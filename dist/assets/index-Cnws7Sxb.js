var XL=Object.defineProperty;var YL=(t,e,r)=>e in t?XL(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var JL=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var si=(t,e,r)=>YL(t,typeof e!="symbol"?e+"":e,r);var Lge=JL((cme,Gx)=>{function Fj(t,e){for(var r=0;r<e.length;r++){const n=e[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var Vx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ly(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Pj={exports:{}},cy={},Dj={exports:{}},yr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg=Symbol.for("react.element"),QL=Symbol.for("react.portal"),qL=Symbol.for("react.fragment"),ZL=Symbol.for("react.strict_mode"),eB=Symbol.for("react.profiler"),tB=Symbol.for("react.provider"),rB=Symbol.for("react.context"),nB=Symbol.for("react.forward_ref"),sB=Symbol.for("react.suspense"),aB=Symbol.for("react.memo"),iB=Symbol.for("react.lazy"),g3=Symbol.iterator;function oB(t){return t===null||typeof t!="object"?null:(t=g3&&t[g3]||t["@@iterator"],typeof t=="function"?t:null)}var Rj={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Mj=Object.assign,Ij={};function ah(t,e,r){this.props=t,this.context=e,this.refs=Ij,this.updater=r||Rj}ah.prototype.isReactComponent={};ah.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ah.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Oj(){}Oj.prototype=ah.prototype;function sk(t,e,r){this.props=t,this.context=e,this.refs=Ij,this.updater=r||Rj}var ak=sk.prototype=new Oj;ak.constructor=sk;Mj(ak,ah.prototype);ak.isPureReactComponent=!0;var m3=Array.isArray,Lj=Object.prototype.hasOwnProperty,ik={current:null},Bj={key:!0,ref:!0,__self:!0,__source:!0};function Uj(t,e,r){var n,s={},a=null,i=null;if(e!=null)for(n in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(a=""+e.key),e)Lj.call(e,n)&&!Bj.hasOwnProperty(n)&&(s[n]=e[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];s.children=l}if(t&&t.defaultProps)for(n in o=t.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:Zg,type:t,key:a,ref:i,props:s,_owner:ik.current}}function lB(t,e){return{$$typeof:Zg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ok(t){return typeof t=="object"&&t!==null&&t.$$typeof===Zg}function cB(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var p3=/\/+/g;function s_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?cB(""+t.key):e.toString(36)}function bx(t,e,r,n,s){var a=typeof t;(a==="undefined"||a==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Zg:case QL:i=!0}}if(i)return i=t,s=s(i),t=n===""?"."+s_(i,0):n,m3(s)?(r="",t!=null&&(r=t.replace(p3,"$&/")+"/"),bx(s,e,r,"",function(u){return u})):s!=null&&(ok(s)&&(s=lB(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(p3,"$&/")+"/")+t)),e.push(s)),1;if(i=0,n=n===""?".":n+":",m3(t))for(var o=0;o<t.length;o++){a=t[o];var l=n+s_(a,o);i+=bx(a,e,r,l,s)}else if(l=oB(t),typeof l=="function")for(t=l.call(t),o=0;!(a=t.next()).done;)a=a.value,l=n+s_(a,o++),i+=bx(a,e,r,l,s);else if(a==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Np(t,e,r){if(t==null)return t;var n=[],s=0;return bx(t,n,"","",function(a){return e.call(r,a,s++)}),n}function uB(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var ua={current:null},Sx={transition:null},dB={ReactCurrentDispatcher:ua,ReactCurrentBatchConfig:Sx,ReactCurrentOwner:ik};function $j(){throw Error("act(...) is not supported in production builds of React.")}yr.Children={map:Np,forEach:function(t,e,r){Np(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Np(t,function(){e++}),e},toArray:function(t){return Np(t,function(e){return e})||[]},only:function(t){if(!ok(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};yr.Component=ah;yr.Fragment=qL;yr.Profiler=eB;yr.PureComponent=sk;yr.StrictMode=ZL;yr.Suspense=sB;yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dB;yr.act=$j;yr.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Mj({},t.props),s=t.key,a=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(a=e.ref,i=ik.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Lj.call(e,l)&&!Bj.hasOwnProperty(l)&&(n[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Zg,type:t.type,key:s,ref:a,props:n,_owner:i}};yr.createContext=function(t){return t={$$typeof:rB,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tB,_context:t},t.Consumer=t};yr.createElement=Uj;yr.createFactory=function(t){var e=Uj.bind(null,t);return e.type=t,e};yr.createRef=function(){return{current:null}};yr.forwardRef=function(t){return{$$typeof:nB,render:t}};yr.isValidElement=ok;yr.lazy=function(t){return{$$typeof:iB,_payload:{_status:-1,_result:t},_init:uB}};yr.memo=function(t,e){return{$$typeof:aB,type:t,compare:e===void 0?null:e}};yr.startTransition=function(t){var e=Sx.transition;Sx.transition={};try{t()}finally{Sx.transition=e}};yr.unstable_act=$j;yr.useCallback=function(t,e){return ua.current.useCallback(t,e)};yr.useContext=function(t){return ua.current.useContext(t)};yr.useDebugValue=function(){};yr.useDeferredValue=function(t){return ua.current.useDeferredValue(t)};yr.useEffect=function(t,e){return ua.current.useEffect(t,e)};yr.useId=function(){return ua.current.useId()};yr.useImperativeHandle=function(t,e,r){return ua.current.useImperativeHandle(t,e,r)};yr.useInsertionEffect=function(t,e){return ua.current.useInsertionEffect(t,e)};yr.useLayoutEffect=function(t,e){return ua.current.useLayoutEffect(t,e)};yr.useMemo=function(t,e){return ua.current.useMemo(t,e)};yr.useReducer=function(t,e,r){return ua.current.useReducer(t,e,r)};yr.useRef=function(t){return ua.current.useRef(t)};yr.useState=function(t){return ua.current.useState(t)};yr.useSyncExternalStore=function(t,e,r){return ua.current.useSyncExternalStore(t,e,r)};yr.useTransition=function(){return ua.current.useTransition()};yr.version="18.3.1";Dj.exports=yr;var b=Dj.exports;const Gn=ly(b),fB=Fj({__proto__:null,default:Gn},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hB=b,gB=Symbol.for("react.element"),mB=Symbol.for("react.fragment"),pB=Object.prototype.hasOwnProperty,xB=hB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yB={key:!0,ref:!0,__self:!0,__source:!0};function Wj(t,e,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),e.key!==void 0&&(a=""+e.key),e.ref!==void 0&&(i=e.ref);for(n in e)pB.call(e,n)&&!yB.hasOwnProperty(n)&&(s[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)s[n]===void 0&&(s[n]=e[n]);return{$$typeof:gB,type:t,key:a,ref:i,props:s,_owner:xB.current}}cy.Fragment=mB;cy.jsx=Wj;cy.jsxs=Wj;Pj.exports=cy;var c=Pj.exports,O2={},Hj={exports:{}},Va={},zj={exports:{}},Gj={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(O,R){var X=O.length;O.push(R);e:for(;0<X;){var te=X-1>>>1,H=O[te];if(0<s(H,R))O[te]=R,O[X]=H,X=te;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var R=O[0],X=O.pop();if(X!==R){O[0]=X;e:for(var te=0,H=O.length,V=H>>>1;te<V;){var q=2*(te+1)-1,Q=O[q],ae=q+1,J=O[ae];if(0>s(Q,X))ae<H&&0>s(J,Q)?(O[te]=J,O[ae]=X,te=ae):(O[te]=Q,O[q]=X,te=q);else if(ae<H&&0>s(J,X))O[te]=J,O[ae]=X,te=ae;else break e}}return R}function s(O,R){var X=O.sortIndex-R.sortIndex;return X!==0?X:O.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var l=[],u=[],d=1,g=null,h=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(O){for(var R=r(u);R!==null;){if(R.callback===null)n(u);else if(R.startTime<=O)n(u),R.sortIndex=R.expirationTime,e(l,R);else break;R=r(u)}}function k(O){if(v=!1,y(O),!x)if(r(l)!==null)x=!0,z(N);else{var R=r(u);R!==null&&G(k,R.startTime-O)}}function N(O,R){x=!1,v&&(v=!1,S(C),C=-1),p=!0;var X=h;try{for(y(R),g=r(l);g!==null&&(!(g.expirationTime>R)||O&&!M());){var te=g.callback;if(typeof te=="function"){g.callback=null,h=g.priorityLevel;var H=te(g.expirationTime<=R);R=t.unstable_now(),typeof H=="function"?g.callback=H:g===r(l)&&n(l),y(R)}else n(l);g=r(l)}if(g!==null)var V=!0;else{var q=r(u);q!==null&&G(k,q.startTime-R),V=!1}return V}finally{g=null,h=X,p=!1}}var E=!1,A=null,C=-1,F=5,P=-1;function M(){return!(t.unstable_now()-P<F)}function I(){if(A!==null){var O=t.unstable_now();P=O;var R=!0;try{R=A(!0,O)}finally{R?Y():(E=!1,A=null)}}else E=!1}var Y;if(typeof _=="function")Y=function(){_(I)};else if(typeof MessageChannel<"u"){var se=new MessageChannel,L=se.port2;se.port1.onmessage=I,Y=function(){L.postMessage(null)}}else Y=function(){w(I,0)};function z(O){A=O,E||(E=!0,Y())}function G(O,R){C=w(function(){O(t.unstable_now())},R)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(O){O.callback=null},t.unstable_continueExecution=function(){x||p||(x=!0,z(N))},t.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<O?Math.floor(1e3/O):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return r(l)},t.unstable_next=function(O){switch(h){case 1:case 2:case 3:var R=3;break;default:R=h}var X=h;h=R;try{return O()}finally{h=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(O,R){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var X=h;h=O;try{return R()}finally{h=X}},t.unstable_scheduleCallback=function(O,R,X){var te=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?te+X:te):X=te,O){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=X+H,O={id:d++,callback:R,priorityLevel:O,startTime:X,expirationTime:H,sortIndex:-1},X>te?(O.sortIndex=X,e(u,O),r(l)===null&&O===r(u)&&(v?(S(C),C=-1):v=!0,G(k,X-te))):(O.sortIndex=H,e(l,O),x||p||(x=!0,z(N))),O},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(O){var R=h;return function(){var X=h;h=R;try{return O.apply(this,arguments)}finally{h=X}}}})(Gj);zj.exports=Gj;var N0=zj.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vB=b,Ha=N0;function vt(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Vj=new Set,rg={};function sd(t,e){Of(t,e),Of(t+"Capture",e)}function Of(t,e){for(rg[t]=e,t=0;t<e.length;t++)Vj.add(e[t])}var gl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),L2=Object.prototype.hasOwnProperty,wB=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,x3={},y3={};function _B(t){return L2.call(y3,t)?!0:L2.call(x3,t)?!1:wB.test(t)?y3[t]=!0:(x3[t]=!0,!1)}function bB(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SB(t,e,r,n){if(e===null||typeof e>"u"||bB(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function da(t,e,r,n,s,a,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=a,this.removeEmptyString=i}var js={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){js[t]=new da(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];js[e]=new da(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){js[t]=new da(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){js[t]=new da(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){js[t]=new da(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){js[t]=new da(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){js[t]=new da(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){js[t]=new da(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){js[t]=new da(t,5,!1,t.toLowerCase(),null,!1,!1)});var lk=/[\-:]([a-z])/g;function ck(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(lk,ck);js[e]=new da(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(lk,ck);js[e]=new da(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(lk,ck);js[e]=new da(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){js[t]=new da(t,1,!1,t.toLowerCase(),null,!1,!1)});js.xlinkHref=new da("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){js[t]=new da(t,1,!1,t.toLowerCase(),null,!0,!0)});function uk(t,e,r,n){var s=js.hasOwnProperty(e)?js[e]:null;(s!==null?s.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SB(e,r,s,n)&&(r=null),n||s===null?_B(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):s.mustUseProperty?t[s.propertyName]=r===null?s.type===3?!1:"":r:(e=s.attributeName,n=s.attributeNamespace,r===null?t.removeAttribute(e):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var Sl=vB.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ap=Symbol.for("react.element"),qd=Symbol.for("react.portal"),Zd=Symbol.for("react.fragment"),dk=Symbol.for("react.strict_mode"),B2=Symbol.for("react.profiler"),Kj=Symbol.for("react.provider"),Xj=Symbol.for("react.context"),fk=Symbol.for("react.forward_ref"),U2=Symbol.for("react.suspense"),$2=Symbol.for("react.suspense_list"),hk=Symbol.for("react.memo"),Vl=Symbol.for("react.lazy"),Yj=Symbol.for("react.offscreen"),v3=Symbol.iterator;function Zh(t){return t===null||typeof t!="object"?null:(t=v3&&t[v3]||t["@@iterator"],typeof t=="function"?t:null)}var xn=Object.assign,a_;function y0(t){if(a_===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);a_=e&&e[1]||""}return`
`+a_+t}var i_=!1;function o_(t,e){if(!t||i_)return"";i_=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var n=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){n=u}t.call(e.prototype)}else{try{throw Error()}catch(u){n=u}t()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var l=`
`+s[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=o);break}}}finally{i_=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?y0(t):""}function kB(t){switch(t.tag){case 5:return y0(t.type);case 16:return y0("Lazy");case 13:return y0("Suspense");case 19:return y0("SuspenseList");case 0:case 2:case 15:return t=o_(t.type,!1),t;case 11:return t=o_(t.type.render,!1),t;case 1:return t=o_(t.type,!0),t;default:return""}}function W2(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Zd:return"Fragment";case qd:return"Portal";case B2:return"Profiler";case dk:return"StrictMode";case U2:return"Suspense";case $2:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Xj:return(t.displayName||"Context")+".Consumer";case Kj:return(t._context.displayName||"Context")+".Provider";case fk:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case hk:return e=t.displayName||null,e!==null?e:W2(t.type)||"Memo";case Vl:e=t._payload,t=t._init;try{return W2(t(e))}catch{}}return null}function CB(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W2(e);case 8:return e===dk?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function yc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Jj(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function TB(t){var e=Jj(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function jp(t){t._valueTracker||(t._valueTracker=TB(t))}function Qj(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=Jj(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Kx(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function H2(t,e){var r=e.checked;return xn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function w3(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=yc(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function qj(t,e){e=e.checked,e!=null&&uk(t,"checked",e,!1)}function z2(t,e){qj(t,e);var r=yc(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?G2(t,e.type,r):e.hasOwnProperty("defaultValue")&&G2(t,e.type,yc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _3(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function G2(t,e,r){(e!=="number"||Kx(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var v0=Array.isArray;function wf(t,e,r,n){if(t=t.options,e){e={};for(var s=0;s<r.length;s++)e["$"+r[s]]=!0;for(r=0;r<t.length;r++)s=e.hasOwnProperty("$"+t[r].value),t[r].selected!==s&&(t[r].selected=s),s&&n&&(t[r].defaultSelected=!0)}else{for(r=""+yc(r),e=null,s=0;s<t.length;s++){if(t[s].value===r){t[s].selected=!0,n&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function V2(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(vt(91));return xn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function b3(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(vt(92));if(v0(r)){if(1<r.length)throw Error(vt(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:yc(r)}}function Zj(t,e){var r=yc(e.value),n=yc(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function S3(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function eF(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function K2(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?eF(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fp,tF=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,s){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fp=Fp||document.createElement("div"),Fp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ng(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var A0={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},EB=["Webkit","ms","Moz","O"];Object.keys(A0).forEach(function(t){EB.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),A0[e]=A0[t]})});function rF(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||A0.hasOwnProperty(t)&&A0[t]?(""+e).trim():e+"px"}function nF(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=rF(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,s):t[r]=s}}var NB=xn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function X2(t,e){if(e){if(NB[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(vt(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(vt(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(vt(61))}if(e.style!=null&&typeof e.style!="object")throw Error(vt(62))}}function Y2(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var J2=null;function gk(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Q2=null,_f=null,bf=null;function k3(t){if(t=rm(t)){if(typeof Q2!="function")throw Error(vt(280));var e=t.stateNode;e&&(e=gy(e),Q2(t.stateNode,t.type,e))}}function sF(t){_f?bf?bf.push(t):bf=[t]:_f=t}function aF(){if(_f){var t=_f,e=bf;if(bf=_f=null,k3(t),e)for(t=0;t<e.length;t++)k3(e[t])}}function iF(t,e){return t(e)}function oF(){}var l_=!1;function lF(t,e,r){if(l_)return t(e,r);l_=!0;try{return iF(t,e,r)}finally{l_=!1,(_f!==null||bf!==null)&&(oF(),aF())}}function sg(t,e){var r=t.stateNode;if(r===null)return null;var n=gy(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(vt(231,e,typeof r));return r}var q2=!1;if(gl)try{var e0={};Object.defineProperty(e0,"passive",{get:function(){q2=!0}}),window.addEventListener("test",e0,e0),window.removeEventListener("test",e0,e0)}catch{q2=!1}function AB(t,e,r,n,s,a,i,o,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(r,u)}catch(d){this.onError(d)}}var j0=!1,Xx=null,Yx=!1,Z2=null,jB={onError:function(t){j0=!0,Xx=t}};function FB(t,e,r,n,s,a,i,o,l){j0=!1,Xx=null,AB.apply(jB,arguments)}function PB(t,e,r,n,s,a,i,o,l){if(FB.apply(this,arguments),j0){if(j0){var u=Xx;j0=!1,Xx=null}else throw Error(vt(198));Yx||(Yx=!0,Z2=u)}}function ad(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function cF(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function C3(t){if(ad(t)!==t)throw Error(vt(188))}function DB(t){var e=t.alternate;if(!e){if(e=ad(t),e===null)throw Error(vt(188));return e!==t?null:t}for(var r=t,n=e;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return C3(s),t;if(a===n)return C3(s),e;a=a.sibling}throw Error(vt(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(vt(189))}}if(r.alternate!==n)throw Error(vt(190))}if(r.tag!==3)throw Error(vt(188));return r.stateNode.current===r?t:e}function uF(t){return t=DB(t),t!==null?dF(t):null}function dF(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=dF(t);if(e!==null)return e;t=t.sibling}return null}var fF=Ha.unstable_scheduleCallback,T3=Ha.unstable_cancelCallback,RB=Ha.unstable_shouldYield,MB=Ha.unstable_requestPaint,In=Ha.unstable_now,IB=Ha.unstable_getCurrentPriorityLevel,mk=Ha.unstable_ImmediatePriority,hF=Ha.unstable_UserBlockingPriority,Jx=Ha.unstable_NormalPriority,OB=Ha.unstable_LowPriority,gF=Ha.unstable_IdlePriority,uy=null,Eo=null;function LB(t){if(Eo&&typeof Eo.onCommitFiberRoot=="function")try{Eo.onCommitFiberRoot(uy,t,void 0,(t.current.flags&128)===128)}catch{}}var Ki=Math.clz32?Math.clz32:$B,BB=Math.log,UB=Math.LN2;function $B(t){return t>>>=0,t===0?32:31-(BB(t)/UB|0)|0}var Pp=64,Dp=4194304;function w0(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Qx(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,s=t.suspendedLanes,a=t.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=w0(o):(a&=i,a!==0&&(n=w0(a)))}else i=r&~s,i!==0?n=w0(i):a!==0&&(n=w0(a));if(n===0)return 0;if(e!==0&&e!==n&&!(e&s)&&(s=n&-n,a=e&-e,s>=a||s===16&&(a&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Ki(e),s=1<<r,n|=t[r],e&=~s;return n}function WB(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HB(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,s=t.expirationTimes,a=t.pendingLanes;0<a;){var i=31-Ki(a),o=1<<i,l=s[i];l===-1?(!(o&r)||o&n)&&(s[i]=WB(o,e)):l<=e&&(t.expiredLanes|=o),a&=~o}}function eb(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function mF(){var t=Pp;return Pp<<=1,!(Pp&4194240)&&(Pp=64),t}function c_(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function em(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ki(e),t[e]=r}function zB(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var s=31-Ki(r),a=1<<s;e[s]=0,n[s]=-1,t[s]=-1,r&=~a}}function pk(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Ki(r),s=1<<n;s&e|t[n]&e&&(t[n]|=e),r&=~s}}var Lr=0;function pF(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var xF,xk,yF,vF,wF,tb=!1,Rp=[],ac=null,ic=null,oc=null,ag=new Map,ig=new Map,Yl=[],GB="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E3(t,e){switch(t){case"focusin":case"focusout":ac=null;break;case"dragenter":case"dragleave":ic=null;break;case"mouseover":case"mouseout":oc=null;break;case"pointerover":case"pointerout":ag.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ig.delete(e.pointerId)}}function t0(t,e,r,n,s,a){return t===null||t.nativeEvent!==a?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},e!==null&&(e=rm(e),e!==null&&xk(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function VB(t,e,r,n,s){switch(e){case"focusin":return ac=t0(ac,t,e,r,n,s),!0;case"dragenter":return ic=t0(ic,t,e,r,n,s),!0;case"mouseover":return oc=t0(oc,t,e,r,n,s),!0;case"pointerover":var a=s.pointerId;return ag.set(a,t0(ag.get(a)||null,t,e,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,ig.set(a,t0(ig.get(a)||null,t,e,r,n,s)),!0}return!1}function _F(t){var e=hu(t.target);if(e!==null){var r=ad(e);if(r!==null){if(e=r.tag,e===13){if(e=cF(r),e!==null){t.blockedOn=e,wF(t.priority,function(){yF(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function kx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=rb(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);J2=n,r.target.dispatchEvent(n),J2=null}else return e=rm(r),e!==null&&xk(e),t.blockedOn=r,!1;e.shift()}return!0}function N3(t,e,r){kx(t)&&r.delete(e)}function KB(){tb=!1,ac!==null&&kx(ac)&&(ac=null),ic!==null&&kx(ic)&&(ic=null),oc!==null&&kx(oc)&&(oc=null),ag.forEach(N3),ig.forEach(N3)}function r0(t,e){t.blockedOn===e&&(t.blockedOn=null,tb||(tb=!0,Ha.unstable_scheduleCallback(Ha.unstable_NormalPriority,KB)))}function og(t){function e(s){return r0(s,t)}if(0<Rp.length){r0(Rp[0],t);for(var r=1;r<Rp.length;r++){var n=Rp[r];n.blockedOn===t&&(n.blockedOn=null)}}for(ac!==null&&r0(ac,t),ic!==null&&r0(ic,t),oc!==null&&r0(oc,t),ag.forEach(e),ig.forEach(e),r=0;r<Yl.length;r++)n=Yl[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Yl.length&&(r=Yl[0],r.blockedOn===null);)_F(r),r.blockedOn===null&&Yl.shift()}var Sf=Sl.ReactCurrentBatchConfig,qx=!0;function XB(t,e,r,n){var s=Lr,a=Sf.transition;Sf.transition=null;try{Lr=1,yk(t,e,r,n)}finally{Lr=s,Sf.transition=a}}function YB(t,e,r,n){var s=Lr,a=Sf.transition;Sf.transition=null;try{Lr=4,yk(t,e,r,n)}finally{Lr=s,Sf.transition=a}}function yk(t,e,r,n){if(qx){var s=rb(t,e,r,n);if(s===null)v_(t,e,n,Zx,r),E3(t,n);else if(VB(s,t,e,r,n))n.stopPropagation();else if(E3(t,n),e&4&&-1<GB.indexOf(t)){for(;s!==null;){var a=rm(s);if(a!==null&&xF(a),a=rb(t,e,r,n),a===null&&v_(t,e,n,Zx,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else v_(t,e,n,null,r)}}var Zx=null;function rb(t,e,r,n){if(Zx=null,t=gk(n),t=hu(t),t!==null)if(e=ad(t),e===null)t=null;else if(r=e.tag,r===13){if(t=cF(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zx=t,null}function bF(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(IB()){case mk:return 1;case hF:return 4;case Jx:case OB:return 16;case gF:return 536870912;default:return 16}default:return 16}}var Ql=null,vk=null,Cx=null;function SF(){if(Cx)return Cx;var t,e=vk,r=e.length,n,s="value"in Ql?Ql.value:Ql.textContent,a=s.length;for(t=0;t<r&&e[t]===s[t];t++);var i=r-t;for(n=1;n<=i&&e[r-n]===s[a-n];n++);return Cx=s.slice(t,1<n?1-n:void 0)}function Tx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Mp(){return!0}function A3(){return!1}function Ka(t){function e(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(r=t[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Mp:A3,this.isPropagationStopped=A3,this}return xn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Mp)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Mp)},persist:function(){},isPersistent:Mp}),e}var ih={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wk=Ka(ih),tm=xn({},ih,{view:0,detail:0}),JB=Ka(tm),u_,d_,n0,dy=xn({},tm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_k,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==n0&&(n0&&t.type==="mousemove"?(u_=t.screenX-n0.screenX,d_=t.screenY-n0.screenY):d_=u_=0,n0=t),u_)},movementY:function(t){return"movementY"in t?t.movementY:d_}}),j3=Ka(dy),QB=xn({},dy,{dataTransfer:0}),qB=Ka(QB),ZB=xn({},tm,{relatedTarget:0}),f_=Ka(ZB),eU=xn({},ih,{animationName:0,elapsedTime:0,pseudoElement:0}),tU=Ka(eU),rU=xn({},ih,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nU=Ka(rU),sU=xn({},ih,{data:0}),F3=Ka(sU),aU={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},iU={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oU={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function lU(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oU[t])?!!e[t]:!1}function _k(){return lU}var cU=xn({},tm,{key:function(t){if(t.key){var e=aU[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Tx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?iU[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_k,charCode:function(t){return t.type==="keypress"?Tx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Tx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),uU=Ka(cU),dU=xn({},dy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),P3=Ka(dU),fU=xn({},tm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_k}),hU=Ka(fU),gU=xn({},ih,{propertyName:0,elapsedTime:0,pseudoElement:0}),mU=Ka(gU),pU=xn({},dy,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),xU=Ka(pU),yU=[9,13,27,32],bk=gl&&"CompositionEvent"in window,F0=null;gl&&"documentMode"in document&&(F0=document.documentMode);var vU=gl&&"TextEvent"in window&&!F0,kF=gl&&(!bk||F0&&8<F0&&11>=F0),D3=" ",R3=!1;function CF(t,e){switch(t){case"keyup":return yU.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function TF(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ef=!1;function wU(t,e){switch(t){case"compositionend":return TF(e);case"keypress":return e.which!==32?null:(R3=!0,D3);case"textInput":return t=e.data,t===D3&&R3?null:t;default:return null}}function _U(t,e){if(ef)return t==="compositionend"||!bk&&CF(t,e)?(t=SF(),Cx=vk=Ql=null,ef=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return kF&&e.locale!=="ko"?null:e.data;default:return null}}var bU={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function M3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!bU[t.type]:e==="textarea"}function EF(t,e,r,n){sF(n),e=e1(e,"onChange"),0<e.length&&(r=new wk("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var P0=null,lg=null;function SU(t){LF(t,0)}function fy(t){var e=nf(t);if(Qj(e))return t}function kU(t,e){if(t==="change")return e}var NF=!1;if(gl){var h_;if(gl){var g_="oninput"in document;if(!g_){var I3=document.createElement("div");I3.setAttribute("oninput","return;"),g_=typeof I3.oninput=="function"}h_=g_}else h_=!1;NF=h_&&(!document.documentMode||9<document.documentMode)}function O3(){P0&&(P0.detachEvent("onpropertychange",AF),lg=P0=null)}function AF(t){if(t.propertyName==="value"&&fy(lg)){var e=[];EF(e,lg,t,gk(t)),lF(SU,e)}}function CU(t,e,r){t==="focusin"?(O3(),P0=e,lg=r,P0.attachEvent("onpropertychange",AF)):t==="focusout"&&O3()}function TU(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return fy(lg)}function EU(t,e){if(t==="click")return fy(e)}function NU(t,e){if(t==="input"||t==="change")return fy(e)}function AU(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zi=typeof Object.is=="function"?Object.is:AU;function cg(t,e){if(Zi(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!L2.call(e,s)||!Zi(t[s],e[s]))return!1}return!0}function L3(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function B3(t,e){var r=L3(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=L3(r)}}function jF(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?jF(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function FF(){for(var t=window,e=Kx();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Kx(t.document)}return e}function Sk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function jU(t){var e=FF(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&jF(r.ownerDocument.documentElement,r)){if(n!==null&&Sk(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!t.extend&&a>n&&(s=n,n=a,a=s),s=B3(r,a);var i=B3(r,n);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),a>n?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var FU=gl&&"documentMode"in document&&11>=document.documentMode,tf=null,nb=null,D0=null,sb=!1;function U3(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sb||tf==null||tf!==Kx(n)||(n=tf,"selectionStart"in n&&Sk(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),D0&&cg(D0,n)||(D0=n,n=e1(nb,"onSelect"),0<n.length&&(e=new wk("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=tf)))}function Ip(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var rf={animationend:Ip("Animation","AnimationEnd"),animationiteration:Ip("Animation","AnimationIteration"),animationstart:Ip("Animation","AnimationStart"),transitionend:Ip("Transition","TransitionEnd")},m_={},PF={};gl&&(PF=document.createElement("div").style,"AnimationEvent"in window||(delete rf.animationend.animation,delete rf.animationiteration.animation,delete rf.animationstart.animation),"TransitionEvent"in window||delete rf.transitionend.transition);function hy(t){if(m_[t])return m_[t];if(!rf[t])return t;var e=rf[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in PF)return m_[t]=e[r];return t}var DF=hy("animationend"),RF=hy("animationiteration"),MF=hy("animationstart"),IF=hy("transitionend"),OF=new Map,$3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ac(t,e){OF.set(t,e),sd(e,[t])}for(var p_=0;p_<$3.length;p_++){var x_=$3[p_],PU=x_.toLowerCase(),DU=x_[0].toUpperCase()+x_.slice(1);Ac(PU,"on"+DU)}Ac(DF,"onAnimationEnd");Ac(RF,"onAnimationIteration");Ac(MF,"onAnimationStart");Ac("dblclick","onDoubleClick");Ac("focusin","onFocus");Ac("focusout","onBlur");Ac(IF,"onTransitionEnd");Of("onMouseEnter",["mouseout","mouseover"]);Of("onMouseLeave",["mouseout","mouseover"]);Of("onPointerEnter",["pointerout","pointerover"]);Of("onPointerLeave",["pointerout","pointerover"]);sd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sd("onBeforeInput",["compositionend","keypress","textInput","paste"]);sd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RU=new Set("cancel close invalid load scroll toggle".split(" ").concat(_0));function W3(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,PB(n,e,void 0,t),t.currentTarget=null}function LF(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],s=n.event;n=n.listeners;e:{var a=void 0;if(e)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;W3(s,o,u),a=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;W3(s,o,u),a=l}}}if(Yx)throw t=Z2,Yx=!1,Z2=null,t}function Xr(t,e){var r=e[cb];r===void 0&&(r=e[cb]=new Set);var n=t+"__bubble";r.has(n)||(BF(e,t,2,!1),r.add(n))}function y_(t,e,r){var n=0;e&&(n|=4),BF(r,t,n,e)}var Op="_reactListening"+Math.random().toString(36).slice(2);function ug(t){if(!t[Op]){t[Op]=!0,Vj.forEach(function(r){r!=="selectionchange"&&(RU.has(r)||y_(r,!1,t),y_(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Op]||(e[Op]=!0,y_("selectionchange",!1,e))}}function BF(t,e,r,n){switch(bF(e)){case 1:var s=XB;break;case 4:s=YB;break;default:s=yk}r=s.bind(null,e,r,t),s=void 0,!q2||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),n?s!==void 0?t.addEventListener(e,r,{capture:!0,passive:s}):t.addEventListener(e,r,!0):s!==void 0?t.addEventListener(e,r,{passive:s}):t.addEventListener(e,r,!1)}function v_(t,e,r,n,s){var a=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;i=i.return}for(;o!==null;){if(i=hu(o),i===null)return;if(l=i.tag,l===5||l===6){n=a=i;continue e}o=o.parentNode}}n=n.return}lF(function(){var u=a,d=gk(r),g=[];e:{var h=OF.get(t);if(h!==void 0){var p=wk,x=t;switch(t){case"keypress":if(Tx(r)===0)break e;case"keydown":case"keyup":p=uU;break;case"focusin":x="focus",p=f_;break;case"focusout":x="blur",p=f_;break;case"beforeblur":case"afterblur":p=f_;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=j3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=qB;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=hU;break;case DF:case RF:case MF:p=tU;break;case IF:p=mU;break;case"scroll":p=JB;break;case"wheel":p=xU;break;case"copy":case"cut":case"paste":p=nU;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=P3}var v=(e&4)!==0,w=!v&&t==="scroll",S=v?h!==null?h+"Capture":null:h;v=[];for(var _=u,y;_!==null;){y=_;var k=y.stateNode;if(y.tag===5&&k!==null&&(y=k,S!==null&&(k=sg(_,S),k!=null&&v.push(dg(_,k,y)))),w)break;_=_.return}0<v.length&&(h=new p(h,x,null,r,d),g.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",p=t==="mouseout"||t==="pointerout",h&&r!==J2&&(x=r.relatedTarget||r.fromElement)&&(hu(x)||x[ml]))break e;if((p||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,p?(x=r.relatedTarget||r.toElement,p=u,x=x?hu(x):null,x!==null&&(w=ad(x),x!==w||x.tag!==5&&x.tag!==6)&&(x=null)):(p=null,x=u),p!==x)){if(v=j3,k="onMouseLeave",S="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(v=P3,k="onPointerLeave",S="onPointerEnter",_="pointer"),w=p==null?h:nf(p),y=x==null?h:nf(x),h=new v(k,_+"leave",p,r,d),h.target=w,h.relatedTarget=y,k=null,hu(d)===u&&(v=new v(S,_+"enter",x,r,d),v.target=y,v.relatedTarget=w,k=v),w=k,p&&x)t:{for(v=p,S=x,_=0,y=v;y;y=Id(y))_++;for(y=0,k=S;k;k=Id(k))y++;for(;0<_-y;)v=Id(v),_--;for(;0<y-_;)S=Id(S),y--;for(;_--;){if(v===S||S!==null&&v===S.alternate)break t;v=Id(v),S=Id(S)}v=null}else v=null;p!==null&&H3(g,h,p,v,!1),x!==null&&w!==null&&H3(g,w,x,v,!0)}}e:{if(h=u?nf(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var N=kU;else if(M3(h))if(NF)N=NU;else{N=TU;var E=CU}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(N=EU);if(N&&(N=N(t,u))){EF(g,N,r,d);break e}E&&E(t,h,u),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&G2(h,"number",h.value)}switch(E=u?nf(u):window,t){case"focusin":(M3(E)||E.contentEditable==="true")&&(tf=E,nb=u,D0=null);break;case"focusout":D0=nb=tf=null;break;case"mousedown":sb=!0;break;case"contextmenu":case"mouseup":case"dragend":sb=!1,U3(g,r,d);break;case"selectionchange":if(FU)break;case"keydown":case"keyup":U3(g,r,d)}var A;if(bk)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else ef?CF(t,r)&&(C="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(C="onCompositionStart");C&&(kF&&r.locale!=="ko"&&(ef||C!=="onCompositionStart"?C==="onCompositionEnd"&&ef&&(A=SF()):(Ql=d,vk="value"in Ql?Ql.value:Ql.textContent,ef=!0)),E=e1(u,C),0<E.length&&(C=new F3(C,t,null,r,d),g.push({event:C,listeners:E}),A?C.data=A:(A=TF(r),A!==null&&(C.data=A)))),(A=vU?wU(t,r):_U(t,r))&&(u=e1(u,"onBeforeInput"),0<u.length&&(d=new F3("onBeforeInput","beforeinput",null,r,d),g.push({event:d,listeners:u}),d.data=A))}LF(g,e)})}function dg(t,e,r){return{instance:t,listener:e,currentTarget:r}}function e1(t,e){for(var r=e+"Capture",n=[];t!==null;){var s=t,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=sg(t,r),a!=null&&n.unshift(dg(t,a,s)),a=sg(t,e),a!=null&&n.push(dg(t,a,s))),t=t.return}return n}function Id(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function H3(t,e,r,n,s){for(var a=e._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,s?(l=sg(r,a),l!=null&&i.unshift(dg(r,l,o))):s||(l=sg(r,a),l!=null&&i.push(dg(r,l,o)))),r=r.return}i.length!==0&&t.push({event:e,listeners:i})}var MU=/\r\n?/g,IU=/\u0000|\uFFFD/g;function z3(t){return(typeof t=="string"?t:""+t).replace(MU,`
`).replace(IU,"")}function Lp(t,e,r){if(e=z3(e),z3(t)!==e&&r)throw Error(vt(425))}function t1(){}var ab=null,ib=null;function ob(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lb=typeof setTimeout=="function"?setTimeout:void 0,OU=typeof clearTimeout=="function"?clearTimeout:void 0,G3=typeof Promise=="function"?Promise:void 0,LU=typeof queueMicrotask=="function"?queueMicrotask:typeof G3<"u"?function(t){return G3.resolve(null).then(t).catch(BU)}:lb;function BU(t){setTimeout(function(){throw t})}function w_(t,e){var r=e,n=0;do{var s=r.nextSibling;if(t.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){t.removeChild(s),og(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);og(e)}function lc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function V3(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var oh=Math.random().toString(36).slice(2),bo="__reactFiber$"+oh,fg="__reactProps$"+oh,ml="__reactContainer$"+oh,cb="__reactEvents$"+oh,UU="__reactListeners$"+oh,$U="__reactHandles$"+oh;function hu(t){var e=t[bo];if(e)return e;for(var r=t.parentNode;r;){if(e=r[ml]||r[bo]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=V3(t);t!==null;){if(r=t[bo])return r;t=V3(t)}return e}t=r,r=t.parentNode}return null}function rm(t){return t=t[bo]||t[ml],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function nf(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(vt(33))}function gy(t){return t[fg]||null}var ub=[],sf=-1;function jc(t){return{current:t}}function Qr(t){0>sf||(t.current=ub[sf],ub[sf]=null,sf--)}function Vr(t,e){sf++,ub[sf]=t.current,t.current=e}var vc={},Ys=jc(vc),Ta=jc(!1),Du=vc;function Lf(t,e){var r=t.type.contextTypes;if(!r)return vc;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=e[a];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Ea(t){return t=t.childContextTypes,t!=null}function r1(){Qr(Ta),Qr(Ys)}function K3(t,e,r){if(Ys.current!==vc)throw Error(vt(168));Vr(Ys,e),Vr(Ta,r)}function UF(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in e))throw Error(vt(108,CB(t)||"Unknown",s));return xn({},r,n)}function n1(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vc,Du=Ys.current,Vr(Ys,t),Vr(Ta,Ta.current),!0}function X3(t,e,r){var n=t.stateNode;if(!n)throw Error(vt(169));r?(t=UF(t,e,Du),n.__reactInternalMemoizedMergedChildContext=t,Qr(Ta),Qr(Ys),Vr(Ys,t)):Qr(Ta),Vr(Ta,r)}var tl=null,my=!1,__=!1;function $F(t){tl===null?tl=[t]:tl.push(t)}function WU(t){my=!0,$F(t)}function Fc(){if(!__&&tl!==null){__=!0;var t=0,e=Lr;try{var r=tl;for(Lr=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}tl=null,my=!1}catch(s){throw tl!==null&&(tl=tl.slice(t+1)),fF(mk,Fc),s}finally{Lr=e,__=!1}}return null}var af=[],of=0,s1=null,a1=0,mi=[],pi=0,Ru=null,sl=1,al="";function ou(t,e){af[of++]=a1,af[of++]=s1,s1=t,a1=e}function WF(t,e,r){mi[pi++]=sl,mi[pi++]=al,mi[pi++]=Ru,Ru=t;var n=sl;t=al;var s=32-Ki(n)-1;n&=~(1<<s),r+=1;var a=32-Ki(e)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,sl=1<<32-Ki(e)+s|r<<s|n,al=a+t}else sl=1<<a|r<<s|n,al=t}function kk(t){t.return!==null&&(ou(t,1),WF(t,1,0))}function Ck(t){for(;t===s1;)s1=af[--of],af[of]=null,a1=af[--of],af[of]=null;for(;t===Ru;)Ru=mi[--pi],mi[pi]=null,al=mi[--pi],mi[pi]=null,sl=mi[--pi],mi[pi]=null}var Wa=null,$a=null,sn=!1,Wi=null;function HF(t,e){var r=yi(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Y3(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Wa=t,$a=lc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Wa=t,$a=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Ru!==null?{id:sl,overflow:al}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=yi(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,Wa=t,$a=null,!0):!1;default:return!1}}function db(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fb(t){if(sn){var e=$a;if(e){var r=e;if(!Y3(t,e)){if(db(t))throw Error(vt(418));e=lc(r.nextSibling);var n=Wa;e&&Y3(t,e)?HF(n,r):(t.flags=t.flags&-4097|2,sn=!1,Wa=t)}}else{if(db(t))throw Error(vt(418));t.flags=t.flags&-4097|2,sn=!1,Wa=t}}}function J3(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Wa=t}function Bp(t){if(t!==Wa)return!1;if(!sn)return J3(t),sn=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!ob(t.type,t.memoizedProps)),e&&(e=$a)){if(db(t))throw zF(),Error(vt(418));for(;e;)HF(t,e),e=lc(e.nextSibling)}if(J3(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(vt(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){$a=lc(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}$a=null}}else $a=Wa?lc(t.stateNode.nextSibling):null;return!0}function zF(){for(var t=$a;t;)t=lc(t.nextSibling)}function Bf(){$a=Wa=null,sn=!1}function Tk(t){Wi===null?Wi=[t]:Wi.push(t)}var HU=Sl.ReactCurrentBatchConfig;function s0(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(vt(309));var n=r.stateNode}if(!n)throw Error(vt(147,t));var s=n,a=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===a?e.ref:(e=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},e._stringRef=a,e)}if(typeof t!="string")throw Error(vt(284));if(!r._owner)throw Error(vt(290,t))}return t}function Up(t,e){throw t=Object.prototype.toString.call(e),Error(vt(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Q3(t){var e=t._init;return e(t._payload)}function GF(t){function e(S,_){if(t){var y=S.deletions;y===null?(S.deletions=[_],S.flags|=16):y.push(_)}}function r(S,_){if(!t)return null;for(;_!==null;)e(S,_),_=_.sibling;return null}function n(S,_){for(S=new Map;_!==null;)_.key!==null?S.set(_.key,_):S.set(_.index,_),_=_.sibling;return S}function s(S,_){return S=fc(S,_),S.index=0,S.sibling=null,S}function a(S,_,y){return S.index=y,t?(y=S.alternate,y!==null?(y=y.index,y<_?(S.flags|=2,_):y):(S.flags|=2,_)):(S.flags|=1048576,_)}function i(S){return t&&S.alternate===null&&(S.flags|=2),S}function o(S,_,y,k){return _===null||_.tag!==6?(_=N_(y,S.mode,k),_.return=S,_):(_=s(_,y),_.return=S,_)}function l(S,_,y,k){var N=y.type;return N===Zd?d(S,_,y.props.children,k,y.key):_!==null&&(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Vl&&Q3(N)===_.type)?(k=s(_,y.props),k.ref=s0(S,_,y),k.return=S,k):(k=Dx(y.type,y.key,y.props,null,S.mode,k),k.ref=s0(S,_,y),k.return=S,k)}function u(S,_,y,k){return _===null||_.tag!==4||_.stateNode.containerInfo!==y.containerInfo||_.stateNode.implementation!==y.implementation?(_=A_(y,S.mode,k),_.return=S,_):(_=s(_,y.children||[]),_.return=S,_)}function d(S,_,y,k,N){return _===null||_.tag!==7?(_=_u(y,S.mode,k,N),_.return=S,_):(_=s(_,y),_.return=S,_)}function g(S,_,y){if(typeof _=="string"&&_!==""||typeof _=="number")return _=N_(""+_,S.mode,y),_.return=S,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ap:return y=Dx(_.type,_.key,_.props,null,S.mode,y),y.ref=s0(S,null,_),y.return=S,y;case qd:return _=A_(_,S.mode,y),_.return=S,_;case Vl:var k=_._init;return g(S,k(_._payload),y)}if(v0(_)||Zh(_))return _=_u(_,S.mode,y,null),_.return=S,_;Up(S,_)}return null}function h(S,_,y,k){var N=_!==null?_.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return N!==null?null:o(S,_,""+y,k);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Ap:return y.key===N?l(S,_,y,k):null;case qd:return y.key===N?u(S,_,y,k):null;case Vl:return N=y._init,h(S,_,N(y._payload),k)}if(v0(y)||Zh(y))return N!==null?null:d(S,_,y,k,null);Up(S,y)}return null}function p(S,_,y,k,N){if(typeof k=="string"&&k!==""||typeof k=="number")return S=S.get(y)||null,o(_,S,""+k,N);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Ap:return S=S.get(k.key===null?y:k.key)||null,l(_,S,k,N);case qd:return S=S.get(k.key===null?y:k.key)||null,u(_,S,k,N);case Vl:var E=k._init;return p(S,_,y,E(k._payload),N)}if(v0(k)||Zh(k))return S=S.get(y)||null,d(_,S,k,N,null);Up(_,k)}return null}function x(S,_,y,k){for(var N=null,E=null,A=_,C=_=0,F=null;A!==null&&C<y.length;C++){A.index>C?(F=A,A=null):F=A.sibling;var P=h(S,A,y[C],k);if(P===null){A===null&&(A=F);break}t&&A&&P.alternate===null&&e(S,A),_=a(P,_,C),E===null?N=P:E.sibling=P,E=P,A=F}if(C===y.length)return r(S,A),sn&&ou(S,C),N;if(A===null){for(;C<y.length;C++)A=g(S,y[C],k),A!==null&&(_=a(A,_,C),E===null?N=A:E.sibling=A,E=A);return sn&&ou(S,C),N}for(A=n(S,A);C<y.length;C++)F=p(A,S,C,y[C],k),F!==null&&(t&&F.alternate!==null&&A.delete(F.key===null?C:F.key),_=a(F,_,C),E===null?N=F:E.sibling=F,E=F);return t&&A.forEach(function(M){return e(S,M)}),sn&&ou(S,C),N}function v(S,_,y,k){var N=Zh(y);if(typeof N!="function")throw Error(vt(150));if(y=N.call(y),y==null)throw Error(vt(151));for(var E=N=null,A=_,C=_=0,F=null,P=y.next();A!==null&&!P.done;C++,P=y.next()){A.index>C?(F=A,A=null):F=A.sibling;var M=h(S,A,P.value,k);if(M===null){A===null&&(A=F);break}t&&A&&M.alternate===null&&e(S,A),_=a(M,_,C),E===null?N=M:E.sibling=M,E=M,A=F}if(P.done)return r(S,A),sn&&ou(S,C),N;if(A===null){for(;!P.done;C++,P=y.next())P=g(S,P.value,k),P!==null&&(_=a(P,_,C),E===null?N=P:E.sibling=P,E=P);return sn&&ou(S,C),N}for(A=n(S,A);!P.done;C++,P=y.next())P=p(A,S,C,P.value,k),P!==null&&(t&&P.alternate!==null&&A.delete(P.key===null?C:P.key),_=a(P,_,C),E===null?N=P:E.sibling=P,E=P);return t&&A.forEach(function(I){return e(S,I)}),sn&&ou(S,C),N}function w(S,_,y,k){if(typeof y=="object"&&y!==null&&y.type===Zd&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case Ap:e:{for(var N=y.key,E=_;E!==null;){if(E.key===N){if(N=y.type,N===Zd){if(E.tag===7){r(S,E.sibling),_=s(E,y.props.children),_.return=S,S=_;break e}}else if(E.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===Vl&&Q3(N)===E.type){r(S,E.sibling),_=s(E,y.props),_.ref=s0(S,E,y),_.return=S,S=_;break e}r(S,E);break}else e(S,E);E=E.sibling}y.type===Zd?(_=_u(y.props.children,S.mode,k,y.key),_.return=S,S=_):(k=Dx(y.type,y.key,y.props,null,S.mode,k),k.ref=s0(S,_,y),k.return=S,S=k)}return i(S);case qd:e:{for(E=y.key;_!==null;){if(_.key===E)if(_.tag===4&&_.stateNode.containerInfo===y.containerInfo&&_.stateNode.implementation===y.implementation){r(S,_.sibling),_=s(_,y.children||[]),_.return=S,S=_;break e}else{r(S,_);break}else e(S,_);_=_.sibling}_=A_(y,S.mode,k),_.return=S,S=_}return i(S);case Vl:return E=y._init,w(S,_,E(y._payload),k)}if(v0(y))return x(S,_,y,k);if(Zh(y))return v(S,_,y,k);Up(S,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,_!==null&&_.tag===6?(r(S,_.sibling),_=s(_,y),_.return=S,S=_):(r(S,_),_=N_(y,S.mode,k),_.return=S,S=_),i(S)):r(S,_)}return w}var Uf=GF(!0),VF=GF(!1),i1=jc(null),o1=null,lf=null,Ek=null;function Nk(){Ek=lf=o1=null}function Ak(t){var e=i1.current;Qr(i1),t._currentValue=e}function hb(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function kf(t,e){o1=t,Ek=lf=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ka=!0),t.firstContext=null)}function Si(t){var e=t._currentValue;if(Ek!==t)if(t={context:t,memoizedValue:e,next:null},lf===null){if(o1===null)throw Error(vt(308));lf=t,o1.dependencies={lanes:0,firstContext:t}}else lf=lf.next=t;return e}var gu=null;function jk(t){gu===null?gu=[t]:gu.push(t)}function KF(t,e,r,n){var s=e.interleaved;return s===null?(r.next=r,jk(e)):(r.next=s.next,s.next=r),e.interleaved=r,pl(t,n)}function pl(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Kl=!1;function Fk(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function XF(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ll(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function cc(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,br&2){var s=n.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),n.pending=e,pl(t,r)}return s=n.interleaved,s===null?(e.next=e,jk(n)):(e.next=s.next,s.next=e),n.interleaved=e,pl(t,r)}function Ex(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,pk(t,r)}}function q3(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=e:a=a.next=e}else s=a=e;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function l1(t,e,r,n){var s=t.updateQueue;Kl=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var l=o,u=l.next;l.next=null,i===null?a=u:i.next=u,i=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==i&&(o===null?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l))}if(a!==null){var g=s.baseState;i=0,d=u=l=null,o=a;do{var h=o.lane,p=o.eventTime;if((n&h)===h){d!==null&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var x=t,v=o;switch(h=e,p=r,v.tag){case 1:if(x=v.payload,typeof x=="function"){g=x.call(p,g,h);break e}g=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=v.payload,h=typeof x=="function"?x.call(p,g,h):x,h==null)break e;g=xn({},g,h);break e;case 2:Kl=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(u=d=p,l=g):d=d.next=p,i|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(d===null&&(l=g),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else a===null&&(s.shared.lanes=0);Iu|=i,t.lanes=i,t.memoizedState=g}}function Z3(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(vt(191,s));s.call(n)}}}var nm={},No=jc(nm),hg=jc(nm),gg=jc(nm);function mu(t){if(t===nm)throw Error(vt(174));return t}function Pk(t,e){switch(Vr(gg,e),Vr(hg,t),Vr(No,nm),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:K2(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=K2(e,t)}Qr(No),Vr(No,e)}function $f(){Qr(No),Qr(hg),Qr(gg)}function YF(t){mu(gg.current);var e=mu(No.current),r=K2(e,t.type);e!==r&&(Vr(hg,t),Vr(No,r))}function Dk(t){hg.current===t&&(Qr(No),Qr(hg))}var fn=jc(0);function c1(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var b_=[];function Rk(){for(var t=0;t<b_.length;t++)b_[t]._workInProgressVersionPrimary=null;b_.length=0}var Nx=Sl.ReactCurrentDispatcher,S_=Sl.ReactCurrentBatchConfig,Mu=0,pn=null,Qn=null,ds=null,u1=!1,R0=!1,mg=0,zU=0;function Is(){throw Error(vt(321))}function Mk(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Zi(t[r],e[r]))return!1;return!0}function Ik(t,e,r,n,s,a){if(Mu=a,pn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Nx.current=t===null||t.memoizedState===null?XU:YU,t=r(n,s),R0){a=0;do{if(R0=!1,mg=0,25<=a)throw Error(vt(301));a+=1,ds=Qn=null,e.updateQueue=null,Nx.current=JU,t=r(n,s)}while(R0)}if(Nx.current=d1,e=Qn!==null&&Qn.next!==null,Mu=0,ds=Qn=pn=null,u1=!1,e)throw Error(vt(300));return t}function Ok(){var t=mg!==0;return mg=0,t}function yo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ds===null?pn.memoizedState=ds=t:ds=ds.next=t,ds}function ki(){if(Qn===null){var t=pn.alternate;t=t!==null?t.memoizedState:null}else t=Qn.next;var e=ds===null?pn.memoizedState:ds.next;if(e!==null)ds=e,Qn=t;else{if(t===null)throw Error(vt(310));Qn=t,t={memoizedState:Qn.memoizedState,baseState:Qn.baseState,baseQueue:Qn.baseQueue,queue:Qn.queue,next:null},ds===null?pn.memoizedState=ds=t:ds=ds.next=t}return ds}function pg(t,e){return typeof e=="function"?e(t):e}function k_(t){var e=ki(),r=e.queue;if(r===null)throw Error(vt(311));r.lastRenderedReducer=t;var n=Qn,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,l=null,u=a;do{var d=u.lane;if((Mu&d)===d)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:t(n,u.action);else{var g={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=g,i=n):l=l.next=g,pn.lanes|=d,Iu|=d}u=u.next}while(u!==null&&u!==a);l===null?i=n:l.next=o,Zi(n,e.memoizedState)||(ka=!0),e.memoizedState=n,e.baseState=i,e.baseQueue=l,r.lastRenderedState=n}if(t=r.interleaved,t!==null){s=t;do a=s.lane,pn.lanes|=a,Iu|=a,s=s.next;while(s!==t)}else s===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function C_(t){var e=ki(),r=e.queue;if(r===null)throw Error(vt(311));r.lastRenderedReducer=t;var n=r.dispatch,s=r.pending,a=e.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=t(a,i.action),i=i.next;while(i!==s);Zi(a,e.memoizedState)||(ka=!0),e.memoizedState=a,e.baseQueue===null&&(e.baseState=a),r.lastRenderedState=a}return[a,n]}function JF(){}function QF(t,e){var r=pn,n=ki(),s=e(),a=!Zi(n.memoizedState,s);if(a&&(n.memoizedState=s,ka=!0),n=n.queue,Lk(eP.bind(null,r,n,t),[t]),n.getSnapshot!==e||a||ds!==null&&ds.memoizedState.tag&1){if(r.flags|=2048,xg(9,ZF.bind(null,r,n,s,e),void 0,null),xs===null)throw Error(vt(349));Mu&30||qF(r,e,s)}return s}function qF(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function ZF(t,e,r,n){e.value=r,e.getSnapshot=n,tP(e)&&rP(t)}function eP(t,e,r){return r(function(){tP(e)&&rP(t)})}function tP(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Zi(t,r)}catch{return!0}}function rP(t){var e=pl(t,1);e!==null&&Xi(e,t,1,-1)}function eN(t){var e=yo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pg,lastRenderedState:t},e.queue=t,t=t.dispatch=KU.bind(null,pn,t),[e.memoizedState,t]}function xg(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function nP(){return ki().memoizedState}function Ax(t,e,r,n){var s=yo();pn.flags|=t,s.memoizedState=xg(1|e,r,void 0,n===void 0?null:n)}function py(t,e,r,n){var s=ki();n=n===void 0?null:n;var a=void 0;if(Qn!==null){var i=Qn.memoizedState;if(a=i.destroy,n!==null&&Mk(n,i.deps)){s.memoizedState=xg(e,r,a,n);return}}pn.flags|=t,s.memoizedState=xg(1|e,r,a,n)}function tN(t,e){return Ax(8390656,8,t,e)}function Lk(t,e){return py(2048,8,t,e)}function sP(t,e){return py(4,2,t,e)}function aP(t,e){return py(4,4,t,e)}function iP(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function oP(t,e,r){return r=r!=null?r.concat([t]):null,py(4,4,iP.bind(null,e,t),r)}function Bk(){}function lP(t,e){var r=ki();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Mk(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function cP(t,e){var r=ki();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&Mk(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function uP(t,e,r){return Mu&21?(Zi(r,e)||(r=mF(),pn.lanes|=r,Iu|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ka=!0),t.memoizedState=r)}function GU(t,e){var r=Lr;Lr=r!==0&&4>r?r:4,t(!0);var n=S_.transition;S_.transition={};try{t(!1),e()}finally{Lr=r,S_.transition=n}}function dP(){return ki().memoizedState}function VU(t,e,r){var n=dc(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},fP(t))hP(e,r);else if(r=KF(t,e,r,n),r!==null){var s=oa();Xi(r,t,n,s),gP(r,e,n)}}function KU(t,e,r){var n=dc(t),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(fP(t))hP(e,s);else{var a=t.alternate;if(t.lanes===0&&(a===null||a.lanes===0)&&(a=e.lastRenderedReducer,a!==null))try{var i=e.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,Zi(o,i)){var l=e.interleaved;l===null?(s.next=s,jk(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}r=KF(t,e,s,n),r!==null&&(s=oa(),Xi(r,t,n,s),gP(r,e,n))}}function fP(t){var e=t.alternate;return t===pn||e!==null&&e===pn}function hP(t,e){R0=u1=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function gP(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,pk(t,r)}}var d1={readContext:Si,useCallback:Is,useContext:Is,useEffect:Is,useImperativeHandle:Is,useInsertionEffect:Is,useLayoutEffect:Is,useMemo:Is,useReducer:Is,useRef:Is,useState:Is,useDebugValue:Is,useDeferredValue:Is,useTransition:Is,useMutableSource:Is,useSyncExternalStore:Is,useId:Is,unstable_isNewReconciler:!1},XU={readContext:Si,useCallback:function(t,e){return yo().memoizedState=[t,e===void 0?null:e],t},useContext:Si,useEffect:tN,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,Ax(4194308,4,iP.bind(null,e,t),r)},useLayoutEffect:function(t,e){return Ax(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ax(4,2,t,e)},useMemo:function(t,e){var r=yo();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=yo();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=VU.bind(null,pn,t),[n.memoizedState,t]},useRef:function(t){var e=yo();return t={current:t},e.memoizedState=t},useState:eN,useDebugValue:Bk,useDeferredValue:function(t){return yo().memoizedState=t},useTransition:function(){var t=eN(!1),e=t[0];return t=GU.bind(null,t[1]),yo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=pn,s=yo();if(sn){if(r===void 0)throw Error(vt(407));r=r()}else{if(r=e(),xs===null)throw Error(vt(349));Mu&30||qF(n,e,r)}s.memoizedState=r;var a={value:r,getSnapshot:e};return s.queue=a,tN(eP.bind(null,n,a,t),[t]),n.flags|=2048,xg(9,ZF.bind(null,n,a,r,e),void 0,null),r},useId:function(){var t=yo(),e=xs.identifierPrefix;if(sn){var r=al,n=sl;r=(n&~(1<<32-Ki(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=mg++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=zU++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},YU={readContext:Si,useCallback:lP,useContext:Si,useEffect:Lk,useImperativeHandle:oP,useInsertionEffect:sP,useLayoutEffect:aP,useMemo:cP,useReducer:k_,useRef:nP,useState:function(){return k_(pg)},useDebugValue:Bk,useDeferredValue:function(t){var e=ki();return uP(e,Qn.memoizedState,t)},useTransition:function(){var t=k_(pg)[0],e=ki().memoizedState;return[t,e]},useMutableSource:JF,useSyncExternalStore:QF,useId:dP,unstable_isNewReconciler:!1},JU={readContext:Si,useCallback:lP,useContext:Si,useEffect:Lk,useImperativeHandle:oP,useInsertionEffect:sP,useLayoutEffect:aP,useMemo:cP,useReducer:C_,useRef:nP,useState:function(){return C_(pg)},useDebugValue:Bk,useDeferredValue:function(t){var e=ki();return Qn===null?e.memoizedState=t:uP(e,Qn.memoizedState,t)},useTransition:function(){var t=C_(pg)[0],e=ki().memoizedState;return[t,e]},useMutableSource:JF,useSyncExternalStore:QF,useId:dP,unstable_isNewReconciler:!1};function Bi(t,e){if(t&&t.defaultProps){e=xn({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function gb(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:xn({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var xy={isMounted:function(t){return(t=t._reactInternals)?ad(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=oa(),s=dc(t),a=ll(n,s);a.payload=e,r!=null&&(a.callback=r),e=cc(t,a,s),e!==null&&(Xi(e,t,s,n),Ex(e,t,s))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=oa(),s=dc(t),a=ll(n,s);a.tag=1,a.payload=e,r!=null&&(a.callback=r),e=cc(t,a,s),e!==null&&(Xi(e,t,s,n),Ex(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=oa(),n=dc(t),s=ll(r,n);s.tag=2,e!=null&&(s.callback=e),e=cc(t,s,n),e!==null&&(Xi(e,t,n,r),Ex(e,t,n))}};function rN(t,e,r,n,s,a,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,a,i):e.prototype&&e.prototype.isPureReactComponent?!cg(r,n)||!cg(s,a):!0}function mP(t,e,r){var n=!1,s=vc,a=e.contextType;return typeof a=="object"&&a!==null?a=Si(a):(s=Ea(e)?Du:Ys.current,n=e.contextTypes,a=(n=n!=null)?Lf(t,s):vc),e=new e(r,a),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=xy,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),e}function nN(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&xy.enqueueReplaceState(e,e.state,null)}function mb(t,e,r,n){var s=t.stateNode;s.props=r,s.state=t.memoizedState,s.refs={},Fk(t);var a=e.contextType;typeof a=="object"&&a!==null?s.context=Si(a):(a=Ea(e)?Du:Ys.current,s.context=Lf(t,a)),s.state=t.memoizedState,a=e.getDerivedStateFromProps,typeof a=="function"&&(gb(t,e,a,r),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&xy.enqueueReplaceState(s,s.state,null),l1(t,r,s,n),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Wf(t,e){try{var r="",n=e;do r+=kB(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:t,source:e,stack:s,digest:null}}function T_(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function pb(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var QU=typeof WeakMap=="function"?WeakMap:Map;function pP(t,e,r){r=ll(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){h1||(h1=!0,Tb=n),pb(t,e)},r}function xP(t,e,r){r=ll(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var s=e.value;r.payload=function(){return n(s)},r.callback=function(){pb(t,e)}}var a=t.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){pb(t,e),typeof n!="function"&&(uc===null?uc=new Set([this]):uc.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),r}function sN(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new QU;var s=new Set;n.set(e,s)}else s=n.get(e),s===void 0&&(s=new Set,n.set(e,s));s.has(r)||(s.add(r),t=d$.bind(null,t,e,r),e.then(t,t))}function aN(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function iN(t,e,r,n,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=ll(-1,1),e.tag=2,cc(r,e,1))),r.lanes|=1),t)}var qU=Sl.ReactCurrentOwner,ka=!1;function ra(t,e,r,n){e.child=t===null?VF(e,null,r,n):Uf(e,t.child,r,n)}function oN(t,e,r,n,s){r=r.render;var a=e.ref;return kf(e,s),n=Ik(t,e,r,n,a,s),r=Ok(),t!==null&&!ka?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xl(t,e,s)):(sn&&r&&kk(e),e.flags|=1,ra(t,e,n,s),e.child)}function lN(t,e,r,n,s){if(t===null){var a=r.type;return typeof a=="function"&&!Kk(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=a,yP(t,e,a,n,s)):(t=Dx(r.type,null,n,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(a=t.child,!(t.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:cg,r(i,n)&&t.ref===e.ref)return xl(t,e,s)}return e.flags|=1,t=fc(a,n),t.ref=e.ref,t.return=e,e.child=t}function yP(t,e,r,n,s){if(t!==null){var a=t.memoizedProps;if(cg(a,n)&&t.ref===e.ref)if(ka=!1,e.pendingProps=n=a,(t.lanes&s)!==0)t.flags&131072&&(ka=!0);else return e.lanes=t.lanes,xl(t,e,s)}return xb(t,e,r,n,s)}function vP(t,e,r){var n=e.pendingProps,s=n.children,a=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Vr(uf,Ma),Ma|=r;else{if(!(r&1073741824))return t=a!==null?a.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Vr(uf,Ma),Ma|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,Vr(uf,Ma),Ma|=n}else a!==null?(n=a.baseLanes|r,e.memoizedState=null):n=r,Vr(uf,Ma),Ma|=n;return ra(t,e,s,r),e.child}function wP(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function xb(t,e,r,n,s){var a=Ea(r)?Du:Ys.current;return a=Lf(e,a),kf(e,s),r=Ik(t,e,r,n,a,s),n=Ok(),t!==null&&!ka?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,xl(t,e,s)):(sn&&n&&kk(e),e.flags|=1,ra(t,e,r,s),e.child)}function cN(t,e,r,n,s){if(Ea(r)){var a=!0;n1(e)}else a=!1;if(kf(e,s),e.stateNode===null)jx(t,e),mP(e,r,n),mb(e,r,n,s),n=!0;else if(t===null){var i=e.stateNode,o=e.memoizedProps;i.props=o;var l=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=Si(u):(u=Ea(r)?Du:Ys.current,u=Lf(e,u));var d=r.getDerivedStateFromProps,g=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";g||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==u)&&nN(e,i,n,u),Kl=!1;var h=e.memoizedState;i.state=h,l1(e,n,i,s),l=e.memoizedState,o!==n||h!==l||Ta.current||Kl?(typeof d=="function"&&(gb(e,r,d,n),l=e.memoizedState),(o=Kl||rN(e,r,o,n,h,l,u))?(g||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=l),i.props=n,i.state=l,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{i=e.stateNode,XF(t,e),o=e.memoizedProps,u=e.type===e.elementType?o:Bi(e.type,o),i.props=u,g=e.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Si(l):(l=Ea(r)?Du:Ys.current,l=Lf(e,l));var p=r.getDerivedStateFromProps;(d=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==g||h!==l)&&nN(e,i,n,l),Kl=!1,h=e.memoizedState,i.state=h,l1(e,n,i,s);var x=e.memoizedState;o!==g||h!==x||Ta.current||Kl?(typeof p=="function"&&(gb(e,r,p,n),x=e.memoizedState),(u=Kl||rN(e,r,u,n,h,x,l)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,x,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,x,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=x),i.props=n,i.state=x,i.context=l,n=u):(typeof i.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),n=!1)}return yb(t,e,r,n,a,s)}function yb(t,e,r,n,s,a){wP(t,e);var i=(e.flags&128)!==0;if(!n&&!i)return s&&X3(e,r,!1),xl(t,e,a);n=e.stateNode,qU.current=e;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&i?(e.child=Uf(e,t.child,null,a),e.child=Uf(e,null,o,a)):ra(t,e,o,a),e.memoizedState=n.state,s&&X3(e,r,!0),e.child}function _P(t){var e=t.stateNode;e.pendingContext?K3(t,e.pendingContext,e.pendingContext!==e.context):e.context&&K3(t,e.context,!1),Pk(t,e.containerInfo)}function uN(t,e,r,n,s){return Bf(),Tk(s),e.flags|=256,ra(t,e,r,n),e.child}var vb={dehydrated:null,treeContext:null,retryLane:0};function wb(t){return{baseLanes:t,cachePool:null,transitions:null}}function bP(t,e,r){var n=e.pendingProps,s=fn.current,a=!1,i=(e.flags&128)!==0,o;if((o=i)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(a=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Vr(fn,s&1),t===null)return fb(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=n.children,t=n.fallback,a?(n=e.mode,a=e.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=wy(i,n,0,null),t=_u(t,n,r,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=wb(r),e.memoizedState=vb,t):Uk(e,i));if(s=t.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return ZU(t,e,i,n,o,s,r);if(a){a=n.fallback,i=e.mode,s=t.child,o=s.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&e.child!==s?(n=e.child,n.childLanes=0,n.pendingProps=l,e.deletions=null):(n=fc(s,l),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=fc(o,a):(a=_u(a,i,r,null),a.flags|=2),a.return=e,n.return=e,n.sibling=a,e.child=n,n=a,a=e.child,i=t.child.memoizedState,i=i===null?wb(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=t.childLanes&~r,e.memoizedState=vb,n}return a=t.child,t=a.sibling,n=fc(a,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function Uk(t,e){return e=wy({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $p(t,e,r,n){return n!==null&&Tk(n),Uf(e,t.child,null,r),t=Uk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function ZU(t,e,r,n,s,a,i){if(r)return e.flags&256?(e.flags&=-257,n=T_(Error(vt(422))),$p(t,e,i,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(a=n.fallback,s=e.mode,n=wy({mode:"visible",children:n.children},s,0,null),a=_u(a,s,i,null),a.flags|=2,n.return=e,a.return=e,n.sibling=a,e.child=n,e.mode&1&&Uf(e,t.child,null,i),e.child.memoizedState=wb(i),e.memoizedState=vb,a);if(!(e.mode&1))return $p(t,e,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(vt(419)),n=T_(a,n,void 0),$p(t,e,i,n)}if(o=(i&t.childLanes)!==0,ka||o){if(n=xs,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,pl(t,s),Xi(n,t,s,-1))}return Vk(),n=T_(Error(vt(421))),$p(t,e,i,n)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=f$.bind(null,t),s._reactRetry=e,null):(t=a.treeContext,$a=lc(s.nextSibling),Wa=e,sn=!0,Wi=null,t!==null&&(mi[pi++]=sl,mi[pi++]=al,mi[pi++]=Ru,sl=t.id,al=t.overflow,Ru=e),e=Uk(e,n.children),e.flags|=4096,e)}function dN(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),hb(t.return,e,r)}function E_(t,e,r,n,s){var a=t.memoizedState;a===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=e,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function SP(t,e,r){var n=e.pendingProps,s=n.revealOrder,a=n.tail;if(ra(t,e,n.children,r),n=fn.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&dN(t,r,e);else if(t.tag===19)dN(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Vr(fn,n),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(r=e.child,s=null;r!==null;)t=r.alternate,t!==null&&c1(t)===null&&(s=r),r=r.sibling;r=s,r===null?(s=e.child,e.child=null):(s=r.sibling,r.sibling=null),E_(e,!1,s,r,a);break;case"backwards":for(r=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&c1(t)===null){e.child=s;break}t=s.sibling,s.sibling=r,r=s,s=t}E_(e,!0,r,null,a);break;case"together":E_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function jx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xl(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),Iu|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(vt(153));if(e.child!==null){for(t=e.child,r=fc(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=fc(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function e$(t,e,r){switch(e.tag){case 3:_P(e),Bf();break;case 5:YF(e);break;case 1:Ea(e.type)&&n1(e);break;case 4:Pk(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,s=e.memoizedProps.value;Vr(i1,n._currentValue),n._currentValue=s;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Vr(fn,fn.current&1),e.flags|=128,null):r&e.child.childLanes?bP(t,e,r):(Vr(fn,fn.current&1),t=xl(t,e,r),t!==null?t.sibling:null);Vr(fn,fn.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return SP(t,e,r);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Vr(fn,fn.current),n)break;return null;case 22:case 23:return e.lanes=0,vP(t,e,r)}return xl(t,e,r)}var kP,_b,CP,TP;kP=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};_b=function(){};CP=function(t,e,r,n){var s=t.memoizedProps;if(s!==n){t=e.stateNode,mu(No.current);var a=null;switch(r){case"input":s=H2(t,s),n=H2(t,n),a=[];break;case"select":s=xn({},s,{value:void 0}),n=xn({},n,{value:void 0}),a=[];break;case"textarea":s=V2(t,s),n=V2(t,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=t1)}X2(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(rg.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(rg.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Xr("scroll",t),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(e.updateQueue=u)&&(e.flags|=4)}};TP=function(t,e,r,n){r!==n&&(e.flags|=4)};function a0(t,e){if(!sn)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Os(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function t$(t,e,r){var n=e.pendingProps;switch(Ck(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Os(e),null;case 1:return Ea(e.type)&&r1(),Os(e),null;case 3:return n=e.stateNode,$f(),Qr(Ta),Qr(Ys),Rk(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Bp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Wi!==null&&(Ab(Wi),Wi=null))),_b(t,e),Os(e),null;case 5:Dk(e);var s=mu(gg.current);if(r=e.type,t!==null&&e.stateNode!=null)CP(t,e,r,n,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(vt(166));return Os(e),null}if(t=mu(No.current),Bp(e)){n=e.stateNode,r=e.type;var a=e.memoizedProps;switch(n[bo]=e,n[fg]=a,t=(e.mode&1)!==0,r){case"dialog":Xr("cancel",n),Xr("close",n);break;case"iframe":case"object":case"embed":Xr("load",n);break;case"video":case"audio":for(s=0;s<_0.length;s++)Xr(_0[s],n);break;case"source":Xr("error",n);break;case"img":case"image":case"link":Xr("error",n),Xr("load",n);break;case"details":Xr("toggle",n);break;case"input":w3(n,a),Xr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Xr("invalid",n);break;case"textarea":b3(n,a),Xr("invalid",n)}X2(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Lp(n.textContent,o,t),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Lp(n.textContent,o,t),s=["children",""+o]):rg.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Xr("scroll",n)}switch(r){case"input":jp(n),_3(n,a,!0);break;case"textarea":jp(n),S3(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=t1)}n=s,e.updateQueue=n,n!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=eF(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[bo]=e,t[fg]=n,kP(t,e,!1,!1),e.stateNode=t;e:{switch(i=Y2(r,n),r){case"dialog":Xr("cancel",t),Xr("close",t),s=n;break;case"iframe":case"object":case"embed":Xr("load",t),s=n;break;case"video":case"audio":for(s=0;s<_0.length;s++)Xr(_0[s],t);s=n;break;case"source":Xr("error",t),s=n;break;case"img":case"image":case"link":Xr("error",t),Xr("load",t),s=n;break;case"details":Xr("toggle",t),s=n;break;case"input":w3(t,n),s=H2(t,n),Xr("invalid",t);break;case"option":s=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},s=xn({},n,{value:void 0}),Xr("invalid",t);break;case"textarea":b3(t,n),s=V2(t,n),Xr("invalid",t);break;default:s=n}X2(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?nF(t,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&tF(t,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&ng(t,l):typeof l=="number"&&ng(t,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(rg.hasOwnProperty(a)?l!=null&&a==="onScroll"&&Xr("scroll",t):l!=null&&uk(t,a,l,i))}switch(r){case"input":jp(t),_3(t,n,!1);break;case"textarea":jp(t),S3(t);break;case"option":n.value!=null&&t.setAttribute("value",""+yc(n.value));break;case"select":t.multiple=!!n.multiple,a=n.value,a!=null?wf(t,!!n.multiple,a,!1):n.defaultValue!=null&&wf(t,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=t1)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Os(e),null;case 6:if(t&&e.stateNode!=null)TP(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(vt(166));if(r=mu(gg.current),mu(No.current),Bp(e)){if(n=e.stateNode,r=e.memoizedProps,n[bo]=e,(a=n.nodeValue!==r)&&(t=Wa,t!==null))switch(t.tag){case 3:Lp(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Lp(n.nodeValue,r,(t.mode&1)!==0)}a&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[bo]=e,e.stateNode=n}return Os(e),null;case 13:if(Qr(fn),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(sn&&$a!==null&&e.mode&1&&!(e.flags&128))zF(),Bf(),e.flags|=98560,a=!1;else if(a=Bp(e),n!==null&&n.dehydrated!==null){if(t===null){if(!a)throw Error(vt(318));if(a=e.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(vt(317));a[bo]=e}else Bf(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Os(e),a=!1}else Wi!==null&&(Ab(Wi),Wi=null),a=!0;if(!a)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||fn.current&1?ts===0&&(ts=3):Vk())),e.updateQueue!==null&&(e.flags|=4),Os(e),null);case 4:return $f(),_b(t,e),t===null&&ug(e.stateNode.containerInfo),Os(e),null;case 10:return Ak(e.type._context),Os(e),null;case 17:return Ea(e.type)&&r1(),Os(e),null;case 19:if(Qr(fn),a=e.memoizedState,a===null)return Os(e),null;if(n=(e.flags&128)!==0,i=a.rendering,i===null)if(n)a0(a,!1);else{if(ts!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=c1(t),i!==null){for(e.flags|=128,a0(a,!1),n=i.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)a=r,t=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=t,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,t=i.dependencies,a.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Vr(fn,fn.current&1|2),e.child}t=t.sibling}a.tail!==null&&In()>Hf&&(e.flags|=128,n=!0,a0(a,!1),e.lanes=4194304)}else{if(!n)if(t=c1(i),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),a0(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!sn)return Os(e),null}else 2*In()-a.renderingStartTime>Hf&&r!==1073741824&&(e.flags|=128,n=!0,a0(a,!1),e.lanes=4194304);a.isBackwards?(i.sibling=e.child,e.child=i):(r=a.last,r!==null?r.sibling=i:e.child=i,a.last=i)}return a.tail!==null?(e=a.tail,a.rendering=e,a.tail=e.sibling,a.renderingStartTime=In(),e.sibling=null,r=fn.current,Vr(fn,n?r&1|2:r&1),e):(Os(e),null);case 22:case 23:return Gk(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?Ma&1073741824&&(Os(e),e.subtreeFlags&6&&(e.flags|=8192)):Os(e),null;case 24:return null;case 25:return null}throw Error(vt(156,e.tag))}function r$(t,e){switch(Ck(e),e.tag){case 1:return Ea(e.type)&&r1(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $f(),Qr(Ta),Qr(Ys),Rk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Dk(e),null;case 13:if(Qr(fn),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(vt(340));Bf()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qr(fn),null;case 4:return $f(),null;case 10:return Ak(e.type._context),null;case 22:case 23:return Gk(),null;case 24:return null;default:return null}}var Wp=!1,Ws=!1,n$=typeof WeakSet=="function"?WeakSet:Set,Ot=null;function cf(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Tn(t,e,n)}else r.current=null}function bb(t,e,r){try{r()}catch(n){Tn(t,e,n)}}var fN=!1;function s$(t,e){if(ab=qx,t=FF(),Sk(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,u=0,d=0,g=t,h=null;t:for(;;){for(var p;g!==r||s!==0&&g.nodeType!==3||(o=i+s),g!==a||n!==0&&g.nodeType!==3||(l=i+n),g.nodeType===3&&(i+=g.nodeValue.length),(p=g.firstChild)!==null;)h=g,g=p;for(;;){if(g===t)break t;if(h===r&&++u===s&&(o=i),h===a&&++d===n&&(l=i),(p=g.nextSibling)!==null)break;g=h,h=g.parentNode}g=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ib={focusedElem:t,selectionRange:r},qx=!1,Ot=e;Ot!==null;)if(e=Ot,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Ot=t;else for(;Ot!==null;){e=Ot;try{var x=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var v=x.memoizedProps,w=x.memoizedState,S=e.stateNode,_=S.getSnapshotBeforeUpdate(e.elementType===e.type?v:Bi(e.type,v),w);S.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var y=e.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(vt(163))}}catch(k){Tn(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,Ot=t;break}Ot=e.return}return x=fN,fN=!1,x}function M0(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&t)===t){var a=s.destroy;s.destroy=void 0,a!==void 0&&bb(e,r,a)}s=s.next}while(s!==n)}}function yy(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Sb(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function EP(t){var e=t.alternate;e!==null&&(t.alternate=null,EP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[bo],delete e[fg],delete e[cb],delete e[UU],delete e[$U])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function NP(t){return t.tag===5||t.tag===3||t.tag===4}function hN(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||NP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function kb(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=t1));else if(n!==4&&(t=t.child,t!==null))for(kb(t,e,r),t=t.sibling;t!==null;)kb(t,e,r),t=t.sibling}function Cb(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Cb(t,e,r),t=t.sibling;t!==null;)Cb(t,e,r),t=t.sibling}var _s=null,$i=!1;function $l(t,e,r){for(r=r.child;r!==null;)AP(t,e,r),r=r.sibling}function AP(t,e,r){if(Eo&&typeof Eo.onCommitFiberUnmount=="function")try{Eo.onCommitFiberUnmount(uy,r)}catch{}switch(r.tag){case 5:Ws||cf(r,e);case 6:var n=_s,s=$i;_s=null,$l(t,e,r),_s=n,$i=s,_s!==null&&($i?(t=_s,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):_s.removeChild(r.stateNode));break;case 18:_s!==null&&($i?(t=_s,r=r.stateNode,t.nodeType===8?w_(t.parentNode,r):t.nodeType===1&&w_(t,r),og(t)):w_(_s,r.stateNode));break;case 4:n=_s,s=$i,_s=r.stateNode.containerInfo,$i=!0,$l(t,e,r),_s=n,$i=s;break;case 0:case 11:case 14:case 15:if(!Ws&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&bb(r,e,i),s=s.next}while(s!==n)}$l(t,e,r);break;case 1:if(!Ws&&(cf(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Tn(r,e,o)}$l(t,e,r);break;case 21:$l(t,e,r);break;case 22:r.mode&1?(Ws=(n=Ws)||r.memoizedState!==null,$l(t,e,r),Ws=n):$l(t,e,r);break;default:$l(t,e,r)}}function gN(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new n$),e.forEach(function(n){var s=h$.bind(null,t,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ri(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=t,i=e,o=i;e:for(;o!==null;){switch(o.tag){case 5:_s=o.stateNode,$i=!1;break e;case 3:_s=o.stateNode.containerInfo,$i=!0;break e;case 4:_s=o.stateNode.containerInfo,$i=!0;break e}o=o.return}if(_s===null)throw Error(vt(160));AP(a,i,s),_s=null,$i=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Tn(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jP(e,t),e=e.sibling}function jP(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ri(e,t),go(t),n&4){try{M0(3,t,t.return),yy(3,t)}catch(v){Tn(t,t.return,v)}try{M0(5,t,t.return)}catch(v){Tn(t,t.return,v)}}break;case 1:Ri(e,t),go(t),n&512&&r!==null&&cf(r,r.return);break;case 5:if(Ri(e,t),go(t),n&512&&r!==null&&cf(r,r.return),t.flags&32){var s=t.stateNode;try{ng(s,"")}catch(v){Tn(t,t.return,v)}}if(n&4&&(s=t.stateNode,s!=null)){var a=t.memoizedProps,i=r!==null?r.memoizedProps:a,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&qj(s,a),Y2(o,i);var u=Y2(o,a);for(i=0;i<l.length;i+=2){var d=l[i],g=l[i+1];d==="style"?nF(s,g):d==="dangerouslySetInnerHTML"?tF(s,g):d==="children"?ng(s,g):uk(s,d,g,u)}switch(o){case"input":z2(s,a);break;case"textarea":Zj(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?wf(s,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?wf(s,!!a.multiple,a.defaultValue,!0):wf(s,!!a.multiple,a.multiple?[]:"",!1))}s[fg]=a}catch(v){Tn(t,t.return,v)}}break;case 6:if(Ri(e,t),go(t),n&4){if(t.stateNode===null)throw Error(vt(162));s=t.stateNode,a=t.memoizedProps;try{s.nodeValue=a}catch(v){Tn(t,t.return,v)}}break;case 3:if(Ri(e,t),go(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{og(e.containerInfo)}catch(v){Tn(t,t.return,v)}break;case 4:Ri(e,t),go(t);break;case 13:Ri(e,t),go(t),s=t.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Hk=In())),n&4&&gN(t);break;case 22:if(d=r!==null&&r.memoizedState!==null,t.mode&1?(Ws=(u=Ws)||d,Ri(e,t),Ws=u):Ri(e,t),go(t),n&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(Ot=t,d=t.child;d!==null;){for(g=Ot=d;Ot!==null;){switch(h=Ot,p=h.child,h.tag){case 0:case 11:case 14:case 15:M0(4,h,h.return);break;case 1:cf(h,h.return);var x=h.stateNode;if(typeof x.componentWillUnmount=="function"){n=h,r=h.return;try{e=n,x.props=e.memoizedProps,x.state=e.memoizedState,x.componentWillUnmount()}catch(v){Tn(n,r,v)}}break;case 5:cf(h,h.return);break;case 22:if(h.memoizedState!==null){pN(g);continue}}p!==null?(p.return=h,Ot=p):pN(g)}d=d.sibling}e:for(d=null,g=t;;){if(g.tag===5){if(d===null){d=g;try{s=g.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=g.stateNode,l=g.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=rF("display",i))}catch(v){Tn(t,t.return,v)}}}else if(g.tag===6){if(d===null)try{g.stateNode.nodeValue=u?"":g.memoizedProps}catch(v){Tn(t,t.return,v)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===t)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===t)break e;for(;g.sibling===null;){if(g.return===null||g.return===t)break e;d===g&&(d=null),g=g.return}d===g&&(d=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Ri(e,t),go(t),n&4&&gN(t);break;case 21:break;default:Ri(e,t),go(t)}}function go(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(NP(r)){var n=r;break e}r=r.return}throw Error(vt(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(ng(s,""),n.flags&=-33);var a=hN(t);Cb(t,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=hN(t);kb(t,o,i);break;default:throw Error(vt(161))}}catch(l){Tn(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function a$(t,e,r){Ot=t,FP(t)}function FP(t,e,r){for(var n=(t.mode&1)!==0;Ot!==null;){var s=Ot,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Wp;if(!i){var o=s.alternate,l=o!==null&&o.memoizedState!==null||Ws;o=Wp;var u=Ws;if(Wp=i,(Ws=l)&&!u)for(Ot=s;Ot!==null;)i=Ot,l=i.child,i.tag===22&&i.memoizedState!==null?xN(s):l!==null?(l.return=i,Ot=l):xN(s);for(;a!==null;)Ot=a,FP(a),a=a.sibling;Ot=s,Wp=o,Ws=u}mN(t)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Ot=a):mN(t)}}function mN(t){for(;Ot!==null;){var e=Ot;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ws||yy(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ws)if(r===null)n.componentDidMount();else{var s=e.elementType===e.type?r.memoizedProps:Bi(e.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=e.updateQueue;a!==null&&Z3(e,a,n);break;case 3:var i=e.updateQueue;if(i!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Z3(e,i,r)}break;case 5:var o=e.stateNode;if(r===null&&e.flags&4){r=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var g=d.dehydrated;g!==null&&og(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(vt(163))}Ws||e.flags&512&&Sb(e)}catch(h){Tn(e,e.return,h)}}if(e===t){Ot=null;break}if(r=e.sibling,r!==null){r.return=e.return,Ot=r;break}Ot=e.return}}function pN(t){for(;Ot!==null;){var e=Ot;if(e===t){Ot=null;break}var r=e.sibling;if(r!==null){r.return=e.return,Ot=r;break}Ot=e.return}}function xN(t){for(;Ot!==null;){var e=Ot;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{yy(4,e)}catch(l){Tn(e,r,l)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var s=e.return;try{n.componentDidMount()}catch(l){Tn(e,s,l)}}var a=e.return;try{Sb(e)}catch(l){Tn(e,a,l)}break;case 5:var i=e.return;try{Sb(e)}catch(l){Tn(e,i,l)}}}catch(l){Tn(e,e.return,l)}if(e===t){Ot=null;break}var o=e.sibling;if(o!==null){o.return=e.return,Ot=o;break}Ot=e.return}}var i$=Math.ceil,f1=Sl.ReactCurrentDispatcher,$k=Sl.ReactCurrentOwner,wi=Sl.ReactCurrentBatchConfig,br=0,xs=null,Vn=null,Ns=0,Ma=0,uf=jc(0),ts=0,yg=null,Iu=0,vy=0,Wk=0,I0=null,_a=null,Hk=0,Hf=1/0,Zo=null,h1=!1,Tb=null,uc=null,Hp=!1,ql=null,g1=0,O0=0,Eb=null,Fx=-1,Px=0;function oa(){return br&6?In():Fx!==-1?Fx:Fx=In()}function dc(t){return t.mode&1?br&2&&Ns!==0?Ns&-Ns:HU.transition!==null?(Px===0&&(Px=mF()),Px):(t=Lr,t!==0||(t=window.event,t=t===void 0?16:bF(t.type)),t):1}function Xi(t,e,r,n){if(50<O0)throw O0=0,Eb=null,Error(vt(185));em(t,r,n),(!(br&2)||t!==xs)&&(t===xs&&(!(br&2)&&(vy|=r),ts===4&&Jl(t,Ns)),Na(t,n),r===1&&br===0&&!(e.mode&1)&&(Hf=In()+500,my&&Fc()))}function Na(t,e){var r=t.callbackNode;HB(t,e);var n=Qx(t,t===xs?Ns:0);if(n===0)r!==null&&T3(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&T3(r),e===1)t.tag===0?WU(yN.bind(null,t)):$F(yN.bind(null,t)),LU(function(){!(br&6)&&Fc()}),r=null;else{switch(pF(n)){case 1:r=mk;break;case 4:r=hF;break;case 16:r=Jx;break;case 536870912:r=gF;break;default:r=Jx}r=BP(r,PP.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function PP(t,e){if(Fx=-1,Px=0,br&6)throw Error(vt(327));var r=t.callbackNode;if(Cf()&&t.callbackNode!==r)return null;var n=Qx(t,t===xs?Ns:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=m1(t,n);else{e=n;var s=br;br|=2;var a=RP();(xs!==t||Ns!==e)&&(Zo=null,Hf=In()+500,wu(t,e));do try{c$();break}catch(o){DP(t,o)}while(!0);Nk(),f1.current=a,br=s,Vn!==null?e=0:(xs=null,Ns=0,e=ts)}if(e!==0){if(e===2&&(s=eb(t),s!==0&&(n=s,e=Nb(t,s))),e===1)throw r=yg,wu(t,0),Jl(t,n),Na(t,In()),r;if(e===6)Jl(t,n);else{if(s=t.current.alternate,!(n&30)&&!o$(s)&&(e=m1(t,n),e===2&&(a=eb(t),a!==0&&(n=a,e=Nb(t,a))),e===1))throw r=yg,wu(t,0),Jl(t,n),Na(t,In()),r;switch(t.finishedWork=s,t.finishedLanes=n,e){case 0:case 1:throw Error(vt(345));case 2:lu(t,_a,Zo);break;case 3:if(Jl(t,n),(n&130023424)===n&&(e=Hk+500-In(),10<e)){if(Qx(t,0)!==0)break;if(s=t.suspendedLanes,(s&n)!==n){oa(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=lb(lu.bind(null,t,_a,Zo),e);break}lu(t,_a,Zo);break;case 4:if(Jl(t,n),(n&4194240)===n)break;for(e=t.eventTimes,s=-1;0<n;){var i=31-Ki(n);a=1<<i,i=e[i],i>s&&(s=i),n&=~a}if(n=s,n=In()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*i$(n/1960))-n,10<n){t.timeoutHandle=lb(lu.bind(null,t,_a,Zo),n);break}lu(t,_a,Zo);break;case 5:lu(t,_a,Zo);break;default:throw Error(vt(329))}}}return Na(t,In()),t.callbackNode===r?PP.bind(null,t):null}function Nb(t,e){var r=I0;return t.current.memoizedState.isDehydrated&&(wu(t,e).flags|=256),t=m1(t,e),t!==2&&(e=_a,_a=r,e!==null&&Ab(e)),t}function Ab(t){_a===null?_a=t:_a.push.apply(_a,t)}function o$(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!Zi(a(),s))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Jl(t,e){for(e&=~Wk,e&=~vy,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Ki(e),n=1<<r;t[r]=-1,e&=~n}}function yN(t){if(br&6)throw Error(vt(327));Cf();var e=Qx(t,0);if(!(e&1))return Na(t,In()),null;var r=m1(t,e);if(t.tag!==0&&r===2){var n=eb(t);n!==0&&(e=n,r=Nb(t,n))}if(r===1)throw r=yg,wu(t,0),Jl(t,e),Na(t,In()),r;if(r===6)throw Error(vt(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lu(t,_a,Zo),Na(t,In()),null}function zk(t,e){var r=br;br|=1;try{return t(e)}finally{br=r,br===0&&(Hf=In()+500,my&&Fc())}}function Ou(t){ql!==null&&ql.tag===0&&!(br&6)&&Cf();var e=br;br|=1;var r=wi.transition,n=Lr;try{if(wi.transition=null,Lr=1,t)return t()}finally{Lr=n,wi.transition=r,br=e,!(br&6)&&Fc()}}function Gk(){Ma=uf.current,Qr(uf)}function wu(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,OU(r)),Vn!==null)for(r=Vn.return;r!==null;){var n=r;switch(Ck(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&r1();break;case 3:$f(),Qr(Ta),Qr(Ys),Rk();break;case 5:Dk(n);break;case 4:$f();break;case 13:Qr(fn);break;case 19:Qr(fn);break;case 10:Ak(n.type._context);break;case 22:case 23:Gk()}r=r.return}if(xs=t,Vn=t=fc(t.current,null),Ns=Ma=e,ts=0,yg=null,Wk=vy=Iu=0,_a=I0=null,gu!==null){for(e=0;e<gu.length;e++)if(r=gu[e],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}gu=null}return t}function DP(t,e){do{var r=Vn;try{if(Nk(),Nx.current=d1,u1){for(var n=pn.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}u1=!1}if(Mu=0,ds=Qn=pn=null,R0=!1,mg=0,$k.current=null,r===null||r.return===null){ts=1,yg=e,Vn=null;break}e:{var a=t,i=r.return,o=r,l=e;if(e=Ns,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,d=o,g=d.tag;if(!(d.mode&1)&&(g===0||g===11||g===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=aN(i);if(p!==null){p.flags&=-257,iN(p,i,o,a,e),p.mode&1&&sN(a,u,e),e=p,l=u;var x=e.updateQueue;if(x===null){var v=new Set;v.add(l),e.updateQueue=v}else x.add(l);break e}else{if(!(e&1)){sN(a,u,e),Vk();break e}l=Error(vt(426))}}else if(sn&&o.mode&1){var w=aN(i);if(w!==null){!(w.flags&65536)&&(w.flags|=256),iN(w,i,o,a,e),Tk(Wf(l,o));break e}}a=l=Wf(l,o),ts!==4&&(ts=2),I0===null?I0=[a]:I0.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,e&=-e,a.lanes|=e;var S=pP(a,l,e);q3(a,S);break e;case 1:o=l;var _=a.type,y=a.stateNode;if(!(a.flags&128)&&(typeof _.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(uc===null||!uc.has(y)))){a.flags|=65536,e&=-e,a.lanes|=e;var k=xP(a,o,e);q3(a,k);break e}}a=a.return}while(a!==null)}IP(r)}catch(N){e=N,Vn===r&&r!==null&&(Vn=r=r.return);continue}break}while(!0)}function RP(){var t=f1.current;return f1.current=d1,t===null?d1:t}function Vk(){(ts===0||ts===3||ts===2)&&(ts=4),xs===null||!(Iu&268435455)&&!(vy&268435455)||Jl(xs,Ns)}function m1(t,e){var r=br;br|=2;var n=RP();(xs!==t||Ns!==e)&&(Zo=null,wu(t,e));do try{l$();break}catch(s){DP(t,s)}while(!0);if(Nk(),br=r,f1.current=n,Vn!==null)throw Error(vt(261));return xs=null,Ns=0,ts}function l$(){for(;Vn!==null;)MP(Vn)}function c$(){for(;Vn!==null&&!RB();)MP(Vn)}function MP(t){var e=LP(t.alternate,t,Ma);t.memoizedProps=t.pendingProps,e===null?IP(t):Vn=e,$k.current=null}function IP(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=r$(r,e),r!==null){r.flags&=32767,Vn=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ts=6,Vn=null;return}}else if(r=t$(r,e,Ma),r!==null){Vn=r;return}if(e=e.sibling,e!==null){Vn=e;return}Vn=e=t}while(e!==null);ts===0&&(ts=5)}function lu(t,e,r){var n=Lr,s=wi.transition;try{wi.transition=null,Lr=1,u$(t,e,r,n)}finally{wi.transition=s,Lr=n}return null}function u$(t,e,r,n){do Cf();while(ql!==null);if(br&6)throw Error(vt(327));r=t.finishedWork;var s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(vt(177));t.callbackNode=null,t.callbackPriority=0;var a=r.lanes|r.childLanes;if(zB(t,a),t===xs&&(Vn=xs=null,Ns=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Hp||(Hp=!0,BP(Jx,function(){return Cf(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=wi.transition,wi.transition=null;var i=Lr;Lr=1;var o=br;br|=4,$k.current=null,s$(t,r),jP(r,t),jU(ib),qx=!!ab,ib=ab=null,t.current=r,a$(r),MB(),br=o,Lr=i,wi.transition=a}else t.current=r;if(Hp&&(Hp=!1,ql=t,g1=s),a=t.pendingLanes,a===0&&(uc=null),LB(r.stateNode),Na(t,In()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)s=e[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(h1)throw h1=!1,t=Tb,Tb=null,t;return g1&1&&t.tag!==0&&Cf(),a=t.pendingLanes,a&1?t===Eb?O0++:(O0=0,Eb=t):O0=0,Fc(),null}function Cf(){if(ql!==null){var t=pF(g1),e=wi.transition,r=Lr;try{if(wi.transition=null,Lr=16>t?16:t,ql===null)var n=!1;else{if(t=ql,ql=null,g1=0,br&6)throw Error(vt(331));var s=br;for(br|=4,Ot=t.current;Ot!==null;){var a=Ot,i=a.child;if(Ot.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(Ot=u;Ot!==null;){var d=Ot;switch(d.tag){case 0:case 11:case 15:M0(8,d,a)}var g=d.child;if(g!==null)g.return=d,Ot=g;else for(;Ot!==null;){d=Ot;var h=d.sibling,p=d.return;if(EP(d),d===u){Ot=null;break}if(h!==null){h.return=p,Ot=h;break}Ot=p}}}var x=a.alternate;if(x!==null){var v=x.child;if(v!==null){x.child=null;do{var w=v.sibling;v.sibling=null,v=w}while(v!==null)}}Ot=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Ot=i;else e:for(;Ot!==null;){if(a=Ot,a.flags&2048)switch(a.tag){case 0:case 11:case 15:M0(9,a,a.return)}var S=a.sibling;if(S!==null){S.return=a.return,Ot=S;break e}Ot=a.return}}var _=t.current;for(Ot=_;Ot!==null;){i=Ot;var y=i.child;if(i.subtreeFlags&2064&&y!==null)y.return=i,Ot=y;else e:for(i=_;Ot!==null;){if(o=Ot,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:yy(9,o)}}catch(N){Tn(o,o.return,N)}if(o===i){Ot=null;break e}var k=o.sibling;if(k!==null){k.return=o.return,Ot=k;break e}Ot=o.return}}if(br=s,Fc(),Eo&&typeof Eo.onPostCommitFiberRoot=="function")try{Eo.onPostCommitFiberRoot(uy,t)}catch{}n=!0}return n}finally{Lr=r,wi.transition=e}}return!1}function vN(t,e,r){e=Wf(r,e),e=pP(t,e,1),t=cc(t,e,1),e=oa(),t!==null&&(em(t,1,e),Na(t,e))}function Tn(t,e,r){if(t.tag===3)vN(t,t,r);else for(;e!==null;){if(e.tag===3){vN(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(uc===null||!uc.has(n))){t=Wf(r,t),t=xP(e,t,1),e=cc(e,t,1),t=oa(),e!==null&&(em(e,1,t),Na(e,t));break}}e=e.return}}function d$(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=oa(),t.pingedLanes|=t.suspendedLanes&r,xs===t&&(Ns&r)===r&&(ts===4||ts===3&&(Ns&130023424)===Ns&&500>In()-Hk?wu(t,0):Wk|=r),Na(t,e)}function OP(t,e){e===0&&(t.mode&1?(e=Dp,Dp<<=1,!(Dp&130023424)&&(Dp=4194304)):e=1);var r=oa();t=pl(t,e),t!==null&&(em(t,e,r),Na(t,r))}function f$(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),OP(t,r)}function h$(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,s=t.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(vt(314))}n!==null&&n.delete(e),OP(t,r)}var LP;LP=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ta.current)ka=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ka=!1,e$(t,e,r);ka=!!(t.flags&131072)}else ka=!1,sn&&e.flags&1048576&&WF(e,a1,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;jx(t,e),t=e.pendingProps;var s=Lf(e,Ys.current);kf(e,r),s=Ik(null,e,n,t,s,r);var a=Ok();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ea(n)?(a=!0,n1(e)):a=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Fk(e),s.updater=xy,e.stateNode=s,s._reactInternals=e,mb(e,n,t,r),e=yb(null,e,n,!0,a,r)):(e.tag=0,sn&&a&&kk(e),ra(null,e,s,r),e=e.child),e;case 16:n=e.elementType;e:{switch(jx(t,e),t=e.pendingProps,s=n._init,n=s(n._payload),e.type=n,s=e.tag=m$(n),t=Bi(n,t),s){case 0:e=xb(null,e,n,t,r);break e;case 1:e=cN(null,e,n,t,r);break e;case 11:e=oN(null,e,n,t,r);break e;case 14:e=lN(null,e,n,Bi(n.type,t),r);break e}throw Error(vt(306,n,""))}return e;case 0:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Bi(n,s),xb(t,e,n,s,r);case 1:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Bi(n,s),cN(t,e,n,s,r);case 3:e:{if(_P(e),t===null)throw Error(vt(387));n=e.pendingProps,a=e.memoizedState,s=a.element,XF(t,e),l1(e,n,null,r);var i=e.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=a,e.memoizedState=a,e.flags&256){s=Wf(Error(vt(423)),e),e=uN(t,e,n,r,s);break e}else if(n!==s){s=Wf(Error(vt(424)),e),e=uN(t,e,n,r,s);break e}else for($a=lc(e.stateNode.containerInfo.firstChild),Wa=e,sn=!0,Wi=null,r=VF(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bf(),n===s){e=xl(t,e,r);break e}ra(t,e,n,r)}e=e.child}return e;case 5:return YF(e),t===null&&fb(e),n=e.type,s=e.pendingProps,a=t!==null?t.memoizedProps:null,i=s.children,ob(n,s)?i=null:a!==null&&ob(n,a)&&(e.flags|=32),wP(t,e),ra(t,e,i,r),e.child;case 6:return t===null&&fb(e),null;case 13:return bP(t,e,r);case 4:return Pk(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=Uf(e,null,n,r):ra(t,e,n,r),e.child;case 11:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Bi(n,s),oN(t,e,n,s,r);case 7:return ra(t,e,e.pendingProps,r),e.child;case 8:return ra(t,e,e.pendingProps.children,r),e.child;case 12:return ra(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,s=e.pendingProps,a=e.memoizedProps,i=s.value,Vr(i1,n._currentValue),n._currentValue=i,a!==null)if(Zi(a.value,i)){if(a.children===s.children&&!Ta.current){e=xl(t,e,r);break e}}else for(a=e.child,a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=ll(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?l.next=l:(l.next=d.next,d.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),hb(a.return,r,e),o.lanes|=r;break}l=l.next}}else if(a.tag===10)i=a.type===e.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(vt(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),hb(i,r,e),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===e){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}ra(t,e,s.children,r),e=e.child}return e;case 9:return s=e.type,n=e.pendingProps.children,kf(e,r),s=Si(s),n=n(s),e.flags|=1,ra(t,e,n,r),e.child;case 14:return n=e.type,s=Bi(n,e.pendingProps),s=Bi(n.type,s),lN(t,e,n,s,r);case 15:return yP(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,s=e.pendingProps,s=e.elementType===n?s:Bi(n,s),jx(t,e),e.tag=1,Ea(n)?(t=!0,n1(e)):t=!1,kf(e,r),mP(e,n,s),mb(e,n,s,r),yb(null,e,n,!0,t,r);case 19:return SP(t,e,r);case 22:return vP(t,e,r)}throw Error(vt(156,e.tag))};function BP(t,e){return fF(t,e)}function g$(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function yi(t,e,r,n){return new g$(t,e,r,n)}function Kk(t){return t=t.prototype,!(!t||!t.isReactComponent)}function m$(t){if(typeof t=="function")return Kk(t)?1:0;if(t!=null){if(t=t.$$typeof,t===fk)return 11;if(t===hk)return 14}return 2}function fc(t,e){var r=t.alternate;return r===null?(r=yi(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function Dx(t,e,r,n,s,a){var i=2;if(n=t,typeof t=="function")Kk(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Zd:return _u(r.children,s,a,e);case dk:i=8,s|=8;break;case B2:return t=yi(12,r,e,s|2),t.elementType=B2,t.lanes=a,t;case U2:return t=yi(13,r,e,s),t.elementType=U2,t.lanes=a,t;case $2:return t=yi(19,r,e,s),t.elementType=$2,t.lanes=a,t;case Yj:return wy(r,s,a,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Kj:i=10;break e;case Xj:i=9;break e;case fk:i=11;break e;case hk:i=14;break e;case Vl:i=16,n=null;break e}throw Error(vt(130,t==null?t:typeof t,""))}return e=yi(i,r,e,s),e.elementType=t,e.type=n,e.lanes=a,e}function _u(t,e,r,n){return t=yi(7,t,n,e),t.lanes=r,t}function wy(t,e,r,n){return t=yi(22,t,n,e),t.elementType=Yj,t.lanes=r,t.stateNode={isHidden:!1},t}function N_(t,e,r){return t=yi(6,t,null,e),t.lanes=r,t}function A_(t,e,r){return e=yi(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function p$(t,e,r,n,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=c_(0),this.expirationTimes=c_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=c_(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Xk(t,e,r,n,s,a,i,o,l){return t=new p$(t,e,r,o,l),e===1?(e=1,a===!0&&(e|=8)):e=0,a=yi(3,null,null,e),t.current=a,a.stateNode=t,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fk(a),t}function x$(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:qd,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function UP(t){if(!t)return vc;t=t._reactInternals;e:{if(ad(t)!==t||t.tag!==1)throw Error(vt(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ea(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(vt(171))}if(t.tag===1){var r=t.type;if(Ea(r))return UF(t,r,e)}return e}function $P(t,e,r,n,s,a,i,o,l){return t=Xk(r,n,!0,t,s,a,i,o,l),t.context=UP(null),r=t.current,n=oa(),s=dc(r),a=ll(n,s),a.callback=e??null,cc(r,a,s),t.current.lanes=s,em(t,s,n),Na(t,n),t}function _y(t,e,r,n){var s=e.current,a=oa(),i=dc(s);return r=UP(r),e.context===null?e.context=r:e.pendingContext=r,e=ll(a,i),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=cc(s,e,i),t!==null&&(Xi(t,s,i,a),Ex(t,s,i)),i}function p1(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function wN(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function Yk(t,e){wN(t,e),(t=t.alternate)&&wN(t,e)}function y$(){return null}var WP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jk(t){this._internalRoot=t}by.prototype.render=Jk.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(vt(409));_y(t,e,null,null)};by.prototype.unmount=Jk.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ou(function(){_y(null,t,null,null)}),e[ml]=null}};function by(t){this._internalRoot=t}by.prototype.unstable_scheduleHydration=function(t){if(t){var e=vF();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Yl.length&&e!==0&&e<Yl[r].priority;r++);Yl.splice(r,0,t),r===0&&_F(t)}};function Qk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Sy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _N(){}function v$(t,e,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=p1(i);a.call(u)}}var i=$P(e,n,t,0,null,!1,!1,"",_N);return t._reactRootContainer=i,t[ml]=i.current,ug(t.nodeType===8?t.parentNode:t),Ou(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=p1(l);o.call(u)}}var l=Xk(t,0,!1,null,null,!1,!1,"",_N);return t._reactRootContainer=l,t[ml]=l.current,ug(t.nodeType===8?t.parentNode:t),Ou(function(){_y(e,l,r,n)}),l}function ky(t,e,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var l=p1(i);o.call(l)}}_y(e,i,t,s)}else i=v$(r,e,t,s,n);return p1(i)}xF=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=w0(e.pendingLanes);r!==0&&(pk(e,r|1),Na(e,In()),!(br&6)&&(Hf=In()+500,Fc()))}break;case 13:Ou(function(){var n=pl(t,1);if(n!==null){var s=oa();Xi(n,t,1,s)}}),Yk(t,1)}};xk=function(t){if(t.tag===13){var e=pl(t,134217728);if(e!==null){var r=oa();Xi(e,t,134217728,r)}Yk(t,134217728)}};yF=function(t){if(t.tag===13){var e=dc(t),r=pl(t,e);if(r!==null){var n=oa();Xi(r,t,e,n)}Yk(t,e)}};vF=function(){return Lr};wF=function(t,e){var r=Lr;try{return Lr=t,e()}finally{Lr=r}};Q2=function(t,e,r){switch(e){case"input":if(z2(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var s=gy(n);if(!s)throw Error(vt(90));Qj(n),z2(n,s)}}}break;case"textarea":Zj(t,r);break;case"select":e=r.value,e!=null&&wf(t,!!r.multiple,e,!1)}};iF=zk;oF=Ou;var w$={usingClientEntryPoint:!1,Events:[rm,nf,gy,sF,aF,zk]},i0={findFiberByHostInstance:hu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_$={bundleType:i0.bundleType,version:i0.version,rendererPackageName:i0.rendererPackageName,rendererConfig:i0.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=uF(t),t===null?null:t.stateNode},findFiberByHostInstance:i0.findFiberByHostInstance||y$,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zp.isDisabled&&zp.supportsFiber)try{uy=zp.inject(_$),Eo=zp}catch{}}Va.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=w$;Va.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Qk(e))throw Error(vt(200));return x$(t,e,null,r)};Va.createRoot=function(t,e){if(!Qk(t))throw Error(vt(299));var r=!1,n="",s=WP;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Xk(t,1,!1,null,null,r,!1,n,s),t[ml]=e.current,ug(t.nodeType===8?t.parentNode:t),new Jk(e)};Va.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(vt(188)):(t=Object.keys(t).join(","),Error(vt(268,t)));return t=uF(e),t=t===null?null:t.stateNode,t};Va.flushSync=function(t){return Ou(t)};Va.hydrate=function(t,e,r){if(!Sy(e))throw Error(vt(200));return ky(null,t,e,!0,r)};Va.hydrateRoot=function(t,e,r){if(!Qk(t))throw Error(vt(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=WP;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),e=$P(e,null,t,1,r??null,s,!1,a,i),t[ml]=e.current,ug(t),n)for(t=0;t<n.length;t++)r=n[t],s=r._getVersion,s=s(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,s]:e.mutableSourceEagerHydrationData.push(r,s);return new by(e)};Va.render=function(t,e,r){if(!Sy(e))throw Error(vt(200));return ky(null,t,e,!1,r)};Va.unmountComponentAtNode=function(t){if(!Sy(t))throw Error(vt(40));return t._reactRootContainer?(Ou(function(){ky(null,null,t,!1,function(){t._reactRootContainer=null,t[ml]=null})}),!0):!1};Va.unstable_batchedUpdates=zk;Va.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Sy(r))throw Error(vt(200));if(t==null||t._reactInternals===void 0)throw Error(vt(38));return ky(t,e,r,!1,n)};Va.version="18.3.1-next-f1338f8080-20240426";function HP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(HP)}catch(t){console.error(t)}}HP(),Hj.exports=Va;var jb=Hj.exports,bN=jb;O2.createRoot=bN.createRoot,O2.hydrateRoot=bN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vg(){return vg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},vg.apply(this,arguments)}var Zl;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Zl||(Zl={}));const SN="popstate";function b$(t){t===void 0&&(t={});function e(n,s){let{pathname:a,search:i,hash:o}=n.location;return Fb("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:GP(s)}return k$(e,r,null,t)}function Xn(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zP(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function S$(){return Math.random().toString(36).substr(2,8)}function kN(t,e){return{usr:t.state,key:t.key,idx:e}}function Fb(t,e,r,n){return r===void 0&&(r=null),vg({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?lh(e):e,{state:r,key:e&&e.key||n||S$()})}function GP(t){let{pathname:e="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function lh(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substr(n),t=t.substr(0,n)),t&&(e.pathname=t)}return e}function k$(t,e,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Zl.Pop,l=null,u=d();u==null&&(u=0,i.replaceState(vg({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function g(){o=Zl.Pop;let w=d(),S=w==null?null:w-u;u=w,l&&l({action:o,location:v.location,delta:S})}function h(w,S){o=Zl.Push;let _=Fb(v.location,w,S);u=d()+1;let y=kN(_,u),k=v.createHref(_);try{i.pushState(y,"",k)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(k)}a&&l&&l({action:o,location:v.location,delta:1})}function p(w,S){o=Zl.Replace;let _=Fb(v.location,w,S);u=d();let y=kN(_,u),k=v.createHref(_);i.replaceState(y,"",k),a&&l&&l({action:o,location:v.location,delta:0})}function x(w){let S=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof w=="string"?w:GP(w);return _=_.replace(/ $/,"%20"),Xn(S,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,S)}let v={get action(){return o},get location(){return t(s,i)},listen(w){if(l)throw new Error("A history only accepts one active listener");return s.addEventListener(SN,g),l=w,()=>{s.removeEventListener(SN,g),l=null}},createHref(w){return e(s,w)},createURL:x,encodeLocation(w){let S=x(w);return{pathname:S.pathname,search:S.search,hash:S.hash}},push:h,replace:p,go(w){return i.go(w)}};return v}var CN;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(CN||(CN={}));function C$(t,e,r){return r===void 0&&(r="/"),T$(t,e,r)}function T$(t,e,r,n){let s=typeof e=="string"?lh(e):e,a=XP(s.pathname||"/",r);if(a==null)return null;let i=VP(t);E$(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let u=B$(a);o=I$(i[l],u)}return o}function VP(t,e,r,n){e===void 0&&(e=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let l={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};l.relativePath.startsWith("/")&&(Xn(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let u=bu([n,l.relativePath]),d=r.concat(l);a.children&&a.children.length>0&&(Xn(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),VP(a.children,e,d,u)),!(a.path==null&&!a.index)&&e.push({path:u,score:R$(u,a.index),routesMeta:d})};return t.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let l of KP(a.path))s(a,i,l)}),e}function KP(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=KP(n.join("/")),o=[];return o.push(...i.map(l=>l===""?a:[a,l].join("/"))),s&&o.push(...i),o.map(l=>t.startsWith("/")&&l===""?"/":l)}function E$(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:M$(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const N$=/^:[\w-]+$/,A$=3,j$=2,F$=1,P$=10,D$=-2,TN=t=>t==="*";function R$(t,e){let r=t.split("/"),n=r.length;return r.some(TN)&&(n+=D$),e&&(n+=j$),r.filter(s=>!TN(s)).reduce((s,a)=>s+(N$.test(a)?A$:a===""?F$:P$),n)}function M$(t,e){return t.length===e.length&&t.slice(0,-1).every((n,s)=>n===e[s])?t[t.length-1]-e[e.length-1]:0}function I$(t,e,r){let{routesMeta:n}=t,s={},a="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],u=o===n.length-1,d=a==="/"?e:e.slice(a.length)||"/",g=O$({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},d),h=l.route;if(!g)return null;Object.assign(s,g.params),i.push({params:s,pathname:bu([a,g.pathname]),pathnameBase:H$(bu([a,g.pathnameBase])),route:h}),g.pathnameBase!=="/"&&(a=bu([a,g.pathnameBase]))}return i}function O$(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=L$(t.path,t.caseSensitive,t.end),s=e.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,g)=>{let{paramName:h,isOptional:p}=d;if(h==="*"){let v=o[g]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[g];return p&&!x?u[h]=void 0:u[h]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:t}}function L$(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),zP(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function B$(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zP(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function XP(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function U$(t,e){e===void 0&&(e="/");let{pathname:r,search:n="",hash:s=""}=typeof t=="string"?lh(t):t;return{pathname:r?r.startsWith("/")?r:$$(r,e):e,search:z$(n),hash:G$(s)}}function $$(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function j_(t,e,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function W$(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function YP(t,e){let r=W$(t);return e?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function JP(t,e,r,n){n===void 0&&(n=!1);let s;typeof t=="string"?s=lh(t):(s=vg({},t),Xn(!s.pathname||!s.pathname.includes("?"),j_("?","pathname","search",s)),Xn(!s.pathname||!s.pathname.includes("#"),j_("#","pathname","hash",s)),Xn(!s.search||!s.search.includes("#"),j_("#","search","hash",s)));let a=t===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let g=e.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),g-=1;s.pathname=h.join("/")}o=g>=0?e[g]:"/"}let l=U$(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(u||d)&&(l.pathname+="/"),l}const bu=t=>t.join("/").replace(/\/\/+/g,"/"),H$=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),z$=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,G$=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function V$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const QP=["post","put","patch","delete"];new Set(QP);const K$=["get",...QP];new Set(K$);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function wg(){return wg=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},wg.apply(this,arguments)}const qk=b.createContext(null),X$=b.createContext(null),sm=b.createContext(null),Cy=b.createContext(null),Pc=b.createContext({outlet:null,matches:[],isDataRoute:!1}),qP=b.createContext(null);function am(){return b.useContext(Cy)!=null}function Ty(){return am()||Xn(!1),b.useContext(Cy).location}function ZP(t){b.useContext(sm).static||b.useLayoutEffect(t)}function Xa(){let{isDataRoute:t}=b.useContext(Pc);return t?oW():Y$()}function Y$(){am()||Xn(!1);let t=b.useContext(qk),{basename:e,future:r,navigator:n}=b.useContext(sm),{matches:s}=b.useContext(Pc),{pathname:a}=Ty(),i=JSON.stringify(YP(s,r.v7_relativeSplatPath)),o=b.useRef(!1);return ZP(()=>{o.current=!0}),b.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let g=JP(u,JSON.parse(i),a,d.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:bu([e,g.pathname])),(d.replace?n.replace:n.push)(g,d.state,d)},[e,n,i,a,t])}function Zk(){let{matches:t}=b.useContext(Pc),e=t[t.length-1];return e?e.params:{}}function J$(t,e){return Q$(t,e)}function Q$(t,e,r,n){am()||Xn(!1);let{navigator:s}=b.useContext(sm),{matches:a}=b.useContext(Pc),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let l=i?i.pathnameBase:"/";i&&i.route;let u=Ty(),d;if(e){var g;let w=typeof e=="string"?lh(e):e;l==="/"||(g=w.pathname)!=null&&g.startsWith(l)||Xn(!1),d=w}else d=u;let h=d.pathname||"/",p=h;if(l!=="/"){let w=l.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=C$(t,{pathname:p}),v=rW(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:bu([l,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?l:bu([l,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return e&&v?b.createElement(Cy.Provider,{value:{location:wg({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Zl.Pop}},v):v}function q$(){let t=iW(),e=V$(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return b.createElement(b.Fragment,null,b.createElement("h2",null,"Unexpected Application Error!"),b.createElement("h3",{style:{fontStyle:"italic"}},e),r?b.createElement("pre",{style:s},r):null,null)}const Z$=b.createElement(q$,null);class eW extends b.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?b.createElement(Pc.Provider,{value:this.props.routeContext},b.createElement(qP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function tW(t){let{routeContext:e,match:r,children:n}=t,s=b.useContext(qk);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),b.createElement(Pc.Provider,{value:e},n)}function rW(t,e,r,n){var s;if(e===void 0&&(e=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var a;if(!r)return null;if(r.errors)t=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(g=>g.route.id&&(o==null?void 0:o[g.route.id])!==void 0);d>=0||Xn(!1),i=i.slice(0,Math.min(i.length,d+1))}let l=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let g=i[d];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(u=d),g.route.id){let{loaderData:h,errors:p}=r,x=g.route.loader&&h[g.route.id]===void 0&&(!p||p[g.route.id]===void 0);if(g.route.lazy||x){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,g,h)=>{let p,x=!1,v=null,w=null;r&&(p=o&&g.route.id?o[g.route.id]:void 0,v=g.route.errorElement||Z$,l&&(u<0&&h===0?(lW("route-fallback"),x=!0,w=null):u===h&&(x=!0,w=g.route.hydrateFallbackElement||null)));let S=e.concat(i.slice(0,h+1)),_=()=>{let y;return p?y=v:x?y=w:g.route.Component?y=b.createElement(g.route.Component,null):g.route.element?y=g.route.element:y=d,b.createElement(tW,{match:g,routeContext:{outlet:d,matches:S,isDataRoute:r!=null},children:y})};return r&&(g.route.ErrorBoundary||g.route.errorElement||h===0)?b.createElement(eW,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:_(),routeContext:{outlet:null,matches:S,isDataRoute:!0}}):_()},null)}var eD=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(eD||{}),tD=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(tD||{});function nW(t){let e=b.useContext(qk);return e||Xn(!1),e}function sW(t){let e=b.useContext(X$);return e||Xn(!1),e}function aW(t){let e=b.useContext(Pc);return e||Xn(!1),e}function rD(t){let e=aW(),r=e.matches[e.matches.length-1];return r.route.id||Xn(!1),r.route.id}function iW(){var t;let e=b.useContext(qP),r=sW(),n=rD();return e!==void 0?e:(t=r.errors)==null?void 0:t[n]}function oW(){let{router:t}=nW(eD.UseNavigateStable),e=rD(tD.UseNavigateStable),r=b.useRef(!1);return ZP(()=>{r.current=!0}),b.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,wg({fromRouteId:e},a)))},[t,e])}const EN={};function lW(t,e,r){EN[t]||(EN[t]=!0)}function cW(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function zf(t){let{to:e,replace:r,state:n,relative:s}=t;am()||Xn(!1);let{future:a,static:i}=b.useContext(sm),{matches:o}=b.useContext(Pc),{pathname:l}=Ty(),u=Xa(),d=JP(e,YP(o,a.v7_relativeSplatPath),l,s==="path"),g=JSON.stringify(d);return b.useEffect(()=>u(JSON.parse(g),{replace:r,state:n,relative:s}),[u,g,s,r,n]),null}function Mn(t){Xn(!1)}function uW(t){let{basename:e="/",children:r=null,location:n,navigationType:s=Zl.Pop,navigator:a,static:i=!1,future:o}=t;am()&&Xn(!1);let l=e.replace(/^\/*/,"/"),u=b.useMemo(()=>({basename:l,navigator:a,static:i,future:wg({v7_relativeSplatPath:!1},o)}),[l,o,a,i]);typeof n=="string"&&(n=lh(n));let{pathname:d="/",search:g="",hash:h="",state:p=null,key:x="default"}=n,v=b.useMemo(()=>{let w=XP(d,l);return w==null?null:{location:{pathname:w,search:g,hash:h,state:p,key:x},navigationType:s}},[l,d,g,h,p,x,s]);return v==null?null:b.createElement(sm.Provider,{value:u},b.createElement(Cy.Provider,{children:r,value:v}))}function eC(t){let{children:e,location:r}=t;return J$(Pb(e),r)}new Promise(()=>{});function Pb(t,e){e===void 0&&(e=[]);let r=[];return b.Children.forEach(t,(n,s)=>{if(!b.isValidElement(n))return;let a=[...e,s];if(n.type===b.Fragment){r.push.apply(r,Pb(n.props.children,a));return}n.type!==Mn&&Xn(!1),!n.props.index||!n.props.children||Xn(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Pb(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const dW="6";try{window.__reactRouterVersion=dW}catch{}const fW="startTransition",NN=fB[fW];function hW(t){let{basename:e,children:r,future:n,window:s}=t,a=b.useRef();a.current==null&&(a.current=b$({window:s,v5Compat:!0}));let i=a.current,[o,l]=b.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=b.useCallback(g=>{u&&NN?NN(()=>l(g)):l(g)},[l,u]);return b.useLayoutEffect(()=>i.listen(d),[i,d]),b.useEffect(()=>cW(n),[n]),b.createElement(uW,{basename:e,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var AN;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(AN||(AN={}));var jN;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(jN||(jN={}));const Jr={student_subjects:30*60*1e3,student_active_tests:10*60*1e3,student_results_table:10*60*1e3,teacher_subjects:15*60*1e3,teacher_classes:15*60*1e3,teacher_tests:10*60*1e3,teacher_results_table:10*60*1e3,admin_users:20*60*1e3,admin_teachers:20*60*1e3,admin_subjects:30*60*1e3,admin_academic_years:60*60*1e3,admin_tests:15*60*1e3,admin_results_table:null,admin_teacher_id:60*60*1e3,all_tests:20*60*1e3,subjects_dropdown:30*60*1e3,grades_classes:60*60*1e3,test_progress:2*60*1e3,anti_cheating:2*60*1e3,word_matching_test:10*60*1e3},zr=t=>{try{const e=localStorage.getItem(t);if(!e)return console.log(" Cache: No data found for key:",t),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(e),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",t,"age:",a,"ttl:",s),localStorage.removeItem(t),null):(console.log(" Cache: Data found for key:",t,"age:",a,"ttl:",s),r)}catch(e){return console.log(" Cache: Corrupted data for key:",t,e),localStorage.removeItem(t),null}},Gr=(t,e,r)=>{try{console.log(" Cache: Setting data for key:",t,"ttl:",r),localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",t)}catch{console.log(" Cache: Storage full, cleaning old data for key:",t),nD();try{localStorage.setItem(t,JSON.stringify({data:e,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",t)}catch{console.warn("Storage full, cannot cache data")}}},nD=()=>{const t=Date.now(),e=Object.keys(localStorage);e.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);t-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=t-7*24*60*60*1e3;e.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:l}=JSON.parse(o);return{key:i,timestamp:l}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},tC=t=>{Object.keys(localStorage).forEach(r=>{r.includes(t)&&localStorage.removeItem(r)})},ch=(t,e,r)=>{const n=`test_progress_${t}_${e}_${r}`,s=`anti_cheating_${t}_${e}_${r}`;localStorage.removeItem(n),localStorage.removeItem(s),console.log(`Cleared test data for ${e}_${r}`)},sD=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Jr,cleanupOldData:nD,clearTestData:ch,clearUserData:tC,getCachedData:zr,setCachedData:Gr},Symbol.toStringTag,{value:"Module"})),aD=b.createContext(),iD=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState(null),[a,i]=b.useState(localStorage.getItem("token")),[o,l]=b.useState(!1),[u,d]=b.useState(!0),[g,h]=b.useState(null);b.useEffect(()=>{console.log("[AUTH] Initializing application session..."),w()},[]),b.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let te=!1;const H=setInterval(async()=>{if(o&&a&&!te){te=!0;try{const V=a||localStorage.getItem("auth_token");if(V&&p(V))console.log("[AUTH] Token expired, attempting refresh..."),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(V)try{const Q=JSON.parse(atob(V.split(".")[1])).exp*1e3,ae=Date.now(),J=Q-ae;J<5*60*1e3&&J>0&&(console.log(`[AUTH] Token expires in ${Math.round(J/1e3)} seconds, refreshing...`),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(q){console.error("[AUTH] Error parsing token for expiration check:",q)}}catch(V){console.error("[AUTH] Error in proactive refresh:",V)}finally{te=!1}}},5*60*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(H)}}},[o,a]);const p=te=>{if(!te)return!0;try{const H=JSON.parse(atob(te.split(".")[1])),V=Date.now()/1e3;return H.exp<=V}catch(H){return console.error("[AUTH] Error decoding token:",H),!0}},x=async()=>{const te=localStorage.getItem("refresh_token");if(!te)return console.log("[AUTH] No refresh token found"),!1;try{const H=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:te})});if(H.ok){const V=await H.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",V.accessToken),localStorage.setItem("refresh_token",V.refreshToken),localStorage.setItem("accessToken",V.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(V.accessToken),V.refreshToken&&window.tokenManager.setRefreshToken(V.refreshToken))}catch{}return i(V.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",H.status),!1}catch(H){return console.error("[AUTH] Token refresh error:",H),!1}},v=async(te,H={})=>{const V=a||localStorage.getItem("auth_token");if(!V)throw new Error("No authentication token found");const q={"Content-Type":"application/json",Authorization:`Bearer ${V}`,...H.headers},Q=await fetch(te,{...H,headers:q});if(Q.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await x()){const J=localStorage.getItem("auth_token");return q.Authorization=`Bearer ${J}`,fetch(te,{...H,headers:q})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return Q},w=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const te=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),H=localStorage.getItem("user_data")||localStorage.getItem("userData"),V=H?JSON.parse(H).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!te,hasUser:!!H,role:V}),te&&V&&H)try{const q=JSON.parse(H);if(p(te))if(console.log("[AUTH] Token expired, attempting refresh..."),await x()){console.log("[AUTH] Token refreshed successfully");const ae=localStorage.getItem("auth_token");i(ae)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(te);else i(te);s(V),r(q);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const Q=localStorage.getItem("refresh_token");Q&&window.tokenManager.setRefreshToken(Q)}}catch{}l(!0),await y(q,V)}catch(q){console.error("[AUTH] Error parsing stored user data:",q),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),l(!1)}}catch(te){console.error("[AUTH] Session initialization error:",te),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),l(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},S=async te=>{try{if(d(!0),h(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),h("Please wait for the logout process to complete.");return}console.log("Attempting login with:",te.username);let H,V;te.username==="admin"?(H={ok:!0,json:()=>({success:!0,token:"test-token"})},V="admin"):(H=await authService.teacherLogin(te),V="teacher");const q=await H.json();await _(H,V,q)}catch(H){C(H)}finally{d(!1)}},_=async(te,H,V)=>{try{if(te.ok&&V.success&&V.token){i(V.token),s(H),r(V),l(!0),localStorage.setItem("auth_token",V.accessToken||V.token),localStorage.setItem("refresh_token",V.refreshToken),localStorage.setItem("user_data",JSON.stringify(V)),localStorage.setItem("accessToken",V.accessToken||V.token);try{const q=Date.now(),Q=7*24*60*60*1e3,ae=[];for(let J=0;J<localStorage.length;J++){const re=localStorage.key(J);if(!(!re||!(re.startsWith("test_progress_")||re.startsWith("test_timer_")||re.startsWith("test_shuffle_order_")||re.startsWith("student_results_table_")||re.startsWith("anti_cheating_"))))try{const we=localStorage.getItem(re);if(!we){ae.push(re);continue}let Fe=null;if(we.startsWith("{")||we.startsWith("[")){const ne=JSON.parse(we),Ee=ne.timestamp||ne.lastSaved||ne.lastTickAt||ne.createdAt||ne.updatedAt||ne.startedAt||ne.started_at;Ee&&(Fe=new Date(Ee).getTime())}if(!Fe){const ne=`${re}__ts`,Ee=localStorage.getItem(ne);Ee&&(Fe=parseInt(Ee)||null)}if(!Fe)continue;q-Fe>Q&&ae.push(re)}catch{}}ae.forEach(J=>{try{localStorage.removeItem(J)}catch{}})}catch(q){console.warn("LocalStorage cleanup skipped:",q)}return await y(V,H),!0}else{const q=V.message||te.statusText||"Login failed";return C(new Error(q)),!1}}catch(q){return C(q),!1}},y=async(te,H)=>{try{switch(H){case"admin":console.log("Admin login successful, role:",te.role),console.log("Admin logged in:",te);break;case"teacher":console.log("Teacher login successful, role:",te.role),console.log("Teacher data:",te.teacher),await N(te),await A();break;case"student":console.log("Student login successful"),k(te);break;default:console.warn("Unknown user role:",H)}}catch(V){console.error("Post-login actions error:",V)}},k=te=>{r(te),console.log("Student info populated:",te)},N=async te=>{r(te),console.log("Teacher info populated:",te)},E=async()=>{try{console.log("Initializing teacher cabinet...")}catch(te){console.error("Error initializing teacher cabinet:",te)}},A=async()=>{try{console.log("Checking teacher subjects...")}catch(te){console.error("Error checking teacher subjects:",te)}},C=te=>{h(te.message||"Login failed"),F()},F=()=>{h(null),d(!1)},P=b.useCallback(()=>{M()},[]),M=()=>{r(null),s(null),i(null),l(!1),h(null);const te=(e==null?void 0:e.student_id)||(e==null?void 0:e.teacher_id)||(e==null?void 0:e.admin_id)||(e==null?void 0:e.id);te&&tC(te),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{I()},100)},I=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},Y=()=>(e==null?void 0:e.id)||null,se=()=>n==="admin"?e:null,L=()=>n==="admin",z=()=>L()?e==null?void 0:e.admin_id:null,G=()=>n==="teacher"?e==null?void 0:e.username:null,O=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof S,logout:typeof P,getCurrentTeacherId:typeof Y,isAdmin:typeof L,getCurrentAdmin:typeof se,getCurrentAdminId:typeof z,getCurrentTeacherUsername:typeof G})};b.useEffect(()=>(window.logout=P,window.getCurrentTeacherId=Y,window.getCurrentAdmin=se,window.isAdmin=L,window.getCurrentAdminId=z,window.getCurrentTeacherUsername=G,window.checkFunctionAvailability=O,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[P]);const R=b.useCallback(te=>{console.log("Setting user data from external auth:",te),r(te),s(te.role),i(te.token),l(!0),d(!1),h(null),localStorage.setItem("auth_token",te.token),localStorage.setItem("user_data",JSON.stringify(te)),localStorage.setItem("accessToken",te.token)},[]),X={user:e,role:n,token:a,isAuthenticated:o,isLoading:u,error:g,login:S,setUserData:R,logout:P,resetLoginForm:F,forceCompleteLogout:M,initializeApplicationSession:w,makeAuthenticatedRequest:v,populateStudentInfo:k,populateTeacherInfo:N,initializeTeacherCabinet:E,checkTeacherSubjects:A,getCurrentTeacherId:Y,getCurrentAdmin:se,isAdmin:L,getCurrentAdminId:z,getCurrentTeacherUsername:G,handleLoginResponse:_,handlePostLoginActions:y,handleLoginFailure:C,resetInterfaceAfterSessionClear:I,checkFunctionAvailability:O};return c.jsx(aD.Provider,{value:X,children:t})},vn=()=>{const t=b.useContext(aD);if(!t)throw new Error("useAuth must be used within an AuthProvider");return t};class gW{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const e=localStorage.getItem("token");return{"Content-Type":"application/json",...e&&{Authorization:`Bearer ${e}`}}}async sendRequest(e,r){try{return await fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(e,r={}){const n=`${this.baseURL}${e}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,l=setTimeout(()=>o.abort(),this.timeout),u=await fetch(n,{...s,signal:o.signal});if(clearTimeout(l),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(l=>setTimeout(l,this.retryDelay*Math.pow(2,i))))}throw a}async get(e,r={}){return this.request(e,{...r,method:"GET"})}async post(e,r,n={}){return this.request(e,{...n,method:"POST",body:JSON.stringify(r)})}async put(e,r,n={}){return this.request(e,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(e,r={}){return this.request(e,{...r,method:"DELETE"})}async patch(e,r,n={}){return this.request(e,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(e,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${e}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(e,r,n={}){const s=`${this.baseURL}${e}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),l=window.URL.createObjectURL(o),u=document.createElement("a");u.href=l,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(l)}catch(i){throw i}}ensureDebugOutput(){let e=document.getElementById("debug-output");return e||(e=document.createElement("div"),e.id="debug-output",e.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",e.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(e)),e}async testDbConnection(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,message:"Database connection failed",error:e.message}}}async testStudentLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testTeacherLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testAdminLogin(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetTeacherSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetClassResults(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetStudentSubjects(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testGetStudentTestResults(){try{const e=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return e&&(e.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(e){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${e.message}</pre>
        `),{success:!1,error:e.message}}}async testEndpoints(){const e=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of e)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(e){const r=this.ensureDebugOutput();try{let n;switch(e){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${e}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${e}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${e}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const e=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;e.innerHTML=r}}const Sn=new gW,rC=b.createContext({});function nC(t){const e=b.useRef(null);return e.current===null&&(e.current=t()),e.current}const sC=typeof window<"u",oD=sC?b.useLayoutEffect:b.useEffect,Ey=b.createContext(null);function aC(t,e){t.indexOf(e)===-1&&t.push(e)}function iC(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}const yl=(t,e,r)=>r>e?e:r<t?t:r;let oC=()=>{};const vl={},lD=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function cD(t){return typeof t=="object"&&t!==null}const uD=t=>/^0[^.\s]+$/u.test(t);function lC(t){let e;return()=>(e===void 0&&(e=t()),e)}const _i=t=>t,mW=(t,e)=>r=>e(t(r)),im=(...t)=>t.reduce(mW),_g=(t,e,r)=>{const n=e-t;return n===0?1:(r-t)/n};class cC{constructor(){this.subscriptions=[]}add(e){return aC(this.subscriptions,e),()=>iC(this.subscriptions,e)}notify(e,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(e,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Ao=t=>t*1e3,jo=t=>t/1e3;function dD(t,e){return e?t*(1e3/e):0}const fD=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,pW=1e-7,xW=12;function yW(t,e,r,n,s){let a,i,o=0;do i=e+(r-e)/2,a=fD(i,n,s)-t,a>0?r=i:e=i;while(Math.abs(a)>pW&&++o<xW);return i}function om(t,e,r,n){if(t===e&&r===n)return _i;const s=a=>yW(a,0,1,t,r);return a=>a===0||a===1?a:fD(s(a),e,n)}const hD=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,gD=t=>e=>1-t(1-e),mD=om(.33,1.53,.69,.99),uC=gD(mD),pD=hD(uC),xD=t=>(t*=2)<1?.5*uC(t):.5*(2-Math.pow(2,-10*(t-1))),dC=t=>1-Math.sin(Math.acos(t)),yD=gD(dC),vD=hD(dC),vW=om(.42,0,1,1),wW=om(0,0,.58,1),wD=om(.42,0,.58,1),_W=t=>Array.isArray(t)&&typeof t[0]!="number",_D=t=>Array.isArray(t)&&typeof t[0]=="number",bW={linear:_i,easeIn:vW,easeInOut:wD,easeOut:wW,circIn:dC,circInOut:vD,circOut:yD,backIn:uC,backInOut:pD,backOut:mD,anticipate:xD},SW=t=>typeof t=="string",FN=t=>{if(_D(t)){oC(t.length===4);const[e,r,n,s]=t;return om(e,r,n,s)}else if(SW(t))return bW[t];return t},Gp=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function kW(t,e){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function l(d){i.has(d)&&(u.schedule(d),t()),d(o)}const u={schedule:(d,g=!1,h=!1)=>{const x=h&&s?r:n;return g&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(l),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const CW=40;function bD(t,e){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=Gp.reduce((y,k)=>(y[k]=kW(a),y),{}),{setup:o,read:l,resolveKeyframes:u,preUpdate:d,update:g,preRender:h,render:p,postRender:x}=i,v=()=>{const y=vl.useManualTiming?s.timestamp:performance.now();r=!1,vl.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(y-s.timestamp,CW),1)),s.timestamp=y,s.isProcessing=!0,o.process(s),l.process(s),u.process(s),d.process(s),g.process(s),h.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&e&&(n=!1,t(v))},w=()=>{r=!0,n=!0,s.isProcessing||t(v)};return{schedule:Gp.reduce((y,k)=>{const N=i[k];return y[k]=(E,A=!1,C=!1)=>(r||w(),N.schedule(E,A,C)),y},{}),cancel:y=>{for(let k=0;k<Gp.length;k++)i[Gp[k]].cancel(y)},state:s,steps:i}}const{schedule:an,cancel:wc,state:bs,steps:F_}=bD(typeof requestAnimationFrame<"u"?requestAnimationFrame:_i,!0);let Rx;function TW(){Rx=void 0}const Ca={now:()=>(Rx===void 0&&Ca.set(bs.isProcessing||vl.useManualTiming?bs.timestamp:performance.now()),Rx),set:t=>{Rx=t,queueMicrotask(TW)}},SD=t=>e=>typeof e=="string"&&e.startsWith(t),fC=SD("--"),EW=SD("var(--"),hC=t=>EW(t)?NW.test(t.split("/*")[0].trim()):!1,NW=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,uh={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},bg={...uh,transform:t=>yl(0,1,t)},Vp={...uh,default:1},L0=t=>Math.round(t*1e5)/1e5,gC=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function AW(t){return t==null}const jW=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,mC=(t,e)=>r=>!!(typeof r=="string"&&jW.test(r)&&r.startsWith(t)||e&&!AW(r)&&Object.prototype.hasOwnProperty.call(r,e)),kD=(t,e,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(gC);return{[t]:parseFloat(s),[e]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},FW=t=>yl(0,255,t),P_={...uh,transform:t=>Math.round(FW(t))},pu={test:mC("rgb","red"),parse:kD("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:n=1})=>"rgba("+P_.transform(t)+", "+P_.transform(e)+", "+P_.transform(r)+", "+L0(bg.transform(n))+")"};function PW(t){let e="",r="",n="",s="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),n=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),n=t.substring(3,4),s=t.substring(4,5),e+=e,r+=r,n+=n,s+=s),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const Db={test:mC("#"),parse:PW,transform:pu.transform},lm=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),zl=lm("deg"),Fo=lm("%"),Qt=lm("px"),DW=lm("vh"),RW=lm("vw"),PN={...Fo,parse:t=>Fo.parse(t)/100,transform:t=>Fo.transform(t*100)},df={test:mC("hsl","hue"),parse:kD("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:n=1})=>"hsla("+Math.round(t)+", "+Fo.transform(L0(e))+", "+Fo.transform(L0(r))+", "+L0(bg.transform(n))+")"},zn={test:t=>pu.test(t)||Db.test(t)||df.test(t),parse:t=>pu.test(t)?pu.parse(t):df.test(t)?df.parse(t):Db.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?pu.transform(t):df.transform(t),getAnimatableNone:t=>{const e=zn.parse(t);return e.alpha=0,zn.transform(e)}},MW=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function IW(t){var e,r;return isNaN(t)&&typeof t=="string"&&(((e=t.match(gC))==null?void 0:e.length)||0)+(((r=t.match(MW))==null?void 0:r.length)||0)>0}const CD="number",TD="color",OW="var",LW="var(",DN="${}",BW=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Sg(t){const e=t.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=e.replace(BW,l=>(zn.test(l)?(n.color.push(a),s.push(TD),r.push(zn.parse(l))):l.startsWith(LW)?(n.var.push(a),s.push(OW),r.push(l)):(n.number.push(a),s.push(CD),r.push(parseFloat(l))),++a,DN)).split(DN);return{values:r,split:o,indexes:n,types:s}}function ED(t){return Sg(t).values}function ND(t){const{split:e,types:r}=Sg(t),n=e.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=e[i],s[i]!==void 0){const o=r[i];o===CD?a+=L0(s[i]):o===TD?a+=zn.transform(s[i]):a+=s[i]}return a}}const UW=t=>typeof t=="number"?0:zn.test(t)?zn.getAnimatableNone(t):t;function $W(t){const e=ED(t);return ND(t)(e.map(UW))}const _c={test:IW,parse:ED,createTransformer:ND,getAnimatableNone:$W};function D_(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function WW({hue:t,saturation:e,lightness:r,alpha:n}){t/=360,e/=100,r/=100;let s=0,a=0,i=0;if(!e)s=a=i=r;else{const o=r<.5?r*(1+e):r+e-r*e,l=2*r-o;s=D_(l,o,t+1/3),a=D_(l,o,t),i=D_(l,o,t-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function x1(t,e){return r=>r>0?e:t}const hn=(t,e,r)=>t+(e-t)*r,R_=(t,e,r)=>{const n=t*t,s=r*(e*e-n)+n;return s<0?0:Math.sqrt(s)},HW=[Db,pu,df],zW=t=>HW.find(e=>e.test(t));function RN(t){const e=zW(t);if(!e)return!1;let r=e.parse(t);return e===df&&(r=WW(r)),r}const MN=(t,e)=>{const r=RN(t),n=RN(e);if(!r||!n)return x1(t,e);const s={...r};return a=>(s.red=R_(r.red,n.red,a),s.green=R_(r.green,n.green,a),s.blue=R_(r.blue,n.blue,a),s.alpha=hn(r.alpha,n.alpha,a),pu.transform(s))},Rb=new Set(["none","hidden"]);function GW(t,e){return Rb.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function VW(t,e){return r=>hn(t,e,r)}function pC(t){return typeof t=="number"?VW:typeof t=="string"?hC(t)?x1:zn.test(t)?MN:YW:Array.isArray(t)?AD:typeof t=="object"?zn.test(t)?MN:KW:x1}function AD(t,e){const r=[...t],n=r.length,s=t.map((a,i)=>pC(a)(a,e[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function KW(t,e){const r={...t,...e},n={};for(const s in r)t[s]!==void 0&&e[s]!==void 0&&(n[s]=pC(t[s])(t[s],e[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function XW(t,e){const r=[],n={color:0,var:0,number:0};for(let s=0;s<e.values.length;s++){const a=e.types[s],i=t.indexes[a][n[a]],o=t.values[i]??0;r[s]=o,n[a]++}return r}const YW=(t,e)=>{const r=_c.createTransformer(e),n=Sg(t),s=Sg(e);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?Rb.has(t)&&!s.values.length||Rb.has(e)&&!n.values.length?GW(t,e):im(AD(XW(n,s),s.values),r):x1(t,e)};function jD(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?hn(t,e,r):pC(t)(t,e)}const JW=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>an.update(e,r),stop:()=>wc(e),now:()=>bs.isProcessing?bs.timestamp:Ca.now()}},FD=(t,e,r=10)=>{let n="";const s=Math.max(Math.round(e/r),2);for(let a=0;a<s;a++)n+=Math.round(t(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},y1=2e4;function xC(t){let e=0;const r=50;let n=t.next(e);for(;!n.done&&e<y1;)e+=r,n=t.next(e);return e>=y1?1/0:e}function QW(t,e=100,r){const n=r({...t,keyframes:[0,e]}),s=Math.min(xC(n),y1);return{type:"keyframes",ease:a=>n.next(s*a).value/e,duration:jo(s)}}const qW=5;function PD(t,e,r){const n=Math.max(e-qW,0);return dD(r-t(n),e-n)}const kn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},M_=.001;function ZW({duration:t=kn.duration,bounce:e=kn.bounce,velocity:r=kn.velocity,mass:n=kn.mass}){let s,a,i=1-e;i=yl(kn.minDamping,kn.maxDamping,i),t=yl(kn.minDuration,kn.maxDuration,jo(t)),i<1?(s=u=>{const d=u*i,g=d*t,h=d-r,p=Mb(u,i),x=Math.exp(-g);return M_-h/p*x},a=u=>{const g=u*i*t,h=g*r+r,p=Math.pow(i,2)*Math.pow(u,2)*t,x=Math.exp(-g),v=Mb(Math.pow(u,2),i);return(-s(u)+M_>0?-1:1)*((h-p)*x)/v}):(s=u=>{const d=Math.exp(-u*t),g=(u-r)*t+1;return-M_+d*g},a=u=>{const d=Math.exp(-u*t),g=(r-u)*(t*t);return d*g});const o=5/t,l=tH(s,a,o);if(t=Ao(t),isNaN(l))return{stiffness:kn.stiffness,damping:kn.damping,duration:t};{const u=Math.pow(l,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:t}}}const eH=12;function tH(t,e,r){let n=r;for(let s=1;s<eH;s++)n=n-t(n)/e(n);return n}function Mb(t,e){return t*Math.sqrt(1-e*e)}const rH=["duration","bounce"],nH=["stiffness","damping","mass"];function IN(t,e){return e.some(r=>t[r]!==void 0)}function sH(t){let e={velocity:kn.velocity,stiffness:kn.stiffness,damping:kn.damping,mass:kn.mass,isResolvedFromDuration:!1,...t};if(!IN(t,nH)&&IN(t,rH))if(t.visualDuration){const r=t.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*yl(.05,1,1-(t.bounce||0))*Math.sqrt(s);e={...e,mass:kn.mass,stiffness:s,damping:a}}else{const r=ZW(t);e={...e,...r,mass:kn.mass},e.isResolvedFromDuration=!0}return e}function v1(t=kn.visualDuration,e=kn.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:l,damping:u,mass:d,duration:g,velocity:h,isResolvedFromDuration:p}=sH({...r,velocity:-jo(r.velocity||0)}),x=h||0,v=u/(2*Math.sqrt(l*d)),w=i-a,S=jo(Math.sqrt(l/d)),_=Math.abs(w)<5;n||(n=_?kn.restSpeed.granular:kn.restSpeed.default),s||(s=_?kn.restDelta.granular:kn.restDelta.default);let y;if(v<1){const N=Mb(S,v);y=E=>{const A=Math.exp(-v*S*E);return i-A*((x+v*S*w)/N*Math.sin(N*E)+w*Math.cos(N*E))}}else if(v===1)y=N=>i-Math.exp(-S*N)*(w+(x+S*w)*N);else{const N=S*Math.sqrt(v*v-1);y=E=>{const A=Math.exp(-v*S*E),C=Math.min(N*E,300);return i-A*((x+v*S*w)*Math.sinh(C)+N*w*Math.cosh(C))/N}}const k={calculatedDuration:p&&g||null,next:N=>{const E=y(N);if(p)o.done=N>=g;else{let A=N===0?x:0;v<1&&(A=N===0?Ao(x):PD(y,N,E));const C=Math.abs(A)<=n,F=Math.abs(i-E)<=s;o.done=C&&F}return o.value=o.done?i:E,o},toString:()=>{const N=Math.min(xC(k),y1),E=FD(A=>k.next(N*A).value,N,30);return N+"ms "+E},toTransition:()=>{}};return k}v1.applyToOptions=t=>{const e=QW(t,100,v1);return t.ease=e.ease,t.duration=Ao(e.duration),t.type="keyframes",t};function Ib({keyframes:t,velocity:e=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:l,restDelta:u=.5,restSpeed:d}){const g=t[0],h={done:!1,value:g},p=C=>o!==void 0&&C<o||l!==void 0&&C>l,x=C=>o===void 0?l:l===void 0||Math.abs(o-C)<Math.abs(l-C)?o:l;let v=r*e;const w=g+v,S=i===void 0?w:i(w);S!==w&&(v=S-g);const _=C=>-v*Math.exp(-C/n),y=C=>S+_(C),k=C=>{const F=_(C),P=y(C);h.done=Math.abs(F)<=u,h.value=h.done?S:P};let N,E;const A=C=>{p(h.value)&&(N=C,E=v1({keyframes:[h.value,x(h.value)],velocity:PD(y,C,h.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return A(0),{calculatedDuration:null,next:C=>{let F=!1;return!E&&N===void 0&&(F=!0,k(C),A(C)),N!==void 0&&C>=N?E.next(C-N):(!F&&k(C),h)}}}function aH(t,e,r){const n=[],s=r||vl.mix||jD,a=t.length-1;for(let i=0;i<a;i++){let o=s(t[i],t[i+1]);if(e){const l=Array.isArray(e)?e[i]||_i:e;o=im(l,o)}n.push(o)}return n}function iH(t,e,{clamp:r=!0,ease:n,mixer:s}={}){const a=t.length;if(oC(a===e.length),a===1)return()=>e[0];if(a===2&&e[0]===e[1])return()=>e[1];const i=t[0]===t[1];t[0]>t[a-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=aH(e,n,s),l=o.length,u=d=>{if(i&&d<t[0])return e[0];let g=0;if(l>1)for(;g<t.length-2&&!(d<t[g+1]);g++);const h=_g(t[g],t[g+1],d);return o[g](h)};return r?d=>u(yl(t[0],t[a-1],d)):u}function oH(t,e){const r=t[t.length-1];for(let n=1;n<=e;n++){const s=_g(0,e,n);t.push(hn(r,1,s))}}function lH(t){const e=[0];return oH(e,t.length-1),e}function cH(t,e){return t.map(r=>r*e)}function uH(t,e){return t.map(()=>e||wD).splice(0,t.length-1)}function B0({duration:t=300,keyframes:e,times:r,ease:n="easeInOut"}){const s=_W(n)?n.map(FN):FN(n),a={done:!1,value:e[0]},i=cH(r&&r.length===e.length?r:lH(e),t),o=iH(i,e,{ease:Array.isArray(s)?s:uH(e,s)});return{calculatedDuration:t,next:l=>(a.value=o(l),a.done=l>=t,a)}}const dH=t=>t!==null;function yC(t,{repeat:e,repeatType:r="loop"},n,s=1){const a=t.filter(dH),o=s<0||e&&r!=="loop"&&e%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const fH={decay:Ib,inertia:Ib,tween:B0,keyframes:B0,spring:v1};function DD(t){typeof t.type=="string"&&(t.type=fH[t.type])}class vC{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const hH=t=>t/100;class wC extends vC{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var n,s;const{motionValue:r}=this.options;r&&r.updatedAt!==Ca.now()&&this.tick(Ca.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(s=(n=this.options).onStop)==null||s.call(n))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;DD(e);const{type:r=B0,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=e;let{keyframes:o}=e;const l=r||B0;l!==B0&&typeof o[0]!="number"&&(this.mixKeyframes=im(hH,jD(o[0],o[1])),o=[0,100]);const u=l({...e,keyframes:o});a==="mirror"&&(this.mirroredGenerator=l({...e,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=xC(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:g,repeatType:h,repeatDelay:p,type:x,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-s/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const S=this.currentTime-u*(this.playbackSpeed>=0?1:-1),_=this.playbackSpeed>=0?S<0:S>s;this.currentTime=Math.max(S,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let y=this.currentTime,k=n;if(g){const C=Math.min(this.currentTime,s)/o;let F=Math.floor(C),P=C%1;!P&&C>=1&&(P=1),P===1&&F--,F=Math.min(F,g+1),!!(F%2)&&(h==="reverse"?(P=1-P,p&&(P-=p/o)):h==="mirror"&&(k=i)),y=yl(0,1,P)*o}const N=_?{done:!1,value:d[0]}:k.next(y);a&&(N.value=a(N.value));let{done:E}=N;!_&&l!==null&&(E=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return A&&x!==Ib&&(N.value=yC(d,this.options,w,this.speed)),v&&v(N.value),A&&this.finish(),N}then(e,r){return this.finished.then(e,r)}get duration(){return jo(this.calculatedDuration)}get time(){return jo(this.currentTime)}set time(e){var r;e=Ao(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(r=this.driver)==null||r.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ca.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=jo(this.currentTime))}play(){var s,a;if(this.isStopped)return;const{driver:e=JW,startTime:r}=this.options;this.driver||(this.driver=e(i=>this.tick(i))),(a=(s=this.options).onPlay)==null||a.call(s);const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ca.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,r;this.notifyFinished(),this.teardown(),this.state="finished",(r=(e=this.options).onComplete)==null||r.call(e)}cancel(){var e,r;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(r=(e=this.options).onCancel)==null||r.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var r;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(r=this.driver)==null||r.stop(),e.observe(this)}}function gH(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const xu=t=>t*180/Math.PI,Ob=t=>{const e=xu(Math.atan2(t[1],t[0]));return Lb(e)},mH={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Ob,rotateZ:Ob,skewX:t=>xu(Math.atan(t[1])),skewY:t=>xu(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Lb=t=>(t=t%360,t<0&&(t+=360),t),ON=Ob,LN=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),BN=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),pH={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:LN,scaleY:BN,scale:t=>(LN(t)+BN(t))/2,rotateX:t=>Lb(xu(Math.atan2(t[6],t[5]))),rotateY:t=>Lb(xu(Math.atan2(-t[2],t[0]))),rotateZ:ON,rotate:ON,skewX:t=>xu(Math.atan(t[4])),skewY:t=>xu(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Bb(t){return t.includes("scale")?1:0}function Ub(t,e){if(!t||t==="none")return Bb(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=pH,s=r;else{const o=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=mH,s=o}if(!s)return Bb(e);const a=n[e],i=s[1].split(",").map(yH);return typeof a=="function"?a(i):i[a]}const xH=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return Ub(r,e)};function yH(t){return parseFloat(t.trim())}const dh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],fh=new Set(dh),UN=t=>t===uh||t===Qt,vH=new Set(["x","y","z"]),wH=dh.filter(t=>!vH.has(t));function _H(t){const e=[];return wH.forEach(r=>{const n=t.getValue(r);n!==void 0&&(e.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),e}const Su={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Ub(e,"x"),y:(t,{transform:e})=>Ub(e,"y")};Su.translateX=Su.x;Su.translateY=Su.y;const ku=new Set;let $b=!1,Wb=!1,Hb=!1;function RD(){if(Wb){const t=Array.from(ku).filter(n=>n.needsMeasurement),e=new Set(t.map(n=>n.element)),r=new Map;e.forEach(n=>{const s=_H(n);s.length&&(r.set(n,s),n.render())}),t.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{var o;(o=n.getValue(a))==null||o.set(i)})}),t.forEach(n=>n.measureEndState()),t.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}Wb=!1,$b=!1,ku.forEach(t=>t.complete(Hb)),ku.clear()}function MD(){ku.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Wb=!0)})}function bH(){Hb=!0,MD(),RD(),Hb=!1}class _C{constructor(e,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(ku.add(this),$b||($b=!0,an.read(MD),an.resolveKeyframes(RD))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:n,motionValue:s}=this;if(e[0]===null){const a=s==null?void 0:s.get(),i=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(e[0]=o)}e[0]===void 0&&(e[0]=i),s&&a===void 0&&s.set(e[0])}gH(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ku.delete(this)}cancel(){this.state==="scheduled"&&(ku.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const SH=t=>t.startsWith("--");function kH(t,e,r){SH(e)?t.style.setProperty(e,r):t.style[e]=r}const CH=lC(()=>window.ScrollTimeline!==void 0),TH={};function EH(t,e){const r=lC(t);return()=>TH[e]??r()}const ID=EH(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),b0=([t,e,r,n])=>`cubic-bezier(${t}, ${e}, ${r}, ${n})`,$N={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:b0([0,.65,.55,1]),circOut:b0([.55,0,1,.45]),backIn:b0([.31,.01,.66,-.59]),backOut:b0([.33,1.53,.69,.99])};function OD(t,e){if(t)return typeof t=="function"?ID()?FD(t,e):"ease-out":_D(t)?b0(t):Array.isArray(t)?t.map(r=>OD(r,e)||$N.easeOut):$N[t]}function NH(t,e,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:l}={},u=void 0){const d={[e]:r};l&&(d.offset=l);const g=OD(o,s);Array.isArray(g)&&(d.easing=g);const h={delay:n,duration:s,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),t.animate(d,h)}function LD(t){return typeof t=="function"&&"applyToOptions"in t}function AH({type:t,...e}){return LD(t)&&ID()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class jH extends vC{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=e,oC(typeof e.type!="string");const u=AH(e);this.animation=NH(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=yC(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):kH(r,n,d),this.animation.cancel()}l==null||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,r;(r=(e=this.animation).finish)==null||r.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,r;this.isPseudoElement||(r=(e=this.animation).commitStyles)==null||r.call(e)}get duration(){var r,n;const e=((n=(r=this.animation.effect)==null?void 0:r.getComputedTiming)==null?void 0:n.call(r).duration)||0;return jo(Number(e))}get time(){return jo(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=Ao(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){var n;return this.allowFlatten&&((n=this.animation.effect)==null||n.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&CH()?(this.animation.timeline=e,_i):r(this)}}const BD={anticipate:xD,backInOut:pD,circInOut:vD};function FH(t){return t in BD}function PH(t){typeof t.ease=="string"&&FH(t.ease)&&(t.ease=BD[t.ease])}const WN=10;class DH extends jH{constructor(e){PH(e),DD(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const o=new wC({...i,autoplay:!1}),l=Ao(this.finishedTime??this.time);r.setWithVelocity(o.sample(l-WN).value,o.sample(l).value,WN),o.stop()}}const HN=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(_c.test(t)||t==="0")&&!t.startsWith("url("));function RH(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function MH(t,e,r,n){const s=t[0];if(s===null)return!1;if(e==="display"||e==="visibility")return!0;const a=t[t.length-1],i=HN(s,e),o=HN(a,e);return!i||!o?!1:RH(t)||(r==="spring"||LD(r))&&n}function zb(t){t.duration=0,t.type}const IH=new Set(["opacity","clipPath","filter","transform"]),OH=lC(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function LH(t){var d;const{motionValue:e,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=t;if(!(((d=e==null?void 0:e.owner)==null?void 0:d.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=e.owner.getProps();return OH()&&r&&IH.has(r)&&(r!=="transform"||!u)&&!l&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const BH=40;class UH extends vC{constructor({autoplay:e=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:l,motionValue:u,element:d,...g}){var x;super(),this.stop=()=>{var v,w;this._animation&&(this._animation.stop(),(v=this.stopTimeline)==null||v.call(this)),(w=this.keyframeResolver)==null||w.cancel()},this.createdAt=Ca.now();const h={autoplay:e,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:l,motionValue:u,element:d,...g},p=(d==null?void 0:d.KeyframeResolver)||_C;this.keyframeResolver=new p(o,(v,w,S)=>this.onKeyframesResolved(v,w,h,!S),l,u,d),(x=this.keyframeResolver)==null||x.scheduleResolve()}onKeyframesResolved(e,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:l,isHandoff:u,onUpdate:d}=n;this.resolvedAt=Ca.now(),MH(e,a,i,o)||((vl.instantAnimations||!l)&&(d==null||d(yC(e,n,r))),e[0]=e[e.length-1],zb(n),n.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>BH?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:e},p=!u&&LH(h)?new DH({...h,element:h.motionValue.owner.current}):new wC(h);p.finished.then(()=>this.notifyFinished()).catch(_i),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),bH()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const $H=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function WH(t){const e=$H.exec(t);if(!e)return[,];const[,r,n,s]=e;return[`--${r??n}`,s]}function UD(t,e,r=1){const[n,s]=WH(t);if(!n)return;const a=window.getComputedStyle(e).getPropertyValue(n);if(a){const i=a.trim();return lD(i)?parseFloat(i):i}return hC(s)?UD(s,e,r+1):s}function bC(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const $D=new Set(["width","height","top","left","right","bottom",...dh]),HH={test:t=>t==="auto",parse:t=>t},WD=t=>e=>e.test(t),HD=[uh,Qt,Fo,zl,RW,DW,HH],zN=t=>HD.find(WD(t));function zH(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||uD(t):!0}const GH=new Set(["brightness","contrast","saturate","opacity"]);function VH(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[n]=r.match(gC)||[];if(!n)return t;const s=r.replace(n,"");let a=GH.has(e)?1:0;return n!==r&&(a*=100),e+"("+a+s+")"}const KH=/\b([a-z-]*)\(.*?\)/gu,Gb={..._c,getAnimatableNone:t=>{const e=t.match(KH);return e?e.map(VH).join(" "):t}},GN={...uh,transform:Math.round},XH={rotate:zl,rotateX:zl,rotateY:zl,rotateZ:zl,scale:Vp,scaleX:Vp,scaleY:Vp,scaleZ:Vp,skew:zl,skewX:zl,skewY:zl,distance:Qt,translateX:Qt,translateY:Qt,translateZ:Qt,x:Qt,y:Qt,z:Qt,perspective:Qt,transformPerspective:Qt,opacity:bg,originX:PN,originY:PN,originZ:Qt},SC={borderWidth:Qt,borderTopWidth:Qt,borderRightWidth:Qt,borderBottomWidth:Qt,borderLeftWidth:Qt,borderRadius:Qt,radius:Qt,borderTopLeftRadius:Qt,borderTopRightRadius:Qt,borderBottomRightRadius:Qt,borderBottomLeftRadius:Qt,width:Qt,maxWidth:Qt,height:Qt,maxHeight:Qt,top:Qt,right:Qt,bottom:Qt,left:Qt,padding:Qt,paddingTop:Qt,paddingRight:Qt,paddingBottom:Qt,paddingLeft:Qt,margin:Qt,marginTop:Qt,marginRight:Qt,marginBottom:Qt,marginLeft:Qt,backgroundPositionX:Qt,backgroundPositionY:Qt,...XH,zIndex:GN,fillOpacity:bg,strokeOpacity:bg,numOctaves:GN},YH={...SC,color:zn,backgroundColor:zn,outlineColor:zn,fill:zn,stroke:zn,borderColor:zn,borderTopColor:zn,borderRightColor:zn,borderBottomColor:zn,borderLeftColor:zn,filter:Gb,WebkitFilter:Gb},zD=t=>YH[t];function GD(t,e){let r=zD(t);return r!==Gb&&(r=_c),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const JH=new Set(["auto","none","0"]);function QH(t,e,r){let n=0,s;for(;n<t.length&&!s;){const a=t[n];typeof a=="string"&&!JH.has(a)&&Sg(a).values.length&&(s=t[n]),n++}if(s&&r)for(const a of e)t[a]=GD(r,s)}class qH extends _C{constructor(e,r,n,s,a){super(e,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let l=0;l<e.length;l++){let u=e[l];if(typeof u=="string"&&(u=u.trim(),hC(u))){const d=UD(u,r.current);d!==void 0&&(e[l]=d),l===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!$D.has(n)||e.length!==2)return;const[s,a]=e,i=zN(s),o=zN(a);if(i!==o)if(UN(i)&&UN(o))for(let l=0;l<e.length;l++){const u=e[l];typeof u=="string"&&(e[l]=parseFloat(u))}else Su[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,n=[];for(let s=0;s<e.length;s++)(e[s]===null||zH(e[s]))&&n.push(s);n.length&&QH(e,n,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Su[n](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&e.getValue(n,s).jump(s,!1)}measureEndState(){var o;const{element:e,name:r,unresolvedKeyframes:n}=this;if(!e||!e.current)return;const s=e.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=Su[r](e.measureViewportBox(),window.getComputedStyle(e.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,u])=>{e.getValue(l).set(u)}),this.resolveNoneKeyframes()}}function ZH(t,e,r){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let n=document;const s=(r==null?void 0:r[t])??n.querySelectorAll(t);return s?Array.from(s):[]}return Array.from(t)}const VD=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function KD(t){return cD(t)&&"offsetHeight"in t}const VN=30,ez=t=>!isNaN(parseFloat(t));class tz{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{var a;const s=Ca.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current),this.dependents))for(const i of this.dependents)i.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Ca.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=ez(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new cC);const n=this.events[e].add(r);return e==="change"?()=>{n(),an.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=Ca.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>VN)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,VN);return dD(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,r;(e=this.dependents)==null||e.clear(),(r=this.events.destroy)==null||r.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Gf(t,e){return new tz(t,e)}const{schedule:kC}=bD(queueMicrotask,!1),Oi={x:!1,y:!1};function XD(){return Oi.x||Oi.y}function rz(t){return t==="x"||t==="y"?Oi[t]?null:(Oi[t]=!0,()=>{Oi[t]=!1}):Oi.x||Oi.y?null:(Oi.x=Oi.y=!0,()=>{Oi.x=Oi.y=!1})}function YD(t,e){const r=ZH(t),n=new AbortController,s={passive:!0,...e,signal:n.signal};return[r,s,()=>n.abort()]}function KN(t){return!(t.pointerType==="touch"||XD())}function nz(t,e,r={}){const[n,s,a]=YD(t,r),i=o=>{if(!KN(o))return;const{target:l}=o,u=e(l,o);if(typeof u!="function"||!l)return;const d=g=>{KN(g)&&(u(g),l.removeEventListener("pointerleave",d))};l.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const JD=(t,e)=>e?t===e?!0:JD(t,e.parentElement):!1,CC=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,sz=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function az(t){return sz.has(t.tagName)||t.tabIndex!==-1}const Mx=new WeakSet;function XN(t){return e=>{e.key==="Enter"&&t(e)}}function I_(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const iz=(t,e)=>{const r=t.currentTarget;if(!r)return;const n=XN(()=>{if(Mx.has(r))return;I_(r,"down");const s=XN(()=>{I_(r,"up")}),a=()=>I_(r,"cancel");r.addEventListener("keyup",s,e),r.addEventListener("blur",a,e)});r.addEventListener("keydown",n,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),e)};function YN(t){return CC(t)&&!XD()}function oz(t,e,r={}){const[n,s,a]=YD(t,r),i=o=>{const l=o.currentTarget;if(!YN(o))return;Mx.add(l);const u=e(l,o),d=(p,x)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",h),Mx.has(l)&&Mx.delete(l),YN(p)&&typeof u=="function"&&u(p,{success:x})},g=p=>{d(p,l===window||l===document||r.useGlobalTarget||JD(l,p.target))},h=p=>{d(p,!1)};window.addEventListener("pointerup",g,s),window.addEventListener("pointercancel",h,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),KD(o)&&(o.addEventListener("focus",u=>iz(u,s)),!az(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function QD(t){return cD(t)&&"ownerSVGElement"in t}function lz(t){return QD(t)&&t.tagName==="svg"}const Gs=t=>!!(t&&t.getVelocity),cz=[...HD,zn,_c],uz=t=>cz.find(WD(t)),TC=b.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class dz extends b.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=KD(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function fz({children:t,isPresent:e,anchorX:r,root:n}){const s=b.useId(),a=b.useRef(null),i=b.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=b.useContext(TC);return b.useInsertionEffect(()=>{const{width:l,height:u,top:d,left:g,right:h}=i.current;if(e||!a.current||!l||!u)return;const p=r==="left"?`left: ${g}`:`right: ${h}`;a.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const v=n??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${l}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[e]),c.jsx(dz,{isPresent:e,childRef:a,sizeRef:i,children:b.cloneElement(t,{ref:a})})}const hz=({children:t,initial:e,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:l})=>{const u=nC(gz),d=b.useId();let g=!0,h=b.useMemo(()=>(g=!1,{id:d,initial:e,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;n&&n()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,n]);return a&&g&&(h={...h}),b.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),b.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(t=c.jsx(fz,{isPresent:r,anchorX:o,root:l,children:t})),c.jsx(Ey.Provider,{value:h,children:t})};function gz(){return new Map}function qD(t=!0){const e=b.useContext(Ey);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=e,a=b.useId();b.useEffect(()=>{if(t)return s(a)},[t]);const i=b.useCallback(()=>t&&n&&n(a),[a,n,t]);return!r&&n?[!1,i]:[!0]}const Kp=t=>t.key||"";function JN(t){const e=[];return b.Children.forEach(t,r=>{b.isValidElement(r)&&e.push(r)}),e}const Sa=({children:t,custom:e,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:l})=>{const[u,d]=qD(i),g=b.useMemo(()=>JN(t),[t]),h=i&&!u?[]:g.map(Kp),p=b.useRef(!0),x=b.useRef(g),v=nC(()=>new Map),[w,S]=b.useState(g),[_,y]=b.useState(g);oD(()=>{p.current=!1,x.current=g;for(let E=0;E<_.length;E++){const A=Kp(_[E]);h.includes(A)?v.delete(A):v.get(A)!==!0&&v.set(A,!1)}},[_,h.length,h.join("-")]);const k=[];if(g!==w){let E=[...g];for(let A=0;A<_.length;A++){const C=_[A],F=Kp(C);h.includes(F)||(E.splice(A,0,C),k.push(C))}return a==="wait"&&k.length&&(E=k),y(JN(E)),S(g),null}const{forceRender:N}=b.useContext(rC);return c.jsx(c.Fragment,{children:_.map(E=>{const A=Kp(E),C=i&&!u?!1:g===_||h.includes(A),F=()=>{if(v.has(A))v.set(A,!0);else return;let P=!0;v.forEach(M=>{M||(P=!1)}),P&&(N==null||N(),y(x.current),i&&(d==null||d()),n&&n())};return c.jsx(hz,{isPresent:C,initial:!p.current||r?void 0:!1,custom:e,presenceAffectsLayout:s,mode:a,root:l,onExitComplete:C?void 0:F,anchorX:o,children:E},A)})})},ZD=b.createContext({strict:!1}),QN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Vf={};for(const t in QN)Vf[t]={isEnabled:e=>QN[t].some(r=>!!e[r])};function mz(t){for(const e in t)Vf[e]={...Vf[e],...t[e]}}const pz=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function w1(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||pz.has(t)}let e7=t=>!w1(t);function xz(t){typeof t=="function"&&(e7=e=>e.startsWith("on")?!w1(e):t(e))}try{xz(require("@emotion/is-prop-valid").default)}catch{}function yz(t,e,r){const n={};for(const s in t)s==="values"&&typeof t.values=="object"||(e7(s)||r===!0&&w1(s)||!e&&!w1(s)||t.draggable&&s.startsWith("onDrag"))&&(n[s]=t[s]);return n}const Ny=b.createContext({});function Ay(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function kg(t){return typeof t=="string"||Array.isArray(t)}const EC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],NC=["initial",...EC];function jy(t){return Ay(t.animate)||NC.some(e=>kg(t[e]))}function t7(t){return!!(jy(t)||t.variants)}function vz(t,e){if(jy(t)){const{initial:r,animate:n}=t;return{initial:r===!1||kg(r)?r:void 0,animate:kg(n)?n:void 0}}return t.inherit!==!1?e:{}}function wz(t){const{initial:e,animate:r}=vz(t,b.useContext(Ny));return b.useMemo(()=>({initial:e,animate:r}),[qN(e),qN(r)])}function qN(t){return Array.isArray(t)?t.join(" "):t}const Cg={};function _z(t){for(const e in t)Cg[e]=t[e],fC(e)&&(Cg[e].isCSSVariable=!0)}function r7(t,{layout:e,layoutId:r}){return fh.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!Cg[t]||t==="opacity")}const bz={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Sz=dh.length;function kz(t,e,r){let n="",s=!0;for(let a=0;a<Sz;a++){const i=dh[a],o=t[i];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(i.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||r){const u=VD(o,SC[i]);if(!l){s=!1;const d=bz[i]||i;n+=`${d}(${u}) `}r&&(e[i]=u)}}return n=n.trim(),r?n=r(e,s?"":n):s&&(n="none"),n}function AC(t,e,r){const{style:n,vars:s,transformOrigin:a}=t;let i=!1,o=!1;for(const l in e){const u=e[l];if(fh.has(l)){i=!0;continue}else if(fC(l)){s[l]=u;continue}else{const d=VD(u,SC[l]);l.startsWith("origin")?(o=!0,a[l]=d):n[l]=d}}if(e.transform||(i||r?n.transform=kz(e,t.transform,r):n.transform&&(n.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${l} ${u} ${d}`}}const jC=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function n7(t,e,r){for(const n in e)!Gs(e[n])&&!r7(n,r)&&(t[n]=e[n])}function Cz({transformTemplate:t},e){return b.useMemo(()=>{const r=jC();return AC(r,e,t),Object.assign({},r.vars,r.style)},[e])}function Tz(t,e){const r=t.style||{},n={};return n7(n,r,t),Object.assign(n,Cz(t,e)),n}function Ez(t,e){const r={},n=Tz(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=n,r}const Nz={offset:"stroke-dashoffset",array:"stroke-dasharray"},Az={offset:"strokeDashoffset",array:"strokeDasharray"};function jz(t,e,r=1,n=0,s=!0){t.pathLength=1;const a=s?Nz:Az;t[a.offset]=Qt.transform(-n);const i=Qt.transform(e),o=Qt.transform(r);t[a.array]=`${i} ${o}`}function s7(t,{attrX:e,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},l,u,d){if(AC(t,o,u),l){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:g,style:h}=t;g.transform&&(h.transform=g.transform,delete g.transform),(h.transform||g.transformOrigin)&&(h.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),h.transform&&(h.transformBox=(d==null?void 0:d.transformBox)??"fill-box",delete g.transformBox),e!==void 0&&(g.x=e),r!==void 0&&(g.y=r),n!==void 0&&(g.scale=n),s!==void 0&&jz(g,s,a,i,!1)}const a7=()=>({...jC(),attrs:{}}),i7=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Fz(t,e,r,n){const s=b.useMemo(()=>{const a=a7();return s7(a,e,i7(n),t.transformTemplate,t.style),{...a.attrs,style:{...a.style}}},[e]);if(t.style){const a={};n7(a,t.style,t),s.style={...a,...s.style}}return s}const Pz=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function FC(t){return typeof t!="string"||t.includes("-")?!1:!!(Pz.indexOf(t)>-1||/[A-Z]/u.test(t))}function Dz(t,e,r,{latestValues:n},s,a=!1){const o=(FC(t)?Fz:Ez)(e,n,s,t),l=yz(e,typeof t=="string",a),u=t!==b.Fragment?{...l,...o,ref:r}:{},{children:d}=e,g=b.useMemo(()=>Gs(d)?d.get():d,[d]);return b.createElement(t,{...u,children:g})}function ZN(t){const e=[{},{}];return t==null||t.values.forEach((r,n)=>{e[0][n]=r.get(),e[1][n]=r.getVelocity()}),e}function PC(t,e,r,n){if(typeof e=="function"){const[s,a]=ZN(n);e=e(r!==void 0?r:t.custom,s,a)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[s,a]=ZN(n);e=e(r!==void 0?r:t.custom,s,a)}return e}function Ix(t){return Gs(t)?t.get():t}function Rz({scrapeMotionValuesFromProps:t,createRenderState:e},r,n,s){return{latestValues:Mz(r,n,s,t),renderState:e()}}function Mz(t,e,r,n){const s={},a=n(t,{});for(const h in a)s[h]=Ix(a[h]);let{initial:i,animate:o}=t;const l=jy(t),u=t7(t);e&&u&&!l&&t.inherit!==!1&&(i===void 0&&(i=e.initial),o===void 0&&(o=e.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const g=d?o:i;if(g&&typeof g!="boolean"&&!Ay(g)){const h=Array.isArray(g)?g:[g];for(let p=0;p<h.length;p++){const x=PC(t,h[p]);if(x){const{transitionEnd:v,transition:w,...S}=x;for(const _ in S){let y=S[_];if(Array.isArray(y)){const k=d?y.length-1:0;y=y[k]}y!==null&&(s[_]=y)}for(const _ in v)s[_]=v[_]}}}return s}const o7=t=>(e,r)=>{const n=b.useContext(Ny),s=b.useContext(Ey),a=()=>Rz(t,e,n,s);return r?a():nC(a)};function DC(t,e,r){var a;const{style:n}=t,s={};for(const i in n)(Gs(n[i])||e.style&&Gs(e.style[i])||r7(i,t)||((a=r==null?void 0:r.getValue(i))==null?void 0:a.liveStyle)!==void 0)&&(s[i]=n[i]);return s}const Iz=o7({scrapeMotionValuesFromProps:DC,createRenderState:jC});function l7(t,e,r){const n=DC(t,e,r);for(const s in t)if(Gs(t[s])||Gs(e[s])){const a=dh.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=t[s]}return n}const Oz=o7({scrapeMotionValuesFromProps:l7,createRenderState:a7}),Lz=Symbol.for("motionComponentSymbol");function ff(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Bz(t,e,r){return b.useCallback(n=>{n&&t.onMount&&t.onMount(n),e&&(n?e.mount(n):e.unmount()),r&&(typeof r=="function"?r(n):ff(r)&&(r.current=n))},[e])}const RC=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Uz="framerAppearId",c7="data-"+RC(Uz),u7=b.createContext({});function $z(t,e,r,n,s){var v,w;const{visualElement:a}=b.useContext(Ny),i=b.useContext(ZD),o=b.useContext(Ey),l=b.useContext(TC).reducedMotion,u=b.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(t,{visualState:e,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const d=u.current,g=b.useContext(u7);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&Wz(u.current,r,s,g);const h=b.useRef(!1);b.useInsertionEffect(()=>{d&&h.current&&d.update(r,o)});const p=r[c7],x=b.useRef(!!p&&!((v=window.MotionHandoffIsComplete)!=null&&v.call(window,p))&&((w=window.MotionHasOptimisedAnimation)==null?void 0:w.call(window,p)));return oD(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),b.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{var S;(S=window.MotionHandoffMarkAsComplete)==null||S.call(window,p)}),x.current=!1),d.enteringChildren=void 0)}),d}function Wz(t,e,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:u,layoutCrossfade:d}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:d7(t.parent)),t.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&ff(o),visualElement:t,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:u})}function d7(t){if(t)return t.options.allowProjection!==!1?t.projection:d7(t.parent)}function O_(t,{forwardMotionProps:e=!1}={},r,n){r&&mz(r);const s=FC(t)?Oz:Iz;function a(o,l){let u;const d={...b.useContext(TC),...o,layoutId:Hz(o)},{isStatic:g}=d,h=wz(o),p=s(o,g);if(!g&&sC){zz();const x=Gz(d);u=x.MeasureLayout,h.visualElement=$z(t,p,d,n,x.ProjectionNode)}return c.jsxs(Ny.Provider,{value:h,children:[u&&h.visualElement?c.jsx(u,{visualElement:h.visualElement,...d}):null,Dz(t,o,Bz(p,h.visualElement,l),p,g,e)]})}a.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const i=b.forwardRef(a);return i[Lz]=t,i}function Hz({layoutId:t}){const e=b.useContext(rC).id;return e&&t!==void 0?e+"-"+t:t}function zz(t,e){b.useContext(ZD).strict}function Gz(t){const{drag:e,layout:r}=Vf;if(!e&&!r)return{};const n={...e,...r};return{MeasureLayout:e!=null&&e.isEnabled(t)||r!=null&&r.isEnabled(t)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function Vz(t,e){if(typeof Proxy>"u")return O_;const r=new Map,n=(a,i)=>O_(a,i,t,e),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,O_(i,void 0,t,e)),r.get(i))})}function f7({top:t,left:e,right:r,bottom:n}){return{x:{min:e,max:r},y:{min:t,max:n}}}function Kz({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Xz(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),n=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function L_(t){return t===void 0||t===1}function Vb({scale:t,scaleX:e,scaleY:r}){return!L_(t)||!L_(e)||!L_(r)}function cu(t){return Vb(t)||h7(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function h7(t){return e5(t.x)||e5(t.y)}function e5(t){return t&&t!=="0%"}function _1(t,e,r){const n=t-r,s=e*n;return r+s}function t5(t,e,r,n,s){return s!==void 0&&(t=_1(t,s,n)),_1(t,r,n)+e}function Kb(t,e=0,r=1,n,s){t.min=t5(t.min,e,r,n,s),t.max=t5(t.max,e,r,n,s)}function g7(t,{x:e,y:r}){Kb(t.x,e.translate,e.scale,e.originPoint),Kb(t.y,r.translate,r.scale,r.originPoint)}const r5=.999999999999,n5=1.0000000000001;function Yz(t,e,r,n=!1){const s=r.length;if(!s)return;e.x=e.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:l}=a.options;l&&l.props.style&&l.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&gf(t,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(e.x*=i.x.scale,e.y*=i.y.scale,g7(t,i)),n&&cu(a.latestValues)&&gf(t,a.latestValues))}e.x<n5&&e.x>r5&&(e.x=1),e.y<n5&&e.y>r5&&(e.y=1)}function hf(t,e){t.min=t.min+e,t.max=t.max+e}function s5(t,e,r,n,s=.5){const a=hn(t.min,t.max,s);Kb(t,e,r,a,n)}function gf(t,e){s5(t.x,e.x,e.scaleX,e.scale,e.originX),s5(t.y,e.y,e.scaleY,e.scale,e.originY)}function m7(t,e){return f7(Xz(t.getBoundingClientRect(),e))}function Jz(t,e,r){const n=m7(t,r),{scroll:s}=e;return s&&(hf(n.x,s.offset.x),hf(n.y,s.offset.y)),n}const a5=()=>({translate:0,scale:1,origin:0,originPoint:0}),mf=()=>({x:a5(),y:a5()}),i5=()=>({min:0,max:0}),Rn=()=>({x:i5(),y:i5()}),Xb={current:null},p7={current:!1};function Qz(){if(p7.current=!0,!!sC)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Xb.current=t.matches;t.addEventListener("change",e),e()}else Xb.current=!1}const qz=new WeakMap;function Zz(t,e,r){for(const n in e){const s=e[n],a=r[n];if(Gs(s))t.addValue(n,s);else if(Gs(a))t.addValue(n,Gf(s,{owner:t}));else if(a!==s)if(t.hasValue(n)){const i=t.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=t.getStaticValue(n);t.addValue(n,Gf(i!==void 0?i:s,{owner:t}))}}for(const n in r)e[n]===void 0&&t.removeValue(n);return e}const o5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class eG{scrapeMotionValuesFromProps(e,r,n){return{}}constructor({parent:e,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=_C,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Ca.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,an.render(this.render,!1,!0))};const{latestValues:l,renderState:u}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=r.initial?{...l}:{},this.renderState=u,this.parent=e,this.props=r,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=jy(r),this.isVariantNode=t7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:d,...g}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in g){const p=g[h];l[h]!==void 0&&Gs(p)&&p.set(l[h])}}mount(e){var r;this.current=e,qz.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,s)=>this.bindToMotionValue(s,n)),p7.current||Qz(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Xb.current,(r=this.parent)==null||r.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),wc(this.notifyUpdate),wc(this.render),this.valueSubscriptions.forEach(r=>r()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const r in this.events)this.events[r].clear();for(const r in this.features){const n=this.features[r];n&&(n.unmount(),n.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=fh.has(e);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[e]=i,this.props.onUpdate&&an.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in Vf){const r=Vf[e];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[e]&&s&&n(this.props)&&(this.features[e]=new s(this)),this.features[e]){const a=this.features[e];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Rn()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<o5.length;n++){const s=o5[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=e[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Zz(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const n=this.values.get(e);r!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&r!==void 0&&(n=Gf(r===null?void 0:r,{owner:this}),this.addValue(e,n)),n}readValue(e,r){let n=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return n!=null&&(typeof n=="string"&&(lD(n)||uD(n))?n=parseFloat(n):!uz(n)&&_c.test(r)&&(n=GD(e,r)),this.setBaseTarget(e,Gs(n)?n.get():n)),Gs(n)?n.get():n}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){var a;const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const i=PC(this.props,r,(a=this.presenceContext)==null?void 0:a.custom);i&&(n=i[e])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,e);return s!==void 0&&!Gs(s)?s:this.initialValues[e]!==void 0&&n===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new cC),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){kC.render(this.render)}}class x7 extends eG{constructor(){super(...arguments),this.KeyframeResolver=qH}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){return e.style?e.style[r]:void 0}removeValueFromRenderState(e,{vars:r,style:n}){delete r[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Gs(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function y7(t,{style:e,vars:r},n,s){const a=t.style;let i;for(i in e)a[i]=e[i];s==null||s.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function tG(t){return window.getComputedStyle(t)}class rG extends x7{constructor(){super(...arguments),this.type="html",this.renderInstance=y7}readValueFromInstance(e,r){var n;if(fh.has(r))return(n=this.projection)!=null&&n.isProjecting?Bb(r):xH(e,r);{const s=tG(e),a=(fC(r)?s.getPropertyValue(r):s[r])||0;return typeof a=="string"?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:r}){return m7(e,r)}build(e,r,n){AC(e,r,n.transformTemplate)}scrapeMotionValuesFromProps(e,r,n){return DC(e,r,n)}}const v7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function nG(t,e,r,n){y7(t,e,void 0,n);for(const s in e.attrs)t.setAttribute(v7.has(s)?s:RC(s),e.attrs[s])}class sG extends x7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Rn}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(fh.has(r)){const n=zD(r);return n&&n.default||0}return r=v7.has(r)?r:RC(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,n){return l7(e,r,n)}build(e,r,n){s7(e,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(e,r,n,s){nG(e,r,n,s)}mount(e){this.isSVGTag=i7(e.tagName),super.mount(e)}}const aG=(t,e)=>FC(t)?new sG(e):new rG(e,{allowProjection:t!==b.Fragment});function Tf(t,e,r){const n=t.getProps();return PC(n,e,r!==void 0?r:n.custom,t)}const Yb=t=>Array.isArray(t);function iG(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Gf(r))}function oG(t){return Yb(t)?t[t.length-1]||0:t}function lG(t,e){const r=Tf(t,e);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=oG(a[i]);iG(t,i,o)}}function cG(t){return!!(Gs(t)&&t.add)}function Jb(t,e){const r=t.getValue("willChange");if(cG(r))return r.add(e);if(!r&&vl.WillChange){const n=new vl.WillChange("auto");t.addValue("willChange",n),n.add(e)}}function w7(t){return t.props[c7]}const uG=t=>t!==null;function dG(t,{repeat:e,repeatType:r="loop"},n){const s=t.filter(uG),a=e&&r!=="loop"&&e%2===1?0:s.length-1;return s[a]}const fG={type:"spring",stiffness:500,damping:25,restSpeed:10},hG=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),gG={type:"keyframes",duration:.8},mG={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},pG=(t,{keyframes:e})=>e.length>2?gG:fh.has(t)?t.startsWith("scale")?hG(e[1]):fG:mG;function xG({when:t,delay:e,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:l,elapsed:u,...d}){return!!Object.keys(d).length}const MC=(t,e,r,n={},s,a)=>i=>{const o=bC(n,t)||{},l=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Ao(l);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...o,delay:-u,onUpdate:h=>{e.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:t,motionValue:e,element:a?void 0:s};xG(o)||Object.assign(d,pG(t,d)),d.duration&&(d.duration=Ao(d.duration)),d.repeatDelay&&(d.repeatDelay=Ao(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let g=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(zb(d),d.delay===0&&(g=!0)),(vl.instantAnimations||vl.skipAnimations)&&(g=!0,zb(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,g&&!a&&e.get()!==void 0){const h=dG(d.keyframes,o);if(h!==void 0){an.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new wC(d):new UH(d)};function yG({protectedKeys:t,needsAnimating:e},r){const n=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,n}function _7(t,e,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:i,...o}=e;n&&(a=n);const l=[],u=s&&t.animationState&&t.animationState.getState()[s];for(const d in o){const g=t.getValue(d,t.latestValues[d]??null),h=o[d];if(h===void 0||u&&yG(u,d))continue;const p={delay:r,...bC(a||{},d)},x=g.get();if(x!==void 0&&!g.isAnimating&&!Array.isArray(h)&&h===x&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const S=w7(t);if(S){const _=window.MotionHandoffAnimation(S,d,an);_!==null&&(p.startTime=_,v=!0)}}Jb(t,d),g.start(MC(d,g,h,t.shouldReduceMotion&&$D.has(d)?{type:!1}:p,t,v));const w=g.animation;w&&l.push(w)}return i&&Promise.all(l).then(()=>{an.update(()=>{i&&lG(t,i)})}),l}function b7(t,e,r,n=0,s=1){const a=Array.from(t).sort((u,d)=>u.sortNodePosition(d)).indexOf(e),i=t.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function Qb(t,e,r={}){var l;const n=Tf(t,e,r.type==="exit"?(l=t.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=t.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(_7(t,n,r)):()=>Promise.resolve(),i=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:d=0,staggerChildren:g,staggerDirection:h}=s;return vG(t,e,u,d,g,h,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[u,d]=o==="beforeChildren"?[a,i]:[i,a];return u().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function vG(t,e,r=0,n=0,s=0,a=1,i){const o=[];for(const l of t.variantChildren)l.notify("AnimationStart",e),o.push(Qb(l,e,{...i,delay:r+(typeof n=="function"?0:n)+b7(t.variantChildren,l,n,s,a)}).then(()=>l.notify("AnimationComplete",e)));return Promise.all(o)}function wG(t,e,r={}){t.notify("AnimationStart",e);let n;if(Array.isArray(e)){const s=e.map(a=>Qb(t,a,r));n=Promise.all(s)}else if(typeof e=="string")n=Qb(t,e,r);else{const s=typeof e=="function"?Tf(t,e,r.custom):e;n=Promise.all(_7(t,s,r))}return n.then(()=>{t.notify("AnimationComplete",e)})}function S7(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}const _G=NC.length;function k7(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?k7(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<_G;r++){const n=NC[r],s=t.props[n];(kg(s)||s===!1)&&(e[n]=s)}return e}const bG=[...EC].reverse(),SG=EC.length;function kG(t){return e=>Promise.all(e.map(({animation:r,options:n})=>wG(t,r,n)))}function CG(t){let e=kG(t),r=l5(),n=!0;const s=l=>(u,d)=>{var h;const g=Tf(t,d,l==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);if(g){const{transition:p,transitionEnd:x,...v}=g;u={...u,...v,...x}}return u};function a(l){e=l(t)}function i(l){const{props:u}=t,d=k7(t.parent)||{},g=[],h=new Set;let p={},x=1/0;for(let w=0;w<SG;w++){const S=bG[w],_=r[S],y=u[S]!==void 0?u[S]:d[S],k=kg(y),N=S===l?_.isActive:null;N===!1&&(x=w);let E=y===d[S]&&y!==u[S]&&k;if(E&&n&&t.manuallyAnimateOnMount&&(E=!1),_.protectedKeys={...p},!_.isActive&&N===null||!y&&!_.prevProp||Ay(y)||typeof y=="boolean")continue;const A=TG(_.prevProp,y);let C=A||S===l&&_.isActive&&!E&&k||w>x&&k,F=!1;const P=Array.isArray(y)?y:[y];let M=P.reduce(s(S),{});N===!1&&(M={});const{prevResolvedValues:I={}}=_,Y={...I,...M},se=G=>{C=!0,h.has(G)&&(F=!0,h.delete(G)),_.needsAnimating[G]=!0;const O=t.getValue(G);O&&(O.liveStyle=!1)};for(const G in Y){const O=M[G],R=I[G];if(p.hasOwnProperty(G))continue;let X=!1;Yb(O)&&Yb(R)?X=!S7(O,R):X=O!==R,X?O!=null?se(G):h.add(G):O!==void 0&&h.has(G)?se(G):_.protectedKeys[G]=!0}_.prevProp=y,_.prevResolvedValues=M,_.isActive&&(p={...p,...M}),n&&t.blockInitialAnimation&&(C=!1);const L=E&&A;C&&(!L||F)&&g.push(...P.map(G=>{const O={type:S};if(typeof G=="string"&&n&&!L&&t.manuallyAnimateOnMount&&t.parent){const{parent:R}=t,X=Tf(R,G);if(R.enteringChildren&&X){const{delayChildren:te}=X.transition||{};O.delay=b7(R.enteringChildren,t,te)}}return{animation:G,options:O}}))}if(h.size){const w={};if(typeof u.initial!="boolean"){const S=Tf(t,Array.isArray(u.initial)?u.initial[0]:u.initial);S&&S.transition&&(w.transition=S.transition)}h.forEach(S=>{const _=t.getBaseTarget(S),y=t.getValue(S);y&&(y.liveStyle=!0),w[S]=_??null}),g.push({animation:w})}let v=!!g.length;return n&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(v=!1),n=!1,v?e(g):Promise.resolve()}function o(l,u){var g;if(r[l].isActive===u)return Promise.resolve();(g=t.variantChildren)==null||g.forEach(h=>{var p;return(p=h.animationState)==null?void 0:p.setActive(l,u)}),r[l].isActive=u;const d=i(l);for(const h in r)r[h].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=l5(),n=!0}}}function TG(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!S7(e,t):!1}function nu(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function l5(){return{animate:nu(!0),whileInView:nu(),whileHover:nu(),whileTap:nu(),whileDrag:nu(),whileFocus:nu(),exit:nu()}}class Dc{constructor(e){this.isMounted=!1,this.node=e}update(){}}class EG extends Dc{constructor(e){super(e),e.animationState||(e.animationState=CG(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Ay(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let NG=0;class AG extends Dc{constructor(){super(...arguments),this.id=NG++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const s=this.node.animationState.setActive("exit",!e);r&&!e&&s.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const jG={animation:{Feature:EG},exit:{Feature:AG}};function Tg(t,e,r,n={passive:!0}){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r)}function cm(t){return{point:{x:t.pageX,y:t.pageY}}}const FG=t=>e=>CC(e)&&t(e,cm(e));function U0(t,e,r,n){return Tg(t,e,FG(r),n)}const C7=1e-4,PG=1-C7,DG=1+C7,T7=.01,RG=0-T7,MG=0+T7;function ia(t){return t.max-t.min}function IG(t,e,r){return Math.abs(t-e)<=r}function c5(t,e,r,n=.5){t.origin=n,t.originPoint=hn(e.min,e.max,t.origin),t.scale=ia(r)/ia(e),t.translate=hn(r.min,r.max,t.origin)-t.originPoint,(t.scale>=PG&&t.scale<=DG||isNaN(t.scale))&&(t.scale=1),(t.translate>=RG&&t.translate<=MG||isNaN(t.translate))&&(t.translate=0)}function $0(t,e,r,n){c5(t.x,e.x,r.x,n?n.originX:void 0),c5(t.y,e.y,r.y,n?n.originY:void 0)}function u5(t,e,r){t.min=r.min+e.min,t.max=t.min+ia(e)}function OG(t,e,r){u5(t.x,e.x,r.x),u5(t.y,e.y,r.y)}function d5(t,e,r){t.min=e.min-r.min,t.max=t.min+ia(e)}function W0(t,e,r){d5(t.x,e.x,r.x),d5(t.y,e.y,r.y)}function fi(t){return[t("x"),t("y")]}const E7=({current:t})=>t?t.ownerDocument.defaultView:null,f5=(t,e)=>Math.abs(t-e);function LG(t,e){const r=f5(t.x,e.x),n=f5(t.y,e.y);return Math.sqrt(r**2+n**2)}class N7{constructor(e,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=U_(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=LG(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:v}=h,{timestamp:w}=bs;this.history.push({...v,timestamp:w});const{onStart:S,onMove:_}=this.handlers;p||(S&&S(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),_&&_(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=B_(p,this.transformPagePoint),an.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const S=U_(h.type==="pointercancel"?this.lastMoveEventInfo:B_(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(h,S),v&&v(h,S)},!CC(e))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=cm(e),l=B_(o,this.transformPagePoint),{point:u}=l,{timestamp:d}=bs;this.history=[{...u,timestamp:d}];const{onSessionStart:g}=r;g&&g(e,U_(l,this.history)),this.removeListeners=im(U0(this.contextWindow,"pointermove",this.handlePointerMove),U0(this.contextWindow,"pointerup",this.handlePointerUp),U0(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),wc(this.updatePoint)}}function B_(t,e){return e?{point:e(t.point)}:t}function h5(t,e){return{x:t.x-e.x,y:t.y-e.y}}function U_({point:t},e){return{point:t,delta:h5(t,A7(e)),offset:h5(t,BG(e)),velocity:UG(e,.1)}}function BG(t){return t[0]}function A7(t){return t[t.length-1]}function UG(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,n=null;const s=A7(t);for(;r>=0&&(n=t[r],!(s.timestamp-n.timestamp>Ao(e)));)r--;if(!n)return{x:0,y:0};const a=jo(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function $G(t,{min:e,max:r},n){return e!==void 0&&t<e?t=n?hn(e,t,n.min):Math.max(t,e):r!==void 0&&t>r&&(t=n?hn(r,t,n.max):Math.min(t,r)),t}function g5(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function WG(t,{top:e,left:r,bottom:n,right:s}){return{x:g5(t.x,r,s),y:g5(t.y,e,n)}}function m5(t,e){let r=e.min-t.min,n=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,n]=[n,r]),{min:r,max:n}}function HG(t,e){return{x:m5(t.x,e.x),y:m5(t.y,e.y)}}function zG(t,e){let r=.5;const n=ia(t),s=ia(e);return s>n?r=_g(e.min,e.max-n,t.min):n>s&&(r=_g(t.min,t.max-s,e.min)),yl(0,1,r)}function GG(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const qb=.35;function VG(t=qb){return t===!1?t=0:t===!0&&(t=qb),{x:p5(t,"left","right"),y:p5(t,"top","bottom")}}function p5(t,e,r){return{min:x5(t,e),max:x5(t,r)}}function x5(t,e){return typeof t=="number"?t:t[e]||0}const KG=new WeakMap;class XG{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Rn(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=g=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(cm(g).point)},i=(g,h)=>{const{drag:p,dragPropagation:x,onDragStart:v}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=rz(p),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),fi(S=>{let _=this.getAxisMotionValue(S).get()||0;if(Fo.test(_)){const{projection:y}=this.visualElement;if(y&&y.layout){const k=y.layout.layoutBox[S];k&&(_=ia(k)*(parseFloat(_)/100))}}this.originPoint[S]=_}),v&&an.postRender(()=>v(g,h)),Jb(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},o=(g,h)=>{this.latestPointerEvent=g,this.latestPanInfo=h;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:v,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:S}=h;if(x&&this.currentDirection===null){this.currentDirection=YG(S),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",h.point,S),this.updateAxis("y",h.point,S),this.visualElement.render(),w&&w(g,h)},l=(g,h)=>{this.latestPointerEvent=g,this.latestPanInfo=h,this.stop(g,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>fi(g=>{var h;return this.getAnimationState(g)==="paused"&&((h=this.getAxisMotionValue(g).animation)==null?void 0:h.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new N7(e,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:E7(this.visualElement)})}stop(e,r){const n=e||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&an.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(e,r,n){const{drag:s}=this.getProps();if(!n||!Xp(e,s,this.currentDirection))return;const a=this.getAxisMotionValue(e);let i=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(i=$G(i,this.constraints[e],this.elastic[e])),a.set(i)}resolveConstraints(){var a;const{dragConstraints:e,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(a=this.visualElement.projection)==null?void 0:a.layout,s=this.constraints;e&&ff(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&n?this.constraints=WG(n.layoutBox,e):this.constraints=!1,this.elastic=VG(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&fi(i=>{this.constraints!==!1&&this.getAxisMotionValue(i)&&(this.constraints[i]=GG(n.layoutBox[i],this.constraints[i]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!ff(e))return!1;const n=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=Jz(n,s.root,this.visualElement.getTransformPagePoint());let i=HG(s.layout.layoutBox,a);if(r){const o=r(Kz(i));this.hasMutatedConstraints=!!o,o&&(i=f7(o))}return i}startAnimation(e){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=fi(d=>{if(!Xp(d,r,this.currentDirection))return;let g=l&&l[d]||{};i&&(g={min:0,max:0});const h=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?e[d]:0,bounceStiffness:h,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...g};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(e,r){const n=this.getAxisMotionValue(e);return Jb(this.visualElement,e),n.start(MC(e,n,0,r,this.visualElement,!1))}stopAnimation(){fi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){fi(e=>{var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.pause()})}getAnimationState(e){var r;return(r=this.getAxisMotionValue(e).animation)==null?void 0:r.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){fi(r=>{const{drag:n}=this.getProps();if(!Xp(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(e[r]-hn(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!ff(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};fi(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const l=o.get();s[i]=zG({min:l,max:l},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),fi(i=>{if(!Xp(i,e,null))return;const o=this.getAxisMotionValue(i),{min:l,max:u}=this.constraints[i];o.set(hn(l,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;KG.set(this.visualElement,this);const e=this.visualElement.current,r=U0(e,"pointerdown",l=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(l)}),n=()=>{const{dragConstraints:l}=this.getProps();ff(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),an.read(n);const i=Tg(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(fi(d=>{const g=this.getAxisMotionValue(d);g&&(this.originPoint[d]+=l[d].translate,g.set(g.get()+l[d].translate))}),this.visualElement.render())});return()=>{i(),r(),a(),o&&o()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=qb,dragMomentum:o=!0}=e;return{...e,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function Xp(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function YG(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class JG extends Dc{constructor(e){super(e),this.removeGroupControls=_i,this.removeListeners=_i,this.controls=new XG(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||_i}unmount(){this.removeGroupControls(),this.removeListeners()}}const y5=t=>(e,r)=>{t&&an.postRender(()=>t(e,r))};class QG extends Dc{constructor(){super(...arguments),this.removePointerDownListener=_i}onPointerDown(e){this.session=new N7(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:E7(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:y5(e),onStart:y5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&an.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=U0(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ox={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function v5(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const o0={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Qt.test(t))t=parseFloat(t);else return t;const r=v5(t,e.target.x),n=v5(t,e.target.y);return`${r}% ${n}%`}},qG={correct:(t,{treeScale:e,projectionDelta:r})=>{const n=t,s=_c.parse(t);if(s.length>5)return n;const a=_c.createTransformer(t),i=typeof s[0]!="number"?1:0,o=r.x.scale*e.x,l=r.y.scale*e.y;s[0+i]/=o,s[1+i]/=l;const u=hn(o,l,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let $_=!1;class ZG extends b.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=e;_z(eV),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),$_&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Ox.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,$_=!0,s||e.layoutDependency!==r||r===void 0||e.isPresent!==a?i.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?i.promote():i.relegate()||an.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),kC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=e;$_=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function j7(t){const[e,r]=qD(),n=b.useContext(rC);return c.jsx(ZG,{...t,layoutGroup:n,switchLayoutGroup:b.useContext(u7),isPresent:e,safeToRemove:r})}const eV={borderRadius:{...o0,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:o0,borderTopRightRadius:o0,borderBottomLeftRadius:o0,borderBottomRightRadius:o0,boxShadow:qG};function tV(t,e,r){const n=Gs(t)?t:Gf(t);return n.start(MC("",n,e,r)),n.animation}const rV=(t,e)=>t.depth-e.depth;class nV{constructor(){this.children=[],this.isDirty=!1}add(e){aC(this.children,e),this.isDirty=!0}remove(e){iC(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(rV),this.isDirty=!1,this.children.forEach(e)}}function sV(t,e){const r=Ca.now(),n=({timestamp:s})=>{const a=s-r;a>=e&&(wc(n),t(a-e))};return an.setup(n,!0),()=>wc(n)}const F7=["TopLeft","TopRight","BottomLeft","BottomRight"],aV=F7.length,w5=t=>typeof t=="string"?parseFloat(t):t,_5=t=>typeof t=="number"||Qt.test(t);function iV(t,e,r,n,s,a){s?(t.opacity=hn(0,r.opacity??1,oV(n)),t.opacityExit=hn(e.opacity??1,0,lV(n))):a&&(t.opacity=hn(e.opacity??1,r.opacity??1,n));for(let i=0;i<aV;i++){const o=`border${F7[i]}Radius`;let l=b5(e,o),u=b5(r,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||_5(l)===_5(u)?(t[o]=Math.max(hn(w5(l),w5(u),n),0),(Fo.test(u)||Fo.test(l))&&(t[o]+="%")):t[o]=u}(e.rotate||r.rotate)&&(t.rotate=hn(e.rotate||0,r.rotate||0,n))}function b5(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const oV=P7(0,.5,yD),lV=P7(.5,.95,_i);function P7(t,e,r){return n=>n<t?0:n>e?1:r(_g(t,e,n))}function S5(t,e){t.min=e.min,t.max=e.max}function ai(t,e){S5(t.x,e.x),S5(t.y,e.y)}function k5(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function C5(t,e,r,n,s){return t-=e,t=_1(t,1/r,n),s!==void 0&&(t=_1(t,1/s,n)),t}function cV(t,e=0,r=1,n=.5,s,a=t,i=t){if(Fo.test(e)&&(e=parseFloat(e),e=hn(i.min,i.max,e/100)-i.min),typeof e!="number")return;let o=hn(a.min,a.max,n);t===a&&(o-=e),t.min=C5(t.min,e,r,o,s),t.max=C5(t.max,e,r,o,s)}function T5(t,e,[r,n,s],a,i){cV(t,e[r],e[n],e[s],e.scale,a,i)}const uV=["x","scaleX","originX"],dV=["y","scaleY","originY"];function E5(t,e,r,n){T5(t.x,e,uV,r?r.x:void 0,n?n.x:void 0),T5(t.y,e,dV,r?r.y:void 0,n?n.y:void 0)}function N5(t){return t.translate===0&&t.scale===1}function D7(t){return N5(t.x)&&N5(t.y)}function A5(t,e){return t.min===e.min&&t.max===e.max}function fV(t,e){return A5(t.x,e.x)&&A5(t.y,e.y)}function j5(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function R7(t,e){return j5(t.x,e.x)&&j5(t.y,e.y)}function F5(t){return ia(t.x)/ia(t.y)}function P5(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class hV{constructor(){this.members=[]}add(e){aC(this.members,e),e.scheduleRender()}remove(e){if(iC(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(s=>e===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(e,r){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,r&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:n}=e;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function gV(t,e,r){let n="";const s=t.x.translate/e.x,a=t.y.translate/e.y,i=(r==null?void 0:r.z)||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:g,rotateY:h,skewX:p,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),g&&(n+=`rotateX(${g}deg) `),h&&(n+=`rotateY(${h}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(n+=`scale(${o}, ${l})`),n||"none"}const W_=["","X","Y","Z"],mV=1e3;let pV=0;function H_(t,e,r,n){const{latestValues:s}=e;s[t]&&(r[t]=s[t],e.setStaticValue(t,0),n&&(n[t]=0))}function M7(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=w7(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",an,!(s||a))}const{parent:n}=t;n&&!n.hasCheckedOptimisedAppear&&M7(n)}function I7({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=e==null?void 0:e()){this.id=pV++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(vV),this.nodes.forEach(SV),this.nodes.forEach(kV),this.nodes.forEach(wV)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new nV)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new cC),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const l=this.eventHandlers.get(i);l&&l.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=QD(i)&&!lz(i),this.instance=i;const{layoutId:o,layout:l,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),t){let d,g=0;const h=()=>this.root.updateBlockedByResize=!1;an.read(()=>{g=window.innerWidth}),t(i,()=>{const p=window.innerWidth;p!==g&&(g=p,this.root.updateBlockedByResize=!0,d&&d(),d=sV(h,250),Ox.hasAnimatedSinceResize&&(Ox.hasAnimatedSinceResize=!1,this.nodes.forEach(M5)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||l)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:g,hasRelativeLayoutChanged:h,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||AV,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),S=!this.targetLayout||!R7(this.targetLayout,p),_=!g&&h;if(this.options.layoutRoot||this.resumeFrom||_||g&&(S||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const y={...bC(x,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(y.delay=0,y.type=!1),this.startAnimation(y),this.setAnimationOrigin(d,_)}else g||M5(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),wc(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(CV),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&M7(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const g=this.path[d];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(D5);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(R5);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(bV),this.nodes.forEach(xV),this.nodes.forEach(yV)):this.nodes.forEach(R5),this.clearAllSnapshots();const o=Ca.now();bs.delta=yl(0,1e3/60,o-bs.timestamp),bs.timestamp=o,bs.isProcessing=!0,F_.update.process(bs),F_.preRender.process(bs),F_.render.process(bs),bs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,kC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(_V),this.sharedNodes.forEach(TV)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,an.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){an.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ia(this.snapshot.measuredBox.x)&&!ia(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Rn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const l=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:l,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!D7(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||cu(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return i&&(l=this.removeTransform(l)),jV(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:i}=this.options;if(!i)return Rn();const o=i.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(FV))){const{scroll:d}=this.root;d&&(hf(o.x,d.offset.x),hf(o.y,d.offset.y))}return o}removeElementScroll(i){var l;const o=Rn();if(ai(o,i),(l=this.scroll)!=null&&l.wasRoot)return o;for(let u=0;u<this.path.length;u++){const d=this.path[u],{scroll:g,options:h}=d;d!==this.root&&g&&h.layoutScroll&&(g.wasRoot&&ai(o,i),hf(o.x,g.offset.x),hf(o.y,g.offset.y))}return o}applyTransform(i,o=!1){const l=Rn();ai(l,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&gf(l,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),cu(d.latestValues)&&gf(l,d.latestValues)}return cu(this.latestValues)&&gf(l,this.latestValues),l}removeTransform(i){const o=Rn();ai(o,i);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!cu(u.latestValues))continue;Vb(u.latestValues)&&u.updateSnapshot();const d=Rn(),g=u.measurePageBox();ai(d,g),E5(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return cu(this.latestValues)&&E5(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==bs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(i||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:g}=this.options;if(!(!this.layout||!(d||g))){if(this.resolvedRelativeTargetAt=bs.timestamp,!this.targetDelta&&!this.relativeTarget){const p=this.getClosestProjectingParent();p&&p.layout&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rn(),this.relativeTargetOrigin=Rn(),W0(this.relativeTargetOrigin,this.layout.layoutBox,p.layout.layoutBox),ai(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Rn(),this.targetWithTransforms=Rn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),OG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ai(this.target,this.layout.layoutBox),g7(this.target,this.targetDelta)):ai(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const p=this.getClosestProjectingParent();p&&!!p.resumingFrom==!!this.resumingFrom&&!p.options.layoutScroll&&p.target&&this.animationProgress!==1?(this.relativeParent=p,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Rn(),this.relativeTargetOrigin=Rn(),W0(this.relativeTargetOrigin,this.target,p.target),ai(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||Vb(this.parent.latestValues)||h7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var x;const i=this.getLead(),o=!!this.resumingFrom||this!==i;let l=!0;if((this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===bs.timestamp&&(l=!1),l)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;ai(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,h=this.treeScale.y;Yz(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Rn());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(k5(this.prevProjectionDelta.x,this.projectionDelta.x),k5(this.prevProjectionDelta.y,this.projectionDelta.y)),$0(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==h||!P5(this.projectionDelta.x,this.prevProjectionDelta.x)||!P5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),i){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=mf(),this.projectionDelta=mf(),this.projectionDeltaWithTransform=mf()}setAnimationOrigin(i,o=!1){const l=this.snapshot,u=l?l.latestValues:{},d={...this.latestValues},g=mf();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Rn(),p=l?l.source:void 0,x=this.layout?this.layout.source:void 0,v=p!==x,w=this.getStack(),S=!w||w.members.length<=1,_=!!(v&&!S&&this.options.crossfade===!0&&!this.path.some(NV));this.animationProgress=0;let y;this.mixTargetDelta=k=>{const N=k/1e3;I5(g.x,i.x,N),I5(g.y,i.y,N),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(W0(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),EV(this.relativeTarget,this.relativeTargetOrigin,h,N),y&&fV(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=Rn()),ai(y,this.relativeTarget)),v&&(this.animationValues=d,iV(d,u,this.latestValues,N,_,S)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){var o,l,u;this.notifyListeners("animationStart"),(o=this.currentAnimation)==null||o.stop(),(u=(l=this.resumingFrom)==null?void 0:l.currentAnimation)==null||u.stop(),this.pendingAnimation&&(wc(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=an.update(()=>{Ox.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Gf(0)),this.currentAnimation=tV(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:d=>{this.mixTargetDelta(d),i.onUpdate&&i.onUpdate(d)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(mV),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:d}=i;if(!(!o||!l||!u)){if(this!==i&&this.layout&&u&&O7(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||Rn();const g=ia(this.layout.layoutBox.x);l.x.min=i.target.x.min,l.x.max=l.x.min+g;const h=ia(this.layout.layoutBox.y);l.y.min=i.target.y.min,l.y.max=l.y.min+h}ai(o,l),gf(o,d),$0(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new hV),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){var o;const{layoutId:i}=this.options;return i?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:i}=this.options;return i?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:l}=i;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&H_("z",i,u,this.animationValues);for(let d=0;d<W_.length;d++)H_(`rotate${W_[d]}`,i,u,this.animationValues),H_(`skew${W_[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const l=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Ix(o==null?void 0:o.pointerEvents)||"",i.transform=l?l(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Ix(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!cu(this.latestValues)&&(i.transform=l?l({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let g=gV(this.projectionDeltaWithTransform,this.treeScale,d);l&&(g=l(d,g)),i.transform=g;const{x:h,y:p}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in Cg){if(d[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:S}=Cg[x],_=g==="none"?d[x]:v(d[x],u);if(w){const y=w.length;for(let k=0;k<y;k++)i[w[k]]=_}else S?this.options.visualElement.renderState.vars[x]=_:i[x]=_}this.options.layoutId&&(i.pointerEvents=u===this?Ix(o==null?void 0:o.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>{var o;return(o=i.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(D5),this.root.sharedNodes.clear()}}}function xV(t){t.updateLayout()}function yV(t){var r;const e=((r=t.resumeFrom)==null?void 0:r.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:s}=t.layout,{animationType:a}=t.options,i=e.source!==t.layout.source;a==="size"?fi(g=>{const h=i?e.measuredBox[g]:e.layoutBox[g],p=ia(h);h.min=n[g].min,h.max=h.min+p}):O7(a,e.layoutBox,n)&&fi(g=>{const h=i?e.measuredBox[g]:e.layoutBox[g],p=ia(n[g]);h.max=h.min+p,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+p)});const o=mf();$0(o,n,e.layoutBox);const l=mf();i?$0(l,t.applyTransform(s,!0),e.measuredBox):$0(l,n,e.layoutBox);const u=!D7(o);let d=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:h,layout:p}=g;if(h&&p){const x=Rn();W0(x,e.layoutBox,h.layoutBox);const v=Rn();W0(v,n,p.layoutBox),R7(x,v)||(d=!0),g.options.layoutRoot&&(t.relativeTarget=v,t.relativeTargetOrigin=x,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:e,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeLayoutChanged:d})}else if(t.isLead()){const{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function vV(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function wV(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function _V(t){t.clearSnapshot()}function D5(t){t.clearMeasurements()}function R5(t){t.isLayoutDirty=!1}function bV(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function M5(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function SV(t){t.resolveTargetDelta()}function kV(t){t.calcProjection()}function CV(t){t.resetSkewAndRotation()}function TV(t){t.removeLeadSnapshot()}function I5(t,e,r){t.translate=hn(e.translate,0,r),t.scale=hn(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function O5(t,e,r,n){t.min=hn(e.min,r.min,n),t.max=hn(e.max,r.max,n)}function EV(t,e,r,n){O5(t.x,e.x,r.x,n),O5(t.y,e.y,r.y,n)}function NV(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const AV={duration:.45,ease:[.4,0,.1,1]},L5=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),B5=L5("applewebkit/")&&!L5("chrome/")?Math.round:_i;function U5(t){t.min=B5(t.min),t.max=B5(t.max)}function jV(t){U5(t.x),U5(t.y)}function O7(t,e,r){return t==="position"||t==="preserve-aspect"&&!IG(F5(e),F5(r),.2)}function FV(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const PV=I7({attachResizeListener:(t,e)=>Tg(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),z_={current:void 0},L7=I7({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!z_.current){const t=new PV({});t.mount(window),t.setOptions({layoutScroll:!0}),z_.current=t}return z_.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),DV={pan:{Feature:QG},drag:{Feature:JG,ProjectionNode:L7,MeasureLayout:j7}};function $5(t,e,r){const{props:n}=t;t.animationState&&n.whileHover&&t.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&an.postRender(()=>a(e,cm(e)))}class RV extends Dc{mount(){const{current:e}=this.node;e&&(this.unmount=nz(e,(r,n)=>($5(this.node,n,"Start"),s=>$5(this.node,s,"End"))))}unmount(){}}class MV extends Dc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=im(Tg(this.node.current,"focus",()=>this.onFocus()),Tg(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function W5(t,e,r){const{props:n}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&n.whileTap&&t.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&an.postRender(()=>a(e,cm(e)))}class IV extends Dc{mount(){const{current:e}=this.node;e&&(this.unmount=oz(e,(r,n)=>(W5(this.node,n,"Start"),(s,{success:a})=>W5(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Zb=new WeakMap,G_=new WeakMap,OV=t=>{const e=Zb.get(t.target);e&&e(t)},LV=t=>{t.forEach(OV)};function BV({root:t,...e}){const r=t||document;G_.has(r)||G_.set(r,{});const n=G_.get(r),s=JSON.stringify(e);return n[s]||(n[s]=new IntersectionObserver(LV,{root:t,...e})),n[s]}function UV(t,e,r){const n=BV(e);return Zb.set(t,r),n.observe(t),()=>{Zb.delete(t),n.unobserve(t)}}const $V={some:0,all:1};class WV extends Dc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=e,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:$V[s]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:g}=this.node.getProps(),h=u?d:g;h&&h(l)};return UV(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(HV(e,r))&&this.startObserver()}unmount(){}}function HV({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const zV={inView:{Feature:WV},tap:{Feature:IV},focus:{Feature:MV},hover:{Feature:RV}},GV={layout:{ProjectionNode:L7,MeasureLayout:j7}},VV={...jG,...zV,...DV,...GV},Le=Vz(VV,aG),Ue=({children:t,variant:e="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",l={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return c.jsx(Le.button,{className:`${o} ${l[e]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:t})},ir=({size:t="md",color:e="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return c.jsx(Le.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[t]} ${s[e]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},eo=({type:t="info",message:e="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,l]=b.useState(!0),[u,d]=b.useState(!1),g=b.useRef(null),h=b.useRef(null);b.useEffect(()=>{if(r>0)return h.current=setTimeout(()=>{p()},r),()=>{h.current&&clearTimeout(h.current)}},[r]);const p=b.useCallback(()=>{u||(d(!0),h.current&&clearTimeout(h.current),setTimeout(()=>{l(!1),s&&s()},300))},[u,s]),x=b.useCallback(S=>{S.key==="Escape"&&p()},[p]);if(!o)return null;const v=["notification",`notification-${t}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),w=()=>{switch(t){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return c.jsx("div",{ref:g,className:v,role:"alert","aria-live":"polite",onKeyDown:x,tabIndex:-1,...i,children:c.jsxs("div",{className:"notification-content",children:[c.jsx("div",{className:"notification-icon","aria-hidden":"true",children:w()}),c.jsx("div",{className:"notification-body",children:c.jsx("div",{className:"notification-message",children:e})}),n&&c.jsx("button",{className:"notification-close",onClick:p,type:"button","aria-label":"Close notification",children:""})]})})},qs=()=>{const[t,e]=b.useState([]),r=b.useCallback((a,i="info",o={})=>{const l=Date.now()+Math.random(),u={id:l,message:a,type:i,...o};return e(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(l)},o.duration||3e3),l},[]),n=b.useCallback(a=>{e(i=>i.filter(o=>o.id!==a))},[]),s=b.useCallback(()=>{e([])},[]);return{notifications:t,showNotification:r,removeNotification:n,clearAllNotifications:s}},ro=()=>{const[t,e]=b.useState(!1),[r,n]=b.useState(null),[s,a]=b.useState(null),i=b.useRef(null);b.useRef(new Map);const o=b.useRef(0),l=3,u=1e3,d=b.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);b.useEffect(()=>d,[d]);const g=b.useCallback(async(z,G={})=>{try{e(!0),n(null),i.current=new AbortController;const O=G.method||"POST",R={method:O,headers:{"Content-Type":"application/json",...G.headers},signal:i.current.signal,...G};O!=="GET"&&O!=="HEAD"&&(R.body=JSON.stringify(G.data||{})),console.log(`[API] Making request to: ${z}`,R);const X=await fetch(z,R);if(!X.ok)throw new Error(`HTTP error! status: ${X.status}`);const te=await X.json();if(console.log("[API] Response received:",te),te.success)return a(te),o.current=0,te;throw new Error(te.error||te.message||"Request failed")}catch(O){if(O.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",O),n(O.message||"Request failed"),o.current<l){o.current++;const R=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${R}ms (attempt ${o.current}/${l})`),await new Promise(X=>setTimeout(X,R)),g(z,G)}throw O}finally{e(!1),i.current=null}},[]),h=b.useCallback(async(z,G={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(z,G)}catch(O){throw console.error("[API] Authenticated request failed:",O),O}},[]),p=b.useCallback(async(z,G)=>{try{const O=`/.netlify/functions/get-test-questions?test_type=${z}&test_id=${G}`;console.log(`[API] Getting test info for ${z}_${G}`);const X=await(await h(O)).json();if(X.success)return console.log("[API] Test info retrieved successfully:",X.test_info),X.test_info;throw new Error(X.error||"Failed to get test info")}catch(O){throw console.error("[API] Failed to get test info:",O),O}},[h]),x=b.useCallback(async(z,G)=>{try{const O=`/.netlify/functions/get-test-questions?test_type=${z}&test_id=${G}`;console.log(`[API] Getting test questions for ${z}_${G}`);const X=await(await h(O)).json();if(X.success)return console.log("[API] Test questions retrieved successfully:",X.questions),X.questions;throw new Error(X.error||"Failed to get test questions")}catch(O){throw console.error("[API] Failed to get test questions:",O),O}},[h]),v=b.useCallback(async()=>{try{const z="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const O=await(await h(z)).json();if(O.success)return console.log("[API] Student active tests loaded successfully:",O.tests),O.tests;throw new Error(O.error||"Failed to load student active tests")}catch(z){throw console.error("[API] Failed to load student active tests:",z),z}},[h]),w=b.useCallback(async(z,G,O)=>{try{let R;switch(z){case"true_false":R="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":R="/.netlify/functions/submit-multiple-choice-test";break;case"input":R="/.netlify/functions/submit-input-test";break;case"matching_type":R="/.netlify/functions/submit-matching-type-test";break;default:throw new Error(`Unknown test type: ${z}`)}console.log(`[API] Submitting ${z} test:`,O);const te=await(await h(R,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(te.success)return console.log("[API] Test submitted successfully:",te),te;throw new Error(te.error||"Failed to submit test")}catch(R){throw console.error("[API] Failed to submit test:",R),R}},[h]),S=b.useCallback(async z=>{try{const G="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",z);const R=await(await h(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(R.success)return console.log("[API] Multiple choice test saved successfully:",R),R;throw new Error(R.error||"Failed to save multiple choice test")}catch(G){throw console.error("[API] Failed to save multiple choice test:",G),G}},[h]),_=b.useCallback(async z=>{try{const G="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",z);const R=await(await h(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(R.success)return console.log("[API] True/false test saved successfully:",R),R;throw new Error(R.error||"Failed to save true/false test")}catch(G){throw console.error("[API] Failed to save true/false test:",G),G}},[h]),y=b.useCallback(async z=>{try{const G="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",z);const R=await(await h(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(R.success)return console.log("[API] Input test saved successfully:",R),R;throw new Error(R.error||"Failed to save input test")}catch(G){throw console.error("[API] Failed to save input test:",G),G}},[h]),k=b.useCallback(async z=>{try{const G="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",z);const R=await(await h(G,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(R.success)return console.log("[API] Test assigned successfully:",R),R;throw new Error(R.error||"Failed to assign test")}catch(G){throw console.error("[API] Failed to assign test:",G),G}},[h]),N=b.useCallback(async()=>{try{const z="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const O=await(await h(z)).json();if(O.success)return console.log("[API] Teacher active tests loaded successfully:",O.tests),O.tests;throw new Error(O.error||"Failed to load teacher active tests")}catch(z){throw console.error("[API] Failed to load teacher active tests:",z),z}},[h]),E=b.useCallback(async()=>{try{const z="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const O=await(await h(z)).json();if(O.success)return console.log("[API] All users loaded successfully:",O.users),O.users;throw new Error(O.error||"Failed to get all users")}catch(z){throw console.error("[API] Failed to get all users:",z),z}},[h]),A=b.useCallback(async()=>{try{const z="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const O=await(await h(z)).json();if(O.success)return console.log("[API] All teachers loaded successfully:",O.teachers),O.teachers;throw new Error(O.error||"Failed to get all teachers")}catch(z){throw console.error("[API] Failed to get all teachers:",z),z}},[h]),C=b.useCallback(async()=>{try{const z="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const O=await(await h(z)).json();if(O.success)return console.log("[API] All subjects loaded successfully:",O.subjects),O.subjects;throw new Error(O.error||"Failed to get all subjects")}catch(z){throw console.error("[API] Failed to get all subjects:",z),z}},[h]),F=b.useCallback(()=>{n(null)},[]),P=b.useCallback(()=>{a(null)},[]),M=b.useCallback(()=>{e(!1),n(null),a(null),o.current=0,d()},[d]),I=b.useCallback(async(z,G={})=>{const R=await(await h(z,{...G,method:"GET"})).json();if(R.success)return R;throw new Error(R.error||"Request failed")},[h]),Y=b.useCallback(async(z,G,O={})=>{const X=await(await h(z,{...O,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)})).json();if(X.success)return X;throw new Error(X.error||"Request failed")},[h]),se=b.useCallback(async(z,G,O={})=>{const X=await(await h(z,{...O,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)})).json();if(X.success)return X;throw new Error(X.error||"Request failed")},[h]),L=b.useCallback(async(z,G={})=>{const R=await(await h(z,{...G,method:"DELETE"})).json();if(R.success)return R;throw new Error(R.error||"Request failed")},[h]);return{loading:t,error:r,data:s,sendRequest:g,makeAuthenticatedRequest:h,get:I,post:Y,put:se,delete:L,getTestInfo:p,getTestQuestions:x,loadStudentActiveTests:v,submitTest:w,saveMultipleChoiceTest:S,saveTrueFalseTest:_,saveInputTest:y,assignTestToClasses:k,loadTeacherActiveTests:N,getAllUsers:E,getAllTeachers:A,getAllSubjects:C,clearError:F,clearData:P,reset:M,cleanup:d}},KV="modulepreload",XV=function(t){return"/"+t},H5={},Cu=function(e,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(l=>{if(l=XV(l),l in H5)return;H5[l]=!0;const u=l.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${d}`))return;const g=document.createElement("link");if(g.rel=u?"stylesheet":KV,u||(g.as="script"),g.crossOrigin="",g.href=l,o&&g.setAttribute("nonce",o),document.head.appendChild(g),u)return new Promise((h,p)=>{g.addEventListener("load",h),g.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return e().catch(a)})};var IC={exports:{}},Fy={},b1={},ur={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t._registerNode=t.Konva=t.glob=void 0;const e=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}t.glob=typeof Vx<"u"?Vx:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},t.Konva={_global:t.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return t.Konva.angleDeg?s*e:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return t.Konva.DD.isDragging},isTransforming(){var s;return(s=t.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!t.Konva.DD.node},releaseCanvasOnDestroy:!0,document:t.glob.document,_injectGlobal(s){t.glob.Konva=s}};const n=s=>{t.Konva[s.prototype.getClassName()]=s};t._registerNode=n,t.Konva._injectGlobal(t.Konva)})(ur);var wn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.Transform=void 0;const e=ur;class r{constructor(k=[1,0,0,1,0,0]){this.dirty=!1,this.m=k&&k.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(k){k.m[0]=this.m[0],k.m[1]=this.m[1],k.m[2]=this.m[2],k.m[3]=this.m[3],k.m[4]=this.m[4],k.m[5]=this.m[5]}point(k){const N=this.m;return{x:N[0]*k.x+N[2]*k.y+N[4],y:N[1]*k.x+N[3]*k.y+N[5]}}translate(k,N){return this.m[4]+=this.m[0]*k+this.m[2]*N,this.m[5]+=this.m[1]*k+this.m[3]*N,this}scale(k,N){return this.m[0]*=k,this.m[1]*=k,this.m[2]*=N,this.m[3]*=N,this}rotate(k){const N=Math.cos(k),E=Math.sin(k),A=this.m[0]*N+this.m[2]*E,C=this.m[1]*N+this.m[3]*E,F=this.m[0]*-E+this.m[2]*N,P=this.m[1]*-E+this.m[3]*N;return this.m[0]=A,this.m[1]=C,this.m[2]=F,this.m[3]=P,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(k,N){const E=this.m[0]+this.m[2]*N,A=this.m[1]+this.m[3]*N,C=this.m[2]+this.m[0]*k,F=this.m[3]+this.m[1]*k;return this.m[0]=E,this.m[1]=A,this.m[2]=C,this.m[3]=F,this}multiply(k){const N=this.m[0]*k.m[0]+this.m[2]*k.m[1],E=this.m[1]*k.m[0]+this.m[3]*k.m[1],A=this.m[0]*k.m[2]+this.m[2]*k.m[3],C=this.m[1]*k.m[2]+this.m[3]*k.m[3],F=this.m[0]*k.m[4]+this.m[2]*k.m[5]+this.m[4],P=this.m[1]*k.m[4]+this.m[3]*k.m[5]+this.m[5];return this.m[0]=N,this.m[1]=E,this.m[2]=A,this.m[3]=C,this.m[4]=F,this.m[5]=P,this}invert(){const k=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),N=this.m[3]*k,E=-this.m[1]*k,A=-this.m[2]*k,C=this.m[0]*k,F=k*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),P=k*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=N,this.m[1]=E,this.m[2]=A,this.m[3]=C,this.m[4]=F,this.m[5]=P,this}getMatrix(){return this.m}decompose(){const k=this.m[0],N=this.m[1],E=this.m[2],A=this.m[3],C=this.m[4],F=this.m[5],P=k*A-N*E,M={x:C,y:F,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(k!=0||N!=0){const I=Math.sqrt(k*k+N*N);M.rotation=N>0?Math.acos(k/I):-Math.acos(k/I),M.scaleX=I,M.scaleY=P/I,M.skewX=(k*E+N*A)/P,M.skewY=0}else if(E!=0||A!=0){const I=Math.sqrt(E*E+A*A);M.rotation=Math.PI/2-(A>0?Math.acos(-E/I):-Math.acos(E/I)),M.scaleX=P/I,M.scaleY=I,M.skewX=0,M.skewY=(k*E+N*A)/P}return M.rotation=t.Util._getRotation(M.rotation),M}}t.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,l=180/Math.PI,u="#",d="",g="0",h="Konva warning: ",p="Konva error: ",x="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let S=[];const _=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(y){setTimeout(y,60)};t.Util={_isElement(y){return!!(y&&y.nodeType==1)},_isFunction(y){return!!(y&&y.constructor&&y.call&&y.apply)},_isPlainObject(y){return!!y&&y.constructor===Object},_isArray(y){return Object.prototype.toString.call(y)===n},_isNumber(y){return Object.prototype.toString.call(y)===s&&!isNaN(y)&&isFinite(y)},_isString(y){return Object.prototype.toString.call(y)===a},_isBoolean(y){return Object.prototype.toString.call(y)===i},isObject(y){return y instanceof Object},isValidSelector(y){if(typeof y!="string")return!1;const k=y[0];return k==="#"||k==="."||k===k.toUpperCase()},_sign(y){return y===0||y>0?1:-1},requestAnimFrame(y){S.push(y),S.length===1&&_(function(){const k=S;S=[],k.forEach(function(N){N()})})},createCanvasElement(){const y=document.createElement("canvas");try{y.style=y.style||{}}catch{}return y},createImageElement(){return document.createElement("img")},_isInDocument(y){for(;y=y.parentNode;)if(y==document)return!0;return!1},_urlToImage(y,k){const N=t.Util.createImageElement();N.onload=function(){k(N)},N.src=y},_rgbToHex(y,k,N){return((1<<24)+(y<<16)+(k<<8)+N).toString(16).slice(1)},_hexToRgb(y){y=y.replace(u,d);const k=parseInt(y,16);return{r:k>>16&255,g:k>>8&255,b:k&255}},getRandomColor(){let y=(Math.random()*16777215<<0).toString(16);for(;y.length<6;)y=g+y;return u+y},getRGB(y){let k;return y in v?(k=v[y],{r:k[0],g:k[1],b:k[2]}):y[0]===u?this._hexToRgb(y.substring(1)):y.substr(0,4)===x?(k=w.exec(y.replace(/ /g,"")),{r:parseInt(k[1],10),g:parseInt(k[2],10),b:parseInt(k[3],10)}):{r:0,g:0,b:0}},colorToRGBA(y){return y=y||"black",t.Util._namedColorToRBA(y)||t.Util._hex3ColorToRGBA(y)||t.Util._hex4ColorToRGBA(y)||t.Util._hex6ColorToRGBA(y)||t.Util._hex8ColorToRGBA(y)||t.Util._rgbColorToRGBA(y)||t.Util._rgbaColorToRGBA(y)||t.Util._hslColorToRGBA(y)},_namedColorToRBA(y){const k=v[y.toLowerCase()];return k?{r:k[0],g:k[1],b:k[2],a:1}:null},_rgbColorToRGBA(y){if(y.indexOf("rgb(")===0){y=y.match(/rgb\(([^)]+)\)/)[1];const k=y.split(/ *, */).map(Number);return{r:k[0],g:k[1],b:k[2],a:1}}},_rgbaColorToRGBA(y){if(y.indexOf("rgba(")===0){y=y.match(/rgba\(([^)]+)\)/)[1];const k=y.split(/ *, */).map((N,E)=>N.slice(-1)==="%"?E===3?parseInt(N)/100:parseInt(N)/100*255:Number(N));return{r:k[0],g:k[1],b:k[2],a:k[3]}}},_hex8ColorToRGBA(y){if(y[0]==="#"&&y.length===9)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:parseInt(y.slice(7,9),16)/255}},_hex6ColorToRGBA(y){if(y[0]==="#"&&y.length===7)return{r:parseInt(y.slice(1,3),16),g:parseInt(y.slice(3,5),16),b:parseInt(y.slice(5,7),16),a:1}},_hex4ColorToRGBA(y){if(y[0]==="#"&&y.length===5)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:parseInt(y[4]+y[4],16)/255}},_hex3ColorToRGBA(y){if(y[0]==="#"&&y.length===4)return{r:parseInt(y[1]+y[1],16),g:parseInt(y[2]+y[2],16),b:parseInt(y[3]+y[3],16),a:1}},_hslColorToRGBA(y){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(y)){const[k,...N]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(y),E=Number(N[0])/360,A=Number(N[1])/100,C=Number(N[2])/100;let F,P,M;if(A===0)return M=C*255,{r:Math.round(M),g:Math.round(M),b:Math.round(M),a:1};C<.5?F=C*(1+A):F=C+A-C*A;const I=2*C-F,Y=[0,0,0];for(let se=0;se<3;se++)P=E+1/3*-(se-1),P<0&&P++,P>1&&P--,6*P<1?M=I+(F-I)*6*P:2*P<1?M=F:3*P<2?M=I+(F-I)*(2/3-P)*6:M=I,Y[se]=M*255;return{r:Math.round(Y[0]),g:Math.round(Y[1]),b:Math.round(Y[2]),a:1}}},haveIntersection(y,k){return!(k.x>y.x+y.width||k.x+k.width<y.x||k.y>y.y+y.height||k.y+k.height<y.y)},cloneObject(y){const k={};for(const N in y)this._isPlainObject(y[N])?k[N]=this.cloneObject(y[N]):this._isArray(y[N])?k[N]=this.cloneArray(y[N]):k[N]=y[N];return k},cloneArray(y){return y.slice(0)},degToRad(y){return y*o},radToDeg(y){return y*l},_degToRad(y){return t.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),t.Util.degToRad(y)},_radToDeg(y){return t.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),t.Util.radToDeg(y)},_getRotation(y){return e.Konva.angleDeg?t.Util.radToDeg(y):y},_capitalize(y){return y.charAt(0).toUpperCase()+y.slice(1)},throw(y){throw new Error(p+y)},error(y){console.error(p+y)},warn(y){e.Konva.showWarnings&&console.warn(h+y)},each(y,k){for(const N in y)k(N,y[N])},_inRange(y,k,N){return k<=y&&y<N},_getProjectionToSegment(y,k,N,E,A,C){let F,P,M;const I=(y-N)*(y-N)+(k-E)*(k-E);if(I==0)F=y,P=k,M=(A-N)*(A-N)+(C-E)*(C-E);else{const Y=((A-y)*(N-y)+(C-k)*(E-k))/I;Y<0?(F=y,P=k,M=(y-A)*(y-A)+(k-C)*(k-C)):Y>1?(F=N,P=E,M=(N-A)*(N-A)+(E-C)*(E-C)):(F=y+Y*(N-y),P=k+Y*(E-k),M=(F-A)*(F-A)+(P-C)*(P-C))}return[F,P,M]},_getProjectionToLine(y,k,N){const E=t.Util.cloneObject(y);let A=Number.MAX_VALUE;return k.forEach(function(C,F){if(!N&&F===k.length-1)return;const P=k[(F+1)%k.length],M=t.Util._getProjectionToSegment(C.x,C.y,P.x,P.y,y.x,y.y),I=M[0],Y=M[1],se=M[2];se<A&&(E.x=I,E.y=Y,A=se)}),E},_prepareArrayForTween(y,k,N){const E=[],A=[];if(y.length>k.length){const F=k;k=y,y=F}for(let F=0;F<y.length;F+=2)E.push({x:y[F],y:y[F+1]});for(let F=0;F<k.length;F+=2)A.push({x:k[F],y:k[F+1]});const C=[];return A.forEach(function(F){const P=t.Util._getProjectionToLine(F,E,N);C.push(P.x),C.push(P.y)}),C},_prepareToStringify(y){let k;y.visitedByCircularReferenceRemoval=!0;for(const N in y)if(y.hasOwnProperty(N)&&y[N]&&typeof y[N]=="object"){if(k=Object.getOwnPropertyDescriptor(y,N),y[N].visitedByCircularReferenceRemoval||t.Util._isElement(y[N]))if(k.configurable)delete y[N];else return null;else if(t.Util._prepareToStringify(y[N])===null)if(k.configurable)delete y[N];else return null}return delete y.visitedByCircularReferenceRemoval,y},_assign(y,k){for(const N in k)y[N]=k[N];return y},_getFirstPointerId(y){return y.touches?y.changedTouches[0].identifier:y.pointerId||999},releaseCanvas(...y){e.Konva.releaseCanvasOnDestroy&&y.forEach(k=>{k.width=0,k.height=0})},drawRoundedRectPath(y,k,N,E){let A=0,C=0,F=0,P=0;typeof E=="number"?A=C=F=P=Math.min(E,k/2,N/2):(A=Math.min(E[0]||0,k/2,N/2),C=Math.min(E[1]||0,k/2,N/2),P=Math.min(E[2]||0,k/2,N/2),F=Math.min(E[3]||0,k/2,N/2)),y.moveTo(A,0),y.lineTo(k-C,0),y.arc(k-C,C,C,Math.PI*3/2,0,!1),y.lineTo(k,N-P),y.arc(k-P,N-P,P,0,Math.PI/2,!1),y.lineTo(F,N),y.arc(F,N-F,F,Math.PI/2,Math.PI,!1),y.lineTo(0,A),y.arc(A,A,A,Math.PI,Math.PI*3/2,!1)}}})(wn);var ln={},Yi={},cl={};Object.defineProperty(cl,"__esModule",{value:!0});cl.HitContext=cl.SceneContext=cl.Context=void 0;const B7=wn,YV=ur;function JV(t){const e=[],r=t.length,n=B7.Util;for(let s=0;s<r;s++){let a=t[s];n._isNumber(a)?a=Math.round(a*1e3)/1e3:n._isString(a)||(a=a+""),e.push(a)}return e}const z5=",",QV="(",qV=")",ZV="([",eK="])",tK=";",rK="()",nK="=",G5=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],sK=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],aK=100;class Py{constructor(e){this.canvas=e,YV.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(e){e.fillEnabled()&&this._fill(e)}_fill(e){}strokeShape(e){e.hasStroke()&&this._stroke(e)}_stroke(e){}fillStrokeShape(e){e.attrs.fillAfterStrokeEnabled?(this.strokeShape(e),this.fillShape(e)):(this.fillShape(e),this.strokeShape(e))}getTrace(e,r){let n=this.traceArr,s=n.length,a="",i,o,l,u;for(i=0;i<s;i++)o=n[i],l=o.method,l?(u=o.args,a+=l,e?a+=rK:B7.Util._isArray(u[0])?a+=ZV+u.join(z5)+eK:(r&&(u=u.map(d=>typeof d=="number"?Math.floor(d):d)),a+=QV+u.join(z5)+qV)):(a+=o.property,e||(a+=nK+o.val)),a+=tK;return a}clearTrace(){this.traceArr=[]}_trace(e){let r=this.traceArr,n;r.push(e),n=r.length,n>=aK&&r.shift()}reset(){const e=this.getCanvas().getPixelRatio();this.setTransform(1*e,0,0,1*e,0,0)}getCanvas(){return this.canvas}clear(e){const r=this.getCanvas();e?this.clearRect(e.x||0,e.y||0,e.width||0,e.height||0):this.clearRect(0,0,r.getWidth()/r.pixelRatio,r.getHeight()/r.pixelRatio)}_applyLineCap(e){const r=e.attrs.lineCap;r&&this.setAttr("lineCap",r)}_applyOpacity(e){const r=e.getAbsoluteOpacity();r!==1&&this.setAttr("globalAlpha",r)}_applyLineJoin(e){const r=e.attrs.lineJoin;r&&this.setAttr("lineJoin",r)}setAttr(e,r){this._context[e]=r}arc(e,r,n,s,a,i){this._context.arc(e,r,n,s,a,i)}arcTo(e,r,n,s,a){this._context.arcTo(e,r,n,s,a)}beginPath(){this._context.beginPath()}bezierCurveTo(e,r,n,s,a,i){this._context.bezierCurveTo(e,r,n,s,a,i)}clearRect(e,r,n,s){this._context.clearRect(e,r,n,s)}clip(...e){this._context.clip.apply(this._context,e)}closePath(){this._context.closePath()}createImageData(e,r){const n=arguments;if(n.length===2)return this._context.createImageData(e,r);if(n.length===1)return this._context.createImageData(e)}createLinearGradient(e,r,n,s){return this._context.createLinearGradient(e,r,n,s)}createPattern(e,r){return this._context.createPattern(e,r)}createRadialGradient(e,r,n,s,a,i){return this._context.createRadialGradient(e,r,n,s,a,i)}drawImage(e,r,n,s,a,i,o,l,u){const d=arguments,g=this._context;d.length===3?g.drawImage(e,r,n):d.length===5?g.drawImage(e,r,n,s,a):d.length===9&&g.drawImage(e,r,n,s,a,i,o,l,u)}ellipse(e,r,n,s,a,i,o,l){this._context.ellipse(e,r,n,s,a,i,o,l)}isPointInPath(e,r,n,s){return n?this._context.isPointInPath(n,e,r,s):this._context.isPointInPath(e,r,s)}fill(...e){this._context.fill.apply(this._context,e)}fillRect(e,r,n,s){this._context.fillRect(e,r,n,s)}strokeRect(e,r,n,s){this._context.strokeRect(e,r,n,s)}fillText(e,r,n,s){s?this._context.fillText(e,r,n,s):this._context.fillText(e,r,n)}measureText(e){return this._context.measureText(e)}getImageData(e,r,n,s){return this._context.getImageData(e,r,n,s)}lineTo(e,r){this._context.lineTo(e,r)}moveTo(e,r){this._context.moveTo(e,r)}rect(e,r,n,s){this._context.rect(e,r,n,s)}roundRect(e,r,n,s,a){this._context.roundRect(e,r,n,s,a)}putImageData(e,r,n){this._context.putImageData(e,r,n)}quadraticCurveTo(e,r,n,s){this._context.quadraticCurveTo(e,r,n,s)}restore(){this._context.restore()}rotate(e){this._context.rotate(e)}save(){this._context.save()}scale(e,r){this._context.scale(e,r)}setLineDash(e){this._context.setLineDash?this._context.setLineDash(e):"mozDash"in this._context?this._context.mozDash=e:"webkitLineDash"in this._context&&(this._context.webkitLineDash=e)}getLineDash(){return this._context.getLineDash()}setTransform(e,r,n,s,a,i){this._context.setTransform(e,r,n,s,a,i)}stroke(e){e?this._context.stroke(e):this._context.stroke()}strokeText(e,r,n,s){this._context.strokeText(e,r,n,s)}transform(e,r,n,s,a,i){this._context.transform(e,r,n,s,a,i)}translate(e,r){this._context.translate(e,r)}_enableTrace(){let e=this,r=G5.length,n=this.setAttr,s,a;const i=function(o){let l=e[o],u;e[o]=function(){return a=JV(Array.prototype.slice.call(arguments,0)),u=l.apply(e,arguments),e._trace({method:o,args:a}),u}};for(s=0;s<r;s++)i(G5[s]);e.setAttr=function(){n.apply(e,arguments);const o=arguments[0];let l=arguments[1];(o==="shadowOffsetX"||o==="shadowOffsetY"||o==="shadowBlur")&&(l=l/this.canvas.getPixelRatio()),e._trace({property:o,val:l})}}_applyGlobalCompositeOperation(e){const r=e.attrs.globalCompositeOperation;!r||r==="source-over"||this.setAttr("globalCompositeOperation",r)}}cl.Context=Py;sK.forEach(function(t){Object.defineProperty(Py.prototype,t,{get(){return this._context[t]},set(e){this._context[t]=e}})});class iK extends Py{constructor(e,{willReadFrequently:r=!1}={}){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:r})}_fillColor(e){const r=e.fill();this.setAttr("fillStyle",r),e._fillFunc(this)}_fillPattern(e){this.setAttr("fillStyle",e._getFillPattern()),e._fillFunc(this)}_fillLinearGradient(e){const r=e._getLinearGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fillRadialGradient(e){const r=e._getRadialGradient();r&&(this.setAttr("fillStyle",r),e._fillFunc(this))}_fill(e){const r=e.fill(),n=e.getFillPriority();if(r&&n==="color"){this._fillColor(e);return}const s=e.getFillPatternImage();if(s&&n==="pattern"){this._fillPattern(e);return}const a=e.getFillLinearGradientColorStops();if(a&&n==="linear-gradient"){this._fillLinearGradient(e);return}const i=e.getFillRadialGradientColorStops();if(i&&n==="radial-gradient"){this._fillRadialGradient(e);return}r?this._fillColor(e):s?this._fillPattern(e):a?this._fillLinearGradient(e):i&&this._fillRadialGradient(e)}_strokeLinearGradient(e){const r=e.getStrokeLinearGradientStartPoint(),n=e.getStrokeLinearGradientEndPoint(),s=e.getStrokeLinearGradientColorStops(),a=this.createLinearGradient(r.x,r.y,n.x,n.y);if(s){for(let i=0;i<s.length;i+=2)a.addColorStop(s[i],s[i+1]);this.setAttr("strokeStyle",a)}}_stroke(e){const r=e.dash(),n=e.getStrokeScaleEnabled();if(e.hasStroke()){if(!n){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e),r&&e.dashEnabled()&&(this.setLineDash(r),this.setAttr("lineDashOffset",e.dashOffset())),this.setAttr("lineWidth",e.strokeWidth()),e.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),e.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(e):this.setAttr("strokeStyle",e.stroke()),e._strokeFunc(this),n||this.restore()}}_applyShadow(e){var r,n,s;const a=(r=e.getShadowRGBA())!==null&&r!==void 0?r:"black",i=(n=e.getShadowBlur())!==null&&n!==void 0?n:5,o=(s=e.getShadowOffset())!==null&&s!==void 0?s:{x:0,y:0},l=e.getAbsoluteScale(),u=this.canvas.getPixelRatio(),d=l.x*u,g=l.y*u;this.setAttr("shadowColor",a),this.setAttr("shadowBlur",i*Math.min(Math.abs(d),Math.abs(g))),this.setAttr("shadowOffsetX",o.x*d),this.setAttr("shadowOffsetY",o.y*g)}}cl.SceneContext=iK;class oK extends Py{constructor(e){super(e),this._context=e._canvas.getContext("2d",{willReadFrequently:!0})}_fill(e){this.save(),this.setAttr("fillStyle",e.colorKey),e._fillFuncHit(this),this.restore()}strokeShape(e){e.hasHitStroke()&&this._stroke(e)}_stroke(e){if(e.hasHitStroke()){const r=e.getStrokeScaleEnabled();if(!r){this.save();const a=this.getCanvas().getPixelRatio();this.setTransform(a,0,0,a,0,0)}this._applyLineCap(e);const n=e.hitStrokeWidth(),s=n==="auto"?e.strokeWidth():n;this.setAttr("lineWidth",s),this.setAttr("strokeStyle",e.colorKey),e._strokeFuncHit(this),r||this.restore()}}}cl.HitContext=oK;Object.defineProperty(Yi,"__esModule",{value:!0});Yi.HitCanvas=Yi.SceneCanvas=Yi.Canvas=void 0;const S1=wn,U7=cl,$7=ur;let Yp;function lK(){if(Yp)return Yp;const t=S1.Util.createCanvasElement(),e=t.getContext("2d");return Yp=function(){const r=$7.Konva._global.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return r/n}(),S1.Util.releaseCanvas(t),Yp}class OC{constructor(e){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const n=(e||{}).pixelRatio||$7.Konva.pixelRatio||lK();this.pixelRatio=n,this._canvas=S1.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(e){const r=this.pixelRatio;this.pixelRatio=e,this.setSize(this.getWidth()/r,this.getHeight()/r)}setWidth(e){this.width=this._canvas.width=e*this.pixelRatio,this._canvas.style.width=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}setHeight(e){this.height=this._canvas.height=e*this.pixelRatio,this._canvas.style.height=e+"px";const r=this.pixelRatio;this.getContext()._context.scale(r,r)}getWidth(){return this.width}getHeight(){return this.height}setSize(e,r){this.setWidth(e||0),this.setHeight(r||0)}toDataURL(e,r){try{return this._canvas.toDataURL(e,r)}catch{try{return this._canvas.toDataURL()}catch(s){return S1.Util.error("Unable to get data URL. "+s.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}}Yi.Canvas=OC;class cK extends OC{constructor(e={width:0,height:0,willReadFrequently:!1}){super(e),this.context=new U7.SceneContext(this,{willReadFrequently:e.willReadFrequently}),this.setSize(e.width,e.height)}}Yi.SceneCanvas=cK;class uK extends OC{constructor(e={width:0,height:0}){super(e),this.hitCanvas=!0,this.context=new U7.HitContext(this),this.setSize(e.width,e.height)}}Yi.HitCanvas=uK;var Dy={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.DD=void 0;const e=ur,r=wn;t.DD={get isDragging(){let n=!1;return t.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return t.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];t.DD._dragElements.forEach((a,i)=>{const{node:o}=a,l=o.getStage();l.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=l._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];t.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(t.DD.justDragged=!0,e.Konva._mouseListenClick=!1,e.Konva._touchListenClick=!1,e.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof e.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){t.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&t.DD._dragElements.delete(a)})}},e.Konva.isBrowser&&(window.addEventListener("mouseup",t.DD._endDragBefore,!0),window.addEventListener("touchend",t.DD._endDragBefore,!0),window.addEventListener("touchcancel",t.DD._endDragBefore,!0),window.addEventListener("mousemove",t.DD._drag),window.addEventListener("touchmove",t.DD._drag),window.addEventListener("mouseup",t.DD._endDragAfter,!1),window.addEventListener("touchend",t.DD._endDragAfter,!1),window.addEventListener("touchcancel",t.DD._endDragAfter,!1))})(Dy);var mr={},Zt={};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.RGBComponent=dK;Zt.alphaComponent=fK;Zt.getNumberValidator=hK;Zt.getNumberOrArrayOfNumbersValidator=gK;Zt.getNumberOrAutoValidator=mK;Zt.getStringValidator=pK;Zt.getStringOrGradientValidator=xK;Zt.getFunctionValidator=yK;Zt.getNumberArrayValidator=vK;Zt.getBooleanValidator=wK;Zt.getComponentValidator=_K;const kl=ur,Nn=wn;function Cl(t){return Nn.Util._isString(t)?'"'+t+'"':Object.prototype.toString.call(t)==="[object Number]"||Nn.Util._isBoolean(t)?t:Object.prototype.toString.call(t)}function dK(t){return t>255?255:t<0?0:Math.round(t)}function fK(t){return t>1?1:t<1e-4?1e-4:t}function hK(){if(kl.Konva.isUnminified)return function(t,e){return Nn.Util._isNumber(t)||Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a number.'),t}}function gK(t){if(kl.Konva.isUnminified)return function(e,r){let n=Nn.Util._isNumber(e),s=Nn.Util._isArray(e)&&e.length==t;return!n&&!s&&Nn.Util.warn(Cl(e)+' is a not valid value for "'+r+'" attribute. The value should be a number or Array<number>('+t+")"),e}}function mK(){if(kl.Konva.isUnminified)return function(t,e){return Nn.Util._isNumber(t)||t==="auto"||Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a number or "auto".'),t}}function pK(){if(kl.Konva.isUnminified)return function(t,e){return Nn.Util._isString(t)||Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a string.'),t}}function xK(){if(kl.Konva.isUnminified)return function(t,e){const r=Nn.Util._isString(t),n=Object.prototype.toString.call(t)==="[object CanvasGradient]"||t&&t.addColorStop;return r||n||Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a string or a native gradient.'),t}}function yK(){if(kl.Konva.isUnminified)return function(t,e){return Nn.Util._isFunction(t)||Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a function.'),t}}function vK(){if(kl.Konva.isUnminified)return function(t,e){const r=Int8Array?Object.getPrototypeOf(Int8Array):null;return r&&t instanceof r||(Nn.Util._isArray(t)?t.forEach(function(n){Nn.Util._isNumber(n)||Nn.Util.warn('"'+e+'" attribute has non numeric element '+n+". Make sure that all elements are numbers.")}):Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a array of numbers.')),t}}function wK(){if(kl.Konva.isUnminified)return function(t,e){return t===!0||t===!1||Nn.Util.warn(Cl(t)+' is a not valid value for "'+e+'" attribute. The value should be a boolean.'),t}}function _K(t){if(kl.Konva.isUnminified)return function(e,r){return e==null||Nn.Util.isObject(e)||Nn.Util.warn(Cl(e)+' is a not valid value for "'+r+'" attribute. The value should be an object with properties '+t),e}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Factory=void 0;const e=wn,r=Zt,n="get",s="set";t.Factory={addGetterSetter(a,i,o,l,u){t.Factory.addGetter(a,i,o),t.Factory.addSetter(a,i,l,u),t.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const l=n+e.Util._capitalize(i);a.prototype[l]=a.prototype[l]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,l){const u=s+e.Util._capitalize(i);a.prototype[u]||t.Factory.overWriteSetter(a,i,o,l)},overWriteSetter(a,i,o,l){const u=s+e.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),l&&l.call(this),this}},addComponentsGetterSetter(a,i,o,l,u){const d=o.length,g=e.Util._capitalize,h=n+g(i),p=s+g(i);a.prototype[h]=function(){const v={};for(let w=0;w<d;w++){const S=o[w];v[S]=this.getAttr(i+g(S))}return v};const x=(0,r.getComponentValidator)(o);a.prototype[p]=function(v){const w=this.attrs[i];l&&(v=l.call(this,v,i)),x&&x.call(this,v,i);for(const S in v)v.hasOwnProperty(S)&&this._setAttr(i+g(S),v[S]);return v||o.forEach(S=>{this._setAttr(i+g(S),void 0)}),this._fireChangeEvent(i,w,v),u&&u.call(this),this},t.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=e.Util._capitalize(i),l=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[l](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,l){e.Util.error("Adding deprecated "+i);const u=n+e.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){e.Util.error(d);const g=this.attrs[i];return g===void 0?o:g},t.Factory.addSetter(a,i,l,function(){e.Util.error(d)}),t.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){e.Util.each(i,function(o,l){const u=a.prototype[l],d=n+e.Util._capitalize(o),g=s+e.Util._capitalize(o);function h(){u.apply(this,arguments),e.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+l+'" instead.')}a.prototype[o]=h,a.prototype[d]=h,a.prototype[g]=h})},afterSetFilter(){this._filterUpToDate=!1}}})(mr);Object.defineProperty(ln,"__esModule",{value:!0});ln.Node=void 0;const Od=Yi,ii=Dy,um=mr,Wl=ur,vr=wn,Ln=Zt,Lx="absoluteOpacity",Jp="allEventListeners",Qo="absoluteTransform",V5="absoluteScale",su="canvas",bK="Change",SK="children",kK="konva",eS="listening",CK="mouseenter",TK="mouseleave",EK="pointerenter",NK="pointerleave",AK="touchenter",jK="touchleave",K5="set",X5="Shape",Bx=" ",Y5="stage",Gl="transform",FK="Stage",tS="visible",PK=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(Bx);let DK=1;class tr{constructor(e){this._id=DK++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(e),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(e){(e===Gl||e===Qo)&&this._cache.get(e)?this._cache.get(e).dirty=!0:e?this._cache.delete(e):this._cache.clear()}_getCache(e,r){let n=this._cache.get(e);return(n===void 0||(e===Gl||e===Qo)&&n.dirty===!0)&&(n=r.call(this),this._cache.set(e,n)),n}_calculate(e,r,n){if(!this._attachedDepsListeners.get(e)){const s=r.map(a=>a+"Change.konva").join(Bx);this.on(s,()=>{this._clearCache(e)}),this._attachedDepsListeners.set(e,!0)}return this._getCache(e,n)}_getCanvasCache(){return this._cache.get(su)}_clearSelfAndDescendantCache(e){this._clearCache(e),e===Qo&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(su)){const{scene:e,filter:r,hit:n,buffer:s}=this._cache.get(su);vr.Util.releaseCanvas(e,r,n,s),this._cache.delete(su)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(e){const r=e||{};let n={};(r.x===void 0||r.y===void 0||r.width===void 0||r.height===void 0)&&(n=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let s=Math.ceil(r.width||n.width),a=Math.ceil(r.height||n.height),i=r.pixelRatio,o=r.x===void 0?Math.floor(n.x):r.x,l=r.y===void 0?Math.floor(n.y):r.y,u=r.offset||0,d=r.drawBorder||!1,g=r.hitCanvasPixelRatio||1;if(!s||!a){vr.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const h=Math.abs(Math.round(n.x)-o)>.5?1:0,p=Math.abs(Math.round(n.y)-l)>.5?1:0;s+=u*2+h,a+=u*2+p,o-=u,l-=u;const x=new Od.SceneCanvas({pixelRatio:i,width:s,height:a}),v=new Od.SceneCanvas({pixelRatio:i,width:0,height:0,willReadFrequently:!0}),w=new Od.HitCanvas({pixelRatio:g,width:s,height:a}),S=x.getContext(),_=w.getContext(),y=new Od.SceneCanvas({width:x.width/x.pixelRatio+Math.abs(o),height:x.height/x.pixelRatio+Math.abs(l),pixelRatio:x.pixelRatio}),k=y.getContext();return w.isCache=!0,x.isCache=!0,this._cache.delete(su),this._filterUpToDate=!1,r.imageSmoothingEnabled===!1&&(x.getContext()._context.imageSmoothingEnabled=!1,v.getContext()._context.imageSmoothingEnabled=!1),S.save(),_.save(),k.save(),S.translate(-o,-l),_.translate(-o,-l),k.translate(-o,-l),y.x=o,y.y=l,this._isUnderCache=!0,this._clearSelfAndDescendantCache(Lx),this._clearSelfAndDescendantCache(V5),this.drawScene(x,this,y),this.drawHit(w,this),this._isUnderCache=!1,S.restore(),_.restore(),d&&(S.save(),S.beginPath(),S.rect(0,0,s,a),S.closePath(),S.setAttr("strokeStyle","red"),S.setAttr("lineWidth",5),S.stroke(),S.restore()),this._cache.set(su,{scene:x,filter:v,hit:w,buffer:y,x:o,y:l}),this._requestDraw(),this}isCached(){return this._cache.has(su)}getClientRect(e){throw new Error('abstract "getClientRect" method call')}_transformedRect(e,r){const n=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}];let s=1/0,a=1/0,i=-1/0,o=-1/0;const l=this.getAbsoluteTransform(r);return n.forEach(function(u){const d=l.point(u);s===void 0&&(s=i=d.x,a=o=d.y),s=Math.min(s,d.x),a=Math.min(a,d.y),i=Math.max(i,d.x),o=Math.max(o,d.y)}),{x:s,y:a,width:i-s,height:o-a}}_drawCachedSceneCanvas(e){e.save(),e._applyOpacity(this),e._applyGlobalCompositeOperation(this);const r=this._getCanvasCache();e.translate(r.x,r.y);const n=this._getCachedSceneCanvas(),s=n.pixelRatio;e.drawImage(n._canvas,0,0,n.width/s,n.height/s),e.restore()}_drawCachedHitCanvas(e){const r=this._getCanvasCache(),n=r.hit;e.save(),e.translate(r.x,r.y),e.drawImage(n._canvas,0,0,n.width/n.pixelRatio,n.height/n.pixelRatio),e.restore()}_getCachedSceneCanvas(){let e=this.filters(),r=this._getCanvasCache(),n=r.scene,s=r.filter,a=s.getContext(),i,o,l,u;if(e){if(!this._filterUpToDate){const d=n.pixelRatio;s.setSize(n.width/n.pixelRatio,n.height/n.pixelRatio);try{for(i=e.length,a.clear(),a.drawImage(n._canvas,0,0,n.getWidth()/d,n.getHeight()/d),o=a.getImageData(0,0,s.getWidth(),s.getHeight()),l=0;l<i;l++){if(u=e[l],typeof u!="function"){vr.Util.error("Filter should be type of function, but got "+typeof u+" instead. Please check correct filters");continue}u.call(this,o),a.putImageData(o,0,0)}}catch(g){vr.Util.error("Unable to apply filter. "+g.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return s}return n}on(e,r){if(this._cache&&this._cache.delete(Jp),arguments.length===3)return this._delegate.apply(this,arguments);const n=e.split(Bx);for(let s=0;s<n.length;s++){const i=n[s].split("."),o=i[0],l=i[1]||"";this.eventListeners[o]||(this.eventListeners[o]=[]),this.eventListeners[o].push({name:l,handler:r})}return this}off(e,r){let n=(e||"").split(Bx),s=n.length,a,i,o,l,u,d;if(this._cache&&this._cache.delete(Jp),!e)for(i in this.eventListeners)this._off(i);for(a=0;a<s;a++)if(o=n[a],l=o.split("."),u=l[0],d=l[1],u)this.eventListeners[u]&&this._off(u,d,r);else for(i in this.eventListeners)this._off(i,d,r);return this}dispatchEvent(e){const r={target:this,type:e.type,evt:e};return this.fire(e.type,r),this}addEventListener(e,r){return this.on(e,function(n){r.call(this,n.evt)}),this}removeEventListener(e){return this.off(e),this}_delegate(e,r,n){const s=this;this.on(e,function(a){const i=a.target.findAncestors(r,!0,s);for(let o=0;o<i.length;o++)a=vr.Util.cloneObject(a),a.currentTarget=i[o],n.call(i[o],a)})}remove(){return this.isDragging()&&this.stopDrag(),ii.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(Qo),this._clearSelfAndDescendantCache(Lx),this._clearSelfAndDescendantCache(V5),this._clearSelfAndDescendantCache(Y5),this._clearSelfAndDescendantCache(tS),this._clearSelfAndDescendantCache(eS)}_remove(){this._clearCaches();const e=this.getParent();e&&e.children&&(e.children.splice(this.index,1),e._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(e){const r="get"+vr.Util._capitalize(e);return vr.Util._isFunction(this[r])?this[r]():this.attrs[e]}getAncestors(){let e=this.getParent(),r=[];for(;e;)r.push(e),e=e.getParent();return r}getAttrs(){return this.attrs||{}}setAttrs(e){return this._batchTransformChanges(()=>{let r,n;if(!e)return this;for(r in e)r!==SK&&(n=K5+vr.Util._capitalize(r),vr.Util._isFunction(this[n])?this[n](e[r]):this._setAttr(r,e[r]))}),this}isListening(){return this._getCache(eS,this._isListening)}_isListening(e){if(!this.listening())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isListening(e):!0}isVisible(){return this._getCache(tS,this._isVisible)}_isVisible(e){if(!this.visible())return!1;const n=this.getParent();return n&&n!==e&&this!==e?n._isVisible(e):!0}shouldDrawHit(e,r=!1){if(e)return this._isVisible(e)&&this._isListening(e);const n=this.getLayer();let s=!1;ii.DD._dragElements.forEach(i=>{i.dragStatus==="dragging"&&(i.node.nodeType==="Stage"||i.node.getLayer()===n)&&(s=!0)});const a=!r&&!Wl.Konva.hitOnDragEnabled&&(s||Wl.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!a}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let e=this.getDepth(),r=this,n=0,s,a,i,o;function l(d){for(s=[],a=d.length,i=0;i<a;i++)o=d[i],n++,o.nodeType!==X5&&(s=s.concat(o.getChildren().slice())),o._id===r._id&&(i=a);s.length>0&&s[0].getDepth()<=e&&l(s)}const u=this.getStage();return r.nodeType!==FK&&u&&l(u.getChildren()),n}getDepth(){let e=0,r=this.parent;for(;r;)e++,r=r.parent;return e}_batchTransformChanges(e){this._batchingTransformChange=!0,e(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(Gl),this._clearSelfAndDescendantCache(Qo)),this._needClearTransformCache=!1}setPosition(e){return this._batchTransformChanges(()=>{this.x(e.x),this.y(e.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const e=this.getStage();if(!e)return null;const r=e.getPointerPosition();if(!r)return null;const n=this.getAbsoluteTransform().copy();return n.invert(),n.point(r)}getAbsolutePosition(e){let r=!1,n=this.parent;for(;n;){if(n.isCached()){r=!0;break}n=n.parent}r&&!e&&(e=!0);const s=this.getAbsoluteTransform(e).getMatrix(),a=new vr.Transform,i=this.offset();return a.m=s.slice(),a.translate(i.x,i.y),a.getTranslation()}setAbsolutePosition(e){const{x:r,y:n,...s}=this._clearTransform();this.attrs.x=r,this.attrs.y=n,this._clearCache(Gl);const a=this._getAbsoluteTransform().copy();return a.invert(),a.translate(e.x,e.y),e={x:this.attrs.x+a.getTranslation().x,y:this.attrs.y+a.getTranslation().y},this._setTransform(s),this.setPosition({x:e.x,y:e.y}),this._clearCache(Gl),this._clearSelfAndDescendantCache(Qo),this}_setTransform(e){let r;for(r in e)this.attrs[r]=e[r]}_clearTransform(){const e={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,e}move(e){let r=e.x,n=e.y,s=this.x(),a=this.y();return r!==void 0&&(s+=r),n!==void 0&&(a+=n),this.setPosition({x:s,y:a}),this}_eachAncestorReverse(e,r){let n=[],s=this.getParent(),a,i;if(!(r&&r._id===this._id)){for(n.unshift(this);s&&(!r||s._id!==r._id);)n.unshift(s),s=s.parent;for(a=n.length,i=0;i<a;i++)e(n[i])}}rotate(e){return this.rotation(this.rotation()+e),this}moveToTop(){if(!this.parent)return vr.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return vr.Util.warn("Node has no parent. moveUp function is ignored."),!1;const e=this.index,r=this.parent.getChildren().length;return e<r-1?(this.parent.children.splice(e,1),this.parent.children.splice(e+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return vr.Util.warn("Node has no parent. moveDown function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.splice(e-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return vr.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const e=this.index;return e>0?(this.parent.children.splice(e,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(e){if(!this.parent)return vr.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(e<0||e>=this.parent.children.length)&&vr.Util.warn("Unexpected value "+e+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const r=this.index;return this.parent.children.splice(r,1),this.parent.children.splice(e,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(Lx,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let e=this.opacity();const r=this.getParent();return r&&!r._isUnderCache&&(e*=r.getAbsoluteOpacity()),e}moveTo(e){return this.getParent()!==e&&(this._remove(),e.add(this)),this}toObject(){let e=this.getAttrs(),r,n,s,a,i;const o={attrs:{},className:this.getClassName()};for(r in e)n=e[r],i=vr.Util.isObject(n)&&!vr.Util._isPlainObject(n)&&!vr.Util._isArray(n),!i&&(s=typeof this[r]=="function"&&this[r],delete e[r],a=s?s.call(this):null,e[r]=n,a!==n&&(o.attrs[r]=n));return vr.Util._prepareToStringify(o)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(e,r,n){const s=[];r&&this._isMatch(e)&&s.push(this);let a=this.parent;for(;a;){if(a===n)return s;a._isMatch(e)&&s.push(a),a=a.parent}return s}isAncestorOf(e){return!1}findAncestor(e,r,n){return this.findAncestors(e,r,n)[0]}_isMatch(e){if(!e)return!1;if(typeof e=="function")return e(this);let r=e.replace(/ /g,"").split(","),n=r.length,s,a;for(s=0;s<n;s++)if(a=r[s],vr.Util.isValidSelector(a)||(vr.Util.warn('Selector "'+a+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),vr.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),vr.Util.warn("Konva is awesome, right?")),a.charAt(0)==="#"){if(this.id()===a.slice(1))return!0}else if(a.charAt(0)==="."){if(this.hasName(a.slice(1)))return!0}else if(this.className===a||this.nodeType===a)return!0;return!1}getLayer(){const e=this.getParent();return e?e.getLayer():null}getStage(){return this._getCache(Y5,this._getStage)}_getStage(){const e=this.getParent();return e?e.getStage():null}fire(e,r={},n){return r.target=r.target||this,n?this._fireAndBubble(e,r):this._fire(e,r),this}getAbsoluteTransform(e){return e?this._getAbsoluteTransform(e):this._getCache(Qo,this._getAbsoluteTransform)}_getAbsoluteTransform(e){let r;if(e)return r=new vr.Transform,this._eachAncestorReverse(function(n){const s=n.transformsEnabled();s==="all"?r.multiply(n.getTransform()):s==="position"&&r.translate(n.x()-n.offsetX(),n.y()-n.offsetY())},e),r;{r=this._cache.get(Qo)||new vr.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(r):r.reset();const n=this.transformsEnabled();if(n==="all")r.multiply(this.getTransform());else if(n==="position"){const s=this.attrs.x||0,a=this.attrs.y||0,i=this.attrs.offsetX||0,o=this.attrs.offsetY||0;r.translate(s-i,a-o)}return r.dirty=!1,r}}getAbsoluteScale(e){let r=this;for(;r;)r._isUnderCache&&(e=r),r=r.getParent();const s=this.getAbsoluteTransform(e).decompose();return{x:s.scaleX,y:s.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(Gl,this._getTransform)}_getTransform(){var e,r;const n=this._cache.get(Gl)||new vr.Transform;n.reset();const s=this.x(),a=this.y(),i=Wl.Konva.getAngle(this.rotation()),o=(e=this.attrs.scaleX)!==null&&e!==void 0?e:1,l=(r=this.attrs.scaleY)!==null&&r!==void 0?r:1,u=this.attrs.skewX||0,d=this.attrs.skewY||0,g=this.attrs.offsetX||0,h=this.attrs.offsetY||0;return(s!==0||a!==0)&&n.translate(s,a),i!==0&&n.rotate(i),(u!==0||d!==0)&&n.skew(u,d),(o!==1||l!==1)&&n.scale(o,l),(g!==0||h!==0)&&n.translate(-1*g,-1*h),n.dirty=!1,n}clone(e){let r=vr.Util.cloneObject(this.attrs),n,s,a,i,o;for(n in e)r[n]=e[n];const l=new this.constructor(r);for(n in this.eventListeners)for(s=this.eventListeners[n],a=s.length,i=0;i<a;i++)o=s[i],o.name.indexOf(kK)<0&&(l.eventListeners[n]||(l.eventListeners[n]=[]),l.eventListeners[n].push(o));return l}_toKonvaCanvas(e){e=e||{};const r=this.getClientRect(),n=this.getStage(),s=e.x!==void 0?e.x:Math.floor(r.x),a=e.y!==void 0?e.y:Math.floor(r.y),i=e.pixelRatio||1,o=new Od.SceneCanvas({width:e.width||Math.ceil(r.width)||(n?n.width():0),height:e.height||Math.ceil(r.height)||(n?n.height():0),pixelRatio:i}),l=o.getContext(),u=new Od.SceneCanvas({width:o.width/o.pixelRatio+Math.abs(s),height:o.height/o.pixelRatio+Math.abs(a),pixelRatio:o.pixelRatio});return e.imageSmoothingEnabled===!1&&(l._context.imageSmoothingEnabled=!1),l.save(),(s||a)&&l.translate(-1*s,-1*a),this.drawScene(o,void 0,u),l.restore(),o}toCanvas(e){return this._toKonvaCanvas(e)._canvas}toDataURL(e){e=e||{};const r=e.mimeType||null,n=e.quality||null,s=this._toKonvaCanvas(e).toDataURL(r,n);return e.callback&&e.callback(s),s}toImage(e){return new Promise((r,n)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,vr.Util._urlToImage(this.toDataURL(e),function(a){r(a),s==null||s(a)})}catch(s){n(s)}})}toBlob(e){return new Promise((r,n)=>{try{const s=e==null?void 0:e.callback;s&&delete e.callback,this.toCanvas(e).toBlob(a=>{r(a),s==null||s(a)},e==null?void 0:e.mimeType,e==null?void 0:e.quality)}catch(s){n(s)}})}setSize(e){return this.width(e.width),this.height(e.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():Wl.Konva.dragDistance}_off(e,r,n){let s=this.eventListeners[e],a,i,o;for(a=0;a<s.length;a++)if(i=s[a].name,o=s[a].handler,(i!=="konva"||r==="konva")&&(!r||i===r)&&(!n||n===o)){if(s.splice(a,1),s.length===0){delete this.eventListeners[e];break}a--}}_fireChangeEvent(e,r,n){this._fire(e+bK,{oldVal:r,newVal:n})}addName(e){if(!this.hasName(e)){const r=this.name(),n=r?r+" "+e:e;this.name(n)}return this}hasName(e){if(!e)return!1;const r=this.name();return r?(r||"").split(/\s/g).indexOf(e)!==-1:!1}removeName(e){const r=(this.name()||"").split(/\s/g),n=r.indexOf(e);return n!==-1&&(r.splice(n,1),this.name(r.join(" "))),this}setAttr(e,r){const n=this[K5+vr.Util._capitalize(e)];return vr.Util._isFunction(n)?n.call(this,r):this._setAttr(e,r),this}_requestDraw(){if(Wl.Konva.autoDrawEnabled){const e=this.getLayer()||this.getStage();e==null||e.batchDraw()}}_setAttr(e,r){const n=this.attrs[e];n===r&&!vr.Util.isObject(r)||(r==null?delete this.attrs[e]:this.attrs[e]=r,this._shouldFireChangeEvents&&this._fireChangeEvent(e,n,r),this._requestDraw())}_setComponentAttr(e,r,n){let s;n!==void 0&&(s=this.attrs[e],s||(this.attrs[e]=this.getAttr(e)),this.attrs[e][r]=n,this._fireChangeEvent(e,s,n))}_fireAndBubble(e,r,n){r&&this.nodeType===X5&&(r.target=this);const s=[CK,TK,EK,NK,AK,jK];if(!(s.indexOf(e)!==-1&&(n&&(this===n||this.isAncestorOf&&this.isAncestorOf(n))||this.nodeType==="Stage"&&!n))){this._fire(e,r);const i=s.indexOf(e)!==-1&&n&&n.isAncestorOf&&n.isAncestorOf(this)&&!n.isAncestorOf(this.parent);(r&&!r.cancelBubble||!r)&&this.parent&&this.parent.isListening()&&!i&&(n&&n.parent?this._fireAndBubble.call(this.parent,e,r,n):this._fireAndBubble.call(this.parent,e,r))}}_getProtoListeners(e){var r,n,s;const a=(r=this._cache.get(Jp))!==null&&r!==void 0?r:{};let i=a==null?void 0:a[e];if(i===void 0){i=[];let o=Object.getPrototypeOf(this);for(;o;){const l=(s=(n=o.eventListeners)===null||n===void 0?void 0:n[e])!==null&&s!==void 0?s:[];i.push(...l),o=Object.getPrototypeOf(o)}a[e]=i,this._cache.set(Jp,a)}return i}_fire(e,r){r=r||{},r.currentTarget=this,r.type=e;const n=this._getProtoListeners(e);if(n)for(let a=0;a<n.length;a++)n[a].handler.call(this,r);const s=this.eventListeners[e];if(s)for(let a=0;a<s.length;a++)s[a].handler.call(this,r)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(e){const r=e?e.pointerId:void 0,n=this.getStage(),s=this.getAbsolutePosition();if(!n)return;const a=n._getPointerById(r)||n._changedPointerPositions[0]||s;ii.DD._dragElements.set(this._id,{node:this,startPointerPos:a,offset:{x:a.x-s.x,y:a.y-s.y},dragStatus:"ready",pointerId:r})}startDrag(e,r=!0){ii.DD._dragElements.has(this._id)||this._createDragElement(e);const n=ii.DD._dragElements.get(this._id);n.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:e&&e.evt},r)}_setDragPosition(e,r){const n=this.getStage()._getPointerById(r.pointerId);if(!n)return;let s={x:n.x-r.offset.x,y:n.y-r.offset.y};const a=this.dragBoundFunc();if(a!==void 0){const i=a.call(this,s,e);i?s=i:vr.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==s.x||this._lastPos.y!==s.y)&&(this.setAbsolutePosition(s),this._requestDraw()),this._lastPos=s}stopDrag(e){const r=ii.DD._dragElements.get(this._id);r&&(r.dragStatus="stopped"),ii.DD._endDragBefore(e),ii.DD._endDragAfter(e)}setDraggable(e){this._setAttr("draggable",e),this._dragChange()}isDragging(){const e=ii.DD._dragElements.get(this._id);return e?e.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(e){if(!(!(e.evt.button!==void 0)||Wl.Konva.dragButtons.indexOf(e.evt.button)>=0)||this.isDragging())return;let s=!1;ii.DD._dragElements.forEach(a=>{this.isAncestorOf(a.node)&&(s=!0)}),s||this._createDragElement(e)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const r=ii.DD._dragElements.get(this._id),n=r&&r.dragStatus==="dragging",s=r&&r.dragStatus==="ready";n?this.stopDrag():s&&ii.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(e={x:0,y:0}){const r=this.getStage();if(!r)return!1;const n={x:-e.x,y:-e.y,width:r.width()+2*e.x,height:r.height()+2*e.y};return vr.Util.haveIntersection(n,this.getClientRect())}static create(e,r){return vr.Util._isString(e)&&(e=JSON.parse(e)),this._createNode(e,r)}static _createNode(e,r){let n=tr.prototype.getClassName.call(e),s=e.children,a,i,o;r&&(e.attrs.container=r),Wl.Konva[n]||(vr.Util.warn('Can not find a node with class name "'+n+'". Fallback to "Shape".'),n="Shape");const l=Wl.Konva[n];if(a=new l(e.attrs),s)for(i=s.length,o=0;o<i;o++)a.add(tr._createNode(s[o]));return a}}ln.Node=tr;tr.prototype.nodeType="Node";tr.prototype._attrsAffectingSize=[];tr.prototype.eventListeners={};tr.prototype.on.call(tr.prototype,PK,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(Gl),this._clearSelfAndDescendantCache(Qo)});tr.prototype.on.call(tr.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(tS)});tr.prototype.on.call(tr.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(eS)});tr.prototype.on.call(tr.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(Lx)});const Hr=um.Factory.addGetterSetter;Hr(tr,"zIndex");Hr(tr,"absolutePosition");Hr(tr,"position");Hr(tr,"x",0,(0,Ln.getNumberValidator)());Hr(tr,"y",0,(0,Ln.getNumberValidator)());Hr(tr,"globalCompositeOperation","source-over",(0,Ln.getStringValidator)());Hr(tr,"opacity",1,(0,Ln.getNumberValidator)());Hr(tr,"name","",(0,Ln.getStringValidator)());Hr(tr,"id","",(0,Ln.getStringValidator)());Hr(tr,"rotation",0,(0,Ln.getNumberValidator)());um.Factory.addComponentsGetterSetter(tr,"scale",["x","y"]);Hr(tr,"scaleX",1,(0,Ln.getNumberValidator)());Hr(tr,"scaleY",1,(0,Ln.getNumberValidator)());um.Factory.addComponentsGetterSetter(tr,"skew",["x","y"]);Hr(tr,"skewX",0,(0,Ln.getNumberValidator)());Hr(tr,"skewY",0,(0,Ln.getNumberValidator)());um.Factory.addComponentsGetterSetter(tr,"offset",["x","y"]);Hr(tr,"offsetX",0,(0,Ln.getNumberValidator)());Hr(tr,"offsetY",0,(0,Ln.getNumberValidator)());Hr(tr,"dragDistance",void 0,(0,Ln.getNumberValidator)());Hr(tr,"width",0,(0,Ln.getNumberValidator)());Hr(tr,"height",0,(0,Ln.getNumberValidator)());Hr(tr,"listening",!0,(0,Ln.getBooleanValidator)());Hr(tr,"preventDefault",!0,(0,Ln.getBooleanValidator)());Hr(tr,"filters",void 0,function(t){return this._filterUpToDate=!1,t});Hr(tr,"visible",!0,(0,Ln.getBooleanValidator)());Hr(tr,"transformsEnabled","all",(0,Ln.getStringValidator)());Hr(tr,"size");Hr(tr,"dragBoundFunc");Hr(tr,"draggable",!1,(0,Ln.getBooleanValidator)());um.Factory.backCompat(tr,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"});var id={};Object.defineProperty(id,"__esModule",{value:!0});id.Container=void 0;const hh=mr,V_=ln,Ry=Zt;class od extends V_.Node{constructor(){super(...arguments),this.children=[]}getChildren(e){const r=this.children||[];return e?r.filter(e):r}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(e=>{e.parent=null,e.index=0,e.destroy()}),this.children=[],this._requestDraw(),this}add(...e){if(e.length===0)return this;if(e.length>1){for(let n=0;n<e.length;n++)this.add(e[n]);return this}const r=e[0];return r.getParent()?(r.moveTo(this),this):(this._validateAdd(r),r.index=this.getChildren().length,r.parent=this,r._clearCaches(),this.getChildren().push(r),this._fire("add",{child:r}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(e){return this._generalFind(e,!1)}findOne(e){const r=this._generalFind(e,!0);return r.length>0?r[0]:void 0}_generalFind(e,r){const n=[];return this._descendants(s=>{const a=s._isMatch(e);return a&&n.push(s),!!(a&&r)}),n}_descendants(e){let r=!1;const n=this.getChildren();for(const s of n){if(r=e(s),r)return!0;if(s.hasChildren()&&(r=s._descendants(e),r))return!0}return!1}toObject(){const e=V_.Node.prototype.toObject.call(this);return e.children=[],this.getChildren().forEach(r=>{e.children.push(r.toObject())}),e}isAncestorOf(e){let r=e.getParent();for(;r;){if(r._id===this._id)return!0;r=r.getParent()}return!1}clone(e){const r=V_.Node.prototype.clone.call(this,e);return this.getChildren().forEach(function(n){r.add(n.clone())}),r}getAllIntersections(e){const r=[];return this.find("Shape").forEach(n=>{n.isVisible()&&n.intersects(e)&&r.push(n)}),r}_clearSelfAndDescendantCache(e){var r;super._clearSelfAndDescendantCache(e),!this.isCached()&&((r=this.children)===null||r===void 0||r.forEach(function(n){n._clearSelfAndDescendantCache(e)}))}_setChildrenIndices(){var e;(e=this.children)===null||e===void 0||e.forEach(function(r,n){r.index=n}),this._requestDraw()}drawScene(e,r,n){const s=this.getLayer(),a=e||s&&s.getCanvas(),i=a&&a.getContext(),o=this._getCanvasCache(),l=o&&o.scene,u=a&&a.isCache;if(!this.isVisible()&&!u)return this;if(l){i.save();const d=this.getAbsoluteTransform(r).getMatrix();i.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this._drawCachedSceneCanvas(i),i.restore()}else this._drawChildren("drawScene",a,r,n);return this}drawHit(e,r){if(!this.shouldDrawHit(r))return this;const n=this.getLayer(),s=e||n&&n.hitCanvas,a=s&&s.getContext(),i=this._getCanvasCache();if(i&&i.hit){a.save();const l=this.getAbsoluteTransform(r).getMatrix();a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this._drawCachedHitCanvas(a),a.restore()}else this._drawChildren("drawHit",s,r);return this}_drawChildren(e,r,n,s){var a;const i=r&&r.getContext(),o=this.clipWidth(),l=this.clipHeight(),u=this.clipFunc(),d=typeof o=="number"&&typeof l=="number"||u,g=n===this;if(d){i.save();const p=this.getAbsoluteTransform(n);let x=p.getMatrix();i.transform(x[0],x[1],x[2],x[3],x[4],x[5]),i.beginPath();let v;if(u)v=u.call(this,i,this);else{const w=this.clipX(),S=this.clipY();i.rect(w||0,S||0,o,l)}i.clip.apply(i,v),x=p.copy().invert().getMatrix(),i.transform(x[0],x[1],x[2],x[3],x[4],x[5])}const h=!g&&this.globalCompositeOperation()!=="source-over"&&e==="drawScene";h&&(i.save(),i._applyGlobalCompositeOperation(this)),(a=this.children)===null||a===void 0||a.forEach(function(p){p[e](r,n,s)}),h&&i.restore(),d&&i.restore()}getClientRect(e={}){var r;const n=e.skipTransform,s=e.relativeTo;let a,i,o,l,u={x:1/0,y:1/0,width:0,height:0};const d=this;(r=this.children)===null||r===void 0||r.forEach(function(p){if(!p.visible())return;const x=p.getClientRect({relativeTo:d,skipShadow:e.skipShadow,skipStroke:e.skipStroke});x.width===0&&x.height===0||(a===void 0?(a=x.x,i=x.y,o=x.x+x.width,l=x.y+x.height):(a=Math.min(a,x.x),i=Math.min(i,x.y),o=Math.max(o,x.x+x.width),l=Math.max(l,x.y+x.height)))});const g=this.find("Shape");let h=!1;for(let p=0;p<g.length;p++)if(g[p]._isVisible(this)){h=!0;break}return h&&a!==void 0?u={x:a,y:i,width:o-a,height:l-i}:u={x:0,y:0,width:0,height:0},n?u:this._transformedRect(u,s)}}id.Container=od;hh.Factory.addComponentsGetterSetter(od,"clip",["x","y","width","height"]);hh.Factory.addGetterSetter(od,"clipX",void 0,(0,Ry.getNumberValidator)());hh.Factory.addGetterSetter(od,"clipY",void 0,(0,Ry.getNumberValidator)());hh.Factory.addGetterSetter(od,"clipWidth",void 0,(0,Ry.getNumberValidator)());hh.Factory.addGetterSetter(od,"clipHeight",void 0,(0,Ry.getNumberValidator)());hh.Factory.addGetterSetter(od,"clipFunc");var W7={},Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.getCapturedShape=MK;Rc.createEvent=LC;Rc.hasPointerCapture=IK;Rc.setPointerCapture=OK;Rc.releaseCapture=z7;const RK=ur,Eg=new Map,H7=RK.Konva._global.PointerEvent!==void 0;function MK(t){return Eg.get(t)}function LC(t){return{evt:t,pointerId:t.pointerId}}function IK(t,e){return Eg.get(t)===e}function OK(t,e){z7(t),e.getStage()&&(Eg.set(t,e),H7&&e._fire("gotpointercapture",LC(new PointerEvent("gotpointercapture"))))}function z7(t,e){const r=Eg.get(t);if(!r)return;const n=r.getStage();n&&n.content,Eg.delete(t),H7&&r._fire("lostpointercapture",LC(new PointerEvent("lostpointercapture")))}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Stage=t.stages=void 0;const e=wn,r=mr,n=id,s=ur,a=Yi,i=Dy,o=ur,l=Rc,u="Stage",d="string",g="px",h="mouseout",p="mouseleave",x="mouseover",v="mouseenter",w="mousemove",S="mousedown",_="mouseup",y="pointermove",k="pointerdown",N="pointerup",E="pointercancel",A="lostpointercapture",C="pointerout",F="pointerleave",P="pointerover",M="pointerenter",I="contextmenu",Y="touchstart",se="touchend",L="touchmove",z="touchcancel",G="wheel",O=5,R=[[v,"_pointerenter"],[S,"_pointerdown"],[w,"_pointermove"],[_,"_pointerup"],[p,"_pointerleave"],[Y,"_pointerdown"],[L,"_pointermove"],[se,"_pointerup"],[z,"_pointercancel"],[x,"_pointerover"],[G,"_wheel"],[I,"_contextmenu"],[k,"_pointerdown"],[y,"_pointermove"],[N,"_pointerup"],[E,"_pointercancel"],[F,"_pointerleave"],[A,"_lostpointercapture"]],X={mouse:{[C]:h,[F]:p,[P]:x,[M]:v,[y]:w,[k]:S,[N]:_,[E]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[C]:"touchout",[F]:"touchleave",[P]:"touchover",[M]:"touchenter",[y]:L,[k]:Y,[N]:se,[E]:z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[C]:C,[F]:F,[P]:P,[M]:M,[y]:y,[k]:k,[N]:N,[E]:E,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},te=ae=>ae.indexOf("pointer")>=0?"pointer":ae.indexOf("touch")>=0?"touch":"mouse",H=ae=>{const J=te(ae);if(J==="pointer")return s.Konva.pointerEventsEnabled&&X.pointer;if(J==="touch")return X.touch;if(J==="mouse")return X.mouse};function V(ae={}){return(ae.clipFunc||ae.clipWidth||ae.clipHeight)&&e.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),ae}const q="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";t.stages=[];class Q extends n.Container{constructor(J){super(V(J)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),t.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{V(this.attrs)}),this._checkVisibility()}_validateAdd(J){const re=J.getType()==="Layer",ve=J.getType()==="FastLayer";re||ve||e.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const J=this.visible()?"":"none";this.content.style.display=J}setContainer(J){if(typeof J===d){let re;if(J.charAt(0)==="."){const ve=J.slice(1);J=document.getElementsByClassName(ve)[0]}else J.charAt(0)!=="#"?re=J:re=J.slice(1),J=document.getElementById(re);if(!J)throw"Can not find container in document with id "+re}return this._setAttr("container",J),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),J.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const J=this.children,re=J.length;for(let ve=0;ve<re;ve++)J[ve].clear();return this}clone(J){return J||(J={}),J.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,J)}destroy(){super.destroy();const J=this.content;J&&e.Util._isInDocument(J)&&this.container().removeChild(J);const re=t.stages.indexOf(this);return re>-1&&t.stages.splice(re,1),e.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const J=this._pointerPositions[0]||this._changedPointerPositions[0];return J?{x:J.x,y:J.y}:(e.Util.warn(q),null)}_getPointerById(J){return this._pointerPositions.find(re=>re.id===J)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(J){J=J||{},J.x=J.x||0,J.y=J.y||0,J.width=J.width||this.width(),J.height=J.height||this.height();const re=new a.SceneCanvas({width:J.width,height:J.height,pixelRatio:J.pixelRatio||1}),ve=re.getContext()._context,we=this.children;return(J.x||J.y)&&ve.translate(-1*J.x,-1*J.y),we.forEach(function(Fe){if(!Fe.isVisible())return;const ne=Fe._toKonvaCanvas(J);ve.drawImage(ne._canvas,J.x,J.y,ne.getWidth()/ne.getPixelRatio(),ne.getHeight()/ne.getPixelRatio())}),re}getIntersection(J){if(!J)return null;const re=this.children,ve=re.length,we=ve-1;for(let Fe=we;Fe>=0;Fe--){const ne=re[Fe].getIntersection(J);if(ne)return ne}return null}_resizeDOM(){const J=this.width(),re=this.height();this.content&&(this.content.style.width=J+g,this.content.style.height=re+g),this.bufferCanvas.setSize(J,re),this.bufferHitCanvas.setSize(J,re),this.children.forEach(ve=>{ve.setSize({width:J,height:re}),ve.draw()})}add(J,...re){if(arguments.length>1){for(let we=0;we<arguments.length;we++)this.add(arguments[we]);return this}super.add(J);const ve=this.children.length;return ve>O&&e.Util.warn("The stage has "+ve+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),J.setSize({width:this.width(),height:this.height()}),J.draw(),s.Konva.isBrowser&&this.content.appendChild(J.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(J){return l.hasPointerCapture(J,this)}setPointerCapture(J){l.setPointerCapture(J,this)}releaseCapture(J){l.releaseCapture(J,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&R.forEach(([J,re])=>{this.content.addEventListener(J,ve=>{this[re](ve)},{passive:!1})})}_pointerenter(J){this.setPointersPositions(J);const re=H(J.type);re&&this._fire(re.pointerenter,{evt:J,target:this,currentTarget:this})}_pointerover(J){this.setPointersPositions(J);const re=H(J.type);re&&this._fire(re.pointerover,{evt:J,target:this,currentTarget:this})}_getTargetShape(J){let re=this[J+"targetShape"];return re&&!re.getStage()&&(re=null),re}_pointerleave(J){const re=H(J.type),ve=te(J.type);if(!re)return;this.setPointersPositions(J);const we=this._getTargetShape(ve),Fe=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;we&&Fe?(we._fireAndBubble(re.pointerout,{evt:J}),we._fireAndBubble(re.pointerleave,{evt:J}),this._fire(re.pointerleave,{evt:J,target:this,currentTarget:this}),this[ve+"targetShape"]=null):Fe&&(this._fire(re.pointerleave,{evt:J,target:this,currentTarget:this}),this._fire(re.pointerout,{evt:J,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(J){const re=H(J.type),ve=te(J.type);if(!re)return;this.setPointersPositions(J);let we=!1;this._changedPointerPositions.forEach(Fe=>{const ne=this.getIntersection(Fe);if(i.DD.justDragged=!1,s.Konva["_"+ve+"ListenClick"]=!0,!ne||!ne.isListening()){this[ve+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&ne.setPointerCapture(Fe.id),this[ve+"ClickStartShape"]=ne,ne._fireAndBubble(re.pointerdown,{evt:J,pointerId:Fe.id}),we=!0;const Ee=J.type.indexOf("touch")>=0;ne.preventDefault()&&J.cancelable&&Ee&&J.preventDefault()}),we||this._fire(re.pointerdown,{evt:J,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(J){const re=H(J.type),ve=te(J.type);if(!re||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&J.cancelable&&J.preventDefault(),this.setPointersPositions(J),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Fe={};let ne=!1;const Ee=this._getTargetShape(ve);this._changedPointerPositions.forEach(ke=>{const He=l.getCapturedShape(ke.id)||this.getIntersection(ke),at=ke.id,Me={evt:J,pointerId:at},Ft=Ee!==He;if(Ft&&Ee&&(Ee._fireAndBubble(re.pointerout,{...Me},He),Ee._fireAndBubble(re.pointerleave,{...Me},He)),He){if(Fe[He._id])return;Fe[He._id]=!0}He&&He.isListening()?(ne=!0,Ft&&(He._fireAndBubble(re.pointerover,{...Me},Ee),He._fireAndBubble(re.pointerenter,{...Me},Ee),this[ve+"targetShape"]=He),He._fireAndBubble(re.pointermove,{...Me})):Ee&&(this._fire(re.pointerover,{evt:J,target:this,currentTarget:this,pointerId:at}),this[ve+"targetShape"]=null)}),ne||this._fire(re.pointermove,{evt:J,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(J){const re=H(J.type),ve=te(J.type);if(!re)return;this.setPointersPositions(J);const we=this[ve+"ClickStartShape"],Fe=this[ve+"ClickEndShape"],ne={};let Ee=!1;this._changedPointerPositions.forEach(ke=>{const He=l.getCapturedShape(ke.id)||this.getIntersection(ke);if(He){if(He.releaseCapture(ke.id),ne[He._id])return;ne[He._id]=!0}const at=ke.id,Me={evt:J,pointerId:at};let Ft=!1;s.Konva["_"+ve+"InDblClickWindow"]?(Ft=!0,clearTimeout(this[ve+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+ve+"InDblClickWindow"]=!0,clearTimeout(this[ve+"DblTimeout"])),this[ve+"DblTimeout"]=setTimeout(function(){s.Konva["_"+ve+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),He&&He.isListening()?(Ee=!0,this[ve+"ClickEndShape"]=He,He._fireAndBubble(re.pointerup,{...Me}),s.Konva["_"+ve+"ListenClick"]&&we&&we===He&&(He._fireAndBubble(re.pointerclick,{...Me}),Ft&&Fe&&Fe===He&&He._fireAndBubble(re.pointerdblclick,{...Me}))):(this[ve+"ClickEndShape"]=null,s.Konva["_"+ve+"ListenClick"]&&this._fire(re.pointerclick,{evt:J,target:this,currentTarget:this,pointerId:at}),Ft&&this._fire(re.pointerdblclick,{evt:J,target:this,currentTarget:this,pointerId:at}))}),Ee||this._fire(re.pointerup,{evt:J,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+ve+"ListenClick"]=!1,J.cancelable&&ve!=="touch"&&ve!=="pointer"&&J.preventDefault()}_contextmenu(J){this.setPointersPositions(J);const re=this.getIntersection(this.getPointerPosition());re&&re.isListening()?re._fireAndBubble(I,{evt:J}):this._fire(I,{evt:J,target:this,currentTarget:this})}_wheel(J){this.setPointersPositions(J);const re=this.getIntersection(this.getPointerPosition());re&&re.isListening()?re._fireAndBubble(G,{evt:J}):this._fire(G,{evt:J,target:this,currentTarget:this})}_pointercancel(J){this.setPointersPositions(J);const re=l.getCapturedShape(J.pointerId)||this.getIntersection(this.getPointerPosition());re&&re._fireAndBubble(N,l.createEvent(J)),l.releaseCapture(J.pointerId)}_lostpointercapture(J){l.releaseCapture(J.pointerId)}setPointersPositions(J){const re=this._getContentPosition();let ve=null,we=null;J=J||window.event,J.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(J.touches,Fe=>{this._pointerPositions.push({id:Fe.identifier,x:(Fe.clientX-re.left)/re.scaleX,y:(Fe.clientY-re.top)/re.scaleY})}),Array.prototype.forEach.call(J.changedTouches||J.touches,Fe=>{this._changedPointerPositions.push({id:Fe.identifier,x:(Fe.clientX-re.left)/re.scaleX,y:(Fe.clientY-re.top)/re.scaleY})})):(ve=(J.clientX-re.left)/re.scaleX,we=(J.clientY-re.top)/re.scaleY,this.pointerPos={x:ve,y:we},this._pointerPositions=[{x:ve,y:we,id:e.Util._getFirstPointerId(J)}],this._changedPointerPositions=[{x:ve,y:we,id:e.Util._getFirstPointerId(J)}])}_setPointerPosition(J){e.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(J)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const J=this.content.getBoundingClientRect();return{top:J.top,left:J.left,scaleX:J.width/this.content.clientWidth||1,scaleY:J.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const J=this.container();if(!J)throw"Stage has no container. A container is required.";J.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),J.appendChild(this.content),this._resizeDOM()}cache(){return e.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(J){J.batchDraw()}),this}}t.Stage=Q,Q.prototype.nodeType=u,(0,o._registerNode)(Q),r.Factory.addGetterSetter(Q,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{t.stages.forEach(ae=>{ae.batchDraw()})})})(W7);var dm={},ss={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.shapes=void 0;const e=ur,r=wn,n=mr,s=ln,a=Zt,i=ur,o=Rc,l="hasShadow",u="shadowRGBA",d="patternImage",g="linearGradient",h="radialGradient";let p;function x(){return p||(p=r.Util.createCanvasElement().getContext("2d"),p)}t.shapes={};function v(F){const P=this.attrs.fillRule;P?F.fill(P):F.fill()}function w(F){F.stroke()}function S(F){const P=this.attrs.fillRule;P?F.fill(P):F.fill()}function _(F){F.stroke()}function y(){this._clearCache(l)}function k(){this._clearCache(u)}function N(){this._clearCache(d)}function E(){this._clearCache(g)}function A(){this._clearCache(h)}class C extends s.Node{constructor(P){super(P);let M;for(;M=r.Util.getRandomColor(),!(M&&!(M in t.shapes)););this.colorKey=M,t.shapes[M]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(l,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const M=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(M&&M.setTransform){const I=new r.Transform;I.translate(this.fillPatternX(),this.fillPatternY()),I.rotate(e.Konva.getAngle(this.fillPatternRotation())),I.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),I.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Y=I.getMatrix(),se=typeof DOMMatrix>"u"?{a:Y[0],b:Y[1],c:Y[2],d:Y[3],e:Y[4],f:Y[5]}:new DOMMatrix(Y);M.setTransform(se)}return M}}_getLinearGradient(){return this._getCache(g,this.__getLinearGradient)}__getLinearGradient(){const P=this.fillLinearGradientColorStops();if(P){const M=x(),I=this.fillLinearGradientStartPoint(),Y=this.fillLinearGradientEndPoint(),se=M.createLinearGradient(I.x,I.y,Y.x,Y.y);for(let L=0;L<P.length;L+=2)se.addColorStop(P[L],P[L+1]);return se}}_getRadialGradient(){return this._getCache(h,this.__getRadialGradient)}__getRadialGradient(){const P=this.fillRadialGradientColorStops();if(P){const M=x(),I=this.fillRadialGradientStartPoint(),Y=this.fillRadialGradientEndPoint(),se=M.createRadialGradient(I.x,I.y,this.fillRadialGradientStartRadius(),Y.x,Y.y,this.fillRadialGradientEndRadius());for(let L=0;L<P.length;L+=2)se.addColorStop(P[L],P[L+1]);return se}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const P=r.Util.colorToRGBA(this.shadowColor());if(P)return"rgba("+P.r+","+P.g+","+P.b+","+P.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const P=this.hitStrokeWidth();return P==="auto"?this.hasStroke():this.strokeEnabled()&&!!P}intersects(P){const M=this.getStage();if(!M)return!1;const I=M.bufferHitCanvas;return I.getContext().clear(),this.drawHit(I,void 0,!0),I.context.getImageData(Math.round(P.x),Math.round(P.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete t.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(P){var M;if(!((M=this.attrs.perfectDrawEnabled)!==null&&M!==void 0?M:!0))return!1;const Y=P||this.hasFill(),se=this.hasStroke(),L=this.getAbsoluteOpacity()!==1;if(Y&&se&&L)return!0;const z=this.hasShadow(),G=this.shadowForStrokeEnabled();return!!(Y&&se&&z&&G)}setStrokeHitEnabled(P){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),P?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const P=this.size();return{x:this._centroid?-P.width/2:0,y:this._centroid?-P.height/2:0,width:P.width,height:P.height}}getClientRect(P={}){let M=!1,I=this.getParent();for(;I;){if(I.isCached()){M=!0;break}I=I.getParent()}const Y=P.skipTransform,se=P.relativeTo||M&&this.getStage()||void 0,L=this.getSelfRect(),G=!P.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,O=L.width+G,R=L.height+G,X=!P.skipShadow&&this.hasShadow(),te=X?this.shadowOffsetX():0,H=X?this.shadowOffsetY():0,V=O+Math.abs(te),q=R+Math.abs(H),Q=X&&this.shadowBlur()||0,ae=V+Q*2,J=q+Q*2,re={width:ae,height:J,x:-(G/2+Q)+Math.min(te,0)+L.x,y:-(G/2+Q)+Math.min(H,0)+L.y};return Y?re:this._transformedRect(re,se)}drawScene(P,M,I){const Y=this.getLayer(),se=P||Y.getCanvas(),L=se.getContext(),z=this._getCanvasCache(),G=this.getSceneFunc(),O=this.hasShadow();let R;const X=M===this;if(!this.isVisible()&&!X)return this;if(z){L.save();const te=this.getAbsoluteTransform(M).getMatrix();return L.transform(te[0],te[1],te[2],te[3],te[4],te[5]),this._drawCachedSceneCanvas(L),L.restore(),this}if(!G)return this;if(L.save(),this._useBufferCanvas()){R=this.getStage();const te=I||R.bufferCanvas,H=te.getContext();H.clear(),H.save(),H._applyLineJoin(this);const V=this.getAbsoluteTransform(M).getMatrix();H.transform(V[0],V[1],V[2],V[3],V[4],V[5]),G.call(this,H,this),H.restore();const q=te.pixelRatio;O&&L._applyShadow(this),L._applyOpacity(this),L._applyGlobalCompositeOperation(this),L.drawImage(te._canvas,te.x||0,te.y||0,te.width/q,te.height/q)}else{if(L._applyLineJoin(this),!X){const te=this.getAbsoluteTransform(M).getMatrix();L.transform(te[0],te[1],te[2],te[3],te[4],te[5]),L._applyOpacity(this),L._applyGlobalCompositeOperation(this)}O&&L._applyShadow(this),G.call(this,L,this)}return L.restore(),this}drawHit(P,M,I=!1){if(!this.shouldDrawHit(M,I))return this;const Y=this.getLayer(),se=P||Y.hitCanvas,L=se&&se.getContext(),z=this.hitFunc()||this.sceneFunc(),G=this._getCanvasCache(),O=G&&G.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),O){L.save();const X=this.getAbsoluteTransform(M).getMatrix();return L.transform(X[0],X[1],X[2],X[3],X[4],X[5]),this._drawCachedHitCanvas(L),L.restore(),this}if(!z)return this;if(L.save(),L._applyLineJoin(this),!(this===M)){const X=this.getAbsoluteTransform(M).getMatrix();L.transform(X[0],X[1],X[2],X[3],X[4],X[5])}return z.call(this,L,this),L.restore(),this}drawHitFromCache(P=0){const M=this._getCanvasCache(),I=this._getCachedSceneCanvas(),Y=M.hit,se=Y.getContext(),L=Y.getWidth(),z=Y.getHeight();se.clear(),se.drawImage(I._canvas,0,0,L,z);try{const G=se.getImageData(0,0,L,z),O=G.data,R=O.length,X=r.Util._hexToRgb(this.colorKey);for(let te=0;te<R;te+=4)O[te+3]>P?(O[te]=X.r,O[te+1]=X.g,O[te+2]=X.b,O[te+3]=255):O[te+3]=0;se.putImageData(G,0,0)}catch(G){r.Util.error("Unable to draw hit graph from cached scene canvas. "+G.message)}return this}hasPointerCapture(P){return o.hasPointerCapture(P,this)}setPointerCapture(P){o.setPointerCapture(P,this)}releaseCapture(P){o.releaseCapture(P,this)}}t.Shape=C,C.prototype._fillFunc=v,C.prototype._strokeFunc=w,C.prototype._fillFuncHit=S,C.prototype._strokeFuncHit=_,C.prototype._centroid=!1,C.prototype.nodeType="Shape",(0,i._registerNode)(C),C.prototype.eventListeners={},C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",y),C.prototype.on.call(C.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",k),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",E),C.prototype.on.call(C.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",A),n.Factory.addGetterSetter(C,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(C,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(C,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(C,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(C,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(C,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(C,"lineJoin"),n.Factory.addGetterSetter(C,"lineCap"),n.Factory.addGetterSetter(C,"sceneFunc"),n.Factory.addGetterSetter(C,"hitFunc"),n.Factory.addGetterSetter(C,"dash"),n.Factory.addGetterSetter(C,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(C,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(C,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(C,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternImage"),n.Factory.addGetterSetter(C,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(C,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(C,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(C,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(C,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(C,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(C,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(C,"fillEnabled",!0),n.Factory.addGetterSetter(C,"strokeEnabled",!0),n.Factory.addGetterSetter(C,"shadowEnabled",!0),n.Factory.addGetterSetter(C,"dashEnabled",!0),n.Factory.addGetterSetter(C,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(C,"fillPriority","color"),n.Factory.addComponentsGetterSetter(C,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(C,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(C,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(C,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(C,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(C,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(C,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(C,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(C,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(C,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(C,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(C,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(C,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(C,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(C,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(C,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(C,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(C,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(C,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(C,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(C,"fillPatternRotation",0),n.Factory.addGetterSetter(C,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(C,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(ss);Object.defineProperty(dm,"__esModule",{value:!0});dm.Layer=void 0;const Xo=wn,K_=id,Ld=ln,BC=mr,J5=Yi,LK=Zt,BK=ss,UK=ur,$K="#",WK="beforeDraw",HK="draw",G7=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],zK=G7.length;let gh=class extends K_.Container{constructor(e){super(e),this.canvas=new J5.SceneCanvas,this.hitCanvas=new J5.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(e){return this.getContext().clear(e),this.getHitCanvas().getContext().clear(e),this}setZIndex(e){super.setZIndex(e);const r=this.getStage();return r&&r.content&&(r.content.removeChild(this.getNativeCanvasElement()),e<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[e+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){Ld.Node.prototype.moveToTop.call(this);const e=this.getStage();return e&&e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!Ld.Node.prototype.moveUp.call(this))return!1;const r=this.getStage();return!r||!r.content?!1:(r.content.removeChild(this.getNativeCanvasElement()),this.index<r.children.length-1?r.content.insertBefore(this.getNativeCanvasElement(),r.children[this.index+1].getCanvas()._canvas):r.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(Ld.Node.prototype.moveDown.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(Ld.Node.prototype.moveToBottom.call(this)){const e=this.getStage();if(e){const r=e.children;e.content&&(e.content.removeChild(this.getNativeCanvasElement()),e.content.insertBefore(this.getNativeCanvasElement(),r[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const e=this.getNativeCanvasElement();return Ld.Node.prototype.remove.call(this),e&&e.parentNode&&Xo.Util._isInDocument(e)&&e.parentNode.removeChild(e),this}getStage(){return this.parent}setSize({width:e,height:r}){return this.canvas.setSize(e,r),this.hitCanvas.setSize(e,r),this._setSmoothEnabled(),this}_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&Xo.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(e){return e=e||{},e.width=e.width||this.getWidth(),e.height=e.height||this.getHeight(),e.x=e.x!==void 0?e.x:this.x(),e.y=e.y!==void 0?e.y:this.y(),Ld.Node.prototype._toKonvaCanvas.call(this,e)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){Xo.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){Xo.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,Xo.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(e){if(!this.isListening()||!this.isVisible())return null;let r=1,n=!1;for(;;){for(let s=0;s<zK;s++){const a=G7[s],i=this._getIntersection({x:e.x+a.x*r,y:e.y+a.y*r}),o=i.shape;if(o)return o;if(n=!!i.antialiased,!i.antialiased)break}if(n)r+=1;else return null}}_getIntersection(e){const r=this.hitCanvas.pixelRatio,n=this.hitCanvas.context.getImageData(Math.round(e.x*r),Math.round(e.y*r),1,1).data,s=n[3];if(s===255){const a=Xo.Util._rgbToHex(n[0],n[1],n[2]),i=BK.shapes[$K+a];return i?{shape:i}:{antialiased:!0}}else if(s>0)return{antialiased:!0};return{}}drawScene(e,r,n){const s=this.getLayer(),a=e||s&&s.getCanvas();return this._fire(WK,{node:this}),this.clearBeforeDraw()&&a.getContext().clear(),K_.Container.prototype.drawScene.call(this,a,r,n),this._fire(HK,{node:this}),this}drawHit(e,r){const n=this.getLayer(),s=e||n&&n.hitCanvas;return n&&n.clearBeforeDraw()&&n.getHitCanvas().getContext().clear(),K_.Container.prototype.drawHit.call(this,s,r),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(e){Xo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(e)}getHitGraphEnabled(e){return Xo.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const e=this.parent;!!this.hitCanvas._canvas.parentNode?e.content.removeChild(this.hitCanvas._canvas):e.content.appendChild(this.hitCanvas._canvas)}destroy(){return Xo.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}};dm.Layer=gh;gh.prototype.nodeType="Layer";(0,UK._registerNode)(gh);BC.Factory.addGetterSetter(gh,"imageSmoothingEnabled",!0);BC.Factory.addGetterSetter(gh,"clearBeforeDraw",!0);BC.Factory.addGetterSetter(gh,"hitGraphEnabled",!0,(0,LK.getBooleanValidator)());var My={};Object.defineProperty(My,"__esModule",{value:!0});My.FastLayer=void 0;const GK=wn,VK=dm,KK=ur;let UC=class extends VK.Layer{constructor(e){super(e),this.listening(!1),GK.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}};My.FastLayer=UC;UC.prototype.nodeType="FastLayer";(0,KK._registerNode)(UC);var mh={};Object.defineProperty(mh,"__esModule",{value:!0});mh.Group=void 0;const XK=wn,YK=id,JK=ur;let $C=class extends YK.Container{_validateAdd(e){const r=e.getType();r!=="Group"&&r!=="Shape"&&XK.Util.throw("You may only add groups and shapes to groups.")}};mh.Group=$C;$C.prototype.nodeType="Group";(0,JK._registerNode)($C);var ph={};Object.defineProperty(ph,"__esModule",{value:!0});ph.Animation=void 0;const X_=ur,Q5=wn,Y_=function(){return X_.glob.performance&&X_.glob.performance.now?function(){return X_.glob.performance.now()}:function(){return new Date().getTime()}}();class So{constructor(e,r){this.id=So.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:Y_(),frameRate:0},this.func=e,this.setLayers(r)}setLayers(e){let r=[];return e&&(r=Array.isArray(e)?e:[e]),this.layers=r,this}getLayers(){return this.layers}addLayer(e){const r=this.layers,n=r.length;for(let s=0;s<n;s++)if(r[s]._id===e._id)return!1;return this.layers.push(e),!0}isRunning(){const r=So.animations,n=r.length;for(let s=0;s<n;s++)if(r[s].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=Y_(),So._addAnimation(this),this}stop(){return So._removeAnimation(this),this}_updateFrameObject(e){this.frame.timeDiff=e-this.frame.lastTime,this.frame.lastTime=e,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(e){this.animations.push(e),this._handleAnimation()}static _removeAnimation(e){const r=e.id,n=this.animations,s=n.length;for(let a=0;a<s;a++)if(n[a].id===r){this.animations.splice(a,1);break}}static _runFrames(){const e={},r=this.animations;for(let n=0;n<r.length;n++){const s=r[n],a=s.layers,i=s.func;s._updateFrameObject(Y_());const o=a.length;let l;if(i?l=i.call(s,s.frame)!==!1:l=!0,!!l)for(let u=0;u<o;u++){const d=a[u];d._id!==void 0&&(e[d._id]=d)}}for(const n in e)e.hasOwnProperty(n)&&e[n].batchDraw()}static _animationLoop(){const e=So;e.animations.length?(e._runFrames(),Q5.Util.requestAnimFrame(e._animationLoop)):e.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,Q5.Util.requestAnimFrame(this._animationLoop))}}ph.Animation=So;So.animations=[];So.animIdCounter=0;So.animRunning=!1;var V7={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Easings=t.Tween=void 0;const e=wn,r=ph,n=ln,s=ur,a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,l=3,u=["fill","stroke","shadowColor"];let d=0;class g{constructor(x,v,w,S,_,y,k){this.prop=x,this.propFunc=v,this.begin=S,this._pos=S,this.duration=y,this._change=0,this.prevPos=0,this.yoyo=k,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=_-this.begin,this.pause()}fire(x){const v=this[x];v&&v()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=l,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===l&&this.setTime(this.duration-x)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class h{constructor(x){const v=this,w=x.node,S=w._id,_=x.easing||t.Easings.Linear,y=!!x.yoyo;let k,N;typeof x.duration>"u"?k=.3:x.duration===0?k=.001:k=x.duration,this.node=w,this._id=d++;const E=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);E||e.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},E),this.tween=new g(N,function(A){v._tweenFunc(A)},_,0,1,k*1e3,y),this._addListeners(),h.attrs[S]||(h.attrs[S]={}),h.attrs[S][this._id]||(h.attrs[S][this._id]={}),h.tweens[S]||(h.tweens[S]={});for(N in x)a[N]===void 0&&this._addAttr(N,x[N]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,v){const w=this.node,S=w._id;let _,y,k,N,E;const A=h.tweens[S][x];A&&delete h.attrs[S][A][x];let C=w.getAttr(x);if(e.Util._isArray(v))if(_=[],y=Math.max(v.length,C.length),x==="points"&&v.length!==C.length&&(v.length>C.length?(N=C,C=e.Util._prepareArrayForTween(C,v,w.closed())):(k=v,v=e.Util._prepareArrayForTween(v,C,w.closed()))),x.indexOf("fill")===0)for(let F=0;F<y;F++)if(F%2===0)_.push(v[F]-C[F]);else{const P=e.Util.colorToRGBA(C[F]);E=e.Util.colorToRGBA(v[F]),C[F]=P,_.push({r:E.r-P.r,g:E.g-P.g,b:E.b-P.b,a:E.a-P.a})}else for(let F=0;F<y;F++)_.push(v[F]-C[F]);else u.indexOf(x)!==-1?(C=e.Util.colorToRGBA(C),E=e.Util.colorToRGBA(v),_={r:E.r-C.r,g:E.g-C.g,b:E.b-C.b,a:E.a-C.a}):_=v-C;h.attrs[S][this._id][x]={start:C,diff:_,end:v,trueEnd:k,trueStart:N},h.tweens[S][x]=this._id}_tweenFunc(x){const v=this.node,w=h.attrs[v._id][this._id];let S,_,y,k,N,E,A,C;for(S in w){if(_=w[S],y=_.start,k=_.diff,C=_.end,e.Util._isArray(y))if(N=[],A=Math.max(y.length,C.length),S.indexOf("fill")===0)for(E=0;E<A;E++)E%2===0?N.push((y[E]||0)+k[E]*x):N.push("rgba("+Math.round(y[E].r+k[E].r*x)+","+Math.round(y[E].g+k[E].g*x)+","+Math.round(y[E].b+k[E].b*x)+","+(y[E].a+k[E].a*x)+")");else for(E=0;E<A;E++)N.push((y[E]||0)+k[E]*x);else u.indexOf(S)!==-1?N="rgba("+Math.round(y.r+k.r*x)+","+Math.round(y.g+k.g*x)+","+Math.round(y.b+k.b*x)+","+(y.a+k.a*x)+")":N=y+k*x;v.setAttr(S,N)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,v=h.attrs[x._id][this._id];v.points&&v.points.trueEnd&&x.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,v=h.attrs[x._id][this._id];v.points&&v.points.trueStart&&x.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,v=this._id,w=h.tweens[x];this.pause(),this.anim&&this.anim.stop();for(const S in w)delete h.tweens[x][S];delete h.attrs[x][v],h.tweens[x]&&(Object.keys(h.tweens[x]).length===0&&delete h.tweens[x],Object.keys(h.attrs[x]).length===0&&delete h.attrs[x])}}t.Tween=h,h.attrs={},h.tweens={},n.Node.prototype.to=function(p){const x=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),x&&x()},new h(p).play()},t.Easings={BackEaseIn(p,x,v,w){return v*(p/=w)*p*((1.70158+1)*p-1.70158)+x},BackEaseOut(p,x,v,w){return v*((p=p/w-1)*p*((1.70158+1)*p+1.70158)+1)+x},BackEaseInOut(p,x,v,w){let S=1.70158;return(p/=w/2)<1?v/2*(p*p*(((S*=1.525)+1)*p-S))+x:v/2*((p-=2)*p*(((S*=1.525)+1)*p+S)+2)+x},ElasticEaseIn(p,x,v,w,S,_){let y=0;return p===0?x:(p/=w)===1?x+v:(_||(_=w*.3),!S||S<Math.abs(v)?(S=v,y=_/4):y=_/(2*Math.PI)*Math.asin(v/S),-(S*Math.pow(2,10*(p-=1))*Math.sin((p*w-y)*(2*Math.PI)/_))+x)},ElasticEaseOut(p,x,v,w,S,_){let y=0;return p===0?x:(p/=w)===1?x+v:(_||(_=w*.3),!S||S<Math.abs(v)?(S=v,y=_/4):y=_/(2*Math.PI)*Math.asin(v/S),S*Math.pow(2,-10*p)*Math.sin((p*w-y)*(2*Math.PI)/_)+v+x)},ElasticEaseInOut(p,x,v,w,S,_){let y=0;return p===0?x:(p/=w/2)===2?x+v:(_||(_=w*(.3*1.5)),!S||S<Math.abs(v)?(S=v,y=_/4):y=_/(2*Math.PI)*Math.asin(v/S),p<1?-.5*(S*Math.pow(2,10*(p-=1))*Math.sin((p*w-y)*(2*Math.PI)/_))+x:S*Math.pow(2,-10*(p-=1))*Math.sin((p*w-y)*(2*Math.PI)/_)*.5+v+x)},BounceEaseOut(p,x,v,w){return(p/=w)<1/2.75?v*(7.5625*p*p)+x:p<2/2.75?v*(7.5625*(p-=1.5/2.75)*p+.75)+x:p<2.5/2.75?v*(7.5625*(p-=2.25/2.75)*p+.9375)+x:v*(7.5625*(p-=2.625/2.75)*p+.984375)+x},BounceEaseIn(p,x,v,w){return v-t.Easings.BounceEaseOut(w-p,0,v,w)+x},BounceEaseInOut(p,x,v,w){return p<w/2?t.Easings.BounceEaseIn(p*2,0,v,w)*.5+x:t.Easings.BounceEaseOut(p*2-w,0,v,w)*.5+v*.5+x},EaseIn(p,x,v,w){return v*(p/=w)*p+x},EaseOut(p,x,v,w){return-v*(p/=w)*(p-2)+x},EaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p+x:-v/2*(--p*(p-2)-1)+x},StrongEaseIn(p,x,v,w){return v*(p/=w)*p*p*p*p+x},StrongEaseOut(p,x,v,w){return v*((p=p/w-1)*p*p*p*p+1)+x},StrongEaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p*p*p*p+x:v/2*((p-=2)*p*p*p*p+2)+x},Linear(p,x,v,w){return v*p/w+x}}})(V7);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;const e=ur,r=wn,n=ln,s=id,a=W7,i=dm,o=My,l=mh,u=Dy,d=ss,g=ph,h=V7,p=cl,x=Yi;t.Konva=r.Util._assign(e.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:l.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:g.Animation,Tween:h.Tween,Easings:h.Easings,Context:p.Context,Canvas:x.Canvas}),t.default=t.Konva})(b1);var Iy={};Object.defineProperty(Iy,"__esModule",{value:!0});Iy.Arc=void 0;const Oy=mr,QK=ss,q5=ur,Ly=Zt,qK=ur;let Tl=class extends QK.Shape{_sceneFunc(e){const r=q5.Konva.getAngle(this.angle()),n=this.clockwise();e.beginPath(),e.arc(0,0,this.outerRadius(),0,r,n),e.arc(0,0,this.innerRadius(),r,0,!n),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}getSelfRect(){const e=this.innerRadius(),r=this.outerRadius(),n=this.clockwise(),s=q5.Konva.getAngle(n?360-this.angle():this.angle()),a=Math.cos(Math.min(s,Math.PI)),i=1,o=Math.sin(Math.min(Math.max(Math.PI,s),3*Math.PI/2)),l=Math.sin(Math.min(s,Math.PI/2)),u=a*(a>0?e:r),d=i*r,g=o*(o>0?e:r),h=l*(l>0?r:e);return{x:u,y:n?-1*h:g,width:d-u,height:h-g}}};Iy.Arc=Tl;Tl.prototype._centroid=!0;Tl.prototype.className="Arc";Tl.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"];(0,qK._registerNode)(Tl);Oy.Factory.addGetterSetter(Tl,"innerRadius",0,(0,Ly.getNumberValidator)());Oy.Factory.addGetterSetter(Tl,"outerRadius",0,(0,Ly.getNumberValidator)());Oy.Factory.addGetterSetter(Tl,"angle",0,(0,Ly.getNumberValidator)());Oy.Factory.addGetterSetter(Tl,"clockwise",!1,(0,Ly.getBooleanValidator)());var By={},fm={};Object.defineProperty(fm,"__esModule",{value:!0});fm.Line=void 0;const Uy=mr,ZK=ur,eX=ss,K7=Zt;function rS(t,e,r,n,s,a,i){const o=Math.sqrt(Math.pow(r-t,2)+Math.pow(n-e,2)),l=Math.sqrt(Math.pow(s-r,2)+Math.pow(a-n,2)),u=i*o/(o+l),d=i*l/(o+l),g=r-u*(s-t),h=n-u*(a-e),p=r+d*(s-t),x=n+d*(a-e);return[g,h,p,x]}function Z5(t,e){const r=t.length,n=[];for(let s=2;s<r-2;s+=2){const a=rS(t[s-2],t[s-1],t[s],t[s+1],t[s+2],t[s+3],e);isNaN(a[0])||(n.push(a[0]),n.push(a[1]),n.push(t[s]),n.push(t[s+1]),n.push(a[2]),n.push(a[3]))}return n}let Mc=class extends eX.Shape{constructor(e){super(e),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(e){const r=this.points(),n=r.length,s=this.tension(),a=this.closed(),i=this.bezier();if(!n)return;let o=0;if(e.beginPath(),e.moveTo(r[0],r[1]),s!==0&&n>4){const l=this.getTensionPoints(),u=l.length;for(o=a?0:4,a||e.quadraticCurveTo(l[0],l[1],l[2],l[3]);o<u-2;)e.bezierCurveTo(l[o++],l[o++],l[o++],l[o++],l[o++],l[o++]);a||e.quadraticCurveTo(l[u-2],l[u-1],r[n-2],r[n-1])}else if(i)for(o=2;o<n;)e.bezierCurveTo(r[o++],r[o++],r[o++],r[o++],r[o++],r[o++]);else for(o=2;o<n;o+=2)e.lineTo(r[o],r[o+1]);a?(e.closePath(),e.fillStrokeShape(this)):e.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():Z5(this.points(),this.tension())}_getTensionPointsClosed(){const e=this.points(),r=e.length,n=this.tension(),s=rS(e[r-2],e[r-1],e[0],e[1],e[2],e[3],n),a=rS(e[r-4],e[r-3],e[r-2],e[r-1],e[0],e[1],n),i=Z5(e,n);return[s[2],s[3]].concat(i).concat([a[0],a[1],e[r-2],e[r-1],a[2],a[3],s[0],s[1],e[0],e[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let e=this.points();if(e.length<4)return{x:e[0]||0,y:e[1]||0,width:0,height:0};this.tension()!==0?e=[e[0],e[1],...this._getTensionPoints(),e[e.length-2],e[e.length-1]]:e=this.points();let r=e[0],n=e[0],s=e[1],a=e[1],i,o;for(let l=0;l<e.length/2;l++)i=e[l*2],o=e[l*2+1],r=Math.min(r,i),n=Math.max(n,i),s=Math.min(s,o),a=Math.max(a,o);return{x:r,y:s,width:n-r,height:a-s}}};fm.Line=Mc;Mc.prototype.className="Line";Mc.prototype._attrsAffectingSize=["points","bezier","tension"];(0,ZK._registerNode)(Mc);Uy.Factory.addGetterSetter(Mc,"closed",!1);Uy.Factory.addGetterSetter(Mc,"bezier",!1);Uy.Factory.addGetterSetter(Mc,"tension",0,(0,K7.getNumberValidator)());Uy.Factory.addGetterSetter(Mc,"points",[],(0,K7.getNumberArrayValidator)());var xh={},X7={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.t2length=t.getQuadraticArcLength=t.getCubicArcLength=t.binomialCoefficients=t.cValues=t.tValues=void 0,t.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],t.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],t.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const e=(i,o,l)=>{let u,d;const h=l/2;u=0;for(let p=0;p<20;p++)d=h*t.tValues[20][p]+h,u+=t.cValues[20][p]*n(i,o,d);return h*u};t.getCubicArcLength=e;const r=(i,o,l)=>{l===void 0&&(l=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],g=2*i[1]-2*i[0],h=2*o[1]-2*o[0],p=4*(u*u+d*d),x=4*(u*g+d*h),v=g*g+h*h;if(p===0)return l*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const w=x/(2*p),S=v/p,_=l+w,y=S-w*w,k=_*_+y>0?Math.sqrt(_*_+y):0,N=w*w+y>0?Math.sqrt(w*w+y):0,E=w+Math.sqrt(w*w+y)!==0?y*Math.log(Math.abs((_+k)/(w+N))):0;return Math.sqrt(p)/2*(_*k-w*N+E)};t.getQuadraticArcLength=r;function n(i,o,l){const u=s(1,l,i),d=s(1,l,o),g=u*u+d*d;return Math.sqrt(g)}const s=(i,o,l)=>{const u=l.length-1;let d,g;if(u===0)return 0;if(i===0){g=0;for(let h=0;h<=u;h++)g+=t.binomialCoefficients[u][h]*Math.pow(1-o,u-h)*Math.pow(o,h)*l[h];return g}else{d=new Array(u);for(let h=0;h<u;h++)d[h]=u*(l[h+1]-l[h]);return s(i-1,o,d)}},a=(i,o,l)=>{let u=1,d=i/o,g=(i-l(d))/o,h=0;for(;u>.001;){const p=l(d+g),x=Math.abs(i-p)/o;if(x<u)u=x,d+=g;else{const v=l(d-g),w=Math.abs(i-v)/o;w<u?(u=w,d-=g):g/=2}if(h++,h>500)break}return d};t.t2length=a})(X7);Object.defineProperty(xh,"__esModule",{value:!0});xh.Path=void 0;const tX=mr,rX=ur,nX=ss,Bd=X7;let hm=class va extends nX.Shape{constructor(e){super(e),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=va.parsePathData(this.data()),this.pathLength=va.getPathLength(this.dataArray)}_sceneFunc(e){const r=this.dataArray;e.beginPath();let n=!1;for(let s=0;s<r.length;s++){const a=r[s].command,i=r[s].points;switch(a){case"L":e.lineTo(i[0],i[1]);break;case"M":e.moveTo(i[0],i[1]);break;case"C":e.bezierCurveTo(i[0],i[1],i[2],i[3],i[4],i[5]);break;case"Q":e.quadraticCurveTo(i[0],i[1],i[2],i[3]);break;case"A":const o=i[0],l=i[1],u=i[2],d=i[3],g=i[4],h=i[5],p=i[6],x=i[7],v=u>d?u:d,w=u>d?1:u/d,S=u>d?d/u:1;e.translate(o,l),e.rotate(p),e.scale(w,S),e.arc(0,0,v,g,g+h,1-x),e.scale(1/w,1/S),e.rotate(-p),e.translate(-o,-l);break;case"z":n=!0,e.closePath();break}}!n&&!this.hasFill()?e.strokeShape(this):e.fillStrokeShape(this)}getSelfRect(){let e=[];this.dataArray.forEach(function(l){if(l.command==="A"){const u=l.points[4],d=l.points[5],g=l.points[4]+d;let h=Math.PI/180;if(Math.abs(u-g)<h&&(h=Math.abs(u-g)),d<0)for(let p=u-h;p>g;p-=h){const x=va.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);e.push(x.x,x.y)}else for(let p=u+h;p<g;p+=h){const x=va.getPointOnEllipticalArc(l.points[0],l.points[1],l.points[2],l.points[3],p,0);e.push(x.x,x.y)}}else if(l.command==="C")for(let u=0;u<=1;u+=.01){const d=va.getPointOnCubicBezier(u,l.start.x,l.start.y,l.points[0],l.points[1],l.points[2],l.points[3],l.points[4],l.points[5]);e.push(d.x,d.y)}else e=e.concat(l.points)});let r=e[0],n=e[0],s=e[1],a=e[1],i,o;for(let l=0;l<e.length/2;l++)i=e[l*2],o=e[l*2+1],isNaN(i)||(r=Math.min(r,i),n=Math.max(n,i)),isNaN(o)||(s=Math.min(s,o),a=Math.max(a,o));return{x:r,y:s,width:n-r,height:a-s}}getLength(){return this.pathLength}getPointAtLength(e){return va.getPointAtLengthOfDataArray(e,this.dataArray)}static getLineLength(e,r,n,s){return Math.sqrt((n-e)*(n-e)+(s-r)*(s-r))}static getPathLength(e){let r=0;for(let n=0;n<e.length;++n)r+=e[n].pathLength;return r}static getPointAtLengthOfDataArray(e,r){let n,s=0,a=r.length;if(!a)return null;for(;s<a&&e>r[s].pathLength;)e-=r[s].pathLength,++s;if(s===a)return n=r[s-1].points.slice(-2),{x:n[0],y:n[1]};if(e<.01)return r[s].command==="M"?(n=r[s].points.slice(0,2),{x:n[0],y:n[1]}):{x:r[s].start.x,y:r[s].start.y};const i=r[s],o=i.points;switch(i.command){case"L":return va.getPointOnLine(e,i.start.x,i.start.y,o[0],o[1]);case"C":return va.getPointOnCubicBezier((0,Bd.t2length)(e,va.getPathLength(r),v=>(0,Bd.getCubicArcLength)([i.start.x,o[0],o[2],o[4]],[i.start.y,o[1],o[3],o[5]],v)),i.start.x,i.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return va.getPointOnQuadraticBezier((0,Bd.t2length)(e,va.getPathLength(r),v=>(0,Bd.getQuadraticArcLength)([i.start.x,o[0],o[2]],[i.start.y,o[1],o[3]],v)),i.start.x,i.start.y,o[0],o[1],o[2],o[3]);case"A":const l=o[0],u=o[1],d=o[2],g=o[3],h=o[5],p=o[6];let x=o[4];return x+=h*e/i.pathLength,va.getPointOnEllipticalArc(l,u,d,g,x,p)}return null}static getPointOnLine(e,r,n,s,a,i,o){i=i??r,o=o??n;const l=this.getLineLength(r,n,s,a);if(l<1e-10)return{x:r,y:n};if(s===r)return{x:i,y:o+(a>n?e:-e)};const u=(a-n)/(s-r),d=Math.sqrt(e*e/(1+u*u))*(s<r?-1:1),g=u*d;if(Math.abs(o-n-u*(i-r))<1e-10)return{x:i+d,y:o+g};const h=((i-r)*(s-r)+(o-n)*(a-n))/(l*l),p=r+h*(s-r),x=n+h*(a-n),v=this.getLineLength(i,o,p,x),w=Math.sqrt(e*e-v*v),S=Math.sqrt(w*w/(1+u*u))*(s<r?-1:1),_=u*S;return{x:p+S,y:x+_}}static getPointOnCubicBezier(e,r,n,s,a,i,o,l,u){function d(w){return w*w*w}function g(w){return 3*w*w*(1-w)}function h(w){return 3*w*(1-w)*(1-w)}function p(w){return(1-w)*(1-w)*(1-w)}const x=l*d(e)+i*g(e)+s*h(e)+r*p(e),v=u*d(e)+o*g(e)+a*h(e)+n*p(e);return{x,y:v}}static getPointOnQuadraticBezier(e,r,n,s,a,i,o){function l(p){return p*p}function u(p){return 2*p*(1-p)}function d(p){return(1-p)*(1-p)}const g=i*l(e)+s*u(e)+r*d(e),h=o*l(e)+a*u(e)+n*d(e);return{x:g,y:h}}static getPointOnEllipticalArc(e,r,n,s,a,i){const o=Math.cos(i),l=Math.sin(i),u={x:n*Math.cos(a),y:s*Math.sin(a)};return{x:e+(u.x*o-u.y*l),y:r+(u.x*l+u.y*o)}}static parsePathData(e){if(!e)return[];let r=e;const n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];r=r.replace(new RegExp(" ","g"),",");for(let g=0;g<n.length;g++)r=r.replace(new RegExp(n[g],"g"),"|"+n[g]);const s=r.split("|"),a=[],i=[];let o=0,l=0;const u=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let d;for(let g=1;g<s.length;g++){let h=s[g],p=h.charAt(0);for(h=h.slice(1),i.length=0;d=u.exec(h);)i.push(d[0]);const x=[];for(let v=0,w=i.length;v<w;v++){if(i[v]==="00"){x.push(0,0);continue}const S=parseFloat(i[v]);isNaN(S)?x.push(0):x.push(S)}for(;x.length>0&&!isNaN(x[0]);){let v="",w=[];const S=o,_=l;let y,k,N,E,A,C,F,P,M,I;switch(p){case"l":o+=x.shift(),l+=x.shift(),v="L",w.push(o,l);break;case"L":o=x.shift(),l=x.shift(),w.push(o,l);break;case"m":const Y=x.shift(),se=x.shift();if(o+=Y,l+=se,v="M",a.length>2&&a[a.length-1].command==="z"){for(let L=a.length-2;L>=0;L--)if(a[L].command==="M"){o=a[L].points[0]+Y,l=a[L].points[1]+se;break}}w.push(o,l),p="l";break;case"M":o=x.shift(),l=x.shift(),v="M",w.push(o,l),p="L";break;case"h":o+=x.shift(),v="L",w.push(o,l);break;case"H":o=x.shift(),v="L",w.push(o,l);break;case"v":l+=x.shift(),v="L",w.push(o,l);break;case"V":l=x.shift(),v="L",w.push(o,l);break;case"C":w.push(x.shift(),x.shift(),x.shift(),x.shift()),o=x.shift(),l=x.shift(),w.push(o,l);break;case"c":w.push(o+x.shift(),l+x.shift(),o+x.shift(),l+x.shift()),o+=x.shift(),l+=x.shift(),v="C",w.push(o,l);break;case"S":k=o,N=l,y=a[a.length-1],y.command==="C"&&(k=o+(o-y.points[2]),N=l+(l-y.points[3])),w.push(k,N,x.shift(),x.shift()),o=x.shift(),l=x.shift(),v="C",w.push(o,l);break;case"s":k=o,N=l,y=a[a.length-1],y.command==="C"&&(k=o+(o-y.points[2]),N=l+(l-y.points[3])),w.push(k,N,o+x.shift(),l+x.shift()),o+=x.shift(),l+=x.shift(),v="C",w.push(o,l);break;case"Q":w.push(x.shift(),x.shift()),o=x.shift(),l=x.shift(),w.push(o,l);break;case"q":w.push(o+x.shift(),l+x.shift()),o+=x.shift(),l+=x.shift(),v="Q",w.push(o,l);break;case"T":k=o,N=l,y=a[a.length-1],y.command==="Q"&&(k=o+(o-y.points[0]),N=l+(l-y.points[1])),o=x.shift(),l=x.shift(),v="Q",w.push(k,N,o,l);break;case"t":k=o,N=l,y=a[a.length-1],y.command==="Q"&&(k=o+(o-y.points[0]),N=l+(l-y.points[1])),o+=x.shift(),l+=x.shift(),v="Q",w.push(k,N,o,l);break;case"A":E=x.shift(),A=x.shift(),C=x.shift(),F=x.shift(),P=x.shift(),M=o,I=l,o=x.shift(),l=x.shift(),v="A",w=this.convertEndpointToCenterParameterization(M,I,o,l,F,P,E,A,C);break;case"a":E=x.shift(),A=x.shift(),C=x.shift(),F=x.shift(),P=x.shift(),M=o,I=l,o+=x.shift(),l+=x.shift(),v="A",w=this.convertEndpointToCenterParameterization(M,I,o,l,F,P,E,A,C);break}a.push({command:v||p,points:w,start:{x:S,y:_},pathLength:this.calcLength(S,_,v||p,w)})}(p==="z"||p==="Z")&&a.push({command:"z",points:[],start:void 0,pathLength:0})}return a}static calcLength(e,r,n,s){let a,i,o,l;const u=va;switch(n){case"L":return u.getLineLength(e,r,s[0],s[1]);case"C":return(0,Bd.getCubicArcLength)([e,s[0],s[2],s[4]],[r,s[1],s[3],s[5]],1);case"Q":return(0,Bd.getQuadraticArcLength)([e,s[0],s[2]],[r,s[1],s[3]],1);case"A":a=0;const d=s[4],g=s[5],h=s[4]+g;let p=Math.PI/180;if(Math.abs(d-h)<p&&(p=Math.abs(d-h)),i=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],d,0),g<0)for(l=d-p;l>h;l-=p)o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),i=o;else for(l=d+p;l<h;l+=p)o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],l,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),i=o;return o=u.getPointOnEllipticalArc(s[0],s[1],s[2],s[3],h,0),a+=u.getLineLength(i.x,i.y,o.x,o.y),a}return 0}static convertEndpointToCenterParameterization(e,r,n,s,a,i,o,l,u){const d=u*(Math.PI/180),g=Math.cos(d)*(e-n)/2+Math.sin(d)*(r-s)/2,h=-1*Math.sin(d)*(e-n)/2+Math.cos(d)*(r-s)/2,p=g*g/(o*o)+h*h/(l*l);p>1&&(o*=Math.sqrt(p),l*=Math.sqrt(p));let x=Math.sqrt((o*o*(l*l)-o*o*(h*h)-l*l*(g*g))/(o*o*(h*h)+l*l*(g*g)));a===i&&(x*=-1),isNaN(x)&&(x=0);const v=x*o*h/l,w=x*-l*g/o,S=(e+n)/2+Math.cos(d)*v-Math.sin(d)*w,_=(r+s)/2+Math.sin(d)*v+Math.cos(d)*w,y=function(P){return Math.sqrt(P[0]*P[0]+P[1]*P[1])},k=function(P,M){return(P[0]*M[0]+P[1]*M[1])/(y(P)*y(M))},N=function(P,M){return(P[0]*M[1]<P[1]*M[0]?-1:1)*Math.acos(k(P,M))},E=N([1,0],[(g-v)/o,(h-w)/l]),A=[(g-v)/o,(h-w)/l],C=[(-1*g-v)/o,(-1*h-w)/l];let F=N(A,C);return k(A,C)<=-1&&(F=Math.PI),k(A,C)>=1&&(F=0),i===0&&F>0&&(F=F-2*Math.PI),i===1&&F<0&&(F=F+2*Math.PI),[S,_,o,l,E,F,d,i]}};xh.Path=hm;hm.prototype.className="Path";hm.prototype._attrsAffectingSize=["data"];(0,rX._registerNode)(hm);tX.Factory.addGetterSetter(hm,"data");Object.defineProperty(By,"__esModule",{value:!0});By.Arrow=void 0;const $y=mr,sX=fm,Y7=Zt,aX=ur,e6=xh;let ld=class extends sX.Line{_sceneFunc(e){super._sceneFunc(e);const r=Math.PI*2,n=this.points();let s=n;const a=this.tension()!==0&&n.length>4;a&&(s=this.getTensionPoints());const i=this.pointerLength(),o=n.length;let l,u;if(a){const h=[s[s.length-4],s[s.length-3],s[s.length-2],s[s.length-1],n[o-2],n[o-1]],p=e6.Path.calcLength(s[s.length-4],s[s.length-3],"C",h),x=e6.Path.getPointOnQuadraticBezier(Math.min(1,1-i/p),h[0],h[1],h[2],h[3],h[4],h[5]);l=n[o-2]-x.x,u=n[o-1]-x.y}else l=n[o-2]-n[o-4],u=n[o-1]-n[o-3];const d=(Math.atan2(u,l)+r)%r,g=this.pointerWidth();this.pointerAtEnding()&&(e.save(),e.beginPath(),e.translate(n[o-2],n[o-1]),e.rotate(d),e.moveTo(0,0),e.lineTo(-i,g/2),e.lineTo(-i,-g/2),e.closePath(),e.restore(),this.__fillStroke(e)),this.pointerAtBeginning()&&(e.save(),e.beginPath(),e.translate(n[0],n[1]),a?(l=(s[0]+s[2])/2-n[0],u=(s[1]+s[3])/2-n[1]):(l=n[2]-n[0],u=n[3]-n[1]),e.rotate((Math.atan2(-u,-l)+r)%r),e.moveTo(0,0),e.lineTo(-i,g/2),e.lineTo(-i,-g/2),e.closePath(),e.restore(),this.__fillStroke(e))}__fillStroke(e){const r=this.dashEnabled();r&&(this.attrs.dashEnabled=!1,e.setLineDash([])),e.fillStrokeShape(this),r&&(this.attrs.dashEnabled=!0)}getSelfRect(){const e=super.getSelfRect(),r=this.pointerWidth()/2;return{x:e.x,y:e.y-r,width:e.width,height:e.height+r*2}}};By.Arrow=ld;ld.prototype.className="Arrow";(0,aX._registerNode)(ld);$y.Factory.addGetterSetter(ld,"pointerLength",10,(0,Y7.getNumberValidator)());$y.Factory.addGetterSetter(ld,"pointerWidth",10,(0,Y7.getNumberValidator)());$y.Factory.addGetterSetter(ld,"pointerAtBeginning",!1);$y.Factory.addGetterSetter(ld,"pointerAtEnding",!0);var Wy={};Object.defineProperty(Wy,"__esModule",{value:!0});Wy.Circle=void 0;const iX=mr,oX=ss,lX=Zt,cX=ur;let yh=class extends oX.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius()!==e/2&&this.radius(e/2)}setHeight(e){this.radius()!==e/2&&this.radius(e/2)}};Wy.Circle=yh;yh.prototype._centroid=!0;yh.prototype.className="Circle";yh.prototype._attrsAffectingSize=["radius"];(0,cX._registerNode)(yh);iX.Factory.addGetterSetter(yh,"radius",0,(0,lX.getNumberValidator)());var Hy={};Object.defineProperty(Hy,"__esModule",{value:!0});Hy.Ellipse=void 0;const WC=mr,uX=ss,J7=Zt,dX=ur;let Ic=class extends uX.Shape{_sceneFunc(e){const r=this.radiusX(),n=this.radiusY();e.beginPath(),e.save(),r!==n&&e.scale(1,n/r),e.arc(0,0,r,0,Math.PI*2,!1),e.restore(),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(e){this.radiusX(e/2)}setHeight(e){this.radiusY(e/2)}};Hy.Ellipse=Ic;Ic.prototype.className="Ellipse";Ic.prototype._centroid=!0;Ic.prototype._attrsAffectingSize=["radiusX","radiusY"];(0,dX._registerNode)(Ic);WC.Factory.addComponentsGetterSetter(Ic,"radius",["x","y"]);WC.Factory.addGetterSetter(Ic,"radiusX",0,(0,J7.getNumberValidator)());WC.Factory.addGetterSetter(Ic,"radiusY",0,(0,J7.getNumberValidator)());var zy={};Object.defineProperty(zy,"__esModule",{value:!0});zy.Image=void 0;const J_=wn,cd=mr,fX=ss,hX=ur,gm=Zt;let Mo=class Q7 extends fX.Shape{constructor(e){super(e),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",r=>{this._removeImageLoad(r.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const e=this.image();e&&e.complete||e&&e.readyState===4||e&&e.addEventListener&&e.addEventListener("load",this._loadListener)}_removeImageLoad(e){e&&e.removeEventListener&&e.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const e=!!this.cornerRadius(),r=this.hasShadow();return e&&r?!0:super._useBufferCanvas(!0)}_sceneFunc(e){const r=this.getWidth(),n=this.getHeight(),s=this.cornerRadius(),a=this.attrs.image;let i;if(a){const o=this.attrs.cropWidth,l=this.attrs.cropHeight;o&&l?i=[a,this.cropX(),this.cropY(),o,l,0,0,r,n]:i=[a,0,0,r,n]}(this.hasFill()||this.hasStroke()||s)&&(e.beginPath(),s?J_.Util.drawRoundedRectPath(e,r,n,s):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)),a&&(s&&e.clip(),e.drawImage.apply(e,i))}_hitFunc(e){const r=this.width(),n=this.height(),s=this.cornerRadius();e.beginPath(),s?J_.Util.drawRoundedRectPath(e,r,n,s):e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}getWidth(){var e,r;return(e=this.attrs.width)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.width}getHeight(){var e,r;return(e=this.attrs.height)!==null&&e!==void 0?e:(r=this.image())===null||r===void 0?void 0:r.height}static fromURL(e,r,n=null){const s=J_.Util.createImageElement();s.onload=function(){const a=new Q7({image:s});r(a)},s.onerror=n,s.crossOrigin="Anonymous",s.src=e}};zy.Image=Mo;Mo.prototype.className="Image";(0,hX._registerNode)(Mo);cd.Factory.addGetterSetter(Mo,"cornerRadius",0,(0,gm.getNumberOrArrayOfNumbersValidator)(4));cd.Factory.addGetterSetter(Mo,"image");cd.Factory.addComponentsGetterSetter(Mo,"crop",["x","y","width","height"]);cd.Factory.addGetterSetter(Mo,"cropX",0,(0,gm.getNumberValidator)());cd.Factory.addGetterSetter(Mo,"cropY",0,(0,gm.getNumberValidator)());cd.Factory.addGetterSetter(Mo,"cropWidth",0,(0,gm.getNumberValidator)());cd.Factory.addGetterSetter(Mo,"cropHeight",0,(0,gm.getNumberValidator)());var Kf={};Object.defineProperty(Kf,"__esModule",{value:!0});Kf.Tag=Kf.Label=void 0;const Gy=mr,gX=ss,mX=mh,HC=Zt,q7=ur,Z7=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],pX="Change.konva",xX="none",nS="up",sS="right",aS="down",iS="left",yX=Z7.length;let zC=class extends mX.Group{constructor(e){super(e),this.on("add.konva",function(r){this._addListeners(r.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(e){let r=this,n;const s=function(){r._sync()};for(n=0;n<yX;n++)e.on(Z7[n]+pX,s)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let e=this.getText(),r=this.getTag(),n,s,a,i,o,l,u;if(e&&r){switch(n=e.width(),s=e.height(),a=r.pointerDirection(),i=r.pointerWidth(),u=r.pointerHeight(),o=0,l=0,a){case nS:o=n/2,l=-1*u;break;case sS:o=n+i,l=s/2;break;case aS:o=n/2,l=s+u;break;case iS:o=-1*i,l=s/2;break}r.setAttrs({x:-1*o,y:-1*l,width:n,height:s}),e.setAttrs({x:-1*o,y:-1*l})}}};Kf.Label=zC;zC.prototype.className="Label";(0,q7._registerNode)(zC);let ud=class extends gX.Shape{_sceneFunc(e){const r=this.width(),n=this.height(),s=this.pointerDirection(),a=this.pointerWidth(),i=this.pointerHeight(),o=this.cornerRadius();let l=0,u=0,d=0,g=0;typeof o=="number"?l=u=d=g=Math.min(o,r/2,n/2):(l=Math.min(o[0]||0,r/2,n/2),u=Math.min(o[1]||0,r/2,n/2),g=Math.min(o[2]||0,r/2,n/2),d=Math.min(o[3]||0,r/2,n/2)),e.beginPath(),e.moveTo(l,0),s===nS&&(e.lineTo((r-a)/2,0),e.lineTo(r/2,-1*i),e.lineTo((r+a)/2,0)),e.lineTo(r-u,0),e.arc(r-u,u,u,Math.PI*3/2,0,!1),s===sS&&(e.lineTo(r,(n-i)/2),e.lineTo(r+a,n/2),e.lineTo(r,(n+i)/2)),e.lineTo(r,n-g),e.arc(r-g,n-g,g,0,Math.PI/2,!1),s===aS&&(e.lineTo((r+a)/2,n),e.lineTo(r/2,n+i),e.lineTo((r-a)/2,n)),e.lineTo(d,n),e.arc(d,n-d,d,Math.PI/2,Math.PI,!1),s===iS&&(e.lineTo(0,(n+i)/2),e.lineTo(-1*a,n/2),e.lineTo(0,(n-i)/2)),e.lineTo(0,l),e.arc(l,l,l,Math.PI,Math.PI*3/2,!1),e.closePath(),e.fillStrokeShape(this)}getSelfRect(){let e=0,r=0,n=this.pointerWidth(),s=this.pointerHeight(),a=this.pointerDirection(),i=this.width(),o=this.height();return a===nS?(r-=s,o+=s):a===aS?o+=s:a===iS?(e-=n*1.5,i+=n):a===sS&&(i+=n*1.5),{x:e,y:r,width:i,height:o}}};Kf.Tag=ud;ud.prototype.className="Tag";(0,q7._registerNode)(ud);Gy.Factory.addGetterSetter(ud,"pointerDirection",xX);Gy.Factory.addGetterSetter(ud,"pointerWidth",0,(0,HC.getNumberValidator)());Gy.Factory.addGetterSetter(ud,"pointerHeight",0,(0,HC.getNumberValidator)());Gy.Factory.addGetterSetter(ud,"cornerRadius",0,(0,HC.getNumberOrArrayOfNumbersValidator)(4));var mm={};Object.defineProperty(mm,"__esModule",{value:!0});mm.Rect=void 0;const vX=mr,wX=ss,_X=ur,bX=wn,SX=Zt;let Vy=class extends wX.Shape{_sceneFunc(e){const r=this.cornerRadius(),n=this.width(),s=this.height();e.beginPath(),r?bX.Util.drawRoundedRectPath(e,n,s,r):e.rect(0,0,n,s),e.closePath(),e.fillStrokeShape(this)}};mm.Rect=Vy;Vy.prototype.className="Rect";(0,_X._registerNode)(Vy);vX.Factory.addGetterSetter(Vy,"cornerRadius",0,(0,SX.getNumberOrArrayOfNumbersValidator)(4));var Ky={};Object.defineProperty(Ky,"__esModule",{value:!0});Ky.RegularPolygon=void 0;const e9=mr,kX=ss,t9=Zt,CX=ur;let dd=class extends kX.Shape{_sceneFunc(e){const r=this._getPoints();e.beginPath(),e.moveTo(r[0].x,r[0].y);for(let n=1;n<r.length;n++)e.lineTo(r[n].x,r[n].y);e.closePath(),e.fillStrokeShape(this)}_getPoints(){const e=this.attrs.sides,r=this.attrs.radius||0,n=[];for(let s=0;s<e;s++)n.push({x:r*Math.sin(s*2*Math.PI/e),y:-1*r*Math.cos(s*2*Math.PI/e)});return n}getSelfRect(){const e=this._getPoints();let r=e[0].x,n=e[0].y,s=e[0].x,a=e[0].y;return e.forEach(i=>{r=Math.min(r,i.x),n=Math.max(n,i.x),s=Math.min(s,i.y),a=Math.max(a,i.y)}),{x:r,y:s,width:n-r,height:a-s}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Ky.RegularPolygon=dd;dd.prototype.className="RegularPolygon";dd.prototype._centroid=!0;dd.prototype._attrsAffectingSize=["radius"];(0,CX._registerNode)(dd);e9.Factory.addGetterSetter(dd,"radius",0,(0,t9.getNumberValidator)());e9.Factory.addGetterSetter(dd,"sides",0,(0,t9.getNumberValidator)());var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});Xy.Ring=void 0;const r9=mr,TX=ss,n9=Zt,EX=ur,t6=Math.PI*2;let fd=class extends TX.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.innerRadius(),0,t6,!1),e.moveTo(this.outerRadius(),0),e.arc(0,0,this.outerRadius(),t6,0,!0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};Xy.Ring=fd;fd.prototype.className="Ring";fd.prototype._centroid=!0;fd.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,EX._registerNode)(fd);r9.Factory.addGetterSetter(fd,"innerRadius",0,(0,n9.getNumberValidator)());r9.Factory.addGetterSetter(fd,"outerRadius",0,(0,n9.getNumberValidator)());var Yy={};Object.defineProperty(Yy,"__esModule",{value:!0});Yy.Sprite=void 0;const hd=mr,NX=ss,AX=ph,s9=Zt,jX=ur;let Io=class extends NX.Shape{constructor(e){super(e),this._updated=!0,this.anim=new AX.Animation(()=>{const r=this._updated;return this._updated=!1,r}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(e){const r=this.animation(),n=this.frameIndex(),s=n*4,a=this.animations()[r],i=this.frameOffsets(),o=a[s+0],l=a[s+1],u=a[s+2],d=a[s+3],g=this.image();if((this.hasFill()||this.hasStroke())&&(e.beginPath(),e.rect(0,0,u,d),e.closePath(),e.fillStrokeShape(this)),g)if(i){const h=i[r],p=n*2;e.drawImage(g,o,l,u,d,h[p+0],h[p+1],u,d)}else e.drawImage(g,o,l,u,d,0,0,u,d)}_hitFunc(e){const r=this.animation(),n=this.frameIndex(),s=n*4,a=this.animations()[r],i=this.frameOffsets(),o=a[s+2],l=a[s+3];if(e.beginPath(),i){const u=i[r],d=n*2;e.rect(u[d+0],u[d+1],o,l)}else e.rect(0,0,o,l);e.closePath(),e.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const e=this;this.interval=setInterval(function(){e._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const e=this.getLayer();this.anim.setLayers(e),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const e=this.frameIndex(),r=this.animation(),n=this.animations(),s=n[r],a=s.length/4;e<a-1?this.frameIndex(e+1):this.frameIndex(0)}};Yy.Sprite=Io;Io.prototype.className="Sprite";(0,jX._registerNode)(Io);hd.Factory.addGetterSetter(Io,"animation");hd.Factory.addGetterSetter(Io,"animations");hd.Factory.addGetterSetter(Io,"frameOffsets");hd.Factory.addGetterSetter(Io,"image");hd.Factory.addGetterSetter(Io,"frameIndex",0,(0,s9.getNumberValidator)());hd.Factory.addGetterSetter(Io,"frameRate",17,(0,s9.getNumberValidator)());hd.Factory.backCompat(Io,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"});var Jy={};Object.defineProperty(Jy,"__esModule",{value:!0});Jy.Star=void 0;const GC=mr,FX=ss,VC=Zt,PX=ur;let Oc=class extends FX.Shape{_sceneFunc(e){const r=this.innerRadius(),n=this.outerRadius(),s=this.numPoints();e.beginPath(),e.moveTo(0,0-n);for(let a=1;a<s*2;a++){const i=a%2===0?n:r,o=i*Math.sin(a*Math.PI/s),l=-1*i*Math.cos(a*Math.PI/s);e.lineTo(o,l)}e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(e){this.outerRadius(e/2)}setHeight(e){this.outerRadius(e/2)}};Jy.Star=Oc;Oc.prototype.className="Star";Oc.prototype._centroid=!0;Oc.prototype._attrsAffectingSize=["innerRadius","outerRadius"];(0,PX._registerNode)(Oc);GC.Factory.addGetterSetter(Oc,"numPoints",5,(0,VC.getNumberValidator)());GC.Factory.addGetterSetter(Oc,"innerRadius",0,(0,VC.getNumberValidator)());GC.Factory.addGetterSetter(Oc,"outerRadius",0,(0,VC.getNumberValidator)());var vh={};Object.defineProperty(vh,"__esModule",{value:!0});vh.Text=void 0;vh.stringToArray=uu;const oS=wn,Zs=mr,DX=ss,Q_=ur,Lc=Zt,RX=ur;function uu(t){return[...t].reduce((e,r,n,s)=>{if(new RegExp("\\p{Emoji}","u").test(r)){const a=s[n+1];a&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(a)?(e.push(r+a),s[n+1]=""):e.push(r)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(r+(s[n+1]||""))?e.push(r+s[n+1]):n>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(r)?e[e.length-1]+=r:r&&e.push(r);return e},[])}const Ud="auto",MX="center",a9="inherit",l0="justify",IX="Change.konva",OX="2d",r6="-",i9="left",LX="text",BX="Text",UX="top",$X="bottom",n6="middle",o9="normal",WX="px ",Qp=" ",HX="right",s6="rtl",zX="word",GX="char",a6="none",q_="",l9=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],VX=l9.length;function KX(t){return t.split(",").map(e=>{e=e.trim();const r=e.indexOf(" ")>=0,n=e.indexOf('"')>=0||e.indexOf("'")>=0;return r&&!n&&(e=`"${e}"`),e}).join(", ")}let qp;function Z_(){return qp||(qp=oS.Util.createCanvasElement().getContext(OX),qp)}function XX(t){t.fillText(this._partialText,this._partialTextX,this._partialTextY)}function YX(t){t.setAttr("miterLimit",2),t.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function JX(t){return t=t||{},!t.fillLinearGradientColorStops&&!t.fillRadialGradientColorStops&&!t.fillPatternImage&&(t.fill=t.fill||"black"),t}let Fn=class extends DX.Shape{constructor(e){super(JX(e)),this._partialTextX=0,this._partialTextY=0;for(let r=0;r<VX;r++)this.on(l9[r]+IX,this._setTextData);this._setTextData()}_sceneFunc(e){const r=this.textArr,n=r.length;if(!this.text())return;let s=this.padding(),a=this.fontSize(),i=this.lineHeight()*a,o=this.verticalAlign(),l=this.direction(),u=0,d=this.align(),g=this.getWidth(),h=this.letterSpacing(),p=this.fill(),x=this.textDecoration(),v=x.indexOf("underline")!==-1,w=x.indexOf("line-through")!==-1,S;l=l===a9?e.direction:l;let _=i/2,y=n6;if(Q_.Konva._fixTextRendering){const k=this.measureSize("M");y="alphabetic",_=(k.fontBoundingBoxAscent-k.fontBoundingBoxDescent)/2+i/2}for(l===s6&&e.setAttr("direction",l),e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",y),e.setAttr("textAlign",i9),o===n6?u=(this.getHeight()-n*i-s*2)/2:o===$X&&(u=this.getHeight()-n*i-s*2),e.translate(s,u+s),S=0;S<n;S++){let k=0,N=0;const E=r[S],A=E.text,C=E.width,F=E.lastInParagraph;if(e.save(),d===HX?k+=g-C-s*2:d===MX&&(k+=(g-C-s*2)/2),v){e.save(),e.beginPath();const P=Q_.Konva._fixTextRendering?Math.round(a/4):Math.round(a/2),M=k,I=_+N+P;e.moveTo(M,I);const Y=d===l0&&!F?g-s*2:C;e.lineTo(M+Math.round(Y),I),e.lineWidth=a/15;const se=this._getLinearGradient();e.strokeStyle=se||p,e.stroke(),e.restore()}if(w){e.save(),e.beginPath();const P=Q_.Konva._fixTextRendering?-Math.round(a/4):0;e.moveTo(k,_+N+P);const M=d===l0&&!F?g-s*2:C;e.lineTo(k+Math.round(M),_+N+P),e.lineWidth=a/15;const I=this._getLinearGradient();e.strokeStyle=I||p,e.stroke(),e.restore()}if(l!==s6&&(h!==0||d===l0)){const P=A.split(" ").length-1,M=uu(A);for(let I=0;I<M.length;I++){const Y=M[I];Y===" "&&!F&&d===l0&&(k+=(g-s*2-C)/P),this._partialTextX=k,this._partialTextY=_+N,this._partialText=Y,e.fillStrokeShape(this),k+=this.measureSize(Y).width+h}}else h!==0&&e.setAttr("letterSpacing",`${h}px`),this._partialTextX=k,this._partialTextY=_+N,this._partialText=A,e.fillStrokeShape(this);e.restore(),n>1&&(_+=i)}}_hitFunc(e){const r=this.getWidth(),n=this.getHeight();e.beginPath(),e.rect(0,0,r,n),e.closePath(),e.fillStrokeShape(this)}setText(e){const r=oS.Util._isString(e)?e:e==null?"":e+"";return this._setAttr(LX,r),this}getWidth(){return this.attrs.width===Ud||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===Ud||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return oS.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(e){var r,n,s,a,i,o,l,u,d,g,h;let p=Z_(),x=this.fontSize(),v;p.save(),p.font=this._getContextFont(),v=p.measureText(e),p.restore();const w=x/100;return{actualBoundingBoxAscent:(r=v.actualBoundingBoxAscent)!==null&&r!==void 0?r:71.58203125*w,actualBoundingBoxDescent:(n=v.actualBoundingBoxDescent)!==null&&n!==void 0?n:0,actualBoundingBoxLeft:(s=v.actualBoundingBoxLeft)!==null&&s!==void 0?s:-7.421875*w,actualBoundingBoxRight:(a=v.actualBoundingBoxRight)!==null&&a!==void 0?a:75.732421875*w,alphabeticBaseline:(i=v.alphabeticBaseline)!==null&&i!==void 0?i:0,emHeightAscent:(o=v.emHeightAscent)!==null&&o!==void 0?o:100*w,emHeightDescent:(l=v.emHeightDescent)!==null&&l!==void 0?l:-20*w,fontBoundingBoxAscent:(u=v.fontBoundingBoxAscent)!==null&&u!==void 0?u:91*w,fontBoundingBoxDescent:(d=v.fontBoundingBoxDescent)!==null&&d!==void 0?d:21*w,hangingBaseline:(g=v.hangingBaseline)!==null&&g!==void 0?g:72.80000305175781*w,ideographicBaseline:(h=v.ideographicBaseline)!==null&&h!==void 0?h:-21*w,width:v.width,height:x}}_getContextFont(){return this.fontStyle()+Qp+this.fontVariant()+Qp+(this.fontSize()+WX)+KX(this.fontFamily())}_addTextLine(e){this.align()===l0&&(e=e.trim());const n=this._getTextWidth(e);return this.textArr.push({text:e,width:n,lastInParagraph:!1})}_getTextWidth(e){const r=this.letterSpacing(),n=e.length;return Z_().measureText(e).width+r*n}_setTextData(){let e=this.text().split(`
`),r=+this.fontSize(),n=0,s=this.lineHeight()*r,a=this.attrs.width,i=this.attrs.height,o=a!==Ud&&a!==void 0,l=i!==Ud&&i!==void 0,u=this.padding(),d=a-u*2,g=i-u*2,h=0,p=this.wrap(),x=p!==a6,v=p!==GX&&x,w=this.ellipsis();this.textArr=[],Z_().font=this._getContextFont();const S=w?this._getTextWidth(q_):0;for(let _=0,y=e.length;_<y;++_){let k=e[_],N=this._getTextWidth(k);if(o&&N>d)for(;k.length>0;){let E=0,A=uu(k).length,C="",F=0;for(;E<A;){const P=E+A>>>1,M=uu(k),I=M.slice(0,P+1).join(""),Y=this._getTextWidth(I);(w&&l&&h+s>g?Y+S:Y)<=d?(E=P+1,C=I,F=Y):A=P}if(C){if(v){const I=uu(k),Y=uu(C),se=I[Y.length],L=se===Qp||se===r6;let z;if(L&&F<=d)z=Y.length;else{const G=Y.lastIndexOf(Qp),O=Y.lastIndexOf(r6);z=Math.max(G,O)+1}z>0&&(E=z,C=I.slice(0,E).join(""),F=this._getTextWidth(C))}if(C=C.trimRight(),this._addTextLine(C),n=Math.max(n,F),h+=s,this._shouldHandleEllipsis(h)){this._tryToAddEllipsisToLastLine();break}if(k=uu(k).slice(E).join("").trimLeft(),k.length>0&&(N=this._getTextWidth(k),N<=d)){this._addTextLine(k),h+=s,n=Math.max(n,N);break}}else break}else this._addTextLine(k),h+=s,n=Math.max(n,N),this._shouldHandleEllipsis(h)&&_<y-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),l&&h+s>g)break}this.textHeight=r,this.textWidth=n}_shouldHandleEllipsis(e){const r=+this.fontSize(),n=this.lineHeight()*r,s=this.attrs.height,a=s!==Ud&&s!==void 0,i=this.padding(),o=s-i*2;return!(this.wrap()!==a6)||a&&e+n>o}_tryToAddEllipsisToLastLine(){const e=this.attrs.width,r=e!==Ud&&e!==void 0,n=this.padding(),s=e-n*2,a=this.ellipsis(),i=this.textArr[this.textArr.length-1];!i||!a||(r&&(this._getTextWidth(i.text+q_)<s||(i.text=i.text.slice(0,i.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(i.text+q_))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const e=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,r=this.hasShadow();return e&&r?!0:super._useBufferCanvas()}};vh.Text=Fn;Fn.prototype._fillFunc=XX;Fn.prototype._strokeFunc=YX;Fn.prototype.className=BX;Fn.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"];(0,RX._registerNode)(Fn);Zs.Factory.overWriteSetter(Fn,"width",(0,Lc.getNumberOrAutoValidator)());Zs.Factory.overWriteSetter(Fn,"height",(0,Lc.getNumberOrAutoValidator)());Zs.Factory.addGetterSetter(Fn,"direction",a9);Zs.Factory.addGetterSetter(Fn,"fontFamily","Arial");Zs.Factory.addGetterSetter(Fn,"fontSize",12,(0,Lc.getNumberValidator)());Zs.Factory.addGetterSetter(Fn,"fontStyle",o9);Zs.Factory.addGetterSetter(Fn,"fontVariant",o9);Zs.Factory.addGetterSetter(Fn,"padding",0,(0,Lc.getNumberValidator)());Zs.Factory.addGetterSetter(Fn,"align",i9);Zs.Factory.addGetterSetter(Fn,"verticalAlign",UX);Zs.Factory.addGetterSetter(Fn,"lineHeight",1,(0,Lc.getNumberValidator)());Zs.Factory.addGetterSetter(Fn,"wrap",zX);Zs.Factory.addGetterSetter(Fn,"ellipsis",!1,(0,Lc.getBooleanValidator)());Zs.Factory.addGetterSetter(Fn,"letterSpacing",0,(0,Lc.getNumberValidator)());Zs.Factory.addGetterSetter(Fn,"text","",(0,Lc.getStringValidator)());Zs.Factory.addGetterSetter(Fn,"textDecoration","");var Qy={};Object.defineProperty(Qy,"__esModule",{value:!0});Qy.TextPath=void 0;const e2=wn,no=mr,QX=ss,c0=xh,t2=vh,c9=Zt,qX=ur,ZX="",u9="normal";function d9(t){t.fillText(this.partialText,0,0)}function f9(t){t.strokeText(this.partialText,0,0)}let as=class extends QX.Shape{constructor(e){super(e),this.dummyCanvas=e2.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return c0.Path.getPathLength(this.dataArray)}_getPointAtLength(e){if(!this.attrs.data)return null;const r=this.pathLength;return e-1>r?null:c0.Path.getPointAtLengthOfDataArray(e,this.dataArray)}_readDataAttribute(){this.dataArray=c0.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(e){e.setAttr("font",this._getContextFont()),e.setAttr("textBaseline",this.textBaseline()),e.setAttr("textAlign","left"),e.save();const r=this.textDecoration(),n=this.fill(),s=this.fontSize(),a=this.glyphInfo;r==="underline"&&e.beginPath();for(let i=0;i<a.length;i++){e.save();const o=a[i].p0;e.translate(o.x,o.y),e.rotate(a[i].rotation),this.partialText=a[i].text,e.fillStrokeShape(this),r==="underline"&&(i===0&&e.moveTo(0,s/2+1),e.lineTo(s,s/2+1)),e.restore()}r==="underline"&&(e.strokeStyle=n,e.lineWidth=s/20,e.stroke()),e.restore()}_hitFunc(e){e.beginPath();const r=this.glyphInfo;if(r.length>=1){const n=r[0].p0;e.moveTo(n.x,n.y)}for(let n=0;n<r.length;n++){const s=r[n].p1;e.lineTo(s.x,s.y)}e.setAttr("lineWidth",this.fontSize()),e.setAttr("strokeStyle",this.colorKey),e.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e2.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(e){return t2.Text.prototype.setText.call(this,e)}_getContextFont(){return t2.Text.prototype._getContextFont.call(this)}_getTextSize(e){const n=this.dummyCanvas.getContext("2d");n.save(),n.font=this._getContextFont();const s=n.measureText(e);return n.restore(),{width:s.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:e,height:r}=this._getTextSize(this.attrs.text);if(this.textWidth=e,this.textHeight=r,this.glyphInfo=[],!this.attrs.data)return null;const n=this.letterSpacing(),s=this.align(),a=this.kerningFunc(),i=Math.max(this.textWidth+((this.attrs.text||"").length-1)*n,0);let o=0;s==="center"&&(o=Math.max(0,this.pathLength/2-i/2)),s==="right"&&(o=Math.max(0,this.pathLength-i));const l=(0,t2.stringToArray)(this.text());let u=o;for(let d=0;d<l.length;d++){const g=this._getPointAtLength(u);if(!g)return;let h=this._getTextSize(l[d]).width+n;if(l[d]===" "&&s==="justify"){const _=this.text().split(" ").length-1;h+=(this.pathLength-i)/_}const p=this._getPointAtLength(u+h);if(!p)return;const x=c0.Path.getLineLength(g.x,g.y,p.x,p.y);let v=0;if(a)try{v=a(l[d-1],l[d])*this.fontSize()}catch{v=0}g.x+=v,p.x+=v,this.textWidth+=v;const w=c0.Path.getPointOnLine(v+x/2,g.x,g.y,p.x,p.y),S=Math.atan2(p.y-g.y,p.x-g.x);this.glyphInfo.push({transposeX:w.x,transposeY:w.y,text:l[d],rotation:S,p0:g,p1:p}),u+=h}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const e=[];this.glyphInfo.forEach(function(u){e.push(u.p0.x),e.push(u.p0.y),e.push(u.p1.x),e.push(u.p1.y)});let r=e[0]||0,n=e[0]||0,s=e[1]||0,a=e[1]||0,i,o;for(let u=0;u<e.length/2;u++)i=e[u*2],o=e[u*2+1],r=Math.min(r,i),n=Math.max(n,i),s=Math.min(s,o),a=Math.max(a,o);const l=this.fontSize();return{x:r-l/2,y:s-l/2,width:n-r+l,height:a-s+l}}destroy(){return e2.Util.releaseCanvas(this.dummyCanvas),super.destroy()}};Qy.TextPath=as;as.prototype._fillFunc=d9;as.prototype._strokeFunc=f9;as.prototype._fillFuncHit=d9;as.prototype._strokeFuncHit=f9;as.prototype.className="TextPath";as.prototype._attrsAffectingSize=["text","fontSize","data"];(0,qX._registerNode)(as);no.Factory.addGetterSetter(as,"data");no.Factory.addGetterSetter(as,"fontFamily","Arial");no.Factory.addGetterSetter(as,"fontSize",12,(0,c9.getNumberValidator)());no.Factory.addGetterSetter(as,"fontStyle",u9);no.Factory.addGetterSetter(as,"align","left");no.Factory.addGetterSetter(as,"letterSpacing",0,(0,c9.getNumberValidator)());no.Factory.addGetterSetter(as,"textBaseline","middle");no.Factory.addGetterSetter(as,"fontVariant",u9);no.Factory.addGetterSetter(as,"text",ZX);no.Factory.addGetterSetter(as,"textDecoration","");no.Factory.addGetterSetter(as,"kerningFunc",void 0);var qy={};Object.defineProperty(qy,"__esModule",{value:!0});qy.Transformer=void 0;const Br=wn,Pr=mr,i6=ln,eY=ss,tY=mm,o6=mh,Li=ur,Bc=Zt,rY=ur,h9="tr-konva",nY=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(t=>t+`.${h9}`).join(" "),l6="nodesRect",sY=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],aY={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},iY="ontouchstart"in Li.Konva._global;function oY(t,e,r){if(t==="rotater")return r;e+=Br.Util.degToRad(aY[t]||0);const n=(Br.Util.radToDeg(e)%360+360)%360;return Br.Util._inRange(n,315+22.5,360)||Br.Util._inRange(n,0,22.5)?"ns-resize":Br.Util._inRange(n,45-22.5,45+22.5)?"nesw-resize":Br.Util._inRange(n,90-22.5,90+22.5)?"ew-resize":Br.Util._inRange(n,135-22.5,135+22.5)?"nwse-resize":Br.Util._inRange(n,180-22.5,180+22.5)?"ns-resize":Br.Util._inRange(n,225-22.5,225+22.5)?"nesw-resize":Br.Util._inRange(n,270-22.5,270+22.5)?"ew-resize":Br.Util._inRange(n,315-22.5,315+22.5)?"nwse-resize":(Br.Util.error("Transformer has unknown angle for cursor detection: "+n),"pointer")}const k1=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function lY(t){return{x:t.x+t.width/2*Math.cos(t.rotation)+t.height/2*Math.sin(-t.rotation),y:t.y+t.height/2*Math.cos(t.rotation)+t.width/2*Math.sin(t.rotation)}}function g9(t,e,r){const n=r.x+(t.x-r.x)*Math.cos(e)-(t.y-r.y)*Math.sin(e),s=r.y+(t.x-r.x)*Math.sin(e)+(t.y-r.y)*Math.cos(e);return{...t,rotation:t.rotation+e,x:n,y:s}}function cY(t,e){const r=lY(t);return g9(t,e,r)}function uY(t,e,r){let n=e;for(let s=0;s<t.length;s++){const a=Li.Konva.getAngle(t[s]),i=Math.abs(a-e)%(Math.PI*2);Math.min(i,Math.PI*2-i)<r&&(n=a)}return n}let lS=0,wr=class extends o6.Group{constructor(e){super(e),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(nY,this.update),this.getNode()&&this.update()}attachTo(e){return this.setNode(e),this}setNode(e){return Br.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([e])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return h9+this._id}setNodes(e=[]){this._nodes&&this._nodes.length&&this.detach();const r=e.filter(s=>s.isAncestorOf(this)?(Br.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=e=r,e.length===1&&this.useSingleNodeRotation()?this.rotation(e[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(s=>{const a=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(s._attrsAffectingSize.length){const i=s._attrsAffectingSize.map(o=>o+"Change."+this._getEventNamespace()).join(" ");s.on(i,a)}s.on(sY.map(i=>i+`.${this._getEventNamespace()}`).join(" "),a),s.on(`absoluteTransformChange.${this._getEventNamespace()}`,a),this._proxyDrag(s)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(e){let r;e.on(`dragstart.${this._getEventNamespace()}`,n=>{r=e.getAbsolutePosition(),!this.isDragging()&&e!==this.findOne(".back")&&this.startDrag(n,!1)}),e.on(`dragmove.${this._getEventNamespace()}`,n=>{if(!r)return;const s=e.getAbsolutePosition(),a=s.x-r.x,i=s.y-r.y;this.nodes().forEach(o=>{if(o===e||o.isDragging())return;const l=o.getAbsolutePosition();o.setAbsolutePosition({x:l.x+a,y:l.y+i}),o.startDrag(n)}),r=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(e=>{e.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(l6),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(l6,this.__getNodeRect)}__getNodeShape(e,r=this.rotation(),n){const s=e.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),a=e.getAbsoluteScale(n),i=e.getAbsolutePosition(n),o=s.x*a.x-e.offsetX()*a.x,l=s.y*a.y-e.offsetY()*a.y,u=(Li.Konva.getAngle(e.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),d={x:i.x+o*Math.cos(u)+l*Math.sin(-u),y:i.y+l*Math.cos(u)+o*Math.sin(u),width:s.width*a.x,height:s.height*a.y,rotation:u};return g9(d,-Li.Konva.getAngle(r),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const r=[];this.nodes().map(u=>{const d=u.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),g=[{x:d.x,y:d.y},{x:d.x+d.width,y:d.y},{x:d.x+d.width,y:d.y+d.height},{x:d.x,y:d.y+d.height}],h=u.getAbsoluteTransform();g.forEach(function(p){const x=h.point(p);r.push(x)})});const n=new Br.Transform;n.rotate(-Li.Konva.getAngle(this.rotation()));let s=1/0,a=1/0,i=-1/0,o=-1/0;r.forEach(function(u){const d=n.point(u);s===void 0&&(s=i=d.x,a=o=d.y),s=Math.min(s,d.x),a=Math.min(a,d.y),i=Math.max(i,d.x),o=Math.max(o,d.y)}),n.invert();const l=n.point({x:s,y:a});return{x:l.x,y:l.y,width:i-s,height:o-a,rotation:Li.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),k1.forEach(e=>{this._createAnchor(e)}),this._createAnchor("rotater")}_createAnchor(e){const r=new tY.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:e+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:iY?10:"auto"}),n=this;r.on("mousedown touchstart",function(s){n._handleMouseDown(s)}),r.on("dragstart",s=>{r.stopDrag(),s.cancelBubble=!0}),r.on("dragend",s=>{s.cancelBubble=!0}),r.on("mouseenter",()=>{const s=Li.Konva.getAngle(this.rotation()),a=this.rotateAnchorCursor(),i=oY(e,s,a);r.getStage().content&&(r.getStage().content.style.cursor=i),this._cursorChange=!0}),r.on("mouseout",()=>{r.getStage().content&&(r.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(r)}_createBack(){const e=new eY.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(r,n){const s=n.getParent(),a=s.padding();r.beginPath(),r.rect(-a,-a,n.width()+a*2,n.height()+a*2),r.moveTo(n.width()/2,-a),s.rotateEnabled()&&s.rotateLineVisible()&&r.lineTo(n.width()/2,-s.rotateAnchorOffset()*Br.Util._sign(n.height())-a),r.fillStrokeShape(n)},hitFunc:(r,n)=>{if(!this.shouldOverdrawWholeArea())return;const s=this.padding();r.beginPath(),r.rect(-s,-s,n.width()+s*2,n.height()+s*2),r.fillStrokeShape(n)}});this.add(e),this._proxyDrag(e),e.on("dragstart",r=>{r.cancelBubble=!0}),e.on("dragmove",r=>{r.cancelBubble=!0}),e.on("dragend",r=>{r.cancelBubble=!0}),this.on("dragmove",r=>{this.update()})}_handleMouseDown(e){if(this._transforming)return;this._movingAnchorName=e.target.name().split(" ")[0];const r=this._getNodeRect(),n=r.width,s=r.height,a=Math.sqrt(Math.pow(n,2)+Math.pow(s,2));this.sin=Math.abs(s/a),this.cos=Math.abs(n/a),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const i=e.target.getAbsolutePosition(),o=e.target.getStage().getPointerPosition();this._anchorDragOffset={x:o.x-i.x,y:o.y-i.y},lS++,this._fire("transformstart",{evt:e.evt,target:this.getNode()}),this._nodes.forEach(l=>{l._fire("transformstart",{evt:e.evt,target:l})})}_handleMouseMove(e){let r,n,s;const a=this.findOne("."+this._movingAnchorName),i=a.getStage();i.setPointersPositions(e);const o=i.getPointerPosition();let l={x:o.x-this._anchorDragOffset.x,y:o.y-this._anchorDragOffset.y};const u=a.getAbsolutePosition();this.anchorDragBoundFunc()&&(l=this.anchorDragBoundFunc()(u,l,e)),a.setAbsolutePosition(l);const d=a.getAbsolutePosition();if(u.x===d.x&&u.y===d.y)return;if(this._movingAnchorName==="rotater"){const _=this._getNodeRect();r=a.x()-_.width/2,n=-a.y()+_.height/2;let y=Math.atan2(-n,r)+Math.PI/2;_.height<0&&(y-=Math.PI);const N=Li.Konva.getAngle(this.rotation())+y,E=Li.Konva.getAngle(this.rotationSnapTolerance()),C=uY(this.rotationSnaps(),N,E)-_.rotation,F=cY(_,C);this._fitNodesInto(F,e);return}const g=this.shiftBehavior();let h;g==="inverted"?h=this.keepRatio()&&!e.shiftKey:g==="none"?h=this.keepRatio():h=this.keepRatio()||e.shiftKey;let p=this.centeredScaling()||e.altKey;if(this._movingAnchorName==="top-left"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};s=Math.sqrt(Math.pow(_.x-a.x(),2)+Math.pow(_.y-a.y(),2));const y=this.findOne(".top-left").x()>_.x?-1:1,k=this.findOne(".top-left").y()>_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,this.findOne(".top-left").x(_.x-r),this.findOne(".top-left").y(_.y-n)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(a.y());else if(this._movingAnchorName==="top-right"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};s=Math.sqrt(Math.pow(a.x()-_.x,2)+Math.pow(_.y-a.y(),2));const y=this.findOne(".top-right").x()<_.x?-1:1,k=this.findOne(".top-right").y()>_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,this.findOne(".top-right").x(_.x+r),this.findOne(".top-right").y(_.y-n)}var x=a.position();this.findOne(".top-left").y(x.y),this.findOne(".bottom-right").x(x.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(a.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(a.x());else if(this._movingAnchorName==="bottom-left"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};s=Math.sqrt(Math.pow(_.x-a.x(),2)+Math.pow(a.y()-_.y,2));const y=_.x<a.x()?-1:1,k=a.y()<_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,a.x(_.x-r),a.y(_.y+n)}x=a.position(),this.findOne(".top-left").x(x.x),this.findOne(".bottom-right").y(x.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(a.y());else if(this._movingAnchorName==="bottom-right"){if(h){const _=p?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};s=Math.sqrt(Math.pow(a.x()-_.x,2)+Math.pow(a.y()-_.y,2));const y=this.findOne(".bottom-right").x()<_.x?-1:1,k=this.findOne(".bottom-right").y()<_.y?-1:1;r=s*this.cos*y,n=s*this.sin*k,this.findOne(".bottom-right").x(_.x+r),this.findOne(".bottom-right").y(_.y+n)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(p=this.centeredScaling()||e.altKey,p){const _=this.findOne(".top-left"),y=this.findOne(".bottom-right"),k=_.x(),N=_.y(),E=this.getWidth()-y.x(),A=this.getHeight()-y.y();y.move({x:-k,y:-N}),_.move({x:E,y:A})}const v=this.findOne(".top-left").getAbsolutePosition();r=v.x,n=v.y;const w=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),S=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:r,y:n,width:w,height:S,rotation:Li.Konva.getAngle(this.rotation())},e)}_handleMouseUp(e){this._removeEvents(e)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(e){var r;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const n=this.getNode();lS--,this._fire("transformend",{evt:e,target:n}),(r=this.getLayer())===null||r===void 0||r.batchDraw(),n&&this._nodes.forEach(s=>{var a;s._fire("transformend",{evt:e,target:s}),(a=s.getLayer())===null||a===void 0||a.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(e,r){const n=this._getNodeRect(),s=1;if(Br.Util._inRange(e.width,-this.padding()*2-s,s)){this.update();return}if(Br.Util._inRange(e.height,-this.padding()*2-s,s)){this.update();return}const a=new Br.Transform;if(a.rotate(Li.Konva.getAngle(this.rotation())),this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("left")>=0){const h=a.point({x:-this.padding()*2,y:0});e.x+=h.x,e.y+=h.y,e.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y}else if(this._movingAnchorName&&e.width<0&&this._movingAnchorName.indexOf("right")>=0){const h=a.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.width+=this.padding()*2}if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("top")>=0){const h=a.point({x:0,y:-this.padding()*2});e.x+=h.x,e.y+=h.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}else if(this._movingAnchorName&&e.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const h=a.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=h.x,this._anchorDragOffset.y-=h.y,e.height+=this.padding()*2}if(this.boundBoxFunc()){const h=this.boundBoxFunc()(n,e);h?e=h:Br.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const i=1e7,o=new Br.Transform;o.translate(n.x,n.y),o.rotate(n.rotation),o.scale(n.width/i,n.height/i);const l=new Br.Transform,u=e.width/i,d=e.height/i;this.flipEnabled()===!1?(l.translate(e.x,e.y),l.rotate(e.rotation),l.translate(e.width<0?e.width:0,e.height<0?e.height:0),l.scale(Math.abs(u),Math.abs(d))):(l.translate(e.x,e.y),l.rotate(e.rotation),l.scale(u,d));const g=l.multiply(o.invert());this._nodes.forEach(h=>{var p;const x=h.getParent().getAbsoluteTransform(),v=h.getTransform().copy();v.translate(h.offsetX(),h.offsetY());const w=new Br.Transform;w.multiply(x.copy().invert()).multiply(g).multiply(x).multiply(v);const S=w.decompose();h.setAttrs(S),(p=h.getLayer())===null||p===void 0||p.batchDraw()}),this.rotation(Br.Util._getRotation(e.rotation)),this._nodes.forEach(h=>{this._fire("transform",{evt:r,target:h}),h._fire("transform",{evt:r,target:h})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(e,r){this.findOne(e).setAttrs(r)}update(){var e;const r=this._getNodeRect();this.rotation(Br.Util._getRotation(r.rotation));const n=r.width,s=r.height,a=this.enabledAnchors(),i=this.resizeEnabled(),o=this.padding(),l=this.anchorSize(),u=this.find("._anchor");u.forEach(g=>{g.setAttrs({width:l,height:l,offsetX:l/2,offsetY:l/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:l/2+o,offsetY:l/2+o,visible:i&&a.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:n/2,y:0,offsetY:l/2+o,visible:i&&a.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:n,y:0,offsetX:l/2-o,offsetY:l/2+o,visible:i&&a.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:s/2,offsetX:l/2+o,visible:i&&a.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:n,y:s/2,offsetX:l/2-o,visible:i&&a.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:s,offsetX:l/2+o,offsetY:l/2-o,visible:i&&a.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:n/2,y:s,offsetY:l/2-o,visible:i&&a.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:n,y:s,offsetX:l/2-o,offsetY:l/2-o,visible:i&&a.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:n/2,y:-this.rotateAnchorOffset()*Br.Util._sign(s)-o,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:n,height:s,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const d=this.anchorStyleFunc();d&&u.forEach(g=>{d(g)}),(e=this.getLayer())===null||e===void 0||e.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const e=this.findOne("."+this._movingAnchorName);e&&e.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),o6.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return i6.Node.prototype.toObject.call(this)}clone(e){return i6.Node.prototype.clone.call(this,e)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}};qy.Transformer=wr;wr.isTransforming=()=>lS>0;function dY(t){return t instanceof Array||Br.Util.warn("enabledAnchors value should be an array"),t instanceof Array&&t.forEach(function(e){k1.indexOf(e)===-1&&Br.Util.warn("Unknown anchor name: "+e+". Available names are: "+k1.join(", "))}),t||[]}wr.prototype.className="Transformer";(0,rY._registerNode)(wr);Pr.Factory.addGetterSetter(wr,"enabledAnchors",k1,dY);Pr.Factory.addGetterSetter(wr,"flipEnabled",!0,(0,Bc.getBooleanValidator)());Pr.Factory.addGetterSetter(wr,"resizeEnabled",!0);Pr.Factory.addGetterSetter(wr,"anchorSize",10,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"rotateEnabled",!0);Pr.Factory.addGetterSetter(wr,"rotateLineVisible",!0);Pr.Factory.addGetterSetter(wr,"rotationSnaps",[]);Pr.Factory.addGetterSetter(wr,"rotateAnchorOffset",50,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"rotateAnchorCursor","crosshair");Pr.Factory.addGetterSetter(wr,"rotationSnapTolerance",5,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"borderEnabled",!0);Pr.Factory.addGetterSetter(wr,"anchorStroke","rgb(0, 161, 255)");Pr.Factory.addGetterSetter(wr,"anchorStrokeWidth",1,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"anchorFill","white");Pr.Factory.addGetterSetter(wr,"anchorCornerRadius",0,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"borderStroke","rgb(0, 161, 255)");Pr.Factory.addGetterSetter(wr,"borderStrokeWidth",1,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"borderDash");Pr.Factory.addGetterSetter(wr,"keepRatio",!0);Pr.Factory.addGetterSetter(wr,"shiftBehavior","default");Pr.Factory.addGetterSetter(wr,"centeredScaling",!1);Pr.Factory.addGetterSetter(wr,"ignoreStroke",!1);Pr.Factory.addGetterSetter(wr,"padding",0,(0,Bc.getNumberValidator)());Pr.Factory.addGetterSetter(wr,"nodes");Pr.Factory.addGetterSetter(wr,"node");Pr.Factory.addGetterSetter(wr,"boundBoxFunc");Pr.Factory.addGetterSetter(wr,"anchorDragBoundFunc");Pr.Factory.addGetterSetter(wr,"anchorStyleFunc");Pr.Factory.addGetterSetter(wr,"shouldOverdrawWholeArea",!1);Pr.Factory.addGetterSetter(wr,"useSingleNodeRotation",!0);Pr.Factory.backCompat(wr,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"});var Zy={};Object.defineProperty(Zy,"__esModule",{value:!0});Zy.Wedge=void 0;const ev=mr,fY=ss,hY=ur,m9=Zt,gY=ur;let El=class extends fY.Shape{_sceneFunc(e){e.beginPath(),e.arc(0,0,this.radius(),0,hY.Konva.getAngle(this.angle()),this.clockwise()),e.lineTo(0,0),e.closePath(),e.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(e){this.radius(e/2)}setHeight(e){this.radius(e/2)}};Zy.Wedge=El;El.prototype.className="Wedge";El.prototype._centroid=!0;El.prototype._attrsAffectingSize=["radius"];(0,gY._registerNode)(El);ev.Factory.addGetterSetter(El,"radius",0,(0,m9.getNumberValidator)());ev.Factory.addGetterSetter(El,"angle",0,(0,m9.getNumberValidator)());ev.Factory.addGetterSetter(El,"clockwise",!1);ev.Factory.backCompat(El,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"});var tv={};Object.defineProperty(tv,"__esModule",{value:!0});tv.Blur=void 0;const c6=mr,mY=ln,pY=Zt;function u6(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const xY=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],yY=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function vY(t,e){const r=t.data,n=t.width,s=t.height;let a,i,o,l,u,d,g,h,p,x,v,w,S,_,y,k,N,E,A,C;const F=e+e+1,P=n-1,M=s-1,I=e+1,Y=I*(I+1)/2,se=new u6,L=xY[e],z=yY[e];let G=null,O=se,R=null,X=null;for(let te=1;te<F;te++)O=O.next=new u6,te===I&&(G=O);O.next=se,o=i=0;for(let te=0;te<s;te++){w=S=_=y=l=u=d=g=0,h=I*(k=r[i]),p=I*(N=r[i+1]),x=I*(E=r[i+2]),v=I*(A=r[i+3]),l+=Y*k,u+=Y*N,d+=Y*E,g+=Y*A,O=se;for(let H=0;H<I;H++)O.r=k,O.g=N,O.b=E,O.a=A,O=O.next;for(let H=1;H<I;H++)a=i+((P<H?P:H)<<2),l+=(O.r=k=r[a])*(C=I-H),u+=(O.g=N=r[a+1])*C,d+=(O.b=E=r[a+2])*C,g+=(O.a=A=r[a+3])*C,w+=k,S+=N,_+=E,y+=A,O=O.next;R=se,X=G;for(let H=0;H<n;H++)r[i+3]=A=g*L>>z,A!==0?(A=255/A,r[i]=(l*L>>z)*A,r[i+1]=(u*L>>z)*A,r[i+2]=(d*L>>z)*A):r[i]=r[i+1]=r[i+2]=0,l-=h,u-=p,d-=x,g-=v,h-=R.r,p-=R.g,x-=R.b,v-=R.a,a=o+((a=H+e+1)<P?a:P)<<2,w+=R.r=r[a],S+=R.g=r[a+1],_+=R.b=r[a+2],y+=R.a=r[a+3],l+=w,u+=S,d+=_,g+=y,R=R.next,h+=k=X.r,p+=N=X.g,x+=E=X.b,v+=A=X.a,w-=k,S-=N,_-=E,y-=A,X=X.next,i+=4;o+=n}for(let te=0;te<n;te++){S=_=y=w=u=d=g=l=0,i=te<<2,h=I*(k=r[i]),p=I*(N=r[i+1]),x=I*(E=r[i+2]),v=I*(A=r[i+3]),l+=Y*k,u+=Y*N,d+=Y*E,g+=Y*A,O=se;for(let V=0;V<I;V++)O.r=k,O.g=N,O.b=E,O.a=A,O=O.next;let H=n;for(let V=1;V<=e;V++)i=H+te<<2,l+=(O.r=k=r[i])*(C=I-V),u+=(O.g=N=r[i+1])*C,d+=(O.b=E=r[i+2])*C,g+=(O.a=A=r[i+3])*C,w+=k,S+=N,_+=E,y+=A,O=O.next,V<M&&(H+=n);i=te,R=se,X=G;for(let V=0;V<s;V++)a=i<<2,r[a+3]=A=g*L>>z,A>0?(A=255/A,r[a]=(l*L>>z)*A,r[a+1]=(u*L>>z)*A,r[a+2]=(d*L>>z)*A):r[a]=r[a+1]=r[a+2]=0,l-=h,u-=p,d-=x,g-=v,h-=R.r,p-=R.g,x-=R.b,v-=R.a,a=te+((a=V+I)<M?a:M)*n<<2,l+=w+=R.r=r[a],u+=S+=R.g=r[a+1],d+=_+=R.b=r[a+2],g+=y+=R.a=r[a+3],R=R.next,h+=k=X.r,p+=N=X.g,x+=E=X.b,v+=A=X.a,w-=k,S-=N,_-=E,y-=A,X=X.next,i+=n}}const wY=function(e){const r=Math.round(this.blurRadius());r>0&&vY(e,r)};tv.Blur=wY;c6.Factory.addGetterSetter(mY.Node,"blurRadius",0,(0,pY.getNumberValidator)(),c6.Factory.afterSetFilter);var rv={};Object.defineProperty(rv,"__esModule",{value:!0});rv.Brighten=void 0;const d6=mr,_Y=ln,bY=Zt,SY=function(t){const e=this.brightness()*255,r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]+=e,r[s+1]+=e,r[s+2]+=e};rv.Brighten=SY;d6.Factory.addGetterSetter(_Y.Node,"brightness",0,(0,bY.getNumberValidator)(),d6.Factory.afterSetFilter);var nv={};Object.defineProperty(nv,"__esModule",{value:!0});nv.Contrast=void 0;const f6=mr,kY=ln,CY=Zt,TY=function(t){const e=Math.pow((this.contrast()+100)/100,2),r=t.data,n=r.length;let s=150,a=150,i=150;for(let o=0;o<n;o+=4)s=r[o],a=r[o+1],i=r[o+2],s/=255,s-=.5,s*=e,s+=.5,s*=255,a/=255,a-=.5,a*=e,a+=.5,a*=255,i/=255,i-=.5,i*=e,i+=.5,i*=255,s=s<0?0:s>255?255:s,a=a<0?0:a>255?255:a,i=i<0?0:i>255?255:i,r[o]=s,r[o+1]=a,r[o+2]=i};nv.Contrast=TY;f6.Factory.addGetterSetter(kY.Node,"contrast",0,(0,CY.getNumberValidator)(),f6.Factory.afterSetFilter);var sv={};Object.defineProperty(sv,"__esModule",{value:!0});sv.Emboss=void 0;const bc=mr,av=ln,EY=wn,p9=Zt,NY=function(t){const e=this.embossStrength()*10,r=this.embossWhiteLevel()*255,n=this.embossDirection(),s=this.embossBlend(),a=t.data,i=t.width,o=t.height,l=i*4;let u=0,d=0,g=o;switch(n){case"top-left":u=-1,d=-1;break;case"top":u=-1,d=0;break;case"top-right":u=-1,d=1;break;case"right":u=0,d=1;break;case"bottom-right":u=1,d=1;break;case"bottom":u=1,d=0;break;case"bottom-left":u=1,d=-1;break;case"left":u=0,d=-1;break;default:EY.Util.error("Unknown emboss direction: "+n)}do{const h=(g-1)*l;let p=u;g+p<1&&(p=0),g+p>o&&(p=0);const x=(g-1+p)*i*4;let v=i;do{const w=h+(v-1)*4;let S=d;v+S<1&&(S=0),v+S>i&&(S=0);const _=x+(v-1+S)*4,y=a[w]-a[_],k=a[w+1]-a[_+1],N=a[w+2]-a[_+2];let E=y;const A=E>0?E:-E,C=k>0?k:-k,F=N>0?N:-N;if(C>A&&(E=k),F>A&&(E=N),E*=e,s){const P=a[w]+E,M=a[w+1]+E,I=a[w+2]+E;a[w]=P>255?255:P<0?0:P,a[w+1]=M>255?255:M<0?0:M,a[w+2]=I>255?255:I<0?0:I}else{let P=r-E;P<0?P=0:P>255&&(P=255),a[w]=a[w+1]=a[w+2]=P}}while(--v)}while(--g)};sv.Emboss=NY;bc.Factory.addGetterSetter(av.Node,"embossStrength",.5,(0,p9.getNumberValidator)(),bc.Factory.afterSetFilter);bc.Factory.addGetterSetter(av.Node,"embossWhiteLevel",.5,(0,p9.getNumberValidator)(),bc.Factory.afterSetFilter);bc.Factory.addGetterSetter(av.Node,"embossDirection","top-left",void 0,bc.Factory.afterSetFilter);bc.Factory.addGetterSetter(av.Node,"embossBlend",!1,void 0,bc.Factory.afterSetFilter);var iv={};Object.defineProperty(iv,"__esModule",{value:!0});iv.Enhance=void 0;const h6=mr,AY=ln,jY=Zt;function r2(t,e,r,n,s){const a=r-e,i=s-n;if(a===0)return n+i/2;if(i===0)return n;let o=(t-e)/a;return o=i*o+n,o}const FY=function(t){const e=t.data,r=e.length;let n=e[0],s=n,a,i=e[1],o=i,l,u=e[2],d=u,g;const h=this.enhance();if(h===0)return;for(let y=0;y<r;y+=4)a=e[y+0],a<n?n=a:a>s&&(s=a),l=e[y+1],l<i?i=l:l>o&&(o=l),g=e[y+2],g<u?u=g:g>d&&(d=g);s===n&&(s=255,n=0),o===i&&(o=255,i=0),d===u&&(d=255,u=0);let p,x,v,w,S,_;if(h>0)p=s+h*(255-s),x=n-h*(n-0),v=o+h*(255-o),w=i-h*(i-0),S=d+h*(255-d),_=u-h*(u-0);else{const y=(s+n)*.5;p=s+h*(s-y),x=n+h*(n-y);const k=(o+i)*.5;v=o+h*(o-k),w=i+h*(i-k);const N=(d+u)*.5;S=d+h*(d-N),_=u+h*(u-N)}for(let y=0;y<r;y+=4)e[y+0]=r2(e[y+0],n,s,x,p),e[y+1]=r2(e[y+1],i,o,w,v),e[y+2]=r2(e[y+2],u,d,_,S)};iv.Enhance=FY;h6.Factory.addGetterSetter(AY.Node,"enhance",0,(0,jY.getNumberValidator)(),h6.Factory.afterSetFilter);var ov={};Object.defineProperty(ov,"__esModule",{value:!0});ov.Grayscale=void 0;const PY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const s=.34*e[n]+.5*e[n+1]+.16*e[n+2];e[n]=s,e[n+1]=s,e[n+2]=s}};ov.Grayscale=PY;var lv={};Object.defineProperty(lv,"__esModule",{value:!0});lv.HSL=void 0;const Xf=mr,KC=ln,XC=Zt;Xf.Factory.addGetterSetter(KC.Node,"hue",0,(0,XC.getNumberValidator)(),Xf.Factory.afterSetFilter);Xf.Factory.addGetterSetter(KC.Node,"saturation",0,(0,XC.getNumberValidator)(),Xf.Factory.afterSetFilter);Xf.Factory.addGetterSetter(KC.Node,"luminance",0,(0,XC.getNumberValidator)(),Xf.Factory.afterSetFilter);const DY=function(t){const e=t.data,r=e.length,n=1,s=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,i=this.luminance()*127,o=n*s*Math.cos(a*Math.PI/180),l=n*s*Math.sin(a*Math.PI/180),u=.299*n+.701*o+.167*l,d=.587*n-.587*o+.33*l,g=.114*n-.114*o-.497*l,h=.299*n-.299*o-.328*l,p=.587*n+.413*o+.035*l,x=.114*n-.114*o+.293*l,v=.299*n-.3*o+1.25*l,w=.587*n-.586*o-1.05*l,S=.114*n+.886*o-.2*l;let _,y,k,N;for(let E=0;E<r;E+=4)_=e[E+0],y=e[E+1],k=e[E+2],N=e[E+3],e[E+0]=u*_+d*y+g*k+i,e[E+1]=h*_+p*y+x*k+i,e[E+2]=v*_+w*y+S*k+i,e[E+3]=N};lv.HSL=DY;var cv={};Object.defineProperty(cv,"__esModule",{value:!0});cv.HSV=void 0;const Yf=mr,YC=ln,JC=Zt,RY=function(t){const e=t.data,r=e.length,n=Math.pow(2,this.value()),s=Math.pow(2,this.saturation()),a=Math.abs(this.hue()+360)%360,i=n*s*Math.cos(a*Math.PI/180),o=n*s*Math.sin(a*Math.PI/180),l=.299*n+.701*i+.167*o,u=.587*n-.587*i+.33*o,d=.114*n-.114*i-.497*o,g=.299*n-.299*i-.328*o,h=.587*n+.413*i+.035*o,p=.114*n-.114*i+.293*o,x=.299*n-.3*i+1.25*o,v=.587*n-.586*i-1.05*o,w=.114*n+.886*i-.2*o;for(let S=0;S<r;S+=4){const _=e[S+0],y=e[S+1],k=e[S+2],N=e[S+3];e[S+0]=l*_+u*y+d*k,e[S+1]=g*_+h*y+p*k,e[S+2]=x*_+v*y+w*k,e[S+3]=N}};cv.HSV=RY;Yf.Factory.addGetterSetter(YC.Node,"hue",0,(0,JC.getNumberValidator)(),Yf.Factory.afterSetFilter);Yf.Factory.addGetterSetter(YC.Node,"saturation",0,(0,JC.getNumberValidator)(),Yf.Factory.afterSetFilter);Yf.Factory.addGetterSetter(YC.Node,"value",0,(0,JC.getNumberValidator)(),Yf.Factory.afterSetFilter);var uv={};Object.defineProperty(uv,"__esModule",{value:!0});uv.Invert=void 0;const MY=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4)e[n]=255-e[n],e[n+1]=255-e[n+1],e[n+2]=255-e[n+2]};uv.Invert=MY;var dv={};Object.defineProperty(dv,"__esModule",{value:!0});dv.Kaleidoscope=void 0;const C1=mr,x9=ln,g6=wn,y9=Zt,IY=function(t,e,r){const n=t.data,s=e.data,a=t.width,i=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||i/2;let u=Math.sqrt(o*o+l*l),d=a-o,g=i-l;const h=Math.sqrt(d*d+g*g);u=h>u?h:u;const p=i,x=a,v=360/x*Math.PI/180;for(let w=0;w<x;w+=1){const S=Math.sin(w*v),_=Math.cos(w*v);for(let y=0;y<p;y+=1){d=Math.floor(o+u*y/p*_),g=Math.floor(l+u*y/p*S);let k=(g*a+d)*4;const N=n[k+0],E=n[k+1],A=n[k+2],C=n[k+3];k=(w+y*a)*4,s[k+0]=N,s[k+1]=E,s[k+2]=A,s[k+3]=C}}},OY=function(t,e,r){const n=t.data,s=e.data,a=t.width,i=t.height,o=r.polarCenterX||a/2,l=r.polarCenterY||i/2;let u=Math.sqrt(o*o+l*l),d=a-o,g=i-l;const h=Math.sqrt(d*d+g*g);u=h>u?h:u;const p=i,x=a,v=0;let w,S;for(d=0;d<a;d+=1)for(g=0;g<i;g+=1){const _=d-o,y=g-l,k=Math.sqrt(_*_+y*y)*p/u;let N=(Math.atan2(y,_)*180/Math.PI+360+v)%360;N=N*x/360,w=Math.floor(N),S=Math.floor(k);let E=(S*a+w)*4;const A=n[E+0],C=n[E+1],F=n[E+2],P=n[E+3];E=(g*a+d)*4,s[E+0]=A,s[E+1]=C,s[E+2]=F,s[E+3]=P}},LY=function(t){const e=t.width,r=t.height;let n,s,a,i,o,l,u,d,g,h,p=Math.round(this.kaleidoscopePower());const x=Math.round(this.kaleidoscopeAngle()),v=Math.floor(e*(x%360)/360);if(p<1)return;const w=g6.Util.createCanvasElement();w.width=e,w.height=r;const S=w.getContext("2d").getImageData(0,0,e,r);g6.Util.releaseCanvas(w),IY(t,S,{polarCenterX:e/2,polarCenterY:r/2});let _=e/Math.pow(2,p);for(;_<=8;)_=_*2,p-=1;_=Math.ceil(_);let y=_,k=0,N=y,E=1;for(v+_>e&&(k=y,N=0,E=-1),s=0;s<r;s+=1)for(n=k;n!==N;n+=E)a=Math.round(n+v)%e,g=(e*s+a)*4,o=S.data[g+0],l=S.data[g+1],u=S.data[g+2],d=S.data[g+3],h=(e*s+n)*4,S.data[h+0]=o,S.data[h+1]=l,S.data[h+2]=u,S.data[h+3]=d;for(s=0;s<r;s+=1)for(y=Math.floor(_),i=0;i<p;i+=1){for(n=0;n<y+1;n+=1)g=(e*s+n)*4,o=S.data[g+0],l=S.data[g+1],u=S.data[g+2],d=S.data[g+3],h=(e*s+y*2-n-1)*4,S.data[h+0]=o,S.data[h+1]=l,S.data[h+2]=u,S.data[h+3]=d;y*=2}OY(S,t,{})};dv.Kaleidoscope=LY;C1.Factory.addGetterSetter(x9.Node,"kaleidoscopePower",2,(0,y9.getNumberValidator)(),C1.Factory.afterSetFilter);C1.Factory.addGetterSetter(x9.Node,"kaleidoscopeAngle",0,(0,y9.getNumberValidator)(),C1.Factory.afterSetFilter);var fv={};Object.defineProperty(fv,"__esModule",{value:!0});fv.Mask=void 0;const m6=mr,BY=ln,UY=Zt;function Zp(t,e,r){let n=(r*t.width+e)*4;const s=[];return s.push(t.data[n++],t.data[n++],t.data[n++],t.data[n++]),s}function u0(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2)+Math.pow(t[2]-e[2],2))}function $Y(t){const e=[0,0,0];for(let r=0;r<t.length;r++)e[0]+=t[r][0],e[1]+=t[r][1],e[2]+=t[r][2];return e[0]/=t.length,e[1]/=t.length,e[2]/=t.length,e}function WY(t,e){const r=Zp(t,0,0),n=Zp(t,t.width-1,0),s=Zp(t,0,t.height-1),a=Zp(t,t.width-1,t.height-1),i=e||10;if(u0(r,n)<i&&u0(n,a)<i&&u0(a,s)<i&&u0(s,r)<i){const o=$Y([n,r,a,s]),l=[];for(let u=0;u<t.width*t.height;u++){const d=u0(o,[t.data[u*4],t.data[u*4+1],t.data[u*4+2]]);l[u]=d<i?0:255}return l}}function HY(t,e){for(let r=0;r<t.width*t.height;r++)t.data[4*r+3]=e[r]}function zY(t,e,r){const n=[1,1,1,1,0,1,1,1,1],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let g=0;g<s;g++)for(let h=0;h<s;h++){const p=o+g-a,x=l+h-a;if(p>=0&&p<r&&x>=0&&x<e){const v=p*e+x,w=n[g*s+h];d+=t[v]*w}}i[u]=d===255*8?255:0}return i}function GY(t,e,r){const n=[1,1,1,1,1,1,1,1,1],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let g=0;g<s;g++)for(let h=0;h<s;h++){const p=o+g-a,x=l+h-a;if(p>=0&&p<r&&x>=0&&x<e){const v=p*e+x,w=n[g*s+h];d+=t[v]*w}}i[u]=d>=255*4?255:0}return i}function VY(t,e,r){const n=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],s=Math.round(Math.sqrt(n.length)),a=Math.floor(s/2),i=[];for(let o=0;o<r;o++)for(let l=0;l<e;l++){const u=o*e+l;let d=0;for(let g=0;g<s;g++)for(let h=0;h<s;h++){const p=o+g-a,x=l+h-a;if(p>=0&&p<r&&x>=0&&x<e){const v=p*e+x,w=n[g*s+h];d+=t[v]*w}}i[u]=d}return i}const KY=function(t){const e=this.threshold();let r=WY(t,e);return r&&(r=zY(r,t.width,t.height),r=GY(r,t.width,t.height),r=VY(r,t.width,t.height),HY(t,r)),t};fv.Mask=KY;m6.Factory.addGetterSetter(BY.Node,"threshold",0,(0,UY.getNumberValidator)(),m6.Factory.afterSetFilter);var hv={};Object.defineProperty(hv,"__esModule",{value:!0});hv.Noise=void 0;const p6=mr,XY=ln,YY=Zt,JY=function(t){const e=this.noise()*255,r=t.data,n=r.length,s=e/2;for(let a=0;a<n;a+=4)r[a+0]+=s-2*s*Math.random(),r[a+1]+=s-2*s*Math.random(),r[a+2]+=s-2*s*Math.random()};hv.Noise=JY;p6.Factory.addGetterSetter(XY.Node,"noise",.2,(0,YY.getNumberValidator)(),p6.Factory.afterSetFilter);var gv={};Object.defineProperty(gv,"__esModule",{value:!0});gv.Pixelate=void 0;const x6=mr,QY=wn,qY=ln,ZY=Zt,eJ=function(t){let e=Math.ceil(this.pixelSize()),r=t.width,n=t.height,s=Math.ceil(r/e),a=Math.ceil(n/e),i=t.data;if(e<=0){QY.Util.error("pixelSize value can not be <= 0");return}for(let o=0;o<s;o+=1)for(let l=0;l<a;l+=1){let u=0,d=0,g=0,h=0;const p=o*e,x=p+e,v=l*e,w=v+e;let S=0;for(let _=p;_<x;_+=1)if(!(_>=r))for(let y=v;y<w;y+=1){if(y>=n)continue;const k=(r*y+_)*4;u+=i[k+0],d+=i[k+1],g+=i[k+2],h+=i[k+3],S+=1}u=u/S,d=d/S,g=g/S,h=h/S;for(let _=p;_<x;_+=1)if(!(_>=r))for(let y=v;y<w;y+=1){if(y>=n)continue;const k=(r*y+_)*4;i[k+0]=u,i[k+1]=d,i[k+2]=g,i[k+3]=h}}};gv.Pixelate=eJ;x6.Factory.addGetterSetter(qY.Node,"pixelSize",8,(0,ZY.getNumberValidator)(),x6.Factory.afterSetFilter);var mv={};Object.defineProperty(mv,"__esModule",{value:!0});mv.Posterize=void 0;const y6=mr,tJ=ln,rJ=Zt,nJ=function(t){const e=Math.round(this.levels()*254)+1,r=t.data,n=r.length,s=255/e;for(let a=0;a<n;a+=1)r[a]=Math.floor(r[a]/s)*s};mv.Posterize=nJ;y6.Factory.addGetterSetter(tJ.Node,"levels",.5,(0,rJ.getNumberValidator)(),y6.Factory.afterSetFilter);var pv={};Object.defineProperty(pv,"__esModule",{value:!0});pv.RGB=void 0;const T1=mr,QC=ln,sJ=Zt,aJ=function(t){const e=t.data,r=e.length,n=this.red(),s=this.green(),a=this.blue();for(let i=0;i<r;i+=4){const o=(.34*e[i]+.5*e[i+1]+.16*e[i+2])/255;e[i]=o*n,e[i+1]=o*s,e[i+2]=o*a,e[i+3]=e[i+3]}};pv.RGB=aJ;T1.Factory.addGetterSetter(QC.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});T1.Factory.addGetterSetter(QC.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});T1.Factory.addGetterSetter(QC.Node,"blue",0,sJ.RGBComponent,T1.Factory.afterSetFilter);var xv={};Object.defineProperty(xv,"__esModule",{value:!0});xv.RGBA=void 0;const Ng=mr,yv=ln,iJ=Zt,oJ=function(t){const e=t.data,r=e.length,n=this.red(),s=this.green(),a=this.blue(),i=this.alpha();for(let o=0;o<r;o+=4){const l=1-i;e[o]=n*i+e[o]*l,e[o+1]=s*i+e[o+1]*l,e[o+2]=a*i+e[o+2]*l}};xv.RGBA=oJ;Ng.Factory.addGetterSetter(yv.Node,"red",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Ng.Factory.addGetterSetter(yv.Node,"green",0,function(t){return this._filterUpToDate=!1,t>255?255:t<0?0:Math.round(t)});Ng.Factory.addGetterSetter(yv.Node,"blue",0,iJ.RGBComponent,Ng.Factory.afterSetFilter);Ng.Factory.addGetterSetter(yv.Node,"alpha",1,function(t){return this._filterUpToDate=!1,t>1?1:t<0?0:t});var vv={};Object.defineProperty(vv,"__esModule",{value:!0});vv.Sepia=void 0;const lJ=function(t){const e=t.data,r=e.length;for(let n=0;n<r;n+=4){const s=e[n+0],a=e[n+1],i=e[n+2];e[n+0]=Math.min(255,s*.393+a*.769+i*.189),e[n+1]=Math.min(255,s*.349+a*.686+i*.168),e[n+2]=Math.min(255,s*.272+a*.534+i*.131)}};vv.Sepia=lJ;var wv={};Object.defineProperty(wv,"__esModule",{value:!0});wv.Solarize=void 0;const cJ=function(t){const e=t.data,r=t.width,n=t.height,s=r*4;let a=n;do{const i=(a-1)*s;let o=r;do{const l=i+(o-1)*4;let u=e[l],d=e[l+1],g=e[l+2];u>127&&(u=255-u),d>127&&(d=255-d),g>127&&(g=255-g),e[l]=u,e[l+1]=d,e[l+2]=g}while(--o)}while(--a)};wv.Solarize=cJ;var _v={};Object.defineProperty(_v,"__esModule",{value:!0});_v.Threshold=void 0;const v6=mr,uJ=ln,dJ=Zt,fJ=function(t){const e=this.threshold()*255,r=t.data,n=r.length;for(let s=0;s<n;s+=1)r[s]=r[s]<e?0:255};_v.Threshold=fJ;v6.Factory.addGetterSetter(uJ.Node,"threshold",.5,(0,dJ.getNumberValidator)(),v6.Factory.afterSetFilter);Object.defineProperty(Fy,"__esModule",{value:!0});Fy.Konva=void 0;const w6=b1,hJ=Iy,gJ=By,mJ=Wy,pJ=Hy,xJ=zy,_6=Kf,yJ=fm,vJ=xh,wJ=mm,_J=Ky,bJ=Xy,SJ=Yy,kJ=Jy,CJ=vh,TJ=Qy,EJ=qy,NJ=Zy,AJ=tv,jJ=rv,FJ=nv,PJ=sv,DJ=iv,RJ=ov,MJ=lv,IJ=cv,OJ=uv,LJ=dv,BJ=fv,UJ=hv,$J=gv,WJ=mv,HJ=pv,zJ=xv,GJ=vv,VJ=wv,KJ=_v;Fy.Konva=w6.Konva.Util._assign(w6.Konva,{Arc:hJ.Arc,Arrow:gJ.Arrow,Circle:mJ.Circle,Ellipse:pJ.Ellipse,Image:xJ.Image,Label:_6.Label,Tag:_6.Tag,Line:yJ.Line,Path:vJ.Path,Rect:wJ.Rect,RegularPolygon:_J.RegularPolygon,Ring:bJ.Ring,Sprite:SJ.Sprite,Star:kJ.Star,Text:CJ.Text,TextPath:TJ.TextPath,Transformer:EJ.Transformer,Wedge:NJ.Wedge,Filters:{Blur:AJ.Blur,Brighten:jJ.Brighten,Contrast:FJ.Contrast,Emboss:PJ.Emboss,Enhance:DJ.Enhance,Grayscale:RJ.Grayscale,HSL:MJ.HSL,HSV:IJ.HSV,Invert:OJ.Invert,Kaleidoscope:LJ.Kaleidoscope,Mask:BJ.Mask,Noise:UJ.Noise,Pixelate:$J.Pixelate,Posterize:WJ.Posterize,RGB:HJ.RGB,RGBA:zJ.RGBA,Sepia:GJ.Sepia,Solarize:VJ.Solarize,Threshold:KJ.Threshold}});var XJ=IC.exports;Object.defineProperty(XJ,"__esModule",{value:!0});const YJ=Fy;IC.exports=YJ.Konva;var v9=IC.exports;const JJ=ly(v9),QJ=Fj({__proto__:null,default:JJ},[v9]);var cS={exports:{}};(function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;var r=b1;Object.defineProperty(e,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=b1;t.exports=n.Konva})(cS,cS.exports);var qJ=cS.exports;const Ag=ly(qJ);var w9={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZJ=function(e){var r={},n=b,s=N0,a=Object.assign;function i(f){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+f,T=1;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+f+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),k=Symbol.for("react.offscreen"),N=Symbol.iterator;function E(f){return f===null||typeof f!="object"?null:(f=N&&f[N]||f["@@iterator"],typeof f=="function"?f:null)}function A(f){if(f==null)return null;if(typeof f=="function")return f.displayName||f.name||null;if(typeof f=="string")return f;switch(f){case d:return"Fragment";case u:return"Portal";case h:return"Profiler";case g:return"StrictMode";case w:return"Suspense";case S:return"SuspenseList"}if(typeof f=="object")switch(f.$$typeof){case x:return(f.displayName||"Context")+".Consumer";case p:return(f._context.displayName||"Context")+".Provider";case v:var m=f.render;return f=f.displayName,f||(f=m.displayName||m.name||"",f=f!==""?"ForwardRef("+f+")":"ForwardRef"),f;case _:return m=f.displayName||null,m!==null?m:A(f.type)||"Memo";case y:m=f._payload,f=f._init;try{return A(f(m))}catch{}}return null}function C(f){var m=f.type;switch(f.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return f=m.render,f=f.displayName||f.name||"",m.displayName||(f!==""?"ForwardRef("+f+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return A(m);case 8:return m===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function F(f){var m=f,T=f;if(f.alternate)for(;m.return;)m=m.return;else{f=m;do m=f,m.flags&4098&&(T=m.return),f=m.return;while(f)}return m.tag===3?T:null}function P(f){if(F(f)!==f)throw Error(i(188))}function M(f){var m=f.alternate;if(!m){if(m=F(f),m===null)throw Error(i(188));return m!==f?null:f}for(var T=f,j=m;;){var D=T.return;if(D===null)break;var U=D.alternate;if(U===null){if(j=D.return,j!==null){T=j;continue}break}if(D.child===U.child){for(U=D.child;U;){if(U===T)return P(D),f;if(U===j)return P(D),m;U=U.sibling}throw Error(i(188))}if(T.return!==j.return)T=D,j=U;else{for(var fe=!1,je=D.child;je;){if(je===T){fe=!0,T=D,j=U;break}if(je===j){fe=!0,j=D,T=U;break}je=je.sibling}if(!fe){for(je=U.child;je;){if(je===T){fe=!0,T=U,j=D;break}if(je===j){fe=!0,j=U,T=D;break}je=je.sibling}if(!fe)throw Error(i(189))}}if(T.alternate!==j)throw Error(i(190))}if(T.tag!==3)throw Error(i(188));return T.stateNode.current===T?f:m}function I(f){return f=M(f),f!==null?Y(f):null}function Y(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){var m=Y(f);if(m!==null)return m;f=f.sibling}return null}function se(f){if(f.tag===5||f.tag===6)return f;for(f=f.child;f!==null;){if(f.tag!==4){var m=se(f);if(m!==null)return m}f=f.sibling}return null}var L=Array.isArray,z=e.getPublicInstance,G=e.getRootHostContext,O=e.getChildHostContext,R=e.prepareForCommit,X=e.resetAfterCommit,te=e.createInstance,H=e.appendInitialChild,V=e.finalizeInitialChildren,q=e.prepareUpdate,Q=e.shouldSetTextContent,ae=e.createTextInstance,J=e.scheduleTimeout,re=e.cancelTimeout,ve=e.noTimeout,we=e.isPrimaryRenderer,Fe=e.supportsMutation,ne=e.supportsPersistence,Ee=e.supportsHydration,ke=e.getInstanceFromNode,He=e.preparePortalMount,at=e.getCurrentEventPriority,Me=e.detachDeletedInstance,Ft=e.supportsMicrotasks,Ut=e.scheduleMicrotask,Pe=e.supportsTestSelectors,Re=e.findFiberRoot,$e=e.getBoundingRect,Be=e.getTextContent,Ge=e.isHiddenSubtree,ht=e.matchAccessibilityRole,Nt=e.setFocusIfFocusable,Ye=e.setupIntersectionObserver,Ve=e.appendChild,ot=e.appendChildToContainer,et=e.commitTextUpdate,nt=e.commitMount,gt=e.commitUpdate,Et=e.insertBefore,Ne=e.insertInContainerBefore,Ke=e.removeChild,Ze=e.removeChildFromContainer,ft=e.resetTextContent,ut=e.hideInstance,bt=e.hideTextInstance,ye=e.unhideInstance,de=e.unhideTextInstance,ee=e.clearContainer,he=e.cloneInstance,Ae=e.createContainerChildSet,st=e.appendChildToContainerChildSet,rt=e.finalizeContainerChildren,At=e.replaceContainerChildren,yt=e.cloneHiddenInstance,wt=e.cloneHiddenTextInstance,Jt=e.canHydrateInstance,dr=e.canHydrateTextInstance,zt=e.canHydrateSuspenseInstance,er=e.isSuspenseInstancePending,pr=e.isSuspenseInstanceFallback,_n=e.getSuspenseInstanceFallbackErrorDetails,Z=e.registerSuspenseInstanceRetry,ge=e.getNextHydratableSibling,oe=e.getFirstHydratableChild,ue=e.getFirstHydratableChildWithinContainer,me=e.getFirstHydratableChildWithinSuspenseInstance,K=e.hydrateInstance,le=e.hydrateTextInstance,be=e.hydrateSuspenseInstance,pe=e.getNextHydratableInstanceAfterSuspenseInstance,Te=e.commitHydratedContainer,B=e.commitHydratedSuspenseInstance,ie=e.clearSuspenseBoundary,xe=e.clearSuspenseBoundaryFromContainer,ce=e.shouldDeleteUnhydratedTailInstances,Ce=e.didNotMatchHydratedContainerTextInstance,Oe=e.didNotMatchHydratedTextInstance,Ie;function mt(f){if(Ie===void 0)try{throw Error()}catch(T){var m=T.stack.trim().match(/\n( *(at )?)/);Ie=m&&m[1]||""}return`
`+Ie+f}var qe=!1;function xt(f,m){if(!f||qe)return"";qe=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(_t){var j=_t}Reflect.construct(f,[],m)}else{try{m.call()}catch(_t){j=_t}f.call(m.prototype)}else{try{throw Error()}catch(_t){j=_t}f()}}catch(_t){if(_t&&j&&typeof _t.stack=="string"){for(var D=_t.stack.split(`
`),U=j.stack.split(`
`),fe=D.length-1,je=U.length-1;1<=fe&&0<=je&&D[fe]!==U[je];)je--;for(;1<=fe&&0<=je;fe--,je--)if(D[fe]!==U[je]){if(fe!==1||je!==1)do if(fe--,je--,0>je||D[fe]!==U[je]){var ze=`
`+D[fe].replace(" at new "," at ");return f.displayName&&ze.includes("<anonymous>")&&(ze=ze.replace("<anonymous>",f.displayName)),ze}while(1<=fe&&0<=je);break}}}finally{qe=!1,Error.prepareStackTrace=T}return(f=f?f.displayName||f.name:"")?mt(f):""}var Bt=Object.prototype.hasOwnProperty,xr=[],$t=-1;function Ht(f){return{current:f}}function Pt(f){0>$t||(f.current=xr[$t],xr[$t]=null,$t--)}function jt(f,m){$t++,xr[$t]=f.current,f.current=m}var W={},_e=Ht(W),tt=Ht(!1),ct=W;function Gt(f,m){var T=f.type.contextTypes;if(!T)return W;var j=f.stateNode;if(j&&j.__reactInternalMemoizedUnmaskedChildContext===m)return j.__reactInternalMemoizedMaskedChildContext;var D={},U;for(U in T)D[U]=m[U];return j&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=m,f.__reactInternalMemoizedMaskedChildContext=D),D}function nr(f){return f=f.childContextTypes,f!=null}function bn(){Pt(tt),Pt(_e)}function Uo(f,m,T){if(_e.current!==W)throw Error(i(168));jt(_e,m),jt(tt,T)}function Ya(f,m,T){var j=f.stateNode;if(m=m.childContextTypes,typeof j.getChildContext!="function")return T;j=j.getChildContext();for(var D in j)if(!(D in m))throw Error(i(108,C(f)||"Unknown",D));return a({},T,j)}function ha(f){return f=(f=f.stateNode)&&f.__reactInternalMemoizedMergedChildContext||W,ct=_e.current,jt(_e,f),jt(tt,tt.current),!0}function cn(f,m,T){var j=f.stateNode;if(!j)throw Error(i(169));T?(f=Ya(f,m,ct),j.__reactInternalMemoizedMergedChildContext=f,Pt(tt),Pt(_e),jt(_e,f)):Pt(tt),jt(tt,T)}var ga=Math.clz32?Math.clz32:aL,Yv=Math.log,sL=Math.LN2;function aL(f){return f>>>=0,f===0?32:31-(Yv(f)/sL|0)|0}var Bm=64,Um=4194304;function Mh(f){switch(f&-f){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return f&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return f}}function $m(f,m){var T=f.pendingLanes;if(T===0)return 0;var j=0,D=f.suspendedLanes,U=f.pingedLanes,fe=T&268435455;if(fe!==0){var je=fe&~D;je!==0?j=Mh(je):(U&=fe,U!==0&&(j=Mh(U)))}else fe=T&~D,fe!==0?j=Mh(fe):U!==0&&(j=Mh(U));if(j===0)return 0;if(m!==0&&m!==j&&!(m&D)&&(D=j&-j,U=m&-m,D>=U||D===16&&(U&4194240)!==0))return m;if(j&4&&(j|=T&16),m=f.entangledLanes,m!==0)for(f=f.entanglements,m&=j;0<m;)T=31-ga(m),D=1<<T,j|=f[T],m&=~D;return j}function iL(f,m){switch(f){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oL(f,m){for(var T=f.suspendedLanes,j=f.pingedLanes,D=f.expirationTimes,U=f.pendingLanes;0<U;){var fe=31-ga(U),je=1<<fe,ze=D[fe];ze===-1?(!(je&T)||je&j)&&(D[fe]=iL(je,m)):ze<=m&&(f.expiredLanes|=je),U&=~je}}function Jv(f){return f=f.pendingLanes&-1073741825,f!==0?f:f&1073741824?1073741824:0}function I4(){var f=Bm;return Bm<<=1,!(Bm&4194240)&&(Bm=64),f}function Qv(f){for(var m=[],T=0;31>T;T++)m.push(f);return m}function Ih(f,m,T){f.pendingLanes|=m,m!==536870912&&(f.suspendedLanes=0,f.pingedLanes=0),f=f.eventTimes,m=31-ga(m),f[m]=T}function lL(f,m){var T=f.pendingLanes&~m;f.pendingLanes=m,f.suspendedLanes=0,f.pingedLanes=0,f.expiredLanes&=m,f.mutableReadLanes&=m,f.entangledLanes&=m,m=f.entanglements;var j=f.eventTimes;for(f=f.expirationTimes;0<T;){var D=31-ga(T),U=1<<D;m[D]=0,j[D]=-1,f[D]=-1,T&=~U}}function qv(f,m){var T=f.entangledLanes|=m;for(f=f.entanglements;T;){var j=31-ga(T),D=1<<j;D&m|f[j]&m&&(f[j]|=m),T&=~D}}var Cr=0;function O4(f){return f&=-f,1<f?4<f?f&268435455?16:536870912:4:1}var Zv=s.unstable_scheduleCallback,L4=s.unstable_cancelCallback,cL=s.unstable_shouldYield,uL=s.unstable_requestPaint,is=s.unstable_now,ew=s.unstable_ImmediatePriority,dL=s.unstable_UserBlockingPriority,tw=s.unstable_NormalPriority,fL=s.unstable_IdlePriority,Wm=null,ao=null;function hL(f){if(ao&&typeof ao.onCommitFiberRoot=="function")try{ao.onCommitFiberRoot(Wm,f,void 0,(f.current.flags&128)===128)}catch{}}function gL(f,m){return f===m&&(f!==0||1/f===1/m)||f!==f&&m!==m}var Ai=typeof Object.is=="function"?Object.is:gL,$o=null,Hm=!1,rw=!1;function B4(f){$o===null?$o=[f]:$o.push(f)}function mL(f){Hm=!0,B4(f)}function io(){if(!rw&&$o!==null){rw=!0;var f=0,m=Cr;try{var T=$o;for(Cr=1;f<T.length;f++){var j=T[f];do j=j(!0);while(j!==null)}$o=null,Hm=!1}catch(D){throw $o!==null&&($o=$o.slice(f+1)),Zv(ew,io),D}finally{Cr=m,rw=!1}}return null}var kd=[],Cd=0,zm=null,Gm=0,Ja=[],Qa=0,Xc=null,Wo=1,Ho="";function Yc(f,m){kd[Cd++]=Gm,kd[Cd++]=zm,zm=f,Gm=m}function U4(f,m,T){Ja[Qa++]=Wo,Ja[Qa++]=Ho,Ja[Qa++]=Xc,Xc=f;var j=Wo;f=Ho;var D=32-ga(j)-1;j&=~(1<<D),T+=1;var U=32-ga(m)+D;if(30<U){var fe=D-D%5;U=(j&(1<<fe)-1).toString(32),j>>=fe,D-=fe,Wo=1<<32-ga(m)+D|T<<D|j,Ho=U+f}else Wo=1<<U|T<<D|j,Ho=f}function nw(f){f.return!==null&&(Yc(f,1),U4(f,1,0))}function sw(f){for(;f===zm;)zm=kd[--Cd],kd[Cd]=null,Gm=kd[--Cd],kd[Cd]=null;for(;f===Xc;)Xc=Ja[--Qa],Ja[Qa]=null,Ho=Ja[--Qa],Ja[Qa]=null,Wo=Ja[--Qa],Ja[Qa]=null}var Da=null,qa=null,rn=!1,Oh=!1,ji=null;function $4(f,m){var T=ni(5,null,null,0);T.elementType="DELETED",T.stateNode=m,T.return=f,m=f.deletions,m===null?(f.deletions=[T],f.flags|=16):m.push(T)}function W4(f,m){switch(f.tag){case 5:return m=Jt(m,f.type,f.pendingProps),m!==null?(f.stateNode=m,Da=f,qa=oe(m),!0):!1;case 6:return m=dr(m,f.pendingProps),m!==null?(f.stateNode=m,Da=f,qa=null,!0):!1;case 13:if(m=zt(m),m!==null){var T=Xc!==null?{id:Wo,overflow:Ho}:null;return f.memoizedState={dehydrated:m,treeContext:T,retryLane:1073741824},T=ni(18,null,null,0),T.stateNode=m,T.return=f,f.child=T,Da=f,qa=null,!0}return!1;default:return!1}}function aw(f){return(f.mode&1)!==0&&(f.flags&128)===0}function iw(f){if(rn){var m=qa;if(m){var T=m;if(!W4(f,m)){if(aw(f))throw Error(i(418));m=ge(T);var j=Da;m&&W4(f,m)?$4(j,T):(f.flags=f.flags&-4097|2,rn=!1,Da=f)}}else{if(aw(f))throw Error(i(418));f.flags=f.flags&-4097|2,rn=!1,Da=f}}}function H4(f){for(f=f.return;f!==null&&f.tag!==5&&f.tag!==3&&f.tag!==13;)f=f.return;Da=f}function Vm(f){if(!Ee||f!==Da)return!1;if(!rn)return H4(f),rn=!0,!1;if(f.tag!==3&&(f.tag!==5||ce(f.type)&&!Q(f.type,f.memoizedProps))){var m=qa;if(m){if(aw(f))throw z4(),Error(i(418));for(;m;)$4(f,m),m=ge(m)}}if(H4(f),f.tag===13){if(!Ee)throw Error(i(316));if(f=f.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(i(317));qa=pe(f)}else qa=Da?ge(f.stateNode):null;return!0}function z4(){for(var f=qa;f;)f=ge(f)}function Td(){Ee&&(qa=Da=null,Oh=rn=!1)}function ow(f){ji===null?ji=[f]:ji.push(f)}var pL=o.ReactCurrentBatchConfig;function Km(f,m){if(Ai(f,m))return!0;if(typeof f!="object"||f===null||typeof m!="object"||m===null)return!1;var T=Object.keys(f),j=Object.keys(m);if(T.length!==j.length)return!1;for(j=0;j<T.length;j++){var D=T[j];if(!Bt.call(m,D)||!Ai(f[D],m[D]))return!1}return!0}function xL(f){switch(f.tag){case 5:return mt(f.type);case 16:return mt("Lazy");case 13:return mt("Suspense");case 19:return mt("SuspenseList");case 0:case 2:case 15:return f=xt(f.type,!1),f;case 11:return f=xt(f.type.render,!1),f;case 1:return f=xt(f.type,!0),f;default:return""}}function Lh(f,m,T){if(f=T.ref,f!==null&&typeof f!="function"&&typeof f!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(i(309));var j=T.stateNode}if(!j)throw Error(i(147,f));var D=j,U=""+f;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===U?m.ref:(m=function(fe){var je=D.refs;fe===null?delete je[U]:je[U]=fe},m._stringRef=U,m)}if(typeof f!="string")throw Error(i(284));if(!T._owner)throw Error(i(290,f))}return f}function Xm(f,m){throw f=Object.prototype.toString.call(m),Error(i(31,f==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":f))}function G4(f){var m=f._init;return m(f._payload)}function V4(f){function m(We,De){if(f){var Xe=We.deletions;Xe===null?(We.deletions=[De],We.flags|=16):Xe.push(De)}}function T(We,De){if(!f)return null;for(;De!==null;)m(We,De),De=De.sibling;return null}function j(We,De){for(We=new Map;De!==null;)De.key!==null?We.set(De.key,De):We.set(De.index,De),De=De.sibling;return We}function D(We,De){return We=Bl(We,De),We.index=0,We.sibling=null,We}function U(We,De,Xe){return We.index=Xe,f?(Xe=We.alternate,Xe!==null?(Xe=Xe.index,Xe<De?(We.flags|=2,De):Xe):(We.flags|=2,De)):(We.flags|=1048576,De)}function fe(We){return f&&We.alternate===null&&(We.flags|=2),We}function je(We,De,Xe,Rt){return De===null||De.tag!==6?(De=r_(Xe,We.mode,Rt),De.return=We,De):(De=D(De,Xe),De.return=We,De)}function ze(We,De,Xe,Rt){var Vt=Xe.type;return Vt===d?Lt(We,De,Xe.props.children,Rt,Xe.key):De!==null&&(De.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===y&&G4(Vt)===De.type)?(Rt=D(De,Xe.props),Rt.ref=Lh(We,De,Xe),Rt.return=We,Rt):(Rt=Cp(Xe.type,Xe.key,Xe.props,null,We.mode,Rt),Rt.ref=Lh(We,De,Xe),Rt.return=We,Rt)}function _t(We,De,Xe,Rt){return De===null||De.tag!==4||De.stateNode.containerInfo!==Xe.containerInfo||De.stateNode.implementation!==Xe.implementation?(De=n_(Xe,We.mode,Rt),De.return=We,De):(De=D(De,Xe.children||[]),De.return=We,De)}function Lt(We,De,Xe,Rt,Vt){return De===null||De.tag!==7?(De=ru(Xe,We.mode,Rt,Vt),De.return=We,De):(De=D(De,Xe),De.return=We,De)}function sr(We,De,Xe){if(typeof De=="string"&&De!==""||typeof De=="number")return De=r_(""+De,We.mode,Xe),De.return=We,De;if(typeof De=="object"&&De!==null){switch(De.$$typeof){case l:return Xe=Cp(De.type,De.key,De.props,null,We.mode,Xe),Xe.ref=Lh(We,null,De),Xe.return=We,Xe;case u:return De=n_(De,We.mode,Xe),De.return=We,De;case y:var Rt=De._init;return sr(We,Rt(De._payload),Xe)}if(L(De)||E(De))return De=ru(De,We.mode,Xe,null),De.return=We,De;Xm(We,De)}return null}function Dt(We,De,Xe,Rt){var Vt=De!==null?De.key:null;if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number")return Vt!==null?null:je(We,De,""+Xe,Rt);if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case l:return Xe.key===Vt?ze(We,De,Xe,Rt):null;case u:return Xe.key===Vt?_t(We,De,Xe,Rt):null;case y:return Vt=Xe._init,Dt(We,De,Vt(Xe._payload),Rt)}if(L(Xe)||E(Xe))return Vt!==null?null:Lt(We,De,Xe,Rt,null);Xm(We,Xe)}return null}function Kr(We,De,Xe,Rt,Vt){if(typeof Rt=="string"&&Rt!==""||typeof Rt=="number")return We=We.get(Xe)||null,je(De,We,""+Rt,Vt);if(typeof Rt=="object"&&Rt!==null){switch(Rt.$$typeof){case l:return We=We.get(Rt.key===null?Xe:Rt.key)||null,ze(De,We,Rt,Vt);case u:return We=We.get(Rt.key===null?Xe:Rt.key)||null,_t(De,We,Rt,Vt);case y:var cr=Rt._init;return Kr(We,De,Xe,cr(Rt._payload),Vt)}if(L(Rt)||E(Rt))return We=We.get(Xe)||null,Lt(De,We,Rt,Vt,null);Xm(De,Rt)}return null}function Wr(We,De,Xe,Rt){for(var Vt=null,cr=null,ar=De,Tr=De=0,cs=null;ar!==null&&Tr<Xe.length;Tr++){ar.index>Tr?(cs=ar,ar=null):cs=ar.sibling;var Er=Dt(We,ar,Xe[Tr],Rt);if(Er===null){ar===null&&(ar=cs);break}f&&ar&&Er.alternate===null&&m(We,ar),De=U(Er,De,Tr),cr===null?Vt=Er:cr.sibling=Er,cr=Er,ar=cs}if(Tr===Xe.length)return T(We,ar),rn&&Yc(We,Tr),Vt;if(ar===null){for(;Tr<Xe.length;Tr++)ar=sr(We,Xe[Tr],Rt),ar!==null&&(De=U(ar,De,Tr),cr===null?Vt=ar:cr.sibling=ar,cr=ar);return rn&&Yc(We,Tr),Vt}for(ar=j(We,ar);Tr<Xe.length;Tr++)cs=Kr(ar,We,Tr,Xe[Tr],Rt),cs!==null&&(f&&cs.alternate!==null&&ar.delete(cs.key===null?Tr:cs.key),De=U(cs,De,Tr),cr===null?Vt=cs:cr.sibling=cs,cr=cs);return f&&ar.forEach(function(Ul){return m(We,Ul)}),rn&&Yc(We,Tr),Vt}function ya(We,De,Xe,Rt){var Vt=E(Xe);if(typeof Vt!="function")throw Error(i(150));if(Xe=Vt.call(Xe),Xe==null)throw Error(i(151));for(var cr=Vt=null,ar=De,Tr=De=0,cs=null,Er=Xe.next();ar!==null&&!Er.done;Tr++,Er=Xe.next()){ar.index>Tr?(cs=ar,ar=null):cs=ar.sibling;var Ul=Dt(We,ar,Er.value,Rt);if(Ul===null){ar===null&&(ar=cs);break}f&&ar&&Ul.alternate===null&&m(We,ar),De=U(Ul,De,Tr),cr===null?Vt=Ul:cr.sibling=Ul,cr=Ul,ar=cs}if(Er.done)return T(We,ar),rn&&Yc(We,Tr),Vt;if(ar===null){for(;!Er.done;Tr++,Er=Xe.next())Er=sr(We,Er.value,Rt),Er!==null&&(De=U(Er,De,Tr),cr===null?Vt=Er:cr.sibling=Er,cr=Er);return rn&&Yc(We,Tr),Vt}for(ar=j(We,ar);!Er.done;Tr++,Er=Xe.next())Er=Kr(ar,We,Tr,Er.value,Rt),Er!==null&&(f&&Er.alternate!==null&&ar.delete(Er.key===null?Tr:Er.key),De=U(Er,De,Tr),cr===null?Vt=Er:cr.sibling=Er,cr=Er);return f&&ar.forEach(function(KL){return m(We,KL)}),rn&&Yc(We,Tr),Vt}function Ko(We,De,Xe,Rt){if(typeof Xe=="object"&&Xe!==null&&Xe.type===d&&Xe.key===null&&(Xe=Xe.props.children),typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case l:e:{for(var Vt=Xe.key,cr=De;cr!==null;){if(cr.key===Vt){if(Vt=Xe.type,Vt===d){if(cr.tag===7){T(We,cr.sibling),De=D(cr,Xe.props.children),De.return=We,We=De;break e}}else if(cr.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===y&&G4(Vt)===cr.type){T(We,cr.sibling),De=D(cr,Xe.props),De.ref=Lh(We,cr,Xe),De.return=We,We=De;break e}T(We,cr);break}else m(We,cr);cr=cr.sibling}Xe.type===d?(De=ru(Xe.props.children,We.mode,Rt,Xe.key),De.return=We,We=De):(Rt=Cp(Xe.type,Xe.key,Xe.props,null,We.mode,Rt),Rt.ref=Lh(We,De,Xe),Rt.return=We,We=Rt)}return fe(We);case u:e:{for(cr=Xe.key;De!==null;){if(De.key===cr)if(De.tag===4&&De.stateNode.containerInfo===Xe.containerInfo&&De.stateNode.implementation===Xe.implementation){T(We,De.sibling),De=D(De,Xe.children||[]),De.return=We,We=De;break e}else{T(We,De);break}else m(We,De);De=De.sibling}De=n_(Xe,We.mode,Rt),De.return=We,We=De}return fe(We);case y:return cr=Xe._init,Ko(We,De,cr(Xe._payload),Rt)}if(L(Xe))return Wr(We,De,Xe,Rt);if(E(Xe))return ya(We,De,Xe,Rt);Xm(We,Xe)}return typeof Xe=="string"&&Xe!==""||typeof Xe=="number"?(Xe=""+Xe,De!==null&&De.tag===6?(T(We,De.sibling),De=D(De,Xe),De.return=We,We=De):(T(We,De),De=r_(Xe,We.mode,Rt),De.return=We,We=De),fe(We)):T(We,De)}return Ko}var Ed=V4(!0),K4=V4(!1),Ym=Ht(null),Jm=null,Nd=null,lw=null;function cw(){lw=Nd=Jm=null}function X4(f,m,T){we?(jt(Ym,m._currentValue),m._currentValue=T):(jt(Ym,m._currentValue2),m._currentValue2=T)}function uw(f){var m=Ym.current;Pt(Ym),we?f._currentValue=m:f._currentValue2=m}function dw(f,m,T){for(;f!==null;){var j=f.alternate;if((f.childLanes&m)!==m?(f.childLanes|=m,j!==null&&(j.childLanes|=m)):j!==null&&(j.childLanes&m)!==m&&(j.childLanes|=m),f===T)break;f=f.return}}function Ad(f,m){Jm=f,lw=Nd=null,f=f.dependencies,f!==null&&f.firstContext!==null&&(f.lanes&m&&(ma=!0),f.firstContext=null)}function Za(f){var m=we?f._currentValue:f._currentValue2;if(lw!==f)if(f={context:f,memoizedValue:m,next:null},Nd===null){if(Jm===null)throw Error(i(308));Nd=f,Jm.dependencies={lanes:0,firstContext:f}}else Nd=Nd.next=f;return m}var Jc=null;function fw(f){Jc===null?Jc=[f]:Jc.push(f)}function Y4(f,m,T,j){var D=m.interleaved;return D===null?(T.next=T,fw(m)):(T.next=D.next,D.next=T),m.interleaved=T,oo(f,j)}function oo(f,m){f.lanes|=m;var T=f.alternate;for(T!==null&&(T.lanes|=m),T=f,f=f.return;f!==null;)f.childLanes|=m,T=f.alternate,T!==null&&(T.childLanes|=m),T=f,f=f.return;return T.tag===3?T.stateNode:null}var Dl=!1;function hw(f){f.updateQueue={baseState:f.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function J4(f,m){f=f.updateQueue,m.updateQueue===f&&(m.updateQueue={baseState:f.baseState,firstBaseUpdate:f.firstBaseUpdate,lastBaseUpdate:f.lastBaseUpdate,shared:f.shared,effects:f.effects})}function zo(f,m){return{eventTime:f,lane:m,tag:0,payload:null,callback:null,next:null}}function Rl(f,m,T){var j=f.updateQueue;if(j===null)return null;if(j=j.shared,hr&2){var D=j.pending;return D===null?m.next=m:(m.next=D.next,D.next=m),j.pending=m,oo(f,T)}return D=j.interleaved,D===null?(m.next=m,fw(j)):(m.next=D.next,D.next=m),j.interleaved=m,oo(f,T)}function Qm(f,m,T){if(m=m.updateQueue,m!==null&&(m=m.shared,(T&4194240)!==0)){var j=m.lanes;j&=f.pendingLanes,T|=j,m.lanes=T,qv(f,T)}}function Q4(f,m){var T=f.updateQueue,j=f.alternate;if(j!==null&&(j=j.updateQueue,T===j)){var D=null,U=null;if(T=T.firstBaseUpdate,T!==null){do{var fe={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};U===null?D=U=fe:U=U.next=fe,T=T.next}while(T!==null);U===null?D=U=m:U=U.next=m}else D=U=m;T={baseState:j.baseState,firstBaseUpdate:D,lastBaseUpdate:U,shared:j.shared,effects:j.effects},f.updateQueue=T;return}f=T.lastBaseUpdate,f===null?T.firstBaseUpdate=m:f.next=m,T.lastBaseUpdate=m}function qm(f,m,T,j){var D=f.updateQueue;Dl=!1;var U=D.firstBaseUpdate,fe=D.lastBaseUpdate,je=D.shared.pending;if(je!==null){D.shared.pending=null;var ze=je,_t=ze.next;ze.next=null,fe===null?U=_t:fe.next=_t,fe=ze;var Lt=f.alternate;Lt!==null&&(Lt=Lt.updateQueue,je=Lt.lastBaseUpdate,je!==fe&&(je===null?Lt.firstBaseUpdate=_t:je.next=_t,Lt.lastBaseUpdate=ze))}if(U!==null){var sr=D.baseState;fe=0,Lt=_t=ze=null,je=U;do{var Dt=je.lane,Kr=je.eventTime;if((j&Dt)===Dt){Lt!==null&&(Lt=Lt.next={eventTime:Kr,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var Wr=f,ya=je;switch(Dt=m,Kr=T,ya.tag){case 1:if(Wr=ya.payload,typeof Wr=="function"){sr=Wr.call(Kr,sr,Dt);break e}sr=Wr;break e;case 3:Wr.flags=Wr.flags&-65537|128;case 0:if(Wr=ya.payload,Dt=typeof Wr=="function"?Wr.call(Kr,sr,Dt):Wr,Dt==null)break e;sr=a({},sr,Dt);break e;case 2:Dl=!0}}je.callback!==null&&je.lane!==0&&(f.flags|=64,Dt=D.effects,Dt===null?D.effects=[je]:Dt.push(je))}else Kr={eventTime:Kr,lane:Dt,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Lt===null?(_t=Lt=Kr,ze=sr):Lt=Lt.next=Kr,fe|=Dt;if(je=je.next,je===null){if(je=D.shared.pending,je===null)break;Dt=je,je=Dt.next,Dt.next=null,D.lastBaseUpdate=Dt,D.shared.pending=null}}while(!0);if(Lt===null&&(ze=sr),D.baseState=ze,D.firstBaseUpdate=_t,D.lastBaseUpdate=Lt,m=D.shared.interleaved,m!==null){D=m;do fe|=D.lane,D=D.next;while(D!==m)}else U===null&&(D.shared.lanes=0);qc|=fe,f.lanes=fe,f.memoizedState=sr}}function q4(f,m,T){if(f=m.effects,m.effects=null,f!==null)for(m=0;m<f.length;m++){var j=f[m],D=j.callback;if(D!==null){if(j.callback=null,j=T,typeof D!="function")throw Error(i(191,D));D.call(j)}}}var Bh={},ei=Ht(Bh),Uh=Ht(Bh),jd=Ht(Bh);function lo(f){if(f===Bh)throw Error(i(174));return f}function gw(f,m){jt(jd,m),jt(Uh,f),jt(ei,Bh),f=G(m),Pt(ei),jt(ei,f)}function Fd(){Pt(ei),Pt(Uh),Pt(jd)}function Z4(f){var m=lo(jd.current),T=lo(ei.current);m=O(T,f.type,m),T!==m&&(jt(Uh,f),jt(ei,m))}function mw(f){Uh.current===f&&(Pt(ei),Pt(Uh))}var un=Ht(0);function Zm(f){for(var m=f;m!==null;){if(m.tag===13){var T=m.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||er(T)||pr(T)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if(m.flags&128)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var pw=[];function xw(){for(var f=0;f<pw.length;f++){var m=pw[f];we?m._workInProgressVersionPrimary=null:m._workInProgressVersionSecondary=null}pw.length=0}var ep=o.ReactCurrentDispatcher,yw=o.ReactCurrentBatchConfig,Qc=0,dn=null,Yn=null,os=null,tp=!1,$h=!1,Wh=0,yL=0;function Ps(){throw Error(i(321))}function vw(f,m){if(m===null)return!1;for(var T=0;T<m.length&&T<f.length;T++)if(!Ai(f[T],m[T]))return!1;return!0}function ww(f,m,T,j,D,U){if(Qc=U,dn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,ep.current=f===null||f.memoizedState===null?bL:SL,f=T(j,D),$h){U=0;do{if($h=!1,Wh=0,25<=U)throw Error(i(301));U+=1,os=Yn=null,m.updateQueue=null,ep.current=kL,f=T(j,D)}while($h)}if(ep.current=sp,m=Yn!==null&&Yn.next!==null,Qc=0,os=Yn=dn=null,tp=!1,m)throw Error(i(300));return f}function _w(){var f=Wh!==0;return Wh=0,f}function co(){var f={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?dn.memoizedState=os=f:os=os.next=f,os}function ti(){if(Yn===null){var f=dn.alternate;f=f!==null?f.memoizedState:null}else f=Yn.next;var m=os===null?dn.memoizedState:os.next;if(m!==null)os=m,Yn=f;else{if(f===null)throw Error(i(310));Yn=f,f={memoizedState:Yn.memoizedState,baseState:Yn.baseState,baseQueue:Yn.baseQueue,queue:Yn.queue,next:null},os===null?dn.memoizedState=os=f:os=os.next=f}return os}function Hh(f,m){return typeof m=="function"?m(f):m}function bw(f){var m=ti(),T=m.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=f;var j=Yn,D=j.baseQueue,U=T.pending;if(U!==null){if(D!==null){var fe=D.next;D.next=U.next,U.next=fe}j.baseQueue=D=U,T.pending=null}if(D!==null){U=D.next,j=j.baseState;var je=fe=null,ze=null,_t=U;do{var Lt=_t.lane;if((Qc&Lt)===Lt)ze!==null&&(ze=ze.next={lane:0,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null}),j=_t.hasEagerState?_t.eagerState:f(j,_t.action);else{var sr={lane:Lt,action:_t.action,hasEagerState:_t.hasEagerState,eagerState:_t.eagerState,next:null};ze===null?(je=ze=sr,fe=j):ze=ze.next=sr,dn.lanes|=Lt,qc|=Lt}_t=_t.next}while(_t!==null&&_t!==U);ze===null?fe=j:ze.next=je,Ai(j,m.memoizedState)||(ma=!0),m.memoizedState=j,m.baseState=fe,m.baseQueue=ze,T.lastRenderedState=j}if(f=T.interleaved,f!==null){D=f;do U=D.lane,dn.lanes|=U,qc|=U,D=D.next;while(D!==f)}else D===null&&(T.lanes=0);return[m.memoizedState,T.dispatch]}function Sw(f){var m=ti(),T=m.queue;if(T===null)throw Error(i(311));T.lastRenderedReducer=f;var j=T.dispatch,D=T.pending,U=m.memoizedState;if(D!==null){T.pending=null;var fe=D=D.next;do U=f(U,fe.action),fe=fe.next;while(fe!==D);Ai(U,m.memoizedState)||(ma=!0),m.memoizedState=U,m.baseQueue===null&&(m.baseState=U),T.lastRenderedState=U}return[U,j]}function eE(){}function tE(f,m){var T=dn,j=ti(),D=m(),U=!Ai(j.memoizedState,D);if(U&&(j.memoizedState=D,ma=!0),j=j.queue,kw(sE.bind(null,T,j,f),[f]),j.getSnapshot!==m||U||os!==null&&os.memoizedState.tag&1){if(T.flags|=2048,zh(9,nE.bind(null,T,j,D,m),void 0,null),ls===null)throw Error(i(349));Qc&30||rE(T,m,D)}return D}function rE(f,m,T){f.flags|=16384,f={getSnapshot:m,value:T},m=dn.updateQueue,m===null?(m={lastEffect:null,stores:null},dn.updateQueue=m,m.stores=[f]):(T=m.stores,T===null?m.stores=[f]:T.push(f))}function nE(f,m,T,j){m.value=T,m.getSnapshot=j,aE(m)&&iE(f)}function sE(f,m,T){return T(function(){aE(m)&&iE(f)})}function aE(f){var m=f.getSnapshot;f=f.value;try{var T=m();return!Ai(f,T)}catch{return!0}}function iE(f){var m=oo(f,1);m!==null&&ri(m,f,1,-1)}function oE(f){var m=co();return typeof f=="function"&&(f=f()),m.memoizedState=m.baseState=f,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hh,lastRenderedState:f},m.queue=f,f=f.dispatch=_L.bind(null,dn,f),[m.memoizedState,f]}function zh(f,m,T,j){return f={tag:f,create:m,destroy:T,deps:j,next:null},m=dn.updateQueue,m===null?(m={lastEffect:null,stores:null},dn.updateQueue=m,m.lastEffect=f.next=f):(T=m.lastEffect,T===null?m.lastEffect=f.next=f:(j=T.next,T.next=f,f.next=j,m.lastEffect=f)),f}function lE(){return ti().memoizedState}function rp(f,m,T,j){var D=co();dn.flags|=f,D.memoizedState=zh(1|m,T,void 0,j===void 0?null:j)}function np(f,m,T,j){var D=ti();j=j===void 0?null:j;var U=void 0;if(Yn!==null){var fe=Yn.memoizedState;if(U=fe.destroy,j!==null&&vw(j,fe.deps)){D.memoizedState=zh(m,T,U,j);return}}dn.flags|=f,D.memoizedState=zh(1|m,T,U,j)}function cE(f,m){return rp(8390656,8,f,m)}function kw(f,m){return np(2048,8,f,m)}function uE(f,m){return np(4,2,f,m)}function dE(f,m){return np(4,4,f,m)}function fE(f,m){if(typeof m=="function")return f=f(),m(f),function(){m(null)};if(m!=null)return f=f(),m.current=f,function(){m.current=null}}function hE(f,m,T){return T=T!=null?T.concat([f]):null,np(4,4,fE.bind(null,m,f),T)}function Cw(){}function gE(f,m){var T=ti();m=m===void 0?null:m;var j=T.memoizedState;return j!==null&&m!==null&&vw(m,j[1])?j[0]:(T.memoizedState=[f,m],f)}function mE(f,m){var T=ti();m=m===void 0?null:m;var j=T.memoizedState;return j!==null&&m!==null&&vw(m,j[1])?j[0]:(f=f(),T.memoizedState=[f,m],f)}function pE(f,m,T){return Qc&21?(Ai(T,m)||(T=I4(),dn.lanes|=T,qc|=T,f.baseState=!0),m):(f.baseState&&(f.baseState=!1,ma=!0),f.memoizedState=T)}function vL(f,m){var T=Cr;Cr=T!==0&&4>T?T:4,f(!0);var j=yw.transition;yw.transition={};try{f(!1),m()}finally{Cr=T,yw.transition=j}}function xE(){return ti().memoizedState}function wL(f,m,T){var j=Ol(f);if(T={lane:j,action:T,hasEagerState:!1,eagerState:null,next:null},yE(f))vE(m,T);else if(T=Y4(f,m,T,j),T!==null){var D=Ms();ri(T,f,j,D),wE(T,m,j)}}function _L(f,m,T){var j=Ol(f),D={lane:j,action:T,hasEagerState:!1,eagerState:null,next:null};if(yE(f))vE(m,D);else{var U=f.alternate;if(f.lanes===0&&(U===null||U.lanes===0)&&(U=m.lastRenderedReducer,U!==null))try{var fe=m.lastRenderedState,je=U(fe,T);if(D.hasEagerState=!0,D.eagerState=je,Ai(je,fe)){var ze=m.interleaved;ze===null?(D.next=D,fw(m)):(D.next=ze.next,ze.next=D),m.interleaved=D;return}}catch{}finally{}T=Y4(f,m,D,j),T!==null&&(D=Ms(),ri(T,f,j,D),wE(T,m,j))}}function yE(f){var m=f.alternate;return f===dn||m!==null&&m===dn}function vE(f,m){$h=tp=!0;var T=f.pending;T===null?m.next=m:(m.next=T.next,T.next=m),f.pending=m}function wE(f,m,T){if(T&4194240){var j=m.lanes;j&=f.pendingLanes,T|=j,m.lanes=T,qv(f,T)}}var sp={readContext:Za,useCallback:Ps,useContext:Ps,useEffect:Ps,useImperativeHandle:Ps,useInsertionEffect:Ps,useLayoutEffect:Ps,useMemo:Ps,useReducer:Ps,useRef:Ps,useState:Ps,useDebugValue:Ps,useDeferredValue:Ps,useTransition:Ps,useMutableSource:Ps,useSyncExternalStore:Ps,useId:Ps,unstable_isNewReconciler:!1},bL={readContext:Za,useCallback:function(f,m){return co().memoizedState=[f,m===void 0?null:m],f},useContext:Za,useEffect:cE,useImperativeHandle:function(f,m,T){return T=T!=null?T.concat([f]):null,rp(4194308,4,fE.bind(null,m,f),T)},useLayoutEffect:function(f,m){return rp(4194308,4,f,m)},useInsertionEffect:function(f,m){return rp(4,2,f,m)},useMemo:function(f,m){var T=co();return m=m===void 0?null:m,f=f(),T.memoizedState=[f,m],f},useReducer:function(f,m,T){var j=co();return m=T!==void 0?T(m):m,j.memoizedState=j.baseState=m,f={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:f,lastRenderedState:m},j.queue=f,f=f.dispatch=wL.bind(null,dn,f),[j.memoizedState,f]},useRef:function(f){var m=co();return f={current:f},m.memoizedState=f},useState:oE,useDebugValue:Cw,useDeferredValue:function(f){return co().memoizedState=f},useTransition:function(){var f=oE(!1),m=f[0];return f=vL.bind(null,f[1]),co().memoizedState=f,[m,f]},useMutableSource:function(){},useSyncExternalStore:function(f,m,T){var j=dn,D=co();if(rn){if(T===void 0)throw Error(i(407));T=T()}else{if(T=m(),ls===null)throw Error(i(349));Qc&30||rE(j,m,T)}D.memoizedState=T;var U={value:T,getSnapshot:m};return D.queue=U,cE(sE.bind(null,j,U,f),[f]),j.flags|=2048,zh(9,nE.bind(null,j,U,T,m),void 0,null),T},useId:function(){var f=co(),m=ls.identifierPrefix;if(rn){var T=Ho,j=Wo;T=(j&~(1<<32-ga(j)-1)).toString(32)+T,m=":"+m+"R"+T,T=Wh++,0<T&&(m+="H"+T.toString(32)),m+=":"}else T=yL++,m=":"+m+"r"+T.toString(32)+":";return f.memoizedState=m},unstable_isNewReconciler:!1},SL={readContext:Za,useCallback:gE,useContext:Za,useEffect:kw,useImperativeHandle:hE,useInsertionEffect:uE,useLayoutEffect:dE,useMemo:mE,useReducer:bw,useRef:lE,useState:function(){return bw(Hh)},useDebugValue:Cw,useDeferredValue:function(f){var m=ti();return pE(m,Yn.memoizedState,f)},useTransition:function(){var f=bw(Hh)[0],m=ti().memoizedState;return[f,m]},useMutableSource:eE,useSyncExternalStore:tE,useId:xE,unstable_isNewReconciler:!1},kL={readContext:Za,useCallback:gE,useContext:Za,useEffect:kw,useImperativeHandle:hE,useInsertionEffect:uE,useLayoutEffect:dE,useMemo:mE,useReducer:Sw,useRef:lE,useState:function(){return Sw(Hh)},useDebugValue:Cw,useDeferredValue:function(f){var m=ti();return Yn===null?m.memoizedState=f:pE(m,Yn.memoizedState,f)},useTransition:function(){var f=Sw(Hh)[0],m=ti().memoizedState;return[f,m]},useMutableSource:eE,useSyncExternalStore:tE,useId:xE,unstable_isNewReconciler:!1};function Fi(f,m){if(f&&f.defaultProps){m=a({},m),f=f.defaultProps;for(var T in f)m[T]===void 0&&(m[T]=f[T]);return m}return m}function Tw(f,m,T,j){m=f.memoizedState,T=T(j,m),T=T==null?m:a({},m,T),f.memoizedState=T,f.lanes===0&&(f.updateQueue.baseState=T)}var ap={isMounted:function(f){return(f=f._reactInternals)?F(f)===f:!1},enqueueSetState:function(f,m,T){f=f._reactInternals;var j=Ms(),D=Ol(f),U=zo(j,D);U.payload=m,T!=null&&(U.callback=T),m=Rl(f,U,D),m!==null&&(ri(m,f,D,j),Qm(m,f,D))},enqueueReplaceState:function(f,m,T){f=f._reactInternals;var j=Ms(),D=Ol(f),U=zo(j,D);U.tag=1,U.payload=m,T!=null&&(U.callback=T),m=Rl(f,U,D),m!==null&&(ri(m,f,D,j),Qm(m,f,D))},enqueueForceUpdate:function(f,m){f=f._reactInternals;var T=Ms(),j=Ol(f),D=zo(T,j);D.tag=2,m!=null&&(D.callback=m),m=Rl(f,D,j),m!==null&&(ri(m,f,j,T),Qm(m,f,j))}};function _E(f,m,T,j,D,U,fe){return f=f.stateNode,typeof f.shouldComponentUpdate=="function"?f.shouldComponentUpdate(j,U,fe):m.prototype&&m.prototype.isPureReactComponent?!Km(T,j)||!Km(D,U):!0}function bE(f,m,T){var j=!1,D=W,U=m.contextType;return typeof U=="object"&&U!==null?U=Za(U):(D=nr(m)?ct:_e.current,j=m.contextTypes,U=(j=j!=null)?Gt(f,D):W),m=new m(T,U),f.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=ap,f.stateNode=m,m._reactInternals=f,j&&(f=f.stateNode,f.__reactInternalMemoizedUnmaskedChildContext=D,f.__reactInternalMemoizedMaskedChildContext=U),m}function SE(f,m,T,j){f=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(T,j),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(T,j),m.state!==f&&ap.enqueueReplaceState(m,m.state,null)}function Ew(f,m,T,j){var D=f.stateNode;D.props=T,D.state=f.memoizedState,D.refs={},hw(f);var U=m.contextType;typeof U=="object"&&U!==null?D.context=Za(U):(U=nr(m)?ct:_e.current,D.context=Gt(f,U)),D.state=f.memoizedState,U=m.getDerivedStateFromProps,typeof U=="function"&&(Tw(f,m,U,T),D.state=f.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(m=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),m!==D.state&&ap.enqueueReplaceState(D,D.state,null),qm(f,T,D,j),D.state=f.memoizedState),typeof D.componentDidMount=="function"&&(f.flags|=4194308)}function Pd(f,m){try{var T="",j=m;do T+=xL(j),j=j.return;while(j);var D=T}catch(U){D=`
Error generating stack: `+U.message+`
`+U.stack}return{value:f,source:m,stack:D,digest:null}}function Nw(f,m,T){return{value:f,source:null,stack:T??null,digest:m??null}}function Aw(f,m){try{console.error(m.value)}catch(T){setTimeout(function(){throw T})}}var CL=typeof WeakMap=="function"?WeakMap:Map;function kE(f,m,T){T=zo(-1,T),T.tag=3,T.payload={element:null};var j=m.value;return T.callback=function(){vp||(vp=!0,Yw=j),Aw(f,m)},T}function CE(f,m,T){T=zo(-1,T),T.tag=3;var j=f.type.getDerivedStateFromError;if(typeof j=="function"){var D=m.value;T.payload=function(){return j(D)},T.callback=function(){Aw(f,m)}}var U=f.stateNode;return U!==null&&typeof U.componentDidCatch=="function"&&(T.callback=function(){Aw(f,m),typeof j!="function"&&(Ml===null?Ml=new Set([this]):Ml.add(this));var fe=m.stack;this.componentDidCatch(m.value,{componentStack:fe!==null?fe:""})}),T}function TE(f,m,T){var j=f.pingCache;if(j===null){j=f.pingCache=new CL;var D=new Set;j.set(m,D)}else D=j.get(m),D===void 0&&(D=new Set,j.set(m,D));D.has(T)||(D.add(T),f=BL.bind(null,f,m,T),m.then(f,f))}function EE(f){do{var m;if((m=f.tag===13)&&(m=f.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return f;f=f.return}while(f!==null);return null}function NE(f,m,T,j,D){return f.mode&1?(f.flags|=65536,f.lanes=D,f):(f===m?f.flags|=65536:(f.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(m=zo(-1,1),m.tag=2,Rl(T,m,1))),T.lanes|=1),f)}var TL=o.ReactCurrentOwner,ma=!1;function ta(f,m,T,j){m.child=f===null?K4(m,null,T,j):Ed(m,f.child,T,j)}function AE(f,m,T,j,D){T=T.render;var U=m.ref;return Ad(m,D),j=ww(f,m,T,j,U,D),T=_w(),f!==null&&!ma?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~D,Go(f,m,D)):(rn&&T&&nw(m),m.flags|=1,ta(f,m,j,D),m.child)}function jE(f,m,T,j,D){if(f===null){var U=T.type;return typeof U=="function"&&!t_(U)&&U.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(m.tag=15,m.type=U,FE(f,m,U,j,D)):(f=Cp(T.type,null,j,m,m.mode,D),f.ref=m.ref,f.return=m,m.child=f)}if(U=f.child,!(f.lanes&D)){var fe=U.memoizedProps;if(T=T.compare,T=T!==null?T:Km,T(fe,j)&&f.ref===m.ref)return Go(f,m,D)}return m.flags|=1,f=Bl(U,j),f.ref=m.ref,f.return=m,m.child=f}function FE(f,m,T,j,D){if(f!==null){var U=f.memoizedProps;if(Km(U,j)&&f.ref===m.ref)if(ma=!1,m.pendingProps=j=U,(f.lanes&D)!==0)f.flags&131072&&(ma=!0);else return m.lanes=f.lanes,Go(f,m,D)}return jw(f,m,T,j,D)}function PE(f,m,T){var j=m.pendingProps,D=j.children,U=f!==null?f.memoizedState:null;if(j.mode==="hidden")if(!(m.mode&1))m.memoizedState={baseLanes:0,cachePool:null,transitions:null},jt(Rd,Ra),Ra|=T;else{if(!(T&1073741824))return f=U!==null?U.baseLanes|T:T,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:f,cachePool:null,transitions:null},m.updateQueue=null,jt(Rd,Ra),Ra|=f,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},j=U!==null?U.baseLanes:T,jt(Rd,Ra),Ra|=j}else U!==null?(j=U.baseLanes|T,m.memoizedState=null):j=T,jt(Rd,Ra),Ra|=j;return ta(f,m,D,T),m.child}function DE(f,m){var T=m.ref;(f===null&&T!==null||f!==null&&f.ref!==T)&&(m.flags|=512,m.flags|=2097152)}function jw(f,m,T,j,D){var U=nr(T)?ct:_e.current;return U=Gt(m,U),Ad(m,D),T=ww(f,m,T,j,U,D),j=_w(),f!==null&&!ma?(m.updateQueue=f.updateQueue,m.flags&=-2053,f.lanes&=~D,Go(f,m,D)):(rn&&j&&nw(m),m.flags|=1,ta(f,m,T,D),m.child)}function RE(f,m,T,j,D){if(nr(T)){var U=!0;ha(m)}else U=!1;if(Ad(m,D),m.stateNode===null)op(f,m),bE(m,T,j),Ew(m,T,j,D),j=!0;else if(f===null){var fe=m.stateNode,je=m.memoizedProps;fe.props=je;var ze=fe.context,_t=T.contextType;typeof _t=="object"&&_t!==null?_t=Za(_t):(_t=nr(T)?ct:_e.current,_t=Gt(m,_t));var Lt=T.getDerivedStateFromProps,sr=typeof Lt=="function"||typeof fe.getSnapshotBeforeUpdate=="function";sr||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(je!==j||ze!==_t)&&SE(m,fe,j,_t),Dl=!1;var Dt=m.memoizedState;fe.state=Dt,qm(m,j,fe,D),ze=m.memoizedState,je!==j||Dt!==ze||tt.current||Dl?(typeof Lt=="function"&&(Tw(m,T,Lt,j),ze=m.memoizedState),(je=Dl||_E(m,T,je,j,Dt,ze,_t))?(sr||typeof fe.UNSAFE_componentWillMount!="function"&&typeof fe.componentWillMount!="function"||(typeof fe.componentWillMount=="function"&&fe.componentWillMount(),typeof fe.UNSAFE_componentWillMount=="function"&&fe.UNSAFE_componentWillMount()),typeof fe.componentDidMount=="function"&&(m.flags|=4194308)):(typeof fe.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=j,m.memoizedState=ze),fe.props=j,fe.state=ze,fe.context=_t,j=je):(typeof fe.componentDidMount=="function"&&(m.flags|=4194308),j=!1)}else{fe=m.stateNode,J4(f,m),je=m.memoizedProps,_t=m.type===m.elementType?je:Fi(m.type,je),fe.props=_t,sr=m.pendingProps,Dt=fe.context,ze=T.contextType,typeof ze=="object"&&ze!==null?ze=Za(ze):(ze=nr(T)?ct:_e.current,ze=Gt(m,ze));var Kr=T.getDerivedStateFromProps;(Lt=typeof Kr=="function"||typeof fe.getSnapshotBeforeUpdate=="function")||typeof fe.UNSAFE_componentWillReceiveProps!="function"&&typeof fe.componentWillReceiveProps!="function"||(je!==sr||Dt!==ze)&&SE(m,fe,j,ze),Dl=!1,Dt=m.memoizedState,fe.state=Dt,qm(m,j,fe,D);var Wr=m.memoizedState;je!==sr||Dt!==Wr||tt.current||Dl?(typeof Kr=="function"&&(Tw(m,T,Kr,j),Wr=m.memoizedState),(_t=Dl||_E(m,T,_t,j,Dt,Wr,ze)||!1)?(Lt||typeof fe.UNSAFE_componentWillUpdate!="function"&&typeof fe.componentWillUpdate!="function"||(typeof fe.componentWillUpdate=="function"&&fe.componentWillUpdate(j,Wr,ze),typeof fe.UNSAFE_componentWillUpdate=="function"&&fe.UNSAFE_componentWillUpdate(j,Wr,ze)),typeof fe.componentDidUpdate=="function"&&(m.flags|=4),typeof fe.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof fe.componentDidUpdate!="function"||je===f.memoizedProps&&Dt===f.memoizedState||(m.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||je===f.memoizedProps&&Dt===f.memoizedState||(m.flags|=1024),m.memoizedProps=j,m.memoizedState=Wr),fe.props=j,fe.state=Wr,fe.context=ze,j=_t):(typeof fe.componentDidUpdate!="function"||je===f.memoizedProps&&Dt===f.memoizedState||(m.flags|=4),typeof fe.getSnapshotBeforeUpdate!="function"||je===f.memoizedProps&&Dt===f.memoizedState||(m.flags|=1024),j=!1)}return Fw(f,m,T,j,U,D)}function Fw(f,m,T,j,D,U){DE(f,m);var fe=(m.flags&128)!==0;if(!j&&!fe)return D&&cn(m,T,!1),Go(f,m,U);j=m.stateNode,TL.current=m;var je=fe&&typeof T.getDerivedStateFromError!="function"?null:j.render();return m.flags|=1,f!==null&&fe?(m.child=Ed(m,f.child,null,U),m.child=Ed(m,null,je,U)):ta(f,m,je,U),m.memoizedState=j.state,D&&cn(m,T,!0),m.child}function ME(f){var m=f.stateNode;m.pendingContext?Uo(f,m.pendingContext,m.pendingContext!==m.context):m.context&&Uo(f,m.context,!1),gw(f,m.containerInfo)}function IE(f,m,T,j,D){return Td(),ow(D),m.flags|=256,ta(f,m,T,j),m.child}var Pw={dehydrated:null,treeContext:null,retryLane:0};function Dw(f){return{baseLanes:f,cachePool:null,transitions:null}}function OE(f,m,T){var j=m.pendingProps,D=un.current,U=!1,fe=(m.flags&128)!==0,je;if((je=fe)||(je=f!==null&&f.memoizedState===null?!1:(D&2)!==0),je?(U=!0,m.flags&=-129):(f===null||f.memoizedState!==null)&&(D|=1),jt(un,D&1),f===null)return iw(m),f=m.memoizedState,f!==null&&(f=f.dehydrated,f!==null)?(m.mode&1?pr(f)?m.lanes=8:m.lanes=1073741824:m.lanes=1,null):(fe=j.children,f=j.fallback,U?(j=m.mode,U=m.child,fe={mode:"hidden",children:fe},!(j&1)&&U!==null?(U.childLanes=0,U.pendingProps=fe):U=Tp(fe,j,0,null),f=ru(f,j,T,null),U.return=m,f.return=m,U.sibling=f,m.child=U,m.child.memoizedState=Dw(T),m.memoizedState=Pw,f):Rw(m,fe));if(D=f.memoizedState,D!==null&&(je=D.dehydrated,je!==null))return EL(f,m,fe,j,je,D,T);if(U){U=j.fallback,fe=m.mode,D=f.child,je=D.sibling;var ze={mode:"hidden",children:j.children};return!(fe&1)&&m.child!==D?(j=m.child,j.childLanes=0,j.pendingProps=ze,m.deletions=null):(j=Bl(D,ze),j.subtreeFlags=D.subtreeFlags&14680064),je!==null?U=Bl(je,U):(U=ru(U,fe,T,null),U.flags|=2),U.return=m,j.return=m,j.sibling=U,m.child=j,j=U,U=m.child,fe=f.child.memoizedState,fe=fe===null?Dw(T):{baseLanes:fe.baseLanes|T,cachePool:null,transitions:fe.transitions},U.memoizedState=fe,U.childLanes=f.childLanes&~T,m.memoizedState=Pw,j}return U=f.child,f=U.sibling,j=Bl(U,{mode:"visible",children:j.children}),!(m.mode&1)&&(j.lanes=T),j.return=m,j.sibling=null,f!==null&&(T=m.deletions,T===null?(m.deletions=[f],m.flags|=16):T.push(f)),m.child=j,m.memoizedState=null,j}function Rw(f,m){return m=Tp({mode:"visible",children:m},f.mode,0,null),m.return=f,f.child=m}function ip(f,m,T,j){return j!==null&&ow(j),Ed(m,f.child,null,T),f=Rw(m,m.pendingProps.children),f.flags|=2,m.memoizedState=null,f}function EL(f,m,T,j,D,U,fe){if(T)return m.flags&256?(m.flags&=-257,j=Nw(Error(i(422))),ip(f,m,fe,j)):m.memoizedState!==null?(m.child=f.child,m.flags|=128,null):(U=j.fallback,D=m.mode,j=Tp({mode:"visible",children:j.children},D,0,null),U=ru(U,D,fe,null),U.flags|=2,j.return=m,U.return=m,j.sibling=U,m.child=j,m.mode&1&&Ed(m,f.child,null,fe),m.child.memoizedState=Dw(fe),m.memoizedState=Pw,U);if(!(m.mode&1))return ip(f,m,fe,null);if(pr(D))return j=_n(D).digest,U=Error(i(419)),j=Nw(U,j,void 0),ip(f,m,fe,j);if(T=(fe&f.childLanes)!==0,ma||T){if(j=ls,j!==null){switch(fe&-fe){case 4:D=2;break;case 16:D=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:D=32;break;case 536870912:D=268435456;break;default:D=0}D=D&(j.suspendedLanes|fe)?0:D,D!==0&&D!==U.retryLane&&(U.retryLane=D,oo(f,D),ri(j,f,D,-1))}return e_(),j=Nw(Error(i(421))),ip(f,m,fe,j)}return er(D)?(m.flags|=128,m.child=f.child,m=UL.bind(null,f),Z(D,m),null):(f=U.treeContext,Ee&&(qa=me(D),Da=m,rn=!0,ji=null,Oh=!1,f!==null&&(Ja[Qa++]=Wo,Ja[Qa++]=Ho,Ja[Qa++]=Xc,Wo=f.id,Ho=f.overflow,Xc=m)),m=Rw(m,j.children),m.flags|=4096,m)}function LE(f,m,T){f.lanes|=m;var j=f.alternate;j!==null&&(j.lanes|=m),dw(f.return,m,T)}function Mw(f,m,T,j,D){var U=f.memoizedState;U===null?f.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:j,tail:T,tailMode:D}:(U.isBackwards=m,U.rendering=null,U.renderingStartTime=0,U.last=j,U.tail=T,U.tailMode=D)}function BE(f,m,T){var j=m.pendingProps,D=j.revealOrder,U=j.tail;if(ta(f,m,j.children,T),j=un.current,j&2)j=j&1|2,m.flags|=128;else{if(f!==null&&f.flags&128)e:for(f=m.child;f!==null;){if(f.tag===13)f.memoizedState!==null&&LE(f,T,m);else if(f.tag===19)LE(f,T,m);else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===m)break e;for(;f.sibling===null;){if(f.return===null||f.return===m)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}j&=1}if(jt(un,j),!(m.mode&1))m.memoizedState=null;else switch(D){case"forwards":for(T=m.child,D=null;T!==null;)f=T.alternate,f!==null&&Zm(f)===null&&(D=T),T=T.sibling;T=D,T===null?(D=m.child,m.child=null):(D=T.sibling,T.sibling=null),Mw(m,!1,D,T,U);break;case"backwards":for(T=null,D=m.child,m.child=null;D!==null;){if(f=D.alternate,f!==null&&Zm(f)===null){m.child=D;break}f=D.sibling,D.sibling=T,T=D,D=f}Mw(m,!0,T,null,U);break;case"together":Mw(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function op(f,m){!(m.mode&1)&&f!==null&&(f.alternate=null,m.alternate=null,m.flags|=2)}function Go(f,m,T){if(f!==null&&(m.dependencies=f.dependencies),qc|=m.lanes,!(T&m.childLanes))return null;if(f!==null&&m.child!==f.child)throw Error(i(153));if(m.child!==null){for(f=m.child,T=Bl(f,f.pendingProps),m.child=T,T.return=m;f.sibling!==null;)f=f.sibling,T=T.sibling=Bl(f,f.pendingProps),T.return=m;T.sibling=null}return m.child}function NL(f,m,T){switch(m.tag){case 3:ME(m),Td();break;case 5:Z4(m);break;case 1:nr(m.type)&&ha(m);break;case 4:gw(m,m.stateNode.containerInfo);break;case 10:X4(m,m.type._context,m.memoizedProps.value);break;case 13:var j=m.memoizedState;if(j!==null)return j.dehydrated!==null?(jt(un,un.current&1),m.flags|=128,null):T&m.child.childLanes?OE(f,m,T):(jt(un,un.current&1),f=Go(f,m,T),f!==null?f.sibling:null);jt(un,un.current&1);break;case 19:if(j=(T&m.childLanes)!==0,f.flags&128){if(j)return BE(f,m,T);m.flags|=128}var D=m.memoizedState;if(D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),jt(un,un.current),j)break;return null;case 22:case 23:return m.lanes=0,PE(f,m,T)}return Go(f,m,T)}function uo(f){f.flags|=4}function UE(f,m){if(f!==null&&f.child===m.child)return!0;if(m.flags&16)return!1;for(f=m.child;f!==null;){if(f.flags&12854||f.subtreeFlags&12854)return!1;f=f.sibling}return!0}var Gh,Vh,lp,cp;if(Fe)Gh=function(f,m){for(var T=m.child;T!==null;){if(T.tag===5||T.tag===6)H(f,T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},Vh=function(){},lp=function(f,m,T,j,D){if(f=f.memoizedProps,f!==j){var U=m.stateNode,fe=lo(ei.current);T=q(U,T,f,j,D,fe),(m.updateQueue=T)&&uo(m)}},cp=function(f,m,T,j){T!==j&&uo(m)};else if(ne){Gh=function(f,m,T,j){for(var D=m.child;D!==null;){if(D.tag===5){var U=D.stateNode;T&&j&&(U=yt(U,D.type,D.memoizedProps,D)),H(f,U)}else if(D.tag===6)U=D.stateNode,T&&j&&(U=wt(U,D.memoizedProps,D)),H(f,U);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)U=D.child,U!==null&&(U.return=D),Gh(f,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===m)break;for(;D.sibling===null;){if(D.return===null||D.return===m)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};var $E=function(f,m,T,j){for(var D=m.child;D!==null;){if(D.tag===5){var U=D.stateNode;T&&j&&(U=yt(U,D.type,D.memoizedProps,D)),st(f,U)}else if(D.tag===6)U=D.stateNode,T&&j&&(U=wt(U,D.memoizedProps,D)),st(f,U);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)U=D.child,U!==null&&(U.return=D),$E(f,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===m)break;for(;D.sibling===null;){if(D.return===null||D.return===m)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};Vh=function(f,m){var T=m.stateNode;if(!UE(f,m)){f=T.containerInfo;var j=Ae(f);$E(j,m,!1,!1),T.pendingChildren=j,uo(m),rt(f,j)}},lp=function(f,m,T,j,D){var U=f.stateNode,fe=f.memoizedProps;if((f=UE(f,m))&&fe===j)m.stateNode=U;else{var je=m.stateNode,ze=lo(ei.current),_t=null;fe!==j&&(_t=q(je,T,fe,j,D,ze)),f&&_t===null?m.stateNode=U:(U=he(U,_t,T,fe,j,m,f,je),V(U,T,j,D,ze)&&uo(m),m.stateNode=U,f?uo(m):Gh(U,m,!1,!1))}},cp=function(f,m,T,j){T!==j?(f=lo(jd.current),T=lo(ei.current),m.stateNode=ae(j,f,T,m),uo(m)):m.stateNode=f.stateNode}}else Vh=function(){},lp=function(){},cp=function(){};function Kh(f,m){if(!rn)switch(f.tailMode){case"hidden":m=f.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?f.tail=null:T.sibling=null;break;case"collapsed":T=f.tail;for(var j=null;T!==null;)T.alternate!==null&&(j=T),T=T.sibling;j===null?m||f.tail===null?f.tail=null:f.tail.sibling=null:j.sibling=null}}function Ds(f){var m=f.alternate!==null&&f.alternate.child===f.child,T=0,j=0;if(m)for(var D=f.child;D!==null;)T|=D.lanes|D.childLanes,j|=D.subtreeFlags&14680064,j|=D.flags&14680064,D.return=f,D=D.sibling;else for(D=f.child;D!==null;)T|=D.lanes|D.childLanes,j|=D.subtreeFlags,j|=D.flags,D.return=f,D=D.sibling;return f.subtreeFlags|=j,f.childLanes=T,m}function AL(f,m,T){var j=m.pendingProps;switch(sw(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ds(m),null;case 1:return nr(m.type)&&bn(),Ds(m),null;case 3:return T=m.stateNode,Fd(),Pt(tt),Pt(_e),xw(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(f===null||f.child===null)&&(Vm(m)?uo(m):f===null||f.memoizedState.isDehydrated&&!(m.flags&256)||(m.flags|=1024,ji!==null&&(qw(ji),ji=null))),Vh(f,m),Ds(m),null;case 5:mw(m),T=lo(jd.current);var D=m.type;if(f!==null&&m.stateNode!=null)lp(f,m,D,j,T),f.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!j){if(m.stateNode===null)throw Error(i(166));return Ds(m),null}if(f=lo(ei.current),Vm(m)){if(!Ee)throw Error(i(175));f=K(m.stateNode,m.type,m.memoizedProps,T,f,m,!Oh),m.updateQueue=f,f!==null&&uo(m)}else{var U=te(D,j,T,f,m);Gh(U,m,!1,!1),m.stateNode=U,V(U,D,j,T,f)&&uo(m)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return Ds(m),null;case 6:if(f&&m.stateNode!=null)cp(f,m,f.memoizedProps,j);else{if(typeof j!="string"&&m.stateNode===null)throw Error(i(166));if(f=lo(jd.current),T=lo(ei.current),Vm(m)){if(!Ee)throw Error(i(176));if(f=m.stateNode,T=m.memoizedProps,(j=le(f,T,m,!Oh))&&(D=Da,D!==null))switch(D.tag){case 3:Ce(D.stateNode.containerInfo,f,T,(D.mode&1)!==0);break;case 5:Oe(D.type,D.memoizedProps,D.stateNode,f,T,(D.mode&1)!==0)}j&&uo(m)}else m.stateNode=ae(j,f,T,m)}return Ds(m),null;case 13:if(Pt(un),j=m.memoizedState,f===null||f.memoizedState!==null&&f.memoizedState.dehydrated!==null){if(rn&&qa!==null&&m.mode&1&&!(m.flags&128))z4(),Td(),m.flags|=98560,D=!1;else if(D=Vm(m),j!==null&&j.dehydrated!==null){if(f===null){if(!D)throw Error(i(318));if(!Ee)throw Error(i(344));if(D=m.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(i(317));be(D,m)}else Td(),!(m.flags&128)&&(m.memoizedState=null),m.flags|=4;Ds(m),D=!1}else ji!==null&&(qw(ji),ji=null),D=!0;if(!D)return m.flags&65536?m:null}return m.flags&128?(m.lanes=T,m):(T=j!==null,T!==(f!==null&&f.memoizedState!==null)&&T&&(m.child.flags|=8192,m.mode&1&&(f===null||un.current&1?Jn===0&&(Jn=3):e_())),m.updateQueue!==null&&(m.flags|=4),Ds(m),null);case 4:return Fd(),Vh(f,m),f===null&&He(m.stateNode.containerInfo),Ds(m),null;case 10:return uw(m.type._context),Ds(m),null;case 17:return nr(m.type)&&bn(),Ds(m),null;case 19:if(Pt(un),D=m.memoizedState,D===null)return Ds(m),null;if(j=(m.flags&128)!==0,U=D.rendering,U===null)if(j)Kh(D,!1);else{if(Jn!==0||f!==null&&f.flags&128)for(f=m.child;f!==null;){if(U=Zm(f),U!==null){for(m.flags|=128,Kh(D,!1),f=U.updateQueue,f!==null&&(m.updateQueue=f,m.flags|=4),m.subtreeFlags=0,f=T,T=m.child;T!==null;)j=T,D=f,j.flags&=14680066,U=j.alternate,U===null?(j.childLanes=0,j.lanes=D,j.child=null,j.subtreeFlags=0,j.memoizedProps=null,j.memoizedState=null,j.updateQueue=null,j.dependencies=null,j.stateNode=null):(j.childLanes=U.childLanes,j.lanes=U.lanes,j.child=U.child,j.subtreeFlags=0,j.deletions=null,j.memoizedProps=U.memoizedProps,j.memoizedState=U.memoizedState,j.updateQueue=U.updateQueue,j.type=U.type,D=U.dependencies,j.dependencies=D===null?null:{lanes:D.lanes,firstContext:D.firstContext}),T=T.sibling;return jt(un,un.current&1|2),m.child}f=f.sibling}D.tail!==null&&is()>Xw&&(m.flags|=128,j=!0,Kh(D,!1),m.lanes=4194304)}else{if(!j)if(f=Zm(U),f!==null){if(m.flags|=128,j=!0,f=f.updateQueue,f!==null&&(m.updateQueue=f,m.flags|=4),Kh(D,!0),D.tail===null&&D.tailMode==="hidden"&&!U.alternate&&!rn)return Ds(m),null}else 2*is()-D.renderingStartTime>Xw&&T!==1073741824&&(m.flags|=128,j=!0,Kh(D,!1),m.lanes=4194304);D.isBackwards?(U.sibling=m.child,m.child=U):(f=D.last,f!==null?f.sibling=U:m.child=U,D.last=U)}return D.tail!==null?(m=D.tail,D.rendering=m,D.tail=m.sibling,D.renderingStartTime=is(),m.sibling=null,f=un.current,jt(un,j?f&1|2:f&1),m):(Ds(m),null);case 22:case 23:return Zw(),T=m.memoizedState!==null,f!==null&&f.memoizedState!==null!==T&&(m.flags|=8192),T&&m.mode&1?Ra&1073741824&&(Ds(m),Fe&&m.subtreeFlags&6&&(m.flags|=8192)):Ds(m),null;case 24:return null;case 25:return null}throw Error(i(156,m.tag))}function jL(f,m){switch(sw(m),m.tag){case 1:return nr(m.type)&&bn(),f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 3:return Fd(),Pt(tt),Pt(_e),xw(),f=m.flags,f&65536&&!(f&128)?(m.flags=f&-65537|128,m):null;case 5:return mw(m),null;case 13:if(Pt(un),f=m.memoizedState,f!==null&&f.dehydrated!==null){if(m.alternate===null)throw Error(i(340));Td()}return f=m.flags,f&65536?(m.flags=f&-65537|128,m):null;case 19:return Pt(un),null;case 4:return Fd(),null;case 10:return uw(m.type._context),null;case 22:case 23:return Zw(),null;case 24:return null;default:return null}}var up=!1,Rs=!1,FL=typeof WeakSet=="function"?WeakSet:Set,It=null;function Dd(f,m){var T=f.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(j){nn(f,m,j)}else T.current=null}function Iw(f,m,T){try{T()}catch(j){nn(f,m,j)}}var WE=!1;function PL(f,m){for(R(f.containerInfo),It=m;It!==null;)if(f=It,m=f.child,(f.subtreeFlags&1028)!==0&&m!==null)m.return=f,It=m;else for(;It!==null;){f=It;try{var T=f.alternate;if(f.flags&1024)switch(f.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var j=T.memoizedProps,D=T.memoizedState,U=f.stateNode,fe=U.getSnapshotBeforeUpdate(f.elementType===f.type?j:Fi(f.type,j),D);U.__reactInternalSnapshotBeforeUpdate=fe}break;case 3:Fe&&ee(f.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(je){nn(f,f.return,je)}if(m=f.sibling,m!==null){m.return=f.return,It=m;break}It=f.return}return T=WE,WE=!1,T}function Xh(f,m,T){var j=m.updateQueue;if(j=j!==null?j.lastEffect:null,j!==null){var D=j=j.next;do{if((D.tag&f)===f){var U=D.destroy;D.destroy=void 0,U!==void 0&&Iw(m,T,U)}D=D.next}while(D!==j)}}function dp(f,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var T=m=m.next;do{if((T.tag&f)===f){var j=T.create;T.destroy=j()}T=T.next}while(T!==m)}}function Ow(f){var m=f.ref;if(m!==null){var T=f.stateNode;switch(f.tag){case 5:f=z(T);break;default:f=T}typeof m=="function"?m(f):m.current=f}}function HE(f){var m=f.alternate;m!==null&&(f.alternate=null,HE(m)),f.child=null,f.deletions=null,f.sibling=null,f.tag===5&&(m=f.stateNode,m!==null&&Me(m)),f.stateNode=null,f.return=null,f.dependencies=null,f.memoizedProps=null,f.memoizedState=null,f.pendingProps=null,f.stateNode=null,f.updateQueue=null}function zE(f){return f.tag===5||f.tag===3||f.tag===4}function GE(f){e:for(;;){for(;f.sibling===null;){if(f.return===null||zE(f.return))return null;f=f.return}for(f.sibling.return=f.return,f=f.sibling;f.tag!==5&&f.tag!==6&&f.tag!==18;){if(f.flags&2||f.child===null||f.tag===4)continue e;f.child.return=f,f=f.child}if(!(f.flags&2))return f.stateNode}}function Lw(f,m,T){var j=f.tag;if(j===5||j===6)f=f.stateNode,m?Ne(T,f,m):ot(T,f);else if(j!==4&&(f=f.child,f!==null))for(Lw(f,m,T),f=f.sibling;f!==null;)Lw(f,m,T),f=f.sibling}function Bw(f,m,T){var j=f.tag;if(j===5||j===6)f=f.stateNode,m?Et(T,f,m):Ve(T,f);else if(j!==4&&(f=f.child,f!==null))for(Bw(f,m,T),f=f.sibling;f!==null;)Bw(f,m,T),f=f.sibling}var ys=null,Pi=!1;function fo(f,m,T){for(T=T.child;T!==null;)Uw(f,m,T),T=T.sibling}function Uw(f,m,T){if(ao&&typeof ao.onCommitFiberUnmount=="function")try{ao.onCommitFiberUnmount(Wm,T)}catch{}switch(T.tag){case 5:Rs||Dd(T,m);case 6:if(Fe){var j=ys,D=Pi;ys=null,fo(f,m,T),ys=j,Pi=D,ys!==null&&(Pi?Ze(ys,T.stateNode):Ke(ys,T.stateNode))}else fo(f,m,T);break;case 18:Fe&&ys!==null&&(Pi?xe(ys,T.stateNode):ie(ys,T.stateNode));break;case 4:Fe?(j=ys,D=Pi,ys=T.stateNode.containerInfo,Pi=!0,fo(f,m,T),ys=j,Pi=D):(ne&&(j=T.stateNode.containerInfo,D=Ae(j),At(j,D)),fo(f,m,T));break;case 0:case 11:case 14:case 15:if(!Rs&&(j=T.updateQueue,j!==null&&(j=j.lastEffect,j!==null))){D=j=j.next;do{var U=D,fe=U.destroy;U=U.tag,fe!==void 0&&(U&2||U&4)&&Iw(T,m,fe),D=D.next}while(D!==j)}fo(f,m,T);break;case 1:if(!Rs&&(Dd(T,m),j=T.stateNode,typeof j.componentWillUnmount=="function"))try{j.props=T.memoizedProps,j.state=T.memoizedState,j.componentWillUnmount()}catch(je){nn(T,m,je)}fo(f,m,T);break;case 21:fo(f,m,T);break;case 22:T.mode&1?(Rs=(j=Rs)||T.memoizedState!==null,fo(f,m,T),Rs=j):fo(f,m,T);break;default:fo(f,m,T)}}function VE(f){var m=f.updateQueue;if(m!==null){f.updateQueue=null;var T=f.stateNode;T===null&&(T=f.stateNode=new FL),m.forEach(function(j){var D=$L.bind(null,f,j);T.has(j)||(T.add(j),j.then(D,D))})}}function Di(f,m){var T=m.deletions;if(T!==null)for(var j=0;j<T.length;j++){var D=T[j];try{var U=f,fe=m;if(Fe){var je=fe;e:for(;je!==null;){switch(je.tag){case 5:ys=je.stateNode,Pi=!1;break e;case 3:ys=je.stateNode.containerInfo,Pi=!0;break e;case 4:ys=je.stateNode.containerInfo,Pi=!0;break e}je=je.return}if(ys===null)throw Error(i(160));Uw(U,fe,D),ys=null,Pi=!1}else Uw(U,fe,D);var ze=D.alternate;ze!==null&&(ze.return=null),D.return=null}catch(_t){nn(D,m,_t)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)KE(m,f),m=m.sibling}function KE(f,m){var T=f.alternate,j=f.flags;switch(f.tag){case 0:case 11:case 14:case 15:if(Di(m,f),ho(f),j&4){try{Xh(3,f,f.return),dp(3,f)}catch(Dt){nn(f,f.return,Dt)}try{Xh(5,f,f.return)}catch(Dt){nn(f,f.return,Dt)}}break;case 1:Di(m,f),ho(f),j&512&&T!==null&&Dd(T,T.return);break;case 5:if(Di(m,f),ho(f),j&512&&T!==null&&Dd(T,T.return),Fe){if(f.flags&32){var D=f.stateNode;try{ft(D)}catch(Dt){nn(f,f.return,Dt)}}if(j&4&&(D=f.stateNode,D!=null)){var U=f.memoizedProps;if(T=T!==null?T.memoizedProps:U,j=f.type,m=f.updateQueue,f.updateQueue=null,m!==null)try{gt(D,m,j,T,U,f)}catch(Dt){nn(f,f.return,Dt)}}}break;case 6:if(Di(m,f),ho(f),j&4&&Fe){if(f.stateNode===null)throw Error(i(162));D=f.stateNode,U=f.memoizedProps,T=T!==null?T.memoizedProps:U;try{et(D,T,U)}catch(Dt){nn(f,f.return,Dt)}}break;case 3:if(Di(m,f),ho(f),j&4){if(Fe&&Ee&&T!==null&&T.memoizedState.isDehydrated)try{Te(m.containerInfo)}catch(Dt){nn(f,f.return,Dt)}if(ne){D=m.containerInfo,U=m.pendingChildren;try{At(D,U)}catch(Dt){nn(f,f.return,Dt)}}}break;case 4:if(Di(m,f),ho(f),j&4&&ne){U=f.stateNode,D=U.containerInfo,U=U.pendingChildren;try{At(D,U)}catch(Dt){nn(f,f.return,Dt)}}break;case 13:Di(m,f),ho(f),D=f.child,D.flags&8192&&(U=D.memoizedState!==null,D.stateNode.isHidden=U,!U||D.alternate!==null&&D.alternate.memoizedState!==null||(Kw=is())),j&4&&VE(f);break;case 22:var fe=T!==null&&T.memoizedState!==null;if(f.mode&1?(Rs=(T=Rs)||fe,Di(m,f),Rs=T):Di(m,f),ho(f),j&8192){if(T=f.memoizedState!==null,(f.stateNode.isHidden=T)&&!fe&&f.mode&1)for(It=f,j=f.child;j!==null;){for(m=It=j;It!==null;){fe=It;var je=fe.child;switch(fe.tag){case 0:case 11:case 14:case 15:Xh(4,fe,fe.return);break;case 1:Dd(fe,fe.return);var ze=fe.stateNode;if(typeof ze.componentWillUnmount=="function"){var _t=fe,Lt=fe.return;try{var sr=_t;ze.props=sr.memoizedProps,ze.state=sr.memoizedState,ze.componentWillUnmount()}catch(Dt){nn(_t,Lt,Dt)}}break;case 5:Dd(fe,fe.return);break;case 22:if(fe.memoizedState!==null){JE(m);continue}}je!==null?(je.return=fe,It=je):JE(m)}j=j.sibling}if(Fe){e:if(j=null,Fe)for(m=f;;){if(m.tag===5){if(j===null){j=m;try{D=m.stateNode,T?ut(D):ye(m.stateNode,m.memoizedProps)}catch(Dt){nn(f,f.return,Dt)}}}else if(m.tag===6){if(j===null)try{U=m.stateNode,T?bt(U):de(U,m.memoizedProps)}catch(Dt){nn(f,f.return,Dt)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===f)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===f)break e;for(;m.sibling===null;){if(m.return===null||m.return===f)break e;j===m&&(j=null),m=m.return}j===m&&(j=null),m.sibling.return=m.return,m=m.sibling}}}break;case 19:Di(m,f),ho(f),j&4&&VE(f);break;case 21:break;default:Di(m,f),ho(f)}}function ho(f){var m=f.flags;if(m&2){try{if(Fe){e:{for(var T=f.return;T!==null;){if(zE(T)){var j=T;break e}T=T.return}throw Error(i(160))}switch(j.tag){case 5:var D=j.stateNode;j.flags&32&&(ft(D),j.flags&=-33);var U=GE(f);Bw(f,U,D);break;case 3:case 4:var fe=j.stateNode.containerInfo,je=GE(f);Lw(f,je,fe);break;default:throw Error(i(161))}}}catch(ze){nn(f,f.return,ze)}f.flags&=-3}m&4096&&(f.flags&=-4097)}function DL(f,m,T){It=f,XE(f)}function XE(f,m,T){for(var j=(f.mode&1)!==0;It!==null;){var D=It,U=D.child;if(D.tag===22&&j){var fe=D.memoizedState!==null||up;if(!fe){var je=D.alternate,ze=je!==null&&je.memoizedState!==null||Rs;je=up;var _t=Rs;if(up=fe,(Rs=ze)&&!_t)for(It=D;It!==null;)fe=It,ze=fe.child,fe.tag===22&&fe.memoizedState!==null?QE(D):ze!==null?(ze.return=fe,It=ze):QE(D);for(;U!==null;)It=U,XE(U),U=U.sibling;It=D,up=je,Rs=_t}YE(f)}else D.subtreeFlags&8772&&U!==null?(U.return=D,It=U):YE(f)}}function YE(f){for(;It!==null;){var m=It;if(m.flags&8772){var T=m.alternate;try{if(m.flags&8772)switch(m.tag){case 0:case 11:case 15:Rs||dp(5,m);break;case 1:var j=m.stateNode;if(m.flags&4&&!Rs)if(T===null)j.componentDidMount();else{var D=m.elementType===m.type?T.memoizedProps:Fi(m.type,T.memoizedProps);j.componentDidUpdate(D,T.memoizedState,j.__reactInternalSnapshotBeforeUpdate)}var U=m.updateQueue;U!==null&&q4(m,U,j);break;case 3:var fe=m.updateQueue;if(fe!==null){if(T=null,m.child!==null)switch(m.child.tag){case 5:T=z(m.child.stateNode);break;case 1:T=m.child.stateNode}q4(m,fe,T)}break;case 5:var je=m.stateNode;T===null&&m.flags&4&&nt(je,m.type,m.memoizedProps,m);break;case 6:break;case 4:break;case 12:break;case 13:if(Ee&&m.memoizedState===null){var ze=m.alternate;if(ze!==null){var _t=ze.memoizedState;if(_t!==null){var Lt=_t.dehydrated;Lt!==null&&B(Lt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Rs||m.flags&512&&Ow(m)}catch(sr){nn(m,m.return,sr)}}if(m===f){It=null;break}if(T=m.sibling,T!==null){T.return=m.return,It=T;break}It=m.return}}function JE(f){for(;It!==null;){var m=It;if(m===f){It=null;break}var T=m.sibling;if(T!==null){T.return=m.return,It=T;break}It=m.return}}function QE(f){for(;It!==null;){var m=It;try{switch(m.tag){case 0:case 11:case 15:var T=m.return;try{dp(4,m)}catch(ze){nn(m,T,ze)}break;case 1:var j=m.stateNode;if(typeof j.componentDidMount=="function"){var D=m.return;try{j.componentDidMount()}catch(ze){nn(m,D,ze)}}var U=m.return;try{Ow(m)}catch(ze){nn(m,U,ze)}break;case 5:var fe=m.return;try{Ow(m)}catch(ze){nn(m,fe,ze)}}}catch(ze){nn(m,m.return,ze)}if(m===f){It=null;break}var je=m.sibling;if(je!==null){je.return=m.return,It=je;break}It=m.return}}var fp=0,hp=1,gp=2,mp=3,pp=4;if(typeof Symbol=="function"&&Symbol.for){var Yh=Symbol.for;fp=Yh("selector.component"),hp=Yh("selector.has_pseudo_class"),gp=Yh("selector.role"),mp=Yh("selector.test_id"),pp=Yh("selector.text")}function $w(f){var m=ke(f);if(m!=null){if(typeof m.memoizedProps["data-testname"]!="string")throw Error(i(364));return m}if(f=Re(f),f===null)throw Error(i(362));return f.stateNode.current}function Ww(f,m){switch(m.$$typeof){case fp:if(f.type===m.value)return!0;break;case hp:e:{m=m.value,f=[f,0];for(var T=0;T<f.length;){var j=f[T++],D=f[T++],U=m[D];if(j.tag!==5||!Ge(j)){for(;U!=null&&Ww(j,U);)D++,U=m[D];if(D===m.length){m=!0;break e}else for(j=j.child;j!==null;)f.push(j,D),j=j.sibling}}m=!1}return m;case gp:if(f.tag===5&&ht(f.stateNode,m.value))return!0;break;case pp:if((f.tag===5||f.tag===6)&&(f=Be(f),f!==null&&0<=f.indexOf(m.value)))return!0;break;case mp:if(f.tag===5&&(f=f.memoizedProps["data-testname"],typeof f=="string"&&f.toLowerCase()===m.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function Hw(f){switch(f.$$typeof){case fp:return"<"+(A(f.value)||"Unknown")+">";case hp:return":has("+(Hw(f)||"")+")";case gp:return'[role="'+f.value+'"]';case pp:return'"'+f.value+'"';case mp:return'[data-testname="'+f.value+'"]';default:throw Error(i(365))}}function qE(f,m){var T=[];f=[f,0];for(var j=0;j<f.length;){var D=f[j++],U=f[j++],fe=m[U];if(D.tag!==5||!Ge(D)){for(;fe!=null&&Ww(D,fe);)U++,fe=m[U];if(U===m.length)T.push(D);else for(D=D.child;D!==null;)f.push(D,U),D=D.sibling}}return T}function zw(f,m){if(!Pe)throw Error(i(363));f=$w(f),f=qE(f,m),m=[],f=Array.from(f);for(var T=0;T<f.length;){var j=f[T++];if(j.tag===5)Ge(j)||m.push(j.stateNode);else for(j=j.child;j!==null;)f.push(j),j=j.sibling}return m}var RL=Math.ceil,xp=o.ReactCurrentDispatcher,Gw=o.ReactCurrentOwner,Pn=o.ReactCurrentBatchConfig,hr=0,ls=null,Un=null,vs=0,Ra=0,Rd=Ht(0),Jn=0,Jh=null,qc=0,yp=0,Vw=0,Qh=null,pa=null,Kw=0,Xw=1/0,Vo=null;function Md(){Xw=is()+500}var vp=!1,Yw=null,Ml=null,wp=!1,Il=null,_p=0,qh=0,Jw=null,bp=-1,Sp=0;function Ms(){return hr&6?is():bp!==-1?bp:bp=is()}function Ol(f){return f.mode&1?hr&2&&vs!==0?vs&-vs:pL.transition!==null?(Sp===0&&(Sp=I4()),Sp):(f=Cr,f!==0?f:at()):1}function ri(f,m,T,j){if(50<qh)throw qh=0,Jw=null,Error(i(185));Ih(f,T,j),(!(hr&2)||f!==ls)&&(f===ls&&(!(hr&2)&&(yp|=T),Jn===4&&Ll(f,vs)),xa(f,j),T===1&&hr===0&&!(m.mode&1)&&(Md(),Hm&&io()))}function xa(f,m){var T=f.callbackNode;oL(f,m);var j=$m(f,f===ls?vs:0);if(j===0)T!==null&&L4(T),f.callbackNode=null,f.callbackPriority=0;else if(m=j&-j,f.callbackPriority!==m){if(T!=null&&L4(T),m===1)f.tag===0?mL(e3.bind(null,f)):B4(e3.bind(null,f)),Ft?Ut(function(){!(hr&6)&&io()}):Zv(ew,io),T=null;else{switch(O4(j)){case 1:T=ew;break;case 4:T=dL;break;case 16:T=tw;break;case 536870912:T=fL;break;default:T=tw}T=c3(T,ZE.bind(null,f))}f.callbackPriority=m,f.callbackNode=T}}function ZE(f,m){if(bp=-1,Sp=0,hr&6)throw Error(i(327));var T=f.callbackNode;if(tu()&&f.callbackNode!==T)return null;var j=$m(f,f===ls?vs:0);if(j===0)return null;if(j&30||j&f.expiredLanes||m)m=kp(f,j);else{m=j;var D=hr;hr|=2;var U=n3();(ls!==f||vs!==m)&&(Vo=null,Md(),Zc(f,m));do try{OL();break}catch(je){r3(f,je)}while(!0);cw(),xp.current=U,hr=D,Un!==null?m=0:(ls=null,vs=0,m=Jn)}if(m!==0){if(m===2&&(D=Jv(f),D!==0&&(j=D,m=Qw(f,D))),m===1)throw T=Jh,Zc(f,0),Ll(f,j),xa(f,is()),T;if(m===6)Ll(f,j);else{if(D=f.current.alternate,!(j&30)&&!ML(D)&&(m=kp(f,j),m===2&&(U=Jv(f),U!==0&&(j=U,m=Qw(f,U))),m===1))throw T=Jh,Zc(f,0),Ll(f,j),xa(f,is()),T;switch(f.finishedWork=D,f.finishedLanes=j,m){case 0:case 1:throw Error(i(345));case 2:eu(f,pa,Vo);break;case 3:if(Ll(f,j),(j&130023424)===j&&(m=Kw+500-is(),10<m)){if($m(f,0)!==0)break;if(D=f.suspendedLanes,(D&j)!==j){Ms(),f.pingedLanes|=f.suspendedLanes&D;break}f.timeoutHandle=J(eu.bind(null,f,pa,Vo),m);break}eu(f,pa,Vo);break;case 4:if(Ll(f,j),(j&4194240)===j)break;for(m=f.eventTimes,D=-1;0<j;){var fe=31-ga(j);U=1<<fe,fe=m[fe],fe>D&&(D=fe),j&=~U}if(j=D,j=is()-j,j=(120>j?120:480>j?480:1080>j?1080:1920>j?1920:3e3>j?3e3:4320>j?4320:1960*RL(j/1960))-j,10<j){f.timeoutHandle=J(eu.bind(null,f,pa,Vo),j);break}eu(f,pa,Vo);break;case 5:eu(f,pa,Vo);break;default:throw Error(i(329))}}}return xa(f,is()),f.callbackNode===T?ZE.bind(null,f):null}function Qw(f,m){var T=Qh;return f.current.memoizedState.isDehydrated&&(Zc(f,m).flags|=256),f=kp(f,m),f!==2&&(m=pa,pa=T,m!==null&&qw(m)),f}function qw(f){pa===null?pa=f:pa.push.apply(pa,f)}function ML(f){for(var m=f;;){if(m.flags&16384){var T=m.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var j=0;j<T.length;j++){var D=T[j],U=D.getSnapshot;D=D.value;try{if(!Ai(U(),D))return!1}catch{return!1}}}if(T=m.child,m.subtreeFlags&16384&&T!==null)T.return=m,m=T;else{if(m===f)break;for(;m.sibling===null;){if(m.return===null||m.return===f)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Ll(f,m){for(m&=~Vw,m&=~yp,f.suspendedLanes|=m,f.pingedLanes&=~m,f=f.expirationTimes;0<m;){var T=31-ga(m),j=1<<T;f[T]=-1,m&=~j}}function e3(f){if(hr&6)throw Error(i(327));tu();var m=$m(f,0);if(!(m&1))return xa(f,is()),null;var T=kp(f,m);if(f.tag!==0&&T===2){var j=Jv(f);j!==0&&(m=j,T=Qw(f,j))}if(T===1)throw T=Jh,Zc(f,0),Ll(f,m),xa(f,is()),T;if(T===6)throw Error(i(345));return f.finishedWork=f.current.alternate,f.finishedLanes=m,eu(f,pa,Vo),xa(f,is()),null}function t3(f){Il!==null&&Il.tag===0&&!(hr&6)&&tu();var m=hr;hr|=1;var T=Pn.transition,j=Cr;try{if(Pn.transition=null,Cr=1,f)return f()}finally{Cr=j,Pn.transition=T,hr=m,!(hr&6)&&io()}}function Zw(){Ra=Rd.current,Pt(Rd)}function Zc(f,m){f.finishedWork=null,f.finishedLanes=0;var T=f.timeoutHandle;if(T!==ve&&(f.timeoutHandle=ve,re(T)),Un!==null)for(T=Un.return;T!==null;){var j=T;switch(sw(j),j.tag){case 1:j=j.type.childContextTypes,j!=null&&bn();break;case 3:Fd(),Pt(tt),Pt(_e),xw();break;case 5:mw(j);break;case 4:Fd();break;case 13:Pt(un);break;case 19:Pt(un);break;case 10:uw(j.type._context);break;case 22:case 23:Zw()}T=T.return}if(ls=f,Un=f=Bl(f.current,null),vs=Ra=m,Jn=0,Jh=null,Vw=yp=qc=0,pa=Qh=null,Jc!==null){for(m=0;m<Jc.length;m++)if(T=Jc[m],j=T.interleaved,j!==null){T.interleaved=null;var D=j.next,U=T.pending;if(U!==null){var fe=U.next;U.next=D,j.next=fe}T.pending=j}Jc=null}return f}function r3(f,m){do{var T=Un;try{if(cw(),ep.current=sp,tp){for(var j=dn.memoizedState;j!==null;){var D=j.queue;D!==null&&(D.pending=null),j=j.next}tp=!1}if(Qc=0,os=Yn=dn=null,$h=!1,Wh=0,Gw.current=null,T===null||T.return===null){Jn=1,Jh=m,Un=null;break}e:{var U=f,fe=T.return,je=T,ze=m;if(m=vs,je.flags|=32768,ze!==null&&typeof ze=="object"&&typeof ze.then=="function"){var _t=ze,Lt=je,sr=Lt.tag;if(!(Lt.mode&1)&&(sr===0||sr===11||sr===15)){var Dt=Lt.alternate;Dt?(Lt.updateQueue=Dt.updateQueue,Lt.memoizedState=Dt.memoizedState,Lt.lanes=Dt.lanes):(Lt.updateQueue=null,Lt.memoizedState=null)}var Kr=EE(fe);if(Kr!==null){Kr.flags&=-257,NE(Kr,fe,je,U,m),Kr.mode&1&&TE(U,_t,m),m=Kr,ze=_t;var Wr=m.updateQueue;if(Wr===null){var ya=new Set;ya.add(ze),m.updateQueue=ya}else Wr.add(ze);break e}else{if(!(m&1)){TE(U,_t,m),e_();break e}ze=Error(i(426))}}else if(rn&&je.mode&1){var Ko=EE(fe);if(Ko!==null){!(Ko.flags&65536)&&(Ko.flags|=256),NE(Ko,fe,je,U,m),ow(Pd(ze,je));break e}}U=ze=Pd(ze,je),Jn!==4&&(Jn=2),Qh===null?Qh=[U]:Qh.push(U),U=fe;do{switch(U.tag){case 3:U.flags|=65536,m&=-m,U.lanes|=m;var We=kE(U,ze,m);Q4(U,We);break e;case 1:je=ze;var De=U.type,Xe=U.stateNode;if(!(U.flags&128)&&(typeof De.getDerivedStateFromError=="function"||Xe!==null&&typeof Xe.componentDidCatch=="function"&&(Ml===null||!Ml.has(Xe)))){U.flags|=65536,m&=-m,U.lanes|=m;var Rt=CE(U,je,m);Q4(U,Rt);break e}}U=U.return}while(U!==null)}a3(T)}catch(Vt){m=Vt,Un===T&&T!==null&&(Un=T=T.return);continue}break}while(!0)}function n3(){var f=xp.current;return xp.current=sp,f===null?sp:f}function e_(){(Jn===0||Jn===3||Jn===2)&&(Jn=4),ls===null||!(qc&268435455)&&!(yp&268435455)||Ll(ls,vs)}function kp(f,m){var T=hr;hr|=2;var j=n3();(ls!==f||vs!==m)&&(Vo=null,Zc(f,m));do try{IL();break}catch(D){r3(f,D)}while(!0);if(cw(),hr=T,xp.current=j,Un!==null)throw Error(i(261));return ls=null,vs=0,Jn}function IL(){for(;Un!==null;)s3(Un)}function OL(){for(;Un!==null&&!cL();)s3(Un)}function s3(f){var m=l3(f.alternate,f,Ra);f.memoizedProps=f.pendingProps,m===null?a3(f):Un=m,Gw.current=null}function a3(f){var m=f;do{var T=m.alternate;if(f=m.return,m.flags&32768){if(T=jL(T,m),T!==null){T.flags&=32767,Un=T;return}if(f!==null)f.flags|=32768,f.subtreeFlags=0,f.deletions=null;else{Jn=6,Un=null;return}}else if(T=AL(T,m,Ra),T!==null){Un=T;return}if(m=m.sibling,m!==null){Un=m;return}Un=m=f}while(m!==null);Jn===0&&(Jn=5)}function eu(f,m,T){var j=Cr,D=Pn.transition;try{Pn.transition=null,Cr=1,LL(f,m,T,j)}finally{Pn.transition=D,Cr=j}return null}function LL(f,m,T,j){do tu();while(Il!==null);if(hr&6)throw Error(i(327));T=f.finishedWork;var D=f.finishedLanes;if(T===null)return null;if(f.finishedWork=null,f.finishedLanes=0,T===f.current)throw Error(i(177));f.callbackNode=null,f.callbackPriority=0;var U=T.lanes|T.childLanes;if(lL(f,U),f===ls&&(Un=ls=null,vs=0),!(T.subtreeFlags&2064)&&!(T.flags&2064)||wp||(wp=!0,c3(tw,function(){return tu(),null})),U=(T.flags&15990)!==0,T.subtreeFlags&15990||U){U=Pn.transition,Pn.transition=null;var fe=Cr;Cr=1;var je=hr;hr|=4,Gw.current=null,PL(f,T),KE(T,f),X(f.containerInfo),f.current=T,DL(T),uL(),hr=je,Cr=fe,Pn.transition=U}else f.current=T;if(wp&&(wp=!1,Il=f,_p=D),U=f.pendingLanes,U===0&&(Ml=null),hL(T.stateNode),xa(f,is()),m!==null)for(j=f.onRecoverableError,T=0;T<m.length;T++)D=m[T],j(D.value,{componentStack:D.stack,digest:D.digest});if(vp)throw vp=!1,f=Yw,Yw=null,f;return _p&1&&f.tag!==0&&tu(),U=f.pendingLanes,U&1?f===Jw?qh++:(qh=0,Jw=f):qh=0,io(),null}function tu(){if(Il!==null){var f=O4(_p),m=Pn.transition,T=Cr;try{if(Pn.transition=null,Cr=16>f?16:f,Il===null)var j=!1;else{if(f=Il,Il=null,_p=0,hr&6)throw Error(i(331));var D=hr;for(hr|=4,It=f.current;It!==null;){var U=It,fe=U.child;if(It.flags&16){var je=U.deletions;if(je!==null){for(var ze=0;ze<je.length;ze++){var _t=je[ze];for(It=_t;It!==null;){var Lt=It;switch(Lt.tag){case 0:case 11:case 15:Xh(8,Lt,U)}var sr=Lt.child;if(sr!==null)sr.return=Lt,It=sr;else for(;It!==null;){Lt=It;var Dt=Lt.sibling,Kr=Lt.return;if(HE(Lt),Lt===_t){It=null;break}if(Dt!==null){Dt.return=Kr,It=Dt;break}It=Kr}}}var Wr=U.alternate;if(Wr!==null){var ya=Wr.child;if(ya!==null){Wr.child=null;do{var Ko=ya.sibling;ya.sibling=null,ya=Ko}while(ya!==null)}}It=U}}if(U.subtreeFlags&2064&&fe!==null)fe.return=U,It=fe;else e:for(;It!==null;){if(U=It,U.flags&2048)switch(U.tag){case 0:case 11:case 15:Xh(9,U,U.return)}var We=U.sibling;if(We!==null){We.return=U.return,It=We;break e}It=U.return}}var De=f.current;for(It=De;It!==null;){fe=It;var Xe=fe.child;if(fe.subtreeFlags&2064&&Xe!==null)Xe.return=fe,It=Xe;else e:for(fe=De;It!==null;){if(je=It,je.flags&2048)try{switch(je.tag){case 0:case 11:case 15:dp(9,je)}}catch(Vt){nn(je,je.return,Vt)}if(je===fe){It=null;break e}var Rt=je.sibling;if(Rt!==null){Rt.return=je.return,It=Rt;break e}It=je.return}}if(hr=D,io(),ao&&typeof ao.onPostCommitFiberRoot=="function")try{ao.onPostCommitFiberRoot(Wm,f)}catch{}j=!0}return j}finally{Cr=T,Pn.transition=m}}return!1}function i3(f,m,T){m=Pd(T,m),m=kE(f,m,1),f=Rl(f,m,1),m=Ms(),f!==null&&(Ih(f,1,m),xa(f,m))}function nn(f,m,T){if(f.tag===3)i3(f,f,T);else for(;m!==null;){if(m.tag===3){i3(m,f,T);break}else if(m.tag===1){var j=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof j.componentDidCatch=="function"&&(Ml===null||!Ml.has(j))){f=Pd(T,f),f=CE(m,f,1),m=Rl(m,f,1),f=Ms(),m!==null&&(Ih(m,1,f),xa(m,f));break}}m=m.return}}function BL(f,m,T){var j=f.pingCache;j!==null&&j.delete(m),m=Ms(),f.pingedLanes|=f.suspendedLanes&T,ls===f&&(vs&T)===T&&(Jn===4||Jn===3&&(vs&130023424)===vs&&500>is()-Kw?Zc(f,0):Vw|=T),xa(f,m)}function o3(f,m){m===0&&(f.mode&1?(m=Um,Um<<=1,!(Um&130023424)&&(Um=4194304)):m=1);var T=Ms();f=oo(f,m),f!==null&&(Ih(f,m,T),xa(f,T))}function UL(f){var m=f.memoizedState,T=0;m!==null&&(T=m.retryLane),o3(f,T)}function $L(f,m){var T=0;switch(f.tag){case 13:var j=f.stateNode,D=f.memoizedState;D!==null&&(T=D.retryLane);break;case 19:j=f.stateNode;break;default:throw Error(i(314))}j!==null&&j.delete(m),o3(f,T)}var l3;l3=function(f,m,T){if(f!==null)if(f.memoizedProps!==m.pendingProps||tt.current)ma=!0;else{if(!(f.lanes&T)&&!(m.flags&128))return ma=!1,NL(f,m,T);ma=!!(f.flags&131072)}else ma=!1,rn&&m.flags&1048576&&U4(m,Gm,m.index);switch(m.lanes=0,m.tag){case 2:var j=m.type;op(f,m),f=m.pendingProps;var D=Gt(m,_e.current);Ad(m,T),D=ww(null,m,j,f,D,T);var U=_w();return m.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,nr(j)?(U=!0,ha(m)):U=!1,m.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,hw(m),D.updater=ap,m.stateNode=D,D._reactInternals=m,Ew(m,j,f,T),m=Fw(null,m,j,!0,U,T)):(m.tag=0,rn&&U&&nw(m),ta(null,m,D,T),m=m.child),m;case 16:j=m.elementType;e:{switch(op(f,m),f=m.pendingProps,D=j._init,j=D(j._payload),m.type=j,D=m.tag=HL(j),f=Fi(j,f),D){case 0:m=jw(null,m,j,f,T);break e;case 1:m=RE(null,m,j,f,T);break e;case 11:m=AE(null,m,j,f,T);break e;case 14:m=jE(null,m,j,Fi(j.type,f),T);break e}throw Error(i(306,j,""))}return m;case 0:return j=m.type,D=m.pendingProps,D=m.elementType===j?D:Fi(j,D),jw(f,m,j,D,T);case 1:return j=m.type,D=m.pendingProps,D=m.elementType===j?D:Fi(j,D),RE(f,m,j,D,T);case 3:e:{if(ME(m),f===null)throw Error(i(387));j=m.pendingProps,U=m.memoizedState,D=U.element,J4(f,m),qm(m,j,null,T);var fe=m.memoizedState;if(j=fe.element,Ee&&U.isDehydrated)if(U={element:j,isDehydrated:!1,cache:fe.cache,pendingSuspenseBoundaries:fe.pendingSuspenseBoundaries,transitions:fe.transitions},m.updateQueue.baseState=U,m.memoizedState=U,m.flags&256){D=Pd(Error(i(423)),m),m=IE(f,m,j,T,D);break e}else if(j!==D){D=Pd(Error(i(424)),m),m=IE(f,m,j,T,D);break e}else for(Ee&&(qa=ue(m.stateNode.containerInfo),Da=m,rn=!0,ji=null,Oh=!1),T=K4(m,null,j,T),m.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(Td(),j===D){m=Go(f,m,T);break e}ta(f,m,j,T)}m=m.child}return m;case 5:return Z4(m),f===null&&iw(m),j=m.type,D=m.pendingProps,U=f!==null?f.memoizedProps:null,fe=D.children,Q(j,D)?fe=null:U!==null&&Q(j,U)&&(m.flags|=32),DE(f,m),ta(f,m,fe,T),m.child;case 6:return f===null&&iw(m),null;case 13:return OE(f,m,T);case 4:return gw(m,m.stateNode.containerInfo),j=m.pendingProps,f===null?m.child=Ed(m,null,j,T):ta(f,m,j,T),m.child;case 11:return j=m.type,D=m.pendingProps,D=m.elementType===j?D:Fi(j,D),AE(f,m,j,D,T);case 7:return ta(f,m,m.pendingProps,T),m.child;case 8:return ta(f,m,m.pendingProps.children,T),m.child;case 12:return ta(f,m,m.pendingProps.children,T),m.child;case 10:e:{if(j=m.type._context,D=m.pendingProps,U=m.memoizedProps,fe=D.value,X4(m,j,fe),U!==null)if(Ai(U.value,fe)){if(U.children===D.children&&!tt.current){m=Go(f,m,T);break e}}else for(U=m.child,U!==null&&(U.return=m);U!==null;){var je=U.dependencies;if(je!==null){fe=U.child;for(var ze=je.firstContext;ze!==null;){if(ze.context===j){if(U.tag===1){ze=zo(-1,T&-T),ze.tag=2;var _t=U.updateQueue;if(_t!==null){_t=_t.shared;var Lt=_t.pending;Lt===null?ze.next=ze:(ze.next=Lt.next,Lt.next=ze),_t.pending=ze}}U.lanes|=T,ze=U.alternate,ze!==null&&(ze.lanes|=T),dw(U.return,T,m),je.lanes|=T;break}ze=ze.next}}else if(U.tag===10)fe=U.type===m.type?null:U.child;else if(U.tag===18){if(fe=U.return,fe===null)throw Error(i(341));fe.lanes|=T,je=fe.alternate,je!==null&&(je.lanes|=T),dw(fe,T,m),fe=U.sibling}else fe=U.child;if(fe!==null)fe.return=U;else for(fe=U;fe!==null;){if(fe===m){fe=null;break}if(U=fe.sibling,U!==null){U.return=fe.return,fe=U;break}fe=fe.return}U=fe}ta(f,m,D.children,T),m=m.child}return m;case 9:return D=m.type,j=m.pendingProps.children,Ad(m,T),D=Za(D),j=j(D),m.flags|=1,ta(f,m,j,T),m.child;case 14:return j=m.type,D=Fi(j,m.pendingProps),D=Fi(j.type,D),jE(f,m,j,D,T);case 15:return FE(f,m,m.type,m.pendingProps,T);case 17:return j=m.type,D=m.pendingProps,D=m.elementType===j?D:Fi(j,D),op(f,m),m.tag=1,nr(j)?(f=!0,ha(m)):f=!1,Ad(m,T),bE(m,j,D),Ew(m,j,D,T),Fw(null,m,j,!0,f,T);case 19:return BE(f,m,T);case 22:return PE(f,m,T)}throw Error(i(156,m.tag))};function c3(f,m){return Zv(f,m)}function WL(f,m,T,j){this.tag=f,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=j,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ni(f,m,T,j){return new WL(f,m,T,j)}function t_(f){return f=f.prototype,!(!f||!f.isReactComponent)}function HL(f){if(typeof f=="function")return t_(f)?1:0;if(f!=null){if(f=f.$$typeof,f===v)return 11;if(f===_)return 14}return 2}function Bl(f,m){var T=f.alternate;return T===null?(T=ni(f.tag,m,f.key,f.mode),T.elementType=f.elementType,T.type=f.type,T.stateNode=f.stateNode,T.alternate=f,f.alternate=T):(T.pendingProps=m,T.type=f.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=f.flags&14680064,T.childLanes=f.childLanes,T.lanes=f.lanes,T.child=f.child,T.memoizedProps=f.memoizedProps,T.memoizedState=f.memoizedState,T.updateQueue=f.updateQueue,m=f.dependencies,T.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},T.sibling=f.sibling,T.index=f.index,T.ref=f.ref,T}function Cp(f,m,T,j,D,U){var fe=2;if(j=f,typeof f=="function")t_(f)&&(fe=1);else if(typeof f=="string")fe=5;else e:switch(f){case d:return ru(T.children,D,U,m);case g:fe=8,D|=8;break;case h:return f=ni(12,T,m,D|2),f.elementType=h,f.lanes=U,f;case w:return f=ni(13,T,m,D),f.elementType=w,f.lanes=U,f;case S:return f=ni(19,T,m,D),f.elementType=S,f.lanes=U,f;case k:return Tp(T,D,U,m);default:if(typeof f=="object"&&f!==null)switch(f.$$typeof){case p:fe=10;break e;case x:fe=9;break e;case v:fe=11;break e;case _:fe=14;break e;case y:fe=16,j=null;break e}throw Error(i(130,f==null?f:typeof f,""))}return m=ni(fe,T,m,D),m.elementType=f,m.type=j,m.lanes=U,m}function ru(f,m,T,j){return f=ni(7,f,j,m),f.lanes=T,f}function Tp(f,m,T,j){return f=ni(22,f,j,m),f.elementType=k,f.lanes=T,f.stateNode={isHidden:!1},f}function r_(f,m,T){return f=ni(6,f,null,m),f.lanes=T,f}function n_(f,m,T){return m=ni(4,f.children!==null?f.children:[],f.key,m),m.lanes=T,m.stateNode={containerInfo:f.containerInfo,pendingChildren:null,implementation:f.implementation},m}function zL(f,m,T,j,D){this.tag=m,this.containerInfo=f,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ve,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qv(0),this.expirationTimes=Qv(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qv(0),this.identifierPrefix=j,this.onRecoverableError=D,Ee&&(this.mutableSourceEagerHydrationData=null)}function u3(f,m,T,j,D,U,fe,je,ze){return f=new zL(f,m,T,je,ze),m===1?(m=1,U===!0&&(m|=8)):m=0,U=ni(3,null,null,m),f.current=U,U.stateNode=f,U.memoizedState={element:j,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},hw(U),f}function d3(f){if(!f)return W;f=f._reactInternals;e:{if(F(f)!==f||f.tag!==1)throw Error(i(170));var m=f;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(nr(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(i(171))}if(f.tag===1){var T=f.type;if(nr(T))return Ya(f,T,m)}return m}function f3(f){var m=f._reactInternals;if(m===void 0)throw typeof f.render=="function"?Error(i(188)):(f=Object.keys(f).join(","),Error(i(268,f)));return f=I(m),f===null?null:f.stateNode}function h3(f,m){if(f=f.memoizedState,f!==null&&f.dehydrated!==null){var T=f.retryLane;f.retryLane=T!==0&&T<m?T:m}}function Ep(f,m){h3(f,m),(f=f.alternate)&&h3(f,m)}function GL(f){return f=I(f),f===null?null:f.stateNode}function VL(){return null}return r.attemptContinuousHydration=function(f){if(f.tag===13){var m=oo(f,134217728);if(m!==null){var T=Ms();ri(m,f,134217728,T)}Ep(f,134217728)}},r.attemptDiscreteHydration=function(f){if(f.tag===13){var m=oo(f,1);if(m!==null){var T=Ms();ri(m,f,1,T)}Ep(f,1)}},r.attemptHydrationAtCurrentPriority=function(f){if(f.tag===13){var m=Ol(f),T=oo(f,m);if(T!==null){var j=Ms();ri(T,f,m,j)}Ep(f,m)}},r.attemptSynchronousHydration=function(f){switch(f.tag){case 3:var m=f.stateNode;if(m.current.memoizedState.isDehydrated){var T=Mh(m.pendingLanes);T!==0&&(qv(m,T|1),xa(m,is()),!(hr&6)&&(Md(),io()))}break;case 13:t3(function(){var j=oo(f,1);if(j!==null){var D=Ms();ri(j,f,1,D)}}),Ep(f,1)}},r.batchedUpdates=function(f,m){var T=hr;hr|=1;try{return f(m)}finally{hr=T,hr===0&&(Md(),Hm&&io())}},r.createComponentSelector=function(f){return{$$typeof:fp,value:f}},r.createContainer=function(f,m,T,j,D,U,fe){return u3(f,m,!1,null,T,j,D,U,fe)},r.createHasPseudoClassSelector=function(f){return{$$typeof:hp,value:f}},r.createHydrationContainer=function(f,m,T,j,D,U,fe,je,ze){return f=u3(T,j,!0,f,D,U,fe,je,ze),f.context=d3(null),T=f.current,j=Ms(),D=Ol(T),U=zo(j,D),U.callback=m??null,Rl(T,U,D),f.current.lanes=D,Ih(f,D,j),xa(f,j),f},r.createPortal=function(f,m,T){var j=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:j==null?null:""+j,children:f,containerInfo:m,implementation:T}},r.createRoleSelector=function(f){return{$$typeof:gp,value:f}},r.createTestNameSelector=function(f){return{$$typeof:mp,value:f}},r.createTextSelector=function(f){return{$$typeof:pp,value:f}},r.deferredUpdates=function(f){var m=Cr,T=Pn.transition;try{return Pn.transition=null,Cr=16,f()}finally{Cr=m,Pn.transition=T}},r.discreteUpdates=function(f,m,T,j,D){var U=Cr,fe=Pn.transition;try{return Pn.transition=null,Cr=1,f(m,T,j,D)}finally{Cr=U,Pn.transition=fe,hr===0&&Md()}},r.findAllNodes=zw,r.findBoundingRects=function(f,m){if(!Pe)throw Error(i(363));m=zw(f,m),f=[];for(var T=0;T<m.length;T++)f.push($e(m[T]));for(m=f.length-1;0<m;m--){T=f[m];for(var j=T.x,D=j+T.width,U=T.y,fe=U+T.height,je=m-1;0<=je;je--)if(m!==je){var ze=f[je],_t=ze.x,Lt=_t+ze.width,sr=ze.y,Dt=sr+ze.height;if(j>=_t&&U>=sr&&D<=Lt&&fe<=Dt){f.splice(m,1);break}else if(j!==_t||T.width!==ze.width||Dt<U||sr>fe){if(!(U!==sr||T.height!==ze.height||Lt<j||_t>D)){_t>j&&(ze.width+=_t-j,ze.x=j),Lt<D&&(ze.width=D-_t),f.splice(m,1);break}}else{sr>U&&(ze.height+=sr-U,ze.y=U),Dt<fe&&(ze.height=fe-sr),f.splice(m,1);break}}}return f},r.findHostInstance=f3,r.findHostInstanceWithNoPortals=function(f){return f=M(f),f=f!==null?se(f):null,f===null?null:f.stateNode},r.findHostInstanceWithWarning=function(f){return f3(f)},r.flushControlled=function(f){var m=hr;hr|=1;var T=Pn.transition,j=Cr;try{Pn.transition=null,Cr=1,f()}finally{Cr=j,Pn.transition=T,hr=m,hr===0&&(Md(),io())}},r.flushPassiveEffects=tu,r.flushSync=t3,r.focusWithin=function(f,m){if(!Pe)throw Error(i(363));for(f=$w(f),m=qE(f,m),m=Array.from(m),f=0;f<m.length;){var T=m[f++];if(!Ge(T)){if(T.tag===5&&Nt(T.stateNode))return!0;for(T=T.child;T!==null;)m.push(T),T=T.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Cr},r.getFindAllNodesFailureDescription=function(f,m){if(!Pe)throw Error(i(363));var T=0,j=[];f=[$w(f),0];for(var D=0;D<f.length;){var U=f[D++],fe=f[D++],je=m[fe];if((U.tag!==5||!Ge(U))&&(Ww(U,je)&&(j.push(Hw(je)),fe++,fe>T&&(T=fe)),fe<m.length))for(U=U.child;U!==null;)f.push(U,fe),U=U.sibling}if(T<m.length){for(f=[];T<m.length;T++)f.push(Hw(m[T]));return`findAllNodes was able to match part of the selector:
  `+(j.join(" > ")+`

No matching component was found for:
  `)+f.join(" > ")}return null},r.getPublicRootInstance=function(f){if(f=f.current,!f.child)return null;switch(f.child.tag){case 5:return z(f.child.stateNode);default:return f.child.stateNode}},r.injectIntoDevTools=function(f){if(f={bundleType:f.bundleType,version:f.version,rendererPackageName:f.rendererPackageName,rendererConfig:f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:GL,findFiberByHostInstance:f.findFiberByHostInstance||VL,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")f=!1;else{var m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(m.isDisabled||!m.supportsFiber)f=!0;else{try{Wm=m.inject(f),ao=m}catch{}f=!!m.checkDCE}}return f},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(f,m,T,j){if(!Pe)throw Error(i(363));f=zw(f,m);var D=Ye(f,T,j).disconnect;return{disconnect:function(){D()}}},r.registerMutableSourceForHydration=function(f,m){var T=m._getVersion;T=T(m._source),f.mutableSourceEagerHydrationData==null?f.mutableSourceEagerHydrationData=[m,T]:f.mutableSourceEagerHydrationData.push(m,T)},r.runWithPriority=function(f,m){var T=Cr;try{return Cr=f,m()}finally{Cr=T}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(f,m,T,j){var D=m.current,U=Ms(),fe=Ol(D);return T=d3(T),m.context===null?m.context=T:m.pendingContext=T,m=zo(U,fe),m.payload={element:f},j=j===void 0?null:j,j!==null&&(m.callback=j),f=Rl(D,m,fe),f!==null&&(ri(f,D,fe,U),Qm(f,D,fe)),fe},r};w9.exports=ZJ;var eQ=w9.exports;const tQ=ly(eQ);var _9={exports:{}},gd={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */gd.ConcurrentRoot=1;gd.ContinuousEventPriority=4;gd.DefaultEventPriority=16;gd.DiscreteEventPriority=1;gd.IdleEventPriority=536870912;gd.LegacyRoot=0;_9.exports=gd;var b9=_9.exports;const b6={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let S6=!1,k6=!1;const qC=".react-konva-event";let S9=!1;function rQ(t){S9=t}const nQ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,sQ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,aQ={};function bv(t,e,r=aQ){if(!S6&&"zIndex"in e&&(console.warn(sQ),S6=!0),!k6&&e.draggable){var n=e.x!==void 0||e.y!==void 0,s=e.onDragEnd||e.onDragMove;n&&!s&&(console.warn(nQ),k6=!0)}for(var a in r)if(!b6[a]){var i=a.slice(0,2)==="on",o=r[a]!==e[a];if(i&&o){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),t.off(l,r[a])}var u=!e.hasOwnProperty(a);u&&t.setAttr(a,void 0)}var d=S9||e._useStrictMode,g={},h=!1;const p={};for(var a in e)if(!b6[a]){var i=a.slice(0,2)==="on",x=r[a]!==e[a];if(i&&x){var l=a.substr(2).toLowerCase();l.substr(0,7)==="content"&&(l="content"+l.substr(7,1).toUpperCase()+l.substr(8)),e[a]&&(p[l]=e[a])}!i&&(e[a]!==r[a]||d&&e[a]!==t.getAttr(a))&&(h=!0,g[a]=e[a])}h&&(t.setAttrs(g),Uc(t));for(var l in p)t.on(l+qC,p[l])}function Uc(t){if(!ur.Konva.autoDrawEnabled){var e=t.getLayer()||t.getStage();e&&e.batchDraw()}}const k9={},iQ={};Ag.Node.prototype._applyProps=bv;function oQ(t,e){if(typeof e=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${e}`);return}t.add(e),Uc(t)}function lQ(t,e,r){let n=Ag[t];n||(console.error(`Konva has no node with the type ${t}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${t}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Ag.Group);const s={},a={};for(var i in e){var o=i.slice(0,2)==="on";o?a[i]=e[i]:s[i]=e[i]}const l=new n(s);return bv(l,a),l}function cQ(t,e,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${t}"`)}function uQ(t,e,r){return!1}function dQ(t){return t}function fQ(){return null}function hQ(){return null}function gQ(t,e,r,n){return iQ}function mQ(){}function pQ(t){}function xQ(t,e){return!1}function yQ(){return k9}function vQ(){return k9}const wQ=setTimeout,_Q=clearTimeout,bQ=-1;function SQ(t,e){return!1}const kQ=!1,CQ=!0,TQ=!0;function EQ(t,e){e.parent===t?e.moveToTop():t.add(e),Uc(t)}function NQ(t,e){e.parent===t?e.moveToTop():t.add(e),Uc(t)}function C9(t,e,r){e._remove(),t.add(e),e.setZIndex(r.getZIndex()),Uc(t)}function AQ(t,e,r){C9(t,e,r)}function jQ(t,e){e.destroy(),e.off(qC),Uc(t)}function FQ(t,e){e.destroy(),e.off(qC),Uc(t)}function PQ(t,e,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function DQ(t,e,r){}function RQ(t,e,r,n,s){bv(t,s,n)}function MQ(t){t.hide(),Uc(t)}function IQ(t){}function OQ(t,e){(e.visible==null||e.visible)&&t.show()}function LQ(t,e){}function BQ(t){}function UQ(){}const $Q=()=>b9.DefaultEventPriority,WQ=Object.freeze(Object.defineProperty({__proto__:null,appendChild:EQ,appendChildToContainer:NQ,appendInitialChild:oQ,cancelTimeout:_Q,clearContainer:BQ,commitMount:DQ,commitTextUpdate:PQ,commitUpdate:RQ,createInstance:lQ,createTextInstance:cQ,detachDeletedInstance:UQ,finalizeInitialChildren:uQ,getChildHostContext:vQ,getCurrentEventPriority:$Q,getPublicInstance:dQ,getRootHostContext:yQ,hideInstance:MQ,hideTextInstance:IQ,idlePriority:N0.unstable_IdlePriority,insertBefore:C9,insertInContainerBefore:AQ,isPrimaryRenderer:kQ,noTimeout:bQ,now:N0.unstable_now,prepareForCommit:fQ,preparePortalMount:hQ,prepareUpdate:gQ,removeChild:jQ,removeChildFromContainer:FQ,resetAfterCommit:mQ,resetTextContent:pQ,run:N0.unstable_runWithPriority,scheduleTimeout:wQ,shouldDeprioritizeSubtree:xQ,shouldSetTextContent:SQ,supportsMutation:TQ,unhideInstance:OQ,unhideTextInstance:LQ,warnsIfNotActing:CQ},Symbol.toStringTag,{value:"Module"}));var HQ=Object.defineProperty,zQ=Object.defineProperties,GQ=Object.getOwnPropertyDescriptors,C6=Object.getOwnPropertySymbols,VQ=Object.prototype.hasOwnProperty,KQ=Object.prototype.propertyIsEnumerable,T6=(t,e,r)=>e in t?HQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,E6=(t,e)=>{for(var r in e||(e={}))VQ.call(e,r)&&T6(t,r,e[r]);if(C6)for(var r of C6(e))KQ.call(e,r)&&T6(t,r,e[r]);return t},XQ=(t,e)=>zQ(t,GQ(e)),N6,A6;typeof window<"u"&&((N6=window.document)!=null&&N6.createElement||((A6=window.navigator)==null?void 0:A6.product)==="ReactNative")?b.useLayoutEffect:b.useEffect;function T9(t,e,r){if(!t)return;if(r(t)===!0)return t;let n=t.child;for(;n;){const s=T9(n,e,r);if(s)return s;n=n.sibling}}function E9(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const j6=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=j6;return}return j6.apply(this,arguments)};const ZC=E9(b.createContext(null));class N9 extends b.Component{render(){return b.createElement(ZC.Provider,{value:this._reactInternals},this.props.children)}}function YQ(){const t=b.useContext(ZC);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=b.useId();return b.useMemo(()=>{for(const n of[t,t==null?void 0:t.alternate]){if(!n)continue;const s=T9(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===e)return!0;i=i.next}});if(s)return s}},[t,e])}function JQ(){const t=YQ(),[e]=b.useState(()=>new Map);e.clear();let r=t;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==ZC&&!e.has(s)&&e.set(s,b.useContext(E9(s)))}r=r.return}return e}function A9(){const t=JQ();return b.useMemo(()=>Array.from(t.keys()).reduce((e,r)=>n=>b.createElement(e,null,b.createElement(r.Provider,XQ(E6({},n),{value:t.get(r)}))),e=>b.createElement(N9,E6({},e))),[t])}function QQ(t){const e=Gn.useRef({});return Gn.useLayoutEffect(()=>{e.current=t}),Gn.useLayoutEffect(()=>()=>{e.current={}},[]),e.current}const qQ=t=>{const e=Gn.useRef(null),r=Gn.useRef(null),n=Gn.useRef(null),s=QQ(t),a=A9(),i=o=>{const{forwardedRef:l}=t;l&&(typeof l=="function"?l(o):l.current=o)};return Gn.useLayoutEffect(()=>(r.current=new Ag.Stage({width:t.width,height:t.height,container:e.current}),i(r.current),n.current=pf.createContainer(r.current,b9.LegacyRoot,!1,null),pf.updateContainer(Gn.createElement(a,{},t.children),n.current),()=>{Ag.isBrowser&&(i(null),pf.updateContainer(null,n.current,null),r.current.destroy())}),[]),Gn.useLayoutEffect(()=>{i(r.current),bv(r.current,t,s),pf.updateContainer(Gn.createElement(a,{},t.children),n.current,null)}),Gn.createElement("div",{ref:e,id:t.id,accessKey:t.accessKey,className:t.className,role:t.role,style:t.style,tabIndex:t.tabIndex,title:t.title})},Lu="Layer",ZQ="FastLayer",zi="Group",eq="Label",ms="Rect",hc="Circle",tq="Ellipse",rq="Wedge",Ss="Line",nq="Sprite",j9="Image",ko="Text",sq="TextPath",aq="Star",iq="Ring",oq="Arc",lq="Tag",cq="Path",uq="RegularPolygon",uS="Arrow",dq="Shape",F9="Transformer",fq="18.2.13",pf=tQ(WQ);pf.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Gn.version,rendererPackageName:"react-konva"});const Bu=Gn.forwardRef((t,e)=>Gn.createElement(N9,{},Gn.createElement(qQ,{...t,forwardedRef:e}))),hq=rQ,gq=Object.freeze(Object.defineProperty({__proto__:null,Arc:oq,Arrow:uS,Circle:hc,Ellipse:tq,FastLayer:ZQ,Group:zi,Image:j9,KonvaRenderer:pf,Label:eq,Layer:Lu,Line:Ss,Path:cq,Rect:ms,RegularPolygon:uq,Ring:iq,Shape:dq,Sprite:nq,Stage:Bu,Star:aq,Tag:lq,Text:ko,TextPath:sq,Transformer:F9,Wedge:rq,useContextBridge:A9,useStrictMode:hq,version:fq},Symbol.toStringTag,{value:"Module"})),it=({children:t,hover:e=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${e?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return c.jsx(Le.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:t})},mq=({children:t,className:e=""})=>c.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${e}`,children:t}),pq=({children:t,className:e=""})=>c.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${e}`,children:t}),xq=({children:t,className:e=""})=>c.jsx("div",{className:`py-4 ${e}`,children:t}),yq=({children:t,className:e=""})=>c.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${e}`,children:t});it.Header=mq;it.Title=pq;it.Body=xq;it.Footer=yq;const vq=t=>{const[e,r]=b.useState({width:800,height:600}),n=b.useRef(null),s=b.useCallback(()=>{if(t.current){t.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let l=a,u=l/o;u>i&&(u=i,l=u*o),r({width:l,height:u})}},[t]);return b.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:e,stageRef:n,updateCanvasSize:s}},dS={convertToOriginal:(t,e,r)=>r?{x:Number(((t-r.x)/r.scale).toFixed(4)),y:Number(((e-r.y)/r.scale).toFixed(4))}:{x:t,y:e},convertToCanvas:(t,e,r)=>r?{x:Number((r.x+t*r.scale).toFixed(4)),y:Number((r.y+e*r.scale).toFixed(4))}:{x:t,y:e},isPointInImage:(t,e)=>e?t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height:!1,calculateImageScale:(t,e)=>{if(!t||!e)return 1;const r=40,n=e.width-r,s=e.height-r;return Math.min(n/t.width,s/t.height)},calculateImageInfo:(t,e)=>{if(!t||!e)return null;const r=40,n=e.width-r,s=e.height-r,a=Math.min(n/t.width,s/t.height),i=t.width*a,o=t.height*a,l=(e.width-i)/2,u=(e.height-o)/2;return{x:l,y:u,width:i,height:o,scale:a,originalWidth:t.width,originalHeight:t.height}}},wq=(t,e)=>{const[r,n]=b.useState(null),s=b.useCallback((a,i)=>dS.calculateImageInfo(a,i),[]);return b.useEffect(()=>{if(t&&e){const a=s(t,e);n(a)}},[t,e,s]),r},_q=t=>{const e=b.useCallback((n,s)=>dS.convertToOriginal(n,s,t),[t]),r=b.useCallback((n,s)=>dS.convertToCanvas(n,s,t),[t]);return{convertToOriginal:e,convertToCanvas:r}},d0={create:(t,e,r,n,s)=>({id:s,x:t-r/2,y:e-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:t=>t.width>0&&t.height>0,findAtPosition:(t,e,r)=>t.find(n=>e>=n.x&&e<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},Vd={create:(t,e,r,n,s,a,i)=>({id:i,startX:t,startY:e,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(t,e,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,l=i.y+i.height/2,u=Math.sqrt(Math.pow(t-o,2)+Math.pow(e-l,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(t,e,r,n,s)=>Vd.snapToNearestBlock(t,e,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},n2={create:(t,e,r)=>({id:r,blockId:t,word:e}),update:(t,e,r)=>t.map(n=>n.blockId===e?{...n,word:r}:n),delete:(t,e)=>t.filter(r=>r.blockId!==e),generateId:t=>`word_${t}`,validate:t=>t&&t.trim().length>0},bq={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null}},Sq=(t,e)=>{switch(e.type){case"SET_CANVAS_SIZE":return{...t,canvas:{...t.canvas,size:e.payload}};case"SET_IMAGE":return{...t,canvas:{...t.canvas,image:e.payload}};case"SET_IMAGE_INFO":return{...t,canvas:{...t.canvas,imageInfo:e.payload}};case"SET_SELECTED_TOOL":return{...t,canvas:{...t.canvas,selectedTool:e.payload}};case"ADD_BLOCK":return{...t,testData:{...t.testData,blocks:[...t.testData.blocks,e.payload]}};case"ADD_WORD":return{...t,testData:{...t.testData,words:[...t.testData.words,e.payload]}};case"ADD_ARROW":return{...t,testData:{...t.testData,arrows:[...t.testData.arrows,e.payload]}};case"UPDATE_BLOCK":return{...t,testData:{...t.testData,blocks:t.testData.blocks.map(r=>r.id===e.payload.id?{...r,...e.payload.updates}:r)}};case"DELETE_BLOCK":return{...t,testData:{...t.testData,blocks:t.testData.blocks.filter(r=>r.id!==e.payload),words:t.testData.words.filter(r=>r.blockId!==e.payload),arrows:t.testData.arrows.filter(r=>r.startBlock!==e.payload&&r.endBlock!==e.payload)}};case"UPDATE_WORDS":return{...t,testData:{...t.testData,words:e.payload}};case"SET_CREATION_STATE":return{...t,creation:{...t.creation,...e.payload}};case"SET_UI_STATE":return{...t,ui:{...t.ui,...e.payload}};case"SET_LOADING":return{...t,ui:{...t.ui,isLoading:e.payload}};case"SET_ERROR":return{...t,ui:{...t.ui,error:e.payload}};case"RESET_TESTDATA":return{...t,testData:{blocks:[],words:[],arrows:[],imageUrl:t.testData.imageUrl}};default:return t}},kq=({testName:t="",showQuestionCount:e=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,l]=b.useReducer(Sq,bq),{showNotification:u}=qs(),{makeAuthenticatedRequest:d}=ro(),{user:g}=vn(),h=b.useRef(null),p=b.useRef(null),x=b.useRef(null),v=b.useRef({}),w=b.useRef({}),{canvasSize:S,stageRef:_}=vq(h),y=wq(o.canvas.image,S),{convertToOriginal:k}=_q(y);b.useEffect(()=>{l({type:"SET_CANVAS_SIZE",payload:S})},[S]),b.useEffect(()=>{y&&l({type:"SET_IMAGE_INFO",payload:y})},[y]),b.useEffect(()=>{var G,O,R;const L=x.current;if(!L)return;const z=(G=o.ui.selectedBlock)!=null&&G.id?v.current[o.ui.selectedBlock.id]:null;z?(L.nodes([z]),(O=L.getLayer())==null||O.batchDraw()):(L.nodes([]),(R=L.getLayer())==null||R.batchDraw())},[o.ui.selectedBlock]);const N=b.useCallback(()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:null}}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),l({type:"RESET_TESTDATA"}),l({type:"SET_ERROR",payload:null})},[]),E=b.useCallback(L=>{const z=L.target.files[0];if(!z||!z.type.startsWith("image/")){u("Please select a valid image file","error");return}const G=new FileReader;G.onload=O=>{const R=O.target.result,X=new Image;X.crossOrigin="anonymous",X.onload=()=>{l({type:"SET_IMAGE",payload:X}),l({type:"SET_UI_STATE",payload:{imageUrl:R}})},X.src=R},G.readAsDataURL(z)},[u]),A=b.useCallback(L=>{const z=_.current;if(!z)return;const G=z.getPointerPosition();if(G){if(o.canvas.selectedTool==="create"){const O=d0.findAtPosition(o.testData.blocks,G.x,G.y);if(O){l({type:"SET_UI_STATE",payload:{selectedBlock:O}});return}l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:G.x,y:G.y}}})}else if(o.canvas.selectedTool==="edit"){const O=d0.findAtPosition(o.testData.blocks,G.x,G.y);l(O?{type:"SET_UI_STATE",payload:{selectedBlock:O}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const O=L.target===z,R=d0.findAtPosition(o.testData.blocks,G.x,G.y);(O||!R)&&l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:G.x,y:G.y}}})}}},[o.canvas.selectedTool,y,o.testData.blocks]),C=b.useCallback(L=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const z=_.current;if(!z)return;const G=z.getPointerPosition();if(!G)return;const O=Math.abs(G.x-o.creation.blockCreationStart.x),R=Math.abs(G.y-o.creation.blockCreationStart.y),X=10,te=Math.max(O,X),H=Math.max(R,X);l({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(G.x,o.creation.blockCreationStart.x),y:Math.min(G.y,o.creation.blockCreationStart.y),width:te,height:H,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const z=_.current;if(!z)return;const G=z.getPointerPosition();if(!G)return;l({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:G.x,endY:G.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),F=b.useCallback(L=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const z=_.current;if(!z)return;const G=z.getPointerPosition();if(!G)return;const O=Math.abs(G.x-o.creation.blockCreationStart.x),R=Math.abs(G.y-o.creation.blockCreationStart.y),X=10,te=Math.max(O,X),H=Math.max(R,X),V=Math.min(G.x,o.creation.blockCreationStart.x)+te/2,q=Math.min(G.y,o.creation.blockCreationStart.y)+H/2,Q=d0.generateId(),ae=d0.create(V,q,te,H,Q),J=n2.create(Q,`Word ${o.testData.blocks.length+1}`,n2.generateId(Q));l({type:"ADD_BLOCK",payload:ae}),l({type:"ADD_WORD",payload:J}),l({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&l({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const z=_.current;if(!z)return;const G=z.getPointerPosition();if(!G)return;if(Vd.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,G.x,G.y,o.testData.blocks)){const O=Vd.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),R=Vd.snapToNearestBlock(G.x,G.y,o.testData.blocks),X=O?O.x:o.creation.arrowStart.x,te=O?O.y:o.creation.arrowStart.y,H=R?R.x:G.x,V=R?R.y:G.y,q=Vd.generateId(),Q=Vd.create(X,te,H,V,O?O.blockId:null,R?R.blockId:null,q);l({type:"ADD_ARROW",payload:Q}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");l({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),P=b.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const L=M();if(Object.keys(L).length>0){console.warn(" [MatchingTestCreator] Validation errors:",L),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),l({type:"SET_LOADING",payload:!0});let z=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const O=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),R=await O.json();if(O.ok&&R.success&&R.url)z=R.url;else throw new Error(R.message||"Upload failed")}const G=o.testData.blocks.map((O,R)=>{let X;if(y){const V=k(O.x,O.y),q=k(O.x+O.width,O.y+O.height);X={x:V.x,y:V.y,width:Number((q.x-V.x).toFixed(4)),height:Number((q.y-V.y).toFixed(4))}}else X={x:Number(O.x.toFixed(4)),y:Number(O.y.toFixed(4)),width:Number(O.width.toFixed(4)),height:Number(O.height.toFixed(4))};const te=o.testData.words.find(V=>V.blockId===O.id),H=o.testData.arrows.find(V=>V.startBlock===O.id);return{question_id:R+1,word:(te==null?void 0:te.word)||`Word ${R+1}`,block_coordinates:X,has_arrow:!!H,arrow:H&&y?(()=>{const V=k(H.startX,H.startY),q=k(H.endX,H.endY),Q=V.x/y.originalWidth*100,ae=V.y/y.originalHeight*100,J=q.x/y.originalWidth*100,re=q.y/y.originalHeight*100;return{start_x:Number(V.x.toFixed(4)),start_y:Number(V.y.toFixed(4)),end_x:Number(q.x.toFixed(4)),end_y:Number(q.y.toFixed(4)),rel_start_x:Number(Q.toFixed(4)),rel_start_y:Number(ae.toFixed(4)),rel_end_x:Number(J.toFixed(4)),rel_end_y:Number(re.toFixed(4)),image_width:y.originalWidth,image_height:y.originalHeight,style:H.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:z,processedQuestions:G}))}catch(z){console.error("Save error:",z),u(`Error saving test: ${z.message}`,"error")}finally{l({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,y,k,d,r,u,t,g]),M=b.useCallback(()=>{const L={};return t.trim()||(L.testName="Test name is required"),o.testData.blocks.length===0&&(L.blocks="At least one block is required"),L},[t,o.testData.blocks.length]),I=()=>c.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[c.jsx(Ue,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),c.jsx(Ue,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),c.jsx(Ue,{onClick:()=>l({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),c.jsx(Ue,{onClick:N,variant:"secondary",size:"sm",children:" Reset"}),c.jsx(Ue,{onClick:()=>{var L;return(L=p.current)==null?void 0:L.click()},variant:"secondary",size:"sm",children:" Upload Image"})]}),Y=()=>c.jsx(Bu,{width:S.width,height:S.height,ref:_,onMouseDown:A,onMouseMove:C,onMouseUp:F,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:c.jsxs(Lu,{children:[o.canvas.image&&y&&c.jsx(j9,{image:o.canvas.image,x:y.x,y:y.y,width:y.width,height:y.height}),o.testData.blocks.map(L=>c.jsxs(zi,{ref:z=>{z&&(w.current[L.id]=z)},draggable:o.canvas.selectedTool==="edit",x:L.x,y:L.y,onMouseEnter:z=>{var O,R;const G=(O=z.target.getStage())==null?void 0:O.container();G&&(G.style.cursor=((R=o.ui.selectedBlock)==null?void 0:R.id)===L.id?"nwse-resize":"move")},onMouseLeave:z=>{var O;const G=(O=z.target.getStage())==null?void 0:O.container();G&&(G.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:L}})},onDragEnd:z=>{const{x:G,y:O}=z.target.position();l({type:"UPDATE_BLOCK",payload:{id:L.id,updates:{x:G,y:O}}})},onClick:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:L}})},onTap:()=>{l({type:"SET_UI_STATE",payload:{selectedBlock:L}})},children:[c.jsx(ms,{ref:z=>{z&&(v.current[L.id]=z)},width:L.width,height:L.height,fill:L.fill,stroke:L.stroke,strokeWidth:L.strokeWidth,cornerRadius:L.cornerRadius,shadowColor:L.shadowColor,shadowBlur:L.shadowBlur,shadowOffset:L.shadowOffset,shadowOpacity:L.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:z=>{const{x:G,y:O}=z.target.getParent().position();l({type:"UPDATE_BLOCK",payload:{id:L.id,updates:{x:G,y:O}}})},onMouseEnter:z=>{var O,R;const G=(O=z.target.getStage())==null?void 0:O.container();G&&(G.style.cursor=((R=o.ui.selectedBlock)==null?void 0:R.id)===L.id?"nwse-resize":"move")},onMouseLeave:z=>{var O;const G=(O=z.target.getStage())==null?void 0:O.container();G&&(G.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:z=>{const G=v.current[L.id];if(!G)return;const O=Math.max(10,G.width()*G.scaleX()),R=Math.max(10,G.height()*G.scaleY());G.scaleX(1),G.scaleY(1),l({type:"UPDATE_BLOCK",payload:{id:L.id,updates:{width:O,height:R}}})}}),c.jsx(ko,{x:2,y:2,text:`${o.testData.blocks.indexOf(L)+1}`,fontSize:Math.min(12,Math.max(8,L.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},L.id)),c.jsx(F9,{ref:x,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(L,z)=>({...z,width:Math.max(z.width,10),height:Math.max(z.height,10)})}),o.testData.arrows.map(L=>c.jsx(uS,{points:[L.startX,L.startY,L.endX,L.endY],stroke:L.stroke,fill:L.fill,strokeWidth:L.strokeWidth,pointerLength:L.pointerLength,pointerWidth:L.pointerWidth},L.id)),o.creation.previewBlock&&c.jsx(ms,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&c.jsx(uS,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),se=b.useMemo(()=>o.testData.blocks.length===0?null:c.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[c.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),c.jsx("div",{className:"space-y-2",children:o.testData.words.map(L=>{const z=o.testData.blocks.find(G=>G.id===L.blockId);return c.jsxs("div",{className:"p-2 bg-white rounded border",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(z)+1]}),c.jsx("button",{onClick:()=>l({type:"DELETE_BLOCK",payload:z.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),c.jsx("input",{type:"text",value:L.word,onChange:G=>{const O=n2.update(o.testData.words,L.blockId,G.target.value);l({type:"UPDATE_WORDS",payload:O})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},L.blockId)})})]}),[o.testData.words,o.testData.blocks]);return c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[c.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{children:c.jsx("div",{className:"mt-2 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[c.jsx("strong",{children:"Test Name:"})," ",t||"Untitled Test"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})}),c.jsx("div",{className:"flex gap-2",children:c.jsx(Ue,{onClick:P,disabled:a||o.ui.isLoading,variant:"primary",children:a||o.ui.isLoading?c.jsx(ir,{size:"sm"}):"Save Test"})})]})}),I(),c.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[c.jsx("div",{ref:h,className:"bg-white border overflow-auto",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)",height:"auto"},children:Y()}),se]}),c.jsx("input",{ref:p,type:"file",accept:"image/*",onChange:E,className:"hidden"})]})},wh=b.createContext(null);function Cq(t,e){return{getTheme:function(){return e??null}}}function Oo(){const t=b.useContext(wh);return t==null&&function(e,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",e);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${e}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(8),t}function pt(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const so=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Tq=so&&"documentMode"in document?document.documentMode:null,_o=so&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Uu=so&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),E1=!(!so||!("InputEvent"in window)||Tq)&&"getTargetRanges"in new window.InputEvent("input"),jg=so&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),Jf=so&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Eq=so&&/Android/.test(navigator.userAgent),P9=so&&/^(?=.*Chrome).*/i.test(navigator.userAgent),F6=so&&Eq&&P9,N1=so&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!P9;function D9(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}const Nq=1,Aq=3,jq=9,Fq=11,$u=0,R9=1,Qf=2,Pq=0,Dq=1,Rq=2,A1=4,j1=8,eT=128,Mq=1792|(112|(3|A1|j1)|eT),tT=1,rT=2,nT=3,sT=4,aT=5,iT=6,Sv=jg||Jf||N1?"":"",wl=`

`,Iq=Uu?"":Sv,Wu={bold:1,capitalize:1024,code:16,highlight:eT,italic:2,lowercase:256,strikethrough:A1,subscript:32,superscript:64,underline:j1,uppercase:512},Oq={directionless:1,unmergeable:2},P6={center:rT,end:iT,justify:sT,left:tT,right:nT,start:aT},Lq={[rT]:"center",[iT]:"end",[sT]:"justify",[tT]:"left",[nT]:"right",[aT]:"start"},Bq={normal:0,segmented:2,token:1},Uq={[Pq]:"normal",[Rq]:"segmented",[Dq]:"token"},D6="$config";function M9(t,e,r,n,s,a){let i=t.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===e&&(Je(i)&&M9(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const $q=100;let fS=!1,oT=0;function Wq(t){oT=t.timeStamp}function s2(t,e,r){const n=t.nodeName==="BR",s=e.__lexicalLineBreak;return s&&(t===s||n&&t.previousSibling===s)||n&&Dv(t,r)!==void 0}function Hq(t,e,r){const n=to(Ci(r));let s=null,a=null;n!==null&&n.anchorNode===t&&(s=n.anchorOffset,a=n.focusOffset);const i=t.nodeValue;i!==null&&ET(e,i,s,a,!1)}function zq(t,e,r){if(dt(t)){const n=t.anchor.getNode();if(n.is(r)&&t.format!==n.getFormat())return!1}return Nl(e)&&r.isAttached()}function Gq(t,e,r,n){for(let s=t;s&&!GZ(s);s=bm(s)){const a=Dv(s,e);if(a!==void 0){const i=Kn(a,r);if(i)return jr(i)||!Zr(s)?void 0:[s,i]}else if(s===n)return[n,FR(r)]}}function I9(t,e,r){fS=!0;const n=performance.now()-oT>$q;try{Ia(t,()=>{const s=Ct()||function(h){return h.getEditorState().read(()=>{const p=Ct();return p!==null?p.clone():null})}(t),a=new Map,i=t.getRootElement(),o=t._editorState,l=t._blockCursorElement;let u=!1,d="";for(let h=0;h<e.length;h++){const p=e[h],x=p.type,v=p.target,w=Gq(v,t,o,i);if(!w)continue;const[S,_]=w;if(x==="characterData")n&&Tt(_)&&Nl(v)&&zq(s,v,_)&&Hq(v,_,t);else if(x==="childList"){u=!0;const y=p.addedNodes;for(let E=0;E<y.length;E++){const A=y[E],C=AR(A),F=A.parentNode;if(F!=null&&A!==l&&C===null&&!s2(A,F,t)){if(Uu){const P=(Zr(A)?A.innerText:null)||A.nodeValue;P&&(d+=P)}F.removeChild(A)}}const k=p.removedNodes,N=k.length;if(N>0){let E=0;for(let A=0;A<N;A++){const C=k[A];(s2(C,v,t)||l===C)&&(v.appendChild(C),E++)}N!==E&&a.set(S,_)}}}if(a.size>0)for(const[h,p]of a)p.reconcileObservedMutation(h,t);const g=r.takeRecords();if(g.length>0){for(let h=0;h<g.length;h++){const p=g[h],x=p.addedNodes,v=p.target;for(let w=0;w<x.length;w++){const S=x[w],_=S.parentNode;_==null||S.nodeName!=="BR"||s2(S,v,t)||_.removeChild(S)}}r.takeRecords()}s!==null&&(u&&Fs(s),Uu&&MR(t)&&s.insertRawText(d))})}finally{fS=!1}}function O9(t){const e=t._observer;e!==null&&I9(t,e.takeRecords(),e)}function L9(t){(function(e){oT===0&&Ci(e).addEventListener("textInput",Wq,!0)})(t),t._observer=new MutationObserver((e,r)=>{I9(t,e,r)})}function Vq(t){const e=new Map,r=new Set;for(let n=typeof t=="function"?t:t.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=PT(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,e.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:e}}let Kq=class B9{constructor(e,r,n=void 0,s=new Map,a=void 0){this.node=e,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:function(l,u,d){let g=d.size;if(u)for(const h in u){const p=l.get(h);p&&d.has(p)||g++}return g}(i,n,s);this.size=o}getValue(e){const r=this.knownState.get(e);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(e.key,e);let n=e.defaultValue;if(this.unknownState&&e.key in this.unknownState){const s=this.unknownState[e.key];s!==void 0&&(n=e.parse(s)),this.updateFromKnown(e,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const e={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete e[n.key]:e[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in e&&(r[n]=e[n],delete e[n]);return R6(e)&&(r.$=e),r}getWritable(e){if(this.node===e)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new B9(e,r,function(a,i,o){let l;if(o)for(const[u,d]of Object.entries(o)){const g=a.get(u);g?i.has(g)||i.set(g,g.parse(d)):(l=l||{},l[u]=d)}return l}(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(e,r){const n=e.key;this.sharedNodeState.sharedConfigMap.set(n,e);const{knownState:s,unknownState:a}=this;s.has(e)||a&&n in a||(a&&(delete a[n],this.unknownState=R6(a)),this.size++),s.set(e,r)}updateFromUnknown(e,r){const n=this.sharedNodeState.sharedConfigMap.get(e);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},e in this.unknownState||this.size++,this.unknownState[e]=r)}updateFromJSON(e){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,e)for(const[n,s]of Object.entries(e))this.updateFromUnknown(n,s)}};function Xq(t){const e=t.getWritable(),r=e.__state?e.__state.getWritable(e):new Kq(e,U9(e));return e.__state=r,r}function U9(t){return t.__state?t.__state.sharedNodeState:TR(Sm(),t.getType()).sharedNodeState}function R6(t){if(t)for(const e in t)return t}function M6(t,e,r){for(const[n,s]of e.knownState){if(t.has(n.key))continue;t.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function I6(t,e,r){const{unknownState:n}=e,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!t.has(a)&&(t.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function O6(t,e){const r=t.__state;return r&&r.node===t?r.getWritable(e):r}function L6(t,e){const r=t.__mode,n=t.__format,s=t.__style,a=e.__mode,i=e.__format,o=e.__style,l=t.__state,u=e.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(t.__state===null||l===u||function(d,g){if(d===g)return!0;if(d&&g&&d.size!==g.size)return!1;const h=new Set;return!(d&&M6(h,d,g)||g&&M6(h,g,d)||d&&I6(h,d,g)||g&&I6(h,g,d))}(l,u))}function B6(t,e){const r=t.mergeWithSibling(e),n=yn()._normalizedNodes;return n.add(t.__key),n.add(e.__key),r}function U6(t){let e,r,n=t;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(e=n.getPreviousSibling())!==null&&Tt(e)&&e.isSimpleText()&&!e.isUnmergeable();){if(e.__text!==""){if(L6(e,n)){n=B6(e,n);break}break}e.remove()}for(;(r=n.getNextSibling())!==null&&Tt(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(L6(n,r)){n=B6(n,r);break}break}r.remove()}}else n.remove()}function F1(t){return $6(t.anchor),$6(t.focus),t}function $6(t){for(;t.type==="element";){const e=t.getNode(),r=t.offset;let n,s;if(r===e.getChildrenSize()?(n=e.getChildAtIndex(r-1),s=!0):(n=e.getChildAtIndex(r),s=!1),Tt(n)){t.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!Je(n))break;t.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let Hu,Ks,Fg,kv,hS,gS,zu,Ji,mS,Pg,qn="",vo=null,wo="",rl="",Kd=!1,P1=!1;function D1(t,e){const r=zu.get(t);if(e!==null){const n=vS(t);n.parentNode===e&&e.removeChild(n)}if(Ji.has(t)||Ks._keyToDOMMap.delete(t),Je(r)){const n=M1(r,zu);pS(n,0,n.length-1,null)}r!==void 0&&NT(Pg,Fg,kv,r,"destroyed")}function pS(t,e,r,n){let s=e;for(;s<=r;++s){const a=t[s];a!==void 0&&D1(a,n)}}function au(t,e){t.setProperty("text-align",e)}const Yq="40px";function $9(t,e){const r=Hu.theme.indent;if(typeof r=="string"){const s=t.classList.contains(r);e>0&&!s?t.classList.add(r):e<1&&s&&t.classList.remove(r)}const n=getComputedStyle(t).getPropertyValue("--lexical-indent-base-value")||Yq;t.style.setProperty("padding-inline-start",e===0?"":`calc(${e} * ${n})`)}function W9(t,e){const r=t.style;e===0?au(r,""):e===tT?au(r,"left"):e===rT?au(r,"center"):e===nT?au(r,"right"):e===sT?au(r,"justify"):e===aT?au(r,"start"):e===iT&&au(r,"end")}function xS(t,e){const r=function(n){const s=n.__dir;if(s!==null)return s;if(rs(n))return null;const a=n.getParentOrThrow();return rs(a)&&a.__dir===null?"auto":null}(e);r!==null?t.dir=r:t.removeAttribute("dir")}function R1(t,e){const r=Ji.get(t);r===void 0&&pt(60);const n=r.createDOM(Hu,Ks);if(function(s,a,i){const o=i._keyToDOMMap;(function(l,u,d){const g=`__lexicalKey_${u._key}`;l[g]=d})(a,i,s),o.set(s,a)}(t,n,Ks),Tt(r)?n.setAttribute("data-lexical-text","true"):jr(r)&&n.setAttribute("data-lexical-decorator","true"),Je(r)){const s=r.__indent,a=r.__size;if(xS(n,r),s!==0&&$9(n,s),a!==0){const o=a-1;yS(M1(r,Ji),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&W9(n,i),r.isInline()||H9(null,r,n),Rv(r)&&(qn+=wl,rl+=wl)}else{const s=r.getTextContent();if(jr(r)){const a=r.decorate(Ks,Hu);a!==null&&z9(t,a),n.contentEditable="false"}qn+=s,rl+=s}return e!==null&&e.insertChild(n),NT(Pg,Fg,kv,r,"created"),n}function yS(t,e,r,n,s){const a=qn;qn="";let i=r;for(;i<=n;++i){R1(t[i],s);const o=Ji.get(t[i]);o!==null&&Tt(o)&&(vo===null&&(vo=o.getFormat()),wo===""&&(wo=o.getStyle()))}Rv(e)&&(qn+=wl),s.element.__lexicalTextContent=qn,qn=a+qn}function W6(t,e){if(t){const r=t.__last;if(r){const n=e.get(r);if(n)return ul(n)?"line-break":jr(n)&&n.isInline()?"decorator":null}return"empty"}return null}function H9(t,e,r){const n=W6(t,zu),s=W6(e,Ji);n!==s&&e.getDOMSlot(r).setManagedLineBreak(s)}function Jq(t,e,r){var n;vo=null,wo="",function(s,a,i){const o=qn,l=s.__size,u=a.__size;qn="";const d=i.element;if(l===1&&u===1){const g=s.__first,h=a.__first;if(g===h)S0(g,d);else{const x=vS(g),v=R1(h,null);try{d.replaceChild(v,x)}catch(w){if(typeof w=="object"&&w!=null){const S=`${w.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${h}}, old child: {tag: ${x.tagName}, key: ${g}}.`;throw new Error(S)}throw w}D1(g,null)}const p=Ji.get(h);Tt(p)&&(vo===null&&(vo=p.getFormat()),wo===""&&(wo=p.getStyle()))}else{const g=M1(s,zu),h=M1(a,Ji);if(g.length!==l&&pt(227),h.length!==u&&pt(228),l===0)u!==0&&yS(h,a,0,u-1,i);else if(u===0){if(l!==0){const p=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;pS(g,0,l-1,p?null:d),p&&(d.textContent="")}}else(function(p,x,v,w,S,_){const y=w-1,k=S-1;let N,E,A=_.getFirstChild(),C=0,F=0;for(;C<=y&&F<=k;){const I=x[C],Y=v[F];if(I===Y)A=a2(S0(Y,_.element)),C++,F++;else{N===void 0&&(N=new Set(x)),E===void 0&&(E=new Set(v));const L=E.has(I),z=N.has(Y);if(L)if(z){const G=Gu(Ks,Y);G===A?A=a2(S0(Y,_.element)):(_.withBefore(A).insertChild(G),S0(Y,_.element)),C++,F++}else R1(Y,_.withBefore(A)),F++;else A=a2(vS(I)),D1(I,_.element),C++}const se=Ji.get(Y);se!==null&&Tt(se)&&(vo===null&&(vo=se.getFormat()),wo===""&&(wo=se.getStyle()))}const P=C>y,M=F>k;if(P&&!M){const I=v[k+1],Y=I===void 0?null:Ks.getElementByKey(I);yS(v,p,F,k,_.withBefore(Y))}else M&&!P&&pS(x,C,y,_.element)})(a,g,h,l,u,i)}Rv(a)&&(qn+=wl),d.__lexicalTextContent=qn,qn=o+qn}(t,e,e.getDOMSlot(r)),n=e,vo==null||vo===n.__textFormat||P1||n.setTextFormat(vo),function(s){wo===""||wo===s.__textStyle||P1||s.setTextStyle(wo)}(e)}function M1(t,e){const r=[];let n=t.__first;for(;n!==null;){const s=e.get(n);s===void 0&&pt(101),r.push(n),n=s.__next}return r}function S0(t,e){const r=zu.get(t);let n=Ji.get(t);r!==void 0&&n!==void 0||pt(61);const s=Kd||gS.has(t)||hS.has(t),a=Gu(Ks,t);if(r===n&&!s){if(Je(r)){const i=a.__lexicalTextContent;i!==void 0&&(qn+=i,rl+=i)}else{const i=r.getTextContent();rl+=i,qn+=i}return a}if(r!==n&&s&&NT(Pg,Fg,kv,n,"updated"),n.updateDOM(r,a,Hu)){const i=R1(t,null);return e===null&&pt(62),e.replaceChild(i,a),D1(t,null),i}if(Je(r)&&Je(n)){const i=n.__indent;(Kd||i!==r.__indent)&&$9(a,i);const o=n.__format;if((Kd||o!==r.__format)&&W9(a,o),s&&(Jq(r,n,a),rs(n)||n.isInline()||H9(r,n,a)),Rv(n)&&(qn+=wl,rl+=wl),(Kd||n.__dir!==r.__dir)&&(xS(a,n),rs(n)&&!Kd))for(const l of n.getChildren())Je(l)&&xS(Gu(Ks,l.getKey()),l)}else{const i=n.getTextContent();if(jr(n)){const o=n.decorate(Ks,Hu);o!==null&&z9(t,o)}qn+=i,rl+=i}if(!P1&&rs(n)&&n.__cachedText!==rl){const i=n.getWritable();i.__cachedText=rl,n=i}return a}function z9(t,e){let r=Ks._pendingDecorators;const n=Ks._decorators;if(r===null){if(n[t]===e)return;r=jR(Ks)}r[t]=e}function a2(t){let e=t.nextSibling;return e!==null&&e===Ks._blockCursorElement&&(e=e.nextSibling),e}function Qq(t,e,r,n,s,a){qn="",rl="",Kd=n===Qf,Ks=r,Hu=r._config,Fg=r._nodes,kv=Ks._listeners.mutation,hS=s,gS=a,zu=t._nodeMap,Ji=e._nodeMap,P1=e._readOnly,mS=new Map(r._keyToDOMMap);const i=new Map;return Pg=i,S0("root",null),Ks=void 0,Fg=void 0,hS=void 0,gS=void 0,zu=void 0,Ji=void 0,Hu=void 0,mS=void 0,Pg=void 0,i}function vS(t){const e=mS.get(t);return e===void 0&&pt(75,t),e}function Xt(t){return{type:t}}const G9=Xt("SELECTION_CHANGE_COMMAND"),qq=Xt("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),lT=Xt("CLICK_COMMAND"),Tu=Xt("DELETE_CHARACTER_COMMAND"),Ef=Xt("INSERT_LINE_BREAK_COMMAND"),Dg=Xt("INSERT_PARAGRAPH_COMMAND"),Nf=Xt("CONTROLLED_TEXT_INSERTION_COMMAND"),cT=Xt("PASTE_COMMAND"),wS=Xt("REMOVE_TEXT_COMMAND"),Rg=Xt("DELETE_WORD_COMMAND"),Mg=Xt("DELETE_LINE_COMMAND"),Vs=Xt("FORMAT_TEXT_COMMAND"),uT=Xt("UNDO_COMMAND"),dT=Xt("REDO_COMMAND"),Zq=Xt("KEYDOWN_COMMAND"),V9=Xt("KEY_ARROW_RIGHT_COMMAND"),eZ=Xt("MOVE_TO_END"),K9=Xt("KEY_ARROW_LEFT_COMMAND"),tZ=Xt("MOVE_TO_START"),X9=Xt("KEY_ARROW_UP_COMMAND"),Y9=Xt("KEY_ARROW_DOWN_COMMAND"),I1=Xt("KEY_ENTER_COMMAND"),J9=Xt("KEY_SPACE_COMMAND"),Q9=Xt("KEY_BACKSPACE_COMMAND"),q9=Xt("KEY_ESCAPE_COMMAND"),Z9=Xt("KEY_DELETE_COMMAND"),eR=Xt("KEY_TAB_COMMAND"),rZ=Xt("INSERT_TAB_COMMAND"),nZ=Xt("INDENT_CONTENT_COMMAND"),H6=Xt("OUTDENT_CONTENT_COMMAND"),tR=Xt("DROP_COMMAND"),rR=Xt("FORMAT_ELEMENT_COMMAND"),nR=Xt("DRAGSTART_COMMAND"),sR=Xt("DRAGOVER_COMMAND"),sZ=Xt("DRAGEND_COMMAND"),Cv=Xt("COPY_COMMAND"),fT=Xt("CUT_COMMAND"),_S=Xt("SELECT_ALL_COMMAND"),aZ=Xt("CLEAR_EDITOR_COMMAND"),iZ=Xt("CLEAR_HISTORY_COMMAND"),ex=Xt("CAN_REDO_COMMAND"),tx=Xt("CAN_UNDO_COMMAND"),oZ=Xt("FOCUS_COMMAND"),lZ=Xt("BLUR_COMMAND"),cZ=Xt("KEY_MODIFIER_COMMAND"),Yo=Object.freeze({}),bS=30,SS=[["keydown",function(t,e){if(H0=t.timeStamp,aR=t.key,!e.isComposing()&&!Mt(e,Zq,t)&&t.key!=null){if(i2&&xA(t))return Ia(e,()=>{rx(e,o2)}),i2=!1,void(o2="");if(function(r){return Dr(r,"ArrowRight",{shiftKey:"any"})}(t))Mt(e,V9,t);else if(function(r){return Dr(r,"ArrowRight",qo)}(t))Mt(e,eZ,t);else if(function(r){return Dr(r,"ArrowLeft",{shiftKey:"any"})}(t))Mt(e,K9,t);else if(function(r){return Dr(r,"ArrowLeft",qo)}(t))Mt(e,tZ,t);else if(function(r){return Dr(r,"ArrowUp",{altKey:"any",shiftKey:"any"})}(t))Mt(e,X9,t);else if(function(r){return Dr(r,"ArrowDown",{altKey:"any",shiftKey:"any"})}(t))Mt(e,Y9,t);else if(function(r){return Dr(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})}(t))z0=!0,Mt(e,I1,t);else if(function(r){return r.key===" "}(t))Mt(e,J9,t);else if(function(r){return _o&&Dr(r,"o",{ctrlKey:!0})}(t))t.preventDefault(),z0=!0,Mt(e,Ef,!0);else if(function(r){return Dr(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})}(t))z0=!1,Mt(e,I1,t);else if(function(r){return Dr(r,"Backspace",{shiftKey:"any"})||_o&&Dr(r,"h",{ctrlKey:!0})}(t))xA(t)?Mt(e,Q9,t):(t.preventDefault(),Mt(e,Tu,!0));else if(function(r){return r.key==="Escape"}(t))Mt(e,q9,t);else if(function(r){return Dr(r,"Delete",{})||_o&&Dr(r,"d",{ctrlKey:!0})}(t))(function(r){return r.key==="Delete"})(t)?Mt(e,Z9,t):(t.preventDefault(),Mt(e,Tu,!1));else if(function(r){return Dr(r,"Backspace",pA)}(t))t.preventDefault(),Mt(e,Rg,!0);else if(function(r){return Dr(r,"Delete",pA)}(t))t.preventDefault(),Mt(e,Rg,!1);else if(function(r){return _o&&Dr(r,"Backspace",{metaKey:!0})}(t))t.preventDefault(),Mt(e,Mg,!0);else if(function(r){return _o&&(Dr(r,"Delete",{metaKey:!0})||Dr(r,"k",{ctrlKey:!0}))}(t))t.preventDefault(),Mt(e,Mg,!1);else if(function(r){return Dr(r,"b",qo)}(t))t.preventDefault(),Mt(e,Vs,"bold");else if(function(r){return Dr(r,"u",qo)}(t))t.preventDefault(),Mt(e,Vs,"underline");else if(function(r){return Dr(r,"i",qo)}(t))t.preventDefault(),Mt(e,Vs,"italic");else if(function(r){return Dr(r,"Tab",{shiftKey:"any"})}(t))Mt(e,eR,t);else if(function(r){return Dr(r,"z",qo)}(t))t.preventDefault(),Mt(e,uT,void 0);else if(function(r){return _o?Dr(r,"z",{metaKey:!0,shiftKey:!0}):Dr(r,"y",{ctrlKey:!0})||Dr(r,"z",{ctrlKey:!0,shiftKey:!0})}(t))t.preventDefault(),Mt(e,dT,void 0);else{const r=e._editorState._selection;r===null||dt(r)?yA(t)&&(t.preventDefault(),Mt(e,_S,t)):function(n){return Dr(n,"c",qo)}(t)?(t.preventDefault(),Mt(e,Cv,t)):function(n){return Dr(n,"x",qo)}(t)?(t.preventDefault(),Mt(e,fT,t)):yA(t)&&(t.preventDefault(),Mt(e,_S,t))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(t)&&Mt(e,cZ,t)}}],["pointerdown",function(t,e){const r=t.target,n=t.pointerType;kh(r)&&n!=="touch"&&n!=="pen"&&t.button===0&&Ia(e,()=>{hA(r)||(CS=!0)})}],["compositionstart",function(t,e){Ia(e,()=>{const r=Ct();if(dt(r)&&!e.isComposing()){const n=r.anchor,s=r.anchor.getNode();Ts(n.key),(t.timeStamp<H0+bS||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||Tt(s)&&s.getStyle()!==r.style)&&Mt(e,Nf,Iq)}})}],["compositionend",function(t,e){Uu?f0=!0:Jf||!jg&&!N1?Ia(e,()=>{rx(e,t.data)}):(i2=!0,o2=t.data)}],["input",function(t,e){t.stopPropagation(),Ia(e,()=>{if(Zr(t.target)&&hA(t.target))return;const r=Ct(),n=t.data,s=uR(t);if(n!=null&&dt(r)&&lR(r,s,n,t.timeStamp,!1)){f0&&(rx(e,n),f0=!1);const a=r.anchor.getNode(),i=to(Ci(e));if(i===null)return;const o=r.isBackward(),l=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;E1&&!r.isCollapsed()&&Tt(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,l)+n+a.getTextContent().slice(l+u)===RR(i.anchorNode)||Mt(e,Nf,n);const d=n.length;Uu&&d>1&&t.inputType==="insertCompositionText"&&!e.isComposing()&&(r.anchor.offset-=d),jg||Jf||N1||!e.isComposing()||(H0=0,Ts(null))}else TT(!1,e,n!==null?n:void 0),f0&&(rx(e,n||void 0),f0=!1);(function(){Cs();const a=yn();O9(a)})()},{event:t}),Xd=null}],["click",function(t,e){Ia(e,()=>{const r=Ct(),n=to(Ci(e)),s=Sh();if(n){if(dt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!rs(i)&&on().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(t.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=function(l,u){let d=l;for(;d!==on()&&d!=null;){if(u(d))return d;d=d.getParent()}return null}(i,l=>Je(l)&&!l.isInline());Je(o)&&o.select(0)}}else if(t.pointerType==="touch"||t.pointerType==="pen"){const a=n.anchorNode;(Zr(a)||Nl(a))&&Fs(mT(s,n,e,t))}}Mt(e,lT,t)})}],["cut",Yo],["copy",Yo],["dragstart",Yo],["dragover",Yo],["dragend",Yo],["paste",Yo],["focus",Yo],["blur",Yo],["drop",Yo]];E1&&SS.push(["beforeinput",(t,e)=>function(r,n){const s=r.inputType,a=uR(r);s==="deleteCompositionText"||Uu&&MR(n)||s!=="insertCompositionText"&&Ia(n,()=>{const i=Ct();if(s==="deleteContentBackward"){if(i===null){const p=Sh();if(!dt(p))return;Fs(p.clone())}if(dt(i)){const p=i.anchor.key===i.focus.key;if(o=r.timeStamp,aR==="MediaLast"&&o<H0+bS&&n.isComposing()&&p){if(Ts(null),H0=0,setTimeout(()=>{Ia(n,()=>{Ts(null)})},bS),dt(i)){const x=i.anchor.getNode();x.markDirty(),Tt(x)||pt(142),cR(i,x)}}else{Ts(null),r.preventDefault();const x=i.anchor.getNode(),v=x.getTextContent(),w=x.canInsertTextAfter(),S=i.anchor.offset===0&&i.focus.offset===v.length;let _=F6&&p&&!S&&w;if(_&&i.isCollapsed()&&(_=!jr(jS(i.anchor,!0))),!_){Mt(n,Tu,!0);const y=Ct();F6&&dt(y)&&y.isCollapsed()&&(du=y,setTimeout(()=>du=null))}}return}}var o;if(!dt(i))return;const l=r.data;Xd!==null&&TT(!1,n,Xd),i.dirty&&Xd===null||!i.isCollapsed()||rs(i.anchor.getNode())||a===null||i.applyDOMRange(a),Xd=null;const u=i.anchor,d=i.focus,g=u.getNode(),h=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":Mt(n,Nf,r);break;case"insertFromComposition":Ts(null),Mt(n,Nf,r);break;case"insertLineBreak":Ts(null),Mt(n,Ef,!1);break;case"insertParagraph":Ts(null),z0&&!Jf?(z0=!1,Mt(n,Ef,!1)):Mt(n,Dg,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":Mt(n,cT,r);break;case"deleteByComposition":(function(p,x){return p!==x||Je(p)||Je(x)||!Eu(p)||!Eu(x)})(g,h)&&Mt(n,wS,r);break;case"deleteByDrag":case"deleteByCut":Mt(n,wS,r);break;case"deleteContent":Mt(n,Tu,!1);break;case"deleteWordBackward":Mt(n,Rg,!0);break;case"deleteWordForward":Mt(n,Rg,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":Mt(n,Mg,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":Mt(n,Mg,!1);break;case"formatStrikeThrough":Mt(n,Vs,"strikethrough");break;case"formatBold":Mt(n,Vs,"bold");break;case"formatItalic":Mt(n,Vs,"italic");break;case"formatUnderline":Mt(n,Vs,"underline");break;case"historyUndo":Mt(n,uT,void 0);break;case"historyRedo":Mt(n,dT,void 0)}else{if(l===`
`)r.preventDefault(),Mt(n,Ef,!1);else if(l===wl)r.preventDefault(),Mt(n,Dg,void 0);else if(l==null&&r.dataTransfer){const p=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(p)}else l!=null&&lR(i,a,l,r.timeStamp,!0)?(r.preventDefault(),Mt(n,Nf,l)):Xd=l;iR=r.timeStamp}})}(t,e)]);let H0=0,aR=null,iR=0,Xd=null;const O1=new WeakMap;let kS=!1,CS=!1,z0=!1,f0=!1,i2=!1,o2="",du=null,oR=[0,"",0,"root",0];function lR(t,e,r,n,s){const a=t.anchor,i=t.focus,o=a.getNode(),l=yn(),u=to(Ci(l)),d=u!==null?u.anchorNode:null,g=a.key,h=l.getElementByKey(g),p=r.length;return g!==i.key||!Tt(o)||(!s&&(!E1||iR<n+50)||o.isDirty()&&p<2||PR(r))&&a.offset!==i.offset&&!o.isComposing()||el(o)||o.isDirty()&&p>1||(s||!E1)&&h!==null&&!o.isComposing()&&d!==qf(h)||u!==null&&e!==null&&(!e.collapsed||e.startContainer!==u.anchorNode||e.startOffset!==u.anchorOffset)||o.getFormat()!==t.format||o.getStyle()!==t.style||function(x,v){if(v.isSegmented())return!0;if(!x.isCollapsed())return!1;const w=x.anchor.offset,S=v.getParentOrThrow(),_=Eu(v);return w===0?!v.canInsertTextBefore()||!S.canInsertTextBefore()&&!v.isComposing()||_||function(y){const k=y.getPreviousSibling();return(Tt(k)||Je(k)&&k.isInline())&&!k.canInsertTextAfter()}(v):w===v.getTextContentSize()&&(!v.canInsertTextAfter()||!S.canInsertTextAfter()&&!v.isComposing()||_)}(t,o)}function z6(t,e){return Nl(t)&&t.nodeValue!==null&&e!==0&&e!==t.nodeValue.length}function G6(t,e,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=t;kS&&(kS=!1,z6(n,s)&&z6(a,i)&&!du)||Ia(e,()=>{if(!r)return void Fs(null);if(!_m(e,n,a))return;let o=Ct();if(du&&dt(o)&&o.isCollapsed()){const l=o.anchor,u=du.anchor;(l.key===u.key&&l.offset===u.offset+1||l.offset===1&&u.getNode().is(l.getNode().getPreviousSibling()))&&(o=du.clone(),Fs(o))}if(du=null,dt(o)){const l=o.anchor,u=l.getNode();if(o.isCollapsed()){t.type==="Range"&&t.anchorNode===t.focusNode&&(o.dirty=!0);const d=Ci(e).event,g=d?d.timeStamp:performance.now(),[h,p,x,v,w]=oR,S=on(),_=e.isComposing()===!1&&S.getTextContent()==="";if(g<w+200&&l.offset===x&&l.key===v)Ux(o,h,p);else if(l.type==="text")Tt(u)||pt(141),cR(o,u);else if(l.type==="element"&&!_){Je(u)||pt(259);const y=l.getNode();y.isEmpty()?function(k,N){const E=N.getTextFormat(),A=N.getTextStyle();Ux(k,E,A)}(o,y):Ux(o,0,"")}}else{const d=l.key,g=o.focus.key,h=o.getNodes(),p=h.length,x=o.isBackward(),v=x?i:s,w=x?s:i,S=x?g:d,_=x?d:g;let y=Mq,k=!1;for(let N=0;N<p;N++){const E=h[N],A=E.getTextContentSize();if(Tt(E)&&A!==0&&!(N===0&&E.__key===S&&v===A||N===p-1&&E.__key===_&&w===0)&&(k=!0,y&=E.getFormat(),y===0))break}o.format=k?y:0}}Mt(e,G9,void 0)})}function Ux(t,e,r){t.format===e&&t.style===r||(t.format=e,t.style=r,t.dirty=!0)}function cR(t,e){Ux(t,e.getFormat(),e.getStyle())}function uR(t){if(!t.getTargetRanges)return null;const e=t.getTargetRanges();return e.length===0?null:e[0]}function rx(t,e){const r=t._compositionKey;if(Ts(null),r!==null&&e!=null){if(e===""){const n=Kn(r),s=qf(t.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&Tt(n)&&ET(n,s.nodeValue,null,null,!0))}if(e[e.length-1]===`
`){const n=Ct();if(dt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void Mt(t,I1,null)}}}TT(!0,t,e)}function dR(t){let e=t.__lexicalEventHandles;return e===void 0&&(e=[],t.__lexicalEventHandles=e),e}const Af=new Map;function fR(t){const e=WZ(t.target);if(e===null)return;const r=ER(e.anchorNode);if(r===null)return;CS&&(CS=!1,Ia(r,()=>{const l=Sh(),u=e.anchorNode;(Zr(u)||Nl(u))&&Fs(mT(l,e,r,t))}));const n=CT(r),s=n[n.length-1],a=s._key,i=Af.get(a),o=i||s;o!==r&&G6(e,o,!1),G6(e,r,!0),r!==s?Af.set(a,r):i&&Af.delete(a)}function V6(t){t._lexicalHandled=!0}function K6(t){return t._lexicalHandled===!0}function uZ(t){const e=t.ownerDocument,r=O1.get(e);if(r===void 0)return;const n=r-1;n>=0||pt(164),O1.set(e,n),n===0&&e.removeEventListener("selectionchange",fR);const s=Pv(t);kT(s)?(function(i){if(i._parentEditor!==null){const o=CT(i),l=o[o.length-1]._key;Af.get(l)===i&&Af.delete(l)}else Af.delete(i._key)}(s),t.__lexicalEditor=null):s&&pt(198);const a=dR(t);for(let i=0;i<a.length;i++)a[i]();t.__lexicalEventHandles=[]}function TS(t,e,r){Cs();const n=t.__key,s=t.getParent();if(s===null)return;const a=function(o){const l=Ct();if(!dt(l)||!Je(o))return l;const{anchor:u,focus:d}=l,g=u.getNode(),h=d.getNode();return FS(g,o)&&u.set(o.__key,0,"element"),FS(h,o)&&d.set(o.__key,0,"element"),l}(t);let i=!1;if(dt(a)&&e){const o=a.anchor,l=a.focus;o.key===n&&(B1(o,t,s,t.getPreviousSibling(),t.getNextSibling()),i=!0),l.key===n&&(B1(l,t,s,t.getPreviousSibling(),t.getNextSibling()),i=!0)}else Bs(a)&&e&&t.isSelected()&&t.selectPrevious();if(dt(a)&&e&&!i){const o=t.getIndexWithinParent();Nu(t),L1(a,s,o,-1)}else Nu(t);r||la(s)||s.canBeEmpty()||!s.isEmpty()||TS(s,e),e&&a&&rs(s)&&s.isEmpty()&&s.selectEnd()}class _h{static getType(){const{ownNodeType:e}=PT(this);return e===void 0&&pt(64,this.name),e}static clone(e){pt(65,this.name)}$config(){return{}}config(e,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:e}),{[e]:r}}afterCloneFrom(e){this.__key===e.__key?(this.__parent=e.__parent,this.__next=e.__next,this.__prev=e.__prev,this.__state=e.__state):e.__state&&(this.__state=e.__state.getWritable(this))}constructor(e){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),RZ(this,e)}getType(){return this.__type}isInline(){pt(137,this.constructor.name)}isAttached(){let e=this.__key;for(;e!==null;){if(e==="root")return!0;const r=Kn(e);if(r===null)break;e=r.__parent}return!1}isSelected(e){const r=e||Ct();if(r==null)return!1;const n=r.getNodes().some(s=>s.__key===this.__key);if(Tt(this))return n;if(dt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(jr(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const e=this.getParent();if(e===null)return-1;let r=e.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const e=this.getLatest().__parent;return e===null?null:Kn(e)}getParentOrThrow(){const e=this.getParent();return e===null&&pt(66,this.__key),e}getTopLevelElement(){let e=this;for(;e!==null;){const r=e.getParent();if(la(r))return Je(e)||e===this&&jr(e)||pt(194),e;e=r}return null}getTopLevelElementOrThrow(){const e=this.getTopLevelElement();return e===null&&pt(67,this.__key),e}getParents(){const e=[];let r=this.getParent();for(;r!==null;)e.push(r),r=r.getParent();return e}getParentKeys(){const e=[];let r=this.getParent();for(;r!==null;)e.push(r.__key),r=r.getParent();return e}getPreviousSibling(){const e=this.getLatest().__prev;return e===null?null:Kn(e)}getPreviousSiblings(){const e=[],r=this.getParent();if(r===null)return e;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)e.push(n),n=n.getNextSibling();return e}getNextSibling(){const e=this.getLatest().__next;return e===null?null:Kn(e)}getNextSiblings(){const e=[];let r=this.getNextSibling();for(;r!==null;)e.push(r),r=r.getNextSibling();return e}getCommonAncestor(e){const r=Je(this)?this:this.getParent(),n=Je(e)?e:e.getParent(),s=r&&n?Wx(r,n):null;return s?s.commonAncestor:null}is(e){return e!=null&&this.__key===e.__key}isBefore(e){const r=Wx(this,e);return r!==null&&(r.type==="descendant"||(r.type==="branch"?BR(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&pt(279),!1)))}isParentOf(e){const r=Wx(this,e);return r!==null&&r.type==="ancestor"}getNodesBetween(e){const r=this.isBefore(e),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===e)break;const o=Je(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const l=r?a.getNextSibling():a.getPreviousSibling();if(l!==null){a=l;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===e)break;let d=null,g=u;do{if(g===null&&pt(68),d=r?g.getNextSibling():g.getPreviousSibling(),g=g.getParent(),g===null)break;d!==null||s.has(g.__key)||n.push(g)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const e=yn()._dirtyLeaves;return e!==null&&e.has(this.__key)}getLatest(){const e=Kn(this.__key);return e===null&&pt(113),e}getWritable(){Cs();const e=Wc(),r=yn(),n=e._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=Ct();if(o!==null&&o.setCachedNodes(null),i.has(s))return W1(a),a;const l=jT(a);return i.add(s),W1(l),n.set(s,l),l}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(e,r){pt(70)}updateDOM(e,r,n){pt(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){const e=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...e}}static importJSON(e){pt(18,this.name)}updateFromJSON(e){return function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of U9(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&Xq(r).updateFromJSON(i),s}(this,e)}static transform(){return null}remove(e){TS(this,!0,e)}replace(e,r){Cs();let n=Ct();n!==null&&(n=n.clone()),h2(this,e);const s=this.getLatest(),a=this.__key,i=e.__key,o=e.getWritable(),l=this.getParentOrThrow().getWritable(),u=l.__size;Nu(o);const d=s.getPreviousSibling(),g=s.getNextSibling(),h=s.__prev,p=s.__next,x=s.__parent;if(TS(s,!1,!0),d===null?l.__first=i:d.getWritable().__next=i,o.__prev=h,g===null?l.__last=i:g.getWritable().__prev=i,o.__next=p,o.__parent=x,l.__size=u,r&&(Je(this)&&Je(o)||pt(139),this.getChildren().forEach(v=>{o.append(v)})),dt(n)){Fs(n);const v=n.anchor,w=n.focus;v.key===a&&Q6(v,o),w.key===a&&Q6(w,o)}return ec()===a&&Ts(i),o}insertAfter(e,r=!0){Cs(),h2(this,e);const n=this.getWritable(),s=e.getWritable(),a=s.getParent(),i=Ct();let o=!1,l=!1;if(a!==null){const p=e.getIndexWithinParent();if(Nu(s),dt(i)){const x=a.__key,v=i.anchor,w=i.focus;o=v.type==="element"&&v.key===x&&v.offset===p+1,l=w.type==="element"&&w.key===x&&w.offset===p+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),g=s.__key,h=n.__next;if(u===null?d.__last=g:u.getWritable().__prev=g,d.__size++,n.__next=g,s.__next=h,s.__prev=n.__key,s.__parent=n.__parent,r&&dt(i)){const p=this.getIndexWithinParent();L1(i,d,p+1);const x=d.__key;o&&i.anchor.set(x,p+2,"element"),l&&i.focus.set(x,p+2,"element")}return e}insertBefore(e,r=!0){Cs(),h2(this,e);const n=this.getWritable(),s=e.getWritable(),a=s.__key;Nu(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),l=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=l,s.__next=n.__key,s.__parent=n.__parent;const d=Ct();return r&&dt(d)&&L1(d,this.getParentOrThrow(),u),e}isParentRequired(){return!1}createParentElementNode(){return qr()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,r){Cs();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(Je(n))return n.select();if(!Tt(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(e,r)}selectNext(e,r){Cs();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(Je(n))return n.select(0,0);if(!Tt(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(e,r)}markDirty(){this.getWritable()}reconcileObservedMutation(e,r){this.markDirty()}}class pm extends _h{static getType(){return"linebreak"}static clone(e){return new pm(e.__key)}constructor(e){super(e)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:e=>function(r){const n=r.parentElement;if(n!==null&&H1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&nx(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&nx(a))return!0}}return!1}(e)||function(r){const n=r.parentElement;if(n!==null&&H1(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&nx(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&nx(a))return!0}return!1}(e)?null:{conversion:dZ,priority:0}}}static importJSON(e){return Do().updateFromJSON(e)}}function dZ(t){return{node:Do()}}function Do(){return fa(new pm)}function ul(t){return t instanceof pm}function nx(t){return Nl(t)&&/^( |\t|\r?\n)+$/.test(t.textContent||"")}function l2(t,e){return 16&e?"code":e&eT?"mark":32&e?"sub":64&e?"sup":null}function c2(t,e){return 1&e?"strong":2&e?"em":"span"}function hR(t,e,r,n,s){const a=n.classList;let i=jf(s,"base");i!==void 0&&a.add(...i),i=jf(s,"underlineStrikethrough");let o=!1;const l=e&j1&&e&A1;i!==void 0&&(r&j1&&r&A1?(o=!0,l||a.add(...i)):l&&a.remove(...i));for(const u in Wu){const d=Wu[u];if(i=jf(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){e&d&&a.remove(...i);continue}e&d&&(!l||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else e&d&&a.remove(...i)}}function gR(t,e,r){const n=e.firstChild,s=r.isComposing(),a=t+(s?Sv:"");if(n==null)e.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||Uu){const[o,l,u]=function(d,g){const h=d.length,p=g.length;let x=0,v=0;for(;x<h&&x<p&&d[x]===g[x];)x++;for(;v+x<h&&v+x<p&&d[h-v-1]===g[p-v-1];)v++;return[x,h-x-v,g.slice(x,p-v)]}(i,a);l!==0&&n.deleteData(o,l),n.insertData(o,u)}else n.nodeValue=a}}function X6(t,e,r,n,s,a){gR(s,t,e);const i=a.theme.text;i!==void 0&&hR(0,0,n,t,i)}function sx(t,e){const r=document.createElement(e);return r.appendChild(t),r}class $c extends _h{static getType(){return"text"}static clone(e){return new $c(e.__text,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__text=e.__text,this.__format=e.__format,this.__style=e.__style,this.__mode=e.__mode,this.__detail=e.__detail}constructor(e="",r){super(r),this.__text=e,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const e=this.getLatest();return Uq[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===ec()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(e){const r=Wu[e];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(e,r){return $1(this.getLatest().__format,e,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(e,r){const n=this.__format,s=l2(0,n),a=c2(0,n),i=s===null?a:s,o=document.createElement(i);let l=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(l=document.createElement(a),o.appendChild(l)),X6(l,this,0,n,this.__text,e);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(e,r,n){const s=this.__text,a=e.__format,i=this.__format,o=l2(0,a),l=l2(0,i),u=c2(0,a),d=c2(0,i);if((o===null?u:o)!==(l===null?d:l))return!0;if(o===l&&u!==d){const v=r.firstChild;v==null&&pt(48);const w=document.createElement(d);return X6(w,this,0,i,s,n),r.replaceChild(w,v),!1}let g=r;l!==null&&o!==null&&(g=r.firstChild,g==null&&pt(49)),gR(s,g,this);const h=n.theme.text;h!==void 0&&a!==i&&hR(0,a,i,g,h);const p=e.__style,x=this.__style;return p!==x&&(r.style.cssText=x),!1}static importDOM(){return{"#text":()=>({conversion:mZ,priority:0}),b:()=>({conversion:hZ,priority:0}),code:()=>({conversion:Jo,priority:0}),em:()=>({conversion:Jo,priority:0}),i:()=>({conversion:Jo,priority:0}),mark:()=>({conversion:Jo,priority:0}),s:()=>({conversion:Jo,priority:0}),span:()=>({conversion:fZ,priority:0}),strong:()=>({conversion:Jo,priority:0}),sub:()=>({conversion:Jo,priority:0}),sup:()=>({conversion:Jo,priority:0}),u:()=>({conversion:Jo,priority:0})}}static importJSON(e){return Cn().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTextContent(e.text).setFormat(e.format).setDetail(e.detail).setMode(e.mode).setStyle(e.style)}exportDOM(e){let{element:r}=super.exportDOM(e);return Zr(r)||pt(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=sx(r,"b")),this.hasFormat("italic")&&(r=sx(r,"i")),this.hasFormat("strikethrough")&&(r=sx(r,"s")),this.hasFormat("underline")&&(r=sx(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(e,r){}setFormat(e){const r=this.getWritable();return r.__format=typeof e=="string"?Wu[e]:e,r}setDetail(e){const r=this.getWritable();return r.__detail=typeof e=="string"?Oq[e]:e,r}setStyle(e){const r=this.getWritable();return r.__style=e,r}toggleFormat(e){const r=$1(this.getFormat(),e,null);return this.setFormat(r)}toggleDirectionless(){const e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){const e=this.getWritable();return e.__detail^=2,e}setMode(e){const r=Bq[e];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(e){if(this.__text===e)return this;const r=this.getWritable();return r.__text=e,r}select(e,r){Cs();let n=e,s=r;const a=Ct(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const l=i.length;n===void 0&&(n=l),s===void 0&&(s=l)}else n=0,s=0;if(!dt(a))return xR(o,n,o,s,"text","text");{const l=ec();l!==a.anchor.key&&l!==a.focus.key||Ts(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const e=this.getTextContentSize();return this.select(e,e)}spliceText(e,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let l=e;l<0&&(l=o+l,l<0&&(l=0));const u=Ct();if(s&&dt(u)){const g=e+o;u.setTextNodeRange(a,g,a,g)}const d=i.slice(0,l)+n+i.slice(l+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){Cs();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=ec(),i=n.length;e.sort((C,F)=>C-F),e.push(i);const o=[],l=e.length;for(let C=0,F=0;C<i&&F<=l;F++){const P=e[F];P>C&&(o.push(n.slice(C,P)),C=P)}const u=o.length;if(u===1)return[r];const d=o[0],g=r.getParent();let h;const p=r.getFormat(),x=r.getStyle(),v=r.__detail;let w=!1,S=null,_=null;const y=Ct();if(dt(y)){const[C,F]=y.isBackward()?[y.focus,y.anchor]:[y.anchor,y.focus];C.type==="text"&&C.key===s&&(S=C),F.type==="text"&&F.key===s&&(_=F)}r.isSegmented()?(h=Cn(d),h.__format=p,h.__style=x,h.__detail=v,h.__state=O6(r,h),w=!0):h=r.setTextContent(d);const k=[h];for(let C=1;C<u;C++){const F=Cn(o[C]);F.__format=p,F.__style=x,F.__detail=v,F.__state=O6(r,F);const P=F.__key;a===s&&Ts(P),k.push(F)}const N=S?S.offset:null,E=_?_.offset:null;let A=0;for(const C of k){if(!S&&!_)break;const F=A+C.getTextContentSize();if(S!==null&&N!==null&&N<=F&&N>=A&&(S.set(C.getKey(),N-A,"text"),N<F&&(S=null)),_!==null&&E!==null&&E<=F&&E>=A){_.set(C.getKey(),E-A,"text");break}A=F}if(g!==null){(function(P){const M=P.getPreviousSibling(),I=P.getNextSibling();M!==null&&W1(M),I!==null&&W1(I)})(this);const C=g.getWritable(),F=this.getIndexWithinParent();w?(C.splice(F,0,k),this.remove()):C.splice(F,1,k),dt(y)&&L1(y,g,F,u-1)}return k}mergeWithSibling(e){const r=e===this.getPreviousSibling();r||e===this.getNextSibling()||pt(50);const n=this.__key,s=e.__key,a=this.__text,i=a.length;ec()===s&&Ts(n);const o=Ct();if(dt(o)){const g=o.anchor,h=o.focus;g!==null&&g.key===s&&sA(g,r,n,e,i),h!==null&&h.key===s&&sA(h,r,n,e,i)}const l=e.__text,u=r?l+a:a+l;this.setTextContent(u);const d=this.getWritable();return e.remove(),d}isTextEntity(){return!1}}function fZ(t){return{forChild:hT(t.style),node:null}}function hZ(t){const e=t,r=e.style.fontWeight==="normal";return{forChild:hT(e.style,r?void 0:"bold"),node:null}}const Y6=new WeakMap;function gZ(t){if(!Zr(t))return!1;if(t.nodeName==="PRE")return!0;const e=t.style.whiteSpace;return typeof e=="string"&&e.startsWith("pre")}function mZ(t){const e=t;t.parentElement===null&&pt(129);let r=e.textContent||"";if(function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=Y6.get(a))===void 0&&!gZ(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let l=0;l<i.length;l++)Y6.set(i[l],o);return o}(e)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(Do()):o==="	"?s.push(bh()):o!==""&&s.push(Cn(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=e,s=!0;for(;n!==null&&(n=J6(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=e,s=!0;for(;n!==null&&(n=J6(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:Cn(r)}}function J6(t,e){let r=t;for(;;){let n;for(;(n=e?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,Zr(r)){const a=r.style.display;if(a===""&&!RS(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=e?r.firstChild:r.lastChild)!==null;)r=s;if(Nl(r))return r;if(r.nodeName==="BR")return null}}const pZ={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Jo(t){const e=pZ[t.nodeName.toLowerCase()];return e===void 0?{node:null}:{forChild:hT(t.style,e),node:null}}function Cn(t=""){return fa(new $c(t))}function Tt(t){return t instanceof $c}function hT(t,e){const r=t.fontWeight,n=t.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=t.fontStyle==="italic",o=n.includes("underline"),l=t.verticalAlign;return u=>(Tt(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),l!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),l!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),e&&!u.hasFormat(e)&&u.toggleFormat(e)),u)}class xm extends $c{static getType(){return"tab"}static clone(e){return new xm(e.__key)}constructor(e){super("	",e),this.__detail=2}static importDOM(){return null}createDOM(e){const r=super.createDOM(e),n=jf(e.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(e){return bh().updateFromJSON(e)}setTextContent(e){return e!=="	"&&e!==""&&pt(126),super.setTextContent("	")}spliceText(e,r,n,s){return n===""&&r===0||n==="	"&&r===1||pt(286),this}setDetail(e){return e!==2&&pt(127),this}setMode(e){return e!=="normal"&&pt(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function bh(){return fa(new xm)}function Tv(t){return t instanceof xm}class xZ{constructor(e,r,n){this._selection=null,this.key=e,this.offset=r,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){return this.key===e.key?this.offset<e.offset:LR(vi(_l(this,"next")),vi(_l(e,"next")))<0}getNode(){const e=Kn(this.key);return e===null&&pt(20),e}set(e,r,n,s){const a=this._selection,i=this.key;s&&this.key===e&&this.offset===r&&this.type===n||(this.key=e,this.offset=r,this.type=n,ym()||(ec()===i&&Ts(e),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function Ro(t,e,r){return new xZ(t,e,r)}function u2(t,e){let r=e.__key,n=t.offset,s="element";if(Tt(e)){s="text";const a=e.getTextContentSize();n>a&&(n=a)}else if(!Je(e)){const a=e.getNextSibling();if(Tt(a))r=a.__key,n=0,s="text";else{const i=e.getParent();i&&(r=i.__key,n=e.getIndexWithinParent()+1)}}t.set(r,n,s)}function Q6(t,e){if(Je(e)){const r=e.getLastDescendant();Je(r)||Tt(r)?u2(t,r):u2(t,e)}else u2(t,e)}class Ev{constructor(e){this._cachedNodes=null,this._nodes=e,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Bs(e))return!1;const r=this._nodes,n=e._nodes;return r.size===n.size&&Array.from(r).every(s=>n.has(s))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Ev(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(e){}insertText(){}insertNodes(e){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(Tt(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(e);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const r=this._nodes,n=[];for(const s of r){const a=Kn(s);a!==null&&n.push(a)}return ym()||(this._cachedNodes=n),n}getTextContent(){const e=this.getNodes();let r="";for(let n=0;n<e.length;n++)r+=e[n].getTextContent();return r}deleteNodes(){const e=this.getNodes();if((Ct()||Sh())===this&&e[0]){const r=As(e[0],"next");tee(kc(r,r))}for(const r of e)r.remove()}}function dt(t){return t instanceof md}class md{constructor(e,r,n,s){this.anchor=e,this.focus=r,e._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!dt(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const e=this._cachedNodes;if(e!==null)return e;const r=function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,l=new Set;for(const u of n)if(Po(u)){const{origin:d}=u;s.length===0?o.add(d):(l.add(d),s.push(d))}else{const{origin:d}=u;Je(d)&&l.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),Xu(n.focus)&&Je(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=Ti(n.focus.origin,"previous");Po(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=MT(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!Je(u)||l.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=vi(n.anchor),d=vi(n.anchor.getFlipped()),g=p=>gc(p)?p.origin:p.getNodeAtCaret(),h=g(u)||g(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(h)}return s}($R(kA(this),"next"));return ym()||(this._cachedNodes=r),r}setTextNodeRange(e,r,n,s){this.anchor.set(e.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const e=this.getNodes();if(e.length===0)return"";const r=e[0],n=e[e.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,l]=ES(this);let u="",d=!0;for(let g=0;g<e.length;g++){const h=e[g];if(Je(h)&&!h.isInline())d||(u+=`
`),d=!h.isEmpty();else if(d=!1,Tt(h)){let p=h.getTextContent();h===r?h===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(p=o<l?p.slice(o,l):p.slice(l,o)):p=i?p.slice(o):p.slice(l):h===n&&(p=i?p.slice(0,l):p.slice(0,o)),u+=p}else!jr(h)&&!ul(h)||h===n&&this.isCollapsed()||(u+=h.getTextContent())}return u}applyDOMRange(e){const r=yn(),n=r.getEditorState()._selection,s=pR(e.startContainer,e.startOffset,e.endContainer,e.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),F1(this)}clone(){const e=this.anchor,r=this.focus;return new md(Ro(e.key,e.offset,e.type),Ro(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(e){this.format=$1(this.format,e,null),this.dirty=!0}setFormat(e){this.format=e,this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){const r=Wu[e];return!!(this.format&r)}insertRawText(e){const r=e.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(Do()):i==="	"?n.push(bh()):n.push(Cn(i))}this.insertNodes(n)}insertText(e){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&function(w,S,_,y){const k=w.getNode(),N=k.getChildAtIndex(w.offset),E=Cn();if(E.setFormat(_),E.setStyle(y),wT(N))N.splice(0,0,[E]);else{const A=rs(k)?qr().append(E):E;N===null?k.append(A):N.insertBefore(A)}w.is(S)&&S.set(E.__key,0,"text"),w.set(E.__key,0,"text")}(i,o,s,a),o.type==="element"&&Ju(o,vi(_l(o,"next")));const l=i.offset;let u=o.offset;const d=this.getNodes(),g=d.length;let h=d[0];Tt(h)||pt(26);const p=h.getTextContent().length,x=h.getParentOrThrow();let v=d[g-1];if(g===1&&o.type==="element"&&(u=p,o.set(i.key,u,"text")),this.isCollapsed()&&l===p&&(el(h)||!h.canInsertTextAfter()||!x.canInsertTextAfter()&&h.getNextSibling()===null)){let w=h.getNextSibling();if(Tt(w)&&w.canInsertTextBefore()&&!el(w)||(w=Cn(),w.setFormat(s),w.setStyle(a),x.canInsertTextAfter()?h.insertAfter(w):x.insertAfter(w)),w.select(0,0),h=w,e!=="")return void this.insertText(e)}else if(this.isCollapsed()&&l===0&&(el(h)||!h.canInsertTextBefore()||!x.canInsertTextBefore()&&h.getPreviousSibling()===null)){let w=h.getPreviousSibling();if(Tt(w)&&!el(w)||(w=Cn(),w.setFormat(s),x.canInsertTextBefore()?h.insertBefore(w):x.insertBefore(w)),w.select(),h=w,e!=="")return void this.insertText(e)}else if(h.isSegmented()&&l!==p){const w=Cn(h.getTextContent());w.setFormat(s),h.replace(w),h=w}else if(!this.isCollapsed()&&e!==""){const w=v.getParent();if(!x.canInsertTextBefore()||!x.canInsertTextAfter()||Je(w)&&(!w.canInsertTextBefore()||!w.canInsertTextAfter()))return this.insertText(""),mR(this.anchor,this.focus,null),void this.insertText(e)}if(g===1){if(Eu(h)){const y=Cn(e);return y.select(),void h.replace(y)}const w=h.getFormat(),S=h.getStyle();if(l!==u||w===s&&S===a){if(Tv(h)){const y=Cn(e);return y.setFormat(s),y.setStyle(a),y.select(),void h.replace(y)}}else{if(h.getTextContent()!==""){const y=Cn(e);if(y.setFormat(s),y.setStyle(a),y.select(),l===0)h.insertBefore(y,!1);else{const[k]=h.splitText(l);k.insertAfter(y,!1)}return void(y.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length))}h.setFormat(s),h.setStyle(a)}const _=u-l;h=h.spliceText(l,_,e,!0),h.getTextContent()===""?h.remove():this.anchor.type==="text"&&(h.isComposing()?this.anchor.offset-=e.length:(this.format=w,this.style=S))}else{const w=new Set([...h.getParentKeys(),...v.getParentKeys()]),S=Je(h)?h:h.getParentOrThrow();let _=Je(v)?v:v.getParentOrThrow(),y=v;if(!S.is(_)&&_.isInline())do y=_,_=_.getParentOrThrow();while(_.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(Tt(v)&&!Eu(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const C=Cn(v.getTextContent());v.replace(C),v=C}rs(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),w.add(v.__key)}else{const C=v.getParentOrThrow();C.canBeEmpty()||C.getChildrenSize()!==1?v.remove():C.remove()}else w.add(v.__key);const k=_.getChildren(),N=new Set(d),E=S.is(_),A=S.isInline()&&h.getNextSibling()===null?S:h;for(let C=k.length-1;C>=0;C--){const F=k[C];if(F.is(h)||Je(F)&&F.isParentOf(h))break;F.isAttached()&&(!N.has(F)||F.is(y)?E||A.insertAfter(F,!1):F.remove())}if(!E){let C=_,F=null;for(;C!==null;){const P=C.getChildren(),M=P.length;(M===0||P[M-1].is(F))&&(w.delete(C.__key),F=C),C=C.getParent()}}if(Eu(h))if(l===p)h.select();else{const C=Cn(e);C.select(),h.replace(C)}else h=h.spliceText(l,p-l,e,!0),h.getTextContent()===""?h.remove():h.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=e.length);for(let C=1;C<g;C++){const F=d[C],P=F.__key;w.has(P)||F.remove()}}}removeText(){const e=Ct()===this;Hx(this,ree(kA(this))),e&&Ct()!==this&&Fs(this)}formatText(e,r=null){if(this.isCollapsed())return this.toggleFormat(e),void Ts(null);const n=this.getNodes(),s=[];for(const k of n)Tt(k)&&s.push(k);const a=k=>{n.forEach(N=>{if(Je(N)){const E=N.getFormatFlags(e,k);N.setTextFormat(E)}})},i=s.length;if(i===0)return this.toggleFormat(e),Ts(null),void a(r);const o=this.anchor,l=this.focus,u=this.isBackward(),d=u?l:o,g=u?o:l;let h=0,p=s[0],x=d.type==="element"?0:d.offset;if(d.type==="text"&&x===p.getTextContentSize()&&(h=1,p=s[1],x=0),p==null)return;const v=p.getFormatFlags(e,r);a(v);const w=i-1;let S=s[w];const _=g.type==="text"?g.offset:S.getTextContentSize();if(p.is(S)){if(x===_)return;if(el(p)||x===0&&_===p.getTextContentSize())p.setFormat(v);else{const k=p.splitText(x,_),N=x===0?k[0]:k[1];N.setFormat(v),d.type==="text"&&d.set(N.__key,0,"text"),g.type==="text"&&g.set(N.__key,_-x,"text")}return void(this.format=v)}x===0||el(p)||([,p]=p.splitText(x),x=0),p.setFormat(v);const y=S.getFormatFlags(e,v);_>0&&(_===S.getTextContentSize()||el(S)||([S]=S.splitText(_)),S.setFormat(y));for(let k=h+1;k<w;k++){const N=s[k],E=N.getFormatFlags(e,y);N.setFormat(E)}d.type==="text"&&d.set(p.__key,x,"text"),g.type==="text"&&g.set(S.__key,_,"text"),this.format=v|y}insertNodes(e){if(e.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const x=Ct();return dt(x)||pt(134),x.insertNodes(e)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=m2(r,xi),s=e[e.length-1];if(Je(n)&&"__language"in n){if("__language"in e[0])this.insertText(e[0].getTextContent());else{const x=d2(this);n.splice(x,0,e),s.selectEnd()}return}if(!e.some(x=>(Je(x)||jr(x))&&!x.isInline())){Je(n)||pt(211,r.constructor.name,r.getType());const x=d2(this);return n.splice(x,0,e),void s.selectEnd()}const a=function(x){const v=qr();let w=null;for(let S=0;S<x.length;S++){const _=x[S],y=ul(_);if(y||jr(_)&&_.isInline()||Je(_)&&_.isInline()||Tt(_)||_.isParentRequired()){if(w===null&&(w=_.createParentElementNode(),v.append(w),y))continue;w!==null&&w.append(_)}else v.append(_),w=null}return v}(e),i=a.getLastDescendant(),o=a.getChildren(),l=!Je(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var g;Je(g=d)&&xi(g)&&!g.isEmpty()&&Je(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(Je(n)||pt(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&pt(212,r.constructor.name,r.getType()),function(x,v,w){const S=v.getParentOrThrow().getLastChild();let _=v;const y=[v];for(;_!==S;)_.getNextSibling()||pt(140),_=_.getNextSibling(),y.push(_);let k=x;for(const N of y)k=k.insertAfter(N)}(n,d));const h=m2(i,xi);l&&Je(h)&&(l.canMergeWhenEmpty()||xi(u))&&(h.append(...l.getChildren()),l.remove()),Je(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const p=Je(n)?n.getLastChild():null;ul(p)&&h!==n&&p.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=qr();return on().splice(this.anchor.offset,0,[i]),i.select(),i}const e=d2(this),r=m2(this.anchor.getNode(),xi);Je(r)||pt(213);const n=r.getChildAtIndex(e),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(e){const r=Do();if(this.insertNodes([r]),e){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const e=this.getNodes(),r=e.length,n=r-1,s=this.anchor,a=this.focus;let i=e[0],o=e[n];const[l,u]=ES(this);if(r===0)return[];if(r===1){if(Tt(i)&&!this.isCollapsed()){const g=l>u?u:l,h=l>u?l:u,p=i.splitText(g,h),x=g===0?p[0]:p[1];return x!=null?[x]:[]}return[i]}const d=s.isBefore(a);if(Tt(i)){const g=d?l:u;g===i.getTextContentSize()?e.shift():g!==0&&([,i]=i.splitText(g),e[0]=i)}if(Tt(o)){const g=o.getTextContent().length,h=d?u:l;h===0?e.pop():h!==g&&([o]=o.splitText(h),e[n]=o)}return e}modify(e,r,n){if(aA(this,e,r,n))return;const s=e==="move",a=yn(),i=to(Ci(a));if(!i)return;const o=a._blockCursorElement,l=a._rootElement,u=this.focus.getNode();if(l===null||o===null||!Je(u)||u.isInline()||u.canBeEmpty()||PS(o,a,l),this.dirty){let d=Gu(a,this.anchor.key),g=Gu(a,this.focus.key);this.anchor.type==="text"&&(d=qf(d)),this.focus.type==="text"&&(g=qf(g)),d&&g&&yR(i,d,this.anchor.offset,g,this.focus.offset)}if(function(d,g,h,p){d.modify(g,h,p)}(i,e,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),g=this.anchor.getNode(),h=rs(g)?g:UZ(g);if(this.applyDOMRange(d),this.dirty=!0,!s){const p=this.getNodes(),x=[];let v=!1;for(let w=0;w<p.length;w++){const S=p[w];FS(S,h)?x.push(S):v=!0}if(v&&x.length>0)if(r){const w=x[0];Je(w)?w.selectStart():w.getParentOrThrow().selectStart()}else{const w=x[x.length-1];Je(w)?w.selectEnd():w.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||function(w){const S=w.focus,_=w.anchor,y=_.key,k=_.offset,N=_.type;_.set(S.key,S.offset,S.type,!0),S.set(y,k,N,!0)}(this)}}n==="lineboundary"&&aA(this,e,r,n,"decorators")}forwardDeletion(e,r,n){if(!n&&(e.type==="element"&&Je(r)&&e.offset===r.getChildrenSize()||e.type==="text"&&e.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(Je(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(e){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,e))return;const a=OT(_l(n,e?"previous":"next"));if(a.getTextSlices().every(o=>o===null||o.distance===0)){let o={type:"initial"};for(const l of a.iterNodeCarets("shadowRoot"))if(Po(l)){if(!l.origin.isInline()){if(l.origin.isShadowRoot()){if(o.type==="merge-block")break;if(Je(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=vi(l);Hx(this,kc(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:l,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(Xu(l)){if(Je(l.origin)){if(l.origin.isInline()){if(!l.origin.isParentOf(a.anchor.origin))break}else o={block:l.origin,type:"merge-next-block"};continue}if(jr(l.origin)){if(!l.origin.isIsolated())if(o.type==="merge-next-block"&&(l.origin.isKeyboardSelectable()||!l.origin.isInline())&&Je(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=gT();u.add(l.origin.getKey()),Fs(u)}else l.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:l,block:u}=o;return Hx(this,kc(!l.origin.isEmpty()&&u.isEmpty()?BT(As(u,l.direction)):a.anchor,l)),this.removeText()}}const i=this.focus;if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&n.offset===0&&Z6(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const l=i.offset,u=o.getTextContentSize();if(o.is(s)||e&&l!==u||!e&&l!==0)return void eA(o,e,l)}else if(s!==null&&s.isSegmented()){const l=n.offset,u=s.getTextContentSize();if(s.is(o)||e&&l!==0||!e&&l!==u)return void eA(s,e,l)}(function(l,u){const d=l.anchor,g=l.focus,h=d.getNode(),p=g.getNode();if(h===p&&d.type==="text"&&g.type==="text"){const x=d.offset,v=g.offset,w=x<v,S=w?x:v,_=w?v:x,y=_-1;S!==y&&function(k){return!(PR(k)||yZ(k))}(h.getTextContent().slice(S,_))&&(u?g.set(g.key,y,g.type):d.set(d.key,y,d.type))}})(this,e)}}if(this.removeText(),e&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&rs(n.getParent())&&n.getPreviousSibling()===null&&Z6(this,n)}}deleteLine(e){this.isCollapsed()&&this.modify("extend",e,"lineboundary"),this.isCollapsed()?this.deleteCharacter(e):this.removeText()}deleteWord(e){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,e))return;this.modify("extend",e,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Bs(t){return t instanceof Ev}function q6(t){const e=t.offset;if(t.type==="text")return e;const r=t.getNode();return e===r.getChildrenSize()?r.getTextContent().length:0}function ES(t){const e=t.getStartEndPoints();if(e===null)return[0,0];const[r,n]=e;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[q6(r),q6(n)]}function Z6(t,e){for(let r=e;r;r=r.getParent()){if(Je(r)){if(r.collapseAtStart(t))return!0;if(la(r))break}if(r.getPreviousSibling())break}return!1}const yZ=(()=>{try{const t=new RegExp("\\p{Emoji}","u"),e=t.test.bind(t);if(e("")&&e("#")&&e(""))return e}catch{}return()=>!1})();function eA(t,e,r){const n=t,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,e&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const l=s.join("").trim();l===""?n.remove():(n.setTextContent(l),n.select(o,o))}function tA(t,e,r,n){let s,a=e;if(Zr(t)){let i=!1;const o=t.childNodes,l=o.length,u=n._blockCursorElement;a===l&&(i=!0,a=l-1);let d=o[a],g=!1;if(d===u)d=o[a+1],g=!0;else if(u!==null){const h=u.parentNode;t===h&&e>Array.prototype.indexOf.call(h.children,u)&&a--}if(s=xf(d),Tt(s))a=mc(s,i?"next":"previous");else{let h=xf(t);if(h===null)return null;if(Je(h)){const p=n.getElementByKey(h.getKey());p===null&&pt(214),[h,a]=h.getDOMSlot(p).resolveChildIndex(h,p,t,e),Je(h)||pt(215),i&&a>=h.getChildrenSize()&&(a=Math.max(0,h.getChildrenSize()-1));let v=h.getChildAtIndex(a);if(Je(v)&&function(w,S,_){const y=w.getParent();return _===null||y===null||!y.canBeEmpty()||y!==_.getNode()}(v,0,r)){const w=i?v.getLastDescendant():v.getFirstDescendant();w===null?h=v:(v=w,h=Je(v)?v:v.getParentOrThrow()),a=0}Tt(v)?(s=v,h=null,a=mc(v,i?"next":"previous")):v!==h&&i&&!g&&(Je(h)||pt(216),a=Math.min(h.getChildrenSize(),a+1))}else{const p=h.getIndexWithinParent();a=e===0&&jr(h)&&xf(t)===h?p:p+1,h=h.getParentOrThrow()}if(Je(h))return Ro(h.__key,a,"element")}}else s=xf(t);return Tt(s)?Ro(s.__key,mc(s,a,"clamp"),"text"):null}function rA(t,e,r){const n=t.offset,s=t.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(e){if((r||!e)&&a===null&&Je(i)&&i.isInline()){const o=i.getPreviousSibling();Tt(o)&&t.set(o.__key,o.getTextContent().length,"text")}}else Je(a)&&!r&&a.isInline()?t.set(a.__key,a.getChildrenSize(),"element"):Tt(a)&&t.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(e&&Je(a)&&a.isInline())t.set(a.__key,0,"element");else if((r||e)&&a===null&&Je(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();Tt(o)&&t.set(o.__key,0,"text")}}}function mR(t,e,r){if(t.type==="text"&&e.type==="text"){const n=t.isBefore(e),s=t.is(e);rA(t,n,s),rA(e,!n,s),s&&e.set(t.key,t.offset,t.type);const a=yn();if(a.isComposing()&&a._compositionKey!==t.key&&dt(r)){const i=r.anchor,o=r.focus;t.set(i.key,i.offset,i.type,!0),e.set(o.key,o.offset,o.type,!0)}}}function pR(t,e,r,n,s,a){if(t===null||r===null||!_m(s,t,r))return null;const i=tA(t,e,dt(a)?a.anchor:null,s);if(i===null)return null;const o=tA(r,n,dt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const l=xf(t),u=xf(r);if(jr(l)&&jr(u))return null}return mR(i,o,a),[i,o]}function NS(t){return Je(t)&&!t.isInline()}function xR(t,e,r,n,s,a){const i=Wc(),o=new md(Ro(t,e,s),Ro(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function Nv(){const t=Ro("root",0,"element"),e=Ro("root",0,"element");return new md(t,e,0,"")}function gT(){return new Ev(new Set)}function mT(t,e,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",l=!fS&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,g,h;if(dt(t)&&!l)return t.clone();if(e===null)return null;if(u=e.anchorNode,d=e.focusNode,g=e.anchorOffset,h=e.focusOffset,o&&dt(t)&&!_m(r,u,d))return t.clone();const p=pR(u,g,d,h,r,t);if(p===null)return null;const[x,v]=p;return new md(x,v,dt(t)?t.format:0,dt(t)?t.style:"")}function Ct(){return Wc()._selection}function Sh(){return yn()._editorState._selection}function L1(t,e,r,n=1){const s=t.anchor,a=t.focus,i=s.getNode(),o=a.getNode();if(!e.is(i)&&!e.is(o))return;const l=e.__key;if(t.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(l,d,"element"),a.set(l,d,"element"),nA(t)}}else{const u=t.isBackward(),d=u?a:s,g=d.getNode(),h=u?s:a,p=h.getNode();if(e.is(g)){const x=d.offset;(r<=x&&n>0||r<x&&n<0)&&d.set(l,Math.max(0,x+n),"element")}if(e.is(p)){const x=h.offset;(r<=x&&n>0||r<x&&n<0)&&h.set(l,Math.max(0,x+n),"element")}}nA(t)}function nA(t){const e=t.anchor,r=e.offset,n=t.focus,s=n.offset,a=e.getNode(),i=n.getNode();if(t.isCollapsed()){if(!Je(a))return;const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(Tt(u)){let d=0;l&&(d=u.getTextContentSize()),e.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(Je(a)){const o=a.getChildrenSize(),l=r>=o,u=l?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(Tt(u)){let d=0;l&&(d=u.getTextContentSize()),e.set(u.__key,d,"text")}}if(Je(i)){const o=i.getChildrenSize(),l=s>=o,u=l?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(Tt(u)){let d=0;l&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function B1(t,e,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,Tt(n)?(i=n.getTextContentSize(),o="text"):Je(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,Tt(s)?o="text":Je(s)&&(o="element")),a!==null&&o!==null?t.set(a,i,o):(i=e.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),t.set(r.__key,i,"element"))}function sA(t,e,r,n,s){t.type==="text"?t.set(r,t.offset+(e?0:s),"text"):t.offset>n.getIndexWithinParent()&&t.set(t.key,t.offset-1,"element")}function yR(t,e,r,n,s){try{t.setBaseAndExtent(e,r,n,s)}catch{}}function vZ(t,e,r,n,s,a,i){const o=n.anchorNode,l=n.focusNode,u=n.anchorOffset,d=n.focusOffset,g=document.activeElement;if(s.has(kR)&&g!==a||g!==null&&ST(g))return;if(!dt(e))return void(t!==null&&_m(r,o,l)&&n.removeAllRanges());const h=e.anchor,p=e.focus,x=h.key,v=p.key,w=Gu(r,x),S=Gu(r,v),_=h.offset,y=p.offset,k=e.format,N=e.style,E=e.isCollapsed();let A=w,C=S,F=!1;if(h.type==="text"){A=qf(w);const L=h.getNode();F=L.getFormat()!==k||L.getStyle()!==N}else dt(t)&&t.anchor.type==="text"&&(F=!0);var P,M,I,Y,se;if(p.type==="text"&&(C=qf(S)),A!==null&&C!==null&&(E&&(t===null||F||dt(t)&&(t.format!==k||t.style!==N))&&(P=k,M=N,I=_,Y=x,se=performance.now(),oR=[P,M,I,Y,se]),u!==_||d!==y||o!==A||l!==C||n.type==="Range"&&E||(g!==null&&a.contains(g)||a.focus({preventScroll:!0}),h.type==="element"))){if(yR(n,A,_,C,y),!s.has(TZ)&&e.isCollapsed()&&a!==null&&a===document.activeElement){const L=dt(e)&&e.anchor.type==="element"?A.childNodes[_]||null:n.rangeCount>0?n.getRangeAt(0):null;if(L!==null){let z;if(L instanceof Text){const G=document.createRange();G.selectNode(L),z=G.getBoundingClientRect()}else z=L.getBoundingClientRect();(function(G,O,R){const X=IR(R),te=AT(X);if(X===null||te===null)return;let{top:H,bottom:V}=O,q=0,Q=0,ae=R;for(;ae!==null;){const J=ae===X.body;if(J)q=0,Q=Ci(G).innerHeight;else{const ve=ae.getBoundingClientRect();q=ve.top,Q=ve.bottom}let re=0;if(H<q?re=-(q-H):V>Q&&(re=V-Q),re!==0)if(J)te.scrollBy(0,re);else{const ve=ae.scrollTop;ae.scrollTop+=re;const we=ae.scrollTop-ve;H-=we,V-=we}if(J)break;ae=bm(ae)}})(r,z,a)}}kS=!0}}function wZ(t){let e=Ct()||Sh();e===null&&(e=on().selectEnd()),e.insertNodes(t)}function d2(t){let e=t;t.isCollapsed()||e.removeText();const r=Ct();dt(r)&&(e=r),dt(e)||pt(161);const n=e.anchor;let s=n.getNode(),a=n.offset;for(;!xi(s);){const i=s;if([s,a]=_Z(s,a),i.is(s))break}return a}function _Z(t,e){const r=t.getParent();if(!r){const s=qr();return on().append(s),s.select(),[on(),0]}if(Tt(t)){const s=t.splitText(e);if(s.length===0)return[r,t.getIndexWithinParent()];const a=e===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!Je(t)||e===0)return[r,t.getIndexWithinParent()];const n=t.getChildAtIndex(e);if(n){const s=new md(Ro(t.__key,e,"element"),Ro(t.__key,e,"element"),0,""),a=t.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,t.getIndexWithinParent()+1]}function aA(t,e,r,n,s="decorators-and-blocks"){if(e==="move"&&n==="character"&&!t.isCollapsed()){const[d,g]=r===t.isBackward()?[t.focus,t.anchor]:[t.anchor,t.focus];return g.set(d.key,d.offset,d.type),!0}const a=_l(t.focus,r?"previous":"next"),i=n==="lineboundary",o=e==="move";let l=a,u=s==="decorators-and-blocks";if(!UR(l)){for(const d of l){u=!1;const{origin:g}=d;if(!jr(g)||g.isIsolated()||(l=d,!i||!g.isInline()))break}if(u)for(const d of OT(a).iterNodeCarets(e==="extend"?"shadowRoot":"root")){if(Po(d))d.origin.isInline()||(l=d);else{if(Je(d.origin))continue;jr(d.origin)&&!d.origin.isInline()&&(l=d)}break}}if(l===a)return!1;if(o&&!i&&jr(l.origin)&&l.origin.isKeyboardSelectable()){const d=gT();return d.add(l.origin.getKey()),Fs(d),!0}return l=vi(l),o&&Ju(t.anchor,l),Ju(t.focus,l),u||!i}let fs=null,hs=null,Aa=!1,f2=!1,$x=0;const iA={characterData:!0,childList:!0,subtree:!0};function ym(){return Aa||fs!==null&&fs._readOnly}function Cs(){Aa&&pt(13)}function vR(){$x>99&&pt(14)}function Wc(){return fs===null&&pt(195,wR()),fs}function yn(){return hs===null&&pt(196,wR()),hs}function wR(){let t=0;const e=new Set,r=Fv.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=Pv(s);if(kT(a))t++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),e.add(i)}}let n=` Detected on the page: ${t} compatible editor(s) with version ${r}`;return e.size&&(n+=` and incompatible editors with versions ${Array.from(e).join(", ")}`),n}function bZ(){return hs}function oA(t,e,r){const n=e.__type,s=TR(t,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](e),e.isAttached());o++);}function lA(t,e){return t!==void 0&&t.__key!==e&&t.isAttached()}function _R(t,e){if(!e)return;const r=t._updateTags;let n=e;Array.isArray(e)||(n=[e]);for(const s of n)r.add(s)}function SZ(t){return pT(t,yn()._nodes)}function pT(t,e){const r=t.type,n=e.get(r);n===void 0&&pt(17,r);const s=n.klass;t.type!==s.getType()&&pt(18,s.name);const a=s.importJSON(t),i=t.children;if(Je(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const l=pT(i[o],e);a.append(l)}return a}function cA(t,e,r){const n=fs,s=Aa,a=hs;fs=e,Aa=!0,hs=t;try{return r()}finally{fs=n,Aa=s,hs=a}}function nl(t,e){const r=t._pendingEditorState,n=t._rootElement,s=t._headless||n===null;if(r===null)return;const a=t._editorState,i=a._selection,o=r._selection,l=t._dirtyType!==$u,u=fs,d=Aa,g=hs,h=t._updating,p=t._observer;let x=null;if(t._pendingEditorState=null,t._editorState=r,!s&&l&&p!==null){hs=t,fs=r,Aa=!1,t._updating=!0;try{const E=t._dirtyType,A=t._dirtyElements,C=t._dirtyLeaves;p.disconnect(),x=Qq(a,r,t,E,A,C)}catch(E){if(E instanceof Error&&t._onError(E),f2)throw E;return CR(t,null,n,r),L9(t),t._dirtyType=Qf,f2=!0,nl(t,a),void(f2=!1)}finally{p.observe(n,iA),t._updating=h,fs=u,Aa=d,hs=g}}r._readOnly||(r._readOnly=!0);const v=t._dirtyLeaves,w=t._dirtyElements,S=t._normalizedNodes,_=t._updateTags,y=t._deferred;l&&(t._dirtyType=$u,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements=new Map,t._normalizedNodes=new Set,t._updateTags=new Set),function(E,A){const C=E._decorators;let F=E._pendingDecorators||C;const P=A._nodeMap;let M;for(M in F)P.has(M)||(F===C&&(F=jR(E)),delete F[M])}(t,r);const k=s?null:to(Ci(t));if(t._editable&&k!==null&&(l||o===null||o.dirty)&&n!==null&&!_.has(EZ)){hs=t,fs=r;try{if(p!==null&&p.disconnect(),l||o===null||o.dirty){const E=t._blockCursorElement;E!==null&&PS(E,t,n),vZ(i,o,t,k,_,n)}(function(E,A,C){let F=E._blockCursorElement;if(dt(C)&&C.isCollapsed()&&C.anchor.type==="element"&&A.contains(document.activeElement)){const P=C.anchor,M=P.getNode(),I=P.offset;let Y=!1,se=null;if(I===M.getChildrenSize())g2(M.getChildAtIndex(I-1))&&(Y=!0);else{const L=M.getChildAtIndex(I);if(L!==null&&g2(L)){const z=L.getPreviousSibling();(z===null||g2(z))&&(Y=!0,se=E.getElementByKey(L.__key))}}if(Y){const L=E.getElementByKey(M.__key);return F===null&&(E._blockCursorElement=F=function(z){const G=z.theme,O=document.createElement("div");O.contentEditable="false",O.setAttribute("data-lexical-cursor","true");let R=G.blockCursor;if(R!==void 0){if(typeof R=="string"){const X=D9(R);R=G.blockCursor=X}R!==void 0&&O.classList.add(...R)}return O}(E._config)),A.style.caretColor="transparent",void(se===null?L.appendChild(F):L.insertBefore(F,se))}}F!==null&&PS(F,E,A)})(t,n,o)}finally{p!==null&&p.observe(n,iA),hs=g,fs=u}}x!==null&&function(E,A,C,F,P){const M=Array.from(E._listeners.mutation),I=M.length;for(let Y=0;Y<I;Y++){const[se,L]=M[Y];for(const z of L){const G=A.get(z);G!==void 0&&se(G,{dirtyLeaves:F,prevEditorState:P,updateTags:C})}}}(t,x,_,v,a),dt(o)||o===null||i!==null&&i.is(o)||t.dispatchCommand(G9,void 0);const N=t._pendingDecorators;N!==null&&(t._decorators=N,t._pendingDecorators=null,G0("decorator",t,!0,N)),function(E,A,C){const F=gA(A),P=gA(C);F!==P&&G0("textcontent",E,!0,P)}(t,e||a,r),G0("update",t,!0,{dirtyElements:w,dirtyLeaves:v,editorState:r,mutatedNodes:x,normalizedNodes:S,prevEditorState:e||a,tags:_}),function(E,A){if(E._deferred=[],A.length!==0){const C=E._updating;E._updating=!0;try{for(let F=0;F<A.length;F++)A[F]()}finally{E._updating=C}}}(t,y),function(E){const A=E._updates;if(A.length!==0){const C=A.shift();if(C){const[F,P]=C;Av(E,F,P)}}}(t)}function G0(t,e,r,...n){const s=e._updating;e._updating=r;try{const a=Array.from(e._listeners[t]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{e._updating=s}}function uA(t,e){const r=t._updates;let n=e||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=t._pendingEditorState;let l;i!==void 0&&(l=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&pt(191),o._flushSync=!0),l&&t._deferred.push(l),_R(t,i.tag)),o==null?Av(t,a,i):a()}}return n}function Av(t,e,r){const n=t._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,_R(t,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&t._deferred.push(s);const o=t._editorState;let l=t._pendingEditorState,u=!1;(l===null||l._readOnly)&&(l=t._pendingEditorState=bR(l||o),u=!0),l._flushSync=i;const d=fs,g=Aa,h=hs,p=t._updating;fs=l,Aa=!1,t._updating=!0,hs=t;const x=t._headless||t.getRootElement()===null;_T(null);try{u&&(x?o._selection!==null&&(l._selection=o._selection.clone()):l._selection=function(_,y){const k=_.getEditorState()._selection,N=to(Ci(_));return dt(k)||k==null?mT(k,N,_,y):k.clone()}(t,r&&r.event||null));const w=t._compositionKey;e(),a=uA(t,a),function(_,y){const k=y.getEditorState()._selection,N=_._selection;if(dt(N)){const E=N.anchor,A=N.focus;let C;if(E.type==="text"&&(C=E.getNode(),C.selectionTransform(k,N)),A.type==="text"){const F=A.getNode();C!==F&&F.selectionTransform(k,N)}}}(l,t),t._dirtyType!==$u&&(a?function(_,y){const k=y._dirtyLeaves,N=_._nodeMap;for(const E of k){const A=N.get(E);Tt(A)&&A.isAttached()&&A.isSimpleText()&&!A.isUnmergeable()&&U6(A)}}(l,t):function(_,y){const k=y._dirtyLeaves,N=y._dirtyElements,E=_._nodeMap,A=ec(),C=new Map;let F=k,P=F.size,M=N,I=M.size;for(;P>0||I>0;){if(P>0){y._dirtyLeaves=new Set;for(const Y of F){const se=E.get(Y);Tt(se)&&se.isAttached()&&se.isSimpleText()&&!se.isUnmergeable()&&U6(se),se!==void 0&&lA(se,A)&&oA(y,se,C),k.add(Y)}if(F=y._dirtyLeaves,P=F.size,P>0){$x++;continue}}y._dirtyLeaves=new Set,y._dirtyElements=new Map,M.delete("root")&&M.set("root",!0);for(const Y of M){const se=Y[0],L=Y[1];if(N.set(se,L),!L)continue;const z=E.get(se);z!==void 0&&lA(z,A)&&oA(y,z,C)}F=y._dirtyLeaves,P=F.size,M=y._dirtyElements,I=M.size,$x++}y._dirtyLeaves=k,y._dirtyElements=N}(l,t),uA(t),function(_,y,k,N){const E=_._nodeMap,A=y._nodeMap,C=[];for(const[F]of N){const P=A.get(F);P!==void 0&&(P.isAttached()||(Je(P)&&M9(P,F,E,A,C,N),E.has(F)||N.delete(F),C.push(F)))}for(const F of C)A.delete(F);for(const F of k){const P=A.get(F);P===void 0||P.isAttached()||(E.has(F)||k.delete(F),A.delete(F))}}(o,l,t._dirtyLeaves,t._dirtyElements)),w!==t._compositionKey&&(l._flushSync=!0);const S=l._selection;if(dt(S)){const _=l._nodeMap,y=S.anchor.key,k=S.focus.key;_.get(y)!==void 0&&_.get(k)!==void 0||pt(19)}else Bs(S)&&S._nodes.size===0&&(l._selection=null)}catch(w){return w instanceof Error&&t._onError(w),t._pendingEditorState=o,t._dirtyType=Qf,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),void nl(t)}finally{fs=d,Aa=g,hs=h,t._updating=p,$x=0}t._dirtyType!==$u||t._deferred.length>0||function(w,S){const _=S.getEditorState()._selection,y=w._selection;if(y!==null){if(y.dirty||!y.is(_))return!0}else if(_!==null)return!0;return!1}(l,t)?l._flushSync?(l._flushSync=!1,nl(t)):u&&PZ(()=>{nl(t)}):(l._flushSync=!1,u&&(n.clear(),t._deferred=[],t._pendingEditorState=null))}function Ia(t,e,r){hs===t&&r===void 0?e():Av(t,e,r)}class V0{constructor(e,r,n){this.element=e,this.before=r||null,this.after=n||null}withBefore(e){return new V0(this.element,e,this.after)}withAfter(e){return new V0(this.element,this.before,e)}withElement(e){return this.element===e?this:new V0(e,this.before,this.after)}insertChild(e){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&pt(222),this.element.insertBefore(e,r),this}removeChild(e){return e.parentElement!==this.element&&pt(223),this.element.removeChild(e),this}replaceChild(e,r){return r.parentElement!==this.element&&pt(224),this.element.replaceChild(e,r),this}getFirstChild(){const e=this.after?this.after.nextSibling:this.element.firstChild;return e===this.before||e===this.getManagedLineBreak()?null:e}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(e){if(e===null)this.removeManagedLineBreak();else{const r=e==="decorator"&&(Jf||jg);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const e=this.getManagedLineBreak();if(e){const r=this.element,n=e.nodeName==="IMG"?e.nextSibling:null;n&&r.removeChild(n),r.removeChild(e),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(e){const r=this.getManagedLineBreak();if(r){if(e===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),e){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let e=0;for(let r=this.after;r!==null;r=r.previousSibling)e++;return e}resolveChildIndex(e,r,n,s){if(n===this.element){const l=this.getFirstChildOffset();return[e,Math.min(l+e.getChildrenSize(),Math.max(l,s))]}const a=dA(r,n);a.push(s);const i=dA(r,this.element);let o=e.getIndexWithinParent();for(let l=0;l<i.length;l++){const u=a[l],d=i[l];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[e.getParentOrThrow(),o]}}function dA(t,e){const r=[];let n=e;for(;n!==t&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==t&&pt(225),r.reverse()}class Js extends _h{constructor(e){super(e),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(e){super.afterCloneFrom(e),this.__key===e.__key&&(this.__first=e.__first,this.__last=e.__last,this.__size=e.__size),this.__indent=e.__indent,this.__format=e.__format,this.__style=e.__style,this.__dir=e.__dir,this.__textFormat=e.__textFormat,this.__textStyle=e.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const e=this.getFormat();return Lq[e]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const e=[];let r=this.getFirstChild();for(;r!==null;)e.push(r),r=r.getNextSibling();return e}getChildrenKeys(){const e=[];let r=this.getFirstChild();for(;r!==null;)e.push(r.__key),r=r.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const e=yn()._dirtyElements;return e!==null&&e.has(this.__key)}isLastChild(){const e=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(e)}getAllTextNodes(){const e=[];let r=this.getFirstChild();for(;r!==null;){if(Tt(r)&&e.push(r),Je(r)){const n=r.getAllTextNodes();e.push(...n)}r=r.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;Je(e);){const r=e.getFirstChild();if(r===null)break;e=r}return e}getLastDescendant(){let e=this.getLastChild();for(;Je(e);){const r=e.getLastChild();if(r===null)break;e=r}return e}getDescendantByIndex(e){const r=this.getChildren(),n=r.length;if(e>=n){const a=r[n-1];return Je(a)&&a.getLastDescendant()||a||null}const s=r[e];return Je(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const e=this.getLatest().__first;return e===null?null:Kn(e)}getFirstChildOrThrow(){const e=this.getFirstChild();return e===null&&pt(45,this.__key),e}getLastChild(){const e=this.getLatest().__last;return e===null?null:Kn(e)}getLastChildOrThrow(){const e=this.getLastChild();return e===null&&pt(96,this.__key),e}getChildAtIndex(e){const r=this.getChildrenSize();let n,s;if(e<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=e;){if(s===e)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=e;){if(s===e)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let e="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];e+=a.getTextContent(),Je(a)&&s!==n-1&&!a.isInline()&&(e+=wl)}return e}getTextContentSize(){let e=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];e+=a.getTextContentSize(),Je(a)&&s!==n-1&&!a.isInline()&&(e+=wl.length)}return e}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(e){if(e!==""){const r=P6[e];return!!(this.getFormat()&r)}return!1}hasTextFormat(e){const r=Wu[e];return!!(this.getTextFormat()&r)}getFormatFlags(e,r){return $1(this.getLatest().__textFormat,e,r)}getTextStyle(){return this.getLatest().__textStyle}select(e,r){Cs();const n=Ct();let s=e,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(e===0&&r===0){const l=this.getFirstChild();if(Tt(l)||Je(l))return l.select(0,0)}else if(!(e!==void 0&&e!==i||r!==void 0&&r!==i)){const l=this.getLastChild();if(Tt(l)||Je(l))return l.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return dt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):xR(o,s,o,a,"element","element")}selectStart(){const e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){const e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){const e=this.getWritable();return this.getChildren().forEach(r=>r.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){const r=this.getWritable();return r.__dir=e,r}setFormat(e){return this.getWritable().__format=e!==""?P6[e]:0,this}setStyle(e){return this.getWritable().__style=e||"",this}setTextFormat(e){const r=this.getWritable();return r.__textFormat=e,r}setTextStyle(e){const r=this.getWritable();return r.__textStyle=e,r}setIndent(e){return this.getWritable().__indent=e,this}splice(e,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();e+r<=a||pt(226,String(e),String(r),String(a));const o=i.__key,l=[],u=[],d=this.getChildAtIndex(e+r);let g=null,h=a-r+s;if(e!==0)if(e===a)g=this.getLastChild();else{const x=this.getChildAtIndex(e);x!==null&&(g=x.getPreviousSibling())}if(r>0){let x=g===null?this.getFirstChild():g.getNextSibling();for(let v=0;v<r;v++){x===null&&pt(100);const w=x.getNextSibling(),S=x.__key;Nu(x.getWritable()),u.push(S),x=w}}let p=g;for(let x=0;x<s;x++){const v=n[x];p!==null&&v.is(p)&&(g=p=p.getPreviousSibling());const w=v.getWritable();w.__parent===o&&h--,Nu(w);const S=v.__key;if(p===null)i.__first=S,w.__prev=null;else{const _=p.getWritable();_.__next=S,w.__prev=_.__key}v.__key===o&&pt(76),w.__parent=o,l.push(S),p=v}if(e+r===a)p!==null&&(p.getWritable().__next=null,i.__last=p.__key);else if(d!==null){const x=d.getWritable();if(p!==null){const v=p.getWritable();x.__prev=p.__key,v.__next=d.__key}else x.__prev=null}if(i.__size=h,u.length){const x=Ct();if(dt(x)){const v=new Set(u),w=new Set(l),{anchor:S,focus:_}=x;fA(S,v,w)&&B1(S,S.getNode(),this,g,d),fA(_,v,w)&&B1(_,_.getNode(),this,g,d),h!==0||this.canBeEmpty()||la(this)||this.remove()}}return i}getDOMSlot(e){return new V0(e)}exportDOM(e){const{element:r}=super.exportDOM(e);if(Zr(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const e={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(e.textFormat=r),n!==""&&(e.textStyle=n),e}updateFromJSON(e){return super.updateFromJSON(e).setFormat(e.format).setIndent(e.indent).setDirection(e.direction).setTextFormat(e.textFormat||0).setTextStyle(e.textStyle||"")}insertNewAfter(e,r){return null}canIndent(){return!0}collapseAtStart(e){return!1}excludeFromCopy(e){return!1}canReplaceWith(e){return!0}canInsertAfter(e){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(e){return!1}extractWithChild(e,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(e,r){const n=this.getDOMSlot(e);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function Je(t){return t instanceof Js}function fA(t,e,r){let n=t.getNode();for(;n;){const s=n.__key;if(e.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class xT extends _h{decorate(e,r){pt(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function jr(t){return t instanceof xT}class vm extends Js{static getType(){return"root"}static clone(){return new vm}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){pt(51)}getTextContent(){const e=this.__cachedText;return!ym()&&yn()._dirtyType!==$u||e===null?super.getTextContent():e}remove(){pt(52)}replace(e){pt(53)}insertBefore(e){pt(54)}insertAfter(e){pt(55)}updateDOM(e,r){return!1}splice(e,r,n){for(const s of n)Je(s)||jr(s)||pt(282);return super.splice(e,r,n)}static importJSON(e){return on().updateFromJSON(e)}collapseAtStart(){return!0}}function rs(t){return t instanceof vm}function bR(t){return new jv(new Map(t._nodeMap))}function yT(){return new jv(new Map([["root",new vm]]))}function SR(t){const e=t.exportJSON(),r=t.constructor;if(e.type!==r.getType()&&pt(130,r.name),Je(t)){const n=e.children;Array.isArray(n)||pt(59,r.name);const s=t.getChildren();for(let a=0;a<s.length;a++){const i=SR(s[a]);n.push(i)}}return e}class jv{constructor(e,r){this._nodeMap=e,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(e,r){return cA(r&&r.editor||null,this,e)}clone(e){const r=new jv(this._nodeMap,e===void 0?this._selection:e);return r._readOnly=!0,r}toJSON(){return cA(null,this,()=>({root:SR(on())}))}}const U1="historic",kZ="history-push",K0="history-merge",CZ="paste",kR="collaboration",TZ="skip-scroll-into-view",EZ="skip-dom-selection";class vT extends Js{static getType(){return"artificial"}createDOM(e){return document.createElement("div")}}class wm extends Js{static getType(){return"paragraph"}static clone(e){return new wm(e.__key)}createDOM(e){const r=document.createElement("p"),n=jf(e.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(e,r,n){return!1}static importDOM(){return{p:e=>({conversion:NZ,priority:0})}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Zr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(e){return qr().updateFromJSON(e)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(e,r){const n=qr();n.setTextFormat(e.format),n.setTextStyle(e.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const e=this.getChildren();if(e.length===0||Tt(e[0])&&e[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function NZ(t){const e=qr();return t.style&&(e.setFormat(t.style.textAlign),FT(t,e)),{node:e}}function qr(){return fa(new wm)}function wT(t){return t instanceof wm}const _r=0,Yd=1,AZ=4;function CR(t,e,r,n){const s=t._keyToDOMMap;s.clear(),t._editorState=yT(),t._pendingEditorState=n,t._compositionKey=null,t._dirtyType=$u,t._cloneNotNeeded.clear(),t._dirtyLeaves=new Set,t._dirtyElements.clear(),t._normalizedNodes=new Set,t._updateTags=new Set,t._updates=[],t._blockCursorElement=null;const a=t._observer;a!==null&&(a.disconnect(),t._observer=null),e!==null&&(e.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function jZ(t){const e=t||{},r=bZ(),n=e.theme||{},s=t===void 0?r:e.parentEditor||null,a=e.disableEvents||!1,i=yT(),o=e.namespace||(s!==null?s._config.namespace:DR()),l=e.editorState,u=[vm,$c,pm,xm,wm,vT,...e.nodes||[]],{onError:d,html:g}=e,h=e.editable===void 0||e.editable;let p;if(t===void 0&&r!==null)p=r._nodes;else{p=new Map;for(let v=0;v<u.length;v++){let w=u[v],S=null,_=null;if(typeof w!="function"){const A=w;w=A.replace,S=A.with,_=A.withKlass||null}const{ownNodeConfig:y}=PT(w),k=w.getType(),N=w.transform(),E=new Set;y&&y.$transform&&E.add(y.$transform),N!==null&&E.add(N),p.set(k,{exportDOM:g&&g.export?g.export.get(w):void 0,klass:w,replace:S,replaceWithKlass:_,sharedNodeState:Vq(u[v]),transforms:E})}}const x=new Fv(i,s,p,{disableEvents:a,namespace:o,theme:n},d||console.error,function(v,w){const S=new Map,_=new Set,y=k=>{Object.keys(k).forEach(N=>{let E=S.get(N);E===void 0&&(E=[],S.set(N,E)),E.push(k[N])})};return v.forEach(k=>{const N=k.klass.importDOM;if(N==null||_.has(N))return;_.add(N);const E=N.call(k.klass);E!==null&&y(E)}),w&&y(w),S}(p,g?g.import:void 0),h,t);return l!==void 0&&(x._pendingEditorState=l,x._dirtyType=Qf),x}class Fv{constructor(e,r,n,s,a,i,o,l){this._createEditorArgs=l,this._parentEditor=r,this._rootElement=null,this._editorState=e,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=$u,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=DR(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(e){const r=this._listeners.update;return r.add(e),()=>{r.delete(e)}}registerEditableListener(e){const r=this._listeners.editable;return r.add(e),()=>{r.delete(e)}}registerDecoratorListener(e){const r=this._listeners.decorator;return r.add(e),()=>{r.delete(e)}}registerTextContentListener(e){const r=this._listeners.textcontent;return r.add(e),()=>{r.delete(e)}}registerRootListener(e){const r=this._listeners.root;return e(this._rootElement,null),r.add(e),()=>{e(null,this._rootElement),r.delete(e)}}registerCommand(e,r,n){n===void 0&&pt(35);const s=this._commands;s.has(e)||s.set(e,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(e);a===void 0&&pt(36,String(e));const i=a[n];return i.add(r),()=>{i.delete(r),a.every(o=>o.size===0)&&s.delete(e)}}registerMutationListener(e,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(e)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(e){const r=this._nodes.get(e.getType());return r===void 0&&pt(37,e.name),r}resolveRegisteredNodeAfterReplacements(e){for(;e.replaceWithKlass;)e=this.getRegisteredNode(e.replaceWithKlass);return e}initializeMutationListener(e,r){const n=this._editorState,s=_A(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&e(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(e,r){const n=this.getRegisteredNode(e);return n.transforms.add(r),n}registerNodeTransform(e,r){const n=this.registerNodeTransformToKlass(e,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return function(i,o){const l=_A(i.getEditorState()),u=[];for(const d of o){const g=l.get(d);g&&u.push(g)}u.length!==0&&i.update(()=>{for(const d of u)for(const g of d.keys()){const h=Kn(g);h&&h.markDirty()}},i._pendingEditorState===null?{tag:K0}:void 0)}(this,s.map(i=>i.klass.getType())),()=>{s.forEach(i=>i.transforms.delete(r))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,r){return Mt(this,e,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){const r=this._rootElement;if(e!==r){const n=jf(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=e,CR(this,r,e,s),r!==null&&(this._config.disableEvents||uZ(r),n!=null&&r.classList.remove(...n)),e!==null){const a=AT(e),i=e.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=Qf,L9(this),this._updateTags.add(K0),nl(this),this._config.disableEvents||function(o,l){const u=o.ownerDocument,d=O1.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",fR),O1.set(u,(d||0)+1),o.__lexicalEditor=l;const g=dR(o);for(let h=0;h<SS.length;h++){const[p,x]=SS[h],v=typeof x=="function"?w=>{K6(w)||(V6(w),(l.isEditable()||p==="click")&&x(w,l))}:w=>{if(K6(w))return;V6(w);const S=l.isEditable();switch(p){case"cut":return S&&Mt(l,fT,w);case"copy":return Mt(l,Cv,w);case"paste":return S&&Mt(l,cT,w);case"dragstart":return S&&Mt(l,nR,w);case"dragover":return S&&Mt(l,sR,w);case"dragend":return S&&Mt(l,sZ,w);case"focus":return S&&Mt(l,oZ,w);case"blur":return S&&Mt(l,lZ,w);case"drop":return S&&Mt(l,tR,w)}};o.addEventListener(p,v),g.push(()=>{o.removeEventListener(p,v)})}}(e,this),n!=null&&e.classList.add(...n)}else this._window=null,this._updateTags.add(K0),nl(this);G0("root",this,!1,e,r)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,r){e.isEmpty()&&pt(38);let n=e;n._readOnly&&(n=bR(e),n._selection=e._selection?e._selection.clone():null),O9(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),nl(this)),this._pendingEditorState=n,this._dirtyType=Qf,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||nl(this)}parseEditorState(e,r){return function(n,s,a){const i=yT(),o=fs,l=Aa,u=hs,d=s._dirtyElements,g=s._dirtyLeaves,h=s._cloneNotNeeded,p=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,fs=i,Aa=!1,hs=s,_T(null);try{const x=s._nodes;pT(n.root,x),a&&a(),i._readOnly=!0}catch(x){x instanceof Error&&s._onError(x)}finally{s._dirtyElements=d,s._dirtyLeaves=g,s._cloneNotNeeded=h,s._dirtyType=p,fs=o,Aa=l,hs=u}return i}(typeof e=="string"?JSON.parse(e):e,this,r)}read(e){return nl(this),this.getEditorState().read(e,{editor:this})}update(e,r){(function(n,s,a){n._updating?n._updates.push([s,a]):Av(n,s,a)})(this,e,r)}focus(e,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Ia(this,()=>{const s=Ct(),a=on();s!==null?s.dirty||Fs(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),OZ("focus"),LZ(()=>{n.removeAttribute("autocapitalize"),e&&e()})}),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const e=this._rootElement;e!==null&&e.blur();const r=to(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,G0("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}Fv.version="0.35.0+prod.esm";let AS=null;function _T(t){AS=t}let FZ=1;function TR(t,e){const r=bT(t,e);return r===void 0&&pt(30,e),r}function bT(t,e){return t._nodes.get(e)}const PZ=typeof queueMicrotask=="function"?queueMicrotask:t=>{Promise.resolve().then(t)};function hA(t){return jr(Sc(t))}function ST(t){const e=document.activeElement;if(!Zr(e))return!1;const r=e.nodeName;return jr(Sc(t))&&(r==="INPUT"||r==="TEXTAREA"||e.contentEditable==="true"&&Pv(e)==null)}function _m(t,e,r){const n=t.getRootElement();try{return n!==null&&n.contains(e)&&n.contains(r)&&e!==null&&!ST(e)&&ER(e)===t}catch{return!1}}function kT(t){return t instanceof Fv}function ER(t){let e=t;for(;e!=null;){const r=Pv(e);if(kT(r))return r;e=bm(e)}return null}function Pv(t){return t?t.__lexicalEditor:null}function Eu(t){return Tv(t)||t.isToken()}function el(t){return Eu(t)||t.isSegmented()}function Nl(t){return kh(t)&&t.nodeType===Aq}function DZ(t){return kh(t)&&t.nodeType===jq}function qf(t){let e=t;for(;e!=null;){if(Nl(e))return e;e=e.firstChild}return null}function $1(t,e,r){const n=Wu[e];if(r!==null&&(t&n)==(r&n))return t;let s=t^n;return e==="subscript"?s&=-65:e==="superscript"?s&=-33:e==="lowercase"?(s&=-513,s&=-1025):e==="uppercase"?(s&=-257,s&=-1025):e==="capitalize"&&(s&=-257,s&=-513),s}function NR(t){return Tt(t)||ul(t)||jr(t)}function RZ(t,e){const r=function(){const i=AS;return AS=null,i}();if((e=e||r&&r.__key)!=null)return void(t.__key=e);Cs(),vR();const n=yn(),s=Wc(),a=""+FZ++;s._nodeMap.set(a,t),Je(t)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=R9,t.__key=a}function Nu(t){const e=t.getParent();if(e!==null){const r=t.getWritable(),n=e.getWritable(),s=t.getPreviousSibling(),a=t.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,l=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),l!==null&&(l.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function W1(t){vR();const e=t.getLatest(),r=e.__parent,n=Wc(),s=yn(),a=n._nodeMap,i=s._dirtyElements;r!==null&&function(l,u,d){let g=l;for(;g!==null;){if(d.has(g))return;const h=u.get(g);if(h===void 0)break;d.set(g,!1),g=h.__parent}}(r,a,i);const o=e.__key;s._dirtyType=R9,Je(t)?i.set(o,!0):s._dirtyLeaves.add(o)}function Ts(t){Cs();const e=yn(),r=e._compositionKey;if(t!==r){if(e._compositionKey=t,r!==null){const n=Kn(r);n!==null&&n.getWritable()}if(t!==null){const n=Kn(t);n!==null&&n.getWritable()}}}function ec(){return ym()?null:yn()._compositionKey}function Kn(t,e){const r=(e||Wc())._nodeMap.get(t);return r===void 0?null:r}function AR(t,e){const r=Dv(t,yn());return r!==void 0?Kn(r,e):null}function Dv(t,e){return t[`__lexicalKey_${e._key}`]}function Sc(t,e){let r=t;for(;r!=null;){const n=AR(r,e);if(n!==null)return n;r=bm(r)}return null}function jR(t){const e=t._decorators,r=Object.assign({},e);return t._pendingDecorators=r,r}function gA(t){return t.read(()=>on().getTextContent())}function on(){return FR(Wc())}function FR(t){return t._nodeMap.get("root")}function Fs(t){Cs();const e=Wc();t!==null&&(t.dirty=!0,t.setCachedNodes(null)),e._selection=t}function xf(t){const e=yn(),r=function(n,s){let a=n;for(;a!=null;){const i=Dv(a,s);if(i!==void 0)return i;a=bm(a)}return null}(t,e);return r===null?t===e.getRootElement()?Kn("root"):null:Kn(r)}function PR(t){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(t)}function CT(t){const e=[];let r=t;for(;r!==null;)e.push(r),r=r._parentEditor;return e}function DR(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function RR(t){return Nl(t)?t.nodeValue:null}function TT(t,e,r){const n=to(Ci(e));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=RR(s);const l=Sc(s);if(o!==null&&Tt(l)){if(o===Sv&&r){const u=r.length;o=r,a=u,i=u}o!==null&&ET(l,o,a,i,t)}}}function ET(t,e,r,n,s){let a=t;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=e;(i||s)&&e[e.length-1]===Sv&&(o=e.slice(0,-1));const l=a.getTextContent();if(s||o!==l){if(o===""){if(Ts(null),jg||Jf||N1)a.remove();else{const v=yn();setTimeout(()=>{v.update(()=>{a.isAttached()&&a.remove()})},20)}return}const u=a.getParent(),d=Sh(),g=a.getTextContentSize(),h=ec(),p=a.getKey();if(a.isToken()||h!==null&&p===h&&!i||dt(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===t.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===t.__key&&d.focus.offset===g&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const x=Ct();if(!dt(x)||r===null||n===null)return void mA(a,o,x);if(x.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=Cn(a.getTextContent());a.replace(v),a=v}mA(a,o,x)}}}function mA(t,e,r){if(t.setTextContent(e),dt(r)){const n=t.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=mc(t,a.offset,"clamp"))}}}function ax(t,e,r){const n=e[r]||!1;return n==="any"||n===t[r]}function MZ(t,e){return ax(t,e,"altKey")&&ax(t,e,"ctrlKey")&&ax(t,e,"shiftKey")&&ax(t,e,"metaKey")}function Dr(t,e,r){return MZ(t,r)&&t.key.toLowerCase()===e.toLowerCase()}const qo={ctrlKey:!_o,metaKey:_o},pA={altKey:_o,ctrlKey:!_o};function xA(t){return t.key==="Backspace"}function yA(t){return Dr(t,"a",qo)}function IZ(t){const e=on();if(dt(t)){const r=t.anchor,n=t.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),F1(t),t}{const r=e.select(0,e.getChildrenSize());return Fs(F1(r)),r}}function jf(t,e){t.__lexicalClassNameCache===void 0&&(t.__lexicalClassNameCache={});const r=t.__lexicalClassNameCache,n=r[e];if(n!==void 0)return n;const s=t[e];if(typeof s=="string"){const a=D9(s);return r[e]=a,a}return s}function NT(t,e,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=e.get(a);o===void 0&&pt(33,a);const l=o.klass;let u=t.get(l);u===void 0&&(u=new Map,t.set(l,u));const d=u.get(i),g=d==="destroyed"&&s==="created";(d===void 0||g)&&u.set(i,g?"updated":s)}function vA(t,e,r){const n=t.getParent();let s=r,a=t;return n!==null&&(e&&r===0?(s=a.getIndexWithinParent(),a=n):e||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(e?s-1:s)}function jS(t,e){const r=t.offset;if(t.type==="element")return vA(t.getNode(),e,r);{const n=t.getNode();if(e&&r===0||!e&&r===n.getTextContentSize()){const s=e?n.getPreviousSibling():n.getNextSibling();return s===null?vA(n.getParentOrThrow(),e,n.getIndexWithinParent()+(e?0:1)):s}}return null}function MR(t){const e=Ci(t).event,r=e&&e.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function Mt(t,e,r){return function(n,s,a){const i=CT(n);for(let o=4;o>=0;o--)for(let l=0;l<i.length;l++){const u=i[l],d=u._commands.get(s);if(d!==void 0){const g=d[o];if(g!==void 0){const h=Array.from(g),p=h.length;let x=!1;if(Ia(u,()=>{for(let v=0;v<p;v++)if(h[v](a,n))return void(x=!0)}),x)return x}}}return!1}(t,e,r)}function Rv(t){return!rs(t)&&!t.isLastChild()&&!t.isInline()}function Gu(t,e){const r=t._keyToDOMMap.get(e);return r===void 0&&pt(75,e),r}function bm(t){const e=t.assignedSlot||t.parentElement;return DS(e)?e.host:e}function IR(t){return DZ(t)?t:Zr(t)?t.ownerDocument:null}function OZ(t){Cs(),yn()._updateTags.add(t)}function LZ(t){Cs(),yn()._deferred.push(t)}function FS(t,e){let r=t.getParent();for(;r!==null;){if(r.is(e))return!0;r=r.getParent()}return!1}function AT(t){const e=IR(t);return e?e.defaultView:null}function Ci(t){const e=t._window;return e===null&&pt(78),e}function BZ(t){return Je(t)&&t.isInline()||jr(t)&&t.isInline()}function UZ(t){let e=t.getParentOrThrow();for(;e!==null;){if(la(e))return e;e=e.getParentOrThrow()}return e}function la(t){return rs(t)||Je(t)&&t.isShadowRoot()}function fa(t){const e=yn(),r=t.getType(),n=bT(e,r);n===void 0&&pt(200,t.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(t),o=i.constructor;return a!==null?i instanceof a||pt(201,a.name,a.getType(),o.name,o.getType(),t.constructor.name,r):i instanceof t.constructor&&o!==t.constructor||pt(202,o.name,o.getType(),t.constructor.name,r),i.__key===t.__key&&pt(203,t.constructor.name,r,o.name,o.getType()),i}return t}function h2(t,e){!rs(t.getParent())||Je(e)||jr(e)||pt(99)}function $Z(t){const e=Kn(t);return e===null&&pt(63,t),e}function g2(t){return(jr(t)||Je(t)&&!t.canBeEmpty())&&!t.isInline()}function PS(t,e,r){r.style.removeProperty("caret-color"),e._blockCursorElement=null;const n=t.parentElement;n!==null&&n.removeChild(t)}function to(t){return so?(t||window).getSelection():null}function WZ(t){const e=AT(t);return e?e.getSelection():null}function OR(t){return Zr(t)&&t.tagName==="A"}function Zr(t){return kh(t)&&t.nodeType===Nq}function kh(t){return typeof t=="object"&&t!==null&&"nodeType"in t&&typeof t.nodeType=="number"}function DS(t){return kh(t)&&t.nodeType===Fq}function RS(t){const e=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return t.nodeName.match(e)!==null}function H1(t){const e=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return t.nodeName.match(e)!==null}function xi(t){if(jr(t)&&!t.isInline())return!0;if(!Je(t)||la(t))return!1;const e=t.getFirstChild(),r=e===null||ul(e)||Tt(e)||e.isInline();return!t.isInline()&&t.canBeEmpty()!==!1&&r}function m2(t,e){let r=t;for(;r!==null&&r.getParent()!==null&&!e(r);)r=r.getParentOrThrow();return e(r)?r:null}function Sm(){return yn()}const wA=new WeakMap,HZ=new Map;function _A(t){if(!t._readOnly&&t.isEmpty())return HZ;t._readOnly||pt(192);let e=wA.get(t);return e||(e=function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n}(t),wA.set(t,e)),e}function jT(t){const e=t.constructor.clone(t);return e.afterCloneFrom(t),e}function FT(t,e){const r=parseInt(t.style.paddingInlineStart,10)||0,n=Math.round(r/40);e.setIndent(n)}function zZ(t){t.__lexicalUnmanaged=!0}function GZ(t){return t.__lexicalUnmanaged===!0}function h0(t,e){return function(r,n){return Object.prototype.hasOwnProperty.call(r,n)}(t,e)&&t[e]!==_h[e]}function PT(t){const e=D6 in t.prototype?t.prototype[D6]():void 0,r=function(i){return i===xT||i===Js||i===_h}(t),n=!r&&h0(t,"getType")?t.getType():void 0;let s,a=n;if(e)if(n)s=e[n];else for(const[i,o]of Object.entries(e))a=i,s=o;if(!r&&a&&(h0(t,"getType")||(t.getType=()=>a),h0(t,"clone")||(t.clone=i=>(_T(i),new t)),h0(t,"importJSON")||(t.importJSON=s&&s.$importJSON||(i=>new t().updateFromJSON(i))),!h0(t,"importDOM")&&s)){const{importDOM:i}=s;i&&(t.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function VZ(t){const e=Sm();return Cs(),new(e.resolveRegisteredNodeAfterReplacements(e.getRegisteredNode(t))).klass}const KZ={next:"previous",previous:"next"};class DT{constructor(e){this.origin=e}[Symbol.iterator](){return LT({hasNext:Xu,initial:this.getAdjacentCaret(),map:e=>e,step:e=>e.getAdjacentCaret()})}getAdjacentCaret(){return As(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return As(this.origin,this.direction)}remove(){const e=this.getNodeAtCaret();return e&&e.remove(),this}replaceOrInsert(e,r){const n=this.getNodeAtCaret();return e.is(this.origin)||e.is(n)||(n===null?this.insert(e):n.replace(e,r)),this}splice(e,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let l=a.getAdjacentCaret();l!==null&&o.size<e;l=l.getAdjacentCaret()){const u=l.origin.getWritable();o.set(u.getKey(),u)}for(const l of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(l.getKey()),!(u.is(l)||a.origin.is(l))){const d=l.getParent();d&&d.is(i)&&l.remove(),u.replace(l)}}else u===null&&pt(263,Array.from(o).join(" "))}else a.insert(l);a=As(l,this.direction)}for(const l of o.values())l.remove();return this}}class Ig extends DT{constructor(){super(...arguments);si(this,"type","child")}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:Ti(r,this.direction)}getParentCaret(r="root"){return As(RT(this.getParentAtCaret(),r),this.direction)}getFlipped(){const r=Ch(this.direction);return As(this.getNodeAtCaret(),r)||Ti(this.origin,r)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(r){return r instanceof Ig&&this.direction===r.direction&&this.origin.is(r.origin)}isSamePointCaret(r){return this.isSameNodeCaret(r)}}const XZ={root:rs,shadowRoot:la};function Ch(t){return KZ[t]}function RT(t,e="root"){return XZ[e](t)?null:t}class Vu extends DT{constructor(){super(...arguments);si(this,"type","sibling")}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:As(r,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return Je(this.origin)?Ti(this.origin,this.direction):null}getParentCaret(r="root"){return As(RT(this.getParentAtCaret(),r),this.direction)}getFlipped(){const r=Ch(this.direction);return As(this.getNodeAtCaret(),r)||Ti(this.origin.getParentOrThrow(),r)}isSamePointCaret(r){return r instanceof Vu&&this.direction===r.direction&&this.origin.is(r.origin)}isSameNodeCaret(r){return(r instanceof Vu||r instanceof Ku)&&this.direction===r.direction&&this.origin.is(r.origin)}}class Ku extends DT{constructor(r,n){super(r);si(this,"type","text");this.offset=n}getLatest(){const r=this.origin.getLatest();return r===this.origin?this:Yu(r,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(r="root"){return As(RT(this.getParentAtCaret(),r),this.direction)}getFlipped(){return Yu(this.origin,Ch(this.direction),this.offset)}isSamePointCaret(r){return r instanceof Ku&&this.direction===r.direction&&this.origin.is(r.origin)&&this.offset===r.offset}isSameNodeCaret(r){return(r instanceof Vu||r instanceof Ku)&&this.direction===r.direction&&this.origin.is(r.origin)}getSiblingCaret(){return As(this.origin,this.direction)}}function gc(t){return t instanceof Ku}function Xu(t){return t instanceof Vu}function Po(t){return t instanceof Ig}const YZ={next:class extends Ku{constructor(){super(...arguments);si(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Ku{constructor(){super(...arguments);si(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},JZ={next:class extends Vu{constructor(){super(...arguments);si(this,"direction","next")}getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Vu{constructor(){super(...arguments);si(this,"direction","previous")}getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},QZ={next:class extends Ig{constructor(){super(...arguments);si(this,"direction","next")}getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Ig{constructor(){super(...arguments);si(this,"direction","previous")}getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function As(t,e){return t?new JZ[e](t):null}function Yu(t,e,r){return t?new YZ[e](t,mc(t,r)):null}function mc(t,e,r="error"){const n=t.getTextContentSize();let s=e==="next"?n:e==="previous"?0:e;return(s<0||s>n)&&(r!=="clamp"&&function(a,...i){const o=new URL("https://lexical.dev/docs/error"),l=new URLSearchParams;l.append("code",a);for(const u of i)l.append("v",u);o.search=l.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(284,String(e),String(n),t.getKey()),s=s<0?0:n),s}function bA(t,e){return new ZZ(t,e)}function Ti(t,e){return Je(t)?new QZ[e](t):null}function qZ(t){return t&&t.getChildCaret()||t}function MT(t){return t&&qZ(t.getAdjacentCaret())}class IT{constructor(e,r,n){si(this,"type","node-caret-range");this.anchor=e,this.focus=r,this.direction=n}getLatest(){const e=this.anchor.getLatest(),r=this.focus.getLatest();return e===this.anchor&&r===this.focus?this:new IT(e,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const e=s=>{const a=this[s].getLatest();return gc(a)?function(i,o){const{direction:l,origin:u}=i,d=mc(u,o==="focus"?Ch(l):l);return bA(i,d-i.offset)}(a,s):null},r=e("anchor"),n=e("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[bA(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(e="root"){const r=gc(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=gc(n),a=i=>i.isSameNodeCaret(n)?null:MT(i)||i.getParentCaret(e);return LT({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class ZZ{constructor(e,r){si(this,"type","slice");this.caret=e,this.distance=r}getSliceIndices(){const{distance:e,caret:{offset:r}}=this,n=r+e;return n<r?[n,r]:[r,n]}getTextContent(){const[e,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(e,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:e,direction:r}}=this,[n,s]=this.getSliceIndices(),a=e.getTextContent();return Yu(e.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function OT(t){return kc(t,As(on(),t.direction))}function eee(t){return kc(t,t)}function kc(t,e){return t.direction!==e.direction&&pt(265),new IT(t,e,t.direction)}function LT(t){const{initial:e,hasNext:r,step:n,map:s}=t;let a=e;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function LR(t,e){const r=Wx(t.origin,e.origin);switch(r===null&&pt(275,t.origin.getKey(),e.origin.getKey()),r.type){case"same":{const n=t.type==="text",s=e.type==="text";return n&&s?function(a,i){return Math.sign(a-i)}(t.offset,e.offset):t.type===e.type?0:n?-1:s?1:t.type==="child"?-1:1}case"ancestor":return t.type==="child"?-1:1;case"descendant":return e.type==="child"?1:-1;case"branch":return BR(r)}}function BR(t){const{a:e,b:r}=t,n=e.__key,s=r.__key;let a=e,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function ix(t,e){return e.is(t)}function SA(t){return Je(t)?[t.getLatest(),null]:[t.getParent(),t.getLatest()]}function Wx(t,e){if(t.is(e))return{commonAncestor:t,type:"same"};const r=new Map;for(let[n,s]=SA(t);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=SA(e);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(ix(t,n)||pt(276),{commonAncestor:n,type:"ancestor"}):s===null?(ix(e,n)||pt(277),{commonAncestor:n,type:"descendant"}):((Je(a)||ix(t,a))&&(Je(s)||ix(e,s))&&n.is(a.getParent())&&n.is(s.getParent())||pt(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function _l(t,e){const{type:r,key:n,offset:s}=t,a=$Z(t.key);return r==="text"?(Tt(a)||pt(266,a.getType(),n),Yu(a,e,s)):(Je(a)||pt(267,a.getType(),n),nee(a,t.offset,e))}function Ju(t,e){const{origin:r,direction:n}=e,s=n==="next";gc(e)?t.set(r.getKey(),e.offset,"text"):Xu(e)?Tt(r)?t.set(r.getKey(),mc(r,n),"text"):t.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Po(e)&&Je(r)||pt(268),t.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function tee(t){const e=Ct(),r=dt(e)?e:Nv();return Hx(r,t),Fs(r),r}function Hx(t,e){Ju(t.anchor,e.anchor),Ju(t.focus,e.focus)}function kA(t){const{anchor:e,focus:r}=t,n=_l(e,"next"),s=_l(r,"next"),a=LR(n,s)<=0?"next":"previous";return kc(Zf(n,a),Zf(s,a))}function BT(t){const{direction:e,origin:r}=t,n=As(r,Ch(e)).getNodeAtCaret();return n?As(n,e):Ti(r.getParentOrThrow(),e)}function CA(t,e="root"){const r=[t];for(let n=Po(t)?t.getParentCaret(e):t.getSiblingCaret();n!==null;n=n.getParentCaret(e))r.push(BT(n));return r}function p2(t){return!!t&&t.origin.isAttached()}function ree(t,e="removeEmptySlices"){if(t.isCollapsed())return t;const r="root",n="next";let s=e;const a=$R(t,n),i=CA(a.anchor,r),o=CA(a.focus.getFlipped(),r),l=new Set,u=[];for(const x of a.iterNodeCarets(r))if(Po(x))l.add(x.origin.getKey());else if(Xu(x)){const{origin:v}=x;Je(v)&&!l.has(v.getKey())||u.push(v)}for(const x of u)x.remove();for(const x of a.getTextSlices()){if(!x)continue;const{origin:v}=x.caret,w=v.getTextContentSize(),S=BT(As(v,n)),_=v.getMode();if(Math.abs(x.distance)===w&&s==="removeEmptySlices"||_==="token"&&x.distance!==0)S.remove();else if(x.distance!==0){s="removeEmptySlices";let y=x.removeTextSlice();const k=x.caret.origin;if(_==="segmented"){const N=y.origin,E=Cn(N.getTextContent()).setStyle(N.getStyle()).setFormat(N.getFormat());S.replaceOrInsert(E),y=Yu(E,n,y.offset)}k.is(i[0].origin)&&(i[0]=y),k.is(o[0].origin)&&(o[0]=y.getFlipped())}}let d,g;for(const x of i)if(p2(x)){d=vi(x);break}for(const x of o)if(p2(x)){g=vi(x);break}const h=function(x,v,w){if(!x||!v)return null;const S=x.getParentAtCaret(),_=v.getParentAtCaret();if(!S||!_)return null;const y=S.getParents().reverse();y.push(S);const k=_.getParents().reverse();k.push(_);const N=Math.min(y.length,k.length);let E;for(E=0;E<N&&y[E]===k[E];E++);const A=(P,M)=>{let I;for(let Y=E;Y<P.length;Y++){const se=P[Y];if(la(se))return;!I&&M(se)&&(I=se)}return I},C=A(y,xi),F=C&&A(k,P=>w.has(P.getKey())&&xi(P));return C&&F?[C,F]:null}(d,g,l);if(h){const[x,v]=h;Ti(x,"previous").splice(0,v.getChildren()),v.remove()}const p=[d,g,...i,...o].find(p2);if(p)return eee(Zf(vi(p),t.direction));pt(269,JSON.stringify(i.map(x=>x.origin.__key)))}function vi(t){const e=function(s){let a=s;for(;Po(a);){const i=MT(a);if(!Po(i))break;a=i}return a}(t.getLatest()),{direction:r}=e;if(Tt(e.origin))return gc(e)?e:Yu(e.origin,r,r);const n=e.getAdjacentCaret();return Xu(n)&&Tt(n.origin)?Yu(n.origin,r,Ch(r)):e}function UR(t){return gc(t)&&t.offset!==mc(t.origin,t.direction)}function Zf(t,e){return t.direction===e?t:t.getFlipped()}function $R(t,e){return t.direction===e?t:kc(Zf(t.focus,e),Zf(t.anchor,e))}function nee(t,e,r){let n=Ti(t,"next");for(let s=0;s<e;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return Zf(n,r)}const WR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,see=WR?b.useLayoutEffect:b.useEffect,ox={tag:K0};function HR({initialConfig:t,children:e}){const r=b.useMemo(()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:l}=t,u=Cq(null,n),d=jZ({editable:t.editable,html:l,namespace:s,nodes:a,onError:g=>i(g,d),theme:n});return function(g,h){if(h!==null){if(h===void 0)g.update(()=>{const p=on();if(p.isEmpty()){const x=qr();p.append(x);const v=WR?document.activeElement:null;(Ct()!==null||v!==null&&v===g.getRootElement())&&x.select()}},ox);else if(h!==null)switch(typeof h){case"string":{const p=g.parseEditorState(h);g.setEditorState(p,ox);break}case"object":g.setEditorState(h,ox);break;case"function":g.update(()=>{on().isEmpty()&&h(g)},ox)}}}(d,o),[d,u]},[]);return see(()=>{const n=t.editable,[s]=r;s.setEditable(n===void 0||n)},[]),c.jsx(wh.Provider,{value:r,children:e})}const aee=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?b.useLayoutEffect:b.useEffect;function iee(t){return{initialValueFn:()=>t.isEditable(),subscribe:e=>t.registerEditableListener(e)}}function oee(){return function(t){const[e]=Oo(),r=b.useMemo(()=>t(e),[e,t]),[n,s]=b.useState(()=>r.initialValueFn()),a=b.useRef(n);return aee(()=>{const{initialValueFn:i,subscribe:o}=r,l=i();return a.current!==l&&(a.current=l,s(l)),o(u=>{a.current=u,s(u)})},[r,t]),n}(iee)}function lee(){return on().getTextContent()}function cee(t,e=!0){if(t)return!1;let r=lee();return e&&(r=r.trim()),r===""}function uee(t){if(!cee(t,!1))return!1;const e=on().getChildren(),r=e.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=e[n];if(jr(s))return!1;if(Je(s)){if(!wT(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const l=a[n];if(!Tt(l))return!1}}}return!0}function zR(t){return()=>uee(t)}const MS=new Map;function GR(t){const e={};if(!t)return e;const r=t.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(e[s.trim()]=a.trim())}return e}function TA(t){let e=MS.get(t);return e===void 0&&(e=GR(t),MS.set(t,e)),e}function VR(t){const e=Sm().getElementByKey(t.getKey());if(e===null)return null;const r=e.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(e)}function KR(t){return VR(rs(t)?t:t.getParentOrThrow())}function EA(t){const e=KR(t);return e!==null&&e.direction==="rtl"}function XR(t,e){const r=t.getStartEndPoints();if(e.isSelected(t)&&!el(e)&&r!==null){const[n,s]=r,a=t.isBackward(),i=n.getNode(),o=s.getNode(),l=e.is(i),u=e.is(o);if(l||u){const[d,g]=ES(t),h=i.is(o),p=e.is(a?o:i),x=e.is(a?i:o);let v,w=0;h?(w=d>g?g:d,v=d>g?d:g):p?(w=a?g:d,v=void 0):x&&(w=0,v=a?d:g),e.__text=e.__text.slice(w,v)}}return e}function dee(t){const e=t.getStyle(),r=GR(e);MS.set(e,r)}function fee(t,e){const r=t.getFormatType(),n=t.getIndent();r!==e.getFormatType()&&e.setFormat(r),n!==e.getIndent()&&e.setIndent(n)}function Ff(t,e,r=fee){if(t===null)return;const n=t.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=Nv(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const l=x2(i.getNode(),xi),u=x2(o.getNode(),xi);Je(l)&&s.set(l.getKey(),l),Je(u)&&s.set(u.getKey(),u)}for(const i of t.getNodes())if(Je(i)&&xi(i))s.set(i.getKey(),i);else if(n===null){const o=x2(i,xi);Je(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const l=e();r(o,l),o.replace(l,!0),a&&(i===a.anchor.key&&a.anchor.set(l.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(l.getKey(),a.focus.offset,a.focus.type))}a&&t.is(Ct())&&Fs(a)}function YR(t){const e=JR(t);return e!==null&&e.writingMode==="vertical-rl"}function JR(t){const e=t.anchor.getNode();return Je(e)?VR(e):KR(e)}function NA(t,e){let r=YR(t)?!e:e;QR(t)&&(r=!r);const n=_l(t.focus,r?"previous":"next");if(UR(n))return!1;for(const s of OT(n)){if(Po(s))return!s.origin.isInline();if(!Je(s.origin)){if(jr(s.origin))return!0;break}}return!1}function hee(t,e,r,n){t.modify(e?"extend":"move",r,n)}function QR(t){const e=JR(t);return e!==null&&e.direction==="rtl"}function AA(t,e,r){const n=QR(t);let s;s=YR(t)||n?!r:r,hee(t,e,s,"character")}function x2(t,e){let r=t;for(;r!==null&&r.getParent()!==null&&!e(r);)r=r.getParentOrThrow();return e(r)?r:null}function gee(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const qR=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,mee=qR&&"documentMode"in document?document.documentMode:null;!(!qR||!("InputEvent"in window)||mee)&&"getTargetRanges"in new window.InputEvent("input");function ZR(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}function pd(...t){return()=>{for(let e=t.length-1;e>=0;e--)t[e]();t.length=0}}function Zn(t,...e){const r=ZR(...e);r.length>0&&t.classList.add(...r)}function pc(t,...e){const r=ZR(...e);r.length>0&&t.classList.remove(...r)}function pee(t){return t?t.getAdjacentCaret():null}function xee(t,e){let r=t;for(;r!=null;){if(r instanceof e)return r;r=r.getParent()}return null}function yee(t){const e=Mv(t,r=>Je(r)&&!r.isInline());return Je(e)||gee(4,t.__key),e}const Mv=(t,e)=>{let r=t;for(;r!==on()&&r!=null;){if(e(r))return r;r=r.getParent()}return null};function yu(t,e){return t!==null&&Object.getPrototypeOf(t).constructor.name===e.name}function eM(t,e){const r=[],n=Array.from(t).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(e(s))r.push(s);else if(Je(s))for(const a of vee(s))n.push(a);return r}function vee(t){return wee(Ti(t,"previous"))}function wee(t){return LT({hasNext:Xu,initial:t.getAdjacentCaret(),map:e=>e.origin.getLatest(),step:e=>e.getAdjacentCaret()})}function _ee(t){const e=window.location.origin,r=n=>{if(n.origin!==e)return;const s=t.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const l=o.args;if(l){const[u,d,g,h,p,x]=l;t.update(()=>{const v=Ct();if(dt(v)){const w=v.anchor;let S=w.getNode(),_=0,y=0;if(Tt(S)&&u>=0&&d>=0&&(_=u,y=u+d,v.setTextNodeRange(S,_,S,y)),_===y&&g===""||(v.insertRawText(g),S=w.getNode()),Tt(S)){_=h,y=h+p;const k=S.getTextContentSize();_=_>k?k:_,y=y>k?k:y,v.setTextNodeRange(S,_,S,y)}n.stopImmediatePropagation()}})}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function bee(t,e){const r=e.body?e.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!rM.has(i.nodeName)){const o=nM(i,t,s,!1);o!==null&&(n=n.concat(o))}}return function(a){for(const i of a)i.getNextSibling()instanceof vT&&i.insertAfter(Do());for(const i of a){const o=i.getChildren();for(const l of o)i.insertBefore(l);i.remove()}}(s),n}function See(t,e){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=on().getChildren();for(let s=0;s<n.length;s++)tM(t,n[s],r,e);return r.innerHTML}function tM(t,e,r,n=null){let s=n===null||e.isSelected(n);const a=Je(e)&&e.excludeFromCopy("html");let i=e;if(n!==null){let p=jT(e);p=Tt(p)&&n!==null?XR(n,p):p,i=p}const o=Je(i)?i.getChildren():[],l=bT(t,i.getType());let u;u=l&&l.exportDOM!==void 0?l.exportDOM(t,i):i.exportDOM(t);const{element:d,after:g}=u;if(!d)return!1;const h=document.createDocumentFragment();for(let p=0;p<o.length;p++){const x=o[p],v=tM(t,x,h,n);!s&&Je(e)&&v&&e.extractWithChild(x,n,"html")&&(s=!0)}if(s&&!a){if((Zr(d)||DS(d))&&d.append(h),r.append(d),g){const p=g.call(i,d);p&&(DS(d)?d.replaceChildren(p):d.replaceWith(p))}}else r.append(h);return s}const rM=new Set(["STYLE","SCRIPT"]);function nM(t,e,r,n,s=new Map,a){let i=[];if(rM.has(t.nodeName))return i;let o=null;const l=function(x,v){const{nodeName:w}=x,S=v._htmlConversions.get(w.toLowerCase());let _=null;if(S!==void 0)for(const y of S){const k=y(x);k!==null&&(_===null||(_.priority||0)<=(k.priority||0))&&(_=k)}return _!==null?_.conversion:null}(t,e),u=l?l(t):null;let d=null;if(u!==null){d=u.after;const x=u.node;if(o=Array.isArray(x)?x[x.length-1]:x,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(x)?x:[o])}u.forChild!=null&&s.set(t.nodeName,u.forChild)}const g=t.childNodes;let h=[];const p=(o==null||!la(o))&&(o!=null&&NS(o)||n);for(let x=0;x<g.length;x++)h.push(...nM(g[x],e,r,p,new Map(s),o));return d!=null&&(h=d(h)),H1(t)&&(h=kee(t,h,p?()=>{const x=new vT;return r.push(x),x}:qr)),o==null?h.length>0?i=i.concat(h):H1(t)&&function(x){return x.nextSibling==null||x.previousSibling==null?!1:RS(x.nextSibling)&&RS(x.previousSibling)}(t)&&(i=i.concat(Do())):Je(o)&&o.append(...h),i}function kee(t,e,r){const n=t.style.textAlign,s=[];let a=[];for(let i=0;i<e.length;i++){const o=e[i];if(NS(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===e.length-1||i<e.length-1&&NS(e[i+1])){const l=r();l.setFormat(n),l.append(...a),s.push(l),a=[]}}return s}function z1(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Cee(t,e=Ct()){return e==null&&z1(166),dt(e)&&e.isCollapsed()||e.getNodes().length===0?"":See(t,e)}function Tee(t,e=Ct()){return e==null&&z1(166),dt(e)&&e.isCollapsed()||e.getNodes().length===0?null:JSON.stringify(Eee(t,e))}function jA(t,e,r){const n=t.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return FA(r,Nee(o.nodes),e)}catch{}const s=t.getData("text/html"),a=t.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString(function(l){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(l):l}(s),"text/html");return FA(r,bee(r,o),e)}catch{}const i=a||t.getData("text/uri-list");if(i!=null)if(dt(e)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let l=0;l<o.length;l++){const u=Ct();if(dt(u)){const d=o[l];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([bh()]):u.insertText(d)}}}else e.insertRawText(i)}function FA(t,e,r){t.dispatchCommand(qq,{nodes:e,selection:r})||(r.insertNodes(e),function(n){if(dt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=_l(s,"previous");if(i)if(gc(i))a=i.origin;else{const o=kc(i,Ti(on(),"next").getFlipped());for(const l of o){if(Tt(l.origin)){a=l.origin;break}if(Je(l.origin)&&!l.origin.isInline())break}}if(a&&Tt(a)){const o=a.getFormat(),l=a.getStyle();n.format===o&&n.style===l||(n.format=o,n.style=l,n.dirty=!0)}}}(r))}function sM(t,e,r,n=[]){let s=e===null||r.isSelected(e);const a=Je(r)&&r.excludeFromCopy("html");let i=r;if(e!==null){let u=jT(r);u=Tt(u)&&e!==null?XR(e,u):u,i=u}const o=Je(i)?i.getChildren():[],l=function(u){const d=u.exportJSON(),g=u.constructor;if(d.type!==g.getType()&&z1(58,g.name),Je(u)){const h=d.children;Array.isArray(h)||z1(59,g.name)}return d}(i);if(Tt(i)){const u=i.__text;u.length>0?l.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],g=sM(t,e,d,l.children);!s&&Je(r)&&g&&r.extractWithChild(d,e,"clone")&&(s=!0)}if(s&&!a)n.push(l);else if(Array.isArray(l.children))for(let u=0;u<l.children.length;u++){const d=l.children[u];n.push(d)}return s}function Eee(t,e){const r=[],n=on().getChildren();for(let s=0;s<n.length;s++)sM(t,e,n[s],r);return{namespace:t._config.namespace,nodes:r}}function Nee(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r],s=SZ(n);Tt(s)&&dee(s),e.push(s)}return e}let $d=null;async function PA(t,e,r){if($d!==null)return!1;if(e!==null)return new Promise((u,d)=>{t.update(()=>{u(DA(t,e,r))})});const n=t.getRootElement(),s=t._window||window,a=window.document,i=to(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const l=new Range;return l.setStart(o,0),l.setEnd(o,1),i.removeAllRanges(),i.addRange(l),new Promise((u,d)=>{const g=t.registerCommand(Cv,h=>(yu(h,ClipboardEvent)&&(g(),$d!==null&&(window.clearTimeout($d),$d=null),u(DA(t,h,r))),!0),AZ);$d=window.setTimeout(()=>{g(),$d=null,u(!1)},50),a.execCommand("copy"),o.remove()})}function DA(t,e,r){if(r===void 0){const s=to(t._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!_m(t,a,i))return!1;const o=Ct();if(o===null)return!1;r=jee(o)}e.preventDefault();const n=e.clipboardData;return n!==null&&(Fee(n,r),!0)}const Aee=[["text/html",Cee],["application/x-lexical-editor",Tee]];function jee(t=Ct()){const e={"text/plain":t?t.getTextContent():""};if(t){const r=Sm();for(const[n,s]of Aee){const a=s(r,t);a!==null&&(e[n]=a)}}return e}function Fee(t,e){for(const r in e){const n=e[r];n!==void 0&&t.setData(r,n)}}function RA(t,e){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(t,e);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(t,e);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const Th=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Pee=Th&&"documentMode"in document?document.documentMode:null,Dee=!(!Th||!("InputEvent"in window)||Pee)&&"getTargetRanges"in new window.InputEvent("input"),Ree=Th&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),MA=Th&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Mee=Th&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Iee=Th&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!Mee,IA=Xt("DRAG_DROP_PASTE_FILE");let km=class aM extends Js{static getType(){return"quote"}static clone(e){return new aM(e.__key)}createDOM(e){const r=document.createElement("blockquote");return Zn(r,e.theme.quote),r}updateDOM(e,r){return!1}static importDOM(){return{blockquote:e=>({conversion:Oee,priority:0})}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Zr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(e){return Cm().updateFromJSON(e)}insertNewAfter(e,r){const n=qr(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const e=qr();return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}canMergeWhenEmpty(){return!0}};function Cm(){return fa(new km)}function OA(t){return t instanceof km}let Tm=class iM extends Js{static getType(){return"heading"}static clone(e){return new iM(e.__tag,e.__key)}constructor(e,r){super(r),this.__tag=e}getTag(){return this.__tag}setTag(e){const r=this.getWritable();return this.__tag=e,r}createDOM(e){const r=this.__tag,n=document.createElement(r),s=e.theme.heading;if(s!==void 0){const a=s[r];Zn(n,a)}return n}updateDOM(e,r,n){return e.__tag!==this.__tag}static importDOM(){return{h1:e=>({conversion:Wd,priority:0}),h2:e=>({conversion:Wd,priority:0}),h3:e=>({conversion:Wd,priority:0}),h4:e=>({conversion:Wd,priority:0}),h5:e=>({conversion:Wd,priority:0}),h6:e=>({conversion:Wd,priority:0}),p:e=>{const r=e.firstChild;return r!==null&&LA(r)?{conversion:()=>({node:null}),priority:3}:null},span:e=>LA(e)?{conversion:r=>({node:tc("h1")}),priority:3}:null}}exportDOM(e){const{element:r}=super.exportDOM(e);if(Zr(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(e){return tc(e.tag).updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setTag(e.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(e,r=!0){const n=e?e.anchor.offset:0,s=this.getLastDescendant(),a=!s||e&&e.anchor.key===s.getKey()&&n===s.getTextContentSize()||!e?qr():tc(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&e){const o=qr();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const e=this.isEmpty()?qr():tc(this.getTag());return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}extractWithChild(){return!0}};function LA(t){return t.nodeName.toLowerCase()==="span"&&t.style.fontSize==="26pt"}function Wd(t){const e=t.nodeName.toLowerCase();let r=null;return e!=="h1"&&e!=="h2"&&e!=="h3"&&e!=="h4"&&e!=="h5"&&e!=="h6"||(r=tc(e),t.style!==null&&(FT(t,r),r.setFormat(t.style.textAlign))),{node:r}}function Oee(t){const e=Cm();return t.style!==null&&(e.setFormat(t.style.textAlign),FT(t,e)),{node:e}}function tc(t="h1"){return fa(new Tm(t))}function Lee(t){return t instanceof Tm}function lx(t){let e=null;if(yu(t,DragEvent)?e=t.dataTransfer:yu(t,ClipboardEvent)&&(e=t.clipboardData),e===null)return[!1,[],!1];const r=e.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(e.files),s]}function BA(t){const e=Ct();if(!dt(e))return!1;const r=new Set,n=e.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=Mv(a,u=>Je(u)&&!u.isInline());if(o===null)continue;const l=o.getKey();o.canIndent()&&!r.has(l)&&(r.add(l),t(o))}return r.size>0}function UA(t){const e=Sc(t);return jr(e)}function y2(t){for(const e of["lowercase","uppercase","capitalize"])t.hasFormat(e)&&t.toggleFormat(e)}function Bee(t){return pd(t.registerCommand(lT,e=>{const r=Ct();return!!Bs(r)&&(r.clear(),!0)},_r),t.registerCommand(Tu,e=>{const r=Ct();return dt(r)?(r.deleteCharacter(e),!0):!!Bs(r)&&(r.deleteNodes(),!0)},_r),t.registerCommand(Rg,e=>{const r=Ct();return!!dt(r)&&(r.deleteWord(e),!0)},_r),t.registerCommand(Mg,e=>{const r=Ct();return!!dt(r)&&(r.deleteLine(e),!0)},_r),t.registerCommand(Nf,e=>{const r=Ct();if(typeof e=="string")r!==null&&r.insertText(e);else{if(r===null)return!1;const n=e.dataTransfer;if(n!=null)jA(n,r,t);else if(dt(r)){const s=e.data;return s&&r.insertText(s),!0}}return!0},_r),t.registerCommand(wS,()=>{const e=Ct();return!!dt(e)&&(e.removeText(),!0)},_r),t.registerCommand(Vs,e=>{const r=Ct();return!!dt(r)&&(r.formatText(e),!0)},_r),t.registerCommand(rR,e=>{const r=Ct();if(!dt(r)&&!Bs(r))return!1;const n=r.getNodes();for(const s of n){const a=Mv(s,i=>Je(i)&&!i.isInline());a!==null&&a.setFormat(e)}return!0},_r),t.registerCommand(Ef,e=>{const r=Ct();return!!dt(r)&&(r.insertLineBreak(e),!0)},_r),t.registerCommand(Dg,()=>{const e=Ct();return!!dt(e)&&(e.insertParagraph(),!0)},_r),t.registerCommand(rZ,()=>(wZ([bh()]),!0),_r),t.registerCommand(nZ,()=>BA(e=>{const r=e.getIndent();e.setIndent(r+1)}),_r),t.registerCommand(H6,()=>BA(e=>{const r=e.getIndent();r>0&&e.setIndent(Math.max(0,r-1))}),_r),t.registerCommand(X9,e=>{const r=Ct();if(Bs(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(dt(r)){const n=jS(r.focus,!0);if(!e.shiftKey&&jr(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),e.preventDefault(),!0}return!1},_r),t.registerCommand(Y9,e=>{const r=Ct();if(Bs(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(dt(r)){if(function(s){const a=s.focus;return a.key==="root"&&a.offset===on().getChildrenSize()}(r))return e.preventDefault(),!0;const n=jS(r.focus,!1);if(!e.shiftKey&&jr(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),e.preventDefault(),!0}return!1},_r),t.registerCommand(K9,e=>{const r=Ct();if(Bs(r)){const n=r.getNodes();if(n.length>0)return e.preventDefault(),EA(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!dt(r))return!1;if(NA(r,!0)){const n=e.shiftKey;return e.preventDefault(),AA(r,n,!0),!0}return!1},_r),t.registerCommand(V9,e=>{const r=Ct();if(Bs(r)){const s=r.getNodes();if(s.length>0)return e.preventDefault(),EA(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!dt(r))return!1;const n=e.shiftKey;return!!NA(r,!1)&&(e.preventDefault(),AA(r,n,!1),!0)},_r),t.registerCommand(Q9,e=>{if(UA(e.target))return!1;const r=Ct();if(dt(r)){if(function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(rs(a))return!1;const i=yee(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))}(r))return e.preventDefault(),t.dispatchCommand(H6,void 0);if(MA&&navigator.language==="ko-KR")return!1}else if(!Bs(r))return!1;return e.preventDefault(),t.dispatchCommand(Tu,!0)},_r),t.registerCommand(Z9,e=>{if(UA(e.target))return!1;const r=Ct();return!(!dt(r)&&!Bs(r))&&(e.preventDefault(),t.dispatchCommand(Tu,!1))},_r),t.registerCommand(I1,e=>{const r=Ct();if(!dt(r))return!1;if(y2(r),e!==null){if((MA||Ree||Iee)&&Dee)return!1;if(e.preventDefault(),e.shiftKey)return t.dispatchCommand(Ef,!1)}return t.dispatchCommand(Dg,void 0)},_r),t.registerCommand(q9,()=>{const e=Ct();return!!dt(e)&&(t.blur(),!0)},_r),t.registerCommand(tR,e=>{const[,r]=lx(e);if(r.length>0){const s=RA(e.clientX,e.clientY);if(s!==null){const{offset:a,node:i}=s,o=Sc(i);if(o!==null){const l=Nv();if(Tt(o))l.anchor.set(o.getKey(),a,"text"),l.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),g=o.getIndexWithinParent()+1;l.anchor.set(d,g,"element"),l.focus.set(d,g,"element")}const u=F1(l);Fs(u)}t.dispatchCommand(IA,r)}return e.preventDefault(),!0}const n=Ct();return!!dt(n)},_r),t.registerCommand(nR,e=>{const[r]=lx(e),n=Ct();return!(r&&!dt(n))},_r),t.registerCommand(sR,e=>{const[r]=lx(e),n=Ct();if(r&&!dt(n))return!1;const s=RA(e.clientX,e.clientY);if(s!==null){const a=Sc(s.node);jr(a)&&e.preventDefault()}return!0},_r),t.registerCommand(_S,()=>(IZ(),!0),_r),t.registerCommand(Cv,e=>(PA(t,yu(e,ClipboardEvent)?e:null),!0),_r),t.registerCommand(fT,e=>(async function(r,n){await PA(n,yu(r,ClipboardEvent)?r:null),n.update(()=>{const s=Ct();dt(s)?s.removeText():Bs(s)&&s.getNodes().forEach(a=>a.remove())})}(e,t),!0),_r),t.registerCommand(cT,e=>{const[,r,n]=lx(e);return r.length>0&&!n?(t.dispatchCommand(IA,r),!0):kh(e.target)&&ST(e.target)?!1:Ct()!==null&&(function(s,a){s.preventDefault(),a.update(()=>{const i=Ct(),o=yu(s,InputEvent)||yu(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&jA(o,i,a)},{tag:CZ})}(e,t),!0)},_r),t.registerCommand(J9,e=>{const r=Ct();return dt(r)&&y2(r),!1},_r),t.registerCommand(eR,e=>{const r=Ct();return dt(r)&&y2(r),!1},_r))}const IS=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?b.useLayoutEffect:b.useEffect;function $A(t){return t.getEditorState().read(zR(t.isComposing()))}function oM({contentEditable:t,placeholder:e=null,ErrorBoundary:r}){const[n]=Oo(),s=function(a,i){const[o,l]=b.useState(()=>a.getDecorators());return IS(()=>a.registerDecoratorListener(u=>{jb.flushSync(()=>{l(u)})}),[a]),b.useEffect(()=>{l(a.getDecorators())},[a]),b.useMemo(()=>{const u=[],d=Object.keys(o);for(let g=0;g<d.length;g++){const h=d[g],p=c.jsx(i,{onError:v=>a._onError(v),children:c.jsx(b.Suspense,{fallback:null,children:o[h]})}),x=a.getElementByKey(h);x!==null&&u.push(jb.createPortal(p,x,h))}return u},[i,o,a])}(n,r);return function(a){IS(()=>pd(Bee(a),_ee(a)),[a])}(n),c.jsxs(c.Fragment,{children:[t,c.jsx(Uee,{content:e}),s]})}function Uee({content:t}){const[e]=Oo(),r=function(s){const[a,i]=b.useState(()=>$A(s));return IS(()=>{function o(){const l=$A(s);i(l)}return o(),pd(s.registerUpdateListener(()=>{o()}),s.registerEditableListener(()=>{o()}))},[s]),a}(e),n=oee();return r?typeof t=="function"?t(n):t:null}const lM=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?b.useLayoutEffect:b.useEffect;function $ee({editor:t,ariaActiveDescendant:e,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:l,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:g,ariaRequired:h,autoCapitalize:p,className:x,id:v,role:w="textbox",spellCheck:S=!0,style:_,tabIndex:y,"data-testid":k,...N},E){const[A,C]=b.useState(t.isEditable()),F=b.useCallback(M=>{M&&M.ownerDocument&&M.ownerDocument.defaultView?t.setRootElement(M):t.setRootElement(null)},[t]),P=b.useMemo(()=>function(...M){return I=>{M.forEach(Y=>{typeof Y=="function"?Y(I):Y!=null&&(Y.current=I)})}}(E,F),[F,E]);return lM(()=>(C(t.isEditable()),t.registerEditableListener(M=>{C(M)})),[t]),c.jsx("div",{"aria-activedescendant":A?e:void 0,"aria-autocomplete":A?r:"none","aria-controls":A?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":A&&w==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":l,"aria-labelledby":u,"aria-multiline":d,"aria-owns":A?g:void 0,"aria-readonly":!A||void 0,"aria-required":h,autoCapitalize:p,className:x,contentEditable:A,"data-testid":k,id:v,ref:P,role:w,spellCheck:S,style:_,tabIndex:y,...N})}const Wee=b.forwardRef($ee);function WA(t){return t.getEditorState().read(zR(t.isComposing()))}const cM=b.forwardRef(Hee);function Hee(t,e){const{placeholder:r,...n}=t,[s]=Oo();return c.jsxs(c.Fragment,{children:[c.jsx(Wee,{editor:s,...n,ref:e}),r!=null&&c.jsx(zee,{editor:s,content:r})]})}function zee({content:t,editor:e}){const r=function(i){const[o,l]=b.useState(()=>WA(i));return lM(()=>{function u(){const d=WA(i);l(d)}return u(),pd(i.registerUpdateListener(()=>{u()}),i.registerEditableListener(()=>{u()}))},[i]),o}(e),[n,s]=b.useState(e.isEditable());if(b.useLayoutEffect(()=>(s(e.isEditable()),e.registerEditableListener(i=>{s(i)})),[e]),!r)return null;let a=null;return typeof t=="function"?a=t(n):t!==null&&(a=t),a===null?null:c.jsx("div",{"aria-hidden":!0,children:a})}const cx=0,OS=1,LS=2,Ui=0,Gee=1,HA=2,Vee=3,Kee=4;function Xee(t,e,r,n,s){if(t===null||r.size===0&&n.size===0&&!s)return Ui;const a=e._selection,i=t._selection;if(s)return Gee;if(!(dt(a)&&dt(i)&&i.isCollapsed()&&a.isCollapsed()))return Ui;const o=function(S,_,y){const k=S._nodeMap,N=[];for(const E of _){const A=k.get(E);A!==void 0&&N.push(A)}for(const[E,A]of y){if(!A)continue;const C=k.get(E);C===void 0||rs(C)||N.push(C)}return N}(e,r,n);if(o.length===0)return Ui;if(o.length>1){const S=e._nodeMap,_=S.get(a.anchor.key),y=S.get(i.anchor.key);return _&&y&&!t._nodeMap.has(_.__key)&&Tt(_)&&_.__text.length===1&&a.anchor.offset===1?HA:Ui}const l=o[0],u=t._nodeMap.get(l.__key);if(!Tt(u)||!Tt(l)||u.__mode!==l.__mode)return Ui;const d=u.__text,g=l.__text;if(d===g)return Ui;const h=a.anchor,p=i.anchor;if(h.key!==p.key||h.type!=="text")return Ui;const x=h.offset,v=p.offset,w=g.length-d.length;return w===1&&v===x-1?HA:w===-1&&v===x+1?Vee:w===-1&&v===x?Kee:Ui}function Yee(t,e){let r=Date.now(),n=Ui;return(s,a,i,o,l,u)=>{const d=Date.now();if(u.has(U1))return n=Ui,r=d,LS;const g=Xee(s,a,o,l,t.isComposing()),h=(()=>{const p=i===null||i.editor===t,x=u.has(kZ);if(!x&&p&&u.has(K0))return cx;if(s===null)return OS;const v=a._selection;return o.size>0||l.size>0?x===!1&&g!==Ui&&g===n&&d<r+e&&p||o.size===1&&function(w,S,_){const y=S._nodeMap.get(w),k=_._nodeMap.get(w),N=S._selection,E=_._selection;return!(dt(N)&&dt(E)&&N.anchor.type==="element"&&N.focus.type==="element"&&E.anchor.type==="text"&&E.focus.type==="text"||!Tt(y)||!Tt(k)||y.__parent!==k.__parent)&&JSON.stringify(S.read(()=>y.exportJSON()))===JSON.stringify(_.read(()=>k.exportJSON()))}(Array.from(o)[0],s,a)?cx:OS:v!==null?cx:LS})();return r=d,n=g,h}}function zA(t){t.undoStack=[],t.redoStack=[],t.current=null}function Jee(t,e,r){const n=Yee(t,r);return pd(t.registerCommand(uT,()=>(function(a,i){const o=i.redoStack,l=i.undoStack;if(l.length!==0){const u=i.current,d=l.pop();u!==null&&(o.push(u),a.dispatchCommand(ex,!0)),l.length===0&&a.dispatchCommand(tx,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:U1})}}(t,e),!0),_r),t.registerCommand(dT,()=>(function(a,i){const o=i.redoStack,l=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(l.push(u),a.dispatchCommand(tx,!0));const d=o.pop();o.length===0&&a.dispatchCommand(ex,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:U1})}}(t,e),!0),_r),t.registerCommand(aZ,()=>(zA(e),!1),_r),t.registerCommand(iZ,()=>(zA(e),t.dispatchCommand(ex,!1),t.dispatchCommand(tx,!1),!0),_r),t.registerUpdateListener(({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:l,tags:u})=>{const d=e.current,g=e.redoStack,h=e.undoStack,p=d===null?null:d.editorState;if(d!==null&&a===p)return;const x=n(i,a,d,o,l,u);if(x===OS)g.length!==0&&(e.redoStack=[],t.dispatchCommand(ex,!1)),d!==null&&(h.push({...d}),t.dispatchCommand(tx,!0));else if(x===LS)return;e.current={editor:t,editorState:a}}))}function Qee(){return{current:null,redoStack:[],undoStack:[]}}function uM({delay:t,externalHistoryState:e}){const[r]=Oo();return function(n,s,a=1e3){const i=b.useMemo(()=>s||Qee(),[s]);b.useEffect(()=>Jee(n,i,a),[a,n,i])}(r,e,t),null}function dM({defaultSelection:t}){const[e]=Oo();return b.useEffect(()=>{e.focus(()=>{const r=document.activeElement,n=e.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})},{defaultSelection:t})},[t,e]),null}function BS(t,e){return BS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},BS(t,e)}var GA={error:null},qee=function(t){var e,r;function n(){for(var a,i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];return(a=t.call.apply(t,[this].concat(o))||this).state=GA,a.resetErrorBoundary=function(){for(var u,d=arguments.length,g=new Array(d),h=0;h<d;h++)g[h]=arguments[h];a.props.onReset==null||(u=a.props).onReset.apply(u,g),a.reset()},a}r=t,(e=n).prototype=Object.create(r.prototype),e.prototype.constructor=e,BS(e,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(GA)},s.componentDidCatch=function(a,i){var o,l;(o=(l=this.props).onError)==null||o.call(l,a,i)},s.componentDidUpdate=function(a,i){var o,l,u,d,g=this.state.error,h=this.props.resetKeys;g!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=h)===void 0&&(d=[]),u.length!==d.length||u.some(function(p,x){return!Object.is(p,d[x])}))&&((o=(l=this.props).onResetKeysChange)==null||o.call(l,a.resetKeys,h),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,l=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(b.isValidElement(u))return u;if(typeof o=="function")return o(d);if(l)return b.createElement(l,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n}(b.Component);function fM({children:t,onError:e}){return c.jsx(qee,{fallback:c.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:e,children:t})}const UT=/^(\d+(?:\.\d+)?)px$/,Pf={BOTH:3,NO_STATUS:0,ROW:1};class Eh extends Js{static getType(){return"tablecell"}static clone(e){return new Eh(e.__headerState,e.__colSpan,e.__width,e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__rowSpan=e.__rowSpan,this.__backgroundColor=e.__backgroundColor,this.__verticalAlign=e.__verticalAlign}static importDOM(){return{td:e=>({conversion:VA,priority:0}),th:e=>({conversion:VA,priority:0})}}static importJSON(e){return hM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeaderStyles(e.headerState).setColSpan(e.colSpan||1).setRowSpan(e.rowSpan||1).setWidth(e.width||void 0).setBackgroundColor(e.backgroundColor||null).setVerticalAlign(e.verticalAlign||void 0)}constructor(e=Pf.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=e,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(e){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),US(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Zn(r,e.theme.tableCell,this.hasHeader()&&e.theme.tableCellHeader),r}exportDOM(e){const r=super.exportDOM(e);if(Zr(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...US(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(e){const r=this.getWritable();return r.__colSpan=e,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(e){const r=this.getWritable();return r.__rowSpan=e,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(e,r=Pf.BOTH){const n=this.getWritable();return n.__headerState=e&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(e){const r=this.getWritable();return r.__width=e,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(e){const r=this.getWritable();return r.__backgroundColor=e,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(e){const r=this.getWritable();return r.__verticalAlign=e||void 0,r}toggleHeaderStyle(e){const r=this.getWritable();return(r.__headerState&e)===e?r.__headerState-=e:r.__headerState+=e,r}hasHeaderState(e){return(this.getHeaderStyles()&e)===e}hasHeader(){return this.getLatest().__headerState!==Pf.NO_STATUS}updateDOM(e){return e.__headerState!==this.__headerState||e.__width!==this.__width||e.__colSpan!==this.__colSpan||e.__rowSpan!==this.__rowSpan||e.__backgroundColor!==this.__backgroundColor||e.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function US(t){return t==="middle"||t==="bottom"}function VA(t){const e=t,r=t.nodeName.toLowerCase();let n;UT.test(e.style.width)&&(n=parseFloat(e.style.width));const s=hM(r==="th"?Pf.ROW:Pf.NO_STATUS,e.colSpan,n);s.__rowSpan=e.rowSpan;const a=e.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=e.style.verticalAlign;US(i)&&(s.__verticalAlign=i);const o=e.style,l=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=l.includes("line-through"),g=o.fontStyle==="italic",h=l.includes("underline");return{after:p=>{const x=[];let v=null;const w=()=>{if(v){const S=v.getFirstChild();ul(S)&&v.getChildrenSize()===1&&S.remove()}};for(const S of p)BZ(S)||Tt(S)||ul(S)?(Tt(S)&&(u&&S.toggleFormat("bold"),d&&S.toggleFormat("strikethrough"),g&&S.toggleFormat("italic"),h&&S.toggleFormat("underline")),v?v.append(S):(v=qr().append(S),x.push(v))):(x.push(S),w(),v=null);return w(),x.length===0&&x.push(qr()),x},node:s}}function hM(t=Pf.NO_STATUS,e=1,r){return fa(new Eh(t,e,r))}function Og(t){return t instanceof Eh}function $S(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class Nh extends Js{static getType(){return"tablerow"}static clone(e){return new Nh(e.__height,e.__key)}static importDOM(){return{tr:e=>({conversion:Zee,priority:0})}}static importJSON(e){return gM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHeight(e.height)}constructor(e,r){super(r),this.__height=e}exportJSON(){const e=this.getHeight();return{...super.exportJSON(),...e===void 0?void 0:{height:e}}}createDOM(e){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Zn(r,e.theme.tableRow),r}extractWithChild(e,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(e){const r=this.getWritable();return r.__height=e,r}getHeight(){return this.getLatest().__height}updateDOM(e){return e.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Zee(t){const e=t;let r;return UT.test(e.style.height)&&(r=parseFloat(e.style.height)),{after:n=>eM(n,Og),node:gM(r)}}function gM(t){return fa(new Nh(t))}function mM(t){return t instanceof Nh}const pM=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,ete=pM&&"documentMode"in document?document.documentMode:null;pM&&"InputEvent"in window&&!ete&&new window.InputEvent("input");function tte(t,e,r){const n=[];let s=null,a=null;function i(l){let u=n[l];return u===void 0&&(n[l]=u=[]),u}const o=t.getChildren();for(let l=0;l<o.length;l++){const u=o[l];mM(u)||$S(209);const d=i(l);for(let g=u.getFirstChild(),h=0;g!=null;g=g.getNextSibling()){for(Og(g)||$S(147);d[h]!==void 0;)h++;const p={cell:g,startColumn:h,startRow:l},{__rowSpan:x,__colSpan:v}=g;for(let w=0;w<x&&!(l+w>=o.length);w++){const S=i(l+w);for(let _=0;_<v;_++)S[h+_]=p}}}return[n,s,a]}function g0(t){return Zr(t)&&t.nodeName==="TABLE"}function rte(t,e){for(let r=e,n=null;r!==null;r=r.getParent()){if(t.is(r))return n;Og(r)&&(n=r)}return null}function nte(t,e,r){return rte(t,Sc(e,r))}function KA(t,e,r){if(!e.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=e.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}pc(t,...n),Zn(t,...s)}const ste=new WeakSet;function XA(t=Sm()){return ste.has(t)}class Em extends Js{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(e){const r=this.getWritable();return r.__colWidths=e,r}static clone(e){return new Em(e.__key)}afterCloneFrom(e){super.afterCloneFrom(e),this.__colWidths=e.__colWidths,this.__rowStriping=e.__rowStriping,this.__frozenColumnCount=e.__frozenColumnCount,this.__frozenRowCount=e.__frozenRowCount}static importDOM(){return{table:e=>({conversion:ate,priority:1})}}static importJSON(e){return xM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setRowStriping(e.rowStriping||!1).setFrozenColumns(e.frozenColumnCount||0).setFrozenRows(e.frozenRowCount||0).setColWidths(e.colWidths)}constructor(e){super(e),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(e,r,n){return n==="html"}getDOMSlot(e){const r=g0(e)?e:e.querySelector("table");return g0(r)||$S(229),super.getDOMSlot(e).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(e,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),zZ(s),Zn(n,e.theme.table),this.updateTableElement(null,n,e),XA(r)){const a=document.createElement("div"),i=e.theme.tableScrollableWrapper;return i?Zn(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,e),a}return n}updateTableWrapper(e,r,n,s){this.__frozenColumnCount!==(e?e.__frozenColumnCount:0)&&function(a,i,o,l){l>0?(Zn(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(pc(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))}(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(e?e.__frozenRowCount:0)&&function(a,i,o,l){l>0?(Zn(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(pc(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))}(r,n,s,this.__frozenRowCount)}updateTableElement(e,r,n){this.__style!==(e?e.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!e&&e.__rowStriping)&&function(s,a,i){i?(Zn(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(pc(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))}(r,n,this.__rowStriping),function(s,a,i,o){const l=s.querySelector("colgroup");if(!l)return;const u=[];for(let d=0;d<i;d++){const g=document.createElement("col"),h=o&&o[d];h&&(g.style.width=`${h}px`),u.push(g)}l.replaceChildren(...u)}(r,0,this.getColumnCount(),this.getColWidths()),KA(r,n,this.getFormatType())}updateDOM(e,r,n){const s=this.getDOMSlot(r).element;return r===s===XA()||(Zr(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(e,r,s,n),this.updateTableElement(e,s,n),!1);var a}exportDOM(e){const r=super.exportDOM(e),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!g0(s)&&Zr(s)&&(s=s.querySelector("table")),!g0(s))return null;KA(s,e._config,this.getFormatType());const[a]=tte(this),i=new Map;for(const d of a)for(const g of d){const h=g.cell.getKey();i.has(h)||i.set(h,{colSpan:g.cell.getColSpan(),startColumn:g.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const g=d.getAttribute("data-temporary-table-cell-lexical-key");if(g){const h=i.get(g);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),h){i.delete(g);for(let p=0;p<h.colSpan;p++)o.add(p+h.startColumn)}}}const l=s.querySelector(":scope > colgroup");if(l){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter((g,h)=>o.has(h));l.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const g of u)d.appendChild(g);s.append(d)}return s},element:!g0(n)&&Zr(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(e,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const l=i[o];if(l==null)continue;const{elem:u}=l,d=nte(this,u);if(d!==null&&e.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(e,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[e<a.length?e:a.length-1];return i??null}getDOMCellFromCordsOrThrow(e,r,n){const s=this.getDOMCellFromCords(e,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(e,r,n){const s=this.getDOMCellFromCords(e,r,n);if(s==null)return null;const a=Sc(s.elem);return Og(a)?a:null}getCellNodeFromCordsOrThrow(e,r,n){const s=this.getCellNodeFromCords(e,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(e){const r=this.getWritable();return r.__rowStriping=e,r}setFrozenColumns(e){const r=this.getWritable();return r.__frozenColumnCount=e,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(e){const r=this.getWritable();return r.__frozenRowCount=e,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const e=this.getFirstChild();if(!e)return 0;let r=0;return e.getChildren().forEach(n=>{Og(n)&&(r+=n.getColSpan())}),r}}function ate(t){const e=xM();t.hasAttribute("data-lexical-row-striping")&&e.setRowStriping(!0),t.hasAttribute("data-lexical-frozen-column")&&e.setFrozenColumns(1),t.hasAttribute("data-lexical-frozen-row")&&e.setFrozenRows(1);const r=t.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!UT.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&e.setColWidths(n)}return{after:n=>eM(n,mM),node:e}}function xM(){return fa(new Em)}function rc(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function WS(t){let e=1,r=t.getParent();for(;r!=null;){if(Fr(r)){const n=r.getParent();if(rr(n)){e++,r=n.getParent();continue}rc(40)}return e}return e}function HS(t){let e=t.getParent();rr(e)||rc(40);let r=e;for(;r!==null;)r=r.getParent(),rr(r)&&(e=r);return e}function yM(t){let e=[];const r=t.getChildren().filter(Fr);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();rr(a)?e=e.concat(yM(a)):e.push(s)}return e}function Co(t){return Fr(t)&&rr(t.getFirstChild())}function YA(t){return za().append(t)}function vM(t,e){return Fr(t)&&(e.length===0||e.length===1&&t.is(e[0])&&t.getChildrenSize()===0)}function JA(t){const e=Ct();if(e!==null){let r=e.getNodes();if(dt(e)){const s=e.getStartEndPoints();s===null&&rc(143);const[a]=s,i=a.getNode(),o=i.getParent();if(la(i)){const l=i.getFirstChild();if(l)r=l.selectStart().getNodes();else{const u=qr();i.append(u),r=u.select().getNodes()}}else if(vM(i,r)){const l=ja(t);if(la(o)){i.replace(l);const u=za();Je(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),l.append(u)}else if(Fr(i)){const u=i.getParentOrThrow();Qu(l,u.getChildren()),u.replace(l)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(Je(a)&&a.isEmpty()&&!Fr(a)&&!n.has(a.getKey())){QA(a,t);continue}let i=NR(a)?a.getParent():Fr(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(rr(i)){if(!n.has(o)){const l=ja(t);Qu(l,i.getChildren()),i.replace(l),n.add(o)}break}{const l=i.getParent();if(la(l)&&!n.has(o)){n.add(o),QA(i,t);break}i=l}}}}}function Qu(t,e){t.splice(t.getChildrenSize(),0,e)}function QA(t,e){if(rr(t))return t;const r=t.getPreviousSibling(),n=t.getNextSibling(),s=za();let a;if(Qu(s,t.getChildren()),rr(r)&&e===r.getListType())r.append(s),rr(n)&&e===n.getListType()&&(Qu(r,n.getChildren()),n.remove()),a=r;else if(rr(n)&&e===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=ja(e);i.append(s),t.replace(i),a=i}return s.setFormat(t.getFormatType()),s.setIndent(t.getIndent()),t.remove(),a}function $T(t,e){const r=t.getLastChild(),n=e.getFirstChild();r&&n&&Co(r)&&Co(n)&&($T(r.getFirstChild(),n.getFirstChild()),n.remove());const s=e.getChildren();s.length>0&&t.append(...s),e.remove()}function ite(){const t=Ct();if(dt(t)){const e=new Set,r=t.getNodes(),n=t.anchor.getNode();if(vM(n,r))e.add(HS(n));else for(let s=0;s<r.length;s++){const a=r[s];if(NR(a)){const i=xee(a,Al);i!=null&&e.add(HS(i))}}for(const s of e){let a=s;const i=yM(s);for(const o of i){const l=qr().setTextStyle(t.style).setTextFormat(t.format);Qu(l,o.getChildren()),a.insertAfter(l),a=l,o.__key===t.anchor.key&&Ju(t.anchor,vi(Ti(l,"next"))),o.__key===t.focus.key&&Ju(t.focus,vi(Ti(l,"next"))),o.remove()}s.remove()}}}function wM(t){const e=t.getListType()!=="check";let r=t.getStart();for(const n of t.getChildren())Fr(n)&&(n.getValue()!==r&&n.setValue(r),e&&n.getLatest().__checked!=null&&n.setChecked(void 0),rr(n.getFirstChild())||r++)}function ote(t){const e=new Set;if(Co(t)||e.has(t.getKey()))return;const r=t.getParent(),n=t.getNextSibling(),s=t.getPreviousSibling();if(Co(n)&&Co(s)){const a=s.getFirstChild();if(rr(a)){a.append(t);const i=n.getFirstChild();rr(i)&&(Qu(a,i.getChildren()),n.remove(),e.add(n.getKey()))}}else if(Co(n)){const a=n.getFirstChild();if(rr(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(t)}}else if(Co(s)){const a=s.getFirstChild();rr(a)&&a.append(t)}else if(rr(r)){const a=za().setTextFormat(t.getTextFormat()).setTextStyle(t.getTextStyle()),i=ja(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(t),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function lte(t){if(Co(t))return;const e=t.getParent(),r=e?e.getParent():void 0;if(rr(r?r.getParent():void 0)&&Fr(r)&&rr(e)){const n=e?e.getFirstChild():void 0,s=e?e.getLastChild():void 0;if(t.is(n))r.insertBefore(t),e.isEmpty()&&r.remove();else if(t.is(s))r.insertAfter(t),e.isEmpty()&&r.remove();else{const a=e.getListType(),i=za(),o=ja(a);i.append(o),t.getPreviousSiblings().forEach(d=>o.append(d));const l=za(),u=ja(a);l.append(u),Qu(u,t.getNextSiblings()),r.insertBefore(i),r.insertAfter(l),r.replace(t)}}}function cte(){const t=Ct();if(!dt(t)||!t.isCollapsed())return!1;const e=t.anchor.getNode();if(!Fr(e)||e.getChildrenSize()!==0)return!1;const r=HS(e),n=e.getParent();rr(n)||rc(40);const s=n.getParent();let a;if(la(s))a=qr(),r.insertAfter(a);else{if(!Fr(s))return!1;a=za(),s.insertAfter(a)}a.setTextStyle(t.style).setTextFormat(t.format).select();const i=e.getNextSiblings();if(i.length>0){const o=ja(n.getListType());if(Fr(a)){const l=za();l.append(o),a.insertAfter(l)}else a.insertAfter(o);o.append(...i)}return function(o){let l=o;for(;l.getNextSibling()==null&&l.getPreviousSibling()==null;){const u=l.getParent();if(u==null||!Fr(u)&&!rr(u))break;l=u}l.remove()}(e),!0}function G1(...t){const e=[];for(const r of t)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))e.push(n);return e}let Al=class extends Js{$config(){return this.config("listitem",{$transform:e=>{if(e.__checked==null)return;const r=e.getParent();rr(r)&&r.getListType()!=="check"&&e.getChecked()!=null&&e.setChecked(void 0)},extends:Js,importDOM:{li:()=>({conversion:ute,priority:0})}})}constructor(e=1,r=void 0,n){super(n),this.__value=e===void 0?1:e,this.__checked=r}afterCloneFrom(e){super.afterCloneFrom(e),this.__value=e.__value,this.__checked=e.__checked}createDOM(e){const r=document.createElement("li");return this.updateListItemDOM(null,r,e),r}updateListItemDOM(e,r,n){const s=this.getParent();rr(s)&&s.getListType()==="check"&&function(o,l,u,d){rr(l.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&l.__checked===u.__checked||o.setAttribute("aria-checked",l.getChecked()?"true":"false"))}(r,this,e),r.value=this.__value,function(o,l,u){const d=[],g=[],h=l.list,p=h?h.listitem:void 0;let x;if(h&&h.nested&&(x=h.nested.listitem),p!==void 0&&d.push(...G1(p)),h){const v=u.getParent(),w=rr(v)&&v.getListType()==="check",S=u.getChecked();w&&!S||g.push(h.listitemUnchecked),w&&S||g.push(h.listitemChecked),w&&d.push(S?h.listitemChecked:h.listitemUnchecked)}if(x!==void 0){const v=G1(x);u.getChildren().some(w=>rr(w))?d.push(...v):g.push(...v)}g.length>0&&pc(o,...g),d.length>0&&Zn(o,...d)}(r,n.theme,this);const a=e?e.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),function(o,l,u){const d=TA(l.__textStyle);for(const g in d)o.style.setProperty(`--listitem-marker-${g}`,d[g]);if(u)for(const g in TA(u.__textStyle))g in d||o.style.removeProperty(`--listitem-marker-${g}`)}(r,this,e)}updateDOM(e,r,n){const s=r;return this.updateListItemDOM(e,s,n),!1}updateFromJSON(e){return super.updateFromJSON(e).setValue(e.value).setChecked(e.checked)}exportDOM(e){const r=this.createDOM(e._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...e){for(let r=0;r<e.length;r++){const n=e[r];if(Je(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(e,r){if(Fr(e))return super.replace(e);this.setIndent(0);const n=this.getParentOrThrow();if(!rr(n))return e;if(n.__first===this.getKey())n.insertBefore(e);else if(n.__last===this.getKey())n.insertAfter(e);else{const s=ja(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(e),e.insertAfter(s)}return r&&(Je(e)||rc(139),this.getChildren().forEach(s=>{e.append(s)})),this.remove(),n.getChildrenSize()===0&&n.remove(),e}insertAfter(e,r=!0){const n=this.getParentOrThrow();if(rr(n)||rc(39),Fr(e))return super.insertAfter(e,r);const s=this.getNextSiblings();if(n.insertAfter(e,r),s.length!==0){const a=ja(n.getListType());s.forEach(i=>a.append(i)),e.insertAfter(a,r)}return e}remove(e){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(e),r&&n&&Co(r)&&Co(n)&&($T(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(e,r=!0){const n=za().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(e){const r=qr();this.getChildren().forEach(i=>r.append(i));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=Fr(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=e.anchor,o=e.focus,l=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(l,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(l,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(e){const r=this.getWritable();return r.__value=e,r}getChecked(){const e=this.getLatest();let r;const n=this.getParent();return rr(n)&&(r=n.getListType()),r==="check"?!!e.__checked:void 0}setChecked(e){const r=this.getWritable();return r.__checked=e,r}toggleChecked(){const e=this.getWritable();return e.setChecked(!e.__checked)}getIndent(){const e=this.getParent();if(e===null||!this.isAttached())return this.getLatest().__indent;let r=e.getParentOrThrow(),n=0;for(;Fr(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(e){typeof e!="number"&&rc(117),(e=Math.floor(e))>=0||rc(199);let r=this.getIndent();for(;r!==e;)r<e?(ote(this),r++):(lte(this),r--);return this}canInsertAfter(e){return Fr(e)}canReplaceWith(e){return Fr(e)}canMergeWith(e){return Fr(e)||wT(e)}extractWithChild(e,r){if(!dt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return ja("bullet")}canMergeWhenEmpty(){return!0}};function ute(t){if(t.classList.contains("task-list-item")){for(const r of t.children)if(r.tagName==="INPUT")return dte(r)}const e=t.getAttribute("aria-checked");return{node:za(e==="true"||e!=="false"&&void 0)}}function dte(t){return t.getAttribute("type")!=="checkbox"?{node:null}:{node:za(t.hasAttribute("checked"))}}function za(t){return fa(new Al(void 0,t))}function Fr(t){return t instanceof Al}let Hc=class extends Js{$config(){return this.config("list",{$transform:e=>{(function(r){const n=r.getNextSibling();rr(n)&&r.getListType()===n.getListType()&&$T(r,n)})(e),wM(e)},extends:Js,importDOM:{ol:()=>({conversion:ZA,priority:0}),ul:()=>({conversion:ZA,priority:0})}})}constructor(e="number",r=1,n){super(n);const s=hte[e]||e;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(e){super.afterCloneFrom(e),this.__listType=e.__listType,this.__tag=e.__tag,this.__start=e.__start}getTag(){return this.getLatest().__tag}setListType(e){const r=this.getWritable();return r.__listType=e,r.__tag=e==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(e){const r=this.getWritable();return r.__start=e,r}createDOM(e,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,qA(s,e.theme,this),s}updateDOM(e,r,n){return e.__tag!==this.__tag||(qA(r,n.theme,this),!1)}updateFromJSON(e){return super.updateFromJSON(e).setListType(e.listType).setStart(e.start)}exportDOM(e){const r=this.createDOM(e._config,e);return Zr(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(e,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];Fr(i)||(s===n&&(s=[...n]),s[a]=za().append(!Je(i)||rr(i)||i.isInline()?i:Cn(i.getTextContent())))}return super.splice(e,r,s)}extractWithChild(e){return Fr(e)}};function qA(t,e,r){const n=[],s=[],a=e.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=WS(r)-1,l=o%i.length,u=i[l],d=a[r.__tag];let g;const h=a.nested,p=a.checklist;if(h!==void 0&&h.list&&(g=h.list),d!==void 0&&n.push(d),p!==void 0&&r.__listType==="check"&&n.push(p),u!==void 0){n.push(...G1(u));for(let x=0;x<i.length;x++)x!==l&&s.push(r.__tag+x)}if(g!==void 0){const x=G1(g);o>1?n.push(...x):s.push(...x)}}s.length>0&&pc(t,...s),n.length>0&&Zn(t,...n)}function fte(t){const e=[];for(let r=0;r<t.length;r++){const n=t[r];if(Fr(n)){e.push(n);const s=n.getChildren();s.length>1&&s.forEach(a=>{rr(a)&&e.push(YA(a))})}else e.push(YA(n))}return e}function ZA(t){const e=t.nodeName.toLowerCase();let r=null;return e==="ol"?r=ja("number",t.start):e==="ul"&&(r=function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(Zr(s)&&s.hasAttribute("aria-checked"))return!0;return!1}(t)?ja("check"):ja("bullet")),{after:fte,node:r}}const hte={ol:"number",ul:"bullet"};function ja(t="number",e=1){return fa(new Hc(t,e))}function rr(t){return t instanceof Hc}const gte=Xt("UPDATE_LIST_START_COMMAND"),WT=Xt("INSERT_UNORDERED_LIST_COMMAND"),HT=Xt("INSERT_ORDERED_LIST_COMMAND"),zT=Xt("REMOVE_LIST_COMMAND");function mte(t){return pd(t.registerCommand(HT,()=>(JA("number"),!0),Yd),t.registerCommand(gte,e=>{const{listNodeKey:r,newStart:n}=e,s=Kn(r);return!!rr(s)&&(s.getListType()==="number"&&(s.setStart(n),wM(s)),!0)},Yd),t.registerCommand(WT,()=>(JA("bullet"),!0),Yd),t.registerCommand(zT,()=>(ite(),!0),Yd),t.registerCommand(Dg,()=>cte(),Yd),t.registerNodeTransform(Al,e=>{const r=e.getFirstChild();if(r){if(Tt(r)){const n=r.getStyle(),s=r.getFormat();e.getTextStyle()!==n&&e.setTextStyle(n),e.getTextFormat()!==s&&e.setTextFormat(s)}}else{const n=Ct();dt(n)&&(n.style!==e.getTextStyle()||n.format!==e.getTextFormat())&&n.isCollapsed()&&e.is(n.anchor.getNode())&&e.setTextStyle(n.style).setTextFormat(n.format)}}),t.registerNodeTransform($c,e=>{const r=e.getParent();if(Fr(r)&&e.is(r.getFirstChild())){const n=e.getStyle(),s=e.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}}))}function pte(t){const e=r=>{const n=r.getParent();if(rr(r.getFirstChild())||!rr(n))return;const s=Mv(r,a=>Fr(a)&&rr(a.getParent())&&Fr(a.getPreviousSibling()));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(Fr(s)){const a=s.getPreviousSibling();if(Fr(a)){const i=function(l){let u=l,d=u.getFirstChild();for(;rr(d);){const g=d.getLastChild();if(!Fr(g))break;u=g,d=u.getFirstChild()}return u}(a),o=i.getParent();if(rr(o)){const l=WS(o);l+1<WS(n)&&r.setIndent(l)}}}};return t.registerNodeTransform(Hc,r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(rr(s)){for(const a of s.getChildren())if(Fr(a)){e(a);const i=a.getFirstChild();rr(i)&&n.push(i)}}}})}var xte={exports:{}};(function(t){var e=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function _(y){return y instanceof l?new l(y.type,_(y.content),y.alias):Array.isArray(y)?y.map(_):y.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(_){return Object.prototype.toString.call(_).slice(8,-1)},objId:function(_){return _.__id||Object.defineProperty(_,"__id",{value:++a}),_.__id},clone:function _(y,k){k=k||{};var N,E;switch(o.util.type(y)){case"Object":if(E=o.util.objId(y),k[E])return k[E];N={},k[E]=N;for(var A in y)y.hasOwnProperty(A)&&(N[A]=_(y[A],k));return N;case"Array":return E=o.util.objId(y),k[E]?k[E]:(N=[],k[E]=N,y.forEach(function(C,F){N[F]=_(C,k)}),N);default:return y}},getLanguage:function(_){for(;_;){var y=s.exec(_.className);if(y)return y[1].toLowerCase();_=_.parentElement}return"none"},setLanguage:function(_,y){_.className=_.className.replace(RegExp(s,"gi"),""),_.classList.add("language-"+y)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(N){var _=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(N.stack)||[])[1];if(_){var y=document.getElementsByTagName("script");for(var k in y)if(y[k].src==_)return y[k]}return null}},isActive:function(_,y,k){for(var N="no-"+y;_;){var E=_.classList;if(E.contains(y))return!0;if(E.contains(N))return!1;_=_.parentElement}return!!k}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(_,y){var k=o.util.clone(o.languages[_]);for(var N in y)k[N]=y[N];return k},insertBefore:function(_,y,k,N){N=N||o.languages;var E=N[_],A={};for(var C in E)if(E.hasOwnProperty(C)){if(C==y)for(var F in k)k.hasOwnProperty(F)&&(A[F]=k[F]);k.hasOwnProperty(C)||(A[C]=E[C])}var P=N[_];return N[_]=A,o.languages.DFS(o.languages,function(M,I){I===P&&M!=_&&(this[M]=A)}),A},DFS:function _(y,k,N,E){E=E||{};var A=o.util.objId;for(var C in y)if(y.hasOwnProperty(C)){k.call(y,C,y[C],N||C);var F=y[C],P=o.util.type(F);P==="Object"&&!E[A(F)]?(E[A(F)]=!0,_(F,k,null,E)):P==="Array"&&!E[A(F)]&&(E[A(F)]=!0,_(F,k,C,E))}}},plugins:{},highlightAll:function(_,y){o.highlightAllUnder(document,_,y)},highlightAllUnder:function(_,y,k){var N={callback:k,container:_,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",N),N.elements=Array.prototype.slice.apply(N.container.querySelectorAll(N.selector)),o.hooks.run("before-all-elements-highlight",N);for(var E=0,A;A=N.elements[E++];)o.highlightElement(A,y===!0,N.callback)},highlightElement:function(_,y,k){var N=o.util.getLanguage(_),E=o.languages[N];o.util.setLanguage(_,N);var A=_.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,N);var C=_.textContent,F={element:_,language:N,grammar:E,code:C};function P(I){F.highlightedCode=I,o.hooks.run("before-insert",F),F.element.innerHTML=F.highlightedCode,o.hooks.run("after-highlight",F),o.hooks.run("complete",F),k&&k.call(F.element)}if(o.hooks.run("before-sanity-check",F),A=F.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!F.code){o.hooks.run("complete",F),k&&k.call(F.element);return}if(o.hooks.run("before-highlight",F),!F.grammar){P(o.util.encode(F.code));return}if(y&&n.Worker){var M=new Worker(o.filename);M.onmessage=function(I){P(I.data)},M.postMessage(JSON.stringify({language:F.language,code:F.code,immediateClose:!0}))}else P(o.highlight(F.code,F.grammar,F.language))},highlight:function(_,y,k){var N={code:_,grammar:y,language:k};if(o.hooks.run("before-tokenize",N),!N.grammar)throw new Error('The language "'+N.language+'" has no grammar.');return N.tokens=o.tokenize(N.code,N.grammar),o.hooks.run("after-tokenize",N),l.stringify(o.util.encode(N.tokens),N.language)},tokenize:function(_,y){var k=y.rest;if(k){for(var N in k)y[N]=k[N];delete y.rest}var E=new g;return h(E,E.head,_),d(_,E,y,E.head,0),x(E)},hooks:{all:{},add:function(_,y){var k=o.hooks.all;k[_]=k[_]||[],k[_].push(y)},run:function(_,y){var k=o.hooks.all[_];if(!(!k||!k.length))for(var N=0,E;E=k[N++];)E(y)}},Token:l};n.Prism=o;function l(_,y,k,N){this.type=_,this.content=y,this.alias=k,this.length=(N||"").length|0}l.stringify=function _(y,k){if(typeof y=="string")return y;if(Array.isArray(y)){var N="";return y.forEach(function(P){N+=_(P,k)}),N}var E={type:y.type,content:_(y.content,k),tag:"span",classes:["token",y.type],attributes:{},language:k},A=y.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(E.classes,A):E.classes.push(A)),o.hooks.run("wrap",E);var C="";for(var F in E.attributes)C+=" "+F+'="'+(E.attributes[F]||"").replace(/"/g,"&quot;")+'"';return"<"+E.tag+' class="'+E.classes.join(" ")+'"'+C+">"+E.content+"</"+E.tag+">"};function u(_,y,k,N){_.lastIndex=y;var E=_.exec(k);if(E&&N&&E[1]){var A=E[1].length;E.index+=A,E[0]=E[0].slice(A)}return E}function d(_,y,k,N,E,A){for(var C in k)if(!(!k.hasOwnProperty(C)||!k[C])){var F=k[C];F=Array.isArray(F)?F:[F];for(var P=0;P<F.length;++P){if(A&&A.cause==C+","+P)return;var M=F[P],I=M.inside,Y=!!M.lookbehind,se=!!M.greedy,L=M.alias;if(se&&!M.pattern.global){var z=M.pattern.toString().match(/[imsuy]*$/)[0];M.pattern=RegExp(M.pattern.source,z+"g")}for(var G=M.pattern||M,O=N.next,R=E;O!==y.tail&&!(A&&R>=A.reach);R+=O.value.length,O=O.next){var X=O.value;if(y.length>_.length)return;if(!(X instanceof l)){var te=1,H;if(se){if(H=u(G,R,_,Y),!H||H.index>=_.length)break;var ae=H.index,V=H.index+H[0].length,q=R;for(q+=O.value.length;ae>=q;)O=O.next,q+=O.value.length;if(q-=O.value.length,R=q,O.value instanceof l)continue;for(var Q=O;Q!==y.tail&&(q<V||typeof Q.value=="string");Q=Q.next)te++,q+=Q.value.length;te--,X=_.slice(R,q),H.index-=R}else if(H=u(G,0,X,Y),!H)continue;var ae=H.index,J=H[0],re=X.slice(0,ae),ve=X.slice(ae+J.length),we=R+X.length;A&&we>A.reach&&(A.reach=we);var Fe=O.prev;re&&(Fe=h(y,Fe,re),R+=re.length),p(y,Fe,te);var ne=new l(C,I?o.tokenize(J,I):J,L,J);if(O=h(y,Fe,ne),ve&&h(y,O,ve),te>1){var Ee={cause:C+","+P,reach:we};d(_,y,k,O.prev,R,Ee),A&&Ee.reach>A.reach&&(A.reach=Ee.reach)}}}}}}function g(){var _={value:null,prev:null,next:null},y={value:null,prev:_,next:null};_.next=y,this.head=_,this.tail=y,this.length=0}function h(_,y,k){var N=y.next,E={value:k,prev:y,next:N};return y.next=E,N.prev=E,_.length++,E}function p(_,y,k){for(var N=y.next,E=0;E<k&&N!==_.tail;E++)N=N.next;y.next=N,N.prev=y,_.length-=E}function x(_){for(var y=[],k=_.head.next;k!==_.tail;)y.push(k.value),k=k.next;return y}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(_){var y=JSON.parse(_.data),k=y.language,N=y.code,E=y.immediateClose;n.postMessage(o.highlight(N,o.languages[k],k)),E&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var S=document.readyState;S==="loading"||S==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o}(e);t.exports&&(t.exports=r),typeof Vx<"u"&&(Vx.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))}(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,w){return" Error "+v+" while fetching file: "+w},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",u="loaded",d="failed",g="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+l+'"])';function h(v,w,S){var _=new XMLHttpRequest;_.open("GET",v,!0),_.onreadystatechange=function(){_.readyState==4&&(_.status<400&&_.responseText?w(_.responseText):_.status>=400?S(s(_.status,_.statusText)):S(a))},_.send(null)}function p(v){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(w){var S=Number(w[1]),_=w[2],y=w[3];return _?y?[S,Number(y)]:[S,void 0]:[S,S]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+g}),r.hooks.add("before-sanity-check",function(v){var w=v.element;if(w.matches(g)){v.code="",w.setAttribute(o,l);var S=w.appendChild(document.createElement("CODE"));S.textContent=n;var _=w.getAttribute("data-src"),y=v.language;if(y==="none"){var k=(/\.(\w+)$/.exec(_)||[,"none"])[1];y=i[k]||k}r.util.setLanguage(S,y),r.util.setLanguage(w,y);var N=r.plugins.autoloader;N&&N.loadLanguages(y),h(_,function(E){w.setAttribute(o,u);var A=p(w.getAttribute("data-range"));if(A){var C=E.split(/\r\n?|\n/g),F=A[0],P=A[1]==null?C.length:A[1];F<0&&(F+=C.length),F=Math.max(0,Math.min(F-1,C.length)),P<0&&(P+=C.length),P=Math.max(0,Math.min(P,C.length)),E=C.slice(F,P).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(F+1))}S.textContent=E,r.highlightElement(S)},function(E){w.setAttribute(o,d),S.textContent=E})}}),r.plugins.fileHighlight={highlight:function(w){for(var S=(w||document).querySelectorAll(g),_=0,y;y=S[_++];)r.highlightElement(y)}};var x=!1;r.fileHighlight=function(){x||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),x=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}}()})(xte);Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(t){t.type==="entity"&&(t.attributes.title=t.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(e,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(t,e){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:Prism.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(t){var e=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return e}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;t.languages.markdown=t.languages.extend("markup",{}),t.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:t.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:t.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:t.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(g){d!==g&&(t.languages.markdown[d].inside.content.inside[g]=t.languages.markdown[g])})}),t.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function g(h){if(!(!h||typeof h=="string"))for(var p=0,x=h.length;p<x;p++){var v=h[p];if(v.type!=="code"){g(v.content);continue}var w=v.content[1],S=v.content[3];if(w&&S&&w.type==="code-language"&&S.type==="code-block"&&typeof w.content=="string"){var _=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");_=(/[a-z][\w-]*/i.exec(_)||[""])[0].toLowerCase();var y="language-"+_;S.alias?typeof S.alias=="string"?S.alias=[S.alias,y]:S.alias.push(y):S.alias=[y]}}}g(d.tokens)}),t.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var g="",h=0,p=d.classes.length;h<p;h++){var x=d.classes[h],v=/language-(.+)/.exec(x);if(v){g=v[1];break}}var w=t.languages[g];if(w)d.content=t.highlight(u(d.content),w,g);else if(g&&g!=="none"&&t.plugins.autoloader){var S="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=S,t.plugins.autoloader.loadLanguages(g,function(){var _=document.getElementById(S);_&&(_.innerHTML=t.highlight(_.textContent,t.languages[g],g))})}}});var i=RegExp(t.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function u(d){var g=d.replace(i,"");return g=g.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,p){if(p=p.toLowerCase(),p[0]==="#"){var x;return p[1]==="x"?x=parseInt(p.slice(2),16):x=Number(p.slice(1)),l(x)}else{var v=o[p];return v||h}}),g}t.languages.md=t.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(t){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css;var r=t.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(t){var e=t.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};e.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:e},boolean:e.boolean,variable:e.variable}})(Prism);Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/};Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python;Prism.languages.py=Prism.languages.python;(function(t){for(var e=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)e=e.replace(/<self>/g,function(){return e});e=e.replace(/<self>/g,function(){return/[^\s\S]/.source}),t.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+e),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},t.languages.rust["closure-params"].inside.rest=t.languages.rust,t.languages.rust.attribute.inside.string=t.languages.rust.string})(Prism);Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(t){t.inside.interpolation.inside=Prism.languages.swift});(function(t){t.languages.typescript=t.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),t.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete t.languages.typescript.parameter,delete t.languages.typescript["literal-property"];var e=t.languages.extend("typescript",{});delete e["class-name"],t.languages.typescript["class-name"].inside=e,t.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e}}}}),t.languages.ts=t.languages.typescript})(Prism);(function(t){var e=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};t.languages.java=t.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:e,function:[t.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),t.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),t.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:e,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism);(function(t){var e=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return e.source});t.languages.cpp=t.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return e.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:e,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),t.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),t.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t.languages.cpp}}}}),t.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),t.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:t.languages.extend("cpp",{})}}),t.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},t.languages.cpp["base-clause"])})(Prism);function _M(t,e){for(const r of t.childNodes){if(Zr(r)&&r.tagName===e)return!0;_M(r,e)}return!1}const k0="data-language",m0="data-highlight-language",ux="data-theme";class xd extends Js{static getType(){return"code"}static clone(e){return new xd(e.__language,e.__key)}constructor(e,r){super(r),this.__language=e||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(e){super.afterCloneFrom(e),this.__language=e.__language,this.__theme=e.__theme,this.__isSyntaxHighlightSupported=e.__isSyntaxHighlightSupported}createDOM(e){const r=document.createElement("code");Zn(r,e.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(k0,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(m0,n));const s=this.getTheme();s&&r.setAttribute(ux,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(e,r,n){const s=this.__language,a=e.__language;s?s!==a&&r.setAttribute(k0,s):a&&r.removeAttribute(k0);const i=this.__isSyntaxHighlightSupported;e.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(m0,s):r.removeAttribute(m0):i&&s&&r.setAttribute(m0,s);const o=this.__theme,l=e.__theme;o?o!==l&&r.setAttribute(ux,o):l&&r.removeAttribute(ux);const u=this.__style,d=e.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(e){const r=document.createElement("pre");Zn(r,e._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(k0,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(m0,n));const s=this.getTheme();s&&r.setAttribute(ux,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:e=>e.textContent!=null&&(/\r?\n/.test(e.textContent)||_M(e,"BR"))?{conversion:e8,priority:1}:null,div:()=>({conversion:yte,priority:1}),pre:()=>({conversion:e8,priority:0}),table:e=>v2(e)?{conversion:vte,priority:3}:null,td:e=>{const r=e,n=r.closest("table");return r.classList.contains("js-file-line")||n&&v2(n)?{conversion:t8,priority:3}:null},tr:e=>{const r=e.closest("table");return r&&v2(r)?{conversion:t8,priority:3}:null}}}static importJSON(e){return il().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setLanguage(e.language).setTheme(e.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(e,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&e.isCollapsed()&&e.anchor.key===this.__key&&e.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const l=qr();return this.insertAfter(l,r),l}const{anchor:a,focus:i}=e,o=(a.isBefore(i)?a:i).getNode();if(Tt(o)){let l=_te(o);const u=[];for(;;)if(Tv(l))u.push(bh()),l=l.getNextSibling();else{if(!kM(l))break;{let w=0;const S=l.getTextContent(),_=l.getTextContentSize();for(;w<_&&S[w]===" ";)w++;if(w!==0&&u.push(SM(" ".repeat(w))),w!==_)break;l=l.getNextSibling()}}const d=o.splitText(a.offset)[0],g=a.offset===0?0:1,h=d.getIndexWithinParent()+g,p=o.getParentOrThrow(),x=[Do(),...u];p.splice(h,0,x);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(GT(o)){const{offset:l}=e.anchor;o.splice(l,0,[Do()]),o.select(l+1,l+1)}return null}canIndent(){return!1}collapseAtStart(){const e=qr();return this.getChildren().forEach(r=>e.append(r)),this.replace(e),!0}setLanguage(e){const r=this.getWritable();return r.__language=e||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(e){const r=this.getWritable();return r.__isSyntaxHighlightSupported=e,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(e){const r=this.getWritable();return r.__theme=e||void 0,r}getTheme(){return this.getLatest().__theme}}function il(t,e){return VZ(xd).setLanguage(t).setTheme(e)}function GT(t){return t instanceof xd}function e8(t){return{node:il(t.getAttribute(k0))}}function yte(t){const e=t,r=r8(e);return r||function(n){let s=n.parentElement;for(;s!==null;){if(r8(s))return!0;s=s.parentElement}return!1}(e)?{node:r?il():null}:{node:null}}function vte(){return{node:il()}}function t8(){return{node:null}}function r8(t){return t.style.fontFamily.match("monospace")!==null}function v2(t){return t.classList.contains("js-file-line-container")}let Iv=class bM extends $c{constructor(e="",r,n){super(e,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(e){return new bM(e.__text,e.__highlightType||void 0,e.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(e){const r=this.getWritable();return r.__highlightType=e||void 0,r}canHaveFormat(){return!1}createDOM(e){const r=super.createDOM(e),n=w2(e.theme,this.__highlightType);return Zn(r,n),r}updateDOM(e,r,n){const s=super.updateDOM(e,r,n),a=w2(n.theme,e.__highlightType),i=w2(n.theme,this.__highlightType);return a!==i&&(a&&pc(r,a),i&&Zn(r,i)),s}static importJSON(e){return SM().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setHighlightType(e.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(e){return this}isParentRequired(){return!0}createParentElementNode(){return il()}};function w2(t,e){return e&&t&&t.codeHighlight&&t.codeHighlight[e]}function SM(t="",e){return fa(new Iv(t,e))}function kM(t){return t instanceof Iv}function wte(t,e){let r=t;for(let n=As(t,e);n&&(kM(n.origin)||Tv(n.origin));n=pee(n))r=n.origin;return r}function _te(t){return wte(t,"previous")}(function(t){t.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var e={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(e).forEach(function(r){var n=e[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),t.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}}),Object.defineProperty(t.languages.diff,"PREFIXES",{value:e})})(Prism);const bte=new Set(["http:","https:","mailto:","sms:","tel:"]);class zc extends Js{static getType(){return"link"}static clone(e){return new zc(e.__url,{rel:e.__rel,target:e.__target,title:e.__title},e.__key)}constructor(e="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=e,this.__target=s,this.__rel=a,this.__title=i}createDOM(e){const r=document.createElement("a");return this.updateLinkDOM(null,r,e),Zn(r,e.theme.link),r}updateLinkDOM(e,r,n){if(OR(r)){e&&e.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];e&&e[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(e,r,n){return this.updateLinkDOM(e,r,n),!1}static importDOM(){return{a:e=>({conversion:Ste,priority:1})}}static importJSON(e){return V1().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setURL(e.url).setRel(e.rel||null).setTarget(e.target||null).setTitle(e.title||null)}sanitizeUrl(e){e=s8(e);try{const r=new URL(s8(e));if(!bte.has(r.protocol))return"about:blank"}catch{return e}return e}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(e){const r=this.getWritable();return r.__url=e,r}getTarget(){return this.getLatest().__target}setTarget(e){const r=this.getWritable();return r.__target=e,r}getRel(){return this.getLatest().__rel}setRel(e){const r=this.getWritable();return r.__rel=e,r}getTitle(){return this.getLatest().__title}setTitle(e){const r=this.getWritable();return r.__title=e,r}insertNewAfter(e,r=!0){const n=V1(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(e,r,n){if(!dt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function Ste(t){let e=null;if(OR(t)){const r=t.textContent;(r!==null&&r!==""||t.children.length>0)&&(e=V1(t.getAttribute("href")||"",{rel:t.getAttribute("rel"),target:t.getAttribute("target"),title:t.getAttribute("title")}))}return{node:e}}function V1(t="",e){return fa(new zc(t,e))}function kte(t){return t instanceof zc}class Ah extends zc{constructor(e="",r={},n){super(e,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(e){return new Ah(e.__url,{isUnlinked:e.__isUnlinked,rel:e.__rel,target:e.__target,title:e.__title},e.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(e){const r=this.getWritable();return r.__isUnlinked=e,r}createDOM(e){return this.__isUnlinked?document.createElement("span"):super.createDOM(e)}updateDOM(e,r,n){return super.updateDOM(e,r,n)||e.__isUnlinked!==this.__isUnlinked}static importJSON(e){return n8().updateFromJSON(e)}updateFromJSON(e){return super.updateFromJSON(e).setIsUnlinked(e.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(e,r=!0){const n=this.getParentOrThrow().insertNewAfter(e,r);if(Je(n)){const s=n8(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function n8(t="",e){return fa(new Ah(t,e))}function Cte(t){return t instanceof Ah}const Tte=/^\+?[0-9\s()-]{5,}$/;function s8(t){return t.match(/^[a-z][a-z0-9+.-]*:/i)||t.match(/^[/#.]/)?t:t.includes("@")?`mailto:${t}`:Tte.test(t)?`tel:${t}`:`https://${t}`}function zS(t,e){const r={};for(const n of t){const s=e(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function Ete(t){const e=zS(t,r=>r.type);return{element:e.element||[],multilineElement:e["multiline-element"]||[],textFormat:e["text-format"]||[],textMatch:e["text-match"]||[]}}const a8=/[!-/:-@[-`{-~\s]/;function Nte(t){return Tt(t)&&!t.hasFormat("code")}function Ate(t,...e){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",t);for(const s of e)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${t}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function i8(t,e,r){const n=r.length;for(let s=e;s>=n;s--){const a=s-n;if(CM(t,a,r,0,n)&&t[a+n]!==" ")return a}return-1}function CM(t,e,r,n,s){for(let a=0;a<s;a++)if(t[e+a]!==r[n+a])return!1;return!0}function jte(t,e=Ov){const r=Ete(e),n=zS(r.textFormat,({tag:i})=>i[i.length-1]),s=zS(r.textMatch,({trigger:i})=>i);for(const i of e){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const l=i.dependencies;for(const u of l)t.hasNode(u)||Ate(173,u.getType())}}const a=(i,o,l)=>{(function(u,d,g,h){const p=u.getParent();if(!la(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[g-1]!==" ")return!1;for(const{regExp:v,replace:w}of h){const S=x.match(v);if(S&&S[0].length===(S[0].endsWith(" ")?g:g-1)){const _=d.getNextSiblings(),[y,k]=d.splitText(g);if(w(u,k?[k,..._]:_,S,!1)!==!1)return y.remove(),!0}}return!1})(i,o,l,r.element)||function(u,d,g,h){const p=u.getParent();if(!la(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[g-1]!==" ")return!1;for(const{regExpStart:v,replace:w,regExpEnd:S}of h){if(S&&!("optional"in S)||S&&"optional"in S&&!S.optional)continue;const _=x.match(v);if(_&&_[0].length===(_[0].endsWith(" ")?g:g-1)){const y=d.getNextSiblings(),[k,N]=d.splitText(g);if(w(u,N?[N,...y]:y,_,null,null,!1)!==!1)return k.remove(),!0}}return!1}(i,o,l,r.multilineElement)||function(u,d,g){let h=u.getTextContent();const p=g[h[d-1]];if(p==null)return!1;d<h.length&&(h=h.slice(0,d));for(const x of p){if(!x.replace||!x.regExp)continue;const v=h.match(x.regExp);if(v===null)continue;const w=v.index||0,S=w+v[0].length;let _;return w===0?[_]=u.splitText(S):[,_]=u.splitText(w,S),_.selectNext(0,0),x.replace(_,v),!0}return!1}(o,l,s)||function(u,d,g){const h=u.getTextContent(),p=d-1,x=h[p],v=g[x];if(!v)return!1;for(const w of v){const{tag:S}=w,_=S.length,y=p-_+1;if(_>1&&!CM(h,y,S,0,_)||h[y-1]===" ")continue;const k=h[p+1];if(w.intraword===!1&&k&&!a8.test(k))continue;const N=u;let E=N,A=i8(h,y,S),C=E;for(;A<0&&(C=C.getPreviousSibling())&&!ul(C);)if(Tt(C)){if(C.hasFormat("code"))continue;const G=C.getTextContent();E=C,A=i8(G,G.length,S)}if(A<0||E===N&&A+_===y)continue;const F=E.getTextContent();if(A>0&&F[A-1]===x)continue;const P=F[A-1];if(w.intraword===!1&&P&&!a8.test(P))continue;const M=N.getTextContent(),I=M.slice(0,y)+M.slice(p+1);N.setTextContent(I);const Y=E===N?I:F;E.setTextContent(Y.slice(0,A)+Y.slice(A+_));const se=Ct(),L=Nv();Fs(L);const z=p-_*(E===N?2:1)+1;L.anchor.set(E.__key,A,"text"),L.focus.set(N.__key,z,"text");for(const G of w.format)L.hasFormat(G)||L.formatText(G);L.anchor.set(L.focus.key,L.focus.offset,L.focus.type);for(const G of w.format)L.hasFormat(G)&&L.toggleFormat(G);return dt(se)&&(L.format=se.format),!0}}(o,l,n)};return t.registerUpdateListener(({tags:i,dirtyLeaves:o,editorState:l,prevEditorState:u})=>{if(i.has(kR)||i.has(U1)||t.isComposing())return;const d=l.read(Ct),g=u.read(Ct);if(!dt(g)||!dt(d)||!d.isCollapsed()||d.is(g))return;const h=d.anchor.key,p=d.anchor.offset,x=l._nodeMap.get(h);!Tt(x)||!o.has(h)||p!==1&&p>g.anchor.offset+1||t.update(()=>{if(!Nte(x))return;const v=x.getParent();v===null||GT(v)||a(v,x,d.anchor.offset)})})}const Fte=/^(\s*)(\d{1,})\.\s/,Pte=/^(\s*)[-*+]\s/,Dte=/^(#{1,6})\s/,Rte=/^>\s/,Mte=/^[ \t]*```([\w-]+)?/,Ite=/[ \t]*```$/,TM=t=>(e,r,n,s)=>{const a=t(n);a.append(...r),e.replace(a),s||a.select(0,0)},EM=t=>(e,r,n,s)=>{const a=e.getPreviousSibling(),i=e.getNextSibling(),o=za(t==="check"?n[3]==="x":void 0);if(rr(i)&&i.getListType()===t){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),e.remove()}else if(rr(a)&&a.getListType()===t)a.append(o),e.remove();else{const u=ja(t,t==="number"?Number(n[2]):void 0);u.append(o),e.replace(u)}o.append(...r),s||o.select(0,0);const l=function(u){const d=u.match(/\t/g),g=u.match(/ /g);let h=0;return d&&(h+=d.length),g&&(h+=Math.floor(g.length/4)),h}(n[1]);l&&o.setIndent(l)},VT=(t,e,r)=>{const n=[],s=t.getChildren();let a=0;for(const i of s)if(Fr(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(rr(d)){n.push(VT(d,e,r+1));continue}}const o=" ".repeat(4*r),l=t.getListType(),u=l==="number"?`${t.getStart()+a}. `:l==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+e(i)),a++}return n.join(`
`)},Ote={dependencies:[Tm],export:(t,e)=>{if(!Lee(t))return null;const r=Number(t.getTag().slice(1));return"#".repeat(r)+" "+e(t)},regExp:Dte,replace:TM(t=>{const e="h"+t[1].length;return tc(e)}),type:"element"},Lte={dependencies:[km],export:(t,e)=>{if(!OA(t))return null;const r=e(t).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:Rte,replace:(t,e,r,n)=>{if(n){const a=t.getPreviousSibling();if(OA(a))return a.splice(a.getChildrenSize(),0,[Do(),...e]),void t.remove()}const s=Cm();s.append(...e),t.replace(s),n||s.select(0,0)},type:"element"},Bte={dependencies:[xd],export:t=>{if(!GT(t))return null;const e=t.getTextContent();return"```"+(t.getLanguage()||"")+(e?`
`+e:"")+"\n```"},regExpEnd:{optional:!0,regExp:Ite},regExpStart:Mte,replace:(t,e,r,n,s,a)=>{let i,o;if(!e&&s){if(s.length===1)n?(i=il(),o=r[1]+s[0]):(i=il(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=il(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const l=Cn(o);i.append(l),t.append(i)}else e&&TM(l=>il(l?l[1]:void 0))(t,e,r,a)},type:"multiline-element"},Ute={dependencies:[Hc,Al],export:(t,e)=>rr(t)?VT(t,e,0):null,regExp:Pte,replace:EM("bullet"),type:"element"},$te={dependencies:[Hc,Al],export:(t,e)=>rr(t)?VT(t,e,0):null,regExp:Fte,replace:EM("number"),type:"element"},Wte={format:["code"],tag:"`",type:"text-format"},Hte={format:["highlight"],tag:"==",type:"text-format"},zte={format:["bold","italic"],tag:"***",type:"text-format"},Gte={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Vte={format:["bold"],tag:"**",type:"text-format"},Kte={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Xte={format:["strikethrough"],tag:"~~",type:"text-format"},Yte={format:["italic"],tag:"*",type:"text-format"},Jte={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Qte={dependencies:[zc],export:(t,e,r)=>{if(!kte(t)||Cte(t))return null;const n=t.getTitle(),s=e(t);return n?`[${s}](${t.getURL()} "${n}")`:`[${s}](${t.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(t,e)=>{const[,r,n,s]=e,a=V1(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let l=r,u="";if(i<o)return;if(i>o){const g=r.split("[");u="["+g[0],l=g.slice(1).join("[")}const d=Cn(l);return d.setFormat(t.getFormat()),a.append(d),t.replace(a),u&&a.insertBefore(Cn(u)),d},trigger:")",type:"text-match"},qte=[Ote,Lte,Ute,$te],Zte=[Bte],ere=[Wte,zte,Gte,Vte,Kte,Hte,Yte,Jte,Xte],tre=[Qte],Ov=[...qte,...Zte,...ere,...tre];function o8(t,e){return t.getEditorState().read(()=>{const r=Kn(e);return r!==null&&r.isSelected()})}function rre(t){const[e]=Oo(),[r,n]=b.useState(()=>o8(e,t));return b.useEffect(()=>{let s=!0;const a=e.registerUpdateListener(()=>{s&&n(o8(e,t))});return()=>{s=!1,a()}},[e,t]),[r,b.useCallback(s=>{e.update(()=>{let a=Ct();Bs(a)||(a=gT(),Fs(a)),Bs(a)&&(s?a.add(t):a.delete(t))})},[e,t]),b.useCallback(()=>{e.update(()=>{const s=Ct();Bs(s)&&s.clear()})},[e])]}function nre({nodeKey:t}){const[e]=Oo(),[r,n,s]=rre(t);return b.useEffect(()=>pd(e.registerCommand(lT,a=>{const i=e.getElementByKey(t);return a.target===i&&(a.shiftKey||s(),n(!r),!0)},Yd)),[s,e,r,t,n]),b.useEffect(()=>{const a=e.getElementByKey(t),i=e._config.theme.hrSelected??"selected";a!==null&&(r?Zn(a,i):pc(a,i))},[e,r,t]),null}class Nm extends xT{static getType(){return"horizontalrule"}static clone(e){return new Nm(e.__key)}static importJSON(e){return KT().updateFromJSON(e)}static importDOM(){return{hr:()=>({conversion:sre,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(e){const r=document.createElement("hr");return Zn(r,e.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return c.jsx(nre,{nodeKey:this.__key})}}function sre(){return{node:KT()}}function KT(){return fa(new Nm)}function are(t){return t instanceof Nm}const ire=[{dependencies:[Nm],export:t=>are(t)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(t,e,r,n)=>{const s=KT();n||t.getNextSibling()!=null?t.replace(s):t.insertBefore(s),s.selectNext()},type:"element"},...Ov];function NM({transformers:t=ire}){const[e]=Oo();return b.useEffect(()=>jte(e,t),[e,t]),null}function AM({hasStrictIndent:t=!1}){const[e]=Oo();return b.useEffect(()=>{if(!e.hasNodes([Hc,Al]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")},[e]),b.useEffect(()=>{if(t)return pte(e)},[e,t]),function(r){b.useEffect(()=>mte(r),[r])}(e),null}const ore=({onChange:t})=>{const[e]=b.useContext(wh)||[];return b.useEffect(()=>{if(t&&e)return e.registerUpdateListener(({editorState:r})=>{r.read(()=>{on().getTextContent();const s=r.toJSON();t(JSON.stringify(s))})})},[e,t]),null},lre=()=>{const[t]=b.useContext(wh)||[],e=b.useCallback(()=>{t&&t.dispatchCommand(Vs,"bold")},[t]),r=b.useCallback(()=>{t&&t.dispatchCommand(Vs,"italic")},[t]),n=b.useCallback(()=>{t&&t.dispatchCommand(Vs,"underline")},[t]),s=b.useCallback(()=>{t&&t.dispatchCommand(Vs,"strikethrough")},[t]),a=b.useCallback(p=>{t&&t.update(()=>{const x=Ct();dt(x)&&Ff(x,()=>tc(p))})},[t]),i=b.useCallback(()=>{t&&t.update(()=>{const p=Ct();dt(p)&&Ff(p,()=>qr())})},[t]);b.useCallback(()=>{t&&t.update(()=>{const p=Ct();dt(p)&&Ff(p,()=>Cm())})},[t]);const o=b.useCallback(()=>{t&&t.dispatchCommand(WT)},[t]),l=b.useCallback(()=>{t&&t.dispatchCommand(HT)},[t]),u=b.useCallback(()=>{t&&t.dispatchCommand(zT)},[t]),d=b.useCallback(p=>{t&&t.update(()=>{const x=Ct();dt(x)&&x.getNodes().forEach(v=>{Tt(v)&&v.setStyle(`color: ${p}`)})})},[t]),g=b.useCallback(p=>{t&&t.update(()=>{const x=Ct();dt(x)&&x.getNodes().forEach(w=>{if(Tt(w)){const S=w.getStyle(),_=S?S.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",y=_?`${_}; font-size: ${p}px;`:`font-size: ${p}px;`;w.setStyle(y)}})})},[t]),h=b.useCallback(p=>{t&&t.dispatchCommand(rR,p)},[t]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:e,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),c.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),c.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),c.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),c.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),c.jsx("button",{type:"button",onClick:()=>g(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),c.jsx("button",{type:"button",onClick:()=>g(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),c.jsx("button",{type:"button",onClick:()=>g(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),c.jsx("button",{type:"button",onClick:()=>g(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),c.jsx("button",{type:"button",onClick:()=>h("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),c.jsx("button",{type:"button",onClick:()=>h("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),c.jsx("button",{type:"button",onClick:()=>h("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},cre=({value:t,onChange:e,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Tm,Hc,Al,km,xd,Iv,Em,Eh,Nh,Ah,zc],onError:s=>{console.error("Lexical error:",s)},editorState:t?(()=>{try{const s=JSON.parse(t);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:t,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs(HR,{initialConfig:n,children:[c.jsx(lre,{}),c.jsx(ore,{onChange:e}),c.jsxs("div",{className:"relative",children:[c.jsx(oM,{contentEditable:c.jsx(cM,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:fM}),c.jsx(uM,{}),c.jsx(dM,{}),c.jsx(AM,{}),c.jsx(NM,{transformers:Ov})]})]})})},ure=({testName:t="",onTestSaved:e,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=vn();ro();const{showNotification:o}=qs(),[l,u]=b.useState({test_name:t,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[d,g]=b.useState({isLoading:!1,error:null,showPreview:!0});b.useEffect(()=>{u(_=>({..._,test_name:t||""}))},[t]);const h=()=>{if(l.num_questions>=3){g(k=>({...k,error:"Maximum 3 questions allowed for performance reasons"}));return}const y={id:Math.max(...l.questions.map(k=>k.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};u(k=>({...k,num_questions:k.num_questions+1,questions:[...k.questions,y]}))},p=_=>{l.questions.length<=1||u(y=>({...y,num_questions:y.num_questions-1,questions:y.questions.filter(k=>k.id!==_)}))},x=(_,y)=>{u(k=>({...k,questions:k.questions.map(N=>N.id===_?{...N,question_json:y}:N)}))},v=(_,y,k)=>{u(N=>({...N,questions:N.questions.map(E=>E.id===_?{...E,canvas_width:y,canvas_height:k}:E)}))},w=(_,y,k)=>{u(N=>({...N,questions:N.questions.map(E=>E.id===_?{...E,max_canvas_width:y,max_canvas_height:k}:E)}))},S=async()=>{if(!l.test_name.trim()){g(_=>({..._,error:"Test name is required"}));return}if(l.questions.some(_=>!_.question_json.trim())){g(_=>({..._,error:"All questions must have content"}));return}g(_=>({..._,isLoading:!0,error:null}));try{const _={test_name:l.test_name,num_questions:l.num_questions,passing_score:l.passing_score,questions:l.questions.map((y,k)=>({question_id:k+1,question_json:y.question_json,canvas_width:y.canvas_width,canvas_height:y.canvas_height,max_canvas_width:y.max_canvas_width,max_canvas_height:y.max_canvas_height}))};e&&e(_)}catch(_){console.error("Error preparing drawing test:",_),g(y=>({...y,error:"Failed to prepare drawing test. Please try again."})),o("Failed to prepare drawing test","error")}finally{g(_=>({..._,isLoading:!1}))}};return c.jsx("div",{className:"drawing-test-creator max-w-4xl mx-auto p-6",children:c.jsxs(it,{className:"p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",l.num_questions,"/3)"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),c.jsxs(Ue,{onClick:h,disabled:l.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),c.jsx("div",{className:"space-y-4",children:l.questions.map((_,y)=>c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[c.jsxs("div",{className:"flex justify-between items-center mb-3",children:[c.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",y+1]}),l.questions.length>1&&c.jsx(Ue,{onClick:()=>p(_.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:c.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),c.jsx(cre,{value:_.question_json,onChange:k=>x(_.id,k),placeholder:""})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canvas Dimensions"}),c.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Canvas is the actual drawing area, viewport is the initial display size"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Width"}),c.jsx("input",{type:"number",value:_.canvas_width,onChange:k=>v(_.id,parseInt(k.target.value),_.canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Height"}),c.jsx("input",{type:"number",value:_.canvas_height,onChange:k=>v(_.id,_.canvas_width,parseInt(k.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Width"}),c.jsx("input",{type:"number",value:_.max_canvas_width,onChange:k=>w(_.id,parseInt(k.target.value),_.max_canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Height"}),c.jsx("input",{type:"number",value:_.max_canvas_height,onChange:k=>w(_.id,_.max_canvas_width,parseInt(k.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]})]})]})]},_.id))})]}),d.error&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:d.error}),c.jsxs("div",{className:"flex justify-end gap-3",children:[c.jsx(Ue,{onClick:r,variant:"secondary",disabled:d.isLoading,children:"Cancel"}),c.jsx(Ue,{onClick:S,variant:"primary",disabled:d.isLoading||!l.test_name.trim(),className:"flex items-center gap-2",children:d.isLoading?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})})},dre=({onChange:t})=>{const[e]=b.useContext(wh)||[];return b.useEffect(()=>{if(t&&e)return e.registerUpdateListener(({editorState:r})=>{r.read(()=>{on().getTextContent();const s=r.toJSON();t(JSON.stringify(s))})})},[e,t]),null},fre=({onAddBlank:t,blankCount:e})=>{const[r]=b.useContext(wh)||[],n=b.useCallback(()=>{r&&r.dispatchCommand(Vs,"bold")},[r]),s=b.useCallback(()=>{r&&r.dispatchCommand(Vs,"italic")},[r]),a=b.useCallback(()=>{r&&r.dispatchCommand(Vs,"underline")},[r]),i=b.useCallback(()=>{r&&r.dispatchCommand(Vs,"strikethrough")},[r]),o=b.useCallback(x=>{r&&r.update(()=>{const v=Ct();dt(v)&&Ff(v,()=>tc(x))})},[r]),l=b.useCallback(()=>{r&&r.update(()=>{const x=Ct();dt(x)&&Ff(x,()=>qr())})},[r]),u=b.useCallback(()=>{r&&r.update(()=>{const x=Ct();dt(x)&&Ff(x,()=>Cm())})},[r]),d=b.useCallback(()=>{r&&r.dispatchCommand(WT)},[r]),g=b.useCallback(()=>{r&&r.dispatchCommand(HT)},[r]),h=b.useCallback(()=>{r&&r.dispatchCommand(zT)},[r]),p=b.useCallback(()=>{!r||!t||(r.update(()=>{const x=Ct();if(dt(x)){const w=`${e+1}_________`,S=Cn(w);S.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),x.insertNodes([S])}}),t())},[r,t,e]);return c.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),c.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),c.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),c.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),c.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),c.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),c.jsx("button",{type:"button",onClick:l,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),c.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),c.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[c.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),c.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),c.jsx("button",{type:"button",onClick:h,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),t&&c.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:c.jsxs("button",{type:"button",onClick:p,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[c.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:c.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},hre=({value:t,onChange:e,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Tm,Hc,Al,km,xd,Iv,Em,Eh,Nh,Ah,zc],onError:i=>{console.error("Lexical error:",i)},editorState:t?(()=>{try{const i=JSON.parse(t);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:t,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return c.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:c.jsxs(HR,{initialConfig:a,children:[c.jsx(fre,{onAddBlank:n,blankCount:s}),c.jsx(dre,{onChange:e}),c.jsxs("div",{className:"relative",children:[c.jsx(oM,{contentEditable:c.jsx(cM,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:c.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:fM}),c.jsx(uM,{}),c.jsx(dM,{}),c.jsx(AM,{}),c.jsx(NM,{transformers:Ov})]})]})})},gre=({testName:t="",allowedTime:e=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=vn();ro();const{showNotification:l}=qs(),[u,d]=b.useState({test_name:t,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:e,blanks:[]}),[g,h]=b.useState({isLoading:!1,error:null,showPreview:!0});b.useEffect(()=>{d(E=>({...E,test_name:t||"",allowed_time:e}))},[t,e]);const p=E=>{d(A=>({...A,test_text:E}))},x=()=>{const A={id:u.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};d(C=>({...C,blanks:[...C.blanks,A],num_blanks:C.num_blanks+1}))},v=E=>{d(A=>({...A,blanks:A.blanks.filter(C=>C.id!==E),num_blanks:A.num_blanks-1}))},w=E=>{d(A=>({...A,blanks:A.blanks.map(C=>C.id===E?{...C,options:[...C.options,""]}:C)}))},S=(E,A)=>{d(C=>({...C,blanks:C.blanks.map(F=>F.id===E?{...F,options:F.options.filter((P,M)=>M!==A),correct_answer:F.correct_answer===String.fromCharCode(65+A)?"":F.correct_answer}:F)}))},_=(E,A,C)=>{d(F=>({...F,blanks:F.blanks.map(P=>P.id===E?{...P,options:P.options.map((M,I)=>I===A?C:M)}:P)}))},y=(E,A)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:E,question:A}),d(C=>({...C,blanks:C.blanks.map(F=>F.id===E?{...F,question:A}:F)})),console.log(" [DEBUG] updateBlankQuestion completed")},k=(E,A)=>{d(C=>({...C,blanks:C.blanks.map(F=>F.id===E?{...F,correct_answer:A}:F)}))},N=async()=>{if(!u.test_name.trim()){h(E=>({...E,error:"Test name is required"}));return}if(!u.test_text.trim()){h(E=>({...E,error:"Test text is required"}));return}if(u.blanks.length===0){h(E=>({...E,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",u.blanks),u.blanks.forEach((E,A)=>{var C;console.log(` [DEBUG] Blank ${A+1}:`,{question:E.question,questionTrimmed:(C=E.question)==null?void 0:C.trim(),correct_answer:E.correct_answer,options:E.options})}),u.separate_type===!1){if(u.blanks.some(E=>!E.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),h(E=>({...E,error:"All blanks must have correct answers"}));return}}else if(u.blanks.some(E=>!E.question.trim()||!E.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),h(E=>({...E,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),h(E=>({...E,isLoading:!0,error:null}));try{const E={test_name:u.test_name,test_text:u.test_text,num_questions:u.blanks.length,num_blanks:u.blanks.length,separate_type:u.separate_type,passing_score:u.passing_score,allowed_time:u.allowed_time,blanks:u.blanks.map((A,C)=>({question_id:C+1,question_json:A.question,question:A.question,options:A.options,correct_answer:A.correct_answer,blank_positions:{},blank_options:A.options||[],correct_answers:[A.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",E),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(E),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(E){console.error("Error preparing fill blanks test:",E),h(A=>({...A,error:"Failed to prepare fill blanks test. Please try again."})),l("Failed to prepare fill blanks test","error")}finally{h(E=>({...E,isLoading:!1}))}};return c.jsx("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto p-6",children:c.jsxs(it,{className:"p-6",children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),c.jsx("p",{className:"text-gray-600",children:"Create a test with rich text content and multiple choice blanks"}),c.jsx("div",{className:"mt-2 text-sm text-gray-600",children:c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsxs("span",{children:[c.jsx("strong",{children:"Test Name:"})," ",t||"Untitled Test"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Blanks:"})," ",u.num_blanks," (auto-calculated)"]}),c.jsxs("span",{children:[c.jsx("strong",{children:"Timer:"})," ",u.allowed_time?`${u.allowed_time} minutes`:"No timer"]})]})}),g.error&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Text Content with Blanks"}),c.jsx("p",{className:"text-sm text-gray-500",children:"Type your text and add blanks where needed"})]}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode:"}),c.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[c.jsx("button",{onClick:()=>d(E=>({...E,separate_type:!0})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${u.separate_type===!0?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Separate"}),c.jsx("button",{onClick:()=>d(E=>({...E,separate_type:!1})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${u.separate_type===!1?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Inline"})]})]})})]}),c.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:c.jsxs("p",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:u.separate_type===!0?"Separate Mode:":"Inline Mode:"})," ",u.separate_type===!0?"Students see numbered blanks in text and answer questions below":"Students see clickable blanks in text with dropdown options"]})}),c.jsx(hre,{value:u.test_text,onChange:p,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:x,blankCount:u.blanks.length})]}),u.separate_type===!0&&c.jsx("div",{className:"space-y-4",children:u.blanks.map((E,A)=>c.jsxs(it,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-md font-medium",children:["Blank ",E.id," Configuration"]}),c.jsx(Ue,{variant:"danger",size:"small",onClick:()=>v(E.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",E.id," *"]}),c.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:E.question,onChange:C=>y(E.id,C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),E.options.map((C,F)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+F)}),c.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+F)}`,value:C||"",onChange:P=>_(E.id,F,P.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),E.options.length>2&&c.jsx(Ue,{variant:"danger",size:"small",onClick:()=>S(E.id,F),className:"px-2 py-1 text-sm",children:""})]},F)),E.options.length<6&&c.jsx(Ue,{variant:"secondary",size:"small",onClick:()=>w(E.id),className:"w-full",children:"+ Add Option"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{value:E.correct_answer||"",onChange:C=>k(E.id,C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),E.options.filter(C=>C.trim().length>0).map((C,F)=>c.jsxs("option",{value:String.fromCharCode(65+F),children:[String.fromCharCode(65+F),") ",C]},F))]})]})]},E.id))}),u.separate_type===!1&&c.jsx("div",{className:"space-y-4",children:u.blanks.map((E,A)=>c.jsxs(it,{className:"p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-md font-medium",children:["Blank ",E.id," Options"]}),c.jsx(Ue,{variant:"danger",size:"small",onClick:()=>v(E.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),c.jsxs("div",{className:"space-y-3",children:[c.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),E.options.map((C,F)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+F)}),c.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+F)}`,value:C||"",onChange:P=>_(E.id,F,P.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),E.options.length>2&&c.jsx(Ue,{variant:"danger",size:"small",onClick:()=>S(E.id,F),className:"px-2 py-1 text-sm",children:""})]},F)),E.options.length<6&&c.jsx(Ue,{variant:"secondary",size:"small",onClick:()=>w(E.id),className:"w-full",children:"+ Add Option"})]}),c.jsxs("div",{className:"mt-4",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{value:E.correct_answer||"",onChange:C=>k(E.id,C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),E.options.filter(C=>C.trim().length>0).map((C,F)=>c.jsxs("option",{value:String.fromCharCode(65+F),children:[String.fromCharCode(65+F),") ",C]},F))]})]})]},E.id))}),c.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[c.jsx(Ue,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),c.jsx(Ue,{onClick:N,variant:"primary",disabled:a||u.blanks.length===0,children:a?c.jsx(ir,{size:"sm"}):"Save Test"})]})]})})},jM=(t,e)=>{const[r,n]=b.useState(()=>{try{const i=window.localStorage.getItem(t);return i?JSON.parse(i):e}catch(i){return console.error(`Error reading localStorage key "${t}":`,i),e}}),s=b.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(t,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${t}":`,o)}},[t,r]),a=b.useCallback(()=>{try{window.localStorage.removeItem(t),n(e)}catch(i){console.error(`Error removing localStorage key "${t}":`,i)}},[t,e]);return[r,s,a]},Lv=()=>{const t=b.useCallback((l,u=null)=>{try{const d=window.localStorage.getItem(l);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${l}":`,d),u}},[]),e=b.useCallback((l,u)=>{try{window.localStorage.setItem(l,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${l}":`,d)}},[]),r=b.useCallback(l=>{try{window.localStorage.removeItem(l)}catch(u){console.error(`Error removing localStorage key "${l}":`,u)}},[]),n=b.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(l){console.error("Error clearing localStorage:",l)}},[]),s=b.useCallback(()=>{try{const l={};for(let h=0;h<window.localStorage.length;h++){const p=window.localStorage.key(h);p&&(l[p]=window.localStorage.getItem(p))}const u=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),g=document.createElement("a");g.href=d,g.download="localStorage_backup.json",g.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(l){console.error("Error exporting localStorage data:",l)}},[]),a=b.useCallback(()=>{try{window.localStorage.clear()}catch(l){console.error("Error clearing localStorage:",l)}},[]),i=b.useCallback(()=>{try{const l={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(l[d]=window.localStorage.getItem(d))}return l}catch(l){return console.error("Error exporting localStorage data:",l),{}}},[]),o=b.useCallback(l=>{try{Object.entries(l).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:t,setItem:e,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},mre=({question:t,testId:e,testType:r="true_false",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onSave:o,isEditing:l=!1,isSaving:u=!1,validationErrors:d={},showCorrectAnswers:g=!1,studentId:h=null})=>{const{getItem:p,setItem:x}=Lv();qs(),b.useRef(null);const[v,w]=b.useState(""),[S,_]=b.useState(""),[y,k]=b.useState(""),[N,E]=b.useState(!1),[A,C]=b.useState(!0),[F,P]=b.useState(""),[M,I]=b.useState(!1),[Y,se]=b.useState(null);b.useEffect(()=>{if(t&&(k(t.question||""),_(t.correct_answer||""),n==="student"&&h)){const Q=p(`test_progress_${h}_${r}_${e}_${t.question_id}`);Q&&w(Q)}},[t,e,r,n,p]),b.useEffect(()=>{if(n==="student"&&v&&e&&(t!=null&&t.question_id)&&h){const Q=setTimeout(()=>{I(!0),x(`test_progress_${h}_${r}_${e}_${t.question_id}`,v),se(new Date().toLocaleTimeString()),setTimeout(()=>I(!1),1e3)},1e3);return()=>clearTimeout(Q)}},[v,e,r,t==null?void 0:t.question_id,n,h,x]),b.useEffect(()=>{if(n==="teacher"&&(y||S)){const Q=setTimeout(()=>{I(!0);const ae={question:y,correct_answer:S,timestamp:Date.now()};x(`teacher_form_${r}_${e}`,ae),se(new Date().toLocaleTimeString()),setTimeout(()=>I(!1),1e3)},2e3);return()=>clearTimeout(Q)}},[y,S,e,r,n,x]);const L=b.useCallback(Q=>{n==="student"&&(w(Q),a&&a(t.question_id,Q),O(Q))},[n,t==null?void 0:t.question_id,a]),z=b.useCallback(Q=>{k(Q),i&&i(t.question_id,Q),R(Q)},[t==null?void 0:t.question_id,i]),G=b.useCallback(Q=>{_(Q),i&&i(t.question_id,{...t,correct_answer:Q}),X(Q)},[t,i]),O=b.useCallback(Q=>{if(n==="student"){if(!Q){C(!1),P("Please select an answer");return}C(!0),P("")}},[n]),R=b.useCallback(Q=>{if(n==="teacher"){if(!Q||Q.trim().length<10){C(!1),P("Question must be at least 10 characters long");return}C(!0),P("")}},[n]),X=b.useCallback(Q=>{if(n==="teacher"){if(!Q){C(!1),P("Please select a correct answer");return}C(!0),P("")}},[n]),te=b.useCallback(()=>{if(n!=="teacher"||!o)return;const Q={question_id:t.question_id,question:y,correct_answer:S,type:"true_false"};o(Q)},[n,o,t==null?void 0:t.question_id,y,S]),H=b.useCallback(Q=>Q?Q.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),V=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:t==null?void 0:t.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[M&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),Y&&!M&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",Y]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:H(y)}}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${v==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&S==="true"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:"true",checked:v==="true",onChange:()=>L("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${v==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:v==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${v==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&S==="false"?"ring-2 ring-green-400":""}`,children:[c.jsx("input",{type:"radio",name:`question_${t==null?void 0:t.question_id}`,value:"false",checked:v==="false",onChange:()=>L("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${v==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:v==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!A&&F&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:F})]}),q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",(t==null?void 0:t.question_id)||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[M&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),Y&&!M&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",Y]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${t==null?void 0:t.question_id}`,value:y,onChange:Q=>z(Q.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${S==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${t==null?void 0:t.question_id}`,value:"true",checked:S==="true",onChange:()=>G("true"),className:"sr-only","aria-label":"True"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${S==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:S==="true"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),c.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${S==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[c.jsx("input",{type:"radio",name:`correct_${t==null?void 0:t.question_id}`,value:"false",checked:S==="false",onChange:()=>G("false"),className:"sr-only","aria-label":"False"}),c.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${S==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:S==="false"&&c.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),c.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!A&&F&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:F}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Ue,{variant:"success",onClick:te,disabled:!A||u,className:"w-full sm:w-auto",children:u?c.jsx(ir,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:"true-false-question-container",children:n==="student"?V():q()})},pre=({question:t,testId:e,testType:r="multiple_choice",mode:n="student",onAnswerChange:s,onQuestionChange:a,onOptionAdd:i,onOptionRemove:o,onSave:l,isEditing:u=!1,isSaving:d=!1,validationErrors:g={},showCorrectAnswers:h=!1,studentId:p=null,displayNumber:x})=>{const{getItem:v,setItem:w}=Lv(),{showNotification:S}=qs();b.useRef(null);const[_,y]=b.useState(""),[k,N]=b.useState(["","","",""]),[E,A]=b.useState(""),[C,F]=b.useState(""),[P,M]=b.useState(!1),[I,Y]=b.useState(!0),[se,L]=b.useState(""),[z,G]=b.useState(!1),[O,R]=b.useState(null);b.useEffect(()=>{if(t&&(F(t.question||""),N(t.options||["","","",""]),A(t.correct_answer||""),n==="student"&&p)){const Ee=v(`test_progress_${p}_${r}_${e}_${t.question_id}`);Ee&&y(Ee)}},[t,e,r,n,v]),b.useEffect(()=>{if(n==="student"&&_&&e&&(t!=null&&t.question_id)&&p){const Ee=setTimeout(()=>{G(!0),w(`test_progress_${p}_${r}_${e}_${t.question_id}`,_),R(new Date().toLocaleTimeString()),setTimeout(()=>G(!1),1e3)},1e3);return()=>clearTimeout(Ee)}},[_,e,r,t==null?void 0:t.question_id,n,p,w]),b.useEffect(()=>{if(n==="teacher"&&(C||k.some(Ee=>Ee.trim()))){const Ee=setTimeout(()=>{G(!0);const ke={question:C,options:k,correct_answer:E,timestamp:Date.now()};w(`teacher_form_${r}_${e}`,ke),R(new Date().toLocaleTimeString()),setTimeout(()=>G(!1),1e3)},2e3);return()=>clearTimeout(Ee)}},[C,k,E,e,r,n,w]),b.useCallback(Ee=>{if(n!=="student")return;const ke=String(Ee);y(ke),s&&s(t.question_id,ke),Q(ke)},[n,t==null?void 0:t.question_id,s]);const X=b.useCallback(Ee=>{F(Ee),a&&a(t.question_id,Ee),ae(Ee)},[t==null?void 0:t.question_id,a]),te=b.useCallback((Ee,ke)=>{const He=[...k];He[Ee]=ke,N(He),a&&a(t.question_id,{...t,options:He}),J(He)},[k,t,a]),H=b.useCallback(Ee=>{A(Ee),a&&a(t.question_id,{...t,correct_answer:Ee}),re(Ee)},[t,a]),V=b.useCallback(()=>{if(k.length<6){const Ee=[...k,""];N(Ee),i&&i(t.question_id,Ee)}else S("Maximum 6 options allowed","warning")},[k,t==null?void 0:t.question_id,i,S]),q=b.useCallback(Ee=>{if(k.length>2){const ke=k.filter((He,at)=>at!==Ee);if(N(ke),E===String.fromCharCode(65+Ee))A("");else if(E&&String.fromCharCode(65+Ee)<E){const He=String.fromCharCode(65+Ee-1);A(He)}o&&o(t.question_id,ke)}else S("Minimum 2 options required","warning")},[k,E,t==null?void 0:t.question_id,o,S]),Q=b.useCallback(Ee=>{if(n==="student"){if(!Ee){Y(!1),L("Please select an answer");return}Y(!0),t!=null&&t.correct_answer&&Ee===t.correct_answer?L(" Correct answer!"):t!=null&&t.correct_answer?L(" Incorrect answer"):L("Answer selected")}},[n,t==null?void 0:t.correct_answer]),ae=b.useCallback(Ee=>!Ee||Ee.trim().length<10?(Y(!1),L("Question must be at least 10 characters long"),!1):(Y(!0),L(""),!0),[]),J=b.useCallback(Ee=>{if(n!=="teacher")return;if(Ee.filter(He=>He.trim().length>0).length<2){Y(!1),L("At least 2 options must be filled");return}if(Ee.some(He=>He.trim().length>0&&He.trim().length<3)){Y(!1),L("Each option must be at least 3 characters long");return}Y(!0),L("")},[n]),re=b.useCallback(Ee=>{if(n==="teacher"){if(!Ee){Y(!1),L("Please select a correct answer");return}Y(!0),L("")}},[n]),ve=b.useCallback(()=>{if(n!=="teacher"||!l)return;const Ee={question_id:t.question_id,question:C,options:k.filter(ke=>ke.trim().length>0),correct_answer:E,type:"multiple_choice"};l(Ee)},[n,l,t==null?void 0:t.question_id,C,k,E]),we=b.useCallback(Ee=>Ee?Ee.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",(t==null?void 0:t.question_id)||"New Question"]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[z&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),O&&!z&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",O]})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("textarea",{id:`question_${t==null?void 0:t.question_id}`,value:C,onChange:Ee=>X(Ee.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),c.jsx(Ue,{variant:"secondary",size:"small",onClick:V,disabled:k.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),c.jsx("div",{className:"space-y-3",children:k.map((Ee,ke)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+ke)}),c.jsx("input",{type:"text",value:Ee,onChange:He=>te(ke,He.target.value),placeholder:`Option ${String.fromCharCode(65+ke)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),k.length>2&&c.jsx(Ue,{variant:"danger",size:"small",onClick:()=>q(ke),className:"px-2 py-1 text-sm",children:""})]},ke))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:`correct_${t==null?void 0:t.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),c.jsxs("select",{id:`correct_${t==null?void 0:t.question_id}`,value:E,onChange:Ee=>H(Ee.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[c.jsx("option",{value:"",children:"Select correct answer"}),k.map((Ee,ke)=>{if(!Ee.trim())return null;const He=String.fromCharCode(65+ke);return c.jsxs("option",{value:He,children:[He,") ",Ee]},ke)})]})]})]}),!I&&se&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:se}),c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Ue,{variant:"success",onClick:ve,disabled:!I||d,className:"w-full sm:w-auto",children:d?c.jsx(ir,{size:"small"}):"Save Question"})})]}):c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof x=="number"?x:t==null?void 0:t.question_id]}),c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[z&&c.jsxs("div",{className:"flex items-center space-x-1",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Saving..."})]}),O&&!z&&c.jsxs("div",{className:"text-green-600",children:[" Saved at ",O]})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:we(C)}}),c.jsx("div",{className:"space-y-3",children:k.map((Ee,ke)=>c.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_===String.fromCharCode(65+ke)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[c.jsx("input",{type:"radio",name:`mcq_${e}_${t==null?void 0:t.question_id}`,value:String.fromCharCode(65+ke),checked:_===String.fromCharCode(65+ke),onChange:He=>{y(He.target.value),s&&s(t==null?void 0:t.question_id,He.target.value)},className:"mr-3"}),c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+ke)}),c.jsx("span",{className:"flex-1",children:Ee||`Option ${String.fromCharCode(65+ke)}`})]},ke))}),!I&&se&&c.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:se})]})},xre=({question:t,testId:e,testType:r="input",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onAnswerAdd:o,onAnswerRemove:l,onSave:u,isEditing:d=!1,isSaving:g=!1,validationErrors:h={},showCorrectAnswers:p=!1,studentId:x=null})=>{const{getItem:v,setItem:w}=Lv(),{showNotification:S}=qs(),_=b.useRef(null),[y,k]=b.useState(""),[N,E]=b.useState([""]),[A,C]=b.useState(!1),[F,P]=b.useState(!0),[M,I]=b.useState(""),[Y,se]=b.useState(!1);b.useEffect(()=>{if(n==="student"&&(t!=null&&t.question_id)&&e&&r&&x){const ae=`test_progress_${x}_${r}_${e}_${t.question_id}`,J=v(ae);J&&k(J)}},[t==null?void 0:t.question_id,r,e,n,x,v]),b.useEffect(()=>{n==="teacher"&&(t!=null&&t.answers)&&E(t.answers.length>0?t.answers:[""])},[t==null?void 0:t.answers,n]),b.useEffect(()=>{if(n==="student"&&y&&(t!=null&&t.question_id)&&e&&r&&x){const ae=setTimeout(()=>{se(!0),w(`test_progress_${x}_${r}_${e}_${t.question_id}`,y),setTimeout(()=>se(!1),1e3)},1e3);return()=>clearTimeout(ae)}},[y,t==null?void 0:t.question_id,r,e,n,x,w]),b.useEffect(()=>{if(n==="teacher"&&N&&i){const ae=setTimeout(()=>{i({...t,answers:N.filter(J=>J.trim())})},500);return()=>clearTimeout(ae)}},[N,t,n,i]);const L=b.useCallback(ae=>{k(ae);const J=ae.trim().length>0;P(J),I(J?"":"Please enter an answer"),a&&a(t.question_id,ae)},[t==null?void 0:t.question_id,a]),z=b.useCallback((ae,J)=>{const re=[...N];re[ae]=J,E(re),a&&a(t.question_id,re)},[N,t==null?void 0:t.question_id,a]),G=b.useCallback(()=>{if(n==="teacher"){const ae=[...N,""];E(ae),o&&o(t.question_id,ae)}},[N,t==null?void 0:t.question_id,n,o]),O=b.useCallback(ae=>{if(n==="teacher"&&N.length>1){const J=N.filter((re,ve)=>ve!==ae);E(J),l&&l(t.question_id,J)}},[N,t==null?void 0:t.question_id,n,l]),R=b.useCallback(()=>{if(n==="student"){const ae=y.trim().length>0;return P(ae),I(ae?"":"Please enter an answer"),ae}else if(n==="teacher"){const ae=N.some(J=>J.trim().length>0);return P(ae),I(ae?"":"Please enter at least one correct answer"),ae}return!0},[y,N,n]),X=b.useCallback(ae=>ae?ae.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),te=b.useCallback(()=>{C(!0)},[]),H=b.useCallback(()=>{C(!1),R()},[R]),V=b.useCallback(ae=>{ae.key==="Enter"&&n==="student"&&y.trim()&&(w(`test_progress_${r}_${e}_${t.question_id}`,y),S("Answer saved","success"))},[y,r,e,t==null?void 0:t.question_id,n,w,S]),q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:t.question_id]}),Y&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:X(t.question)}}),c.jsx("div",{className:"space-y-3",children:c.jsx("input",{ref:_,type:"text",id:`input_${t.question_id}`,placeholder:"Enter your answer here...",value:y,onChange:ae=>L(ae.target.value),onFocus:te,onBlur:H,onKeyPress:V,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${F?A?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":t.question_id,"aria-label":`Answer for question ${t.question_id}`,"aria-invalid":!F,"aria-describedby":F?void 0:`error-${t.question_id}`})}),p&&t.correct_answers&&c.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[c.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),c.jsx("ul",{className:"space-y-1",children:t.correct_answers.map((ae,J)=>c.jsxs("li",{className:"text-green-700 text-sm",children:[" ",ae]},J))})]})]}),Q=()=>c.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",t.question_id||"New"]}),g&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Saving..."})]})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:`question_${t.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),c.jsx("input",{type:"text",id:`question_${t.question_id||"new"}`,value:t.question||"",onChange:ae=>i&&i({...t,question:ae.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${h.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),h.question&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h.question})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),c.jsx(Ue,{type:"button",variant:"secondary",size:"small",onClick:G,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),c.jsx("div",{className:"space-y-3",children:N.map((ae,J)=>c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:J+1}),c.jsx("input",{type:"text",value:ae,onChange:re=>z(J,re.target.value),placeholder:`Correct answer ${J+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":t.question_id,"data-answer-index":J}),N.length>1&&c.jsx(Ue,{type:"button",variant:"danger",size:"small",onClick:()=>O(J),className:"px-2 py-1 text-sm",children:" Remove"})]},J))}),h.answers&&c.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:h.answers})]})]}),u&&c.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:c.jsx(Ue,{type:"button",variant:"success",onClick:u,disabled:g,className:"w-full sm:w-auto",children:g?c.jsx(ir,{size:"small"}):"Save Question"})})]});return c.jsx("div",{className:`input-question-container ${n} ${A?"focused":""}`,children:n==="student"?q():Q()})},Hi=({isOpen:t=!1,onClose:e,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...l})=>{if(!t)return null;const u=g=>{i&&g.target===g.currentTarget&&e()};Gn.useEffect(()=>{const g=h=>{h.key==="Escape"&&e()};return t&&(document.addEventListener("keydown",g),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",g),document.body.style.overflow="unset"}},[t,e]);const d={small:"max-w-sm",medium:"max-w-md",large:"max-w-2xl"};return c.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...l,children:c.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-6
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:g=>g.stopPropagation(),children:[(r||a)&&c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&c.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&c.jsx(Ue,{variant:"secondary",size:"small",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200","aria-label":"Close modal",children:""})]}),c.jsx("div",{className:"space-y-6",children:n})]})})},Am=(t,e,r)=>{const[n,s]=b.useState(!1),[a,i]=b.useState(0),[o,l]=b.useState(!1),u=b.useRef(!1);b.useEffect(()=>{if(!t||!e||!r)return;const w=`anti_cheating_${r}_${t}_${e}`,S=zr(w);S&&(i(S.tabSwitches||0),l(S.isCheating||!1))},[t,e,r]);const d=b.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const w=Date.now();setTimeout(()=>{const S=Date.now()-w;console.log(" Timer completed - time hidden:",S,"ms"),S>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(_=>{const y=_+1,k=y>=2;console.log(" Tab switch count updated:",{newCount:y,cheating:k}),l(k);const N=`anti_cheating_${r}_${t}_${e}`;return Gr(N,{tabSwitches:y,isCheating:k},2*60*1e3),y})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[t,e,r]),g=b.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),h=b.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",g),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[g]),p=b.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",g),console.log(" Anti-cheating event listeners removed")},[g]),x=b.useCallback(()=>{const w={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",w),w},[o,a]),v=b.useCallback(()=>{r&&t&&e&&ch(r,t,e),i(0),l(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,t,e]);return{startTracking:h,stopTracking:p,clearData:v,getCheatingData:x,tabSwitches:a,isCheating:o,isTracking:n}},yre=({testData:t,onTestComplete:e,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=b.useState(null),[o,l]=b.useState(null);b.useEffect(()=>{(async()=>{try{const[Re,$e]=await Promise.all([Cu(()=>Promise.resolve().then(()=>gq),void 0),Cu(()=>Promise.resolve().then(()=>QJ),void 0)]);i(Re),l($e.default)}catch(Re){console.error("Failed to load Konva:",Re)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,g]=b.useState({}),[h,p]=b.useState({}),[x,v]=b.useState(0),[w,S]=b.useState(!1),[_,y]=b.useState(null),[k,N]=b.useState(0),[E,A]=b.useState(0),[C,F]=b.useState(null),[P,M]=b.useState(null),[I,Y]=b.useState(!1),[se,L]=b.useState(!1),{showNotification:z}=qs(),{makeAuthenticatedRequest:G}=ro(),{user:O}=vn(),{startTracking:R,stopTracking:X,getCheatingData:te,clearData:H}=Am("matching_type",t==null?void 0:t.id,(O==null?void 0:O.student_id)||(O==null?void 0:O.id)),V=b.useRef(null),q=b.useRef(null),Q=b.useRef(null),ae=b.useRef(0),[J,re]=b.useState(400);b.useRef({});const ve=b.useCallback(()=>{Y(!0)},[]),we=b.useCallback(()=>{p({}),g({}),Y(!1)},[]),Fe=b.useCallback(()=>{L(!0)},[]),ne=b.useCallback(()=>{L(!1),r()},[r]),Ee=b.useMemo(()=>{if(!t)return null;const Pe=t.blocks.map(Be=>{let Ge=Be.coordinates;if(typeof Ge=="string")try{Ge=JSON.parse(Ge)}catch(ht){console.error(" Failed to parse coordinates:",ht),Ge={x:0,y:0,width:100,height:100}}return Ge={x:(typeof Ge.x=="number"?Ge.x:Number(Ge.x))||0,y:(typeof Ge.y=="number"?Ge.y:Number(Ge.y))||0,width:(typeof Ge.width=="number"?Ge.width:Number(Ge.width))||30,height:(typeof Ge.height=="number"?Ge.height:Number(Ge.height))||10},{id:Be.id,word:Be.word,coordinates:Ge,hasArrow:Be.hasArrow,arrow:Be.arrow}}),Re=Array.isArray(t.arrows)?t.arrows:[],$e=t.words.map(Be=>({id:Be.id,word:Be.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:Pe,arrows:Re,words:$e}},[t]);b.useEffect(()=>{if(!(t!=null&&t.image_url))return;const Pe=new Image;Pe.crossOrigin="anonymous",Pe.onload=()=>{var et,nt,gt;console.log(" Image loaded successfully"),N(Pe.width),A(Pe.height);const Re=((et=V.current)==null?void 0:et.clientWidth)||800,$e=((nt=V.current)==null?void 0:nt.clientHeight)||600,Be=Re/Pe.width,Ge=$e/Pe.height,ht=Math.min(Be,Ge,1),Nt=Pe.width*ht,Ye=Pe.height*ht,Ve=(Re-Nt)/2,ot=($e-Ye)/2;y({x:Ve,y:ot,width:Nt,height:Ye,scaleX:ht,scaleY:ht,scale:ht,image:Pe}),ae.current=((gt=V.current)==null?void 0:gt.clientWidth)||800,console.log(" Image info calculated:",{x:Ve,y:ot,width:Nt,height:Ye,scaleX:ht,scaleY:ht})},Pe.onerror=()=>{console.error(" Failed to load image"),z("Failed to load test image","error")},Pe.src=t.image_url},[t==null?void 0:t.image_url,z]),b.useEffect(()=>{var ot;if(!Ee||!_)return;const Pe=ae.current||((ot=V.current)==null?void 0:ot.clientWidth)||800,Re=12,$e=38;let Be=_.x,Ge=_.y+_.height+Re;const ht=_.x+_.width,Nt={};Ee.words.forEach(et=>{if(!Object.prototype.hasOwnProperty.call(h,et.id)){const nt=typeof et.word=="string"?et.word:"",gt=Math.max(60,nt.length*8+20);Be+gt>Math.min(Pe-Re,ht)&&(Be=_.x,Ge+=$e),d[et.id]||(Nt[et.id]={x:Be,y:Ge}),Be+=gt+Re}}),Object.keys(Nt).length&&g(et=>({...et,...Nt}));const Ye=Object.values(Nt).reduce((et,nt)=>Math.max(et,nt.y),Ge),Ve=Math.max(_.y+_.height+Re,Ye+$e+Re);re(Math.max(400,Math.ceil(Ve)))},[Ee,_,h,d]);const ke=b.useCallback(()=>{if(!_||!Ee)return[];const Pe=u();return Pe?Ee.blocks.map(Re=>{var Ve;const $e=Re.coordinates;let Be,Ge,ht,Nt;Be=_.x+$e.x*(_.scale??_.scaleX),Ge=_.y+$e.y*(_.scale??_.scaleY),ht=$e.width*(_.scale??_.scaleX),Nt=$e.height*(_.scale??_.scaleY);const Ye=h[Re.id];return c.jsxs(Pe.Group,{children:[c.jsx(Pe.Rect,{x:Be,y:Ge,width:ht,height:Nt,fill:Ye?"rgba(40, 167, 69, 0.4)":C===Re.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:Ye?"#28a745":C===Re.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:Ye?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),Ye&&c.jsx(Pe.KonvaText,{x:Be+5,y:Ge+Nt/2-10,width:ht-10,height:20,text:((Ve=Ee.words.find(ot=>ot.id===Ye))==null?void 0:Ve.word)||"",fontSize:Math.min(12,ht/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},Re.id)}):[]},[_,Ee,h,a]),He=b.useCallback(()=>{if(!_||!Ee)return[];const Pe=u();return Pe?(console.log(" Processing arrows:",Ee.arrows),Ee.arrows.map(Re=>{var Nt,Ye,Ve;if(console.log(" Arrow data:",Re),!Re.start||!Re.end)return console.warn(" Arrow missing start/end coordinates:",Re),null;let $e,Be,Ge,ht;if(Re.rel_start_x!==null&&Re.rel_start_y!==null&&Re.rel_end_x!==null&&Re.rel_end_y!==null&&Re.image_width&&Re.image_height&&Re.image_width>0&&Re.image_height>0){const ot=Re.image_width,et=Re.image_height,nt=_.width/ot,gt=_.height/et;$e=_.x+Number(Re.rel_start_x)/100*ot*nt,Be=_.y+Number(Re.rel_start_y)/100*et*gt,Ge=_.x+Number(Re.rel_end_x)/100*ot*nt,ht=_.y+Number(Re.rel_end_y)/100*et*gt}else{const ot=_.scale??_.scaleX??1,et=Number(Re.start.x),nt=Number(Re.start.y),gt=Number(Re.end.x),Et=Number(Re.end.y);et<=_.width+1&&gt<=_.width+1&&nt<=_.height+1&&Et<=_.height+1?($e=_.x+(isNaN(et)?0:et),Be=_.y+(isNaN(nt)?0:nt),Ge=_.x+(isNaN(gt)?0:gt),ht=_.y+(isNaN(Et)?0:Et)):($e=_.x+(isNaN(et)?0:et)*ot,Be=_.y+(isNaN(nt)?0:nt)*ot,Ge=_.x+(isNaN(gt)?0:gt)*ot,ht=_.y+(isNaN(Et)?0:Et)*ot)}return c.jsx(Pe.Arrow,{points:[$e,Be,Ge,ht],stroke:((Nt=Re.style)==null?void 0:Nt.color)||"#dc3545",fill:((Ye=Re.style)==null?void 0:Ye.color)||"#dc3545",strokeWidth:((Ve=Re.style)==null?void 0:Ve.thickness)||3,pointerLength:10,pointerWidth:10},Re.id)}).filter(Boolean)):[]},[_,Ee,a]),at=b.useCallback(()=>{if(!Ee)return[];const Pe=u();return Pe?Ee.words.map(Re=>{const $e=d[Re.id]||{x:0,y:0},Be=typeof Re.word=="string"?Re.word:"",Ge=Math.max(60,Be.length*8+20);return Object.values(h).includes(Re.id)?null:c.jsxs(Pe.Group,{x:$e.x,y:$e.y,draggable:!0,onDragEnd:Nt=>Me(Nt,Re.id),children:[c.jsx(Pe.Rect,{width:Ge,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),c.jsx(Pe.KonvaText,{text:Be,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:Ge,height:34,listening:!1})]},Re.id)}):[]},[Ee,d,h,_,a]),Me=b.useCallback((Pe,Re)=>{const $e=Pe.target.x(),Be=Pe.target.y();if(g(nt=>({...nt,[Re]:{x:$e,y:Be}})),!_||!Ee)return;const Ge=Ee.words.find(nt=>nt.id===Re);if(!Ge)return;const ht=typeof Ge.word=="string"?Ge.word:"",Nt=Math.max(60,ht.length*8+20),Ye={x:$e,y:Be,width:Nt,height:34},Ve=_.scale??_.scaleX??1,ot=(nt,gt)=>!(gt.x>nt.x+nt.width||gt.x+gt.width<nt.x||gt.y>nt.y+nt.height||gt.y+gt.height<nt.y),et=Ee.blocks.find(nt=>{const gt=nt.coordinates,Et={x:_.x+gt.x*Ve,y:_.y+gt.y*Ve,width:gt.width*Ve,height:gt.height*Ve};return ot(Ye,Et)});if(et){p(Ze=>({...Ze,[et.id]:Re}));const nt=et.coordinates,gt=_.x+nt.x*Ve,Et=_.y+nt.y*Ve,Ne=nt.width*Ve,Ke=nt.height*Ve;g(Ze=>({...Ze,[Re]:{x:gt+(Ne-Nt)/2,y:Et+(Ke-34)/2}})),z(`Word "${Ge.word}" placed in block`,"success")}},[_,Ee,z]),Ft=b.useCallback(()=>{if(!Ee)return 0;const Pe=Ee.words.length,Re=Object.keys(h).length;return Pe>0?Re/Pe*100:0},[Ee,h]);b.useEffect(()=>{const Pe=Ft();v(Pe)},[Ft]),b.useEffect(()=>{if(t&&!P){const Pe=new Date;M(Pe),console.log(" Test timer started at:",Pe.toISOString()),R(),console.log(" Anti-cheating tracking started")}},[t,P,R]);const Ut=b.useCallback(async()=>{if(Ee){S(!0);try{const Pe=Ee.words.length;let Re=0;console.log(" Scoring check - placedWords:",h),console.log(" Scoring check - blocks:",Ee.blocks.map(Ne=>({id:Ne.id,word:Ne.word}))),console.log(" Scoring check - words:",Ee.words.map(Ne=>({id:Ne.id,word:Ne.word}))),Ee.blocks.forEach(Ne=>{const Ke=h[Ne.id];if(console.log(` Block ${Ne.id} (expects "${Ne.word}") has placed word ID: ${Ke}`),Ke){const Ze=Ee.words.find(ft=>ft.id===Ke);console.log(" Placed word:",Ze),Ze&&Ze.word===Ne.word?(Re++,console.log(` Correct! Block ${Ne.id} has correct word "${Ze.word}"`)):console.log(` Incorrect! Block ${Ne.id} expected "${Ne.word}" but got "${(Ze==null?void 0:Ze.word)||"nothing"}"`)}else console.log(` Block ${Ne.id} has no word placed`)});const $e=Re,Be=Pe;console.log(` Final Score: ${$e}/${Be} (${Math.round($e/Be*100)}%)`);const Ge=new Date,ht=P?Math.round((Ge-P)/1e3):0,Nt=P?P.toISOString():Ge.toISOString();console.log(" Test timing:",{startedAt:Nt,endTime:Ge.toISOString(),timeTaken:`${ht} seconds`});const Ye=te();console.log(" Anti-cheating data for submission:",Ye);const Ve=O.student_id,ot=`retest_assignment_id_${Ve}_matching_type_${t.id}`,et=localStorage.getItem(ot),nt={test_id:t.id,test_name:t.test_name,teacher_id:t.teacher_id||null,subject_id:t.subject_id||null,student_id:Ve,answers:h,score:$e,maxScore:Be,time_taken:ht,started_at:Nt,submitted_at:Ge.toISOString(),caught_cheating:Ye.caught_cheating,visibility_change_times:Ye.visibility_change_times,retest_assignment_id:et?Number(et):null,parent_test_id:t.id};console.log(" Submitting test data:",nt);const Et=await(await G("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(nt)})).json();if(console.log(" Submission response:",Et),Et.success){if(z("Test submitted successfully!","success"),X(),H(),O!=null&&O.student_id&&ch(O.student_id,"matching_type",t.id),O!=null&&O.student_id){const Ke=`test_completed_${O.student_id}_matching_type_${t.id}`;localStorage.setItem(Ke,"true"),console.log(" Test marked as completed in localStorage:",Ke)}if(O!=null&&O.student_id){const{setCachedData:Ke,CACHE_TTL:Ze}=await Cu(async()=>{const{setCachedData:ut,CACHE_TTL:bt}=await Promise.resolve().then(()=>sD);return{setCachedData:ut,CACHE_TTL:bt}},void 0),ft=`student_results_table_${O.student_id}`;Ke(ft,Et,Ze.student_results_table),console.log(" Test results cached with key:",ft)}const Ne=`retest1_${Ve}_matching_type_${t.id}`;localStorage.removeItem(Ne),localStorage.removeItem(ot),e&&e($e)}else throw new Error(Et.message||"Failed to submit test")}catch(Pe){console.error(" Error submitting test:",Pe),z(`Error submitting test: ${Pe.message}`,"error")}finally{S(!1)}}},[Ee,h,t,O,P,G,z,e]);return!t||!Ee?c.jsx(ir,{}):c.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:c.jsxs("div",{className:"max-w-6xl mx-auto",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:t.test_name})}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(x),"%"]})]})]}),c.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:c.jsx("div",{className:"lg:col-span-3",children:c.jsxs(it,{className:"p-4",children:[c.jsxs("div",{className:"mb-4 text-center space-x-4",children:[c.jsx(Ue,{onClick:ve,variant:"secondary",children:"Reset"}),c.jsx(Ue,{onClick:Fe,variant:"secondary",children:"Back to Cabinet"})]}),c.jsx("div",{ref:V,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${J}px`},children:_&&a?(()=>{var Be;const{Stage:Pe,Layer:Re,KonvaImage:$e}=u();return c.jsxs(Pe,{ref:q,width:((Be=V.current)==null?void 0:Be.clientWidth)||800,height:J,children:[c.jsxs(Re,{children:[c.jsx($e,{ref:Q,image:_.image,x:_.x,y:_.y,width:_.width,height:_.height,listening:!1}),ke(),He()]}),c.jsx(Re,{listening:!0,children:at()})]})})():_?c.jsxs("div",{className:"flex items-center justify-center h-full",children:[c.jsx(ir,{size:"lg"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),c.jsx("div",{className:"mt-4 text-center",children:c.jsx(Ue,{onClick:Ut,disabled:w||x<100,children:w?"Submitting...":"Submit Test"})})]})})}),c.jsx(Hi,{isOpen:I,onClose:()=>Y(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ue,{onClick:()=>Y(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ue,{onClick:we,variant:"primary",children:"Reset"})]})]})}),c.jsx(Hi,{isOpen:se,onClose:()=>L(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ue,{onClick:()=>L(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ue,{onClick:ne,variant:"primary",children:"Go Back"})]})]})})]})})},vre=({testName:t="",onTestSaved:e,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=vn(),{makeAuthenticatedRequest:o}=ro(),{showNotification:l}=qs(),[u,d]=b.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[g,h]=b.useState("drag"),[p,x]=b.useState(!1),[v,w]=b.useState(null),S=b.useCallback(()=>{d(A=>[...A,{leftWord:"",rightWord:""}])},[]),_=b.useCallback(A=>{u.length>1&&d(C=>C.filter((F,P)=>P!==A))},[u.length]),y=b.useCallback((A,C)=>{d(F=>F.map((P,M)=>M===A?{...P,leftWord:C}:P))},[]),k=b.useCallback((A,C)=>{d(F=>F.map((P,M)=>M===A?{...P,rightWord:C}:P))},[]),N=b.useCallback(()=>u.every(A=>A.leftWord.trim()&&A.rightWord.trim()),[u]),E=b.useCallback(async()=>{if(!N()){l("Please fill in all word pairs","error");return}x(!0),w(null);try{const A=u.map((F,P)=>({question_id:P+1,left_word:F.leftWord.trim(),right_word:F.rightWord.trim()})),C={test_name:t,num_questions:A.length,interaction_type:g,questions:A};console.log(" Saving word matching test:",C),e({testName:t,numQuestions:A.length,interactionType:g,wordPairs:u,questions:A})}catch(A){console.error("Error saving word matching test:",A),w(A.message),l("Failed to save test: "+A.message,"error")}finally{x(!1)}},[t,u,g,N,o,l,e]);return c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-6",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-gray-600",children:"Enter word pairs - position 1 left matches position 1 right"})]}),c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"mb-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${g==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h("drag"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:g==="drag",onChange:()=>h("drag"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",c.jsx("br",{})," Visual feedback on placement",c.jsx("br",{})," Mobile-friendly"]})]}),c.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${g==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h("arrow"),children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx("input",{type:"radio",checked:g==="arrow",onChange:()=>h("arrow"),className:"mr-3"}),c.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),c.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",c.jsx("br",{})," Better for visual learners",c.jsx("br",{})," Requires precision"]})]})]})]})}),c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"word-pairs-section",children:[c.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),c.jsx(Ue,{onClick:S,size:"sm",children:"+ Add Pair"})]}),c.jsx("div",{className:"pairs-list space-y-3",children:u.map((A,C)=>c.jsxs("div",{className:"word-pair-row flex items-center space-x-4 p-4 bg-gray-50 rounded-lg border",children:[c.jsx("div",{className:"pair-number flex-shrink-0",children:c.jsx("span",{className:"number-badge w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:C+1})}),c.jsx("div",{className:"left-word flex-1",children:c.jsx("input",{type:"text",value:A.leftWord,onChange:F=>y(C,F.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-xl",children:""}),c.jsx("div",{className:"right-word flex-1",children:c.jsx("input",{type:"text",value:A.rightWord,onChange:F=>k(C,F.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsx("div",{className:"pair-actions flex-shrink-0",children:c.jsx(Ue,{onClick:()=>_(C),variant:"outline",size:"sm",className:"remove-btn w-8 h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},C))})]})}),c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"preview-section",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),c.jsx("div",{className:"preview-pairs space-y-2",children:u.map((A,C)=>c.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[c.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[C+1,"."]}),c.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:A.leftWord||"Left word"}),c.jsx("span",{className:"preview-arrow text-gray-500",children:""}),c.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:A.rightWord||"Right word"})]},C))})]})}),c.jsxs("div",{className:"flex justify-center space-x-4",children:[c.jsx(Ue,{onClick:E,disabled:!N()||p,className:"px-8",children:p?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),c.jsx(Ue,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&c.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:c.jsx("p",{className:"text-red-600",children:v})})]})},wre=(t,e)=>{const[r,n,s]=jM(`test_progress_${t}_${e}`,{}),[a,i]=b.useState(!1),[o,l]=b.useState(0),[u,d]=b.useState(0),[g,h]=b.useState(!1),[p,x]=b.useState(null),v=b.useRef(null),w=b.useRef(null),S=b.useCallback((R,X)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(te=>({...te,[R]:X})),console.log(`Saved progress for question ${R}:`,X)},[n]),_=b.useCallback(R=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[R]||null,[r]),y=b.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${t}, testId: ${e}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const R=`test_progress_${t}_${e}`;console.log(`[DEBUG] Removing localStorage key: ${R}`);const X=Object.keys(r).length>0;s(),console.log(X?`[DEBUG] Progress cleared for test ${t}_${e}`:`[DEBUG] No progress found to clear for test ${t}_${e}`)},[s,t,e,r]),k=b.useCallback(()=>{v.current&&(k(v.current),v.current=null),w.current&&(k(w.current),w.current=null)},[]),N=b.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${t}, testId: ${e}`),w.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),P()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[t,e]),E=b.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${t}, testId: ${e}`);const R=F(),X=u>0?Math.round(R/u*100):0;return console.log(`[DEBUG] Progress: ${R}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${X}%`),{answeredQuestions:R,totalQuestions:u,percentage:X}},[t,e,u]),A=b.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const R=F();console.log(`[DEBUG] Submit button state check: ${R}/${u} questions answered`);const X=R===u&&u>0;return console.log(X?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),X},[u]),C=b.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${t}, testId: ${e}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const R=Object.keys(r).length;l(R),console.log(`[DEBUG] Restored ${R} answered questions`)}catch(R){console.error("[ERROR] Failed to load saved progress:",R),x(R.message)}},[t,e,r]),F=b.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${t}`);const R=Object.keys(r).length;return l(R),console.log(`[DEBUG] Found ${R} answered questions`),R},[t,r]),P=b.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${t}, testId: ${e}`);try{console.log("[DEBUG] Progress saved:",r)}catch(R){console.error("[ERROR] Failed to save progress:",R),x(R.message)}},[t,e,r]),M=b.useCallback(()=>{try{const R=`test_completed_${t}_${e}`,X=localStorage.getItem(R)==="true";return i(X),X}catch(R){return console.error("Error checking test completion:",R),!1}},[t,e]),I=b.useCallback(()=>{try{const R=`test_completed_${t}_${e}`;localStorage.setItem(R,"true"),i(!0),console.log(`Test ${t}_${e} marked as completed`)}catch(R){console.error("Error marking test completed:",R)}},[t,e]),Y=b.useCallback(()=>{console.log("Marking test completed in UI:",{testType:t,testId:e}),I()},[t,e,I]),se=b.useCallback(R=>{try{const X=`test_creation_state_${t}_${e}`;localStorage.setItem(X,JSON.stringify(R)),console.log("Test creation state saved:",R)}catch(X){console.error("Error saving test creation state:",X)}},[t,e]),L=b.useCallback(()=>{try{const R=`test_creation_state_${t}_${e}`;localStorage.removeItem(R),console.log("Test creation state cleared")}catch(R){console.error("Error clearing test creation state:",R)}},[t,e]),z=b.useCallback((R,X)=>{try{const te=`test_step_${t}_${e}_${R}`;localStorage.setItem(te,JSON.stringify(X)),console.log(`Step ${R} data saved:`,X)}catch(te){console.error(`Error saving step ${R} data:`,te)}},[t,e]),G=b.useCallback(R=>{try{const X=`test_step_${t}_${e}_${R}`,te=localStorage.getItem(X);return te?JSON.parse(te):null}catch(X){return console.error(`Error restoring step ${R} data:`,X),null}},[t,e]),O=b.useCallback(()=>{try{const R=`test_creation_state_${t}_${e}`,X=localStorage.getItem(R);return X?JSON.parse(X):null}catch(R){return console.error("Error restoring test creation state:",R),null}},[t,e]);return b.useEffect(()=>()=>{k()},[t,e,N,C,k]),b.useEffect(()=>{F()},[r,F]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:g,error:p,saveProgress:S,getProgress:_,clearProgress:y,clearInterval:k,setupProgressTracking:N,updateProgress:E,updateSubmitButton:A,loadProgress:C,getAnsweredCount:F,saveProgressForPage:P,checkCompleted:M,markCompleted:I,markCompletedUI:Y,saveState:se,clearState:L,saveStepData:z,restoreStepData:G,restoreState:O,setTotalQuestions:d,setError:x}},_re=({testData:t,onTestComplete:e,onBackToCabinet:r})=>{var Pe,Re;const{user:n}=vn(),{makeAuthenticatedRequest:s}=ro(),[a,i]=b.useState({width:window.innerWidth,height:window.innerHeight});b.useEffect(()=>{const $e=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",$e),()=>window.removeEventListener("resize",$e)},[]);const{getCheatingData:o,stopTracking:l,clearData:u}=Am(),[d,g]=b.useState(null),[h,p]=b.useState({}),[x,v]=b.useState(null),w=b.useRef(null),[S,_]=b.useState(800),y={VERY_SMALL:400,MOBILE:600,TABLET:900},k={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},N={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:100,MARGIN:50,PADDING:20},E=a.width<y.VERY_SMALL,A=a.width>=y.VERY_SMALL&&a.width<y.MOBILE,C=a.width>=y.MOBILE&&a.width<y.TABLET;a.width>=y.TABLET;const F=E?k.VERY_SMALL:A?k.MOBILE:C?k.TABLET:k.DESKTOP;b.useEffect(()=>{const $e=()=>{if(w.current){const Ge=w.current.clientWidth;console.log(" Container width detected:",Ge),Ge>0&&_(Ge)}};$e();const Be=[setTimeout($e,50),setTimeout($e,100),setTimeout($e,200),setTimeout($e,500)];return window.addEventListener("resize",$e),()=>{Be.forEach(Ge=>clearTimeout(Ge)),window.removeEventListener("resize",$e)}},[d]);const P=Math.max(N.CANVAS_HEIGHT*F,(((Pe=d==null?void 0:d.leftWords)==null?void 0:Pe.length)||3)*N.BLOCK_SPACING*F+N.PADDING*2),M=N.BLOCK_WIDTH*F,I=N.BLOCK_HEIGHT*F,Y=N.BLOCK_SPACING*F,se=N.MARGIN*F,L=se;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:(Re=w.current)==null?void 0:Re.clientWidth,canvasWidth:S,scale:F,blockWidth:M,margin:se,leftBlockX:L,displayDataLoaded:!!d});const z=L+M+20+M+se,G=z<=S;let O,R=M,X=I;if(G)O=Math.min(Math.max(L+M+20,S-M-se),S-M-se);else{const $e=S-se*2,Be=Math.floor(($e-20)/2);R=Math.max(60,Be),X=Math.max(30,X*(R/M)),O=L+R+20,console.log(" Very small screen - adjusted block size:",{availableWidth:$e,maxBlockWidth:Be,actualBlockWidth:R,actualBlockHeight:X})}console.log(" Right Block Position:",{rightBlockX:O,rightBlockRightEdge:O+R,canvasWidth:S,fits:O+R<=S,canFitSideBySide:G,minRequiredWidth:z});const te=se,H={DRAGGED_WORD:Math.max(8,14*F),ORIGINAL_WORD:Math.max(10,16*F),LEFT_WORD:Math.max(10,14*F)},V=Math.max(1,3*F),[q,Q]=b.useState([]),[ae,J]=b.useState(!1),[re,ve]=b.useState(null),[we,Fe]=b.useState(!1),[ne,Ee]=b.useState(!1);b.useEffect(()=>{if(t&&(g(t),ve(new Date),n!=null&&n.student_id)){const $e=`test_progress_${n.student_id}_word_matching_${t.id}`,Be=zr($e);Be&&(p(Be.answers||{}),Q(Be.arrows||[]),ve(new Date(Be.startTime)),console.log(" Test progress restored:",Be))}},[t,n==null?void 0:n.student_id]),b.useEffect(()=>{if(d&&re&&(n!=null&&n.student_id)){const $e=setInterval(()=>{const Be={answers:h,arrows:q,startTime:re.toISOString()},Ge=`test_progress_${n.student_id}_word_matching_${t.id}`;Gr(Ge,Be,Jr.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval($e)}},[d,h,q,re,n==null?void 0:n.student_id,t==null?void 0:t.id]);const ke=b.useCallback(($e,Be)=>{if(t.interaction_type==="arrow")if(x){if(x.side===$e&&x.index===Be)v(null);else if(x.side!==$e){const Ge={id:Date.now().toString(),startWord:x,endWord:{side:$e,index:Be},color:"#3B82F6"};Q(ht=>[...ht,Ge]),p(ht=>({...ht,[x.index]:Be})),v(null)}}else v({side:$e,index:Be})},[x,t==null?void 0:t.interaction_type]);b.useCallback(($e,Be)=>{t.interaction_type==="drag"&&p(Ge=>({...Ge,[$e]:Be}))},[t==null?void 0:t.interaction_type]);const He=b.useCallback(()=>{Fe(!0)},[]),at=b.useCallback(()=>{p({}),Q([]),v(null),Fe(!1)},[]),Me=b.useCallback(()=>{Ee(!0)},[]),Ft=b.useCallback(()=>{Ee(!1),r&&r()},[r]),Ut=b.useCallback(async()=>{if(d){J(!0);try{const $e=d.leftWords.length;let Be=0,Ge={};t.interaction_type==="drag"?Object.entries(h).forEach(([ft,ut])=>{const bt=d.correctPairs[ft];ut===bt&&Be++,Ge[ft]=ut}):q.forEach(ft=>{const ut=ft.startWord.side==="left"?ft.startWord.index:ft.endWord.index,bt=ft.startWord.side==="right"?ft.startWord.index:ft.endWord.index;d.correctPairs[ut]===bt&&Be++,Ge[ut]=bt});const ht=Be,Nt=$e;console.log(` Final Score: ${ht}/${Nt} (${Math.round(ht/Nt*100)}%)`);const Ye=new Date,Ve=re?Math.round((Ye-re)/1e3):0,ot=re?re.toISOString():Ye.toISOString(),et=o(),nt=n.student_id,gt=`retest_assignment_id_${nt}_word_matching_${t.id}`,Et=localStorage.getItem(gt),Ne={test_id:t.id,test_name:t.test_name,teacher_id:t.teacher_id||null,subject_id:t.subject_id||null,student_id:nt,parent_test_id:t.id,retest_assignment_id:Et?Number(Et):null,interaction_type:t.interaction_type,answers:Ge,score:ht,maxScore:Nt,time_taken:Ve,started_at:ot,submitted_at:Ye.toISOString(),caught_cheating:et.caught_cheating,visibility_change_times:et.visibility_change_times};console.log(" Submission data being sent:",Ne),console.log(" TestData structure:",t),console.log(" Submitting test results...");const Ke=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ne)});console.log(" Submission response received:",Ke.status);const Ze=await Ke.json();if(Ze.success){if(l(),u(),n!=null&&n.student_id){const ft=`test_completed_${n.student_id}_word_matching_${t.id}`;localStorage.setItem(ft,"true"),console.log(" Test marked as completed in localStorage:",ft);const ut=`retest1_${nt}_word_matching_${t.id}`;localStorage.removeItem(ut),localStorage.removeItem(gt),ch(n.student_id,"word_matching",t.id),console.log(" Test data cleared from cache");const bt=`student_results_table_${n.student_id}`;Gr(bt,Ze,Jr.student_results_table),console.log(" Test results cached with key:",bt)}setTimeout(()=>{e&&e(ht)},2e3)}else throw new Error(Ze.message||"Failed to submit test")}catch($e){console.error("Error submitting test:",$e)}finally{J(!1)}}},[d,h,q,t,n,re,o,l,u,s,e]);return d?c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[c.jsx(Hi,{isOpen:ae,onClose:()=>{},title:"Submitting",size:"small",children:c.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[c.jsx(ir,{size:"lg",className:"mb-3"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"text-center",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:t.test_name}),c.jsx("p",{className:"text-gray-600",children:t.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),t.interaction_type==="drag"?c.jsx(it,{className:"mb-6",children:c.jsx("div",{ref:w,className:"relative w-full",children:c.jsx(Bu,{width:S,height:P,className:`border-2 border-gray-200 rounded-lg ${ae?"pointer-events-none opacity-50":""}`,children:c.jsxs(Lu,{children:[d.leftWords.map(($e,Be)=>{const Ge=h[Be]!==void 0,ht=te+Be*Y;return c.jsxs(zi,{x:L,y:ht,draggable:!Ge,onDragStart:Nt=>{Nt.target.moveToTop()},onDragEnd:Nt=>{Nt.target.getStage();const Ye=d.rightWords,Ve=R+60,ot=X+30,et=O-30,nt=te-15;console.log(" Drop detection - Word dropped at:",Nt.target.x(),Nt.target.y());for(let gt=0;gt<Ye.length;gt++){const Et=nt+gt*Y,Ne=et,Ke=et+Ve,Ze=Et,ft=Et+ot;if(console.log(` Checking drop zone ${gt}:`,{left:Ne,right:Ke,top:Ze,bottom:ft,word:Ye[gt]}),Nt.target.x()>=Ne&&Nt.target.x()<=Ke&&Nt.target.y()>=Ze&&Nt.target.y()<=ft){console.log(` Match found! Word "${d.leftWords[Be]}" matched with "${Ye[gt]}"`),p(ut=>({...ut,[Be]:gt}));break}}console.log(" No match found, resetting position"),Nt.target.position({x:L,y:ht})},children:[c.jsx(ms,{width:R,height:X,fill:Ge?"#e5e7eb":"#3b82f6",stroke:Ge?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Ge?.5:1}),c.jsx(ko,{text:$e,x:R/2,y:X/2,fontSize:H.LEFT_WORD,fontFamily:"Arial",fill:Ge?"#dc2626":"white",align:"center",verticalAlign:"middle",width:R,offsetX:R/2,offsetY:X/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Be}`)}),d.rightWords.map(($e,Be)=>{const Ge=te+Be*Y,ht=Object.keys(h).find(Nt=>h[Nt]===Be);return c.jsxs(zi,{x:O,y:Ge,children:[c.jsx(ms,{width:R,height:X,fill:ht?"#10b981":"#f3f4f6",stroke:ht?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),c.jsx(ko,{text:$e,x:R/2,y:X/2,fontSize:H.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:R,offsetX:R/2,offsetY:X/2,wrap:"word",ellipsis:!0,listening:!1}),ht&&c.jsx(ko,{text:d.leftWords[ht],x:M/2,y:I/4,fontSize:H.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:R,offsetX:R/2,offsetY:X/8,wrap:"word",ellipsis:!0})]},`right-${Be}`)})]})})})}):c.jsx(it,{className:"mb-6",children:c.jsx("div",{ref:w,className:"relative w-full",children:c.jsx(Bu,{width:S,height:P,className:`border-2 border-gray-200 rounded-lg ${ae?"pointer-events-none opacity-50":""}`,children:c.jsxs(Lu,{children:[d.leftWords.map(($e,Be)=>{const Ge=te+Be*Y,ht=(x==null?void 0:x.side)==="left"&&(x==null?void 0:x.index)===Be;return c.jsxs(zi,{x:L,y:Ge,onClick:()=>ke("left",Be),children:[c.jsx(ms,{width:R,height:X,fill:ht?"#3b82f6":"#f3f4f6",stroke:ht?"#1d4ed8":"#d1d5db",strokeWidth:ht?3:2,cornerRadius:8}),c.jsx(ko,{text:$e,x:M/2,y:I/2,fontSize:H.LEFT_WORD,fontFamily:"Arial",fill:ht?"white":"#374151",align:"center",verticalAlign:"middle",width:R,offsetX:R/2,offsetY:X/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Be}`)}),d.rightWords.map(($e,Be)=>{const Ge=te+Be*Y,ht=(x==null?void 0:x.side)==="right"&&(x==null?void 0:x.index)===Be;return c.jsxs(zi,{x:O,y:Ge,onClick:()=>ke("right",Be),children:[c.jsx(ms,{width:R,height:X,fill:ht?"#3b82f6":"#f3f4f6",stroke:ht?"#1d4ed8":"#d1d5db",strokeWidth:ht?3:2,cornerRadius:8}),c.jsx(ko,{text:$e,x:M/2,y:I/2,fontSize:H.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:R,offsetX:R/2,offsetY:X/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${Be}`)}),q.map(($e,Be)=>{const Ge=te+$e.startWord.index*Y+I/2,ht=te+$e.endWord.index*Y+I/2;return c.jsx(Ss,{points:[L+M+20,Ge,O-20,ht],stroke:$e.color||"#3b82f6",strokeWidth:V,lineCap:"round",lineJoin:"round"},Be)})]})})})}),c.jsx(it,{children:c.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${ae?"pointer-events-none opacity-50":""}`,children:[c.jsx(Ue,{onClick:He,variant:"outline",disabled:ae,children:"Reset"}),c.jsx(Ue,{onClick:Me,variant:"outline",disabled:ae,children:"Back to Cabinet"}),c.jsx(Ue,{onClick:Ut,disabled:ae,className:"px-8",children:ae?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),c.jsx(Hi,{isOpen:we&&!ae,onClose:()=>Fe(!1),title:"Reset Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ue,{onClick:()=>Fe(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ue,{onClick:at,variant:"primary",children:"Reset"})]})]})}),c.jsx(Hi,{isOpen:ne&&!ae,onClose:()=>Ee(!1),title:"Exit Test",size:"small",children:c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),c.jsxs("div",{className:"flex gap-3 justify-center",children:[c.jsx(Ue,{onClick:()=>Ee(!1),variant:"secondary",children:"Cancel"}),c.jsx(Ue,{onClick:Ft,variant:"primary",children:"Leave"})]})]})})]}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(ir,{size:"lg"})})},bre=({id:t,x:e,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:l,onSelect:u,onUpdate:d,onDelete:g})=>{const h=x=>{x.cancelBubble=!0,d(t,{isEditing:!0})},p=x=>{d(t,{x:x.target.x(),y:x.target.y()})};return c.jsxs(zi,{x:e,y:r,draggable:!0,onClick:x=>{x.cancelBubble=!0,u(t)},onDblClick:h,onDragEnd:p,children:[c.jsx(ms,{width:n,height:s,fill:l?"#fef3c7":"#ffffff",stroke:l?"#f59e0b":"#d1d5db",strokeWidth:l?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),c.jsx(ko,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word"})]})},Sre=({x:t,y:e,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=b.useRef(null);b.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const l=u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),a(o.current.value)):u.key==="Escape"&&i()};return c.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:e,left:t,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:l,onBlur:()=>a(o.current.value)})},kre=({width:t,height:e,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:l,isPanning:u,isFullscreen:d,constrainPanPosition:g,handleWheel:h,stageRef:p,setIsPanning:x,responsiveDimensions:v,canvasSize:w,question:S,textBoxes:_,setTextBoxes:y,selectedTextBox:k,setSelectedTextBox:N,handleTextBoxSelect:E,handleTextBoxUpdate:A,handleTextBoxDelete:C,isEditingText:F,editingTextBox:P,setIsEditingText:M,setEditingTextBox:I,setCurrentTool:Y})=>{const[se,L]=b.useState(!1),[z,G]=b.useState([]),[O,R]=b.useState(null),[X,te]=b.useState(null),H=b.useRef(null),[V,q]=b.useState(.25),[Q,ae]=b.useState({x:0,y:0});b.useEffect(()=>{const ee=()=>{const he=H.current;if(!he)return;const Ae=he.clientWidth||1,st=he.clientHeight||1,rt=Math.min(Ae/(w.width||1),st/(w.height||1));q(Math.min(rt,1))};return ee(),window.addEventListener("resize",ee),()=>window.removeEventListener("resize",ee)},[w.width,w.height,d]);const J=ee=>{const he=p.current,Ae=he.getPointerPosition();if(s==="pan")return;if(s==="text"){const rt={x:(Ae.x-he.x())/he.scaleX(),y:(Ae.y-he.y())/he.scaleY()},At={id:Date.now(),x:rt.x,y:rt.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};y(yt=>[...yt,At]),N(At.id),Y("pan");return}L(!0);const st={x:(Ae.x-he.x())/he.scaleX(),y:(Ae.y-he.y())/he.scaleY()};te(st),s==="pencil"?G([{x:st.x,y:st.y,color:a,thickness:i}]):s==="eraser"?G([{x:st.x,y:st.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&R({type:s,startX:st.x,startY:st.y,endX:st.x,endY:st.y,color:a,thickness:i})},re=ee=>{const he=p.current,Ae=he.getPointerPosition(),st={x:(Ae.x-he.x())/he.scaleX(),y:(Ae.y-he.y())/he.scaleY()};if(ae(st),s!=="pan"&&se)if(s==="pencil"){const rt=[...z,{x:st.x,y:st.y,color:a,thickness:i}];G(rt)}else if(s==="eraser"){const rt=[...z,{x:st.x,y:st.y,color:a,thickness:i,tool:"eraser"}];G(rt)}else["line","rectangle","circle"].includes(s)&&O&&R({...O,endX:st.x,endY:st.y})},ve=()=>{if(s!=="pan"&&se){if(s==="pencil"){const ee=[...r,z];n(ee),G([])}else if(s==="eraser"){const ee=[...r,z];n(ee),G([])}else if(["line","rectangle","circle"].includes(s)&&O){const ee=[...r,O];n(ee),R(null)}L(!1),te(null)}},[we,Fe]=b.useState(null),[ne,Ee]=b.useState(null),[ke,He]=b.useState(!1),[at,Me]=b.useState(null),[Ft,Ut]=b.useState(!1),[Pe,Re]=b.useState(!1),[$e,Be]=b.useState([]),[Ge,ht]=b.useState(null),[Nt,Ye]=b.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Ve=null;const et=(window.devicePixelRatio||1)>1.5,nt={scaleDelta:et?.03:.04,centerDelta:et?4:6,minTouchDistance:8,gestureHysteresis:.02},gt=()=>{Ut(!1),Me(null),Fe(null),Ee(null),L(!1),te(null),Re(!1),ht(null),Ve&&(cancelAnimationFrame(Ve),Ve=null),p.current&&p.current.stop()},Et=ee=>{if(ee.length<2)return 0;const he=ee[0],Ae=ee[1];return Math.sqrt(Math.pow(Ae.clientX-he.clientX,2)+Math.pow(Ae.clientY-he.clientY,2))},Ne=ee=>{if(ee.length<2)return null;const he=ee[0],Ae=ee[1];return{x:(he.clientX+Ae.clientX)/2,y:(he.clientY+Ae.clientY)/2}},Ke=ee=>{Be(he=>[...he,{type:ee,timestamp:Date.now()}].slice(-5))},Ze=()=>{const ee=Date.now(),he=$e.filter(rt=>ee-rt.timestamp<500);if(he.length<2)return 0;const Ae=he[he.length-1],st=he[he.length-2];return Ae.type===st.type?nt.gestureHysteresis:0},ft=(ee,he)=>{Ye(Ae=>({totalGestures:Ae.totalGestures+1,zoomGestures:ee.includes("zoom")?Ae.zoomGestures+1:Ae.zoomGestures,panGestures:ee.includes("pan")?Ae.panGestures+1:Ae.panGestures,combinedGestures:ee==="zoom+pan"?Ae.combinedGestures+1:Ae.combinedGestures,averageResponseTime:(Ae.averageResponseTime+he)/2}))},ut=(ee,he,Ae,st)=>{const rt=p.current,At=rt.scaleX(),yt=rt.position();let wt=At,Jt=yt;if(ee){const er=Ae/we,pr=At*er,_n=(S==null?void 0:S.max_canvas_width)||1536,Z=(S==null?void 0:S.max_canvas_height)||2048,ge=_n/w.width,oe=Z/w.height,ue=Math.min(ge,oe,1);wt=Math.max(.25,Math.min(ue,pr));const me=st,K={x:(me.x-rt.x())/At,y:(me.y-rt.y())/At};Jt={x:me.x-K.x*wt,y:me.y-K.y*wt}}if(he){const er=st.x-ne.x,pr=st.y-ne.y;ee?Jt={x:Jt.x+er,y:Jt.y+pr}:Jt={x:yt.x+er,y:yt.y+pr}}Ve||(Ve=requestAnimationFrame(()=>{rt.scale({x:wt,y:wt}),rt.position(Jt),rt.batchDraw(),Ve=null})),ee&&he?(Me("zoom+pan"),Re(!0)):ee?(Me("zoom"),Re(!0)):he&&Me("pan");const zt=Date.now()-(Ge||Date.now());ft(ee&&he?"zoom+pan":ee?"zoom":"pan",zt),console.log(" Combined gesture",{doZoom:ee,doPan:he,scale:wt.toFixed(2),pos:Jt})},bt=ee=>{const he=ee.evt.touches;he.length===2?(ee.evt.preventDefault(),Ut(!0),Me(null),Fe(Et(he)),Ee(Ne(he)),L(!1),ht(Date.now())):he.length===1&&(Ut(!1),Me(null),J())},ye=ee=>{const he=ee.evt.touches;if(he.length===2&&Ft){ee.evt.preventDefault();const Ae=p.current,st=Et(he),rt=Ne(he);if(we&&ne&&Ae&&st>nt.minTouchDistance){const At=Math.abs(st/we-1),yt=Math.sqrt(Math.pow(rt.x-ne.x,2)+Math.pow(rt.y-ne.y,2)),wt=Ze(),Jt=nt.scaleDelta-wt,dr=nt.centerDelta-wt*10,zt=At>Jt,er=yt>dr;(zt||er)&&(ut(zt,er,st,rt),zt&&er?Ke("zoom+pan"):zt?Ke("zoom"):er&&Ke("pan")),console.log(" Gesture Debug",{scaleDelta:At.toFixed(3),centerDelta:yt.toFixed(1),doZoom:zt,doPan:er,hysteresis:wt.toFixed(3),adjustedScaleDelta:Jt.toFixed(3),adjustedCenterDelta:dr.toFixed(1),gestureHistory:$e.slice(-3)})}Fe(st),Ee(rt)}else he.length===1&&!Ft&&(ee.evt.preventDefault(),re())},de=ee=>{const he=ee.evt.touches;he.length===0?(ve(),gt(),Re(!1)):he.length===1&&(Ut(!1),Me(null),Fe(null),Ee(null),Re(!1))};return c.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:c.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:c.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[c.jsx("div",{ref:H,className:"w-full h-full",children:c.jsx(Bu,{ref:p,width:v.width,height:v.height,scaleX:d?v.zoom:o,scaleY:d?v.zoom:o,onMouseDown:J,onMousemove:re,onMouseup:ve,onTouchStart:bt,onTouchMove:ye,onTouchEnd:de,onWheel:h||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&x(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(x(!1),g)){const ee=p.current,he=H.current,Ae=(he==null?void 0:he.clientWidth)||v.width,st=(he==null?void 0:he.clientHeight)||v.height,rt=w.width*ee.scaleX(),At=w.height*ee.scaleY(),yt=ee.x(),wt=ee.y();(yt>Ae||yt<-rt||wt>st||wt<-At)&&g(ee)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(w.width*o),"x",Math.round(w.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(w.width*o*w.height*o))},children:c.jsxs(Lu,{children:[c.jsx(ms,{x:0,y:0,width:w.width,height:w.height,fill:"white"}),r.map((ee,he)=>{var Ae,st,rt,At;if(Array.isArray(ee)){const yt=((Ae=ee[0])==null?void 0:Ae.tool)==="eraser";return c.jsx(Ss,{points:ee.flatMap(wt=>[wt.x,wt.y]),stroke:yt?"black":((st=ee[0])==null?void 0:st.color)||"#000000",strokeWidth:yt?(((rt=ee[0])==null?void 0:rt.thickness)||2)*7:((At=ee[0])==null?void 0:At.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:yt?"destination-out":"source-over"},he)}else{if(ee.type==="line")return c.jsx(Ss,{points:[ee.startX,ee.startY,ee.endX,ee.endY],stroke:ee.color,strokeWidth:ee.thickness,lineCap:"round"},he);if(ee.type==="rectangle"){const yt=Math.abs(ee.endX-ee.startX),wt=Math.abs(ee.endY-ee.startY),Jt=Math.min(ee.startX,ee.endX),dr=Math.min(ee.startY,ee.endY);return c.jsx(ms,{x:Jt,y:dr,width:yt,height:wt,stroke:ee.color,strokeWidth:ee.thickness,fill:"transparent"},he)}else if(ee.type==="circle"){const yt=Math.sqrt(Math.pow(ee.endX-ee.startX,2)+Math.pow(ee.endY-ee.startY,2))/2,wt=(ee.startX+ee.endX)/2,Jt=(ee.startY+ee.endY)/2;return c.jsx(hc,{x:wt,y:Jt,radius:yt,stroke:ee.color,strokeWidth:ee.thickness,fill:"transparent"},he)}}return null}),_.map(ee=>c.jsx(bre,{...ee,isSelected:k===ee.id,onSelect:E,onUpdate:A,onDelete:C},ee.id)),s==="pencil"&&c.jsx(Ss,{points:z.flatMap(ee=>[ee.x,ee.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&c.jsx(Ss,{points:z.flatMap(ee=>[ee.x,ee.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),O&&O.type==="line"&&c.jsx(Ss,{points:[O.startX,O.startY,O.endX,O.endY],stroke:O.color,strokeWidth:O.thickness,lineCap:"round"}),O&&O.type==="rectangle"&&c.jsx(ms,{x:Math.min(O.startX,O.endX),y:Math.min(O.startY,O.endY),width:Math.abs(O.endX-O.startX),height:Math.abs(O.endY-O.startY),stroke:O.color,strokeWidth:O.thickness,fill:"transparent"}),O&&O.type==="circle"&&c.jsx(hc,{x:(O.startX+O.endX)/2,y:(O.startY+O.endY)/2,radius:Math.sqrt(Math.pow(O.endX-O.startX,2)+Math.pow(O.endY-O.startY,2))/2,stroke:O.color,strokeWidth:O.thickness,fill:"transparent"}),s==="eraser"&&c.jsx(hc,{x:Q.x,y:Q.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&c.jsx(Ss,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&c.jsx(Ss,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&c.jsx(Ss,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&c.jsx(Ss,{points:[Q.x-10,Q.y,Q.x+10,Q.y,Q.x,Q.y-10,Q.x,Q.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),F&&P&&c.jsx(Sre,{x:P.x,y:P.y,width:P.width,height:P.height,initialText:P.text,onSave:ee=>{A(P.id,{text:ee}),M(!1),I(null)},onCancel:()=>{M(!1),I(null)}}),c.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[c.jsx("button",{onClick:()=>{const ee=p.current,he=ee.scaleX(),Ae=(S==null?void 0:S.max_canvas_width)||1536,st=(S==null?void 0:S.max_canvas_height)||2048,rt=Ae/w.width,At=st/w.height,yt=Math.min(rt,At,5),wt=Math.min(yt,ee.scaleX()*1.2);ee.scale({x:wt,y:wt}),ee.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",he.toFixed(2),"->",wt.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*wt),"x",Math.round(w.height*wt)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*wt*w.height*wt),"pixels"),l(wt)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),c.jsx("button",{onClick:()=>{const ee=p.current,he=ee.scaleX(),Ae=Math.max(.25,ee.scaleX()*.8);ee.scale({x:Ae,y:Ae}),ee.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",he.toFixed(2),"->",Ae.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*Ae),"x",Math.round(w.height*Ae)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*Ae*w.height*Ae),"pixels"),l(Ae)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),c.jsx("button",{onClick:()=>{const ee=p.current,he=ee.scaleX();ee.scale({x:1,y:1}),ee.position({x:0,y:0}),ee.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",he.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Reset resolution:",w.width*w.height,"pixels"),l(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),c.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},Cre=({content:t})=>{if(!t)return c.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const e=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(e).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(e).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(e).join(""):"";let l="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?l+=" text-align: center;":i.format==="right"?l+=" text-align: right;":i.format==="left"&&(l+=" text-align: left;")),`<li style="${l}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(e).join(""):""};let r=t;if(typeof t=="string"&&t.startsWith("{"))try{const n=JSON.parse(t);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(e).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return c.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},Tre=({question:t,questionIndex:e,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{qs();const[o,l]=b.useState([]),[u,d]=b.useState(!0),[g,h]=b.useState("pencil"),[p,x]=b.useState("#000000"),[v,w]=b.useState(2),[S,_]=b.useState([]),[y,k]=b.useState(-1),[N,E]=b.useState({width:600,height:800}),[A,C]=b.useState(1),[F,P]=b.useState(!1),[M,I]=b.useState(!1),[Y,se]=b.useState(!1),[L,z]=b.useState([]),[G,O]=b.useState(null),[R,X]=b.useState(!1),[te,H]=b.useState(null),V=y>0,q=y<S.length-1,[Q,ae]=b.useState(!1),J=b.useRef(null),re=b.useRef(null),[ve,we]=b.useState({width:600,height:800}),Fe=b.useRef(!1),[ne,Ee]=b.useState(.25),ke=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];b.useEffect(()=>{const Ye=()=>{se(window.innerWidth>=1024)};return Ye(),window.addEventListener("resize",Ye),()=>window.removeEventListener("resize",Ye)},[]),b.useEffect(()=>{if(t){const Ye=t.max_canvas_width||1536,Ve=t.max_canvas_height||2048,ot=t.canvas_width||600,et=t.canvas_height||800;if(E({width:Ye,height:Ve}),Fe.current)console.log(" DrawingTestStudent - Preserving user zoom:",A.toFixed(2));else{C(1),Fe.current=!0;const gt=(ot-Ye*1)/2,Et=(et-Ve*1)/2;if(!isNaN(gt)&&!isNaN(Et)&&J.current){const Ne={x:gt,y:Et};J.current.position(Ne),J.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",Ye,"x",Ve),console.log(" DrawingTestStudent - Viewport size:",ot,"x",et),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",Ye*Ve,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(Ye/Ve).toFixed(2))}if(r&&typeof r=="string")try{const nt=JSON.parse(r);nt.lines?l(nt.lines):l(nt),nt.textBoxes&&z(nt.textBoxes)}catch{console.log("No valid drawing data found")}d(!1)}},[t,r]),b.useEffect(()=>{const Ye=()=>{const Ve=re.current;if(!Ve)return;const ot=Ve.clientWidth||1,et=Ve.clientHeight||1,nt=Math.min(ot/(N.width||1),et/(N.height||1));Ee(Math.min(nt,1))};return Ye(),window.addEventListener("resize",Ye),()=>window.removeEventListener("resize",Ye)},[N.width,N.height,Q]);const He=Ye=>{l(Ye);const Ve={lines:Ye,textBoxes:L};n(t.question_id,JSON.stringify(Ve)),at(Ye,L)},at=(Ye,Ve=L)=>{const ot=S.slice(0,y+1);ot.push({lines:[...Ye],textBoxes:[...Ve]}),_(ot),k(ot.length-1)},Me=()=>{if(V){const Ye=y-1,Ve=S[Ye];if(Ve&&typeof Ve=="object"&&Ve.lines){l([...Ve.lines]),z([...Ve.textBoxes]);const ot={lines:Ve.lines,textBoxes:Ve.textBoxes};n(t.question_id,JSON.stringify(ot))}else{const ot=Ve||[];l([...ot]),n(t.question_id,JSON.stringify(ot))}k(Ye)}},Ft=()=>{if(q){const Ye=y+1,Ve=S[Ye];if(Ve&&typeof Ve=="object"&&Ve.lines){l([...Ve.lines]),z([...Ve.textBoxes]);const ot={lines:Ve.lines,textBoxes:Ve.textBoxes};n(t.question_id,JSON.stringify(ot))}else{const ot=Ve||[];l([...ot]),n(t.question_id,JSON.stringify(ot))}k(Ye)}},Ut=()=>{l([]),z([]),O(null),n(t.question_id,"")},Pe=Ye=>{O(Ye)},Re=(Ye,Ve)=>{const ot=L.map(nt=>nt.id===Ye?{...nt,...Ve}:nt);z(ot),at(o,ot);const et={lines:o,textBoxes:ot};if(n(t.question_id,JSON.stringify(et)),Ve.isEditing){const nt=L.find(gt=>gt.id===Ye);H(nt),X(!0)}},$e=Ye=>{const Ve=L.filter(et=>et.id!==Ye);z(Ve),G===Ye&&O(null),at(o,Ve);const ot={lines:o,textBoxes:Ve};n(t.question_id,JSON.stringify(ot))},Be=()=>{if(Q){const ot=(t==null?void 0:t.canvas_width)||600,et=(t==null?void 0:t.canvas_height)||800,nt=window.innerWidth-40,gt=window.innerHeight-40,Et=nt/ot,Ne=gt/et,Ke=Math.min(Et,Ne,1);return{width:ot,height:et,zoom:Ke}}const Ye=(t==null?void 0:t.canvas_width)||600,Ve=(t==null?void 0:t.canvas_height)||800;return{width:Ye,height:Ve,zoom:1}};b.useEffect(()=>{const Ye=()=>{we(Be())};return Ye(),window.addEventListener("resize",Ye),()=>window.removeEventListener("resize",Ye)},[Q,N]);const Ge=Ye=>{Ye.evt.preventDefault();const Ve=J.current,ot=Ve.scaleX(),et=Ve.getPointerPosition(),nt={x:(et.x-Ve.x())/ot,y:(et.y-Ve.y())/ot},gt=Ye.evt.deltaY>0?ot*.9:ot*1.1,Et=(t==null?void 0:t.max_canvas_width)||1536,Ne=(t==null?void 0:t.max_canvas_height)||2048,Ke=Et/N.width,Ze=Ne/N.height,ft=Math.min(Ke,Ze,1),ut=Math.max(ne,Math.min(ft,gt)),bt={x:et.x-nt.x*ut,y:et.y-nt.y*ut};if(ut<=ne&&re.current){const ye=re.current.clientWidth||1,de=re.current.clientHeight||1;bt.x=(ye-N.width*ut)/2,bt.y=(de-N.height*ut)/2}Ve.scale({x:ut,y:ut}),Ve.position(bt),Ve.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",ot.toFixed(2),"->",ut.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(N.width*ut),"x",Math.round(N.height*ut)),console.log(" DrawingTestStudent - New resolution:",Math.round(N.width*ut*N.height*ut),"pixels"),C(ut),Fe.current=!0},ht=Ye=>{const Ve=Ye.scaleX(),ot=re.current,et=(ot==null?void 0:ot.clientWidth)||ve.width,nt=(ot==null?void 0:ot.clientHeight)||ve.height,gt=N.width*Ve,Et=N.height*Ve;if(Ve<=ne){const ee=(et-gt)/2,he=(nt-Et)/2;Ye.position({x:ee,y:he}),Ye.batchDraw();return}if(gt<=et&&Et<=nt){const ee=(et-gt)/2,he=(nt-Et)/2;Ye.position({x:ee,y:he}),Ye.batchDraw();return}const Ne=Math.max(0,gt-et),Ke=Math.max(0,Et-nt),Ze=-Ne,ft=-Ke,ut=Ye.x(),bt=Ye.y(),ye=Math.max(Ze,Math.min(Ne,ut)),de=Math.max(ft,Math.min(Ke,bt));(ye!==ut||de!==bt)&&(Ye.position({x:ye,y:de}),Ye.batchDraw())},Nt=()=>{if(Q)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const Ye=document.querySelector(".drawing-canvas-container");Ye&&(Ye.requestFullscreen?Ye.requestFullscreen():Ye.webkitRequestFullscreen?Ye.webkitRequestFullscreen():Ye.msRequestFullscreen&&Ye.msRequestFullscreen())}};return b.useEffect(()=>{const Ye=()=>{ae(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",Ye),document.addEventListener("webkitfullscreenchange",Ye),document.addEventListener("msfullscreenchange",Ye),()=>{document.removeEventListener("fullscreenchange",Ye),document.removeEventListener("webkitfullscreenchange",Ye),document.removeEventListener("msfullscreenchange",Ye)}},[]),b.useEffect(()=>()=>{J.current&&J.current.stop()},[]),u?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx(ir,{})}):t?c.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${Q?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!Q&&c.jsx("div",{className:"mb-4",children:c.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",e+1]})}),!Q&&t.question_json&&t.question_json.trim()&&c.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[c.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),c.jsx("div",{className:"text-gray-700",children:c.jsx(Cre,{content:t.question_json})})]}),!Q&&c.jsx(it,{className:"p-1 sm:p-2 mb-2",children:c.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),c.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[c.jsx("button",{onClick:()=>h("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),c.jsx("button",{onClick:()=>h("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),c.jsx("button",{onClick:()=>h("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),c.jsx("button",{onClick:()=>h("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),c.jsx("button",{onClick:()=>h("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),c.jsx("button",{onClick:()=>h("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),c.jsx("button",{onClick:()=>h("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${g==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:Me,disabled:!V,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${V?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),c.jsx("button",{onClick:Ft,disabled:!q,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${q?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>P(!F),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[c.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:p}}),c.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),F&&c.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:c.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:ke.map(Ye=>c.jsx("button",{onClick:()=>{x(Ye),P(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${p===Ye?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:Ye},title:Ye},Ye))})})]}),c.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[c.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),c.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:Ye=>w(parseInt(Ye.target.value)),className:"w-16 sm:w-20"}),c.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),c.jsx(Ue,{onClick:Ut,variant:"secondary",size:"sm",children:"Clear"})]})}),c.jsx(it,{paddingClass:"p-0 sm:p-2",children:c.jsxs("div",{className:"w-full drawing-canvas-container relative p-0 m-0",children:[c.jsx(kre,{width:N.width,height:N.height,lines:o,onDrawingChange:He,currentTool:g,currentColor:p,currentThickness:v,zoom:A,onZoomChange:C,isPanning:M,isFullscreen:Q,constrainPanPosition:ht,handleWheel:Ge,stageRef:J,setIsPanning:I,responsiveDimensions:ve,canvasSize:N,question:t,textBoxes:L,setTextBoxes:z,selectedTextBox:G,setSelectedTextBox:O,handleTextBoxSelect:Pe,handleTextBoxUpdate:Re,handleTextBoxDelete:$e,isEditingText:R,editingTextBox:te,setIsEditingText:X,setEditingTextBox:H,setCurrentTool:h}),c.jsx("button",{onClick:Nt,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:Q?"Exit Fullscreen":"Enter Fullscreen",children:Q?c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):c.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:c.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},_2={enhanceUserData(t,e){const r={id:t.id||t.student_id||t.teacher_id,username:t.username||t.student_id,name:t.name||t.first_name,surname:t.surname||t.last_name,nickname:t.nickname,role:e,is_active:t.is_active!==void 0?t.is_active:!0,created_at:t.created_at,updated_at:t.updated_at};switch(e){case"student":return{...r,student_id:t.student_id,grade:t.grade,class:t.class,number:t.number,subjects:t.subjects||[]};case"teacher":return{...r,teacher_id:t.teacher_id,first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone,subjects:t.subjects||[]};case"admin":return{...r,admin_id:t.admin_id,permissions:t.permissions||["all"]};default:return r}},async studentLogin(t){console.log("Trying student login...");try{const e=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:t.username,password:t.password})}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:e};throw new Error(r.message||"Student login failed")}catch(e){throw console.error("Student login error:",e),new Error(e.message||"Student login failed")}},async teacherLogin(t){console.log("Trying teacher login...");try{const e=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:e};throw new Error(r.message||"Teacher login failed")}catch(e){throw console.error("Teacher login error:",e),new Error(e.message||"Teacher login failed")}},async adminLogin(t){console.log("Trying admin login...");try{const e=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await e.json();if(e.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:e};throw new Error(r.message||"Admin login failed")}catch(e){throw console.error("Admin login error:",e),new Error(e.message||"Admin login failed")}},async login(t){const{username:e,password:r}=t;console.log("Attempting login with:",e,r);try{if(e==="admin"){const o=await this.adminLogin(t),l=await o.json();return await this.handleLoginResponse(o,"admin",l)}const n=await this.teacherLogin(t),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(t),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(t,e,r){if(t.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,e),{success:!0,data:r,role:e}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(t,e){console.log(`Handling post-login actions for role: ${e}`);try{switch(e){case"student":t.student&&(this.populateStudentInfo(t.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":t.teacher&&(this.populateTeacherInfo(t.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":t.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${e}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const t=document.getElementById("unifiedLoginForm");if(t){t.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=t.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),t.classList.remove("test-submitting","disabled"),t.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(t){return console.error("Logout error:",t),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(t){console.error("Error resetting interface:",t),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(t){var e,r;try{return{success:!0,message:(await Sn.post("/auth/change-password",{currentPassword:t.currentPassword,newPassword:t.newPassword,confirmPassword:t.confirmPassword})).data.message}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Password change failed")}},async verifyToken(t){try{const e=await Sn.get("/auth/verify",{headers:{Authorization:`Bearer ${t}`}});return{success:!0,valid:e.data.valid,user:e.data.user}}catch(e){return{success:!1,valid:!1,error:e.message}}},async refreshToken(t){var e,r;try{const n=await Sn.post("/auth/refresh",{refreshToken:t});return{success:!0,token:n.data.token,refreshToken:n.data.refreshToken}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Token refresh failed")}},async getUserProfile(){var t,e;try{return{success:!0,user:(await Sn.get("/auth/profile")).data.user}}catch(r){throw new Error(((e=(t=r.response)==null?void 0:t.data)==null?void 0:e.message)||"Failed to get user profile")}},async updateUserProfile(t){var e,r;try{return{success:!0,user:(await Sn.put("/auth/profile",t)).data.user}}catch(n){throw new Error(((r=(e=n.response)==null?void 0:e.data)==null?void 0:r.message)||"Failed to update user profile")}},populateStudentInfo(t){console.log("=== populateStudentInfo called ==="),console.log("Student object:",t);const e=document.getElementById("studentName");if(e){const s=`${(t==null?void 0:t.name)||""} ${(t==null?void 0:t.surname)||""}`.trim();e.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=(t==null?void 0:t.grade)||"",console.log("Set student grade to:",t==null?void 0:t.grade));const n=document.getElementById("studentClass");n&&(n.textContent=(t==null?void 0:t.class)||"",console.log("Set student class to:",t==null?void 0:t.class)),console.log("Student info populated successfully")},populateTeacherInfo(t){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",t);const e=document.getElementById("teacherName");if(e){const n=`${(t==null?void 0:t.name)||""} ${(t==null?void 0:t.surname)||""}`.trim();e.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=(t==null?void 0:t.username)||"",console.log("Set teacher username to:",t==null?void 0:t.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const t=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return t&&t.sub?t.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${t.sub}`),t.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${t.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(t){return console.error("[ERROR] Error getting current teacher ID from JWT:",t),null}},getCurrentAdmin(){var r;const t=(r=window.tokenManager)==null?void 0:r.getToken();if(!t)return null;const e=window.tokenManager.decodeToken(t);if(!e||e.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:e.sub,username:e.username,role:e.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const t=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return t&&t.username?(console.log(`[DEBUG] Found teacher username from JWT: ${t.username}`),t.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(t){return console.error("[ERROR] Error getting current teacher username from JWT:",t),null}},isAdmin(){var t;try{const e=(t=window.tokenManager)==null?void 0:t.getToken();if(!e)return!1;const r=window.tokenManager.decodeToken(e);return r&&r.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const t=this.getCurrentAdmin();return t?t.id:null}catch(t){return console.error("[ERROR] Error getting admin ID:",t),null}}},Ere=()=>{const t=Xa(),{login:e,setUserData:r,isAuthenticated:n,user:s}=vn(),[a,i]=b.useState({username:"",password:""}),[o,l]=b.useState(!1),[u,d]=b.useState(""),[g,h]=b.useState([]),[p,x]=b.useState(!1);b.useEffect(()=>{v()},[]);const v=b.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const M=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());M&&M.role?console.log("User role from JWT:",M.role):console.log("No valid role found in JWT, showing login")}catch(M){console.error("Error decoding JWT token:",M)}}else console.log("No valid JWT session found, showing login")},[]),w=b.useCallback(async M=>{if(M.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),C("Please wait for the logout process to complete.","warning");return}const{username:I,password:Y}=a;if(!I||!Y){d("Please enter both username and password");return}l(!0),d("");try{let se,L;I==="admin"?(se=await _2.adminLogin({username:I,password:Y}),L=aa.ADMIN):/^\d+$/.test(I)?(se=await _2.studentLogin({username:I,password:Y}),L=aa.STUDENT):(se=await _2.teacherLogin({username:I,password:Y}),L=aa.TEACHER);let z,G;if(se.response?(z=se,G=se.response):(z=await se.json(),G=se),await S(G,L,z)){C("Login successful!","success");try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(se){console.error("Login error:",se),d("Invalid username or password")}finally{l(!1)}},[a]),S=b.useCallback(async(M,I,Y)=>{if(M.ok&&Y.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),E(),!1;try{Y.token&&(window.tokenManager.setTokens(Y.token,I),Y.refreshToken&&window.tokenManager.setRefreshToken(Y.refreshToken),console.log("JWT token stored successfully"));const se={...Y.data,...Y,role:I};return r(se),await _(se),!0}catch(se){return console.error("Error handling login response:",se),E(se),!1}}else return console.error("Login failed:",Y.error||"Unknown error"),d(Y.error||"Login failed. Please check your credentials."),!1},[e]),_=b.useCallback(async M=>{if(console.log("Handling post-login actions for role:",M.role),p){console.log(" Post-login already handled, skipping");return}x(!0);try{switch(M.role){case aa.STUDENT:await y(M),t("/student");break;case aa.TEACHER:await k(M),t("/teacher");break;case aa.ADMIN:await N(M),t("/admin");break;default:console.error("Unknown user role:",M.role),E()}}catch(I){console.error("Error in post-login actions:",I),E(I)}},[t,p]);b.useEffect(()=>{n||x(!1)},[n]);const y=b.useCallback(async M=>{console.log("Populating student info:",M)},[]),k=b.useCallback(async M=>{console.log("Populating teacher info:",M)},[]),N=b.useCallback(async M=>{console.log("Populating admin info:",M)},[]),E=b.useCallback((M=null)=>{console.error("Login failure:",M),d("Login failed. Please check your credentials and try again."),A()},[]),A=b.useCallback(()=>{i({username:"",password:""}),d(""),l(!1)},[]),C=b.useCallback((M,I)=>{const Y={id:Date.now(),message:M,type:I,timestamp:new Date};h(se=>[...se,Y]),setTimeout(()=>{h(se=>se.filter(L=>L.id!==Y.id))},ba.NOTIFICATION_DURATION)},[]),F=b.useCallback(M=>{const{name:I,value:Y}=M.target;i(se=>({...se,[I]:Y})),u&&d("")},[u]),P=b.useCallback(M=>{M.key==="Enter"&&!o&&w(M)},[w,o]);return c.jsxs(Le.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsxs(Le.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsxs(Le.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx(Le.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:c.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),c.jsx(Le.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),c.jsx(Le.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),c.jsxs(Le.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[c.jsx(Le.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),c.jsxs("form",{onSubmit:w,className:"space-y-6",children:[c.jsxs(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[c.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID"}),c.jsx(Le.input,{type:"text",id:"username",name:"username",value:a.username,onChange:F,onKeyDown:P,placeholder:"Enter student ID",required:!0,autoComplete:"username",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsxs(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[c.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),c.jsx(Le.input,{type:"password",id:"password",name:"password",value:a.password,onChange:F,onKeyDown:P,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),c.jsx(Sa,{children:u&&c.jsx(Le.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:c.jsx("p",{className:"text-sm text-red-600",children:u})})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:c.jsx(Ue,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]}),ba.DEBUG_MODE]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:c.jsx(Sa,{children:g.map(M=>c.jsx(Le.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:c.jsx(eo,{type:M.type,message:M.message,onClose:()=>h(I=>I.filter(Y=>Y.id!==M.id))})},M.id))})})]})},Ur={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(e.success)return console.log("Student data loaded successfully:",e.subjects),e.subjects;throw new Error(e.error||"Failed to load student data")}catch(t){throw console.error("Error loading student data:",t),t}},getStudentSubjects(t){return console.log("getStudentSubjects called with subjects:",t),t.map(e=>({id:e.id||e.subject_id,name:e.subject,grade:e.grade,class:e.class,testResults:e.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const t=await this.getCurrentTeacherId();if(!t)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:t,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(t){throw console.error("Error loading teacher data:",t),t}},getTeacherSubjects(t){return console.log("getTeacherSubjects called with subjects:",t),t.map(e=>{let r=[];return e.classes&&Array.isArray(e.classes)&&(r=e.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:e.subject_id,name:e.subject,classes:r,assignments:e.assignments||[],description:e.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(e=>({id:e,name:e,classes:this.generateClassButtons(e)}))},generateClassButtons(t){const e=[];for(let r=1;r<=10;r++)e.push({id:`${t}_${r}`,name:`${t}/${r}`,grade:t,class:r});return e},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[e,r,n,s]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAcademicYear(),this.getAllUsers()]);return{teachers:e.status==="fulfilled"?e.value:[],subjects:r.status==="fulfilled"?r.value:[],academicYear:n.status==="fulfilled"?n.value:[],users:s.status==="fulfilled"?s.value:[],loadedAt:new Date().toISOString()}}catch(t){throw console.error("Error loading admin data:",t),t}},async saveTeacherSubjects(t){console.log("saveTeacherSubjects called with subjects:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:t})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(e){throw console.error("Error saving teacher subjects:",e),e}},async deleteTeacherSubject(t){console.log("deleteTeacherSubject called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(e){throw console.error("Error deleting teacher subject assignment:",e),e}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(e.success)return console.log("Subjects dropdown data loaded successfully"),e.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(e.error||"Failed to load subjects dropdown")}catch(t){throw console.error("Error loading subjects dropdown:",t),t}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(e.success)return console.log("Grades and classes loaded successfully"),e.data;throw new Error(e.message||"Failed to load grades and classes")}catch(t){throw console.error("Error loading grades and classes:",t),t}},async saveSubjectClasses(t,e){console.log("saveSubjectClasses called with subjectId:",t,"classes:",e);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:t,classes:e})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(e.success)return console.log("All subjects loaded successfully"),e.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all subjects")}catch(t){throw console.error("Error loading all subjects:",t),t}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(e.success)return console.log("Subjects for selection loaded successfully"),e.subjects;throw new Error(e.message||"Failed to load subjects for selection")}catch(t){throw console.error("Error loading subjects for selection:",t),t}},async getAcademicYear(){console.log("getAcademicYear called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-academic-year")).json();if(e.success)return console.log("Academic year loaded successfully"),e.academic_years.map(r=>({id:r.id,year:r.academic_year,semester:r.semester,term:r.term,start_date:r.start_date,end_date:r.end_date,is_current:r.is_current}));throw new Error(e.error||"Failed to load academic year")}catch(t){throw console.error("Error loading academic year:",t),t}},async addAcademicYear(t){console.log("addAcademicYear called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(e){throw console.error("Error adding academic year:",e),e}},async getAllUsers(){console.log("getAllUsers called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(e.success)return console.log("All users loaded successfully"),e.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all users")}catch(t){throw console.error("Error loading all users:",t),t}},async getAllTeachers(){console.log("getAllTeachers called");try{const e=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(e.success)return console.log("All teachers loaded successfully"),e.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(e.error||"Failed to load all teachers")}catch(t){throw console.error("Error loading all teachers:",t),t}},async createUser(t){console.log("createUser called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(e){throw console.error("Error creating user:",e),e}},async updateUser(t,e){console.log("updateUser called with userId:",t,"data:",e);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(t){console.log("createTeacher called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(e){throw console.error("Error creating teacher:",e),e}},async updateTeacher(t,e){console.log("updateTeacher called with teacherId:",t,"data:",e);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(t){console.log("updateStudentInfo called with data:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(e){throw console.error("Error updating student info:",e),e}},async changePassword(t){console.log("changePassword called");let e;if(t.studentId)e="/.netlify/functions/change-student-password";else if(t.username)e="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const t=localStorage.getItem("accessToken");if(!t)return null;const e=JSON.parse(atob(t.split(".")[1]));return e.teacher_id||e.sub||null}catch(t){return console.error("Error getting current teacher ID:",t),null}},async getCurrentAdminId(){try{const t=localStorage.getItem("accessToken");if(!t)return null;const e=JSON.parse(atob(t.split(".")[1]));return e.admin_id||e.sub||null}catch(t){return console.error("Error getting current admin ID:",t),null}}},FM=b.createContext(),PM=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState([]),[a,i]=b.useState([]),[o,l]=b.useState([]),[u,d]=b.useState([]),[g,h]=b.useState([]),[p,x]=b.useState([]),[v,w]=b.useState([]),[S,_]=b.useState(!1),[y,k]=b.useState(null),[N,E]=b.useState(!1),[A,C]=b.useState(!1),[F,P]=b.useState(!1),[M,I]=b.useState(null),[Y,se]=b.useState(null),[L,z]=b.useState(null),G=b.useCallback(async()=>{try{_(!0),k(null);const ee=`student_subjects_${(e==null?void 0:e.student_id)||(e==null?void 0:e.id)||""}`;console.log(" UserContext: Checking cache for key:",ee);const he=zr(ee);if(he){console.log(" UserContext: Cache HIT! Using cached student data"),s(he),O(he);return}console.log(" UserContext: Cache MISS! Fetching from API");const Ae=await Ur.getStudentData();if(Ae)s(Ae),O(Ae),console.log(" UserContext: Caching student data with key:",ee),Gr(ee,Ae,Jr.student_subjects);else throw new Error("No subjects data received")}catch(de){k(de.message||"Failed to load student data"),console.error("Error loading student data:",de)}finally{_(!1)}},[e==null?void 0:e.student_id,e==null?void 0:e.id]),O=de=>{console.log("Displaying student subjects:",de),s(de)},R=b.useCallback(async()=>{try{if(_(!0),k(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),k("No valid teacher session found");return}const ee=`teacher_subjects_${(e==null?void 0:e.teacher_id)||(e==null?void 0:e.id)||""}`,he=zr(ee);if(he){s(he),he.length===0?Ke():X(he);return}const Ae=await Ur.getTeacherSubjects();if(Ae.success)s(Ae.subjects),Gr(ee,Ae.subjects,Jr.teacher_subjects),Ae.subjects.length===0?Ke():X(Ae.subjects);else throw new Error(Ae.message||"Failed to load teacher data")}catch(de){k(de.message||"Failed to load teacher data"),console.error("Error loading teacher data:",de)}finally{_(!1)}},[e==null?void 0:e.teacher_id,e==null?void 0:e.id]),X=de=>{console.log("Showing main cabinet with subjects:",de),s(de)},te=de=>{console.log("Displaying grade buttons:",de),l(de)},H=async()=>{try{if(_(!0),k(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),k("No valid admin session found");return}await Promise.all([Ee(),Re(),Ve(),ae()])}catch(de){k(de.message||"Failed to load admin data"),console.error("Error loading admin data:",de)}finally{_(!1)}},V=de=>{console.log(" populateStudentInfoDirectly called with:",de);try{r(de),console.log(" Set student profile:",de)}catch(ee){console.error("Error populating student info:",ee)}},q=de=>{console.log("=== populateStudentInfo called ==="),r(de)},Q=de=>{console.log("=== populateTeacherInfo called ==="),r(de)},ae=b.useCallback(async()=>{try{_(!0);const de="admin_users_",ee=zr(de);if(ee){d(ee),J(ee);return}const he=await Ur.getAllUsers();if(he.success)d(he.users),J(he.users),Gr(de,he.users,Jr.admin_users);else throw new Error(he.message||"Failed to load users")}catch(de){k(de.message||"Failed to load users"),console.error("Error loading users:",de)}finally{_(!1)}},[]),J=de=>{console.log("Displaying all users:",de),d(de)},re=(de,ee)=>{console.log("Displaying users table:",de,ee),d(de)},ve=()=>{console.log("Toggling users content")},we=()=>{console.log("Showing add user form"),E(!0)},Fe=()=>{console.log("Hiding add user form"),E(!1)},ne=de=>{console.log("Editing user row:",de);const ee=u.find(he=>he.id===de);I(ee)},Ee=b.useCallback(async()=>{try{const de="admin_teachers_",ee=zr(de);if(ee){h(ee),ke(ee);return}const he=await Ur.getAllTeachers();if(he.success)h(he.teachers),ke(he.teachers),Gr(de,he.teachers,Jr.admin_teachers);else throw new Error(he.message||"Failed to load teachers")}catch(de){k(de.message||"Failed to load teachers"),console.error("Error loading teachers:",de)}},[]),ke=de=>{console.log("Displaying all teachers:",de),h(de)},He=(de,ee)=>{console.log("Displaying teachers table:",de,ee),h(de)},at=()=>{console.log("Toggling teachers content")},Me=()=>{console.log("Showing add teacher form"),C(!0)},Ft=()=>{console.log("Hiding add teacher form"),C(!1)},Ut=de=>{console.log("Editing teacher:",de);const ee=g.find(he=>he.id===de);se(ee)},Pe=de=>{console.log("Editing teacher row:",de);const ee=g.find(he=>he.id===de);se(ee)},Re=b.useCallback(async()=>{try{const de="admin_subjects_",ee=zr(de);if(ee){x(ee),$e(ee);return}const he=await Ur.getAllSubjects();if(he.success)x(he.subjects),$e(he.subjects),Gr(de,he.subjects,Jr.admin_subjects);else throw new Error(he.message||"Failed to load subjects")}catch(de){k(de.message||"Failed to load subjects"),console.error("Error loading subjects:",de)}},[]),$e=de=>{console.log("Displaying all subjects:",de),x(de)},Be=(de,ee)=>{console.log("Displaying subjects table:",de,ee),x(de)},Ge=()=>{console.log("Toggling subjects content")},ht=()=>{console.log("Showing add subject form"),P(!0)},Nt=()=>{console.log("Hiding add subject form"),P(!1)},Ye=de=>{console.log("Editing subject row:",de);const ee=p.find(he=>he.id===de);z(ee)},Ve=b.useCallback(async()=>{try{const de="admin_academic_years_",ee=zr(de);if(ee){w(ee),ot(ee);return}const he=await Ur.getAcademicYear();if(he.success)w(he.academicYears),ot(he.academicYears),Gr(de,he.academicYears,Jr.admin_academic_years);else throw new Error(he.message||"Failed to load academic year")}catch(de){k(de.message||"Failed to load academic year"),console.error("Error loading academic year:",de)}},[]),ot=de=>{console.log("Displaying academic year:",de),w(de)},et=()=>{console.log("Showing add academic year form")},nt=()=>{console.log("Hiding add academic year form")},gt=de=>{console.log("Handling add academic year:",de)},Et=()=>{console.log("Toggling academic year content")},Ne=()=>{console.log("Showing academic year editor")},Ke=()=>{console.log("Showing subject selection")},Ze=()=>{console.log("Showing main cabinet")},ft=de=>{r(ee=>({...ee,...de}))},ut=()=>{r(null),s([]),i([]),l([]),d([]),h([]),x([]),w([]),k(null)},bt=b.useCallback(de=>{ut(),de&&tC(de)},[]),ye={userProfile:e,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:g,allSubjects:p,academicYears:v,isLoading:S,error:y,showUserForm:N,showTeacherForm:A,showSubjectForm:F,editingUser:M,editingTeacher:Y,editingSubject:L,loadStudentData:G,displayStudentSubjects:O,populateStudentInfoDirectly:V,populateStudentInfo:q,loadTeacherData:R,showMainCabinetWithSubjects:X,displayGradeButtons:te,populateTeacherInfo:Q,showSubjectSelection:Ke,showMainCabinet:Ze,loadAdminData:H,getAllUsers:ae,displayAllUsers:J,displayUsersTable:re,toggleUsersContent:ve,showAddUserForm:we,hideAddUserForm:Fe,editUserRow:ne,loadAllTeachers:Ee,displayAllTeachers:ke,displayTeachersTable:He,toggleTeachersContent:at,showAddTeacherForm:Me,hideAddTeacherForm:Ft,editTeacher:Ut,editTeacherRow:Pe,loadAllSubjects:Re,displayAllSubjects:$e,displaySubjectsTable:Be,toggleSubjectsContent:Ge,showAddSubjectForm:ht,hideAddSubjectForm:Nt,editSubjectRow:Ye,loadAcademicYear:Ve,displayAcademicYear:ot,showAddAcademicYearForm:et,hideAddAcademicYearForm:nt,handleAddAcademicYear:gt,toggleAcademicYearContent:Et,showAcademicYearEditor:Ne,updateUserProfile:ft,clearUserData:ut,clearUserDataWithCache:bt,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:l,setAllUsers:d,setAllTeachers:h,setAllSubjects:x,setAcademicYears:w,setError:k};return c.jsx(FM.Provider,{value:ye,children:t})},Bv=()=>{const t=b.useContext(FM);if(!t)throw new Error("useUser must be used within a UserProvider");return t},l8={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},Mr={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},aa={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(t,e)=>e+1);const ba={API_BASE_URL:"",APP_NAME:"Mathayom Watsing Test System",VERSION:"2.0.0",DEBUG_MODE:!1,AUTO_SAVE_INTERVAL:3e4,NOTIFICATION_DURATION:3e3,MAX_TEST_QUESTIONS:50,MIN_TEST_QUESTIONS:1,ITEMS_PER_PAGE:20,CACHE_DURATION:3e5,CURRENT_ACADEMIC_YEAR:"2025-2026",CURRENT_SEMESTER:1},xc=(t,e,r)=>{if(!t||!Array.isArray(t)||t.length===0)return{score:0,total:0,percentage:0};let n=0;return t.forEach((s,a)=>{const i=Array.isArray(e)?e[a]:e[String(s.question_id||s.id||a)];i!=null&&eh(s,i,r)&&n++}),{score:n,total:t.length,percentage:Math.round(n/t.length*100)}},Lg=(t,e)=>{console.log(" Getting correct answer for question:",t,"testType:",e);let r="";switch(e){case Mr.TRUE_FALSE:r=t.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case Mr.MULTIPLE_CHOICE:const n=t.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=t[s];a?r=a:r=`Option ${t.correct_answer}`;break;case Mr.INPUT:t.correct_answers&&Array.isArray(t.correct_answers)?r=t.correct_answers.join(", "):r=t.correct_answer||"Unknown";break;case Mr.MATCHING:r=t.correct_answer||t.answer;break;case Mr.WORD_MATCHING:r=t.correct_answer||t.answer;break;case Mr.DRAWING:r="Drawing required";break;case Mr.FILL_BLANKS:t.correct_answers&&Array.isArray(t.correct_answers)&&t.correct_answers.length>0?r=t.correct_answers[0]:r=t.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},eh=(t,e,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",t,"studentAnswer:",e,"testType:",r),!e||e==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case Mr.TRUE_FALSE:n=e.toLowerCase()==="true"===t.correct_answer;break;case Mr.MULTIPLE_CHOICE:let a="";if(typeof e=="string"){const o=e.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const l=parseInt(o,10),u=l>=0?l:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof e=="number"){const o=e;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(t.correct_answer||"").toUpperCase();break;case Mr.INPUT:if(t.correct_answers&&Array.isArray(t.correct_answers)){const o=e.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=t.correct_answers.some(l=>{const u=l.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u})}else n=e.toLowerCase().trim()===t.correct_answer.toLowerCase().trim();break;case Mr.MATCHING:if(t.correct_answer&&typeof t.correct_answer=="object"){const o=typeof e=="string"?JSON.parse(e||"{}"):e;n=JSON.stringify(o)===JSON.stringify(t.correct_answer)}break;case Mr.WORD_MATCHING:if(t.correct_answer&&typeof t.correct_answer=="object"){const o=typeof e=="string"?JSON.parse(e||"{}"):e;n=JSON.stringify(o)===JSON.stringify(t.correct_answer)}break;case Mr.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case Mr.FILL_BLANKS:const i=t.correct_answers&&Array.isArray(t.correct_answers)&&t.correct_answers.length>0?t.correct_answers[0]:t.correct_answer;if(i&&e){let o="";if(typeof e=="string"){const l=e.trim();if(/^[a-z]$/i.test(l))o=l.toUpperCase();else if(/^\d+$/.test(l)){const u=parseInt(l,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof e=="number"){const l=e;Number.isNaN(l)||(o=String.fromCharCode(65+l))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n},Ar={async getTestInfo(t,e){console.log(`[DEBUG] getTestInfo called with testType: ${t}, testId: ${e}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(t,e){console.log(`[DEBUG] getTestQuestions called with testType: ${t}, testId: ${e}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const t="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",t);const e=await window.tokenManager.makeAuthenticatedRequest(t);if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(t){throw console.error("[ERROR] Failed to get active tests:",t),t}},async getTeacherTests(){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests";console.log("[DEBUG] Fetching teacher tests from:",t);const e=await window.tokenManager.makeAuthenticatedRequest(t);if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const r=await e.json();if(console.log("[DEBUG] Teacher tests data received:",r),r.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(t,e,r,n={},s=null){var a,i,o;console.log("Submitting test:",{testType:t,testId:e});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let l;try{const N=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${t}&test_id=${e}`)).json();if(N.success)l=N.test_info;else throw new Error("Failed to get test information")}catch(k){console.error("Error getting test info:",k);const N=await this.getTestQuestions(t,e);l={test_name:`Test ${e}`,num_questions:N.length}}const u=await this.getTestQuestions(t,e);let d,g;if(t==="drawing")d=null,g=null;else{const k=n!=null&&n.answers_by_id?n.answers_by_id:r;d=xc(u,k,t).score,g=l.num_questions}const h=this.transformAnswersForSubmission(r,t),p=l.teacher_id||null,x=l.subject_id||null,v=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||((a=window.tokenManager)!=null&&a.getCurrentUser?((i=window.tokenManager.getCurrentUser())==null?void 0:i.student_id)||((o=window.tokenManager.getCurrentUser())==null?void 0:o.id):null),w={test_id:e,test_name:l.test_name,test_type:t,teacher_id:p,subject_id:x,student_id:v,answers:h,score:d,maxScore:g,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||e};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",w.retest_assignment_id);let S;switch(t){case"multiple_choice":S="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":S="/.netlify/functions/submit-true-false-test";break;case"input":S="/.netlify/functions/submit-input-test";break;case"matching_type":S="/.netlify/functions/submit-matching-type-test";break;case"word_matching":S="/.netlify/functions/submit-word-matching-test";break;case"drawing":S="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":S="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${t}`)}console.log("Submitting to:",S),console.log("Submission data:",w),console.log("Submission data JSON:",JSON.stringify(w,null,2)),console.log(" Final submission retest_assignment_id:",w.retest_assignment_id);const _=await window.tokenManager.makeAuthenticatedRequest(S,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);const y=await _.json();if(console.log("Test submission result:",y),y.success)return this.clearTestProgress(t,e),{success:!0,score:d,maxScore:g,result:y};throw new Error(y.error||"Failed to submit test")}catch(l){throw console.error("Error submitting test:",l),l}},async createTest(t){try{return(await Sn.post("/tests/create",t)).data}catch(e){throw new Error(e.message||"Failed to create test")}},async updateTest(t,e,r){try{return(await Sn.put(`/tests/${t}/${e}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(t,e){try{return(await Sn.delete(`/tests/${t}/${e}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(t,e){try{return(await Sn.post(`/tests/${t}/${e}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(t,e){try{return(await Sn.post(`/tests/${t}/${e}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(t,e){try{return(await Sn.post(`/tests/${t}/${e}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(t,e,r){try{return(await Sn.delete(`/tests/${t}/${e}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(t,e){try{return(await Sn.get(`/tests/${t}/${e}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(t,e,r="json"){try{return(await Sn.get(`/tests/${t}/${e}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(t,e){try{return(await Sn.uploadFile(`/tests/import?type=${e}`,t)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(t,e){try{return(await Sn.get(`/tests/${t}/${e}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const t=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const e=await t.json();if(console.log("[DEBUG] Student test results data received:",e),e.success)return console.log("[DEBUG] Student test results retrieved successfully"),e;throw new Error(e.error||"Failed to get student test results")}catch(t){throw console.error("[ERROR] Failed to get student test results:",t),new Error(t.message||"Failed to get student test results")}},async getClassResults(t,e,r){try{return(await Sn.get(`/tests/class-results/${t}/${e}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(t,e,r){try{return(await Sn.post(`/tests/${t}/${e}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(t,e){try{return(await Sn.get(`/tests/${t}/${e}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(t,e){try{return(await Sn.delete(`/tests/${t}/${e}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(t){try{return(await Sn.post("/tests/validate",t)).data}catch(e){throw new Error(e.message||"Failed to validate test data")}},async getTestPreview(t,e){try{return(await Sn.get(`/tests/${t}/${e}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(t,e,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(e))===r.correct_answer;case"true_false":return e.toLowerCase()==="true"===r.correct_answer;case"input":return(r.correct_answers||[]).some(o=>e.toLowerCase().trim()===o.toLowerCase().trim());case"matching_type":return JSON.stringify(e)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(e)===JSON.stringify(r.correct_answer);case"drawing":return e&&e!=="No answer";default:return!1}},transformAnswersForSubmission(t,e){switch(e){case"multiple_choice":return t;case"true_false":return t;case"input":return t;case"matching_type":return t;case"word_matching":return t;case"drawing":if(Array.isArray(t)&&t.length>0)try{const r=t[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):t}catch(r){return console.warn("Failed to parse drawing answers:",r),t}return t;default:return t}},async markTestCompleted(t,e){try{console.log(`[DEBUG] markTestCompleted called with testType: ${t}, testId: ${e}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:t,test_id:e})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${t}_${e} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(t,e){try{const r=`test_progress_${t}_${e}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${t}_${e}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(t){console.log("[DEBUG] saveMultipleChoiceTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving multiple choice test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveTrueFalseTest(t){console.log("[DEBUG] saveTrueFalseTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving true/false test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveInputTest(t){console.log("[DEBUG] saveInputTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving input test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveMatchingTest(t){console.log("[DEBUG] saveMatchingTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,test_type:"matching_type",num_questions:t.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving matching test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveWordMatchingTest(t){console.log("[DEBUG] saveWordMatchingTest called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(e){return console.error("Error saving word matching test:",e),{success:!1,message:"Error saving test: "+e.message}}},async saveDrawingTest(t){console.log("[DEBUG] saveDrawingTest called with:",t);try{const e={...t,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(e){return console.error("Error saving drawing test:",e),{success:!1,message:"Error saving test: "+e.message}}},async getDrawingTest(t){console.log("[DEBUG] getDrawingTest called with testId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${t}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(e){return console.error("Error getting drawing test:",e),{success:!1,message:"Error getting test: "+e.message}}},async submitDrawingTest(t,e,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:t,answers:e,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:t,answers:e,time_taken:r,caught_cheating:(n==null?void 0:n.caught_cheating)||!1,visibility_change_times:(n==null?void 0:n.visibility_change_times)||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(t,e,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:t,score:e,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:t,score:e,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(t){console.log("[DEBUG] getWordMatchingTest called with testId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${t}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(e){return console.error("Error getting word matching test:",e),{success:!1,message:"Error getting test: "+e.message}}},async submitWordMatchingTest(t,e,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:t,answers:e,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:t,answers:e,time_taken:r,caught_cheating:(n==null?void 0:n.caught_cheating)||!1,visibility_change_times:(n==null?void 0:n.visibility_change_times)||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(t){console.log("[DEBUG] assignTestToClasses called with:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(e){return console.error("Error assigning test to classes:",e),{success:!1,message:"Error assigning test: "+e.message}}},async removeClassAssignment(t){console.log("[DEBUG] removeClassAssignment called with assignmentId:",t);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${t}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(e){return console.error("Error removing class assignment:",e),{success:!1,message:"Error removing assignment: "+e.message}}}},DM=b.createContext(),RM=({children:t})=>{const[e,r]=b.useState(null),[n,s]=b.useState([]),[a,i]=b.useState({}),[o,l]=b.useState({}),[u,d]=b.useState(!1),[g,h]=b.useState(null),[p,x]=b.useState([]),[v,w]=b.useState(!1),[S,_]=b.useState(null),[y,k]=b.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[N,E]=b.useState(null),[A,C]=b.useState(0),{getItem:F,setItem:P,removeItem:M}=jM();b.useEffect(()=>{let ye;return u&&N&&(ye=setInterval(()=>{const de=Math.floor((Date.now()-N)/1e3);C(de)},1e3)),()=>{ye&&clearInterval(ye)}},[u,N]);const I=async(ye,de)=>{try{w(!0),_(null),console.log(`[DEBUG] loadTestForPage called with testType: ${ye}, testId: ${de}`);const ee=await Ar.getTestInfo(ye,de);console.log("[DEBUG] Test info retrieved:",ee);const he=await Ar.getTestQuestions(ye,de);console.log("[DEBUG] Test questions retrieved:",he),r({...ee,testType:ye,testId:de}),s(he),d(!0),E(Date.now()),C(0),Y(ye,de),console.log("[DEBUG] Test loaded successfully")}catch(ee){_(ee.message||"Failed to load test"),console.error("Error loading test:",ee)}finally{w(!1)}},Y=(ye,de)=>{try{const ee=`test_progress_${ye}_${de}`,he=F(ee);he&&(i(he.answers||{}),l(he.progress||{}))}catch(ee){console.error("Error loading saved progress:",ee)}},se=(ye,de,ee,he)=>{var Ae,st;try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const At=`test_progress_${((st=(Ae=window.tokenManager)==null?void 0:Ae.getDecodedToken())==null?void 0:st.sub)||"unknown"}_${ye}_${de}`,yt={...a,[ee]:he},wt={...o,[ee]:{answered:!0,timestamp:Date.now()}};i(yt),l(wt),P(At,{answers:yt,progress:wt,lastSaved:Date.now()}),console.log(`Saved progress for question ${ee}:`,he)}catch(rt){console.error("Error saving test progress:",rt)}},L=(ye,de,ee)=>{var he,Ae,st;try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const At=`test_progress_${((Ae=(he=window.tokenManager)==null?void 0:he.getDecodedToken())==null?void 0:Ae.sub)||"unknown"}_${ye}_${de}`,yt=F(At);return((st=yt==null?void 0:yt.answers)==null?void 0:st[ee])||null}catch(rt){return console.error("Error getting test progress:",rt),null}},z=(ye,de)=>{var ee,he;try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${ye}, testId: ${de}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Ae=((he=(ee=window.tokenManager)==null?void 0:ee.getDecodedToken())==null?void 0:he.sub)||"unknown",st=`test_progress_${Ae}_${ye}_${de}`;console.log(`[DEBUG] Removing localStorage key: ${st}`);const rt=F(st)!==null;M(st),i({}),l({});for(let At=0;At<localStorage.length;At++){const yt=localStorage.key(At);yt&&yt.startsWith(`test_progress_${Ae}_${ye}_${de}_`)&&(localStorage.removeItem(yt),console.log(`[DEBUG] Cleared individual question key: ${yt}`))}console.log(rt?`[DEBUG] Progress cleared for test ${ye}_${de}`:`[DEBUG] No progress found to clear for test ${ye}_${de}`)}catch(Ae){console.error("Error clearing test progress:",Ae)}},G=async(ye,de,ee="")=>{try{w(!0),_(null),console.log("Submitting test:",{testType:ye,testId:de});const he=ae(ye,de);if(Object.keys(he).length===0){_("Please answer at least one question before submitting.");return}let Ae;try{Ae=await Ar.getTestInfo(ye,de)}catch(dr){console.error("Error getting test info:",dr);const zt=await Ar.getTestQuestions(ye,de);Ae={test_name:`Test ${de}`,num_questions:zt.length}}const st=await Ar.getTestQuestions(ye,de),rt=xc(st,he,ye),At=Ae.num_questions,yt=re(he,ye),wt={test_id:de,test_name:Ae.test_name,score:rt,maxScore:At,answers:yt},Jt=await Ar.submitTest(ye,de,wt);if(Jt.success){if(h(Jt.result),te(ye,de,ee),z(ye,de),ee){const dr=`student_results_table_${ee}`;console.log(" TestContext: Caching test results after submission with key:",dr),Gr(dr,Jt.result,Jr.student_results_table)}return ee&&ch(ee,ye,de),d(!1),Jt.results}else throw new Error(Jt.message||"Test submission failed")}catch(he){throw _(he.message||"Failed to submit test"),he}finally{w(!1)}},O=(ye,de,ee)=>{h({testType:ye,testId:de,answers:ee}),d(!1)},R=()=>{r(null),s([]),i({}),l({}),d(!1),h(null),_(null),E(null),C(0)},X=(ye,de,ee="")=>{try{const he=`test_completed_${ee}_${ye}_${de}`;return F(he)===!0}catch(he){return console.error("Error checking test completion:",he),!1}},te=(ye,de,ee="")=>{try{const he=`test_completed_${ee}_${ye}_${de}`;P(he,!0)}catch(he){console.error("Error marking test completed:",he)}},H=ye=>Object.keys(a).length,V=()=>{const ye=H(e==null?void 0:e.testType),de=n.length;return{canSubmit:ye===de,answeredCount:ye,totalQuestions:de}},q=()=>{e&&z(e.testType,e.testId),R()},Q=(ye="")=>{try{const de=`student_results_table_${ye}`;console.log(" TestContext: Clearing test results cache:",de),localStorage.removeItem(de),console.log(" TestContext: Test results cache cleared")}catch(de){console.error("Error clearing test results cache:",de)}},ae=(ye,de)=>({...a}),J=(ye,de,ee=null)=>{try{if(!ye)return"No answer";switch(de){case"true_false":return ye?"True":"False";case"multiple_choice":if(ee&&typeof ye=="string"&&!isNaN(parseInt(ye))){const he=parseInt(ye),Ae=`option_${String.fromCharCode(97+he)}`,st=ee[Ae];if(st)return st}return String(ye).toUpperCase();case"input":return String(ye);case"matching_type":return typeof ye=="object"?Object.entries(ye).map(([he,Ae])=>`${he}  ${Ae}`).join(", "):String(ye);case"word_matching":return typeof ye=="object"?Object.entries(ye).map(([he,Ae])=>`${he}  ${Ae}`).join(", "):String(ye);case"drawing":return"Drawing submitted";default:return String(ye)}}catch(he){return console.error("Error formatting student answer:",he),"Error displaying answer"}},re=(ye,de)=>{try{if(!ye||typeof ye!="object")return{};const ee={};return Object.entries(ye).forEach(([he,Ae])=>{if(Ae!=null)switch(de){case"true_false":ee[he]=!!Ae;break;case"multiple_choice":ee[he]=String(Ae).toUpperCase();break;case"input":ee[he]=String(Ae).trim();break;case"matching_type":typeof Ae=="object"?ee[he]=Ae:ee[he]=String(Ae);break;case"word_matching":typeof Ae=="object"?ee[he]=Ae:ee[he]=String(Ae);break;case"drawing":ee[he]=Ae;break;default:ee[he]=Ae}}),ee}catch(ee){return console.error("Error transforming answers for submission:",ee),ye||{}}},ve=b.useCallback(async(ye="")=>{try{w(!0);const de=`student_active_tests_${ye}`,ee=zr(de);if(ee)return x(ee),ee;const he=await Ar.getActiveTests();return x(he),Gr(de,he,Jr.student_active_tests),he}catch(de){return _(de.message||"Failed to load active tests"),x([]),[]}finally{w(!1)}},[]),we=async()=>{try{return w(!0),await Ar.getTeacherTests()}catch(ye){return _(ye.message||"Failed to load teacher tests"),[]}finally{w(!1)}},Fe=async ye=>{try{return w(!0),await Ar.createTest(ye)}catch(de){throw _(de.message||"Failed to create test"),de}finally{w(!1)}},ne=async(ye,de)=>{try{return w(!0),await Ar.deleteTest(ye,de)}catch(ee){throw _(ee.message||"Failed to delete test"),ee}finally{w(!1)}},Ee=async(ye,de)=>{try{return await Ar.getTestInfo(ye,de)}catch(ee){throw console.error("Error getting test info:",ee),ee}},ke=async(ye,de)=>{try{return await Ar.getTestQuestions(ye,de)}catch(ee){throw console.error("Error getting test questions:",ee),ee}},He=async(ye,de,ee)=>{try{console.log("Showing test results:",{testType:ye,testId:de,studentAnswers:ee});const he=await Ee(ye,de),Ae=await ke(ye,de);Ft(he,Ae,ye,ee),d(!1),console.log("Test results displayed successfully")}catch(he){console.error("Error showing test results:",he),_("Failed to display test results"),h({testType:ye,testId:de,answers:ee,showResults:!0,error:"Could not load detailed results"}),d(!1)}},at=async(ye,de,ee)=>{try{w(!0);const he=await Ee(ye,de),Ae=await ke(ye,de);Ft(he,Ae,ye,ee)}catch(he){_(he.message||"Failed to load test results")}finally{w(!1)}},Me=b.useCallback(async(ye="")=>{var de;try{w(!0);const ee=`student_results_table_${ye}`;console.log(" TestContext: Checking cache for key:",ee);const he=zr(ee);if(he)return console.log(" TestContext: Cache HIT! Using cached test results"),h(he),he;console.log(" TestContext: Cache MISS! Fetching from API");const Ae=await Ar.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Ae),console.log(" TestContext: Results data:",(Ae==null?void 0:Ae.results)||Ae),console.log(" TestContext: Results length:",((de=Ae==null?void 0:Ae.results)==null?void 0:de.length)||0),h(Ae),console.log(" TestContext: Caching test results with key:",ee),console.log(" TestContext: Results being cached:",Ae),console.log(" TestContext: Results.results being cached:",Ae.results),Gr(ee,Ae,Jr.student_results_table),Ae}catch(ee){throw console.error("Error loading test results:",ee),_(ee.message||"Failed to load test results"),ee}finally{w(!1)}},[]),Ft=(ye,de,ee,he)=>{try{console.log("Displaying test results:",{testInfo:ye,questions:de,testType:ee,studentAnswers:he});const Ae=xc(de,he,ee),st=(ye==null?void 0:ye.num_questions)||(de==null?void 0:de.length)||0,rt=st>0?Math.round(Ae/st*100):0,At=rt>=60,yt=de.map((wt,Jt)=>{const dr=wt.question_id||wt.id,zt=he[dr],er=eh(wt,zt,ee);return{questionNumber:Jt+1,question:wt.question||wt.question_text,userAnswer:J(zt,ee),correctAnswer:Lg(wt,ee),isCorrect:er,questionType:ee}});h({testInfo:ye,questions:de,testType:ee,studentAnswers:he,showResults:!0,score:Ae,totalQuestions:st,percentage:rt,passed:At,questionAnalysis:yt,timestamp:new Date().toISOString()}),l(wt=>({...wt,score:Ae,totalQuestions:st,percentage:rt,passed:At,lastUpdated:Date.now()})),Ut(),console.log(`Test results displayed: ${Ae}/${st} (${rt}%) - ${At?"PASSED":"FAILED"}`)}catch(Ae){console.error("Error displaying test results:",Ae),_("Failed to display test results")}},Ut=b.useCallback(()=>{try{console.log("Setting up test results page event listeners");const ye=st=>{if(st.key==="Escape"&&q(),st.ctrlKey&&st.key==="p"&&(st.preventDefault(),window.print()),st.key==="Enter"&&g&&!g.passed){const rt=document.getElementById("retake-test-button");rt&&rt.click()}},de=()=>{window.print()},ee=()=>{var st;if(g){const rt=`Test: ${((st=g.testInfo)==null?void 0:st.test_name)||"Test"}
Score: ${g.score}/${g.totalQuestions} (${g.percentage}%)
Status: ${g.passed?"PASSED":"FAILED"}
Completed: ${new Date(g.timestamp).toLocaleString()}`;navigator.clipboard.writeText(rt).then(()=>{console.log("Results copied to clipboard")}).catch(At=>{console.error("Failed to copy results:",At)})}};document.addEventListener("keydown",ye);const he=document.getElementById("print-results");he&&he.addEventListener("click",de);const Ae=document.getElementById("copy-results");return Ae&&Ae.addEventListener("click",ee),()=>{document.removeEventListener("keydown",ye),he&&he.removeEventListener("click",de),Ae&&Ae.removeEventListener("click",ee)}}catch(ye){console.error("Error setting up test results page event listeners:",ye)}},[q,g]),Pe=async(ye,de,ee)=>{try{w(!0),_(null),console.log("Viewing test details:",{testType:ye,testId:de,testName:ee}),k({isOpen:!0,testType:ye,testId:de,testName:ee,questions:[],isLoading:!0});const he=await Ar.getTestQuestions(ye,de);he&&he.length>0?(k({isOpen:!0,testType:ye,testId:de,testName:ee,questions:he,isLoading:!1}),console.log(`Test details loaded: ${he.length} questions`)):(_("Could not load test questions. Please try again."),k({isOpen:!0,testType:ye,testId:de,testName:ee,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(he){console.error("Error loading test details:",he),_("Error loading test details. Please try again."),k({isOpen:!0,testType:ye,testId:de,testName:ee,questions:[],isLoading:!1,error:he.message||"Failed to load test details"})}finally{w(!1)}},Re=(ye,de,ee,he)=>{try{console.log("Showing test details modal:",{testType:ye,testId:de,testName:ee,questions:he}),k({isOpen:!0,testType:ye,testId:de,testName:ee,questions:he||[],isLoading:!1,error:null})}catch(Ae){console.error("Error showing test details modal:",Ae),_("Failed to show test details modal")}},$e=()=>{try{console.log("Closing test details modal"),k({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(ye){console.error("Error closing test details modal:",ye)}},Be=(ye,de)=>{try{switch(de){case"multiple_choice":return c.jsxs("div",{className:"answer-options",children:[c.jsx("p",{children:c.jsx("strong",{children:"Options:"})}),c.jsxs("p",{children:["A) ",ye.option_a||"No text"]}),c.jsxs("p",{children:["B) ",ye.option_b||"No text"]}),ye.option_c&&c.jsxs("p",{children:["C) ",ye.option_c]}),ye.option_d&&c.jsxs("p",{children:["D) ",ye.option_d]}),ye.option_e&&c.jsxs("p",{children:["E) ",ye.option_e]}),ye.option_f&&c.jsxs("p",{children:["F) ",ye.option_f]}),c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",ye.correct_answer||"Not specified"]})})]});case"true_false":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",ye.correct_answer?"True":"False"]})})});case"input":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",ye.correct_answer||"Not specified"]})})});case"matching_type":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",ye.correct_answer?JSON.stringify(ye.correct_answer):"Not specified"]})})});case"word_matching":return c.jsx("div",{className:"answer-options",children:c.jsx("p",{className:"correct-answer",children:c.jsxs("strong",{children:["Correct Answer: ",ye.correct_answer?JSON.stringify(ye.correct_answer):"Not specified"]})})});default:return c.jsx("p",{children:"Unknown question type"})}}catch(ee){return console.error("Error formatting question answer display:",ee),c.jsx("p",{children:"Error displaying question"})}},Ge=(ye,de)=>{try{console.log("Navigating to test:",{testType:ye,testId:de}),r({testType:ye,testId:de}),d(!0),I(ye,de)}catch(ee){console.error("Error navigating to test:",ee),_("Failed to navigate to test")}},ht=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),l({}),d(!1),h(null),_(null)}catch(ye){console.error("Error hiding test sections:",ye)}},Nt=(ye,de,ee,he)=>{try{console.log("Displaying test on page:",{testInfo:ye,questions:de,testType:ee,testId:he}),r({...ye,testType:ee,testId:he}),s(de),d(!0),Y(ee,he),Et(ee,he),nt(ee,he)}catch(Ae){console.error("Error displaying test on page:",Ae),_("Failed to display test on page")}},Ye=(ye,de,ee)=>{try{return console.log("Rendering questions for page:",{questions:ye,testType:de,testId:ee}),!ye||!Array.isArray(ye)?(console.warn("Invalid questions array for rendering"),[]):ye.map((he,Ae)=>{const st=rt=>{const At={...a,[he.question_id]:rt};i(At),se(de,ee,he.question_id,rt)};return{question:he,index:Ae,testType:de,testId:ee,studentAnswer:a[he.question_id]||"",onAnswerChange:st}})}catch(he){return console.error("Error rendering questions for page:",he),[]}},Ve=b.useCallback((ye,de)=>{try{if(!ye||!de){console.warn("Cannot save progress: missing testType or testId");return}const ee=`test_progress_${ye}_${de}`,he={answers:a,progress:o,lastSaved:Date.now(),testType:ye,testId:de};P(ee,he),console.log(`Progress saved for test ${ye}_${de}:`,he)}catch(ee){console.error("Error saving progress for page:",ee)}},[a,o,P]),ot=b.useCallback(ye=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(ee=>ee==null?!1:typeof ee=="string"?ee.trim()!=="":typeof ee=="object"?Object.keys(ee).length>0:!0).length}catch(de){return console.error("Error getting answered questions count for page:",de),0}},[a]),et=b.useCallback((ye,de)=>{try{console.log("Updating progress display for page:",{testType:ye,testId:de});const ee=ot(ye),he=n.length,Ae=he>0?Math.round(ee/he*100):0,st=ee===he&&he>0;l(wt=>({...wt,answeredCount:ee,totalQuestions:he,percentage:Ae,canSubmit:st,remainingQuestions:he-ee,lastUpdated:Date.now()}));const rt=document.getElementById("progress-bar"),At=document.getElementById("progress-text"),yt=document.getElementById("submit-test-button");return rt&&(rt.style.width=`${Ae}%`,rt.className=rt.className.replace(/bg-\w+-\d+/,""),Ae>=100?rt.classList.add("bg-green-500"):Ae>=80?rt.classList.add("bg-blue-500"):Ae>=60?rt.classList.add("bg-yellow-500"):Ae>=40?rt.classList.add("bg-orange-500"):rt.classList.add("bg-red-500")),At&&(At.textContent=`${ee}/${he} questions answered (${Ae}%)`),yt&&(yt.disabled=!st,st?(yt.textContent=" Submit Test",yt.classList.remove("bg-gray-400"),yt.classList.add("bg-green-600","hover:bg-green-700")):(yt.textContent=` Complete ${he-ee} more question${he-ee!==1?"s":""}`,yt.classList.remove("bg-green-600","hover:bg-green-700"),yt.classList.add("bg-gray-400"))),{answeredCount:ee,totalQuestions:he,percentage:Ae,canSubmit:st}}catch(ee){return console.error("Error updating progress display for page:",ee),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,ot]),nt=b.useCallback((ye,de)=>{try{console.log("Setting up test page event listeners:",{testType:ye,testId:de});const ee=setInterval(()=>{Object.keys(a).length>0&&(Ve(ye,de),console.log("Auto-saved progress for test:",ye,de))},3e4),he=setInterval(()=>{et(ye,de)},2e3),Ae=wt=>{wt.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&q(),wt.ctrlKey&&wt.key==="s"&&(wt.preventDefault(),Ve(ye,de),console.log("Manual save triggered")),wt.key},st=wt=>{Object.keys(a).length>0&&(wt.preventDefault(),wt.returnValue="Your test progress will be saved. Are you sure you want to leave?")},rt=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),Ve(ye,de))},At=()=>{console.log("Window focused - updating progress"),et(ye,de)},yt=()=>{console.log("Window blurred - saving progress"),Ve(ye,de)};return document.addEventListener("keydown",Ae),window.addEventListener("beforeunload",st),document.addEventListener("visibilitychange",rt),window.addEventListener("focus",At),window.addEventListener("blur",yt),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${ye}_${de}`]=ee,window.testIntervals[`progress_${ye}_${de}`]=he,()=>{clearInterval(ee),clearInterval(he),document.removeEventListener("keydown",Ae),window.removeEventListener("beforeunload",st),document.removeEventListener("visibilitychange",rt),window.removeEventListener("focus",At),window.removeEventListener("blur",yt),window.testIntervals&&(delete window.testIntervals[`autosave_${ye}_${de}`],delete window.testIntervals[`progress_${ye}_${de}`])}}catch(ee){console.error("Error setting up test page event listeners:",ee)}},[a,Ve,et,q]),gt=b.useCallback(()=>{try{const ye=ot(e==null?void 0:e.testType),de=n.length,ee=ye===de&&de>0,he=document.getElementById("submit-test-button");return he&&(he.disabled=!ee,he.textContent=ee?"Submit Test":`Complete ${de-ye} more questions`),{canSubmit:ee,answeredCount:ye,totalQuestions:de}}catch(ye){return console.error("Error updating submit button state for page:",ye),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[e,n.length,ot]),Et=b.useCallback((ye,de)=>{try{console.log("Setting up progress tracking for page:",{testType:ye,testId:de});const ee=setInterval(()=>{et(ye,de),gt()},1e3),he=setInterval(()=>{Object.keys(a).length>0&&Ve(ye,de)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${ye}_${de}`]=ee,window.testIntervals[`autosave_${ye}_${de}`]=he,()=>{clearInterval(ee),clearInterval(he),window.testIntervals&&(delete window.testIntervals[`progress_${ye}_${de}`],delete window.testIntervals[`autosave_${ye}_${de}`])}}catch(ee){console.error("Error setting up progress tracking for page:",ee)}},[a,et,gt,Ve]),Ne=b.useCallback(async(ye,de)=>{const ee=document.getElementById("submit-test-button");try{const he=ot(ye),Ae=n.length;if(he<Ae){_(`Please answer all ${Ae} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;ee&&(ee.disabled=!0,ee.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await G(ye,de)&&(z(ye,de),O(ye,de,a),console.log("Test submitted successfully!"))}catch(he){console.error("Error submitting test from page:",he),_("Failed to submit test. Please try again."),ee&&(ee.disabled=!1,ee.textContent="Submit Test")}},[ot,n.length,G,z,O,a]),Ke=b.useCallback(()=>{try{if(!e)return null;const ye=["true_false","multiple_choice","input","matching_type","word_matching"];return ye.includes(e.testType)?e.testType:ye.includes(e.test_type)?e.test_type:null}catch(ye){return console.error("Error getting current test type:",ye),null}},[e]),Ze=b.useCallback((ye,de)=>{try{console.log("Clearing progress tracking interval:",{testType:ye,testId:de});const ee=`progress_interval_${ye}_${de}`,he=`autosave_interval_${ye}_${de}`;window.testIntervals&&(window.testIntervals[ee]&&(clearInterval(window.testIntervals[ee]),delete window.testIntervals[ee]),window.testIntervals[he]&&(clearInterval(window.testIntervals[he]),delete window.testIntervals[he])),console.log(`Cleared progress tracking intervals for test ${ye}_${de}`)}catch(ee){console.error("Error clearing progress tracking interval:",ee)}},[]),bt={currentTest:e,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:g,activeTests:p,isLoading:v,error:S,testDetailsModal:y,testStartTime:N,timeElapsed:A,loadTestForPage:I,submitTest:G,navigateToTestResults:O,navigateBackToCabinet:R,clearTestDataAndReturnToCabinet:q,saveTestProgress:se,getTestProgress:L,clearTestProgress:z,loadSavedProgressForPage:Y,isTestCompleted:X,markTestCompleted:te,markTestCompletedInUI:(ye,de)=>{console.log("Marking test completed in UI:",{testType:ye,testId:de}),te(ye,de)},getAnsweredQuestionsCount:H,updateSubmitButtonState:V,updateSubmitButtonStateForPage:gt,loadStudentActiveTests:ve,loadActiveTests:ve,loadTeacherActiveTests:we,getTestInfo:Ee,getTestQuestions:ke,createTest:Fe,deleteTest:ne,showTestResults:He,loadTestResults:Me,loadTestResultsForPage:at,displayTestResultsOnPage:Ft,setupTestResultsPageEventListeners:Ut,clearTestResultsCache:Q,viewTestDetails:Pe,showTestDetailsModal:Re,closeTestDetailsModal:$e,getQuestionAnswerDisplay:Be,navigateToTest:Ge,hideTestSections:ht,displayTestOnPage:Nt,renderQuestionsForPage:Ye,setupTestPageEventListeners:nt,setupProgressTrackingForPage:Et,updateProgressDisplayForPage:et,submitTestFromPage:Ne,getAnsweredQuestionsCountForPage:ot,getCurrentTestType:Ke,saveProgressForPage:Ve,clearProgressTrackingInterval:Ze,collectTestAnswers:ae,calculateTestScore:xc,checkAnswerCorrectness:eh,formatStudentAnswerForDisplay:J,getCorrectAnswer:Lg,transformAnswersForSubmission:re,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const de=Date.now()-15*24*60*60*1e3,ee=[];for(let he=0;he<localStorage.length;he++){const Ae=localStorage.key(he);if(!(!Ae||!((Ae.startsWith("test_")||Ae.startsWith("student_")||Ae.startsWith("teacher_")||Ae.startsWith("admin_")||Ae.includes("progress")||Ae.includes("answers"))&&!Ae.includes("test_completed_"))))try{const rt=localStorage.getItem(Ae);if(!rt){ee.push(Ae);continue}let At=null;if(rt.startsWith("{")||rt.startsWith("[")){const yt=JSON.parse(rt),wt=yt.timestamp||yt.lastSaved||yt.lastTickAt||yt.createdAt||yt.updatedAt||yt.startedAt||yt.started_at||yt.created_at;wt&&(At=new Date(wt).getTime())}if(!At){const yt=`${Ae}__ts`,wt=localStorage.getItem(yt);wt&&(At=parseInt(wt)||null)}if(!At)continue;At<de&&ee.push(Ae)}catch{continue}}return ee.forEach(he=>{console.log(`Removing old localStorage key: ${he}`),M(he)}),console.log(`Cleared ${ee.length} old test-related items from localStorage`),{success:!0,clearedCount:ee.length}}catch(ye){return console.error("Error clearing old test data:",ye),{success:!1,error:ye.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:l,setIsTestActive:d,setTestResults:h,setError:_};return c.jsx(DM.Provider,{value:bt,children:t})},jm=()=>{const t=b.useContext(DM);if(!t)throw new Error("useTest must be used within a TestProvider");return t},XT=({testResults:t,onBackToCabinet:e,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!t||!t.showResults)return c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsx("div",{className:"text-center",children:c.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:l,totalQuestions:u,percentage:d,passed:g,questionAnalysis:h,timestamp:p}=t,x=S=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[S]||S,v=S=>S>=80?"text-green-600 bg-green-50":S>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",w=S=>S?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):c.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:c.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[c.jsxs(Le.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[((t==null?void 0:t.caught_cheating)||s)&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",(t==null?void 0:t.visibility_change_times)||a||0," times during the test."]})})]})}),c.jsxs("div",{className:"flex justify-between items-start mb-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),c.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:(i==null?void 0:i.test_name)||"Test"}),c.jsxs("p",{className:"text-sm text-gray-500",children:[x(o),"  Completed on ",new Date(p).toLocaleDateString()]})]}),c.jsx("div",{className:"text-right",children:c.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${w(g)}`,children:g?" PASSED":" FAILED"})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:l}),c.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),c.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:c.jsx(Le.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),c.jsx("div",{className:"flex flex-wrap gap-3",children:c.jsx(Ue,{onClick:e,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&c.jsxs(Le.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:h.map((S,_)=>c.jsxs(Le.div,{className:`p-4 rounded-lg border-2 ${S.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:_*.1},children:[c.jsxs("div",{className:"flex items-start justify-between mb-3",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",S.questionNumber]}),c.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${S.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.isCorrect?" Correct":" Incorrect"})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),c.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:S.question})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),c.jsx("p",{className:`p-3 rounded ${S.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.userAnswer||"No answer provided"})]}),c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),c.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:S.correctAnswer})]})]})]},_))})]}),c.jsxs(Le.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[c.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.filter(S=>S.isCorrect).length}),c.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),c.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-red-600",children:h.filter(S=>!S.isCorrect).length}),c.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[c.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(h.filter(S=>S.isCorrect).length/u*100),"%"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),c.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),c.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},MM=({isOpen:t,onClose:e,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!t)return null;const o=g=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[g]||g,l=g=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[g]||"",u=(g,h)=>{switch(h){case"multiple_choice":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[g.option_a&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),c.jsx("span",{className:"text-gray-700",children:g.option_a})]}),g.option_b&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),c.jsx("span",{className:"text-gray-700",children:g.option_b})]}),g.option_c&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),c.jsx("span",{className:"text-gray-700",children:g.option_c})]}),g.option_d&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),c.jsx("span",{className:"text-gray-700",children:g.option_d})]}),g.option_e&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),c.jsx("span",{className:"text-gray-700",children:g.option_e})]}),g.option_f&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:g.option_f})]})]})]});case"true_false":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),c.jsx("span",{className:"text-gray-700",children:"True"})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),c.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return c.jsxs("div",{className:"space-y-2",children:[c.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),c.jsx("div",{className:"bg-gray-100 p-3 rounded",children:c.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(g,h)=>{if(!g.correct_answer)return null;let p="";switch(h){case"multiple_choice":p=g.correct_answer.toUpperCase();break;case"true_false":p=g.correct_answer?"True":"False";break;case"input":p=g.correct_answer;break;case"matching_type":p=typeof g.correct_answer=="object"?JSON.stringify(g.correct_answer):g.correct_answer;break;default:p=String(g.correct_answer)}return c.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[c.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),c.jsx("p",{className:"text-green-700 font-mono",children:p})]})};return c.jsx(Sa,{children:c.jsxs(Le.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[c.jsx(Le.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:e}),c.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:c.jsxs(Le.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[c.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("span",{className:"text-2xl",children:l(r)}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Ue,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),c.jsx(Ue,{onClick:e,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),c.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?c.jsx("div",{className:"flex items-center justify-center py-12",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),c.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):c.jsx("div",{className:"space-y-6",children:a.map((g,h)=>c.jsxs(Le.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:h*.1,duration:.3},children:[c.jsx("div",{className:"flex items-start justify-between mb-4",children:c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",h+1]}),c.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),c.jsx("div",{className:"mb-4",children:c.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:g.question||g.question_text})}),u(g,r),d(g,r)]},g.id||g.question_id||h))})}),c.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[c.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&c.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),c.jsx("div",{className:"flex items-center space-x-3",children:c.jsx(Ue,{onClick:e,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},Nre=({answeredCount:t=0,totalQuestions:e=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=e>0?Math.round(t/e*100):0,l=e-t,u=h=>{const p=Math.floor(h/3600),x=Math.floor(h%3600/60),v=h%60;return p>0?`${p}:${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${x}:${v.toString().padStart(2,"0")}`},d=h=>h>=100?"bg-green-500":h>=80?"bg-blue-500":h>=60?"bg-yellow-500":h>=40?"bg-orange-500":"bg-red-500",g=h=>h>=100?"text-green-600":h>=80?"text-blue-600":h>=60?"text-yellow-600":h>=40?"text-orange-600":"text-red-600";return c.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),c.jsx("div",{className:"flex items-center space-x-4",children:c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"text-2xl",children:""}),c.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),c.jsxs("div",{className:"mb-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),c.jsxs("span",{className:`text-sm font-semibold ${g(o)}`,children:[o,"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:c.jsx(Le.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),c.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:t}),c.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:l}),c.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),c.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:e}),c.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),c.jsx("div",{className:"mb-4",children:t===e?c.jsx(Le.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):l===1?c.jsx(Le.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:c.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):c.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:c.jsxs("span",{className:"text-gray-600 font-medium",children:[l," questions remaining"]})})}),a&&c.jsx("div",{className:"flex justify-center",children:c.jsx(Le.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),c.jsx("span",{children:"Submitting..."})]}):c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{children:""}),c.jsx("span",{children:"Submit Test"})]})})})]})},Are=({testText:t,blanks:e,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:l})=>{var z;if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",t),console.log("- blanks:",e),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!t||!e||!Array.isArray(e))return console.log(" FillBlanksTestStudent: Missing test data"),c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(it,{className:"max-w-md w-full",children:c.jsxs(it.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),c.jsx(Ue,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[u,d]=b.useState({}),[g,h]=b.useState(!1),[p,x]=b.useState(null),[v,w]=b.useState(null),[S,_]=b.useState(!1),[y,k]=b.useState(null),{showNotification:N}=qs(),{makeAuthenticatedRequest:E}=ro(),{user:A}=vn(),{startTracking:C,stopTracking:F,getCheatingData:P,clearData:M}=Am("fill_blanks",n,(A==null?void 0:A.student_id)||(A==null?void 0:A.id));Lv();const I=b.useCallback((G,O)=>{try{let R=G;if(typeof G=="string"&&G.startsWith("{"))try{const V=JSON.parse(G);V.root&&V.root.children&&(R=V.root.children.map(q=>q.children?q.children.map(Q=>Q.style&&Q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":Q.text||"").join(""):"").join(" "))}catch(V){console.error("Error parsing Lexical JSON:",V)}let X=R;O.forEach((V,q)=>{const Q=`[${q+1}_________]`;X=X.replace("[BLANK_PLACEHOLDER]",Q)});const H=X.split(/(\[\d+_________\])/).map((V,q)=>V.match(/\[\d+_________\]/)?c.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:V},q):c.jsx("span",{children:V},q));return c.jsx("div",{className:"prose max-w-none mb-6",children:c.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:H})})}catch(R){return console.error("Error rendering text with blanks:",R),c.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),Y=b.useCallback((G,O)=>{try{let R=G;if(typeof G=="string"&&G.startsWith("{"))try{const V=JSON.parse(G);V.root&&V.root.children&&(R=V.root.children.map(q=>q.children?q.children.map(Q=>Q.style&&Q.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":Q.text||"").join(""):"").join(" "))}catch(V){console.error("Error parsing Lexical JSON:",V)}const X=[];O.forEach((V,q)=>{const Q=u[V.id],ae=Q?V.options[Q.charCodeAt(0)-65]:null,J=ae?c.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(V.id),children:ae},q):c.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(V.id),children:[q+1,"_________"]},q);X.push(J),R=R.replace("[BLANK_PLACEHOLDER]",`__BLANK_${V.id}__`)});const te=R.split(/__BLANK_\d+__/),H=[];for(let V=0;V<te.length;V++)te[V]&&H.push(c.jsx("span",{children:te[V]},`text-${V}`)),V<X.length&&H.push(X[V]);return c.jsx("div",{className:"prose max-w-none mb-6",children:c.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:H})})}catch(R){return console.error("Error rendering text with inline blanks:",R),c.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[u]),se=b.useCallback((G,O)=>{const R={...u,[G]:O};d(R),l&&l(G,O)},[u,l]),L=b.useCallback(G=>c.jsx("div",{className:"space-y-6",children:G.map((O,R)=>{const X=O.blank_options||O.options||[];O.correct_answers;const te=O.question_json||O.question||`Blank ${R+1}`;return console.log(` Blank ${R+1} question text:`,te),c.jsxs(it,{className:"p-4",children:[c.jsxs("div",{className:"mb-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",R+1]}),c.jsx("p",{className:"text-gray-600 mb-4",children:te})]}),c.jsx("div",{className:"space-y-3",children:X.filter(H=>H&&H.trim().length>0).map((H,V)=>c.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[c.jsx("input",{type:"radio",name:`blank_${O.question_id||O.id||R}`,value:String.fromCharCode(65+V),checked:u[O.question_id||O.id||R]===String.fromCharCode(65+V),onChange:q=>se(O.question_id||O.id||R,q.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),c.jsxs("span",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+V)}),c.jsx("span",{className:"text-gray-700",children:H})]})]},V))})]},O.question_id||O.id||R)})}),[u,se]);return b.useEffect(()=>{if(n&&(A!=null&&A.student_id)){x(new Date),C(),console.log(" Anti-cheating tracking started for fill blanks test");const O=`test_progress_${A.student_id}_fill_blanks_${n}`,R=zr(O);R&&(d(R.answers||{}),x(new Date(R.startTime)),console.log(" Fill blanks test progress restored:",R))}},[n,A==null?void 0:A.student_id,e,C]),b.useEffect(()=>{if(p&&(A!=null&&A.student_id)&&n){const G=setInterval(()=>{const O={answers:u,startTime:p.toISOString()},R=`test_progress_${A.student_id}_fill_blanks_${n}`;Gr(R,O,Jr.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(G)}},[p,u,A==null?void 0:A.student_id,n]),b.useEffect(()=>()=>{F(),M(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[F,M]),b.useCallback(async()=>{h(!0);try{const G=e.length;let O=0;e.forEach((Fe,ne)=>{const Ee=u[Fe.id];Ee&&Ee===Fe.correct_answer&&O++});const R=O,X=G;console.log(` Fill Blanks Score: ${R}/${X} (${Math.round(R/X*100)}%)`);const te=new Date,H=p?Math.round((te-p)/1e3):0,V=p?p.toISOString():te.toISOString(),q=P();console.log(" Anti-cheating data for fill blanks submission:",q);const Q=A.student_id,ae=`retest_assignment_id_${Q}_fill_blanks_${n}`,J=localStorage.getItem(ae),re={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:Q,parent_test_id:n,retest_assignment_id:J?Number(J):null,answers:u,score:R,maxScore:X,time_taken:H,started_at:V,submitted_at:te.toISOString(),caught_cheating:q.caught_cheating,visibility_change_times:q.visibility_change_times};console.log(" Submitting fill blanks test:",re);const we=await(await E("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(re)})).json();if(we.success){if(N("Test submitted successfully!","success"),F(),M(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),A!=null&&A.student_id&&(ch(A.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),A!=null&&A.student_id){const Fe=`test_completed_${A.student_id}_fill_blanks_${n}`;localStorage.setItem(Fe,"true"),console.log(" Fill blanks test marked as completed in localStorage:",Fe);const ne=`retest1_${Q}_fill_blanks_${n}`;localStorage.removeItem(ne),localStorage.removeItem(ae)}if(A!=null&&A.student_id){const Fe=`student_results_table_${A.student_id}`;Gr(Fe,we,Jr.student_results_table),console.log(" Fill blanks test results cached with key:",Fe)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(R)},2e3)}else throw new Error(we.message||"Failed to submit test")}catch(G){console.error("Error submitting test:",G),N("Error submitting test. Please try again.","error")}finally{h(!1)}},[u,e,n,s,a,i,p,P,F,M,E,N,o,A]),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:c.jsxs(it,{children:[g&&c.jsx(it.Header,{children:c.jsx("div",{className:"flex items-center justify-center",children:c.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[c.jsx(ir,{size:"small"}),c.jsx("span",{children:"Submitting..."})]})})}),c.jsx(it.Body,{children:r===!0?c.jsxs(c.Fragment,{children:[I(t,e),L(e)]}):c.jsx(c.Fragment,{children:Y(t,e)})}),r===!1&&v&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),c.jsx("div",{className:"space-y-2",children:(z=e.find(G=>G.id===v))==null?void 0:z.options.filter(G=>G.trim().length>0).map((G,O)=>c.jsxs("button",{onClick:()=>{se(v,String.fromCharCode(65+O)),w(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[c.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+O),")"]}),G]},O))}),c.jsx("div",{className:"mt-4 flex justify-end",children:c.jsx(Ue,{onClick:()=>w(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),c.jsx(it.Footer,{children:c.jsx("div",{className:"flex gap-3"})})]})})};let jre=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setToken(e){localStorage.setItem(this.tokenKey,e)}setRefreshToken(e){localStorage.setItem(this.refreshTokenKey,e)}setUserData(e){localStorage.setItem(this.userKey,JSON.stringify(e))}setTokens(e,r){this.setToken(e),this.setUserData({role:r}),localStorage.setItem("accessToken",e)}isAuthenticated(){const e=this.getToken();if(!e)return!1;try{const r=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const e=this.getUserData();return e?e.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const e=this.getToken();return e?`Bearer ${e}`:null}async makeAuthenticatedRequest(e,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(e,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(e,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const e=this.getRefreshToken();if(!e)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},50*60*1e3)}};const th=new jre;window.tokenManager=th;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{th.init()}):th.init());const IM=async(t,e,r,n,s)=>{var a;try{console.log(" Fetching teacher student results:",{teacherId:t,grade:e,className:r,semester:n,academicPeriodId:s});const o=await(await th.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${t}&grade=${e}&class=${r}&semester=${n}&academic_period_id=${s}`)).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",((a=o.students)==null?void 0:a.length)||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(i){return console.error("Error fetching teacher student results:",i),{success:!1,error:i.message,results:[]}}},OM=async(t,e)=>{try{console.log(" Fetching student results view:",{studentId:t,academicPeriodId:e});const r=e?`&academic_period_id=${e}`:"",s=await(await th.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${t}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},Fre=async(t,e,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:t,grade:e,className:r,academicPeriodId:n});const a=await(await th.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${t}&grade=${e}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},Pre=async(t,e,r,n,s,a={})=>{try{const i=await IM(t,e,r,n,s);if(!i.success)return i;let o=i.results;return a.subject&&(o=o.filter(l=>l.subject&&l.subject.toLowerCase().includes(a.subject.toLowerCase()))),a.testType&&(o=o.filter(l=>l.test_type===a.testType)),a.minScore!==void 0&&(o=o.filter(l=>l.score/l.max_score*100>=a.minScore)),a.maxScore!==void 0&&(o=o.filter(l=>l.score/l.max_score*100<=a.maxScore)),a.passed!==void 0&&(o=o.filter(l=>l.score>=l.passing_score===a.passed)),{success:!0,results:o,count:o.length,originalCount:i.results.length}}catch(i){return console.error("Error filtering teacher student results:",i),{success:!1,error:i.message,results:[]}}},Dre=async(t,e,r={})=>{try{const n=await OM(t,e);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},Rre={getTeacherStudentResults:IM,getStudentResultsView:OM,getClassSummary:Fre,getTeacherStudentResultsFiltered:Pre,getStudentResultsViewFiltered:Dre};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mre=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ire=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,n)=>n?n.toUpperCase():r.toLowerCase()),c8=t=>{const e=Ire(t);return e.charAt(0).toUpperCase()+e.slice(1)},LM=(...t)=>t.filter((e,r,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===r).join(" ").trim(),Ore=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bre=b.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},l)=>b.createElement("svg",{ref:l,...Lre,width:e,height:e,stroke:t,strokeWidth:n?Number(r)*24/Number(e):r,className:LM("lucide",s),...!a&&!Ore(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>b.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jh=(t,e)=>{const r=b.forwardRef(({className:n,...s},a)=>b.createElement(Bre,{ref:a,iconNode:e,className:LM(`lucide-${Mre(c8(t))}`,`lucide-${t}`,n),...s}));return r.displayName=c8(t),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ure=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],$re=jh("download",Ure);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wre=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Hre=jh("maximize-2",Wre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zre=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Gre=jh("rotate-cw",zre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vre=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],BM=jh("x",Vre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kre=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Xre=jh("zoom-in",Kre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yre=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Jre=jh("zoom-out",Yre),Mi={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},UM={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},iu={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},u8={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},d8={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},K1={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},$M=t=>{try{const e=JSON.stringify(t);return new Blob([e]).size/1024}catch(e){return console.warn("Error calculating memory usage:",e),0}},Qre=t=>Array.isArray(t)?t.map(e=>Array.isArray(e)?qre(e):e):t,qre=t=>{if(t.length<=2)return t;const e=[t[0]],r=2;for(let n=1;n<t.length-1;n++){const s=t[n-1],a=t[n];t[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&e.push(a)}return e.push(t[t.length-1]),e},Zre=(t,e=Date.now())=>{const r=$M(t);return{data:[...t],timestamp:e,memoryUsage:r,compressed:r>K1.COMPRESSION_THRESHOLD}},f8=(t,e,r)=>{const n=Zre(e),s=$M(e),a=t.slice(0,r+1);a.push(n);let i=a;return s>K1.MAX_MEMORY_KB&&(i=ene(a)),i.length>K1.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},ene=t=>t.map(e=>e.memoryUsage>K1.COMPRESSION_THRESHOLD?{...e,data:Qre(e.data),compressed:!0}:e),h8=(t,e)=>{if(e<0||e>=t.length)return[];const r=t[e];return r?r.compressed?tne(r.data):[...r.data]:[]},tne=t=>[...t],g8=t=>t>0,m8=(t,e)=>t<e-1,rne=()=>({history:[],index:-1}),nne=()=>{const[t,e]=b.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=b.useState([]),[s,a]=b.useState([]),i=b.useCallback(N=>{e(E=>({...E,...N}))},[]),o=b.useCallback(()=>{e({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),l=b.useCallback(N=>{const E={x:N.x,y:N.y,color:t.currentColor,thickness:t.currentThickness};t.currentTool==="pencil"?e(A=>({...A,isDrawing:!0,currentLine:[E]})):["line","rectangle","circle"].includes(t.currentTool)&&e(A=>({...A,isDrawing:!0,currentShape:{type:t.currentTool,startX:N.x,startY:N.y,endX:N.x,endY:N.y,color:t.currentColor,thickness:t.currentThickness}}))},[t.currentTool,t.currentColor,t.currentThickness]),u=b.useCallback(N=>{if(!t.isDrawing)return;const E={x:N.x,y:N.y,color:t.currentColor,thickness:t.currentThickness};t.currentTool==="pencil"?e(A=>({...A,currentLine:[...A.currentLine,E]})):t.currentShape&&e(A=>({...A,currentShape:{...A.currentShape,endX:N.x,endY:N.y}}))},[t.isDrawing,t.currentTool,t.currentColor,t.currentThickness,t.currentShape]),d=b.useCallback(()=>{if(!t.isDrawing)return;let N=r;if(t.currentTool==="pencil"&&t.currentLine.length>0?(N=[...r,t.currentLine],n(N)):t.currentShape&&(N=[...r,t.currentShape],n(N)),N!==r){const E=f8(t.drawingHistory,N,t.historyIndex);e(A=>({...A,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:E.history,historyIndex:E.index}))}else e(E=>({...E,isDrawing:!1,currentLine:[],currentShape:null}))},[t.isDrawing,t.currentTool,t.currentLine,t.currentShape,r,t.drawingHistory,t.historyIndex]),g=b.useCallback(N=>Math.round(N*d8.ERASER_TO_THICKNESS_RATIO),[]),h=b.useCallback(N=>Math.round(N*d8.THICKNESS_TO_ERASER_RATIO),[]),p=b.useCallback(N=>{e(E=>({...E,currentThickness:N,eraserSize:g(N)}))},[g]),x=b.useCallback(N=>{e(E=>({...E,eraserSize:N,currentThickness:h(N)}))},[h]),v=b.useCallback(N=>{const E=f8(t.drawingHistory,N,t.historyIndex);e(A=>({...A,drawingHistory:E.history,historyIndex:E.index}))},[t.drawingHistory,t.historyIndex]),w=b.useCallback(()=>{if(g8(t.historyIndex)){const N=t.historyIndex-1,E=h8(t.drawingHistory,N);n([...E]),e(A=>({...A,historyIndex:N}))}},[t.historyIndex,t.drawingHistory]),S=b.useCallback(()=>{if(m8(t.historyIndex,t.drawingHistory.length)){const N=t.historyIndex+1,E=h8(t.drawingHistory,N);n([...E]),e(A=>({...A,historyIndex:N}))}},[t.historyIndex,t.drawingHistory]),_=b.useCallback(()=>{const N=rne();e(E=>({...E,drawingHistory:N.history,historyIndex:N.index}))},[]),y=g8(t.historyIndex),k=m8(t.historyIndex,t.drawingHistory.length);return{drawingState:t,setDrawingState:e,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:l,continueDrawing:u,finishDrawing:d,handleThicknessChange:p,handleEraserSizeChange:x,saveToHistoryState:v,undo:w,redo:S,clearHistoryState:_,canUndoState:y,canRedoState:k}},p8={SCALE_DELTA:.05,CENTER_DELTA:20},yf=t=>{if(t.length<2)return 0;const e=t[0],r=t[1];return Math.sqrt(Math.pow(r.clientX-e.clientX,2)+Math.pow(r.clientY-e.clientY,2))},Xl=t=>{if(t.length<2)return null;const e=t[0],r=t[1];return{x:(e.clientX+r.clientX)/2,y:(e.clientY+r.clientY)/2}},sne=(t,e)=>{if(t.length!==2||!e)return null;const r=yf(t),n=yf(e),s=Xl(t),a=Xl(e);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>p8.SCALE_DELTA?"zoom":o>p8.CENTER_DELTA?"pan":null},ane=t=>{let e;return function(){const r=arguments,n=this;e&&cancelAnimationFrame(e),e=requestAnimationFrame(()=>{t.apply(n,r),e=null})}},Jd=(t,e)=>{const r=e.getPointerPosition();return{x:(r.x-e.x())/e.scaleX(),y:(r.y-e.y())/e.scaleY()}},oi={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},X1={color:"#000000",thickness:2},x8=(t,e,r)=>({x:t.x,y:t.y,color:e||X1.color,thickness:r||X1.thickness}),ine=(t,e,r,n,s)=>({type:t,startX:e.x,startY:e.y,endX:r.x,endY:r.y,color:n||X1.color,thickness:s||X1.thickness}),WM=(t,e,r,n,s,a)=>{const i=t-r,o=e-n,l=s-r,u=a-n,d=i*l+o*u,g=l*l+u*u;let h=-1;g!==0&&(h=d/g);let p,x;h<0?(p=r,x=n):h>1?(p=s,x=a):(p=r+h*l,x=n+h*u);const v=t-p,w=e-x;return Math.sqrt(v*v+w*w)},one=(t,e)=>{if(e.length===0)return[t];const r=e.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(t.slice(s,a.index+1)),s=a.index+1;return s<t.length&&n.push(t.slice(s)),n.filter(a=>a.length>0)},lne=(t,e,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],l=n[i+1],u=WM(t,e,o.x,o.y,l.x,l.y);u<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:u})}return s},cne=(t,e,r,n)=>{const s=lne(e,r,n,t);return s.length===0?[t]:one(t,s)},une=(t,e,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return t>=s&&t<=s+i&&e>=a&&e<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(t-s,2)+Math.pow(e-a,2))<=i}return!1},y8=(t,e,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=cne(a,t,e,r);s.push(...i)}else a.type==="line"?WM(t,e,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(une(t,e,r,a)||s.push(a));return s},dne=(t,e,r,n,s,a,i,o,l)=>{const[u,d]=b.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),g=b.useCallback(E=>{if(t.currentTool===oi.PAN)return;const A=E.target.getStage(),C=Jd(E,A),F=x8(C,t.currentColor,t.currentThickness);t.currentTool===oi.PENCIL?e(P=>({...P,isDrawing:!0,currentLine:[F]})):[oi.LINE,oi.RECTANGLE,oi.CIRCLE].includes(t.currentTool)&&e(P=>({...P,isDrawing:!0,currentShape:ine(t.currentTool,C,C,t.currentColor,t.currentThickness)}))},[t.currentTool,t.currentColor,t.currentThickness,e]),h=b.useCallback(E=>{const A=y8(E.x,E.y,t.eraserSize,r);n(A),s(A)},[t.eraserSize,r,n,s]),p=b.useCallback(E=>{o&&(a(),v("Undo",E))},[o,a]),x=b.useCallback(E=>{l&&(i(),v("Redo",E))},[l,i]),v=b.useCallback((E,A)=>{const C=A.target.getStage(),F=Jd(A,C),P=new Konva.Circle({x:F.x,y:F.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});C.add(P),P.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{P.destroy()}})},[]),w=b.useCallback(E=>{if(!t.isDrawing)return;const A=E.target.getStage(),C=Jd(E,A),F=x8(C,t.currentColor,t.currentThickness);t.currentTool===oi.PENCIL?e(P=>({...P,currentLine:[...P.currentLine,F]})):t.currentShape&&e(P=>({...P,currentShape:{...P.currentShape,endX:C.x,endY:C.y}}))},[t.isDrawing,t.currentTool,t.currentColor,t.currentThickness,t.currentShape,e]),S=b.useCallback(()=>{t.isDrawing&&(t.currentTool===oi.PENCIL&&t.currentLine.length>0?n(E=>[...E,t.currentLine]):t.currentShape&&n(E=>[...E,t.currentShape]),e(E=>({...E,isDrawing:!1,currentLine:[],currentShape:null})))},[t.isDrawing,t.currentTool,t.currentLine,t.currentShape,n,e]),_=b.useCallback(E=>{E.evt.preventDefault(),E.evt.stopPropagation();const A=E.evt.touches;if(A.length===2)d({isActive:!0,type:"pan",lastDistance:yf(A),lastCenter:Xl(A)});else if(A.length===1)if(t.currentTool===oi.ERASER){const C=E.target.getStage(),F=Jd(E,C);h(F)}else t.currentTool===oi.UNDO?p(E):t.currentTool===oi.REDO?x(E):g(E)},[yf,Xl,g,t.currentTool,h,p,x]),y=b.useCallback(ane(E=>{E.evt.preventDefault(),E.evt.stopPropagation();const A=E.evt.touches;if(A.length===2&&u.isActive){const C=sne(A,u);if(C==="zoom"){const F=yf(A),P=Xl(A),M=F/u.lastDistance,I=Math.max(.25,Math.min(1,t.zoom*M));e(Y=>({...Y,zoom:I,position:{x:P.x-(P.x-Y.position.x)*(I/Y.zoom),y:P.y-(P.y-Y.position.y)*(I/Y.zoom)}}))}else if(C==="pan"){const F=Xl(A),P=F.x-u.lastCenter.x,M=F.y-u.lastCenter.y;e(I=>({...I,position:{x:I.position.x+P,y:I.position.y+M}}))}d(F=>({...F,lastDistance:yf(A),lastCenter:Xl(A)}))}else if(A.length===1)if(t.currentTool===oi.ERASER){const C=E.target.getStage(),F=Jd(E,C),P=y8(F.x,F.y,t.eraserSize,r);n(P)}else if(t.currentTool===oi.PAN){const C=Xl(A),F=C.x-u.lastCenter.x,P=C.y-u.lastCenter.y;e(M=>({...M,position:{x:M.position.x+F,y:M.position.y+P}})),d(M=>({...M,lastCenter:C}))}else w(E)}),[u,t.zoom,e,w]),k=b.useCallback(E=>{y(E)},[y]),N=b.useCallback(E=>{E.evt.preventDefault(),E.evt.stopPropagation();const A=E.evt.touches;A.length===0?(S(),d({isActive:!1,type:null,lastDistance:null,lastCenter:null})):A.length===1&&d(C=>({...C,isActive:!1}))},[S]);return{handleTouchStart:_,handleTouchMove:k,handleTouchEnd:N,handleEraserStart:h,handleUndoTouch:p,handleRedoTouch:x,showTouchFeedback:v}},fne=(t,e)=>{const[r,n]=b.useState(t.MIN),[s,a]=b.useState({x:0,y:0}),i=b.useCallback((h,p,x)=>{const v=Math.max(t.MIN,Math.min(t.MAX,h));if(p){const w=v/r,S={x:p.x-(p.x-s.x)*w,y:p.y-(p.y-s.y)*w};return{zoom:v,position:S}}else{const w=e.width*v,S=e.height*v,_={x:(x.width-w)/2,y:(x.height-S)/2};return{zoom:v,position:_}}},[r,s,t,e]),o=b.useCallback(()=>{const h=Math.min(r*(1+t.STEP),t.MAX);n(h)},[r,t]),l=b.useCallback(()=>{const h=Math.max(r/(1+t.STEP),t.MIN);n(h)},[r,t]),u=b.useCallback((h,p,x)=>{const v=i(h,p,x);n(v.zoom),a(v.position)},[i]),d=b.useCallback((h,p)=>{a(x=>({x:x.x+h,y:x.y+p}))},[]),g=b.useCallback(()=>{n(t.INITIAL),a({x:0,y:0})},[t.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:l,handleZoomToPoint:u,handlePan:d,resetZoom:g}},hne=t=>{const[e,r]=b.useState([]),[n,s]=b.useState(0),a=b.useCallback(g=>{if(console.log("parseDrawingData - input drawing:",g),console.log("parseDrawingData - drawing.answers:",g==null?void 0:g.answers),!(g!=null&&g.answers))return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof g.answers=="string"){console.log("parseDrawingData - parsing string answers");const h=JSON.parse(g.answers);return console.log("parseDrawingData - parsed string result:",h),h&&typeof h=="object"&&h.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),h}if(g.answers&&typeof g.answers=="object"&&g.answers.lines)return console.log("parseDrawingData - answers is new format object"),g.answers;if(Array.isArray(g.answers)){if(console.log("parseDrawingData - answers is array"),g.answers.every(p=>typeof p=="string"))try{const p=g.answers.map(x=>{try{return JSON.parse(x)}catch{return x}});return console.log("parseDrawingData - parsed array elements"),p}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),g.answers}return g.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(h){return console.error("Error parsing drawing data:",h),[]}},[]),i=b.useCallback(g=>{var p,x;if(console.log("processQuestions - input answers:",g),console.log("processQuestions - answers type:",typeof g),console.log("processQuestions - answers isArray:",Array.isArray(g)),g&&typeof g=="object"&&g.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",(p=g.lines)==null?void 0:p.length),console.log("processQuestions - textBoxes count:",(x=g.textBoxes)==null?void 0:x.length);const v=o(g.lines);return console.log("processQuestions - canvas groups:",v),console.log("processQuestions - number of canvas groups:",v.length),v.map((w,S)=>(console.log(`processQuestions - canvas ${S} strokes:`,w),console.log(`processQuestions - canvas ${S} stroke count:`,w.length),{questionNumber:S+1,drawingData:w,textBoxes:g.textBoxes||[]}))}if(Array.isArray(g)&&g.every(v=>v&&typeof v=="object"&&v.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),g.map((v,w)=>({questionNumber:w+1,drawingData:v.lines||[],textBoxes:v.textBoxes||[]}));if(!Array.isArray(g))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",g.length,"answers (old format)");const h=o(g);return console.log("processQuestions - canvas groups:",h),console.log("processQuestions - number of canvas groups:",h.length),h.map((v,w)=>(console.log(`processQuestions - canvas ${w} strokes:`,v),console.log(`processQuestions - canvas ${w} stroke count:`,v.length),{questionNumber:w+1,drawingData:v,textBoxes:[]}))},[]),o=b.useCallback(g=>{console.log("groupStrokesByCanvas - input answers:",g);const h=l(g);return console.log("groupStrokesByCanvas - using strategy:",h),h==="by_question_boundary"?u(g):h==="by_stroke_type"?d(g):[g]},[]),l=b.useCallback(g=>{console.log("determineGroupingStrategy - analyzing answers:",g);let h=0,p=0;return g.forEach(x=>{Array.isArray(x)?h++:typeof x=="object"&&p++}),console.log("determineGroupingStrategy - arrayCount:",h,"objectCount:",p),h>0&&p>0?"by_stroke_type":g.length>3?"by_question_boundary":"single_canvas"},[]),u=b.useCallback(g=>{console.log("groupByQuestionBoundary - grouping answers:",g);const h=[];let p=[];const x=Math.ceil(g.length/2);for(let v=0;v<g.length;v++)p.push(g[v]),(v+1)%x===0&&v<g.length-1&&(h.push([...p]),p=[]);return p.length>0&&h.push(p),console.log("groupByQuestionBoundary - result:",h),h},[]),d=b.useCallback(g=>{console.log("groupByStrokeType - grouping answers:",g);const h=[],p=[];g.forEach(v=>{Array.isArray(v)?h.push(v):typeof v=="object"&&p.push(v)});const x=[];return h.length>0&&x.push(h),p.length>0&&x.push(p),console.log("groupByStrokeType - result:",x),x},[]);return b.useEffect(()=>{var g,h,p,x;if(t){console.log("useDataParsing - drawing object:",t),console.log("useDataParsing - drawing.answers:",t.answers),console.log("useDataParsing - drawing.answers type:",typeof t.answers),console.log("useDataParsing - drawing.answers length:",(g=t.answers)==null?void 0:g.length);const v=a(t);console.log("useDataParsing - parsed answers:",v),console.log("useDataParsing - parsed answers type:",typeof v),console.log("useDataParsing - parsed answers length:",v==null?void 0:v.length);const w=i(v);console.log("useDataParsing - processed questions:",w),console.log("useDataParsing - processed questions length:",w==null?void 0:w.length),w.length>0&&(console.log("useDataParsing - first question drawingData:",(h=w[0])==null?void 0:h.drawingData),console.log("useDataParsing - first question drawingData length:",(x=(p=w[0])==null?void 0:p.drawingData)==null?void 0:x.length)),r(w),s(0)}},[t,a,i]),{questionsData:e,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},v8={MIN:.25,INITIAL:1},gne=(t,e)=>{const[r,n]=b.useState(!1),[s,a]=b.useState(null),i=b.useCallback(()=>{document.fullscreenElement||(a({zoom:t.zoom,position:{...t.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),e(l=>({...l,zoom:v8.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(l=>{console.error("Error entering fullscreen:",l)}))},[t.zoom,t.position,e]),o=b.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(e(l=>({...l,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):e(l=>({...l,zoom:v8.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(l=>{console.error("Error exiting fullscreen:",l)})},[s,e]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},HM=b.forwardRef(({drawingData:t,textBoxes:e=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:l,mousePosition:u,isMouseOverCanvas:d,isEraserDrawing:g},h)=>{const p=b.useRef(null),[x,v]=b.useState(.25),[w,S]=b.useState(null),[_,y]=b.useState({x:0,y:0}),[k,N]=b.useState(!1),E=b.useCallback(({x:X,y:te,size:H,visible:V,isDrawing:q})=>!V||!X||!te?null:c.jsx(hc,{x:X,y:te,radius:H/2,stroke:u8.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:q?.8:u8.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),A=b.useCallback(X=>{if(r.currentTool===iu.ERASER){const te=X.target.getStage(),H=Jd(X,te);y(H)}},[r.currentTool]),C=b.useCallback(()=>{r.currentTool===iu.ERASER&&N(!0)},[r.currentTool]),F=b.useCallback(()=>{N(!1)},[]);b.useEffect(()=>{const X=h.current;if(X)return X.on("mousemove",A),X.on("mouseenter",C),X.on("mouseleave",F),()=>{X.off("mousemove",A),X.off("mouseenter",C),X.off("mouseleave",F)}},[A,C,F,h]),b.useEffect(()=>{const X=n.width??n.WIDTH,te=n.height??n.HEIGHT,H=()=>{const V=p.current;if(!V)return;const q=V.clientWidth||1,Q=V.clientHeight||1,ae=Math.abs(r.rotation%180)===90,J=ae?te:X,re=ae?X:te,ve=Math.min(q/(J||1),Q/(re||1));v(Math.min(ve,1))};return H(),window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const P=b.useMemo(()=>{const X=p.current;if(!X||!w)return 0;const te=X.clientWidth||1,H=X.clientHeight||1,V=Math.min(te/Math.max(w.width,1),H/Math.max(w.height,1));return Math.min(V,UM.MAX)},[w]),M=b.useMemo(()=>Math.max(s,x||1),[s,x]),I=b.useMemo(()=>{const X=n.width??n.WIDTH,te=n.height??n.HEIGHT;if(!p.current)return{x:0,y:0};const H=p.current.clientWidth||1,V=p.current.clientHeight||1,q=(H-X*M)/2,Q=(V-te*M)/2;return s<=x?{x:q,y:Q}:{x:a.x!==void 0?a.x:q,y:a.y!==void 0?a.y:Q}},[a,s,x,M,n.width,n.height,w,P]);b.useEffect(()=>{if(!Array.isArray(t)||t.length===0){S(null);return}let X=1/0,te=1/0,H=-1/0,V=-1/0;const q=(re,ve)=>{Number.isFinite(re)&&Number.isFinite(ve)&&(re<X&&(X=re),ve<te&&(te=ve),re>H&&(H=re),ve>V&&(V=ve))};if(t.forEach(re=>{if(Array.isArray(re))re.forEach(ve=>q(ve.x,ve.y));else if(re&&typeof re=="object"){if(re.type==="line")q(re.startX,re.startY),q(re.endX,re.endY);else if(re.type==="rectangle")q(re.startX,re.startY),q(re.endX,re.endY);else if(re.type==="circle"){const ve=Math.sqrt(Math.pow(re.endX-re.startX,2)+Math.pow(re.endY-re.startY,2))/2,we=(re.startX+re.endX)/2,Fe=(re.startY+re.endY)/2;q(we-ve,Fe-ve),q(we+ve,Fe+ve)}}}),!Number.isFinite(X)||!Number.isFinite(te)||!Number.isFinite(H)||!Number.isFinite(V)){S(null);return}const Q=16,ae=Math.max(1,H-X+Q*2),J=Math.max(1,V-te+Q*2);S({minX:X-Q,minY:te-Q,width:ae,height:J})},[t]),b.useEffect(()=>{console.log("CanvasViewer - drawingData:",t),console.log("CanvasViewer - drawingData length:",t==null?void 0:t.length),console.log("CanvasViewer - textBoxes:",e),console.log("CanvasViewer - textBoxes length:",e==null?void 0:e.length),t&&t.length>0&&console.log("CanvasViewer - first item:",t[0]),e&&e.length>0&&console.log("CanvasViewer - first textBox:",e[0])},[t,e]),b.useEffect(()=>{const X=n.width??n.WIDTH,te=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:X,height:te}),console.log("CanvasViewer - zoom:",s,"fitZoom:",x,"displayScale:",M),console.log("CanvasViewer - stagePosition:",I)},[n,s,x,M,I]);const Y=(X,te)=>{var H,V;if(console.log(`CanvasViewer - rendering element ${te}:`,X),Array.isArray(X))return console.log(`CanvasViewer - rendering line with ${X.length} points`),c.jsx(Ss,{points:X.flatMap(q=>[q.x,q.y]),stroke:((H=X[0])==null?void 0:H.color)||"#000000",strokeWidth:((V=X[0])==null?void 0:V.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round"},te);if(X.type==="line")return c.jsx(Ss,{points:[X.startX,X.startY,X.endX,X.endY],stroke:X.color,strokeWidth:X.thickness,lineCap:"round"},te);if(X.type==="rectangle"){const q=Math.abs(X.endX-X.startX),Q=Math.abs(X.endY-X.startY),ae=Math.min(X.startX,X.endX),J=Math.min(X.startY,X.endY);return c.jsx(ms,{x:ae,y:J,width:q,height:Q,stroke:X.color,strokeWidth:X.thickness,fill:"transparent"},te)}else if(X.type==="circle"){const q=Math.sqrt(Math.pow(X.endX-X.startX,2)+Math.pow(X.endY-X.startY,2))/2,Q=(X.startX+X.endX)/2,ae=(X.startY+X.endY)/2;return c.jsx(hc,{x:Q,y:ae,radius:q,stroke:X.color,strokeWidth:X.thickness,fill:"transparent"},te)}return null},se=()=>{if(!r.isDrawing)return null;if(r.currentTool===iu.PENCIL&&r.currentLine.length>0)return c.jsx(Ss,{points:r.currentLine.flatMap(X=>[X.x,X.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:X,startX:te,startY:H,endX:V,endY:q,color:Q,thickness:ae}=r.currentShape;if(X===iu.LINE)return c.jsx(Ss,{points:[te,H,V,q],stroke:Q,strokeWidth:ae,lineCap:"round"});if(X===iu.RECTANGLE){const J=Math.abs(V-te),re=Math.abs(q-H),ve=Math.min(te,V),we=Math.min(H,q);return c.jsx(ms,{x:ve,y:we,width:J,height:re,stroke:Q,strokeWidth:ae,fill:"transparent"})}else if(X===iu.CIRCLE){const J=Math.sqrt(Math.pow(V-te,2)+Math.pow(q-H,2))/2,re=(te+V)/2,ve=(H+q)/2;return c.jsx(hc,{x:re,y:ve,radius:J,stroke:Q,strokeWidth:ae,fill:"transparent"})}}return null},L=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},z={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},G=b.useCallback(X=>{X.preventDefault(),X.stopPropagation()},[]),O=b.useCallback(X=>{X.preventDefault(),X.stopPropagation()},[]),R=b.useCallback(X=>{X.preventDefault(),X.stopPropagation()},[]);return c.jsx("div",{style:{...L,touchAction:"none",WebkitTouchCallout:"none"},ref:p,className:"select-none",onTouchStart:G,onTouchMove:O,onTouchEnd:R,children:c.jsx("div",{style:{...z,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:G,onTouchMove:O,onTouchEnd:R,children:c.jsx(Bu,{ref:h,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:M,scaleY:M,x:I.x,y:I.y,onTouchStart:i,onTouchMove:o,onTouchEnd:l,children:c.jsxs(Lu,{children:[c.jsx(ms,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),t.map((X,te)=>(console.log(`CanvasViewer - mapping item ${te}:`,X),Y(X,te))),e&&e.map((X,te)=>c.jsx(ms,{x:X.x,y:X.y,width:X.width,height:X.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${te}`)),e&&e.map((X,te)=>c.jsx(ko,{x:X.x+8,y:X.y+8,width:X.width-16,height:X.height-16,text:X.text,fontSize:X.fontSize||14,fill:X.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${te}`)),se(),r.currentTool===iu.ERASER&&c.jsx(E,{x:_.x,y:_.y,size:r.eraserSize,visible:k,isDrawing:g})]})})})})});HM.displayName="CanvasViewer";function mne({containerRef:t,canvasSize:e,rotation:r=0}){const[n,s]=b.useState(1),[a,i]=b.useState({x:0,y:0}),o=b.useRef({width:1,height:1}),l=b.useRef(.01),u=b.useRef(0),d=b.useRef(!1),g=b.useCallback(()=>{const k=(e==null?void 0:e.width)??(e==null?void 0:e.WIDTH)??0,N=(e==null?void 0:e.height)??(e==null?void 0:e.HEIGHT)??0,E=Math.abs(r%180)===90;return{width:E?N:k,height:E?k:N}},[e,r]),h=b.useCallback(()=>{const k=t==null?void 0:t.current;if(!k)return{width:1,height:1};const N=k.clientWidth||1,E=k.clientHeight||1;return o.current={width:N,height:E},{width:N,height:E}},[t]),p=b.useCallback(()=>{const{width:k,height:N}=o.current,{width:E,height:A}=g(),C=k/Math.max(E,1),F=N/Math.max(A,1);return Math.min(C,F,1)*.98},[g]),x=b.useCallback(k=>{const{width:N,height:E}=o.current,{width:A,height:C}=g(),F=Math.max(l.current,Math.min(k,1.5));let P=(N-A*F)/2,M=(E-C*F)/2;const I=N-A*F,Y=E-C*F;P=Math.min(Math.max(0,P),Math.max(0,I)),M=Math.min(Math.max(0,M),Math.max(0,Y));try{console.log("[Camera] centerAtScale",{targetScale:k,clampedScale:F,container:{containerW:N,containerH:E},canvas:{canvasW:A,canvasH:C},translate:{x:P,y:M},rotation:r})}catch{}i({x:P,y:M}),s(F)},[g]),v=b.useCallback(()=>{const{width:k,height:N}=h(),{width:E,height:A}=g(),C=p();let F=(k-E*C)/2,P=(N-A*C)/2;const M=k-E*C,I=N-A*C;F=Math.min(Math.max(0,F),Math.max(0,M)),P=Math.min(Math.max(0,P),Math.max(0,I));try{console.log("[Camera] fitCanvas",{scale:C,container:{containerW:k,containerH:N},canvas:{canvasW:E,canvasH:A},translate:{x:F,y:P},rotation:r})}catch{}s(C),i({x:F,y:P}),l.current=C,d.current=!1},[g,h,p]),w=b.useCallback(()=>{const{width:k,height:N}=h(),{width:E,height:A}=g(),C=(k-E)/2,F=(N-A)/2;s(1),i({x:C,y:F})},[g,h]),S=b.useCallback((k,N)=>{const{width:E,height:A}=o.current,{width:C,height:F}=g(),P=Math.max(l.current,Math.min(k,1.5));if(N&&Number.isFinite(N.x)&&Number.isFinite(N.y)){const M={x:(N.x-a.x)/n,y:(N.y-a.y)/n},I=N.x-M.x*P,Y=N.y-M.y*P;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:P})}catch{}s(P),i({x:I,y:Y}),u.current=Date.now()+400,d.current=!0}else{let M=(E-C*P)/2,I=(A-F*P)/2;const Y=E-C*P,se=A-F*P;M=Math.min(Math.max(0,M),Math.max(0,Y)),I=Math.min(Math.max(0,I),Math.max(0,se));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:P})}catch{}s(P),i({x:M,y:I}),u.current=Date.now()+400,d.current=!0}},[g,n,a]),_=b.useCallback((k,N)=>{const E=n*k,{width:A,height:C}=o.current,F={x:A/2,y:C/2};S(E,N||F)},[n,S]),y=b.useCallback((k,N)=>{i(E=>({x:E.x+k,y:E.y+N})),u.current=Date.now()+200,d.current=!0},[]);return b.useEffect(()=>{const k=t==null?void 0:t.current;if(!k)return;const N=new ResizeObserver(()=>{h();const E=p();if(l.current=E,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}x(n)}});return N.observe(k),h(),()=>N.disconnect()},[t,h,p,x,n]),b.useEffect(()=>{d.current=!1,l.current=p(),x(n)},[r,e==null?void 0:e.width,e==null?void 0:e.height,e==null?void 0:e.WIDTH,e==null?void 0:e.HEIGHT,p,x,n]),b.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:x,fitCanvas:v,oneToOne:w,zoomTo:S,zoomByFactor:_,panBy:y}),[n,a,x,v,w,S,_,y])}const p0=new Map,zM=b.forwardRef(({drawingData:t,textBoxes:e=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer"},i)=>{const o=b.useRef(null),l=b.useRef(null),u=mne({containerRef:o,canvasSize:r,rotation:n}),[d,g]=b.useState({width:1,height:1}),h=b.useRef(null),p=b.useRef(null),[x,v]=b.useState(null);b.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",t),console.log("[ViewerCanvas] drawingData length:",t==null?void 0:t.length),t&&t.length>0&&console.log("[ViewerCanvas] First drawing element:",t[0]),console.log("[ViewerCanvas] textBoxes:",e),console.log("[ViewerCanvas] textBoxes length:",e==null?void 0:e.length)},[t]),b.useEffect(()=>{typeof s=="function"&&s(u.scale);try{console.log("[ViewerCanvas] scale changed",{scale:u.scale})}catch{}if(a){const L=p0.get(a)||{};p0.set(a,{...L,scale:u.scale})}},[u.scale,s]),b.useEffect(()=>{if(a){const L=p0.get(a)||{};p0.set(a,{...L,translate:{x:u.translate.x,y:u.translate.y}})}},[a,u.translate.x,u.translate.y]),b.useImperativeHandle(i,()=>({zoomIn:L=>u.zoomByFactor(1.1,L),zoomOut:L=>u.zoomByFactor(1/1.1,L),fitCanvas:()=>u.fitCanvas(),oneToOne:()=>u.oneToOne(),getScale:()=>u.scale,getStage:()=>l.current,getPointerPosition:()=>{var L,z;return(z=(L=l.current)==null?void 0:L.getPointerPosition)==null?void 0:z.call(L)},exportPNGFullCanvas:()=>{const L=l.current;if(!L)return null;const z=(r==null?void 0:r.width)??(r==null?void 0:r.WIDTH)??1536,G=(r==null?void 0:r.height)??(r==null?void 0:r.HEIGHT)??2048,O={scaleX:L.scaleX(),scaleY:L.scaleY(),x:L.x(),y:L.y(),width:L.width(),height:L.height()},R=h.current,X=p.current,te=R?{x:R.x(),y:R.y(),scaleX:R.scaleX(),scaleY:R.scaleY()}:null,H=X?{x:X.x(),y:X.y(),rotation:X.rotation()}:null;try{return L.scale({x:1,y:1}),L.position({x:0,y:0}),L.size({width:z,height:G}),R&&(R.position({x:0,y:0}),R.scale({x:1,y:1})),X&&(X.position({x:0,y:0}),X.rotation(0)),L.batchDraw(),L.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:z,height:G})}finally{X&&H&&(X.position({x:H.x,y:H.y}),X.rotation(H.rotation)),R&&te&&(R.position({x:te.x,y:te.y}),R.scale({x:te.scaleX,y:te.scaleY})),L.scale({x:O.scaleX,y:O.scaleY}),L.position({x:O.x,y:O.y}),L.size({width:O.width,height:O.height}),L.batchDraw()}}}),[u]),b.useEffect(()=>{const L=o.current;if(!L)return;const z=()=>{g({width:L.clientWidth||1,height:L.clientHeight||1})};z();const G=new ResizeObserver(z);return G.observe(L),()=>G.disconnect()},[]),b.useEffect(()=>{if(!Array.isArray(t)||t.length===0){v(null);return}let L=1/0,z=1/0,G=-1/0,O=-1/0;const R=(V,q)=>{Number.isFinite(V)&&Number.isFinite(q)&&(V<L&&(L=V),q<z&&(z=q),V>G&&(G=V),q>O&&(O=q))};if(t.forEach(V=>{if(Array.isArray(V))V.forEach(q=>R(q.x,q.y));else if(V&&typeof V=="object"){if(V.type==="line")R(V.startX,V.startY),R(V.endX,V.endY);else if(V.type==="rectangle")R(V.startX,V.startY),R(V.endX,V.endY);else if(V.type==="circle"){const q=Math.hypot(V.endX-V.startX,V.endY-V.startY)/2,Q=(V.startX+V.endX)/2,ae=(V.startY+V.endY)/2;R(Q-q,ae-q),R(Q+q,ae+q)}}}),!Number.isFinite(L)||!Number.isFinite(z)||!Number.isFinite(G)||!Number.isFinite(O)){v(null);return}const X=16,te=Math.max(1,G-L+X*2),H=Math.max(1,O-z+X*2);v({minX:L-X,minY:z-X,width:te,height:H,centerX:L-X+te/2,centerY:z-X+H/2})},[t]);const w=b.useMemo(()=>{if(!x)return{scale:1,x:0,y:0};const L=(r==null?void 0:r.width)??(r==null?void 0:r.WIDTH)??1536,z=(r==null?void 0:r.height)??(r==null?void 0:r.HEIGHT)??2048,G=Math.min(L/Math.max(1,x.width),z/Math.max(1,x.height),1),O=x.width*G,R=x.height*G,X=(L-O)/2,te=(z-R)/2,H=X-x.minX*G,V=te-x.minY*G;return{scale:G,x:H,y:V}},[x,r==null?void 0:r.width,r==null?void 0:r.height,r==null?void 0:r.WIDTH,r==null?void 0:r.HEIGHT]),S=b.useRef(!1);b.useEffect(()=>{if(S.current)return;const L=a?p0.get(a):null;L&&Number.isFinite(L.scale)&&L.translate&&Number.isFinite(L.translate.x)&&Number.isFinite(L.translate.y)?(u.setScale(L.scale),u.setTranslate(L.translate)):u.fitCanvas(),S.current=!0},[a,u]),b.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:u.scale,translate:u.translate})}catch{}u.fitCanvas()},[n]),b.useEffect(()=>{u.centerAtScale(u.scale)},[n]);const _=L=>{L.evt.preventDefault();const z=l.current;if(!z)return;const G=z.getPointerPosition(),O=Math.pow(1.0015,-L.evt.deltaY);u.zoomByFactor(O,G)},y=b.useRef(!1),k=b.useRef({x:0,y:0}),N=()=>{const L=o.current;if(!L)return 1;const z=L.clientWidth||1,G=L.clientHeight||1,O=(r==null?void 0:r.width)??(r==null?void 0:r.WIDTH)??1,R=(r==null?void 0:r.height)??(r==null?void 0:r.HEIGHT)??1,X=Math.abs(n%180)===90,te=X?R:O,H=X?O:R,V=Math.min(z/te,G/H);return Math.min(V,1)},E=L=>{const z=N();u.scale<=z||(y.current=!0,k.current={x:L.evt.clientX,y:L.evt.clientY})},A=L=>{if(!y.current)return;const z=L.evt.clientX-k.current.x,G=L.evt.clientY-k.current.y;k.current={x:L.evt.clientX,y:L.evt.clientY},u.panBy(z,G)},C=()=>{y.current=!1},F=1536,P=2048,M=(L,z)=>{var G,O;if(console.log(`[ViewerCanvas] Rendering drawing element ${z}:`,L),Array.isArray(L))return console.log(`[ViewerCanvas] Array item with ${L.length} points:`,L.slice(0,3)),c.jsx(Ss,{points:L.flatMap(R=>[R.x,R.y]),stroke:((G=L[0])==null?void 0:G.color)||"#000000",strokeWidth:((O=L[0])==null?void 0:O.thickness)||2,tension:.5,lineCap:"round",lineJoin:"round"},z);if((L==null?void 0:L.type)==="line")return c.jsx(Ss,{points:[L.startX,L.startY,L.endX,L.endY],stroke:L.color,strokeWidth:L.thickness,lineCap:"round"},z);if((L==null?void 0:L.type)==="rectangle"){const R=Math.abs(L.endX-L.startX),X=Math.abs(L.endY-L.startY),te=Math.min(L.startX,L.endX),H=Math.min(L.startY,L.endY);return c.jsx(ms,{x:te,y:H,width:R,height:X,stroke:L.color,strokeWidth:L.thickness,fill:"transparent"},z)}else if((L==null?void 0:L.type)==="circle"){const R=Math.sqrt(Math.pow(L.endX-L.startX,2)+Math.pow(L.endY-L.startY,2))/2,X=(L.startX+L.endX)/2,te=(L.startY+L.endY)/2;return c.jsx(hc,{x:X,y:te,radius:R,stroke:L.color,strokeWidth:L.thickness,fill:"transparent"},z)}return null},I=b.useCallback(L=>{L.preventDefault(),L.stopPropagation()},[]),Y=b.useCallback(L=>{L.preventDefault(),L.stopPropagation()},[]),se=b.useCallback(L=>{L.preventDefault(),L.stopPropagation()},[]);return c.jsx("div",{ref:o,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:I,onTouchMove:Y,onTouchEnd:se,children:c.jsx(Bu,{ref:l,width:d.width,height:d.height,onWheel:_,onMouseDown:E,onMouseMove:A,onMouseUp:C,onMouseLeave:C,children:c.jsx(Lu,{children:c.jsx(zi,{ref:h,x:u.translate.x,y:u.translate.y,scaleX:u.scale,scaleY:u.scale,children:(()=>{const L=(n%360+360)%360;let z=0,G=0;L===90?z=P:L===180?(z=F,G=P):L===270&&(G=F);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:L,tx:z,ty:G,canvasW:F,canvasH:P})}catch{}return c.jsxs(zi,{ref:p,x:z,y:G,rotation:n,children:[c.jsx(ms,{x:0,y:0,width:F,height:P,fill:"white"}),c.jsxs(zi,{x:w.x,y:w.y,scaleX:w.scale,scaleY:w.scale,children:[Array.isArray(t)?(console.log("[ViewerCanvas] Rendering",t.length,"drawing elements"),t.map((O,R)=>M(O,R))):null,Array.isArray(e)&&e.map((O,R)=>c.jsxs(zi,{x:O.x,y:O.y,listening:!1,children:[c.jsx(ms,{width:O.width,height:O.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),c.jsx(ko,{text:O.text,x:8,y:8,width:Math.max(0,(O.width||0)-16),height:Math.max(0,(O.height||0)-16),fontSize:O.fontSize||14,fill:O.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${R}`))]})]})})()})})})})});zM.displayName="ViewerCanvas";const pne=({zoom:t,onZoomIn:e,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>c.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[c.jsx(Ue,{onClick:e,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:c.jsx(Xre,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Ue,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:c.jsx(Jre,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Ue,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:c.jsx(Gre,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Ue,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:c.jsx($re,{className:"w-4 h-4 mx-auto my-auto"})}),c.jsx(Ue,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?c.jsx(BM,{className:"w-4 h-4 mx-auto my-auto"}):c.jsx(Hre,{className:"w-4 h-4 mx-auto my-auto"})})]}),xne=({currentQuestion:t,totalQuestions:e,onPrevious:r,onNext:n,drawingDataLength:s})=>e<=1?null:c.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx(Ue,{onClick:r,disabled:t===0,variant:"outline",size:"sm",children:"Previous"}),c.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",t+1," of ",e]}),c.jsx(Ue,{onClick:n,disabled:t===e-1,variant:"outline",size:"sm",children:"Next"})]}),c.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),GM=({drawing:t,isOpen:e,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1})=>{var re,ve;const{drawingState:i,setDrawingState:o,drawingData:l,setDrawingData:u,textBoxes:d,setTextBoxes:g,saveToHistoryState:h,undo:p,redo:x,canUndoState:v,canRedoState:w}=nne(),{questionsData:S,currentQuestionIndex:_,setCurrentQuestionIndex:y}=hne(t),{zoom:k,position:N,handleZoomIn:E,handleZoomOut:A}=fne(UM,Mi),{isFullscreen:C,enterFullscreen:F,exitFullscreen:P}=gne(i,o),{handleTouchStart:M,handleTouchMove:I,handleTouchEnd:Y}=dne(i,o,l,u,h,p,x,v,w),se=b.useRef(null),L=b.useRef(null),[z,G]=b.useState(1),[O,R]=b.useState(""),[X,te]=b.useState("");b.useEffect(()=>{var we,Fe;if(console.log("DrawingModal - questionsData:",S),console.log("DrawingModal - currentQuestionIndex:",_),S.length>0){const ne=((we=S[_])==null?void 0:we.drawingData)||[],Ee=((Fe=S[_])==null?void 0:Fe.textBoxes)||[];console.log("DrawingModal - setting drawingData:",ne),console.log("DrawingModal - setting textBoxes:",Ee),u(ne),g(Ee)}},[S,_,u,g]),b.useEffect(()=>{var we,Fe;e&&t&&(R(((we=t.score)==null?void 0:we.toString())||""),te(((Fe=t.max_score)==null?void 0:Fe.toString())||"100"))},[e,t]);const H=()=>{_>0&&y(_-1)},V=()=>{_<S.length-1&&y(_+1)},q=()=>{v&&p()},Q=()=>{w&&x()};b.useEffect(()=>{const we=Fe=>{(Fe.ctrlKey||Fe.metaKey)&&(Fe.key==="z"&&!Fe.shiftKey?(Fe.preventDefault(),q()):(Fe.key==="y"||Fe.key==="z"&&Fe.shiftKey)&&(Fe.preventDefault(),Q()))};return document.addEventListener("keydown",we),()=>document.removeEventListener("keydown",we)},[q,Q]);const ae=()=>{o(we=>({...we,rotation:(we.rotation+90)%360}))},J=()=>{if(a&&L.current){const Ee=L.current.exportPNGFullCanvas();if(!Ee)return;const ke=document.createElement("a");ke.href=Ee,ke.download=`drawing-${(t==null?void 0:t.name)||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(ke),ke.click(),document.body.removeChild(ke);return}const we=se.current;if(!we)return;const Fe=we.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Mi.WIDTH,height:Mi.HEIGHT}),ne=document.createElement("a");ne.href=Fe,ne.download=`drawing-${(t==null?void 0:t.name)||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(ne),ne.click(),document.body.removeChild(ne)};return!e||!t?null:c.jsx(Sa,{children:c.jsx(Le.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:c.jsxs(Le.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:we=>we.stopPropagation(),onTouchStart:we=>we.preventDefault(),onTouchMove:we=>we.preventDefault(),onTouchEnd:we=>we.preventDefault(),children:[c.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),c.jsxs("p",{className:"text-sm text-gray-600",children:[t.name," ",t.surname," - ",t.test_name]})]}),c.jsx(Ue,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:c.jsx(BM,{className:"w-5 h-5"})})]}),S.length>1&&c.jsx(xne,{currentQuestion:_,totalQuestions:S.length,onPrevious:H,onNext:V,drawingDataLength:((ve=(re=S[_])==null?void 0:re.drawingData)==null?void 0:ve.length)||0}),c.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[c.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?c.jsx(zM,{ref:L,drawingData:l,textBoxes:d,canvasSize:{width:Mi.WIDTH,height:Mi.HEIGHT,WIDTH:Mi.WIDTH,HEIGHT:Mi.HEIGHT},rotation:i.rotation,onScaleChange:G}):c.jsx(HM,{ref:se,drawingData:l,textBoxes:d,drawingState:i,canvasSize:{width:Mi.WIDTH,height:Mi.HEIGHT,WIDTH:Mi.WIDTH,HEIGHT:Mi.HEIGHT},zoom:k,position:N,onTouchStart:M,onTouchMove:I,onTouchEnd:Y,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),c.jsx(pne,{zoom:a?z:k,onZoomIn:()=>{var we,Fe;if(a&&L.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:(Fe=(we=L.current).getScale)==null?void 0:Fe.call(we)})}catch{}L.current.zoomIn(void 0),setTimeout(()=>{var ne,Ee;try{console.log("[ZoomButton] ZoomIn after",{after:(Ee=(ne=L.current).getScale)==null?void 0:Ee.call(ne)})}catch{}},0)}else E()},onZoomOut:()=>{var we,Fe;if(a&&L.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:(Fe=(we=L.current).getScale)==null?void 0:Fe.call(we)})}catch{}L.current.zoomOut(void 0),setTimeout(()=>{var ne,Ee;try{console.log("[ZoomButton] ZoomOut after",{after:(Ee=(ne=L.current).getScale)==null?void 0:Ee.call(ne)})}catch{}},0)}else A()},onRotate:ae,onDownload:J,onFullscreen:C?P:F,isFullscreen:C}),c.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?z:k)*100),"%"]})]}),!1]})]})})})},VM=({testType:t,testId:e,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const l=Xa(),{user:u,isAuthenticated:d}=vn(),{testResults:g,loadTestResults:h}=jm(),[p,x]=b.useState(!0),[v,w]=b.useState(""),[S,_]=b.useState([]),[y,k]=b.useState([]),[N,E]=b.useState(null),[A,C]=b.useState([]),[F,P]=b.useState(0),[M,I]=b.useState(0),[Y,se]=b.useState(!1),[L,z]=b.useState(null);b.useEffect(()=>{G()},[t,e]),b.useEffect(()=>{!t&&!e&&(g&&g.results?(console.log(" Using cached test results from TestContext"),k(g.results),x(!1)):R())},[t,e,g]);const G=b.useCallback(async()=>{console.log(" Initializing Student Results...");try{if(x(!0),w(""),!d||!u){console.log(" User not authenticated"),w("User not authenticated");return}if(u.role!==aa.STUDENT){console.error(" Invalid user role for student results:",u.role),w("Access denied. Student role required.");return}console.log(" Loading test results..."),await h((u==null?void 0:u.student_id)||(u==null?void 0:u.id)||""),t&&e&&r&&(console.log(" Loading specific test results..."),await O(t,e,r)),console.log(" Student Results initialization complete!")}catch(ae){console.error(" Error initializing student results:",ae),w("Failed to initialize student results")}finally{x(!1)}},[d,u,t,e,r,h]),O=b.useCallback(async(ae,J,re)=>{console.log(" Loading specific test results:",ae,J);try{const ve=await Ar.getTestInfo(ae,J);console.log(" Test info loaded:",ve),E(ve);const we=await Ar.getTestQuestions(ae,J);console.log(" Test questions loaded:",we),C(we);const Fe=xc(we,re,ae).score,ne=we.length>0?Math.round(Fe/we.length*100):0;P(Fe),I(ne),console.log(" Test results calculated:",{score:Fe,percentage:ne})}catch(ve){throw console.error(" Error loading specific test results:",ve),ve}},[]),R=b.useCallback(async(ae=0)=>{console.log(" Loading all student results using existing test results API...",ae>0?`(retry ${ae})`:"");try{if(!((u==null?void 0:u.student_id)||(u==null?void 0:u.sub)))throw new Error("Student ID not found");const re=await Ar.getStudentTestResults();if(re.success){console.log(" All student results loaded:",re.results.length,"results");const ve=re.results.map(we=>({...we,caught_cheating:we.caught_cheating||!1,visibility_change_times:we.visibility_change_times||0}));k(ve),z(new Date),re.results.length===0&&ae===0&&(console.log(" No results found, retrying in 2 seconds..."),setTimeout(()=>{R(1)},2e3))}else throw new Error(re.error||"Failed to load student results")}catch(J){console.error(" Error loading all student results:",J),w(J.message)}},[u]),X=b.useCallback(ae=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[ae]||ae,[]),te=b.useCallback(ae=>{if(!ae||ae.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No results available"})});const J=a?ae:ae.slice(0,o);return c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),c.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:J.map((re,ve)=>c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:c.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:X(re.subject)})}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:re.teacher_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:re.test_name}),c.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:c.jsx("div",{className:"flex flex-col items-center space-y-1",children:re.test_type==="drawing"?re.score!==null?c.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(re.score/re.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(re.score/re.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[re.score,"/",re.max_score," (",Math.round(re.score/re.max_score*100),"%)"]}):c.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):c.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(re.score/re.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(re.score/re.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[re.score,"/",re.max_score," (",Math.round(re.score/re.max_score*100),"%)"]})})}),c.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(re.submitted_at).toLocaleDateString()})]},ve))})]}),ae.length>o&&i&&c.jsx("div",{className:"text-center pt-4",children:c.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${ae.length-o} More`})})]})},[X,a,o,i]),H=b.useCallback((ae,J)=>{if(console.log(" formatAnswer called with:",{answer:ae,testType:J,answerType:typeof ae}),!ae)return"No answer";switch(J){case"true_false":const re=typeof ae=="boolean"?ae:ae==="true";return console.log(" Boolean answer processed:",re),re?"True":"False";case"multiple_choice":return ae.toUpperCase();case"input":return ae;case"word_matching":return typeof ae=="object"?Object.entries(ae).map(([ve,we])=>`${ve}  ${we}`).join(", "):ae;case"drawing":return"Drawing submitted";default:return ae}},[]),V=b.useCallback(()=>!N||!A||!r?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",N.test_name||N.title||"Test"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-blue-600",children:F}),c.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-3xl font-bold text-gray-900",children:A.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:`text-3xl font-bold ${M>=80?"text-green-600":M>=60?"text-yellow-600":"text-red-600"}`,children:[M,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),c.jsx("div",{className:"space-y-4",children:A.map((ae,J)=>{const re=r[J],ve=Lg(ae,t),we=eh(ae,re,t);return c.jsxs("div",{className:`border rounded-lg p-4 ${we?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[c.jsxs("div",{className:"flex justify-between items-start mb-2",children:[c.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",J+1]}),c.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${we?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:we?"Correct":"Incorrect"})]}),c.jsx("p",{className:"text-gray-700 mb-3",children:ae.question}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:H(re,t)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),c.jsx("p",{className:"text-sm text-gray-900",children:H(ve,t)})]})]})]},J)})})]})]}),[N,A,r,t,F,M,Lg,eh,H]),q=b.useCallback(()=>{if(!y||y.length===0)return c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const ae={};return y.forEach(J=>{const re=J.subject||"Unknown Subject";ae[re]||(ae[re]=[]),ae[re].push(J)}),c.jsx("div",{className:"space-y-6",children:Object.entries(ae).map(([J,re])=>c.jsxs("div",{className:"bg-white rounded-lg shadow",children:[c.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:J})}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),c.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:re.map((ve,we)=>{const Fe=Math.round(ve.score/ve.max_score*100),ne=Fe>=80?"text-green-600":Fe>=60?"text-yellow-600":"text-red-600";return c.jsxs("tr",{className:"hover:bg-gray-50",children:[c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ve.test_name}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ve.teacher_name||"Unknown"}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:c.jsxs("span",{className:ne,children:[ve.score,"/",ve.max_score," (",Fe,"%)"]})}),c.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ve.submitted_at).toLocaleDateString()})]},we)})})]})})]},J))})},[y]);b.useCallback(()=>{console.log(" Clearing test data and returning to cabinet..."),E(null),C([]),setStudentAnswers(null),P(0),I(0),se(!1),n?n():l("/student")},[n,l]);const Q=b.useCallback(()=>{console.log(" Navigating back to cabinet..."),n?n():l("/student")},[n,l]);return b.useCallback((ae,J)=>{const re={id:Date.now(),message:ae,type:J,timestamp:new Date};_(ve=>[...ve,re]),setTimeout(()=>{_(ve=>ve.filter(we=>we.id!==re.id))},ba.NOTIFICATION_DURATION)},[]),p?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:v}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{children:[p?c.jsxs("div",{className:"text-center py-8",children:[c.jsx(ir,{size:"md"}),c.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-red-600",children:v})]}):te(y),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:S.map(ae=>c.jsx(eo,{type:ae.type,message:ae.message,onClose:()=>_(J=>J.filter(re=>re.id!==ae.id))},ae.id))})]}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",L?L.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[N&&c.jsx(Ue,{variant:"outline",onClick:()=>se(!Y),children:Y?"Hide Details":"Show Details"}),c.jsx(Ue,{variant:"outline",onClick:Q,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Y&&N?V():q()}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:S.map(ae=>c.jsx(eo,{type:ae.type,message:ae.message,onClose:()=>_(J=>J.filter(re=>re.id!==ae.id))},ae.id))}),selectedDrawing&&c.jsx(GM,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},yne=({isMenuOpen:t,onToggleMenu:e,onShowPasswordChange:r})=>{var Ee;const n=Xa(),{user:s,isAuthenticated:a,logout:i}=vn(),{studentData:o,loadStudentData:l}=Bv(),{activeTests:u,testResults:d,loadActiveTests:g,loadTestResults:h,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=jm(),[w,S]=b.useState(!0),[_,y]=b.useState(""),[k,N]=b.useState([]),[E,A]=b.useState(null),[C,F]=b.useState(!1),[P,M]=b.useState(null),[I,Y]=b.useState(null),[se,L]=b.useState(new Set),[z,G]=b.useState(!1),[O,R]=b.useState(!1),[X,te]=b.useState(!1),[H,V]=b.useState(!1);b.useEffect(()=>{q()},[]),b.useEffect(()=>()=>{te(!1)},[]),b.useEffect(()=>{if(X){const ke=setTimeout(()=>{te(!1)},1e3);return()=>clearTimeout(ke)}},[X]);const q=b.useCallback(async()=>{console.log(" Initializing Student Cabinet...");try{if(S(!0),y(""),!a||!s){console.log(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==aa.STUDENT){console.error(" Invalid user role for student cabinet:",s.role),y("Access denied. Student role required.");return}console.log(" Loading student data..."),await l(),console.log(" Loading active tests...");try{localStorage.removeItem("student_active_tests_")}catch{}await g(),console.log(" Loading test results..."),await h((s==null?void 0:s.student_id)||(s==null?void 0:s.id)||""),console.log(" Calculating average score..."),await Q(),console.log(" Student Cabinet initialization complete!")}catch(ke){console.error(" Error initializing student cabinet:",ke),y("Failed to initialize student cabinet")}finally{S(!1)}},[a,s,n]),Q=b.useCallback(async()=>{console.log(" Calculating average score...");try{if(d&&d.length>0){const ke=d.reduce((at,Me)=>typeof Me.score=="number"&&typeof Me.max_score=="number"&&Me.max_score>0?at+Math.round(Me.score/Me.max_score*100):at,0),He=Math.round(ke/d.length);Y(He),console.log(" Average score calculated:",He)}}catch(ke){console.error(" Error calculating average score:",ke)}},[d]);b.useEffect(()=>{if(X){console.log(" Skipping completed tests initialization during navigation");return}const ke=(s==null?void 0:s.student_id)||(s==null?void 0:s.id);if(!ke){console.log(" Student ID not available yet, skipping localStorage initialization");return}const He=new Set;for(let at=0;at<localStorage.length;at++){const Me=localStorage.key(at);if(Me&&Me.startsWith(`test_completed_${ke}_`)&&localStorage.getItem(Me)==="true"){const Ut=Me.replace(`test_completed_${ke}_`,"").split("_");if(Ut.length>=2){const Pe=Ut[0],Re=Ut.slice(1).join("_"),$e=`${Pe}_${Re}`;He.add($e),console.log(" Found completed test in localStorage:",$e)}}}L(He),V(!0),console.log(" Initialized completed tests from localStorage:",Array.from(He))},[s==null?void 0:s.student_id,s==null?void 0:s.id,X]),b.useEffect(()=>{console.log(" testResults structure:",d);const ke=(d==null?void 0:d.results)||d;if(console.log(" resultsArray:",ke),ke&&ke.length>0){const He=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"",at=new Set;ke.forEach(Me=>{const Ft=`${Me.test_type}_${Me.test_id}`;at.add(Ft),localStorage.setItem(`test_completed_${He}_${Me.test_type}_${Me.test_id}`,"true")}),L(Me=>{const Ft=new Set([...Me,...at]);return console.log(" Updated completed tests (merged):",Array.from(Ft)),Ft})}},[d,s==null?void 0:s.student_id,s==null?void 0:s.id]);const ae=b.useCallback(async(ke,He,at=!1,Me=null)=>{console.log(" Checking test completion:",ke,He,"retestAvailable:",at);try{const Ft=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"";if(at){console.log(" Retest available from backend, checking attempt limits.");const $e=[];for(let ht=1;ht<=10;ht++){const Nt=`retest_attempt${ht}_${Ft}_${ke}_${He}`;localStorage.getItem(Nt)==="true"&&$e.push(Nt)}const Be=$e.length,Ge=(Me==null?void 0:Me.retest_attempts_left)||(Me==null?void 0:Me.max_attempts)||3;return console.log(" Current attempts:",Be,"Max attempts:",Ge,"Attempt keys:",$e),Be>=Ge?(console.log(" Maximum retest attempts reached in localStorage"),!0):(console.log(" Retest attempts available, allowing start."),!1)}const Ut=`test_completed_${Ft}_${ke}_${He}`,Pe=localStorage.getItem(Ut);if(console.log(" localStorage key:",Ut),console.log(" localStorage value:",Pe),ke==="word_matching"){console.log(" Debug: All localStorage keys for student",Ft);for(let $e=0;$e<localStorage.length;$e++){const Be=localStorage.key($e);Be&&Be.includes(Ft)&&Be.includes("word_matching")&&console.log(" Found word_matching key:",Be,"=",localStorage.getItem(Be))}}if(Pe==="true")return console.log(" Found completion status in local storage:",Pe),!0;const Re=(d==null?void 0:d.results)||d;return Re&&Re.length>0&&(console.log(" Checking database results:",Re.length,"results"),Re.some(Be=>(console.log(" Checking result:",Be.test_type,Be.test_id,"vs",ke,He),Be.test_type===ke&&Be.test_id===He)))?(console.log(" Found completion status in database results"),localStorage.setItem(Ut,"true"),!0):(console.log(" Test not completed according to local storage or database"),!1)}catch(Ft){return console.error(" Error checking test completion:",Ft),!1}},[d,s==null?void 0:s.student_id,s==null?void 0:s.id]),J=b.useCallback((ke,He)=>{const at={id:Date.now(),message:ke,type:He,timestamp:new Date};N(Me=>[...Me,at]),setTimeout(()=>{N(Me=>Me.filter(Ft=>Ft.id!==at.id))},ba.NOTIFICATION_DURATION)},[]),re=b.useCallback(async ke=>{console.log(" Showing test details:",ke);try{await p(ke.test_type,ke.test_id,ke.test_name)}catch(He){console.error("Error loading test details:",He),J("Failed to load test details","error")}},[p,J]),ve=b.useCallback(ke=>{console.log(" Starting test:",ke);const He=`${ke.test_type}_${ke.test_id}`;if(se.has(He)&&!(ke!=null&&ke.retest_available)){J("This test has already been completed","warning");return}if(console.log(" Checking retest conditions:"),console.log(" test.retest_available:",ke==null?void 0:ke.retest_available),console.log(" testKey:",He),console.log(" completedTests.has(testKey):",se.has(He)),console.log(" completedTests:",Array.from(se)),ke!=null&&ke.retest_available){const at=(s==null?void 0:s.student_id)||(s==null?void 0:s.id)||"",Me=`retest1_${at}_${ke.test_type}_${ke.test_id}`;if(localStorage.setItem(Me,"true"),console.log(" Set retest key:",Me),console.log(" Test retest_assignment_id:",ke.retest_assignment_id),console.log(" Test retest_assignment_id type:",typeof ke.retest_assignment_id),ke!=null&&ke.retest_assignment_id){const Ft=`retest_assignment_id_${at}_${ke.test_type}_${ke.test_id}`;localStorage.setItem(Ft,String(ke.retest_assignment_id)),console.log(" Set retest assignment ID:",Ft,"=",ke.retest_assignment_id)}else console.log(" No retest assignment ID found in test data")}else console.log(" Retest assignment ID storage skipped - retest not available");if(te(!0),console.log(" Set isStartingTest to true for test:",ke.test_type),ke.test_type==="matching_type"){console.log(" Redirecting to matching test page for testId:",ke.test_id),n(`/student/matching-test/${ke.test_id}`);return}if(ke.test_type==="word_matching"){console.log(" Redirecting to word matching test page for testId:",ke.test_id),n(`/student/word-matching-test/${ke.test_id}`);return}n(`/student/test/${ke.test_type}/${ke.test_id}`)},[n,se,J,s==null?void 0:s.student_id,s==null?void 0:s.id]),we=b.useCallback(()=>{G(ke=>!ke)},[]),Fe=b.useCallback(()=>{R(ke=>!ke)},[]),ne=b.useCallback(async ke=>{if(console.log(" Starting test:",ke),X){console.log(" Test already starting, ignoring click");return}try{if(await ae(ke.test_type,ke.test_id,ke==null?void 0:ke.retest_available,ke)&&!(ke!=null&&ke.retest_available)){J("This test has already been completed","warning");return}ve(ke)}catch(He){console.error(" Error starting test:",He),J("Failed to start test. Please try again.","error")}},[ae,ve,J,X]);return b.useCallback(ke=>{console.log(" Viewing test details:",ke),re(ke)},[re]),w?c.jsx(Le.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsxs(Le.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx(ir,{size:"lg"}),c.jsx(Le.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):_?c.jsx(Le.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:c.jsx(Le.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:c.jsxs(Le.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[c.jsx(Le.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),c.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-6",children:_}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs(Le.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Le.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(Le.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Le.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:((Ee=s==null?void 0:s.name)==null?void 0:Ee.charAt(0))||"S"})})}),c.jsxs("div",{children:[c.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s==null?void 0:s.name," ",s==null?void 0:s.surname]}),c.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s==null?void 0:s.grade," - Class ",s==null?void 0:s.class]})]})]}),c.jsxs(Le.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:e,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(Le.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:t?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(Sa,{children:t&&c.jsx(Le.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(Le.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(Le.button,{onClick:()=>{e(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),c.jsxs(Le.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:c.jsx("div",{className:"lg:col-span-1 space-y-6",children:I!==null&&c.jsx(Le.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:c.jsxs(it,{children:[c.jsx(it.Header,{children:c.jsx(it.Title,{children:"Average Score"})}),c.jsx(it.Body,{children:c.jsxs(Le.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[c.jsxs(Le.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[I,"%"]}),c.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),c.jsxs("div",{className:"space-y-6",children:[c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(it,{children:[c.jsx(it.Header,{children:c.jsx(it.Title,{className:"text-center",children:"Active Tests"})}),c.jsx(it.Body,{children:u&&u.length>0?c.jsxs("div",{className:"relative",children:[console.log(" Rendering overlay, isStartingTest:",X),X&&c.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),c.jsxs("div",{className:"space-y-4",children:[(z?u:u.slice(0,3)).map((ke,He)=>c.jsx(Le.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:z?0:.7+He*.1,duration:.3},whileHover:{scale:1.02},children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsx("div",{className:"flex-1",children:c.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[c.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:ke.test_name}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:ke.subject}),c.jsx("span",{className:"text-gray-500",children:ke.teacher_name}),c.jsxs("span",{className:"text-gray-500",children:[c.jsx("span",{className:"sm:hidden",children:new Date(ke.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),c.jsx("span",{className:"hidden sm:inline",children:new Date(ke.assigned_at).toLocaleDateString()})]})]})}),c.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const at=`${ke.test_type}_${ke.test_id}`,Me=se.has(at);return H?Me&&(ke!=null&&ke.retest_available)?c.jsx(Ue,{variant:"primary",size:"sm",onClick:()=>ne(ke),disabled:X,children:"Start Retest"}):Me?c.jsx(Ue,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(console.log(" Button render, isStartingTest:",X,"test:",ke.test_type),c.jsx(Ue,{variant:"primary",size:"sm",onClick:()=>ne(ke),disabled:X,children:"Start Test"})):c.jsx(Ue,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."})})()})]})},`${ke.test_type}_${ke.test_id}`)),u.length>3&&c.jsx("div",{className:"text-center pt-2",children:c.jsx("button",{onClick:we,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:z?"Show Less":`Show ${u.length-3} More`})})]})]}):c.jsxs(Le.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[c.jsx(Le.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(it,{children:[c.jsx(it.Header,{children:c.jsx(it.Title,{children:"Test Results"})}),c.jsx(it.Body,{children:d&&d.showResults?c.jsx(XT,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(ke,He)=>{g(),setTestResults(null)},isLoading:w}):c.jsx(VM,{compact:!0,showAll:O,onToggleShowAll:Fe,maxInitial:3})})]})})]})]}),c.jsx(MM,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:k.map(ke=>c.jsx(eo,{type:ke.type,message:ke.message,onClose:()=>N(He=>He.filter(at=>at.id!==ke.id))},ke.id))})]})},vne=({testInfo:t,questions:e,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[l,u]=b.useState(0),[d,g]=b.useState(0),[h,p]=b.useState(!0);if(b.useEffect(()=>{const w=()=>{try{const S=xc(e,n,r).score,_=(t==null?void 0:t.num_questions)||(e==null?void 0:e.length)||0,y=_>0?Math.round(S/_*100):0;u(S),g(y),p(!1)}catch(S){console.error("Error calculating test results:",S),u(0),g(0),p(!1)}};e&&e.length>0?w():p(!1)},[e,n,r,t,xc]),h)return c.jsx("div",{className:"flex justify-center items-center min-h-64",children:c.jsx("div",{className:"text-lg",children:"Calculating results..."})});const x=(t==null?void 0:t.num_questions)||(e==null?void 0:e.length)||0,v=(t==null?void 0:t.test_name)||(t==null?void 0:t.title)||"Test";return c.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"results-header text-center",children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",v]}),c.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"results-summary",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",l," / ",x," (",d,"%)"]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:c.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})}),c.jsx("div",{className:"text-center",children:c.jsx("p",{className:`text-lg font-medium ${d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600"}`,children:d>=80?"Excellent!":d>=60?"Good job!":"Keep practicing!"})})]})}),e&&e.length>0&&c.jsx(it,{className:"mb-6",children:c.jsxs("div",{className:"questions-review",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),c.jsx("div",{className:"space-y-4",children:e.map((w,S)=>{const _=n[String(w.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",S+1,":",{question:w,studentAnswer:_,testType:r});const y=a(w,_,r);return console.log(" TestResultsDisplay - isCorrect result:",y),c.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${y?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[c.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",S+1]}),c.jsx("span",{className:`text-2xl font-bold ${y?"text-green-600":"text-red-600"}`,children:y?"":""})]}),c.jsx("div",{className:"question-text mb-3",children:c.jsx("p",{className:"text-gray-700 font-medium",children:w.question})}),c.jsxs("div",{className:"answer-section space-y-2",children:[c.jsxs("p",{className:"student-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",c.jsx("span",{className:`font-medium ${y?"text-green-700":"text-red-700"}`,children:i(_,r,w)})]}),!y&&c.jsxs("p",{className:"correct-answer",children:[c.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",c.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(w.correct_answer||"").toUpperCase():i(o(w,r),r,w)})]})]})]},w.question_id||S)})})]})}),c.jsx(it,{children:c.jsx("div",{className:"results-actions text-center",children:c.jsx(Ue,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})},wne=({onBackToCabinet:t,currentTest:e})=>{const r=Xa(),{user:n,isAuthenticated:s}=vn(),{activeTests:a,loadActiveTests:i}=jm(),o=b.useCallback((Ne,Ke,Ze)=>{try{const ut=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${Ne}_${Ke}`;localStorage.setItem(ut,JSON.stringify(Ze)),console.log(`Saved test progress for ${Ne}_${Ke}:`,Ze)}catch(ft){console.error("Error saving test progress:",ft)}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),l=b.useCallback((Ne,Ke)=>{try{const ft=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${Ne}_${Ke}`,ut=localStorage.getItem(ft);return ut?JSON.parse(ut):null}catch(Ze){return console.error("Error getting test progress:",Ze),null}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),u=b.useCallback((Ne,Ke)=>{try{const Ze=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",ft=`test_progress_${Ze}_${Ne}_${Ke}`;localStorage.removeItem(ft);for(let ut=0;ut<localStorage.length;ut++){const bt=localStorage.key(ut);bt&&bt.startsWith(`test_progress_${Ze}_${Ne}_${Ke}_`)&&(localStorage.removeItem(bt),console.log(` Cleared individual question key: ${bt}`))}console.log(`Cleared test progress for ${Ne}_${Ke}`)}catch(Ze){console.error("Error clearing test progress:",Ze)}},[n==null?void 0:n.student_id,n==null?void 0:n.id]),[d,g]=b.useState(!0),[h,p]=b.useState(!1),[x,v]=b.useState(""),[w,S]=b.useState(!1),[_,y]=b.useState(""),[k,N]=b.useState([]),[E,A]=b.useState(e?"test":"list"),[C,F]=b.useState(null),[P,M]=b.useState(null),[I,Y]=b.useState(null),[se,L]=b.useState([]),[z,G]=b.useState([]),[O,R]=b.useState(0),[X,te]=b.useState(0),[H,V]=b.useState(null),q=Gn.useRef(null),Q=Gn.useRef(null),[ae,J]=b.useState(!1),[re,ve]=b.useState(!1),[we,Fe]=b.useState(null),[ne,Ee]=b.useState(null),{startTracking:ke,stopTracking:He,getCheatingData:at,clearData:Me,isCheating:Ft,tabSwitches:Ut}=Am(C==null?void 0:C.test_type,C==null?void 0:C.test_id,(n==null?void 0:n.student_id)||(n==null?void 0:n.id));b.useEffect(()=>{(()=>{const Ke=[];for(let Ze=0;Ze<localStorage.length;Ze++){const ft=localStorage.key(Ze);if(ft&&ft.startsWith("test_progress_")&&!ft.includes("_51712_")&&!ft.includes("_51736_")){const ut=ft.split("_");ut.length===4&&ut[0]==="test"&&ut[1]==="progress"&&Ke.push(ft)}}Ke.forEach(Ze=>{localStorage.removeItem(Ze),console.log(" Cleared old cache key:",Ze)})})()},[]),b.useEffect(()=>{Pe()},[]),b.useEffect(()=>{e&&(console.log(" Auto-starting test from prop:",e),S(!0),Be(e))},[e]);const Pe=b.useCallback(async()=>{console.log(" Initializing Student Tests...");try{if(g(!0),y(""),!s||!n){console.log(" User not authenticated"),y("User not authenticated");return}if(n.role!==aa.STUDENT){console.error(" Invalid user role for student tests:",n.role),y("Access denied. Student role required.");return}console.log(" Loading active tests..."),await i(),console.log(" Student Tests initialization complete!")}catch(Ne){console.error(" Error initializing student tests:",Ne),y("Failed to initialize student tests")}finally{g(!1)}},[s,n,i]);b.useCallback(async()=>{console.log(" Loading student active tests...");try{const Ne=await Ar.getActiveTests();console.log(" Active tests loaded:",Ne);const Ke=Ne.map(Ze=>({...Ze,subject_id:Ze.subject_id||Ze.subjectId,teacher_id:Ze.teacher_id||Ze.teacherId,is_active:Ze.is_active!==void 0?Ze.is_active:!0,created_at:Ze.created_at||Ze.createdAt,updated_at:Ze.updated_at||Ze.updatedAt}));return Ee(new Date),Ke}catch(Ne){throw console.error(" Error loading active tests:",Ne),Ne}},[]),b.useCallback(async(Ne,Ke)=>{console.log(" Checking test completion:",Ne,Ke);try{const Ze=l(Ne,Ke);return Ze&&Ze.completed}catch(Ze){return console.error(" Error checking test completion:",Ze),!1}},[l]),b.useEffect(()=>{if(se.length>0&&(C!=null&&C.test_id)){const Ne=setTimeout(()=>{let Ke=!1;const Ze=new Array(se.length).fill("");if(se.forEach((ft,ut)=>{const ye=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${P}_${C==null?void 0:C.test_id}_${ft.question_id}`,de=localStorage.getItem(ye);if(de){const ee=de.replace(/^"(.*)"$/,"$1");Ze[ut]=ee,Ke=!0}}),Ke){G(Ze);const ft=Ze.filter(bt=>bt&&typeof bt=="string"&&bt.trim()!=="").length,ut=se.length>0?ft/se.length*100:0;R(ut)}},100);return()=>clearTimeout(Ne)}},[se,P,C==null?void 0:C.test_id]);const Re=b.useCallback(async(Ne,Ke)=>{console.log(" Marking test as completed:",Ne,Ke);try{const Ze=l(Ne,Ke)||{};Ze.completed=!0,Ze.completedAt=new Date().toISOString(),o(Ne,Ke,Ze);const ut=`test_completed_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${Ne}_${Ke}`;localStorage.setItem(ut,"true"),console.log(" Test completion marked in localStorage:",ut),console.log(" localStorage value after setting:",localStorage.getItem(ut)),ot("Test marked as completed","success")}catch(Ze){console.error(" Error marking test as completed:",Ze),ot("Failed to mark test as completed","error")}},[l,o]),$e=b.useCallback(Ne=>{console.log(" Showing test details:",Ne),Fe(Ne),ve(!0)},[]),Be=b.useCallback(async Ne=>{console.log(" Starting test:",Ne);let Ke=Date.now(),Ze;try{v(""),p(!0),Ke=Date.now();const ft=()=>{const zt=Date.now()-Ke,pr=Math.max(0,250-zt);setTimeout(()=>{g(!1),p(!1)},pr)};let ut=!1;Ze=setTimeout(()=>{ut=!0,v("Loading is taking longer than expected...")},15e3);const ye=`test_completed_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${Ne.test_type}_${Ne.test_id}`,de=localStorage.getItem(ye)==="true";if(de&&!(Ne!=null&&Ne.retest_available)){console.log(" Test already completed, redirecting to main cabinet"),ot("This test has already been completed","info"),r("/student");return}if(de&&(Ne!=null&&Ne.retest_available)&&console.log(" Test completed but retest available, allowing retest"),Ne.test_type===Mr.MATCHING){console.log(" Redirecting to matching test page for testId:",Ne.test_id),r(`/student/matching-test/${Ne.test_id}`);return}if(Ne.test_type===Mr.WORD_MATCHING){console.log(" Redirecting to word matching test page for testId:",Ne.test_id),r(`/student/word-matching-test/${Ne.test_id}`);return}F(Ne),M(Ne.test_type);const[ee,he]=await Promise.all([Ar.getTestInfo(Ne.test_type,Ne.test_id),Ar.getTestQuestions(Ne.test_type,Ne.test_id)]);Y(ee);let Ae=he;try{if(!!(ee!=null&&ee.is_shuffled)){const er=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",pr=`${er}:${Ne.test_type}:${Ne.test_id}`,_n=Array.from(pr).reduce((oe,ue)=>(oe<<5)-oe+ue.charCodeAt(0),0)>>>0,Z=`test_shuffle_order_${er}_${Ne.test_type}_${Ne.test_id}`,ge=localStorage.getItem(Z);if(ge){const oe=JSON.parse(ge),ue=new Map(he.map(me=>[me.question_id,me]));Ae=oe.map(me=>ue.get(me)).filter(Boolean)}else{const ue=function(K){return function(){var le=K+=1831565813;return le=Math.imul(le^le>>>15,le|1),le^=le+Math.imul(le^le>>>7,le|61),((le^le>>>14)>>>0)/4294967296}}(_n);Ae=[...he];for(let K=Ae.length-1;K>0;K--){const le=Math.floor(ue()*(K+1));[Ae[K],Ae[le]]=[Ae[le],Ae[K]]}const me=Ae.map(K=>K.question_id);localStorage.setItem(Z,JSON.stringify(me))}}}catch(zt){console.error("Shuffle error (ignored):",zt)}L(Ae),ft();const st=l(Ne.test_type,Ne.test_id);let rt=(st==null?void 0:st.answers)||new Array(he.length).fill("");he.forEach((zt,er)=>{const _n=`test_progress_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}_${Ne.test_type}_${Ne.test_id}_${zt.question_id}`,Z=localStorage.getItem(_n);console.log(` Checking individual answer for question ${zt.question_id}:`,Z),Z&&(rt[er]=Z,console.log(` Loaded individual answer for question ${zt.question_id}:`,Z))}),console.log(" Initial answers after loading individual saves:",rt),G(rt);const At=rt.filter(zt=>zt&&typeof zt=="string"&&zt.trim()!=="").length,yt=he.length>0?At/he.length*100:0;console.log(" Calculated progress:",At,"answered out of",he.length,"=",yt+"%"),R(yt);const wt=Number((ee==null?void 0:ee.allowed_time)||0),Jt=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown";if(q.current=`test_timer_${Jt}_${Ne.test_type}_${Ne.test_id}`,wt>0)try{const zt=localStorage.getItem(q.current),er=Date.now();if(zt){const pr=JSON.parse(zt),_n=Math.floor((er-new Date(pr.lastTickAt).getTime())/1e3),Z=Math.max(0,Number(pr.remainingSeconds||wt)-Math.max(0,_n));te(Z),Q.current=er}else te(wt),Q.current=er,localStorage.setItem(q.current,JSON.stringify({remainingSeconds:wt,lastTickAt:new Date(er).toISOString(),startedAt:new Date(er).toISOString()}))}catch(zt){console.error("Timer cache init error:",zt),te(wt)}else te(0);const dr=new Date;V(dr),console.log(" Test timer started at:",dr.toISOString()),ke(),console.log(" Anti-cheating tracking started"),A("test"),console.log(" Test started successfully")}catch(ft){console.error(" Error starting test:",ft),ot("Failed to start test","error"),v("Failed to load test data. Please try again.")}finally{const ft=Date.now()-Ke,bt=Math.max(0,250-ft);setTimeout(()=>{g(!1),p(!1)},bt),S(!1);try{Ze&&clearTimeout(Ze)}catch{}}},[l]),Ge=b.useCallback(async()=>{if(!C||!I||!se||!z){ot("No test data to submit","error");return}console.log(" Submitting test:",C);try{J(!0);const Ne=xc(se,z,C.test_type),Ke=new Date,Ze=H?Math.round((Ke-H)/1e3):0,ft=H?H.toISOString():Ke.toISOString();console.log(" Test timing:",{startedAt:ft,endTime:Ke.toISOString(),timeTaken:`${Ze} seconds`});const ut=at();console.log(" Anti-cheating data for submission:",ut);const bt={};se.forEach((de,ee)=>{bt[de.question_id]=z[ee]??""}),C.test_type==="drawing"&&(console.log(" Drawing test answers being submitted:",z),console.log(" Drawing test answers type:",typeof z[0]),console.log(" Drawing test answers content:",z[0]));const ye=await Ar.submitTest(C.test_type,C.test_id,z,{time_taken:(()=>{const de=Number((I==null?void 0:I.allowed_time)||0);return de>0?Math.min(Ze,de):Ze})(),started_at:ft,submitted_at:Ke.toISOString(),answers_by_id:bt,question_order:se.map(de=>de.question_id),caught_cheating:ut.caught_cheating,visibility_change_times:ut.visibility_change_times,retest_assignment_id:(()=>{const ee=`retest_assignment_id_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||""}_${C.test_type}_${C.test_id}`,he=localStorage.getItem(ee);return console.log(" Frontend retest key:",ee),console.log(" Frontend retest assignment ID from localStorage:",he),console.log(" Frontend retest assignment ID converted:",he?Number(he):null),console.log(" Frontend current test data:",C),console.log(" Frontend current test retest_assignment_id:",C.retest_assignment_id),he?Number(he):null})(),parent_test_id:C.test_id},n);if(console.log(" Test submission result:",ye),ye.success){const de=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"",ee=`retest1_${de}_${C.test_type}_${C.test_id}`;if(localStorage.getItem(ee)==="true"){const rt=(C==null?void 0:C.retest_attempts_left)||(C==null?void 0:C.max_attempts)||3;if(((ye==null?void 0:ye.percentage_score)??0)>=50){const yt=`retest_attempt${rt}_${de}_${C.test_type}_${C.test_id}`;localStorage.setItem(yt,"true"),console.log(" Passed retest, marking last-slot key:",yt),localStorage.removeItem(ee)}else{let yt=1;for(let Jt=1;Jt<=10;Jt++){const dr=`retest_attempt${Jt}_${de}_${C.test_type}_${C.test_id}`;if(localStorage.getItem(dr)!=="true"){yt=Jt;break}}const wt=`retest_attempt${yt}_${de}_${C.test_type}_${C.test_id}`;localStorage.setItem(wt,"true"),console.log(" Marked retest attempt as completed:",wt),yt>=rt&&localStorage.removeItem(ee)}}if(console.log(" Marking test as completed..."),await Re(C.test_type,C.test_id),C.test_type!=="drawing"){console.log(" Caching test results after submission...");const At=`student_results_table_${(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown"}`,{setCachedData:yt,CACHE_TTL:wt}=await Cu(async()=>{const{setCachedData:Jt,CACHE_TTL:dr}=await Promise.resolve().then(()=>sD);return{setCachedData:Jt,CACHE_TTL:dr}},void 0);yt(At,ye,wt.student_results_table),console.log(" Test results cached with key:",At)}else console.log(" Drawing test submitted - not caching results (will appear after teacher grades)");console.log(" Clearing test progress..."),u(C.test_type,C.test_id);try{const rt=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",At=`test_timer_${rt}_${C.test_type}_${C.test_id}`;localStorage.removeItem(At);const yt=`test_shuffle_order_${rt}_${C.test_type}_${C.test_id}`;localStorage.removeItem(yt)}catch{}if(n!=null&&n.student_id){const rt=`test_completed_${n.student_id}_${C.test_type}_${C.test_id}`;localStorage.setItem(rt,"true"),console.log(" Test marked as completed in localStorage:",rt)}try{const rt=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"",At=`retest1_${rt}_${C.test_type}_${C.test_id}`,yt=`retest_assignment_id_${rt}_${C.test_type}_${C.test_id}`;localStorage.removeItem(At),localStorage.removeItem(yt),console.log(" Cleared retest keys:",At,yt)}catch(rt){console.warn("Failed to clear retest keys:",rt)}console.log(" Clearing test progress and anti-cheating data...");const Ae=(n==null?void 0:n.student_id)||(n==null?void 0:n.id)||"unknown",st=[];for(let rt=0;rt<localStorage.length;rt++){const At=localStorage.key(rt);At&&(At.startsWith(`test_progress_${Ae}_`)||At.startsWith(`anti_cheating_${Ae}_`))&&st.push(At)}st.forEach(rt=>{localStorage.removeItem(rt),console.log(` Cleared: ${rt}`)}),console.log(" Clearing anti-cheating data..."),He(),Me(),C.test_type!=="drawing"?A("results"):r("/student"),ot("Test submitted successfully!","success"),console.log(" Test submitted successfully")}else throw console.error(" Test submission failed:",ye.error),new Error(ye.error||"Failed to submit test")}catch(Ne){console.error(" Error submitting test:",Ne),ot("Failed to submit test","error")}finally{J(!1)}},[C,I,se,z,Re,u]);b.useCallback(()=>(console.log(" Collecting test answers..."),z),[z]);const ht=b.useCallback(()=>{if(!se||!z)return;const Ne=z.filter(Ze=>Ze&&typeof Ze=="string"&&Ze.trim()!=="").length,Ke=se.length>0?Ne/se.length*100:0;if(R(Ke),console.log(` Progress updated: ${Ne}/${se.length} questions answered (${Math.round(Ke)}%)`),C){const Ze={answers:z,progress:Ke,lastSaved:new Date().toISOString()};o(C.test_type,C.test_id,Ze)}},[se,z,C,o]);b.useEffect(()=>{ht()},[ht]);const Nt=b.useCallback(()=>{if(!z)return 0;const Ne=z.filter(Ke=>Ke&&typeof Ke=="string"&&Ke.trim()!=="").length;return console.log(" getAnsweredCount:",{studentAnswers:z,answeredCount:Ne,totalQuestions:se==null?void 0:se.length}),Ne},[z,se]),Ye=b.useCallback(()=>{console.log(" Navigating back to cabinet..."),t?t():r("/student")},[t,r]);b.useCallback(()=>{console.log(" Showing test results..."),A("results")},[]);const Ve=b.useCallback((Ne,Ke,Ze=null)=>{switch(console.log(" Formatting student answer for display:",Ne,"testType:",Ke,"question:",Ze),Ke){case Mr.MULTIPLE_CHOICE:if(Ne.toString().startsWith("Option "))return Ne;if(Ze&&typeof Ne=="string"&&!isNaN(parseInt(Ne))){const ft=parseInt(Ne),ut=`option_${String.fromCharCode(97+ft)}`,bt=Ze[ut];if(bt)return console.log(" Converted",Ne,"to option text:",bt),bt;{const ye=String.fromCharCode(65+ft);return console.log(" Converted",Ne,"to",ye),ye}}else{if(typeof Ne=="string"&&isNaN(parseInt(Ne)))return console.log(" Already formatted text:",Ne),Ne;{const ft=String.fromCharCode(65+parseInt(Ne));return console.log(" Converted",Ne,"to",ft),ft}}case Mr.TRUE_FALSE:return Ne==="true"?"True":"False";case Mr.INPUT:return Ne;case Mr.MATCHING:return typeof Ne=="object"?JSON.stringify(Ne):Ne;case Mr.WORD_MATCHING:return typeof Ne=="object"?JSON.stringify(Ne):Ne;case Mr.DRAWING:return Ne&&Ne.trim()!==""?"Drawing submitted":"No drawing";case Mr.FILL_BLANKS:return Ne;default:return console.warn(" Unknown test type for answer formatting:",Ke),Ne}},[]),ot=b.useCallback((Ne,Ke)=>{const Ze={id:Date.now(),message:Ne,type:Ke,timestamp:new Date};N(ft=>[...ft,Ze]),setTimeout(()=>{N(ft=>ft.filter(ut=>ut.id!==Ze.id))},ba.NOTIFICATION_DURATION)},[]);b.useEffect(()=>{ht()},[ht]),b.useEffect(()=>{if(E!=="test")return;const Ne=Number((I==null?void 0:I.allowed_time)||0);if(!Ne)return;const Ke=setInterval(()=>{te(Ze=>{const ft=Math.max(0,Ze-1);try{const ut=Date.now();Q.current||(Q.current=ut),q.current&&localStorage.setItem(q.current,JSON.stringify({remainingSeconds:ft,lastTickAt:new Date(ut).toISOString(),startedAt:H?H.toISOString():new Date(ut-(Ne-ft)*1e3).toISOString()}))}catch{}return ft===0&&Ge(),ft})},1e3);return()=>clearInterval(Ke)},[E,I==null?void 0:I.allowed_time,Ge,H]);const et=b.useCallback((Ne,Ke)=>{if(!Ne)return null;const Ze=(ft,ut)=>{const bt=[...z];bt[Ke]=ut,G(bt),console.log(` Answer changed: question ${ft} = ${ut}`),console.log(" Updated studentAnswers:",bt)};switch(C.test_type){case Mr.TRUE_FALSE:return c.jsx(mre,{question:Ne,questionIndex:Ke,studentAnswer:z[Ke]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:P,displayNumber:Ke+1});case Mr.MULTIPLE_CHOICE:return c.jsx(pre,{question:Ne,questionIndex:Ke,studentAnswer:z[Ke]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:P,displayNumber:Ke+1});case Mr.INPUT:return c.jsx(xre,{question:Ne,questionIndex:Ke,studentAnswer:z[Ke]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:P,displayNumber:Ke+1});case Mr.MATCHING:return console.error("Matching test reached renderQuestion - this should not happen"),c.jsxs("div",{className:"text-center p-8",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),c.jsx(Ue,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case Mr.DRAWING:return c.jsx(Tre,{question:Ne,questionIndex:Ke,studentAnswer:z[Ke]||"",onAnswerChange:Ze,mode:"student",testId:C==null?void 0:C.test_id,testType:P});case Mr.FILL_BLANKS:return Ke===0?c.jsx(Are,{testText:I==null?void 0:I.test_text,blanks:(se||[]).map((ft,ut)=>{var bt;return{id:ft.question_id||ut+1,options:ft.blank_options||[],correct_answer:((bt=ft.correct_answers)==null?void 0:bt[0])||ft.correct_answer,question:ft.question_json||""}}),separateType:I==null?void 0:I.separate_type,testId:C==null?void 0:C.test_id,testName:(I==null?void 0:I.test_name)||(C==null?void 0:C.test_name),teacherId:(I==null?void 0:I.teacher_id)||(C==null?void 0:C.teacher_id),subjectId:(I==null?void 0:I.subject_id)||(C==null?void 0:C.subject_id),onTestComplete:Ge,onAnswerChange:(ft,ut)=>{const bt=se.findIndex(ye=>ye.question_id===ft);if(bt!==-1){const ye=[...z];ye[bt]=ut,G(ye),console.log(` Fill Blanks answer changed: question ${ft} = ${ut}`)}}},`fill-blanks-${C==null?void 0:C.test_id}-${I==null?void 0:I.test_name}`):null;default:return c.jsx("div",{children:"Unsupported question type"})}},[C,z,P]);function nt(){return!C||!I||!se?null:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("div",{className:"flex justify-between items-center mb-4",children:c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:I.test_name||I.title||"Test"})}),c.jsx("div",{className:"mb-4",children:c.jsx(Nre,{answeredCount:Nt(),totalQuestions:se.length,percentage:Math.round(O),timeElapsed:Number((I==null?void 0:I.allowed_time)||0)>0?X:0,showDetails:!0})})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),c.jsx("div",{className:"space-y-8",children:se.map((Ne,Ke)=>c.jsx("div",{className:"question-container",children:et(Ne,Ke)},Ne.question_id||Ke))})]}),c.jsx("div",{className:"flex justify-center",children:c.jsx(Ue,{variant:"primary",size:"lg",onClick:Ge,disabled:ae||Nt()<se.length,loading:ae,children:ae?"Submitting...":`Submit Test (${Nt()}/${se.length})`})})]})}if(d)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:e?"Starting Test...":"Loading Student Tests..."})]})});if(_)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:_}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsx("div",{children:c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),c.jsx(Ue,{variant:"outline",onClick:Ye,children:"Back to Cabinet"})]})})}),Ft&&E==="results"&&c.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsx("div",{className:"ml-3",children:c.jsxs("p",{className:"text-sm text-red-700",children:[c.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",Ut," times during the test."]})})]})}),c.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!e&&E==="list"&&gt(),E==="test"&&nt(),E==="results"&&Et()]}),E==="test"&&h&&c.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),x&&c.jsx("div",{className:"mt-3 text-sm text-gray-500",children:x})]}),c.jsx(MM,{isOpen:re,onClose:()=>ve(!1),testType:we==null?void 0:we.test_type,testId:we==null?void 0:we.test_id,testName:we==null?void 0:we.test_name,questions:we==null?void 0:we.questions,isLoading:d}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:k.map(Ne=>c.jsx(eo,{type:Ne.type,message:Ne.message,onClose:()=>N(Ke=>Ke.filter(Ze=>Ze.id!==Ne.id))},Ne.id))})]});function gt(){return!a||a.length===0?c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):c.jsx("div",{className:"space-y-6",children:a.map((Ne,Ke)=>c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Ne.test_name}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Subject:"})," ",Ne.subject]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Ne.teacher_name]}),c.jsxs("div",{children:[c.jsx("span",{className:"font-medium",children:"Type:"})," ",Ne.test_type]})]}),c.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Ne.assigned_at).toLocaleDateString()]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(Ue,{variant:"outline",onClick:()=>$e(Ne),disabled:w||d,children:"View Details"}),c.jsx(Ue,{variant:"primary",onClick:()=>Be(Ne),disabled:w||d,children:w?"Starting...":"Start Test"})]})]})},Ke))})}function Et(){if(!C||!I||!se||!z)return null;const Ne={};return z.forEach((Ke,Ze)=>{if(se[Ze]){const ft=se[Ze].question_id||se[Ze].id||Ze;Ne[String(ft)]=Ke,console.log(" Converting answer:",{index:Ze,questionId:ft,answer:Ke,question:se[Ze]})}}),console.log(" Final answersObject:",Ne),console.log(" Questions structure:",se.map(Ke=>({id:Ke.question_id,correct_answer:Ke.correct_answer}))),c.jsx(vne,{testInfo:I,questions:se,testType:C.test_type,studentAnswers:Ne,onBackToCabinet:Ye,checkAnswerCorrectness:eh,formatStudentAnswerForDisplay:Ve,getCorrectAnswer:Lg})}},_ne=()=>{const{testId:t}=Zk(),e=Xa(),{user:r}=vn(),{makeAuthenticatedRequest:n}=ro(),{showNotification:s}=qs(),[a,i]=b.useState(null),[o,l]=b.useState(!0),[u,d]=b.useState(null),[g,h]=b.useState(null),[p,x]=b.useState(!1);Am("matching_type",a==null?void 0:a.id);const v=b.useCallback(()=>{if(!(r!=null&&r.student_id)||!t)return!1;const k=`test_completed_${r.student_id}_matching_type_${t}`,N=localStorage.getItem(k)==="true",E=`retest1_${r.student_id}_matching_type_${t}`,A=localStorage.getItem(E)==="true";return N&&!A?(console.log(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),e("/student"),!0):!1},[r==null?void 0:r.student_id,t,e,s]),w=b.useCallback(async()=>{if(!t){d("Test ID is required"),l(!1);return}if(!v())try{l(!0),d(null);const k=await n(`/.netlify/functions/get-matching-type-test?test_id=${t}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!k.ok)throw new Error("Failed to load test data");const N=await k.json();if(!N.success)throw new Error(N.message||"Failed to load test");const E=N.data;console.log(" Test data from get-matching-type-test:",E);const A=await n(`/.netlify/functions/get-test-questions?test_id=${t}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!A.ok)throw new Error("Failed to load test questions");const C=await A.json();if(!C.success)throw new Error(C.message||"Failed to load test questions");console.log(" Questions data from get-test-questions:",C);const F={id:E.test_id,test_name:E.test_name,teacher_id:E.teacher_id,subject_id:E.subject_id,image_url:E.image_url,image:null,blocks:(()=>{if(Array.isArray(C.questions)&&C.questions.length>0){const P=C.questions[0];return Array.isArray(P.blocks)?P.blocks.map((M,I)=>{let Y=M.block_coordinates||M.coordinates||(typeof M.x=="number"?{x:M.x,y:M.y,width:M.width,height:M.height}:null);if(typeof Y=="string")try{Y=JSON.parse(Y)}catch{Y=null}return(!Y||typeof Y!="object")&&(Y={x:0,y:0,width:30,height:10}),Y={x:(typeof Y.x=="number"?Y.x:Number(Y.x))||0,y:(typeof Y.y=="number"?Y.y:Number(Y.y))||0,width:(typeof Y.width=="number"?Y.width:Number(Y.width))||30,height:(typeof Y.height=="number"?Y.height:Number(Y.height))||10},{id:M.block_id||M.question_id||M.id||I+1,word:M.word||`Word ${I+1}`,coordinates:Y,hasArrow:!!M.has_arrow,arrow:M.arrow||null}}):C.questions.map(M=>{console.log(" Processing question:",M);let I;try{I=typeof M.block_coordinates=="string"?JSON.parse(M.block_coordinates):M.block_coordinates}catch{I={x:0,y:0,width:100,height:100}}return(!I||typeof I!="object")&&(I={x:0,y:0,width:100,height:100}),I={x:(typeof I.x=="number"?I.x:Number(I.x))||0,y:(typeof I.y=="number"?I.y:Number(I.y))||0,width:(typeof I.width=="number"?I.width:Number(I.width))||100,height:(typeof I.height=="number"?I.height:Number(I.height))||100},{id:M.question_id,word:M.word,coordinates:I,hasArrow:M.has_arrow,arrow:M.arrow}})}return[]})(),words:(()=>{if(Array.isArray(C.questions)&&C.questions.length>0){const P=C.questions[0];if(Array.isArray(P.words)){const M=P.words,I=Array.isArray(P.blocks)?P.blocks:[];return typeof M[0]=="string"?M.map((se,L)=>{var G,O,R;return{id:`w_${((G=I[L])==null?void 0:G.question_id)||((O=I[L])==null?void 0:O.block_id)||((R=C.questions[L])==null?void 0:R.question_id)||L+1}_${L}`,word:String(se),blockId:null,isPlaced:!1,isCorrect:!1}}):M.map((se,L)=>({id:`w_${se.question_id||se.id||L+1}_${L}`,word:se.word||String(se.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return C.questions.map(M=>({id:`w_${M.question_id}`,word:M.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:E.arrows?E.arrows.map(P=>(console.log(" Processing arrow:",P),{id:P.id,questionId:P.question_id,blockId:P.block_id||P.question_id,start:{x:Number(P.start_x)||0,y:Number(P.start_y)||0},end:{x:Number(P.end_x)||0,y:Number(P.end_y)||0},rel_start_x:P.rel_start_x!==null?Number(P.rel_start_x):null,rel_start_y:P.rel_start_y!==null?Number(P.rel_start_y):null,rel_end_x:P.rel_end_x!==null?Number(P.rel_end_x):null,rel_end_y:P.rel_end_y!==null?Number(P.rel_end_y):null,image_width:P.image_width?Number(P.image_width):null,image_height:P.image_height?Number(P.image_height):null,style:(typeof P.style=="string"?JSON.parse(P.style):P.style)||{color:"#dc3545",thickness:3}})):[]};if(E.image_url){const P=new Image;P.crossOrigin="anonymous",P.onload=()=>{F.image=P,i(F),l(!1)},P.onerror=()=>{console.warn("Failed to load test image"),i(F),l(!1)},P.src=E.image_url}else i(F),l(!1)}catch(k){console.error("Error loading test data:",k),d(k.message||"Failed to load test"),l(!1)}},[t,n]);b.useEffect(()=>{r!=null&&r.student_id&&w()},[w,r==null?void 0:r.student_id]);const S=b.useCallback(async k=>{var F,P,M;console.log("Test completed:",k),s("Test completed successfully!","success");const N=parseInt(k)||0,E=((F=a==null?void 0:a.blocks)==null?void 0:F.length)||((P=a==null?void 0:a.words)==null?void 0:P.length)||0,A=E>0?Math.round(N/E*100):0,C={showResults:!0,testInfo:{test_name:(a==null?void 0:a.test_name)||"Test",id:a==null?void 0:a.id,test_id:a==null?void 0:a.id},testType:"matching_type",score:N,totalQuestions:E,percentage:A,passed:A>=60,questionAnalysis:((M=a==null?void 0:a.questions)==null?void 0:M.map((I,Y)=>({questionNumber:Y+1,isCorrect:Y<N,userAnswer:Y<N?`Matched: ${I.word}`:"Not answered",correctAnswer:`Match: ${I.word}`})))||Array.from({length:E},(I,Y)=>({questionNumber:Y+1,isCorrect:Y<N,userAnswer:Y<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",C),h(C),x(!0)},[a,s]),_=b.useCallback(()=>{e("/student")},[e]),y=b.useCallback(()=>{x(!1),h(null),w()},[w]);return o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(it,{className:"max-w-md w-full",children:c.jsxs(it.Body,{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(it,{className:"max-w-md w-full",children:c.jsxs(it.Body,{className:"text-center",children:[c.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?p&&g?c.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:c.jsx(XT,{testResults:g,onBackToCabinet:_,onRetakeTest:y,isLoading:!1})}):c.jsx(yre,{testData:a,onTestComplete:S,onBackToCabinet:_}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx(it,{className:"max-w-md w-full",children:c.jsxs(it.Body,{className:"text-center",children:[c.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),c.jsx("button",{onClick:_,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},bne=()=>{const{testId:t}=Zk(),e=Xa(),{user:r}=vn(),{makeAuthenticatedRequest:n}=ro(),{showNotification:s}=qs(),[a,i]=b.useState(null),[o,l]=b.useState(!0),[u,d]=b.useState(null),[g,h]=b.useState(null),[p,x]=b.useState(!1),v=b.useCallback(()=>{if(!(r!=null&&r.student_id)||!t)return!1;const y=`test_completed_${r.student_id}_word_matching_${t}`,k=`retest1_${r.student_id}_word_matching_${t}`;return localStorage.getItem(k)==="true"?!1:localStorage.getItem(y)==="true"},[r==null?void 0:r.student_id,t]),w=b.useCallback(async()=>{if(!t){d("Test ID is required"),l(!1);return}if(v()){s("This test has already been completed","warning"),e("/student");return}l(!0),d(null);try{const y=`word_matching_test_${t}`,k=zr(y);if(k){if(console.log(" Word matching test loaded from cache:",k),k.id){let A=k;if(Array.isArray(A.rightWords)&&Array.isArray(A.correctPairs)){const C=A.rightWords.map((I,Y)=>Y);for(let I=C.length-1;I>0;I--){const Y=Math.floor(Math.random()*(I+1));[C[I],C[Y]]=[C[Y],C[I]]}const F=C.map(I=>A.rightWords[I]),P=new Map(C.map((I,Y)=>[I,Y])),M=A.correctPairs.map(I=>P.get(I));A={...A,rightWords:F,correctPairs:M}}i(A)}else{let C={id:k.test_id,test_id:k.test_id,test_name:k.test_name,teacher_id:k.teacher_id,subject_id:k.subject_id,num_questions:k.num_questions,interaction_type:k.interaction_type,passing_score:k.passing_score,created_at:k.created_at,updated_at:k.updated_at,leftWords:k.leftWords,rightWords:k.rightWords,correctPairs:k.correctPairs,originalPairs:k.originalPairs};if(Array.isArray(C.rightWords)&&Array.isArray(C.correctPairs)){const F=C.rightWords.map((Y,se)=>se);for(let Y=F.length-1;Y>0;Y--){const se=Math.floor(Math.random()*(Y+1));[F[Y],F[se]]=[F[se],F[Y]]}const P=F.map(Y=>C.rightWords[Y]),M=new Map(F.map((Y,se)=>[Y,se])),I=C.correctPairs.map(Y=>M.get(Y));C={...C,rightWords:P,correctPairs:I}}i(C)}l(!1);return}const E=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${t}`)).json();if(E.success){const A={id:E.data.test_id,test_id:E.data.test_id,test_name:E.data.test_name,teacher_id:E.data.teacher_id,subject_id:E.data.subject_id,num_questions:E.data.num_questions,interaction_type:E.data.interaction_type,passing_score:E.data.passing_score,created_at:E.data.created_at,updated_at:E.data.updated_at,leftWords:E.data.leftWords,rightWords:E.data.rightWords,correctPairs:E.data.correctPairs,originalPairs:E.data.originalPairs};let C=A;if(Array.isArray(C.rightWords)&&Array.isArray(C.correctPairs)){const F=C.rightWords.map((Y,se)=>se);for(let Y=F.length-1;Y>0;Y--){const se=Math.floor(Math.random()*(Y+1));[F[Y],F[se]]=[F[se],F[Y]]}const P=F.map(Y=>C.rightWords[Y]),M=new Map(F.map((Y,se)=>[Y,se])),I=C.correctPairs.map(Y=>M.get(Y));C={...C,rightWords:P,correctPairs:I}}i(C),Gr(y,C,Jr.word_matching_test),console.log(" Word matching test loaded from API and cached:",A)}else throw new Error(E.message||"Failed to load test")}catch(y){console.error("Error loading word matching test:",y),d(y.message),s("Failed to load test: "+y.message,"error")}finally{l(!1)}},[t,v,n,s,e]),S=b.useCallback(async y=>{console.log("Test completed:",y),s("Test completed successfully!","success");const k=parseInt(y)||0,N=(a==null?void 0:a.num_questions)||0,E=N>0?Math.round(k/N*100):0,A={showResults:!0,testInfo:{test_name:(a==null?void 0:a.test_name)||"Test",id:a==null?void 0:a.id,test_id:a==null?void 0:a.id},testType:"word_matching",score:k,totalQuestions:N,percentage:E,passed:E>=60,questionAnalysis:Array.isArray(a==null?void 0:a.correctPairs)?a.correctPairs.map((C,F)=>({questionNumber:F+1,isCorrect:F<k,userAnswer:F<k?`${C.left}  ${C.right}`:"Not answered",correctAnswer:`${C.left}  ${C.right}`})):Array.from({length:N},(C,F)=>({questionNumber:F+1,isCorrect:F<k,userAnswer:F<k?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",A),h(A),x(!0)},[a,s]),_=b.useCallback(()=>{e("/student")},[e]);return b.useEffect(()=>{w()},[w]),o?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsxs(it,{className:"p-8 text-center",children:[c.jsx(ir,{size:"lg",className:"mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(it,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-red-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),c.jsx("p",{className:"text-gray-600 mb-4",children:u}),c.jsx("button",{onClick:()=>e("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?p&&g?c.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:c.jsx(XT,{testResults:g,onBackToCabinet:()=>{h(null),x(!1),e("/student")},onRetakeTest:(y,k)=>{h(null),x(!1),w()},isLoading:!1})}):c.jsx(Le.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:c.jsx(_re,{testData:a,onTestComplete:S,onBackToCabinet:_})}):c.jsx("div",{className:"flex justify-center items-center min-h-screen",children:c.jsx(it,{className:"p-8 text-center",children:c.jsxs("div",{className:"text-gray-600 mb-4",children:[c.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),c.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),c.jsx("button",{onClick:()=>e("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},Sne=()=>{const{testType:t,testId:e}=Zk(),r=Xa(),{activeTests:n}=jm(),s=()=>{r("/student")},a=n.find(i=>i.test_type===t&&i.test_id===parseInt(e));return c.jsx(wne,{onBackToCabinet:s,currentTest:a||{test_type:t,test_id:parseInt(e)}})},kne=()=>{const t=Xa(),{user:e,isAuthenticated:r,isLoading:n}=vn(),[s,a]=b.useState(!1),[i,o]=b.useState(!0),[l,u]=b.useState(""),[d,g]=b.useState([]),[h,p]=b.useState(!1),[x,v]=b.useState(!1),[w,S]=b.useState({currentPassword:"",newPassword:"",confirmPassword:""}),_=b.useCallback(async()=>{console.log(" Initializing Student Application...");try{if(o(!0),u(""),!r||!e){console.log(" User not authenticated, redirecting to login"),t("/login");return}if(e.role!==aa.STUDENT){console.error(" Invalid user role for student app:",e.role),u("Access denied. Student role required.");return}console.log(" Initializing event listeners..."),y(),console.log(" Setting up back to cabinet button listeners..."),k(),console.log(" Setting up password change form listener..."),N(),console.log(" Loading student data..."),await E(),console.log(" Exposing student functions globally..."),A(),console.log(" Populating student info from user data..."),Y(e),a(!0),console.log(" Student Application initialization complete!")}catch(z){console.error(" Error initializing student app:",z),u("Failed to initialize student application")}finally{o(!1)}},[r,e,t]);b.useEffect(()=>{n||_()},[n,r,e,_]);const y=b.useCallback(()=>{console.log(" Setting up student event listeners...");const z=O=>{h&&!O.target.closest(".student-menu")&&p(!1)},G=O=>{O.key==="Escape"&&h&&p(!1)};return document.addEventListener("click",z),document.addEventListener("keydown",G),()=>{document.removeEventListener("click",z),document.removeEventListener("keydown",G)}},[h]),k=b.useCallback(()=>{console.log(" Setting up back to cabinet listeners...")},[]),N=b.useCallback(()=>{console.log(" Setting up password change form...")},[]),E=b.useCallback(async()=>{console.log(" Loading student data...");try{console.log(" Student data loaded successfully")}catch(z){throw console.error(" Error loading student data:",z),z}},[]),A=b.useCallback(()=>{console.log(" Exposing student functions globally..."),window.toggleStudentMenu=C,window.showChangePasswordTab=F,window.hideChangePasswordTab=P,window.navigateBackToCabinet=I,window.handlePasswordChange=M,window.populateStudentInfoDirectly=Y,console.log(" All student functions exposed globally")},[]),C=b.useCallback(()=>{console.log(" toggleStudentMenu called"),p(z=>{const G=!z;return console.log(" Menu state changed from",z,"to",G),G}),console.log(" Toggled dropdown menu")},[]),F=b.useCallback(()=>{console.log(" showChangePasswordTab called"),v(!0),p(!1)},[]),P=b.useCallback(()=>{console.log(" hideChangePasswordTab called"),v(!1),S({currentPassword:"",newPassword:"",confirmPassword:""})},[]),M=b.useCallback(async z=>{z.preventDefault(),console.log(" handlePasswordChange called");const{currentPassword:G,newPassword:O,confirmPassword:R}=w;if(!G||!O||!R){se("Please fill in all fields","error");return}if(O!==R){se("New passwords do not match","error");return}if(O.length<6){se("New password must be at least 6 characters long","error");return}const X=/[a-zA-Z]/.test(O),te=/[0-9]/.test(O);if(!X||!te){se("New password must contain both letters and numbers","error");return}if(!e||!e.student_id){se("Session expired. Please login again.","error");return}const H=e.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const V=await Ur.changePassword({studentId:H,currentPassword:G,newPassword:O});V.success?(se("Password changed successfully!","success"),P()):se(V.message||"Failed to change password","error")}catch(V){console.error("Password change error:",V),se("Failed to change password. Please try again.","error")}finally{o(!1)}},[w,e]),I=b.useCallback(()=>{if(console.log("[DEBUG] navigateBackToCabinet called"),!r||!e){console.warn("[WARN] No valid user found, redirecting to login"),t("/login");return}e.role===aa.STUDENT?(console.log("[DEBUG] Navigating to student cabinet"),t("/student")):(console.warn("[WARN] Unknown user role, redirecting to login"),t("/login"))},[r,e,t]),Y=b.useCallback(z=>{console.log(" populateStudentInfoDirectly called with:",z);try{console.log(" Student info populated successfully")}catch(G){console.error(" Error populating student info:",G)}},[]),se=b.useCallback((z,G)=>{const O={id:Date.now(),message:z,type:G,timestamp:new Date};g(R=>[...R,O]),setTimeout(()=>{g(R=>R.filter(X=>X.id!==O.id))},ba.NOTIFICATION_DURATION)},[]),L=b.useCallback(z=>{const{name:G,value:O}=z.target;S(R=>({...R,[G]:O}))},[]);return i?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):l?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:l}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?c.jsxs("div",{className:"bg-gray-50",children:[c.jsxs(eC,{children:[c.jsx(Mn,{path:"/",element:c.jsxs("div",{className:"student-app",children:[c.jsx(yne,{isMenuOpen:h,onToggleMenu:C,onShowPasswordChange:F}),x&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),c.jsxs("form",{onSubmit:M,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:w.currentPassword,onChange:L,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:w.newPassword,onChange:L,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:w.confirmPassword,onChange:L,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:P,className:"flex-1",children:"Cancel"}),c.jsx(Ue,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),c.jsx(Mn,{path:"/test/:testType/:testId",element:c.jsx(Sne,{})}),c.jsx(Mn,{path:"matching-test/:testId",element:c.jsx(_ne,{})}),c.jsx(Mn,{path:"word-matching-test/:testId",element:c.jsx(bne,{})}),c.jsx(Mn,{path:"/results",element:c.jsx(VM,{})})]}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(z=>c.jsx(eo,{type:z.type,message:z.message,onClose:()=>g(G=>G.filter(O=>O.id!==z.id))},z.id))})]}):c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},Cne=()=>c.jsx(iD,{children:c.jsx(RM,{children:c.jsx(PM,{children:c.jsx(kne,{})})})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Y1={};Y1.version="0.18.5";var KM=1252,Tne=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],YT={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},JT=function(t){Tne.indexOf(t)!=-1&&(KM=YT[0]=t)};function Ene(){JT(1252)}var Gi=function(t){JT(t)};function QT(){Gi(1200),Ene()}function w8(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function Nne(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function XM(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var C0=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?Nne(t.slice(2)):e==254&&r==255?XM(t.slice(2)):e==65279?t.slice(1):t},dx=function(e){return String.fromCharCode(e)},_8=function(e){return String.fromCharCode(e)},Bg,nc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ug(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),a=r>>2,n=t.charCodeAt(u++),i=(r&3)<<4|n>>4,s=t.charCodeAt(u++),o=(n&15)<<2|s>>6,l=s&63,isNaN(n)?o=l=64:isNaN(s)&&(l=64),e+=nc.charAt(a)+nc.charAt(i)+nc.charAt(o)+nc.charAt(l);return e}function Ga(t){var e="",r=0,n=0,s=0,a=0,i=0,o=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)a=nc.indexOf(t.charAt(u++)),i=nc.indexOf(t.charAt(u++)),r=a<<2|i>>4,e+=String.fromCharCode(r),o=nc.indexOf(t.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),l=nc.indexOf(t.charAt(u++)),s=(o&3)<<6|l,l!==64&&(e+=String.fromCharCode(s));return e}var fr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),jl=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Cc(t){return fr?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function b8(t){return fr?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ba=function(e){return fr?jl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Uv(t){if(typeof ArrayBuffer>"u")return Ba(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Gc(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function Ane(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function qT(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return qT(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var gs=fr?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:jl(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),s=0;for(e=0,r=0;e<t.length;r+=s,++e)if(s=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function jne(t){for(var e=[],r=0,n=t.length+250,s=Cc(t.length+255),a=0;a<t.length;++a){var i=t.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=t.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(e.push(s.slice(0,r)),r=0,s=Cc(65535),n=65530)}return e.push(s.slice(0,r)),gs(e)}var ca=/\u0000/g,T0=/[\u0001-\u0006]/g;function Df(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Vi(t,e){var r=""+t;return r.length>=e?r:En("0",e-r.length)+r}function ZT(t,e){var r=""+t;return r.length>=e?r:En(" ",e-r.length)+r}function J1(t,e){var r=""+t;return r.length>=e?r:r+En(" ",e-r.length)}function Fne(t,e){var r=""+Math.round(t);return r.length>=e?r:En("0",e-r.length)+r}function Pne(t,e){var r=""+t;return r.length>=e?r:En("0",e-r.length)+r}var S8=Math.pow(2,32);function Hd(t,e){if(t>S8||t<-S8)return Fne(t,e);var r=Math.round(t);return Pne(r,e)}function Q1(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var k8=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],b2=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Dne(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Kt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},C8={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Rne={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function q1(t,e,r){for(var n=t<0?-1:1,s=t*n,a=0,i=1,o=0,l=1,u=0,d=0,g=Math.floor(s);u<e&&(g=Math.floor(s),o=g*i+a,d=g*u+l,!(s-g<5e-8));)s=1/(s-g),a=i,i=o,l=u,u=d;if(d>e&&(u>e?(d=l,o=a):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function vu(t,e,r){if(t>2958465||t<0)return null;var n=t|0,s=Math.floor(86400*(t-n)),a=0,i=[],o={D:n,T:s,u:86400*(t-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=Une(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var YM=new Date(1899,11,31,0,0,0),Mne=YM.getTime(),Ine=new Date(1900,2,1,0,0,0);function JM(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=Ine&&(r+=24*60*60*1e3),(r-(Mne+(t.getTimezoneOffset()-YM.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function e4(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function One(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Lne(t){var e=t<0?12:11,r=e4(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function Bne(t){var e=e4(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function $g(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=Lne(t):e===10?r=t.toFixed(10).substr(0,12):r=Bne(t),e4(One(r.toUpperCase()))}function qu(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):$g(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ei(14,JM(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Une(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function $ne(t,e,r,n){var s="",a=0,i=0,o=r.y,l,u=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return b2[r.m-1][1];case 5:return b2[r.m-1][0];default:return b2[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return k8[r.q][0];default:return k8[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Vi(r.S,e.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),e==="s"?a===0?"0":""+a/i:(s=Vi(a,2+n),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=o,u=1;break}var d=u>0?Vi(l,u):"";return d}function sc(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var QM=/%/g;function Wne(t,e,r){var n=e.replace(QM,""),s=e.length-n.length;return dl(t,n,r*Math.pow(10,2*s))+En("%",s)}function Hne(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return dl(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function qM(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+qM(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var ZM=/# (\?+)( ?)\/( ?)(\d+)/;function zne(t,e,r){var n=parseInt(t[4],10),s=Math.round(e*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?En(" ",t[1].length+1+t[4].length):ZT(i,t[1].length)+t[2]+"/"+t[3]+Vi(o,t[4].length))}function Gne(t,e,r){return r+(e===0?"":""+e)+En(" ",t[1].length+2+t[4].length)}var eI=/^#*0*\.([0#]+)/,tI=/\).*[0#]/,rI=/\(###\) ###\\?-####/;function na(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function T8(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function E8(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Vne(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Kne(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ci(t,e,r){if(t.charCodeAt(0)===40&&!e.match(tI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ci("n",n,r):"("+ci("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Hne(t,e,r);if(e.indexOf("%")!==-1)return Wne(t,e,r);if(e.indexOf("E")!==-1)return qM(e,r);if(e.charCodeAt(0)===36)return"$"+ci(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Hd(l,e.length);if(e.match(/^[#?]+$/))return s=Hd(r,0),s==="0"&&(s=""),s.length>e.length?s:na(e.substr(0,e.length-s.length))+s;if(a=e.match(ZM))return zne(a,l,u);if(e.match(/^#+0+$/))return u+Hd(l,e.length-e.indexOf("0"));if(a=e.match(eI))return s=T8(r,a[1].length).replace(/^([^\.]+)$/,"$1."+na(a[1])).replace(/\.$/,"."+na(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+En("0",na(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+T8(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+sc(Hd(l,0));if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ci(t,e,-r):sc(""+(Math.floor(r)+Vne(r,a[1].length)))+"."+Vi(E8(r,a[1].length),a[1].length);if(a=e.match(/^#,#*,#0/))return ci(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Df(ci(t,e.replace(/[\\-]/g,""),r)),i=0,Df(Df(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(e.match(rI))return s=ci(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=q1(l,Math.pow(10,i)-1,!1),s=""+u,d=dl("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=J1(o[2],i),d.length<a[4].length&&(d=na(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=q1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ZT(o[1],i)+a[2]+"/"+a[3]+J1(o[2],i):En(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=Hd(r,0),e.length<=s.length?s:na(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var g=e.indexOf(".")-i,h=e.length-s.length-g;return na(e.substr(0,g)+s+e.substr(e.length-h))}if(a=e.match(/^00,000\.([#0]*0)$/))return i=E8(r,a[1].length),r<0?"-"+ci(t,e,-r):sc(Kne(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Vi(0,3-x.length):"")+x})+"."+Vi(i,a[1].length);switch(e){case"###,##0.00":return ci(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=sc(Hd(l,0));return p!=="0"?u+p:"";case"###,###.00":return ci(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ci(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function Xne(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return dl(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Yne(t,e,r){var n=e.replace(QM,""),s=e.length-n.length;return dl(t,n,r*Math.pow(10,2*s))+En("%",s)}function nI(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+nI(t,-e);var s=t.indexOf(".");s===-1&&(s=t.indexOf("E"));var a=Math.floor(Math.log(e)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(e/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,d){return l+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function po(t,e,r){if(t.charCodeAt(0)===40&&!e.match(tI)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?po("n",n,r):"("+po("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return Xne(t,e,r);if(e.indexOf("%")!==-1)return Yne(t,e,r);if(e.indexOf("E")!==-1)return nI(e,r);if(e.charCodeAt(0)===36)return"$"+po(t,e.substr(e.charAt(1)==" "?2:1),r);var s,a,i,o,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Vi(l,e.length);if(e.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>e.length?s:na(e.substr(0,e.length-s.length))+s;if(a=e.match(ZM))return Gne(a,l,u);if(e.match(/^#+0+$/))return u+Vi(l,e.length-e.indexOf("0"));if(a=e.match(eI))return s=(""+r).replace(/^([^\.]+)$/,"$1."+na(a[1])).replace(/\.$/,"."+na(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+En("0",na(a[1]).length-v.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),a=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=e.match(/^#{1,3},##0(\.?)$/))return u+sc(""+l);if(a=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+po(t,e,-r):sc(""+r)+"."+En("0",a[1].length);if(a=e.match(/^#,#*,#0/))return po(t,e.replace(/^#,#*,/,""),r);if(a=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Df(po(t,e.replace(/[\\-]/g,""),r)),i=0,Df(Df(e.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(e.match(rI))return s=po(t,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=q1(l,Math.pow(10,i)-1,!1),s=""+u,d=dl("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=J1(o[2],i),d.length<a[4].length&&(d=na(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=q1(l,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ZT(o[1],i)+a[2]+"/"+a[3]+J1(o[2],i):En(" ",2*i+1+a[2].length+a[3].length));if(a=e.match(/^[#0?]+$/))return s=""+r,e.length<=s.length?s:na(e.substr(0,e.length-s.length))+s;if(a=e.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var g=e.indexOf(".")-i,h=e.length-s.length-g;return na(e.substr(0,g)+s+e.substr(e.length-h))}if(a=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+po(t,e,-r):sc(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Vi(0,3-x.length):"")+x})+"."+Vi(0,a[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=sc(""+l);return p!=="0"?u+p:"";default:if(e.match(/\.[0#?]*$/))return po(t,e.slice(0,e.lastIndexOf(".")),r)+na(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function dl(t,e,r){return(r|0)===r?po(t,e,r):ci(t,e,r)}function Jne(t){for(var e=[],r=!1,n=0,s=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(s,n-s),s=n+1}if(e[e.length]=t.substr(s),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var sI=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Fh(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Q1(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(sI))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Qne(t,e,r,n){for(var s=[],a="",i=0,o="",l="t",u,d,g,h="H";i<t.length;)switch(o=t.charAt(i)){case"G":if(!Q1(t,i))throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(g=t.charCodeAt(++i))!==34&&i<t.length;)a+=String.fromCharCode(g);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=t.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:e},++i;break;case"B":case"b":if(t.charAt(i+1)==="1"||t.charAt(i+1)==="2"){if(u==null&&(u=vu(e,r,t.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:t.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=vu(e,r),u==null))return"";for(a=o;++i<t.length&&t.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=vu(e,r)),t.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",h="h",i+=3):t.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,h="h"):t.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,h="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,l=o;break;case"[":for(a=o;t.charAt(i++)!=="]"&&i<t.length;)a+=t.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(sI)){if(u==null&&(u=vu(e,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Fh(t)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<t.length&&(o=t.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;t.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},l=o;break;case"*":++i,(t.charAt(i)==" "||t.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<t.length&&"0123456789".indexOf(t.charAt(++i))>-1;)a+=t.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);s[s.length]={t:"t",v:o},++i;break}var w=0,S=0,_;for(i=s.length-1,l="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,l="h",w<1&&(w=1);break;case"s":(_=s[i].v.match(/\.0+$/))&&(S=Math.max(S,_[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=s[i].t;break;case"m":l==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",k;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=$ne(s[i].t.charCodeAt(0),s[i].v,u,S),s[i].t="t";break;case"n":case"?":for(k=i+1;s[k]!=null&&((o=s[k].t)==="?"||o==="D"||(o===" "||o==="t")&&s[k+1]!=null&&(s[k+1].t==="?"||s[k+1].t==="t"&&s[k+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[k].v==="/"||s[k].v===" "&&s[k+1]!=null&&s[k+1].t=="?"));)s[i].v+=s[k].v,s[k]={v:"",t:";"},++k;y+=s[i].v,i=k-1;break;case"G":s[i].t="t",s[i].v=qu(e,r);break}var N="",E,A;if(y.length>0){y.charCodeAt(0)==40?(E=e<0&&y.charCodeAt(0)===45?-e:e,A=dl("n",y,E)):(E=e<0&&n>1?-e:e,A=dl("n",y,E),E<0&&s[0]&&s[0].t=="t"&&(A=A.substr(1),s[0].v="-"+s[0].v)),k=A.length-1;var C=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){C=i;break}var F=s.length;if(C===s.length&&A.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(k>=s[i].v.length-1?(k-=s[i].v.length,s[i].v=A.substr(k+1,s[i].v.length)):k<0?s[i].v="":(s[i].v=A.substr(0,k+1),k=-1),s[i].t="t",F=i);k>=0&&F<s.length&&(s[F].v=A.substr(0,k+1)+s[F].v)}else if(C!==s.length&&A.indexOf("E")===-1){for(k=A.indexOf(".")-1,i=C;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===C?s[i].v.indexOf(".")-1:s[i].v.length-1,N=s[i].v.substr(d+1);d>=0;--d)k>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(N=A.charAt(k--)+N);s[i].v=N,s[i].t="t",F=i}for(k>=0&&F<s.length&&(s[F].v=A.substr(0,k+1)+s[F].v),k=A.indexOf(".")+1,i=C;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==C)){for(d=s[i].v.indexOf(".")>-1&&i===C?s[i].v.indexOf(".")+1:0,N=s[i].v.substr(0,d);d<s[i].v.length;++d)k<A.length&&(N+=A.charAt(k++));s[i].v=N,s[i].t="t",F=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(E=n>1&&e<0&&i>0&&s[i-1].v==="-"?-e:e,s[i].v=dl(s[i].t,s[i].v,E),s[i].t="t");var P="";for(i=0;i!==s.length;++i)s[i]!=null&&(P+=s[i].v);return P}var N8=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function A8(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function qne(t,e){var r=Jne(t),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(N8),o=r[1].match(N8);return A8(e,i)?[n,r[0]]:A8(e,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Ei(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Kt)[t],n==null&&(n=r.table&&r.table[C8[t]]||Kt[C8[t]]),n==null&&(n=Rne[t]||"General");break}if(Q1(n,0))return qu(e,r);e instanceof Date&&(e=JM(e,r.date1904));var s=qne(n,e);if(Q1(s[1]))return qu(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Qne(s[1],e,r,s[0])}function fl(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Kt[r]==null){e<0&&(e=r);continue}if(Kt[r]==t){e=r;break}}e<0&&(e=391)}return Kt[e]=t,e}function $v(t){for(var e=0;e!=392;++e)t[e]!==void 0&&fl(t[e],e)}function Ph(){Kt=Dne()}var Zne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},aI=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function ese(t){var e=typeof t=="number"?Kt[t]:t;return e=e.replace(aI,"(\\d+)"),new RegExp("^"+e+"$")}function tse(t,e,r){var n=-1,s=-1,a=-1,i=-1,o=-1,l=-1;(e.match(aI)||[]).forEach(function(g,h){var p=parseInt(r[h+1],10);switch(g.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:s=p;break}}),l>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var rse=function(){var t={};t.version="1.2.0";function e(){for(var A=0,C=new Array(256),F=0;F!=256;++F)A=F,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,A=A&1?-306674912^A>>>1:A>>>1,C[F]=A;return typeof Int32Array<"u"?new Int32Array(C):C}var r=e();function n(A){var C=0,F=0,P=0,M=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)M[P]=A[P];for(P=0;P!=256;++P)for(F=A[P],C=256+P;C<4096;C+=256)F=M[C]=F>>>8^A[F&255];var I=[];for(P=1;P!=16;++P)I[P-1]=typeof Int32Array<"u"?M.subarray(P*256,P*256+256):M.slice(P*256,P*256+256);return I}var s=n(r),a=s[0],i=s[1],o=s[2],l=s[3],u=s[4],d=s[5],g=s[6],h=s[7],p=s[8],x=s[9],v=s[10],w=s[11],S=s[12],_=s[13],y=s[14];function k(A,C){for(var F=C^-1,P=0,M=A.length;P<M;)F=F>>>8^r[(F^A.charCodeAt(P++))&255];return~F}function N(A,C){for(var F=C^-1,P=A.length-15,M=0;M<P;)F=y[A[M++]^F&255]^_[A[M++]^F>>8&255]^S[A[M++]^F>>16&255]^w[A[M++]^F>>>24]^v[A[M++]]^x[A[M++]]^p[A[M++]]^h[A[M++]]^g[A[M++]]^d[A[M++]]^u[A[M++]]^l[A[M++]]^o[A[M++]]^i[A[M++]]^a[A[M++]]^r[A[M++]];for(P+=15;M<P;)F=F>>>8^r[(F^A[M++])&255];return~F}function E(A,C){for(var F=C^-1,P=0,M=A.length,I=0,Y=0;P<M;)I=A.charCodeAt(P++),I<128?F=F>>>8^r[(F^I)&255]:I<2048?(F=F>>>8^r[(F^(192|I>>6&31))&255],F=F>>>8^r[(F^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,Y=A.charCodeAt(P++)&1023,F=F>>>8^r[(F^(240|I>>8&7))&255],F=F>>>8^r[(F^(128|I>>2&63))&255],F=F>>>8^r[(F^(128|Y>>6&15|(I&3)<<4))&255],F=F>>>8^r[(F^(128|Y&63))&255]):(F=F>>>8^r[(F^(224|I>>12&15))&255],F=F>>>8^r[(F^(128|I>>6&63))&255],F=F>>>8^r[(F^(128|I&63))&255]);return~F}return t.table=r,t.bstr=k,t.buf=N,t.str=E,t}(),Wt=function(){var e={};e.version="1.2.1";function r(Z,ge){for(var oe=Z.split("/"),ue=ge.split("/"),me=0,K=0,le=Math.min(oe.length,ue.length);me<le;++me){if(K=oe[me].length-ue[me].length)return K;if(oe[me]!=ue[me])return oe[me]<ue[me]?-1:1}return oe.length-ue.length}function n(Z){if(Z.charAt(Z.length-1)=="/")return Z.slice(0,-1).indexOf("/")===-1?Z:n(Z.slice(0,-1));var ge=Z.lastIndexOf("/");return ge===-1?Z:Z.slice(0,ge+1)}function s(Z){if(Z.charAt(Z.length-1)=="/")return s(Z.slice(0,-1));var ge=Z.lastIndexOf("/");return ge===-1?Z:Z.slice(ge+1)}function a(Z,ge){typeof ge=="string"&&(ge=new Date(ge));var oe=ge.getHours();oe=oe<<6|ge.getMinutes(),oe=oe<<5|ge.getSeconds()>>>1,Z.write_shift(2,oe);var ue=ge.getFullYear()-1980;ue=ue<<4|ge.getMonth()+1,ue=ue<<5|ge.getDate(),Z.write_shift(2,ue)}function i(Z){var ge=Z.read_shift(2)&65535,oe=Z.read_shift(2)&65535,ue=new Date,me=oe&31;oe>>>=5;var K=oe&15;oe>>>=4,ue.setMilliseconds(0),ue.setFullYear(oe+1980),ue.setMonth(K-1),ue.setDate(me);var le=ge&31;ge>>>=5;var be=ge&63;return ge>>>=6,ue.setHours(ge),ue.setMinutes(be),ue.setSeconds(le<<1),ue}function o(Z){ks(Z,0);for(var ge={},oe=0;Z.l<=Z.length-4;){var ue=Z.read_shift(2),me=Z.read_shift(2),K=Z.l+me,le={};switch(ue){case 21589:oe=Z.read_shift(1),oe&1&&(le.mtime=Z.read_shift(4)),me>5&&(oe&2&&(le.atime=Z.read_shift(4)),oe&4&&(le.ctime=Z.read_shift(4))),le.mtime&&(le.mt=new Date(le.mtime*1e3));break}Z.l=K,ge[ue]=le}return ge}var l;function u(){return l||(l={})}function d(Z,ge){if(Z[0]==80&&Z[1]==75)return ye(Z,ge);if((Z[0]|32)==109&&(Z[1]|32)==105)return wt(Z,ge);if(Z.length<512)throw new Error("CFB file size "+Z.length+" < 512");var oe=3,ue=512,me=0,K=0,le=0,be=0,pe=0,Te=[],B=Z.slice(0,512);ks(B,0);var ie=g(B);switch(oe=ie[0],oe){case 3:ue=512;break;case 4:ue=4096;break;case 0:if(ie[1]==0)return ye(Z,ge);default:throw new Error("Major Version: Expected 3 or 4 saw "+oe)}ue!==512&&(B=Z.slice(0,ue),ks(B,28));var xe=Z.slice(0,ue);h(B,oe);var ce=B.read_shift(4,"i");if(oe===3&&ce!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ce);B.l+=4,le=B.read_shift(4,"i"),B.l+=4,B.chk("00100000","Mini Stream Cutoff Size: "),be=B.read_shift(4,"i"),me=B.read_shift(4,"i"),pe=B.read_shift(4,"i"),K=B.read_shift(4,"i");for(var Ce=-1,Oe=0;Oe<109&&(Ce=B.read_shift(4,"i"),!(Ce<0));++Oe)Te[Oe]=Ce;var Ie=p(Z,ue);w(pe,K,Ie,ue,Te);var mt=_(Ie,le,Te,ue);mt[le].name="!Directory",me>0&&be!==Y&&(mt[be].name="!MiniFAT"),mt[Te[0]].name="!FAT",mt.fat_addrs=Te,mt.ssz=ue;var qe={},xt=[],Bt=[],xr=[];y(le,mt,Ie,xt,me,qe,Bt,be),x(Bt,xr,xt),xt.shift();var $t={FileIndex:Bt,FullPaths:xr};return ge&&ge.raw&&($t.raw={header:xe,sectors:Ie}),$t}function g(Z){if(Z[Z.l]==80&&Z[Z.l+1]==75)return[0,0];Z.chk(se,"Header Signature: "),Z.l+=16;var ge=Z.read_shift(2,"u");return[Z.read_shift(2,"u"),ge]}function h(Z,ge){var oe=9;switch(Z.l+=2,oe=Z.read_shift(2)){case 9:if(ge!=3)throw new Error("Sector Shift: Expected 9 saw "+oe);break;case 12:if(ge!=4)throw new Error("Sector Shift: Expected 12 saw "+oe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+oe)}Z.chk("0600","Mini Sector Shift: "),Z.chk("000000000000","Reserved: ")}function p(Z,ge){for(var oe=Math.ceil(Z.length/ge)-1,ue=[],me=1;me<oe;++me)ue[me-1]=Z.slice(me*ge,(me+1)*ge);return ue[oe-1]=Z.slice(oe*ge),ue}function x(Z,ge,oe){for(var ue=0,me=0,K=0,le=0,be=0,pe=oe.length,Te=[],B=[];ue<pe;++ue)Te[ue]=B[ue]=ue,ge[ue]=oe[ue];for(;be<B.length;++be)ue=B[be],me=Z[ue].L,K=Z[ue].R,le=Z[ue].C,Te[ue]===ue&&(me!==-1&&Te[me]!==me&&(Te[ue]=Te[me]),K!==-1&&Te[K]!==K&&(Te[ue]=Te[K])),le!==-1&&(Te[le]=ue),me!==-1&&ue!=Te[ue]&&(Te[me]=Te[ue],B.lastIndexOf(me)<be&&B.push(me)),K!==-1&&ue!=Te[ue]&&(Te[K]=Te[ue],B.lastIndexOf(K)<be&&B.push(K));for(ue=1;ue<pe;++ue)Te[ue]===ue&&(K!==-1&&Te[K]!==K?Te[ue]=Te[K]:me!==-1&&Te[me]!==me&&(Te[ue]=Te[me]));for(ue=1;ue<pe;++ue)if(Z[ue].type!==0){if(be=ue,be!=Te[be])do be=Te[be],ge[ue]=ge[be]+"/"+ge[ue];while(be!==0&&Te[be]!==-1&&be!=Te[be]);Te[ue]=-1}for(ge[0]+="/",ue=1;ue<pe;++ue)Z[ue].type!==2&&(ge[ue]+="/")}function v(Z,ge,oe){for(var ue=Z.start,me=Z.size,K=[],le=ue;oe&&me>0&&le>=0;)K.push(ge.slice(le*I,le*I+I)),me-=I,le=fu(oe,le*4);return K.length===0?Qe(0):gs(K).slice(0,Z.size)}function w(Z,ge,oe,ue,me){var K=Y;if(Z===Y){if(ge!==0)throw new Error("DIFAT chain shorter than expected")}else if(Z!==-1){var le=oe[Z],be=(ue>>>2)-1;if(!le)return;for(var pe=0;pe<be&&(K=fu(le,pe*4))!==Y;++pe)me.push(K);w(fu(le,ue-4),ge-1,oe,ue,me)}}function S(Z,ge,oe,ue,me){var K=[],le=[];me||(me=[]);var be=ue-1,pe=0,Te=0;for(pe=ge;pe>=0;){me[pe]=!0,K[K.length]=pe,le.push(Z[pe]);var B=oe[Math.floor(pe*4/ue)];if(Te=pe*4&be,ue<4+Te)throw new Error("FAT boundary crossed: "+pe+" 4 "+ue);if(!Z[B])break;pe=fu(Z[B],Te)}return{nodes:K,data:$8([le])}}function _(Z,ge,oe,ue){var me=Z.length,K=[],le=[],be=[],pe=[],Te=ue-1,B=0,ie=0,xe=0,ce=0;for(B=0;B<me;++B)if(be=[],xe=B+ge,xe>=me&&(xe-=me),!le[xe]){pe=[];var Ce=[];for(ie=xe;ie>=0;){Ce[ie]=!0,le[ie]=!0,be[be.length]=ie,pe.push(Z[ie]);var Oe=oe[Math.floor(ie*4/ue)];if(ce=ie*4&Te,ue<4+ce)throw new Error("FAT boundary crossed: "+ie+" 4 "+ue);if(!Z[Oe]||(ie=fu(Z[Oe],ce),Ce[ie]))break}K[xe]={nodes:be,data:$8([pe])}}return K}function y(Z,ge,oe,ue,me,K,le,be){for(var pe=0,Te=ue.length?2:0,B=ge[Z].data,ie=0,xe=0,ce;ie<B.length;ie+=128){var Ce=B.slice(ie,ie+128);ks(Ce,64),xe=Ce.read_shift(2),ce=o4(Ce,0,xe-Te),ue.push(ce);var Oe={name:ce,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},Ie=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Ie!==0&&(Oe.ct=k(Ce,Ce.l-8));var mt=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);mt!==0&&(Oe.mt=k(Ce,Ce.l-8)),Oe.start=Ce.read_shift(4,"i"),Oe.size=Ce.read_shift(4,"i"),Oe.size<0&&Oe.start<0&&(Oe.size=Oe.type=0,Oe.start=Y,Oe.name=""),Oe.type===5?(pe=Oe.start,me>0&&pe!==Y&&(ge[pe].name="!StreamData")):Oe.size>=4096?(Oe.storage="fat",ge[Oe.start]===void 0&&(ge[Oe.start]=S(oe,Oe.start,ge.fat_addrs,ge.ssz)),ge[Oe.start].name=Oe.name,Oe.content=ge[Oe.start].data.slice(0,Oe.size)):(Oe.storage="minifat",Oe.size<0?Oe.size=0:pe!==Y&&Oe.start!==Y&&ge[pe]&&(Oe.content=v(Oe,ge[pe].data,(ge[be]||{}).data))),Oe.content&&ks(Oe.content,0),K[ce]=Oe,le.push(Oe)}}function k(Z,ge){return new Date((La(Z,ge+4)/1e7*Math.pow(2,32)+La(Z,ge)/1e7-11644473600)*1e3)}function N(Z,ge){return u(),d(l.readFileSync(Z),ge)}function E(Z,ge){var oe=ge&&ge.type;switch(oe||fr&&Buffer.isBuffer(Z)&&(oe="buffer"),oe||"base64"){case"file":return N(Z,ge);case"base64":return d(Ba(Ga(Z)),ge);case"binary":return d(Ba(Z),ge)}return d(Z,ge)}function A(Z,ge){var oe=ge||{},ue=oe.root||"Root Entry";if(Z.FullPaths||(Z.FullPaths=[]),Z.FileIndex||(Z.FileIndex=[]),Z.FullPaths.length!==Z.FileIndex.length)throw new Error("inconsistent CFB structure");Z.FullPaths.length===0&&(Z.FullPaths[0]=ue+"/",Z.FileIndex[0]={name:ue,type:5}),oe.CLSID&&(Z.FileIndex[0].clsid=oe.CLSID),C(Z)}function C(Z){var ge="Sh33tJ5";if(!Wt.find(Z,"/"+ge)){var oe=Qe(4);oe[0]=55,oe[1]=oe[3]=50,oe[2]=54,Z.FileIndex.push({name:ge,type:2,content:oe,size:4,L:69,R:69,C:69}),Z.FullPaths.push(Z.FullPaths[0]+ge),F(Z)}}function F(Z,ge){A(Z);for(var oe=!1,ue=!1,me=Z.FullPaths.length-1;me>=0;--me){var K=Z.FileIndex[me];switch(K.type){case 0:ue?oe=!0:(Z.FileIndex.pop(),Z.FullPaths.pop());break;case 1:case 2:case 5:ue=!0,isNaN(K.R*K.L*K.C)&&(oe=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(oe=!0);break;default:oe=!0;break}}if(!(!oe&&!ge)){var le=new Date(1987,1,19),be=0,pe=Object.create?Object.create(null):{},Te=[];for(me=0;me<Z.FullPaths.length;++me)pe[Z.FullPaths[me]]=!0,Z.FileIndex[me].type!==0&&Te.push([Z.FullPaths[me],Z.FileIndex[me]]);for(me=0;me<Te.length;++me){var B=n(Te[me][0]);ue=pe[B],ue||(Te.push([B,{name:s(B).replace("/",""),type:1,clsid:z,ct:le,mt:le,content:null}]),pe[B]=!0)}for(Te.sort(function(ce,Ce){return r(ce[0],Ce[0])}),Z.FullPaths=[],Z.FileIndex=[],me=0;me<Te.length;++me)Z.FullPaths[me]=Te[me][0],Z.FileIndex[me]=Te[me][1];for(me=0;me<Te.length;++me){var ie=Z.FileIndex[me],xe=Z.FullPaths[me];if(ie.name=s(xe).replace("/",""),ie.L=ie.R=ie.C=-(ie.color=1),ie.size=ie.content?ie.content.length:0,ie.start=0,ie.clsid=ie.clsid||z,me===0)ie.C=Te.length>1?1:-1,ie.size=0,ie.type=5;else if(xe.slice(-1)=="/"){for(be=me+1;be<Te.length&&n(Z.FullPaths[be])!=xe;++be);for(ie.C=be>=Te.length?-1:be,be=me+1;be<Te.length&&n(Z.FullPaths[be])!=n(xe);++be);ie.R=be>=Te.length?-1:be,ie.type=1}else n(Z.FullPaths[me+1]||"")==n(xe)&&(ie.R=me+1),ie.type=2}}}function P(Z,ge){var oe=ge||{};if(oe.fileType=="mad")return Jt(Z,oe);switch(F(Z),oe.fileType){case"zip":return ee(Z,oe)}var ue=function(ce){for(var Ce=0,Oe=0,Ie=0;Ie<ce.FileIndex.length;++Ie){var mt=ce.FileIndex[Ie];if(mt.content){var qe=mt.content.length;qe>0&&(qe<4096?Ce+=qe+63>>6:Oe+=qe+511>>9)}}for(var xt=ce.FullPaths.length+3>>2,Bt=Ce+7>>3,xr=Ce+127>>7,$t=Bt+Oe+xt+xr,Ht=$t+127>>7,Pt=Ht<=109?0:Math.ceil((Ht-109)/127);$t+Ht+Pt+127>>7>Ht;)Pt=++Ht<=109?0:Math.ceil((Ht-109)/127);var jt=[1,Pt,Ht,xr,xt,Oe,Ce,0];return ce.FileIndex[0].size=Ce<<6,jt[7]=(ce.FileIndex[0].start=jt[0]+jt[1]+jt[2]+jt[3]+jt[4]+jt[5])+(jt[6]+7>>3),jt}(Z),me=Qe(ue[7]<<9),K=0,le=0;{for(K=0;K<8;++K)me.write_shift(1,L[K]);for(K=0;K<8;++K)me.write_shift(2,0);for(me.write_shift(2,62),me.write_shift(2,3),me.write_shift(2,65534),me.write_shift(2,9),me.write_shift(2,6),K=0;K<3;++K)me.write_shift(2,0);for(me.write_shift(4,0),me.write_shift(4,ue[2]),me.write_shift(4,ue[0]+ue[1]+ue[2]+ue[3]-1),me.write_shift(4,0),me.write_shift(4,4096),me.write_shift(4,ue[3]?ue[0]+ue[1]+ue[2]-1:Y),me.write_shift(4,ue[3]),me.write_shift(-4,ue[1]?ue[0]-1:Y),me.write_shift(4,ue[1]),K=0;K<109;++K)me.write_shift(-4,K<ue[2]?ue[1]+K:-1)}if(ue[1])for(le=0;le<ue[1];++le){for(;K<236+le*127;++K)me.write_shift(-4,K<ue[2]?ue[1]+K:-1);me.write_shift(-4,le===ue[1]-1?Y:le+1)}var be=function(ce){for(le+=ce;K<le-1;++K)me.write_shift(-4,K+1);ce&&(++K,me.write_shift(-4,Y))};for(le=K=0,le+=ue[1];K<le;++K)me.write_shift(-4,G.DIFSECT);for(le+=ue[2];K<le;++K)me.write_shift(-4,G.FATSECT);be(ue[3]),be(ue[4]);for(var pe=0,Te=0,B=Z.FileIndex[0];pe<Z.FileIndex.length;++pe)B=Z.FileIndex[pe],B.content&&(Te=B.content.length,!(Te<4096)&&(B.start=le,be(Te+511>>9)));for(be(ue[6]+7>>3);me.l&511;)me.write_shift(-4,G.ENDOFCHAIN);for(le=K=0,pe=0;pe<Z.FileIndex.length;++pe)B=Z.FileIndex[pe],B.content&&(Te=B.content.length,!(!Te||Te>=4096)&&(B.start=le,be(Te+63>>6)));for(;me.l&511;)me.write_shift(-4,G.ENDOFCHAIN);for(K=0;K<ue[4]<<2;++K){var ie=Z.FullPaths[K];if(!ie||ie.length===0){for(pe=0;pe<17;++pe)me.write_shift(4,0);for(pe=0;pe<3;++pe)me.write_shift(4,-1);for(pe=0;pe<12;++pe)me.write_shift(4,0);continue}B=Z.FileIndex[K],K===0&&(B.start=B.size?B.start-1:Y);var xe=K===0&&oe.root||B.name;if(Te=2*(xe.length+1),me.write_shift(64,xe,"utf16le"),me.write_shift(2,Te),me.write_shift(1,B.type),me.write_shift(1,B.color),me.write_shift(-4,B.L),me.write_shift(-4,B.R),me.write_shift(-4,B.C),B.clsid)me.write_shift(16,B.clsid,"hex");else for(pe=0;pe<4;++pe)me.write_shift(4,0);me.write_shift(4,B.state||0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,0),me.write_shift(4,B.start),me.write_shift(4,B.size),me.write_shift(4,0)}for(K=1;K<Z.FileIndex.length;++K)if(B=Z.FileIndex[K],B.size>=4096)if(me.l=B.start+1<<9,fr&&Buffer.isBuffer(B.content))B.content.copy(me,me.l,0,B.size),me.l+=B.size+511&-512;else{for(pe=0;pe<B.size;++pe)me.write_shift(1,B.content[pe]);for(;pe&511;++pe)me.write_shift(1,0)}for(K=1;K<Z.FileIndex.length;++K)if(B=Z.FileIndex[K],B.size>0&&B.size<4096)if(fr&&Buffer.isBuffer(B.content))B.content.copy(me,me.l,0,B.size),me.l+=B.size+63&-64;else{for(pe=0;pe<B.size;++pe)me.write_shift(1,B.content[pe]);for(;pe&63;++pe)me.write_shift(1,0)}if(fr)me.l=me.length;else for(;me.l<me.length;)me.write_shift(1,0);return me}function M(Z,ge){var oe=Z.FullPaths.map(function(pe){return pe.toUpperCase()}),ue=oe.map(function(pe){var Te=pe.split("/");return Te[Te.length-(pe.slice(-1)=="/"?2:1)]}),me=!1;ge.charCodeAt(0)===47?(me=!0,ge=oe[0].slice(0,-1)+ge):me=ge.indexOf("/")!==-1;var K=ge.toUpperCase(),le=me===!0?oe.indexOf(K):ue.indexOf(K);if(le!==-1)return Z.FileIndex[le];var be=!K.match(T0);for(K=K.replace(ca,""),be&&(K=K.replace(T0,"!")),le=0;le<oe.length;++le)if((be?oe[le].replace(T0,"!"):oe[le]).replace(ca,"")==K||(be?ue[le].replace(T0,"!"):ue[le]).replace(ca,"")==K)return Z.FileIndex[le];return null}var I=64,Y=-2,se="d0cf11e0a1b11ae1",L=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",G={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:se,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function O(Z,ge,oe){u();var ue=P(Z,oe);l.writeFileSync(ge,ue)}function R(Z){for(var ge=new Array(Z.length),oe=0;oe<Z.length;++oe)ge[oe]=String.fromCharCode(Z[oe]);return ge.join("")}function X(Z,ge){var oe=P(Z,ge);switch(ge&&ge.type||"buffer"){case"file":return u(),l.writeFileSync(ge.filename,oe),oe;case"binary":return typeof oe=="string"?oe:R(oe);case"base64":return Ug(typeof oe=="string"?oe:R(oe));case"buffer":if(fr)return Buffer.isBuffer(oe)?oe:jl(oe);case"array":return typeof oe=="string"?Ba(oe):oe}return oe}var te;function H(Z){try{var ge=Z.InflateRaw,oe=new ge;if(oe._processChunk(new Uint8Array([3,0]),oe._finishFlushFlag),oe.bytesRead)te=Z;else throw new Error("zlib does not expose bytesRead")}catch(ue){console.error("cannot use native zlib: "+(ue.message||ue))}}function V(Z,ge){if(!te)return ut(Z,ge);var oe=te.InflateRaw,ue=new oe,me=ue._processChunk(Z.slice(Z.l),ue._finishFlushFlag);return Z.l+=ue.bytesRead,me}function q(Z){return te?te.deflateRawSync(Z):et(Z)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ae=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],J=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(Z){var ge=(Z<<1|Z<<11)&139536|(Z<<5|Z<<15)&558144;return(ge>>16|ge>>8|ge)&255}for(var ve=typeof Uint8Array<"u",we=ve?new Uint8Array(256):[],Fe=0;Fe<256;++Fe)we[Fe]=re(Fe);function ne(Z,ge){var oe=we[Z&255];return ge<=8?oe>>>8-ge:(oe=oe<<8|we[Z>>8&255],ge<=16?oe>>>16-ge:(oe=oe<<8|we[Z>>16&255],oe>>>24-ge))}function Ee(Z,ge){var oe=ge&7,ue=ge>>>3;return(Z[ue]|(oe<=6?0:Z[ue+1]<<8))>>>oe&3}function ke(Z,ge){var oe=ge&7,ue=ge>>>3;return(Z[ue]|(oe<=5?0:Z[ue+1]<<8))>>>oe&7}function He(Z,ge){var oe=ge&7,ue=ge>>>3;return(Z[ue]|(oe<=4?0:Z[ue+1]<<8))>>>oe&15}function at(Z,ge){var oe=ge&7,ue=ge>>>3;return(Z[ue]|(oe<=3?0:Z[ue+1]<<8))>>>oe&31}function Me(Z,ge){var oe=ge&7,ue=ge>>>3;return(Z[ue]|(oe<=1?0:Z[ue+1]<<8))>>>oe&127}function Ft(Z,ge,oe){var ue=ge&7,me=ge>>>3,K=(1<<oe)-1,le=Z[me]>>>ue;return oe<8-ue||(le|=Z[me+1]<<8-ue,oe<16-ue)||(le|=Z[me+2]<<16-ue,oe<24-ue)||(le|=Z[me+3]<<24-ue),le&K}function Ut(Z,ge,oe){var ue=ge&7,me=ge>>>3;return ue<=5?Z[me]|=(oe&7)<<ue:(Z[me]|=oe<<ue&255,Z[me+1]=(oe&7)>>8-ue),ge+3}function Pe(Z,ge,oe){var ue=ge&7,me=ge>>>3;return oe=(oe&1)<<ue,Z[me]|=oe,ge+1}function Re(Z,ge,oe){var ue=ge&7,me=ge>>>3;return oe<<=ue,Z[me]|=oe&255,oe>>>=8,Z[me+1]=oe,ge+8}function $e(Z,ge,oe){var ue=ge&7,me=ge>>>3;return oe<<=ue,Z[me]|=oe&255,oe>>>=8,Z[me+1]=oe&255,Z[me+2]=oe>>>8,ge+16}function Be(Z,ge){var oe=Z.length,ue=2*oe>ge?2*oe:ge+5,me=0;if(oe>=ge)return Z;if(fr){var K=b8(ue);if(Z.copy)Z.copy(K);else for(;me<Z.length;++me)K[me]=Z[me];return K}else if(ve){var le=new Uint8Array(ue);if(le.set)le.set(Z);else for(;me<oe;++me)le[me]=Z[me];return le}return Z.length=ue,Z}function Ge(Z){for(var ge=new Array(Z),oe=0;oe<Z;++oe)ge[oe]=0;return ge}function ht(Z,ge,oe){var ue=1,me=0,K=0,le=0,be=0,pe=Z.length,Te=ve?new Uint16Array(32):Ge(32);for(K=0;K<32;++K)Te[K]=0;for(K=pe;K<oe;++K)Z[K]=0;pe=Z.length;var B=ve?new Uint16Array(pe):Ge(pe);for(K=0;K<pe;++K)Te[me=Z[K]]++,ue<me&&(ue=me),B[K]=0;for(Te[0]=0,K=1;K<=ue;++K)Te[K+16]=be=be+Te[K-1]<<1;for(K=0;K<pe;++K)be=Z[K],be!=0&&(B[K]=Te[be+16]++);var ie=0;for(K=0;K<pe;++K)if(ie=Z[K],ie!=0)for(be=ne(B[K],ue)>>ue-ie,le=(1<<ue+4-ie)-1;le>=0;--le)ge[be|le<<ie]=ie&15|K<<4;return ue}var Nt=ve?new Uint16Array(512):Ge(512),Ye=ve?new Uint16Array(32):Ge(32);if(!ve){for(var Ve=0;Ve<512;++Ve)Nt[Ve]=0;for(Ve=0;Ve<32;++Ve)Ye[Ve]=0}(function(){for(var Z=[],ge=0;ge<32;ge++)Z.push(5);ht(Z,Ye,32);var oe=[];for(ge=0;ge<=143;ge++)oe.push(8);for(;ge<=255;ge++)oe.push(9);for(;ge<=279;ge++)oe.push(7);for(;ge<=287;ge++)oe.push(8);ht(oe,Nt,288)})();var ot=function(){for(var ge=ve?new Uint8Array(32768):[],oe=0,ue=0;oe<J.length-1;++oe)for(;ue<J[oe+1];++ue)ge[ue]=oe;for(;ue<32768;++ue)ge[ue]=29;var me=ve?new Uint8Array(259):[];for(oe=0,ue=0;oe<ae.length-1;++oe)for(;ue<ae[oe+1];++ue)me[ue]=oe;function K(be,pe){for(var Te=0;Te<be.length;){var B=Math.min(65535,be.length-Te),ie=Te+B==be.length;for(pe.write_shift(1,+ie),pe.write_shift(2,B),pe.write_shift(2,~B&65535);B-- >0;)pe[pe.l++]=be[Te++]}return pe.l}function le(be,pe){for(var Te=0,B=0,ie=ve?new Uint16Array(32768):[];B<be.length;){var xe=Math.min(65535,be.length-B);if(xe<10){for(Te=Ut(pe,Te,+(B+xe==be.length)),Te&7&&(Te+=8-(Te&7)),pe.l=Te/8|0,pe.write_shift(2,xe),pe.write_shift(2,~xe&65535);xe-- >0;)pe[pe.l++]=be[B++];Te=pe.l*8;continue}Te=Ut(pe,Te,+(B+xe==be.length)+2);for(var ce=0;xe-- >0;){var Ce=be[B];ce=(ce<<5^Ce)&32767;var Oe=-1,Ie=0;if((Oe=ie[ce])&&(Oe|=B&-32768,Oe>B&&(Oe-=32768),Oe<B))for(;be[Oe+Ie]==be[B+Ie]&&Ie<250;)++Ie;if(Ie>2){Ce=me[Ie],Ce<=22?Te=Re(pe,Te,we[Ce+1]>>1)-1:(Re(pe,Te,3),Te+=5,Re(pe,Te,we[Ce-23]>>5),Te+=3);var mt=Ce<8?0:Ce-4>>2;mt>0&&($e(pe,Te,Ie-ae[Ce]),Te+=mt),Ce=ge[B-Oe],Te=Re(pe,Te,we[Ce]>>3),Te-=3;var qe=Ce<4?0:Ce-2>>1;qe>0&&($e(pe,Te,B-Oe-J[Ce]),Te+=qe);for(var xt=0;xt<Ie;++xt)ie[ce]=B&32767,ce=(ce<<5^be[B])&32767,++B;xe-=Ie-1}else Ce<=143?Ce=Ce+48:Te=Pe(pe,Te,1),Te=Re(pe,Te,we[Ce]),ie[ce]=B&32767,++B}Te=Re(pe,Te,0)-1}return pe.l=(Te+7)/8|0,pe.l}return function(pe,Te){return pe.length<8?K(pe,Te):le(pe,Te)}}();function et(Z){var ge=Qe(50+Math.floor(Z.length*1.1)),oe=ot(Z,ge);return ge.slice(0,oe)}var nt=ve?new Uint16Array(32768):Ge(32768),gt=ve?new Uint16Array(32768):Ge(32768),Et=ve?new Uint16Array(128):Ge(128),Ne=1,Ke=1;function Ze(Z,ge){var oe=at(Z,ge)+257;ge+=5;var ue=at(Z,ge)+1;ge+=5;var me=He(Z,ge)+4;ge+=4;for(var K=0,le=ve?new Uint8Array(19):Ge(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],pe=1,Te=ve?new Uint8Array(8):Ge(8),B=ve?new Uint8Array(8):Ge(8),ie=le.length,xe=0;xe<me;++xe)le[Q[xe]]=K=ke(Z,ge),pe<K&&(pe=K),Te[K]++,ge+=3;var ce=0;for(Te[0]=0,xe=1;xe<=pe;++xe)B[xe]=ce=ce+Te[xe-1]<<1;for(xe=0;xe<ie;++xe)(ce=le[xe])!=0&&(be[xe]=B[ce]++);var Ce=0;for(xe=0;xe<ie;++xe)if(Ce=le[xe],Ce!=0){ce=we[be[xe]]>>8-Ce;for(var Oe=(1<<7-Ce)-1;Oe>=0;--Oe)Et[ce|Oe<<Ce]=Ce&7|xe<<3}var Ie=[];for(pe=1;Ie.length<oe+ue;)switch(ce=Et[Me(Z,ge)],ge+=ce&7,ce>>>=3){case 16:for(K=3+Ee(Z,ge),ge+=2,ce=Ie[Ie.length-1];K-- >0;)Ie.push(ce);break;case 17:for(K=3+ke(Z,ge),ge+=3;K-- >0;)Ie.push(0);break;case 18:for(K=11+Me(Z,ge),ge+=7;K-- >0;)Ie.push(0);break;default:Ie.push(ce),pe<ce&&(pe=ce);break}var mt=Ie.slice(0,oe),qe=Ie.slice(oe);for(xe=oe;xe<286;++xe)mt[xe]=0;for(xe=ue;xe<30;++xe)qe[xe]=0;return Ne=ht(mt,nt,286),Ke=ht(qe,gt,30),ge}function ft(Z,ge){if(Z[0]==3&&!(Z[1]&3))return[Cc(ge),2];for(var oe=0,ue=0,me=b8(ge||1<<18),K=0,le=me.length>>>0,be=0,pe=0;!(ue&1);){if(ue=ke(Z,oe),oe+=3,ue>>>1)ue>>1==1?(be=9,pe=5):(oe=Ze(Z,oe),be=Ne,pe=Ke);else{oe&7&&(oe+=8-(oe&7));var Te=Z[oe>>>3]|Z[(oe>>>3)+1]<<8;if(oe+=32,Te>0)for(!ge&&le<K+Te&&(me=Be(me,K+Te),le=me.length);Te-- >0;)me[K++]=Z[oe>>>3],oe+=8;continue}for(;;){!ge&&le<K+32767&&(me=Be(me,K+32767),le=me.length);var B=Ft(Z,oe,be),ie=ue>>>1==1?Nt[B]:nt[B];if(oe+=ie&15,ie>>>=4,!(ie>>>8&255))me[K++]=ie;else{if(ie==256)break;ie-=257;var xe=ie<8?0:ie-4>>2;xe>5&&(xe=0);var ce=K+ae[ie];xe>0&&(ce+=Ft(Z,oe,xe),oe+=xe),B=Ft(Z,oe,pe),ie=ue>>>1==1?Ye[B]:gt[B],oe+=ie&15,ie>>>=4;var Ce=ie<4?0:ie-2>>1,Oe=J[ie];for(Ce>0&&(Oe+=Ft(Z,oe,Ce),oe+=Ce),!ge&&le<ce&&(me=Be(me,ce+100),le=me.length);K<ce;)me[K]=me[K-Oe],++K}}}return ge?[me,oe+7>>>3]:[me.slice(0,K),oe+7>>>3]}function ut(Z,ge){var oe=Z.slice(Z.l||0),ue=ft(oe,ge);return Z.l+=ue[1],ue[0]}function bt(Z,ge){if(Z)typeof console<"u"&&console.error(ge);else throw new Error(ge)}function ye(Z,ge){var oe=Z;ks(oe,0);var ue=[],me=[],K={FileIndex:ue,FullPaths:me};A(K,{root:ge.root});for(var le=oe.length-4;(oe[le]!=80||oe[le+1]!=75||oe[le+2]!=5||oe[le+3]!=6)&&le>=0;)--le;oe.l=le+4,oe.l+=4;var be=oe.read_shift(2);oe.l+=6;var pe=oe.read_shift(4);for(oe.l=pe,le=0;le<be;++le){oe.l+=20;var Te=oe.read_shift(4),B=oe.read_shift(4),ie=oe.read_shift(2),xe=oe.read_shift(2),ce=oe.read_shift(2);oe.l+=8;var Ce=oe.read_shift(4),Oe=o(oe.slice(oe.l+ie,oe.l+ie+xe));oe.l+=ie+xe+ce;var Ie=oe.l;oe.l=Ce+4,de(oe,Te,B,K,Oe),oe.l=Ie}return K}function de(Z,ge,oe,ue,me){Z.l+=2;var K=Z.read_shift(2),le=Z.read_shift(2),be=i(Z);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var pe=Z.read_shift(4),Te=Z.read_shift(4),B=Z.read_shift(4),ie=Z.read_shift(2),xe=Z.read_shift(2),ce="",Ce=0;Ce<ie;++Ce)ce+=String.fromCharCode(Z[Z.l++]);if(xe){var Oe=o(Z.slice(Z.l,Z.l+xe));(Oe[21589]||{}).mt&&(be=Oe[21589].mt),((me||{})[21589]||{}).mt&&(be=me[21589].mt)}Z.l+=xe;var Ie=Z.slice(Z.l,Z.l+Te);switch(le){case 8:Ie=V(Z,B);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+le)}var mt=!1;K&8&&(pe=Z.read_shift(4),pe==134695760&&(pe=Z.read_shift(4),mt=!0),Te=Z.read_shift(4),B=Z.read_shift(4)),Te!=ge&&bt(mt,"Bad compressed size: "+ge+" != "+Te),B!=oe&&bt(mt,"Bad uncompressed size: "+oe+" != "+B),zt(ue,ce,Ie,{unsafe:!0,mt:be})}function ee(Z,ge){var oe=ge||{},ue=[],me=[],K=Qe(1),le=oe.compression?8:0,be=0,pe=0,Te=0,B=0,ie=0,xe=Z.FullPaths[0],ce=xe,Ce=Z.FileIndex[0],Oe=[],Ie=0;for(pe=1;pe<Z.FullPaths.length;++pe)if(ce=Z.FullPaths[pe].slice(xe.length),Ce=Z.FileIndex[pe],!(!Ce.size||!Ce.content||ce=="Sh33tJ5")){var mt=B,qe=Qe(ce.length);for(Te=0;Te<ce.length;++Te)qe.write_shift(1,ce.charCodeAt(Te)&127);qe=qe.slice(0,qe.l),Oe[ie]=rse.buf(Ce.content,0);var xt=Ce.content;le==8&&(xt=q(xt)),K=Qe(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,be),K.write_shift(2,le),Ce.mt?a(K,Ce.mt):K.write_shift(4,0),K.write_shift(-4,Oe[ie]),K.write_shift(4,xt.length),K.write_shift(4,Ce.content.length),K.write_shift(2,qe.length),K.write_shift(2,0),B+=K.length,ue.push(K),B+=qe.length,ue.push(qe),B+=xt.length,ue.push(xt),K=Qe(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,be),K.write_shift(2,le),K.write_shift(4,0),K.write_shift(-4,Oe[ie]),K.write_shift(4,xt.length),K.write_shift(4,Ce.content.length),K.write_shift(2,qe.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,mt),Ie+=K.l,me.push(K),Ie+=qe.length,me.push(qe),++ie}return K=Qe(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,ie),K.write_shift(2,ie),K.write_shift(4,Ie),K.write_shift(4,B),K.write_shift(2,0),gs([gs(ue),gs(me),K])}var he={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ae(Z,ge){if(Z.ctype)return Z.ctype;var oe=Z.name||"",ue=oe.match(/\.([^\.]+)$/);return ue&&he[ue[1]]||ge&&(ue=(oe=ge).match(/[\.\\]([^\.\\])+$/),ue&&he[ue[1]])?he[ue[1]]:"application/octet-stream"}function st(Z){for(var ge=Ug(Z),oe=[],ue=0;ue<ge.length;ue+=76)oe.push(ge.slice(ue,ue+76));return oe.join(`\r
`)+`\r
`}function rt(Z){var ge=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Te){var B=Te.charCodeAt(0).toString(16).toUpperCase();return"="+(B.length==1?"0"+B:B)});ge=ge.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ge.charAt(0)==`
`&&(ge="=0D"+ge.slice(1)),ge=ge.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var oe=[],ue=ge.split(`\r
`),me=0;me<ue.length;++me){var K=ue[me];if(K.length==0){oe.push("");continue}for(var le=0;le<K.length;){var be=76,pe=K.slice(le,le+be);pe.charAt(be-1)=="="?be--:pe.charAt(be-2)=="="?be-=2:pe.charAt(be-3)=="="&&(be-=3),pe=K.slice(le,le+be),le+=be,le<K.length&&(pe+="="),oe.push(pe)}}return oe.join(`\r
`)}function At(Z){for(var ge=[],oe=0;oe<Z.length;++oe){for(var ue=Z[oe];oe<=Z.length&&ue.charAt(ue.length-1)=="=";)ue=ue.slice(0,ue.length-1)+Z[++oe];ge.push(ue)}for(var me=0;me<ge.length;++me)ge[me]=ge[me].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return Ba(ge.join(`\r
`))}function yt(Z,ge,oe){for(var ue="",me="",K="",le,be=0;be<10;++be){var pe=ge[be];if(!pe||pe.match(/^\s*$/))break;var Te=pe.match(/^(.*?):\s*([^\s].*)$/);if(Te)switch(Te[1].toLowerCase()){case"content-location":ue=Te[2].trim();break;case"content-type":K=Te[2].trim();break;case"content-transfer-encoding":me=Te[2].trim();break}}switch(++be,me.toLowerCase()){case"base64":le=Ba(Ga(ge.slice(be).join("")));break;case"quoted-printable":le=At(ge.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+me)}var B=zt(Z,ue.slice(oe.length),le,{unsafe:!0});K&&(B.ctype=K)}function wt(Z,ge){if(R(Z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var oe=ge&&ge.root||"",ue=(fr&&Buffer.isBuffer(Z)?Z.toString("binary"):R(Z)).split(`\r
`),me=0,K="";for(me=0;me<ue.length;++me)if(K=ue[me],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),oe||(oe=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,oe.length)!=oe))for(;oe.length>0&&(oe=oe.slice(0,oe.length-1),oe=oe.slice(0,oe.lastIndexOf("/")+1),K.slice(0,oe.length)!=oe););var le=(ue[1]||"").match(/boundary="(.*?)"/);if(!le)throw new Error("MAD cannot find boundary");var be="--"+(le[1]||""),pe=[],Te=[],B={FileIndex:pe,FullPaths:Te};A(B);var ie,xe=0;for(me=0;me<ue.length;++me){var ce=ue[me];ce!==be&&ce!==be+"--"||(xe++&&yt(B,ue.slice(ie,me),oe),ie=me)}return B}function Jt(Z,ge){var oe=ge||{},ue=oe.boundary||"SheetJS";ue="------="+ue;for(var me=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ue.slice(2)+'"',"","",""],K=Z.FullPaths[0],le=K,be=Z.FileIndex[0],pe=1;pe<Z.FullPaths.length;++pe)if(le=Z.FullPaths[pe].slice(K.length),be=Z.FileIndex[pe],!(!be.size||!be.content||le=="Sh33tJ5")){le=le.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ie){return"_x"+Ie.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ie){return"_u"+Ie.charCodeAt(0).toString(16)+"_"});for(var Te=be.content,B=fr&&Buffer.isBuffer(Te)?Te.toString("binary"):R(Te),ie=0,xe=Math.min(1024,B.length),ce=0,Ce=0;Ce<=xe;++Ce)(ce=B.charCodeAt(Ce))>=32&&ce<128&&++ie;var Oe=ie>=xe*4/5;me.push(ue),me.push("Content-Location: "+(oe.root||"file:///C:/SheetJS/")+le),me.push("Content-Transfer-Encoding: "+(Oe?"quoted-printable":"base64")),me.push("Content-Type: "+Ae(be,le)),me.push(""),me.push(Oe?rt(B):st(B))}return me.push(ue+`--\r
`),me.join(`\r
`)}function dr(Z){var ge={};return A(ge,Z),ge}function zt(Z,ge,oe,ue){var me=ue&&ue.unsafe;me||A(Z);var K=!me&&Wt.find(Z,ge);if(!K){var le=Z.FullPaths[0];ge.slice(0,le.length)==le?le=ge:(le.slice(-1)!="/"&&(le+="/"),le=(le+ge).replace("//","/")),K={name:s(ge),type:2},Z.FileIndex.push(K),Z.FullPaths.push(le),me||Wt.utils.cfb_gc(Z)}return K.content=oe,K.size=oe?oe.length:0,ue&&(ue.CLSID&&(K.clsid=ue.CLSID),ue.mt&&(K.mt=ue.mt),ue.ct&&(K.ct=ue.ct)),K}function er(Z,ge){A(Z);var oe=Wt.find(Z,ge);if(oe){for(var ue=0;ue<Z.FileIndex.length;++ue)if(Z.FileIndex[ue]==oe)return Z.FileIndex.splice(ue,1),Z.FullPaths.splice(ue,1),!0}return!1}function pr(Z,ge,oe){A(Z);var ue=Wt.find(Z,ge);if(ue){for(var me=0;me<Z.FileIndex.length;++me)if(Z.FileIndex[me]==ue)return Z.FileIndex[me].name=s(oe),Z.FullPaths[me]=oe,!0}return!1}function _n(Z){F(Z,!0)}return e.find=M,e.read=E,e.parse=d,e.write=X,e.writeFile=O,e.utils={cfb_new:dr,cfb_add:zt,cfb_del:er,cfb_mov:pr,cfb_gc:_n,ReadShift:X0,CheckField:EI,prep_blob:ks,bconcat:gs,use_zlib:H,_deflateRaw:et,_inflateRaw:ut,consts:G},e}();function nse(t){return typeof t=="string"?Uv(t):Array.isArray(t)?Ane(t):t}function Fm(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Uv(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?To(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var s=new Blob([nse(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,t);if(typeof saveAs<"u")return saveAs(s,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:t,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=t,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Gc(e)),o.write(e),o.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function sse(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function jn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function j8(t,e){for(var r=[],n=jn(t),s=0;s!==n.length;++s)r[t[n[s]][e]]==null&&(r[t[n[s]][e]]=n[s]);return r}function Wv(t){for(var e=[],r=jn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Hv(t){for(var e=[],r=jn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function ase(t){for(var e=[],r=jn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Z1=new Date(1899,11,30,0,0,0);function ns(t,e){var r=t.getTime(),n=Z1.getTime()+(t.getTimezoneOffset()-Z1.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var iI=new Date,ise=Z1.getTime()+(iI.getTimezoneOffset()-Z1.getTimezoneOffset())*6e4,F8=iI.getTimezoneOffset();function zv(t){var e=new Date;return e.setTime(t*24*60*60*1e3+ise),e.getTimezoneOffset()!==F8&&e.setTime(e.getTime()+(e.getTimezoneOffset()-F8)*6e4),e}function ose(t){var e=0,r=0,n=!1,s=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(s[a],10)}return e}var P8=new Date("2017-02-19T19:06:09.000Z"),oI=isNaN(P8.getFullYear())?new Date("2/19/17"):P8,lse=oI.getFullYear()==2017;function en(t,e){var r=new Date(t);if(lse)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(oI.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=t.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return t.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Zu(t,e){if(fr&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return To(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return To(XM(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return To(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return To(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=t.length;++s)n.push(String.fromCharCode(t[s]));return n.join("")}function tn(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=tn(t[r]));return e}function En(t,e){for(var r="";r.length<e;)r+=t;return r}function Qi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(e=Number(n)))?e/r:e}var cse=["january","february","march","april","may","june","july","august","september","october","november","december"];function rh(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),s=e.getMonth(),a=e.getDate();if(isNaN(a))return r;var i=t.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&cse.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var use=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(t||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function lI(t){return t?t.content&&t.type?Zu(t.content,!0):t.data?C0(t.data):t.asNodeBuffer&&fr?C0(t.asNodeBuffer().toString("binary")):t.asBinary?C0(t.asBinary()):t._data&&t._data.getContent?C0(Zu(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function cI(t){if(!t)return null;if(t.data)return w8(t.data);if(t.asNodeBuffer&&fr)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?w8(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function dse(t){return t&&t.name.slice(-4)===".bin"?cI(t):lI(t)}function hi(t,e){for(var r=t.FullPaths||jn(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return t.files?t.files[r[a]]:t.FileIndex[a]}return null}function t4(t,e){var r=hi(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Wn(t,e,r){if(!r)return dse(t4(t,e));if(!e)return null;try{return Wn(t,e)}catch{return null}}function Ua(t,e,r){if(!r)return lI(t4(t,e));if(!e)return null;try{return Ua(t,e)}catch{return null}}function fse(t,e,r){return cI(t4(t,e))}function D8(t){for(var e=t.FullPaths||jn(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function lr(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return fr?n=jl(r):n=jne(r),Wt.utils.cfb_add(t,e,n)}Wt.utils.cfb_add(t,e,r)}else t.file(e,r)}function r4(){return Wt.utils.cfb_new()}function uI(t,e){switch(e.type){case"base64":return Wt.read(t,{type:"base64"});case"binary":return Wt.read(t,{type:"binary"});case"buffer":case"array":return Wt.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function E0(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Bn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,hse=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,R8=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,gse=/<[^>]*>/g,ea=Bn.match(R8)?R8:gse,mse=/<\w*:/,pse=/<(\/?)\w+:/;function qt(t,e,r){for(var n={},s=0,a=0;s!==t.length&&!((a=t.charCodeAt(s))===32||a===10||a===13);++s);if(e||(n[0]=t.slice(0,s)),s===t.length)return n;var i=t.match(hse),o=0,l="",u=0,d="",g="",h=1;if(i)for(u=0;u!=i.length;++u){for(g=i[u],a=0;a!=g.length&&g.charCodeAt(a)!==61;++a);for(d=g.slice(0,a).trim();g.charCodeAt(a+1)==32;)++a;for(h=(s=g.charCodeAt(a+1))==34||s==39?1:0,l=g.slice(a+1+h,g.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Lo(t){return t.replace(pse,"<$1")}var dI={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},n4=Wv(dI),Sr=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(t,function(o,l){return dI[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),s4=/[&<>'"]/g,xse=/[\u0000-\u0008\u000b-\u001f]/g;function Or(t){var e=t+"";return e.replace(s4,function(r){return n4[r]}).replace(xse,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function M8(t){return Or(t).replace(/ /g,"_x0020_")}var fI=/[\u0000-\u001f]/g;function a4(t){var e=t+"";return e.replace(s4,function(r){return n4[r]}).replace(/\n/g,"<br/>").replace(fI,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function yse(t){var e=t+"";return e.replace(s4,function(r){return n4[r]}).replace(fI,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var I8=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function vse(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Yr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function S2(t){for(var e="",r=0,n=0,s=0,a=0,i=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(s=t.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,e+=String.fromCharCode(i);continue}if(a=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=t.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function O8(t){var e=Cc(2*t.length),r,n,s=1,a=0,i=0,o;for(n=0;n<t.length;n+=s)s=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(e[a++]=i&255,e[a++]=i>>>8,i=0),e[a++]=r%256,e[a++]=r>>>8;return e.slice(0,a).toString("ucs2")}function L8(t){return jl(t,"binary").toString("utf8")}var fx="foo bar baz",$r=fr&&(L8(fx)==S2(fx)&&L8||O8(fx)==S2(fx)&&O8)||S2,To=fr?function(t){return jl(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,s=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Wg=function(){var t={};return function(r,n){var s=r+"|"+(n||"");return t[s]?t[s]:t[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),hI=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<t.length;++s)n=n.replace(t[s][0],t[s][1]);return n}}(),wse=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_se=/<\/?(?:vt:)?variant>/g,bse=/<(?:vt:)([^>]*)>([\s\S]*)</;function B8(t,e){var r=qt(t),n=t.match(wse(r.baseType))||[],s=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(_se,"").match(bse);i&&s.push({v:$r(i[2]),t:i[1]})}),s}var gI=/(^\s|\s$|\n)/;function Es(t,e){return"<"+t+(e.match(gI)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Hg(t){return jn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function St(t,e,r){return"<"+t+(r!=null?Hg(r):"")+(e!=null?(e.match(gI)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function GS(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Sse(t,e){switch(typeof t){case"string":var r=St("vt:lpwstr",Or(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return St((t|0)==t?"vt:i4":"vt:r8",Or(String(t)));case"boolean":return St("vt:bool",t?"true":"false")}if(t instanceof Date)return St("vt:filetime",GS(t));throw new Error("Unable to serialize "+t)}function i4(t){if(fr&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return $r(Gc(qT(t)));throw new Error("Bad input format: expected Buffer or string")}var zg=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,es={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},yd=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Oa={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function kse(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),s=t[e+6]&15,a=5;a>=0;--a)s=s*256+t[e+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Cse(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,s=0,a=0,i=n?-e:e;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(e)?26985:0);for(var o=0;o<=5;++o,a/=256)t[r+o]=a&255;t[r+6]=(s&15)<<4|a&15,t[r+7]=s>>4|n}var U8=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var s=0,a=t[0][n].length;s<a;s+=r)e.push.apply(e,t[0][n].slice(s,s+r));return e},$8=fr?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:jl(e)})):U8(t)}:U8,W8=function(t,e,r){for(var n=[],s=e;s<r;s+=2)n.push(String.fromCharCode(ol(t,s)));return n.join("").replace(ca,"")},o4=fr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(ca,""):W8(t,e,r)}:W8,H8=function(t,e,r){for(var n=[],s=e;s<e+r;++s)n.push(("0"+t[s].toString(16)).slice(-2));return n.join("")},mI=fr?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):H8(t,e,r)}:H8,z8=function(t,e,r){for(var n=[],s=e;s<r;s++)n.push(String.fromCharCode(Qd(t,s)));return n.join("")},Pm=fr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):z8(e,r,n)}:z8,pI=function(t,e){var r=La(t,e);return r>0?Pm(t,e+4,e+4+r-1):""},xI=pI,yI=function(t,e){var r=La(t,e);return r>0?Pm(t,e+4,e+4+r-1):""},vI=yI,wI=function(t,e){var r=2*La(t,e);return r>0?Pm(t,e+4,e+4+r-1):""},_I=wI,bI=function(e,r){var n=La(e,r);return n>0?o4(e,r+4,r+4+n):""},SI=bI,kI=function(t,e){var r=La(t,e);return r>0?Pm(t,e+4,e+4+r):""},CI=kI,TI=function(t,e){return kse(t,e)},ey=TI,l4=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};fr&&(xI=function(e,r){if(!Buffer.isBuffer(e))return pI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},vI=function(e,r){if(!Buffer.isBuffer(e))return yI(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},_I=function(e,r){if(!Buffer.isBuffer(e))return wI(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},SI=function(e,r){if(!Buffer.isBuffer(e))return bI(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},CI=function(e,r){if(!Buffer.isBuffer(e))return kI(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},ey=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):TI(e,r)},l4=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Qd=function(t,e){return t[e]},ol=function(t,e){return t[e+1]*256+t[e]},Tse=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},La=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},fu=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Ese=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function X0(t,e){var r="",n,s,a=[],i,o,l,u;switch(e){case"dbcs":if(u=this.l,fr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(ol(this,u)),u+=2;t*=2;break;case"utf8":r=Pm(this,this.l,this.l+t);break;case"utf16le":t*=2,r=o4(this,this.l,this.l+t);break;case"wstr":return X0.call(this,t,"dbcs");case"lpstr-ansi":r=xI(this,this.l),t=4+La(this,this.l);break;case"lpstr-cp":r=vI(this,this.l),t=4+La(this,this.l);break;case"lpwstr":r=_I(this,this.l),t=4+2*La(this,this.l);break;case"lpp4":t=4+La(this,this.l),r=SI(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+La(this,this.l),r=CI(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(i=Qd(this,this.l+t++))!==0;)a.push(dx(i));r=a.join("");break;case"_wstr":for(t=0,r="";(i=ol(this,this.l+t))!==0;)a.push(dx(i)),t+=2;t+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Qd(this,u),this.l=u+1,o=X0.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(dx(ol(this,u))),u+=2}r=a.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Qd(this,u),this.l=u+1,o=X0.call(this,t-l,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(dx(Qd(this,u))),u+=1}r=a.join("");break;default:switch(t){case 1:return n=Qd(this,this.l),this.l++,n;case 2:return n=(e==="i"?Tse:ol)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?fu:Ese)(this,this.l),this.l+=4,n):(s=La(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return t==8?s=ey(this,this.l):s=ey([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;t=8;case 16:r=mI(this,this.l,t);break}}return this.l+=t,r}var Nse=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Ase=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},jse=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function Fse(t,e,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=e.length;++s)jse(this,e.charCodeAt(s),this.l+2*s);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;n=e.length}else if(r==="hex"){for(;s<t;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(s=0;s<Math.min(e.length,t);++s){var i=e.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Nse(this,e,this.l);break;case 8:if(n=8,r==="f"){Cse(this,e,this.l);break}case 16:break;case-4:n=4,Ase(this,e,this.l);break}return this.l+=n,this}function EI(t,e){var r=mI(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function ks(t,e){t.l=e,t.read_shift=X0,t.chk=EI,t.write_shift=Fse}function Qs(t,e){t.l+=e}function Qe(t){var e=Cc(t);return ks(e,0),e}function Fl(t,e,r){if(t){var n,s,a;ks(t,t.l||0);for(var i=t.length,o=0,l=0;t.l<i;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var u=Jg[o]||Jg[65535];for(n=t.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=t.read_shift(1))&127)<<7*s;l=t.l+a;var d=u.f&&u.f(t,a,r);if(t.l=l,e(d,u,o))return}}}function Fa(){var t=[],e=fr?256:2048,r=function(u){var d=Qe(u);return ks(d,0),d},n=r(e),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,e)))},i=function(){return s(),gs(t)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(e)};return{next:a,push:o,end:i,_bufs:t}}function lt(t,e,r,n){var s=+e,a;if(!isNaN(s)){n||(n=Jg[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=t.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&l4(r)&&t.push(r)}}function Y0(t,e,r){var n=tn(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function G8(t,e,r){var n=tn(t);return n.s=Y0(n.s,e.s,r),n.e=Y0(n.e,e.s,r),n}function J0(t,e){if(t.cRel&&t.c<0)for(t=tn(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=tn(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Yt(t);return!t.cRel&&t.cRel!=null&&(r=Rse(r)),!t.rRel&&t.rRel!=null&&(r=Pse(r)),r}function k2(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+gn(t.s.c)+":"+(t.e.cRel?"":"$")+gn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+On(t.s.r)+":"+(t.e.rRel?"":"$")+On(t.e.r):J0(t.s,e.biff)+":"+J0(t.e,e.biff)}function c4(t){return parseInt(Dse(t),10)-1}function On(t){return""+(t+1)}function Pse(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Dse(t){return t.replace(/\$(\d+)$/,"$1")}function u4(t){for(var e=Mse(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function gn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function Rse(t){return t.replace(/^([A-Z])/,"$$$1")}function Mse(t){return t.replace(/^\$([A-Z])/,"$1")}function Ise(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mn(t){for(var e=0,r=0,n=0;n<t.length;++n){var s=t.charCodeAt(n);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:e-1}}function Yt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Pa(t){var e=t.indexOf(":");return e==-1?{s:mn(t),e:mn(t)}:{s:mn(t.slice(0,e)),e:mn(t.slice(e+1))}}function or(t,e){return typeof e>"u"||typeof e=="number"?or(t.s,t.e):(typeof t!="string"&&(t=Yt(t)),typeof e!="string"&&(e=Yt(e)),t==e?t:t+":"+e)}function kr(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=t.length;for(r=0;n<a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.s.c=--r,r=0;n<a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(e.s.r=--r,n===a||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=a&&!((s=t.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(e.e.c=--r,r=0;n!=a&&!((s=t.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return e.e.r=--r,e}function V8(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ei(t.z,r?ns(e):e)}catch{}try{return t.w=Ei((t.XF||{}).numFmtId||(r?14:0),r?ns(e):e)}catch{return""+e}}function bl(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Pl[t.v]||t.v:e==null?V8(t,t.v):V8(t,e))}function Vc(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function NI(t,e,r){var n=r||{},s=t?Array.isArray(t):n.dense,a=t||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?mn(n.origin):n.origin;i=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=kr(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var g=0;g!=e.length;++g)if(e[g]){if(!Array.isArray(e[g]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=e[g].length;++h)if(!(typeof e[g][h]>"u")){var p={v:e[g][h]},x=i+g,v=o+h;if(u.s.r>x&&(u.s.r=x),u.s.c>v&&(u.s.c=v),u.e.r<x&&(u.e.r=x),u.e.c<v&&(u.e.c=v),e[g][h]&&typeof e[g][h]=="object"&&!Array.isArray(e[g][h])&&!(e[g][h]instanceof Date))p=e[g][h];else if(Array.isArray(p.v)&&(p.f=e[g][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Kt[14],n.cellDates?(p.t="d",p.w=Ei(p.z,ns(p.v))):(p.t="n",p.v=ns(p.v),p.w=Ei(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Yt({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return u.s.c<1e7&&(a["!ref"]=or(u)),a}function Dh(t,e){return NI(null,t,e)}function Ose(t){return t.read_shift(4,"i")}function qi(t,e){return e||(e=Qe(4)),e.write_shift(4,t),e}function Xs(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function ps(t,e){var r=!1;return e==null&&(r=!0,e=Qe(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Lse(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Bse(t,e){return e||(e=Qe(4)),e.write_shift(2,0),e.write_shift(2,0),e}function d4(t,e){var r=t.l,n=t.read_shift(1),s=Xs(t),a=[],i={t:s,h:s};if(n&1){for(var o=t.read_shift(4),l=0;l!=o;++l)a.push(Lse(t));i.r=a}else i.r=[{ich:0,ifnt:0}];return t.l=r+e,i}function Use(t,e){var r=!1;return e==null&&(r=!0,e=Qe(15+4*t.t.length)),e.write_shift(1,0),ps(t.t,e),r?e.slice(0,e.l):e}var $se=d4;function Wse(t,e){var r=!1;return e==null&&(r=!0,e=Qe(23+4*t.t.length)),e.write_shift(1,1),ps(t.t,e),e.write_shift(4,1),Bse({},e),r?e.slice(0,e.l):e}function Ni(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function vd(t,e){return e==null&&(e=Qe(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function wd(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function _d(t,e){return e==null&&(e=Qe(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var Hse=Xs,AI=ps;function f4(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function ty(t,e){var r=!1;return e==null&&(r=!0,e=Qe(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var zse=Xs,VS=f4,h4=ty;function g4(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var s=n===0?ey([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):fu(e,0)>>2;return r?s/100:s}function jI(t,e){e==null&&(e=Qe(4));var r=0,n=0,s=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?s:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function FI(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Gse(t,e){return e||(e=Qe(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var bd=FI,Rh=Gse;function zs(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function ed(t,e){return(e||Qe(8)).write_shift(8,t,"f")}function Vse(t){var e={},r=t.read_shift(1),n=r>>>1,s=t.read_shift(1),a=t.read_shift(2,"i"),i=t.read_shift(1),o=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=s;var u=Au[s];u&&(e.rgb=Vg(u));break;case 2:e.rgb=Vg([i,o,l]);break;case 3:e.theme=s;break}return a!=0&&(e.tint=a>0?a/32767:a/32768),e}function ry(t,e){if(e||(e=Qe(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Kse(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Xse(t,e){e||(e=Qe(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function PI(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Yse(t){return PI(t,1)}function Jse(t){return PI(t,2)}var m4=2,wa=3,hx=11,K8=12,ny=19,gx=64,Qse=65,qse=71,Zse=4108,eae=4126,us=80,DI=81,tae=[us,DI],KS={1:{n:"CodePage",t:m4},2:{n:"Category",t:us},3:{n:"PresentationFormat",t:us},4:{n:"ByteCount",t:wa},5:{n:"LineCount",t:wa},6:{n:"ParagraphCount",t:wa},7:{n:"SlideCount",t:wa},8:{n:"NoteCount",t:wa},9:{n:"HiddenCount",t:wa},10:{n:"MultimediaClipCount",t:wa},11:{n:"ScaleCrop",t:hx},12:{n:"HeadingPairs",t:Zse},13:{n:"TitlesOfParts",t:eae},14:{n:"Manager",t:us},15:{n:"Company",t:us},16:{n:"LinksUpToDate",t:hx},17:{n:"CharacterCount",t:wa},19:{n:"SharedDoc",t:hx},22:{n:"HyperlinksChanged",t:hx},23:{n:"AppVersion",t:wa,p:"version"},24:{n:"DigSig",t:Qse},26:{n:"ContentType",t:us},27:{n:"ContentStatus",t:us},28:{n:"Language",t:us},29:{n:"Version",t:us},255:{},2147483648:{n:"Locale",t:ny},2147483651:{n:"Behavior",t:ny},1919054434:{}},XS={1:{n:"CodePage",t:m4},2:{n:"Title",t:us},3:{n:"Subject",t:us},4:{n:"Author",t:us},5:{n:"Keywords",t:us},6:{n:"Comments",t:us},7:{n:"Template",t:us},8:{n:"LastAuthor",t:us},9:{n:"RevNumber",t:us},10:{n:"EditTime",t:gx},11:{n:"LastPrinted",t:gx},12:{n:"CreatedDate",t:gx},13:{n:"ModifiedDate",t:gx},14:{n:"PageCount",t:wa},15:{n:"WordCount",t:wa},16:{n:"CharCount",t:wa},17:{n:"Thumbnail",t:qse},18:{n:"Application",t:us},19:{n:"DocSecurity",t:wa},255:{},2147483648:{n:"Locale",t:ny},2147483651:{n:"Behavior",t:ny},1919054434:{}},X8={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},rae=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function nae(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var sae=nae([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Au=tn(sae),Pl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RI={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},YS={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},mx={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function p4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function aae(t){var e=p4();if(!t||!t.match)return e;var r={};if((t.match(ea)||[]).forEach(function(n){var s=qt(n);switch(s[0].replace(mse,"<")){case"<?xml":break;case"<Types":e.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":e[YS[s.ContentType]]!==void 0&&e[YS[s.ContentType]].push(s.PartName);break}}),e.xmlns!==es.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function MI(t,e){var r=ase(YS),n=[],s;n[n.length]=Bn,n[n.length]=St("Types",null,{xmlns:es.CT,"xmlns:xsd":es.xsd,"xmlns:xsi":es.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return St("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){t[l]&&t[l].length>0&&(s=t[l][0],n[n.length]=St("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:mx[l][e.bookType]||mx[l].xlsx}))},i=function(l){(t[l]||[]).forEach(function(u){n[n.length]=St("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:mx[l][e.bookType]||mx[l].xlsx})})},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=St("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var gr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Gg(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Q0(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(ea)||[]).forEach(function(s){var a=qt(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:E0(a.Target,e);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function Rf(t){var e=[Bn,St("Relationships",null,{xmlns:es.RELS})];return jn(t["!id"]).forEach(function(r){e[e.length]=St("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ir(t,e,r,n,s,a){if(s||(s={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,s.Id="rId"+e,s.Type=n,s.Target=r,[gr.HLINK,gr.XPATH,gr.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),t["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][s.Id]=s,t[("/"+s.Target).replace("//","/")]=s,e}var iae="application/vnd.oasis.opendocument.spreadsheet";function oae(t,e){for(var r=i4(t),n,s;n=zg.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=qt(n[0],!1),s.path=="/"&&s.type!==iae)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function lae(t){var e=[Bn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Y8(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function cae(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function uae(t){var e=[Bn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Y8(t[r][0],t[r][1])),e.push(cae("",t[r][0]));return e.push(Y8("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function II(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Y1.version+"</meta:generator></office:meta></office:document-meta>"}var bi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],dae=function(){for(var t=new Array(bi.length),e=0;e<bi.length;++e){var r=bi[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function OI(t){var e={};t=$r(t);for(var r=0;r<bi.length;++r){var n=bi[r],s=t.match(dae[r]);s!=null&&s.length>0&&(e[n[1]]=Sr(s[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=en(e[n[1]]))}return e}function C2(t,e,r,n,s){s[t]!=null||e==null||e===""||(s[t]=e,e=Or(e),n[n.length]=r?St(t,e,r):Es(t,e))}function LI(t,e){var r=e||{},n=[Bn,St("cp:coreProperties",null,{"xmlns:cp":es.CORE_PROPS,"xmlns:dc":es.dc,"xmlns:dcterms":es.dcterms,"xmlns:dcmitype":es.dcmitype,"xmlns:xsi":es.xsi})],s={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&C2("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:GS(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),t.ModifiedDate!=null&&C2("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:GS(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=bi.length;++a){var i=bi[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:t?t[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&C2(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ju=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],BI=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function UI(t,e,r,n){var s=[];if(typeof t=="string")s=B8(t,n);else for(var a=0;a<t.length;++a)s=s.concat(t[a].map(function(d){return{v:d}}));var i=typeof e=="string"?B8(e,n).map(function(d){return d.v}):e,o=0,l=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(l=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function fae(t,e,r){var n={};return e||(e={}),t=$r(t),ju.forEach(function(s){var a=(t.match(Wg(s[0]))||[])[1];switch(s[2]){case"string":a&&(e[s[1]]=Sr(a));break;case"bool":e[s[1]]=a==="true";break;case"raw":var i=t.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&UI(n.HeadingPairs,n.TitlesOfParts,e,r),e}function $I(t){var e=[],r=St;return t||(t={}),t.Application="SheetJS",e[e.length]=Bn,e[e.length]=St("Properties",null,{xmlns:es.EXT_PROPS,"xmlns:vt":es.vt}),ju.forEach(function(n){if(t[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Or(String(t[n[1]]));break;case"bool":s=t[n[1]]?"true":"false";break}s!==void 0&&(e[e.length]=r(n[0],s))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Or(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var hae=/<[^>]+>[^<]*/g;function gae(t,e){var r={},n="",s=t.match(hae);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=qt(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Sr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),u=l[0].slice(4),d=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Sr(d);break;case"bool":r[n]=Yr(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=en(d);break;case"cy":case"error":r[n]=Sr(d);break;default:if(u.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,l)}}else if(i.slice(0,2)!=="</"){if(e.WTF)throw new Error(i)}}}return r}function WI(t){var e=[Bn,St("Properties",null,{xmlns:es.CUST_PROPS,"xmlns:vt":es.vt})];if(!t)return e.join("");var r=1;return jn(t).forEach(function(s){++r,e[e.length]=St("property",Sse(t[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Or(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var JS={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},T2;function mae(t,e,r){T2||(T2=Wv(JS)),e=T2[e]||e,t[e]=r}function pae(t,e){var r=[];return jn(JS).map(function(n){for(var s=0;s<bi.length;++s)if(bi[s][1]==n)return bi[s];for(s=0;s<ju.length;++s)if(ju[s][1]==n)return ju[s];throw n}).forEach(function(n){if(t[n[1]]!=null){var s=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(Es(JS[n[1]]||n[1],s))}}),St("DocumentProperties",r.join(""),{xmlns:Oa.o})}function xae(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return t&&jn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)){for(var i=0;i<bi.length;++i)if(a==bi[i][1])return;for(i=0;i<ju.length;++i)if(a==ju[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=t[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),s.push(St(M8(a),o,{"dt:dt":l}))}}),e&&jn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)&&!(t&&Object.prototype.hasOwnProperty.call(t,a))){var i=e[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(St(M8(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Oa.o+'">'+s.join("")+"</"+n+">"}function x4(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function yae(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=Qe(8);return i.write_shift(4,n),i.write_shift(4,s),i}function HI(t,e,r){var n=t.l,s=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return s}function zI(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function GI(t,e,r){return e===31?zI(t):HI(t,e,r)}function QS(t,e,r){return GI(t,e,r===!1?0:4)}function vae(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return GI(t,e,0)}function wae(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var s=t.l;r[n]=t.read_shift(0,"lpwstr").replace(ca,""),t.l-s&2&&(t.l+=2)}return r}function _ae(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(ca,"");return r}function bae(t){var e=t.l,r=sy(t,DI);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=sy(t,wa);return[r,n]}function Sae(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(bae(t));return r}function J8(t,e){for(var r=t.read_shift(4),n={},s=0;s!=r;++s){var a=t.read_shift(4),i=t.read_shift(4);n[a]=t.read_shift(i,e===1200?"utf16le":"utf8").replace(ca,"").replace(T0,"!"),e===1200&&i%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function VI(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function kae(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function sy(t,e,r){var n=t.read_shift(2),s,a=r||{};if(t.l+=2,e!==K8&&n!==e&&tae.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===K8?n:e){case 2:return s=t.read_shift(2,"i"),a.raw||(t.l+=2),s;case 3:return s=t.read_shift(4,"i"),s;case 11:return t.read_shift(4)!==0;case 19:return s=t.read_shift(4),s;case 30:return HI(t,n,4).replace(ca,"");case 31:return zI(t);case 64:return x4(t);case 65:return VI(t);case 71:return kae(t);case 80:return QS(t,n,!a.raw).replace(ca,"");case 81:return vae(t,n).replace(ca,"");case 4108:return Sae(t);case 4126:case 4127:return n==4127?wae(t):_ae(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Q8(t,e){var r=Qe(4),n=Qe(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=Qe(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=yae(e);break;case 31:case 80:for(n=Qe(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return gs([r,n])}function q8(t,e){var r=t.l,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0,o=0,l=-1,u={};for(i=0;i!=s;++i){var d=t.read_shift(4),g=t.read_shift(4);a[i]=[d,g+r]}a.sort(function(_,y){return _[1]-y[1]});var h={};for(i=0;i!=s;++i){if(t.l!==a[i][1]){var p=!0;if(i>0&&e)switch(e[a[i-1][0]].t){case 2:t.l+2===a[i][1]&&(t.l+=2,p=!1);break;case 80:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break;case 4108:t.l<=a[i][1]&&(t.l=a[i][1],p=!1);break}if((!e||i==0)&&t.l<=a[i][1]&&(p=!1,t.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+t.l+" :"+i)}if(e){var x=e[a[i][0]];if(h[x.n]=sy(t,x.t,{raw:!0}),x.p==="version"&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(h[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Gi(o=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(a[i][0]===1){if(o=h.CodePage=sy(t,m4),Gi(o),l!==-1){var v=t.l;t.l=a[l][1],u=J8(t,o),t.l=v}}else if(a[i][0]===0){if(o===0){l=i,t.l=a[i+1][1];continue}u=J8(t,o)}else{var w=u[a[i][0]],S;switch(t[t.l]){case 65:t.l+=4,S=VI(t);break;case 30:t.l+=4,S=QS(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,S=QS(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,S=t.read_shift(4,"i");break;case 19:t.l+=4,S=t.read_shift(4);break;case 5:t.l+=4,S=t.read_shift(8,"f");break;case 11:t.l+=4,S=Dn(t,4);break;case 64:t.l+=4,S=en(x4(t));break;default:throw new Error("unparsed value: "+t[t.l])}h[w]=S}}return t.l=r+n,h}var KI=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Cae(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Z8(t,e,r){var n=Qe(8),s=[],a=[],i=8,o=0,l=Qe(8),u=Qe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),a.push(l),s.push(u),i+=8+l.length,!e){u=Qe(8),u.write_shift(4,0),s.unshift(u);var d=[Qe(4)];for(d[0].write_shift(4,t.length),o=0;o<t.length;++o){var g=t[o][0];for(l=Qe(8+2*(g.length+1)+(g.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,g.length+1),l.write_shift(0,g,"dbcs");l.l!=l.length;)l.write_shift(1,0);d.push(l)}l=gs(d),a.unshift(l),i+=8+l.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(KI.indexOf(t[o][0])>-1||BI.indexOf(t[o][0])>-1)&&t[o][1]!=null){var h=t[o][1],p=0;if(e){p=+e[t[o][0]];var x=r[p];if(x.p=="version"&&typeof h=="string"){var v=h.split(".");h=(+v[0]<<16)+(+v[1]||0)}l=Q8(x.t,h)}else{var w=Cae(h);w==-1&&(w=31,h=String(h)),l=Q8(w,h)}a.push(l),u=Qe(8),u.write_shift(4,e?p:2+o),s.push(u),i+=8+l.length}var S=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,S),S+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),gs([n].concat(s).concat(a))}function ej(t,e,r){var n=t.content;if(!n)return{};ks(n,0);var s,a,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Wt.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),l=n.read_shift(4));var g=q8(n,e),h={SystemIdentifier:u};for(var p in g)h[p]=g[p];if(h.FMTID=a,s===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var x;try{x=q8(n,null)}catch{}for(p in x)h[p]=x[p];return h.FMTID=[a,i],h}function tj(t,e,r,n,s,a){var i=Qe(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Wt.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,e,"hex"),i.write_shift(4,s?68:48);var l=Z8(t,r,n);if(o.push(l),s){var u=Z8(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+l.length),o.push(u)}return gs(o)}function Hl(t,e){return t.read_shift(e),null}function Tae(t,e){e||(e=Qe(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function Eae(t,e,r){for(var n=[],s=t.l+e;t.l<s;)n.push(r(t,s-t.l));if(s!==t.l)throw new Error("Slurp error");return n}function Dn(t,e){return t.read_shift(e)===1}function sa(t,e){return e||(e=Qe(2)),e.write_shift(2,+!!t),e}function Hn(t){return t.read_shift(2,"u")}function gi(t,e){return e||(e=Qe(2)),e.write_shift(2,t),e}function XI(t,e){return Eae(t,e,Hn)}function Nae(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function YI(t,e,r){return r||(r=Qe(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Dm(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=t.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?t.read_shift(n,s):"";return i}function Aae(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,l={};s&&(i=t.read_shift(2)),n&&(o=t.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=e===0?"":t.read_shift(e,u);return s&&(t.l+=4*i),n&&(t.l+=o),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function jae(t){var e=t.t||"",r=Qe(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=Qe(2*e.length);n.write_shift(2*e.length,e,"utf16le");var s=[r,n];return gs(s)}function td(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var s=t.read_shift(1);return s===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Rm(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):td(t,n,r)}function Sd(t,e,r){if(r.biff>5)return Rm(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function JI(t,e,r){return r||(r=Qe(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function Fae(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function Pae(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var s=t.read_shift((n?e-24:e)>>1,"utf16le").replace(ca,"");return n&&(t.l+=24),s}function Dae(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=t.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=t.read_shift(a>>1,"utf16le").replace(ca,"");return r+i}function Rae(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Pae(t);case"0303000000000000c000000000000046":return Dae(t);default:throw new Error("Unsupported Moniker "+r)}}function px(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(ca,""):"";return r}function rj(t,e){e||(e=Qe(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Mae(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=t.read_shift(2);t.l+=2;var a,i,o,l,u="",d,g;s&16&&(a=px(t,r-t.l)),s&128&&(i=px(t,r-t.l)),(s&257)===257&&(o=px(t,r-t.l)),(s&257)===1&&(l=Rae(t,r-t.l)),s&8&&(u=px(t,r-t.l)),s&32&&(d=t.read_shift(16)),s&64&&(g=x4(t)),t.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return d&&(p.guid=d),g&&(p.time=g),a&&(p.Tooltip=a),p}function Iae(t){var e=Qe(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}e.write_shift(4,2),e.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)e.write_shift(4,i[r]);if(a==28)n=n.slice(1),rj(n,e);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),a&8&&rj(s>-1?n.slice(s+1):"",e)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)e.write_shift(1,parseInt(i[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function QI(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),s=t.read_shift(1);return[e,r,n,s]}function qI(t,e){var r=QI(t);return r[3]=0,r}function Bo(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function rd(t,e,r,n){return n||(n=Qe(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function Oae(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Lae(t,e,r){return e===0?"":Sd(t,e,r)}function Bae(t,e,r){var n=r.biff>8?4:2,s=t.read_shift(n),a=t.read_shift(n,"i"),i=t.read_shift(n,"i");return[s,a,i]}function ZI(t){var e=t.read_shift(2),r=g4(t);return[e,r]}function Uae(t,e,r){t.l+=4,e-=4;var n=t.l+e,s=Dm(t,e,r),a=t.read_shift(2);if(n-=t.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return t.l+=a,s}function Gv(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2);return{s:{c:n,r:e},e:{c:s,r}}}function eO(t,e){return e||(e=Qe(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function tO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),s=t.read_shift(1);return{s:{c:n,r:e},e:{c:s,r}}}var $ae=tO;function rO(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function Wae(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function Hae(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Ls(t){t.l+=2,t.l+=t.read_shift(2)}var zae={0:Ls,4:Ls,5:Ls,6:Ls,7:Hae,8:Ls,9:Ls,10:Ls,11:Ls,12:Ls,13:Wae,14:Ls,15:Ls,16:Ls,17:Ls,18:Ls,19:Ls,20:Ls,21:rO};function Gae(t,e){for(var r=t.l+e,n=[];t.l<r;){var s=t.read_shift(2);t.l-=2;try{n.push(zae[s](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function xx(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function y4(t,e,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Qe(s);return a.write_shift(2,n),a.write_shift(2,e),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Vae(t,e){return e===0||t.read_shift(2),1200}function Kae(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,s=Sd(t,0,r);return t.read_shift(e+n-t.l),s}function Xae(t,e){var r=!e||e.biff==8,n=Qe(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Yae(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Jae(t,e,r){var n=t.read_shift(4),s=t.read_shift(1)&3,a=t.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Dm(t,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Qae(t,e){var r=!e||e.biff>=8?2:1,n=Qe(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function qae(t,e){for(var r=t.l+e,n=t.read_shift(4),s=t.read_shift(4),a=[],i=0;i!=s&&t.l<r;++i)a.push(Aae(t));return a.Count=n,a.Unique=s,a}function Zae(t,e){var r=Qe(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],s=0;s<t.length;++s)n[s]=jae(t[s]);var a=gs([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function eie(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function tie(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function rie(t){var e=Oae(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function nie(t){return t.read_shift(2),t.read_shift(4)}function nj(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var s=t.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function sie(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2);return{Pos:[e,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:l,TabRatio:u}}function aie(){var t=Qe(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function iie(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function oie(t){var e=Qe(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function lie(){}function cie(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Dm(t,0,r),n}function uie(t,e){var r=t.name||"Arial",n=e&&e.biff==5,s=n?15+r.length:16+2*r.length,a=Qe(s);return a.write_shift(2,t.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function die(t){var e=Bo(t);return e.isst=t.read_shift(4),e}function fie(t,e,r,n){var s=Qe(10);return rd(t,e,n,s),s.write_shift(4,r),s}function hie(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,s=Bo(t);r.biff==2&&t.l++;var a=Rm(t,n-t.l,r);return s.val=a,s}function gie(t,e,r,n,s){var a=!s||s.biff==8,i=Qe(8+ +a+(1+a)*r.length);return rd(t,e,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function mie(t,e,r){var n=t.read_shift(2),s=Sd(t,0,r);return[n,s]}function pie(t,e,r,n){var s=r&&r.biff==5;n||(n=Qe(s?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(s?1:2,e.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var xie=Sd;function sj(t,e,r){var n=t.l+e,s=r.biff==8||!r.biff?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(2),l=t.read_shift(2);return t.l=n,{s:{r:a,c:o},e:{r:i,c:l}}}function yie(t,e){var r=e.biff==8||!e.biff?4:2,n=Qe(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function vie(t){var e=t.read_shift(2),r=t.read_shift(2),n=ZI(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function wie(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(ZI(t));if(t.l!==r)throw new Error("MulRK read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function _ie(t,e){for(var r=t.l+e-2,n=t.read_shift(2),s=t.read_shift(2),a=[];t.l<r;)a.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var i=t.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function bie(t,e,r,n){var s={},a=t.read_shift(4),i=t.read_shift(4),o=t.read_shift(4),l=t.read_shift(2);return s.patternType=rae[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=l&127,s.icvBack=l>>7&127,s.fsxButton=l>>14&1),s}function Sie(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=bie(t,e,n.fStyle,r),n}function aj(t,e,r,n){var s=r&&r.biff==5;n||(n=Qe(s?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var a=0;return t.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function kie(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function Cie(t){var e=Qe(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function ij(t,e,r){var n=Bo(t);(r.biff==2||e==9)&&++t.l;var s=Nae(t);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Tie(t,e,r,n,s,a){var i=Qe(8);return rd(t,e,n,i),YI(r,a,i),i}function Eie(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Bo(t),s=zs(t);return n.val=s,n}function Nie(t,e,r,n){var s=Qe(14);return rd(t,e,n,s),ed(r,s),s}var oj=Lae;function Aie(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=td(t,a),o=[];n>t.l;)o.push(Rm(t));return[a,s,i,o]}function lj(t,e,r){var n=t.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Uae(t,e-2,r)),a.body=s||t.read_shift(e-2),typeof s=="string"&&(a.Name=s),a}var jie=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function cj(t,e,r){var n=t.l+e,s=t.read_shift(2),a=t.read_shift(1),i=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),l=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var u=td(t,i,r);s&32&&(u=jie[u.charCodeAt(0)]);var d=n-t.l;r&&r.biff==2&&--d;var g=n==t.l||o===0||!(d>0)?[]:Gue(t,d,r,o);return{chKey:a,Name:u,itab:l,rgce:g}}function nO(t,e,r){if(r.biff<8)return Fie(t,e,r);for(var n=[],s=t.l+e,a=t.read_shift(r.biff>8?4:2);a--!==0;)n.push(Bae(t,r.biff>8?12:6,r));if(t.l!=s)throw new Error("Bad ExternSheet: "+t.l+" != "+s);return n}function Fie(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Dm(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function Pie(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),s=t.read_shift(2),a=td(t,n,r),i=td(t,s,r);return[a,i]}function Die(t,e,r){var n=tO(t);t.l++;var s=t.read_shift(1);return e-=8,[Vue(t,e,r),s,n]}function uj(t,e,r){var n=$ae(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,Hue(t,e,r)]}function Rie(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function Mie(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),i=t.read_shift(2),o=Sd(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:s},o,i,a]}}function Iie(t,e,r){return Mie(t,e,r)}function Oie(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(Gv(t));return r}function Lie(t){var e=Qe(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)eO(t[r],e);return e}function Bie(t,e,r){if(r&&r.biff<8)return $ie(t,e,r);var n=rO(t),s=Gae(t,e-22,n[1]);return{cmo:n,ft:s}}var Uie={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var s=t.read_shift(1);return t.l+=s,t.l=r,{fmt:n}}};function $ie(t,e,r){t.l+=4;var n=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var i=[];return i.push((Uie[n]||Qs)(t,e,r)),{cmo:[s,n,a],ft:i}}function Wie(t,e,r){var n=t.l,s="";try{t.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?t.l+=6:i=Fae(t,6,r);var o=t.read_shift(2);t.read_shift(2),Hn(t,2);var l=t.read_shift(2);t.l+=l;for(var u=1;u<t.lens.length-1;++u){if(t.l-n!=t.lens[u])throw new Error("TxO: bad continue record");var d=t[t.l],g=td(t,t.lens[u+1]-t.lens[u]-1);if(s+=g,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return t.l=n+e,{t:s}}catch{return t.l=n+e,{t:s}}}function Hie(t,e){var r=Gv(t);t.l+=16;var n=Mae(t,e-24);return[r,n]}function zie(t){var e=Qe(24),r=mn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(n[s],16));return gs([e,Iae(t[1])])}function Gie(t,e){t.read_shift(2);var r=Gv(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(ca,""),[r,n]}function Vie(t){var e=t[1].Tooltip,r=Qe(10+2*(e.length+1));r.write_shift(2,2048);var n=mn(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<e.length;++s)r.write_shift(2,e.charCodeAt(s));return r.write_shift(2,0),r}function Kie(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=X8[r]||r,r=t.read_shift(2),e[1]=X8[r]||r,e}function Xie(t){return t||(t=Qe(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Yie(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(qI(t));return r}function Jie(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(qI(t));return r}function Qie(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function sO(t,e,r){if(!r.cellStyles)return Qs(t,e);var n=r&&r.biff>=12?4:2,s=t.read_shift(n),a=t.read_shift(n),i=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s,e:a,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function qie(t,e){var r=Qe(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Zie(t,e){var r={};return e<32||(t.l+=16,r.header=zs(t),r.footer=zs(t),t.l+=2),r}function eoe(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var s=t.read_shift(1);return t.l+=3,s&16&&(n.area=!0),n}function toe(t){for(var e=Qe(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var roe=Bo,noe=XI,soe=Rm;function aoe(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,s}function ioe(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Bo(t);++t.l;var s=Sd(t,e-7,r);return n.t="str",n.val=s,n}function ooe(t){var e=Bo(t);++t.l;var r=zs(t);return e.t="n",e.val=r,e}function loe(t,e,r){var n=Qe(15);return Lm(n,t,e),n.write_shift(8,r,"f"),n}function coe(t){var e=Bo(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function uoe(t,e,r){var n=Qe(9);return Lm(n,t,e),n.write_shift(2,r),n}function doe(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function foe(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function hoe(t,e,r){var n=t.l+e,s=Bo(t),a=t.read_shift(2),i=td(t,a,r);return t.l=n,s.t="str",s.val=i,s}var goe=[2,3,48,49,131,139,140,245],qS=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Wv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],d=Cc(1);switch(l.type){case"base64":d=Ba(Ga(o));break;case"binary":d=Ba(o);break;case"buffer":case"array":d=o;break}ks(d,0);var g=d.read_shift(1),h=!!(g&136),p=!1,x=!1;switch(g){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+g.toString(16))}var v=0,w=521;g==2&&(v=d.read_shift(2)),d.l+=3,g!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),g!=2&&(w=d.read_shift(2));var S=d.read_shift(2),_=l.codepage||1252;g!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=t[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var y=[],k={},N=Math.min(d.length,g==2?521:w-10-(p?264:0)),E=x?32:11;d.l<N&&d[d.l]!=13;)switch(k={},k.name=Bg.utils.decode(_,d.slice(d.l,d.l+E)).replace(/[\u0000\r\n].*$/g,""),d.l+=E,k.type=String.fromCharCode(d.read_shift(1)),g!=2&&!x&&(k.offset=d.read_shift(4)),k.len=d.read_shift(1),g==2&&(k.offset=d.read_shift(2)),k.dec=d.read_shift(1),k.name.length&&y.push(k),g!=2&&(d.l+=x?13:14),k.type){case"B":(!p||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var A=0,C=0;for(u[0]=[],C=0;C!=y.length;++C)u[0][C]=y[C].name;for(;v-- >0;){if(d[d.l]===42){d.l+=S;continue}for(++d.l,u[++A]=[],C=0,C=0;C!=y.length;++C){var F=d.slice(d.l,d.l+y[C].len);d.l+=y[C].len,ks(F,0);var P=Bg.utils.decode(_,F);switch(y[C].type){case"C":P.trim().length&&(u[A][C]=P.replace(/\s+$/,""));break;case"D":P.length===8?u[A][C]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):u[A][C]=P;break;case"F":u[A][C]=parseFloat(P.trim());break;case"+":case"I":u[A][C]=x?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":u[A][C]=!0;break;case"N":case"F":u[A][C]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+g.toString(16));u[A][C]="##MEMO##"+(x?parseInt(P.trim(),10):F.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(u[A][C]=+P||0);break;case"@":u[A][C]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":u[A][C]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":u[A][C]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[A][C]=-F.read_shift(-8,"f");break;case"B":if(p&&y[C].len==8){u[A][C]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[C].len;break;case"0":if(y[C].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[C].type)}}}if(g!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var d=Dh(r(o,u),u);return d["!cols"]=u.DBF.map(function(g){return{wch:g.len,DBF:g}}),delete u.DBF,d}function s(o,l){try{return Vc(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var u=l||{};if(+u.codepage>=0&&Gi(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Fa(),g=oy(o,{header:1,raw:!0,cellDates:!0}),h=g[0],p=g.slice(1),x=o["!cols"]||[],v=0,w=0,S=0,_=1;for(v=0;v<h.length;++v){if(((x[v]||{}).DBF||{}).name){h[v]=x[v].DBF.name,++S;continue}if(h[v]!=null){if(++S,typeof h[v]=="number"&&(h[v]=h[v].toString(10)),typeof h[v]!="string")throw new Error("DBF Invalid column name "+h[v]+" |"+typeof h[v]+"|");if(h.indexOf(h[v])!==v){for(w=0;w<1024;++w)if(h.indexOf(h[v]+"_"+w)==-1){h[v]+="_"+w;break}}}}var y=kr(o["!ref"]),k=[],N=[],E=[];for(v=0;v<=y.e.c-y.s.c;++v){var A="",C="",F=0,P=[];for(w=0;w<p.length;++w)p[w][v]!=null&&P.push(p[w][v]);if(P.length==0||h[v]==null){k[v]="?";continue}for(w=0;w<P.length;++w){switch(typeof P[w]){case"number":C="B";break;case"string":C="C";break;case"boolean":C="L";break;case"object":C=P[w]instanceof Date?"D":"C";break;default:C="C"}F=Math.max(F,String(P[w]).length),A=A&&A!=C?"C":C}F>250&&(F=250),C=((x[v]||{}).DBF||{}).type,C=="C"&&x[v].DBF.len>F&&(F=x[v].DBF.len),A=="B"&&C=="N"&&(A="N",E[v]=x[v].DBF.dec,F=x[v].DBF.len),N[v]=A=="C"||C=="N"?F:a[A]||0,_+=N[v],k[v]=A}var M=d.next(32);for(M.write_shift(4,318902576),M.write_shift(4,p.length),M.write_shift(2,296+32*S),M.write_shift(2,_),v=0;v<4;++v)M.write_shift(4,0);for(M.write_shift(4,0|(+e[KM]||3)<<8),v=0,w=0;v<h.length;++v)if(h[v]!=null){var I=d.next(32),Y=(h[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,Y,"sbcs"),I.write_shift(1,k[v]=="?"?"C":k[v],"sbcs"),I.write_shift(4,w),I.write_shift(1,N[v]||a[k[v]]||0),I.write_shift(1,E[v]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),w+=N[v]||a[k[v]]||0}var se=d.next(264);for(se.write_shift(4,13),v=0;v<65;++v)se.write_shift(4,0);for(v=0;v<p.length;++v){var L=d.next(_);for(L.write_shift(1,0),w=0;w<h.length;++w)if(h[w]!=null)switch(k[w]){case"L":L.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":L.write_shift(8,p[v][w]||0,"f");break;case"N":var z="0";for(typeof p[v][w]=="number"&&(z=p[v][w].toFixed(E[w]||0)),S=0;S<N[w]-z.length;++S)L.write_shift(1,32);L.write_shift(1,z,"sbcs");break;case"D":p[v][w]?(L.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),L.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),L.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):L.write_shift(8,"00000000","sbcs");break;case"C":var G=String(p[v][w]!=null?p[v][w]:"").slice(0,N[w]);for(L.write_shift(1,G,"sbcs"),S=0;S<N[w]-G.length;++S)L.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),aO=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+jn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var x=t[p];return typeof x=="number"?_8(x):x},n=function(h,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?h:_8(v)};t["|"]=254;function s(h,p){switch(p.type){case"base64":return a(Ga(h),p);case"binary":return a(h,p);case"buffer":return a(fr&&Buffer.isBuffer(h)?h.toString("binary"):Gc(h),p);case"array":return a(Zu(h),p)}throw new Error("Unrecognized type "+p.type)}function a(h,p){var x=h.split(/[\n\r]+/),v=-1,w=-1,S=0,_=0,y=[],k=[],N=null,E={},A=[],C=[],F=[],P=0,M;for(+p.codepage>=0&&Gi(+p.codepage);S!==x.length;++S){P=0;var I=x[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),Y=I.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),se=Y[0],L;if(I.length>0)switch(se){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&k.push(I.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,G=!1,O=!1,R=!1,X=-1,te=-1;for(_=1;_<Y.length;++_)switch(Y[_].charAt(0)){case"A":break;case"X":w=parseInt(Y[_].slice(1))-1,G=!0;break;case"Y":for(v=parseInt(Y[_].slice(1))-1,G||(w=0),M=y.length;M<=v;++M)y[M]=[];break;case"K":L=Y[_].slice(1),L.charAt(0)==='"'?L=L.slice(1,L.length-1):L==="TRUE"?L=!0:L==="FALSE"?L=!1:isNaN(Qi(L))?isNaN(rh(L).getDate())||(L=en(L)):(L=Qi(L),N!==null&&Fh(N)&&(L=zv(L))),z=!0;break;case"E":R=!0;var H=Mf(Y[_].slice(1),{r:v,c:w});y[v][w]=[y[v][w],H];break;case"S":O=!0,y[v][w]=[y[v][w],"S5S"];break;case"G":break;case"R":X=parseInt(Y[_].slice(1))-1;break;case"C":te=parseInt(Y[_].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(z&&(y[v][w]&&y[v][w].length==2?y[v][w][0]=L:y[v][w]=L,N=null),O){if(R)throw new Error("SYLK shared formula cannot have own formula");var V=X>-1&&y[X][te];if(!V||!V[1])throw new Error("SYLK shared formula cannot find base");y[v][w][1]=SO(V[1],{r:v-X,c:w-te})}break;case"F":var q=0;for(_=1;_<Y.length;++_)switch(Y[_].charAt(0)){case"X":w=parseInt(Y[_].slice(1))-1,++q;break;case"Y":for(v=parseInt(Y[_].slice(1))-1,M=y.length;M<=v;++M)y[M]=[];break;case"M":P=parseInt(Y[_].slice(1))/20;break;case"F":break;case"G":break;case"P":N=k[parseInt(Y[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=Y[_].slice(1).split(" "),M=parseInt(F[0],10);M<=parseInt(F[1],10);++M)P=parseInt(F[2],10),C[M-1]=P===0?{hidden:!0}:{wch:P},Tc(C[M-1]);break;case"C":w=parseInt(Y[_].slice(1))-1,C[w]||(C[w]={});break;case"R":v=parseInt(Y[_].slice(1))-1,A[v]||(A[v]={}),P>0?(A[v].hpt=P,A[v].hpx=sh(P)):P===0&&(A[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}q<1&&(N=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return A.length>0&&(E["!rows"]=A),C.length>0&&(E["!cols"]=C),p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),[y,E]}function i(h,p){var x=s(h,p),v=x[0],w=x[1],S=Dh(v,p);return jn(w).forEach(function(_){S[_]=w[_]}),S}function o(h,p){return Vc(i(h,p),p)}function l(h,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(h.t){case"n":w+=h.v||0,h.f&&!h.F&&(w+=";E"+k4(h.f,{r:x,c:v}));break;case"b":w+=h.v?"TRUE":"FALSE";break;case"e":w+=h.w||h.v;break;case"d":w+='"'+(h.w||h.v)+'"';break;case"s":w+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(h,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Kg(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Xg(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&h.push(w)})}function d(h,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*Yg(x.hpx)+";"),w.length>2&&h.push(w+"R"+(v+1))})}function g(h,p){var x=["ID;PWXL;N;E"],v=[],w=kr(h["!ref"]),S,_=Array.isArray(h),y=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),h["!cols"]&&u(x,h["!cols"]),h["!rows"]&&d(x,h["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var k=w.s.r;k<=w.e.r;++k)for(var N=w.s.c;N<=w.e.c;++N){var E=Yt({r:k,c:N});S=_?(h[k]||[])[N]:h[E],!(!S||S.v==null&&(!S.f||S.F))&&v.push(l(S,h,k,N))}return x.join(y)+y+v.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:i,from_sheet:g}}(),iO=function(){function t(a,i){switch(i.type){case"base64":return e(Ga(a),i);case"binary":return e(a,i);case"buffer":return e(fr&&Buffer.isBuffer(a)?a.toString("binary"):Gc(a),i);case"array":return e(Zu(a),i)}throw new Error("Unrecognized type "+i.type)}function e(a,i){for(var o=a.split(`
`),l=-1,u=-1,d=0,g=[];d!==o.length;++d){if(o[d].trim()==="BOT"){g[++l]=[],u=0;continue}if(!(l<0)){var h=o[d].trim().split(","),p=h[0],x=h[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){g[++l]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?g[l][u]=!0:v==="FALSE"?g[l][u]=!1:isNaN(Qi(x))?isNaN(rh(x).getDate())?g[l][u]=x:g[l][u]=en(x):g[l][u]=Qi(x),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),g[l][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(g=g.slice(0,i.sheetRows)),g}function r(a,i){return Dh(t(a,i),i)}function n(a,i){return Vc(r(a,i),i)}var s=function(){var a=function(l,u,d,g,h){l.push(u),l.push(d+","+g),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,u,d,g){l.push(u+","+d),l.push(u==1?'"'+g.replace(/"/g,'""')+'"':g)};return function(l){var u=[],d=kr(l["!ref"]),g,h=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var v=Yt({r:p,c:x});if(g=h?(l[p]||[])[x]:l[v],!g){i(u,1,0,"");continue}switch(g.t){case"n":var w=g.w;!w&&g.v!=null&&(w=g.v),w==null?g.f&&!g.F?i(u,1,0,"="+g.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,g.v?1:0,g.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(g.v)?g.v:'="'+g.v+'"');break;case"d":g.w||(g.w=Ei(g.z||Kt[14],ns(en(g.v)))),i(u,0,g.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var S=`\r
`,_=u.join(S);return _}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),oO=function(){function t(g){return g.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(g){return g.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(g,h){for(var p=g.split(`
`),x=-1,v=-1,w=0,S=[];w!==p.length;++w){var _=p[w].trim().split(":");if(_[0]==="cell"){var y=mn(_[1]);if(S.length<=y.r)for(x=S.length;x<=y.r;++x)S[x]||(S[x]=[]);switch(x=y.r,v=y.c,_[2]){case"t":S[x][v]=t(_[3]);break;case"v":S[x][v]=+_[3];break;case"vtf":var k=_[_.length-1];case"vtc":switch(_[3]){case"nl":S[x][v]=!!+_[4];break;default:S[x][v]=+_[4];break}_[2]=="vtf"&&(S[x][v]=[S[x][v],k])}}}return h&&h.sheetRows&&(S=S.slice(0,h.sheetRows)),S}function n(g,h){return Dh(r(g,h),h)}function s(g,h){return Vc(n(g,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(g){if(!g||!g["!ref"])return"";for(var h=[],p=[],x,v="",w=Pa(g["!ref"]),S=Array.isArray(g),_=w.s.r;_<=w.e.r;++_)for(var y=w.s.c;y<=w.e.c;++y)if(v=Yt({r:_,c:y}),x=S?(g[_]||[])[y]:g[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(e(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=e(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=e(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=ns(en(x.v));p[2]="vtc",p[3]="nd",p[4]=""+k,p[5]=x.w||Ei(x.z||Kt[14],k);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(g){return[a,i,o,i,u(g),l].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}}(),nh=function(){function t(d,g,h,p,x){x.raw?g[h][p]=d:d===""||(d==="TRUE"?g[h][p]=!0:d==="FALSE"?g[h][p]=!1:isNaN(Qi(d))?isNaN(rh(d).getDate())?g[h][p]=d:g[h][p]=en(d):g[h][p]=Qi(d))}function e(d,g){var h=g||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,S=0,_=0;_<=v;++_)S=x[_].indexOf(" "),S==-1?S=x[_].length:S++,w=Math.max(w,S);for(_=0;_<=v;++_){p[_]=[];var y=0;for(t(x[_].slice(0,w).trim(),p,_,y,h),y=1;y<=(x[_].length-w)/10+1;++y)t(x[_].slice(w+(y-1)*10,w+y*10).trim(),p,_,y,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var g={},h=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?h=!h:!h&&x in r&&(g[x]=(g[x]||0)+1);x=[];for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&x.push([g[p],p]);if(!x.length){g=n;for(p in g)Object.prototype.hasOwnProperty.call(g,p)&&x.push([g[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(d,g){var h=g||{},p="",x=h.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):h&&h.FS?p=h.FS:p=s(d.slice(0,1024));var w=0,S=0,_=0,y=0,k=0,N=p.charCodeAt(0),E=!1,A=0,C=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=h.dateNF!=null?ese(h.dateNF):null;function P(){var M=d.slice(y,k),I={};if(M.charAt(0)=='"'&&M.charAt(M.length-1)=='"'&&(M=M.slice(1,-1).replace(/""/g,'"')),M.length===0)I.t="z";else if(h.raw)I.t="s",I.v=M;else if(M.trim().length===0)I.t="s",I.v=M;else if(M.charCodeAt(0)==61)M.charCodeAt(1)==34&&M.charCodeAt(M.length-1)==34?(I.t="s",I.v=M.slice(2,-1).replace(/""/g,'"')):Ace(M)?(I.t="n",I.f=M.slice(1)):(I.t="s",I.v=M);else if(M=="TRUE")I.t="b",I.v=!0;else if(M=="FALSE")I.t="b",I.v=!1;else if(!isNaN(_=Qi(M)))I.t="n",h.cellText!==!1&&(I.w=M),I.v=_;else if(!isNaN(rh(M).getDate())||F&&M.match(F)){I.z=h.dateNF||Kt[14];var Y=0;F&&M.match(F)&&(M=tse(M,h.dateNF,M.match(F)||[]),Y=1),h.cellDates?(I.t="d",I.v=en(M,Y)):(I.t="n",I.v=ns(en(M,Y))),h.cellText!==!1&&(I.w=Ei(I.z,I.v instanceof Date?ns(I.v):I.v)),h.cellNF||delete I.z}else I.t="s",I.v=M;if(I.t=="z"||(h.dense?(x[w]||(x[w]=[]),x[w][S]=I):x[Yt({c:S,r:w})]=I),y=k+1,C=d.charCodeAt(y),v.e.c<S&&(v.e.c=S),v.e.r<w&&(v.e.r=w),A==N)++S;else if(S=0,++w,h.sheetRows&&h.sheetRows<=w)return!0}e:for(;k<d.length;++k)switch(A=d.charCodeAt(k)){case 34:C===34&&(E=!E);break;case N:case 10:case 13:if(!E&&P())break e;break}return k-y>0&&P(),x["!ref"]=or(v),x}function i(d,g){return!(g&&g.PRN)||g.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,g):Dh(e(d,g),g)}function o(d,g){var h="",p=g.type=="string"?[0,0,0,0]:P4(d,g);switch(g.type){case"base64":h=Ga(d);break;case"binary":h=d;break;case"buffer":g.codepage==65001?h=d.toString("utf8"):g.codepage&&typeof Bg<"u"||(h=fr&&Buffer.isBuffer(d)?d.toString("binary"):Gc(d));break;case"array":h=Zu(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+g.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=$r(h.slice(3)):g.type!="string"&&g.type!="buffer"&&g.codepage==65001?h=$r(h):g.type=="binary"&&typeof Bg<"u",h.slice(0,19)=="socialcalc:version:"?oO.to_sheet(g.type=="string"?h:$r(h),g):i(h,g)}function l(d,g){return Vc(o(d,g),g)}function u(d){for(var g=[],h=kr(d["!ref"]),p,x=Array.isArray(d),v=h.s.r;v<=h.e.r;++v){for(var w=[],S=h.s.c;S<=h.e.c;++S){var _=Yt({r:v,c:S});if(p=x?(d[v]||[])[S]:d[_],!p||p.v==null){w.push("          ");continue}for(var y=(p.w||(bl(p),p.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(S===0?" ":""))}g.push(w.join(""))}return g.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function moe(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var s=aO.to_workbook(t,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return nh.to_workbook(t,e)}}var Fu=function(){function t(H,V,q){if(H){ks(H,H.l||0);for(var Q=q.Enum||X;H.l<H.length;){var ae=H.read_shift(2),J=Q[ae]||Q[65535],re=H.read_shift(2),ve=H.l+re,we=J.f&&J.f(H,re,q);if(H.l=ve,V(we,J,ae))return}}}function e(H,V){switch(V.type){case"base64":return r(Ba(Ga(H)),V);case"binary":return r(Ba(H),V);case"buffer":case"array":return r(H,V)}throw"Unsupported type "+V.type}function r(H,V){if(!H)return H;var q=V||{},Q=q.dense?[]:{},ae="Sheet1",J="",re=0,ve={},we=[],Fe=[],ne={s:{r:0,c:0},e:{r:0,c:0}},Ee=q.sheetRows||0;if(H[2]==0&&(H[3]==8||H[3]==9)&&H.length>=16&&H[14]==5&&H[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(H[2]==2)q.Enum=X,t(H,function(Me,Ft,Ut){switch(Ut){case 0:q.vers=Me,Me>=4096&&(q.qpro=!0);break;case 6:ne=Me;break;case 204:Me&&(J=Me);break;case 222:J=Me;break;case 15:case 51:q.qpro||(Me[1].v=Me[1].v.slice(1));case 13:case 14:case 16:Ut==14&&(Me[2]&112)==112&&(Me[2]&15)>1&&(Me[2]&15)<15&&(Me[1].z=q.dateNF||Kt[14],q.cellDates&&(Me[1].t="d",Me[1].v=zv(Me[1].v))),q.qpro&&Me[3]>re&&(Q["!ref"]=or(ne),ve[ae]=Q,we.push(ae),Q=q.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},re=Me[3],ae=J||"Sheet"+(re+1),J="");var Pe=q.dense?(Q[Me[0].r]||[])[Me[0].c]:Q[Yt(Me[0])];if(Pe){Pe.t=Me[1].t,Pe.v=Me[1].v,Me[1].z!=null&&(Pe.z=Me[1].z),Me[1].f!=null&&(Pe.f=Me[1].f);break}q.dense?(Q[Me[0].r]||(Q[Me[0].r]=[]),Q[Me[0].r][Me[0].c]=Me[1]):Q[Yt(Me[0])]=Me[1];break}},q);else if(H[2]==26||H[2]==14)q.Enum=te,H[2]==14&&(q.qpro=!0,H.l=0),t(H,function(Me,Ft,Ut){switch(Ut){case 204:ae=Me;break;case 22:Me[1].v=Me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Me[3]>re&&(Q["!ref"]=or(ne),ve[ae]=Q,we.push(ae),Q=q.dense?[]:{},ne={s:{r:0,c:0},e:{r:0,c:0}},re=Me[3],ae="Sheet"+(re+1)),Ee>0&&Me[0].r>=Ee)break;q.dense?(Q[Me[0].r]||(Q[Me[0].r]=[]),Q[Me[0].r][Me[0].c]=Me[1]):Q[Yt(Me[0])]=Me[1],ne.e.c<Me[0].c&&(ne.e.c=Me[0].c),ne.e.r<Me[0].r&&(ne.e.r=Me[0].r);break;case 27:Me[14e3]&&(Fe[Me[14e3][0]]=Me[14e3][1]);break;case 1537:Fe[Me[0]]=Me[1],Me[0]==re&&(ae=Me[1]);break}},q);else throw new Error("Unrecognized LOTUS BOF "+H[2]);if(Q["!ref"]=or(ne),ve[J||ae]=Q,we.push(J||ae),!Fe.length)return{SheetNames:we,Sheets:ve};for(var ke={},He=[],at=0;at<Fe.length;++at)ve[we[at]]?(He.push(Fe[at]||we[at]),ke[Fe[at]]=ve[Fe[at]]||ve[we[at]]):(He.push(Fe[at]),ke[Fe[at]]={"!ref":"A1"});return{SheetNames:He,Sheets:ke}}function n(H,V){var q=V||{};if(+q.codepage>=0&&Gi(+q.codepage),q.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Fa(),ae=kr(H["!ref"]),J=Array.isArray(H),re=[];kt(Q,0,a(1030)),kt(Q,6,l(ae));for(var ve=Math.min(ae.e.r,8191),we=ae.s.r;we<=ve;++we)for(var Fe=On(we),ne=ae.s.c;ne<=ae.e.c;++ne){we===ae.s.r&&(re[ne]=gn(ne));var Ee=re[ne]+Fe,ke=J?(H[we]||[])[ne]:H[Ee];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?kt(Q,13,p(we,ne,ke.v)):kt(Q,14,v(we,ne,ke.v));else{var He=bl(ke);kt(Q,15,g(we,ne,He.slice(0,239)))}}return kt(Q,1),Q.end()}function s(H,V){var q=V||{};if(+q.codepage>=0&&Gi(+q.codepage),q.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Fa();kt(Q,0,i(H));for(var ae=0,J=0;ae<H.SheetNames.length;++ae)(H.Sheets[H.SheetNames[ae]]||{})["!ref"]&&kt(Q,27,R(H.SheetNames[ae],J++));var re=0;for(ae=0;ae<H.SheetNames.length;++ae){var ve=H.Sheets[H.SheetNames[ae]];if(!(!ve||!ve["!ref"])){for(var we=kr(ve["!ref"]),Fe=Array.isArray(ve),ne=[],Ee=Math.min(we.e.r,8191),ke=we.s.r;ke<=Ee;++ke)for(var He=On(ke),at=we.s.c;at<=we.e.c;++at){ke===we.s.r&&(ne[at]=gn(at));var Me=ne[at]+He,Ft=Fe?(ve[ke]||[])[at]:ve[Me];if(!(!Ft||Ft.t=="z"))if(Ft.t=="n")kt(Q,23,P(ke,at,re,Ft.v));else{var Ut=bl(Ft);kt(Q,22,A(ke,at,re,Ut.slice(0,239)))}}++re}}return kt(Q,1),Q.end()}function a(H){var V=Qe(2);return V.write_shift(2,H),V}function i(H){var V=Qe(26);V.write_shift(2,4096),V.write_shift(2,4),V.write_shift(4,0);for(var q=0,Q=0,ae=0,J=0;J<H.SheetNames.length;++J){var re=H.SheetNames[J],ve=H.Sheets[re];if(!(!ve||!ve["!ref"])){++ae;var we=Pa(ve["!ref"]);q<we.e.r&&(q=we.e.r),Q<we.e.c&&(Q=we.e.c)}}return q>8191&&(q=8191),V.write_shift(2,q),V.write_shift(1,ae),V.write_shift(1,Q),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(1,1),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(4,0),V}function o(H,V,q){var Q={s:{c:0,r:0},e:{c:0,r:0}};return V==8&&q.qpro?(Q.s.c=H.read_shift(1),H.l++,Q.s.r=H.read_shift(2),Q.e.c=H.read_shift(1),H.l++,Q.e.r=H.read_shift(2),Q):(Q.s.c=H.read_shift(2),Q.s.r=H.read_shift(2),V==12&&q.qpro&&(H.l+=2),Q.e.c=H.read_shift(2),Q.e.r=H.read_shift(2),V==12&&q.qpro&&(H.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function l(H){var V=Qe(8);return V.write_shift(2,H.s.c),V.write_shift(2,H.s.r),V.write_shift(2,H.e.c),V.write_shift(2,H.e.r),V}function u(H,V,q){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return q.qpro&&q.vers!=20768?(Q[0].c=H.read_shift(1),Q[3]=H.read_shift(1),Q[0].r=H.read_shift(2),H.l+=2):(Q[2]=H.read_shift(1),Q[0].c=H.read_shift(2),Q[0].r=H.read_shift(2)),Q}function d(H,V,q){var Q=H.l+V,ae=u(H,V,q);if(ae[1].t="s",q.vers==20768){H.l++;var J=H.read_shift(1);return ae[1].v=H.read_shift(J,"utf8"),ae}return q.qpro&&H.l++,ae[1].v=H.read_shift(Q-H.l,"cstr"),ae}function g(H,V,q){var Q=Qe(7+q.length);Q.write_shift(1,255),Q.write_shift(2,V),Q.write_shift(2,H),Q.write_shift(1,39);for(var ae=0;ae<Q.length;++ae){var J=q.charCodeAt(ae);Q.write_shift(1,J>=128?95:J)}return Q.write_shift(1,0),Q}function h(H,V,q){var Q=u(H,V,q);return Q[1].v=H.read_shift(2,"i"),Q}function p(H,V,q){var Q=Qe(7);return Q.write_shift(1,255),Q.write_shift(2,V),Q.write_shift(2,H),Q.write_shift(2,q,"i"),Q}function x(H,V,q){var Q=u(H,V,q);return Q[1].v=H.read_shift(8,"f"),Q}function v(H,V,q){var Q=Qe(13);return Q.write_shift(1,255),Q.write_shift(2,V),Q.write_shift(2,H),Q.write_shift(8,q,"f"),Q}function w(H,V,q){var Q=H.l+V,ae=u(H,V,q);if(ae[1].v=H.read_shift(8,"f"),q.qpro)H.l=Q;else{var J=H.read_shift(2);k(H.slice(H.l,H.l+J),ae),H.l+=J}return ae}function S(H,V,q){var Q=V&32768;return V&=-32769,V=(Q?H:0)+(V>=8192?V-16384:V),(Q?"":"$")+(q?gn(V):On(V))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(H,V){ks(H,0);for(var q=[],Q=0,ae="",J="",re="",ve="";H.l<H.length;){var we=H[H.l++];switch(we){case 0:q.push(H.read_shift(8,"f"));break;case 1:J=S(V[0].c,H.read_shift(2),!0),ae=S(V[0].r,H.read_shift(2),!1),q.push(J+ae);break;case 2:{var Fe=S(V[0].c,H.read_shift(2),!0),ne=S(V[0].r,H.read_shift(2),!1);J=S(V[0].c,H.read_shift(2),!0),ae=S(V[0].r,H.read_shift(2),!1),q.push(Fe+ne+":"+J+ae)}break;case 3:if(H.l<H.length){console.error("WK1 premature formula end");return}break;case 4:q.push("("+q.pop()+")");break;case 5:q.push(H.read_shift(2));break;case 6:{for(var Ee="";we=H[H.l++];)Ee+=String.fromCharCode(we);q.push('"'+Ee.replace(/"/g,'""')+'"')}break;case 8:q.push("-"+q.pop());break;case 23:q.push("+"+q.pop());break;case 22:q.push("NOT("+q.pop()+")");break;case 20:case 21:ve=q.pop(),re=q.pop(),q.push(["AND","OR"][we-20]+"("+re+","+ve+")");break;default:if(we<32&&y[we])ve=q.pop(),re=q.pop(),q.push(re+y[we]+ve);else if(_[we]){if(Q=_[we][1],Q==69&&(Q=H[H.l++]),Q>q.length){console.error("WK1 bad formula parse 0x"+we.toString(16)+":|"+q.join("|")+"|");return}var ke=q.slice(-Q);q.length-=Q,q.push(_[we][0]+"("+ke.join(",")+")")}else return we<=7?console.error("WK1 invalid opcode "+we.toString(16)):we<=24?console.error("WK1 unsupported op "+we.toString(16)):we<=30?console.error("WK1 invalid opcode "+we.toString(16)):we<=115?console.error("WK1 unsupported function opcode "+we.toString(16)):console.error("WK1 unrecognized opcode "+we.toString(16))}}q.length==1?V[1].f=""+q[0]:console.error("WK1 bad formula parse |"+q.join("|")+"|")}function N(H){var V=[{c:0,r:0},{t:"n",v:0},0];return V[0].r=H.read_shift(2),V[3]=H[H.l++],V[0].c=H[H.l++],V}function E(H,V){var q=N(H);return q[1].t="s",q[1].v=H.read_shift(V-4,"cstr"),q}function A(H,V,q,Q){var ae=Qe(6+Q.length);ae.write_shift(2,H),ae.write_shift(1,q),ae.write_shift(1,V),ae.write_shift(1,39);for(var J=0;J<Q.length;++J){var re=Q.charCodeAt(J);ae.write_shift(1,re>=128?95:re)}return ae.write_shift(1,0),ae}function C(H,V){var q=N(H);q[1].v=H.read_shift(2);var Q=q[1].v>>1;if(q[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return q[1].v=Q,q}function F(H,V){var q=N(H),Q=H.read_shift(4),ae=H.read_shift(4),J=H.read_shift(2);if(J==65535)return Q===0&&ae===3221225472?(q[1].t="e",q[1].v=15):Q===0&&ae===3489660928?(q[1].t="e",q[1].v=42):q[1].v=0,q;var re=J&32768;return J=(J&32767)-16446,q[1].v=(1-re*2)*(ae*Math.pow(2,J+32)+Q*Math.pow(2,J)),q}function P(H,V,q,Q){var ae=Qe(14);if(ae.write_shift(2,H),ae.write_shift(1,q),ae.write_shift(1,V),Q==0)return ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(2,65535),ae;var J=0,re=0,ve=0,we=0;return Q<0&&(J=1,Q=-Q),re=Math.log2(Q)|0,Q/=Math.pow(2,re-31),we=Q>>>0,we&2147483648||(Q/=2,++re,we=Q>>>0),Q-=we,we|=2147483648,we>>>=0,Q*=Math.pow(2,32),ve=Q>>>0,ae.write_shift(4,ve),ae.write_shift(4,we),re+=16383+(J?32768:0),ae.write_shift(2,re),ae}function M(H,V){var q=F(H);return H.l+=V-14,q}function I(H,V){var q=N(H),Q=H.read_shift(4);return q[1].v=Q>>6,q}function Y(H,V){var q=N(H),Q=H.read_shift(8,"f");return q[1].v=Q,q}function se(H,V){var q=Y(H);return H.l+=V-10,q}function L(H,V){return H[H.l+V-1]==0?H.read_shift(V,"cstr"):""}function z(H,V){var q=H[H.l++];q>V-1&&(q=V-1);for(var Q="";Q.length<q;)Q+=String.fromCharCode(H[H.l++]);return Q}function G(H,V,q){if(!(!q.qpro||V<21)){var Q=H.read_shift(1);H.l+=17,H.l+=1,H.l+=2;var ae=H.read_shift(V-21,"cstr");return[Q,ae]}}function O(H,V){for(var q={},Q=H.l+V;H.l<Q;){var ae=H.read_shift(2);if(ae==14e3){for(q[ae]=[0,""],q[ae][0]=H.read_shift(2);H[H.l];)q[ae][1]+=String.fromCharCode(H[H.l]),H.l++;H.l++}}return q}function R(H,V){var q=Qe(5+H.length);q.write_shift(2,14e3),q.write_shift(2,V);for(var Q=0;Q<H.length;++Q){var ae=H.charCodeAt(Q);q[q.l++]=ae>127?95:ae}return q[q.l++]=0,q}var X={0:{n:"BOF",f:Hn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:L},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},te={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:C},25:{n:"FORMULA19",f:M},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:O},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:se},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:L},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:G},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:e}}();function poe(t){var e={},r=t.match(ea),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=qt(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;e.cp=YT[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=a.val;break;case"<sz":e.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":a.rgb&&(e.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return e}var xoe=function(){var t=Wg("t"),e=Wg("rPr");function r(a){var i=a.match(t);if(!i)return{t:"s",v:""};var o={t:"s",v:Sr(i[1])},l=a.match(e);return l&&(o.s=poe(l[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),yoe=function(){var e=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var l=s.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(a.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(e,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),voe=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,woe=/<(?:\w+:)?r>/,_oe=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function v4(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Sr($r(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=$r(t),r&&(n.h=a4(n.t))):t.match(woe)&&(n.r=$r(t),n.t=Sr($r((t.replace(_oe,"").match(voe)||[]).join("").replace(ea,""))),r&&(n.h=yoe(xoe(n.r)))),n):{t:""}}var boe=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Soe=/<(?:\w+:)?(?:si|sstItem)>/g,koe=/<\/(?:\w+:)?(?:si|sstItem)>/;function Coe(t,e){var r=[],n="";if(!t)return r;var s=t.match(boe);if(s){n=s[2].replace(Soe,"").split(koe);for(var a=0;a!=n.length;++a){var i=v4(n[a].trim(),e);i!=null&&(r[r.length]=i)}s=qt(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Toe=/^\s|\s$|[\t\n\r]/;function lO(t,e){if(!e.bookSST)return"";var r=[Bn];r[r.length]=St("sst",null,{xmlns:yd[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var s=t[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Toe)&&(a+=' xml:space="preserve"'),a+=">"+Or(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Eoe(t){return[t.read_shift(4),t.read_shift(4)]}function Noe(t,e){var r=[],n=!1;return Fl(t,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Aoe(t,e){return e||(e=Qe(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var joe=Use;function Foe(t){var e=Fa();lt(e,159,Aoe(t));for(var r=0;r<t.length;++r)lt(e,19,joe(t[r]));return lt(e,160),e.end()}function cO(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function hl(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function Poe(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=hl(t,4),e.U=hl(t,4),e.W=hl(t,4),e}function Doe(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},s=t.read_shift(4),a=[];s-- >0;)a.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=a,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function Roe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(Doe(t));return e}function Moe(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function Ioe(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=hl(t,4),e.U=hl(t,4),e.W=hl(t,4),e}function Ooe(t){var e=Ioe(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function uO(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function dO(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function Loe(t){var e=hl(t);switch(e.Minor){case 2:return[e.Minor,Boe(t)];case 3:return[e.Minor,Uoe()];case 4:return[e.Minor,$oe(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function Boe(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=uO(t,r),s=dO(t,t.length-t.l);return{t:"Std",h:n,v:s}}function Uoe(){throw new Error("File is password-protected: ECMA-376 Extensible")}function $oe(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(ea,function(a){var i=qt(a);switch(Lo(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Woe(t,e){var r={},n=r.EncryptionVersionInfo=hl(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var s=t.read_shift(4);return e-=4,r.EncryptionHeader=uO(t,s),e-=s,r.EncryptionVerifier=dO(t,e),r}function Hoe(t){var e={},r=e.EncryptionVersionInfo=hl(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function w4(t){var e=0,r,n=cO(t),s=n.length+1,a,i,o,l,u;for(r=Cc(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=e&16384?1:0,l=e<<1&32767,u=o|l,e=u^i;return e^52811}var fO=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=e[i.length-1],l=104,u=i.length-1;u>=0;--u)for(var d=i[u],g=0;g!=7;++g)d&64&&(o^=r[l]),d*=2,--l;return o};return function(i){for(var o=cO(i),l=a(o),u=o.length,d=Cc(16),g=0;g!=16;++g)d[g]=0;var h,p,x;for((u&1)===1&&(h=l>>8,d[u]=s(t[0],h),--u,h=l&255,p=o[o.length-1],d[u]=s(p,h));u>0;)--u,h=l>>8,d[u]=s(o[u],h),--u,h=l&255,d[u]=s(o[u],h);for(u=15,x=15-o.length;x>0;)h=l>>8,d[u]=s(t[x],h),--u,--x,h=l&255,d[u]=s(o[u],h),--u,--x;return d}}(),zoe=function(t,e,r,n,s){s||(s=e),n||(n=fO(t));var a,i;for(a=0;a!=e.length;++a)i=e[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Goe=function(t){var e=0,r=fO(t);return function(n){var s=zoe("",n,e,r);return e=s[1],s[0]}};function Voe(t,e,r,n){var s={key:Hn(t),verificationBytes:Hn(t)};return r.password&&(s.verifier=w4(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Goe(r.password)),s}function Koe(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=Hoe(t):n.Data=Woe(t,e),n}function Xoe(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?Koe(t,e-2,n):Voe(t,r.biff>=8?e:e-2,r,n),n}var hO=function(){function t(s,a){switch(a.type){case"base64":return e(Ga(s),a);case"binary":return e(s,a);case"buffer":return e(fr&&Buffer.isBuffer(s)?s.toString("binary"):Gc(s),a);case"array":return e(Zu(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){var i=a||{},o=i.dense?[]:{},l=s.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(d,g){Array.isArray(o)&&(o[g]=[]);for(var h=/\\\w+\b/g,p=0,x,v=-1;x=h.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,h.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var S={v:w,t:"s"};Array.isArray(o)?o[g][v]=S:o[Yt({r:g,c:v})]=S}break}p=h.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=or(u),o}function r(s,a){return Vc(t(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=kr(s["!ref"]),o,l=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var g=Yt({r:u,c:d});o=l?(s[u]||[])[d]:s[g],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(bl(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function Yoe(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function Vg(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function Joe(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,s=Math.max(e,r,n),a=Math.min(e,r,n),i=s-a;if(i===0)return[0,0,e];var o=0,l=0,u=s+a;switch(l=i/(u>1?2-u:u),s){case e:o=((r-n)/i+6)%6;break;case r:o=(n-e)/i+2;break;case n:o=(e-r)/i+4;break}return[o/6,l,u/2]}function Qoe(t){var e=t[0],r=t[1],n=t[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*e,l;if(r!==0)switch(o|0){case 0:case 6:l=s*o,i[0]+=s,i[1]+=l;break;case 1:l=s*(2-o),i[0]+=l,i[1]+=s;break;case 2:l=s*(o-2),i[1]+=s,i[2]+=l;break;case 3:l=s*(4-o),i[1]+=l,i[2]+=s;break;case 4:l=s*(o-4),i[2]+=s,i[0]+=l;break;case 5:l=s*(6-o),i[2]+=l,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function ay(t,e){if(e===0)return t;var r=Joe(Yoe(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),Vg(Qoe(r))}var gO=6,qoe=15,Zoe=1,Hs=gO;function Kg(t){return Math.floor((t+Math.round(128/Hs)/256)*Hs)}function Xg(t){return Math.floor((t-5)/Hs*100+.5)/100}function iy(t){return Math.round((t*Hs+5)/Hs*256)/256}function E2(t){return iy(Xg(Kg(t)))}function _4(t){var e=Math.abs(t-E2(t)),r=Hs;if(e>.005)for(Hs=Zoe;Hs<qoe;++Hs)Math.abs(t-E2(t))<=e&&(e=Math.abs(t-E2(t)),r=Hs);Hs=r}function Tc(t){t.width?(t.wpx=Kg(t.width),t.wch=Xg(t.wpx),t.MDW=Hs):t.wpx?(t.wch=Xg(t.wpx),t.width=iy(t.wch),t.MDW=Hs):typeof t.wch=="number"&&(t.width=iy(t.wch),t.wpx=Kg(t.width),t.MDW=Hs),t.customWidth&&delete t.customWidth}var ele=96,mO=ele;function Yg(t){return t*96/mO}function sh(t){return t*mO/96}var tle={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function rle(t,e,r,n){e.Borders=[];var s={},a=!1;(t[0].match(ea)||[]).forEach(function(i){var o=qt(i);switch(Lo(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Yr(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Yr(o.diagonalDown)),e.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function nle(t,e,r,n){e.Fills=[];var s={},a=!1;(t[0].match(ea)||[]).forEach(function(i){var o=qt(i);switch(Lo(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},e.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function sle(t,e,r,n){e.Fonts=[];var s={},a=!1;(t[0].match(ea)||[]).forEach(function(i){var o=qt(i);switch(Lo(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=$r(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Yr(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Yr(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Yr(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Yr(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Yr(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Yr(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Yr(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=YT[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Yr(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var l=Au[s.color.index];s.color.index==81&&(l=Au[1]),l||(l=Au[1]),s.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=ay(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function ale(t,e,r){e.NumberFmt=[];for(var n=jn(Kt),s=0;s<n.length;++s)e.NumberFmt[n[s]]=Kt[n[s]];var a=t[0].match(ea);if(a)for(s=0;s<a.length;++s){var i=qt(a[s]);switch(Lo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Sr($r(i.formatCode)),l=parseInt(i.numFmtId,10);if(e.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&e.NumberFmt[l]!=null;--l);e.NumberFmt[l]=o}fl(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function ile(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=St("numFmt",null,{numFmtId:n,formatCode:Or(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=St("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var yx=["numFmtId","fillId","fontId","borderId","xfId"],vx=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function ole(t,e,r){e.CellXf=[];var n,s=!1;(t[0].match(ea)||[]).forEach(function(a){var i=qt(a),o=0;switch(Lo(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<yx.length;++o)n[yx[o]]&&(n[yx[o]]=parseInt(n[yx[o]],10));for(o=0;o<vx.length;++o)n[vx[o]]&&(n[vx[o]]=Yr(n[vx[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=Yr(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function lle(t){var e=[];return e[e.length]=St("cellXfs",null),t.forEach(function(r){e[e.length]=St("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=St("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var cle=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var g;return(g=o.match(e))&&ale(g,d,u),(g=o.match(s))&&sle(g,d,l,u),(g=o.match(n))&&nle(g,d,l,u),(g=o.match(a))&&rle(g,d,l,u),(g=o.match(r))&&ole(g,d,u),d}}();function pO(t,e){var r=[Bn,St("styleSheet",null,{xmlns:yd[0],"xmlns:vt":es.vt})],n;return t.SSF&&(n=ile(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=lle(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ule(t,e){var r=t.read_shift(2),n=Xs(t);return[r,n]}function dle(t,e,r){r||(r=Qe(6+4*e.length)),r.write_shift(2,t),ps(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function fle(t,e,r){var n={};n.sz=t.read_shift(2)/20;var s=Kse(t);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=t.read_shift(2);switch(a===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=t.read_shift(1);i!=0&&(n.underline=i);var o=t.read_shift(1);o>0&&(n.family=o);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=Vse(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Xs(t),n}function hle(t,e){e||(e=Qe(25+4*32)),e.write_shift(2,t.sz*20),Xse(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),ry(t.color,e);var n=0;return n=2,e.write_shift(1,n),ps(t.name,e),e.length>e.l?e.slice(0,e.l):e}var gle=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],N2,mle=Qs;function dj(t,e){e||(e=Qe(4*3+8*7+16*1)),N2||(N2=Wv(gle));var r=N2[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(ry({auto:1},e),ry({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function ple(t,e){var r=t.l+e,n=t.read_shift(2),s=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:s}}function xO(t,e,r){r||(r=Qe(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function x0(t,e){return e||(e=Qe(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var xle=Qs;function yle(t,e){return e||(e=Qe(51)),e.write_shift(1,0),x0(null,e),x0(null,e),x0(null,e),x0(null,e),x0(null,e),e.length>e.l?e.slice(0,e.l):e}function vle(t,e){return e||(e=Qe(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),ty(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function wle(t,e,r){var n=Qe(2052);return n.write_shift(4,t),ty(e,n),ty(r,n),n.length>n.l?n.slice(0,n.l):n}function _le(t,e,r){var n={};n.NumberFmt=[];for(var s in Kt)n.NumberFmt[s]=Kt[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Fl(t,function(l,u,d){switch(d){case 44:n.NumberFmt[l[0]]=l[1],fl(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(l.color.rgb=ay(e.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function ble(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&++r}),r!=0&&(lt(t,615,qi(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&lt(t,44,dle(s,e[s]))}),lt(t,616))}}function Sle(t){var e=1;lt(t,611,qi(e)),lt(t,43,hle({sz:12,color:{theme:1},name:"Calibri",family:2})),lt(t,612)}function kle(t){var e=2;lt(t,603,qi(e)),lt(t,45,dj({patternType:"none"})),lt(t,45,dj({patternType:"gray125"})),lt(t,604)}function Cle(t){var e=1;lt(t,613,qi(e)),lt(t,46,yle()),lt(t,614)}function Tle(t){var e=1;lt(t,626,qi(e)),lt(t,47,xO({numFmtId:0},65535)),lt(t,627)}function Ele(t,e){lt(t,617,qi(e.length)),e.forEach(function(r){lt(t,47,xO(r,0))}),lt(t,618)}function Nle(t){var e=1;lt(t,619,qi(e)),lt(t,48,vle({xfId:0,name:"Normal"})),lt(t,620)}function Ale(t){var e=0;lt(t,505,qi(e)),lt(t,506)}function jle(t){var e=0;lt(t,508,wle(e,"TableStyleMedium9","PivotStyleMedium4")),lt(t,509)}function Fle(t,e){var r=Fa();return lt(r,278),ble(r,t.SSF),Sle(r),kle(r),Cle(r),Tle(r),Ele(r,e.cellXfs),Nle(r),Ale(r),jle(r),lt(r,279),r.end()}var Ple=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Dle(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(ea)||[]).forEach(function(s){var a=qt(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(e.themeElements.clrScheme[Ple.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Rle(){}function Mle(){}var Ile=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ole=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Lle=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ble(t,e,r){e.themeElements={};var n;[["clrScheme",Ile,Dle],["fontScheme",Ole,Rle],["fmtScheme",Lle,Mle]].forEach(function(s){if(!(n=t.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,e,r)})}var Ule=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function yO(t,e){(!t||t.length===0)&&(t=b4());var r,n={};if(!(r=t.match(Ule)))throw new Error("themeElements not found in theme");return Ble(r[0],n,e),n.raw=t,n}function b4(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Bn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function $le(t,e,r){var n=t.l+e,s=t.read_shift(4);if(s!==124226){if(!r.cellStyles){t.l=n;return}var a=t.slice(t.l);t.l=n;var i;try{i=uI(a,{type:"array"})}catch{return}var o=Ua(i,"theme/theme/theme1.xml",!0);if(o)return yO(o,r)}}function Wle(t){return t.read_shift(4)}function Hle(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=zle(t,4);break;case 2:e.xclrValue=QI(t);break;case 3:e.xclrValue=Wle(t);break;case 4:t.l+=4;break}return t.l+=8,e}function zle(t,e){return Qs(t,e)}function Gle(t,e){return Qs(t,e)}function Vle(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Hle(t);break;case 6:n[1]=Gle(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function Kle(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var s=t.read_shift(2),a=[];s-- >0;)a.push(Vle(t,r-t.l));return{ixfe:n,ext:a}}function Xle(t,e){e.forEach(function(r){switch(r[0]){}})}function Yle(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Xs(t)}}function Jle(t){var e=Qe(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),ps(t.name,e),e.slice(0,e.l)}function Qle(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function qle(t){var e=Qe(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Zle(t,e){var r=Qe(8+2*e.length);return r.write_shift(4,t),ps(e,r),r.slice(0,r.l)}function ece(t){return t.l+=4,t.read_shift(4)!=0}function tce(t,e){var r=Qe(8);return r.write_shift(4,t),r.write_shift(4,1),r}function rce(t,e,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Fl(t,function(l,u,d){switch(d){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(g){o==1?n.Cell.push({type:n.Types[g[0]-1].name,index:g[1]}):o==0&&n.Value.push({type:n.Types[g[0]-1].name,index:g[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function nce(){var t=Fa();return lt(t,332),lt(t,334,qi(1)),lt(t,335,Jle({name:"XLDAPR",version:12e4,flags:3496657072})),lt(t,336),lt(t,339,Zle(1,"XLDAPR")),lt(t,52),lt(t,35,qi(514)),lt(t,4096,qi(0)),lt(t,4097,gi(1)),lt(t,36),lt(t,53),lt(t,340),lt(t,337,tce(1)),lt(t,51,qle([[1,0]])),lt(t,338),lt(t,333),t.end()}function sce(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var s=!1,a=2,i;return t.replace(ea,function(o){var l=qt(o);switch(Lo(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==l.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):a==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function vO(){var t=[Bn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function ace(t){var e=[];if(!t)return e;var r=1;return(t.match(ea)||[]).forEach(function(n){var s=qt(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,e.push(s);break}}),e}function ice(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Yt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function oce(t,e,r){var n=[];return Fl(t,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function lce(t,e,r,n){if(!t)return t;var s=n||{},a=!1;Fl(t,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!l.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function cce(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var vf=1024;function wO(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[St("xml",null,{"xmlns:v":Oa.v,"xmlns:o":Oa.o,"xmlns:x":Oa.x,"xmlns:mv":Oa.mv}).replace(/\/>/,">"),St("o:shapelayout",St("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),St("v:shapetype",[St("v:stroke",null,{joinstyle:"miter"}),St("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];vf<t*1e3;)vf+=1e3;return e.forEach(function(a){var i=mn(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?St("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=St("v:fill",l,o),d={on:"t",obscured:"t"};++vf,s=s.concat(["<v:shape"+Hg({id:"_x0000_s"+vf,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,St("v:shadow",null,d),St("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Es("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),Es("x:AutoFill","False"),Es("x:Row",String(i.r)),Es("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function fj(t,e,r,n){var s=Array.isArray(t),a;e.forEach(function(i){var o=mn(i.ref);if(s?(t[o.r]||(t[o.r]=[]),a=t[o.r][o.c]):a=t[i.ref],!a){a={t:"z"},s?t[o.r][o.c]=a:t[i.ref]=a;var l=kr(t["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=or(l);u!==t["!ref"]&&(t["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var g=a.c.length-1;g>=0;--g){if(!r&&a.c[g].T)return;r&&!a.c[g].T&&a.c.splice(g,1)}if(r&&n){for(g=0;g<n.length;++g)if(d.a==n[g].id){d.a=n[g].name||d.a;break}}a.c.push(d)})}function uce(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=qt(o[0]),u={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},d=mn(l.ref);if(!(e.sheetRows&&e.sheetRows<=d.r)){var g=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!g&&!!g[1]&&v4(g[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function _O(t){var e=[Bn,St("comments",null,{xmlns:yd[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(s){var a=Or(s.a);r.indexOf(a)==-1&&(r.push(a),e.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(s=r.indexOf(Or(l.a))),a.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)e.push(Es("t",Or(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;e.push(Es("t",Or(i)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function dce(t,e){var r=[],n=!1,s={},a=0;return t.replace(ea,function(o,l){var u=qt(o);switch(Lo(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=l+o.length;break;case"</text>":s.t=t.slice(a,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function fce(t,e,r){var n=[Bn,St("ThreadedComments",null,{xmlns:es.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&e.indexOf(i.a)==-1&&e.push(i.a);var l={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,i.ID=l.id,i.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(i.a)).slice(-12)+"}"),n.push(St("threadedComment",Es("text",i.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function hce(t,e){var r=[],n=!1;return t.replace(ea,function(a){var i=qt(a);switch(Lo(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function gce(t){var e=[Bn,St("personList",null,{xmlns:es.TCMNT,"xmlns:x":yd[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(St("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function mce(t){var e={};e.iauthor=t.read_shift(4);var r=bd(t);return e.rfx=r.s,e.ref=Yt(r.s),t.l+=16,e}function pce(t,e){return e==null&&(e=Qe(36)),e.write_shift(4,t[1].iauthor),Rh(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var xce=Xs;function yce(t){return ps(t.slice(0,54))}function vce(t,e){var r=[],n=[],s={},a=!1;return Fl(t,function(o,l,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,e.sheetRows&&s.rfx&&e.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!a||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function wce(t){var e=Fa(),r=[];return lt(e,628),lt(e,630),t.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),lt(e,632,yce(s.a)))})}),lt(e,631),lt(e,633),t.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:mn(n[0]),e:mn(n[0])};lt(e,635,pce([a,s])),s.t&&s.t.length>0&&lt(e,637,Wse(s)),lt(e,636),delete s.iauthor})}),lt(e,634),lt(e,629),e.end()}var _ce="application/vnd.ms-office.vbaProject";function bce(t){var e=Wt.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Wt.utils.cfb_add(e,s,t.FileIndex[n].content)}}),Wt.write(e)}function Sce(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Wt.utils.cfb_add(t,s,e.FileIndex[n].content)}})}var bO=["xlsb","xlsm","xlam","biff8","xla"];function kce(){return{"!type":"dialog"}}function Cce(){return{"!type":"dialog"}}function Tce(){return{"!type":"macro"}}function Ece(){return{"!type":"macro"}}var Mf=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,s,a,i){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=e.c:--d,l?u+=e.r:--u,s+(o?"":"$")+gn(d)+(l?"":"$")+On(u)}return function(s,a){return e=a,s.replace(t,r)}}(),S4=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,k4=function(){return function(e,r){return e.replace(S4,function(n,s,a,i,o,l){var u=u4(i)-(a?0:r.c),d=c4(l)-(o?0:r.r),g=d==0?"":o?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+g+"C"+h})}}();function SO(t,e){return t.replace(S4,function(r,n,s,a,i,o){return n+(s=="$"?s+a:gn(u4(a)+e.c))+(i=="$"?i+o:On(c4(o)+e.r))})}function Nce(t,e,r){var n=Pa(e),s=n.s,a=mn(r),i={r:a.r-s.r,c:a.c-s.c};return SO(t,i)}function Ace(t){return t.length!=1}function hj(t){return t.replace(/_xlfn\./g,"")}function $n(t){t.l+=1}function Ec(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function kO(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return CO(t);r.biff==12&&(n=4)}var s=t.read_shift(n),a=t.read_shift(n),i=Ec(t),o=Ec(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function CO(t){var e=Ec(t),r=Ec(t),n=t.read_shift(1),s=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function jce(t,e,r){if(r.biff<8)return CO(t);var n=t.read_shift(r.biff==12?4:2),s=t.read_shift(r.biff==12?4:2),a=Ec(t),i=Ec(t);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function TO(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return Fce(t);var n=t.read_shift(r&&r.biff==12?4:2),s=Ec(t);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function Fce(t){var e=Ec(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function Pce(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Dce(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Rce(t);var s=t.read_shift(n>=12?4:2),a=t.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function Rce(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),s==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:s,rRel:n}}function Mce(t,e,r){var n=(t[t.l++]&96)>>5,s=kO(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Ice(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}var i=kO(t,a,r);return[n,s,i]}function Oce(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Lce(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=8;if(r)switch(r.biff){case 5:t.l+=12,a=6;break;case 12:a=12;break}return t.l+=a,[n,s]}function Bce(t,e,r){var n=(t[t.l++]&96)>>5,s=jce(t,e-1,r);return[n,s]}function Uce(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function gj(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function $ce(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(t.read_shift(r&&r.biff==2?1:2));return s}function Wce(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function Hce(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function zce(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function Gce(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function EO(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function Vce(t){return t.read_shift(2),EO(t)}function Kce(t){return t.read_shift(2),EO(t)}function Xce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=TO(t,0,r);return[n,s]}function Yce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=Dce(t,0,r);return[n,s]}function Jce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var a=TO(t,0,r);return[n,s,a]}function Qce(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var s=t.read_shift(r&&r.biff<=3?1:2);return[ede[s],jO[s],n]}function qce(t,e,r){var n=t[t.l++],s=t.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Zce(t);return[s,(a[0]===0?jO:Zue)[a[1]]]}function Zce(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function eue(t,e,r){t.l+=r&&r.biff==2?3:4}function tue(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function rue(t){return t.l++,Pl[t.read_shift(1)]}function nue(t){return t.l++,t.read_shift(2)}function sue(t){return t.l++,t.read_shift(1)!==0}function aue(t){return t.l++,zs(t)}function iue(t,e,r){return t.l++,Dm(t,e-1,r)}function oue(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Dn(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Pl[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=zs(t);break;case 2:r[1]=Sd(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function lue(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?bd:Gv)(t));return s}function cue(t,e,r){var n=0,s=0;r.biff==12?(n=t.read_shift(4),s=t.read_shift(4)):(s=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=oue(t,r.biff);return i}function uue(t,e,r){var n=t.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=t.read_shift(s);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,a]}function due(t,e,r){if(r.biff==5)return fue(t);var n=t.read_shift(1)>>>5&3,s=t.read_shift(2),a=t.read_shift(4);return[n,s,a]}function fue(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function hue(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function gue(t,e,r){var n=t.read_shift(1)>>>5&3,s=t.read_shift(r&&r.biff==2?1:2);return[n,s]}function mue(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function pue(t,e,r){var n=(t[t.l++]&96)>>5,s=t.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return t.l+=a,[n,s]}var xue=Qs,yue=Qs,vue=Qs;function Mm(t,e,r){return t.l+=2,[Pce(t)]}function C4(t){return t.l+=6,[]}var wue=Mm,_ue=C4,bue=C4,Sue=Mm;function NO(t){return t.l+=2,[Hn(t),t.read_shift(2)&1]}var kue=Mm,Cue=NO,Tue=C4,Eue=Mm,Nue=Mm,Aue=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function jue(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),s=t.read_shift(2),a=t.read_shift(2),i=Aue[r>>2&31];return{ixti:e,coltype:r&3,rt:i,idx:n,c:s,C:a}}function Fue(t){return t.l+=2,[t.read_shift(4)]}function Pue(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Due(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Rue(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Mue(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Iue(t){return t.l+=4,[0,0]}var mj={1:{n:"PtgExp",f:tue},2:{n:"PtgTbl",f:vue},3:{n:"PtgAdd",f:$n},4:{n:"PtgSub",f:$n},5:{n:"PtgMul",f:$n},6:{n:"PtgDiv",f:$n},7:{n:"PtgPower",f:$n},8:{n:"PtgConcat",f:$n},9:{n:"PtgLt",f:$n},10:{n:"PtgLe",f:$n},11:{n:"PtgEq",f:$n},12:{n:"PtgGe",f:$n},13:{n:"PtgGt",f:$n},14:{n:"PtgNe",f:$n},15:{n:"PtgIsect",f:$n},16:{n:"PtgUnion",f:$n},17:{n:"PtgRange",f:$n},18:{n:"PtgUplus",f:$n},19:{n:"PtgUminus",f:$n},20:{n:"PtgPercent",f:$n},21:{n:"PtgParen",f:$n},22:{n:"PtgMissArg",f:$n},23:{n:"PtgStr",f:iue},26:{n:"PtgSheet",f:Pue},27:{n:"PtgEndSheet",f:Due},28:{n:"PtgErr",f:rue},29:{n:"PtgBool",f:sue},30:{n:"PtgInt",f:nue},31:{n:"PtgNum",f:aue},32:{n:"PtgArray",f:Uce},33:{n:"PtgFunc",f:Qce},34:{n:"PtgFuncVar",f:qce},35:{n:"PtgName",f:uue},36:{n:"PtgRef",f:Xce},37:{n:"PtgArea",f:Mce},38:{n:"PtgMemArea",f:hue},39:{n:"PtgMemErr",f:xue},40:{n:"PtgMemNoMem",f:yue},41:{n:"PtgMemFunc",f:gue},42:{n:"PtgRefErr",f:mue},43:{n:"PtgAreaErr",f:Oce},44:{n:"PtgRefN",f:Yce},45:{n:"PtgAreaN",f:Bce},46:{n:"PtgMemAreaN",f:Rue},47:{n:"PtgMemNoMemN",f:Mue},57:{n:"PtgNameX",f:due},58:{n:"PtgRef3d",f:Jce},59:{n:"PtgArea3d",f:Ice},60:{n:"PtgRefErr3d",f:pue},61:{n:"PtgAreaErr3d",f:Lce},255:{}},Oue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Lue={1:{n:"PtgElfLel",f:NO},2:{n:"PtgElfRw",f:Eue},3:{n:"PtgElfCol",f:wue},6:{n:"PtgElfRwV",f:Nue},7:{n:"PtgElfColV",f:Sue},10:{n:"PtgElfRadical",f:kue},11:{n:"PtgElfRadicalS",f:Tue},13:{n:"PtgElfColS",f:_ue},15:{n:"PtgElfColSV",f:bue},16:{n:"PtgElfRadicalLel",f:Cue},25:{n:"PtgList",f:jue},29:{n:"PtgSxName",f:Fue},255:{}},Bue={0:{n:"PtgAttrNoop",f:Iue},1:{n:"PtgAttrSemi",f:Gce},2:{n:"PtgAttrIf",f:Hce},4:{n:"PtgAttrChoose",f:$ce},8:{n:"PtgAttrGoto",f:Wce},16:{n:"PtgAttrSum",f:eue},32:{n:"PtgAttrBaxcel",f:gj},33:{n:"PtgAttrBaxcel",f:gj},64:{n:"PtgAttrSpace",f:Vce},65:{n:"PtgAttrSpaceSemi",f:Kce},128:{n:"PtgAttrIfError",f:zce},255:{}};function Im(t,e,r,n){if(n.biff<8)return Qs(t,e);for(var s=t.l+e,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=cue(t,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=lue(t,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=t.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return e=s-t.l,e!==0&&a.push(Qs(t,e)),a}function Om(t,e,r){for(var n=t.l+e,s,a,i=[];n!=t.l;)e=n-t.l,a=t[t.l],s=mj[a]||mj[Oue[a]],(a===24||a===25)&&(s=(a===24?Lue:Bue)[t[t.l+1]]),!s||!s.f?Qs(t,e):i.push([s.n,s.f(t,e,r)]);return i}function Uue(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var $ue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Wue(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function AO(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(t[n[0]][0]){case 357:return s=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return t[n[0]][0][3]?(s=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function pj(t,e,r){var n=AO(t,e,r);return n=="#REF"?n:Wue(n,r)}function $s(t,e,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],l,u,d,g=0,h=0,p,x="";if(!t[0]||!t[0][0])return"";for(var v=-1,w="",S=0,_=t[0].length;S<_;++S){var y=t[0][S];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),v>=0){switch(t[0][v][1][0]){case 0:w=En(" ",t[0][v][1][1]);break;case 1:w=En("\r",t[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}u=u+w,v=-1}o.push(u+$ue[y[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Y0(y[1][1],i,s),o.push(J0(d,a));break;case"PtgRefN":d=r?Y0(y[1][1],r,s):y[1][1],o.push(J0(d,a));break;case"PtgRef3d":g=y[1][1],d=Y0(y[1][2],i,s),x=pj(n,g,s),o.push(x+"!"+J0(d,a));break;case"PtgFunc":case"PtgFuncVar":var k=y[1][0],N=y[1][1];k||(k=0),k&=127;var E=k==0?[]:o.slice(-k);o.length-=k,N==="User"&&(N=E.shift()),o.push(N+"("+E.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":p=G8(y[1][1],r?{s:r}:i,s),o.push(k2(p,s));break;case"PtgArea":p=G8(y[1][1],i,s),o.push(k2(p,s));break;case"PtgArea3d":g=y[1][1],p=y[1][2],x=pj(n,g,s),o.push(x+"!"+k2(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=y[1][2];var A=(n.names||[])[h-1]||(n[0]||[])[h],C=A?A.Name:"SH33TJSNAME"+String(h);C&&C.slice(0,6)=="_xlfn."&&!s.xlfn&&(C=C.slice(6)),o.push(C);break;case"PtgNameX":var F=y[1][1];h=y[1][2];var P;if(s.biff<=5)F<0&&(F=-F),n[F]&&(P=n[F][h]);else{var M="";if(((n[F]||[])[0]||[])[0]==14849||(((n[F]||[])[0]||[])[0]==1025?n[F][h]&&n[F][h].itab>0&&(M=n.SheetNames[n[F][h].itab-1]+"!"):M=n.SheetNames[h-1]+"!"),n[F]&&n[F][h])M+=n[F][h].Name;else if(n[0]&&n[0][h])M+=n[0][h].Name;else{var I=(AO(n,F,s)||"").split(";;");I[h-1]?M=I[h-1]:M+="SH33TJSERRX"}o.push(M);break}P||(P={Name:"SH33TJSERRY"}),o.push(P.Name);break;case"PtgParen":var Y="(",se=")";if(v>=0){switch(w="",t[0][v][1][0]){case 2:Y=En(" ",t[0][v][1][1])+Y;break;case 3:Y=En("\r",t[0][v][1][1])+Y;break;case 4:se=En(" ",t[0][v][1][1])+se;break;case 5:se=En("\r",t[0][v][1][1])+se;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][v][1][0])}v=-1}o.push(Y+o.pop()+se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:y[1][1],r:y[1][0]};var L={c:r.c,r:r.r};if(n.sharedf[Yt(d)]){var z=n.sharedf[Yt(d)];o.push($s(z,i,L,n,s))}else{var G=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push($s(u[1],i,L,n,s)),G=!0;break}G||o.push(y[1])}break;case"PtgArray":o.push("{"+Uue(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var O=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&O.indexOf(t[0][S][0])==-1){y=t[0][v];var R=!0;switch(y[1][0]){case 4:R=!1;case 0:w=En(" ",y[1][1]);break;case 5:R=!1;case 1:w=En("\r",y[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((R?w:"")+o.pop()+(R?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Hue(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Qs(t,e-2)];var o=Om(t,i,r);return e!==i+s&&(a=Im(t,e-i-s,o,r)),t.l=n,[o,a]}function zue(t,e,r){var n=t.l+e,s=r.biff==2?1:2,a,i=t.read_shift(s);if(i==65535)return[[],Qs(t,e-2)];var o=Om(t,i,r);return e!==i+s&&(a=Im(t,e-i-s,o,r)),t.l=n,[o,a]}function Gue(t,e,r,n){var s=t.l+e,a=Om(t,n,r),i;return s!==t.l&&(i=Im(t,s-t.l,a,r)),[a,i]}function Vue(t,e,r){var n=t.l+e,s,a=t.read_shift(2),i=Om(t,a,r);return a==65535?[[],Qs(t,e-2)]:(e!==a+2&&(s=Im(t,n-a-2,i,r)),[i,s])}function Kue(t){var e;if(ol(t,t.l+6)!==65535)return[zs(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function Xue(t){if(t==null){var e=Qe(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return ed(t);return ed(0)}function A2(t,e,r){var n=t.l+e,s=Bo(t);r.biff==2&&++t.l;var a=Kue(t),i=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=zue(t,n-t.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Yue(t,e,r,n,s){var a=rd(e,r,s),i=Xue(t.v),o=Qe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Qe(t.bf.length),d=0;d<t.bf.length;++d)u[d]=t.bf[d];var g=gs([a,i,o,u]);return g}function Vv(t,e,r){var n=t.read_shift(4),s=Om(t,n,r),a=t.read_shift(4),i=a>0?Im(t,a,s,r):null;return[s,i]}var Jue=Vv,Kv=Vv,Que=Vv,que=Vv,Zue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jO={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ede={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xj(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function tde(t){var e="of:="+t.replace(S4,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function j2(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function rde(t){return t.replace(/\./,"!")}var q0={},If={},Z0=typeof Map<"u";function T4(t,e,r){var n=0,s=t.length;if(r){if(Z0?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var a=Z0?r.get(e):r[e];n<a.length;++n)if(t[a[n]].t===e)return t.Count++,a[n]}}else for(;n<s;++n)if(t[n].t===e)return t.Count++,n;return t[s]={t:e},t.Count++,t.Unique++,r&&(Z0?(r.has(e)||r.set(e,[]),r.get(e).push(s)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(s))),s}function Xv(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Hs=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Xg(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=iy(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Pu(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Kc(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],s=60,a=t.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){fl(e.z,s),r.ssf[s]=e.z,r.revssf[e.z]=n=s;break}}for(s=0;s!=a;++s)if(t[s].numFmtId===n)return s;return t[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function FO(t,e,r,n,s,a){try{n.cellNF&&(t.z=Kt[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=en(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Kt[e]==null&&fl(Zne[e]||"General",e),t.t==="e")t.w=t.w||Pl[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$g(t.v);else if(t.t==="d"){var i=ns(t.v);(i|0)===i?t.w=i.toString(10):t.w=$g(i)}else{if(t.v===void 0)return"";t.w=qu(t.v,If)}else t.t==="d"?t.w=Ei(e,ns(t.v),If):t.w=Ei(e,t.v,If)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=a.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=ay(s.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=s.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=ay(s.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=s.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function nde(t,e,r){if(t&&t["!ref"]){var n=kr(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function sde(t,e){var r=kr(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=or(r))}var ade=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ide=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,ode=/<(?:\w:)?hyperlink [^>]*>/mg,lde=/"(\w*:\w*)"/,cde=/<(?:\w:)?col\b[^>]*[\/]?>/g,ude=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,dde=/<(?:\w:)?pageMargins[^>]*\/>/g,PO=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,fde=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,hde=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function gde(t,e,r,n,s,a,i){if(!t)return t;n||(n={"!id":{}});var o=e.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",g=t.match(ide);g?(u=t.slice(0,g.index),d=t.slice(g.index+g[0].length)):u=d=t;var h=u.match(PO);h?E4(h[0],o,s,r):(h=u.match(fde))&&pde(h[0],h[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(lde);x&&sde(o,x[1])}var v=u.match(hde);v&&v[1]&&Ade(v[1],s);var w=[];if(e.cellStyles){var S=u.match(cde);S&&kde(w,S)}g&&Pde(g[1],o,e,l,a,i);var _=d.match(ude);_&&(o["!autofilter"]=Tde(_[0]));var y=[],k=d.match(ade);if(k)for(p=0;p!=k.length;++p)y[p]=kr(k[p].slice(k[p].indexOf('"')+1));var N=d.match(ode);N&&_de(o,N,n);var E=d.match(dde);if(E&&(o["!margins"]=bde(qt(E[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=or(l)),e.sheetRows>0&&o["!ref"]){var A=kr(o["!ref"]);e.sheetRows<=+A.e.r&&(A.e.r=e.sheetRows-1,A.e.r>l.e.r&&(A.e.r=l.e.r),A.e.r<A.s.r&&(A.s.r=A.e.r),A.e.c>l.e.c&&(A.e.c=l.e.c),A.e.c<A.s.c&&(A.s.c=A.e.c),o["!fullref"]=o["!ref"],o["!ref"]=or(A))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function mde(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+or(t[r])+'"/>';return e+"</mergeCells>"}function E4(t,e,r,n){var s=qt(t);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Sr($r(s.codeName)))}function pde(t,e,r,n,s){E4(t.slice(0,t.indexOf(">")),r,n,s)}function xde(t,e,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,i.codeName=To(Or(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),o=(o||"")+St("outlinePr",null,u)}!a&&!o||(s[s.length]=St("sheetPr",o,i))}var yde=["objects","scenarios","selectLockedCells","selectUnlockedCells"],vde=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wde(t){var e={sheet:1};return yde.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),vde.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=w4(t.password).toString(16).toUpperCase()),St("sheetProtection",null,e)}function _de(t,e,r){for(var n=Array.isArray(t),s=0;s!=e.length;++s){var a=qt($r(e[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Sr(a.location))):(a.Target="#"+Sr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=kr(a.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var d=Yt({c:u,r:l});n?(t[l]||(t[l]=[]),t[l][u]||(t[l][u]={t:"z",v:void 0}),t[l][u].l=a):(t[d]||(t[d]={t:"z",v:void 0}),t[d].l=a)}}}function bde(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function Sde(t){return Pu(t),St("pageMargins",null,t)}function kde(t,e){for(var r=!1,n=0;n!=e.length;++n){var s=qt(e[n],!0);s.hidden&&(s.hidden=Yr(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,_4(s.width)),Tc(s);a<=i;)t[a++]=tn(s)}}function Cde(t,e){for(var r=["<cols>"],n,s=0;s!=e.length;++s)(n=e[s])&&(r[r.length]=St("col",null,Xv(s,n)));return r[r.length]="</cols>",r.join("")}function Tde(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function Ede(t,e,r,n){var s=typeof t.ref=="string"?t.ref:or(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Pa(s);i.s.r==i.e.r&&(i.e.r=Pa(e["!ref"]).e.r,s=or(i));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),St("autoFilter",null,{ref:s})}var Nde=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Ade(t,e){e.Views||(e.Views=[{}]),(t.match(Nde)||[]).forEach(function(r,n){var s=qt(r);e.Views[n]||(e.Views[n]={}),+s.zoomScale&&(e.Views[n].zoom=+s.zoomScale),Yr(s.rightToLeft)&&(e.Views[n].RTL=!0)})}function jde(t,e,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),St("sheetViews",St("sheetView",null,s),{})}function Fde(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var s="",a=t.t,i=t.v;if(t.t!=="z")switch(t.t){case"b":s=t.v?"1":"0";break;case"n":s=""+t.v;break;case"e":s=Pl[t.v];break;case"d":n&&n.cellDates?s=en(t.v,-1).toISOString():(t=tn(t),t.t="n",s=""+(t.v=ns(en(t.v)))),typeof t.z>"u"&&(t.z=Kt[14]);break;default:s=t.v;break}var o=Es("v",Or(s)),l={r:e},u=Kc(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Es("v",""+T4(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=a&&(t.t=a,t.v=i),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=St("f",Or(t.f),d)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),St("c",o,l)}var Pde=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Wg("v"),i=Wg("f");return function(l,u,d,g,h,p){for(var x=0,v="",w=[],S=[],_=0,y=0,k=0,N="",E,A,C=0,F=0,P,M,I=0,Y=0,se=Array.isArray(p.CellXf),L,z=[],G=[],O=Array.isArray(u),R=[],X={},te=!1,H=!!d.sheetStubs,V=l.split(e),q=0,Q=V.length;q!=Q;++q){v=V[q].trim();var ae=v.length;if(ae!==0){var J=0;e:for(x=0;x<ae;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(A=qt(v.slice(J,x),!0),C=A.r!=null?parseInt(A.r,10):C+1,F=-1,d.sheetRows&&d.sheetRows<C)continue;X={},te=!1,A.ht&&(te=!0,X.hpt=parseFloat(A.ht),X.hpx=sh(X.hpt)),A.hidden=="1"&&(te=!0,X.hidden=!0),A.outlineLevel!=null&&(te=!0,X.level=+A.outlineLevel),te&&(R[C-1]=X)}break;case"<":J=x;break}if(J>=x)break;if(A=qt(v.slice(J,x),!0),C=A.r!=null?parseInt(A.r,10):C+1,F=-1,!(d.sheetRows&&d.sheetRows<C)){g.s.r>C-1&&(g.s.r=C-1),g.e.r<C-1&&(g.e.r=C-1),d&&d.cellStyles&&(X={},te=!1,A.ht&&(te=!0,X.hpt=parseFloat(A.ht),X.hpx=sh(X.hpt)),A.hidden=="1"&&(te=!0,X.hidden=!0),A.outlineLevel!=null&&(te=!0,X.level=+A.outlineLevel),te&&(R[C-1]=X)),w=v.slice(x).split(t);for(var re=0;re!=w.length&&w[re].trim().charAt(0)=="<";++re);for(w=w.slice(re),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(S=v.match(r),_=x,y=0,k=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,S!=null&&S.length===2){for(_=0,N=S[1],y=0;y!=N.length&&!((k=N.charCodeAt(y)-64)<1||k>26);++y)_=26*_+k;--_,F=_}else++F;for(y=0;y!=v.length&&v.charCodeAt(y)!==62;++y);if(++y,A=qt(v.slice(0,y),!0),A.r||(A.r=Yt({r:C-1,c:F})),N=v.slice(y),E={t:""},(S=N.match(a))!=null&&S[1]!==""&&(E.v=Sr(S[1])),d.cellFormula){if((S=N.match(i))!=null&&S[1]!==""){if(E.f=Sr($r(S[1])).replace(/\r\n/g,`
`),d.xlfn||(E.f=hj(E.f)),S[0].indexOf('t="array"')>-1)E.F=(N.match(s)||[])[1],E.F.indexOf(":")>-1&&z.push([kr(E.F),E.F]);else if(S[0].indexOf('t="shared"')>-1){M=qt(S[0]);var ve=Sr($r(S[1]));d.xlfn||(ve=hj(ve)),G[parseInt(M.si,10)]=[M,ve,A.r]}}else(S=N.match(/<f[^>]*\/>/))&&(M=qt(S[0]),G[M.si]&&(E.f=Nce(G[M.si][1],G[M.si][2],A.r)));var we=mn(A.r);for(y=0;y<z.length;++y)we.r>=z[y][0].s.r&&we.r<=z[y][0].e.r&&we.c>=z[y][0].s.c&&we.c<=z[y][0].e.c&&(E.F=z[y][1])}if(A.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(H)E.t="z";else continue;else E.t=A.t||"n";switch(g.s.c>F&&(g.s.c=F),g.e.c<F&&(g.e.c=F),E.t){case"n":if(E.v==""||E.v==null){if(!H)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!H)continue;E.t="z"}else P=q0[parseInt(E.v,10)],E.v=P.t,E.r=P.r,d.cellHTML&&(E.h=P.h);break;case"str":E.t="s",E.v=E.v!=null?$r(E.v):"",d.cellHTML&&(E.h=a4(E.v));break;case"inlineStr":S=N.match(n),E.t="s",S!=null&&(P=v4(S[1]))?(E.v=P.t,d.cellHTML&&(E.h=P.h)):E.v="";break;case"b":E.v=Yr(E.v);break;case"d":d.cellDates?E.v=en(E.v,1):(E.v=ns(en(E.v,1)),E.t="n");break;case"e":(!d||d.cellText!==!1)&&(E.w=E.v),E.v=RI[E.v];break}if(I=Y=0,L=null,se&&A.s!==void 0&&(L=p.CellXf[A.s],L!=null&&(L.numFmtId!=null&&(I=L.numFmtId),d.cellStyles&&L.fillId!=null&&(Y=L.fillId))),FO(E,I,Y,d,h,p),d.cellDates&&se&&E.t=="n"&&Fh(Kt[I])&&(E.t="d",E.v=zv(E.v)),A.cm&&d.xlmeta){var Fe=(d.xlmeta.Cell||[])[+A.cm-1];Fe&&Fe.type=="XLDAPR"&&(E.D=!0)}if(O){var ne=mn(A.r);u[ne.r]||(u[ne.r]=[]),u[ne.r][ne.c]=E}else u[A.r]=E}}}}R.length>0&&(u["!rows"]=R)}}();function Dde(t,e,r,n){var s=[],a=[],i=kr(t["!ref"]),o="",l,u="",d=[],g=0,h=0,p=t["!rows"],x=Array.isArray(t),v={r:u},w,S=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=gn(h);for(g=i.s.r;g<=i.e.r;++g){for(a=[],u=On(g),h=i.s.c;h<=i.e.c;++h){l=d[h]+u;var _=x?(t[g]||[])[h]:t[l];_!==void 0&&(o=Fde(_,l,t,e))!=null&&a.push(o)}(a.length>0||p&&p[g])&&(v={r:u},p&&p[g]&&(w=p[g],w.hidden&&(v.hidden=1),S=-1,w.hpx?S=Yg(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(v.ht=S,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=St("row",a.join(""),v))}if(p)for(;g<p.length;++g)p&&p[g]&&(v={r:g+1},w=p[g],w.hidden&&(v.hidden=1),S=-1,w.hpx?S=Yg(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(v.ht=S,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=St("row","",v));return s.join("")}function DO(t,e,r,n){var s=[Bn,St("worksheet",null,{xmlns:yd[0],"xmlns:r":es.r})],a=r.SheetNames[t],i=0,o="",l=r.Sheets[a];l==null&&(l={});var u=l["!ref"]||"A1",d=kr(u);if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=or(d)}n||(n={}),l["!comments"]=[];var g=[];xde(l,r,t,e,s),s[s.length]=St("dimension",null,{ref:u}),s[s.length]=jde(l,e,t,r),e.sheetFormat&&(s[s.length]=St("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(s[s.length]=Cde(l,l["!cols"])),s[i=s.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=Dde(l,e),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),l["!protect"]&&(s[s.length]=wde(l["!protect"])),l["!autofilter"]!=null&&(s[s.length]=Ede(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(s[s.length]=mde(l["!merges"]));var h=-1,p,x=-1;return l["!links"].length>0&&(s[s.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Ir(n,-1,Or(v[1].Target).replace(/#.*$/,""),gr.HLINK),p["r:id"]="rId"+x),(h=v[1].Target.indexOf("#"))>-1&&(p.location=Or(v[1].Target.slice(h+1))),v[1].Tooltip&&(p.tooltip=Or(v[1].Tooltip)),s[s.length]=St("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(s[s.length]=Sde(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Es("ignoredErrors",St("ignoredError",null,{numberStoredAsText:1,sqref:u}))),g.length>0&&(x=Ir(n,-1,"../drawings/drawing"+(t+1)+".xml",gr.DRAW),s[s.length]=St("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=g),l["!comments"].length>0&&(x=Ir(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",gr.VML),s[s.length]=St("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Rde(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var s=t.read_shift(2);t.l+=1;var a=t.read_shift(1);return t.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function Mde(t,e,r){var n=Qe(145),s=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var a=320;s.hpx?a=Yg(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:t,c:0},d=0;d<16;++d)if(!(e.s.c>d+1<<10||e.e.c<d<<10)){for(var g=-1,h=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Yt(u)];x&&(g<0&&(g=p),h=p)}g<0||(++o,n.write_shift(4,g),n.write_shift(4,h))}var v=n.l;return n.l=l,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Ide(t,e,r,n){var s=Mde(n,r,e);(s.length>17||(e["!rows"]||[])[n])&&lt(t,0,s)}var Ode=bd,Lde=Rh;function Bde(){}function Ude(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=Hse(t),r}function $de(t,e,r){r==null&&(r=Qe(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return ry({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),AI(t,r),r.slice(0,r.l)}function Wde(t){var e=Ni(t);return[e]}function Hde(t,e,r){return r==null&&(r=Qe(8)),vd(e,r)}function zde(t){var e=wd(t);return[e]}function Gde(t,e,r){return r==null&&(r=Qe(4)),_d(e,r)}function Vde(t){var e=Ni(t),r=t.read_shift(1);return[e,r,"b"]}function Kde(t,e,r){return r==null&&(r=Qe(9)),vd(e,r),r.write_shift(1,t.v?1:0),r}function Xde(t){var e=wd(t),r=t.read_shift(1);return[e,r,"b"]}function Yde(t,e,r){return r==null&&(r=Qe(5)),_d(e,r),r.write_shift(1,t.v?1:0),r}function Jde(t){var e=Ni(t),r=t.read_shift(1);return[e,r,"e"]}function Qde(t,e,r){return r==null&&(r=Qe(9)),vd(e,r),r.write_shift(1,t.v),r}function qde(t){var e=wd(t),r=t.read_shift(1);return[e,r,"e"]}function Zde(t,e,r){return r==null&&(r=Qe(8)),_d(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function efe(t){var e=Ni(t),r=t.read_shift(4);return[e,r,"s"]}function tfe(t,e,r){return r==null&&(r=Qe(12)),vd(e,r),r.write_shift(4,e.v),r}function rfe(t){var e=wd(t),r=t.read_shift(4);return[e,r,"s"]}function nfe(t,e,r){return r==null&&(r=Qe(8)),_d(e,r),r.write_shift(4,e.v),r}function sfe(t){var e=Ni(t),r=zs(t);return[e,r,"n"]}function afe(t,e,r){return r==null&&(r=Qe(16)),vd(e,r),ed(t.v,r),r}function RO(t){var e=wd(t),r=zs(t);return[e,r,"n"]}function ife(t,e,r){return r==null&&(r=Qe(12)),_d(e,r),ed(t.v,r),r}function ofe(t){var e=Ni(t),r=g4(t);return[e,r,"n"]}function lfe(t,e,r){return r==null&&(r=Qe(12)),vd(e,r),jI(t.v,r),r}function cfe(t){var e=wd(t),r=g4(t);return[e,r,"n"]}function ufe(t,e,r){return r==null&&(r=Qe(8)),_d(e,r),jI(t.v,r),r}function dfe(t){var e=Ni(t),r=d4(t);return[e,r,"is"]}function ffe(t){var e=Ni(t),r=Xs(t);return[e,r,"str"]}function hfe(t,e,r){return r==null&&(r=Qe(12+4*t.v.length)),vd(e,r),ps(t.v,r),r.length>r.l?r.slice(0,r.l):r}function gfe(t){var e=wd(t),r=Xs(t);return[e,r,"str"]}function mfe(t,e,r){return r==null&&(r=Qe(8+4*t.v.length)),_d(e,r),ps(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pfe(t,e,r){var n=t.l+e,s=Ni(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"b"];if(r.cellFormula){t.l+=2;var o=Kv(t,n-t.l,r);i[3]=$s(o,null,s,r.supbooks,r)}else t.l=n;return i}function xfe(t,e,r){var n=t.l+e,s=Ni(t);s.r=r["!row"];var a=t.read_shift(1),i=[s,a,"e"];if(r.cellFormula){t.l+=2;var o=Kv(t,n-t.l,r);i[3]=$s(o,null,s,r.supbooks,r)}else t.l=n;return i}function yfe(t,e,r){var n=t.l+e,s=Ni(t);s.r=r["!row"];var a=zs(t),i=[s,a,"n"];if(r.cellFormula){t.l+=2;var o=Kv(t,n-t.l,r);i[3]=$s(o,null,s,r.supbooks,r)}else t.l=n;return i}function vfe(t,e,r){var n=t.l+e,s=Ni(t);s.r=r["!row"];var a=Xs(t),i=[s,a,"str"];if(r.cellFormula){t.l+=2;var o=Kv(t,n-t.l,r);i[3]=$s(o,null,s,r.supbooks,r)}else t.l=n;return i}var wfe=bd,_fe=Rh;function bfe(t,e){return e==null&&(e=Qe(4)),e.write_shift(4,t),e}function Sfe(t,e){var r=t.l+e,n=bd(t),s=f4(t),a=Xs(t),i=Xs(t),o=Xs(t);t.l=r;var l={rfx:n,relId:s,loc:a,display:o};return i&&(l.Tooltip=i),l}function kfe(t,e){var r=Qe(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Rh({s:mn(t[0]),e:mn(t[0])},r),h4("rId"+e,r);var n=t[1].Target.indexOf("#"),s=n==-1?"":t[1].Target.slice(n+1);return ps(s||"",r),ps(t[1].Tooltip||"",r),ps("",r),r.slice(0,r.l)}function Cfe(){}function Tfe(t,e,r){var n=t.l+e,s=FI(t),a=t.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=Jue(t,n-t.l,r);i[1]=o}else t.l=n;return i}function Efe(t,e,r){var n=t.l+e,s=bd(t),a=[s];if(r.cellFormula){var i=que(t,n-t.l,r);a[1]=i,t.l=n}else t.l=n;return a}function Nfe(t,e,r){r==null&&(r=Qe(18));var n=Xv(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),r.write_shift(2,s),r}var MO=["left","right","top","bottom","header","footer"];function Afe(t){var e={};return MO.forEach(function(r){e[r]=zs(t)}),e}function jfe(t,e){return e==null&&(e=Qe(6*8)),Pu(t),MO.forEach(function(r){ed(t[r],e)}),e}function Ffe(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function Pfe(t,e,r){r==null&&(r=Qe(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Dfe(t){var e=Qe(24);return e.write_shift(4,4),e.write_shift(4,1),Rh(t,e),e}function Rfe(t,e){return e==null&&(e=Qe(16*4+2)),e.write_shift(2,t.password?w4(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Mfe(){}function Ife(){}function Ofe(t,e,r,n,s,a,i){if(!t)return t;var o=e||{};n||(n={"!id":{}});var l=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},g=!1,h=!1,p,x,v,w,S,_,y,k,N,E=[];o.biff=12,o["!row"]=0;var A=0,C=!1,F=[],P={},M=o.supbooks||s.supbooks||[[]];if(M.sharedf=P,M.arrayf=F,M.SheetNames=s.SheetNames||s.Sheets.map(function(O){return O.name}),!o.supbooks&&(o.supbooks=M,s.Names))for(var I=0;I<s.Names.length;++I)M[0][I+1]=s.Names[I];var Y=[],se=[],L=!1;Jg[16]={n:"BrtShortReal",f:RO};var z;if(Fl(t,function(R,X,te){if(!h)switch(te){case 148:u=R;break;case 0:p=R,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),k=On(w=p.r),o["!row"]=p.r,(R.hidden||R.hpt||R.level!=null)&&(R.hpt&&(R.hpx=sh(R.hpt)),se[R.r]=R);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:R[2]},R[2]){case"n":x.v=R[1];break;case"s":y=q0[R[1]],x.v=y.t,x.r=y.r;break;case"b":x.v=!!R[1];break;case"e":x.v=R[1],o.cellText!==!1&&(x.w=Pl[x.v]);break;case"str":x.t="s",x.v=R[1];break;case"is":x.t="s",x.v=R[1].t;break}if((v=i.CellXf[R[0].iStyleRef])&&FO(x,v.numFmtId,null,o,a,i),S=R[0].c==-1?S+1:R[0].c,o.dense?(l[w]||(l[w]=[]),l[w][S]=x):l[gn(S)+k]=x,o.cellFormula){for(C=!1,A=0;A<F.length;++A){var H=F[A];p.r>=H[0].s.r&&p.r<=H[0].e.r&&S>=H[0].s.c&&S<=H[0].e.c&&(x.F=or(H[0]),C=!0)}!C&&R.length>3&&(x.f=R[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>S&&(d.s.c=S),d.e.r<p.r&&(d.e.r=p.r),d.e.c<S&&(d.e.c=S),o.cellDates&&v&&x.t=="n"&&Fh(Kt[v.numFmtId])){var V=vu(x.v);V&&(x.t="d",x.v=new Date(V.y,V.m-1,V.d,V.H,V.M,V.S,V.u))}z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 1:case 12:if(!o.sheetStubs||g)break;x={t:"z",v:void 0},S=R[0].c==-1?S+1:R[0].c,o.dense?(l[w]||(l[w]=[]),l[w][S]=x):l[gn(S)+k]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>S&&(d.s.c=S),d.e.r<p.r&&(d.e.r=p.r),d.e.c<S&&(d.e.c=S),z&&(z.type=="XLDAPR"&&(x.D=!0),z=void 0);break;case 176:E.push(R);break;case 49:z=((o.xlmeta||{}).Cell||[])[R-1];break;case 494:var q=n["!id"][R.relId];for(q?(R.Target=q.Target,R.loc&&(R.Target+="#"+R.loc),R.Rel=q):R.relId==""&&(R.Target="#"+R.loc),w=R.rfx.s.r;w<=R.rfx.e.r;++w)for(S=R.rfx.s.c;S<=R.rfx.e.c;++S)o.dense?(l[w]||(l[w]=[]),l[w][S]||(l[w][S]={t:"z",v:void 0}),l[w][S].l=R):(_=Yt({c:S,r:w}),l[_]||(l[_]={t:"z",v:void 0}),l[_].l=R);break;case 426:if(!o.cellFormula)break;F.push(R),N=o.dense?l[w][S]:l[gn(S)+k],N.f=$s(R[1],d,{r:p.r,c:S},M,o),N.F=or(R[0]);break;case 427:if(!o.cellFormula)break;P[Yt(R[0].s)]=R[1],N=o.dense?l[w][S]:l[gn(S)+k],N.f=$s(R[1],d,{r:p.r,c:S},M,o);break;case 60:if(!o.cellStyles)break;for(;R.e>=R.s;)Y[R.e--]={width:R.w/256,hidden:!!(R.flags&1),level:R.level},L||(L=!0,_4(R.w/256)),Tc(Y[R.e+1]);break;case 161:l["!autofilter"]={ref:or(R)};break;case 476:l["!margins"]=R;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),R.name&&(s.Sheets[r].CodeName=R.name),(R.above||R.left)&&(l["!outline"]={above:R.above,left:R.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),R.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:g=!0;break;case 38:g=!1;break;default:if(!X.T){if(!g||o.WTF)throw new Error("Unexpected record 0x"+te.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=or(u||d)),o.sheetRows&&l["!ref"]){var G=kr(l["!ref"]);o.sheetRows<=+G.e.r&&(G.e.r=o.sheetRows-1,G.e.r>d.e.r&&(G.e.r=d.e.r),G.e.r<G.s.r&&(G.s.r=G.e.r),G.e.c>d.e.c&&(G.e.c=d.e.c),G.e.c<G.s.c&&(G.s.c=G.e.c),l["!fullref"]=l["!ref"],l["!ref"]=or(G))}return E.length>0&&(l["!merges"]=E),Y.length>0&&(l["!cols"]=Y),se.length>0&&(l["!rows"]=se),l}function Lfe(t,e,r,n,s,a,i){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=tn(e),e.z=e.z||Kt[14],e.v=ns(en(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var l={r,c:n};switch(l.s=Kc(s.cellXfs,e,s),e.l&&a["!links"].push([Yt(l),e.l]),e.c&&a["!comments"].push([Yt(l),e.c]),e.t){case"s":case"str":return s.bookSST?(o=T4(s.Strings,e.v,s.revStrings),l.t="s",l.v=o,i?lt(t,18,nfe(e,l)):lt(t,7,tfe(e,l))):(l.t="str",i?lt(t,17,mfe(e,l)):lt(t,6,hfe(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?i?lt(t,13,ufe(e,l)):lt(t,2,lfe(e,l)):i?lt(t,16,ife(e,l)):lt(t,5,afe(e,l)),!0;case"b":return l.t="b",i?lt(t,15,Yde(e,l)):lt(t,4,Kde(e,l)),!0;case"e":return l.t="e",i?lt(t,14,Zde(e,l)):lt(t,3,Qde(e,l)),!0}return i?lt(t,12,Gde(e,l)):lt(t,1,Hde(e,l)),!0}function Bfe(t,e,r,n){var s=kr(e["!ref"]||"A1"),a,i="",o=[];lt(t,145);var l=Array.isArray(e),u=s.e.r;e["!rows"]&&(u=Math.max(s.e.r,e["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=On(d),Ide(t,e,s,d);var g=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=gn(h)),a=o[h]+i;var p=l?(e[d]||[])[h]:e[a];if(!p){g=!1;continue}g=Lfe(t,p,d,h,n,e,g)}}lt(t,146)}function Ufe(t,e){!e||!e["!merges"]||(lt(t,177,bfe(e["!merges"].length)),e["!merges"].forEach(function(r){lt(t,176,_fe(r))}),lt(t,178))}function $fe(t,e){!e||!e["!cols"]||(lt(t,390),e["!cols"].forEach(function(r,n){r&&lt(t,60,Nfe(n,r))}),lt(t,391))}function Wfe(t,e){!e||!e["!ref"]||(lt(t,648),lt(t,649,Dfe(kr(e["!ref"]))),lt(t,650))}function Hfe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var s=Ir(r,-1,n[1].Target.replace(/#.*$/,""),gr.HLINK);lt(t,494,kfe(n,s))}}),delete e["!links"]}function zfe(t,e,r,n){if(e["!comments"].length>0){var s=Ir(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",gr.VML);lt(t,551,h4("rId"+s)),e["!legacy"]=s}}function Gfe(t,e,r,n){if(e["!autofilter"]){var s=e["!autofilter"],a=typeof s.ref=="string"?s.ref:or(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Pa(a);o.s.r==o.e.r&&(o.e.r=Pa(e["!ref"]).e.r,a=or(o));for(var l=0;l<i.length;++l){var u=i[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),lt(t,161,Rh(kr(a))),lt(t,162)}}function Vfe(t,e,r){lt(t,133),lt(t,137,Pfe(e,r)),lt(t,138),lt(t,134)}function Kfe(t,e){e["!protect"]&&lt(t,535,Rfe(e["!protect"]))}function Xfe(t,e,r,n){var s=Fa(),a=r.SheetNames[t],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var l=kr(i["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],lt(s,129),(r.vbaraw||i["!outline"])&&lt(s,147,$de(o,i["!outline"])),lt(s,148,Lde(l)),Vfe(s,i,r.Workbook),$fe(s,i),Bfe(s,i,t,e),Kfe(s,i),Gfe(s,i,r,t),Ufe(s,i),Hfe(s,i,n),i["!margins"]&&lt(s,476,jfe(i["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&Wfe(s,i),zfe(s,i,t,n),lt(s,130),s.end()}function Yfe(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(e[+i[1]]=r?+i[2]:i[2])});var s=Sr((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[e,s,n]}function Jfe(t,e,r,n,s,a){var i=a||{"!type":"chart"};if(!t)return a;var o=0,l=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(g){var h=Yfe(g);d.s.r=d.s.c=0,d.e.c=o,u=gn(o),h[0].forEach(function(p,x){i[u+On(x)]={t:"n",v:p,z:h[1]},l=x}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=or(d)),i}function Qfe(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=t.match(PO);return o&&E4(o[0],a,s,r),(i=t.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function qfe(t,e){t.l+=10;var r=Xs(t);return{name:r}}function Zfe(t,e,r,n,s){if(!t)return t;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Fl(t,function(l,u,d){switch(d){case 550:a["!rel"]=l;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),l.name&&(s.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},e),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var N4=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ehe=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],the=[],rhe=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yj(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],s=0;s!=e.length;++s){var a=e[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Yr(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function vj(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Yr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function IO(t){vj(t.WBProps,N4),vj(t.CalcPr,rhe),yj(t.WBView,ehe),yj(t.Sheets,the),If.date1904=Yr(t.WBProps.date1904)}function nhe(t){return!t.Workbook||!t.Workbook.WBProps?"false":Yr(t.Workbook.WBProps.date1904)?"true":"false"}var she="][*?/\\".split("");function OO(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return she.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function ahe(t,e,r){t.forEach(function(n,s){OO(n);for(var a=0;a<s;++a)if(n==t[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=e&&e[s]&&e[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function ihe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];ahe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)nde(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var ohe=/<\w+:workbook/;function lhe(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(t.replace(ea,function(l,u){var d=qt(l);switch(Lo(d[0])){case"<?xml":break;case"<workbook":l.match(ohe)&&(s="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":N4.forEach(function(g){if(d[g[0]]!=null)switch(g[2]){case"bool":r.WBProps[g[0]]=Yr(d[g[0]]);break;case"int":r.WBProps[g[0]]=parseInt(d[g[0]],10);break;default:r.WBProps[g[0]]=d[g[0]]}}),d.codeName&&(r.WBProps.CodeName=$r(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Sr($r(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=$r(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Yr(d.hidden||"0")&&(a.Hidden=!0),i=u+l.length;break;case"</definedName>":a.Ref=Sr($r(t.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return l}),yd.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return IO(r),r}function LO(t){var e=[Bn];e[e.length]=St("workbook",null,{xmlns:yd[0],"xmlns:r":es.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(N4.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=St("workbookPr",null,n);var s=t.Workbook&&t.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",a=0;a!=t.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==t.SheetNames.length&&(a=0),e[e.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",a=0;a!=t.SheetNames.length;++a){var i={name:Or(t.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}e[e.length]=St("sheet",null,i)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(e[e.length]=St("definedName",Or(o.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function che(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=VS(t),r.name=Xs(t),r}function uhe(t,e){return e||(e=Qe(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),h4(t.strRelID,e),ps(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function dhe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var s=e>8?Xs(t):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function fhe(t,e){e||(e=Qe(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),AI(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function hhe(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function ghe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var s=t.read_shift(4),a=zse(t),i=Que(t,0,r),o=f4(t);t.l=n;var l={Name:a,Ptg:i};return s<268435455&&(l.Sheet=s),o&&(l.Comment=o),l}function mhe(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;e||(e={}),e.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Jg[16]={n:"BrtFRTArchID$",f:hhe},Fl(t,function(l,u,d){switch(d){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(e.SID=l.Sheet),l.Ref=$s(l.Ptg,null,null,i,e),delete e.SID,delete l.Ptg,a.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,l]):i[0]=[d,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},e),IO(r),r.Names=a,r.supbooks=i,r}function phe(t,e){lt(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};lt(t,156,uhe(s))}lt(t,144)}function xhe(t,e){e||(e=Qe(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return ps("SheetJS",e),ps(Y1.version,e),ps(Y1.version,e),ps("7262",e),e.length>e.l?e.slice(0,e.l):e}function yhe(t,e){e||(e=Qe(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function vhe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(lt(t,135),lt(t,158,yhe(s)),lt(t,136))}}function whe(t,e){var r=Fa();return lt(r,131),lt(r,128,xhe()),lt(r,153,fhe(t.Workbook&&t.Workbook.WBProps||null)),vhe(r,t),phe(r,t),lt(r,132),r.end()}function _he(t,e,r){return e.slice(-4)===".bin"?mhe(t,r):lhe(t,r)}function bhe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Ofe(t,n,r,s,a,i,o):gde(t,n,r,s,a,i,o)}function She(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Zfe(t,n,r,s,a):Qfe(t,n,r,s,a)}function khe(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?Tce():Ece()}function Che(t,e,r,n,s,a,i,o){return e.slice(-4)===".bin"?kce():Cce()}function The(t,e,r,n){return e.slice(-4)===".bin"?_le(t,r,n):cle(t,r,n)}function Ehe(t,e,r){return yO(t,r)}function Nhe(t,e,r){return e.slice(-4)===".bin"?Noe(t,r):Coe(t,r)}function Ahe(t,e,r){return e.slice(-4)===".bin"?vce(t,r):uce(t,r)}function jhe(t,e,r){return e.slice(-4)===".bin"?oce(t):ace(t)}function Fhe(t,e,r,n){return r.slice(-4)===".bin"?lce(t,e,r,n):void 0}function Phe(t,e,r){return e.slice(-4)===".bin"?rce(t,e,r):sce(t,e,r)}function Dhe(t,e,r){return(e.slice(-4)===".bin"?whe:LO)(t)}function Rhe(t,e,r,n,s){return(e.slice(-4)===".bin"?Xfe:DO)(t,r,n,s)}function Mhe(t,e,r){return(e.slice(-4)===".bin"?Fle:pO)(t,r)}function Ihe(t,e,r){return(e.slice(-4)===".bin"?Foe:lO)(t,r)}function Ohe(t,e,r){return(e.slice(-4)===".bin"?wce:_O)(t)}function Lhe(t){return(t.slice(-4)===".bin"?nce:vO)()}var BO=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,UO=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ii(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=t.match(BO),a,i,o,l;if(s)for(l=0;l!=s.length;++l)a=s[l].match(UO),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Bhe(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(BO),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(UO),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var eg;function Uhe(t,e){var r=eg[t]||Sr(t);return r==="General"?qu(e):Ei(r,e)}function $he(t,e,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Yr(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=en(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Sr(e)]=s}function Whe(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Pl[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$g(t.v):t.w=qu(t.v):t.w=Uhe(e||"General",t.v)}catch(a){if(r.WTF)throw a}try{var n=eg[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Fh(n)){var s=vu(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Hhe(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=tle[n.Pattern]||n.Pattern)}t[e.ID]=e}function zhe(t,e,r,n,s,a,i,o,l,u){var d="General",g=n.StyleID,h={};u=u||{};var p=[],x=0;for(g===void 0&&o&&(g=o.StyleID),g===void 0&&i&&(g=i.StyleID);a[g]!==void 0&&(a[g].nf&&(d=a[g].nf),a[g].Interior&&p.push(a[g].Interior),!!a[g].Parent);)g=a[g].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Yr(t);break;case"String":n.t="s",n.r=I8(Sr(t)),n.v=t.indexOf("<")>-1?Sr(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(en(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Sr(t):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RI[t],u.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=I8(e||t));break}if(Whe(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=Sr(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=Mf(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Mf("RC:RC",s):n.ArrayRange&&(n.F=Mf(n.ArrayRange,s),l.push([kr(n.F),n.F]))}else for(x=0;x<l.length;++x)s.r>=l[x][0].s.r&&s.r<=l[x][0].e.r&&s.c>=l[x][0].s.c&&s.c<=l[x][0].e.c&&(n.F=l[x][1]);u.cellStyles&&(p.forEach(function(w){!h.patternType&&w.patternType&&(h.patternType=w.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Ghe(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function F2(t,e){var r=e||{};Ph();var n=C0(i4(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=$r(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=tn(r);return i.type="string",nh.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ft){s.indexOf("<"+Ft)>=0&&(a=!0)}),a)return j0e(n,r);eg={"General Number":"General","General Date":Kt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Kt[15],"Short Date":Kt[14],"Long Time":Kt[19],"Medium Time":Kt[18],"Short Time":Kt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Kt[2],Standard:Kt[4],Percent:Kt[10],Scientific:Kt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,d={},g=[],h=r.dense?[]:{},p="",x={},v={},w=Ii('<Data ss:Type="String">'),S=0,_=0,y=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},E={},A="",C=0,F=[],P={},M={},I=0,Y=[],se=[],L={},z=[],G,O=!1,R=[],X=[],te={},H=0,V=0,q={Sheets:[],WBProps:{date1904:!1}},Q={};zg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ae="";o=zg.exec(n);)switch(o[3]=(ae=o[3]).toLowerCase()){case"data":if(ae=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?zhe(n.slice(S,o.index),A,w,l[l.length-1][0]=="comment"?L:x,{c:_,r:y},N,z[_],v,R,r):(A="",w=Ii(o[0]),S=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(se.length>0&&(x.c=se),(!r.sheetRows||r.sheetRows>y)&&x.v!==void 0&&(r.dense?(h[y]||(h[y]=[]),h[y][_]=x):h[gn(_)+On(y)]=x),x.HRef&&(x.l={Target:Sr(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(H=_+(parseInt(x.MergeAcross,10)|0),V=y+(parseInt(x.MergeDown,10)|0),F.push({s:{c:_,r:y},e:{c:H,r:V}})),!r.sheetStubs)x.MergeAcross?_=H+1:++_;else if(x.MergeAcross||x.MergeDown){for(var J=_;J<=H;++J)for(var re=y;re<=V;++re)(J>_||re>y)&&(r.dense?(h[re]||(h[re]=[]),h[re][J]={t:"z"}):h[gn(J)+On(re)]={t:"z"});_=H+1}else++_;else x=Bhe(o[0]),x.Index&&(_=+x.Index-1),_<k.s.c&&(k.s.c=_),_>k.e.c&&(k.e.c=_),o[0].slice(-2)==="/>"&&++_,se=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<k.s.r&&(k.s.r=y),y>k.e.r&&(k.e.r=y),o[0].slice(-2)==="/>"&&(v=Ii(o[0]),v.Index&&(y=+v.Index-1)),_=0,++y):(v=Ii(o[0]),v.Index&&(y=+v.Index-1),te={},(v.AutoFitHeight=="0"||v.Height)&&(te.hpx=parseInt(v.Height,10),te.hpt=Yg(te.hpx),X[y]=te),v.Hidden=="1"&&(te.hidden=!0,X[y]=te));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));g.push(p),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(h["!ref"]=or(k),r.sheetRows&&r.sheetRows<=k.e.r&&(h["!fullref"]=h["!ref"],k.e.r=r.sheetRows-1,h["!ref"]=or(k))),F.length&&(h["!merges"]=F),z.length>0&&(h["!cols"]=z),X.length>0&&(h["!rows"]=X),d[p]=h}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=_=0,l.push([o[3],!1]),u=Ii(o[0]),p=Sr(u.Name),h=r.dense?[]:{},F=[],R=[],X=[],Q={name:p,Hidden:0},q.Sheets.push(Q);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),z=[],O=!1}break;case"style":o[1]==="/"?Hhe(N,E,r):E=Ii(o[0]);break;case"numberformat":E.nf=Sr(Ii(o[0]).Format||"General"),eg[E.nf]&&(E.nf=eg[E.nf]);for(var ve=0;ve!=392&&Kt[ve]!=E.nf;++ve);if(ve==392){for(ve=57;ve!=392;++ve)if(Kt[ve]==null){fl(E.nf,ve);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(G=Ii(o[0]),G.Hidden&&(G.hidden=!0,delete G.Hidden),G.Width&&(G.wpx=parseInt(G.Width,10)),!O&&G.wpx>10){O=!0,Hs=gO;for(var we=0;we<z.length;++we)z[we]&&Tc(z[we])}O&&Tc(G),z[G.Index-1||z.length]=G;for(var Fe=0;Fe<+G.Span;++Fe)z[z.length]=tn(G);break;case"namedrange":if(o[1]==="/")break;q.Names||(q.Names=[]);var ne=qt(o[0]),Ee={Name:ne.Name,Ref:Mf(ne.RefersTo.slice(1),{r:0,c:0})};q.Sheets.length>0&&(Ee.Sheet=q.Sheets.length-1),q.Names.push(Ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?A+=n.slice(C,o.index):C=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=Ii(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?mae(P,ae,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Ghe(L),se.push(L)}else l.push([o[3],!1]),u=Ii(o[0]),L={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=Ii(o[0]);h["!autofilter"]={ref:Mf(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return kj(n,r);var He=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:He=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:He=!1}break;case"excelworkbook":switch(o[3]){case"date1904":q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:He=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:He=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else I=o.index+o[0].length;break;case"header":h["!margins"]||Pu(h["!margins"]={},"xlml"),isNaN(+qt(o[0]).Margin)||(h["!margins"].header=+qt(o[0]).Margin);break;case"footer":h["!margins"]||Pu(h["!margins"]={},"xlml"),isNaN(+qt(o[0]).Margin)||(h["!margins"].footer=+qt(o[0]).Margin);break;case"pagemargins":var at=qt(o[0]);h["!margins"]||Pu(h["!margins"]={},"xlml"),isNaN(+at.Top)||(h["!margins"].top=+at.Top),isNaN(+at.Left)||(h["!margins"].left=+at.Left),isNaN(+at.Right)||(h["!margins"].right=+at.Right),isNaN(+at.Bottom)||(h["!margins"].bottom=+at.Bottom);break;case"displayrighttoleft":q.Views||(q.Views=[]),q.Views[0]||(q.Views[0]={}),q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:He=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:He=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:He=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:He=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:He=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:He=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:He=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:He=!1}break;case"smarttags":break;default:He=!1;break}if(He||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?$he(M,ae,Y,n.slice(I,o.index)):(Y=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Me={};return!r.bookSheets&&!r.bookProps&&(Me.Sheets=d),Me.SheetNames=g,Me.Workbook=q,Me.SSF=tn(Kt),Me.Props=P,Me.Custprops=M,Me}function ZS(t,e){switch(j4(e=e||{}),e.type||"base64"){case"base64":return F2(Ga(t),e);case"binary":case"buffer":case"file":return F2(t,e);case"array":return F2(Gc(t),e)}}function Vhe(t,e){var r=[];return t.Props&&r.push(pae(t.Props,e)),t.Custprops&&r.push(xae(t.Props,t.Custprops)),r.join("")}function Khe(){return""}function Xhe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,s){var a=[];a.push(St("NumberFormat",null,{"ss:Format":Or(Kt[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(St("Style",a.join(""),i))}),St("Styles",r.join(""))}function $O(t){return St("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+k4(t.Ref,{r:0,c:0})})}function Yhe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var s=e[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push($O(s)))}return St("Names",r.join(""))}function Jhe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push($O(o)))}return a.join("")}function Qhe(t,e,r,n){if(!t)return"";var s=[];if(t["!margins"]&&(s.push("<PageSetup>"),t["!margins"].header&&s.push(St("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&s.push(St("Footer",null,{"x:Margin":t["!margins"].footer})),s.push(St("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(St("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),t["!protect"]&&(s.push(Es("ProtectContents","True")),t["!protect"].objects&&s.push(Es("ProtectObjects","True")),t["!protect"].scenarios&&s.push(Es("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?s.push(Es("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&s.push(Es("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){t["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":St("WorksheetOptions",s.join(""),{xmlns:Oa.x})}function qhe(t){return t.map(function(e){var r=vse(e.t||""),n=St("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return St("Comment",n,{"ss:Author":e.a})}).join("")}function Zhe(t,e,r,n,s,a,i){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Or(k4(t.f,i))),t.F&&t.F.slice(0,e.length)==e){var l=mn(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==i.r?"":"["+(l.r-i.r)+"]")+"C"+(l.c==i.c?"":"["+(l.c-i.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Or(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Or(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var g="",h="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":g="Number",h=String(t.v);break;case"b":g="Boolean",h=t.v?"1":"0";break;case"e":g="Error",h=Pl[t.v];break;case"d":g="DateTime",h=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Kt[14]);break;case"s":g="String",h=yse(t.v||"");break}var p=Kc(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=t.v!=null?h:"",v=t.t=="z"?"":'<Data ss:Type="'+g+'">'+x+"</Data>";return(t.c||[]).length>0&&(v+=qhe(t.c)),St("Cell",v,o)}function e0e(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=sh(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function t0e(t,e,r,n){if(!t["!ref"])return"";var s=kr(t["!ref"]),a=t["!merges"]||[],i=0,o=[];t["!cols"]&&t["!cols"].forEach(function(w,S){Tc(w);var _=!!w.width,y=Xv(S,w),k={"ss:Index":S+1};_&&(k["ss:Width"]=Kg(y.width)),w.hidden&&(k["ss:Hidden"]="1"),o.push(St("Column",null,k))});for(var l=Array.isArray(t),u=s.s.r;u<=s.e.r;++u){for(var d=[e0e(u,(t["!rows"]||[])[u])],g=s.s.c;g<=s.e.c;++g){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>g)&&!(a[i].s.r>u)&&!(a[i].e.c<g)&&!(a[i].e.r<u)){(a[i].s.c!=g||a[i].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:g},x=Yt(p),v=l?(t[u]||[])[g]:t[x];d.push(Zhe(v,x,t,e,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function r0e(t,e,r){var n=[],s=r.SheetNames[t],a=r.Sheets[s],i=a?Jhe(a,e,t,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?t0e(a,e,t,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Qhe(a,e,t,r)),n.join("")}function n0e(t,e){e||(e={}),t.SSF||(t.SSF=tn(Kt)),t.SSF&&(Ph(),$v(t.SSF),e.revssf=Hv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Kc(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Vhe(t,e)),r.push(Khe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(St("Worksheet",r0e(n,e,t),{"ss:Name":Or(t.SheetNames[n])}));return r[2]=Xhe(t,e),r[3]=Yhe(t),Bn+St("Workbook",r.join(""),{xmlns:Oa.ss,"xmlns:o":Oa.o,"xmlns:x":Oa.x,"xmlns:ss":Oa.ss,"xmlns:dt":Oa.dt,"xmlns:html":Oa.html})}function s0e(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Yse(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=Jse(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var a0e=[60,1084,2066,2165,2175];function i0e(t,e,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var l=ol(r,r.l),u=ek[l],d=0;u!=null&&a0e.indexOf(l)>-1;)a=ol(r,r.l+2),d=r.l+4,l==2066?d+=4:(l==2165||l==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=ek[l=ol(r,r.l)];var g=gs(i);ks(g,0);var h=0;g.lens=[];for(var p=0;p<i.length;++p)g.lens.push(h),h+=i[p].length;if(g.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+g.length+" < "+n;return e.f(g,g.length,s)}function mo(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Kt[n])}catch(a){if(e.WTF)throw a}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Pl[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$g(t.v):t.w=qu(t.v):t.w=Ei(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(a){if(e.WTF)throw a}if(e.cellDates&&n&&t.t=="n"&&Fh(Kt[n]||String(n))){var s=vu(t.v);s&&(t.t="d",t.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function wx(t,e,r){return{v:t,ixfe:e,t:r}}function o0e(t,e){var r={opts:{}},n={},s=e.dense?[]:{},a={},i={},o=null,l=[],u="",d={},g,h="",p,x,v,w,S={},_=[],y,k,N=[],E=[],A={Sheets:[],WBProps:{date1904:!1},Views:[{}]},C={},F=function(et){return et<8?Au[et]:et<64&&E[et-8]||Au[et]},P=function(et,nt,gt){var Et=nt.XF.data;if(!(!Et||!Et.patternType||!gt||!gt.cellStyles)){nt.s={},nt.s.patternType=Et.patternType;var Ne;(Ne=Vg(F(Et.icvFore)))&&(nt.s.fgColor={rgb:Ne}),(Ne=Vg(F(Et.icvBack)))&&(nt.s.bgColor={rgb:Ne})}},M=function(et,nt,gt){if(!(te>1)&&!(gt.sheetRows&&et.r>=gt.sheetRows)){if(gt.cellStyles&&nt.XF&&nt.XF.data&&P(et,nt,gt),delete nt.ixfe,delete nt.XF,g=et,h=Yt(et),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),et.r<i.s.r&&(i.s.r=et.r),et.c<i.s.c&&(i.s.c=et.c),et.r+1>i.e.r&&(i.e.r=et.r+1),et.c+1>i.e.c&&(i.e.c=et.c+1),gt.cellFormula&&nt.f){for(var Et=0;Et<_.length;++Et)if(!(_[Et][0].s.c>et.c||_[Et][0].s.r>et.r)&&!(_[Et][0].e.c<et.c||_[Et][0].e.r<et.r)){nt.F=or(_[Et][0]),(_[Et][0].s.c!=et.c||_[Et][0].s.r!=et.r)&&delete nt.f,nt.f&&(nt.f=""+$s(_[Et][1],i,et,R,I));break}}gt.dense?(s[et.r]||(s[et.r]=[]),s[et.r][et.c]=nt):s[h]=nt}},I={enc:!1,sbcch:0,snames:[],sharedf:S,arrayf:_,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(I.password=e.password);var Y,se=[],L=[],z=[],G=[],O=!1,R=[];R.SheetNames=I.snames,R.sharedf=I.sharedf,R.arrayf=I.arrayf,R.names=[],R.XTI=[];var X=0,te=0,H=0,V=[],q=[],Q;I.codepage=1200,Gi(1200);for(var ae=!1;t.l<t.length-1;){var J=t.l,re=t.read_shift(2);if(re===0&&X===10)break;var ve=t.l===t.length?0:t.read_shift(2),we=ek[re];if(we&&we.f){if(e.bookSheets&&X===133&&re!==133)break;if(X=re,we.r===2||we.r==12){var Fe=t.read_shift(2);if(ve-=2,!I.enc&&Fe!==re&&((Fe&255)<<8|Fe>>8)!==re)throw new Error("rt mismatch: "+Fe+"!="+re);we.r==12&&(t.l+=10,ve-=10)}var ne={};if(re===10?ne=we.f(t,ve,I):ne=i0e(re,we,t,ve,I),te==0&&[9,521,1033,2057].indexOf(X)===-1)continue;switch(re){case 34:r.opts.Date1904=A.WBProps.date1904=ne;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(t.l=0),I.enc=ne,!e.password)throw new Error("File is password-protected");if(ne.valid==null)throw new Error("Encryption scheme unsupported");if(!ne.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=ne;break;case 66:var Ee=Number(ne);switch(Ee){case 21010:Ee=1200;break;case 32768:Ee=1e4;break;case 32769:Ee=1252;break}Gi(I.codepage=Ee),ae=!0;break;case 317:I.rrtabid=ne;break;case 25:I.winlocked=ne;break;case 439:r.opts.RefreshAll=ne;break;case 12:r.opts.CalcCount=ne;break;case 16:r.opts.CalcDelta=ne;break;case 17:r.opts.CalcIter=ne;break;case 13:r.opts.CalcMode=ne;break;case 14:r.opts.CalcPrecision=ne;break;case 95:r.opts.CalcSaveRecalc=ne;break;case 15:I.CalcRefMode=ne;break;case 2211:r.opts.FullCalc=ne;break;case 129:ne.fDialog&&(s["!type"]="dialog"),ne.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ne.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:N.push(ne);break;case 430:R.push([ne]),R[R.length-1].XTI=[];break;case 35:case 547:R[R.length-1].push(ne);break;case 24:case 536:Q={Name:ne.Name,Ref:$s(ne.rgce,i,null,R,I)},ne.itab>0&&(Q.Sheet=ne.itab-1),R.names.push(Q),R[0]||(R[0]=[],R[0].XTI=[]),R[R.length-1].push(ne),ne.Name=="_xlnm._FilterDatabase"&&ne.itab>0&&ne.rgce&&ne.rgce[0]&&ne.rgce[0][0]&&ne.rgce[0][0][0]=="PtgArea3d"&&(q[ne.itab-1]={ref:or(ne.rgce[0][0][1][2])});break;case 22:I.ExternCount=ne;break;case 23:R.length==0&&(R[0]=[],R[0].XTI=[]),R[R.length-1].XTI=R[R.length-1].XTI.concat(ne),R.XTI=R.XTI.concat(ne);break;case 2196:if(I.biff<8)break;Q!=null&&(Q.Comment=ne[1]);break;case 18:s["!protect"]=ne;break;case 19:ne!==0&&I.WTF&&console.error("Password verifier: "+ne);break;case 133:a[ne.pos]=ne,I.snames.push(ne.name);break;case 10:{if(--te)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=or(i),e.sheetRows&&e.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=e.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=or(i),i.e.r=ke}i.e.r++,i.e.c++}se.length>0&&(s["!merges"]=se),L.length>0&&(s["!objects"]=L),z.length>0&&(s["!cols"]=z),G.length>0&&(s["!rows"]=G),A.Sheets.push(C)}u===""?d=s:n[u]=s,s=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[re]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ne.BIFFVer]||8),I.biffguess=ne.BIFFVer==0,ne.BIFFVer==0&&ne.dt==4096&&(I.biff=5,ae=!0,Gi(I.codepage=28591)),I.biff==8&&ne.BIFFVer==0&&ne.dt==16&&(I.biff=2),te++)break;if(s=e.dense?[]:{},I.biff<8&&!ae&&(ae=!0,Gi(I.codepage=e.codepage||1252)),I.biff<5||ne.BIFFVer==0&&ne.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var He={pos:t.l-ve,name:u};a[He.pos]=He,I.snames.push(u)}else u=(a[J]||{name:""}).name;ne.dt==32&&(s["!type"]="chart"),ne.dt==64&&(s["!type"]="macro"),se=[],L=[],I.arrayf=_=[],z=[],G=[],O=!1,C={Hidden:(a[J]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(e.dense?(s[ne.r]||[])[ne.c]:s[Yt({c:ne.c,r:ne.r})])&&++ne.c,y={ixfe:ne.ixfe,XF:N[ne.ixfe]||{},v:ne.val,t:"n"},H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:ne.c,r:ne.r},y,e);break;case 5:case 517:y={ixfe:ne.ixfe,XF:N[ne.ixfe],v:ne.val,t:ne.t},H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:ne.c,r:ne.r},y,e);break;case 638:y={ixfe:ne.ixfe,XF:N[ne.ixfe],v:ne.rknum,t:"n"},H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:ne.c,r:ne.r},y,e);break;case 189:for(var at=ne.c;at<=ne.C;++at){var Me=ne.rkrec[at-ne.c][0];y={ixfe:Me,XF:N[Me],v:ne.rkrec[at-ne.c][1],t:"n"},H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:at,r:ne.r},y,e)}break;case 6:case 518:case 1030:{if(ne.val=="String"){o=ne;break}if(y=wx(ne.val,ne.cell.ixfe,ne.tt),y.XF=N[y.ixfe],e.cellFormula){var Ft=ne.formula;if(Ft&&Ft[0]&&Ft[0][0]&&Ft[0][0][0]=="PtgExp"){var Ut=Ft[0][0][1][0],Pe=Ft[0][0][1][1],Re=Yt({r:Ut,c:Pe});S[Re]?y.f=""+$s(ne.formula,i,ne.cell,R,I):y.F=((e.dense?(s[Ut]||[])[Pe]:s[Re])||{}).F}else y.f=""+$s(ne.formula,i,ne.cell,R,I)}H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M(ne.cell,y,e),o=ne}break;case 7:case 519:if(o)o.val=ne,y=wx(ne,o.cell.ixfe,"s"),y.XF=N[y.ixfe],e.cellFormula&&(y.f=""+$s(o.formula,i,o.cell,R,I)),H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M(o.cell,y,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{_.push(ne);var $e=Yt(ne[0].s);if(p=e.dense?(s[ne[0].s.r]||[])[ne[0].s.c]:s[$e],e.cellFormula&&p){if(!o||!$e||!p)break;p.f=""+$s(ne[1],i,ne[0],R,I),p.F=or(ne[0])}}break;case 1212:{if(!e.cellFormula)break;if(h){if(!o)break;S[Yt(o.cell)]=ne[0],p=e.dense?(s[o.cell.r]||[])[o.cell.c]:s[Yt(o.cell)],(p||{}).f=""+$s(ne[0],i,g,R,I)}}break;case 253:y=wx(l[ne.isst].t,ne.ixfe,"s"),l[ne.isst].h&&(y.h=l[ne.isst].h),y.XF=N[y.ixfe],H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:ne.c,r:ne.r},y,e);break;case 513:e.sheetStubs&&(y={ixfe:ne.ixfe,XF:N[ne.ixfe],t:"z"},H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:ne.c,r:ne.r},y,e));break;case 190:if(e.sheetStubs)for(var Be=ne.c;Be<=ne.C;++Be){var Ge=ne.ixfe[Be-ne.c];y={ixfe:Ge,XF:N[Ge],t:"z"},H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:Be,r:ne.r},y,e)}break;case 214:case 516:case 4:y=wx(ne.val,ne.ixfe,"s"),y.XF=N[y.ixfe],H>0&&(y.z=V[y.ixfe>>8&63]),mo(y,e,r.opts.Date1904),M({c:ne.c,r:ne.r},y,e);break;case 0:case 512:te===1&&(i=ne);break;case 252:l=ne;break;case 1054:if(I.biff==4){V[H++]=ne[1];for(var ht=0;ht<H+163&&Kt[ht]!=ne[1];++ht);ht>=163&&fl(ne[1],H+163)}else fl(ne[1],ne[0]);break;case 30:{V[H++]=ne;for(var Nt=0;Nt<H+163&&Kt[Nt]!=ne;++Nt);Nt>=163&&fl(ne,H+163)}break;case 229:se=se.concat(ne);break;case 93:L[ne.cmo[0]]=I.lastobj=ne;break;case 438:I.lastobj.TxO=ne;break;case 127:I.lastobj.ImData=ne;break;case 440:for(w=ne[0].s.r;w<=ne[0].e.r;++w)for(v=ne[0].s.c;v<=ne[0].e.c;++v)p=e.dense?(s[w]||[])[v]:s[Yt({c:v,r:w})],p&&(p.l=ne[1]);break;case 2048:for(w=ne[0].s.r;w<=ne[0].e.r;++w)for(v=ne[0].s.c;v<=ne[0].e.c;++v)p=e.dense?(s[w]||[])[v]:s[Yt({c:v,r:w})],p&&p.l&&(p.l.Tooltip=ne[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;p=e.dense?(s[ne[0].r]||[])[ne[0].c]:s[Yt(ne[0])];var Ye=L[ne[2]];p||(e.dense?(s[ne[0].r]||(s[ne[0].r]=[]),p=s[ne[0].r][ne[0].c]={t:"z"}):p=s[Yt(ne[0])]={t:"z"},i.e.r=Math.max(i.e.r,ne[0].r),i.s.r=Math.min(i.s.r,ne[0].r),i.e.c=Math.max(i.e.c,ne[0].c),i.s.c=Math.min(i.s.c,ne[0].c)),p.c||(p.c=[]),x={a:ne[1],t:Ye.TxO.t},p.c.push(x)}break;case 2173:Xle(N[ne.ixfe],ne.ext);break;case 125:{if(!I.cellStyles)break;for(;ne.e>=ne.s;)z[ne.e--]={width:ne.w/256,level:ne.level||0,hidden:!!(ne.flags&1)},O||(O=!0,_4(ne.w/256)),Tc(z[ne.e+1])}break;case 520:{var Ve={};ne.level!=null&&(G[ne.r]=Ve,Ve.level=ne.level),ne.hidden&&(G[ne.r]=Ve,Ve.hidden=!0),ne.hpt&&(G[ne.r]=Ve,Ve.hpt=ne.hpt,Ve.hpx=sh(ne.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Pu(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[re]]=ne;break;case 161:s["!margins"]||Pu(s["!margins"]={}),s["!margins"].header=ne.header,s["!margins"].footer=ne.footer;break;case 574:ne.RTL&&(A.Views[0].RTL=!0);break;case 146:E=ne;break;case 2198:Y=ne;break;case 140:k=ne;break;case 442:u?C.CodeName=ne||C.name:A.WBProps.CodeName=ne||"ThisWorkbook";break}}else we||console.error("Missing Info for XLS Record 0x"+re.toString(16)),t.l+=ve}return r.SheetNames=jn(a).sort(function(ot,et){return Number(ot)-Number(et)}).map(function(ot){return a[ot].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&q.forEach(function(ot,et){r.Sheets[r.SheetNames[et]]["!autofilter"]=ot}),r.Strings=l,r.SSF=tn(Kt),I.enc&&(r.Encryption=I.enc),Y&&(r.Themes=Y),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),R.names.length>0&&(A.Names=R.names),r.Workbook=A,r}var tg={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function l0e(t,e,r){var n=Wt.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ej(n,KS,tg.DSI);for(var a in s)e[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Wt.find(t,"/!SummaryInformation");if(i&&i.size>0)try{var o=ej(i,XS,tg.SI);for(var l in o)e[l]==null&&(e[l]=o[l])}catch(u){if(r.WTF)throw u}e.HeadingPairs&&e.TitlesOfParts&&(UI(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function c0e(t,e){var r=[],n=[],s=[],a=0,i,o=j8(KS,"n"),l=j8(XS,"n");if(t.Props)for(i=jn(t.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],t.Props[i[a]]]);if(t.Custprops)for(i=jn(t.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(t.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(l,i[a])?n:s).push([i[a],t.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)KI.indexOf(s[a][0])>-1||BI.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Wt.utils.cfb_add(e,"/SummaryInformation",tj(n,tg.SI,l,XS)),(r.length||u.length)&&Wt.utils.cfb_add(e,"/DocumentSummaryInformation",tj(r,tg.DSI,o,KS,u.length?u:null,tg.UDI))}function WO(t,e){e||(e={}),j4(e),QT(),e.codepage&&JT(e.codepage);var r,n;if(t.FullPaths){if(Wt.find(t,"/encryption"))throw new Error("File is password-protected");r=Wt.find(t,"!CompObj"),n=Wt.find(t,"/Workbook")||Wt.find(t,"/Book")}else{switch(e.type){case"base64":t=Ba(Ga(t));break;case"binary":t=Ba(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}ks(t,0),n={content:t}}var s,a;if(r&&s0e(r),e.bookProps&&!e.bookSheets)s={};else{var i=fr?"buffer":"array";if(n&&n.content)s=o0e(n.content,e);else if((a=Wt.find(t,"PerfectOffice_MAIN"))&&a.content)s=Fu.to_workbook(a.content,(e.type=i,e));else if((a=Wt.find(t,"NativeContent_MAIN"))&&a.content)s=Fu.to_workbook(a.content,(e.type=i,e));else throw(a=Wt.find(t,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Wt.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=bce(t))}var o={};return t.FullPaths&&l0e(t,o,e),s.Props=s.Custprops=o,e.bookFiles&&(s.cfb=t),s}function u0e(t,e){var r=e||{},n=Wt.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Wt.utils.cfb_add(n,s,HO(t,r)),r.biff==8&&(t.Props||t.Custprops)&&c0e(t,n),r.biff==8&&t.vbaraw&&Sce(n,Wt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Jg={0:{f:Rde},1:{f:Wde},2:{f:ofe},3:{f:Jde},4:{f:Vde},5:{f:sfe},6:{f:ffe},7:{f:efe},8:{f:vfe},9:{f:yfe},10:{f:pfe},11:{f:xfe},12:{f:zde},13:{f:cfe},14:{f:qde},15:{f:Xde},16:{f:RO},17:{f:gfe},18:{f:rfe},19:{f:d4},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ghe},40:{},42:{},43:{f:fle},44:{f:ule},45:{f:mle},46:{f:xle},47:{f:ple},48:{},49:{f:Ose},50:{},51:{f:Qle},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:sO},62:{f:dfe},63:{f:ice},64:{f:Mfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ffe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Ude},148:{f:Ode,p:16},151:{f:Cfe},152:{},153:{f:dhe},154:{},155:{},156:{f:che},157:{},158:{},159:{T:1,f:Eoe},160:{T:-1},161:{T:1,f:bd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wfe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Yle},336:{T:-1},337:{f:ece,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:VS},357:{},358:{},359:{},360:{T:1},361:{},362:{f:nO},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Tfe},427:{f:Efe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Afe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Bde},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Sfe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:VS},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:xce},633:{T:1},634:{T:-1},635:{T:1,f:mce},636:{T:-1},637:{f:$se},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:qfe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ife},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ek={6:{f:A2},10:{f:Hl},12:{f:Hn},13:{f:Hn},14:{f:Dn},15:{f:Dn},16:{f:zs},17:{f:Dn},18:{f:Dn},19:{f:Hn},20:{f:oj},21:{f:oj},23:{f:nO},24:{f:cj},25:{f:Dn},26:{},27:{},28:{f:Iie},29:{},34:{f:Dn},35:{f:lj},38:{f:zs},39:{f:zs},40:{f:zs},41:{f:zs},42:{f:Dn},43:{f:Dn},47:{f:Xoe},49:{f:cie},51:{f:Hn},60:{},61:{f:sie},64:{f:Dn},65:{f:lie},66:{f:Hn},77:{},80:{},81:{},82:{},85:{f:Hn},89:{},90:{},91:{},92:{f:Kae},93:{f:Bie},94:{},95:{f:Dn},96:{},97:{},99:{f:Dn},125:{f:sO},128:{f:kie},129:{f:Yae},130:{f:Hn},131:{f:Dn},132:{f:Dn},133:{f:Jae},134:{},140:{f:Kie},141:{f:Hn},144:{},146:{f:Jie},151:{},152:{},153:{},154:{},155:{},156:{f:Hn},157:{},158:{},160:{f:noe},161:{f:Zie},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:wie},190:{f:_ie},193:{f:Hl},197:{},198:{},199:{},200:{},201:{},202:{f:Dn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Hn},220:{},221:{f:Dn},222:{},224:{f:Sie},225:{f:Vae},226:{f:Hl},227:{},229:{f:Oie},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:qae},253:{f:die},255:{f:eie},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:XI},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Dn},353:{f:Hl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Aie},431:{f:Dn},432:{},433:{},434:{},437:{},438:{f:Wie},439:{f:Dn},440:{f:Hie},441:{},442:{f:Rm},443:{},444:{f:Hn},445:{},446:{},448:{f:Hl},449:{f:nie,r:2},450:{f:Hl},512:{f:sj},513:{f:roe},515:{f:Eie},516:{f:hie},517:{f:ij},519:{f:soe},520:{f:tie},523:{},545:{f:uj},549:{f:nj},566:{},574:{f:iie},638:{f:vie},659:{},1048:{},1054:{f:mie},1084:{},1212:{f:Die},2048:{f:Gie},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:xx},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Hl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Qie,r:12},2173:{f:Kle,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Dn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Pie,r:12},2197:{},2198:{f:$le,r:12},2199:{},2200:{},2201:{},2202:{f:Rie,r:12},2203:{f:Hl},2204:{},2205:{},2206:{},2207:{},2211:{f:rie},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Hn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:eoe},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Yie},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sj},1:{},2:{f:coe},3:{f:ooe},4:{f:ioe},5:{f:ij},7:{f:doe},8:{},9:{f:xx},11:{},22:{f:Hn},30:{f:xie},31:{},32:{},33:{f:uj},36:{},37:{f:nj},50:{f:foe},62:{},52:{},67:{},68:{f:Hn},69:{},86:{},126:{},127:{f:aoe},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hoe},223:{},234:{},354:{},421:{},518:{f:A2},521:{f:xx},536:{f:cj},547:{f:lj},561:{},579:{},1030:{f:A2},1033:{f:xx},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function kt(t,e,r,n){var s=e;if(!isNaN(s)){var a=n||(r||[]).length||0,i=t.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&l4(r)&&t.push(r)}}function d0e(t,e,r,n){var s=(r||[]).length||0;if(s<=8224)return kt(t,e,r,s);var a=e;if(!isNaN(a)){for(var i=r.parts||[],o=0,l=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=t.next(4);for(d.write_shift(2,a),d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<s;){for(d=t.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Lm(t,e,r){return t||(t=Qe(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function f0e(t,e,r,n){var s=Qe(9);return Lm(s,t,e),YI(r,n||"b",s),s}function h0e(t,e,r){var n=Qe(8+2*r.length);return Lm(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function g0e(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?ns(en(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?kt(t,2,uoe(r,n,s)):kt(t,3,loe(r,n,s));return;case"b":case"e":kt(t,5,f0e(r,n,e.v,e.t));return;case"s":case"str":kt(t,4,h0e(r,n,(e.v||"").slice(0,255)));return}kt(t,1,Lm(null,r,n))}function m0e(t,e,r,n){var s=Array.isArray(e),a=kr(e["!ref"]||"A1"),i,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=or(a)}for(var u=a.s.r;u<=a.e.r;++u){o=On(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(l[d]=gn(d)),i=l[d]+o;var g=s?(e[u]||[])[d]:e[i];g&&g0e(t,g,u,d)}}}function p0e(t,e){for(var r=e||{},n=Fa(),s=0,a=0;a<t.SheetNames.length;++a)t.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return kt(n,r.biff==4?1033:r.biff==3?521:9,y4(t,16,r)),m0e(n,t.Sheets[t.SheetNames[s]],s,r),kt(n,10),n.end()}function x0e(t,e,r){kt(t,49,uie({sz:12,name:"Arial"},r))}function y0e(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)e[s]!=null&&kt(t,1054,pie(s,e[s],r))})}function v0e(t,e){var r=Qe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),kt(t,2151,r),r=Qe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),eO(kr(e["!ref"]||"A1"),r),r.write_shift(4,4),kt(t,2152,r)}function w0e(t,e){for(var r=0;r<16;++r)kt(t,224,aj({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){kt(t,224,aj(n,0,e))})}function _0e(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];kt(t,440,zie(n)),n[1].Tooltip&&kt(t,2048,Vie(n))}delete e["!links"]}function b0e(t,e){if(e){var r=0;e.forEach(function(n,s){++r<=256&&n&&kt(t,125,qie(Xv(s,n),s))})}}function S0e(t,e,r,n,s){var a=16+Kc(s.cellXfs,e,s);if(e.v==null&&!e.bf){kt(t,513,rd(r,n,a));return}if(e.bf)kt(t,6,Yue(e,r,n,s,a));else switch(e.t){case"d":case"n":var i=e.t=="d"?ns(en(e.v)):e.v;kt(t,515,Nie(r,n,i,a));break;case"b":case"e":kt(t,517,Tie(r,n,e.v,a,s,e.t));break;case"s":case"str":if(s.bookSST){var o=T4(s.Strings,e.v,s.revStrings);kt(t,253,fie(r,n,o,a))}else kt(t,516,gie(r,n,(e.v||"").slice(0,255),a,s));break;default:kt(t,513,rd(r,n,a))}}function k0e(t,e,r){var n=Fa(),s=r.SheetNames[t],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[t]||{},l=Array.isArray(a),u=e.biff==8,d,g="",h=[],p=kr(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}kt(n,2057,y4(r,16,e)),kt(n,13,gi(1)),kt(n,12,gi(100)),kt(n,15,sa(!0)),kt(n,17,sa(!1)),kt(n,16,ed(.001)),kt(n,95,sa(!0)),kt(n,42,sa(!1)),kt(n,43,sa(!1)),kt(n,130,gi(1)),kt(n,128,Cie()),kt(n,131,sa(!1)),kt(n,132,sa(!1)),u&&b0e(n,a["!cols"]),kt(n,512,yie(p,e)),u&&(a["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){g=On(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(h[w]=gn(w)),d=h[w]+g;var S=l?(a[v]||[])[w]:a[d];S&&(S0e(n,S,v,w,e),u&&S.l&&a["!links"].push([d,S.l]))}}var _=o.CodeName||o.name||s;return u&&kt(n,574,oie((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&kt(n,229,Lie(a["!merges"])),u&&_0e(n,a),kt(n,442,JI(_)),u&&v0e(n,a),kt(n,10),n.end()}function C0e(t,e,r){var n=Fa(),s=(t||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,l=r.biff==5;if(kt(n,2057,y4(t,5,r)),r.bookType=="xla"&&kt(n,135),kt(n,225,o?gi(1200):null),kt(n,193,Tae(2)),l&&kt(n,191),l&&kt(n,192),kt(n,226),kt(n,92,Xae("SheetJS",r)),kt(n,66,gi(o?1200:1252)),o&&kt(n,353,gi(0)),o&&kt(n,448),kt(n,317,toe(t.SheetNames.length)),o&&t.vbaraw&&kt(n,211),o&&t.vbaraw){var u=i.CodeName||"ThisWorkbook";kt(n,442,JI(u))}kt(n,156,gi(17)),kt(n,25,sa(!1)),kt(n,18,sa(!1)),kt(n,19,gi(0)),o&&kt(n,431,sa(!1)),o&&kt(n,444,gi(0)),kt(n,61,aie()),kt(n,64,sa(!1)),kt(n,141,gi(0)),kt(n,34,sa(nhe(t)=="true")),kt(n,14,sa(!0)),o&&kt(n,439,sa(!1)),kt(n,218,gi(0)),x0e(n,t,r),y0e(n,t.SSF,r),w0e(n,r),o&&kt(n,352,sa(!1));var d=n.end(),g=Fa();o&&kt(g,140,Xie()),o&&r.Strings&&d0e(g,252,Zae(r.Strings)),kt(g,10);var h=g.end(),p=Fa(),x=0,v=0;for(v=0;v<t.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*t.SheetNames[v].length;var w=d.length+x+h.length;for(v=0;v<t.SheetNames.length;++v){var S=a[v]||{};kt(p,133,Qae({pos:w,hs:S.Hidden||0,dt:0,name:t.SheetNames[v]},r)),w+=e[v].length}var _=p.end();if(x!=_.length)throw new Error("BS8 "+x+" != "+_.length);var y=[];return d.length&&y.push(d),_.length&&y.push(_),h.length&&y.push(h),gs(y)}function T0e(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=tn(Kt)),t&&t.SSF&&(Ph(),$v(t.SSF),r.revssf=Hv(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,F4(r),r.cellXfs=[],Kc(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var s=0;s<t.SheetNames.length;++s)n[n.length]=k0e(s,r,t);return n.unshift(C0e(t,n,r)),gs(n)}function HO(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Pa(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=e||{};switch(a.biff||2){case 8:case 5:return T0e(t,e);case 4:case 3:case 2:return p0e(t,e)}throw new Error("invalid type "+a.bookType+" for BIFF")}function wj(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var s=t.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=t.match(/<\/table/i),i=s.index,o=a&&a.index||t.length,l=use(t.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,g=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<l.length;++i){var v=l[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var S=v.split(/<\/t[dh]>/i);for(o=0;o<S.length;++o){var _=S[o].trim();if(_.match(/<t[dh]/i)){for(var y=_,k=0;y.charAt(0)=="<"&&(k=y.indexOf(">"))>-1;)y=y.slice(k+1);for(var N=0;N<x.length;++N){var E=x[N];E.s.c==d&&E.s.r<u&&u<=E.e.r&&(d=E.e.c+1,N=-1)}var A=qt(_.slice(0,_.indexOf(">")));h=A.colspan?+A.colspan:1,((g=+A.rowspan)>1||h>1)&&x.push({s:{r:u,c:d},e:{r:u+(g||1)-1,c:d+h-1}});var C=A.t||A["data-t"]||"";if(!y.length){d+=h;continue}if(y=hI(y),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!y.length){d+=h;continue}var F={t:"s",v:y};r.raw||!y.trim().length||C=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(Qi(y))?isNaN(rh(y).getDate())||(F={t:"d",v:en(y)},r.cellDates||(F={t:"n",v:ns(F.v)}),F.z=r.dateNF||Kt[14]):F={t:"n",v:Qi(y)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=F):n[Yt({r:u,c:d})]=F,d+=h}}}}return n["!ref"]=or(p),x.length&&(n["!merges"]=x),n}function E0e(t,e,r,n){for(var s=t["!merges"]||[],a=[],i=e.s.c;i<=e.e.c;++i){for(var o=0,l=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,l=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Yt({r,c:i}),g=n.dense?(t[r]||[])[i]:t[d],h=g&&g.v!=null&&(g.h||a4(g.w||(bl(g),g.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":g&&(p["data-t"]=g&&g.t||"z",g.v!=null&&(p["data-v"]=g.v),g.z!=null&&(p["data-z"]=g.z),g.l&&(g.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+g.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(St("td",h,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var N0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',A0e="</body></html>";function j0e(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Vc(wj(r[0],e),e);var n=R4();return r.forEach(function(s,a){M4(n,wj(s,e),"Sheet"+(a+1))}),n}function F0e(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zO(t,e){var r=e||{},n=r.header!=null?r.header:N0e,s=r.footer!=null?r.footer:A0e,a=[n],i=Pa(t["!ref"]);r.dense=Array.isArray(t),a.push(F0e(t,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(E0e(t,i,o,r));return a.push("</table>"+s),a.join("")}function GO(t,e,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?mn(n.origin):n.origin;s=i.r,a=i.c}var o=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(t["!ref"]){var d=Pa(t["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var g=[],h=0,p=t["!rows"]||(t["!rows"]=[]),x=0,v=0,w=0,S=0,_=0,y=0;for(t["!cols"]||(t["!cols"]=[]);x<o.length&&v<l;++x){var k=o[x];if(_j(k)){if(n.display)continue;p[v]={hidden:!0}}var N=k.children;for(w=S=0;w<N.length;++w){var E=N[w];if(!(n.display&&_j(E))){var A=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):hI(E.innerHTML),C=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<g.length;++h){var F=g[h];F.s.c==S+a&&F.s.r<v+s&&v+s<=F.e.r&&(S=F.e.c+1-a,h=-1)}y=+E.getAttribute("colspan")||1,((_=+E.getAttribute("rowspan")||1)>1||y>1)&&g.push({s:{r:v+s,c:S+a},e:{r:v+s+(_||1)-1,c:S+a+(y||1)-1}});var P={t:"s",v:A},M=E.getAttribute("data-t")||E.getAttribute("t")||"";A!=null&&(A.length==0?P.t=M||"z":n.raw||A.trim().length==0||M=="s"||(A==="TRUE"?P={t:"b",v:!0}:A==="FALSE"?P={t:"b",v:!1}:isNaN(Qi(A))?isNaN(rh(A).getDate())||(P={t:"d",v:en(A)},n.cellDates||(P={t:"n",v:ns(P.v)}),P.z=n.dateNF||Kt[14]):P={t:"n",v:Qi(A)})),P.z===void 0&&C!=null&&(P.z=C);var I="",Y=E.getElementsByTagName("A");if(Y&&Y.length)for(var se=0;se<Y.length&&!(Y[se].hasAttribute("href")&&(I=Y[se].getAttribute("href"),I.charAt(0)!="#"));++se);I&&I.charAt(0)!="#"&&(P.l={Target:I}),n.dense?(t[v+s]||(t[v+s]=[]),t[v+s][S+a]=P):t[Yt({c:S+a,r:v+s})]=P,u.e.c<S+a&&(u.e.c=S+a),S+=y}}++v}return g.length&&(t["!merges"]=(t["!merges"]||[]).concat(g)),u.e.r=Math.max(u.e.r,v-1+s),t["!ref"]=or(u),v>=l&&(t["!fullref"]=or((u.e.r=o.length-x+v-1+s,u))),t}function VO(t,e){var r=e||{},n=r.dense?[]:{};return GO(n,t,e)}function P0e(t,e){return Vc(VO(t,e),e)}function _j(t){var e="",r=D0e(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function D0e(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function R0e(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Sr(e.replace(/<[^>]*>/g,""));return[r]}var bj={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function KO(t,e){var r=e||{},n=i4(t),s=[],a,i,o={name:""},l="",u=0,d,g,h={},p=[],x=r.dense?[]:{},v,w,S={value:""},_="",y=0,k=[],N=-1,E=-1,A={s:{r:1e6,c:1e7},e:{r:0,c:0}},C=0,F={},P=[],M={},I=0,Y=0,se=[],L=1,z=1,G=[],O={Names:[]},R={},X=["",""],te=[],H={},V="",q=0,Q=!1,ae=!1,J=0;for(zg.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=zg.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(A.e.c>=A.s.c&&A.e.r>=A.s.r?x["!ref"]=or(A):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=A.e.r&&(x["!fullref"]=x["!ref"],A.e.r=r.sheetRows-1,x["!ref"]=or(A)),P.length&&(x["!merges"]=P),se.length&&(x["!rows"]=se),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),h[d.name]=x,ae=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=qt(v[0],!1),N=E=-1,A.s.r=A.s.c=1e7,A.e.r=A.e.c=0,x=r.dense?[]:{},P=[],se=[],ae=!0);break;case"table-row-group":v[1]==="/"?--C:++C;break;case"table-row":case"":if(v[1]==="/"){N+=L,L=1;break}if(g=qt(v[0],!1),g.?N=g.-1:N==-1&&(N=0),L=+g["number-rows-repeated"]||1,L<10)for(J=0;J<L;++J)C>0&&(se[N+J]={level:C});E=-1;break;case"covered-table-cell":v[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(x[N]||(x[N]=[]),x[N][E]={t:"z"}):x[Yt({r:N,c:E})]={t:"z"}),_="",k=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++E,S=qt(v[0],!1),z=parseInt(S["number-columns-repeated"]||"1",10),w={t:"z",v:null},S.formula&&r.cellFormula!=!1&&(w.f=xj(Sr(S.formula))),(S.||S["value-type"])=="string"&&(w.t="s",w.v=Sr(S["string-value"]||""),r.dense?(x[N]||(x[N]=[]),x[N][E]=w):x[Yt({r:N,c:E})]=w),E+=z-1;else if(v[1]!=="/"){++E,_="",y=0,k=[],z=1;var re=L?N+L-1:N;if(E>A.e.c&&(A.e.c=E),E<A.s.c&&(A.s.c=E),N<A.s.r&&(A.s.r=N),re>A.e.r&&(A.e.r=re),S=qt(v[0],!1),te=[],H={},w={t:S.||S["value-type"],v:null},r.cellFormula)if(S.formula&&(S.formula=Sr(S.formula)),S["number-matrix-columns-spanned"]&&S["number-matrix-rows-spanned"]&&(I=parseInt(S["number-matrix-rows-spanned"],10)||0,Y=parseInt(S["number-matrix-columns-spanned"],10)||0,M={s:{r:N,c:E},e:{r:N+I-1,c:E+Y-1}},w.F=or(M),G.push([M,w.F])),S.formula)w.f=xj(S.formula);else for(J=0;J<G.length;++J)N>=G[J][0].s.r&&N<=G[J][0].e.r&&E>=G[J][0].s.c&&E<=G[J][0].e.c&&(w.F=G[J][1]);switch((S["number-columns-spanned"]||S["number-rows-spanned"])&&(I=parseInt(S["number-rows-spanned"],10)||0,Y=parseInt(S["number-columns-spanned"],10)||0,M={s:{r:N,c:E},e:{r:N+I-1,c:E+Y-1}},P.push(M)),S["number-columns-repeated"]&&(z=parseInt(S["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=Yr(S["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(S.value);break;case"percentage":w.t="n",w.v=parseFloat(S.value);break;case"currency":w.t="n",w.v=parseFloat(S.value);break;case"date":w.t="d",w.v=en(S["date-value"]),r.cellDates||(w.t="n",w.v=ns(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=ose(S["time-value"])/86400,r.cellDates&&(w.t="d",w.v=zv(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(S.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",S["string-value"]!=null&&(_=Sr(S["string-value"]),k=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(Q=!1,w.t==="s"&&(w.v=_||"",k.length&&(w.R=k),Q=y==0),R.Target&&(w.l=R),te.length>0&&(w.c=te,te=[]),_&&r.cellText!==!1&&(w.w=_),Q&&(w.t="z",delete w.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var ve=0;ve<L;++ve){if(z=parseInt(S["number-columns-repeated"]||"1",10),r.dense)for(x[N+ve]||(x[N+ve]=[]),x[N+ve][E]=ve==0?w:tn(w);--z>0;)x[N+ve][E+z]=tn(w);else for(x[Yt({r:N+ve,c:E})]=w;--z>0;)x[Yt({r:N+ve,c:E+z})]=tn(w);A.e.c<=E&&(A.e.c=E)}z=parseInt(S["number-columns-repeated"]||"1",10),E+=z-1,z=0,w={},_="",k=[]}R={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;H.t=_,k.length&&(H.R=k),H.a=V,te.push(H)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);V="",q=0,_="",y=0,k=[];break;case"creator":v[1]==="/"?V=n.slice(q,v.index):q=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);_="",y=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(F[o.name]=l,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(l="",o=qt(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=qt(v[0],!1),l+=bj[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=qt(v[0],!1),l+=bj[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=qt(v[0],!1),X=j2(i["cell-range-address"]);var we={Name:i.name,Ref:X[0]+"!"+X[1]};ae&&(we.Sheet=p.length),O.Names.push(we);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!S||!S["string-value"])){var Fe=R0e(n.slice(y,v.index));_=(_.length>0?_+`
`:"")+Fe[0]}else qt(v[0],!1),y=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{X=j2(qt(v[0])["target-range-address"]),h[X[0]]["!autofilter"]={ref:X[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(R=qt(v[0],!1),!R.href)break;R.Target=Sr(R.href),delete R.href,R.Target.charAt(0)=="#"&&R.Target.indexOf(".")>-1?(X=j2(R.Target.slice(1)),R.Target="#"+X[0]+"!"+X[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var ne={Sheets:h,SheetNames:p,Workbook:O};return r.bookSheets&&delete ne.Sheets,ne}function Sj(t,e){e=e||{},hi(t,"META-INF/manifest.xml")&&oae(Wn(t,"META-INF/manifest.xml"),e);var r=Ua(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=KO($r(r),e);return hi(t,"meta.xml")&&(n.Props=OI(Wn(t,"meta.xml"))),n}function kj(t,e){return KO(t,e)}var M0e=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Hg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Bn+e}}(),Cj=function(){var t=function(a){return Or(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var l=[];l.push('      <table:table table:name="'+Or(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,g=Pa(a["!ref"]||"A1"),h=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=g.e.c;++d)l.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",w=a["!rows"]||[];for(u=0;u<g.s.r;++u)v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=g.e.r;++u){for(v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+v+`>
`),d=0;d<g.s.c;++d)l.push(e);for(;d<=g.e.c;++d){var S=!1,_={},y="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>d)&&!(h[p].s.r>u)&&!(h[p].e.c<d)&&!(h[p].e.r<u)){(h[p].s.c!=d||h[p].s.r!=u)&&(S=!0),_["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,_["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(S){l.push(r);continue}var k=Yt({r:u,c:d}),N=x?(a[u]||[])[d]:a[k];if(N&&N.f&&(_["table:formula"]=Or(tde(N.f)),N.F&&N.F.slice(0,k.length)==k)){var E=Pa(N.F);_["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,_["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!N){l.push(e);continue}switch(N.t){case"b":y=N.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=N.v?"true":"false";break;case"n":y=N.w||String(N.v||0),_["office:value-type"]="float",_["office:value"]=N.v||0;break;case"s":case"str":y=N.v==null?"":N.v,_["office:value-type"]="string";break;case"d":y=N.w||en(N.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=en(N.v).toISOString(),_["table:style-name"]="ce1";break;default:l.push(e);continue}var A=t(y);if(N.l&&N.l.Target){var C=N.l.Target;C=C.charAt(0)=="#"?"#"+rde(C.slice(1)):C,C.charAt(0)!="#"&&!C.match(/^\w+:/)&&(C="../"+C),A=St("text:a",A,{"xlink:href":C.replace(/&/g,"&amp;")})}l.push("          "+St("table:table-cell",St("text:p",A,{}),_)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var g=u["!cols"][d];if(g.width==null&&g.wpx==null&&g.wch==null)continue;Tc(g),g.ods=o;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=l;var g=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+g+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var l=[Bn],u=Hg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Hg({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+d+`>
`),l.push(II().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),s(l,i),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var g=0;g!=i.SheetNames.length;++g)l.push(n(i.Sheets[i.SheetNames[g]],i,g));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function XO(t,e){if(e.bookType=="fods")return Cj(t,e);var r=r4(),n="",s=[],a=[];return n="mimetype",lr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",lr(r,n,Cj(t,e)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",lr(r,n,M0e(t,e)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",lr(r,n,Bn+II()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",lr(r,n,uae(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",lr(r,n,lae(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function nd(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function tk(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):$r(Gc(t))}function I0e(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ba(To(t))}function O0e(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Nc(t){var e=t.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(s){r.set(s,n),n+=s.length}),r}function Tj(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function L0e(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,s=e+13;s>=e;--s)n=n*256+t[s];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function B0e(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)t[e+a]=s&255;t[e+15]|=r>=0?0:128}function Qg(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Rr(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function An(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Nr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],s=Qg(t,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var l=r[0];t[r[0]++]>=128;);o=t.slice(l,r[0])}break;case 5:i=4,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Qg(t,r),o=t.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};e[s]==null?e[s]=[u]:e[s].push(u)}return e}function ws(t){var e=[];return t.forEach(function(r,n){r.forEach(function(s){s.data&&(e.push(Rr(n*8+s.type)),s.type==2&&e.push(Rr(s.data.length)),e.push(s.data))})}),Nc(e)}function A4(t,e){return(t==null?void 0:t.map(function(r){return e(r.data)}))||[]}function ui(t){for(var e,r=[],n=[0];n[0]<t.length;){var s=Qg(t,n),a=Nr(t.slice(n[0],n[0]+s));n[0]+=s;var i={id:An(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Nr(o.data),u=An(l[3][0].data);i.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=a[3])!=null&&e[0]&&(i.merge=An(a[3][0].data)>>>0>0),r.push(i)}return r}function zd(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Rr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Rr(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Rr(i.data.length)}],n[2].push({data:ws(i.meta),type:2})});var a=ws(n);e.push(Rr(a.length)),e.push(a),s.forEach(function(i){return e.push(i)})}),Nc(e)}function U0e(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=Qg(e,r),s=[];r[0]<e.length;){var a=e[r[0]]&3;if(a==0){var i=e[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=e[r[0]],o>1&&(i|=e[r[0]+1]<<8),o>2&&(i|=e[r[0]+2]<<16),o>3&&(i|=e[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(e.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,u=0;if(a==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,a==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Nc(s)],l==0)throw new Error("Invalid offset 0");if(l>s[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(s.push(s[0].slice(-l)),u-=l;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-l,-l+u))}}var d=Nc(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function di(t){for(var e=[],r=0;r<t.length;){var n=t[r++],s=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(U0e(n,t.slice(r,r+s))),r+=s}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Nc(e)}function Gd(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),s=new Uint8Array(4);e.push(s);var a=Rr(n),i=a.length;e.push(a),n<=60?(i++,e.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Nc(e)}function $0e(t,e,r,n){var s=nd(t),a=s.getUint32(4,!0),i=(n>1?12:8)+Tj(a&(n>1?3470:398))*4,o=-1,l=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=Tj(a&(n>1?12288:4096))*4,a&16&&(l=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var g;switch(t[2]){case 0:break;case 2:g={t:"n",v:u};break;case 3:g={t:"s",v:e[l]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:u>0};break;case 7:g={t:"n",v:u/86400};break;case 8:g={t:"e",v:0};break;case 9:if(o>-1)g={t:"s",v:r[o]};else if(l>-1)g={t:"s",v:e[l]};else if(!isNaN(u))g={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return g}function W0e(t,e,r){var n=nd(t),s=n.getUint32(8,!0),a=12,i=-1,o=-1,l=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(l=L0e(t,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var g;switch(t[1]){case 0:break;case 2:g={t:"n",v:l};break;case 3:g={t:"s",v:e[o]};break;case 5:g={t:"d",v:d};break;case 6:g={t:"b",v:u>0};break;case 7:g={t:"n",v:u/86400};break;case 8:g={t:"e",v:0};break;case 9:if(i>-1)g={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)));break;case 10:g={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(s&31," : ").concat(t.slice(0,4)))}return g}function P2(t,e){var r=new Uint8Array(32),n=nd(r),s=12,a=0;switch(r[0]=5,t.t){case"n":r[1]=2,B0e(r,s,t.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,t.v?1:0,!0),a|=2,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,a,!0),r.slice(0,s)}function D2(t,e){var r=new Uint8Array(32),n=nd(r),s=12,a=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(s,t.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,t.v?1:0,!0),a|=32,s+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(s,e.indexOf(t.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,a,!0),r.slice(0,s)}function H0e(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return $0e(t,e,r,t[0]);case 5:return W0e(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Us(t){var e=Nr(t);return Qg(e[1][0].data)}function Ej(t,e){var r=Nr(e.data),n=An(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Nr(i.data),l=An(o[1][0].data)>>>0;switch(n){case 1:a[l]=tk(o[3][0].data);break;case 8:{var u=t[Us(o[9][0].data)][0],d=Nr(u.data),g=t[Us(d[1][0].data)][0],h=An(g.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=Nr(g.data);a[l]=p[3].map(function(x){return tk(x.data)}).join("")}break}}),a}function z0e(t,e){var r,n,s,a,i,o,l,u,d,g,h,p,x,v,w=Nr(t),S=An(w[1][0].data)>>>0,_=An(w[2][0].data)>>>0,y=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&An(w[8][0].data)>0||!1,k,N;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&e!=0)k=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,N=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((g=(d=w[4])==null?void 0:d[0])!=null&&g.data&&e!=1)k=(p=(h=w[4])==null?void 0:h[0])==null?void 0:p.data,N=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var E=y?4:1,A=nd(k),C=[],F=0;F<k.length/2;++F){var P=A.getUint16(F*2,!0);P<65535&&C.push([F,P])}if(C.length!=_)throw"Expected ".concat(_," cells, found ").concat(C.length);var M=[];for(F=0;F<C.length-1;++F)M[C[F][0]]=N.subarray(C[F][1]*E,C[F+1][1]*E);return C.length>=1&&(M[C[C.length-1][0]]=N.subarray(C[C.length-1][1]*E)),{R:S,cells:M}}function G0e(t,e){var r,n=Nr(e.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?An(n[7][0].data)>>>0>0?1:0:-1,a=A4(n[5],function(i){return z0e(i,s)});return{nrows:An(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=l}),i},[])}}function V0e(t,e,r){var n,s=Nr(e.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(An(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(An(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=or(a);var i=Nr(s[4][0].data),o=Ej(t,t[Us(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?Ej(t,t[Us(i[17][0].data)][0]):[],u=Nr(i[3][0].data),d=0;u[1].forEach(function(g){var h=Nr(g.data),p=t[Us(h[2][0].data)][0],x=An(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=G0e(t,p);v.data.forEach(function(w,S){w.forEach(function(_,y){var k=Yt({r:d+S,c:y}),N=H0e(_,o,l);N&&(r[k]=N)})}),d+=v.nrows})}function K0e(t,e){var r=Nr(e.data),n={"!ref":"A1"},s=t[Us(r[2][0].data)],a=An(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return V0e(t,s[0],n),n}function X0e(t,e){var r,n=Nr(e.data),s={name:(r=n[1])!=null&&r[0]?tk(n[1][0].data):"",sheets:[]},a=A4(n[2],Us);return a.forEach(function(i){t[i].forEach(function(o){var l=An(o.meta[1][0].data);l==6e3&&s.sheets.push(K0e(t,o))})}),s}function Y0e(t,e){var r=R4(),n=Nr(e.data),s=A4(n[1],Us);if(s.forEach(function(a){t[a].forEach(function(i){var o=An(i.meta[1][0].data);if(o==2){var l=X0e(t,i);l.sheets.forEach(function(u,d){M4(r,u,d==0?l.name:l.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function R2(t){var e,r,n,s,a={},i=[];if(t.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=di(l.content)}catch(g){return console.log("?? "+l.content.length+" "+(g.message||g))}var d;try{d=ui(u)}catch(g){return console.log("## "+(g.message||g))}d.forEach(function(g){a[g.id]=g.messages,i.push(g.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(e=a==null?void 0:a[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&An(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(l){a[l].forEach(function(u){var d=An(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Y0e(a,o)}function J0e(t,e,r){var n,s,a,i;if(!((n=t[6])!=null&&n[0])||!((s=t[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=t[8])==null?void 0:a[0])==null?void 0:i.data)&&An(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=nd(t[7][0].data),d=0,g=[],h=nd(t[4][0].data),p=0,x=[],v=0;v<e.length;++v){if(e[v]==null){u.setUint16(v*2,65535,!0),h.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),h.setUint16(v*2,p,!0);var w,S;switch(typeof e[v]){case"string":w=P2({t:"s",v:e[v]},r),S=D2({t:"s",v:e[v]},r);break;case"number":w=P2({t:"n",v:e[v]},r),S=D2({t:"n",v:e[v]},r);break;case"boolean":w=P2({t:"b",v:e[v]},r),S=D2({t:"b",v:e[v]},r);break;default:throw new Error("Unsupported value "+e[v])}g.push(w),d+=w.length,x.push(S),p+=S.length,++l}for(t[2][0].data=Rr(l);v<t[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),h.setUint16(v*2,65535,!0);return t[6][0].data=Nc(g),t[3][0].data=Nc(x),l}function Q0e(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Pa(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(or(n)));var a=oy(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(V){return V.forEach(function(q){typeof q=="string"&&i.push(q)})});var o={},l=[],u=Wt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(V,q){return[V,u.FullPaths[q]]}).forEach(function(V){var q=V[0],Q=V[1];if(q.type==2&&q.name.match(/\.iwa/)){var ae=q.content,J=di(ae),re=ui(J);re.forEach(function(ve){l.push(ve.id),o[ve.id]={deps:[],location:Q,type:An(ve.messages[0].meta[1][0].data)}})}}),l.sort(function(V,q){return V-q});var d=l.filter(function(V){return V>1}).map(function(V){return[V,Rr(V)]});u.FileIndex.map(function(V,q){return[V,u.FullPaths[q]]}).forEach(function(V){var q=V[0];if(V[1],!!q.name.match(/\.iwa/)){var Q=ui(di(q.content));Q.forEach(function(ae){ae.messages.forEach(function(J){d.forEach(function(re){ae.messages.some(function(ve){return An(ve.meta[1][0].data)!=11006&&O0e(ve.data,re[1])})&&o[re[0]].deps.push(ae.id)})})})}});for(var g=Wt.find(u,o[1].location),h=ui(di(g.content)),p,x=0;x<h.length;++x){var v=h[x];v.id==1&&(p=v)}var w=Us(Nr(p.messages[0].data)[1][0].data);for(g=Wt.find(u,o[w].location),h=ui(di(g.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(p=v);for(w=Us(Nr(p.messages[0].data)[2][0].data),g=Wt.find(u,o[w].location),h=ui(di(g.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(p=v);for(w=Us(Nr(p.messages[0].data)[2][0].data),g=Wt.find(u,o[w].location),h=ui(di(g.content)),x=0;x<h.length;++x)v=h[x],v.id==w&&(p=v);var S=Nr(p.messages[0].data);{S[6][0].data=Rr(n.e.r+1),S[7][0].data=Rr(n.e.c+1);var _=Us(S[46][0].data),y=Wt.find(u,o[_].location),k=ui(di(y.content));{for(var N=0;N<k.length&&k[N].id!=_;++N);if(k[N].id!=_)throw"Bad ColumnRowUIDMapArchive";var E=Nr(k[N].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var A=0;A<=n.e.c;++A){var C=[];C[1]=C[2]=[{type:0,data:Rr(A+420690)}],E[1].push({type:2,data:ws(C)}),E[2].push({type:0,data:Rr(A)}),E[3].push({type:0,data:Rr(A)})}E[4]=[],E[5]=[],E[6]=[];for(var F=0;F<=n.e.r;++F)C=[],C[1]=C[2]=[{type:0,data:Rr(F+726270)}],E[4].push({type:2,data:ws(C)}),E[5].push({type:0,data:Rr(F)}),E[6].push({type:0,data:Rr(F)});k[N].messages[0].data=ws(E)}y.content=Gd(zd(k)),y.size=y.content.length,delete S[46];var P=Nr(S[4][0].data);{P[7][0].data=Rr(n.e.r+1);var M=Nr(P[1][0].data),I=Us(M[2][0].data);y=Wt.find(u,o[I].location),k=ui(di(y.content));{if(k[0].id!=I)throw"Bad HeaderStorageBucket";var Y=Nr(k[0].messages[0].data);for(F=0;F<a.length;++F){var se=Nr(Y[2][0].data);se[1][0].data=Rr(F),se[4][0].data=Rr(a[F].length),Y[2][F]={type:Y[2][0].type,data:ws(se)}}k[0].messages[0].data=ws(Y)}y.content=Gd(zd(k)),y.size=y.content.length;var L=Us(P[2][0].data);y=Wt.find(u,o[L].location),k=ui(di(y.content));{if(k[0].id!=L)throw"Bad HeaderStorageBucket";for(Y=Nr(k[0].messages[0].data),A=0;A<=n.e.c;++A)se=Nr(Y[2][0].data),se[1][0].data=Rr(A),se[4][0].data=Rr(n.e.r+1),Y[2][A]={type:Y[2][0].type,data:ws(se)};k[0].messages[0].data=ws(Y)}y.content=Gd(zd(k)),y.size=y.content.length;var z=Us(P[4][0].data);(function(){for(var V=Wt.find(u,o[z].location),q=ui(di(V.content)),Q,ae=0;ae<q.length;++ae){var J=q[ae];J.id==z&&(Q=J)}var re=Nr(Q.messages[0].data);{re[3]=[];var ve=[];i.forEach(function(ne,Ee){ve[1]=[{type:0,data:Rr(Ee)}],ve[2]=[{type:0,data:Rr(1)}],ve[3]=[{type:2,data:I0e(ne)}],re[3].push({type:2,data:ws(ve)})})}Q.messages[0].data=ws(re);var we=zd(q),Fe=Gd(we);V.content=Fe,V.size=V.content.length})();var G=Nr(P[3][0].data);{var O=G[1][0];delete G[2];var R=Nr(O.data);{var X=Us(R[2][0].data);(function(){for(var V=Wt.find(u,o[X].location),q=ui(di(V.content)),Q,ae=0;ae<q.length;++ae){var J=q[ae];J.id==X&&(Q=J)}var re=Nr(Q.messages[0].data);{delete re[6],delete G[7];var ve=new Uint8Array(re[5][0].data);re[5]=[];for(var we=0,Fe=0;Fe<=n.e.r;++Fe){var ne=Nr(ve);we+=J0e(ne,a[Fe],i),ne[1][0].data=Rr(Fe),re[5].push({data:ws(ne),type:2})}re[1]=[{type:0,data:Rr(n.e.c+1)}],re[2]=[{type:0,data:Rr(n.e.r+1)}],re[3]=[{type:0,data:Rr(we)}],re[4]=[{type:0,data:Rr(n.e.r+1)}]}Q.messages[0].data=ws(re);var Ee=zd(q),ke=Gd(Ee);V.content=ke,V.size=V.content.length})()}O.data=ws(R)}P[3][0].data=ws(G)}S[4][0].data=ws(P)}p.messages[0].data=ws(S);var te=zd(h),H=Gd(te);return g.content=H,g.size=g.content.length,u}function YO(t){return function(r){for(var n=0;n!=t.length;++n){var s=t[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function j4(t){YO([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function F4(t){YO([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function q0e(t){return gr.WS.indexOf(t)>-1?"sheet":t==gr.CS?"chart":t==gr.DS?"dialog":t==gr.MS?"macro":t&&t.length?t:"sheet"}function Z0e(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,q0e(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function ege(t,e,r,n,s,a,i,o,l,u,d,g){try{a[n]=Q0(Ua(t,r,!0),e);var h=Wn(t,e),p;switch(o){case"sheet":p=bhe(h,e,s,l,a[n],u,d,g);break;case"chart":if(p=She(h,e,s,l,a[n],u,d,g),!p||!p["!drawel"])break;var x=E0(p["!drawel"].Target,e),v=Gg(x),w=cce(Ua(t,x,!0),Q0(Ua(t,v,!0),x)),S=E0(w,x),_=Gg(S);p=Jfe(Ua(t,S,!0),S,l,Q0(Ua(t,_,!0),S),u,p);break;case"macro":p=khe(h,e,s,l,a[n],u,d,g);break;case"dialog":p=Che(h,e,s,l,a[n],u,d,g);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var y=[];a&&a[n]&&jn(a[n]).forEach(function(k){var N="";if(a[n][k].Type==gr.CMNT){N=E0(a[n][k].Target,e);var E=Ahe(Wn(t,N,!0),N,l);if(!E||!E.length)return;fj(p,E,!1)}a[n][k].Type==gr.TCMNT&&(N=E0(a[n][k].Target,e),y=y.concat(dce(Wn(t,N,!0),l)))}),y&&y.length&&fj(p,y,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function li(t){return t.charAt(0)=="/"?t.slice(1):t}function tge(t,e){if(Ph(),e=e||{},j4(e),hi(t,"META-INF/manifest.xml")||hi(t,"objectdata.xml"))return Sj(t,e);if(hi(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof R2<"u"){if(t.FileIndex)return R2(t);var r=Wt.utils.cfb_new();return D8(t).forEach(function(se){lr(r,se,fse(t,se))}),R2(r)}throw new Error("Unsupported NUMBERS file")}if(!hi(t,"[Content_Types].xml"))throw hi(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):hi(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=D8(t),s=aae(Ua(t,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Wn(t,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Wn(t,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var l={},u={};if(!e.bookSheets&&!e.bookProps){if(q0=[],s.sst)try{q0=Nhe(Wn(t,li(s.sst)),s.sst,e)}catch(se){if(e.WTF)throw se}e.cellStyles&&s.themes.length&&(l=Ehe(Ua(t,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],e)),s.style&&(u=The(Wn(t,li(s.style)),s.style,l,e))}s.links.map(function(se){try{var L=Q0(Ua(t,Gg(li(se))),se);return Fhe(Wn(t,li(se)),L,se,e)}catch{}});var d=_he(Wn(t,li(s.workbooks[0])),s.workbooks[0],e),g={},h="";s.coreprops.length&&(h=Wn(t,li(s.coreprops[0]),!0),h&&(g=OI(h)),s.extprops.length!==0&&(h=Wn(t,li(s.extprops[0]),!0),h&&fae(h,g,e)));var p={};(!e.bookSheets||e.bookProps)&&s.custprops.length!==0&&(h=Ua(t,li(s.custprops[0]),!0),h&&(p=gae(h,e)));var x={};if((e.bookSheets||e.bookProps)&&(d.Sheets?i=d.Sheets.map(function(L){return L.name}):g.Worksheets&&g.SheetNames.length>0&&(i=g.SheetNames),e.bookProps&&(x.Props=g,x.Custprops=p),e.bookSheets&&typeof i<"u"&&(x.SheetNames=i),e.bookSheets?x.SheetNames:e.bookProps))return x;i={};var v={};e.bookDeps&&s.calcchain&&(v=jhe(Wn(t,li(s.calcchain)),s.calcchain));var w=0,S={},_,y;{var k=d.Sheets;g.Worksheets=k.length,g.SheetNames=[];for(var N=0;N!=k.length;++N)g.SheetNames[N]=k[N].name}var E=a?"bin":"xml",A=s.workbooks[0].lastIndexOf("/"),C=(s.workbooks[0].slice(0,A+1)+"_rels/"+s.workbooks[0].slice(A+1)+".rels").replace(/^\//,"");hi(t,C)||(C="xl/_rels/workbook."+E+".rels");var F=Q0(Ua(t,C,!0),C.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(e.xlmeta=Phe(Wn(t,li(s.metadata[0])),s.metadata[0],e)),(s.people||[]).length>=1&&(e.people=hce(Wn(t,li(s.people[0])),e)),F&&(F=Z0e(F,d.Sheets));var P=Wn(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=g.Worksheets;++w){var M="sheet";if(F&&F[w]?(_="xl/"+F[w][1].replace(/[\/]?xl\//,""),hi(t,_)||(_=F[w][1]),hi(t,_)||(_=C.replace(/_rels\/.*$/,"")+F[w][1]),M=F[w][2]):(_="xl/worksheets/sheet"+(w+1-P)+"."+E,_=_.replace(/sheet0\./,"sheet.")),y=_.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(w!=e.sheets)continue e;break;case"string":if(g.SheetNames[w].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var I=!1,Y=0;Y!=e.sheets.length;++Y)typeof e.sheets[Y]=="number"&&e.sheets[Y]==w&&(I=1),typeof e.sheets[Y]=="string"&&e.sheets[Y].toLowerCase()==g.SheetNames[w].toLowerCase()&&(I=1);if(!I)continue e}}ege(t,_,y,g.SheetNames[w],w,S,i,M,e,d,l,u)}return x={Directory:s,Workbook:d,Props:g,Custprops:p,Deps:v,Sheets:i,SheetNames:g.SheetNames,Strings:q0,Styles:u,Themes:l,SSF:tn(Kt)},e&&e.bookFiles&&(t.files?(x.keys=n,x.files=t.files):(x.keys=[],x.files={},t.FullPaths.forEach(function(se,L){se=se.replace(/^Root Entry[\/]/,""),x.keys.push(se),x.files[se]=t.FileIndex[L]}))),e&&e.bookVBA&&(s.vba.length>0?x.vbaraw=Wn(t,li(s.vba[0]),!0):s.defaults&&s.defaults.bin===_ce&&(x.vbaraw=Wn(t,"xl/vbaProject.bin",!0))),x}function rge(t,e){var r=e||{},n="Workbook",s=Wt.find(t,n);try{if(n="/!DataSpaces/Version",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Poe(s.content),n="/!DataSpaces/DataSpaceMap",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Roe(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Moe(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Ooe(s.content)}catch{}if(n="/EncryptionInfo",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Loe(s.content);if(n="/EncryptedPackage",s=Wt.find(t,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function nge(t,e){return e.bookType=="ods"?XO(t,e):e.bookType=="numbers"?Q0e(t,e):e.bookType=="xlsb"?sge(t,e):age(t,e)}function sge(t,e){vf=1024,t&&!t.SSF&&(t.SSF=tn(Kt)),t&&t.SSF&&(Ph(),$v(t.SSF),e.revssf=Hv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Z0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=bO.indexOf(e.bookType)>-1,s=p4();F4(e=e||{});var a=r4(),i="",o=0;if(e.cellXfs=[],Kc(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",lr(a,i,LI(t.Props,e)),s.coreprops.push(i),Ir(e.rels,2,i,gr.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,lr(a,i,$I(t.Props)),s.extprops.push(i),Ir(e.rels,3,i,gr.EXT_PROPS),t.Custprops!==t.Props&&jn(t.Custprops||{}).length>0&&(i="docProps/custom.xml",lr(a,i,WI(t.Custprops)),s.custprops.push(i),Ir(e.rels,4,i,gr.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var d={"!id":{}},g=t.Sheets[t.SheetNames[o-1]],h=(g||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,lr(a,i,Rhe(o-1,i,e,t,d)),s.sheets.push(i),Ir(e.wbrels,-1,"worksheets/sheet"+o+"."+r,gr.WS[0])}if(g){var p=g["!comments"],x=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+r,lr(a,v,Ohe(p,v)),s.comments.push(v),Ir(d,-1,"../comments"+o+"."+r,gr.CMNT),x=!0),g["!legacy"]&&x&&lr(a,"xl/drawings/vmlDrawing"+o+".vml",wO(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}d["!id"].rId1&&lr(a,Gg(i),Rf(d))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,lr(a,i,Ihe(e.Strings,i,e)),s.strs.push(i),Ir(e.wbrels,-1,"sharedStrings."+r,gr.SST)),i="xl/workbook."+r,lr(a,i,Dhe(t,i)),s.workbooks.push(i),Ir(e.rels,1,i,gr.WB),i="xl/theme/theme1.xml",lr(a,i,b4(t.Themes,e)),s.themes.push(i),Ir(e.wbrels,-1,"theme/theme1.xml",gr.THEME),i="xl/styles."+r,lr(a,i,Mhe(t,i,e)),s.styles.push(i),Ir(e.wbrels,-1,"styles."+r,gr.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",lr(a,i,t.vbaraw),s.vba.push(i),Ir(e.wbrels,-1,"vbaProject.bin",gr.VBA)),i="xl/metadata."+r,lr(a,i,Lhe(i)),s.metadata.push(i),Ir(e.wbrels,-1,"metadata."+r,gr.XLMETA),lr(a,"[Content_Types].xml",MI(s,e)),lr(a,"_rels/.rels",Rf(e.rels)),lr(a,"xl/_rels/workbook."+r+".rels",Rf(e.wbrels)),delete e.revssf,delete e.ssf,a}function age(t,e){vf=1024,t&&!t.SSF&&(t.SSF=tn(Kt)),t&&t.SSF&&(Ph(),$v(t.SSF),e.revssf=Hv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Z0?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=bO.indexOf(e.bookType)>-1,s=p4();F4(e=e||{});var a=r4(),i="",o=0;if(e.cellXfs=[],Kc(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),i="docProps/core.xml",lr(a,i,LI(t.Props,e)),s.coreprops.push(i),Ir(e.rels,2,i,gr.CORE_PROPS),i="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,lr(a,i,$I(t.Props)),s.extprops.push(i),Ir(e.rels,3,i,gr.EXT_PROPS),t.Custprops!==t.Props&&jn(t.Custprops||{}).length>0&&(i="docProps/custom.xml",lr(a,i,WI(t.Custprops)),s.custprops.push(i),Ir(e.rels,4,i,gr.CUST_PROPS));var d=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var g={"!id":{}},h=t.Sheets[t.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,lr(a,i,DO(o-1,e,t,g)),s.sheets.push(i),Ir(e.wbrels,-1,"worksheets/sheet"+o+"."+r,gr.WS[0])}if(h){var x=h["!comments"],v=!1,w="";if(x&&x.length>0){var S=!1;x.forEach(function(_){_[1].forEach(function(y){y.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+o+"."+r,lr(a,w,fce(x,d,e)),s.threadedcomments.push(w),Ir(g,-1,"../threadedComments/threadedComment"+o+"."+r,gr.TCMNT)),w="xl/comments"+o+"."+r,lr(a,w,_O(x)),s.comments.push(w),Ir(g,-1,"../comments"+o+"."+r,gr.CMNT),v=!0}h["!legacy"]&&v&&lr(a,"xl/drawings/vmlDrawing"+o+".vml",wO(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}g["!id"].rId1&&lr(a,Gg(i),Rf(g))}return e.Strings!=null&&e.Strings.length>0&&(i="xl/sharedStrings."+r,lr(a,i,lO(e.Strings,e)),s.strs.push(i),Ir(e.wbrels,-1,"sharedStrings."+r,gr.SST)),i="xl/workbook."+r,lr(a,i,LO(t)),s.workbooks.push(i),Ir(e.rels,1,i,gr.WB),i="xl/theme/theme1.xml",lr(a,i,b4(t.Themes,e)),s.themes.push(i),Ir(e.wbrels,-1,"theme/theme1.xml",gr.THEME),i="xl/styles."+r,lr(a,i,pO(t,e)),s.styles.push(i),Ir(e.wbrels,-1,"styles."+r,gr.STY),t.vbaraw&&n&&(i="xl/vbaProject.bin",lr(a,i,t.vbaraw),s.vba.push(i),Ir(e.wbrels,-1,"vbaProject.bin",gr.VBA)),i="xl/metadata."+r,lr(a,i,vO()),s.metadata.push(i),Ir(e.wbrels,-1,"metadata."+r,gr.XLMETA),d.length>1&&(i="xl/persons/person.xml",lr(a,i,gce(d)),s.people.push(i),Ir(e.wbrels,-1,"persons/person.xml",gr.PEOPLE)),lr(a,"[Content_Types].xml",MI(s,e)),lr(a,"_rels/.rels",Rf(e.rels)),lr(a,"xl/_rels/workbook."+r+".rels",Rf(e.wbrels)),delete e.revssf,delete e.ssf,a}function P4(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=Ga(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function ige(t,e){return Wt.find(t,"EncryptedPackage")?rge(t,e):WO(t,e)}function oge(t,e){var r,n=t,s=e||{};return s.type||(s.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),r=uI(n,s),tge(r,s)}function JO(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return ZS(t.slice(r),e);default:break e}return nh.to_workbook(t,e)}function lge(t,e){var r="",n=P4(t,e);switch(e.type){case"base64":r=Ga(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Zu(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=$r(r)),e.type="binary",JO(r,e)}function cge(t,e){var r=t;return e.type=="base64"&&(r=Ga(r)),r=Bg.utils.decode(1200,r.slice(2),"str"),e.type="binary",JO(r,e)}function uge(t){return t.match(/[^\x00-\x7F]/)?To(t):t}function M2(t,e,r,n){return n?(r.type="string",nh.to_workbook(t,r)):nh.to_workbook(e,r)}function rk(t,e){QT();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return rk(new Uint8Array(t),(r=tn(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),If={},r.dateNF&&(If.dateNF=r.dateNF),r.type||(r.type=fr&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=fr?"buffer":"binary",n=sse(t),typeof Uint8Array<"u"&&!fr&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=uge(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=tn(r),r.type="array",rk(qT(n),r)}switch((s=P4(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return ige(Wt.read(n,r),r);break;case 9:if(s[1]<=8)return WO(n,r);break;case 60:return ZS(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return moe(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return iO.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?oge(n,r):M2(t,n,r,a);case 239:return s[3]===60?ZS(n,r):M2(t,n,r,a);case 255:if(s[1]===254)return cge(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Fu.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Fu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return qS.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return hO.to_workbook(n,r);break;case 10:case 13:case 32:return lge(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return goe.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?qS.to_workbook(n,r):M2(t,n,r,a)}function QO(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Fm(e.file,Wt.write(t,{type:fr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Wt.write(t,e)}function dge(t,e){var r=tn(e||{}),n=nge(t,r);return fge(n,r)}function fge(t,e){var r={},n=fr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var s=t.FullPaths?Wt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Uv(s))}return e.password&&typeof encrypt_agile<"u"?QO(encrypt_agile(s,e.password),e):e.type==="file"?Fm(e.file,s):e.type=="string"?$r(s):s}function hge(t,e){var r=e||{},n=u0e(t,r);return QO(n,r)}function xo(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Ug(To(n));case"binary":return To(n);case"string":return t;case"file":return Fm(e.file,n,"utf8");case"buffer":return fr?jl(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):xo(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function gge(t,e){switch(e.type){case"base64":return Ug(t);case"binary":return t;case"string":return t;case"file":return Fm(e.file,t,"binary");case"buffer":return fr?jl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function _x(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Ug(r):e.type=="string"?$r(r):r;case"file":return Fm(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function qO(t,e){QT(),ihe(t);var r=tn(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=qO(t,r);return r.type="array",Uv(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=t.SheetNames.indexOf(r.sheet),!t.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return xo(n0e(t,r),r);case"slk":case"sylk":return xo(aO.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"htm":case"html":return xo(zO(t.Sheets[t.SheetNames[s]],r),r);case"txt":return gge(ZO(t.Sheets[t.SheetNames[s]],r),r);case"csv":return xo(D4(t.Sheets[t.SheetNames[s]],r),r,"\uFEFF");case"dif":return xo(iO.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"dbf":return _x(qS.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"prn":return xo(nh.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"rtf":return xo(hO.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"eth":return xo(oO.from_sheet(t.Sheets[t.SheetNames[s]],r),r);case"fods":return xo(XO(t,r),r);case"wk1":return _x(Fu.sheet_to_wk1(t.Sheets[t.SheetNames[s]],r),r);case"wk3":return _x(Fu.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),_x(HO(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),hge(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return dge(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function mge(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function pge(t,e,r){var n={};return n.type="file",n.file=e,mge(n),qO(t,n)}function xge(t,e,r,n,s,a,i,o){var l=On(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),g=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||t[r])for(var p=e.s.c;p<=e.e.c;++p){var x=i?t[r][p]:t[n[p]+l];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(h[a[p]]=u);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)h[a[p]]=null;else if(u!==void 0)h[a[p]]=u;else if(d&&v===null)h[a[p]]=null;else continue;else h[a[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:bl(x,v,o);v!=null&&(g=!1)}}return{row:h,isempty:g}}function oy(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},d=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":l=kr(d);break;case"number":l=kr(t["!ref"]),l.s.r=d;break;default:l=d}n>0&&(s=0);var g=On(l.s.r),h=[],p=[],x=0,v=0,w=Array.isArray(t),S=l.s.r,_=0,y={};w&&!t[S]&&(t[S]=[]);var k=u.skipHidden&&t["!cols"]||[],N=u.skipHidden&&t["!rows"]||[];for(_=l.s.c;_<=l.e.c;++_)if(!(k[_]||{}).hidden)switch(h[_]=gn(_),r=w?t[S][_]:t[h[_]+g],n){case 1:a[_]=_-l.s.c;break;case 2:a[_]=h[_];break;case 3:a[_]=u.header[_-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=bl(r,null,u),v=y[i]||0,!v)y[i]=1;else{do o=i+"_"+v++;while(y[o]);y[i]=v,y[o]=1}a[_]=o}for(S=l.s.r+s;S<=l.e.r;++S)if(!(N[S]||{}).hidden){var E=xge(t,l,S,h,n,a,w,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=E.row)}return p.length=x,p}var Nj=/"/g;function yge(t,e,r,n,s,a,i,o){for(var l=!0,u=[],d="",g=On(r),h=e.s.c;h<=e.e.c;++h)if(n[h]){var p=o.dense?(t[r]||[])[h]:t[n[h]+g];if(p==null)d="";else if(p.v!=null){l=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:bl(p,null,o));for(var x=0,v=0;x!==d.length;++x)if((v=d.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(Nj,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(l=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(Nj,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&l?null:u.join(i)}function D4(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var s=kr(t["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",g=[];n.dense=Array.isArray(t);for(var h=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(h[x]||{}).hidden||(g[x]=gn(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=yge(t,s,w,g,i,l,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function ZO(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=D4(t,e);return r}function vge(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var s=kr(t["!ref"]),a="",i=[],o,l=[],u=Array.isArray(t);for(o=s.s.c;o<=s.e.c;++o)i[o]=gn(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=On(d),o=s.s.c;o<=s.e.c;++o)if(e=i[o]+a,r=u?(t[d]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function eL(t,e,r){var n=r||{},s=+!n.skipHeader,a=t||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?mn(n.origin):n.origin;i=l.r,o=l.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+e.length-1+s}};if(a["!ref"]){var g=kr(a["!ref"]);d.e.c=Math.max(d.e.c,g.e.c),d.e.r=Math.max(d.e.r,g.e.r),i==-1&&(i=g.e.r+1,d.e.r=i+e.length-1+s)}else i==-1&&(i=0,d.e.r=e.length-1+s);var h=n.header||[],p=0;e.forEach(function(v,w){jn(v).forEach(function(S){(p=h.indexOf(S))==-1&&(h[p=h.length]=S);var _=v[S],y="z",k="",N=Yt({c:o+p,r:i+w+s});u=qg(a,N),_&&typeof _=="object"&&!(_ instanceof Date)?a[N]=_:(typeof _=="number"?y="n":typeof _=="boolean"?y="b":typeof _=="string"?y="s":_ instanceof Date?(y="d",n.cellDates||(y="n",_=ns(_)),k=n.dateNF||Kt[14]):_===null&&n.nullError&&(y="e",_=0),u?(u.t=y,u.v=_,delete u.w,delete u.R,k&&(u.z=k)):a[N]=u={t:y,v:_},k&&(u.z=k))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var x=On(i);if(s)for(p=0;p<h.length;++p)a[gn(p+o)+x]={t:"s",v:h[p]};return a["!ref"]=or(d),a}function wge(t,e){return eL(null,t,e)}function qg(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=mn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?qg(t,Yt(e)):qg(t,Yt({r:e,c:r||0}))}function _ge(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function R4(){return{SheetNames:[],Sheets:{}}}function M4(t,e,r,n){var s=1;if(!r)for(;s<=65535&&t.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&t.SheetNames.indexOf(r=i+s)!=-1;++s);}if(OO(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function bge(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=_ge(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function Sge(t,e){return t.z=e,t}function tL(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function kge(t,e,r){return tL(t,"#"+e,r)}function Cge(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function Tge(t,e,r,n){for(var s=typeof e!="string"?e:kr(e),a=typeof e=="string"?e:or(e),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var l=qg(t,i,o);l.t="n",l.F=a,delete l.v,i==s.s.r&&o==s.s.c&&(l.f=r,n&&(l.D=!0))}return t}var zx={encode_col:gn,encode_row:On,encode_cell:Yt,encode_range:or,decode_col:u4,decode_row:c4,split_cell:Ise,decode_cell:mn,decode_range:Pa,format_cell:bl,sheet_add_aoa:NI,sheet_add_json:eL,sheet_add_dom:GO,aoa_to_sheet:Dh,json_to_sheet:wge,table_to_sheet:VO,table_to_book:P0e,sheet_to_csv:D4,sheet_to_txt:ZO,sheet_to_json:oy,sheet_to_html:zO,sheet_to_formulae:vge,sheet_to_row_object_array:oy,sheet_get_cell:qg,book_new:R4,book_append_sheet:M4,book_set_sheet_visibility:bge,cell_set_number_format:Sge,cell_set_hyperlink:tL,cell_set_internal_link:kge,cell_add_comment:Cge,sheet_set_array_formula:Tge,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const rL=({onBackToCabinet:t,selectedGrade:e,selectedClass:r,openRetestModal:n})=>{Xa(),Ty();const{user:s,isAuthenticated:a}=vn(),{showNotification:i}=qs(),o=b.useCallback(K=>{let le=null;if(typeof(K==null?void 0:K.percentage)=="number"&&!Number.isNaN(K.percentage))return le=Math.round(K.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:K.percentage,rounded:le,result:K}),le;const be=(K==null?void 0:K.retest_best_score)??(K==null?void 0:K.score),pe=(K==null?void 0:K.retest_best_max_score)??(K==null?void 0:K.max_score),Te=Number(be??0),B=Number(pe??0);return B>0&&(le=Math.round(Te/B*100)),console.debug("[TeacherResults] Computed percentage",{score:K==null?void 0:K.score,max_score:K==null?void 0:K.max_score,retest_best_score:K==null?void 0:K.retest_best_score,retest_best_max_score:K==null?void 0:K.retest_best_max_score,derived:le,result:K}),le},[]);b.useCallback(K=>{const le=o(K);return le===null?"bg-gray-100 text-gray-800":le<50?"bg-red-100 text-red-700":le<70?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"},[o]),b.useCallback(K=>{const le=o(K);return le!==null&&le<50},[o]);const[l,u]=b.useState(null),[d,g]=b.useState(!0),[h,p]=b.useState(""),[x,v]=b.useState([]),[w,S]=b.useState(null),[_,y]=b.useState(!1),[k,N]=b.useState([]),[E,A]=b.useState([]),[C,F]=b.useState([1,2]),[P,M]=b.useState(null),[I,Y]=b.useState(null),[se,L]=b.useState(null),[z,G]=b.useState("main"),[O,R]=b.useState(null),[X,te]=b.useState(null),H=O||e,V=X||r,[q,Q]=b.useState(null),[ae,J]=b.useState({}),[re,ve]=b.useState(!1),[we,Fe]=b.useState(new Set),[ne,Ee]=b.useState(!1),[ke,He]=b.useState(!1),at=b.useRef(null),[Me,Ft]=b.useState(null),[Ut,Pe]=b.useState(!1),[Re,$e]=b.useState(null),[Be,Ge]=b.useState(""),[ht,Nt]=b.useState(""),[Ye,Ve]=b.useState(!1),[ot,et]=b.useState(!1),[nt,gt]=b.useState(new Set),[Et,Ne]=b.useState({}),[Ke,Ze]=b.useState(!1),ft=b.useRef(new Set),ut=b.useRef({}),bt=b.useRef(null);b.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(nt)),ft.current=nt},[nt]),b.useEffect(()=>{console.log(" columnScores state changed:",Et),ut.current=Et},[Et]);const ye=b.useCallback(K=>{console.log(" Toggling test collapse for:",K),Fe(le=>{const be=new Set(le);return be.has(K)?(be.delete(K),console.log(" Expanding test:",K)):(be.add(K),console.log(" Collapsing test:",K)),console.log(" New collapsed tests:",Array.from(be)),be})},[]),de=b.useCallback(()=>{if(at.current){const{scrollLeft:K,scrollWidth:le,clientWidth:be}=at.current;Ee(K>0),He(K<le-be-1)}},[]);b.useEffect(()=>{Ae()},[]),b.useEffect(()=>{P&&at.current&&setTimeout(de,100)},[P,de]),b.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(we))},[we]);const ee=b.useCallback(async(K,le,be)=>{var pe,Te,B;console.log(" Loading class results for:",K,le,be),ve(!0);try{const ie=`${K}/${le}`;console.log(" Formatted class name:",ie);let xe=l;xe||(console.log(" Teacher data not loaded, loading now..."),xe=await Ur.getTeacherData(),u(xe));const ce=s==null?void 0:s.teacher_id;let Ce=null,Oe=I;if(Oe||(console.log(" Academic year data not loaded, loading now..."),Oe=await At()),Oe&&Array.isArray(Oe)&&Oe.length>0){const mt=parseInt(be);console.log(" Looking for semester",mt,"in current academic year");const qe=new Date,xt=Oe.find(Pt=>{const jt=new Date(Pt.start_date),W=new Date(Pt.end_date);return qe>=jt&&qe<=W}),Bt=xt?xt.academic_year:Oe[0].academic_year;console.log(" Current academic year:",Bt);const xr=Oe.filter(Pt=>Pt.academic_year===Bt);console.log(" Current year periods:",xr);const $t=xr.filter(Pt=>parseInt(Pt.semester)===1),Ht=xr.filter(Pt=>parseInt(Pt.semester)===2);if(console.log(" Semester 1 periods:",$t),console.log(" Semester 2 periods:",Ht),mt===1?(Ce=(pe=$t[0])==null?void 0:pe.id,console.log(" Using semester 1 period:",$t[0])):mt===2&&(Ce=(Te=Ht[0])==null?void 0:Te.id,console.log(" Using semester 2 period:",Ht[0])),!Ce)throw new Error(`No ${mt===1?"Semester 1":"Semester 2"} data available for academic year ${Bt}`)}if(!ce||!Ce)throw console.error(" Missing data:",{teacherId:ce,academicPeriodId:Ce,academicYear:I}),new Error("Missing teacher ID or academic period ID");const Ie=await Rre.getTeacherStudentResults(ce,K,ie,be,Ce);if(console.log(" Class results response:",Ie),Ie.success){console.log(" API Response details:",{results:Ie.results,students:Ie.students,count:Ie.count,student_count:Ie.student_count});const mt=[],qe=new Set,xt=new Set;Ie.results&&Ie.results.length>0&&Ie.results.forEach($t=>{$t.test_name&&!qe.has($t.test_name)&&(qe.add($t.test_name),mt.push({test_name:$t.test_name,test_type:$t.test_type,subject:$t.subject})),$t.subject&&xt.add($t.subject)});const Bt=(Ie.students||[]).map($t=>{const Ht={};return(Ie.results||[]).filter(jt=>jt.student_id===$t.student_id).forEach(jt=>{jt.test_name&&(Ht[jt.test_name]={id:jt.id,test_type:jt.test_type,test_id:jt.test_id,subject_id:jt.subject_id,score:jt.score,max_score:jt.max_score,retest_offered:jt.retest_offered,caught_cheating:jt.caught_cheating,visibility_change_times:jt.visibility_change_times,answers:jt.answers,name:jt.name,surname:jt.surname,test_name:jt.test_name})}),{...$t,...Ht}}),xr={results:Ie.results||[],students:Bt,class:Bt,unique_tests:mt,subjects:Array.from(xt),count:Ie.count||0,student_count:Ie.student_count||0};console.log(" Processed results data:",{uniqueTests:mt.length,subjects:Array.from(xt),resultsCount:((B=Ie.results)==null?void 0:B.length)||0,studentsWithScores:Bt.length,sampleStudent:Bt[0]}),M(xr),J(xr),L(new Date),Ie.students&&Ie.students.length>0?(console.log(" Student list loaded:",Ie.students.length,"students"),console.log(" Sample student:",Ie.students[0])):console.log(" No students found for this class")}else console.log(" API call failed for this class"),M(null),J(null)}catch(ie){console.error(" Error loading class results:",ie),i("Error loading class results","error"),M(null),J(null)}finally{ve(!1)}},[l,s,I,i]),he=b.useCallback(async(K,le)=>{console.log(" Determining current semester for:",K,le);try{if(I&&I.length>0){const be=new Date;let pe=1,Te=null;for(const B of I){const ie=new Date(B.start_date),xe=new Date(B.end_date);if(console.log(" Checking period:",{period:B,semester:B.semester,semesterType:typeof B.semester,startDate:ie,endDate:xe,currentDate:be,isInRange:be>=ie&&be<=xe}),be>=ie&&be<=xe){Te=B,pe=B.semester,console.log(" Found matching period:",{period:B,semester:B.semester,semesterType:typeof B.semester});break}}if(Te){console.log(" Current academic period found:",Te),console.log(" Current semester:",pe);const B=pe&&!isNaN(pe)?pe:1;console.log(" Using semester:",B),S(B),await ee(K,le,B)}else console.log(" No current academic period found, using default semester 1"),S(1),await ee(K,le,1)}else console.log(" No academic year data, using default semester 1"),S(1),await ee(K,le,1)}catch(be){console.error(" Error determining current semester:",be),S(1),await ee(K,le,1)}},[I,ee]);b.useEffect(()=>{e&&r&&(console.log(" Props detected:",{grade:e,class:r}),he(e,r))},[e,r,he]);const Ae=b.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(g(!0),p(""),!a||!s){console.log(" User not authenticated"),p("User not authenticated");return}if(s.role!==aa.TEACHER){console.error(" Invalid user role for teacher results:",s.role),p("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await st(),console.log(" Loading academic year data..."),await rt(),console.log(" Teacher results initialization complete!")}catch(K){console.error(" Error initializing teacher results:",K),p("Failed to initialize teacher results")}finally{g(!1)}},[a,s]),st=b.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const K=`teacher_data_${(s==null?void 0:s.teacher_id)||(s==null?void 0:s.id)||""}`;let le=zr(K);le?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),le=await Ur.getTeacherData(),console.log(" Teacher data loaded:",le),Gr(K,le,Jr.teacher_subjects)),u(le);const be=[];le&&le.subjects&&le.subjects.forEach(xe=>{xe.classes&&xe.classes.forEach(ce=>{ce.grade&&ce.class&&be.push({grade:ce.grade,class:ce.class,subject:xe.name})})}),A(be),console.log(" Available classes from teacher data:",be);const pe=`teacher_tests_${(s==null?void 0:s.teacher_id)||(s==null?void 0:s.id)||""}`,Te=zr(pe);Te&&Te.some(xe=>xe.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(pe));let B=zr(pe);B?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),B=await Ar.getTeacherTests(),console.log(" Teacher tests loaded:",B),Gr(pe,B,Jr.teacher_tests));const ie=B.flatMap(xe=>xe.assignments||[]);v(ie),console.log(" Raw assignments data:",ie),console.log(" Teacher assignments loaded:",ie.length)}catch(K){console.error(" Error loading teacher assignments:",K),i("Failed to load teacher assignments","error")}},[i]),rt=b.useCallback(async()=>{var K;console.log(" Loading academic year data...");try{const le="admin_academic_years_";let be=zr(le);be?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),be=await Ur.getAcademicYear(),console.log(" Academic year response:",be),Gr(le,be,Jr.admin_academic_years)),console.log(" First academic year record:",(be==null?void 0:be[0])||((K=be==null?void 0:be.academic_years)==null?void 0:K[0])),be&&Array.isArray(be)?(Y(be),console.log(" Academic year data loaded:",be.length),console.log(" Sample record fields:",Object.keys(be[0]||{}))):be&&be.academic_years?(Y(be.academic_years),console.log(" Academic year data loaded:",be.academic_years.length),console.log(" Sample record fields:",Object.keys(be.academic_years[0]||{}))):console.warn(" Failed to load academic year data:",(be==null?void 0:be.error)||"No data received")}catch(le){console.error(" Error loading academic year data:",le)}},[]),At=b.useCallback(async()=>{console.log(" Loading academic year data (direct return)...");try{const K="admin_academic_years_";let le=zr(K);return le?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),le=await Ur.getAcademicYear(),console.log(" Academic year response:",le),Gr(K,le,Jr.admin_academic_years)),le&&Array.isArray(le)?(console.log(" Returning academic year data:",le.length),le):le&&le.academic_years?(console.log(" Returning academic year data:",le.academic_years.length),le.academic_years):(console.warn(" Failed to load academic year data:",(le==null?void 0:le.error)||"No data received"),null)}catch(K){return console.error(" Error loading academic year data:",K),null}},[]),yt=b.useCallback(async(K,le)=>{console.log(" Showing classes for grade:",K,"class:",le),R(K),te(le),S(null),M(null),K&&le&&await he(K,le)},[he]);b.useCallback((K,le)=>{console.log(" Showing semesters for class:",K,le),S(null),M(null),he(K,le)},[]),b.useCallback((K,le)=>{console.log(" Class clicked:",K,le),y(!0),he(K,le)},[]);const wt=b.useCallback(async K=>{!H||!V||(console.log(" Loading results for semester:",K),S(K),await ee(H,V,K))},[H,V,ee]);b.useCallback(()=>{let K=1;if(I&&I.length>0){const le=new Date;for(const be of I){const pe=new Date(be.start_date),Te=new Date(be.end_date);if(le>=pe&&le<=Te){K=be.semester;break}}}return c.jsx("div",{className:"flex space-x-4 mb-6",children:[1,2].map(le=>c.jsxs(Le.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${w===le?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>wt(le),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",le,le===K&&c.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},le))})},[w,wt,I]),b.useCallback(K=>K.reduce((le,be)=>(le[be.student_id]||(le[be.student_id]=[]),le[be.student_id].push(be),le),{}),[]),b.useCallback(K=>{if(K.length===0)return 0;const le=K.reduce((be,pe)=>be+(pe.percentage||0),0);return Math.round(le/K.length)},[]),b.useCallback(K=>{K.score<K.passing_score&&window.confirm("Give another try?")&&Jt(K.student_id,K.test_id)},[]);const Jt=b.useCallback(async(K,le)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:K,testId:le})})).ok&&(V&&wt(w),i("Test made accessible to student","success"))}catch(be){console.error("Error resetting test attempt:",be),i("Failed to reset test attempt","error")}},[V,w,wt,i]),dr=b.useCallback((K,le)=>{if(K===null||le===null)return"";const be=Math.round(K/le*100);return be>=80?"text-green-600 bg-green-50":be>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),zt=b.useCallback(K=>{Ft(K),Pe(!0)},[]);b.useCallback((K,le,be)=>{$e({resultId:K,score:le,maxScore:be}),Ge((le==null?void 0:le.toString())||""),Nt((be==null?void 0:be.toString())||""),et(!0)},[]),b.useCallback(K=>{Ge(K)},[]),b.useCallback(K=>{Nt(K)},[]),b.useCallback(async()=>{if(Re){Ve(!0);try{const K={resultId:Re.resultId,score:parseInt(Be)||0,maxScore:parseInt(ht)||1};(await fetch(l8.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)})).ok?(i("Score updated successfully","success"),V&&wt(w),$e(null),Ge(""),Nt(""),et(!1)):i("Failed to update score","error")}catch(K){console.error("Error updating score:",K),i("Failed to update score","error")}finally{Ve(!1)}}},[Re,Be,ht,V,w,wt,i]),b.useCallback(()=>{$e(null),Ge(""),Nt(""),et(!1)},[]);const er=(K,le)=>{if(console.log(" Starting column editing for drawing test:",K),console.log(" Current editingColumns before update:",Array.from(nt)),console.log(" Results data passed to function:",le),gt(be=>{const pe=new Set(be).add(K);return console.log(" Updated editingColumns:",Array.from(pe)),pe}),console.log(" Initializing column scores for test:",K),console.log(" Results data:",le),console.log(" Results.class:",le?le.class:"null"),le&&le.class){const be={};console.log(" Processing",le.class.length,"students"),le.class.forEach((pe,Te)=>{console.log(` Student ${Te}:`,pe.student_id,"Keys:",Object.keys(pe));const B=pe[K];console.log(` Student ${pe.student_id} test result for ${K}:`,B),console.log(" Test result keys:",B?Object.keys(B):"null"),console.log(" Test result id:",B?B.id:"null"),B&&B.test_type==="drawing"&&(be[pe.student_id]={score:(B.score||0).toString(),maxScore:(B.max_score||100).toString(),resultId:B.id})}),console.log(" Initial scores for column:",be),Ne(pe=>({...pe,[K]:be}))}else console.log(" No results or class data available")},pr=b.useCallback(K=>{gt(le=>{const be=new Set(le);return be.delete(K),be}),Ne(le=>{const be={...le};return delete be[K],be})},[]),_n=b.useCallback((K,le,be,pe)=>{const Te=pe.toString();ut.current[K]||(ut.current[K]={}),ut.current[K][le]||(ut.current[K][le]={}),ut.current[K][le][be]=Te;const B=parseInt(pe)||0;Ne(ie=>{var xe;return{...ie,[K]:{...ie[K],[le]:{...(xe=ie[K])==null?void 0:xe[le],[be]:B}}}})},[]),Z=b.useCallback(async K=>{if(ut.current[K]){Ze(!0);try{const le=Object.entries(ut.current[K]).map(([B,ie])=>({resultId:ie.resultId,score:parseInt(ie.score)||0,maxScore:parseInt(ie.maxScore)||100}));console.log(" Saving column scores for",K,":",le);const be=le.map(B=>(console.log(" Sending update:",B),fetch(l8.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(B)})));(await Promise.all(be)).every(B=>B.ok)?(i(`Scores updated successfully for ${K}`,"success"),V&&wt(w),pr(K)):i("Failed to update some scores","error")}catch(le){console.error("Error updating column scores:",le),i("Failed to update scores","error")}finally{Ze(!1)}}},[Et,V,w,wt,i,pr]),ge=b.useCallback((K,le,be)=>!le||le.length===0?c.jsx(Le.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsxs(Le.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[ne&&c.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),ke&&c.jsx("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),c.jsxs(Le.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[c.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:pe=>{at.current&&(at.current.scrollLeft=pe.target.scrollLeft)},children:c.jsx("div",{className:"min-w-full h-1",children:c.jsx("div",{className:"h-1",style:{width:`${(be.length+5)*120}px`}})})}),c.jsx("div",{ref:at,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:pe=>{de(pe);const Te=pe.target.previousElementSibling;Te&&(Te.scrollLeft=pe.target.scrollLeft)},children:c.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[c.jsx("thead",{children:c.jsxs(Le.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Name"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Surname"}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),be.map((pe,Te)=>{const B=we.has(pe.test_name),ie=pe.test_type==="drawing",xe=ft.current.has(pe.test_name);return console.log(` Rendering test ${pe.test_name}:`,{isDrawingTest:ie,isEditingColumn:xe,editingColumns:Array.from(ft.current),test_type:pe.test_type}),c.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${B?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),console.log(" Clicked on test header:",pe.test_name),ye(pe.test_name)},children:B?c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):c.jsxs("div",{className:"flex flex-col space-y-2",children:[ie&&c.jsx("div",{className:"flex justify-center",children:xe?c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),Z(pe.test_name)},disabled:Ke,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:Ke?c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save"}),c.jsx("button",{onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),pr(pe.test_name)},disabled:Ke,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):c.jsx("button",{onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),console.log(" Edit Column button clicked for drawing test:",pe.test_name),console.log(" Results state at button click:",P),console.log(" Current results ref:",bt.current),er(pe.test_name,bt.current)},className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit Column"})}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("span",{className:"truncate",title:pe.test_name,children:pe.test_name.length>8?pe.test_name.substring(0,8)+"...":pe.test_name}),c.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})},Te)})]})}),c.jsx("tbody",{children:c.jsx(Sa,{children:le.map((pe,Te)=>c.jsxs(Le.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Te%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Te*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[c.jsx(Le.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:pe.student_id}),c.jsx(Le.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:pe.name}),c.jsx(Le.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:pe.surname}),c.jsx(Le.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:pe.number??Te+1}),c.jsx(Le.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:pe.nickname||"-"}),be.map((B,ie)=>{var Ce,Oe,Ie,mt;const xe=we.has(B.test_name),ce=pe[B.test_name];return xe?(console.log(" Rendering collapsed column for test:",B.test_name),c.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),console.log(" Clicked on collapsed arrow for:",B.test_name),ye(B.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},ie)):c.jsx(Le.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:qe=>{if(console.debug("[TeacherResults] Main table TD clicked",{testResult:ce,student:pe.student_id}),ce!=null&&ce.retest_offered){i("Retest is already offered","info");return}const xt=o(ce);xt!==null&&xt<50&&(console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:pe.student_id,test:B}),n({failedStudentIds:[pe.student_id],test_type:B.test_type,original_test_id:(ce==null?void 0:ce.test_id)||B.test_id,subject_id:(ce==null?void 0:ce.subject_id)||B.subject_id}))},children:ce&&ce.test_type==="drawing"?c.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[c.jsx("button",{onClick:()=>zt(ce),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const qe=ft.current.has(B.test_name);return console.log(` Score cell for ${B.test_name}:`,{isEditing:qe,editingColumns:Array.from(ft.current),test_name:B.test_name}),qe})()?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ce.max_score||100,value:((Oe=(Ce=ut.current[B.test_name])==null?void 0:Ce[pe.student_id])==null?void 0:Oe.score)||ce.score||"",onChange:qe=>_n(B.test_name,pe.student_id,"score",qe.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:((mt=(Ie=ut.current[B.test_name])==null?void 0:Ie[pe.student_id])==null?void 0:mt.maxScore)||ce.max_score||100,onChange:qe=>_n(B.test_name,pe.student_id,"maxScore",qe.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log(" Double-clicked on drawing test score:",B.test_name),console.log(" Results state at double-click:",P),console.log(" Current results ref:",bt.current),er(B.test_name,bt.current)},title:"Double-click to edit column",children:[ce.score||0,"/",ce.max_score||100]}),ce.caught_cheating&&ce.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ce.visibility_change_times,")"]})]}):ce&&ce.score!==null&&ce.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const qe=o(ce),xt=qe!==null&&qe<50,Bt=qe!==null&&qe>=50&&qe<70,xr=qe!==null&&qe>=70;console.debug("[TeacherResults] Main table pill",{studentId:pe.student_id,pct:qe,isRed:xt,isYellow:Bt,isGreen:xr,testResult:ce});const $t=qe===null?"text-gray-600":xt?"text-red-600 font-semibold":Bt?"text-yellow-600":"text-green-600",Ht=(ce==null?void 0:ce.retest_offered)===!0;return c.jsxs(Le.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${$t} ${xt?"cursor-pointer hover:opacity-90":""} ${Ht?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:xt?{color:"#b91c1c"}:void 0,whileHover:{scale:xt?1.1:1.05},transition:{duration:.2},onClick:Pt=>{if(Pt.preventDefault(),Pt.stopPropagation(),ce!=null&&ce.retest_offered){i("Retest is already offered","info");return}xt&&(console.debug("[TeacherResults] Main table pill clicked -> opening retest modal",{studentId:pe.student_id,test:B}),n({failedStudentIds:[pe.student_id],test_type:B.test_type,original_test_id:(ce==null?void 0:ce.test_id)||B.test_id,subject_id:(ce==null?void 0:ce.subject_id)||B.subject_id}))},title:Ht?"Retest offered":xt?"Offer retest":"",children:[(()=>{const Pt=ce.retest_best_score??ce.score,jt=ce.retest_best_max_score??ce.max_score;return c.jsxs(c.Fragment,{children:[c.jsx("span",{className:xt?"text-red-700":"",children:Pt}),"/",c.jsx("span",{children:jt})]})})(),ce.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),ce.caught_cheating&&ce.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ce.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},ie)})]},Te))})})]})})]})]}),[dr,we,ye]),oe=b.useCallback((K,le,be)=>!le||le.length===0?c.jsx(Le.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:c.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):c.jsx(Le.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:c.jsx(Le.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:c.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:c.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[c.jsx("thead",{children:c.jsxs(Le.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Name"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Surname"}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),c.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),be.map((pe,Te)=>{const B=pe.test_type==="drawing",ie=ft.current.has(pe.test_name);return c.jsx(Le.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Te*.05},children:c.jsxs("div",{className:"flex flex-col space-y-1",children:[B&&c.jsx("div",{className:"flex justify-center",children:ie?c.jsxs("div",{className:"flex gap-1",children:[c.jsx("button",{onClick:xe=>{xe.preventDefault(),xe.stopPropagation(),Z(pe.test_name)},disabled:Ke,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Ke?"Saving...":"Save"}),c.jsx("button",{onClick:xe=>{xe.preventDefault(),xe.stopPropagation(),pr(pe.test_name)},disabled:Ke,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):c.jsx("button",{onClick:xe=>{xe.preventDefault(),xe.stopPropagation(),er(pe.test_name)},className:"px-1 py-0.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit"})}),c.jsx("span",{className:"text-xs",children:pe.test_name.length>10?pe.test_name.substring(0,10)+"...":pe.test_name})]})},Te)})]})}),c.jsx("tbody",{children:c.jsx(Sa,{children:le.map((pe,Te)=>c.jsxs(Le.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Te%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Te*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[c.jsx(Le.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:pe.student_id}),c.jsx(Le.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:pe.name}),c.jsx(Le.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:pe.surname}),c.jsx(Le.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:pe.number??Te+1}),c.jsx(Le.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:pe.nickname||"-"}),be.map((B,ie)=>{var Ce,Oe,Ie,mt;const xe=we.has(B.test_name),ce=pe[B.test_name];return xe?c.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:c.jsx("div",{className:"flex justify-center",children:c.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:qe=>{qe.preventDefault(),qe.stopPropagation(),ye(B.test_name)},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},ie):c.jsx(Le.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:qe=>{console.debug("[TeacherResults] TD clicked",{testResult:ce,student:pe.student_id});const xt=o(ce);if(xt!==null&&xt<50){if(ce!=null&&ce.retest_offered){i("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:pe.student_id}),n({failedStudentIds:[pe.student_id]})}},children:ce&&ce.score!==null&&ce.score!==void 0?c.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[ce.test_type==="drawing"?c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>zt(ce),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),ft.current.has(B.test_name)?c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx("input",{type:"number",min:"0",max:ce.max_score||100,value:((Oe=(Ce=ut.current[B.test_name])==null?void 0:Ce[pe.student_id])==null?void 0:Oe.score)||ce.score||"",onChange:qe=>_n(B.test_name,pe.student_id,"score",qe.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),c.jsx("span",{className:"text-xs text-gray-500",children:"/"}),c.jsx("input",{type:"number",min:"1",value:((mt=(Ie=ut.current[B.test_name])==null?void 0:Ie[pe.student_id])==null?void 0:mt.maxScore)||ce.max_score||100,onChange:qe=>_n(B.test_name,pe.student_id,"maxScore",qe.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):c.jsxs(Le.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${ce.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>er(B.test_name),title:"Double-click to edit column",children:[ce.score,"/",ce.max_score,ce.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})]}):(()=>{const qe=o(ce),xt=qe!==null&&qe<50,Bt=qe!==null&&qe>=50&&qe<70,xr=qe!==null&&qe>=70;console.debug("[TeacherResults] Render pill",{studentId:pe.student_id,pct:qe,isRed:xt,isYellow:Bt,isGreen:xr,score:ce.score,max:ce.max_score,percentageField:ce.percentage});const Ht=`px-1 py-0.5 rounded text-xs font-medium ${qe===null?"text-gray-600":xt?"text-red-600 font-semibold":Bt?"text-yellow-600":"text-green-600"} ${xt?"cursor-pointer hover:opacity-90 pointer-events-auto":""}`;return console.debug("[TeacherResults] Pill classes",{classNameStr:Ht,pct:qe,isRed:xt,isYellow:Bt,isGreen:xr}),c.jsxs(Le.div,{className:Ht,style:xt?{color:"#b91c1c"}:void 0,whileHover:{scale:xt?1.05:1},transition:{duration:.15},onClick:xt?Pt=>{Pt.preventDefault(),Pt.stopPropagation();const jt=window.getComputedStyle(Pt.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:pe.student_id,className:Ht,computedColor:jt}),n({failedStudentIds:[pe.student_id]})}:void 0,title:xt?"Offer retest":"",children:[c.jsx("span",{className:xt?"text-red-700":"",children:ce.score}),"/",c.jsx("span",{children:ce.max_score}),ce.caught_cheating&&c.jsx("span",{className:"ml-1",children:""})]})})(),ce.caught_cheating&&ce.visibility_change_times&&c.jsxs("span",{className:"text-xs text-red-600",children:["(",ce.visibility_change_times,")"]})]}):c.jsx("span",{className:"text-gray-400",children:"-"})},ie)})]},Te))})})]})})})}),[dr,we,ye]),ue=b.useCallback(()=>{var be;if(!P)return null;console.log(" renderResults - results:",P),console.log(" renderResults - results.class:",P.class),console.log(" renderResults - results.unique_tests:",P.unique_tests);const K=P.class&&Array.isArray(P.class)&&P.class.length>0;if(console.log(" renderResults - hasStudentData:",K),!K)return console.log(" renderResults - No student data, showing no students message"),c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const le=P.unique_tests||[];return console.log(" renderResults - uniqueTests:",le),bt.current=P,c.jsxs("div",{className:"space-y-6",children:[c.jsxs(Le.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[c.jsxs(Le.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",H,", Class ",H,"/",V,", Semester ",w]}),c.jsxs(Le.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",((be=P.subjects)==null?void 0:be.length)||0," subject(s)"]}),c.jsxs(Le.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[c.jsx("button",{onClick:()=>{var Te;const pe=((Te=P.unique_tests)==null?void 0:Te.map(B=>B.test_name))||[];Fe(new Set(pe))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),c.jsx("button",{onClick:()=>Fe(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),c.jsxs(Le.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[c.jsx(Le.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),c.jsx("div",{className:"hidden md:block",children:ge("All Subjects",P.class,le)}),c.jsx("div",{className:"md:hidden",children:oe("All Subjects",P.class,le)})]})]})},[P,ge,H,V,w]),me=b.useCallback(()=>{if(!P||!P.class||!P.unique_tests)return;const K=["Student ID","Name","Surname","No.","Nickname",...P.unique_tests.map(ie=>ie.test_name)],le=P.class.map((ie,xe)=>{const ce=[];return ce.push(ie.student_id),ce.push(ie.name),ce.push(ie.surname),ce.push(ie.number??xe+1),ce.push(ie.nickname||"-"),P.unique_tests.forEach(Ce=>{const Oe=ie[Ce.test_name];Oe&&Oe.score!==null&&Oe.score!==void 0?ce.push(`${Oe.score}/${Oe.max_score}`):ce.push("-")}),ce}),be=zx.aoa_to_sheet([K,...le]),pe=zx.book_new(),Te=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...P.unique_tests.map(()=>({wch:15}))];be["!cols"]=Te,zx.book_append_sheet(pe,be,"Class Results");const B=`class-results-${H}-${V}-semester-${w}.xlsx`;pge(pe,B),i("Excel file exported successfully!","success")},[P,H,V,w,i]);return d?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):h?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:h}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsx("div",{className:"flex justify-between items-center py-4",children:c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",se?se.toLocaleString():"Never"]})]})})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),E.length>0?c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:E.map((K,le)=>c.jsxs(Ue,{variant:H===K.grade&&V===K.class?"primary":"outline",onClick:()=>yt(K.grade,K.class),className:"w-full",children:[K.grade,"/",K.class]},`${K.grade}-${K.class}-${le}`))}):c.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),V&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Select Semester for ",H,"/",V]}),c.jsx("div",{className:"flex space-x-4",children:[1,2].map(K=>{let le=1;if(I&&I.length>0){const be=new Date;for(const pe of I){const Te=new Date(pe.start_date),B=new Date(pe.end_date);if(be>=Te&&be<=B){le=pe.semester;break}}}return c.jsxs(Le.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${w===K?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>wt(K),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",K,K===le&&c.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},K)})})]}),V&&P&&c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[H," ",V," - Test Results (Semester ",w,")"]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:me,children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),c.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),ue()]}),V&&!P&&c.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:c.jsx("div",{className:"text-center py-8",children:c.jsx("p",{className:"text-gray-500",children:"No test results available for this class and semester."})})})]})}),Me&&c.jsx(GM,{drawing:Me,isOpen:Ut,onClose:()=>Pe(!1),isTeacherView:!0})]})},Aj=({onBackToLogin:t})=>{const e=Xa(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=vn(),{teacherData:i,loadTeacherData:o}=Bv(),{activeTests:l,loadActiveTests:u}=jm(),{showNotification:d,notifications:g}=qs(),[h,p]=b.useState(!0),[x,v]=b.useState(""),[w,S]=b.useState("main"),[_,y]=b.useState([]),[k,N]=b.useState([]),[E,A]=b.useState(null),[C,F]=b.useState(null),[P,M]=b.useState(null),[I,Y]=b.useState(!1),[se,L]=b.useState(!1),[z,G]=b.useState(null),[O,R]=b.useState(!1),[X,te]=b.useState(null),[H,V]=b.useState(!1),[q,Q]=b.useState(null),[ae,J]=b.useState(null),[re,ve]=b.useState([]),[we,Fe]=b.useState(!1),[ne,Ee]=b.useState(null),[ke,He]=b.useState({}),[at,Me]=b.useState(!1),[Ft,Ut]=b.useState(!1),[Pe,Re]=b.useState(0),[$e,Be]=b.useState(!1),[Ge,ht]=b.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Nt,Ye]=b.useState([]),[Ve,ot]=b.useState([]),[et,nt]=b.useState(!1),[gt,Et]=b.useState(null),[Ne,Ke]=b.useState([]),[Ze,ft]=b.useState(!1),[ut,bt]=b.useState("subject");b.useEffect(()=>{At()},[]),b.useEffect(()=>{const W=_e=>{at&&!_e.target.closest(".relative")&&Me(!1),Ft&&!_e.target.closest(".relative")&&Ut(!1)};return document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[at,Ft]);const ye=b.useCallback(()=>{console.log(" showChangePasswordTab called"),Be(!0),Me(!1),Ut(!1)},[]),de=b.useCallback(()=>{console.log(" hideChangePasswordTab called"),Be(!1),ht({currentPassword:"",newPassword:"",confirmPassword:""})},[]),ee=b.useCallback(async()=>{if(!r)return;const{currentPassword:W,newPassword:_e,confirmPassword:tt}=Ge;if(!W||!_e||!tt){d("Please fill in all fields","error");return}if(_e!==tt){d("New passwords do not match","error");return}if(_e.length<6){d("New password must be at least 6 characters long","error");return}const ct=/[a-zA-Z]/.test(_e),Gt=/[0-9]/.test(_e);if(!ct||!Gt){d("New password must contain both letters and numbers","error");return}try{const nr=await Ur.changePassword({username:r.username,currentPassword:W,newPassword:_e});nr.success?(d("Password changed successfully!","success"),de()):d(nr.message||"Failed to change password","error")}catch(nr){console.error("Password change error:",nr),d("Failed to change password. Please try again.","error")}},[r,Ge,d]),he=b.useCallback(W=>{const{name:_e,value:tt}=W.target;ht(ct=>({...ct,[_e]:tt}))},[]),Ae=b.useCallback(async()=>{console.log(" Loading teacher data...");try{const W=await Ur.getTeacherData();return console.log(" Teacher data loaded:",W),J(new Date),W}catch(W){throw console.error(" Error loading teacher data:",W),W}},[]),st=b.useCallback(async()=>{var W;console.log(" Loading teacher subjects...");try{const _e=`teacher_subjects_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`,tt=zr(_e);if(tt)return console.log(" Using cached teacher subjects"),y(tt),tt;const ct=await Ur.getTeacherData();console.log(" Raw teacher data:",ct);const Gt=Ur.getTeacherSubjects(ct.subjects);return console.log(" Teacher subjects loaded:",Gt),y(Gt),Gr(_e,Gt,Jr.teacher_subjects),console.log(" Available classes for performance chart:",((W=Gt[0])==null?void 0:W.classes)||[]),console.log(" Performance chart will load when user clicks on a class"),Gt}catch(_e){throw console.error(" Error loading teacher subjects:",_e),_e}},[r==null?void 0:r.teacher_id,r==null?void 0:r.id]),rt=b.useCallback(async()=>{console.log(" Loading teacher active tests...");try{const W=`teacher_tests_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`,_e=zr(W);_e&&_e.some(Gt=>Gt.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(W));const tt=zr(W);if(tt)return console.log(" Using cached teacher tests"),N(tt),tt;const ct=await Ar.getTeacherTests();return console.log(" Teacher tests loaded:",ct),N(ct),Gr(W,ct,Jr.teacher_tests),ct}catch(W){throw console.error(" Error loading teacher tests:",W),W}},[r==null?void 0:r.teacher_id,r==null?void 0:r.id]),At=b.useCallback(async()=>{console.log(" Initializing Teacher Cabinet...");try{if(p(!0),v(""),!n||!r){console.log(" User not authenticated"),v("User not authenticated");return}if(r.role!==aa.TEACHER){console.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}console.log(" Loading teacher data..."),await Ae(),console.log(" Loading teacher subjects..."),await st(),console.log(" Loading active tests..."),await rt(),console.log(" Teacher Cabinet initialization complete!")}catch(W){console.error(" Error initializing teacher cabinet:",W),v("Failed to initialize teacher cabinet")}finally{p(!1)}},[n,r,Ae,st,rt]),yt=b.useCallback(()=>{console.log(" Showing subject selection prompt..."),Y(!0),wt(),bt("subject")},[]),wt=b.useCallback(async()=>{console.log(" Loading available subjects..."),nt(!0);try{const W=await Ur.getSubjectsForSelection();Ye(W),console.log(" Available subjects loaded:",W)}catch(W){console.error(" Error loading available subjects:",W),d("Failed to load subjects","error")}finally{nt(!1)}},[]),Jt=b.useCallback(W=>{if(!W){Et(null);return}const _e=Nt.find(tt=>tt.subject_id==W);_e&&(Et(_e),Ke([]),bt("classes"))},[Nt]),dr=b.useCallback((W,_e)=>{Ke(tt=>tt.some(ct=>ct.grade===W&&ct.class===_e)?tt.filter(ct=>!(ct.grade===W&&ct.class===_e)):[...tt,{grade:W,class:_e}])},[]),zt=b.useCallback(()=>{if(!gt||Ne.length===0){d("Please select at least one class","warning");return}const W={subject_id:parseInt(gt.subject_id),subject_name:gt.subject,classes:Ne};ot(_e=>[..._e,W]),Et(null),Ke([]),bt("subject"),d(`Added ${gt.subject} with ${Ne.length} classes`,"success")},[gt,Ne]),er=b.useCallback(W=>{ot(_e=>_e.filter((tt,ct)=>ct!==W))},[]),pr=b.useCallback(async(W,_e,tt)=>{console.log(" Deleting teacher subject:",{subjectId:W,grade:_e,classNumber:tt});try{const ct={subjectId:W,grade:_e,class:tt};console.log(" Sending delete request with data:",ct);const Gt=await Ur.deleteTeacherSubject(ct);if(Gt.success)d("Subject assignment deleted successfully!","success"),await st();else throw new Error(Gt.error||"Failed to delete subject assignment")}catch(ct){console.error(" Error deleting subject assignment:",ct),d("Error deleting subject assignment. Please try again.","error")}},[st,d]),_n=b.useCallback((W,_e,tt,ct)=>{Q({subjectId:W,subjectName:_e,grade:tt,classNumber:ct}),V(!0)},[]),Z=b.useCallback(async()=>{q&&(await pr(q.subjectId,q.grade,q.classNumber),V(!1),Q(null))},[q,pr]),ge=b.useCallback(()=>{V(!1),Q(null)},[]),oe=b.useCallback(async()=>{if(Ve.length===0){d("Please select at least one subject","warning");return}try{const W=await Ur.saveTeacherSubjects(Ve);if(W.success)d("Subjects saved successfully!","success"),Y(!1),ot([]),bt("subject"),await st();else throw new Error(W.error||"Failed to save subjects")}catch(W){console.error(" Error saving teacher subjects:",W),d("Failed to save subjects","error")}},[Ve,st]);b.useCallback(async W=>{console.log(" Saving teacher subjects:",W);try{const _e=await Ur.saveTeacherSubjects(W);if(_e.success)d("Subjects saved successfully!","success"),await st(),Y(!1);else throw new Error(_e.error||"Failed to save subjects")}catch(_e){console.error(" Error saving teacher subjects:",_e),d("Failed to save subjects","error")}},[st]);const ue=b.useCallback(()=>{console.log(" Showing active tests..."),S("tests")},[]),me=b.useCallback(W=>{console.log(" Showing test details:",W),G(W),L(!0)},[]);b.useCallback(async(W,_e,tt)=>{console.log(" Removing class assignment:",W,_e,tt);try{const ct=await Ar.removeClassAssignment(W,_e,tt);if(ct.success)d("Assignment removed successfully!","success"),await rt();else throw new Error(ct.error||"Failed to remove assignment")}catch(ct){console.error(" Error removing class assignment:",ct),d("Failed to remove assignment","error")}},[rt]);const K=b.useCallback(async(W,_e)=>{console.log(" Marking test as completed:",W,_e);try{const tt=await Ar.markTestCompleted(W,_e);if(tt.success){d("Test marked as completed!","success");const ct=`teacher_tests_${(r==null?void 0:r.teacher_id)||(r==null?void 0:r.id)||""}`;localStorage.removeItem(ct),console.log(" Cleared teacher tests cache"),await rt()}else throw new Error(tt.error||"Failed to mark test as completed")}catch(tt){console.error(" Error marking test as completed:",tt),d("Failed to mark test as completed","error")}},[rt,d,r==null?void 0:r.teacher_id,r==null?void 0:r.id]),le=b.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await rt(),d("Tests refreshed successfully!","success")}catch(W){console.error(" Error refreshing tests:",W),d("Failed to refresh tests","error")}},[rt]),[be,pe]=b.useState(!1),Te=b.useCallback(async W=>{console.log(" Loading performance data for class:",W),console.log(" Current selectedClassForChart:",ne);try{pe(!0);const[_e,tt]=W.split("/"),ct=_e.startsWith("M")?_e:`M${_e}`,Gt=`class_summary_${r.teacher_id}_${ct}_${tt}_${ba.CURRENT_ACADEMIC_YEAR}_${ba.CURRENT_SEMESTER}`,nr=zr(Gt);if((nr?Date.now()-nr.timestamp:1/0)>36e5)try{await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/refresh-class-summary-semester")}catch(cn){console.warn("Materialized view refresh failed (continuing):",cn.message)}const Ya=await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary-semester?teacher_id=${r.teacher_id}&grade=${ct}&class=${tt}&semester=${ba.CURRENT_SEMESTER}&academic_year=${ba.CURRENT_ACADEMIC_YEAR}`);console.log(" API response status:",Ya.status);const ha=await Ya.json();if(console.log(" Performance API response:",ha),console.log(" API success:",ha.success),console.log(" API summary:",ha.summary),ha.success&&ha.summary){console.log(" Processing semester performance data:",ha.summary);const cn=ha.summary;console.log(" Semester summary:",{total_students:cn.total_students,total_tests:cn.total_tests,completed_tests:cn.completed_tests,average_class_score:cn.average_class_score,pass_rate:cn.pass_rate,cheating_incidents:cn.cheating_incidents});const ga={summary:cn,semester:ba.CURRENT_SEMESTER,academicYear:ba.CURRENT_ACADEMIC_YEAR,overallAverage:cn.average_class_score||0,totalTests:cn.total_tests||0,completedTests:cn.completed_tests||0,passRate:cn.pass_rate||0,cheatingIncidents:cn.cheating_incidents||0,lastTestDate:cn.last_test_date,semesterProgress:B(cn)};console.log(" Semester performance data:",ga),He(Yv=>({...Yv,[W]:ga}))}else console.log(" No performance data available for class:",W),He(cn=>({...cn,[W]:{tests:[],overallAverage:0}}))}catch(_e){console.error(" Error loading performance data:",_e),console.error(" Error details:",_e.message),He(tt=>({...tt,[W]:{tests:[],overallAverage:0}}))}finally{pe(!1)}},[r]),B=b.useCallback(W=>{if(!W.last_test_date)return 0;const _e=new Date("2025-05-01"),tt=new Date("2025-09-30"),ct=new Date,Gt=tt-_e,nr=Math.min(ct-_e,Gt);return Math.round(nr/Gt*100)},[]);b.useCallback((W,_e)=>{console.log(" Showing class results:",W,_e),console.log(" Class click - grade:",W,"className:",_e),F(W),M(_e),S("results");const tt=`${W}/${_e}`;console.log(" Loading performance data for clicked class:",tt),Ee(tt),Te(tt)},[Te]);const[ie,xe]=b.useState([]),[ce,Ce]=b.useState([]),Oe=b.useCallback(async()=>{try{const _e=await(await Cu(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);xe(_e)}catch(W){console.warn("Failed to load retests",W)}},[r]);b.useCallback(async W=>{try{const tt=await(await Cu(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(W);Ce(tt)}catch(_e){console.warn("Failed to load retest targets",_e)}},[]);const[Ie,mt]=b.useState(!1);b.useEffect(()=>{console.debug("[TeacherCabinet] showRetestModal state changed:",Ie)},[Ie]);const[qe,xt]=b.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),Bt=b.useCallback(async W=>{console.debug("[TeacherCabinet] openRetestModal called with:",W);const{test_type:_e,original_test_id:tt,subject_id:ct,failedStudentIds:Gt=[]}=W||{};xt({test_type:_e||"multiple_choice",original_test_id:tt||"",subject_id:ct||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:Gt}),console.debug("[TeacherCabinet] Setting showRetestModal to true"),mt(!0)},[]),xr=b.useCallback(async()=>{try{const W=await Cu(()=>import("./retestService-C6b0YDiD.js"),[]),_e=new Date,tt=new Date(_e.getTime()+qe.window_days*24*60*60*1e3),ct={...qe,grade:C,class:P,window_start:_e.toISOString(),window_end:tt.toISOString()};await W.retestService.createRetestAssignment(ct),d("Retest created","success"),mt(!1),Oe(),Re(Gt=>Gt+1)}catch(W){console.error("Create retest error",W),d(W.message||"Failed to create retest","error")}},[qe,C,P,Oe]),$t=b.useCallback(W=>{var ct,Gt;if(!W)return c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"Click on a class to view performance data"})]});const tt=(ke[W]||{}).summary;return tt?c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[c.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[((ct=tt.average_class_score)==null?void 0:ct.toFixed(1))||0,"%"]}),c.jsx("div",{className:"text-sm text-blue-600",children:"Class Average"})]}),c.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-green-600",children:tt.total_tests||0}),c.jsx("div",{className:"text-sm text-green-600",children:"Total Tests"})]}),c.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[c.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[((Gt=tt.pass_rate)==null?void 0:Gt.toFixed(1))||0,"%"]}),c.jsx("div",{className:"text-sm text-purple-600",children:"Pass Rate"})]}),c.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-3xl font-bold text-red-600",children:tt.cheating_incidents||0}),c.jsx("div",{className:"text-sm text-red-600",children:"Cheating Incidents"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:tt.completed_tests||0}),c.jsx("div",{className:"text-sm text-yellow-600",children:"Completed Tests"})]}),c.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:tt.highest_score||0}),c.jsx("div",{className:"text-sm text-indigo-600",children:"Highest Score"})]}),c.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[c.jsx("div",{className:"text-2xl font-bold text-pink-600",children:tt.total_students||0}),c.jsx("div",{className:"text-sm text-pink-600",children:"Total Students"})]})]}),be&&c.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-xs text-center",children:[c.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-gray-300 border-t-transparent rounded-full mx-auto mb-2"}),c.jsx("div",{className:"text-sm text-gray-700",children:"Loading latest class summary..."})]})})]}):c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"No performance data available for this class"})]})},[ke]);if(h)return c.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),c.jsx("div",{className:"flex flex-wrap gap-2"})]});if(x)return c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:x}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return c.jsxs(Le.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Le.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-6",children:[c.jsxs(Le.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),c.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),c.jsxs(Le.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsx("div",{className:"hidden md:block",children:c.jsxs("div",{className:"relative",children:[c.jsxs("button",{onClick:()=>Me(!at),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[c.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),c.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:at?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),at&&c.jsxs(Le.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[c.jsxs("button",{onClick:()=>{Me(!1),ye()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:()=>{Me(!1),t?t():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})]})]})}),c.jsxs("div",{className:"md:hidden",children:[c.jsx("button",{onClick:()=>Ut(!Ft),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:c.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Ft&&c.jsxs(Le.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[c.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[c.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),c.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),c.jsxs("button",{onClick:()=>{Ut(!1),ye()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),c.jsx("span",{children:"Change Password"})]}),c.jsxs("button",{onClick:()=>{Ut(!1),t?t():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),c.jsx("span",{children:"Logout"})]})]})]})]})]})})}),c.jsx(Le.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:c.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:c.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((W,_e)=>c.jsxs(Le.button,{onClick:()=>W.key==="tests"?ue():S(W.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 ${w===W.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+_e*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[c.jsx("span",{className:"sm:hidden",children:W.shortLabel}),c.jsx("span",{className:"hidden sm:inline",children:W.label})]},W.key))})})}),c.jsx(Le.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:c.jsxs(Sa,{mode:"wait",children:[w==="main"&&c.jsx(Le.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Ht()},"main"),w==="subjects"&&c.jsx(Le.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Pt()},"subjects"),w==="tests"&&c.jsx(Le.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:jt()},"tests"),w==="results"&&c.jsx(Le.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:c.jsx(rL,{selectedGrade:C,selectedClass:P,onBackToCabinet:()=>S("main"),openRetestModal:Bt},Pe)},"results")]})}),I&&c.jsx(Hi,{isOpen:I,onClose:()=>{Y(!1),bt("subject"),ot([]),Et(null),Ke([])},title:"Select Subjects and Classes",size:"large",children:c.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[ut==="subject"&&c.jsxs(Le.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),et?c.jsxs("div",{className:"flex items-center justify-center py-8",children:[c.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),c.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):c.jsxs("select",{value:(gt==null?void 0:gt.subject_id)||"",onChange:W=>Jt(W.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"Select a subject"}),Nt.map(W=>c.jsx("option",{value:W.subject_id,children:W.subject},W.subject_id))]})]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(Ue,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),c.jsx(Ue,{variant:"primary",onClick:()=>bt("classes"),disabled:!gt,children:"Next: Select Classes"})]})]}),ut==="classes"&&gt&&c.jsxs(Le.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",gt.subject]}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),c.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:c.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6].map(W=>c.jsxs("div",{className:"space-y-2",children:[c.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",W]}),c.jsx("div",{className:"space-y-1",children:[15,16].map(_e=>c.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[c.jsx("input",{type:"checkbox",checked:Ne.some(tt=>tt.grade===W.toString()&&tt.class===_e.toString()),onChange:()=>dr(W.toString(),_e.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),c.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",_e]})]},_e))})]},W))})})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(Ue,{variant:"outline",onClick:()=>bt("subject"),children:"Back to Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(Ue,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),c.jsx(Ue,{variant:"primary",onClick:zt,disabled:Ne.length===0,children:"Add Subject"})]})]})]}),Ve.length>0&&c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),c.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Ve.map((W,_e)=>c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-900",children:W.subject_name}),c.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",W.classes.map(tt=>`Grade ${tt.grade} Class ${tt.class}`).join(", ")]})]}),c.jsx("button",{onClick:()=>er(_e),className:"text-red-600 hover:text-red-800 p-1",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},_e))})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx(Ue,{variant:"outline",onClick:()=>bt("subject"),children:"Add More Subjects"}),c.jsxs("div",{className:"space-x-3",children:[c.jsx(Ue,{variant:"outline",onClick:()=>Y(!1),children:"Cancel"}),c.jsx(Ue,{variant:"primary",onClick:oe,children:"Save All Subjects"})]})]})]})]})}),Ie&&c.jsxs(Hi,{isOpen:Ie,onClose:()=>mt(!1),title:"Create Retest",size:"medium",children:[c.jsx("div",{className:"space-y-4",children:c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),c.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:qe.window_days,onChange:W=>xt(_e=>({..._e,window_days:Number(W.target.value)})),children:[c.jsx("option",{value:1,children:"1 day"}),c.jsx("option",{value:2,children:"2 days"}),c.jsx("option",{value:3,children:"3 days"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),c.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:qe.max_attempts,onChange:W=>xt(_e=>({..._e,max_attempts:Number(W.target.value)})),children:[c.jsx("option",{value:1,children:"1 attempt"}),c.jsx("option",{value:2,children:"2 attempts"}),c.jsx("option",{value:3,children:"3 attempts"})]}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),c.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[c.jsx("button",{onClick:()=>mt(!1),className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50",children:"Cancel"}),c.jsx("button",{onClick:xr,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Create Retest"})]})]}),se&&z&&c.jsxs(Hi,{isOpen:se,onClose:()=>L(!1),title:"Test Details",size:"large",children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:z.test_name})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),c.jsx("p",{className:"text-sm text-gray-900",children:z.subject})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),c.jsx("p",{className:"text-sm text-gray-900",children:z.test_type})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),c.jsx("p",{className:"text-sm text-gray-900",children:new Date(z.created_at).toLocaleDateString()})]})]}),c.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:c.jsx(Ue,{variant:"outline",onClick:()=>L(!1),children:"Close"})})]}),H&&q&&c.jsx(Hi,{isOpen:H,onClose:ge,title:"Delete Subject Assignment",size:"small",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:c.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),c.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",c.jsx("span",{className:"font-semibold text-gray-900",children:q.subjectName})," ","in Grade ",q.grade,", Class ",q.classNumber,"?"]}),c.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx(Ue,{variant:"outline",onClick:ge,children:"Cancel"}),c.jsx(Ue,{variant:"danger",onClick:Z,children:"Delete Assignment"})]})]})}),c.jsx(Le.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:g.map(W=>c.jsx(Le.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:c.jsx("div",{className:`p-4 rounded-lg shadow-lg ${W.type==="success"?"bg-green-600 text-white":W.type==="error"?"bg-red-600 text-white":W.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{children:W.message}),c.jsx("button",{onClick:()=>setNotifications(_e=>_e.filter(tt=>tt.id!==W.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},W.id))}),$e&&c.jsx(Hi,{isOpen:$e,onClose:de,title:"Change Password",size:"sm",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),c.jsx("input",{type:"password",name:"currentPassword",value:Ge.currentPassword,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),c.jsx("input",{type:"password",name:"newPassword",value:Ge.newPassword,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),c.jsx("input",{type:"password",name:"confirmPassword",value:Ge.confirmPassword,onChange:he,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),c.jsxs("div",{className:"flex space-x-3 pt-4",children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:de,className:"flex-1",children:"Cancel"}),c.jsx(Ue,{type:"button",onClick:ee,className:"flex-1",children:"Change Password"})]})]})})]});function Ht(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsxs(it,{children:[c.jsx(it.Header,{children:c.jsx(it.Title,{children:"My Subjects & Classes"})}),c.jsx(it.Body,{children:_.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),c.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),c.jsx(Ue,{variant:"outline",onClick:()=>S("subjects"),children:"Manage Subjects"})]}):c.jsx("div",{className:"space-y-6",children:_.map((W,_e)=>{var tt;return c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+_e*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:W.name}),c.jsxs("span",{className:"text-sm text-gray-500",children:[((tt=W.classes)==null?void 0:tt.length)||0," classes"]})]}),W.classes&&W.classes.length>0?c.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:W.classes.map((ct,Gt)=>c.jsx(Le.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+_e*.1+Gt*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:c.jsxs(Ue,{variant:"outline",size:"sm",onClick:()=>{F(ct.grade),M(ct.class),S("results")},className:"font-medium",children:[ct.grade,"/",ct.class]})},Gt))}):c.jsx("div",{className:"text-center py-4 text-gray-500",children:c.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},W.id)})})})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:c.jsxs(it,{children:[c.jsxs(it.Header,{children:[c.jsx(it.Title,{children:"Test Performance Overview"}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Average scores across all tests by class"})]}),c.jsx(it.Body,{children:_.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),c.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):c.jsxs("div",{className:"space-y-4",children:[c.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const W=[];return _.forEach(_e=>{_e.classes&&_e.classes.forEach(tt=>{const ct=`${tt.grade}/${tt.class}`;W.find(Gt=>Gt.key===ct)||W.push({key:ct,grade:tt.grade,class:tt.class,subject:_e.name})})}),W})().map((W,_e)=>c.jsxs("button",{onClick:()=>{console.log(" Class button clicked:",W.key),Ee(W.key),Te(W.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${ne===W.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[W.grade,"/",W.class]},W.key))}),c.jsx("div",{className:"mt-4",children:$t(ne)})]})})]})})]})}function Pt(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(it,{children:c.jsx(it.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(it.Title,{children:"Subject Management"}),c.jsx(Ue,{variant:"primary",onClick:yt,children:"Add Subject"})]})})})}),_.length===0?c.jsx(Le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(it,{children:c.jsx(it.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(Le.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),c.jsx(Ue,{variant:"primary",onClick:yt,size:"lg",children:"Add Your First Subject"})]})})})}):c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:c.jsxs(it,{children:[c.jsx(it.Header,{children:c.jsx(it.Title,{children:"Your Subjects"})}),c.jsx(it.Body,{children:c.jsx("div",{className:"space-y-4",children:_.map((W,_e)=>{var tt;return c.jsx(Le.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+_e*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:c.jsx("div",{className:"flex justify-between items-start",children:c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:W.name}),c.jsx("div",{className:"flex flex-wrap gap-2",children:((tt=W.classes)==null?void 0:tt.map((ct,Gt)=>c.jsxs(Le.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+_e*.1+Gt*.05,duration:.2},whileHover:{scale:1.1},children:[c.jsxs("span",{children:[ct.grade," - ",ct.className]}),c.jsx("button",{onClick:()=>_n(W.id,W.name,ct.grade,ct.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:c.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Gt)))||c.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},_e)})})})]})})]})}function jt(){return c.jsxs("div",{className:"space-y-8",children:[c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:c.jsx(it,{children:c.jsx(it.Header,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx(it.Title,{children:"Active Tests"}),c.jsxs("div",{className:"flex gap-3",children:[c.jsx(Ue,{variant:"outline",onClick:le,children:"Refresh"}),c.jsx(Ue,{variant:"primary",onClick:()=>e("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),k.length===0?c.jsx(Le.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:c.jsx(it,{children:c.jsx(it.Body,{children:c.jsxs("div",{className:"text-center p-12",children:[c.jsx(Le.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),c.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),c.jsx(Ue,{variant:"primary",onClick:()=>e("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:k.map((W,_e)=>{var tt,ct,Gt;return c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+_e*.1,duration:.3},whileHover:{scale:1.01},children:c.jsx(it,{children:c.jsx(it.Body,{children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:W.test_name}),c.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:W.test_type}),c.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Assignments:"}),c.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:((tt=W.assignments)==null?void 0:tt.length)||0})]}),W.assignments&&W.assignments.length>0&&c.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[c.jsx("span",{className:"font-medium",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1",children:W.assignments.map((nr,bn)=>c.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[nr.grade,"/",nr.class]},bn))})]}),c.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(W.created_at).toLocaleDateString()})]})]}),c.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[c.jsx("div",{className:"sm:hidden",children:c.jsx(Ue,{variant:"outline",onClick:()=>me(W),size:"sm",className:"text-xs",title:`Assignments: ${((ct=W.assignments)==null?void 0:ct.length)||0} | Classes: ${((Gt=W.assignments)==null?void 0:Gt.map(nr=>`${nr.grade}/${nr.class}`).join(", "))||"None"} | ${new Date(W.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),c.jsx("div",{className:"hidden sm:block",children:c.jsx(Ue,{variant:"outline",onClick:()=>me(W),size:"sm",children:"Details"})}),c.jsx(Ue,{variant:"success",onClick:()=>K(W.test_type,W.test_id),size:"sm",children:"Complete"})]})]})})})},_e)})})]})}},Ege={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks"},jj=()=>{var be,pe,Te;const{user:t}=vn();wre();const{notifications:e,showNotification:r,removeNotification:n}=qs(),[s,a]=b.useState(!1),[i,o]=b.useState(!1),[l,u]=b.useState("typeSelection"),[d,g]=b.useState(!1),[h,p]=b.useState(null),[x,v]=b.useState([]),[w,S]=b.useState(!1),[_,y]=b.useState(!1),[k,N]=b.useState(!1),[E,A]=b.useState(!1),[C,F]=b.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[P,M]=b.useState([]),[I,Y]=b.useState(null);b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null),b.useRef(null);const se=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),te(),console.log(" Test creation initialization complete")},[t,r]),L=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),z(),u("typeSelection"),O("testTypeSelection")},[t,r]),z=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),g(!0)},[t]),G=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),g(!1)},[t]),O=b.useCallback(async B=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",B),console.log("  Call stack:",new Error().stack);const ie={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},xe={isInTestCreation:!0,currentStep:B,timestamp:Date.now(),excelState:ie};localStorage.setItem("test_creation_state",JSON.stringify(xe)),console.log(" Saved test creation state:",xe);const ce={};switch(B){case"testTypeSelection":break;case"multipleChoiceForm":ce.testName=C.testName||"",ce.numQuestions=C.numQuestions||"",ce.numOptions=C.numOptions||"",ce.questions=C.questions||{};break;case"trueFalseForm":ce.testName=C.testName||"",ce.numQuestions=C.numQuestions||"",ce.questions=C.questions||{};break;case"inputForm":ce.testName=C.testName||"",ce.numQuestions=C.numQuestions||"",ce.questions=C.questions||{};break;case"formCreation":ce.testName=C.testName||"",ce.numQuestions=C.numQuestions||"",ce.numOptions=C.numOptions||"",ce.questions=C.questions||{},ce.enableTimer=!!C.enableTimer,ce.timerMinutes=C.timerMinutes||"",ce.isShuffled=!!C.isShuffled;break;case"assignment":case"testAssignment":ce.testName=C.testName||"",ce.numQuestions=C.numQuestions||"",ce.numOptions=C.numOptions||"",ce.questions=C.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",B);break}Object.keys(ce).length>0&&(localStorage.setItem(`form_data_${B}`,JSON.stringify(ce)),console.log(" Saved form data for step:",B,ce))},[t,C]),R=b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const B=[];for(let ie=0;ie<localStorage.length;ie++){const xe=localStorage.key(ie);xe&&(xe.includes("test")||xe.includes("form")||xe.includes("question"))&&B.push(xe)}B.forEach(ie=>{localStorage.removeItem(ie),console.log(" Removed localStorage key:",ie)}),console.log(" Cleared test creation state from localStorage")},[t]);b.useCallback(async()=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),F({testName:"",numQuestions:0,numOptions:0,questions:{}}),p(null),M([]),Y(null),console.log(" Cleared all test form fields")},[t]);const X=b.useCallback(()=>{console.log(" Resetting Excel upload state..."),nt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(ie=>{const xe=document.querySelector(`.excel-upload-btn[data-test-type="${ie}"]`);xe&&(xe.style.display="none",console.log(" Excel button hidden for:",ie));const ce=document.querySelector(`.excel-hint[data-test-type="${ie}"]`);ce&&(ce.style.display="none",console.log(" Excel hint hidden for:",ie));const Ce=document.querySelector(`.excel-file-input[data-test-type="${ie}"]`);Ce&&(Ce.value="",console.log(" File input cleared for:",ie))}),console.log(" Excel upload state reset complete")},[]),te=b.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(ie=>{const xe=document.getElementById(ie);xe&&xe.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${ie}`)})}),console.log(" Form auto-save setup complete")},[]);b.useCallback(async B=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",B),console.log("  Call stack:",new Error().stack);const ie={};switch(B){case"testTypeSelection":break;case"multipleChoiceForm":ie.testName=C.testName||"",ie.numQuestions=C.numQuestions||"",ie.numOptions=C.numOptions||"",ie.questions=C.questions||{};break;case"trueFalseForm":ie.testName=C.testName||"",ie.numQuestions=C.numQuestions||"",ie.questions=C.questions||{};break;case"inputForm":ie.testName=C.testName||"",ie.numQuestions=C.numQuestions||"",ie.questions=C.questions||{};break;case"formCreation":ie.testName=C.testName||"",ie.numQuestions=C.numQuestions||"",ie.numOptions=C.numOptions||"",ie.questions=C.questions||{};break;default:console.log(" Unknown step for form data save:",B);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:B,data:ie,timestamp:Date.now()})),console.log(" Saved form data for step:",B,ie)},[t,C]);const H=b.useCallback(async B=>{console.log(" Restoring form data for step:",B);try{const ie=localStorage.getItem(`form_data_${B}`);if(ie){const xe=JSON.parse(ie);console.log(" Restored form data:",xe),F(ce=>{const Ce={...ce,...xe};return console.log(" Updated formData with restored data:",Ce),console.log(" Matching test data in restored data:",Ce.matchingTestData),Ce}),Object.keys(xe).forEach(ce=>{const Ce=document.getElementById(ce);Ce&&xe[ce]!==void 0&&(Ce.value=xe[ce])}),console.log(" Form data restored for step:",B)}else console.log(" No saved data found for step:",B)}catch(ie){console.error(" Error restoring form data:",ie)}},[t]),V=b.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(xe=>{const ce=document.getElementById(xe);ce&&ce.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${xe}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(xe=>{xe.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),q=b.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(ie=>{ie.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),Q=b.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(ie=>{ie.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),ae=b.useCallback(B=>{console.log(" showExcelUploadButton called with testType:",B);const ie=B==="multiple-choice"?"multipleChoice":B==="true-false"?"trueFalse":B==="input"?"input":B;nt(xe=>({...xe,[ie]:{...xe[ie],buttonVisible:!0}}))},[]),J=b.useCallback(B=>{console.log(" showExcelHint called with testType:",B);const ie=B==="multiple-choice"?"multipleChoice":B==="true-false"?"trueFalse":B==="input"?"input":B;nt(xe=>({...xe,[ie]:{...xe[ie],hintVisible:!0}}))},[]),re=b.useCallback(async(B,ie,xe)=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:B,testType:ie,testId:xe}),v(B),console.log(" Test assignment options displayed for:",{testType:ie,testId:xe,classesCount:B.length})},[t]),ve=b.useCallback(async(B,ie)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!t||!t.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",t.teacher_id);const ce=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${t.teacher_id}`)).json();console.log("Teacher subjects response:",ce),ce.success&&ce.subjects&&ce.subjects.length>0?(console.log("Teacher subjects loaded:",ce.subjects),v(ce.subjects),re(ce.subjects,B,ie)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(xe){console.error("Error loading teacher grades and classes:",xe),r("Error loading teacher grades and classes","error")}},[t,r,re]),we=b.useCallback(async()=>{console.log(" Loading available classes...");try{const B=await Ur.getGradesAndClasses();if(console.log(" Raw grades/classes data:",B),!B||B.length===0){v([]);return}const ie=new Map;B.forEach(ce=>{const Ce=ce.subject_id,Oe=ce.subject||`Subject ${Ce}`;ie.has(Ce)||ie.set(Ce,{subject_id:Ce,subject:Oe,classes:[]}),ie.get(Ce).classes.push({grade:ce.grade,class:ce.class})});const xe=Array.from(ie.values());v(xe),console.log(" Transformed available classes:",xe)}catch(B){console.error(" Error loading available classes:",B),r("Failed to load available classes","error")}},[r]);b.useCallback(async(B,ie)=>{if(i){o(!1);return}if(!t||!t.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}z(),O("testAssignment"),Y(ie),p(B),u("testAssignment"),ve(B,ie),we(),console.log(" Test assignment interface shown for:",{testType:B,testId:ie})},[i,t,z,O,ve,we]);const Fe=b.useCallback(async B=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",B),B.length===0){Me([]);return}Me(B),console.log(" Active tests displayed:",B.length,"tests")},[t]);b.useCallback(async(B,ie)=>{try{console.log(" Loading test questions for:",{testType:B,testId:ie});const xe=await Ar.getTestQuestions(ie,B);return console.log(" Test questions loaded:",xe),xe}catch(xe){throw console.error("Error loading test questions:",xe),xe}},[]),b.useCallback((B,ie,xe,ce)=>{console.log(" Showing teacher test details modal:",{testType:B,testId:ie,testName:xe,questionsCount:ce.length}),console.log("Test Details:",{testType:B,testId:ie,testName:xe,questions:ce.map(Ce=>({id:Ce.question_id,question:Ce.question,correctAnswer:Ce.correct_answer}))}),r(`Test details for "${xe}" loaded successfully.`,"success")},[r]);const ne=b.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const B=await Ar.getTeacherTests();console.log(" DEBUG: Tests loaded:",B),B&&B.length>0?(console.log(" DEBUG: Success! Displaying",B.length,"tests"),Fe(B)):(console.log(" DEBUG: No tests found"),Me([]))}catch(B){console.error(" DEBUG: Error loading active tests:",B),r("Error loading active tests.","error")}},[r,Fe]),Ee=b.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}}),M([]),o(!1),a(!1),R()},[r,R]),ke=b.useCallback(async(B,ie)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",B),console.log(" Test ID:",ie),console.log(" Current formData:",C),console.log(" Selected Classes:",P),console.log(" User:",t),!t||!t.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",t.teacher_id),P.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request...");const xe=P.map(Ie=>{const mt={grade:parseInt(Ie.grade),class:parseInt(Ie.class),subject_id:parseInt(Ie.subject_id),academic_period_id:8,due_date:null};return console.log(" Created assignment:",mt),mt});if(console.log(" Final assignments array:",xe),B==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ie=C.matchingTestData;if(console.log(" Matching test data from formData:",Ie),!Ie){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let mt;Ie.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),mt=Ie.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",Ie.blocks),console.log(" Words:",Ie.words),console.log(" Arrows:",Ie.arrows),mt=Ie.blocks.map((Bt,xr)=>{var W;const $t=((W=Ie.words.find(_e=>_e.blockId===Bt.id))==null?void 0:W.word)||`Word ${xr+1}`,Ht=Ie.arrows.some(_e=>_e.startBlock===Bt.id),Pt=Ie.arrows.find(_e=>_e.startBlock===Bt.id)||null,jt={question_id:xr+1,word:$t,block_coordinates:{x:Bt.x,y:Bt.y,width:Bt.width,height:Bt.height},has_arrow:Ht,arrow:Pt?{startX:Pt.startX,startY:Pt.startY,endX:Pt.endX,endY:Pt.endY,style:Pt.style||{}}:null};return console.log(` Question ${xr+1}:`,jt),jt})),console.log(" Final questions array:",mt);const qe={teacher_id:t.teacher_id,test_name:C.testName,image_url:Ie.imageUrl,num_blocks:Ie.blocks.length,questions:mt,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,assignments:xe};console.log(" Final matching test data payload:",qe),console.log(" Calling testService.saveMatchingTest...");const xt=await Ar.saveMatchingTest(qe);console.log(" API Response:",xt),xt.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),He()):(console.error(" Failed to create matching test:",xt.message),r("Error creating and assigning matching test: "+xt.message,"error")),A(!1);return}if(B==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ie=C.wordMatchingData;if(console.log(" Word matching test data from formData:",Ie),!Ie){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const mt=Ie.wordPairs.map((Bt,xr)=>({question_id:xr+1,left_word:Bt.leftWord,right_word:Bt.rightWord}));console.log(" Final word matching questions array:",mt);const qe={teacher_id:t.teacher_id,test_type:"word_matching",test_name:C.testName,num_questions:Ie.wordPairs.length,interaction_type:Ie.interactionType||"drag",questions:mt,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,assignments:xe};console.log(" Final word matching test data payload:",qe),console.log(" Calling testService.assignTestToClasses for word matching...");const xt=await Ar.assignTestToClasses(qe);console.log(" API Response:",xt),xt.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),He()):(console.error(" Failed to create word matching test:",xt.message),r("Error creating and assigning word matching test: "+xt.message,"error")),A(!1);return}if(B==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ie=C.drawingData;if(console.log(" Drawing test data from formData:",Ie),!Ie){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const mt=Ie.questions||[];console.log(" Drawing questions array:",mt);const qe={teacher_id:t.teacher_id,test_type:"drawing",test_name:C.testName,num_questions:Ie.num_questions,passing_score:Ie.passing_score,questions:mt,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,assignments:xe};console.log(" Final drawing test data payload:",qe),console.log(" Calling testService.assignTestToClasses...");const xt=await Ar.assignTestToClasses(qe);console.log(" API Response:",xt),xt.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),He()):(console.error(" Failed to create drawing test:",xt.message),r("Error creating and assigning drawing test: "+xt.message,"error")),A(!1);return}if(B==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Bt=>setTimeout(Bt,100));const Ie=C.fillBlanksData;if(console.log(" Fill blanks test data from formData:",Ie),!Ie){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const mt=Ie.blanks||[];console.log(" Fill blanks questions array:",mt);const qe={teacher_id:t.teacher_id,test_type:"fill_blanks",test_name:C.testName,test_text:Ie.test_text,num_questions:Ie.num_questions,num_blanks:Ie.num_blanks,separate_type:Ie.separate_type,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,questions:mt,assignments:xe};console.log(" Final fill blanks test data payload:",qe),console.log(" Calling testService.assignTestToClasses...");const xt=await Ar.assignTestToClasses(qe);console.log(" API Response:",xt),xt.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),He()):(console.error(" Failed to create fill blanks test:",xt.message),r("Error creating and assigning fill blanks test: "+xt.message,"error")),A(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",C.questions);const ce=Object.keys(C.questions).map(Ie=>{var Bt;const mt=C.questions[Ie];console.log(` Processing question ${Ie}:`,mt);let qe;B==="input"?qe={correct_answers:mt.correct_answers||[mt.correctAnswer||""]}:qe={correct_answer:mt.correctAnswer||((Bt=mt.correct_answers)==null?void 0:Bt[0])||""};const xt={question_id:parseInt(Ie),question:mt.question,...qe,options:mt.options||[]};return console.log(` Question ${Ie} correct_answers:`,mt.correct_answers),console.log(` Question ${Ie} correctAnswer:`,mt.correctAnswer),console.log(` Converted question ${Ie}:`,xt),xt});console.log(" Final questions array:",ce);const Ce={teacher_id:t.teacher_id,test_type:Ege[B],test_name:C.testName,num_questions:C.numQuestions,num_options:C.numOptions,questions:ce,allowed_time:C.enableTimer?Math.max(0,Math.floor(Number(C.timerMinutes||0)*60)):null,is_shuffled:!!C.isShuffled,assignments:xe};console.log(" Final test data payload:",Ce),console.log(" Setting isAssigningTest to true..."),A(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Ie=>setTimeout(Ie,100)),console.log(" Calling testService.assignTestToClasses...");const Oe=await Ar.assignTestToClasses(Ce);console.log(" API Response:",Oe),Oe.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),He()):(console.error(" Failed to create and assign test:",Oe.message),r("Error creating and assigning test: "+Oe.message,"error"))}catch(xe){console.error(" Exception in assignTestToClasses:",xe),console.error("Error creating and assigning test:",xe),r("Error creating and assigning test. Please try again.","error")}finally{A(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[t,P,C,r,Ee]),He=b.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),p(null),Y(null),M([]),G(),R(),Ee(),console.log(" Returned to main cabinet")}catch(B){console.error("Error returning to main cabinet:",B)}},[G,R,Ee]),[at,Me]=b.useState([]),[Ft,Ut]=b.useState(!1);b.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await ne(),r("Active tests data refreshed.","success")}catch(B){console.error("Error refreshing active tests data:",B),r("Error refreshing data.","error")}},[ne,r]);const[Pe,Re]=b.useState([]),[$e,Be]=b.useState([]),[Ge,ht]=b.useState(!1),[Nt,Ye]=b.useState(!1),Ve=b.useCallback(async B=>{if(!t||!t.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",B),Re(B),console.log(" Existing subjects displayed in selection:",B.length,"subjects")},[t]);b.useCallback(async()=>{try{console.log("Loading existing subjects...");const B=await Ur.getTeacherSubjects();console.log("Existing subjects loaded:",B),B&&B.length>0?Ve(B):(console.log("No existing subjects found"),Re([]))}catch(B){console.error("Error loading existing subjects:",B),r("Error loading subjects.","error")}},[r,Ve]);const ot=b.useCallback(B=>{console.log("Checking for outside click...");const ie=document.getElementById("dropdownMenu"),xe=document.querySelector("[data-menu-button]");ie&&!ie.contains(B.target)&&!(xe!=null&&xe.contains(B.target))&&(console.log("Outside click detected, closing menu"),ie.classList.remove("show"),document.removeEventListener("click",ot))},[]),[et,nt]=b.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),gt=b.useCallback((B,ie)=>{const xe=B.target.files[0];if(!xe)return;if(!xe.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),B.target.value="";return}if(xe.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),B.target.value="";return}N(!0);const ce=new FileReader;ce.onload=function(Ce){try{console.log(" File loaded, processing data...");const Oe=new Uint8Array(Ce.target.result),Ie=rk(Oe,{type:"array"}),mt=Ie.SheetNames[0],qe=Ie.Sheets[mt],xt=zx.sheet_to_json(qe,{header:1});console.log(" Parsed Excel data:",xt),Ne(xt,ie),N(!1)}catch(Oe){console.error("Error processing Excel file:",Oe),r("Error reading Excel file: "+Oe.message,"error"),B.target.value="",N(!1)}},ce.onerror=function(){r("Failed to read file","error"),B.target.value="",N(!1)},ce.readAsArrayBuffer(xe)},[r]),Et=b.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const B=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${B.length} Excel upload buttons`),B.forEach((ie,xe)=>{const ce=ie.dataset.testType,Ce=document.querySelector(`.excel-file-input[data-test-type="${ce}"]`);console.log(` Processing button ${xe+1}: testType=${ce}, fileInput=${Ce?"found":"not found"}`),Ce?(ie._excelClickHandler&&ie.removeEventListener("click",ie._excelClickHandler),Ce._excelChangeHandler&&Ce.removeEventListener("change",Ce._excelChangeHandler),ie._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${ce}`),Ce.click()},Ce._excelChangeHandler=Oe=>{console.log(` File input changed for test type: ${ce}`),gt(Oe,ce)},ie.addEventListener("click",ie._excelClickHandler),Ce.addEventListener("change",Ce._excelChangeHandler),console.log(` Excel upload initialized for test type: ${ce}`)):console.warn(` File input not found for test type: ${ce}`)}),console.log(" Excel upload initialization complete")},[gt]),Ne=b.useCallback((B,ie)=>{const xe=B.filter(qe=>Array.isArray(qe)&&qe.length>0&&qe.some(xt=>xt&&xt.toString().trim()!==""));console.log(" Original Excel data rows:",B.length),console.log(" Filtered Excel data rows:",xe.length);const Ce=Ke(xe,ie).dataRows;if(Ce.length===0){const qe="No data rows found after header processing. Please check your Excel file.";r(qe,"error"),alert(qe),ee(ie);return}console.log(` Processing Excel data for test type: ${ie}`),console.log(" Data rows after header processing:",Ce);const Oe=ut(Ce,ie);if(console.log(" Recognition result:",Oe),!Oe.recognized){console.log(` Excel data recognition failed for test type: ${ie}`);const qe="Excel data recognition failed. Please check your file format.";r(qe,"error"),alert(qe),ee(ie);return}console.log(` Excel data recognition successful for test type: ${ie}`);const Ie=Ce.length,mt=de(ie);if(mt===0)console.log(` No question count specified, using CSV count: ${Ie}`),F(qe=>({...qe,numQuestions:Ie}));else if(Ie!==mt){const qe=`Your CSV file has ${Ie} data rows, but you specified ${mt} questions.

Please either:
1. Change your question count to ${Ie}, or
2. Fix your CSV file to have exactly ${mt} data rows

Then try uploading again.`;r(qe,"error"),ee(ie);return}he(Ce,ie)},[r]),Ke=b.useCallback((B,ie)=>{if(B.length===0)return{hasHeaders:!1,headerRow:null,dataRows:B};const xe=B[0],ce=Ze(ie);if(ft(xe,ce).isLikelyHeader){const Oe=`The first row of your Excel file looks like it contains headers:

"${xe.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(Oe))return{hasHeaders:!0,headerRow:xe,dataRows:B.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:B}},[]),Ze=b.useCallback(B=>{switch(B){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),ft=b.useCallback((B,ie)=>{if(!B||B.length===0)return{isLikelyHeader:!1};if(B.length<ie.expectedColumns)return{isLikelyHeader:!1};const xe=B.join(" ").toLowerCase(),ce=ie.keywords.filter(Oe=>xe.includes(Oe.toLowerCase()));return{isLikelyHeader:ce.length>ie.keywords.length/2,keywordMatches:ce}},[]),ut=b.useCallback((B,ie)=>{if(B.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${ie}`),console.log(" Excel data to validate:",B);const xe=bt(B,ie);if(console.log(" Recognition result:",xe),!xe.matches){const ce=`Your Excel file doesn't match the expected format.

Required format:
${ye(ie)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",ce),console.log(" Calling showNotification with message:",ce),r(ce,"error"),console.log(" showNotification called"),alert(ce),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${ie}`),{recognized:!0,data:B}},[r]),bt=b.useCallback((B,ie)=>{var xe;if(ie==="multipleChoice")for(let ce=0;ce<B.length;ce++){const Ce=B[ce];if(Ce.length<4)return{matches:!1,issue:`Row ${ce+1} has ${Ce.length} columns but needs at least 4`};if(!Ce[0]||Ce[0].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no question in column 1`};if(!Ce[1]||Ce[1].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no correct answer in column 2`}}else if(ie==="trueFalse")for(let ce=0;ce<B.length;ce++){const Ce=B[ce];if(Ce.length<2)return{matches:!1,issue:`Row ${ce+1} has ${Ce.length} columns but needs at least 2`};if(!Ce[0]||Ce[0].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no question in column 1`};const Oe=(xe=Ce[1])==null?void 0:xe.toString().trim().toLowerCase();if(!Oe||!["true","false","t","f"].includes(Oe))return{matches:!1,issue:`Row ${ce+1} has invalid correct answer in column 2 (must be True/False)`}}else if(ie==="input")for(let ce=0;ce<B.length;ce++){const Ce=B[ce];if(Ce.length<2)return{matches:!1,issue:`Row ${ce+1} has ${Ce.length} columns but needs at least 2`};if(!Ce[0]||Ce[0].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no question in column 1`};if(!Ce[1]||Ce[1].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no correct answer in column 2`}}return{matches:!0}},[]),ye=b.useCallback(B=>{switch(B){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),de=b.useCallback(B=>C.numQuestions||0,[C.numQuestions]),ee=b.useCallback(B=>{console.log(` Clearing file input for test type: ${B}`)},[]),he=b.useCallback((B,ie)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${ie}`),ie){case"multipleChoice":case"multiple-choice":Ae(B);break;case"trueFalse":case"true-false":st(B);break;case"input":rt(B);break;default:console.log(` Unknown test type: ${ie}`)}},[]),Ae=b.useCallback(B=>{console.log(" populateMultipleChoiceFromExcel called with:",B);const ie=Math.max(...B.map(Ce=>Ce.length-2)),xe=Math.min(ie,6);console.log(` Excel data has ${ie} option columns, using ${xe} options`),F(Ce=>({...Ce,numOptions:xe}));const ce={};B.forEach((Ce,Oe)=>{const Ie=Oe+1;console.log(` Row ${Oe+1} data:`,Ce);const mt={question:(Ce[0]||"").toString().trim(),options:[],correctAnswer:(Ce[1]||"").toString().trim().toUpperCase()};console.log(` Question ${Ie} correctAnswer:`,mt.correctAnswer),["A","B","C","D","E","F"].slice(0,xe).forEach((Bt,xr)=>{const $t=(Ce[xr+2]||"").toString().trim();console.log(` Option ${xr} (${Bt}):`,$t),mt.options.push($t)}),ce[Ie]=mt}),F(Ce=>{const Oe={...Ce,questions:ce};return console.log(" Updating form data with:",Oe),Oe}),console.log(" Populated multiple choice questions from Excel:",ce),r(`Successfully loaded ${B.length} questions from CSV file!`,"success"),V(),At("multiple-choice")},[C.numOptions,V,r]),st=b.useCallback(B=>{console.log(" populateTrueFalseFromExcel called with:",B);const ie={};B.forEach((xe,ce)=>{var Ie;const Ce=ce+1,Oe={question:(xe[0]||"").toString().trim(),correctAnswer:((Ie=xe[1])==null?void 0:Ie.toString().trim().toLowerCase())==="true"?"true":"false"};ie[Ce]=Oe}),F(xe=>({...xe,questions:ie})),console.log(" Populated true/false questions from Excel:",ie),r(`Successfully loaded ${B.length} questions from CSV file!`,"success"),q(),At("true-false")},[q,r]),rt=b.useCallback(B=>{console.log(" populateInputFromExcel called with:",B);const ie={};B.forEach((xe,ce)=>{const Ce=ce+1,Oe=[];for(let mt=1;mt<xe.length;mt++){const qe=(xe[mt]||"").toString().trim();qe&&Oe.push(qe)}const Ie={question:(xe[0]||"").toString().trim(),correctAnswer:Oe[0]||"",correct_answers:Oe};console.log(` Excel question ${Ce} data:`,Ie),ie[Ce]=Ie}),F(xe=>({...xe,questions:ie})),console.log(" Populated input questions from Excel:",ie),r(`Successfully loaded ${B.length} questions from Excel file!`,"success"),Q(),At("input")},[Q,r]),At=b.useCallback(B=>{switch(console.log(` Reattaching form event listeners for test type: ${B}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(xe=>{xe.removeEventListener("input",()=>{}),xe.removeAttribute("data-listener-attached")}),B){case"multiple-choice":V();break;case"true-false":q();break;case"input":Q();break;default:console.warn("Unknown test type for event listener reattachment:",B)}console.log(` Form event listeners reattached for test type: ${B}`)},[V,q,Q]),yt=b.useCallback(()=>{const B=localStorage.getItem("test_creation_state");if(!B)return console.log(" No test creation state found in localStorage"),!1;try{const ie=JSON.parse(B);console.log(" Found test creation state:",ie);const xe=Date.now()-ie.timestamp,ce=30*60*1e3;if(xe>ce)return console.log(" Test creation state is too old, clearing it"),R(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),z(),ie.excelState&&X(),ie.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),p("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),p("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),p("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return H(ie.currentStep),!0}catch(ie){return console.error(" Error restoring test creation state:",ie),R(),!1}},[R,z,X,H]);b.useEffect(()=>{console.log(" Initializing Teacher Tests..."),se(),yt(),we(),Et()},[se,yt,we,Et]),b.useEffect(()=>{C.numQuestions>0&&h&&h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{Et()},100))},[C.numQuestions,h,Et]);const wt=B=>{console.log(" Test type selected:",B),console.log(" Setting testType to:",B),p(B),u("formCreation"),F({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),O("formCreation"),setTimeout(()=>{Et()},100)},Jt=(B,ie)=>{F(xe=>({...xe,[B]:ie}))},dr=(B,ie,xe)=>{F(ce=>({...ce,questions:{...ce.questions,[B]:{...ce.questions[B],[ie]:xe}}}))},zt=(B,ie,xe,ce=0)=>{const Ce={};for(let Oe=1;Oe<=xe;Oe++)B==="multipleChoice"?Ce[Oe]={question:"",options:Array.from({length:ce},()=>""),correctAnswer:""}:B==="trueFalse"?Ce[Oe]={question:"",correctAnswer:""}:B==="input"&&(Ce[Oe]={question:"",correct_answers:[""]});F(Oe=>({...Oe,questions:Ce})),B==="multipleChoice"?(ae("multiple-choice"),J("multiple-choice")):B==="trueFalse"?(ae("true-false"),J("true-false")):B==="input"&&(ae("input"),J("input"))},er=async()=>{if(!h||!C.testName||!C.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),O("testAssignment",C),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},pr=(B,ie,xe,ce,Ce)=>{M(xe?Oe=>[...Oe,{grade:B,class:ie,subject_id:ce,subject:Ce}]:Oe=>Oe.filter(Ie=>!(Ie.grade===B&&Ie.class===ie&&Ie.subject_id===ce)))},_n=b.useCallback(async B=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",B),console.log(" [DEBUG] Current formData:",C),console.log(" [DEBUG] Current testType:",h),console.log(" [DEBUG] Current user:",t),console.log(" [DEBUG] Current currentStep:",l),y(!0);try{const ie=B.blocks.map((Ce,Oe)=>{var xt;const Ie=((xt=B.words.find(Bt=>Bt.blockId===Ce.id))==null?void 0:xt.word)||`Word ${Oe+1}`,mt=B.arrows.some(Bt=>Bt.startBlock===Ce.id),qe=B.arrows.find(Bt=>Bt.startBlock===Ce.id)||null;return{question_id:Oe+1,word:Ie,block_coordinates:{x:Ce.x,y:Ce.y,width:Ce.width,height:Ce.height},has_arrow:mt,arrow:qe?{startX:qe.startX,startY:qe.startY,endX:qe.endX,endY:qe.endY,style:qe.style||{}}:null}}),xe={teacher_id:t.teacher_id,test_name:C.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:B.imageUrl,num_blocks:B.blocks.length,questions:ie,assignments:[]};console.log(" Sending matching test payload:",xe);const ce={...C,testName:xe.test_name,numQuestions:xe.num_blocks,numOptions:0,questions:ie.reduce((Ce,Oe,Ie)=>(Ce[Ie+1]={question:Oe.word,correctAnswer:Oe.word,options:[]},Ce),{}),matchingTestData:B};console.log(" Assignment form data:",ce),F(ce),O("testAssignment",ce),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(ie){console.error(" Error saving matching test:",ie),r("Failed to save matching test: "+ie.message,"error")}finally{y(!1)}},[t,C,h,r,O]),Z=b.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ge=b.useCallback(async B=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",B),y(!0);try{F(ie=>{var xe;return{...ie,wordMatchingData:B,numQuestions:B.numQuestions||((xe=B.wordPairs)==null?void 0:xe.length)||0}}),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(ie){console.error("Error saving word matching test:",ie),r("Failed to save word matching test: "+ie.message,"error")}finally{y(!1)}},[r]),oe=b.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ue=b.useCallback(async B=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",B),y(!0);try{F(ie=>{var xe;return{...ie,drawingData:B,numQuestions:B.num_questions||((xe=B.questions)==null?void 0:xe.length)||0}}),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(ie){console.error(" Error saving drawing test:",ie),r("Error saving drawing test","error")}finally{y(!1)}},[r]),me=b.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),K=b.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),F({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),le=b.useCallback(async B=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",B),y(!0);try{F(ie=>{var xe;return{...ie,fillBlanksData:B,numQuestions:B.num_questions||((xe=B.blanks)==null?void 0:xe.length)||0}}),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(ie){console.error(" Error saving fill blanks test:",ie),r("Error saving fill blanks test","error")}finally{y(!1)}},[r]);return c.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[c.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs(Sa,{mode:"wait",children:[l==="typeSelection"&&c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"flex items-center justify-between mb-4",children:[c.jsxs(Ue,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsx("div",{className:"flex-1"})]}),c.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),c.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"}].map(({type:B,title:ie,description:xe,icon:ce})=>c.jsx(Le.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>wt(B),children:c.jsxs(it,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[c.jsx("div",{className:"mb-3 flex justify-center",children:c.jsx("img",{src:ce,alt:ie,className:"w-12 h-12 object-contain"})}),c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:ie}),c.jsx("p",{className:"text-sm text-gray-600",children:xe})]})},B))})]}),l==="formCreation"&&c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsx("div",{className:"flex items-center justify-between",children:c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsx("div",{className:"flex space-x-2",children:c.jsx(Ue,{variant:"outline",onClick:L,children:" Back to Test Types"})}),c.jsxs("div",{children:[c.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",h==="multipleChoice"?"Multiple Choice":h==="trueFalse"?"True/False":h==="input"?"Input":h==="drawing"?"Drawing":h==="fillBlanks"?"Fill Blanks":h==="wordMatching"?"Word Matching":"Picture Matching"," Test"]}),c.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),c.jsx(it,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),c.jsx("input",{type:"text",value:C.testName,onChange:B=>Jt("testName",B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),h!=="matching"&&h!=="wordMatching"&&h!=="drawing"&&h!=="fillBlanks"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),c.jsx("input",{type:"number",min:"1",max:"50",value:C.numQuestions,onChange:B=>{const ie=parseInt(B.target.value)||0;Jt("numQuestions",ie),ie>0&&zt(h,C.testName,ie,C.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),h==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),c.jsx("input",{type:"number",min:"2",max:"6",value:C.numOptions,onChange:B=>{const ie=parseInt(B.target.value)||0;Jt("numOptions",ie),ie>0&&ie<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),C.numQuestions>0&&zt(h,C.testName,C.numQuestions,ie)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs("label",{className:"inline-flex items-center space-x-2",children:[c.jsx("input",{type:"checkbox",checked:!!C.enableTimer,onChange:B=>Jt("enableTimer",B.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),C.enableTimer&&c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),c.jsx("input",{type:"number",min:"1",max:"1440",value:C.timerMinutes,onChange:B=>Jt("timerMinutes",B.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]}),h!=="drawing"&&h!=="matching"&&h!=="fillBlanks"&&c.jsxs("label",{className:"inline-flex items-center space-x-2 ml-6",children:[c.jsx("input",{type:"checkbox",checked:!!C.isShuffled,onChange:B=>Jt("isShuffled",B.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})]})]})}),h==="matching"&&c.jsx(it,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),c.jsx(kq,{testName:C.testName,onTestSaved:_n,onCancel:Z,onBackToCabinet:He,isSaving:_,validationErrors:{}})]})}),h==="wordMatching"&&c.jsx(it,{children:c.jsxs("div",{className:"space-y-4 text-center",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),c.jsx(vre,{testName:C.testName,onTestSaved:ge,onCancel:oe,onBackToCabinet:He,isSaving:_,validationErrors:{}})]})}),h==="drawing"&&c.jsxs("div",{className:"drawing-test-section",children:[console.log(" Rendering DrawingTestCreator, testType:",h),c.jsx(ure,{testName:C.testName,onTestSaved:ue,onCancel:me,onBackToCabinet:He,isSaving:_,validationErrors:{}})]}),h==="fillBlanks"&&c.jsxs("div",{className:"fill-blanks-test-section",children:[console.log(" Rendering FillBlanksTestCreator, testType:",h),c.jsx(gre,{testName:C.testName,allowedTime:C.enableTimer&&parseInt(C.timerMinutes)||null,onTestSaved:le,onCancel:K,onBackToCabinet:He,isSaving:_,validationErrors:{}})]}),h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&C.numQuestions>0&&c.jsx(it,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),c.jsxs("div",{className:"space-y-6",children:[h==="multipleChoice"&&((be=et.multipleChoice)==null?void 0:be.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:k,children:k?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Multiple Choice Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),c.jsx("div",{children:"Column 3: Option A text"}),c.jsx("div",{children:"Column 4: Option B text"}),c.jsx("div",{children:"Column 5: Option C text"}),c.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),h==="trueFalse"&&((pe=et.trueFalse)==null?void 0:pe.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:k,children:k?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-xs text-blue-800",children:[c.jsxs("div",{children:[c.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),c.jsxs("div",{className:"mt-1",children:[c.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),h==="input"&&((Te=et.input)==null?void 0:Te.buttonVisible)&&c.jsxs("div",{className:"flex items-start space-x-4",children:[c.jsxs("div",{className:"flex flex-col items-center",children:[c.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:k,children:k?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white"}),c.jsx("span",{className:"font-medium",children:"Processing..."})]}):c.jsxs(c.Fragment,{children:[c.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),c.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),c.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),c.jsx("div",{className:"w-fit",children:c.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:c.jsxs("div",{className:"text-sm text-blue-800",children:[c.jsx("strong",{children:"Input Test Format:"}),c.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[c.jsx("div",{children:"Column 1: Question"}),c.jsx("div",{children:"Column 2: Answer 1"}),c.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&C.numQuestions>0&&c.jsx(it,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),C.numQuestions>0&&c.jsx(it,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),c.jsx("div",{className:"space-y-6",children:Object.keys(C.questions).map(B=>{var ie,xe,ce,Ce,Oe,Ie,mt,qe,xt,Bt,xr;return c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",B]}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),c.jsx("textarea",{value:((ie=C.questions[B])==null?void 0:ie.question)||"",onChange:$t=>dr(B,"question",$t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),h==="multipleChoice"&&c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),c.jsx("div",{className:"space-y-2",children:(ce=(xe=C.questions[B])==null?void 0:xe.options)==null?void 0:ce.map(($t,Ht)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Ht),":"]}),c.jsx("input",{type:"text",value:$t,onChange:Pt=>{const jt=[...C.questions[B].options];jt[Ht]=Pt.target.value,dr(B,"options",jt)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Ht)}`})]},Ht))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),h==="multipleChoice"?c.jsx("div",{children:c.jsxs("select",{value:((Ce=C.questions[B])==null?void 0:Ce.correctAnswer)||"",onChange:$t=>dr(B,"correctAnswer",$t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"",children:"Select correct answer"}),(Ie=(Oe=C.questions[B])==null?void 0:Oe.options)==null?void 0:Ie.map(($t,Ht)=>c.jsx("option",{value:String.fromCharCode(65+Ht),children:String.fromCharCode(65+Ht)},Ht))]})}):h==="trueFalse"?c.jsxs("select",{value:((mt=C.questions[B])==null?void 0:mt.correctAnswer)||"",onChange:$t=>dr(B,"correctAnswer",$t.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[c.jsx("option",{value:"true",children:"True"}),c.jsx("option",{value:"false",children:"False"})]}):c.jsxs("div",{className:"space-y-2",children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),c.jsxs("div",{className:"space-y-2",children:[c.jsx("input",{type:"text",value:((xt=(qe=C.questions[B])==null?void 0:qe.correct_answers)==null?void 0:xt[0])||"",onChange:$t=>{var jt;const Pt=[...((jt=C.questions[B])==null?void 0:jt.correct_answers)||[""]];Pt[0]=$t.target.value,dr(B,"correct_answers",Pt)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),((xr=(Bt=C.questions[B])==null?void 0:Bt.correct_answers)==null?void 0:xr.slice(1).map(($t,Ht)=>c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("input",{type:"text",value:$t,onChange:Pt=>{var W;const jt=[...((W=C.questions[B])==null?void 0:W.correct_answers)||[]];jt[Ht+1]=Pt.target.value,dr(B,"correct_answers",jt)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Ht+2}`}),c.jsx("button",{type:"button",onClick:()=>{var jt;const Pt=[...((jt=C.questions[B])==null?void 0:jt.correct_answers)||[]];Pt.splice(Ht+1,1),dr(B,"correct_answers",Pt)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Ht)))||[],c.jsx("button",{type:"button",onClick:()=>{var Pt;const Ht=[...((Pt=C.questions[B])==null?void 0:Pt.correct_answers)||[""],""];dr(B,"correct_answers",Ht)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},B)})})]})}),C.testName&&C.numQuestions>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(Ue,{onClick:er,disabled:_,className:"px-8",children:_?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),l==="testAssignment"&&c.jsxs(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center space-x-4",children:[c.jsxs(Ue,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),c.jsx("span",{children:"Back to Main"})]}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),c.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),c.jsx(Ue,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),c.jsx(it,{children:c.jsxs("div",{className:"space-y-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),x.length===0?c.jsxs("div",{className:"text-center py-8",children:[c.jsx("div",{className:"text-6xl mb-4",children:""}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),c.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),c.jsx("div",{className:"mt-4",children:c.jsx(Ue,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):c.jsx("div",{className:"space-y-6",children:x.map(B=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:B.subject}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:B.classes.map(ie=>c.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[c.jsx("input",{type:"checkbox",checked:P.some(xe=>xe.grade===ie.grade&&xe.class===ie.class&&xe.subject_id===B.subject_id),onChange:xe=>pr(ie.grade,ie.class,xe.target.checked,B.subject_id,B.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),c.jsxs("span",{className:"text-sm text-gray-700",children:[ie.grade,"/",ie.class]})]},`${ie.grade}-${ie.class}-${B.subject_id}`))})]},B.subject_id))})]})}),P.length>0&&c.jsx("div",{className:"flex justify-end",children:c.jsx(Ue,{onClick:()=>ke(h,null),disabled:w,className:"px-8",children:w?c.jsxs(c.Fragment,{children:[c.jsx(ir,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${P.length} Class${P.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",E),E&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),_&&c.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),c.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:e.map(B=>c.jsx(eo,{type:B.type,message:B.message,duration:B.duration,onClose:()=>n(B.id)},B.id))})]})},Nge=({onDataLoaded:t,onError:e})=>{const r=Xa(),{user:n,isAuthenticated:s}=vn(),{teacherData:a,loadTeacherData:i}=Bv(),[o,l]=b.useState(!0),[u,d]=b.useState(""),[g,h]=b.useState([]),[p,x]=b.useState(null),[v,w]=b.useState([]),[S,_]=b.useState([]),[y,k]=b.useState([]),[N,E]=b.useState(null),[A,C]=b.useState(0);b.useEffect(()=>{se()},[]),b.useCallback(async z=>{console.log(" Teacher login attempt...");try{const G=await Ur.teacherLogin(z);if(G.success)return Y("Login successful!","success"),await F(),G;throw new Error(G.error||"Login failed")}catch(G){throw console.error(" Teacher login error:",G),Y("Login failed. Please check your credentials.","error"),G}},[]);const F=b.useCallback(async()=>{console.log(" Loading teacher data...");try{if(l(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==aa.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const z=await Ur.getTeacherData();if(z&&z.success)console.log(" Teacher data loaded successfully:",z),x(z.teacher||n),z.subjects&&(w(z.subjects),console.log(" Teacher subjects loaded:",z.subjects.length)),z.grades&&_(z.grades),z.classes&&k(z.classes),E(new Date),C(G=>G+1),t&&t(z),Y("Teacher data loaded successfully!","success");else throw new Error((z==null?void 0:z.error)||"Failed to load teacher data")}catch(z){console.error(" Error loading teacher data:",z);const G=z.message||"Failed to load teacher data";d(G),e&&e(z),Y(G,"error")}finally{l(!1)}},[s,n,t,e]),P=b.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);b.useCallback(z=>{console.log(" Showing main cabinet with subjects:",z),z&&w(z),r("/teacher/cabinet")},[r]);const M=b.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(G=>({id:G,name:`Grade ${G}`,classes:I(G)}))),[]),I=b.useCallback(z=>Array.from({length:10},(O,R)=>R+1).map(O=>({id:`${z}-${O}`,name:`Class ${O}`,grade:z,classNumber:O})),[]),Y=b.useCallback((z,G)=>{const O={id:Date.now(),message:z,type:G,timestamp:new Date};h(R=>[...R,O]),setTimeout(()=>{h(R=>R.filter(X=>X.id!==O.id))},ba.NOTIFICATION_DURATION)},[]),se=b.useCallback(async()=>{console.log(" Initializing teacher data..."),await F()},[F]),L=b.useCallback(async()=>{console.log(" Refreshing teacher data..."),await F()},[F]);return b.useCallback(async z=>{console.log(" Updating teacher profile:",z);try{const G=await Ur.updateUserProfile(z);if(G.success)return x(O=>({...O,...z})),Y("Profile updated successfully!","success"),G;throw new Error(G.error||"Failed to update profile")}catch(G){throw console.error(" Error updating teacher profile:",G),Y("Failed to update profile","error"),G}},[]),b.useCallback(async z=>{console.log(" Changing teacher password...");try{const G=await Ur.changePassword(z);if(G.success)return Y("Password changed successfully!","success"),G;throw new Error(G.error||"Failed to change password")}catch(G){throw console.error(" Error changing teacher password:",G),Y("Failed to change password","error"),G}},[]),o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:u}),c.jsxs("div",{className:"flex space-x-3 justify-center",children:[c.jsx(Ue,{variant:"primary",onClick:L,children:"Retry"}),c.jsx(Ue,{variant:"outline",onClick:P,children:"Go Back"})]})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",N?N.toLocaleString():"Never"," | Version: ",A]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsx(Ue,{variant:"outline",onClick:L,children:"Refresh Data"}),c.jsx(Ue,{variant:"outline",onClick:P,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),p?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.name||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.username||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.email||"N/A"})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),c.jsx("p",{className:"text-sm text-gray-900",children:p.role||"N/A"})]})]}):c.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((z,G)=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900",children:z.name}),c.jsx("p",{className:"text-sm text-gray-600 mt-1",children:z.description||"No description"}),z.classes&&z.classes.length>0&&c.jsxs("div",{className:"mt-2",children:[c.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:z.classes.map((O,R)=>c.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[O.grade," - ",O.className]},R))})]})]},G))}):c.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M().map(z=>c.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[c.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:z.name}),c.jsx("div",{className:"grid grid-cols-5 gap-1",children:z.classes.map(G=>c.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",G),children:G.classNumber},G.id))})]},z.id))})]}),c.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[c.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-green-600",children:S.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:y.length}),c.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:A}),c.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:g.map(z=>c.jsx(eo,{type:z.type,message:z.message,onClose:()=>h(G=>G.filter(O=>O.id!==z.id))},z.id))})]})},Age=({onBackToCabinet:t})=>{var Ut;const e=Xa(),{user:r,isAuthenticated:n}=vn(),{teacherData:s}=Bv(),[a,i]=b.useState(!0),[o,l]=b.useState(""),[u,d]=b.useState([]),[g,h]=b.useState([]),[p,x]=b.useState([]),[v,w]=b.useState([]),[S,_]=b.useState(null),[y,k]=b.useState([]),[N,E]=b.useState(!1),[A,C]=b.useState(!1),[F,P]=b.useState(!1),[M,I]=b.useState(!1),[Y,se]=b.useState(null),[L,z]=b.useState(!0),[G,O]=b.useState(null);b.useEffect(()=>{Me()},[]),b.useCallback(Pe=>{console.log(" Rendering existing subjects:",Pe),h(Pe)},[]);const R=b.useCallback(()=>{console.log(" Showing subject selection prompt..."),E(!0),z(!1),X()},[]),X=b.useCallback(async()=>{console.log(" Loading existing subjects...");try{const Pe=await Ur.getTeacherSubjects();Pe.success&&Pe.subjects&&Pe.subjects.length>0?(console.log(" Existing subjects found:",Pe.subjects),te(Pe.subjects)):(console.log(" No existing subjects found"),w([]))}catch(Pe){console.error(" Error loading existing subjects:",Pe),at("Failed to load existing subjects","error")}},[]),te=b.useCallback(Pe=>{console.log(" Rendering subject selection:",Pe);const Re=[];Pe.forEach($e=>{$e.classes&&Array.isArray($e.classes)&&$e.classes.forEach(Be=>{Re.push({id:`${$e.subject_id}-${Be.grade}-${Be.class}`,subjectId:$e.subject_id,subjectName:$e.subject,grade:Be.grade,class:Be.class,displayText:`${$e.subject} - ${Be.grade}/${Be.class}`})})}),w(Re),console.log(" Processed subjects for selection:",Re)},[]),H=b.useCallback(async Pe=>{if(console.log(" Saving teacher subjects:",Pe),!Pe||Pe.length===0){at("Please select at least one subject and class combination.","warning");return}try{const Re=Pe.reduce((Be,Ge)=>{const ht=Be.find(Nt=>Nt.subject_id===Ge.subjectId);return ht?ht.classes.push({grade:Ge.grade,class:Ge.class}):Be.push({subject_id:Ge.subjectId,classes:[{grade:Ge.grade,class:Ge.class}]}),Be},[]);console.log(" Transformed data for backend:",Re);const $e=await Ur.saveTeacherSubjects(Re);if($e.success)at("Subjects saved successfully!","success"),E(!1),z(!0),O(new Date),await X();else throw new Error($e.error||"Failed to save subjects")}catch(Re){console.error(" Error saving subjects:",Re),at("Error saving subjects. Please try again.","error")}},[]),V=b.useCallback(()=>{console.log(" Toggling subject dropdown..."),C(Pe=>!Pe),P(!1)},[]),q=b.useCallback(async()=>{var Pe;console.log(" Loading subjects for dropdown...");try{const Re=await Ur.getAllSubjects();if(Re.success)x(Re.subjects||[]),console.log(" Available subjects loaded:",((Pe=Re.subjects)==null?void 0:Pe.length)||0);else throw new Error(Re.error||"Failed to load subjects")}catch(Re){console.error(" Error loading subjects for dropdown:",Re),at("Failed to load subjects","error")}},[]),Q=b.useCallback(Pe=>{console.log(" Subject selected:",Pe);const Re=p.find($e=>$e.subject_id===parseInt(Pe));Re&&(_(Re),P(!0),C(!1),ae())},[p]),ae=b.useCallback(()=>{console.log(" Loading grades and classes...")},[]),J=b.useCallback((Pe,Re)=>{console.log(" Saving classes for subject:",Pe,Re);const $e={id:`${Pe.subject_id}-${Date.now()}`,subjectId:Pe.subject_id,subjectName:Pe.subject,grade:Re.grade,class:Re.class,displayText:`${Pe.subject} - ${Re.grade}/${Re.class}`};w(Be=>[...Be,$e]),_(null),k([]),P(!1),ve(`Added ${Pe.subject} for ${Re.grade}/${Re.class}`)},[]),re=b.useCallback(()=>{console.log(" Resetting subject selection..."),_(null),k([]),C(!1),P(!1)},[]),ve=b.useCallback(Pe=>{console.log(" Showing message:",Pe),at(Pe,"success")},[]),we=b.useCallback(Pe=>{console.log(" Showing confirmation modal:",Pe),se(Pe),I(!0)},[]),Fe=b.useCallback(()=>{console.log(" Hiding confirmation modal..."),I(!1),se(null)},[]),ne=b.useCallback(()=>{console.log(" Confirming save subjects..."),Fe(),H(v)},[v,H,Fe]),Ee=b.useCallback(()=>{console.log(" Cancelling save subjects..."),Fe()},[Fe]),ke=b.useCallback(Pe=>{console.log(" Removing subject:",Pe),w(Re=>Re.filter($e=>$e.id!==Pe)),at("Subject removed","info")},[]);b.useCallback(()=>{console.log(" Showing edit subjects button..."),z(!0)},[]),b.useCallback(()=>{console.log(" Hiding edit subjects button..."),z(!1)},[]);const He=b.useCallback(Pe=>{console.log(" Generating class buttons for grade:",Pe);let Re;return Pe===1||Pe===2?Re=["15","16"]:Pe===3?Re=["15","16"]:Pe===4?Re=["13","14"]:Pe===5||Pe===6?Re=["13","14"]:Re=[],Re.map($e=>({id:`${Pe}-${$e}`,grade:Pe,class:$e,displayText:`${Pe}/${$e}`}))},[]);b.useCallback((Pe,Re)=>{console.log(" Showing class results:",Pe,Re),e("/teacher/results")},[e]);const at=b.useCallback((Pe,Re)=>{const $e={id:Date.now(),message:Pe,type:Re,timestamp:new Date};d(Be=>[...Be,$e]),setTimeout(()=>{d(Be=>Be.filter(Ge=>Ge.id!==$e.id))},ba.NOTIFICATION_DURATION)},[]),Me=b.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),l(""),!n||!r){console.log(" User not authenticated"),l("User not authenticated");return}if(r.role!==aa.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),l("Access denied. Teacher role required.");return}await X(),await q(),console.log(" Teacher subjects initialization complete!")}catch(Pe){console.error(" Error initializing teacher subjects:",Pe),l("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,X,q]),Ft=b.useCallback(()=>{t?t():e("/teacher/cabinet")},[t,e]);return a?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(ir,{size:"lg"}),c.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?c.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:c.jsx("div",{className:"text-center",children:c.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[c.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),c.jsx("p",{className:"text-red-600 mb-4",children:o}),c.jsx(Ue,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):c.jsxs("div",{className:"min-h-screen bg-gray-50",children:[c.jsx("div",{className:"bg-white shadow-sm border-b",children:c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:c.jsxs("div",{className:"flex justify-between items-center py-4",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),c.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",G?G.toLocaleString():"Never"]})]}),c.jsxs("div",{className:"flex space-x-3",children:[L&&c.jsx(Ue,{variant:"primary",onClick:R,children:"Edit Subjects"}),c.jsx(Ue,{variant:"outline",onClick:Ft,children:"Back to Cabinet"})]})]})})}),c.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:c.jsxs("div",{className:"space-y-6",children:[!N&&c.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),c.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs(Ue,{variant:"primary",onClick:R,className:"px-6 py-2",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),g.length>0?c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((Pe,Re)=>c.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-start justify-between",children:[c.jsxs("div",{className:"flex-1",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:Pe.subject}),Pe.classes&&Pe.classes.length>0&&c.jsxs("div",{children:[c.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),c.jsx("div",{className:"flex flex-wrap gap-2",children:Pe.classes.map(($e,Be)=>c.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",$e.grade," - Class ",$e.class]},Be))})]})]}),c.jsx("div",{className:"ml-4",children:c.jsx(Ue,{variant:"outline",size:"sm",onClick:()=>ke(Pe.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},Re))}):c.jsxs("div",{className:"text-center py-12",children:[c.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:c.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),c.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),c.jsxs(Ue,{variant:"primary",onClick:R,className:"px-6 py-3",children:[c.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),N&&c.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[c.jsxs("div",{className:"mb-6",children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),c.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),c.jsxs("div",{className:"relative",children:[c.jsxs(Ue,{variant:"outline",onClick:V,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[c.jsx("span",{className:"text-gray-900 font-medium",children:S?S.subject:"Select a subject"}),c.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),A&&c.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(Pe=>c.jsx("button",{onClick:()=>Q(Pe.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:c.jsx("span",{className:"text-gray-900 font-medium",children:Pe.subject})},Pe.subject_id))})]})]}),F&&S&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),c.jsxs("div",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",S.subject]}),c.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(Pe=>c.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:c.jsx("span",{className:"text-white font-bold text-xs",children:Pe})}),c.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",Pe]})]}),c.jsx("div",{className:"space-y-3",children:He(Pe).map(Re=>c.jsx(Ue,{variant:"outline",size:"sm",onClick:()=>J(S,Re),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:Re.displayText},Re.id))})]},Pe))})]}),v.length>0&&c.jsxs("div",{className:"mb-8",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:c.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),c.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(Pe=>c.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsx("div",{className:"flex-1",children:c.jsx("span",{className:"text-sm font-semibold text-purple-900",children:Pe.displayText})}),c.jsx(Ue,{variant:"outline",size:"sm",onClick:()=>ke(Pe.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:c.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Pe.id))})]}),c.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[c.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),c.jsxs("div",{className:"flex space-x-4",children:[c.jsxs(Ue,{variant:"outline",onClick:()=>{E(!1),z(!0),re()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),c.jsxs(Ue,{variant:"primary",onClick:()=>we({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[c.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),F?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),M&&c.jsx(Hi,{isOpen:M,onClose:Fe,title:"Confirm Save",variant:"confirmation",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",((Ut=Y==null?void 0:Y.data)==null?void 0:Ut.length)||0," subject assignments?"]}),c.jsxs("div",{className:"flex justify-end space-x-3",children:[c.jsx(Ue,{variant:"outline",onClick:Ee,children:"Cancel"}),c.jsx(Ue,{variant:"primary",onClick:ne,children:"Save"})]})]})}),c.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(Pe=>c.jsx(eo,{type:Pe.type,message:Pe.message,onClose:()=>d(Re=>Re.filter($e=>$e.id!==Pe.id))},Pe.id))})]})},jge=()=>{const{user:t,role:e,isAuthenticated:r,isLoading:n}=vn(),[s,a]=b.useState("cabinet");return!r||e!=="teacher"?c.jsx(zf,{to:"/login",replace:!0}):n?c.jsxs("div",{className:"teacher-app-loading",children:[c.jsx(ir,{}),c.jsx("p",{children:"Loading teacher interface..."})]}):c.jsx("div",{className:"teacher-app",children:c.jsxs(eC,{children:[c.jsx(Mn,{path:"/",element:c.jsx(Aj,{})}),c.jsx(Mn,{path:"/cabinet",element:c.jsx(Aj,{})}),c.jsx(Mn,{path:"/tests",element:c.jsx(jj,{})}),c.jsx(Mn,{path:"/tests/create",element:c.jsx(jj,{})}),c.jsx(Mn,{path:"/data",element:c.jsx(Nge,{})}),c.jsx(Mn,{path:"/subjects",element:c.jsx(Age,{})}),c.jsx(Mn,{path:"/results",element:c.jsx(rL,{})}),c.jsx(Mn,{path:"*",element:c.jsx(zf,{to:"/teacher",replace:!0})})]})})},Se={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},Fge=()=>{var jt;const{user:t,isAdmin:e,logout:r}=vn(),{get:n,post:s}=ro(),a=b.useCallback(async()=>{try{h({type:"info",message:"Refreshing class summary view..."});const W=await s("/.netlify/functions/refresh-class-summary-semester",{});W&&(W.success||W.message)?h({type:"success",message:"Class summary view refreshed."}):h({type:"error",message:(W==null?void 0:W.error)||"Failed to refresh view"})}catch(W){h({type:"error",message:"Failed to refresh view"}),console.error("Refresh class summary error:",W)}},[s]),i=b.useCallback(async()=>{try{h({type:"info",message:"Checking for overdue assignments..."});const W=await s("/.netlify/functions/check-overdue-assignments",{});if(W&&W.success){const _e=W.overdue_count||0;_e>0?h({type:"success",message:`Found and marked ${_e} overdue assignments as inactive.`}):h({type:"info",message:"No overdue assignments found."})}else h({type:"error",message:(W==null?void 0:W.error)||"Failed to check assignments"})}catch(W){h({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",W)}},[s]),[o,l]=b.useState(!1),[u,d]=b.useState(null),[g,h]=b.useState(null),[p,x]=b.useState(!1),[v,w]=b.useState(!1),[S,_]=b.useState(!1),[y,k]=b.useState(!1),[N,E]=b.useState(""),[A,C]=b.useState(null),[F,P]=b.useState({}),[M,I]=b.useState(null),[Y,se]=b.useState({}),[L,z]=b.useState(null),[G,O]=b.useState({}),[R,X]=b.useState([]),[te,H]=b.useState(""),[V,q]=b.useState(""),[Q,ae]=b.useState(""),[J,re]=b.useState(!0),[ve,we]=b.useState(!1),[Fe,ne]=b.useState([]),[Ee,ke]=b.useState(""),[He,at]=b.useState(""),[Me,Ft]=b.useState(""),[Ut,Pe]=b.useState(!1),[Re,$e]=b.useState(!1),[Be,Ge]=b.useState([]),[ht,Nt]=b.useState([]),[Ye,Ve]=b.useState([]),[ot,et]=b.useState([]),[nt,gt]=b.useState(!1),[Et,Ne]=b.useState(!1),[Ke,Ze]=b.useState(!1),[ft,ut]=b.useState(!1),[bt,ye]=b.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[de,ee]=b.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[he,Ae]=b.useState({subject_id:"",subject:"",description:"",is_active:!0}),[st,rt]=b.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});b.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),At()},[]),b.useEffect(()=>{const W=_e=>{Ut&&!_e.target.closest(".admin-menu")&&Pe(!1)};return document.addEventListener("mousedown",W),()=>{document.removeEventListener("mousedown",W)}},[Ut]);const At=b.useCallback(async()=>{try{l(!0),await dr(),console.log("Admin app initialized")}catch(W){d("Failed to initialize admin app"),console.error("Admin app initialization error:",W)}finally{l(!1)}},[]),yt=b.useCallback(()=>{Pe(W=>!W)},[]),wt=b.useCallback(()=>{$e(!0),Pe(!1)},[]),Jt=b.useCallback(()=>{$e(!1)},[]),dr=b.useCallback(async()=>{try{await Promise.all([zt(),er(),pr(),_n()])}catch(W){console.error("Error loading admin data:",W),d("Failed to load admin data")}},[]),zt=b.useCallback(async()=>{try{const W="admin_users_",_e=zr(W);if(_e){console.log(" Using cached users data"),Ge(_e);return}const tt=await n("/.netlify/functions/get-all-users");console.log(" Users response:",tt);const ct=tt.users||[];Ge(ct),Gr(W,ct,Jr.admin_users),console.log(" Users set to state:",ct)}catch(W){console.error("Error loading users:",W)}},[n]),er=b.useCallback(async()=>{try{const W="admin_teachers_",_e=zr(W);if(_e){console.log(" Using cached teachers data"),Nt(_e);return}const tt=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",tt);const ct=tt.teachers||[];Nt(ct),Gr(W,ct,Jr.admin_teachers),console.log(" Teachers set to state:",ct)}catch(W){console.error("Error loading teachers:",W)}},[n]),pr=b.useCallback(async()=>{try{const W="admin_subjects_",_e=zr(W);if(_e){console.log(" Using cached subjects data"),Ve(_e);return}const tt=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",tt);const ct=tt.subjects||[];Ve(ct),Gr(W,ct,Jr.admin_subjects),console.log(" Subjects set to state:",ct)}catch(W){console.error("Error loading subjects:",W)}},[n]),_n=b.useCallback(async()=>{try{const W="admin_academic_years_",_e=zr(W);if(_e){console.log(" Using cached academic years data"),et(_e);return}const ct=(await n("/.netlify/functions/get-academic-year")).academic_years||[];et(ct),Gr(W,ct,Jr.admin_academic_years)}catch(W){console.error("Error loading academic year:",W)}},[n]),Z=b.useCallback(async()=>{try{if(k(!y),!y){const[W,_e]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",W),console.log(" Assignments response:",_e);const tt=W.tests||[],Gt=(_e.assignments||[]).reduce((bn,Uo)=>{const Ya=`${Uo.test_type}-${Uo.test_id}`;return bn[Ya]||(bn[Ya]=[]),bn[Ya].push(Uo),bn},{}),nr=tt.map(bn=>{const Uo=`${bn.test_type}-${bn.test_id}`,Ya=Gt[Uo]||[],ha=Ya.some(cn=>cn.is_active);return{...bn,is_active:ha,assignments:Ya}});X(nr),console.log(" All tests with status set to state:",nr)}}catch(W){console.error("Error loading tests:",W),h({type:"error",message:"Failed to load tests"})}},[n,y]),ge=b.useCallback((W,_e)=>{ye(tt=>({...tt,[W]:_e}))},[]),oe=b.useCallback((W,_e)=>{ee(tt=>({...tt,[W]:_e}))},[]),ue=b.useCallback((W,_e)=>{Ae(tt=>({...tt,[W]:_e}))},[]);b.useCallback(()=>{console.log(" Testing local storage...");try{const W={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(W));const _e=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",_e),h({type:"success",message:"Local storage test successful"})}catch(W){console.error(" Local storage test failed:",W),h({type:"error",message:"Local storage test failed"})}},[]),b.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),h({type:"success",message:"Local storage cleared"})}catch(W){console.error(" Error clearing local storage:",W),h({type:"error",message:"Error clearing local storage"})}},[]),b.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const _e=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",_e),h({type:"success",message:`Found ${_e.length} teachers`})}catch(W){console.error(" Error checking teacher subjects:",W),h({type:"error",message:"Error checking teacher subjects"})}},[n]);const me=b.useCallback(async W=>{W.preventDefault();try{console.log(" Submitting user:",bt);const _e=await s("/.netlify/functions/add-user",bt);_e.success?(h({type:"success",message:"User added successfully"}),gt(!1),ye({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),zt()):h({type:"error",message:_e.message||"Failed to add user"})}catch(_e){console.error(" Error adding user:",_e),h({type:"error",message:"Error adding user"})}},[bt,s,zt]),K=b.useCallback(async W=>{W.preventDefault();try{console.log(" Submitting teacher:",de);const _e=await s("/.netlify/functions/add-teacher",de);_e.success?(h({type:"success",message:"Teacher added successfully"}),Ne(!1),ee({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),er()):h({type:"error",message:_e.message||"Failed to add teacher"})}catch(_e){console.error(" Error adding teacher:",_e),h({type:"error",message:"Error adding teacher"})}},[de,s,er]),le=b.useCallback(async W=>{W.preventDefault();try{console.log(" Submitting subject:",he);const _e=await s("/.netlify/functions/add-subject",he);_e.success?(h({type:"success",message:"Subject added successfully"}),Ze(!1),Ae({subject_id:"",subject:"",description:"",is_active:!0}),pr()):h({type:"error",message:_e.message||"Failed to add subject"})}catch(_e){console.error(" Error adding subject:",_e),h({type:"error",message:"Error adding subject"})}},[he,s,pr]),be=b.useCallback(W=>{C(W),P({name:W.name||"",surname:W.surname||"",grade:W.grade||"",class:W.class||"",student_id:W.student_id||"",nickname:W.nickname||"",password:W.password||"",is_active:W.is_active!==void 0?W.is_active:!0})},[]),pe=b.useCallback(async()=>{try{const W=[];Object.keys(F).forEach(_e=>{_e!=="student_id"&&F[_e]!==A[_e]&&W.push({fieldName:_e,newValue:F[_e]})});for(const _e of W)await s("/.netlify/functions/update-user",{userId:A.student_id,fieldName:_e.fieldName,newValue:_e.newValue});h({type:"success",message:"User updated successfully!"}),C(null),P({}),zt()}catch{h({type:"error",message:"Failed to update user"})}},[F,A,s,zt]),Te=b.useCallback(async W=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:W})).success&&(h({type:"success",message:"User deleted successfully!"}),zt())}catch{h({type:"error",message:"Failed to delete user"})}},[s,zt]),B=b.useCallback(W=>{I(W),se({teacher_id:W.teacher_id||"",username:W.username||"",password:W.password||"",first_name:W.first_name||"",last_name:W.last_name||"",is_active:W.is_active!==void 0?W.is_active:!0})},[]),ie=b.useCallback(async()=>{try{const W=[];Object.keys(Y).forEach(_e=>{_e!=="teacher_id"&&Y[_e]!==M[_e]&&W.push({fieldName:_e,newValue:Y[_e]})});for(const _e of W)await s("/.netlify/functions/update-teacher",{teacherId:M.teacher_id,fieldName:_e.fieldName,newValue:_e.newValue});h({type:"success",message:"Teacher updated successfully!"}),I(null),se({}),er()}catch{h({type:"error",message:"Failed to update teacher"})}},[Y,M,s,er]),xe=b.useCallback(async W=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:W})).success&&(h({type:"success",message:"Teacher deleted successfully!"}),er())}catch{h({type:"error",message:"Failed to delete teacher"})}},[s,er]),ce=b.useCallback(W=>{z(W),O({subject_id:W.subject_id||"",subject:W.subject||""})},[]),Ce=b.useCallback(async()=>{try{const W=[];Object.keys(G).forEach(_e=>{_e!=="subject_id"&&G[_e]!==L[_e]&&W.push({fieldName:_e,newValue:G[_e]})});for(const _e of W)await s("/.netlify/functions/update-subject",{subjectId:L.subject_id,fieldName:_e.fieldName,newValue:_e.newValue});h({type:"success",message:"Subject updated successfully!"}),z(null),O({}),pr()}catch{h({type:"error",message:"Failed to update subject"})}},[G,L,s,pr]),Oe=b.useCallback(async W=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const _e=await s("/.netlify/functions/delete-subject",{subjectId:W});_e.success?(h({type:"success",message:"Subject deleted successfully!"}),pr()):h({type:"error",message:_e.message||"Failed to delete subject"})}catch{h({type:"error",message:"Failed to delete subject"})}},[s,pr]),Ie=b.useCallback((W,_e)=>{rt(tt=>({...tt,[W]:_e}))},[]),mt=b.useCallback(async W=>{if(W.preventDefault(),!st.startDate||!st.endDate||!st.teacherId){h({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const _e=await s("/.netlify/functions/delete-test-data",st);_e.success?(h({type:"success",message:`Successfully deleted ${_e.deletedCount} test records!`}),ut(!1),rt({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):h({type:"error",message:_e.message||"Failed to delete test data"})}catch{h({type:"error",message:"Failed to delete test data"})}},[st,s]),qe=b.useCallback(async(W,_e,tt)=>{try{const ct=await n("/.netlify/functions/get-test-assignments");if(ct.success&&ct.assignments){const Gt=ct.assignments.filter(nr=>nr.test_id===parseInt(W)&&nr.test_type===_e);if(Gt.length===0){h({type:"error",message:"No assignments found for this test"});return}for(const nr of Gt){const bn=await s("/.netlify/functions/remove-assignment",{teacher_id:tt,assignment_id:nr.assignment_id,test_type:_e,test_id:W});if(!bn.success){h({type:"error",message:`Failed to complete test: ${bn.message}`});return}}h({type:"success",message:"Test marked as complete successfully!"}),await Z()}else h({type:"error",message:"Failed to get test assignments"})}catch(ct){console.error("Error completing test:",ct),h({type:"error",message:"Failed to complete test"})}},[s,n,Z]),xt=b.useCallback(async(W,_e,tt)=>{try{const ct=await n("/.netlify/functions/get-test-assignments");if(ct.success&&ct.assignments){const Gt=ct.assignments.filter(nr=>nr.test_id===parseInt(W)&&nr.test_type===_e);if(Gt.length===0){h({type:"error",message:"No assignments found for this test"});return}for(const nr of Gt){const bn=await s("/.netlify/functions/remove-assignment",{teacher_id:tt,assignment_id:nr.assignment_id,test_type:_e,test_id:W,mark_active:!0});if(!bn.success){h({type:"error",message:`Failed to reactivate test: ${bn.message}`});return}}h({type:"success",message:"Test marked as active successfully!"}),await Z()}else h({type:"error",message:"Failed to get test assignments"})}catch(ct){console.error("Error reactivating test:",ct),h({type:"error",message:"Failed to reactivate test"})}},[s,n,Z]),Bt=b.useCallback(async()=>{try{if(we(!ve),!ve){const W=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",W),ne(W.tests||[]),console.log(" Actual tests set to state:",W.tests||[])}}catch(W){console.error("Error loading actual tests:",W),h({type:"error",message:"Failed to load tests"})}},[n,ve]),xr=b.useCallback(async(W,_e,tt)=>{try{const ct=await s("/.netlify/functions/delete-test",{test_id:W,test_type:_e,teacher_id:tt});ct.success?(h({type:"success",message:"Test deleted successfully!"}),await Bt()):h({type:"error",message:`Failed to delete test: ${ct.message}`})}catch(ct){console.error("Error deleting test:",ct),h({type:"error",message:"Failed to delete test"})}},[s,Bt]),$t=N?Be.filter(W=>W.grade.toString()===N):Be,Ht=R.filter(W=>{const _e=!te||W.teacher_id===te,tt=!V||new Date(W.created_at)>=new Date(V),ct=!Q||new Date(W.created_at)<=new Date(Q+"T23:59:59"),Gt=J?W.is_active:!W.is_active;return _e&&tt&&ct&&Gt}),Pt=Fe.filter(W=>{const _e=!Ee||W.teacher_id===Ee,tt=!He||new Date(W.created_at)>=new Date(He),ct=!Me||new Date(W.created_at)<=new Date(Me+"T23:59:59");return _e&&tt&&ct});return c.jsxs(Le.div,{id:"admin-cabinet-main",className:Se.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[c.jsx(Le.div,{className:Se.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:c.jsx("div",{className:Se.headerContent,children:c.jsxs("div",{className:Se.headerFlex,children:[c.jsxs(Le.div,{className:Se.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx(Le.div,{className:Se.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:c.jsx("span",{className:"text-white font-semibold text-xl",children:((jt=t==null?void 0:t.username)==null?void 0:jt.charAt(0))||"A"})})}),c.jsxs("div",{children:[c.jsx("h1",{className:Se.adminText,children:(t==null?void 0:t.username)||"Administrator"}),c.jsx("p",{className:Se.adminSubtext,children:"Administrator Dashboard"})]})]}),c.jsxs(Le.div,{className:Se.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[c.jsxs("button",{onClick:yt,className:Se.menuButton,style:{zIndex:1e3},children:[c.jsx("span",{className:"hidden sm:inline",children:"Menu"}),c.jsx(Le.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Ut?180:0},transition:{duration:.2},children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),c.jsx(Sa,{children:Ut&&c.jsx(Le.div,{className:Se.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:c.jsxs("div",{className:"py-2",children:[c.jsx(Le.button,{onClick:wt,className:Se.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),c.jsx(Le.button,{onClick:()=>{yt(),r()},className:Se.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&c.jsx(ir,{text:"Loading..."}),u&&c.jsx(eo,{type:"error",message:u,onClose:()=>d(null)}),g&&c.jsx(eo,{type:g.type,message:g.message,onClose:()=>h(null)}),Re&&c.jsx("div",{className:Se.modalOverlay,children:c.jsxs("div",{className:Se.modalContent,children:[c.jsx("h2",{className:Se.modalTitle,children:"Change Password"}),c.jsxs("form",{className:"space-y-4",children:[c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{htmlFor:"currentPassword",className:Se.formLabel,children:"Current Password"}),c.jsx("input",{type:"password",id:"currentPassword",className:Se.formInput})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{htmlFor:"newPassword",className:Se.formLabel,children:"New Password"}),c.jsx("input",{type:"password",id:"newPassword",className:Se.formInput})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{htmlFor:"confirmPassword",className:Se.formLabel,children:"Confirm New Password"}),c.jsx("input",{type:"password",id:"confirmPassword",className:Se.formInput})]}),c.jsxs("div",{className:Se.modalActions,children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:Jt,className:"flex-1",children:"Cancel"}),c.jsx(Ue,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),c.jsx(Le.div,{className:Se.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:c.jsxs("div",{className:"space-y-6",children:[c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsx(it.Header,{className:Se.cardHeader,children:c.jsx(it.Title,{className:Se.cardTitle,children:"User Management"})}),c.jsxs(it.Body,{className:Se.cardBody,children:[c.jsxs("div",{className:Se.buttonGroup,children:[c.jsx(Ue,{variant:"primary",onClick:()=>gt(!0),className:Se.buttonPrimary,children:"Add User"}),c.jsx(Ue,{variant:"secondary",onClick:()=>{zt(),x(!p)},className:Se.buttonSecondary,children:p?"Hide Users Table":"Get All Users "})]}),c.jsx(Sa,{children:nt&&c.jsxs(Le.div,{className:Se.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),c.jsxs("form",{onSubmit:me,className:"space-y-4",children:[c.jsxs("div",{className:Se.formGrid,children:[c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Grade"}),c.jsx("input",{type:"text",value:bt.grade,onChange:W=>ge("grade",W.target.value),className:Se.formInput,placeholder:"Enter grade"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Class"}),c.jsx("input",{type:"text",value:bt.class,onChange:W=>ge("class",W.target.value),className:Se.formInput,placeholder:"Enter class"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Number"}),c.jsx("input",{type:"text",value:bt.number,onChange:W=>ge("number",W.target.value),className:Se.formInput,placeholder:"Enter number"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Student ID"}),c.jsx("input",{type:"text",value:bt.student_id,onChange:W=>ge("student_id",W.target.value),className:Se.formInput,placeholder:"Enter student ID"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Name"}),c.jsx("input",{type:"text",value:bt.name,onChange:W=>ge("name",W.target.value),className:Se.formInput,placeholder:"Enter name"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Surname"}),c.jsx("input",{type:"text",value:bt.surname,onChange:W=>ge("surname",W.target.value),className:Se.formInput,placeholder:"Enter surname"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Nickname"}),c.jsx("input",{type:"text",value:bt.nickname,onChange:W=>ge("nickname",W.target.value),className:Se.formInput,placeholder:"Enter nickname"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:bt.password,onChange:W=>ge("password",W.target.value),className:Se.formInput,placeholder:"Enter password"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"userActive",checked:bt.is_active,onChange:W=>ge("is_active",W.target.checked),className:Se.formCheckbox}),c.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:Se.formActions,children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:()=>gt(!1),className:Se.buttonSecondary,children:"Cancel"}),c.jsx(Ue,{type:"submit",variant:"primary",className:Se.buttonPrimary,children:"Add User"})]})]})]})}),p&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",$t.length," of ",Be.length,")"]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),c.jsxs("select",{value:N,onChange:W=>E(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Grades"}),[...new Set(Be.map(W=>W.grade))].sort().map(W=>c.jsxs("option",{value:W,children:["Grade ",W]},W))]})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:c.jsxs("table",{className:Se.table,children:[c.jsx("thead",{className:Se.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:Se.tableHeaderCell,children:"Name"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Grade"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Class"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Student ID"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Number"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Nickname"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:Se.tableBody,children:$t.map((W,_e)=>c.jsxs("tr",{className:Se.tableRow,children:[c.jsxs("td",{className:Se.tableCell,children:[W.name," ",W.surname]}),c.jsx("td",{className:Se.tableCell,children:W.grade}),c.jsx("td",{className:Se.tableCell,children:W.class}),c.jsx("td",{className:Se.tableCell,children:W.student_id}),c.jsx("td",{className:Se.tableCell,children:W.number}),c.jsx("td",{className:Se.tableCell,children:W.nickname}),c.jsx("td",{className:Se.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>be(W),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Te(W.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},W.id||_e))})]})})})]})]})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsxs(it.Header,{className:Se.cardHeader,children:[c.jsx(it.Title,{className:Se.cardTitle,children:"Teacher Management"}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsx("button",{onClick:a,className:"px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs whitespace-nowrap",title:"Refresh materialized class summary view",children:"Refresh Class Summary View"}),c.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),c.jsx(Ue,{variant:"primary",onClick:()=>Ne(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),c.jsx(Ue,{variant:"secondary",onClick:()=>{er(),w(!v)},className:"text-xs whitespace-nowrap",children:v?"Hide Teachers Table":"Get All Teachers "})]})]}),c.jsxs(it.Body,{className:Se.cardBody,children:[c.jsx(Sa,{children:Et&&c.jsxs(Le.div,{className:Se.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),c.jsxs("form",{onSubmit:K,className:"space-y-4",children:[c.jsxs("div",{className:Se.formGrid,children:[c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Teacher ID"}),c.jsx("input",{type:"text",value:de.teacher_id,onChange:W=>oe("teacher_id",W.target.value),className:Se.formInput,placeholder:"Enter teacher ID"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Username"}),c.jsx("input",{type:"text",value:de.username,onChange:W=>oe("username",W.target.value),className:Se.formInput,placeholder:"Enter username"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Password"}),c.jsx("input",{type:"password",value:de.password,onChange:W=>oe("password",W.target.value),className:Se.formInput,placeholder:"Enter password"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"First Name"}),c.jsx("input",{type:"text",value:de.first_name,onChange:W=>oe("first_name",W.target.value),className:Se.formInput,placeholder:"Enter first name"})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Last Name"}),c.jsx("input",{type:"text",value:de.last_name,onChange:W=>oe("last_name",W.target.value),className:Se.formInput,placeholder:"Enter last name"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacherActive",checked:de.is_active,onChange:W=>oe("is_active",W.target.checked),className:Se.formCheckbox}),c.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),c.jsxs("div",{className:Se.formActions,children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:()=>Ne(!1),className:Se.buttonSecondary,children:"Cancel"}),c.jsx(Ue,{type:"submit",variant:"primary",className:Se.buttonPrimary,children:"Add Teacher"})]})]})]})}),A&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),c.jsx("input",{type:"text",value:F.name,onChange:W=>P({...F,name:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),c.jsx("input",{type:"text",value:F.surname,onChange:W=>P({...F,surname:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),c.jsx("input",{type:"number",value:F.grade,onChange:W=>P({...F,grade:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),c.jsx("input",{type:"number",value:F.class,onChange:W=>P({...F,class:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),c.jsx("input",{type:"text",value:F.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),c.jsx("input",{type:"text",value:F.nickname,onChange:W=>P({...F,nickname:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:F.password,onChange:W=>P({...F,password:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"is_active",checked:F.is_active,onChange:W=>P({...F,is_active:W.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{C(null),P({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:pe,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),v&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",ht.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:Se.table,children:[c.jsx("thead",{className:Se.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:Se.tableHeaderCell,children:"Teacher ID"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Name"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Username"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Password"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Status"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Created"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:Se.tableBody,children:ht.map((W,_e)=>c.jsxs("tr",{className:Se.tableRow,children:[c.jsx("td",{className:Se.tableCell,children:W.teacher_id}),c.jsxs("td",{className:Se.tableCell,children:[W.first_name," ",W.last_name]}),c.jsx("td",{className:Se.tableCell,children:W.username}),c.jsx("td",{className:Se.tableCell,children:W.password}),c.jsx("td",{className:Se.tableCell,children:c.jsx("span",{className:W.is_active?Se.statusActive:Se.statusInactive,children:W.is_active?"Active":"Inactive"})}),c.jsx("td",{className:Se.tableCell,children:new Date(W.created_at).toLocaleDateString()}),c.jsx("td",{className:Se.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>B(W),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>xe(W.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},W.teacher_id||_e))})]})})})]})]})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsx(it.Header,{className:Se.cardHeader,children:c.jsx(it.Title,{className:Se.cardTitle,children:"Subject Management"})}),c.jsxs(it.Body,{className:Se.cardBody,children:[c.jsxs("div",{className:Se.buttonGroup,children:[c.jsx(Ue,{variant:"primary",onClick:()=>Ze(!0),className:Se.buttonPrimary,children:"Add Subject"}),c.jsx(Ue,{variant:"secondary",onClick:()=>{pr(),_(!S)},className:Se.buttonSecondary,children:S?"Hide Subjects Table":"Get All Subjects "})]}),c.jsx(Sa,{children:Ke&&c.jsxs(Le.div,{className:Se.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),c.jsxs("form",{onSubmit:le,className:"space-y-4",children:[c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Subject Name"}),c.jsx("input",{type:"text",value:he.subject,onChange:W=>ue("subject",W.target.value),className:Se.formInput,placeholder:"Enter subject name",required:!0}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),c.jsxs("div",{className:Se.formActions,children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:()=>Ze(!1),className:Se.buttonSecondary,children:"Cancel"}),c.jsx(Ue,{type:"submit",variant:"primary",className:Se.buttonPrimary,children:"Add Subject"})]})]})]})}),M&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),c.jsx("input",{type:"text",value:Y.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),c.jsx("input",{type:"text",value:Y.username,onChange:W=>se({...Y,username:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),c.jsx("input",{type:"text",value:Y.password,onChange:W=>se({...Y,password:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),c.jsx("input",{type:"text",value:Y.first_name,onChange:W=>se({...Y,first_name:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),c.jsx("input",{type:"text",value:Y.last_name,onChange:W=>se({...Y,last_name:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:Y.is_active,onChange:W=>se({...Y,is_active:W.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),c.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>{I(null),se({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),c.jsx("button",{onClick:ie,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),L&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),c.jsx("input",{type:"text",value:G.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),c.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),c.jsx("input",{type:"text",value:G.subject,onChange:W=>O({...G,subject:W.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),c.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[c.jsx("button",{onClick:()=>z(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),c.jsx("button",{onClick:Ce,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),S&&c.jsxs("div",{className:"mt-6",children:[c.jsx("div",{className:"mb-4",children:c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",Ye.length,")"]})}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:Se.table,children:[c.jsx("thead",{className:Se.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:Se.tableHeaderCell,children:"Subject ID"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Subject Name"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:Se.tableBody,children:Ye.map((W,_e)=>c.jsxs("tr",{className:Se.tableRow,children:[c.jsx("td",{className:Se.tableCell,children:W.subject_id}),c.jsx("td",{className:Se.tableCell,children:W.subject}),c.jsx("td",{className:Se.tableCell,children:c.jsxs("div",{className:"flex space-x-2",children:[c.jsx("button",{onClick:()=>ce(W),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),c.jsx("button",{onClick:()=>Oe(W.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},W.subject_id||_e))})]})})})]})]})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsx(it.Header,{className:Se.cardHeader,children:c.jsx(it.Title,{className:Se.cardTitle,children:"Test Data Deletion"})}),c.jsxs(it.Body,{className:Se.cardBody,children:[c.jsx("div",{className:Se.buttonGroup,children:c.jsx(Ue,{variant:"danger",onClick:()=>ut(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),c.jsx(Sa,{children:ft&&c.jsxs(Le.div,{className:Se.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),c.jsxs("form",{onSubmit:mt,className:"space-y-4",children:[c.jsxs("div",{className:Se.formGrid,children:[c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Start Date *"}),c.jsx("input",{type:"date",value:st.startDate,onChange:W=>Ie("startDate",W.target.value),className:Se.formInput,required:!0})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"End Date *"}),c.jsx("input",{type:"date",value:st.endDate,onChange:W=>Ie("endDate",W.target.value),className:Se.formInput,required:!0})]})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Teacher ID *"}),c.jsxs("select",{value:st.teacherId,onChange:W=>Ie("teacherId",W.target.value),className:Se.formInput,required:!0,children:[c.jsx("option",{value:"",children:"Select a teacher"}),ht.map(W=>c.jsxs("option",{value:W.teacher_id,children:[W.teacher_id," - ",W.first_name," ",W.last_name]},W.teacher_id))]})]}),c.jsxs("div",{className:Se.formGroup,children:[c.jsx("label",{className:Se.formLabel,children:"Subject (Optional)"}),c.jsxs("select",{value:st.subjectId,onChange:W=>Ie("subjectId",W.target.value),className:Se.formInput,children:[c.jsx("option",{value:"",children:"All subjects"}),Ye.map(W=>c.jsx("option",{value:W.subject_id,children:W.subject},W.subject_id))]})]}),c.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:c.jsxs("div",{className:"flex",children:[c.jsx("div",{className:"flex-shrink-0",children:c.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:c.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),c.jsxs("div",{className:"ml-3",children:[c.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),c.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[c.jsx("p",{children:"This will permanently delete:"}),c.jsxs("ul",{className:"list-disc list-inside mt-1",children:[c.jsx("li",{children:"All test records within the date range"}),c.jsx("li",{children:"All test questions and answers"}),c.jsx("li",{children:"All test results and submissions"}),c.jsx("li",{children:"All test assignments"}),c.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),c.jsxs("div",{className:Se.formActions,children:[c.jsx(Ue,{type:"button",variant:"secondary",onClick:()=>ut(!1),className:Se.buttonSecondary,children:"Cancel"}),c.jsx(Ue,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsx(it.Header,{className:Se.cardHeader,children:c.jsx(it.Title,{className:Se.cardTitle,children:"Assignments Management"})}),c.jsxs(it.Body,{className:Se.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(Ue,{variant:"primary",onClick:Z,className:Se.buttonPrimary,children:y?"Hide Assignments Table":"Get All Assignments "})}),y&&c.jsx("div",{className:"mb-6",children:c.jsx("div",{className:"border-b border-gray-200",children:c.jsxs("nav",{className:"-mb-px flex space-x-8",children:[c.jsx("button",{onClick:()=>re(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${J?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),c.jsx("button",{onClick:()=>re(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${J?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),y&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[J?"Active":"Inactive"," Assignments (",Ht.length," of ",R.filter(W=>J?W.is_active:!W.is_active).length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:te,onChange:W=>H(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),ht.map(W=>c.jsxs("option",{value:W.teacher_id,children:[W.first_name," ",W.last_name]},W.teacher_id))]}),c.jsx("input",{type:"date",value:V,onChange:W=>q(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:Q,onChange:W=>ae(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:Se.table,children:[c.jsx("thead",{className:Se.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:Se.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Type"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Created"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:Se.tableBody,children:Ht.map((W,_e)=>c.jsxs("tr",{className:Se.tableRow,children:[c.jsx("td",{className:Se.tableCell,children:W.test_name}),c.jsx("td",{className:Se.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:W.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:Se.tableCell,children:W.teacher_name}),c.jsx("td",{className:Se.tableCell,children:W.num_questions}),c.jsx("td",{className:Se.tableCell,children:new Date(W.created_at).toLocaleDateString()}),c.jsx("td",{className:Se.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:J?c.jsx("button",{onClick:()=>qe(W.test_id,W.test_type,W.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):c.jsx("button",{onClick:()=>xt(W.test_id,W.test_type,W.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${W.test_type}-${W.test_id}-${_e}`))})]})})})]})]})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsx(it.Header,{className:Se.cardHeader,children:c.jsx(it.Title,{className:Se.cardTitle,children:"Test Management"})}),c.jsxs(it.Body,{className:Se.cardBody,children:[c.jsx("div",{className:"mb-4",children:c.jsx(Ue,{variant:"primary",onClick:Bt,className:Se.buttonPrimary,children:ve?"Hide Tests Table":"Get All Tests "})}),ve&&c.jsxs("div",{className:"mt-6",children:[c.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[c.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Pt.length," of ",Fe.length,")"]}),c.jsxs("div",{className:"flex flex-wrap gap-2",children:[c.jsxs("select",{value:Ee,onChange:W=>ke(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[c.jsx("option",{value:"",children:"All Teachers"}),ht.map(W=>c.jsxs("option",{value:W.teacher_id,children:[W.first_name," ",W.last_name]},W.teacher_id))]}),c.jsx("input",{type:"date",value:He,onChange:W=>at(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),c.jsx("input",{type:"date",value:Me,onChange:W=>Ft(W.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),c.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:c.jsx("div",{className:"overflow-x-auto max-h-96",children:c.jsxs("table",{className:Se.table,children:[c.jsx("thead",{className:Se.tableHeader,children:c.jsxs("tr",{children:[c.jsx("th",{className:Se.tableHeaderCell,children:"Test Name"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Type"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Teacher"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Questions"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Created"}),c.jsx("th",{className:Se.tableHeaderCell,children:"Actions"})]})}),c.jsx("tbody",{className:Se.tableBody,children:Pt.map((W,_e)=>c.jsxs("tr",{className:Se.tableRow,children:[c.jsx("td",{className:Se.tableCell,children:W.test_name}),c.jsx("td",{className:Se.tableCell,children:c.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:W.test_type.replace("_"," ").toUpperCase()})}),c.jsx("td",{className:Se.tableCell,children:W.teacher_name}),c.jsx("td",{className:Se.tableCell,children:W.num_questions}),c.jsx("td",{className:Se.tableCell,children:new Date(W.created_at).toLocaleDateString()}),c.jsx("td",{className:Se.tableCell,children:c.jsx("div",{className:"flex space-x-2",children:c.jsx("button",{onClick:()=>xr(W.test_id,W.test_type,W.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${W.test_type}-${W.test_id}-${_e}`))})]})})})]})]})]})}),c.jsx(Le.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:c.jsxs(it,{className:Se.cardContainer,children:[c.jsx(it.Header,{className:Se.cardHeader,children:c.jsx(it.Title,{className:Se.cardTitle,children:"Debug & Testing"})}),c.jsx(it.Body,{className:Se.cardBody})]})})]})})]})},Pge=()=>{const{isAdmin:t,getCurrentAdminId:e,logout:r}=vn(),{get:n}=ro(),{showNotification:s}=qs();b.useEffect(()=>{a()},[]);const a=b.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!t()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),l(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[t,e,r,s,n]),i=b.useCallback(()=>{console.log(" Initializing global event listeners...");const d=g=>{g.ctrlKey&&g.key==="k"&&(g.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=b.useCallback(async()=>{var d,g,h,p,x,v,w,S;try{console.log(" Loading admin data...");const[_,y,k,N]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);_.status==="fulfilled"&&((d=_.value)!=null&&d.success)&&console.log(" Users loaded:",((g=_.value.users)==null?void 0:g.length)||0),y.status==="fulfilled"&&((h=y.value)!=null&&h.success)&&console.log(" Teachers loaded:",((p=y.value.teachers)==null?void 0:p.length)||0),k.status==="fulfilled"&&((x=k.value)!=null&&x.success)&&console.log(" Subjects loaded:",((v=k.value.subjects)==null?void 0:v.length)||0),N.status==="fulfilled"&&((w=N.value)!=null&&w.success)&&console.log(" Academic years loaded:",((S=N.value.academic_years)==null?void 0:S.length)||0),console.log(" Admin data loading completed")}catch(_){throw console.error(" Error loading admin data:",_),_}},[n]),l=b.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=b.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const g=document.getElementById("allSubjectsContainer"),h=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!g){console.error(" allSubjectsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const g=document.getElementById("addSubjectForm");g&&(g.style.display="block")},window.hideAddSubjectForm=()=>{const g=document.getElementById("addSubjectForm"),h=document.getElementById("newSubjectForm");g&&(g.style.display="none"),h&&h.reset()},window.showAddAcademicYearForm=()=>{const g=document.getElementById("addAcademicYearForm");g&&(g.style.display="block")},window.hideAddAcademicYearForm=()=>{const g=document.getElementById("addAcademicYearForm"),h=document.getElementById("newAcademicYearForm");g&&(g.style.display="none"),h&&h.reset()},window.toggleUsersContent=()=>{const g=document.getElementById("allUsersContainer"),h=document.querySelector('button[onclick="toggleUsersContent()"]');if(!g){console.error(" allUsersContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const g=document.getElementById("addUserForm");g&&(g.style.display="block")},window.hideAddUserForm=()=>{const g=document.getElementById("addUserForm"),h=document.getElementById("newUserForm");g&&(g.style.display="none"),h&&h.reset()},window.showAddTeacherForm=()=>{const g=document.getElementById("addTeacherForm");g&&(g.style.display="block")},window.hideAddTeacherForm=()=>{const g=document.getElementById("addTeacherForm"),h=document.getElementById("newTeacherForm");g&&(g.style.display="none"),h&&h.reset()},window.toggleTeachersContent=()=>{const g=document.getElementById("allTeachersContainer"),h=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!g){console.error(" allTeachersContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const g=document.getElementById("allTestsContainer"),h=document.querySelector('button[onclick="toggleTestsContent()"]');if(!g){console.error(" allTestsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const g=document.getElementById("allAssignmentsContainer"),h=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!g){console.error(" allAssignmentsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const g=document.getElementById("allResultsContainer"),h=document.querySelector('button[onclick="toggleResultsContent()"]');if(!g){console.error(" allResultsContainer not found");return}if(!h){console.error(" Button not found");return}const p=g.style.display!=="none";g.style.display=p?"none":"block",h.textContent=p?"Show Results":"Hide Results"};const d={};window.toggleSection=g=>{console.log(` toggleSection called with sectionId: ${g}`);const h=Date.now();if(d[g]&&h-d[g]<300){console.log(` Ignoring rapid successive call for ${g}`);return}d[g]=h;const p=document.getElementById(g);if(!p){console.error(` Section with id '${g}' not found!`);return}const x=p.style.display!=="none";p.style.display=x?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${g}')"]`);v&&(v.textContent=x?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const g=document.querySelectorAll(".section-header");console.log(` Found ${g.length} section headers`),g.forEach((h,p)=>{const x=h.textContent.trim();if(console.log(` Processing header ${p+1}:`,x),h.dataset.listenerAdded==="true"){console.log(` Skipping header ${x} - listener already added`);return}h.addEventListener("click",()=>{const v=h.dataset.sectionId;v&&window.toggleSection(v)}),h.dataset.listenerAdded="true",console.log(` Added click listener to header: ${x}`)})},window.makeFieldEditable=g=>{const h=g.textContent;g.dataset.field;const p=document.createElement("input");p.type="text",p.value=h,p.className="editable-input";const x=document.createElement("button");x.textContent="Save",x.className="btn-save",x.onclick=()=>window.saveField(g,p,x,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{g.textContent=h,g.style.display="block",p.remove(),x.remove(),v.remove()},g.style.display="none",g.parentNode.insertBefore(p,g),g.parentNode.insertBefore(x,g),g.parentNode.insertBefore(v,g)},window.saveField=(g,h,p,x)=>{const v=h.value.trim(),w=g.dataset.field,S=g.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${w} for record ${S} with value: ${v}`),g.textContent=v,g.style.display="block",h.remove(),p.remove(),x.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const g=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(g){return console.error(" localStorage error:",g),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const g={};for(let v=0;v<localStorage.length;v++){const w=localStorage.key(v);g[w]=localStorage.getItem(w)}const h=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),p=URL.createObjectURL(h),x=document.createElement("a");x.href=p,x.download="localStorage-backup.json",x.click(),URL.revokeObjectURL(p)},console.log(" Admin functions exposed globally")},[]);return t()?c.jsx(Fge,{}):c.jsxs("div",{className:"admin-error",children:[c.jsx("h2",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access the admin dashboard."}),c.jsx("button",{onClick:r,children:"Return to Login"})]})},I2=({children:t,allowedRoles:e})=>{const{isAuthenticated:r,role:n,isLoading:s}=vn();return s?c.jsx("div",{className:"flex items-center justify-center min-h-screen",children:c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),c.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?e&&!e.includes(n)?c.jsx(zf,{to:"/unauthorized",replace:!0}):t:c.jsx(zf,{to:"/login",replace:!0})},Dge=()=>c.jsxs("div",{className:"unauthorized-page",children:[c.jsx("h1",{children:"Access Denied"}),c.jsx("p",{children:"You don't have permission to access this page."})]}),Rge=()=>c.jsx(iD,{children:c.jsx(RM,{children:c.jsx(PM,{children:c.jsx(hW,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:c.jsx("div",{className:"app",children:c.jsxs(eC,{children:[c.jsx(Mn,{path:"/login",element:c.jsx(Ere,{})}),c.jsx(Mn,{path:"/unauthorized",element:c.jsx(Dge,{})}),c.jsx(Mn,{path:"/student/*",element:c.jsx(I2,{allowedRoles:["student"],children:c.jsx(Cne,{})})}),c.jsx(Mn,{path:"/teacher/*",element:c.jsx(I2,{allowedRoles:["teacher"],children:c.jsx(jge,{})})}),c.jsx(Mn,{path:"/admin/*",element:c.jsx(I2,{allowedRoles:["admin"],children:c.jsx(Pge,{})})}),c.jsx(Mn,{path:"/",element:c.jsx(zf,{to:"/login",replace:!0})}),c.jsx(Mn,{path:"*",element:c.jsx(zf,{to:"/login",replace:!0})})]})})})})})});class Mge{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setToken(e){localStorage.setItem(this.tokenKey,e)}setRefreshToken(e){localStorage.setItem(this.refreshTokenKey,e)}setUserData(e){localStorage.setItem(this.userKey,JSON.stringify(e))}setTokens(e,r){this.setToken(e),this.setUserData({role:r}),localStorage.setItem("accessToken",e)}isAuthenticated(){const e=this.getToken();if(!e)return!1;try{const r=JSON.parse(atob(e.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const e=this.getUserData();return e?e.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const e=this.getToken();return e?`Bearer ${e}`:null}async makeAuthenticatedRequest(e,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(e,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(e,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const e=this.getRefreshToken();if(!e)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:e})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(e){try{return JSON.parse(atob(e.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},50*60*1e3)}}const nk=new Mge;window.tokenManager=nk;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{nk.init()}):nk.init());class nL{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const e=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",e),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),e?(this.currentRole=e,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let e=!1;try{const r=window.tokenManager.getAccessToken();r&&(e=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),e=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${e?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(e,r){console.log(`Function ${e} already available in main script for ${r}`),this.loadedFunctions.add(e)}setupRoleBasedUI(){let e=!1;try{const r=window.tokenManager.getAccessToken();r&&(e=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),e=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!e&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(e){const r=`Access denied. This function requires ${e} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(e){return this.blockedFunctions.has(e)}isFunctionLoaded(e){return this.loadedFunctions.has(e)}getCurrentRole(){return this.currentRole}hasRole(e){return this.currentRole===e}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const e=window.tokenManager.getUserRole();return e?(console.log("[DEBUG] Setting role after login:",e),this.currentRole=e,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",e),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new nL;typeof Gx<"u"&&Gx.exports&&(Gx.exports=nL);const Ige=()=>{console.log("[DEBUG] Initializing application with new structure");const t={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(t)),console.log("[DEBUG] Application initialized with enhanced features")},Oge=()=>{console.log("[DEBUG] Starting main application"),Ige(),O2.createRoot(document.getElementById("root")).render(c.jsx(Gn.StrictMode,{children:c.jsx(Rge,{})}))};Oge()});export default Lge();
