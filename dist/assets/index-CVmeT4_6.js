var VV=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var P3e=VV((uAe,l_)=>{function mM(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var c_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ol(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yS={exports:{}},tx={},vS={exports:{}},sn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ij;function KV(){if(Ij)return sn;Ij=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function g(W){return W===null||typeof W!="object"?null:(W=f&&W[f]||W["@@iterator"],typeof W=="function"?W:null)}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,v={};function w(W,R,z){this.props=W,this.context=R,this.refs=v,this.updater=z||p}w.prototype.isReactComponent={},w.prototype.setState=function(W,R){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,R,"setState")},w.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function C(){}C.prototype=w.prototype;function k(W,R,z){this.props=W,this.context=R,this.refs=v,this.updater=z||p}var _=k.prototype=new C;_.constructor=k,x(_,w.prototype),_.isPureReactComponent=!0;var N=Array.isArray,E=Object.prototype.hasOwnProperty,P={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function A(W,R,z){var K,J={},se=null,X=null;if(R!=null)for(K in R.ref!==void 0&&(X=R.ref),R.key!==void 0&&(se=""+R.key),R)E.call(R,K)&&!F.hasOwnProperty(K)&&(J[K]=R[K]);var ie=arguments.length-2;if(ie===1)J.children=z;else if(1<ie){for(var le=Array(ie),ce=0;ce<ie;ce++)le[ce]=arguments[ce+2];J.children=le}if(W&&W.defaultProps)for(K in ie=W.defaultProps,ie)J[K]===void 0&&(J[K]=ie[K]);return{$$typeof:e,type:W,key:se,ref:X,props:J,_owner:P.current}}function j(W,R){return{$$typeof:e,type:W.type,key:R,ref:W.ref,props:W.props,_owner:W._owner}}function I(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function L(W){var R={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(z){return R[z]})}var Y=/\/+/g;function Z(W,R){return typeof W=="object"&&W!==null&&W.key!=null?L(""+W.key):R.toString(36)}function ae(W,R,z,K,J){var se=typeof W;(se==="undefined"||se==="boolean")&&(W=null);var X=!1;if(W===null)X=!0;else switch(se){case"string":case"number":X=!0;break;case"object":switch(W.$$typeof){case e:case t:X=!0}}if(X)return X=W,J=J(X),W=K===""?"."+Z(X,0):K,N(J)?(z="",W!=null&&(z=W.replace(Y,"$&/")+"/"),ae(J,R,z,"",function(ce){return ce})):J!=null&&(I(J)&&(J=j(J,z+(!J.key||X&&X.key===J.key?"":(""+J.key).replace(Y,"$&/")+"/")+W)),R.push(J)),1;if(X=0,K=K===""?".":K+":",N(W))for(var ie=0;ie<W.length;ie++){se=W[ie];var le=K+Z(se,ie);X+=ae(se,R,z,le,J)}else if(le=g(W),typeof le=="function")for(W=le.call(W),ie=0;!(se=W.next()).done;)se=se.value,le=K+Z(se,ie++),X+=ae(se,R,z,le,J);else if(se==="object")throw R=String(W),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.");return X}function ee(W,R,z){if(W==null)return W;var K=[],J=0;return ae(W,K,"","",function(se){return R.call(z,se,J++)}),K}function ne(W){if(W._status===-1){var R=W._result;R=R(),R.then(function(z){(W._status===0||W._status===-1)&&(W._status=1,W._result=z)},function(z){(W._status===0||W._status===-1)&&(W._status=2,W._result=z)}),W._status===-1&&(W._status=0,W._result=R)}if(W._status===1)return W._result.default;throw W._result}var B={current:null},V={transition:null},M={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:V,ReactCurrentOwner:P};function H(){throw Error("act(...) is not supported in production builds of React.")}return sn.Children={map:ee,forEach:function(W,R,z){ee(W,function(){R.apply(this,arguments)},z)},count:function(W){var R=0;return ee(W,function(){R++}),R},toArray:function(W){return ee(W,function(R){return R})||[]},only:function(W){if(!I(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},sn.Component=w,sn.Fragment=r,sn.Profiler=s,sn.PureComponent=k,sn.StrictMode=n,sn.Suspense=c,sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,sn.act=H,sn.cloneElement=function(W,R,z){if(W==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+W+".");var K=x({},W.props),J=W.key,se=W.ref,X=W._owner;if(R!=null){if(R.ref!==void 0&&(se=R.ref,X=P.current),R.key!==void 0&&(J=""+R.key),W.type&&W.type.defaultProps)var ie=W.type.defaultProps;for(le in R)E.call(R,le)&&!F.hasOwnProperty(le)&&(K[le]=R[le]===void 0&&ie!==void 0?ie[le]:R[le])}var le=arguments.length-2;if(le===1)K.children=z;else if(1<le){ie=Array(le);for(var ce=0;ce<le;ce++)ie[ce]=arguments[ce+2];K.children=ie}return{$$typeof:e,type:W.type,key:J,ref:se,props:K,_owner:X}},sn.createContext=function(W){return W={$$typeof:i,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},W.Provider={$$typeof:a,_context:W},W.Consumer=W},sn.createElement=A,sn.createFactory=function(W){var R=A.bind(null,W);return R.type=W,R},sn.createRef=function(){return{current:null}},sn.forwardRef=function(W){return{$$typeof:o,render:W}},sn.isValidElement=I,sn.lazy=function(W){return{$$typeof:d,_payload:{_status:-1,_result:W},_init:ne}},sn.memo=function(W,R){return{$$typeof:u,type:W,compare:R===void 0?null:R}},sn.startTransition=function(W){var R=V.transition;V.transition={};try{W()}finally{V.transition=R}},sn.unstable_act=H,sn.useCallback=function(W,R){return B.current.useCallback(W,R)},sn.useContext=function(W){return B.current.useContext(W)},sn.useDebugValue=function(){},sn.useDeferredValue=function(W){return B.current.useDeferredValue(W)},sn.useEffect=function(W,R){return B.current.useEffect(W,R)},sn.useId=function(){return B.current.useId()},sn.useImperativeHandle=function(W,R,z){return B.current.useImperativeHandle(W,R,z)},sn.useInsertionEffect=function(W,R){return B.current.useInsertionEffect(W,R)},sn.useLayoutEffect=function(W,R){return B.current.useLayoutEffect(W,R)},sn.useMemo=function(W,R){return B.current.useMemo(W,R)},sn.useReducer=function(W,R,z){return B.current.useReducer(W,R,z)},sn.useRef=function(W){return B.current.useRef(W)},sn.useState=function(W){return B.current.useState(W)},sn.useSyncExternalStore=function(W,R,z){return B.current.useSyncExternalStore(W,R,z)},sn.useTransition=function(){return B.current.useTransition()},sn.version="18.3.1",sn}var Rj;function k0(){return Rj||(Rj=1,vS.exports=KV()),vS.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Mj;function qV(){if(Mj)return tx;Mj=1;var e=k0(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,u){var d,f={},g=null,p=null;u!==void 0&&(g=""+u),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(p=c.ref);for(d in c)n.call(c,d)&&!a.hasOwnProperty(d)&&(f[d]=c[d]);if(o&&o.defaultProps)for(d in c=o.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:o,key:g,ref:p,props:f,_owner:s.current}}return tx.Fragment=r,tx.jsx=i,tx.jsxs=i,tx}var Lj;function YV(){return Lj||(Lj=1,yS.exports=qV()),yS.exports}var l=YV(),S=k0();const Fs=Ol(S),pM=mM({__proto__:null,default:Fs},[S]);var ow={},wS={exports:{}},po={},_S={exports:{}},bS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bj;function XV(){return Bj||(Bj=1,(function(e){function t(V,M){var H=V.length;V.push(M);e:for(;0<H;){var W=H-1>>>1,R=V[W];if(0<s(R,M))V[W]=M,V[H]=R,H=W;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var M=V[0],H=V.pop();if(H!==M){V[0]=H;e:for(var W=0,R=V.length,z=R>>>1;W<z;){var K=2*(W+1)-1,J=V[K],se=K+1,X=V[se];if(0>s(J,H))se<R&&0>s(X,J)?(V[W]=X,V[se]=H,W=se):(V[W]=J,V[K]=H,W=K);else if(se<R&&0>s(X,H))V[W]=X,V[se]=H,W=se;else break e}}return M}function s(V,M){var H=V.sortIndex-M.sortIndex;return H!==0?H:V.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,g=3,p=!1,x=!1,v=!1,w=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(V){for(var M=r(u);M!==null;){if(M.callback===null)n(u);else if(M.startTime<=V)n(u),M.sortIndex=M.expirationTime,t(c,M);else break;M=r(u)}}function N(V){if(v=!1,_(V),!x)if(r(c)!==null)x=!0,ne(E);else{var M=r(u);M!==null&&B(N,M.startTime-V)}}function E(V,M){x=!1,v&&(v=!1,C(A),A=-1),p=!0;var H=g;try{for(_(M),f=r(c);f!==null&&(!(f.expirationTime>M)||V&&!L());){var W=f.callback;if(typeof W=="function"){f.callback=null,g=f.priorityLevel;var R=W(f.expirationTime<=M);M=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(c)&&n(c),_(M)}else n(c);f=r(c)}if(f!==null)var z=!0;else{var K=r(u);K!==null&&B(N,K.startTime-M),z=!1}return z}finally{f=null,g=H,p=!1}}var P=!1,F=null,A=-1,j=5,I=-1;function L(){return!(e.unstable_now()-I<j)}function Y(){if(F!==null){var V=e.unstable_now();I=V;var M=!0;try{M=F(!0,V)}finally{M?Z():(P=!1,F=null)}}else P=!1}var Z;if(typeof k=="function")Z=function(){k(Y)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,ee=ae.port2;ae.port1.onmessage=Y,Z=function(){ee.postMessage(null)}}else Z=function(){w(Y,0)};function ne(V){F=V,P||(P=!0,Z())}function B(V,M){A=w(function(){V(e.unstable_now())},M)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){x||p||(x=!0,ne(E))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(V){switch(g){case 1:case 2:case 3:var M=3;break;default:M=g}var H=g;g=M;try{return V()}finally{g=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,M){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var H=g;g=V;try{return M()}finally{g=H}},e.unstable_scheduleCallback=function(V,M,H){var W=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?W+H:W):H=W,V){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=H+R,V={id:d++,callback:M,priorityLevel:V,startTime:H,expirationTime:R,sortIndex:-1},H>W?(V.sortIndex=H,t(u,V),r(c)===null&&V===r(u)&&(v?(C(A),A=-1):v=!0,B(N,H-W))):(V.sortIndex=R,t(c,V),x||p||(x=!0,ne(E))),V},e.unstable_shouldYield=L,e.unstable_wrapCallback=function(V){var M=g;return function(){var H=g;g=M;try{return V.apply(this,arguments)}finally{g=H}}}})(bS)),bS}var $j;function fN(){return $j||($j=1,_S.exports=XV()),_S.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uj;function JV(){if(Uj)return po;Uj=1;var e=k0(),t=fN();function r(h){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+h,T=1;T<arguments.length;T++)m+="&args[]="+encodeURIComponent(arguments[T]);return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(h,m){i(h,m),i(h+"Capture",m)}function i(h,m){for(s[h]=m,h=0;h<m.length;h++)n.add(m[h])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function g(h){return c.call(f,h)?!0:c.call(d,h)?!1:u.test(h)?f[h]=!0:(d[h]=!0,!1)}function p(h,m,T,D){if(T!==null&&T.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return D?!1:T!==null?!T.acceptsBooleans:(h=h.toLowerCase().slice(0,5),h!=="data-"&&h!=="aria-");default:return!1}}function x(h,m,T,D){if(m===null||typeof m>"u"||p(h,m,T,D))return!0;if(D)return!1;if(T!==null)switch(T.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function v(h,m,T,D,G,Q,de){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=D,this.attributeNamespace=G,this.mustUseProperty=T,this.propertyName=h,this.type=m,this.sanitizeURL=Q,this.removeEmptyString=de}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(h){w[h]=new v(h,0,!1,h,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(h){var m=h[0];w[m]=new v(m,1,!1,h[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(h){w[h]=new v(h,2,!1,h.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(h){w[h]=new v(h,2,!1,h,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(h){w[h]=new v(h,3,!1,h.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(h){w[h]=new v(h,3,!0,h,null,!1,!1)}),["capture","download"].forEach(function(h){w[h]=new v(h,4,!1,h,null,!1,!1)}),["cols","rows","size","span"].forEach(function(h){w[h]=new v(h,6,!1,h,null,!1,!1)}),["rowSpan","start"].forEach(function(h){w[h]=new v(h,5,!1,h.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function k(h){return h[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(h){var m=h.replace(C,k);w[m]=new v(m,1,!1,h,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(h){var m=h.replace(C,k);w[m]=new v(m,1,!1,h,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(h){var m=h.replace(C,k);w[m]=new v(m,1,!1,h,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(h){w[h]=new v(h,1,!1,h.toLowerCase(),null,!1,!1)}),w.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(h){w[h]=new v(h,1,!1,h.toLowerCase(),null,!0,!0)});function _(h,m,T,D){var G=w.hasOwnProperty(m)?w[m]:null;(G!==null?G.type!==0:D||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(x(m,T,G,D)&&(T=null),D||G===null?g(m)&&(T===null?h.removeAttribute(m):h.setAttribute(m,""+T)):G.mustUseProperty?h[G.propertyName]=T===null?G.type===3?!1:"":T:(m=G.attributeName,D=G.attributeNamespace,T===null?h.removeAttribute(m):(G=G.type,T=G===3||G===4&&T===!0?"":""+T,D?h.setAttributeNS(D,m,T):h.setAttribute(m,T))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,E=Symbol.for("react.element"),P=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),L=Symbol.for("react.context"),Y=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),ee=Symbol.for("react.memo"),ne=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),V=Symbol.iterator;function M(h){return h===null||typeof h!="object"?null:(h=V&&h[V]||h["@@iterator"],typeof h=="function"?h:null)}var H=Object.assign,W;function R(h){if(W===void 0)try{throw Error()}catch(T){var m=T.stack.trim().match(/\n( *(at )?)/);W=m&&m[1]||""}return`
`+W+h}var z=!1;function K(h,m){if(!h||z)return"";z=!0;var T=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(dt){var D=dt}Reflect.construct(h,[],m)}else{try{m.call()}catch(dt){D=dt}h.call(m.prototype)}else{try{throw Error()}catch(dt){D=dt}h()}}catch(dt){if(dt&&D&&typeof dt.stack=="string"){for(var G=dt.stack.split(`
`),Q=D.stack.split(`
`),de=G.length-1,je=Q.length-1;1<=de&&0<=je&&G[de]!==Q[je];)je--;for(;1<=de&&0<=je;de--,je--)if(G[de]!==Q[je]){if(de!==1||je!==1)do if(de--,je--,0>je||G[de]!==Q[je]){var Re=`
`+G[de].replace(" at new "," at ");return h.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",h.displayName)),Re}while(1<=de&&0<=je);break}}}finally{z=!1,Error.prepareStackTrace=T}return(h=h?h.displayName||h.name:"")?R(h):""}function J(h){switch(h.tag){case 5:return R(h.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return h=K(h.type,!1),h;case 11:return h=K(h.type.render,!1),h;case 1:return h=K(h.type,!0),h;default:return""}}function se(h){if(h==null)return null;if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case F:return"Fragment";case P:return"Portal";case j:return"Profiler";case A:return"StrictMode";case Z:return"Suspense";case ae:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case L:return(h.displayName||"Context")+".Consumer";case I:return(h._context.displayName||"Context")+".Provider";case Y:var m=h.render;return h=h.displayName,h||(h=m.displayName||m.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case ee:return m=h.displayName||null,m!==null?m:se(h.type)||"Memo";case ne:m=h._payload,h=h._init;try{return se(h(m))}catch{}}return null}function X(h){var m=h.type;switch(h.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return h=m.render,h=h.displayName||h.name||"",m.displayName||(h!==""?"ForwardRef("+h+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(m);case 8:return m===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function ie(h){switch(typeof h){case"boolean":case"number":case"string":case"undefined":return h;case"object":return h;default:return""}}function le(h){var m=h.type;return(h=h.nodeName)&&h.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function ce(h){var m=le(h)?"checked":"value",T=Object.getOwnPropertyDescriptor(h.constructor.prototype,m),D=""+h[m];if(!h.hasOwnProperty(m)&&typeof T<"u"&&typeof T.get=="function"&&typeof T.set=="function"){var G=T.get,Q=T.set;return Object.defineProperty(h,m,{configurable:!0,get:function(){return G.call(this)},set:function(de){D=""+de,Q.call(this,de)}}),Object.defineProperty(h,m,{enumerable:T.enumerable}),{getValue:function(){return D},setValue:function(de){D=""+de},stopTracking:function(){h._valueTracker=null,delete h[m]}}}}function be(h){h._valueTracker||(h._valueTracker=ce(h))}function re(h){if(!h)return!1;var m=h._valueTracker;if(!m)return!0;var T=m.getValue(),D="";return h&&(D=le(h)?h.checked?"true":"false":h.value),h=D,h!==T?(m.setValue(h),!0):!1}function pe(h){if(h=h||(typeof document<"u"?document:void 0),typeof h>"u")return null;try{return h.activeElement||h.body}catch{return h.body}}function Ce(h,m){var T=m.checked;return H({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:T??h._wrapperState.initialChecked})}function Ae(h,m){var T=m.defaultValue==null?"":m.defaultValue,D=m.checked!=null?m.checked:m.defaultChecked;T=ie(m.value!=null?m.value:T),h._wrapperState={initialChecked:D,initialValue:T,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function We(h,m){m=m.checked,m!=null&&_(h,"checked",m,!1)}function Le(h,m){We(h,m);var T=ie(m.value),D=m.type;if(T!=null)D==="number"?(T===0&&h.value===""||h.value!=T)&&(h.value=""+T):h.value!==""+T&&(h.value=""+T);else if(D==="submit"||D==="reset"){h.removeAttribute("value");return}m.hasOwnProperty("value")?Qe(h,m.type,T):m.hasOwnProperty("defaultValue")&&Qe(h,m.type,ie(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(h.defaultChecked=!!m.defaultChecked)}function At(h,m,T){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var D=m.type;if(!(D!=="submit"&&D!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+h._wrapperState.initialValue,T||m===h.value||(h.value=m),h.defaultValue=m}T=h.name,T!==""&&(h.name=""),h.defaultChecked=!!h._wrapperState.initialChecked,T!==""&&(h.name=T)}function Qe(h,m,T){(m!=="number"||pe(h.ownerDocument)!==h)&&(T==null?h.defaultValue=""+h._wrapperState.initialValue:h.defaultValue!==""+T&&(h.defaultValue=""+T))}var gt=Array.isArray;function ht(h,m,T,D){if(h=h.options,m){m={};for(var G=0;G<T.length;G++)m["$"+T[G]]=!0;for(T=0;T<h.length;T++)G=m.hasOwnProperty("$"+h[T].value),h[T].selected!==G&&(h[T].selected=G),G&&D&&(h[T].defaultSelected=!0)}else{for(T=""+ie(T),m=null,G=0;G<h.length;G++){if(h[G].value===T){h[G].selected=!0,D&&(h[G].defaultSelected=!0);return}m!==null||h[G].disabled||(m=h[G])}m!==null&&(m.selected=!0)}}function tt(h,m){if(m.dangerouslySetInnerHTML!=null)throw Error(r(91));return H({},m,{value:void 0,defaultValue:void 0,children:""+h._wrapperState.initialValue})}function ut(h,m){var T=m.value;if(T==null){if(T=m.children,m=m.defaultValue,T!=null){if(m!=null)throw Error(r(92));if(gt(T)){if(1<T.length)throw Error(r(93));T=T[0]}m=T}m==null&&(m=""),T=m}h._wrapperState={initialValue:ie(T)}}function Dt(h,m){var T=ie(m.value),D=ie(m.defaultValue);T!=null&&(T=""+T,T!==h.value&&(h.value=T),m.defaultValue==null&&h.defaultValue!==T&&(h.defaultValue=T)),D!=null&&(h.defaultValue=""+D)}function Rt(h){var m=h.textContent;m===h._wrapperState.initialValue&&m!==""&&m!==null&&(h.value=m)}function It(h){switch(h){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function De(h,m){return h==null||h==="http://www.w3.org/1999/xhtml"?It(m):h==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":h}var Ie,Je=(function(h){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,T,D,G){MSApp.execUnsafeLocalFunction(function(){return h(m,T,D,G)})}:h})(function(h,m){if(h.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in h)h.innerHTML=m;else{for(Ie=Ie||document.createElement("div"),Ie.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=Ie.firstChild;h.firstChild;)h.removeChild(h.firstChild);for(;m.firstChild;)h.appendChild(m.firstChild)}});function qe(h,m){if(m){var T=h.firstChild;if(T&&T===h.lastChild&&T.nodeType===3){T.nodeValue=m;return}}h.textContent=m}var Ze={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tt=["Webkit","ms","Moz","O"];Object.keys(Ze).forEach(function(h){Tt.forEach(function(m){m=m+h.charAt(0).toUpperCase()+h.substring(1),Ze[m]=Ze[h]})});function Nt(h,m,T){return m==null||typeof m=="boolean"||m===""?"":T||typeof m!="number"||m===0||Ze.hasOwnProperty(h)&&Ze[h]?(""+m).trim():m+"px"}function $t(h,m){h=h.style;for(var T in m)if(m.hasOwnProperty(T)){var D=T.indexOf("--")===0,G=Nt(T,m[T],D);T==="float"&&(T="cssFloat"),D?h.setProperty(T,G):h[T]=G}}var ir=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function pr(h,m){if(m){if(ir[h]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(r(137,h));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(r(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(r(61))}if(m.style!=null&&typeof m.style!="object")throw Error(r(62))}}function Nr(h,m){if(h.indexOf("-")===-1)return typeof m.is=="string";switch(h){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dr=null;function Vt(h){return h=h.target||h.srcElement||window,h.correspondingUseElement&&(h=h.correspondingUseElement),h.nodeType===3?h.parentNode:h}var ge=null,Te=null,Fe=null;function Me(h){if(h=ah(h)){if(typeof ge!="function")throw Error(r(280));var m=h.stateNode;m&&(m=ea(m),ge(h.stateNode,h.type,m))}}function kt(h){Te?Fe?Fe.push(h):Fe=[h]:Te=h}function Pe(){if(Te){var h=Te,m=Fe;if(Fe=Te=null,Me(h),m)for(h=0;h<m.length;h++)Me(m[h])}}function He(h,m){return h(m)}function ke(){}var $e=!1;function Ue(h,m,T){if($e)return h(m,T);$e=!0;try{return He(h,m,T)}finally{$e=!1,(Te!==null||Fe!==null)&&(ke(),Pe())}}function Et(h,m){var T=h.stateNode;if(T===null)return null;var D=ea(T);if(D===null)return null;T=D[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(h=h.type,D=!(h==="button"||h==="input"||h==="select"||h==="textarea")),h=!D;break e;default:h=!1}if(h)return null;if(T&&typeof T!="function")throw Error(r(231,m,typeof T));return T}var Ft=!1;if(o)try{var zt={};Object.defineProperty(zt,"passive",{get:function(){Ft=!0}}),window.addEventListener("test",zt,zt),window.removeEventListener("test",zt,zt)}catch{Ft=!1}function fr(h,m,T,D,G,Q,de,je,Re){var dt=Array.prototype.slice.call(arguments,3);try{m.apply(T,dt)}catch(Ut){this.onError(Ut)}}var nr=!1,Dr=null,ue=!1,we=null,ye={onError:function(h){nr=!0,Dr=h}};function xe(h,m,T,D,G,Q,de,je,Re){nr=!1,Dr=null,fr.apply(ye,arguments)}function _e(h,m,T,D,G,Q,de,je,Re){if(xe.apply(this,arguments),nr){if(nr){var dt=Dr;nr=!1,Dr=null}else throw Error(r(198));ue||(ue=!0,we=dt)}}function Se(h){var m=h,T=h;if(h.alternate)for(;m.return;)m=m.return;else{h=m;do m=h,(m.flags&4098)!==0&&(T=m.return),h=m.return;while(h)}return m.tag===3?T:null}function Ve(h){if(h.tag===13){var m=h.memoizedState;if(m===null&&(h=h.alternate,h!==null&&(m=h.memoizedState)),m!==null)return m.dehydrated}return null}function lt(h){if(Se(h)!==h)throw Error(r(188))}function Ke(h){var m=h.alternate;if(!m){if(m=Se(h),m===null)throw Error(r(188));return m!==h?null:h}for(var T=h,D=m;;){var G=T.return;if(G===null)break;var Q=G.alternate;if(Q===null){if(D=G.return,D!==null){T=D;continue}break}if(G.child===Q.child){for(Q=G.child;Q;){if(Q===T)return lt(G),h;if(Q===D)return lt(G),m;Q=Q.sibling}throw Error(r(188))}if(T.return!==D.return)T=G,D=Q;else{for(var de=!1,je=G.child;je;){if(je===T){de=!0,T=G,D=Q;break}if(je===D){de=!0,D=G,T=Q;break}je=je.sibling}if(!de){for(je=Q.child;je;){if(je===T){de=!0,T=Q,D=G;break}if(je===D){de=!0,D=Q,T=G;break}je=je.sibling}if(!de)throw Error(r(189))}}if(T.alternate!==D)throw Error(r(190))}if(T.tag!==3)throw Error(r(188));return T.stateNode.current===T?h:m}function oe(h){return h=Ke(h),h!==null?fe(h):null}function fe(h){if(h.tag===5||h.tag===6)return h;for(h=h.child;h!==null;){var m=fe(h);if(m!==null)return m;h=h.sibling}return null}var Ee=t.unstable_scheduleCallback,Ne=t.unstable_cancelCallback,Ye=t.unstable_shouldYield,ot=t.unstable_requestPaint,pt=t.unstable_now,Gt=t.unstable_getCurrentPriorityLevel,xt=t.unstable_ImmediatePriority,Jt=t.unstable_UserBlockingPriority,wr=t.unstable_NormalPriority,Sr=t.unstable_LowPriority,xr=t.unstable_IdlePriority,Ir=null,rn=null;function Jr(h){if(rn&&typeof rn.onCommitFiberRoot=="function")try{rn.onCommitFiberRoot(Ir,h,void 0,(h.current.flags&128)===128)}catch{}}var he=Math.clz32?Math.clz32:Cr,vt=Math.log,kr=Math.LN2;function Cr(h){return h>>>=0,h===0?32:31-(vt(h)/kr|0)|0}var Nn=64,_n=4194304;function Zr(h){switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return h&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return h}}function Be(h,m){var T=h.pendingLanes;if(T===0)return 0;var D=0,G=h.suspendedLanes,Q=h.pingedLanes,de=T&268435455;if(de!==0){var je=de&~G;je!==0?D=Zr(je):(Q&=de,Q!==0&&(D=Zr(Q)))}else de=T&~G,de!==0?D=Zr(de):Q!==0&&(D=Zr(Q));if(D===0)return 0;if(m!==0&&m!==D&&(m&G)===0&&(G=D&-D,Q=m&-m,G>=Q||G===16&&(Q&4194240)!==0))return m;if((D&4)!==0&&(D|=T&16),m=h.entangledLanes,m!==0)for(h=h.entanglements,m&=D;0<m;)T=31-he(m),G=1<<T,D|=h[T],m&=~G;return D}function Ct(h,m){switch(h){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qt(h,m){for(var T=h.suspendedLanes,D=h.pingedLanes,G=h.expirationTimes,Q=h.pendingLanes;0<Q;){var de=31-he(Q),je=1<<de,Re=G[de];Re===-1?((je&T)===0||(je&D)!==0)&&(G[de]=Ct(je,m)):Re<=m&&(h.expiredLanes|=je),Q&=~je}}function lr(h){return h=h.pendingLanes&-1073741825,h!==0?h:h&1073741824?1073741824:0}function es(){var h=Nn;return Nn<<=1,(Nn&4194240)===0&&(Nn=64),h}function Kn(h){for(var m=[],T=0;31>T;T++)m.push(h);return m}function Mi(h,m,T){h.pendingLanes|=m,m!==536870912&&(h.suspendedLanes=0,h.pingedLanes=0),h=h.eventTimes,m=31-he(m),h[m]=T}function B0(h,m){var T=h.pendingLanes&~m;h.pendingLanes=m,h.suspendedLanes=0,h.pingedLanes=0,h.expiredLanes&=m,h.mutableReadLanes&=m,h.entangledLanes&=m,m=h.entanglements;var D=h.eventTimes;for(h=h.expirationTimes;0<T;){var G=31-he(T),Q=1<<G;m[G]=0,D[G]=-1,h[G]=-1,T&=~Q}}function Gf(h,m){var T=h.entangledLanes|=m;for(h=h.entanglements;T;){var D=31-he(T),G=1<<D;G&m|h[D]&m&&(h[D]|=m),T&=~G}}var cn=0;function su(h){return h&=-h,1<h?4<h?(h&268435455)!==0?16:536870912:4:1}var st,mt,Yt,St,br,Pt=!1,Wr=[],nn=null,rt=null,Qt=null,Lt=new Map,bn=new Map,Gr=[],Vr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function qn(h,m){switch(h){case"focusin":case"focusout":nn=null;break;case"dragenter":case"dragleave":rt=null;break;case"mouseover":case"mouseout":Qt=null;break;case"pointerover":case"pointerout":Lt.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":bn.delete(m.pointerId)}}function Mn(h,m,T,D,G,Q){return h===null||h.nativeEvent!==Q?(h={blockedOn:m,domEventName:T,eventSystemFlags:D,nativeEvent:Q,targetContainers:[G]},m!==null&&(m=ah(m),m!==null&&mt(m)),h):(h.eventSystemFlags|=D,m=h.targetContainers,G!==null&&m.indexOf(G)===-1&&m.push(G),h)}function Yn(h,m,T,D,G){switch(m){case"focusin":return nn=Mn(nn,h,m,T,D,G),!0;case"dragenter":return rt=Mn(rt,h,m,T,D,G),!0;case"mouseover":return Qt=Mn(Qt,h,m,T,D,G),!0;case"pointerover":var Q=G.pointerId;return Lt.set(Q,Mn(Lt.get(Q)||null,h,m,T,D,G)),!0;case"gotpointercapture":return Q=G.pointerId,bn.set(Q,Mn(bn.get(Q)||null,h,m,T,D,G)),!0}return!1}function oo(h){var m=kc(h.target);if(m!==null){var T=Se(m);if(T!==null){if(m=T.tag,m===13){if(m=Ve(T),m!==null){h.blockedOn=m,br(h.priority,function(){Yt(T)});return}}else if(m===3&&T.stateNode.current.memoizedState.isDehydrated){h.blockedOn=T.tag===3?T.stateNode.containerInfo:null;return}}}h.blockedOn=null}function gc(h){if(h.blockedOn!==null)return!1;for(var m=h.targetContainers;0<m.length;){var T=z0(h.domEventName,h.eventSystemFlags,m[0],h.nativeEvent);if(T===null){T=h.nativeEvent;var D=new T.constructor(T.type,T);dr=D,T.target.dispatchEvent(D),dr=null}else return m=ah(T),m!==null&&mt(m),h.blockedOn=T,!1;m.shift()}return!0}function $0(h,m,T){gc(h)&&T.delete(m)}function z2(){Pt=!1,nn!==null&&gc(nn)&&(nn=null),rt!==null&&gc(rt)&&(rt=null),Qt!==null&&gc(Qt)&&(Qt=null),Lt.forEach($0),bn.forEach($0)}function mc(h,m){h.blockedOn===m&&(h.blockedOn=null,Pt||(Pt=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,z2)))}function pi(h){function m(G){return mc(G,h)}if(0<Wr.length){mc(Wr[0],h);for(var T=1;T<Wr.length;T++){var D=Wr[T];D.blockedOn===h&&(D.blockedOn=null)}}for(nn!==null&&mc(nn,h),rt!==null&&mc(rt,h),Qt!==null&&mc(Qt,h),Lt.forEach(m),bn.forEach(m),T=0;T<Gr.length;T++)D=Gr[T],D.blockedOn===h&&(D.blockedOn=null);for(;0<Gr.length&&(T=Gr[0],T.blockedOn===null);)oo(T),T.blockedOn===null&&Gr.shift()}var vd=N.ReactCurrentBatchConfig,U0=!0;function Ao(h,m,T,D){var G=cn,Q=vd.transition;vd.transition=null;try{cn=1,wd(h,m,T,D)}finally{cn=G,vd.transition=Q}}function Ll(h,m,T,D){var G=cn,Q=vd.transition;vd.transition=null;try{cn=4,wd(h,m,T,D)}finally{cn=G,vd.transition=Q}}function wd(h,m,T,D){if(U0){var G=z0(h,m,T,D);if(G===null)sg(h,m,D,_d,T),qn(h,D);else if(Yn(G,h,m,T,D))D.stopPropagation();else if(qn(h,D),m&4&&-1<Vr.indexOf(h)){for(;G!==null;){var Q=ah(G);if(Q!==null&&st(Q),Q=z0(h,m,T,D),Q===null&&sg(h,m,D,_d,T),Q===G)break;G=Q}G!==null&&D.stopPropagation()}else sg(h,m,D,null,T)}}var _d=null;function z0(h,m,T,D){if(_d=null,h=Vt(D),h=kc(h),h!==null)if(m=Se(h),m===null)h=null;else if(T=m.tag,T===13){if(h=Ve(m),h!==null)return h;h=null}else if(T===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;h=null}else m!==h&&(h=null);return _d=h,null}function d1(h){switch(h){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gt()){case xt:return 1;case Jt:return 4;case wr:case Sr:return 16;case xr:return 536870912;default:return 16}default:return 16}}var fa=null,pc=null,Bl=null;function Vf(){if(Bl)return Bl;var h,m=pc,T=m.length,D,G="value"in fa?fa.value:fa.textContent,Q=G.length;for(h=0;h<T&&m[h]===G[h];h++);var de=T-h;for(D=1;D<=de&&m[T-D]===G[Q-D];D++);return Bl=G.slice(h,1<D?1-D:void 0)}function au(h){var m=h.keyCode;return"charCode"in h?(h=h.charCode,h===0&&m===13&&(h=13)):h=m,h===10&&(h=13),32<=h||h===13?h:0}function Va(){return!0}function Li(){return!1}function $s(h){function m(T,D,G,Q,de){this._reactName=T,this._targetInst=G,this.type=D,this.nativeEvent=Q,this.target=de,this.currentTarget=null;for(var je in h)h.hasOwnProperty(je)&&(T=h[je],this[je]=T?T(Q):Q[je]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?Va:Li,this.isPropagationStopped=Li,this}return H(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var T=this.nativeEvent;T&&(T.preventDefault?T.preventDefault():typeof T.returnValue!="unknown"&&(T.returnValue=!1),this.isDefaultPrevented=Va)},stopPropagation:function(){var T=this.nativeEvent;T&&(T.stopPropagation?T.stopPropagation():typeof T.cancelBubble!="unknown"&&(T.cancelBubble=!0),this.isPropagationStopped=Va)},persist:function(){},isPersistent:Va}),m}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(h){return h.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},jo=$s(xi),Po=H({},xi,{view:0,detail:0}),f1=$s(Po),Kf,qf,ha,Ka=H({},Po,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ou,button:0,buttons:0,relatedTarget:function(h){return h.relatedTarget===void 0?h.fromElement===h.srcElement?h.toElement:h.fromElement:h.relatedTarget},movementX:function(h){return"movementX"in h?h.movementX:(h!==ha&&(ha&&h.type==="mousemove"?(Kf=h.screenX-ha.screenX,qf=h.screenY-ha.screenY):qf=Kf=0,ha=h),Kf)},movementY:function(h){return"movementY"in h?h.movementY:qf}}),Wn=$s(Ka),Yf=H({},Ka,{dataTransfer:0}),Fo=$s(Yf),h1=H({},Po,{relatedTarget:0}),W0=$s(h1),fp=H({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),hp=$s(fp),g1=H({},xi,{clipboardData:function(h){return"clipboardData"in h?h.clipboardData:window.clipboardData}}),H0=$s(g1),m1=H({},xi,{data:0}),iu=$s(m1),gp={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},W2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},G0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function H2(h){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(h):(h=G0[h])?!!m[h]:!1}function ou(){return H2}var V0=H({},Po,{key:function(h){if(h.key){var m=gp[h.key]||h.key;if(m!=="Unidentified")return m}return h.type==="keypress"?(h=au(h),h===13?"Enter":String.fromCharCode(h)):h.type==="keydown"||h.type==="keyup"?W2[h.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ou,charCode:function(h){return h.type==="keypress"?au(h):0},keyCode:function(h){return h.type==="keydown"||h.type==="keyup"?h.keyCode:0},which:function(h){return h.type==="keypress"?au(h):h.type==="keydown"||h.type==="keyup"?h.keyCode:0}}),p1=$s(V0),x1=H({},Ka,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lu=$s(x1),y1=H({},Po,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ou}),K0=$s(y1),q0=H({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),bd=$s(q0),mp=H({},Ka,{deltaX:function(h){return"deltaX"in h?h.deltaX:"wheelDeltaX"in h?-h.wheelDeltaX:0},deltaY:function(h){return"deltaY"in h?h.deltaY:"wheelDeltaY"in h?-h.wheelDeltaY:"wheelDelta"in h?-h.wheelDelta:0},deltaZ:0,deltaMode:0}),pp=$s(mp),v1=[9,13,27,32],Xf=o&&"CompositionEvent"in window,cu=null;o&&"documentMode"in document&&(cu=document.documentMode);var Sd=o&&"TextEvent"in window&&!cu,Bi=o&&(!Xf||cu&&8<cu&&11>=cu),xc=" ",Y0=!1;function xp(h,m){switch(h){case"keyup":return v1.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Oo(h){return h=h.detail,typeof h=="object"&&"data"in h?h.data:null}var $i=!1;function yp(h,m){switch(h){case"compositionend":return Oo(m);case"keypress":return m.which!==32?null:(Y0=!0,xc);case"textInput":return h=m.data,h===xc&&Y0?null:h;default:return null}}function w1(h,m){if($i)return h==="compositionend"||!Xf&&xp(h,m)?(h=Vf(),Bl=pc=fa=null,$i=!1,h):null;switch(h){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Bi&&m.locale!=="ko"?null:m.data;default:return null}}var $l={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ul(h){var m=h&&h.nodeName&&h.nodeName.toLowerCase();return m==="input"?!!$l[h.type]:m==="textarea"}function Jf(h,m,T,D){kt(D),m=ag(m,"onChange"),0<m.length&&(T=new jo("onChange","change",null,T,D),h.push({event:T,listeners:m}))}var kd=null,yc=null;function _1(h){Ap(h,0)}function vc(h){var m=zs(h);if(re(m))return h}function lo(h,m){if(h==="change")return m}var Cd=!1;if(o){var wc;if(o){var co="oninput"in document;if(!co){var X0=document.createElement("div");X0.setAttribute("oninput","return;"),co=typeof X0.oninput=="function"}wc=co}else wc=!1;Cd=wc&&(!document.documentMode||9<document.documentMode)}function uu(){kd&&(kd.detachEvent("onpropertychange",vp),yc=kd=null)}function vp(h){if(h.propertyName==="value"&&vc(yc)){var m=[];Jf(m,yc,h,Vt(h)),Ue(_1,m)}}function wp(h,m,T){h==="focusin"?(uu(),kd=m,yc=T,kd.attachEvent("onpropertychange",vp)):h==="focusout"&&uu()}function ts(h){if(h==="selectionchange"||h==="keyup"||h==="keydown")return vc(yc)}function J0(h,m){if(h==="click")return vc(m)}function _p(h,m){if(h==="input"||h==="change")return vc(m)}function bp(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var yi=typeof Object.is=="function"?Object.is:bp;function du(h,m){if(yi(h,m))return!0;if(typeof h!="object"||h===null||typeof m!="object"||m===null)return!1;var T=Object.keys(h),D=Object.keys(m);if(T.length!==D.length)return!1;for(D=0;D<T.length;D++){var G=T[D];if(!c.call(m,G)||!yi(h[G],m[G]))return!1}return!0}function _c(h){for(;h&&h.firstChild;)h=h.firstChild;return h}function Xn(h,m){var T=_c(h);h=0;for(var D;T;){if(T.nodeType===3){if(D=h+T.textContent.length,h<=m&&D>=m)return{node:T,offset:m-h};h=D}e:{for(;T;){if(T.nextSibling){T=T.nextSibling;break e}T=T.parentNode}T=void 0}T=_c(T)}}function ks(h,m){return h&&m?h===m?!0:h&&h.nodeType===3?!1:m&&m.nodeType===3?ks(h,m.parentNode):"contains"in h?h.contains(m):h.compareDocumentPosition?!!(h.compareDocumentPosition(m)&16):!1:!1}function Us(){for(var h=window,m=pe();m instanceof h.HTMLIFrameElement;){try{var T=typeof m.contentWindow.location.href=="string"}catch{T=!1}if(T)h=m.contentWindow;else break;m=pe(h.document)}return m}function Td(h){var m=h&&h.nodeName&&h.nodeName.toLowerCase();return m&&(m==="input"&&(h.type==="text"||h.type==="search"||h.type==="tel"||h.type==="url"||h.type==="password")||m==="textarea"||h.contentEditable==="true")}function Qf(h){var m=Us(),T=h.focusedElem,D=h.selectionRange;if(m!==T&&T&&T.ownerDocument&&ks(T.ownerDocument.documentElement,T)){if(D!==null&&Td(T)){if(m=D.start,h=D.end,h===void 0&&(h=m),"selectionStart"in T)T.selectionStart=m,T.selectionEnd=Math.min(h,T.value.length);else if(h=(m=T.ownerDocument||document)&&m.defaultView||window,h.getSelection){h=h.getSelection();var G=T.textContent.length,Q=Math.min(D.start,G);D=D.end===void 0?Q:Math.min(D.end,G),!h.extend&&Q>D&&(G=D,D=Q,Q=G),G=Xn(T,Q);var de=Xn(T,D);G&&de&&(h.rangeCount!==1||h.anchorNode!==G.node||h.anchorOffset!==G.offset||h.focusNode!==de.node||h.focusOffset!==de.offset)&&(m=m.createRange(),m.setStart(G.node,G.offset),h.removeAllRanges(),Q>D?(h.addRange(m),h.extend(de.node,de.offset)):(m.setEnd(de.node,de.offset),h.addRange(m)))}}for(m=[],h=T;h=h.parentNode;)h.nodeType===1&&m.push({element:h,left:h.scrollLeft,top:h.scrollTop});for(typeof T.focus=="function"&&T.focus(),T=0;T<m.length;T++)h=m[T],h.element.scrollLeft=h.left,h.element.scrollTop=h.top}}var Zf=o&&"documentMode"in document&&11>=document.documentMode,Ed=null,Zs=null,fu=null,eh=!1;function Q0(h,m,T){var D=T.window===T?T.document:T.nodeType===9?T:T.ownerDocument;eh||Ed==null||Ed!==pe(D)||(D=Ed,"selectionStart"in D&&Td(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),fu&&du(fu,D)||(fu=D,D=ag(Zs,"onSelect"),0<D.length&&(m=new jo("onSelect","select",null,m,T),h.push({event:m,listeners:D}),m.target=Ed)))}function Ui(h,m){var T={};return T[h.toLowerCase()]=m.toLowerCase(),T["Webkit"+h]="webkit"+m,T["Moz"+h]="moz"+m,T}var ga={animationend:Ui("Animation","AnimationEnd"),animationiteration:Ui("Animation","AnimationIteration"),animationstart:Ui("Animation","AnimationStart"),transitionend:Ui("Transition","TransitionEnd")},hu={},Z0={};o&&(Z0=document.createElement("div").style,"AnimationEvent"in window||(delete ga.animationend.animation,delete ga.animationiteration.animation,delete ga.animationstart.animation),"TransitionEvent"in window||delete ga.transitionend.transition);function Nd(h){if(hu[h])return hu[h];if(!ga[h])return h;var m=ga[h],T;for(T in m)if(m.hasOwnProperty(T)&&T in Z0)return hu[h]=m[T];return h}var Sp=Nd("animationend"),kp=Nd("animationiteration"),Cp=Nd("animationstart"),Tp=Nd("transitionend"),Ep=new Map,Np="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zl(h,m){Ep.set(h,m),a(m,[h])}for(var eg=0;eg<Np.length;eg++){var gu=Np[eg],b1=gu.toLowerCase(),tg=gu[0].toUpperCase()+gu.slice(1);zl(b1,"on"+tg)}zl(Sp,"onAnimationEnd"),zl(kp,"onAnimationIteration"),zl(Cp,"onAnimationStart"),zl("dblclick","onDoubleClick"),zl("focusin","onFocus"),zl("focusout","onBlur"),zl(Tp,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S1=new Set("cancel close invalid load scroll toggle".split(" ").concat(bc));function rg(h,m,T){var D=h.type||"unknown-event";h.currentTarget=T,_e(D,m,void 0,h),h.currentTarget=null}function Ap(h,m){m=(m&4)!==0;for(var T=0;T<h.length;T++){var D=h[T],G=D.event;D=D.listeners;e:{var Q=void 0;if(m)for(var de=D.length-1;0<=de;de--){var je=D[de],Re=je.instance,dt=je.currentTarget;if(je=je.listener,Re!==Q&&G.isPropagationStopped())break e;rg(G,je,dt),Q=Re}else for(de=0;de<D.length;de++){if(je=D[de],Re=je.instance,dt=je.currentTarget,je=je.listener,Re!==Q&&G.isPropagationStopped())break e;rg(G,je,dt),Q=Re}}}if(ue)throw h=we,ue=!1,we=null,h}function Ln(h,m){var T=m[og];T===void 0&&(T=m[og]=new Set);var D=h+"__bubble";T.has(D)||(jp(m,h,2,!1),T.add(D))}function ng(h,m,T){var D=0;m&&(D|=4),jp(T,h,D,m)}var th="_reactListening"+Math.random().toString(36).slice(2);function mu(h){if(!h[th]){h[th]=!0,n.forEach(function(T){T!=="selectionchange"&&(S1.has(T)||ng(T,!1,h),ng(T,!0,h))});var m=h.nodeType===9?h:h.ownerDocument;m===null||m[th]||(m[th]=!0,ng("selectionchange",!1,m))}}function jp(h,m,T,D){switch(d1(m)){case 1:var G=Ao;break;case 4:G=Ll;break;default:G=wd}T=G.bind(null,m,T,h),G=void 0,!Ft||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(G=!0),D?G!==void 0?h.addEventListener(m,T,{capture:!0,passive:G}):h.addEventListener(m,T,!0):G!==void 0?h.addEventListener(m,T,{passive:G}):h.addEventListener(m,T,!1)}function sg(h,m,T,D,G){var Q=D;if((m&1)===0&&(m&2)===0&&D!==null)e:for(;;){if(D===null)return;var de=D.tag;if(de===3||de===4){var je=D.stateNode.containerInfo;if(je===G||je.nodeType===8&&je.parentNode===G)break;if(de===4)for(de=D.return;de!==null;){var Re=de.tag;if((Re===3||Re===4)&&(Re=de.stateNode.containerInfo,Re===G||Re.nodeType===8&&Re.parentNode===G))return;de=de.return}for(;je!==null;){if(de=kc(je),de===null)return;if(Re=de.tag,Re===5||Re===6){D=Q=de;continue e}je=je.parentNode}}D=D.return}Ue(function(){var dt=Q,Ut=Vt(T),Ht=[];e:{var Bt=Ep.get(h);if(Bt!==void 0){var cr=jo,yr=h;switch(h){case"keypress":if(au(T)===0)break e;case"keydown":case"keyup":cr=p1;break;case"focusin":yr="focus",cr=W0;break;case"focusout":yr="blur",cr=W0;break;case"beforeblur":case"afterblur":cr=W0;break;case"click":if(T.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":cr=Wn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":cr=Fo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":cr=K0;break;case Sp:case kp:case Cp:cr=hp;break;case Tp:cr=bd;break;case"scroll":cr=f1;break;case"wheel":cr=pp;break;case"copy":case"cut":case"paste":cr=H0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":cr=lu}var vr=(m&4)!==0,Vs=!vr&&h==="scroll",nt=vr?Bt!==null?Bt+"Capture":null:Bt;vr=[];for(var ze=dt,it;ze!==null;){it=ze;var Xt=it.stateNode;if(it.tag===5&&Xt!==null&&(it=Xt,nt!==null&&(Xt=Et(ze,nt),Xt!=null&&vr.push(Ad(ze,Xt,it)))),Vs)break;ze=ze.return}0<vr.length&&(Bt=new cr(Bt,yr,null,T,Ut),Ht.push({event:Bt,listeners:vr}))}}if((m&7)===0){e:{if(Bt=h==="mouseover"||h==="pointerover",cr=h==="mouseout"||h==="pointerout",Bt&&T!==dr&&(yr=T.relatedTarget||T.fromElement)&&(kc(yr)||yr[el]))break e;if((cr||Bt)&&(Bt=Ut.window===Ut?Ut:(Bt=Ut.ownerDocument)?Bt.defaultView||Bt.parentWindow:window,cr?(yr=T.relatedTarget||T.toElement,cr=dt,yr=yr?kc(yr):null,yr!==null&&(Vs=Se(yr),yr!==Vs||yr.tag!==5&&yr.tag!==6)&&(yr=null)):(cr=null,yr=dt),cr!==yr)){if(vr=Wn,Xt="onMouseLeave",nt="onMouseEnter",ze="mouse",(h==="pointerout"||h==="pointerover")&&(vr=lu,Xt="onPointerLeave",nt="onPointerEnter",ze="pointer"),Vs=cr==null?Bt:zs(cr),it=yr==null?Bt:zs(yr),Bt=new vr(Xt,ze+"leave",cr,T,Ut),Bt.target=Vs,Bt.relatedTarget=it,Xt=null,kc(Ut)===dt&&(vr=new vr(nt,ze+"enter",yr,T,Ut),vr.target=it,vr.relatedTarget=Vs,Xt=vr),Vs=Xt,cr&&yr)t:{for(vr=cr,nt=yr,ze=0,it=vr;it;it=pu(it))ze++;for(it=0,Xt=nt;Xt;Xt=pu(Xt))it++;for(;0<ze-it;)vr=pu(vr),ze--;for(;0<it-ze;)nt=pu(nt),it--;for(;ze--;){if(vr===nt||nt!==null&&vr===nt.alternate)break t;vr=pu(vr),nt=pu(nt)}vr=null}else vr=null;cr!==null&&k1(Ht,Bt,cr,vr,!1),yr!==null&&Vs!==null&&k1(Ht,Vs,yr,vr,!0)}}e:{if(Bt=dt?zs(dt):window,cr=Bt.nodeName&&Bt.nodeName.toLowerCase(),cr==="select"||cr==="input"&&Bt.type==="file")var _r=lo;else if(Ul(Bt))if(Cd)_r=_p;else{_r=ts;var Ar=wp}else(cr=Bt.nodeName)&&cr.toLowerCase()==="input"&&(Bt.type==="checkbox"||Bt.type==="radio")&&(_r=J0);if(_r&&(_r=_r(h,dt))){Jf(Ht,_r,T,Ut);break e}Ar&&Ar(h,Bt,dt),h==="focusout"&&(Ar=Bt._wrapperState)&&Ar.controlled&&Bt.type==="number"&&Qe(Bt,"number",Bt.value)}switch(Ar=dt?zs(dt):window,h){case"focusin":(Ul(Ar)||Ar.contentEditable==="true")&&(Ed=Ar,Zs=dt,fu=null);break;case"focusout":fu=Zs=Ed=null;break;case"mousedown":eh=!0;break;case"contextmenu":case"mouseup":case"dragend":eh=!1,Q0(Ht,T,Ut);break;case"selectionchange":if(Zf)break;case"keydown":case"keyup":Q0(Ht,T,Ut)}var jr;if(Xf)e:{switch(h){case"compositionstart":var Br="onCompositionStart";break e;case"compositionend":Br="onCompositionEnd";break e;case"compositionupdate":Br="onCompositionUpdate";break e}Br=void 0}else $i?xp(h,T)&&(Br="onCompositionEnd"):h==="keydown"&&T.keyCode===229&&(Br="onCompositionStart");Br&&(Bi&&T.locale!=="ko"&&($i||Br!=="onCompositionStart"?Br==="onCompositionEnd"&&$i&&(jr=Vf()):(fa=Ut,pc="value"in fa?fa.value:fa.textContent,$i=!0)),Ar=ag(dt,Br),0<Ar.length&&(Br=new iu(Br,h,null,T,Ut),Ht.push({event:Br,listeners:Ar}),jr?Br.data=jr:(jr=Oo(T),jr!==null&&(Br.data=jr)))),(jr=Sd?yp(h,T):w1(h,T))&&(dt=ag(dt,"onBeforeInput"),0<dt.length&&(Ut=new iu("onBeforeInput","beforeinput",null,T,Ut),Ht.push({event:Ut,listeners:dt}),Ut.data=jr))}Ap(Ht,m)})}function Ad(h,m,T){return{instance:h,listener:m,currentTarget:T}}function ag(h,m){for(var T=m+"Capture",D=[];h!==null;){var G=h,Q=G.stateNode;G.tag===5&&Q!==null&&(G=Q,Q=Et(h,T),Q!=null&&D.unshift(Ad(h,Q,G)),Q=Et(h,m),Q!=null&&D.push(Ad(h,Q,G))),h=h.return}return D}function pu(h){if(h===null)return null;do h=h.return;while(h&&h.tag!==5);return h||null}function k1(h,m,T,D,G){for(var Q=m._reactName,de=[];T!==null&&T!==D;){var je=T,Re=je.alternate,dt=je.stateNode;if(Re!==null&&Re===D)break;je.tag===5&&dt!==null&&(je=dt,G?(Re=Et(T,Q),Re!=null&&de.unshift(Ad(T,Re,je))):G||(Re=Et(T,Q),Re!=null&&de.push(Ad(T,Re,je)))),T=T.return}de.length!==0&&h.push({event:m,listeners:de})}var G2=/\r\n?/g,C1=/\u0000|\uFFFD/g;function Pp(h){return(typeof h=="string"?h:""+h).replace(G2,`
`).replace(C1,"")}function rh(h,m,T){if(m=Pp(m),Pp(h)!==m&&T)throw Error(r(425))}function xu(){}var Fp=null,Op=null;function Dp(h,m){return h==="textarea"||h==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var zi=typeof setTimeout=="function"?setTimeout:void 0,Ip=typeof clearTimeout=="function"?clearTimeout:void 0,nh=typeof Promise=="function"?Promise:void 0,T1=typeof queueMicrotask=="function"?queueMicrotask:typeof nh<"u"?function(h){return nh.resolve(null).then(h).catch(E1)}:zi;function E1(h){setTimeout(function(){throw h})}function ig(h,m){var T=m,D=0;do{var G=T.nextSibling;if(h.removeChild(T),G&&G.nodeType===8)if(T=G.data,T==="/$"){if(D===0){h.removeChild(G),pi(m);return}D--}else T!=="$"&&T!=="$?"&&T!=="$!"||D++;T=G}while(T);pi(m)}function Zo(h){for(;h!=null;h=h.nextSibling){var m=h.nodeType;if(m===1||m===3)break;if(m===8){if(m=h.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return h}function yu(h){h=h.previousSibling;for(var m=0;h;){if(h.nodeType===8){var T=h.data;if(T==="$"||T==="$!"||T==="$?"){if(m===0)return h;m--}else T==="/$"&&m++}h=h.previousSibling}return null}var Sc=Math.random().toString(36).slice(2),uo="__reactFiber$"+Sc,sh="__reactProps$"+Sc,el="__reactContainer$"+Sc,og="__reactEvents$"+Sc,N1="__reactListeners$"+Sc,A1="__reactHandles$"+Sc;function kc(h){var m=h[uo];if(m)return m;for(var T=h.parentNode;T;){if(m=T[el]||T[uo]){if(T=m.alternate,m.child!==null||T!==null&&T.child!==null)for(h=yu(h);h!==null;){if(T=h[uo])return T;h=yu(h)}return m}h=T,T=h.parentNode}return null}function ah(h){return h=h[uo]||h[el],!h||h.tag!==5&&h.tag!==6&&h.tag!==13&&h.tag!==3?null:h}function zs(h){if(h.tag===5||h.tag===6)return h.stateNode;throw Error(r(33))}function ea(h){return h[sh]||null}var lg=[],vu=-1;function Wl(h){return{current:h}}function Bn(h){0>vu||(h.current=lg[vu],lg[vu]=null,vu--)}function An(h,m){vu++,lg[vu]=h.current,h.current=m}var tl={},ma=Wl(tl),Ea=Wl(!1),Cc=tl;function wu(h,m){var T=h.type.contextTypes;if(!T)return tl;var D=h.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===m)return D.__reactInternalMemoizedMaskedChildContext;var G={},Q;for(Q in T)G[Q]=m[Q];return D&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=m,h.__reactInternalMemoizedMaskedChildContext=G),G}function Na(h){return h=h.childContextTypes,h!=null}function jd(){Bn(Ea),Bn(ma)}function Rp(h,m,T){if(ma.current!==tl)throw Error(r(168));An(ma,m),An(Ea,T)}function cg(h,m,T){var D=h.stateNode;if(m=m.childContextTypes,typeof D.getChildContext!="function")return T;D=D.getChildContext();for(var G in D)if(!(G in m))throw Error(r(108,X(h)||"Unknown",G));return H({},T,D)}function _u(h){return h=(h=h.stateNode)&&h.__reactInternalMemoizedMergedChildContext||tl,Cc=ma.current,An(ma,h),An(Ea,Ea.current),!0}function j1(h,m,T){var D=h.stateNode;if(!D)throw Error(r(169));T?(h=cg(h,m,Cc),D.__reactInternalMemoizedMergedChildContext=h,Bn(Ea),Bn(ma),An(ma,h)):Bn(Ea),An(Ea,T)}var rl=null,Pd=!1,ug=!1;function ih(h){rl===null?rl=[h]:rl.push(h)}function Hl(h){Pd=!0,ih(h)}function Tc(){if(!ug&&rl!==null){ug=!0;var h=0,m=cn;try{var T=rl;for(cn=1;h<T.length;h++){var D=T[h];do D=D(!0);while(D!==null)}rl=null,Pd=!1}catch(G){throw rl!==null&&(rl=rl.slice(h+1)),Ee(xt,Tc),G}finally{cn=m,ug=!1}}return null}var qa=[],bu=0,Ec=null,Nc=0,Ya=[],Xa=0,Ac=null,Wi=1,Jn="";function Su(h,m){qa[bu++]=Nc,qa[bu++]=Ec,Ec=h,Nc=m}function P1(h,m,T){Ya[Xa++]=Wi,Ya[Xa++]=Jn,Ya[Xa++]=Ac,Ac=h;var D=Wi;h=Jn;var G=32-he(D)-1;D&=~(1<<G),T+=1;var Q=32-he(m)+G;if(30<Q){var de=G-G%5;Q=(D&(1<<de)-1).toString(32),D>>=de,G-=de,Wi=1<<32-he(m)+G|T<<G|D,Jn=Q+h}else Wi=1<<Q|T<<G|D,Jn=h}function Fd(h){h.return!==null&&(Su(h,1),P1(h,1,0))}function ta(h){for(;h===Ec;)Ec=qa[--bu],qa[bu]=null,Nc=qa[--bu],qa[bu]=null;for(;h===Ac;)Ac=Ya[--Xa],Ya[Xa]=null,Jn=Ya[--Xa],Ya[Xa]=null,Wi=Ya[--Xa],Ya[Xa]=null}var Hi=null,sr=null,Sn=!1,Gi=null;function Mp(h,m){var T=cl(5,null,null,0);T.elementType="DELETED",T.stateNode=m,T.return=h,m=h.deletions,m===null?(h.deletions=[T],h.flags|=16):m.push(T)}function F1(h,m){switch(h.tag){case 5:var T=h.type;return m=m.nodeType!==1||T.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(h.stateNode=m,Hi=h,sr=Zo(m.firstChild),!0):!1;case 6:return m=h.pendingProps===""||m.nodeType!==3?null:m,m!==null?(h.stateNode=m,Hi=h,sr=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(T=Ac!==null?{id:Wi,overflow:Jn}:null,h.memoizedState={dehydrated:m,treeContext:T,retryLane:1073741824},T=cl(18,null,null,0),T.stateNode=m,T.return=h,h.child=T,Hi=h,sr=null,!0):!1;default:return!1}}function ku(h){return(h.mode&1)!==0&&(h.flags&128)===0}function Od(h){if(Sn){var m=sr;if(m){var T=m;if(!F1(h,m)){if(ku(h))throw Error(r(418));m=Zo(T.nextSibling);var D=Hi;m&&F1(h,m)?Mp(D,T):(h.flags=h.flags&-4097|2,Sn=!1,Hi=h)}}else{if(ku(h))throw Error(r(418));h.flags=h.flags&-4097|2,Sn=!1,Hi=h}}}function dg(h){for(h=h.return;h!==null&&h.tag!==5&&h.tag!==3&&h.tag!==13;)h=h.return;Hi=h}function oh(h){if(h!==Hi)return!1;if(!Sn)return dg(h),Sn=!0,!1;var m;if((m=h.tag!==3)&&!(m=h.tag!==5)&&(m=h.type,m=m!=="head"&&m!=="body"&&!Dp(h.type,h.memoizedProps)),m&&(m=sr)){if(ku(h))throw Lp(),Error(r(418));for(;m;)Mp(h,m),m=Zo(m.nextSibling)}if(dg(h),h.tag===13){if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(r(317));e:{for(h=h.nextSibling,m=0;h;){if(h.nodeType===8){var T=h.data;if(T==="/$"){if(m===0){sr=Zo(h.nextSibling);break e}m--}else T!=="$"&&T!=="$!"&&T!=="$?"||m++}h=h.nextSibling}sr=null}}else sr=Hi?Zo(h.stateNode.nextSibling):null;return!0}function Lp(){for(var h=sr;h;)h=Zo(h.nextSibling)}function Cu(){sr=Hi=null,Sn=!1}function lh(h){Gi===null?Gi=[h]:Gi.push(h)}var Bp=N.ReactCurrentBatchConfig;function xs(h,m,T){if(h=T.ref,h!==null&&typeof h!="function"&&typeof h!="object"){if(T._owner){if(T=T._owner,T){if(T.tag!==1)throw Error(r(309));var D=T.stateNode}if(!D)throw Error(r(147,h));var G=D,Q=""+h;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===Q?m.ref:(m=function(de){var je=G.refs;de===null?delete je[Q]:je[Q]=de},m._stringRef=Q,m)}if(typeof h!="string")throw Error(r(284));if(!T._owner)throw Error(r(290,h))}return h}function vi(h,m){throw h=Object.prototype.toString.call(m),Error(r(31,h==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":h))}function Do(h){var m=h._init;return m(h._payload)}function fg(h){function m(nt,ze){if(h){var it=nt.deletions;it===null?(nt.deletions=[ze],nt.flags|=16):it.push(ze)}}function T(nt,ze){if(!h)return null;for(;ze!==null;)m(nt,ze),ze=ze.sibling;return null}function D(nt,ze){for(nt=new Map;ze!==null;)ze.key!==null?nt.set(ze.key,ze):nt.set(ze.index,ze),ze=ze.sibling;return nt}function G(nt,ze){return nt=Zd(nt,ze),nt.index=0,nt.sibling=null,nt}function Q(nt,ze,it){return nt.index=it,h?(it=nt.alternate,it!==null?(it=it.index,it<ze?(nt.flags|=2,ze):it):(nt.flags|=2,ze)):(nt.flags|=1048576,ze)}function de(nt){return h&&nt.alternate===null&&(nt.flags|=2),nt}function je(nt,ze,it,Xt){return ze===null||ze.tag!==6?(ze=fS(it,nt.mode,Xt),ze.return=nt,ze):(ze=G(ze,it),ze.return=nt,ze)}function Re(nt,ze,it,Xt){var _r=it.type;return _r===F?Ut(nt,ze,it.props.children,Xt,it.key):ze!==null&&(ze.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===ne&&Do(_r)===ze.type)?(Xt=G(ze,it.props),Xt.ref=xs(nt,ze,it),Xt.return=nt,Xt):(Xt=Z1(it.type,it.key,it.props,null,nt.mode,Xt),Xt.ref=xs(nt,ze,it),Xt.return=nt,Xt)}function dt(nt,ze,it,Xt){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==it.containerInfo||ze.stateNode.implementation!==it.implementation?(ze=hS(it,nt.mode,Xt),ze.return=nt,ze):(ze=G(ze,it.children||[]),ze.return=nt,ze)}function Ut(nt,ze,it,Xt,_r){return ze===null||ze.tag!==7?(ze=vh(it,nt.mode,Xt,_r),ze.return=nt,ze):(ze=G(ze,it),ze.return=nt,ze)}function Ht(nt,ze,it){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ze=fS(""+ze,nt.mode,it),ze.return=nt,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case E:return it=Z1(ze.type,ze.key,ze.props,null,nt.mode,it),it.ref=xs(nt,null,ze),it.return=nt,it;case P:return ze=hS(ze,nt.mode,it),ze.return=nt,ze;case ne:var Xt=ze._init;return Ht(nt,Xt(ze._payload),it)}if(gt(ze)||M(ze))return ze=vh(ze,nt.mode,it,null),ze.return=nt,ze;vi(nt,ze)}return null}function Bt(nt,ze,it,Xt){var _r=ze!==null?ze.key:null;if(typeof it=="string"&&it!==""||typeof it=="number")return _r!==null?null:je(nt,ze,""+it,Xt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case E:return it.key===_r?Re(nt,ze,it,Xt):null;case P:return it.key===_r?dt(nt,ze,it,Xt):null;case ne:return _r=it._init,Bt(nt,ze,_r(it._payload),Xt)}if(gt(it)||M(it))return _r!==null?null:Ut(nt,ze,it,Xt,null);vi(nt,it)}return null}function cr(nt,ze,it,Xt,_r){if(typeof Xt=="string"&&Xt!==""||typeof Xt=="number")return nt=nt.get(it)||null,je(ze,nt,""+Xt,_r);if(typeof Xt=="object"&&Xt!==null){switch(Xt.$$typeof){case E:return nt=nt.get(Xt.key===null?it:Xt.key)||null,Re(ze,nt,Xt,_r);case P:return nt=nt.get(Xt.key===null?it:Xt.key)||null,dt(ze,nt,Xt,_r);case ne:var Ar=Xt._init;return cr(nt,ze,it,Ar(Xt._payload),_r)}if(gt(Xt)||M(Xt))return nt=nt.get(it)||null,Ut(ze,nt,Xt,_r,null);vi(ze,Xt)}return null}function yr(nt,ze,it,Xt){for(var _r=null,Ar=null,jr=ze,Br=ze=0,Da=null;jr!==null&&Br<it.length;Br++){jr.index>Br?(Da=jr,jr=null):Da=jr.sibling;var xn=Bt(nt,jr,it[Br],Xt);if(xn===null){jr===null&&(jr=Da);break}h&&jr&&xn.alternate===null&&m(nt,jr),ze=Q(xn,ze,Br),Ar===null?_r=xn:Ar.sibling=xn,Ar=xn,jr=Da}if(Br===it.length)return T(nt,jr),Sn&&Su(nt,Br),_r;if(jr===null){for(;Br<it.length;Br++)jr=Ht(nt,it[Br],Xt),jr!==null&&(ze=Q(jr,ze,Br),Ar===null?_r=jr:Ar.sibling=jr,Ar=jr);return Sn&&Su(nt,Br),_r}for(jr=D(nt,jr);Br<it.length;Br++)Da=cr(jr,nt,Br,it[Br],Xt),Da!==null&&(h&&Da.alternate!==null&&jr.delete(Da.key===null?Br:Da.key),ze=Q(Da,ze,Br),Ar===null?_r=Da:Ar.sibling=Da,Ar=Da);return h&&jr.forEach(function(ef){return m(nt,ef)}),Sn&&Su(nt,Br),_r}function vr(nt,ze,it,Xt){var _r=M(it);if(typeof _r!="function")throw Error(r(150));if(it=_r.call(it),it==null)throw Error(r(151));for(var Ar=_r=null,jr=ze,Br=ze=0,Da=null,xn=it.next();jr!==null&&!xn.done;Br++,xn=it.next()){jr.index>Br?(Da=jr,jr=null):Da=jr.sibling;var ef=Bt(nt,jr,xn.value,Xt);if(ef===null){jr===null&&(jr=Da);break}h&&jr&&ef.alternate===null&&m(nt,jr),ze=Q(ef,ze,Br),Ar===null?_r=ef:Ar.sibling=ef,Ar=ef,jr=Da}if(xn.done)return T(nt,jr),Sn&&Su(nt,Br),_r;if(jr===null){for(;!xn.done;Br++,xn=it.next())xn=Ht(nt,xn.value,Xt),xn!==null&&(ze=Q(xn,ze,Br),Ar===null?_r=xn:Ar.sibling=xn,Ar=xn);return Sn&&Su(nt,Br),_r}for(jr=D(nt,jr);!xn.done;Br++,xn=it.next())xn=cr(jr,nt,Br,xn.value,Xt),xn!==null&&(h&&xn.alternate!==null&&jr.delete(xn.key===null?Br:xn.key),ze=Q(xn,ze,Br),Ar===null?_r=xn:Ar.sibling=xn,Ar=xn);return h&&jr.forEach(function(GV){return m(nt,GV)}),Sn&&Su(nt,Br),_r}function Vs(nt,ze,it,Xt){if(typeof it=="object"&&it!==null&&it.type===F&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case E:e:{for(var _r=it.key,Ar=ze;Ar!==null;){if(Ar.key===_r){if(_r=it.type,_r===F){if(Ar.tag===7){T(nt,Ar.sibling),ze=G(Ar,it.props.children),ze.return=nt,nt=ze;break e}}else if(Ar.elementType===_r||typeof _r=="object"&&_r!==null&&_r.$$typeof===ne&&Do(_r)===Ar.type){T(nt,Ar.sibling),ze=G(Ar,it.props),ze.ref=xs(nt,Ar,it),ze.return=nt,nt=ze;break e}T(nt,Ar);break}else m(nt,Ar);Ar=Ar.sibling}it.type===F?(ze=vh(it.props.children,nt.mode,Xt,it.key),ze.return=nt,nt=ze):(Xt=Z1(it.type,it.key,it.props,null,nt.mode,Xt),Xt.ref=xs(nt,ze,it),Xt.return=nt,nt=Xt)}return de(nt);case P:e:{for(Ar=it.key;ze!==null;){if(ze.key===Ar)if(ze.tag===4&&ze.stateNode.containerInfo===it.containerInfo&&ze.stateNode.implementation===it.implementation){T(nt,ze.sibling),ze=G(ze,it.children||[]),ze.return=nt,nt=ze;break e}else{T(nt,ze);break}else m(nt,ze);ze=ze.sibling}ze=hS(it,nt.mode,Xt),ze.return=nt,nt=ze}return de(nt);case ne:return Ar=it._init,Vs(nt,ze,Ar(it._payload),Xt)}if(gt(it))return yr(nt,ze,it,Xt);if(M(it))return vr(nt,ze,it,Xt);vi(nt,it)}return typeof it=="string"&&it!==""||typeof it=="number"?(it=""+it,ze!==null&&ze.tag===6?(T(nt,ze.sibling),ze=G(ze,it),ze.return=nt,nt=ze):(T(nt,ze),ze=fS(it,nt.mode,Xt),ze.return=nt,nt=ze),de(nt)):T(nt,ze)}return Vs}var Tu=fg(!0),fo=fg(!1),ch=Wl(null),Vi=null,Dd=null,hg=null;function gg(){hg=Dd=Vi=null}function mg(h){var m=ch.current;Bn(ch),h._currentValue=m}function pg(h,m,T){for(;h!==null;){var D=h.alternate;if((h.childLanes&m)!==m?(h.childLanes|=m,D!==null&&(D.childLanes|=m)):D!==null&&(D.childLanes&m)!==m&&(D.childLanes|=m),h===T)break;h=h.return}}function Gl(h,m){Vi=h,hg=Dd=null,h=h.dependencies,h!==null&&h.firstContext!==null&&((h.lanes&m)!==0&&(te=!0),h.firstContext=null)}function Ja(h){var m=h._currentValue;if(hg!==h)if(h={context:h,memoizedValue:m,next:null},Dd===null){if(Vi===null)throw Error(r(308));Dd=h,Vi.dependencies={lanes:0,firstContext:h}}else Dd=Dd.next=h;return m}var nl=null;function Id(h){nl===null?nl=[h]:nl.push(h)}function uh(h,m,T,D){var G=m.interleaved;return G===null?(T.next=T,Id(m)):(T.next=G.next,G.next=T),m.interleaved=T,Ki(h,D)}function Ki(h,m){h.lanes|=m;var T=h.alternate;for(T!==null&&(T.lanes|=m),T=h,h=h.return;h!==null;)h.childLanes|=m,T=h.alternate,T!==null&&(T.childLanes|=m),T=h,h=h.return;return T.tag===3?T.stateNode:null}var sl=!1;function dh(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xg(h,m){h=h.updateQueue,m.updateQueue===h&&(m.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,effects:h.effects})}function al(h,m){return{eventTime:h,lane:m,tag:0,payload:null,callback:null,next:null}}function il(h,m,T){var D=h.updateQueue;if(D===null)return null;if(D=D.shared,(gn&2)!==0){var G=D.pending;return G===null?m.next=m:(m.next=G.next,G.next=m),D.pending=m,Ki(h,T)}return G=D.interleaved,G===null?(m.next=m,Id(D)):(m.next=G.next,G.next=m),D.interleaved=m,Ki(h,T)}function yg(h,m,T){if(m=m.updateQueue,m!==null&&(m=m.shared,(T&4194240)!==0)){var D=m.lanes;D&=h.pendingLanes,T|=D,m.lanes=T,Gf(h,T)}}function fh(h,m){var T=h.updateQueue,D=h.alternate;if(D!==null&&(D=D.updateQueue,T===D)){var G=null,Q=null;if(T=T.firstBaseUpdate,T!==null){do{var de={eventTime:T.eventTime,lane:T.lane,tag:T.tag,payload:T.payload,callback:T.callback,next:null};Q===null?G=Q=de:Q=Q.next=de,T=T.next}while(T!==null);Q===null?G=Q=m:Q=Q.next=m}else G=Q=m;T={baseState:D.baseState,firstBaseUpdate:G,lastBaseUpdate:Q,shared:D.shared,effects:D.effects},h.updateQueue=T;return}h=T.lastBaseUpdate,h===null?T.firstBaseUpdate=m:h.next=m,T.lastBaseUpdate=m}function Rd(h,m,T,D){var G=h.updateQueue;sl=!1;var Q=G.firstBaseUpdate,de=G.lastBaseUpdate,je=G.shared.pending;if(je!==null){G.shared.pending=null;var Re=je,dt=Re.next;Re.next=null,de===null?Q=dt:de.next=dt,de=Re;var Ut=h.alternate;Ut!==null&&(Ut=Ut.updateQueue,je=Ut.lastBaseUpdate,je!==de&&(je===null?Ut.firstBaseUpdate=dt:je.next=dt,Ut.lastBaseUpdate=Re))}if(Q!==null){var Ht=G.baseState;de=0,Ut=dt=Re=null,je=Q;do{var Bt=je.lane,cr=je.eventTime;if((D&Bt)===Bt){Ut!==null&&(Ut=Ut.next={eventTime:cr,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var yr=h,vr=je;switch(Bt=m,cr=T,vr.tag){case 1:if(yr=vr.payload,typeof yr=="function"){Ht=yr.call(cr,Ht,Bt);break e}Ht=yr;break e;case 3:yr.flags=yr.flags&-65537|128;case 0:if(yr=vr.payload,Bt=typeof yr=="function"?yr.call(cr,Ht,Bt):yr,Bt==null)break e;Ht=H({},Ht,Bt);break e;case 2:sl=!0}}je.callback!==null&&je.lane!==0&&(h.flags|=64,Bt=G.effects,Bt===null?G.effects=[je]:Bt.push(je))}else cr={eventTime:cr,lane:Bt,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Ut===null?(dt=Ut=cr,Re=Ht):Ut=Ut.next=cr,de|=Bt;if(je=je.next,je===null){if(je=G.shared.pending,je===null)break;Bt=je,je=Bt.next,Bt.next=null,G.lastBaseUpdate=Bt,G.shared.pending=null}}while(!0);if(Ut===null&&(Re=Ht),G.baseState=Re,G.firstBaseUpdate=dt,G.lastBaseUpdate=Ut,m=G.shared.interleaved,m!==null){G=m;do de|=G.lane,G=G.next;while(G!==m)}else Q===null&&(G.shared.lanes=0);mh|=de,h.lanes=de,h.memoizedState=Ht}}function ds(h,m,T){if(h=m.effects,m.effects=null,h!==null)for(m=0;m<h.length;m++){var D=h[m],G=D.callback;if(G!==null){if(D.callback=null,D=T,typeof G!="function")throw Error(r(191,G));G.call(D)}}}var Kr={},jn=Wl(Kr),Qn=Wl(Kr),ys=Wl(Kr);function Ws(h){if(h===Kr)throw Error(r(174));return h}function jc(h,m){switch(An(ys,m),An(Qn,h),An(jn,Kr),h=m.nodeType,h){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:De(null,"");break;default:h=h===8?m.parentNode:m,m=h.namespaceURI||null,h=h.tagName,m=De(m,h)}Bn(jn),An(jn,m)}function Zn(){Bn(jn),Bn(Qn),Bn(ys)}function Md(h){Ws(ys.current);var m=Ws(jn.current),T=De(m,h.type);m!==T&&(An(Qn,h),An(jn,T))}function Vl(h){Qn.current===h&&(Bn(jn),Bn(Qn))}var $n=Wl(0);function Ld(h){for(var m=h;m!==null;){if(m.tag===13){var T=m.memoizedState;if(T!==null&&(T=T.dehydrated,T===null||T.data==="$?"||T.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var Eu=[];function Aa(){for(var h=0;h<Eu.length;h++)Eu[h]._workInProgressVersionPrimary=null;Eu.length=0}var Bd=N.ReactCurrentDispatcher,hh=N.ReactCurrentBatchConfig,Qa=0,Tn=null,fs=null,Cs=null,Io=!1,Pc=!1,ho=0,vg=0;function Ts(){throw Error(r(321))}function gh(h,m){if(m===null)return!1;for(var T=0;T<m.length&&T<h.length;T++)if(!yi(h[T],m[T]))return!1;return!0}function $d(h,m,T,D,G,Q){if(Qa=Q,Tn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,Bd.current=h===null||h.memoizedState===null?K2:Dc,h=T(D,G),Pc){Q=0;do{if(Pc=!1,ho=0,25<=Q)throw Error(r(301));Q+=1,Cs=fs=null,m.updateQueue=null,Bd.current=kg,h=T(D,G)}while(Pc)}if(Bd.current=Hd,m=fs!==null&&fs.next!==null,Qa=0,Cs=fs=Tn=null,Io=!1,m)throw Error(r(300));return h}function Ud(){var h=ho!==0;return ho=0,h}function Hn(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cs===null?Tn.memoizedState=Cs=h:Cs=Cs.next=h,Cs}function Hs(){if(fs===null){var h=Tn.alternate;h=h!==null?h.memoizedState:null}else h=fs.next;var m=Cs===null?Tn.memoizedState:Cs.next;if(m!==null)Cs=m,fs=h;else{if(h===null)throw Error(r(310));fs=h,h={memoizedState:fs.memoizedState,baseState:fs.baseState,baseQueue:fs.baseQueue,queue:fs.queue,next:null},Cs===null?Tn.memoizedState=Cs=h:Cs=Cs.next=h}return Cs}function ja(h,m){return typeof m=="function"?m(h):m}function Pa(h){var m=Hs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=h;var D=fs,G=D.baseQueue,Q=T.pending;if(Q!==null){if(G!==null){var de=G.next;G.next=Q.next,Q.next=de}D.baseQueue=G=Q,T.pending=null}if(G!==null){Q=G.next,D=D.baseState;var je=de=null,Re=null,dt=Q;do{var Ut=dt.lane;if((Qa&Ut)===Ut)Re!==null&&(Re=Re.next={lane:0,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null}),D=dt.hasEagerState?dt.eagerState:h(D,dt.action);else{var Ht={lane:Ut,action:dt.action,hasEagerState:dt.hasEagerState,eagerState:dt.eagerState,next:null};Re===null?(je=Re=Ht,de=D):Re=Re.next=Ht,Tn.lanes|=Ut,mh|=Ut}dt=dt.next}while(dt!==null&&dt!==Q);Re===null?de=D:Re.next=je,yi(D,m.memoizedState)||(te=!0),m.memoizedState=D,m.baseState=de,m.baseQueue=Re,T.lastRenderedState=D}if(h=T.interleaved,h!==null){G=h;do Q=G.lane,Tn.lanes|=Q,mh|=Q,G=G.next;while(G!==h)}else G===null&&(T.lanes=0);return[m.memoizedState,T.dispatch]}function wg(h){var m=Hs(),T=m.queue;if(T===null)throw Error(r(311));T.lastRenderedReducer=h;var D=T.dispatch,G=T.pending,Q=m.memoizedState;if(G!==null){T.pending=null;var de=G=G.next;do Q=h(Q,de.action),de=de.next;while(de!==G);yi(Q,m.memoizedState)||(te=!0),m.memoizedState=Q,m.baseQueue===null&&(m.baseState=Q),T.lastRenderedState=Q}return[Q,D]}function _g(){}function bg(h,m){var T=Tn,D=Hs(),G=m(),Q=!yi(D.memoizedState,G);if(Q&&(D.memoizedState=G,te=!0),D=D.queue,Wp($p.bind(null,T,D,h),[h]),D.getSnapshot!==m||Q||Cs!==null&&Cs.memoizedState.tag&1){if(T.flags|=2048,zd(9,Kl.bind(null,T,D,G,m),void 0,null),Oa===null)throw Error(r(349));(Qa&30)!==0||O1(T,m,G)}return G}function O1(h,m,T){h.flags|=16384,h={getSnapshot:m,value:T},m=Tn.updateQueue,m===null?(m={lastEffect:null,stores:null},Tn.updateQueue=m,m.stores=[h]):(T=m.stores,T===null?m.stores=[h]:T.push(h))}function Kl(h,m,T,D){m.value=T,m.getSnapshot=D,Up(m)&&Sg(h)}function $p(h,m,T){return T(function(){Up(m)&&Sg(h)})}function Up(h){var m=h.getSnapshot;h=h.value;try{var T=m();return!yi(h,T)}catch{return!0}}function Sg(h){var m=Ki(h,1);m!==null&&Jl(m,h,1,-1)}function Fc(h){var m=Hn();return typeof h=="function"&&(h=h()),m.memoizedState=m.baseState=h,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ja,lastRenderedState:h},m.queue=h,h=h.dispatch=B1.bind(null,Tn,h),[m.memoizedState,h]}function zd(h,m,T,D){return h={tag:h,create:m,destroy:T,deps:D,next:null},m=Tn.updateQueue,m===null?(m={lastEffect:null,stores:null},Tn.updateQueue=m,m.lastEffect=h.next=h):(T=m.lastEffect,T===null?m.lastEffect=h.next=h:(D=T.next,T.next=h,h.next=D,m.lastEffect=h)),h}function zp(){return Hs().memoizedState}function Wd(h,m,T,D){var G=Hn();Tn.flags|=h,G.memoizedState=zd(1|m,T,void 0,D===void 0?null:D)}function Nu(h,m,T,D){var G=Hs();D=D===void 0?null:D;var Q=void 0;if(fs!==null){var de=fs.memoizedState;if(Q=de.destroy,D!==null&&gh(D,de.deps)){G.memoizedState=zd(m,T,Q,D);return}}Tn.flags|=h,G.memoizedState=zd(1|m,T,Q,D)}function D1(h,m){return Wd(8390656,8,h,m)}function Wp(h,m){return Nu(2048,8,h,m)}function Hp(h,m){return Nu(4,2,h,m)}function Gp(h,m){return Nu(4,4,h,m)}function Oc(h,m){if(typeof m=="function")return h=h(),m(h),function(){m(null)};if(m!=null)return h=h(),m.current=h,function(){m.current=null}}function I1(h,m,T){return T=T!=null?T.concat([h]):null,Nu(4,4,Oc.bind(null,m,h),T)}function ql(){}function Vp(h,m){var T=Hs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&gh(m,D[1])?D[0]:(T.memoizedState=[h,m],h)}function Gn(h,m){var T=Hs();m=m===void 0?null:m;var D=T.memoizedState;return D!==null&&m!==null&&gh(m,D[1])?D[0]:(h=h(),T.memoizedState=[h,m],h)}function R1(h,m,T){return(Qa&21)===0?(h.baseState&&(h.baseState=!1,te=!0),h.memoizedState=T):(yi(T,m)||(T=es(),Tn.lanes|=T,mh|=T,h.baseState=!0),m)}function M1(h,m){var T=cn;cn=T!==0&&4>T?T:4,h(!0);var D=hh.transition;hh.transition={};try{h(!1),m()}finally{cn=T,hh.transition=D}}function L1(){return Hs().memoizedState}function V2(h,m,T){var D=Jd(h);if(T={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null},Kp(h))$1(m,T);else if(T=uh(h,m,T,D),T!==null){var G=Yi();Jl(T,h,D,G),qi(T,m,D)}}function B1(h,m,T){var D=Jd(h),G={lane:D,action:T,hasEagerState:!1,eagerState:null,next:null};if(Kp(h))$1(m,G);else{var Q=h.alternate;if(h.lanes===0&&(Q===null||Q.lanes===0)&&(Q=m.lastRenderedReducer,Q!==null))try{var de=m.lastRenderedState,je=Q(de,T);if(G.hasEagerState=!0,G.eagerState=je,yi(je,de)){var Re=m.interleaved;Re===null?(G.next=G,Id(m)):(G.next=Re.next,Re.next=G),m.interleaved=G;return}}catch{}finally{}T=uh(h,m,G,D),T!==null&&(G=Yi(),Jl(T,h,D,G),qi(T,m,D))}}function Kp(h){var m=h.alternate;return h===Tn||m!==null&&m===Tn}function $1(h,m){Pc=Io=!0;var T=h.pending;T===null?m.next=m:(m.next=T.next,T.next=m),h.pending=m}function qi(h,m,T){if((T&4194240)!==0){var D=m.lanes;D&=h.pendingLanes,T|=D,m.lanes=T,Gf(h,T)}}var Hd={readContext:Ja,useCallback:Ts,useContext:Ts,useEffect:Ts,useImperativeHandle:Ts,useInsertionEffect:Ts,useLayoutEffect:Ts,useMemo:Ts,useReducer:Ts,useRef:Ts,useState:Ts,useDebugValue:Ts,useDeferredValue:Ts,useTransition:Ts,useMutableSource:Ts,useSyncExternalStore:Ts,useId:Ts,unstable_isNewReconciler:!1},K2={readContext:Ja,useCallback:function(h,m){return Hn().memoizedState=[h,m===void 0?null:m],h},useContext:Ja,useEffect:D1,useImperativeHandle:function(h,m,T){return T=T!=null?T.concat([h]):null,Wd(4194308,4,Oc.bind(null,m,h),T)},useLayoutEffect:function(h,m){return Wd(4194308,4,h,m)},useInsertionEffect:function(h,m){return Wd(4,2,h,m)},useMemo:function(h,m){var T=Hn();return m=m===void 0?null:m,h=h(),T.memoizedState=[h,m],h},useReducer:function(h,m,T){var D=Hn();return m=T!==void 0?T(m):m,D.memoizedState=D.baseState=m,h={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:m},D.queue=h,h=h.dispatch=V2.bind(null,Tn,h),[D.memoizedState,h]},useRef:function(h){var m=Hn();return h={current:h},m.memoizedState=h},useState:Fc,useDebugValue:ql,useDeferredValue:function(h){return Hn().memoizedState=h},useTransition:function(){var h=Fc(!1),m=h[0];return h=M1.bind(null,h[1]),Hn().memoizedState=h,[m,h]},useMutableSource:function(){},useSyncExternalStore:function(h,m,T){var D=Tn,G=Hn();if(Sn){if(T===void 0)throw Error(r(407));T=T()}else{if(T=m(),Oa===null)throw Error(r(349));(Qa&30)!==0||O1(D,m,T)}G.memoizedState=T;var Q={value:T,getSnapshot:m};return G.queue=Q,D1($p.bind(null,D,Q,h),[h]),D.flags|=2048,zd(9,Kl.bind(null,D,Q,T,m),void 0,null),T},useId:function(){var h=Hn(),m=Oa.identifierPrefix;if(Sn){var T=Jn,D=Wi;T=(D&~(1<<32-he(D)-1)).toString(32)+T,m=":"+m+"R"+T,T=ho++,0<T&&(m+="H"+T.toString(32)),m+=":"}else T=vg++,m=":"+m+"r"+T.toString(32)+":";return h.memoizedState=m},unstable_isNewReconciler:!1},Dc={readContext:Ja,useCallback:Vp,useContext:Ja,useEffect:Wp,useImperativeHandle:I1,useInsertionEffect:Hp,useLayoutEffect:Gp,useMemo:Gn,useReducer:Pa,useRef:zp,useState:function(){return Pa(ja)},useDebugValue:ql,useDeferredValue:function(h){var m=Hs();return R1(m,fs.memoizedState,h)},useTransition:function(){var h=Pa(ja)[0],m=Hs().memoizedState;return[h,m]},useMutableSource:_g,useSyncExternalStore:bg,useId:L1,unstable_isNewReconciler:!1},kg={readContext:Ja,useCallback:Vp,useContext:Ja,useEffect:Wp,useImperativeHandle:I1,useInsertionEffect:Hp,useLayoutEffect:Gp,useMemo:Gn,useReducer:wg,useRef:zp,useState:function(){return wg(ja)},useDebugValue:ql,useDeferredValue:function(h){var m=Hs();return fs===null?m.memoizedState=h:R1(m,fs.memoizedState,h)},useTransition:function(){var h=wg(ja)[0],m=Hs().memoizedState;return[h,m]},useMutableSource:_g,useSyncExternalStore:bg,useId:L1,unstable_isNewReconciler:!1};function pa(h,m){if(h&&h.defaultProps){m=H({},m),h=h.defaultProps;for(var T in h)m[T]===void 0&&(m[T]=h[T]);return m}return m}function Gd(h,m,T,D){m=h.memoizedState,T=T(D,m),T=T==null?m:H({},m,T),h.memoizedState=T,h.lanes===0&&(h.updateQueue.baseState=T)}var Vd={isMounted:function(h){return(h=h._reactInternals)?Se(h)===h:!1},enqueueSetState:function(h,m,T){h=h._reactInternals;var D=Yi(),G=Jd(h),Q=al(D,G);Q.payload=m,T!=null&&(Q.callback=T),m=il(h,Q,G),m!==null&&(Jl(m,h,G,D),yg(m,h,G))},enqueueReplaceState:function(h,m,T){h=h._reactInternals;var D=Yi(),G=Jd(h),Q=al(D,G);Q.tag=1,Q.payload=m,T!=null&&(Q.callback=T),m=il(h,Q,G),m!==null&&(Jl(m,h,G,D),yg(m,h,G))},enqueueForceUpdate:function(h,m){h=h._reactInternals;var T=Yi(),D=Jd(h),G=al(T,D);G.tag=2,m!=null&&(G.callback=m),m=il(h,G,D),m!==null&&(Jl(m,h,D,T),yg(m,h,D))}};function Cg(h,m,T,D,G,Q,de){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(D,Q,de):m.prototype&&m.prototype.isPureReactComponent?!du(T,D)||!du(G,Q):!0}function U1(h,m,T){var D=!1,G=tl,Q=m.contextType;return typeof Q=="object"&&Q!==null?Q=Ja(Q):(G=Na(m)?Cc:ma.current,D=m.contextTypes,Q=(D=D!=null)?wu(h,G):tl),m=new m(T,Q),h.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=Vd,h.stateNode=m,m._reactInternals=h,D&&(h=h.stateNode,h.__reactInternalMemoizedUnmaskedChildContext=G,h.__reactInternalMemoizedMaskedChildContext=Q),m}function qp(h,m,T,D){h=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(T,D),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(T,D),m.state!==h&&Vd.enqueueReplaceState(m,m.state,null)}function Tg(h,m,T,D){var G=h.stateNode;G.props=T,G.state=h.memoizedState,G.refs={},dh(h);var Q=m.contextType;typeof Q=="object"&&Q!==null?G.context=Ja(Q):(Q=Na(m)?Cc:ma.current,G.context=wu(h,Q)),G.state=h.memoizedState,Q=m.getDerivedStateFromProps,typeof Q=="function"&&(Gd(h,m,Q,T),G.state=h.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof G.getSnapshotBeforeUpdate=="function"||typeof G.UNSAFE_componentWillMount!="function"&&typeof G.componentWillMount!="function"||(m=G.state,typeof G.componentWillMount=="function"&&G.componentWillMount(),typeof G.UNSAFE_componentWillMount=="function"&&G.UNSAFE_componentWillMount(),m!==G.state&&Vd.enqueueReplaceState(G,G.state,null),Rd(h,T,G,D),G.state=h.memoizedState),typeof G.componentDidMount=="function"&&(h.flags|=4194308)}function Au(h,m){try{var T="",D=m;do T+=J(D),D=D.return;while(D);var G=T}catch(Q){G=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:h,source:m,stack:G,digest:null}}function Eg(h,m,T){return{value:h,source:null,stack:T??null,digest:m??null}}function Kd(h,m){try{console.error(m.value)}catch(T){setTimeout(function(){throw T})}}var q2=typeof WeakMap=="function"?WeakMap:Map;function z1(h,m,T){T=al(-1,T),T.tag=3,T.payload={element:null};var D=m.value;return T.callback=function(){K1||(K1=!0,sS=D),Kd(h,m)},T}function y(h,m,T){T=al(-1,T),T.tag=3;var D=h.type.getDerivedStateFromError;if(typeof D=="function"){var G=m.value;T.payload=function(){return D(G)},T.callback=function(){Kd(h,m)}}var Q=h.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(T.callback=function(){Kd(h,m),typeof D!="function"&&(Yd===null?Yd=new Set([this]):Yd.add(this));var de=m.stack;this.componentDidCatch(m.value,{componentStack:de!==null?de:""})}),T}function b(h,m,T){var D=h.pingCache;if(D===null){D=h.pingCache=new q2;var G=new Set;D.set(m,G)}else G=D.get(m),G===void 0&&(G=new Set,D.set(m,G));G.has(T)||(G.add(T),h=DV.bind(null,h,m,T),m.then(h,h))}function O(h){do{var m;if((m=h.tag===13)&&(m=h.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return h;h=h.return}while(h!==null);return null}function U(h,m,T,D,G){return(h.mode&1)===0?(h===m?h.flags|=65536:(h.flags|=128,T.flags|=131072,T.flags&=-52805,T.tag===1&&(T.alternate===null?T.tag=17:(m=al(-1,1),m.tag=2,il(T,m,1))),T.lanes|=1),h):(h.flags|=65536,h.lanes=G,h)}var q=N.ReactCurrentOwner,te=!1;function ve(h,m,T,D){m.child=h===null?fo(m,null,T,D):Tu(m,h.child,T,D)}function Ge(h,m,T,D,G){T=T.render;var Q=m.ref;return Gl(m,G),D=$d(h,m,T,D,Q,G),T=Ud(),h!==null&&!te?(m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~G,Fa(h,m,G)):(Sn&&T&&Fd(m),m.flags|=1,ve(h,m,D,G),m.child)}function ft(h,m,T,D,G){if(h===null){var Q=T.type;return typeof Q=="function"&&!dS(Q)&&Q.defaultProps===void 0&&T.compare===null&&T.defaultProps===void 0?(m.tag=15,m.type=Q,Kt(h,m,Q,D,G)):(h=Z1(T.type,null,D,m,m.mode,G),h.ref=m.ref,h.return=m,m.child=h)}if(Q=h.child,(h.lanes&G)===0){var de=Q.memoizedProps;if(T=T.compare,T=T!==null?T:du,T(de,D)&&h.ref===m.ref)return Fa(h,m,G)}return m.flags|=1,h=Zd(Q,D),h.ref=m.ref,h.return=m,m.child=h}function Kt(h,m,T,D,G){if(h!==null){var Q=h.memoizedProps;if(du(Q,D)&&h.ref===m.ref)if(te=!1,m.pendingProps=D=Q,(h.lanes&G)!==0)(h.flags&131072)!==0&&(te=!0);else return m.lanes=h.lanes,Fa(h,m,G)}return ar(h,m,T,D,G)}function hr(h,m,T){var D=m.pendingProps,G=D.children,Q=h!==null?h.memoizedState:null;if(D.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},An(Ag,Ro),Ro|=T;else{if((T&1073741824)===0)return h=Q!==null?Q.baseLanes|T:T,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:h,cachePool:null,transitions:null},m.updateQueue=null,An(Ag,Ro),Ro|=h,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=Q!==null?Q.baseLanes:T,An(Ag,Ro),Ro|=D}else Q!==null?(D=Q.baseLanes|T,m.memoizedState=null):D=T,An(Ag,Ro),Ro|=D;return ve(h,m,G,T),m.child}function Ur(h,m){var T=m.ref;(h===null&&T!==null||h!==null&&h.ref!==T)&&(m.flags|=512,m.flags|=2097152)}function ar(h,m,T,D,G){var Q=Na(T)?Cc:ma.current;return Q=wu(m,Q),Gl(m,G),T=$d(h,m,T,D,Q,G),D=Ud(),h!==null&&!te?(m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~G,Fa(h,m,G)):(Sn&&D&&Fd(m),m.flags|=1,ve(h,m,T,G),m.child)}function Un(h,m,T,D,G){if(Na(T)){var Q=!0;_u(m)}else Q=!1;if(Gl(m,G),m.stateNode===null)on(h,m),U1(m,T,D),Tg(m,T,D,G),D=!0;else if(h===null){var de=m.stateNode,je=m.memoizedProps;de.props=je;var Re=de.context,dt=T.contextType;typeof dt=="object"&&dt!==null?dt=Ja(dt):(dt=Na(T)?Cc:ma.current,dt=wu(m,dt));var Ut=T.getDerivedStateFromProps,Ht=typeof Ut=="function"||typeof de.getSnapshotBeforeUpdate=="function";Ht||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==D||Re!==dt)&&qp(m,de,D,dt),sl=!1;var Bt=m.memoizedState;de.state=Bt,Rd(m,D,de,G),Re=m.memoizedState,je!==D||Bt!==Re||Ea.current||sl?(typeof Ut=="function"&&(Gd(m,T,Ut,D),Re=m.memoizedState),(je=sl||Cg(m,T,je,D,Bt,Re,dt))?(Ht||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(m.flags|=4194308)):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=D,m.memoizedState=Re),de.props=D,de.state=Re,de.context=dt,D=je):(typeof de.componentDidMount=="function"&&(m.flags|=4194308),D=!1)}else{de=m.stateNode,xg(h,m),je=m.memoizedProps,dt=m.type===m.elementType?je:pa(m.type,je),de.props=dt,Ht=m.pendingProps,Bt=de.context,Re=T.contextType,typeof Re=="object"&&Re!==null?Re=Ja(Re):(Re=Na(T)?Cc:ma.current,Re=wu(m,Re));var cr=T.getDerivedStateFromProps;(Ut=typeof cr=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==Ht||Bt!==Re)&&qp(m,de,D,Re),sl=!1,Bt=m.memoizedState,de.state=Bt,Rd(m,D,de,G);var yr=m.memoizedState;je!==Ht||Bt!==yr||Ea.current||sl?(typeof cr=="function"&&(Gd(m,T,cr,D),yr=m.memoizedState),(dt=sl||Cg(m,T,dt,D,Bt,yr,Re)||!1)?(Ut||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(D,yr,Re),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(D,yr,Re)),typeof de.componentDidUpdate=="function"&&(m.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof de.componentDidUpdate!="function"||je===h.memoizedProps&&Bt===h.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===h.memoizedProps&&Bt===h.memoizedState||(m.flags|=1024),m.memoizedProps=D,m.memoizedState=yr),de.props=D,de.state=yr,de.context=Re,D=dt):(typeof de.componentDidUpdate!="function"||je===h.memoizedProps&&Bt===h.memoizedState||(m.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===h.memoizedProps&&Bt===h.memoizedState||(m.flags|=1024),D=!1)}return kn(h,m,T,D,Q,G)}function kn(h,m,T,D,G,Q){Ur(h,m);var de=(m.flags&128)!==0;if(!D&&!de)return G&&j1(m,T,!1),Fa(h,m,Q);D=m.stateNode,q.current=m;var je=de&&typeof T.getDerivedStateFromError!="function"?null:D.render();return m.flags|=1,h!==null&&de?(m.child=Tu(m,h.child,null,Q),m.child=Tu(m,null,je,Q)):ve(h,m,je,Q),m.memoizedState=D.state,G&&j1(m,T,!0),m.child}function Za(h){var m=h.stateNode;m.pendingContext?Rp(h,m.pendingContext,m.pendingContext!==m.context):m.context&&Rp(h,m.context,!1),jc(h,m.containerInfo)}function ol(h,m,T,D,G){return Cu(),lh(G),m.flags|=256,ve(h,m,T,D),m.child}var ct={dehydrated:null,treeContext:null,retryLane:0};function Xe(h){return{baseLanes:h,cachePool:null,transitions:null}}function yt(h,m,T){var D=m.pendingProps,G=$n.current,Q=!1,de=(m.flags&128)!==0,je;if((je=de)||(je=h!==null&&h.memoizedState===null?!1:(G&2)!==0),je?(Q=!0,m.flags&=-129):(h===null||h.memoizedState!==null)&&(G|=1),An($n,G&1),h===null)return Od(m),h=m.memoizedState,h!==null&&(h=h.dehydrated,h!==null)?((m.mode&1)===0?m.lanes=1:h.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(de=D.children,h=D.fallback,Q?(D=m.mode,Q=m.child,de={mode:"hidden",children:de},(D&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=de):Q=ew(de,D,0,null),h=vh(h,D,T,null),Q.return=m,h.return=m,Q.sibling=h,m.child=Q,m.child.memoizedState=Xe(T),m.memoizedState=ct,h):or(m,de));if(G=h.memoizedState,G!==null&&(je=G.dehydrated,je!==null))return Yr(h,m,de,D,je,G,T);if(Q){Q=D.fallback,de=m.mode,G=h.child,je=G.sibling;var Re={mode:"hidden",children:D.children};return(de&1)===0&&m.child!==G?(D=m.child,D.childLanes=0,D.pendingProps=Re,m.deletions=null):(D=Zd(G,Re),D.subtreeFlags=G.subtreeFlags&14680064),je!==null?Q=Zd(je,Q):(Q=vh(Q,de,T,null),Q.flags|=2),Q.return=m,D.return=m,D.sibling=Q,m.child=D,D=Q,Q=m.child,de=h.child.memoizedState,de=de===null?Xe(T):{baseLanes:de.baseLanes|T,cachePool:null,transitions:de.transitions},Q.memoizedState=de,Q.childLanes=h.childLanes&~T,m.memoizedState=ct,D}return Q=h.child,h=Q.sibling,D=Zd(Q,{mode:"visible",children:D.children}),(m.mode&1)===0&&(D.lanes=T),D.return=m,D.sibling=null,h!==null&&(T=m.deletions,T===null?(m.deletions=[h],m.flags|=16):T.push(h)),m.child=D,m.memoizedState=null,D}function or(h,m){return m=ew({mode:"visible",children:m},h.mode,0,null),m.return=h,h.child=m}function Tr(h,m,T,D){return D!==null&&lh(D),Tu(m,h.child,null,T),h=or(m,m.pendingProps.children),h.flags|=2,m.memoizedState=null,h}function Yr(h,m,T,D,G,Q,de){if(T)return m.flags&256?(m.flags&=-257,D=Eg(Error(r(422))),Tr(h,m,de,D)):m.memoizedState!==null?(m.child=h.child,m.flags|=128,null):(Q=D.fallback,G=m.mode,D=ew({mode:"visible",children:D.children},G,0,null),Q=vh(Q,G,de,null),Q.flags|=2,D.return=m,Q.return=m,D.sibling=Q,m.child=D,(m.mode&1)!==0&&Tu(m,h.child,null,de),m.child.memoizedState=Xe(de),m.memoizedState=ct,Q);if((m.mode&1)===0)return Tr(h,m,de,null);if(G.data==="$!"){if(D=G.nextSibling&&G.nextSibling.dataset,D)var je=D.dgst;return D=je,Q=Error(r(419)),D=Eg(Q,D,void 0),Tr(h,m,de,D)}if(je=(de&h.childLanes)!==0,te||je){if(D=Oa,D!==null){switch(de&-de){case 4:G=2;break;case 16:G=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:G=32;break;case 536870912:G=268435456;break;default:G=0}G=(G&(D.suspendedLanes|de))!==0?0:G,G!==0&&G!==Q.retryLane&&(Q.retryLane=G,Ki(h,G),Jl(D,h,G,-1))}return uS(),D=Eg(Error(r(421))),Tr(h,m,de,D)}return G.data==="$?"?(m.flags|=128,m.child=h.child,m=IV.bind(null,h),G._reactRetry=m,null):(h=Q.treeContext,sr=Zo(G.nextSibling),Hi=m,Sn=!0,Gi=null,h!==null&&(Ya[Xa++]=Wi,Ya[Xa++]=Jn,Ya[Xa++]=Ac,Wi=h.id,Jn=h.overflow,Ac=m),m=or(m,D.children),m.flags|=4096,m)}function zr(h,m,T){h.lanes|=m;var D=h.alternate;D!==null&&(D.lanes|=m),pg(h.return,m,T)}function un(h,m,T,D,G){var Q=h.memoizedState;Q===null?h.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:D,tail:T,tailMode:G}:(Q.isBackwards=m,Q.rendering=null,Q.renderingStartTime=0,Q.last=D,Q.tail=T,Q.tailMode=G)}function Gs(h,m,T){var D=m.pendingProps,G=D.revealOrder,Q=D.tail;if(ve(h,m,D.children,T),D=$n.current,(D&2)!==0)D=D&1|2,m.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=m.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&zr(h,T,m);else if(h.tag===19)zr(h,T,m);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===m)break e;for(;h.sibling===null;){if(h.return===null||h.return===m)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}D&=1}if(An($n,D),(m.mode&1)===0)m.memoizedState=null;else switch(G){case"forwards":for(T=m.child,G=null;T!==null;)h=T.alternate,h!==null&&Ld(h)===null&&(G=T),T=T.sibling;T=G,T===null?(G=m.child,m.child=null):(G=T.sibling,T.sibling=null),un(m,!1,G,T,Q);break;case"backwards":for(T=null,G=m.child,m.child=null;G!==null;){if(h=G.alternate,h!==null&&Ld(h)===null){m.child=G;break}h=G.sibling,G.sibling=T,T=G,G=h}un(m,!0,T,null,Q);break;case"together":un(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function on(h,m){(m.mode&1)===0&&h!==null&&(h.alternate=null,m.alternate=null,m.flags|=2)}function Fa(h,m,T){if(h!==null&&(m.dependencies=h.dependencies),mh|=m.lanes,(T&m.childLanes)===0)return null;if(h!==null&&m.child!==h.child)throw Error(r(153));if(m.child!==null){for(h=m.child,T=Zd(h,h.pendingProps),m.child=T,T.return=m;h.sibling!==null;)h=h.sibling,T=T.sibling=Zd(h,h.pendingProps),T.return=m;T.sibling=null}return m.child}function Y2(h,m,T){switch(m.tag){case 3:Za(m),Cu();break;case 5:Md(m);break;case 1:Na(m.type)&&_u(m);break;case 4:jc(m,m.stateNode.containerInfo);break;case 10:var D=m.type._context,G=m.memoizedProps.value;An(ch,D._currentValue),D._currentValue=G;break;case 13:if(D=m.memoizedState,D!==null)return D.dehydrated!==null?(An($n,$n.current&1),m.flags|=128,null):(T&m.child.childLanes)!==0?yt(h,m,T):(An($n,$n.current&1),h=Fa(h,m,T),h!==null?h.sibling:null);An($n,$n.current&1);break;case 19:if(D=(T&m.childLanes)!==0,(h.flags&128)!==0){if(D)return Gs(h,m,T);m.flags|=128}if(G=m.memoizedState,G!==null&&(G.rendering=null,G.tail=null,G.lastEffect=null),An($n,$n.current),D)break;return null;case 22:case 23:return m.lanes=0,hr(h,m,T)}return Fa(h,m,T)}var ij,X2,oj,lj;ij=function(h,m){for(var T=m.child;T!==null;){if(T.tag===5||T.tag===6)h.appendChild(T.stateNode);else if(T.tag!==4&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===m)break;for(;T.sibling===null;){if(T.return===null||T.return===m)return;T=T.return}T.sibling.return=T.return,T=T.sibling}},X2=function(){},oj=function(h,m,T,D){var G=h.memoizedProps;if(G!==D){h=m.stateNode,Ws(jn.current);var Q=null;switch(T){case"input":G=Ce(h,G),D=Ce(h,D),Q=[];break;case"select":G=H({},G,{value:void 0}),D=H({},D,{value:void 0}),Q=[];break;case"textarea":G=tt(h,G),D=tt(h,D),Q=[];break;default:typeof G.onClick!="function"&&typeof D.onClick=="function"&&(h.onclick=xu)}pr(T,D);var de;T=null;for(dt in G)if(!D.hasOwnProperty(dt)&&G.hasOwnProperty(dt)&&G[dt]!=null)if(dt==="style"){var je=G[dt];for(de in je)je.hasOwnProperty(de)&&(T||(T={}),T[de]="")}else dt!=="dangerouslySetInnerHTML"&&dt!=="children"&&dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&dt!=="autoFocus"&&(s.hasOwnProperty(dt)?Q||(Q=[]):(Q=Q||[]).push(dt,null));for(dt in D){var Re=D[dt];if(je=G?.[dt],D.hasOwnProperty(dt)&&Re!==je&&(Re!=null||je!=null))if(dt==="style")if(je){for(de in je)!je.hasOwnProperty(de)||Re&&Re.hasOwnProperty(de)||(T||(T={}),T[de]="");for(de in Re)Re.hasOwnProperty(de)&&je[de]!==Re[de]&&(T||(T={}),T[de]=Re[de])}else T||(Q||(Q=[]),Q.push(dt,T)),T=Re;else dt==="dangerouslySetInnerHTML"?(Re=Re?Re.__html:void 0,je=je?je.__html:void 0,Re!=null&&je!==Re&&(Q=Q||[]).push(dt,Re)):dt==="children"?typeof Re!="string"&&typeof Re!="number"||(Q=Q||[]).push(dt,""+Re):dt!=="suppressContentEditableWarning"&&dt!=="suppressHydrationWarning"&&(s.hasOwnProperty(dt)?(Re!=null&&dt==="onScroll"&&Ln("scroll",h),Q||je===Re||(Q=[])):(Q=Q||[]).push(dt,Re))}T&&(Q=Q||[]).push("style",T);var dt=Q;(m.updateQueue=dt)&&(m.flags|=4)}},lj=function(h,m,T,D){T!==D&&(m.flags|=4)};function Yp(h,m){if(!Sn)switch(h.tailMode){case"hidden":m=h.tail;for(var T=null;m!==null;)m.alternate!==null&&(T=m),m=m.sibling;T===null?h.tail=null:T.sibling=null;break;case"collapsed":T=h.tail;for(var D=null;T!==null;)T.alternate!==null&&(D=T),T=T.sibling;D===null?m||h.tail===null?h.tail=null:h.tail.sibling=null:D.sibling=null}}function wi(h){var m=h.alternate!==null&&h.alternate.child===h.child,T=0,D=0;if(m)for(var G=h.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags&14680064,D|=G.flags&14680064,G.return=h,G=G.sibling;else for(G=h.child;G!==null;)T|=G.lanes|G.childLanes,D|=G.subtreeFlags,D|=G.flags,G.return=h,G=G.sibling;return h.subtreeFlags|=D,h.childLanes=T,m}function kV(h,m,T){var D=m.pendingProps;switch(ta(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wi(m),null;case 1:return Na(m.type)&&jd(),wi(m),null;case 3:return D=m.stateNode,Zn(),Bn(Ea),Bn(ma),Aa(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(h===null||h.child===null)&&(oh(m)?m.flags|=4:h===null||h.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Gi!==null&&(oS(Gi),Gi=null))),X2(h,m),wi(m),null;case 5:Vl(m);var G=Ws(ys.current);if(T=m.type,h!==null&&m.stateNode!=null)oj(h,m,T,D,G),h.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!D){if(m.stateNode===null)throw Error(r(166));return wi(m),null}if(h=Ws(jn.current),oh(m)){D=m.stateNode,T=m.type;var Q=m.memoizedProps;switch(D[uo]=m,D[sh]=Q,h=(m.mode&1)!==0,T){case"dialog":Ln("cancel",D),Ln("close",D);break;case"iframe":case"object":case"embed":Ln("load",D);break;case"video":case"audio":for(G=0;G<bc.length;G++)Ln(bc[G],D);break;case"source":Ln("error",D);break;case"img":case"image":case"link":Ln("error",D),Ln("load",D);break;case"details":Ln("toggle",D);break;case"input":Ae(D,Q),Ln("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!Q.multiple},Ln("invalid",D);break;case"textarea":ut(D,Q),Ln("invalid",D)}pr(T,Q),G=null;for(var de in Q)if(Q.hasOwnProperty(de)){var je=Q[de];de==="children"?typeof je=="string"?D.textContent!==je&&(Q.suppressHydrationWarning!==!0&&rh(D.textContent,je,h),G=["children",je]):typeof je=="number"&&D.textContent!==""+je&&(Q.suppressHydrationWarning!==!0&&rh(D.textContent,je,h),G=["children",""+je]):s.hasOwnProperty(de)&&je!=null&&de==="onScroll"&&Ln("scroll",D)}switch(T){case"input":be(D),At(D,Q,!0);break;case"textarea":be(D),Rt(D);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(D.onclick=xu)}D=G,m.updateQueue=D,D!==null&&(m.flags|=4)}else{de=G.nodeType===9?G:G.ownerDocument,h==="http://www.w3.org/1999/xhtml"&&(h=It(T)),h==="http://www.w3.org/1999/xhtml"?T==="script"?(h=de.createElement("div"),h.innerHTML="<script><\/script>",h=h.removeChild(h.firstChild)):typeof D.is=="string"?h=de.createElement(T,{is:D.is}):(h=de.createElement(T),T==="select"&&(de=h,D.multiple?de.multiple=!0:D.size&&(de.size=D.size))):h=de.createElementNS(h,T),h[uo]=m,h[sh]=D,ij(h,m,!1,!1),m.stateNode=h;e:{switch(de=Nr(T,D),T){case"dialog":Ln("cancel",h),Ln("close",h),G=D;break;case"iframe":case"object":case"embed":Ln("load",h),G=D;break;case"video":case"audio":for(G=0;G<bc.length;G++)Ln(bc[G],h);G=D;break;case"source":Ln("error",h),G=D;break;case"img":case"image":case"link":Ln("error",h),Ln("load",h),G=D;break;case"details":Ln("toggle",h),G=D;break;case"input":Ae(h,D),G=Ce(h,D),Ln("invalid",h);break;case"option":G=D;break;case"select":h._wrapperState={wasMultiple:!!D.multiple},G=H({},D,{value:void 0}),Ln("invalid",h);break;case"textarea":ut(h,D),G=tt(h,D),Ln("invalid",h);break;default:G=D}pr(T,G),je=G;for(Q in je)if(je.hasOwnProperty(Q)){var Re=je[Q];Q==="style"?$t(h,Re):Q==="dangerouslySetInnerHTML"?(Re=Re?Re.__html:void 0,Re!=null&&Je(h,Re)):Q==="children"?typeof Re=="string"?(T!=="textarea"||Re!=="")&&qe(h,Re):typeof Re=="number"&&qe(h,""+Re):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?Re!=null&&Q==="onScroll"&&Ln("scroll",h):Re!=null&&_(h,Q,Re,de))}switch(T){case"input":be(h),At(h,D,!1);break;case"textarea":be(h),Rt(h);break;case"option":D.value!=null&&h.setAttribute("value",""+ie(D.value));break;case"select":h.multiple=!!D.multiple,Q=D.value,Q!=null?ht(h,!!D.multiple,Q,!1):D.defaultValue!=null&&ht(h,!!D.multiple,D.defaultValue,!0);break;default:typeof G.onClick=="function"&&(h.onclick=xu)}switch(T){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return wi(m),null;case 6:if(h&&m.stateNode!=null)lj(h,m,h.memoizedProps,D);else{if(typeof D!="string"&&m.stateNode===null)throw Error(r(166));if(T=Ws(ys.current),Ws(jn.current),oh(m)){if(D=m.stateNode,T=m.memoizedProps,D[uo]=m,(Q=D.nodeValue!==T)&&(h=Hi,h!==null))switch(h.tag){case 3:rh(D.nodeValue,T,(h.mode&1)!==0);break;case 5:h.memoizedProps.suppressHydrationWarning!==!0&&rh(D.nodeValue,T,(h.mode&1)!==0)}Q&&(m.flags|=4)}else D=(T.nodeType===9?T:T.ownerDocument).createTextNode(D),D[uo]=m,m.stateNode=D}return wi(m),null;case 13:if(Bn($n),D=m.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(Sn&&sr!==null&&(m.mode&1)!==0&&(m.flags&128)===0)Lp(),Cu(),m.flags|=98560,Q=!1;else if(Q=oh(m),D!==null&&D.dehydrated!==null){if(h===null){if(!Q)throw Error(r(318));if(Q=m.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(r(317));Q[uo]=m}else Cu(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;wi(m),Q=!1}else Gi!==null&&(oS(Gi),Gi=null),Q=!0;if(!Q)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=T,m):(D=D!==null,D!==(h!==null&&h.memoizedState!==null)&&D&&(m.child.flags|=8192,(m.mode&1)!==0&&(h===null||($n.current&1)!==0?xa===0&&(xa=3):uS())),m.updateQueue!==null&&(m.flags|=4),wi(m),null);case 4:return Zn(),X2(h,m),h===null&&mu(m.stateNode.containerInfo),wi(m),null;case 10:return mg(m.type._context),wi(m),null;case 17:return Na(m.type)&&jd(),wi(m),null;case 19:if(Bn($n),Q=m.memoizedState,Q===null)return wi(m),null;if(D=(m.flags&128)!==0,de=Q.rendering,de===null)if(D)Yp(Q,!1);else{if(xa!==0||h!==null&&(h.flags&128)!==0)for(h=m.child;h!==null;){if(de=Ld(h),de!==null){for(m.flags|=128,Yp(Q,!1),D=de.updateQueue,D!==null&&(m.updateQueue=D,m.flags|=4),m.subtreeFlags=0,D=T,T=m.child;T!==null;)Q=T,h=D,Q.flags&=14680066,de=Q.alternate,de===null?(Q.childLanes=0,Q.lanes=h,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=de.childLanes,Q.lanes=de.lanes,Q.child=de.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=de.memoizedProps,Q.memoizedState=de.memoizedState,Q.updateQueue=de.updateQueue,Q.type=de.type,h=de.dependencies,Q.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext}),T=T.sibling;return An($n,$n.current&1|2),m.child}h=h.sibling}Q.tail!==null&&pt()>jg&&(m.flags|=128,D=!0,Yp(Q,!1),m.lanes=4194304)}else{if(!D)if(h=Ld(de),h!==null){if(m.flags|=128,D=!0,T=h.updateQueue,T!==null&&(m.updateQueue=T,m.flags|=4),Yp(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!de.alternate&&!Sn)return wi(m),null}else 2*pt()-Q.renderingStartTime>jg&&T!==1073741824&&(m.flags|=128,D=!0,Yp(Q,!1),m.lanes=4194304);Q.isBackwards?(de.sibling=m.child,m.child=de):(T=Q.last,T!==null?T.sibling=de:m.child=de,Q.last=de)}return Q.tail!==null?(m=Q.tail,Q.rendering=m,Q.tail=m.sibling,Q.renderingStartTime=pt(),m.sibling=null,T=$n.current,An($n,D?T&1|2:T&1),m):(wi(m),null);case 22:case 23:return cS(),D=m.memoizedState!==null,h!==null&&h.memoizedState!==null!==D&&(m.flags|=8192),D&&(m.mode&1)!==0?(Ro&1073741824)!==0&&(wi(m),m.subtreeFlags&6&&(m.flags|=8192)):wi(m),null;case 24:return null;case 25:return null}throw Error(r(156,m.tag))}function CV(h,m){switch(ta(m),m.tag){case 1:return Na(m.type)&&jd(),h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 3:return Zn(),Bn(Ea),Bn(ma),Aa(),h=m.flags,(h&65536)!==0&&(h&128)===0?(m.flags=h&-65537|128,m):null;case 5:return Vl(m),null;case 13:if(Bn($n),h=m.memoizedState,h!==null&&h.dehydrated!==null){if(m.alternate===null)throw Error(r(340));Cu()}return h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 19:return Bn($n),null;case 4:return Zn(),null;case 10:return mg(m.type._context),null;case 22:case 23:return cS(),null;case 24:return null;default:return null}}var W1=!1,_i=!1,TV=typeof WeakSet=="function"?WeakSet:Set,gr=null;function Ng(h,m){var T=h.ref;if(T!==null)if(typeof T=="function")try{T(null)}catch(D){Es(h,m,D)}else T.current=null}function J2(h,m,T){try{T()}catch(D){Es(h,m,D)}}var cj=!1;function EV(h,m){if(Fp=U0,h=Us(),Td(h)){if("selectionStart"in h)var T={start:h.selectionStart,end:h.selectionEnd};else e:{T=(T=h.ownerDocument)&&T.defaultView||window;var D=T.getSelection&&T.getSelection();if(D&&D.rangeCount!==0){T=D.anchorNode;var G=D.anchorOffset,Q=D.focusNode;D=D.focusOffset;try{T.nodeType,Q.nodeType}catch{T=null;break e}var de=0,je=-1,Re=-1,dt=0,Ut=0,Ht=h,Bt=null;t:for(;;){for(var cr;Ht!==T||G!==0&&Ht.nodeType!==3||(je=de+G),Ht!==Q||D!==0&&Ht.nodeType!==3||(Re=de+D),Ht.nodeType===3&&(de+=Ht.nodeValue.length),(cr=Ht.firstChild)!==null;)Bt=Ht,Ht=cr;for(;;){if(Ht===h)break t;if(Bt===T&&++dt===G&&(je=de),Bt===Q&&++Ut===D&&(Re=de),(cr=Ht.nextSibling)!==null)break;Ht=Bt,Bt=Ht.parentNode}Ht=cr}T=je===-1||Re===-1?null:{start:je,end:Re}}else T=null}T=T||{start:0,end:0}}else T=null;for(Op={focusedElem:h,selectionRange:T},U0=!1,gr=m;gr!==null;)if(m=gr,h=m.child,(m.subtreeFlags&1028)!==0&&h!==null)h.return=m,gr=h;else for(;gr!==null;){m=gr;try{var yr=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(yr!==null){var vr=yr.memoizedProps,Vs=yr.memoizedState,nt=m.stateNode,ze=nt.getSnapshotBeforeUpdate(m.elementType===m.type?vr:pa(m.type,vr),Vs);nt.__reactInternalSnapshotBeforeUpdate=ze}break;case 3:var it=m.stateNode.containerInfo;it.nodeType===1?it.textContent="":it.nodeType===9&&it.documentElement&&it.removeChild(it.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Xt){Es(m,m.return,Xt)}if(h=m.sibling,h!==null){h.return=m.return,gr=h;break}gr=m.return}return yr=cj,cj=!1,yr}function Xp(h,m,T){var D=m.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var G=D=D.next;do{if((G.tag&h)===h){var Q=G.destroy;G.destroy=void 0,Q!==void 0&&J2(m,T,Q)}G=G.next}while(G!==D)}}function H1(h,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var T=m=m.next;do{if((T.tag&h)===h){var D=T.create;T.destroy=D()}T=T.next}while(T!==m)}}function Q2(h){var m=h.ref;if(m!==null){var T=h.stateNode;switch(h.tag){case 5:h=T;break;default:h=T}typeof m=="function"?m(h):m.current=h}}function uj(h){var m=h.alternate;m!==null&&(h.alternate=null,uj(m)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(m=h.stateNode,m!==null&&(delete m[uo],delete m[sh],delete m[og],delete m[N1],delete m[A1])),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function dj(h){return h.tag===5||h.tag===3||h.tag===4}function fj(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||dj(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function Z2(h,m,T){var D=h.tag;if(D===5||D===6)h=h.stateNode,m?T.nodeType===8?T.parentNode.insertBefore(h,m):T.insertBefore(h,m):(T.nodeType===8?(m=T.parentNode,m.insertBefore(h,T)):(m=T,m.appendChild(h)),T=T._reactRootContainer,T!=null||m.onclick!==null||(m.onclick=xu));else if(D!==4&&(h=h.child,h!==null))for(Z2(h,m,T),h=h.sibling;h!==null;)Z2(h,m,T),h=h.sibling}function eS(h,m,T){var D=h.tag;if(D===5||D===6)h=h.stateNode,m?T.insertBefore(h,m):T.appendChild(h);else if(D!==4&&(h=h.child,h!==null))for(eS(h,m,T),h=h.sibling;h!==null;)eS(h,m,T),h=h.sibling}var ei=null,Yl=!1;function qd(h,m,T){for(T=T.child;T!==null;)hj(h,m,T),T=T.sibling}function hj(h,m,T){if(rn&&typeof rn.onCommitFiberUnmount=="function")try{rn.onCommitFiberUnmount(Ir,T)}catch{}switch(T.tag){case 5:_i||Ng(T,m);case 6:var D=ei,G=Yl;ei=null,qd(h,m,T),ei=D,Yl=G,ei!==null&&(Yl?(h=ei,T=T.stateNode,h.nodeType===8?h.parentNode.removeChild(T):h.removeChild(T)):ei.removeChild(T.stateNode));break;case 18:ei!==null&&(Yl?(h=ei,T=T.stateNode,h.nodeType===8?ig(h.parentNode,T):h.nodeType===1&&ig(h,T),pi(h)):ig(ei,T.stateNode));break;case 4:D=ei,G=Yl,ei=T.stateNode.containerInfo,Yl=!0,qd(h,m,T),ei=D,Yl=G;break;case 0:case 11:case 14:case 15:if(!_i&&(D=T.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){G=D=D.next;do{var Q=G,de=Q.destroy;Q=Q.tag,de!==void 0&&((Q&2)!==0||(Q&4)!==0)&&J2(T,m,de),G=G.next}while(G!==D)}qd(h,m,T);break;case 1:if(!_i&&(Ng(T,m),D=T.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=T.memoizedProps,D.state=T.memoizedState,D.componentWillUnmount()}catch(je){Es(T,m,je)}qd(h,m,T);break;case 21:qd(h,m,T);break;case 22:T.mode&1?(_i=(D=_i)||T.memoizedState!==null,qd(h,m,T),_i=D):qd(h,m,T);break;default:qd(h,m,T)}}function gj(h){var m=h.updateQueue;if(m!==null){h.updateQueue=null;var T=h.stateNode;T===null&&(T=h.stateNode=new TV),m.forEach(function(D){var G=RV.bind(null,h,D);T.has(D)||(T.add(D),D.then(G,G))})}}function Xl(h,m){var T=m.deletions;if(T!==null)for(var D=0;D<T.length;D++){var G=T[D];try{var Q=h,de=m,je=de;e:for(;je!==null;){switch(je.tag){case 5:ei=je.stateNode,Yl=!1;break e;case 3:ei=je.stateNode.containerInfo,Yl=!0;break e;case 4:ei=je.stateNode.containerInfo,Yl=!0;break e}je=je.return}if(ei===null)throw Error(r(160));hj(Q,de,G),ei=null,Yl=!1;var Re=G.alternate;Re!==null&&(Re.return=null),G.return=null}catch(dt){Es(G,m,dt)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)mj(m,h),m=m.sibling}function mj(h,m){var T=h.alternate,D=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:if(Xl(m,h),Ic(h),D&4){try{Xp(3,h,h.return),H1(3,h)}catch(vr){Es(h,h.return,vr)}try{Xp(5,h,h.return)}catch(vr){Es(h,h.return,vr)}}break;case 1:Xl(m,h),Ic(h),D&512&&T!==null&&Ng(T,T.return);break;case 5:if(Xl(m,h),Ic(h),D&512&&T!==null&&Ng(T,T.return),h.flags&32){var G=h.stateNode;try{qe(G,"")}catch(vr){Es(h,h.return,vr)}}if(D&4&&(G=h.stateNode,G!=null)){var Q=h.memoizedProps,de=T!==null?T.memoizedProps:Q,je=h.type,Re=h.updateQueue;if(h.updateQueue=null,Re!==null)try{je==="input"&&Q.type==="radio"&&Q.name!=null&&We(G,Q),Nr(je,de);var dt=Nr(je,Q);for(de=0;de<Re.length;de+=2){var Ut=Re[de],Ht=Re[de+1];Ut==="style"?$t(G,Ht):Ut==="dangerouslySetInnerHTML"?Je(G,Ht):Ut==="children"?qe(G,Ht):_(G,Ut,Ht,dt)}switch(je){case"input":Le(G,Q);break;case"textarea":Dt(G,Q);break;case"select":var Bt=G._wrapperState.wasMultiple;G._wrapperState.wasMultiple=!!Q.multiple;var cr=Q.value;cr!=null?ht(G,!!Q.multiple,cr,!1):Bt!==!!Q.multiple&&(Q.defaultValue!=null?ht(G,!!Q.multiple,Q.defaultValue,!0):ht(G,!!Q.multiple,Q.multiple?[]:"",!1))}G[sh]=Q}catch(vr){Es(h,h.return,vr)}}break;case 6:if(Xl(m,h),Ic(h),D&4){if(h.stateNode===null)throw Error(r(162));G=h.stateNode,Q=h.memoizedProps;try{G.nodeValue=Q}catch(vr){Es(h,h.return,vr)}}break;case 3:if(Xl(m,h),Ic(h),D&4&&T!==null&&T.memoizedState.isDehydrated)try{pi(m.containerInfo)}catch(vr){Es(h,h.return,vr)}break;case 4:Xl(m,h),Ic(h);break;case 13:Xl(m,h),Ic(h),G=h.child,G.flags&8192&&(Q=G.memoizedState!==null,G.stateNode.isHidden=Q,!Q||G.alternate!==null&&G.alternate.memoizedState!==null||(nS=pt())),D&4&&gj(h);break;case 22:if(Ut=T!==null&&T.memoizedState!==null,h.mode&1?(_i=(dt=_i)||Ut,Xl(m,h),_i=dt):Xl(m,h),Ic(h),D&8192){if(dt=h.memoizedState!==null,(h.stateNode.isHidden=dt)&&!Ut&&(h.mode&1)!==0)for(gr=h,Ut=h.child;Ut!==null;){for(Ht=gr=Ut;gr!==null;){switch(Bt=gr,cr=Bt.child,Bt.tag){case 0:case 11:case 14:case 15:Xp(4,Bt,Bt.return);break;case 1:Ng(Bt,Bt.return);var yr=Bt.stateNode;if(typeof yr.componentWillUnmount=="function"){D=Bt,T=Bt.return;try{m=D,yr.props=m.memoizedProps,yr.state=m.memoizedState,yr.componentWillUnmount()}catch(vr){Es(D,T,vr)}}break;case 5:Ng(Bt,Bt.return);break;case 22:if(Bt.memoizedState!==null){yj(Ht);continue}}cr!==null?(cr.return=Bt,gr=cr):yj(Ht)}Ut=Ut.sibling}e:for(Ut=null,Ht=h;;){if(Ht.tag===5){if(Ut===null){Ut=Ht;try{G=Ht.stateNode,dt?(Q=G.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(je=Ht.stateNode,Re=Ht.memoizedProps.style,de=Re!=null&&Re.hasOwnProperty("display")?Re.display:null,je.style.display=Nt("display",de))}catch(vr){Es(h,h.return,vr)}}}else if(Ht.tag===6){if(Ut===null)try{Ht.stateNode.nodeValue=dt?"":Ht.memoizedProps}catch(vr){Es(h,h.return,vr)}}else if((Ht.tag!==22&&Ht.tag!==23||Ht.memoizedState===null||Ht===h)&&Ht.child!==null){Ht.child.return=Ht,Ht=Ht.child;continue}if(Ht===h)break e;for(;Ht.sibling===null;){if(Ht.return===null||Ht.return===h)break e;Ut===Ht&&(Ut=null),Ht=Ht.return}Ut===Ht&&(Ut=null),Ht.sibling.return=Ht.return,Ht=Ht.sibling}}break;case 19:Xl(m,h),Ic(h),D&4&&gj(h);break;case 21:break;default:Xl(m,h),Ic(h)}}function Ic(h){var m=h.flags;if(m&2){try{e:{for(var T=h.return;T!==null;){if(dj(T)){var D=T;break e}T=T.return}throw Error(r(160))}switch(D.tag){case 5:var G=D.stateNode;D.flags&32&&(qe(G,""),D.flags&=-33);var Q=fj(h);eS(h,Q,G);break;case 3:case 4:var de=D.stateNode.containerInfo,je=fj(h);Z2(h,je,de);break;default:throw Error(r(161))}}catch(Re){Es(h,h.return,Re)}h.flags&=-3}m&4096&&(h.flags&=-4097)}function NV(h,m,T){gr=h,pj(h)}function pj(h,m,T){for(var D=(h.mode&1)!==0;gr!==null;){var G=gr,Q=G.child;if(G.tag===22&&D){var de=G.memoizedState!==null||W1;if(!de){var je=G.alternate,Re=je!==null&&je.memoizedState!==null||_i;je=W1;var dt=_i;if(W1=de,(_i=Re)&&!dt)for(gr=G;gr!==null;)de=gr,Re=de.child,de.tag===22&&de.memoizedState!==null?vj(G):Re!==null?(Re.return=de,gr=Re):vj(G);for(;Q!==null;)gr=Q,pj(Q),Q=Q.sibling;gr=G,W1=je,_i=dt}xj(h)}else(G.subtreeFlags&8772)!==0&&Q!==null?(Q.return=G,gr=Q):xj(h)}}function xj(h){for(;gr!==null;){var m=gr;if((m.flags&8772)!==0){var T=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:_i||H1(5,m);break;case 1:var D=m.stateNode;if(m.flags&4&&!_i)if(T===null)D.componentDidMount();else{var G=m.elementType===m.type?T.memoizedProps:pa(m.type,T.memoizedProps);D.componentDidUpdate(G,T.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var Q=m.updateQueue;Q!==null&&ds(m,Q,D);break;case 3:var de=m.updateQueue;if(de!==null){if(T=null,m.child!==null)switch(m.child.tag){case 5:T=m.child.stateNode;break;case 1:T=m.child.stateNode}ds(m,de,T)}break;case 5:var je=m.stateNode;if(T===null&&m.flags&4){T=je;var Re=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":Re.autoFocus&&T.focus();break;case"img":Re.src&&(T.src=Re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var dt=m.alternate;if(dt!==null){var Ut=dt.memoizedState;if(Ut!==null){var Ht=Ut.dehydrated;Ht!==null&&pi(Ht)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}_i||m.flags&512&&Q2(m)}catch(Bt){Es(m,m.return,Bt)}}if(m===h){gr=null;break}if(T=m.sibling,T!==null){T.return=m.return,gr=T;break}gr=m.return}}function yj(h){for(;gr!==null;){var m=gr;if(m===h){gr=null;break}var T=m.sibling;if(T!==null){T.return=m.return,gr=T;break}gr=m.return}}function vj(h){for(;gr!==null;){var m=gr;try{switch(m.tag){case 0:case 11:case 15:var T=m.return;try{H1(4,m)}catch(Re){Es(m,T,Re)}break;case 1:var D=m.stateNode;if(typeof D.componentDidMount=="function"){var G=m.return;try{D.componentDidMount()}catch(Re){Es(m,G,Re)}}var Q=m.return;try{Q2(m)}catch(Re){Es(m,Q,Re)}break;case 5:var de=m.return;try{Q2(m)}catch(Re){Es(m,de,Re)}}}catch(Re){Es(m,m.return,Re)}if(m===h){gr=null;break}var je=m.sibling;if(je!==null){je.return=m.return,gr=je;break}gr=m.return}}var AV=Math.ceil,G1=N.ReactCurrentDispatcher,tS=N.ReactCurrentOwner,ll=N.ReactCurrentBatchConfig,gn=0,Oa=null,ra=null,ti=0,Ro=0,Ag=Wl(0),xa=0,Jp=null,mh=0,V1=0,rS=0,Qp=null,go=null,nS=0,jg=1/0,ju=null,K1=!1,sS=null,Yd=null,q1=!1,Xd=null,Y1=0,Zp=0,aS=null,X1=-1,J1=0;function Yi(){return(gn&6)!==0?pt():X1!==-1?X1:X1=pt()}function Jd(h){return(h.mode&1)===0?1:(gn&2)!==0&&ti!==0?ti&-ti:Bp.transition!==null?(J1===0&&(J1=es()),J1):(h=cn,h!==0||(h=window.event,h=h===void 0?16:d1(h.type)),h)}function Jl(h,m,T,D){if(50<Zp)throw Zp=0,aS=null,Error(r(185));Mi(h,T,D),((gn&2)===0||h!==Oa)&&(h===Oa&&((gn&2)===0&&(V1|=T),xa===4&&Qd(h,ti)),mo(h,D),T===1&&gn===0&&(m.mode&1)===0&&(jg=pt()+500,Pd&&Tc()))}function mo(h,m){var T=h.callbackNode;qt(h,m);var D=Be(h,h===Oa?ti:0);if(D===0)T!==null&&Ne(T),h.callbackNode=null,h.callbackPriority=0;else if(m=D&-D,h.callbackPriority!==m){if(T!=null&&Ne(T),m===1)h.tag===0?Hl(_j.bind(null,h)):ih(_j.bind(null,h)),T1(function(){(gn&6)===0&&Tc()}),T=null;else{switch(su(D)){case 1:T=xt;break;case 4:T=Jt;break;case 16:T=wr;break;case 536870912:T=xr;break;default:T=wr}T=Aj(T,wj.bind(null,h))}h.callbackPriority=m,h.callbackNode=T}}function wj(h,m){if(X1=-1,J1=0,(gn&6)!==0)throw Error(r(327));var T=h.callbackNode;if(Pg()&&h.callbackNode!==T)return null;var D=Be(h,h===Oa?ti:0);if(D===0)return null;if((D&30)!==0||(D&h.expiredLanes)!==0||m)m=Q1(h,D);else{m=D;var G=gn;gn|=2;var Q=Sj();(Oa!==h||ti!==m)&&(ju=null,jg=pt()+500,xh(h,m));do try{FV();break}catch(je){bj(h,je)}while(!0);gg(),G1.current=Q,gn=G,ra!==null?m=0:(Oa=null,ti=0,m=xa)}if(m!==0){if(m===2&&(G=lr(h),G!==0&&(D=G,m=iS(h,G))),m===1)throw T=Jp,xh(h,0),Qd(h,D),mo(h,pt()),T;if(m===6)Qd(h,D);else{if(G=h.current.alternate,(D&30)===0&&!jV(G)&&(m=Q1(h,D),m===2&&(Q=lr(h),Q!==0&&(D=Q,m=iS(h,Q))),m===1))throw T=Jp,xh(h,0),Qd(h,D),mo(h,pt()),T;switch(h.finishedWork=G,h.finishedLanes=D,m){case 0:case 1:throw Error(r(345));case 2:yh(h,go,ju);break;case 3:if(Qd(h,D),(D&130023424)===D&&(m=nS+500-pt(),10<m)){if(Be(h,0)!==0)break;if(G=h.suspendedLanes,(G&D)!==D){Yi(),h.pingedLanes|=h.suspendedLanes&G;break}h.timeoutHandle=zi(yh.bind(null,h,go,ju),m);break}yh(h,go,ju);break;case 4:if(Qd(h,D),(D&4194240)===D)break;for(m=h.eventTimes,G=-1;0<D;){var de=31-he(D);Q=1<<de,de=m[de],de>G&&(G=de),D&=~Q}if(D=G,D=pt()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*AV(D/1960))-D,10<D){h.timeoutHandle=zi(yh.bind(null,h,go,ju),D);break}yh(h,go,ju);break;case 5:yh(h,go,ju);break;default:throw Error(r(329))}}}return mo(h,pt()),h.callbackNode===T?wj.bind(null,h):null}function iS(h,m){var T=Qp;return h.current.memoizedState.isDehydrated&&(xh(h,m).flags|=256),h=Q1(h,m),h!==2&&(m=go,go=T,m!==null&&oS(m)),h}function oS(h){go===null?go=h:go.push.apply(go,h)}function jV(h){for(var m=h;;){if(m.flags&16384){var T=m.updateQueue;if(T!==null&&(T=T.stores,T!==null))for(var D=0;D<T.length;D++){var G=T[D],Q=G.getSnapshot;G=G.value;try{if(!yi(Q(),G))return!1}catch{return!1}}}if(T=m.child,m.subtreeFlags&16384&&T!==null)T.return=m,m=T;else{if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Qd(h,m){for(m&=~rS,m&=~V1,h.suspendedLanes|=m,h.pingedLanes&=~m,h=h.expirationTimes;0<m;){var T=31-he(m),D=1<<T;h[T]=-1,m&=~D}}function _j(h){if((gn&6)!==0)throw Error(r(327));Pg();var m=Be(h,0);if((m&1)===0)return mo(h,pt()),null;var T=Q1(h,m);if(h.tag!==0&&T===2){var D=lr(h);D!==0&&(m=D,T=iS(h,D))}if(T===1)throw T=Jp,xh(h,0),Qd(h,m),mo(h,pt()),T;if(T===6)throw Error(r(345));return h.finishedWork=h.current.alternate,h.finishedLanes=m,yh(h,go,ju),mo(h,pt()),null}function lS(h,m){var T=gn;gn|=1;try{return h(m)}finally{gn=T,gn===0&&(jg=pt()+500,Pd&&Tc())}}function ph(h){Xd!==null&&Xd.tag===0&&(gn&6)===0&&Pg();var m=gn;gn|=1;var T=ll.transition,D=cn;try{if(ll.transition=null,cn=1,h)return h()}finally{cn=D,ll.transition=T,gn=m,(gn&6)===0&&Tc()}}function cS(){Ro=Ag.current,Bn(Ag)}function xh(h,m){h.finishedWork=null,h.finishedLanes=0;var T=h.timeoutHandle;if(T!==-1&&(h.timeoutHandle=-1,Ip(T)),ra!==null)for(T=ra.return;T!==null;){var D=T;switch(ta(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&jd();break;case 3:Zn(),Bn(Ea),Bn(ma),Aa();break;case 5:Vl(D);break;case 4:Zn();break;case 13:Bn($n);break;case 19:Bn($n);break;case 10:mg(D.type._context);break;case 22:case 23:cS()}T=T.return}if(Oa=h,ra=h=Zd(h.current,null),ti=Ro=m,xa=0,Jp=null,rS=V1=mh=0,go=Qp=null,nl!==null){for(m=0;m<nl.length;m++)if(T=nl[m],D=T.interleaved,D!==null){T.interleaved=null;var G=D.next,Q=T.pending;if(Q!==null){var de=Q.next;Q.next=G,D.next=de}T.pending=D}nl=null}return h}function bj(h,m){do{var T=ra;try{if(gg(),Bd.current=Hd,Io){for(var D=Tn.memoizedState;D!==null;){var G=D.queue;G!==null&&(G.pending=null),D=D.next}Io=!1}if(Qa=0,Cs=fs=Tn=null,Pc=!1,ho=0,tS.current=null,T===null||T.return===null){xa=1,Jp=m,ra=null;break}e:{var Q=h,de=T.return,je=T,Re=m;if(m=ti,je.flags|=32768,Re!==null&&typeof Re=="object"&&typeof Re.then=="function"){var dt=Re,Ut=je,Ht=Ut.tag;if((Ut.mode&1)===0&&(Ht===0||Ht===11||Ht===15)){var Bt=Ut.alternate;Bt?(Ut.updateQueue=Bt.updateQueue,Ut.memoizedState=Bt.memoizedState,Ut.lanes=Bt.lanes):(Ut.updateQueue=null,Ut.memoizedState=null)}var cr=O(de);if(cr!==null){cr.flags&=-257,U(cr,de,je,Q,m),cr.mode&1&&b(Q,dt,m),m=cr,Re=dt;var yr=m.updateQueue;if(yr===null){var vr=new Set;vr.add(Re),m.updateQueue=vr}else yr.add(Re);break e}else{if((m&1)===0){b(Q,dt,m),uS();break e}Re=Error(r(426))}}else if(Sn&&je.mode&1){var Vs=O(de);if(Vs!==null){(Vs.flags&65536)===0&&(Vs.flags|=256),U(Vs,de,je,Q,m),lh(Au(Re,je));break e}}Q=Re=Au(Re,je),xa!==4&&(xa=2),Qp===null?Qp=[Q]:Qp.push(Q),Q=de;do{switch(Q.tag){case 3:Q.flags|=65536,m&=-m,Q.lanes|=m;var nt=z1(Q,Re,m);fh(Q,nt);break e;case 1:je=Re;var ze=Q.type,it=Q.stateNode;if((Q.flags&128)===0&&(typeof ze.getDerivedStateFromError=="function"||it!==null&&typeof it.componentDidCatch=="function"&&(Yd===null||!Yd.has(it)))){Q.flags|=65536,m&=-m,Q.lanes|=m;var Xt=y(Q,je,m);fh(Q,Xt);break e}}Q=Q.return}while(Q!==null)}Cj(T)}catch(_r){m=_r,ra===T&&T!==null&&(ra=T=T.return);continue}break}while(!0)}function Sj(){var h=G1.current;return G1.current=Hd,h===null?Hd:h}function uS(){(xa===0||xa===3||xa===2)&&(xa=4),Oa===null||(mh&268435455)===0&&(V1&268435455)===0||Qd(Oa,ti)}function Q1(h,m){var T=gn;gn|=2;var D=Sj();(Oa!==h||ti!==m)&&(ju=null,xh(h,m));do try{PV();break}catch(G){bj(h,G)}while(!0);if(gg(),gn=T,G1.current=D,ra!==null)throw Error(r(261));return Oa=null,ti=0,xa}function PV(){for(;ra!==null;)kj(ra)}function FV(){for(;ra!==null&&!Ye();)kj(ra)}function kj(h){var m=Nj(h.alternate,h,Ro);h.memoizedProps=h.pendingProps,m===null?Cj(h):ra=m,tS.current=null}function Cj(h){var m=h;do{var T=m.alternate;if(h=m.return,(m.flags&32768)===0){if(T=kV(T,m,Ro),T!==null){ra=T;return}}else{if(T=CV(T,m),T!==null){T.flags&=32767,ra=T;return}if(h!==null)h.flags|=32768,h.subtreeFlags=0,h.deletions=null;else{xa=6,ra=null;return}}if(m=m.sibling,m!==null){ra=m;return}ra=m=h}while(m!==null);xa===0&&(xa=5)}function yh(h,m,T){var D=cn,G=ll.transition;try{ll.transition=null,cn=1,OV(h,m,T,D)}finally{ll.transition=G,cn=D}return null}function OV(h,m,T,D){do Pg();while(Xd!==null);if((gn&6)!==0)throw Error(r(327));T=h.finishedWork;var G=h.finishedLanes;if(T===null)return null;if(h.finishedWork=null,h.finishedLanes=0,T===h.current)throw Error(r(177));h.callbackNode=null,h.callbackPriority=0;var Q=T.lanes|T.childLanes;if(B0(h,Q),h===Oa&&(ra=Oa=null,ti=0),(T.subtreeFlags&2064)===0&&(T.flags&2064)===0||q1||(q1=!0,Aj(wr,function(){return Pg(),null})),Q=(T.flags&15990)!==0,(T.subtreeFlags&15990)!==0||Q){Q=ll.transition,ll.transition=null;var de=cn;cn=1;var je=gn;gn|=4,tS.current=null,EV(h,T),mj(T,h),Qf(Op),U0=!!Fp,Op=Fp=null,h.current=T,NV(T),ot(),gn=je,cn=de,ll.transition=Q}else h.current=T;if(q1&&(q1=!1,Xd=h,Y1=G),Q=h.pendingLanes,Q===0&&(Yd=null),Jr(T.stateNode),mo(h,pt()),m!==null)for(D=h.onRecoverableError,T=0;T<m.length;T++)G=m[T],D(G.value,{componentStack:G.stack,digest:G.digest});if(K1)throw K1=!1,h=sS,sS=null,h;return(Y1&1)!==0&&h.tag!==0&&Pg(),Q=h.pendingLanes,(Q&1)!==0?h===aS?Zp++:(Zp=0,aS=h):Zp=0,Tc(),null}function Pg(){if(Xd!==null){var h=su(Y1),m=ll.transition,T=cn;try{if(ll.transition=null,cn=16>h?16:h,Xd===null)var D=!1;else{if(h=Xd,Xd=null,Y1=0,(gn&6)!==0)throw Error(r(331));var G=gn;for(gn|=4,gr=h.current;gr!==null;){var Q=gr,de=Q.child;if((gr.flags&16)!==0){var je=Q.deletions;if(je!==null){for(var Re=0;Re<je.length;Re++){var dt=je[Re];for(gr=dt;gr!==null;){var Ut=gr;switch(Ut.tag){case 0:case 11:case 15:Xp(8,Ut,Q)}var Ht=Ut.child;if(Ht!==null)Ht.return=Ut,gr=Ht;else for(;gr!==null;){Ut=gr;var Bt=Ut.sibling,cr=Ut.return;if(uj(Ut),Ut===dt){gr=null;break}if(Bt!==null){Bt.return=cr,gr=Bt;break}gr=cr}}}var yr=Q.alternate;if(yr!==null){var vr=yr.child;if(vr!==null){yr.child=null;do{var Vs=vr.sibling;vr.sibling=null,vr=Vs}while(vr!==null)}}gr=Q}}if((Q.subtreeFlags&2064)!==0&&de!==null)de.return=Q,gr=de;else e:for(;gr!==null;){if(Q=gr,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:Xp(9,Q,Q.return)}var nt=Q.sibling;if(nt!==null){nt.return=Q.return,gr=nt;break e}gr=Q.return}}var ze=h.current;for(gr=ze;gr!==null;){de=gr;var it=de.child;if((de.subtreeFlags&2064)!==0&&it!==null)it.return=de,gr=it;else e:for(de=ze;gr!==null;){if(je=gr,(je.flags&2048)!==0)try{switch(je.tag){case 0:case 11:case 15:H1(9,je)}}catch(_r){Es(je,je.return,_r)}if(je===de){gr=null;break e}var Xt=je.sibling;if(Xt!==null){Xt.return=je.return,gr=Xt;break e}gr=je.return}}if(gn=G,Tc(),rn&&typeof rn.onPostCommitFiberRoot=="function")try{rn.onPostCommitFiberRoot(Ir,h)}catch{}D=!0}return D}finally{cn=T,ll.transition=m}}return!1}function Tj(h,m,T){m=Au(T,m),m=z1(h,m,1),h=il(h,m,1),m=Yi(),h!==null&&(Mi(h,1,m),mo(h,m))}function Es(h,m,T){if(h.tag===3)Tj(h,h,T);else for(;m!==null;){if(m.tag===3){Tj(m,h,T);break}else if(m.tag===1){var D=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Yd===null||!Yd.has(D))){h=Au(T,h),h=y(m,h,1),m=il(m,h,1),h=Yi(),m!==null&&(Mi(m,1,h),mo(m,h));break}}m=m.return}}function DV(h,m,T){var D=h.pingCache;D!==null&&D.delete(m),m=Yi(),h.pingedLanes|=h.suspendedLanes&T,Oa===h&&(ti&T)===T&&(xa===4||xa===3&&(ti&130023424)===ti&&500>pt()-nS?xh(h,0):rS|=T),mo(h,m)}function Ej(h,m){m===0&&((h.mode&1)===0?m=1:(m=_n,_n<<=1,(_n&130023424)===0&&(_n=4194304)));var T=Yi();h=Ki(h,m),h!==null&&(Mi(h,m,T),mo(h,T))}function IV(h){var m=h.memoizedState,T=0;m!==null&&(T=m.retryLane),Ej(h,T)}function RV(h,m){var T=0;switch(h.tag){case 13:var D=h.stateNode,G=h.memoizedState;G!==null&&(T=G.retryLane);break;case 19:D=h.stateNode;break;default:throw Error(r(314))}D!==null&&D.delete(m),Ej(h,T)}var Nj;Nj=function(h,m,T){if(h!==null)if(h.memoizedProps!==m.pendingProps||Ea.current)te=!0;else{if((h.lanes&T)===0&&(m.flags&128)===0)return te=!1,Y2(h,m,T);te=(h.flags&131072)!==0}else te=!1,Sn&&(m.flags&1048576)!==0&&P1(m,Nc,m.index);switch(m.lanes=0,m.tag){case 2:var D=m.type;on(h,m),h=m.pendingProps;var G=wu(m,ma.current);Gl(m,T),G=$d(null,m,D,h,G,T);var Q=Ud();return m.flags|=1,typeof G=="object"&&G!==null&&typeof G.render=="function"&&G.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Na(D)?(Q=!0,_u(m)):Q=!1,m.memoizedState=G.state!==null&&G.state!==void 0?G.state:null,dh(m),G.updater=Vd,m.stateNode=G,G._reactInternals=m,Tg(m,D,h,T),m=kn(null,m,D,!0,Q,T)):(m.tag=0,Sn&&Q&&Fd(m),ve(null,m,G,T),m=m.child),m;case 16:D=m.elementType;e:{switch(on(h,m),h=m.pendingProps,G=D._init,D=G(D._payload),m.type=D,G=m.tag=LV(D),h=pa(D,h),G){case 0:m=ar(null,m,D,h,T);break e;case 1:m=Un(null,m,D,h,T);break e;case 11:m=Ge(null,m,D,h,T);break e;case 14:m=ft(null,m,D,pa(D.type,h),T);break e}throw Error(r(306,D,""))}return m;case 0:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),ar(h,m,D,G,T);case 1:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),Un(h,m,D,G,T);case 3:e:{if(Za(m),h===null)throw Error(r(387));D=m.pendingProps,Q=m.memoizedState,G=Q.element,xg(h,m),Rd(m,D,null,T);var de=m.memoizedState;if(D=de.element,Q.isDehydrated)if(Q={element:D,isDehydrated:!1,cache:de.cache,pendingSuspenseBoundaries:de.pendingSuspenseBoundaries,transitions:de.transitions},m.updateQueue.baseState=Q,m.memoizedState=Q,m.flags&256){G=Au(Error(r(423)),m),m=ol(h,m,D,T,G);break e}else if(D!==G){G=Au(Error(r(424)),m),m=ol(h,m,D,T,G);break e}else for(sr=Zo(m.stateNode.containerInfo.firstChild),Hi=m,Sn=!0,Gi=null,T=fo(m,null,D,T),m.child=T;T;)T.flags=T.flags&-3|4096,T=T.sibling;else{if(Cu(),D===G){m=Fa(h,m,T);break e}ve(h,m,D,T)}m=m.child}return m;case 5:return Md(m),h===null&&Od(m),D=m.type,G=m.pendingProps,Q=h!==null?h.memoizedProps:null,de=G.children,Dp(D,G)?de=null:Q!==null&&Dp(D,Q)&&(m.flags|=32),Ur(h,m),ve(h,m,de,T),m.child;case 6:return h===null&&Od(m),null;case 13:return yt(h,m,T);case 4:return jc(m,m.stateNode.containerInfo),D=m.pendingProps,h===null?m.child=Tu(m,null,D,T):ve(h,m,D,T),m.child;case 11:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),Ge(h,m,D,G,T);case 7:return ve(h,m,m.pendingProps,T),m.child;case 8:return ve(h,m,m.pendingProps.children,T),m.child;case 12:return ve(h,m,m.pendingProps.children,T),m.child;case 10:e:{if(D=m.type._context,G=m.pendingProps,Q=m.memoizedProps,de=G.value,An(ch,D._currentValue),D._currentValue=de,Q!==null)if(yi(Q.value,de)){if(Q.children===G.children&&!Ea.current){m=Fa(h,m,T);break e}}else for(Q=m.child,Q!==null&&(Q.return=m);Q!==null;){var je=Q.dependencies;if(je!==null){de=Q.child;for(var Re=je.firstContext;Re!==null;){if(Re.context===D){if(Q.tag===1){Re=al(-1,T&-T),Re.tag=2;var dt=Q.updateQueue;if(dt!==null){dt=dt.shared;var Ut=dt.pending;Ut===null?Re.next=Re:(Re.next=Ut.next,Ut.next=Re),dt.pending=Re}}Q.lanes|=T,Re=Q.alternate,Re!==null&&(Re.lanes|=T),pg(Q.return,T,m),je.lanes|=T;break}Re=Re.next}}else if(Q.tag===10)de=Q.type===m.type?null:Q.child;else if(Q.tag===18){if(de=Q.return,de===null)throw Error(r(341));de.lanes|=T,je=de.alternate,je!==null&&(je.lanes|=T),pg(de,T,m),de=Q.sibling}else de=Q.child;if(de!==null)de.return=Q;else for(de=Q;de!==null;){if(de===m){de=null;break}if(Q=de.sibling,Q!==null){Q.return=de.return,de=Q;break}de=de.return}Q=de}ve(h,m,G.children,T),m=m.child}return m;case 9:return G=m.type,D=m.pendingProps.children,Gl(m,T),G=Ja(G),D=D(G),m.flags|=1,ve(h,m,D,T),m.child;case 14:return D=m.type,G=pa(D,m.pendingProps),G=pa(D.type,G),ft(h,m,D,G,T);case 15:return Kt(h,m,m.type,m.pendingProps,T);case 17:return D=m.type,G=m.pendingProps,G=m.elementType===D?G:pa(D,G),on(h,m),m.tag=1,Na(D)?(h=!0,_u(m)):h=!1,Gl(m,T),U1(m,D,G),Tg(m,D,G,T),kn(null,m,D,!0,h,T);case 19:return Gs(h,m,T);case 22:return hr(h,m,T)}throw Error(r(156,m.tag))};function Aj(h,m){return Ee(h,m)}function MV(h,m,T,D){this.tag=h,this.key=T,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cl(h,m,T,D){return new MV(h,m,T,D)}function dS(h){return h=h.prototype,!(!h||!h.isReactComponent)}function LV(h){if(typeof h=="function")return dS(h)?1:0;if(h!=null){if(h=h.$$typeof,h===Y)return 11;if(h===ee)return 14}return 2}function Zd(h,m){var T=h.alternate;return T===null?(T=cl(h.tag,m,h.key,h.mode),T.elementType=h.elementType,T.type=h.type,T.stateNode=h.stateNode,T.alternate=h,h.alternate=T):(T.pendingProps=m,T.type=h.type,T.flags=0,T.subtreeFlags=0,T.deletions=null),T.flags=h.flags&14680064,T.childLanes=h.childLanes,T.lanes=h.lanes,T.child=h.child,T.memoizedProps=h.memoizedProps,T.memoizedState=h.memoizedState,T.updateQueue=h.updateQueue,m=h.dependencies,T.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},T.sibling=h.sibling,T.index=h.index,T.ref=h.ref,T}function Z1(h,m,T,D,G,Q){var de=2;if(D=h,typeof h=="function")dS(h)&&(de=1);else if(typeof h=="string")de=5;else e:switch(h){case F:return vh(T.children,G,Q,m);case A:de=8,G|=8;break;case j:return h=cl(12,T,m,G|2),h.elementType=j,h.lanes=Q,h;case Z:return h=cl(13,T,m,G),h.elementType=Z,h.lanes=Q,h;case ae:return h=cl(19,T,m,G),h.elementType=ae,h.lanes=Q,h;case B:return ew(T,G,Q,m);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case I:de=10;break e;case L:de=9;break e;case Y:de=11;break e;case ee:de=14;break e;case ne:de=16,D=null;break e}throw Error(r(130,h==null?h:typeof h,""))}return m=cl(de,T,m,G),m.elementType=h,m.type=D,m.lanes=Q,m}function vh(h,m,T,D){return h=cl(7,h,D,m),h.lanes=T,h}function ew(h,m,T,D){return h=cl(22,h,D,m),h.elementType=B,h.lanes=T,h.stateNode={isHidden:!1},h}function fS(h,m,T){return h=cl(6,h,null,m),h.lanes=T,h}function hS(h,m,T){return m=cl(4,h.children!==null?h.children:[],h.key,m),m.lanes=T,m.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},m}function BV(h,m,T,D,G){this.tag=m,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kn(0),this.expirationTimes=Kn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kn(0),this.identifierPrefix=D,this.onRecoverableError=G,this.mutableSourceEagerHydrationData=null}function gS(h,m,T,D,G,Q,de,je,Re){return h=new BV(h,m,T,je,Re),m===1?(m=1,Q===!0&&(m|=8)):m=0,Q=cl(3,null,null,m),h.current=Q,Q.stateNode=h,Q.memoizedState={element:D,isDehydrated:T,cache:null,transitions:null,pendingSuspenseBoundaries:null},dh(Q),h}function $V(h,m,T){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:D==null?null:""+D,children:h,containerInfo:m,implementation:T}}function jj(h){if(!h)return tl;h=h._reactInternals;e:{if(Se(h)!==h||h.tag!==1)throw Error(r(170));var m=h;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Na(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(r(171))}if(h.tag===1){var T=h.type;if(Na(T))return cg(h,T,m)}return m}function Pj(h,m,T,D,G,Q,de,je,Re){return h=gS(T,D,!0,h,G,Q,de,je,Re),h.context=jj(null),T=h.current,D=Yi(),G=Jd(T),Q=al(D,G),Q.callback=m??null,il(T,Q,G),h.current.lanes=G,Mi(h,G,D),mo(h,D),h}function tw(h,m,T,D){var G=m.current,Q=Yi(),de=Jd(G);return T=jj(T),m.context===null?m.context=T:m.pendingContext=T,m=al(Q,de),m.payload={element:h},D=D===void 0?null:D,D!==null&&(m.callback=D),h=il(G,m,de),h!==null&&(Jl(h,G,de,Q),yg(h,G,de)),de}function rw(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 5:return h.child.stateNode;default:return h.child.stateNode}}function Fj(h,m){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var T=h.retryLane;h.retryLane=T!==0&&T<m?T:m}}function mS(h,m){Fj(h,m),(h=h.alternate)&&Fj(h,m)}function UV(){return null}var Oj=typeof reportError=="function"?reportError:function(h){console.error(h)};function pS(h){this._internalRoot=h}nw.prototype.render=pS.prototype.render=function(h){var m=this._internalRoot;if(m===null)throw Error(r(409));tw(h,m,null,null)},nw.prototype.unmount=pS.prototype.unmount=function(){var h=this._internalRoot;if(h!==null){this._internalRoot=null;var m=h.containerInfo;ph(function(){tw(null,h,null,null)}),m[el]=null}};function nw(h){this._internalRoot=h}nw.prototype.unstable_scheduleHydration=function(h){if(h){var m=St();h={blockedOn:null,target:h,priority:m};for(var T=0;T<Gr.length&&m!==0&&m<Gr[T].priority;T++);Gr.splice(T,0,h),T===0&&oo(h)}};function xS(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)}function sw(h){return!(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11&&(h.nodeType!==8||h.nodeValue!==" react-mount-point-unstable "))}function Dj(){}function zV(h,m,T,D,G){if(G){if(typeof D=="function"){var Q=D;D=function(){var dt=rw(de);Q.call(dt)}}var de=Pj(m,D,h,0,null,!1,!1,"",Dj);return h._reactRootContainer=de,h[el]=de.current,mu(h.nodeType===8?h.parentNode:h),ph(),de}for(;G=h.lastChild;)h.removeChild(G);if(typeof D=="function"){var je=D;D=function(){var dt=rw(Re);je.call(dt)}}var Re=gS(h,0,!1,null,null,!1,!1,"",Dj);return h._reactRootContainer=Re,h[el]=Re.current,mu(h.nodeType===8?h.parentNode:h),ph(function(){tw(m,Re,T,D)}),Re}function aw(h,m,T,D,G){var Q=T._reactRootContainer;if(Q){var de=Q;if(typeof G=="function"){var je=G;G=function(){var Re=rw(de);je.call(Re)}}tw(m,de,h,G)}else de=zV(T,m,h,G,D);return rw(de)}st=function(h){switch(h.tag){case 3:var m=h.stateNode;if(m.current.memoizedState.isDehydrated){var T=Zr(m.pendingLanes);T!==0&&(Gf(m,T|1),mo(m,pt()),(gn&6)===0&&(jg=pt()+500,Tc()))}break;case 13:ph(function(){var D=Ki(h,1);if(D!==null){var G=Yi();Jl(D,h,1,G)}}),mS(h,1)}},mt=function(h){if(h.tag===13){var m=Ki(h,134217728);if(m!==null){var T=Yi();Jl(m,h,134217728,T)}mS(h,134217728)}},Yt=function(h){if(h.tag===13){var m=Jd(h),T=Ki(h,m);if(T!==null){var D=Yi();Jl(T,h,m,D)}mS(h,m)}},St=function(){return cn},br=function(h,m){var T=cn;try{return cn=h,m()}finally{cn=T}},ge=function(h,m,T){switch(m){case"input":if(Le(h,T),m=T.name,T.type==="radio"&&m!=null){for(T=h;T.parentNode;)T=T.parentNode;for(T=T.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<T.length;m++){var D=T[m];if(D!==h&&D.form===h.form){var G=ea(D);if(!G)throw Error(r(90));re(D),Le(D,G)}}}break;case"textarea":Dt(h,T);break;case"select":m=T.value,m!=null&&ht(h,!!T.multiple,m,!1)}},He=lS,ke=ph;var WV={usingClientEntryPoint:!1,Events:[ah,zs,ea,kt,Pe,lS]},ex={findFiberByHostInstance:kc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HV={bundleType:ex.bundleType,version:ex.version,rendererPackageName:ex.rendererPackageName,rendererConfig:ex.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(h){return h=oe(h),h===null?null:h.stateNode},findFiberByHostInstance:ex.findFiberByHostInstance||UV,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var iw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!iw.isDisabled&&iw.supportsFiber)try{Ir=iw.inject(HV),rn=iw}catch{}}return po.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=WV,po.createPortal=function(h,m){var T=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xS(m))throw Error(r(200));return $V(h,m,null,T)},po.createRoot=function(h,m){if(!xS(h))throw Error(r(299));var T=!1,D="",G=Oj;return m!=null&&(m.unstable_strictMode===!0&&(T=!0),m.identifierPrefix!==void 0&&(D=m.identifierPrefix),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),m=gS(h,1,!1,null,null,T,!1,D,G),h[el]=m.current,mu(h.nodeType===8?h.parentNode:h),new pS(m)},po.findDOMNode=function(h){if(h==null)return null;if(h.nodeType===1)return h;var m=h._reactInternals;if(m===void 0)throw typeof h.render=="function"?Error(r(188)):(h=Object.keys(h).join(","),Error(r(268,h)));return h=oe(m),h=h===null?null:h.stateNode,h},po.flushSync=function(h){return ph(h)},po.hydrate=function(h,m,T){if(!sw(m))throw Error(r(200));return aw(null,h,m,!0,T)},po.hydrateRoot=function(h,m,T){if(!xS(h))throw Error(r(405));var D=T!=null&&T.hydratedSources||null,G=!1,Q="",de=Oj;if(T!=null&&(T.unstable_strictMode===!0&&(G=!0),T.identifierPrefix!==void 0&&(Q=T.identifierPrefix),T.onRecoverableError!==void 0&&(de=T.onRecoverableError)),m=Pj(m,null,h,1,T??null,G,!1,Q,de),h[el]=m.current,mu(h),D)for(h=0;h<D.length;h++)T=D[h],G=T._getVersion,G=G(T._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[T,G]:m.mutableSourceEagerHydrationData.push(T,G);return new nw(m)},po.render=function(h,m,T){if(!sw(m))throw Error(r(200));return aw(null,h,m,!1,T)},po.unmountComponentAtNode=function(h){if(!sw(h))throw Error(r(40));return h._reactRootContainer?(ph(function(){aw(null,null,h,!1,function(){h._reactRootContainer=null,h[el]=null})}),!0):!1},po.unstable_batchedUpdates=lS,po.unstable_renderSubtreeIntoContainer=function(h,m,T,D){if(!sw(T))throw Error(r(200));if(h==null||h._reactInternals===void 0)throw Error(r(38));return aw(h,m,T,!1,D)},po.version="18.3.1-next-f1338f8080-20240426",po}var zj;function xM(){if(zj)return wS.exports;zj=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),wS.exports=JV(),wS.exports}var Wj;function QV(){if(Wj)return ow;Wj=1;var e=xM();return ow.createRoot=e.createRoot,ow.hydrateRoot=e.hydrateRoot,ow}var ZV=QV();const eK=Ol(ZV);var iT=xM();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dy(){return Dy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dy.apply(this,arguments)}var uf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(uf||(uf={}));const Hj="popstate";function tK(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return oT("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:vM(s)}return nK(t,r,null,e)}function ca(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function yM(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function rK(){return Math.random().toString(36).substr(2,8)}function Gj(e,t){return{usr:e.state,key:e.key,idx:t}}function oT(e,t,r,n){return r===void 0&&(r=null),Dy({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Im(t):t,{state:r,key:t&&t.key||n||rK()})}function vM(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Im(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function nK(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=uf.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Dy({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){o=uf.Pop;let w=d(),C=w==null?null:w-u;u=w,c&&c({action:o,location:v.location,delta:C})}function g(w,C){o=uf.Push;let k=oT(v.location,w,C);u=d()+1;let _=Gj(k,u),N=v.createHref(k);try{i.pushState(_,"",N)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(N)}a&&c&&c({action:o,location:v.location,delta:1})}function p(w,C){o=uf.Replace;let k=oT(v.location,w,C);u=d();let _=Gj(k,u),N=v.createHref(k);i.replaceState(_,"",N),a&&c&&c({action:o,location:v.location,delta:0})}function x(w){let C=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof w=="string"?w:vM(w);return k=k.replace(/ $/,"%20"),ca(C,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,C)}let v={get action(){return o},get location(){return e(s,i)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Hj,f),c=w,()=>{s.removeEventListener(Hj,f),c=null}},createHref(w){return t(s,w)},createURL:x,encodeLocation(w){let C=x(w);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:g,replace:p,go(w){return i.go(w)}};return v}var Vj;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Vj||(Vj={}));function sK(e,t,r){return r===void 0&&(r="/"),aK(e,t,r)}function aK(e,t,r,n){let s=typeof t=="string"?Im(t):t,a=bM(s.pathname||"/",r);if(a==null)return null;let i=wM(e);iK(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=yK(a);o=mK(i[c],u)}return o}function wM(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(ca(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Bh([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(ca(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),wM(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:hK(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of _M(a.path))s(a,i,c)}),t}function _M(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=_M(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function iK(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:gK(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const oK=/^:[\w-]+$/,lK=3,cK=2,uK=1,dK=10,fK=-2,Kj=e=>e==="*";function hK(e,t){let r=e.split("/"),n=r.length;return r.some(Kj)&&(n+=fK),t&&(n+=cK),r.filter(s=>!Kj(s)).reduce((s,a)=>s+(oK.test(a)?lK:a===""?uK:dK),n)}function gK(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function mK(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=pK({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),g=c.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:Bh([a,f.pathname]),pathnameBase:bK(Bh([a,f.pathnameBase])),route:g}),f.pathnameBase!=="/"&&(a=Bh([a,f.pathnameBase]))}return i}function pK(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=xK(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:g,isOptional:p}=d;if(g==="*"){let v=o[f]||"";i=a.slice(0,a.length-v.length).replace(/(.)\/+$/,"$1")}const x=o[f];return p&&!x?u[g]=void 0:u[g]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function xK(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),yM(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function yK(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return yM(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function bM(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function vK(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?Im(e):e;return{pathname:r?r.startsWith("/")?r:wK(r,t):t,search:SK(n),hash:kK(s)}}function wK(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function SS(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function _K(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function SM(e,t){let r=_K(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function kM(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=Im(e):(s=Dy({},e),ca(!s.pathname||!s.pathname.includes("?"),SS("?","pathname","search",s)),ca(!s.pathname||!s.pathname.includes("#"),SS("#","pathname","hash",s)),ca(!s.search||!s.search.includes("#"),SS("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),f-=1;s.pathname=g.join("/")}o=f>=0?t[f]:"/"}let c=vK(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Bh=e=>e.join("/").replace(/\/\/+/g,"/"),bK=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),SK=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,kK=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function CK(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const CM=["post","put","patch","delete"];new Set(CM);const TK=["get",...CM];new Set(TK);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Iy(){return Iy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iy.apply(this,arguments)}const hN=S.createContext(null),EK=S.createContext(null),Sv=S.createContext(null),jb=S.createContext(null),Pf=S.createContext({outlet:null,matches:[],isDataRoute:!1}),TM=S.createContext(null);function kv(){return S.useContext(jb)!=null}function Pb(){return kv()||ca(!1),S.useContext(jb).location}function EM(e){S.useContext(Sv).static||S.useLayoutEffect(e)}function Eo(){let{isDataRoute:e}=S.useContext(Pf);return e?$K():NK()}function NK(){kv()||ca(!1);let e=S.useContext(hN),{basename:t,future:r,navigator:n}=S.useContext(Sv),{matches:s}=S.useContext(Pf),{pathname:a}=Pb(),i=JSON.stringify(SM(s,r.v7_relativeSplatPath)),o=S.useRef(!1);return EM(()=>{o.current=!0}),S.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=kM(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Bh([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,i,a,e])}function Fb(){let{matches:e}=S.useContext(Pf),t=e[e.length-1];return t?t.params:{}}function AK(e,t){return jK(e,t)}function jK(e,t,r,n){kv()||ca(!1);let{navigator:s}=S.useContext(Sv),{matches:a}=S.useContext(Pf),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=Pb(),d;if(t){var f;let w=typeof t=="string"?Im(t):t;c==="/"||(f=w.pathname)!=null&&f.startsWith(c)||ca(!1),d=w}else d=u;let g=d.pathname||"/",p=g;if(c!=="/"){let w=c.replace(/^\//,"").split("/");p="/"+g.replace(/^\//,"").split("/").slice(w.length).join("/")}let x=sK(e,{pathname:p}),v=IK(x&&x.map(w=>Object.assign({},w,{params:Object.assign({},o,w.params),pathname:Bh([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Bh([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,r,n);return t&&v?S.createElement(jb.Provider,{value:{location:Iy({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:uf.Pop}},v):v}function PK(){let e=BK(),t=CK(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return S.createElement(S.Fragment,null,S.createElement("h2",null,"Unexpected Application Error!"),S.createElement("h3",{style:{fontStyle:"italic"}},t),r?S.createElement("pre",{style:s},r):null,null)}const FK=S.createElement(PK,null);class OK extends S.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?S.createElement(Pf.Provider,{value:this.props.routeContext},S.createElement(TM.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function DK(e){let{routeContext:t,match:r,children:n}=e,s=S.useContext(hN);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),S.createElement(Pf.Provider,{value:t},n)}function IK(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);d>=0||ca(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:g,errors:p}=r,x=f.route.loader&&g[f.route.id]===void 0&&(!p||p[f.route.id]===void 0);if(f.route.lazy||x){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,g)=>{let p,x=!1,v=null,w=null;r&&(p=o&&f.route.id?o[f.route.id]:void 0,v=f.route.errorElement||FK,c&&(u<0&&g===0?(UK("route-fallback"),x=!0,w=null):u===g&&(x=!0,w=f.route.hydrateFallbackElement||null)));let C=t.concat(i.slice(0,g+1)),k=()=>{let _;return p?_=v:x?_=w:f.route.Component?_=S.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=d,S.createElement(DK,{match:f,routeContext:{outlet:d,matches:C,isDataRoute:r!=null},children:_})};return r&&(f.route.ErrorBoundary||f.route.errorElement||g===0)?S.createElement(OK,{location:r.location,revalidation:r.revalidation,component:v,error:p,children:k(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):k()},null)}var NM=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(NM||{}),AM=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(AM||{});function RK(e){let t=S.useContext(hN);return t||ca(!1),t}function MK(e){let t=S.useContext(EK);return t||ca(!1),t}function LK(e){let t=S.useContext(Pf);return t||ca(!1),t}function jM(e){let t=LK(),r=t.matches[t.matches.length-1];return r.route.id||ca(!1),r.route.id}function BK(){var e;let t=S.useContext(TM),r=MK(),n=jM();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function $K(){let{router:e}=RK(NM.UseNavigateStable),t=jM(AM.UseNavigateStable),r=S.useRef(!1);return EM(()=>{r.current=!0}),S.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Iy({fromRouteId:t},a)))},[e,t])}const qj={};function UK(e,t,r){qj[e]||(qj[e]=!0)}function zK(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function pm(e){let{to:t,replace:r,state:n,relative:s}=e;kv()||ca(!1);let{future:a,static:i}=S.useContext(Sv),{matches:o}=S.useContext(Pf),{pathname:c}=Pb(),u=Eo(),d=kM(t,SM(o,a.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return S.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function Os(e){ca(!1)}function WK(e){let{basename:t="/",children:r=null,location:n,navigationType:s=uf.Pop,navigator:a,static:i=!1,future:o}=e;kv()&&ca(!1);let c=t.replace(/^\/*/,"/"),u=S.useMemo(()=>({basename:c,navigator:a,static:i,future:Iy({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=Im(n));let{pathname:d="/",search:f="",hash:g="",state:p=null,key:x="default"}=n,v=S.useMemo(()=>{let w=bM(d,c);return w==null?null:{location:{pathname:w,search:f,hash:g,state:p,key:x},navigationType:s}},[c,d,f,g,p,x,s]);return v==null?null:S.createElement(Sv.Provider,{value:u},S.createElement(jb.Provider,{children:r,value:v}))}function gN(e){let{children:t,location:r}=e;return AK(lT(t),r)}new Promise(()=>{});function lT(e,t){t===void 0&&(t=[]);let r=[];return S.Children.forEach(e,(n,s)=>{if(!S.isValidElement(n))return;let a=[...t,s];if(n.type===S.Fragment){r.push.apply(r,lT(n.props.children,a));return}n.type!==Os&&ca(!1),!n.props.index||!n.props.children||ca(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=lT(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const HK="6";try{window.__reactRouterVersion=HK}catch{}const GK="startTransition",Yj=pM[GK];function VK(e){let{basename:t,children:r,future:n,window:s}=e,a=S.useRef();a.current==null&&(a.current=tK({window:s,v5Compat:!0}));let i=a.current,[o,c]=S.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=S.useCallback(f=>{u&&Yj?Yj(()=>c(f)):c(f)},[c,u]);return S.useLayoutEffect(()=>i.listen(d),[i,d]),S.useEffect(()=>zK(n),[n]),S.createElement(WK,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var Xj;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Xj||(Xj={}));var Jj;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Jj||(Jj={}));const Is={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3,speaking_test_data:3600*1e3},Rs=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log(" Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log(" Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log(" Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},vs=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),PM();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},PM=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:c}=JSON.parse(o);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},mN=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},Rm=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;if(localStorage.removeItem(n),localStorage.removeItem(s),t==="speaking_test_data"){const a=`speaking_test_data_${e}_${r}`;localStorage.removeItem(a),console.log(`Cleared speaking test data cache for ${r}`)}console.log(`Cleared test data for ${t}_${r}`)},Vg=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Is,cleanupOldData:PM,clearTestData:Rm,clearUserData:mN,getCachedData:Rs,setCachedData:vs},Symbol.toStringTag,{value:"Module"})),FM=S.createContext(),OM=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState(null),[a,i]=S.useState(localStorage.getItem("token")),[o,c]=S.useState(!1),[u,d]=S.useState(!0),[f,g]=S.useState(null);S.useEffect(()=>{console.log("[AUTH] Initializing application session..."),w()},[]),S.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let W=!1;const R=setInterval(async()=>{if(o&&a&&!W){W=!0;try{const z=a||localStorage.getItem("auth_token");if(z&&p(z))console.log("[AUTH] Token expired, attempting refresh..."),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(z)try{const J=JSON.parse(atob(z.split(".")[1])).exp*1e3,se=Date.now(),X=J-se;X<300*1e3&&X>0&&(console.log(`[AUTH] Token expires in ${Math.round(X/1e3)} seconds, refreshing...`),await x()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(K){console.error("[AUTH] Error parsing token for expiration check:",K)}}catch(z){console.error("[AUTH] Error in proactive refresh:",z)}finally{W=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(R)}}},[o,a]);const p=W=>{if(!W)return!0;try{if(typeof W!="string"||!W.includes("."))return console.warn("[AUTH] Invalid token format - not a JWT"),!0;const R=W.split(".");if(R.length!==3)return console.warn("[AUTH] Invalid token format - not 3 parts"),!0;const z=JSON.parse(atob(R[1])),K=Date.now()/1e3;return z.exp<=K}catch(R){if(console.error("[AUTH] Error decoding token:",R),console.warn("[AUTH] Token appears to be corrupted - clearing authentication"),localStorage.removeItem("auth_token"),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("userData"),window.tokenManager)try{window.tokenManager.clearTokens()}catch(z){console.warn("[AUTH] Error clearing token manager:",z)}return!0}},x=async()=>{const W=localStorage.getItem("refresh_token");if(!W)return console.log("[AUTH] No refresh token found"),!1;try{const R=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:W})});if(R.ok){const z=await R.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",z.accessToken),localStorage.setItem("refresh_token",z.refreshToken),localStorage.setItem("accessToken",z.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(z.accessToken),z.refreshToken&&window.tokenManager.setRefreshToken(z.refreshToken))}catch{}return i(z.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",R.status),!1}catch(R){return console.error("[AUTH] Token refresh error:",R),!1}},v=async(W,R={})=>{const z=a||localStorage.getItem("auth_token");if(!z)throw new Error("No authentication token found");const K={"Content-Type":"application/json",Authorization:`Bearer ${z}`,...R.headers},J=await fetch(W,{...R,headers:K});if(J.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await x()){const X=localStorage.getItem("auth_token");return K.Authorization=`Bearer ${X}`,fetch(W,{...R,headers:K})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return J},w=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const W=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),R=localStorage.getItem("user_data")||localStorage.getItem("userData"),z=R?JSON.parse(R).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!W,hasUser:!!R,role:z}),W&&z&&R)try{const K=JSON.parse(R);if(p(W))if(console.log("[AUTH] Token expired, attempting refresh..."),await x()){console.log("[AUTH] Token refreshed successfully");const se=localStorage.getItem("auth_token");i(se)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(W);else i(W);s(z),r(K);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const J=localStorage.getItem("refresh_token");J&&window.tokenManager.setRefreshToken(J)}}catch{}c(!0),await _(K,z)}catch(K){console.error("[AUTH] Error parsing stored user data:",K),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(W){console.error("[AUTH] Session initialization error:",W),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},C=async W=>{try{if(d(!0),g(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),g("Please wait for the logout process to complete.");return}console.log("Attempting login with:",W.username);let R,z;W.username==="admin"?(R={ok:!0,json:()=>({success:!0,token:"test-token"})},z="admin"):(R=await authService.teacherLogin(W),z="teacher");const K=await R.json();await k(R,z,K)}catch(R){A(R)}finally{d(!1)}},k=async(W,R,z)=>{try{if(W.ok&&z.success&&z.token){i(z.token),s(R),r(z),c(!0),localStorage.setItem("auth_token",z.accessToken||z.token),localStorage.setItem("refresh_token",z.refreshToken),localStorage.setItem("user_data",JSON.stringify(z)),localStorage.setItem("accessToken",z.accessToken||z.token);try{const K=Date.now(),J=10080*60*1e3,se=[];for(let X=0;X<localStorage.length;X++){const ie=localStorage.key(X);if(!(!ie||!(ie.startsWith("test_progress_")||ie.startsWith("test_timer_")||ie.startsWith("test_shuffle_order_")||ie.startsWith("student_results_table_")||ie.startsWith("anti_cheating_"))))try{const ce=localStorage.getItem(ie);if(!ce){se.push(ie);continue}let be=null;if(ce.startsWith("{")||ce.startsWith("[")){const re=JSON.parse(ce),pe=re.timestamp||re.lastSaved||re.lastTickAt||re.createdAt||re.updatedAt||re.startedAt||re.started_at;pe&&(be=new Date(pe).getTime())}if(!be){const re=`${ie}__ts`,pe=localStorage.getItem(re);pe&&(be=parseInt(pe)||null)}if(!be)continue;K-be>J&&se.push(ie)}catch{}}se.forEach(X=>{try{localStorage.removeItem(X)}catch{}})}catch(K){console.warn("LocalStorage cleanup skipped:",K)}return await _(z,R),!0}else{const K=z.message||W.statusText||"Login failed";return A(new Error(K)),!1}}catch(K){return A(K),!1}},_=async(W,R)=>{try{switch(R){case"admin":console.log("Admin login successful, role:",W.role),console.log("Admin logged in:",W);break;case"teacher":console.log("Teacher login successful, role:",W.role),console.log("Teacher data:",W.teacher),await E(W),await F();break;case"student":console.log("Student login successful"),N(W);break;default:console.warn("Unknown user role:",R)}}catch(z){console.error("Post-login actions error:",z)}},N=W=>{r(W),console.log("Student info populated:",W)},E=async W=>{r(W),console.log("Teacher info populated:",W)},P=async()=>{try{console.log("Initializing teacher cabinet...")}catch(W){console.error("Error initializing teacher cabinet:",W)}},F=async()=>{try{console.log("Checking teacher subjects...")}catch(W){console.error("Error checking teacher subjects:",W)}},A=W=>{g(W.message||"Login failed"),j()},j=()=>{g(null),d(!1)},I=S.useCallback(()=>{L()},[]),L=()=>{r(null),s(null),i(null),c(!1),g(null);const W=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;W&&mN(W),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{Y()},100)},Y=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},Z=()=>t?.id||null,ae=()=>n==="admin"?t:null,ee=()=>n==="admin",ne=()=>ee()?t?.admin_id:null,B=()=>n==="teacher"?t?.username:null,V=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof C,logout:typeof I,getCurrentTeacherId:typeof Z,isAdmin:typeof ee,getCurrentAdmin:typeof ae,getCurrentAdminId:typeof ne,getCurrentTeacherUsername:typeof B})};S.useEffect(()=>(window.logout=I,window.getCurrentTeacherId=Z,window.getCurrentAdmin=ae,window.isAdmin=ee,window.getCurrentAdminId=ne,window.getCurrentTeacherUsername=B,window.checkFunctionAvailability=V,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[I]);const M=S.useCallback(W=>{console.log("Setting user data from external auth:",W),r(W),s(W.role),i(W.token),c(!0),d(!1),g(null),localStorage.setItem("auth_token",W.token),localStorage.setItem("user_data",JSON.stringify(W)),localStorage.setItem("accessToken",W.token)},[]),H={user:t,role:n,token:a,isAuthenticated:o,isLoading:u,error:f,login:C,setUserData:M,logout:I,resetLoginForm:j,forceCompleteLogout:L,initializeApplicationSession:w,makeAuthenticatedRequest:v,populateStudentInfo:N,populateTeacherInfo:E,initializeTeacherCabinet:P,checkTeacherSubjects:F,getCurrentTeacherId:Z,getCurrentAdmin:ae,isAdmin:ee,getCurrentAdminId:ne,getCurrentTeacherUsername:B,handleLoginResponse:k,handlePostLoginActions:_,handleLoginFailure:A,resetInterfaceAfterSessionClear:Y,checkFunctionAvailability:V};return l.jsx(FM.Provider,{value:H,children:e})},cs=()=>{const e=S.useContext(FM);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class KK{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,c=setTimeout(()=>o.abort(),this.timeout),u=await fetch(n,{...s,signal:o.signal});if(clearTimeout(c),!u.ok)throw new Error(`HTTP error! status: ${u.status}`);return await u.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(c=>setTimeout(c,this.retryDelay*Math.pow(2,i))))}throw a}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),c=window.URL.createObjectURL(o),u=document.createElement("a");u.href=c,u.download=r,document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(c)}catch(i){throw i}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const Ns=new KK,pN=S.createContext({});function xN(e){const t=S.useRef(null);return t.current===null&&(t.current=e()),t.current}const yN=typeof window<"u",DM=yN?S.useLayoutEffect:S.useEffect,Ob=S.createContext(null);function vN(e,t){e.indexOf(t)===-1&&e.push(t)}function wN(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Qu=(e,t,r)=>r>t?t:r<e?e:r;let _N=()=>{};const Zu={},IM=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function RM(e){return typeof e=="object"&&e!==null}const MM=e=>/^0[^.\s]+$/u.test(e);function bN(e){let t;return()=>(t===void 0&&(t=e()),t)}const Cl=e=>e,qK=(e,t)=>r=>t(e(r)),Cv=(...e)=>e.reduce(qK),Ry=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class SN{constructor(){this.subscriptions=[]}add(t){return vN(this.subscriptions,t),()=>wN(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Vc=e=>e*1e3,Kc=e=>e/1e3;function LM(e,t){return t?e*(1e3/t):0}const BM=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,YK=1e-7,XK=12;function JK(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=BM(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>YK&&++o<XK);return i}function Tv(e,t,r,n){if(e===t&&r===n)return Cl;const s=a=>JK(a,0,1,e,r);return a=>a===0||a===1?a:BM(s(a),t,n)}const $M=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,UM=e=>t=>1-e(1-t),zM=Tv(.33,1.53,.69,.99),kN=UM(zM),WM=$M(kN),HM=e=>(e*=2)<1?.5*kN(e):.5*(2-Math.pow(2,-10*(e-1))),CN=e=>1-Math.sin(Math.acos(e)),GM=UM(CN),VM=$M(CN),QK=Tv(.42,0,1,1),ZK=Tv(0,0,.58,1),KM=Tv(.42,0,.58,1),eq=e=>Array.isArray(e)&&typeof e[0]!="number",qM=e=>Array.isArray(e)&&typeof e[0]=="number",tq={linear:Cl,easeIn:QK,easeInOut:KM,easeOut:ZK,circIn:CN,circInOut:VM,circOut:GM,backIn:kN,backInOut:WM,backOut:zM,anticipate:HM},rq=e=>typeof e=="string",Qj=e=>{if(qM(e)){_N(e.length===4);const[t,r,n,s]=e;return Tv(t,r,n,s)}else if(rq(e))return tq[e];return e},lw=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function nq(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(o)}const u={schedule:(d,f=!1,g=!1)=>{const x=g&&s?r:n;return f&&i.add(d),x.has(d)||x.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const sq=40;function YM(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=lw.reduce((_,N)=>(_[N]=nq(a),_),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:g,render:p,postRender:x}=i,v=()=>{const _=Zu.useManualTiming?s.timestamp:performance.now();r=!1,Zu.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(_-s.timestamp,sq),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),c.process(s),u.process(s),d.process(s),f.process(s),g.process(s),p.process(s),x.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(v))},w=()=>{r=!0,n=!0,s.isProcessing||e(v)};return{schedule:lw.reduce((_,N)=>{const E=i[N];return _[N]=(P,F=!1,A=!1)=>(r||w(),E.schedule(P,F,A)),_},{}),cancel:_=>{for(let N=0;N<lw.length;N++)i[lw[N]].cancel(_)},state:s,steps:i}}const{schedule:gs,cancel:bf,state:si,steps:kS}=YM(typeof requestAnimationFrame<"u"?requestAnimationFrame:Cl,!0);let Xw;function aq(){Xw=void 0}const _o={now:()=>(Xw===void 0&&_o.set(si.isProcessing||Zu.useManualTiming?si.timestamp:performance.now()),Xw),set:e=>{Xw=e,queueMicrotask(aq)}},XM=e=>t=>typeof t=="string"&&t.startsWith(e),TN=XM("--"),iq=XM("var(--"),EN=e=>iq(e)?oq.test(e.split("/*")[0].trim()):!1,oq=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Mm={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},My={...Mm,transform:e=>Qu(0,1,e)},cw={...Mm,default:1},gy=e=>Math.round(e*1e5)/1e5,NN=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function lq(e){return e==null}const cq=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,AN=(e,t)=>r=>!!(typeof r=="string"&&cq.test(r)&&r.startsWith(e)||t&&!lq(r)&&Object.prototype.hasOwnProperty.call(r,t)),JM=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(NN);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},uq=e=>Qu(0,255,e),CS={...Mm,transform:e=>Math.round(uq(e))},Ph={test:AN("rgb","red"),parse:JM("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+CS.transform(e)+", "+CS.transform(t)+", "+CS.transform(r)+", "+gy(My.transform(n))+")"};function dq(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const cT={test:AN("#"),parse:dq,transform:Ph.transform},Ev=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),sf=Ev("deg"),qc=Ev("%"),Mr=Ev("px"),fq=Ev("vh"),hq=Ev("vw"),Zj={...qc,parse:e=>qc.parse(e)/100,transform:e=>qc.transform(e*100)},Kg={test:AN("hsl","hue"),parse:JM("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+qc.transform(gy(t))+", "+qc.transform(gy(r))+", "+gy(My.transform(n))+")"},ia={test:e=>Ph.test(e)||cT.test(e)||Kg.test(e),parse:e=>Ph.test(e)?Ph.parse(e):Kg.test(e)?Kg.parse(e):cT.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Ph.transform(e):Kg.transform(e),getAnimatableNone:e=>{const t=ia.parse(e);return t.alpha=0,ia.transform(t)}},gq=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function mq(e){return isNaN(e)&&typeof e=="string"&&(e.match(NN)?.length||0)+(e.match(gq)?.length||0)>0}const QM="number",ZM="color",pq="var",xq="var(",e5="${}",yq=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Ly(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(yq,c=>(ia.test(c)?(n.color.push(a),s.push(ZM),r.push(ia.parse(c))):c.startsWith(xq)?(n.var.push(a),s.push(pq),r.push(c)):(n.number.push(a),s.push(QM),r.push(parseFloat(c))),++a,e5)).split(e5);return{values:r,split:o,indexes:n,types:s}}function e7(e){return Ly(e).values}function t7(e){const{split:t,types:r}=Ly(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===QM?a+=gy(s[i]):o===ZM?a+=ia.transform(s[i]):a+=s[i]}return a}}const vq=e=>typeof e=="number"?0:ia.test(e)?ia.getAnimatableNone(e):e;function wq(e){const t=e7(e);return t7(e)(t.map(vq))}const Sf={test:mq,parse:e7,createTransformer:t7,getAnimatableNone:wq};function TS(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function _q({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=TS(c,o,e+1/3),a=TS(c,o,e),i=TS(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function u_(e,t){return r=>r>0?t:e}const ws=(e,t,r)=>e+(t-e)*r,ES=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},bq=[cT,Ph,Kg],Sq=e=>bq.find(t=>t.test(e));function t5(e){const t=Sq(e);if(!t)return!1;let r=t.parse(e);return t===Kg&&(r=_q(r)),r}const r5=(e,t)=>{const r=t5(e),n=t5(t);if(!r||!n)return u_(e,t);const s={...r};return a=>(s.red=ES(r.red,n.red,a),s.green=ES(r.green,n.green,a),s.blue=ES(r.blue,n.blue,a),s.alpha=ws(r.alpha,n.alpha,a),Ph.transform(s))},uT=new Set(["none","hidden"]);function kq(e,t){return uT.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function Cq(e,t){return r=>ws(e,t,r)}function jN(e){return typeof e=="number"?Cq:typeof e=="string"?EN(e)?u_:ia.test(e)?r5:Nq:Array.isArray(e)?r7:typeof e=="object"?ia.test(e)?r5:Tq:u_}function r7(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>jN(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function Tq(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=jN(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function Eq(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const Nq=(e,t)=>{const r=Sf.createTransformer(t),n=Ly(e),s=Ly(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?uT.has(e)&&!s.values.length||uT.has(t)&&!n.values.length?kq(e,t):Cv(r7(Eq(n,s),s.values),r):u_(e,t)};function n7(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?ws(e,t,r):jN(e)(e,t)}const Aq=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>gs.update(t,r),stop:()=>bf(t),now:()=>si.isProcessing?si.timestamp:_o.now()}},s7=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},d_=2e4;function PN(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<d_;)t+=r,n=e.next(t);return t>=d_?1/0:t}function jq(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(PN(n),d_);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:Kc(s)}}const Pq=5;function a7(e,t,r){const n=Math.max(t-Pq,0);return LM(r-e(n),t-n)}const js={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},NS=.001;function Fq({duration:e=js.duration,bounce:t=js.bounce,velocity:r=js.velocity,mass:n=js.mass}){let s,a,i=1-t;i=Qu(js.minDamping,js.maxDamping,i),e=Qu(js.minDuration,js.maxDuration,Kc(e)),i<1?(s=u=>{const d=u*i,f=d*e,g=d-r,p=dT(u,i),x=Math.exp(-f);return NS-g/p*x},a=u=>{const f=u*i*e,g=f*r+r,p=Math.pow(i,2)*Math.pow(u,2)*e,x=Math.exp(-f),v=dT(Math.pow(u,2),i);return(-s(u)+NS>0?-1:1)*((g-p)*x)/v}):(s=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-NS+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const o=5/e,c=Dq(s,a,o);if(e=Vc(e),isNaN(c))return{stiffness:js.stiffness,damping:js.damping,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:e}}}const Oq=12;function Dq(e,t,r){let n=r;for(let s=1;s<Oq;s++)n=n-e(n)/t(n);return n}function dT(e,t){return e*Math.sqrt(1-t*t)}const Iq=["duration","bounce"],Rq=["stiffness","damping","mass"];function n5(e,t){return t.some(r=>e[r]!==void 0)}function Mq(e){let t={velocity:js.velocity,stiffness:js.stiffness,damping:js.damping,mass:js.mass,isResolvedFromDuration:!1,...e};if(!n5(e,Rq)&&n5(e,Iq))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*Qu(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:js.mass,stiffness:s,damping:a}}else{const r=Fq(e);t={...t,...r,mass:js.mass},t.isResolvedFromDuration=!0}return t}function f_(e=js.visualDuration,t=js.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:g,isResolvedFromDuration:p}=Mq({...r,velocity:-Kc(r.velocity||0)}),x=g||0,v=u/(2*Math.sqrt(c*d)),w=i-a,C=Kc(Math.sqrt(c/d)),k=Math.abs(w)<5;n||(n=k?js.restSpeed.granular:js.restSpeed.default),s||(s=k?js.restDelta.granular:js.restDelta.default);let _;if(v<1){const E=dT(C,v);_=P=>{const F=Math.exp(-v*C*P);return i-F*((x+v*C*w)/E*Math.sin(E*P)+w*Math.cos(E*P))}}else if(v===1)_=E=>i-Math.exp(-C*E)*(w+(x+C*w)*E);else{const E=C*Math.sqrt(v*v-1);_=P=>{const F=Math.exp(-v*C*P),A=Math.min(E*P,300);return i-F*((x+v*C*w)*Math.sinh(A)+E*w*Math.cosh(A))/E}}const N={calculatedDuration:p&&f||null,next:E=>{const P=_(E);if(p)o.done=E>=f;else{let F=E===0?x:0;v<1&&(F=E===0?Vc(x):a7(_,E,P));const A=Math.abs(F)<=n,j=Math.abs(i-P)<=s;o.done=A&&j}return o.value=o.done?i:P,o},toString:()=>{const E=Math.min(PN(N),d_),P=s7(F=>N.next(E*F).value,E,30);return E+"ms "+P},toTransition:()=>{}};return N}f_.applyToOptions=e=>{const t=jq(e,100,f_);return e.ease=t.ease,e.duration=Vc(t.duration),e.type="keyframes",e};function fT({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],g={done:!1,value:f},p=A=>o!==void 0&&A<o||c!==void 0&&A>c,x=A=>o===void 0?c:c===void 0||Math.abs(o-A)<Math.abs(c-A)?o:c;let v=r*t;const w=f+v,C=i===void 0?w:i(w);C!==w&&(v=C-f);const k=A=>-v*Math.exp(-A/n),_=A=>C+k(A),N=A=>{const j=k(A),I=_(A);g.done=Math.abs(j)<=u,g.value=g.done?C:I};let E,P;const F=A=>{p(g.value)&&(E=A,P=f_({keyframes:[g.value,x(g.value)],velocity:a7(_,A,g.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return F(0),{calculatedDuration:null,next:A=>{let j=!1;return!P&&E===void 0&&(j=!0,N(A),F(A)),E!==void 0&&A>=E?P.next(A-E):(!j&&N(A),g)}}}function Lq(e,t,r){const n=[],s=r||Zu.mix||n7,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Cl:t;o=Cv(c,o)}n.push(o)}return n}function Bq(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(_N(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Lq(t,n,s),c=o.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const g=Ry(e[f],e[f+1],d);return o[f](g)};return r?d=>u(Qu(e[0],e[a-1],d)):u}function $q(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Ry(0,t,n);e.push(ws(r,1,s))}}function Uq(e){const t=[0];return $q(t,e.length-1),t}function zq(e,t){return e.map(r=>r*t)}function Wq(e,t){return e.map(()=>t||KM).splice(0,e.length-1)}function my({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=eq(n)?n.map(Qj):Qj(n),a={done:!1,value:t[0]},i=zq(r&&r.length===t.length?r:Uq(t),e),o=Bq(i,t,{ease:Array.isArray(s)?s:Wq(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const Hq=e=>e!==null;function FN(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(Hq),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const Gq={decay:fT,inertia:fT,tween:my,keyframes:my,spring:f_};function i7(e){typeof e.type=="string"&&(e.type=Gq[e.type])}class ON{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const Vq=e=>e/100;class DN extends ON{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==_o.now()&&this.tick(_o.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;i7(t);const{type:r=my,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||my;c!==my&&typeof o[0]!="number"&&(this.mixKeyframes=Cv(Vq,n7(o[0],o[1])),o=[0,100]);const u=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=PN(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:g,repeatDelay:p,type:x,onUpdate:v,finalKeyframe:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,N=n;if(f){const A=Math.min(this.currentTime,s)/o;let j=Math.floor(A),I=A%1;!I&&A>=1&&(I=1),I===1&&j--,j=Math.min(j,f+1),!!(j%2)&&(g==="reverse"?(I=1-I,p&&(I-=p/o)):g==="mirror"&&(N=i)),_=Qu(0,1,I)*o}const E=k?{done:!1,value:d[0]}:N.next(_);a&&(E.value=a(E.value));let{done:P}=E;!k&&c!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return F&&x!==fT&&(E.value=FN(d,this.options,w,this.speed)),v&&v(E.value),F&&this.finish(),E}then(t,r){return this.finished.then(t,r)}get duration(){return Kc(this.calculatedDuration)}get time(){return Kc(this.currentTime)}set time(t){t=Vc(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(_o.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=Kc(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Aq,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(_o.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function Kq(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Fh=e=>e*180/Math.PI,hT=e=>{const t=Fh(Math.atan2(e[1],e[0]));return gT(t)},qq={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:hT,rotateZ:hT,skewX:e=>Fh(Math.atan(e[1])),skewY:e=>Fh(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},gT=e=>(e=e%360,e<0&&(e+=360),e),s5=hT,a5=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),i5=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Yq={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:a5,scaleY:i5,scale:e=>(a5(e)+i5(e))/2,rotateX:e=>gT(Fh(Math.atan2(e[6],e[5]))),rotateY:e=>gT(Fh(Math.atan2(-e[2],e[0]))),rotateZ:s5,rotate:s5,skewX:e=>Fh(Math.atan(e[4])),skewY:e=>Fh(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function mT(e){return e.includes("scale")?1:0}function pT(e,t){if(!e||e==="none")return mT(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Yq,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=qq,s=o}if(!s)return mT(t);const a=n[t],i=s[1].split(",").map(Jq);return typeof a=="function"?a(i):i[a]}const Xq=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return pT(r,t)};function Jq(e){return parseFloat(e.trim())}const Lm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Bm=new Set(Lm),o5=e=>e===Mm||e===Mr,Qq=new Set(["x","y","z"]),Zq=Lm.filter(e=>!Qq.has(e));function eY(e){const t=[];return Zq.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const $h={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>pT(t,"x"),y:(e,{transform:t})=>pT(t,"y")};$h.translateX=$h.x;$h.translateY=$h.y;const Uh=new Set;let xT=!1,yT=!1,vT=!1;function o7(){if(yT){const e=Array.from(Uh).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=eY(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}yT=!1,xT=!1,Uh.forEach(e=>e.complete(vT)),Uh.clear()}function l7(){Uh.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(yT=!0)})}function tY(){vT=!0,l7(),o7(),vT=!1}class IN{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Uh.add(this),xT||(xT=!0,gs.read(l7),gs.resolveKeyframes(o7))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}Kq(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Uh.delete(this)}cancel(){this.state==="scheduled"&&(Uh.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const rY=e=>e.startsWith("--");function nY(e,t,r){rY(t)?e.style.setProperty(t,r):e.style[t]=r}const sY=bN(()=>window.ScrollTimeline!==void 0),aY={};function iY(e,t){const r=bN(e);return()=>aY[t]??r()}const c7=iY(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ay=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,l5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ay([0,.65,.55,1]),circOut:ay([.55,0,1,.45]),backIn:ay([.31,.01,.66,-.59]),backOut:ay([.33,1.53,.69,.99])};function u7(e,t){if(e)return typeof e=="function"?c7()?s7(e,t):"ease-out":qM(e)?ay(e):Array.isArray(e)?e.map(r=>u7(r,t)||l5.easeOut):l5[e]}function oY(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=u7(o,s);Array.isArray(f)&&(d.easing=f);const g={delay:n,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(g.pseudoElement=u),e.animate(d,g)}function d7(e){return typeof e=="function"&&"applyToOptions"in e}function lY({type:e,...t}){return d7(e)&&c7()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class cY extends ON{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,_N(typeof t.type!="string");const u=lY(t);this.animation=oY(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=FN(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):nY(r,n,d),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return Kc(Number(t))}get time(){return Kc(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Vc(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&sY()?(this.animation.timeline=t,Cl):r(this)}}const f7={anticipate:HM,backInOut:WM,circInOut:VM};function uY(e){return e in f7}function dY(e){typeof e.ease=="string"&&uY(e.ease)&&(e.ease=f7[e.ease])}const c5=10;class fY extends cY{constructor(t){dY(t),i7(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new DN({...i,autoplay:!1}),c=Vc(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-c5).value,o.sample(c).value,c5),o.stop()}}const u5=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Sf.test(e)||e==="0")&&!e.startsWith("url("));function hY(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function gY(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=u5(s,t),o=u5(a,t);return!i||!o?!1:hY(e)||(r==="spring"||d7(r))&&n}function wT(e){e.duration=0,e.type}const mY=new Set(["opacity","clipPath","filter","transform"]),pY=bN(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function xY(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return pY()&&r&&mY.has(r)&&(r!=="transform"||!u)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const yY=40;class vY extends ON{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=_o.now();const g={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},p=d?.KeyframeResolver||IN;this.keyframeResolver=new p(o,(x,v,w)=>this.onKeyframesResolved(x,v,g,!w),c,u,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:u,onUpdate:d}=n;this.resolvedAt=_o.now(),gY(t,a,i,o)||((Zu.instantAnimations||!c)&&d?.(FN(t,n,r)),t[0]=t[t.length-1],wT(n),n.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>yY?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},p=!u&&xY(g)?new fY({...g,element:g.motionValue.owner.current}):new DN(g);p.finished.then(()=>this.notifyFinished()).catch(Cl),this.pendingTimeline&&(this.stopTimeline=p.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=p}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),tY()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const wY=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function _Y(e){const t=wY.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function h7(e,t,r=1){const[n,s]=_Y(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return IM(i)?parseFloat(i):i}return EN(s)?h7(s,t,r+1):s}function RN(e,t){return e?.[t]??e?.default??e}const g7=new Set(["width","height","top","left","right","bottom",...Lm]),bY={test:e=>e==="auto",parse:e=>e},m7=e=>t=>t.test(e),p7=[Mm,Mr,qc,sf,hq,fq,bY],d5=e=>p7.find(m7(e));function SY(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||MM(e):!0}const kY=new Set(["brightness","contrast","saturate","opacity"]);function CY(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(NN)||[];if(!n)return e;const s=r.replace(n,"");let a=kY.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const TY=/\b([a-z-]*)\(.*?\)/gu,_T={...Sf,getAnimatableNone:e=>{const t=e.match(TY);return t?t.map(CY).join(" "):e}},f5={...Mm,transform:Math.round},EY={rotate:sf,rotateX:sf,rotateY:sf,rotateZ:sf,scale:cw,scaleX:cw,scaleY:cw,scaleZ:cw,skew:sf,skewX:sf,skewY:sf,distance:Mr,translateX:Mr,translateY:Mr,translateZ:Mr,x:Mr,y:Mr,z:Mr,perspective:Mr,transformPerspective:Mr,opacity:My,originX:Zj,originY:Zj,originZ:Mr},MN={borderWidth:Mr,borderTopWidth:Mr,borderRightWidth:Mr,borderBottomWidth:Mr,borderLeftWidth:Mr,borderRadius:Mr,radius:Mr,borderTopLeftRadius:Mr,borderTopRightRadius:Mr,borderBottomRightRadius:Mr,borderBottomLeftRadius:Mr,width:Mr,maxWidth:Mr,height:Mr,maxHeight:Mr,top:Mr,right:Mr,bottom:Mr,left:Mr,padding:Mr,paddingTop:Mr,paddingRight:Mr,paddingBottom:Mr,paddingLeft:Mr,margin:Mr,marginTop:Mr,marginRight:Mr,marginBottom:Mr,marginLeft:Mr,backgroundPositionX:Mr,backgroundPositionY:Mr,...EY,zIndex:f5,fillOpacity:My,strokeOpacity:My,numOctaves:f5},NY={...MN,color:ia,backgroundColor:ia,outlineColor:ia,fill:ia,stroke:ia,borderColor:ia,borderTopColor:ia,borderRightColor:ia,borderBottomColor:ia,borderLeftColor:ia,filter:_T,WebkitFilter:_T},x7=e=>NY[e];function y7(e,t){let r=x7(e);return r!==_T&&(r=Sf),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const AY=new Set(["auto","none","0"]);function jY(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!AY.has(a)&&Ly(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=y7(r,s)}class PY extends IN{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),EN(u))){const d=h7(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!g7.has(n)||t.length!==2)return;const[s,a]=t,i=d5(s),o=d5(a);if(i!==o)if(o5(i)&&o5(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else $h[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||SY(t[s]))&&n.push(s);n.length&&jY(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$h[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=$h[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,c])=>{t.getValue(o).set(c)}),this.resolveNoneKeyframes()}}function FY(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const v7=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function w7(e){return RM(e)&&"offsetHeight"in e}const h5=30,OY=e=>!isNaN(parseFloat(e));class DY{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=_o.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=_o.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=OY(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new SN);const n=this.events[t].add(r);return t==="change"?()=>{n(),gs.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=_o.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>h5)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,h5);return LM(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function xm(e,t){return new DY(e,t)}const{schedule:LN}=YM(queueMicrotask,!1),ec={x:!1,y:!1};function _7(){return ec.x||ec.y}function IY(e){return e==="x"||e==="y"?ec[e]?null:(ec[e]=!0,()=>{ec[e]=!1}):ec.x||ec.y?null:(ec.x=ec.y=!0,()=>{ec.x=ec.y=!1})}function b7(e,t){const r=FY(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function g5(e){return!(e.pointerType==="touch"||_7())}function RY(e,t,r={}){const[n,s,a]=b7(e,r),i=o=>{if(!g5(o))return;const{target:c}=o,u=t(c,o);if(typeof u!="function"||!c)return;const d=f=>{g5(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const S7=(e,t)=>t?e===t?!0:S7(e,t.parentElement):!1,BN=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,MY=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function LY(e){return MY.has(e.tagName)||e.tabIndex!==-1}const Jw=new WeakSet;function m5(e){return t=>{t.key==="Enter"&&e(t)}}function AS(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const BY=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=m5(()=>{if(Jw.has(r))return;AS(r,"down");const s=m5(()=>{AS(r,"up")}),a=()=>AS(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function p5(e){return BN(e)&&!_7()}function $Y(e,t,r={}){const[n,s,a]=b7(e,r),i=o=>{const c=o.currentTarget;if(!p5(o))return;Jw.add(c);const u=t(c,o),d=(p,x)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",g),Jw.has(c)&&Jw.delete(c),p5(p)&&typeof u=="function"&&u(p,{success:x})},f=p=>{d(p,c===window||c===document||r.useGlobalTarget||S7(c,p.target))},g=p=>{d(p,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",g,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),w7(o)&&(o.addEventListener("focus",u=>BY(u,s)),!LY(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function k7(e){return RM(e)&&"ownerSVGElement"in e}function UY(e){return k7(e)&&e.tagName==="svg"}const ji=e=>!!(e&&e.getVelocity),zY=[...p7,ia,Sf],WY=e=>zY.find(m7(e)),$N=S.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class HY extends S.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=w7(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function GY({children:e,isPresent:t,anchorX:r,root:n}){const s=S.useId(),a=S.useRef(null),i=S.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=S.useContext($N);return S.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:f,right:g}=i.current;if(t||!a.current||!c||!u)return;const p=r==="left"?`left: ${f}`:`right: ${g}`;a.current.dataset.motionPopId=s;const x=document.createElement("style");o&&(x.nonce=o);const v=n??document.head;return v.appendChild(x),x.sheet&&x.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${p}px !important;
            top: ${d}px !important;
          }
        `),()=>{v.contains(x)&&v.removeChild(x)}},[t]),l.jsx(HY,{isPresent:t,childRef:a,sizeRef:i,children:S.cloneElement(e,{ref:a})})}const VY=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const u=xN(KY),d=S.useId();let f=!0,g=S.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:s,onExitComplete:p=>{u.set(p,!0);for(const x of u.values())if(!x)return;n&&n()},register:p=>(u.set(p,!1),()=>u.delete(p))}),[r,u,n]);return a&&f&&(g={...g}),S.useMemo(()=>{u.forEach((p,x)=>u.set(x,!1))},[r]),S.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(GY,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(Ob.Provider,{value:g,children:e})};function KY(){return new Map}function C7(e=!0){const t=S.useContext(Ob);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=S.useId();S.useEffect(()=>{if(e)return s(a)},[e]);const i=S.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const uw=e=>e.key||"";function x5(e){const t=[];return S.Children.forEach(e,r=>{S.isValidElement(r)&&t.push(r)}),t}const wo=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[u,d]=C7(i),f=S.useMemo(()=>x5(e),[e]),g=i&&!u?[]:f.map(uw),p=S.useRef(!0),x=S.useRef(f),v=xN(()=>new Map),[w,C]=S.useState(f),[k,_]=S.useState(f);DM(()=>{p.current=!1,x.current=f;for(let P=0;P<k.length;P++){const F=uw(k[P]);g.includes(F)?v.delete(F):v.get(F)!==!0&&v.set(F,!1)}},[k,g.length,g.join("-")]);const N=[];if(f!==w){let P=[...f];for(let F=0;F<k.length;F++){const A=k[F],j=uw(A);g.includes(j)||(P.splice(F,0,A),N.push(A))}return a==="wait"&&N.length&&(P=N),_(x5(P)),C(f),null}const{forceRender:E}=S.useContext(pN);return l.jsx(l.Fragment,{children:k.map(P=>{const F=uw(P),A=i&&!u?!1:f===k||g.includes(F),j=()=>{if(v.has(F))v.set(F,!0);else return;let I=!0;v.forEach(L=>{L||(I=!1)}),I&&(E?.(),_(x.current),i&&d?.(),n&&n())};return l.jsx(VY,{isPresent:A,initial:!p.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:A?void 0:j,anchorX:o,children:P},F)})})},T7=S.createContext({strict:!1}),y5={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},ym={};for(const e in y5)ym[e]={isEnabled:t=>y5[e].some(r=>!!t[r])};function qY(e){for(const t in e)ym[t]={...ym[t],...e[t]}}const YY=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function h_(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||YY.has(e)}let E7=e=>!h_(e);function XY(e){typeof e=="function"&&(E7=t=>t.startsWith("on")?!h_(t):e(t))}try{XY(require("@emotion/is-prop-valid").default)}catch{}function JY(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(E7(s)||r===!0&&h_(s)||!t&&!h_(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const Db=S.createContext({});function Ib(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function By(e){return typeof e=="string"||Array.isArray(e)}const UN=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],zN=["initial",...UN];function Rb(e){return Ib(e.animate)||zN.some(t=>By(e[t]))}function N7(e){return!!(Rb(e)||e.variants)}function QY(e,t){if(Rb(e)){const{initial:r,animate:n}=e;return{initial:r===!1||By(r)?r:void 0,animate:By(n)?n:void 0}}return e.inherit!==!1?t:{}}function ZY(e){const{initial:t,animate:r}=QY(e,S.useContext(Db));return S.useMemo(()=>({initial:t,animate:r}),[v5(t),v5(r)])}function v5(e){return Array.isArray(e)?e.join(" "):e}const $y={};function eX(e){for(const t in e)$y[t]=e[t],TN(t)&&($y[t].isCSSVariable=!0)}function A7(e,{layout:t,layoutId:r}){return Bm.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!$y[e]||e==="opacity")}const tX={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},rX=Lm.length;function nX(e,t,r){let n="",s=!0;for(let a=0;a<rX;a++){const i=Lm[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const u=v7(o,MN[i]);if(!c){s=!1;const d=tX[i]||i;n+=`${d}(${u}) `}r&&(t[i]=u)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function WN(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const u=t[c];if(Bm.has(c)){i=!0;continue}else if(TN(c)){s[c]=u;continue}else{const d=v7(u,MN[c]);c.startsWith("origin")?(o=!0,a[c]=d):n[c]=d}}if(t.transform||(i||r?n.transform=nX(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${c} ${u} ${d}`}}const HN=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function j7(e,t,r){for(const n in t)!ji(t[n])&&!A7(n,r)&&(e[n]=t[n])}function sX({transformTemplate:e},t){return S.useMemo(()=>{const r=HN();return WN(r,t,e),Object.assign({},r.vars,r.style)},[t])}function aX(e,t){const r=e.style||{},n={};return j7(n,r,e),Object.assign(n,sX(e,t)),n}function iX(e,t){const r={},n=aX(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const oX={offset:"stroke-dashoffset",array:"stroke-dasharray"},lX={offset:"strokeDashoffset",array:"strokeDasharray"};function cX(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?oX:lX;e[a.offset]=Mr.transform(-n);const i=Mr.transform(t),o=Mr.transform(r);e[a.array]=`${i} ${o}`}function P7(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},c,u,d){if(WN(e,o,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:g}=e;f.transform&&(g.transform=f.transform,delete f.transform),(g.transform||f.transformOrigin)&&(g.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),g.transform&&(g.transformBox=d?.transformBox??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),n!==void 0&&(f.scale=n),s!==void 0&&cX(f,s,a,i,!1)}const F7=()=>({...HN(),attrs:{}}),O7=e=>typeof e=="string"&&e.toLowerCase()==="svg";function uX(e,t,r,n){const s=S.useMemo(()=>{const a=F7();return P7(a,t,O7(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};j7(a,e.style,e),s.style={...a,...s.style}}return s}const dX=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function GN(e){return typeof e!="string"||e.includes("-")?!1:!!(dX.indexOf(e)>-1||/[A-Z]/u.test(e))}function fX(e,t,r,{latestValues:n},s,a=!1){const o=(GN(e)?uX:iX)(t,n,s,e),c=JY(t,typeof e=="string",a),u=e!==S.Fragment?{...c,...o,ref:r}:{},{children:d}=t,f=S.useMemo(()=>ji(d)?d.get():d,[d]);return S.createElement(e,{...u,children:f})}function w5(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function VN(e,t,r,n){if(typeof t=="function"){const[s,a]=w5(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=w5(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function Qw(e){return ji(e)?e.get():e}function hX({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:gX(r,n,s,e),renderState:t()}}function gX(e,t,r,n){const s={},a=n(e,{});for(const g in a)s[g]=Qw(a[g]);let{initial:i,animate:o}=e;const c=Rb(e),u=N7(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?o:i;if(f&&typeof f!="boolean"&&!Ib(f)){const g=Array.isArray(f)?f:[f];for(let p=0;p<g.length;p++){const x=VN(e,g[p]);if(x){const{transitionEnd:v,transition:w,...C}=x;for(const k in C){let _=C[k];if(Array.isArray(_)){const N=d?_.length-1:0;_=_[N]}_!==null&&(s[k]=_)}for(const k in v)s[k]=v[k]}}}return s}const D7=e=>(t,r)=>{const n=S.useContext(Db),s=S.useContext(Ob),a=()=>hX(e,t,n,s);return r?a():xN(a)};function KN(e,t,r){const{style:n}=e,s={};for(const a in n)(ji(n[a])||t.style&&ji(t.style[a])||A7(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const mX=D7({scrapeMotionValuesFromProps:KN,createRenderState:HN});function I7(e,t,r){const n=KN(e,t,r);for(const s in e)if(ji(e[s])||ji(t[s])){const a=Lm.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const pX=D7({scrapeMotionValuesFromProps:I7,createRenderState:F7}),xX=Symbol.for("motionComponentSymbol");function qg(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function yX(e,t,r){return S.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):qg(r)&&(r.current=n))},[t])}const qN=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),vX="framerAppearId",R7="data-"+qN(vX),M7=S.createContext({});function wX(e,t,r,n,s){const{visualElement:a}=S.useContext(Db),i=S.useContext(T7),o=S.useContext(Ob),c=S.useContext($N).reducedMotion,u=S.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=S.useContext(M7);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&_X(u.current,r,s,f);const g=S.useRef(!1);S.useInsertionEffect(()=>{d&&g.current&&d.update(r,o)});const p=r[R7],x=S.useRef(!!p&&!window.MotionHandoffIsComplete?.(p)&&window.MotionHasOptimisedAnimation?.(p));return DM(()=>{d&&(g.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),x.current&&d.animationState&&d.animationState.animateChanges())}),S.useEffect(()=>{d&&(!x.current&&d.animationState&&d.animationState.animateChanges(),x.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(p)}),x.current=!1),d.enteringChildren=void 0)}),d}function _X(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:L7(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&qg(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:c,layoutRoot:u})}function L7(e){if(e)return e.options.allowProjection!==!1?e.projection:L7(e.parent)}function jS(e,{forwardMotionProps:t=!1}={},r,n){r&&qY(r);const s=GN(e)?pX:mX;function a(o,c){let u;const d={...S.useContext($N),...o,layoutId:bX(o)},{isStatic:f}=d,g=ZY(o),p=s(o,f);if(!f&&yN){SX();const x=kX(d);u=x.MeasureLayout,g.visualElement=wX(e,p,d,n,x.ProjectionNode)}return l.jsxs(Db.Provider,{value:g,children:[u&&g.visualElement?l.jsx(u,{visualElement:g.visualElement,...d}):null,fX(e,o,yX(p,g.visualElement,c),p,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=S.forwardRef(a);return i[xX]=e,i}function bX({layoutId:e}){const t=S.useContext(pN).id;return t&&e!==void 0?t+"-"+e:e}function SX(e,t){S.useContext(T7).strict}function kX(e){const{drag:t,layout:r}=ym;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function CX(e,t){if(typeof Proxy>"u")return jS;const r=new Map,n=(a,i)=>jS(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,jS(i,void 0,e,t)),r.get(i))})}function B7({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function TX({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function EX(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function PS(e){return e===void 0||e===1}function bT({scale:e,scaleX:t,scaleY:r}){return!PS(e)||!PS(t)||!PS(r)}function Ch(e){return bT(e)||$7(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function $7(e){return _5(e.x)||_5(e.y)}function _5(e){return e&&e!=="0%"}function g_(e,t,r){const n=e-r,s=t*n;return r+s}function b5(e,t,r,n,s){return s!==void 0&&(e=g_(e,s,n)),g_(e,r,n)+t}function ST(e,t=0,r=1,n,s){e.min=b5(e.min,t,r,n,s),e.max=b5(e.max,t,r,n,s)}function U7(e,{x:t,y:r}){ST(e.x,t.translate,t.scale,t.originPoint),ST(e.y,r.translate,r.scale,r.originPoint)}const S5=.999999999999,k5=1.0000000000001;function NX(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Xg(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,U7(e,i)),n&&Ch(a.latestValues)&&Xg(e,a.latestValues))}t.x<k5&&t.x>S5&&(t.x=1),t.y<k5&&t.y>S5&&(t.y=1)}function Yg(e,t){e.min=e.min+t,e.max=e.max+t}function C5(e,t,r,n,s=.5){const a=ws(e.min,e.max,s);ST(e,t,r,a,n)}function Xg(e,t){C5(e.x,t.x,t.scaleX,t.scale,t.originX),C5(e.y,t.y,t.scaleY,t.scale,t.originY)}function z7(e,t){return B7(EX(e.getBoundingClientRect(),t))}function AX(e,t,r){const n=z7(e,r),{scroll:s}=t;return s&&(Yg(n.x,s.offset.x),Yg(n.y,s.offset.y)),n}const T5=()=>({translate:0,scale:1,origin:0,originPoint:0}),Jg=()=>({x:T5(),y:T5()}),E5=()=>({min:0,max:0}),Ys=()=>({x:E5(),y:E5()}),kT={current:null},W7={current:!1};function jX(){if(W7.current=!0,!!yN)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>kT.current=e.matches;e.addEventListener("change",t),t()}else kT.current=!1}const PX=new WeakMap;function FX(e,t,r){for(const n in t){const s=t[n],a=r[n];if(ji(s))e.addValue(n,s);else if(ji(a))e.addValue(n,xm(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,xm(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const N5=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class OX{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=IN,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=_o.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,gs.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Rb(r),this.isVariantNode=N7(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in f){const p=f[g];c[g]!==void 0&&ji(p)&&p.set(c[g])}}mount(t){this.current=t,PX.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),W7.current||jX(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:kT.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),bf(this.notifyUpdate),bf(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=Bm.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&gs.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in ym){const r=ym[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ys()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<N5.length;n++){const s=N5[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=FX(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=xm(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(IM(n)||MM(n))?n=parseFloat(n):!WY(n)&&Sf.test(r)&&(n=y7(t,r)),this.setBaseTarget(t,ji(n)?n.get():n)),ji(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=VN(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!ji(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new SN),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){LN.render(this.render)}}class H7 extends OX{constructor(){super(...arguments),this.KeyframeResolver=PY}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;ji(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function G7(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function DX(e){return window.getComputedStyle(e)}class IX extends H7{constructor(){super(...arguments),this.type="html",this.renderInstance=G7}readValueFromInstance(t,r){if(Bm.has(r))return this.projection?.isProjecting?mT(r):Xq(t,r);{const n=DX(t),s=(TN(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return z7(t,r)}build(t,r,n){WN(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return KN(t,r,n)}}const V7=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function RX(e,t,r,n){G7(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(V7.has(s)?s:qN(s),t.attrs[s])}class MX extends H7{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ys}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Bm.has(r)){const n=x7(r);return n&&n.default||0}return r=V7.has(r)?r:qN(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return I7(t,r,n)}build(t,r,n){P7(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){RX(t,r,n,s)}mount(t){this.isSVGTag=O7(t.tagName),super.mount(t)}}const LX=(e,t)=>GN(e)?new MX(t):new IX(t,{allowProjection:e!==S.Fragment});function nm(e,t,r){const n=e.getProps();return VN(n,t,r!==void 0?r:n.custom,e)}const CT=e=>Array.isArray(e);function BX(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,xm(r))}function $X(e){return CT(e)?e[e.length-1]||0:e}function UX(e,t){const r=nm(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=$X(a[i]);BX(e,i,o)}}function zX(e){return!!(ji(e)&&e.add)}function TT(e,t){const r=e.getValue("willChange");if(zX(r))return r.add(t);if(!r&&Zu.WillChange){const n=new Zu.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function K7(e){return e.props[R7]}const WX=e=>e!==null;function HX(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(WX),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const GX={type:"spring",stiffness:500,damping:25,restSpeed:10},VX=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),KX={type:"keyframes",duration:.8},qX={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},YX=(e,{keyframes:t})=>t.length>2?KX:Bm.has(e)?e.startsWith("scale")?VX(t[1]):GX:qX;function XX({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const YN=(e,t,r,n={},s,a)=>i=>{const o=RN(n,e)||{},c=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-Vc(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:g=>{t.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};XX(o)||Object.assign(d,YX(e,d)),d.duration&&(d.duration=Vc(d.duration)),d.repeatDelay&&(d.repeatDelay=Vc(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(wT(d),d.delay===0&&(f=!0)),(Zu.instantAnimations||Zu.skipAnimations)&&(f=!0,wT(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!a&&t.get()!==void 0){const g=HX(d.keyframes,o);if(g!==void 0){gs.update(()=>{d.onUpdate(g),d.onComplete()});return}}return o.isSync?new DN(d):new vY(d)};function JX({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function q7(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const c=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const d in o){const f=e.getValue(d,e.latestValues[d]??null),g=o[d];if(g===void 0||u&&JX(u,d))continue;const p={delay:r,...RN(a||{},d)},x=f.get();if(x!==void 0&&!f.isAnimating&&!Array.isArray(g)&&g===x&&!p.velocity)continue;let v=!1;if(window.MotionHandoffAnimation){const C=K7(e);if(C){const k=window.MotionHandoffAnimation(C,d,gs);k!==null&&(p.startTime=k,v=!0)}}TT(e,d),f.start(YN(d,f,g,e.shouldReduceMotion&&g7.has(d)?{type:!1}:p,e,v));const w=f.animation;w&&c.push(w)}return i&&Promise.all(c).then(()=>{gs.update(()=>{i&&UX(e,i)})}),c}function Y7(e,t,r,n=0,s=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function ET(e,t,r={}){const n=nm(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(q7(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=s;return QX(e,t,c,u,d,f,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>u())}else return Promise.all([a(),i(r.delay)])}function QX(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(ET(c,t,{...i,delay:r+(typeof n=="function"?0:n)+Y7(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function ZX(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>ET(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=ET(e,t,r);else{const s=typeof t=="function"?nm(e,t,r.custom):t;n=Promise.all(q7(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function X7(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const eJ=zN.length;function J7(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?J7(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<eJ;r++){const n=zN[r],s=e.props[n];(By(s)||s===!1)&&(t[n]=s)}return t}const tJ=[...UN].reverse(),rJ=UN.length;function nJ(e){return t=>Promise.all(t.map(({animation:r,options:n})=>ZX(e,r,n)))}function sJ(e){let t=nJ(e),r=A5(),n=!0;const s=c=>(u,d)=>{const f=nm(e,d,c==="exit"?e.presenceContext?.custom:void 0);if(f){const{transition:g,transitionEnd:p,...x}=f;u={...u,...x,...p}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=J7(e.parent)||{},f=[],g=new Set;let p={},x=1/0;for(let w=0;w<rJ;w++){const C=tJ[w],k=r[C],_=u[C]!==void 0?u[C]:d[C],N=By(_),E=C===c?k.isActive:null;E===!1&&(x=w);let P=_===d[C]&&_!==u[C]&&N;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),k.protectedKeys={...p},!k.isActive&&E===null||!_&&!k.prevProp||Ib(_)||typeof _=="boolean")continue;const F=aJ(k.prevProp,_);let A=F||C===c&&k.isActive&&!P&&N||w>x&&N,j=!1;const I=Array.isArray(_)?_:[_];let L=I.reduce(s(C),{});E===!1&&(L={});const{prevResolvedValues:Y={}}=k,Z={...Y,...L},ae=B=>{A=!0,g.has(B)&&(j=!0,g.delete(B)),k.needsAnimating[B]=!0;const V=e.getValue(B);V&&(V.liveStyle=!1)};for(const B in Z){const V=L[B],M=Y[B];if(p.hasOwnProperty(B))continue;let H=!1;CT(V)&&CT(M)?H=!X7(V,M):H=V!==M,H?V!=null?ae(B):g.add(B):V!==void 0&&g.has(B)?ae(B):k.protectedKeys[B]=!0}k.prevProp=_,k.prevResolvedValues=L,k.isActive&&(p={...p,...L}),n&&e.blockInitialAnimation&&(A=!1);const ee=P&&F;A&&(!ee||j)&&f.push(...I.map(B=>{const V={type:C};if(typeof B=="string"&&n&&!ee&&e.manuallyAnimateOnMount&&e.parent){const{parent:M}=e,H=nm(M,B);if(M.enteringChildren&&H){const{delayChildren:W}=H.transition||{};V.delay=Y7(M.enteringChildren,e,W)}}return{animation:B,options:V}}))}if(g.size){const w={};if(typeof u.initial!="boolean"){const C=nm(e,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(w.transition=C.transition)}g.forEach(C=>{const k=e.getBaseTarget(C),_=e.getValue(C);_&&(_.liveStyle=!0),w[C]=k??null}),f.push({animation:w})}let v=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(v=!1),n=!1,v?t(f):Promise.resolve()}function o(c,u){if(r[c].isActive===u)return Promise.resolve();e.variantChildren?.forEach(f=>f.animationState?.setActive(c,u)),r[c].isActive=u;const d=i(c);for(const f in r)r[f].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=A5(),n=!0}}}function aJ(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!X7(t,e):!1}function wh(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function A5(){return{animate:wh(!0),whileInView:wh(),whileHover:wh(),whileTap:wh(),whileDrag:wh(),whileFocus:wh(),exit:wh()}}class Ff{constructor(t){this.isMounted=!1,this.node=t}update(){}}class iJ extends Ff{constructor(t){super(t),t.animationState||(t.animationState=sJ(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Ib(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let oJ=0;class lJ extends Ff{constructor(){super(...arguments),this.id=oJ++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const cJ={animation:{Feature:iJ},exit:{Feature:lJ}};function Uy(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Nv(e){return{point:{x:e.pageX,y:e.pageY}}}const uJ=e=>t=>BN(t)&&e(t,Nv(t));function py(e,t,r,n){return Uy(e,t,uJ(r),n)}const Q7=1e-4,dJ=1-Q7,fJ=1+Q7,Z7=.01,hJ=0-Z7,gJ=0+Z7;function eo(e){return e.max-e.min}function mJ(e,t,r){return Math.abs(e-t)<=r}function j5(e,t,r,n=.5){e.origin=n,e.originPoint=ws(t.min,t.max,e.origin),e.scale=eo(r)/eo(t),e.translate=ws(r.min,r.max,e.origin)-e.originPoint,(e.scale>=dJ&&e.scale<=fJ||isNaN(e.scale))&&(e.scale=1),(e.translate>=hJ&&e.translate<=gJ||isNaN(e.translate))&&(e.translate=0)}function xy(e,t,r,n){j5(e.x,t.x,r.x,n?n.originX:void 0),j5(e.y,t.y,r.y,n?n.originY:void 0)}function P5(e,t,r){e.min=r.min+t.min,e.max=e.min+eo(t)}function pJ(e,t,r){P5(e.x,t.x,r.x),P5(e.y,t.y,r.y)}function F5(e,t,r){e.min=t.min-r.min,e.max=e.min+eo(t)}function yy(e,t,r){F5(e.x,t.x,r.x),F5(e.y,t.y,r.y)}function xl(e){return[e("x"),e("y")]}const eL=({current:e})=>e?e.ownerDocument.defaultView:null,O5=(e,t)=>Math.abs(e-t);function xJ(e,t){const r=O5(e.x,t.x),n=O5(e.y,t.y);return Math.sqrt(r**2+n**2)}class tL{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=OS(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,x=xJ(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!p&&!x)return;const{point:v}=g,{timestamp:w}=si;this.history.push({...v,timestamp:w});const{onStart:C,onMove:k}=this.handlers;p||(C&&C(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,g)},this.handlePointerMove=(g,p)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=FS(p,this.transformPagePoint),gs.update(this.updatePoint,!0)},this.handlePointerUp=(g,p)=>{this.end();const{onEnd:x,onSessionEnd:v,resumeAnimation:w}=this.handlers;if(this.dragSnapToOrigin&&w&&w(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=OS(g.type==="pointercancel"?this.lastMoveEventInfo:FS(p,this.transformPagePoint),this.history);this.startEvent&&x&&x(g,C),v&&v(g,C)},!BN(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=Nv(t),c=FS(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=si;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,OS(c,this.history)),this.removeListeners=Cv(py(this.contextWindow,"pointermove",this.handlePointerMove),py(this.contextWindow,"pointerup",this.handlePointerUp),py(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),bf(this.updatePoint)}}function FS(e,t){return t?{point:t(e.point)}:e}function D5(e,t){return{x:e.x-t.x,y:e.y-t.y}}function OS({point:e},t){return{point:e,delta:D5(e,rL(t)),offset:D5(e,yJ(t)),velocity:vJ(t,.1)}}function yJ(e){return e[0]}function rL(e){return e[e.length-1]}function vJ(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=rL(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Vc(t)));)r--;if(!n)return{x:0,y:0};const a=Kc(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function wJ(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ws(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ws(r,e,n.max):Math.min(e,r)),e}function I5(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function _J(e,{top:t,left:r,bottom:n,right:s}){return{x:I5(e.x,r,s),y:I5(e.y,t,n)}}function R5(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function bJ(e,t){return{x:R5(e.x,t.x),y:R5(e.y,t.y)}}function SJ(e,t){let r=.5;const n=eo(e),s=eo(t);return s>n?r=Ry(t.min,t.max-n,e.min):n>s&&(r=Ry(e.min,e.max-s,t.min)),Qu(0,1,r)}function kJ(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const NT=.35;function CJ(e=NT){return e===!1?e=0:e===!0&&(e=NT),{x:M5(e,"left","right"),y:M5(e,"top","bottom")}}function M5(e,t,r){return{min:L5(e,t),max:L5(e,r)}}function L5(e,t){return typeof e=="number"?e:e[t]||0}const TJ=new WeakMap;class EJ{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ys(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Nv(f).point)},i=(f,g)=>{const{drag:p,dragPropagation:x,onDragStart:v}=this.getProps();if(p&&!x&&(this.openDragLock&&this.openDragLock(),this.openDragLock=IY(p),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),xl(C=>{let k=this.getAxisMotionValue(C).get()||0;if(qc.test(k)){const{projection:_}=this.visualElement;if(_&&_.layout){const N=_.layout.layoutBox[C];N&&(k=eo(N)*(parseFloat(k)/100))}}this.originPoint[C]=k}),v&&gs.postRender(()=>v(f,g)),TT(this.visualElement,"transform");const{animationState:w}=this.visualElement;w&&w.setActive("whileDrag",!0)},o=(f,g)=>{this.latestPointerEvent=f,this.latestPanInfo=g;const{dragPropagation:p,dragDirectionLock:x,onDirectionLock:v,onDrag:w}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:C}=g;if(x&&this.currentDirection===null){this.currentDirection=NJ(C),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",g.point,C),this.updateAxis("y",g.point,C),this.visualElement.render(),w&&w(f,g)},c=(f,g)=>{this.latestPointerEvent=f,this.latestPanInfo=g,this.stop(f,g),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>xl(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:d}=this.getProps();this.panSession=new tL(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:eL(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&gs.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!dw(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=wJ(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&qg(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=_J(n.layoutBox,t):this.constraints=!1,this.elastic=CJ(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&xl(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=kJ(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!qg(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=AX(n,s.root,this.visualElement.getTransformPagePoint());let i=bJ(s.layout.layoutBox,a);if(r){const o=r(TX(i));this.hasMutatedConstraints=!!o,o&&(i=B7(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=xl(d=>{if(!dw(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const g=s?200:1e6,p=s?40:1e7,x={type:"inertia",velocity:n?t[d]:0,bounceStiffness:g,bounceDamping:p,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,x)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return TT(this.visualElement,t),n.start(YN(t,n,0,r,this.visualElement,!1))}stopAnimation(){xl(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){xl(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){xl(r=>{const{drag:n}=this.getProps();if(!dw(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-ws(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!qg(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};xl(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=SJ({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),xl(i=>{if(!dw(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];o.set(ws(c,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;TJ.set(this.visualElement,this);const t=this.visualElement.current,r=py(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();qg(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),gs.read(n);const i=Uy(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(xl(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=NT,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function dw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function NJ(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class AJ extends Ff{constructor(t){super(t),this.removeGroupControls=Cl,this.removeListeners=Cl,this.controls=new EJ(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Cl}unmount(){this.removeGroupControls(),this.removeListeners()}}const B5=e=>(t,r)=>{e&&gs.postRender(()=>e(t,r))};class jJ extends Ff{constructor(){super(...arguments),this.removePointerDownListener=Cl}onPointerDown(t){this.session=new tL(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:eL(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:B5(t),onStart:B5(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&gs.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=py(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Zw={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function $5(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const rx={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Mr.test(e))e=parseFloat(e);else return e;const r=$5(e,t.target.x),n=$5(e,t.target.y);return`${r}% ${n}%`}},PJ={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Sf.parse(e);if(s.length>5)return n;const a=Sf.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const u=ws(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let DS=!1;class FJ extends S.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;eX(OJ),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),DS&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),Zw.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,DS=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||gs.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),LN.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;DS=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function nL(e){const[t,r]=C7(),n=S.useContext(pN);return l.jsx(FJ,{...e,layoutGroup:n,switchLayoutGroup:S.useContext(M7),isPresent:t,safeToRemove:r})}const OJ={borderRadius:{...rx,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:rx,borderTopRightRadius:rx,borderBottomLeftRadius:rx,borderBottomRightRadius:rx,boxShadow:PJ};function DJ(e,t,r){const n=ji(e)?e:xm(e);return n.start(YN("",n,t,r)),n.animation}const IJ=(e,t)=>e.depth-t.depth;class RJ{constructor(){this.children=[],this.isDirty=!1}add(t){vN(this.children,t),this.isDirty=!0}remove(t){wN(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(IJ),this.isDirty=!1,this.children.forEach(t)}}function MJ(e,t){const r=_o.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(bf(n),e(a-t))};return gs.setup(n,!0),()=>bf(n)}const sL=["TopLeft","TopRight","BottomLeft","BottomRight"],LJ=sL.length,U5=e=>typeof e=="string"?parseFloat(e):e,z5=e=>typeof e=="number"||Mr.test(e);function BJ(e,t,r,n,s,a){s?(e.opacity=ws(0,r.opacity??1,$J(n)),e.opacityExit=ws(t.opacity??1,0,UJ(n))):a&&(e.opacity=ws(t.opacity??1,r.opacity??1,n));for(let i=0;i<LJ;i++){const o=`border${sL[i]}Radius`;let c=W5(t,o),u=W5(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||z5(c)===z5(u)?(e[o]=Math.max(ws(U5(c),U5(u),n),0),(qc.test(u)||qc.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=ws(t.rotate||0,r.rotate||0,n))}function W5(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const $J=aL(0,.5,GM),UJ=aL(.5,.95,Cl);function aL(e,t,r){return n=>n<e?0:n>t?1:r(Ry(e,t,n))}function H5(e,t){e.min=t.min,e.max=t.max}function ul(e,t){H5(e.x,t.x),H5(e.y,t.y)}function G5(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function V5(e,t,r,n,s){return e-=t,e=g_(e,1/r,n),s!==void 0&&(e=g_(e,1/s,n)),e}function zJ(e,t=0,r=1,n=.5,s,a=e,i=e){if(qc.test(t)&&(t=parseFloat(t),t=ws(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=ws(a.min,a.max,n);e===a&&(o-=t),e.min=V5(e.min,t,r,o,s),e.max=V5(e.max,t,r,o,s)}function K5(e,t,[r,n,s],a,i){zJ(e,t[r],t[n],t[s],t.scale,a,i)}const WJ=["x","scaleX","originX"],HJ=["y","scaleY","originY"];function q5(e,t,r,n){K5(e.x,t,WJ,r?r.x:void 0,n?n.x:void 0),K5(e.y,t,HJ,r?r.y:void 0,n?n.y:void 0)}function Y5(e){return e.translate===0&&e.scale===1}function iL(e){return Y5(e.x)&&Y5(e.y)}function X5(e,t){return e.min===t.min&&e.max===t.max}function GJ(e,t){return X5(e.x,t.x)&&X5(e.y,t.y)}function J5(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function oL(e,t){return J5(e.x,t.x)&&J5(e.y,t.y)}function Q5(e){return eo(e.x)/eo(e.y)}function Z5(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class VJ{constructor(){this.members=[]}add(t){vN(this.members,t),t.scheduleRender()}remove(t){if(wN(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function KJ(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:g,skewX:p,skewY:x}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),f&&(n+=`rotateX(${f}deg) `),g&&(n+=`rotateY(${g}deg) `),p&&(n+=`skewX(${p}deg) `),x&&(n+=`skewY(${x}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const IS=["","X","Y","Z"],qJ=1e3;let YJ=0;function RS(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function lL(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=K7(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",gs,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&lL(n)}function cL({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=YJ++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(QJ),this.nodes.forEach(rQ),this.nodes.forEach(nQ),this.nodes.forEach(ZJ)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new RJ)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new SN),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=k7(i)&&!UY(i),this.instance=i;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let d,f=0;const g=()=>this.root.updateBlockedByResize=!1;gs.read(()=>{f=window.innerWidth}),e(i,()=>{const p=window.innerWidth;p!==f&&(f=p,this.root.updateBlockedByResize=!0,d&&d(),d=MJ(g,250),Zw.hasAnimatedSinceResize&&(Zw.hasAnimatedSinceResize=!1,this.nodes.forEach(r6)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:g,layout:p})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||lQ,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=u.getProps(),C=!this.targetLayout||!oL(this.targetLayout,p),k=!f&&g;if(this.options.layoutRoot||this.resumeFrom||k||f&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...RN(x,"layout"),onPlay:v,onComplete:w};(u.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(d,k)}else f||r6(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=p})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),bf(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(sQ),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&lL(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(e6);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(t6);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(tQ),this.nodes.forEach(XJ),this.nodes.forEach(JJ)):this.nodes.forEach(t6),this.clearAllSnapshots();const o=_o.now();si.delta=Qu(0,1e3/60,o-si.timestamp),si.timestamp=o,si.isProcessing=!0,kS.update.process(si),kS.preRender.process(si),kS.render.process(si),si.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,LN.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(eQ),this.sharedNodes.forEach(aQ)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,gs.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){gs.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!eo(this.snapshot.measuredBox.x)&&!eo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ys(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!iL(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||Ch(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),cQ(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Ys();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(uQ))){const{scroll:u}=this.root;u&&(Yg(o.x,u.offset.x),Yg(o.y,u.offset.y))}return o}removeElementScroll(i){const o=Ys();if(ul(o,i),this.scroll?.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:f}=u;u!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&ul(o,i),Yg(o.x,d.offset.x),Yg(o.y,d.offset.y))}return o}applyTransform(i,o=!1){const c=Ys();ul(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&Xg(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),Ch(d.latestValues)&&Xg(c,d.latestValues)}return Ch(this.latestValues)&&Xg(c,this.latestValues),c}removeTransform(i){const o=Ys();ul(o,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!Ch(u.latestValues))continue;bT(u.latestValues)&&u.updateSnapshot();const d=Ys(),f=u.measurePageBox();ul(d,f),q5(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return Ch(this.latestValues)&&q5(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==si.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=si.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ys(),this.relativeTargetOrigin=Ys(),yy(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),ul(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ys(),this.targetWithTransforms=Ys()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pJ(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ul(this.target,this.layout.layoutBox),U7(this.target,this.targetDelta)):ul(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ys(),this.relativeTargetOrigin=Ys(),yy(this.relativeTargetOrigin,this.target,g.target),ul(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||bT(this.parent.latestValues)||$7(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===si.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;ul(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,g=this.treeScale.y;NX(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Ys());const{target:p}=i;if(!p){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(G5(this.prevProjectionDelta.x,this.projectionDelta.x),G5(this.prevProjectionDelta.y,this.projectionDelta.y)),xy(this.projectionDelta,this.layoutCorrected,p,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==g||!Z5(this.projectionDelta.x,this.prevProjectionDelta.x)||!Z5(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",p))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Jg(),this.projectionDelta=Jg(),this.projectionDeltaWithTransform=Jg()}setAnimationOrigin(i,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Jg();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=Ys(),p=c?c.source:void 0,x=this.layout?this.layout.source:void 0,v=p!==x,w=this.getStack(),C=!w||w.members.length<=1,k=!!(v&&!C&&this.options.crossfade===!0&&!this.path.some(oQ));this.animationProgress=0;let _;this.mixTargetDelta=N=>{const E=N/1e3;n6(f.x,i.x,E),n6(f.y,i.y,E),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(yy(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),iQ(this.relativeTarget,this.relativeTargetOrigin,g,E),_&&GJ(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=Ys()),ul(_,this.relativeTarget)),v&&(this.animationValues=d,BJ(d,u,this.latestValues,E,k,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=E},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(bf(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=gs.update(()=>{Zw.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=xm(0)),this.currentAnimation=DJ(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(qJ),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=i;if(!(!o||!c||!u)){if(this!==i&&this.layout&&u&&uL(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Ys();const f=eo(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const g=eo(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+g}ul(o,c),Xg(o,d),xy(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new VJ),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&RS("z",i,u,this.animationValues);for(let d=0;d<IS.length;d++)RS(`rotate${IS[d]}`,i,u,this.animationValues),RS(`skew${IS[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=Qw(o?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=Qw(o?.pointerEvents)||""),this.hasProjected&&!Ch(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=KJ(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:g,y:p}=this.projectionDelta;i.transformOrigin=`${g.origin*100}% ${p.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const x in $y){if(d[x]===void 0)continue;const{correct:v,applyTo:w,isCSSVariable:C}=$y[x],k=f==="none"?d[x]:v(d[x],u);if(w){const _=w.length;for(let N=0;N<_;N++)i[w[N]]=k}else C?this.options.visualElement.renderState.vars[x]=k:i[x]=k}this.options.layoutId&&(i.pointerEvents=u===this?Qw(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(e6),this.root.sharedNodes.clear()}}}function XJ(e){e.updateLayout()}function JJ(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?xl(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],g=eo(f);f.min=r[d].min,f.max=f.min+g}):uL(s,t.layoutBox,r)&&xl(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],g=eo(r[d]);f.max=f.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+g)});const i=Jg();xy(i,r,t.layoutBox);const o=Jg();a?xy(o,e.applyTransform(n,!0),t.measuredBox):xy(o,r,t.layoutBox);const c=!iL(i);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:g}=d;if(f&&g){const p=Ys();yy(p,t.layoutBox,f.layoutBox);const x=Ys();yy(x,r,g.layoutBox),oL(p,x)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=x,e.relativeTargetOrigin=p,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function QJ(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function ZJ(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function eQ(e){e.clearSnapshot()}function e6(e){e.clearMeasurements()}function t6(e){e.isLayoutDirty=!1}function tQ(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function r6(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function rQ(e){e.resolveTargetDelta()}function nQ(e){e.calcProjection()}function sQ(e){e.resetSkewAndRotation()}function aQ(e){e.removeLeadSnapshot()}function n6(e,t,r){e.translate=ws(t.translate,0,r),e.scale=ws(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function s6(e,t,r,n){e.min=ws(t.min,r.min,n),e.max=ws(t.max,r.max,n)}function iQ(e,t,r,n){s6(e.x,t.x,r.x,n),s6(e.y,t.y,r.y,n)}function oQ(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const lQ={duration:.45,ease:[.4,0,.1,1]},a6=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),i6=a6("applewebkit/")&&!a6("chrome/")?Math.round:Cl;function o6(e){e.min=i6(e.min),e.max=i6(e.max)}function cQ(e){o6(e.x),o6(e.y)}function uL(e,t,r){return e==="position"||e==="preserve-aspect"&&!mJ(Q5(t),Q5(r),.2)}function uQ(e){return e!==e.root&&e.scroll?.wasRoot}const dQ=cL({attachResizeListener:(e,t)=>Uy(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),MS={current:void 0},dL=cL({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!MS.current){const e=new dQ({});e.mount(window),e.setOptions({layoutScroll:!0}),MS.current=e}return MS.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),fQ={pan:{Feature:jJ},drag:{Feature:AJ,ProjectionNode:dL,MeasureLayout:nL}};function l6(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&gs.postRender(()=>a(t,Nv(t)))}class hQ extends Ff{mount(){const{current:t}=this.node;t&&(this.unmount=RY(t,(r,n)=>(l6(this.node,n,"Start"),s=>l6(this.node,s,"End"))))}unmount(){}}class gQ extends Ff{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Cv(Uy(this.node.current,"focus",()=>this.onFocus()),Uy(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function c6(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&gs.postRender(()=>a(t,Nv(t)))}class mQ extends Ff{mount(){const{current:t}=this.node;t&&(this.unmount=$Y(t,(r,n)=>(c6(this.node,n,"Start"),(s,{success:a})=>c6(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const AT=new WeakMap,LS=new WeakMap,pQ=e=>{const t=AT.get(e.target);t&&t(e)},xQ=e=>{e.forEach(pQ)};function yQ({root:e,...t}){const r=e||document;LS.has(r)||LS.set(r,{});const n=LS.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(xQ,{root:e,...t})),n[s]}function vQ(e,t,r){const n=yQ(t);return AT.set(e,r),n.observe(e),()=>{AT.delete(e),n.unobserve(e)}}const wQ={some:0,all:1};class _Q extends Ff{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:wQ[s]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),g=u?d:f;g&&g(c)};return vQ(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(bQ(t,r))&&this.startObserver()}unmount(){}}function bQ({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const SQ={inView:{Feature:_Q},tap:{Feature:mQ},focus:{Feature:gQ},hover:{Feature:hQ}},kQ={layout:{ProjectionNode:dL,MeasureLayout:nL}},CQ={...cJ,...SQ,...fQ,...kQ},at=CX(CQ,LX),et=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return l.jsx(at.button,{className:`${o} ${c[t]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Hr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return l.jsx(at.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},uc=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,c]=S.useState(!0),[u,d]=S.useState(!1),f=S.useRef(null),g=S.useRef(null);S.useEffect(()=>{if(r>0)return g.current=setTimeout(()=>{p()},r),()=>{g.current&&clearTimeout(g.current)}},[r]);const p=S.useCallback(()=>{u||(d(!0),g.current&&clearTimeout(g.current),setTimeout(()=>{c(!1),s&&s()},300))},[u,s]),x=S.useCallback(C=>{C.key==="Escape"&&p()},[p]);if(!o)return null;const v=["notification",`notification-${e}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),w=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return l.jsx("div",{ref:f,className:v,role:"alert","aria-live":"polite",onKeyDown:x,tabIndex:-1,...i,children:l.jsxs("div",{className:"notification-content",children:[l.jsx("div",{className:"notification-icon","aria-hidden":"true",children:w()}),l.jsx("div",{className:"notification-body",children:l.jsx("div",{className:"notification-message",children:t})}),n&&l.jsx("button",{className:"notification-close",onClick:p,type:"button","aria-label":"Close notification",children:""})]})})},ka=()=>{const[e,t]=S.useState([]),r=S.useCallback((a,i="info",o={})=>{const c=Date.now()+Math.random(),u={id:c,message:a,type:i,...o};return t(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(c)},o.duration||3e3),c},[]),n=S.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=S.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},Jo=()=>{const[e,t]=S.useState(!1),[r,n]=S.useState(null),[s,a]=S.useState(null),i=S.useRef(null);S.useRef(new Map);const o=S.useRef(0),c=3,u=1e3,d=S.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);S.useEffect(()=>d,[d]);const f=S.useCallback(async(R,z={})=>{try{t(!0),n(null),i.current=new AbortController;const K=z.method||"POST",J={method:K,headers:{"Content-Type":"application/json",...z.headers},signal:i.current.signal,...z};K!=="GET"&&K!=="HEAD"&&(J.body=JSON.stringify(z.data||{})),console.log(`[API] Making request to: ${R}`,J);const se=await fetch(R,J);if(!se.ok)throw new Error(`HTTP error! status: ${se.status}`);const X=await se.json();if(console.log("[API] Response received:",X),X.success)return a(X),o.current=0,X;throw new Error(X.error||X.message||"Request failed")}catch(K){if(K.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",K),n(K.message||"Request failed"),o.current<c){o.current++;const J=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${J}ms (attempt ${o.current}/${c})`),await new Promise(se=>setTimeout(se,J)),f(R,z)}throw K}finally{t(!1),i.current=null}},[]),g=S.useCallback(async(R,z={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(R,z)}catch(K){throw console.error("[API] Authenticated request failed:",K),K}},[]),p=S.useCallback(async(R,z)=>{try{const K=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${z}`;console.log(`[API] Getting test info for ${R}_${z}`);const se=await(await g(K)).json();if(se.success)return console.log("[API] Test info retrieved successfully:",se.test_info),se.test_info;throw new Error(se.error||"Failed to get test info")}catch(K){throw console.error("[API] Failed to get test info:",K),K}},[g]),x=S.useCallback(async(R,z)=>{try{const K=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${z}`;console.log(`[API] Getting test questions for ${R}_${z}`);const se=await(await g(K)).json();if(se.success)return console.log("[API] Test questions retrieved successfully:",se.questions),se.questions;throw new Error(se.error||"Failed to get test questions")}catch(K){throw console.error("[API] Failed to get test questions:",K),K}},[g]),v=S.useCallback(async()=>{try{const R="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const K=await(await g(R)).json();if(K.success)return console.log("[API] Student active tests loaded successfully:",K.tests),K.tests;throw new Error(K.error||"Failed to load student active tests")}catch(R){throw console.error("[API] Failed to load student active tests:",R),R}},[g]),w=S.useCallback(async(R,z,K)=>{try{let J;switch(R){case"true_false":J="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":J="/.netlify/functions/submit-multiple-choice-test";break;case"input":J="/.netlify/functions/submit-input-test";break;case"matching_type":J="/.netlify/functions/submit-matching-type-test";break;case"speaking":J="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${R}`)}console.log(`[API] Submitting ${R} test:`,K);const X=await(await g(J,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)})).json();if(X.success)return console.log("[API] Test submitted successfully:",X),X;throw new Error(X.error||"Failed to submit test")}catch(J){throw console.error("[API] Failed to submit test:",J),J}},[g]),C=S.useCallback(async R=>{try{const z="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",R);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(J.success)return console.log("[API] Multiple choice test saved successfully:",J),J;throw new Error(J.error||"Failed to save multiple choice test")}catch(z){throw console.error("[API] Failed to save multiple choice test:",z),z}},[g]),k=S.useCallback(async R=>{try{const z="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",R);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(J.success)return console.log("[API] True/false test saved successfully:",J),J;throw new Error(J.error||"Failed to save true/false test")}catch(z){throw console.error("[API] Failed to save true/false test:",z),z}},[g]),_=S.useCallback(async R=>{try{const z="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",R);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(J.success)return console.log("[API] Input test saved successfully:",J),J;throw new Error(J.error||"Failed to save input test")}catch(z){throw console.error("[API] Failed to save input test:",z),z}},[g]),N=S.useCallback(async R=>{try{const z="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",R);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(J.success)return console.log("[API] Test assigned successfully:",J),J;throw new Error(J.error||"Failed to assign test")}catch(z){throw console.error("[API] Failed to assign test:",z),z}},[g]),E=S.useCallback(async()=>{try{const R="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const K=await(await g(R)).json();if(K.success)return console.log("[API] Teacher active tests loaded successfully:",K.tests),K.tests;throw new Error(K.error||"Failed to load teacher active tests")}catch(R){throw console.error("[API] Failed to load teacher active tests:",R),R}},[g]),P=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const K=await(await g(R)).json();if(K.success)return console.log("[API] All users loaded successfully:",K.users),K.users;throw new Error(K.error||"Failed to get all users")}catch(R){throw console.error("[API] Failed to get all users:",R),R}},[g]),F=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const K=await(await g(R)).json();if(K.success)return console.log("[API] All teachers loaded successfully:",K.teachers),K.teachers;throw new Error(K.error||"Failed to get all teachers")}catch(R){throw console.error("[API] Failed to get all teachers:",R),R}},[g]),A=S.useCallback(async()=>{try{const R="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const K=await(await g(R)).json();if(K.success)return console.log("[API] All subjects loaded successfully:",K.subjects),K.subjects;throw new Error(K.error||"Failed to get all subjects")}catch(R){throw console.error("[API] Failed to get all subjects:",R),R}},[g]),j=S.useCallback(()=>{n(null)},[]),I=S.useCallback(()=>{a(null)},[]),L=S.useCallback(()=>{t(!1),n(null),a(null),o.current=0,d()},[d]),Y=S.useCallback(async(R,z={})=>{const J=await(await g(R,{...z,method:"GET"})).json();if(J.success)return J;throw new Error(J.error||"Request failed")},[g]),Z=S.useCallback(async(R,z,K={})=>{const se=await(await g(R,{...K,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(se.success)return se;throw new Error(se.error||"Request failed")},[g]),ae=S.useCallback(async(R,z,K={})=>{const se=await(await g(R,{...K,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(se.success)return se;throw new Error(se.error||"Request failed")},[g]),ee=S.useCallback(async(R,z={})=>{const J=await(await g(R,{...z,method:"DELETE"})).json();if(J.success)return J;throw new Error(J.error||"Request failed")},[g]),ne=S.useCallback(async R=>{try{const z="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",R);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(J.success)return console.log("[API] Speaking test submitted successfully:",J),J;throw new Error(J.error||"Failed to submit speaking test")}catch(z){throw console.error("[API] Failed to submit speaking test:",z),z}},[g]),B=S.useCallback(async R=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${R}`;console.log("[API] Getting speaking test:",R);const J=await(await g(z,{method:"GET"})).json();if(J.success)return console.log("[API] Speaking test loaded successfully:",J),J;throw new Error(J.error||"Failed to load speaking test")}catch(z){throw console.error("[API] Failed to load speaking test:",z),z}},[g]),V=S.useCallback(async R=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${R}`;console.log("[API] Getting speaking test questions:",R);const J=await(await g(z,{method:"GET"})).json();if(J.success)return console.log("[API] Speaking test questions loaded successfully:",J),J;throw new Error(J.error||"Failed to load speaking test questions")}catch(z){throw console.error("[API] Failed to load speaking test questions:",z),z}},[g]),M=S.useCallback(async R=>{try{const z="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(J.success)return console.log("[API] Audio uploaded successfully:",J),J;throw new Error(J.error||"Failed to upload audio")}catch(z){throw console.error("[API] Failed to upload audio:",z),z}},[g]),H=S.useCallback(async R=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(R)}`;console.log("[API] Getting speaking audio:",R);const J=await(await g(z,{method:"GET"})).json();if(J.success)return console.log("[API] Audio URL retrieved successfully:",J),J;throw new Error(J.error||"Failed to get audio")}catch(z){throw console.error("[API] Failed to get audio:",z),z}},[g]),W=S.useCallback(async(R,z)=>{try{const K=`/.netlify/functions/check-test-completion?test_id=${R}&test_type=${z}`;console.log("[API] Checking test completion:",R,z);const se=await(await g(K,{method:"GET"})).json();if(se.success)return console.log("[API] Test completion status:",se),se;throw new Error(se.error||"Failed to check test completion")}catch(K){throw console.error("[API] Failed to check test completion:",K),K}},[g]);return{loading:e,error:r,data:s,sendRequest:f,makeAuthenticatedRequest:g,get:Y,post:Z,put:ae,delete:ee,getTestInfo:p,getTestQuestions:x,loadStudentActiveTests:v,submitTest:w,submitSpeakingTest:ne,getSpeakingTest:B,getSpeakingTestQuestions:V,uploadSpeakingAudio:M,getSpeakingAudio:H,checkTestCompletion:W,saveMultipleChoiceTest:C,saveTrueFalseTest:k,saveInputTest:_,assignTestToClasses:N,loadTeacherActiveTests:E,getAllUsers:P,getAllTeachers:F,getAllSubjects:A,clearError:j,clearData:I,reset:L,cleanup:d}},TQ="modulepreload",EQ=function(e){return"/"+e},u6={},Zi=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=u;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=EQ(d),d in u6)return;u6[d]=!0;const f=d.endsWith(".css"),g=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${g}`))return;const p=document.createElement("link");if(p.rel=f?"stylesheet":TQ,f||(p.as="script"),p.crossOrigin="",p.href=d,c&&p.setAttribute("nonce",c),document.head.appendChild(p),f)return new Promise((x,v)=>{p.addEventListener("load",x),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var e_={exports:{}},nx={},BS={},$S={},d6;function tn(){return d6||(d6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof c_<"u"?c_:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})($S)),$S}var US={},f6;function Bs(){return f6||(f6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=tn();class r{constructor(N=[1,0,0,1,0,0]){this.dirty=!1,this.m=N&&N.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(N){N.m[0]=this.m[0],N.m[1]=this.m[1],N.m[2]=this.m[2],N.m[3]=this.m[3],N.m[4]=this.m[4],N.m[5]=this.m[5]}point(N){const E=this.m;return{x:E[0]*N.x+E[2]*N.y+E[4],y:E[1]*N.x+E[3]*N.y+E[5]}}translate(N,E){return this.m[4]+=this.m[0]*N+this.m[2]*E,this.m[5]+=this.m[1]*N+this.m[3]*E,this}scale(N,E){return this.m[0]*=N,this.m[1]*=N,this.m[2]*=E,this.m[3]*=E,this}rotate(N){const E=Math.cos(N),P=Math.sin(N),F=this.m[0]*E+this.m[2]*P,A=this.m[1]*E+this.m[3]*P,j=this.m[0]*-P+this.m[2]*E,I=this.m[1]*-P+this.m[3]*E;return this.m[0]=F,this.m[1]=A,this.m[2]=j,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(N,E){const P=this.m[0]+this.m[2]*E,F=this.m[1]+this.m[3]*E,A=this.m[2]+this.m[0]*N,j=this.m[3]+this.m[1]*N;return this.m[0]=P,this.m[1]=F,this.m[2]=A,this.m[3]=j,this}multiply(N){const E=this.m[0]*N.m[0]+this.m[2]*N.m[1],P=this.m[1]*N.m[0]+this.m[3]*N.m[1],F=this.m[0]*N.m[2]+this.m[2]*N.m[3],A=this.m[1]*N.m[2]+this.m[3]*N.m[3],j=this.m[0]*N.m[4]+this.m[2]*N.m[5]+this.m[4],I=this.m[1]*N.m[4]+this.m[3]*N.m[5]+this.m[5];return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=I,this}invert(){const N=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),E=this.m[3]*N,P=-this.m[1]*N,F=-this.m[2]*N,A=this.m[0]*N,j=N*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=N*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=E,this.m[1]=P,this.m[2]=F,this.m[3]=A,this.m[4]=j,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const N=this.m[0],E=this.m[1],P=this.m[2],F=this.m[3],A=this.m[4],j=this.m[5],I=N*F-E*P,L={x:A,y:j,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(N!=0||E!=0){const Y=Math.sqrt(N*N+E*E);L.rotation=E>0?Math.acos(N/Y):-Math.acos(N/Y),L.scaleX=Y,L.scaleY=I/Y,L.skewX=(N*P+E*F)/I,L.skewY=0}else if(P!=0||F!=0){const Y=Math.sqrt(P*P+F*F);L.rotation=Math.PI/2-(F>0?Math.acos(-P/Y):-Math.acos(P/Y)),L.scaleX=I/Y,L.scaleY=Y,L.skewX=0,L.skewY=(N*P+E*F)/I}return L.rotation=e.Util._getRotation(L.rotation),L}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,c=180/Math.PI,u="#",d="",f="0",g="Konva warning: ",p="Konva error: ",x="rgb(",v={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},w=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};e.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===n},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===a},_isBoolean(_){return Object.prototype.toString.call(_)===i},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;const N=_[0];return N==="#"||N==="."||N===N.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){C.push(_),C.length===1&&k(function(){const N=C;C=[],N.forEach(function(E){E()})})},createCanvasElement(){const _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,N){const E=e.Util.createImageElement();E.onload=function(){N(E)},E.src=_},_rgbToHex(_,N,E){return((1<<24)+(_<<16)+(N<<8)+E).toString(16).slice(1)},_hexToRgb(_){_=_.replace(u,d);const N=parseInt(_,16);return{r:N>>16&255,g:N>>8&255,b:N&255}},getRandomColor(){let _=(Math.random()*16777215<<0).toString(16);for(;_.length<6;)_=f+_;return u+_},getRGB(_){let N;return _ in v?(N=v[_],{r:N[0],g:N[1],b:N[2]}):_[0]===u?this._hexToRgb(_.substring(1)):_.substr(0,4)===x?(N=w.exec(_.replace(/ /g,"")),{r:parseInt(N[1],10),g:parseInt(N[2],10),b:parseInt(N[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",e.Util._namedColorToRBA(_)||e.Util._hex3ColorToRGBA(_)||e.Util._hex4ColorToRGBA(_)||e.Util._hex6ColorToRGBA(_)||e.Util._hex8ColorToRGBA(_)||e.Util._rgbColorToRGBA(_)||e.Util._rgbaColorToRGBA(_)||e.Util._hslColorToRGBA(_)},_namedColorToRBA(_){const N=v[_.toLowerCase()];return N?{r:N[0],g:N[1],b:N[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];const N=_.split(/ *, */).map(Number);return{r:N[0],g:N[1],b:N[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];const N=_.split(/ *, */).map((E,P)=>E.slice(-1)==="%"?P===3?parseInt(E)/100:parseInt(E)/100*255:Number(E));return{r:N[0],g:N[1],b:N[2],a:N[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[N,...E]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),P=Number(E[0])/360,F=Number(E[1])/100,A=Number(E[2])/100;let j,I,L;if(F===0)return L=A*255,{r:Math.round(L),g:Math.round(L),b:Math.round(L),a:1};A<.5?j=A*(1+F):j=A+F-A*F;const Y=2*A-j,Z=[0,0,0];for(let ae=0;ae<3;ae++)I=P+1/3*-(ae-1),I<0&&I++,I>1&&I--,6*I<1?L=Y+(j-Y)*6*I:2*I<1?L=j:3*I<2?L=Y+(j-Y)*(2/3-I)*6:L=Y,Z[ae]=L*255;return{r:Math.round(Z[0]),g:Math.round(Z[1]),b:Math.round(Z[2]),a:1}}},haveIntersection(_,N){return!(N.x>_.x+_.width||N.x+N.width<_.x||N.y>_.y+_.height||N.y+N.height<_.y)},cloneObject(_){const N={};for(const E in _)this._isPlainObject(_[E])?N[E]=this.cloneObject(_[E]):this._isArray(_[E])?N[E]=this.cloneArray(_[E]):N[E]=_[E];return N},cloneArray(_){return _.slice(0)},degToRad(_){return _*o},radToDeg(_){return _*c},_degToRad(_){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(_)},_radToDeg(_){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(_)},_getRotation(_){return t.Konva.angleDeg?e.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(p+_)},error(_){console.error(p+_)},warn(_){t.Konva.showWarnings&&console.warn(g+_)},each(_,N){for(const E in _)N(E,_[E])},_inRange(_,N,E){return N<=_&&_<E},_getProjectionToSegment(_,N,E,P,F,A){let j,I,L;const Y=(_-E)*(_-E)+(N-P)*(N-P);if(Y==0)j=_,I=N,L=(F-E)*(F-E)+(A-P)*(A-P);else{const Z=((F-_)*(E-_)+(A-N)*(P-N))/Y;Z<0?(j=_,I=N,L=(_-F)*(_-F)+(N-A)*(N-A)):Z>1?(j=E,I=P,L=(E-F)*(E-F)+(P-A)*(P-A)):(j=_+Z*(E-_),I=N+Z*(P-N),L=(j-F)*(j-F)+(I-A)*(I-A))}return[j,I,L]},_getProjectionToLine(_,N,E){const P=e.Util.cloneObject(_);let F=Number.MAX_VALUE;return N.forEach(function(A,j){if(!E&&j===N.length-1)return;const I=N[(j+1)%N.length],L=e.Util._getProjectionToSegment(A.x,A.y,I.x,I.y,_.x,_.y),Y=L[0],Z=L[1],ae=L[2];ae<F&&(P.x=Y,P.y=Z,F=ae)}),P},_prepareArrayForTween(_,N,E){const P=[],F=[];if(_.length>N.length){const j=N;N=_,_=j}for(let j=0;j<_.length;j+=2)P.push({x:_[j],y:_[j+1]});for(let j=0;j<N.length;j+=2)F.push({x:N[j],y:N[j+1]});const A=[];return F.forEach(function(j){const I=e.Util._getProjectionToLine(j,P,E);A.push(I.x),A.push(I.y)}),A},_prepareToStringify(_){let N;_.visitedByCircularReferenceRemoval=!0;for(const E in _)if(_.hasOwnProperty(E)&&_[E]&&typeof _[E]=="object"){if(N=Object.getOwnPropertyDescriptor(_,E),_[E].visitedByCircularReferenceRemoval||e.Util._isElement(_[E]))if(N.configurable)delete _[E];else return null;else if(e.Util._prepareToStringify(_[E])===null)if(N.configurable)delete _[E];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,N){for(const E in N)_[E]=N[E];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){t.Konva.releaseCanvasOnDestroy&&_.forEach(N=>{N.width=0,N.height=0})},drawRoundedRectPath(_,N,E,P){let F=0,A=0,j=0,I=0;typeof P=="number"?F=A=j=I=Math.min(P,N/2,E/2):(F=Math.min(P[0]||0,N/2,E/2),A=Math.min(P[1]||0,N/2,E/2),I=Math.min(P[2]||0,N/2,E/2),j=Math.min(P[3]||0,N/2,E/2)),_.moveTo(F,0),_.lineTo(N-A,0),_.arc(N-A,A,A,Math.PI*3/2,0,!1),_.lineTo(N,E-I),_.arc(N-I,E-I,I,0,Math.PI/2,!1),_.lineTo(j,E),_.arc(j,E-j,j,Math.PI/2,Math.PI,!1),_.lineTo(0,F),_.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(US)),US}var sx={},Pu={},Fu={},h6;function fL(){if(h6)return Fu;h6=1,Object.defineProperty(Fu,"__esModule",{value:!0}),Fu.HitContext=Fu.SceneContext=Fu.Context=void 0;const e=Bs(),t=tn();function r(C){const k=[],_=C.length,N=e.Util;for(let E=0;E<_;E++){let P=C[E];N._isNumber(P)?P=Math.round(P*1e3)/1e3:N._isString(P)||(P=P+""),k.push(P)}return k}const n=",",s="(",a=")",i="([",o="])",c=";",u="()",d="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],p=100;let x=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,_){let N=this.traceArr,E=N.length,P="",F,A,j,I;for(F=0;F<E;F++)A=N[F],j=A.method,j?(I=A.args,P+=j,k?P+=u:e.Util._isArray(I[0])?P+=i+I.join(n)+o:(_&&(I=I.map(L=>typeof L=="number"?Math.floor(L):L)),P+=s+I.join(n)+a)):(P+=A.property,k||(P+=d+A.val)),P+=c;return P}clearTrace(){this.traceArr=[]}_trace(k){let _=this.traceArr,N;_.push(k),N=_.length,N>=p&&_.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const _=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(k){const _=k.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(k){const _=k.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(k){const _=k.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(k,_){this._context[k]=_}arc(k,_,N,E,P,F){this._context.arc(k,_,N,E,P,F)}arcTo(k,_,N,E,P){this._context.arcTo(k,_,N,E,P)}beginPath(){this._context.beginPath()}bezierCurveTo(k,_,N,E,P,F){this._context.bezierCurveTo(k,_,N,E,P,F)}clearRect(k,_,N,E){this._context.clearRect(k,_,N,E)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,_){const N=arguments;if(N.length===2)return this._context.createImageData(k,_);if(N.length===1)return this._context.createImageData(k)}createLinearGradient(k,_,N,E){return this._context.createLinearGradient(k,_,N,E)}createPattern(k,_){return this._context.createPattern(k,_)}createRadialGradient(k,_,N,E,P,F){return this._context.createRadialGradient(k,_,N,E,P,F)}drawImage(k,_,N,E,P,F,A,j,I){const L=arguments,Y=this._context;L.length===3?Y.drawImage(k,_,N):L.length===5?Y.drawImage(k,_,N,E,P):L.length===9&&Y.drawImage(k,_,N,E,P,F,A,j,I)}ellipse(k,_,N,E,P,F,A,j){this._context.ellipse(k,_,N,E,P,F,A,j)}isPointInPath(k,_,N,E){return N?this._context.isPointInPath(N,k,_,E):this._context.isPointInPath(k,_,E)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,_,N,E){this._context.fillRect(k,_,N,E)}strokeRect(k,_,N,E){this._context.strokeRect(k,_,N,E)}fillText(k,_,N,E){E?this._context.fillText(k,_,N,E):this._context.fillText(k,_,N)}measureText(k){return this._context.measureText(k)}getImageData(k,_,N,E){return this._context.getImageData(k,_,N,E)}lineTo(k,_){this._context.lineTo(k,_)}moveTo(k,_){this._context.moveTo(k,_)}rect(k,_,N,E){this._context.rect(k,_,N,E)}roundRect(k,_,N,E,P){this._context.roundRect(k,_,N,E,P)}putImageData(k,_,N){this._context.putImageData(k,_,N)}quadraticCurveTo(k,_,N,E){this._context.quadraticCurveTo(k,_,N,E)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,_){this._context.scale(k,_)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,_,N,E,P,F){this._context.setTransform(k,_,N,E,P,F)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,_,N,E){this._context.strokeText(k,_,N,E)}transform(k,_,N,E,P,F){this._context.transform(k,_,N,E,P,F)}translate(k,_){this._context.translate(k,_)}_enableTrace(){let k=this,_=f.length,N=this.setAttr,E,P;const F=function(A){let j=k[A],I;k[A]=function(){return P=r(Array.prototype.slice.call(arguments,0)),I=j.apply(k,arguments),k._trace({method:A,args:P}),I}};for(E=0;E<_;E++)F(f[E]);k.setAttr=function(){N.apply(k,arguments);const A=arguments[0];let j=arguments[1];(A==="shadowOffsetX"||A==="shadowOffsetY"||A==="shadowBlur")&&(j=j/this.canvas.getPixelRatio()),k._trace({property:A,val:j})}}_applyGlobalCompositeOperation(k){const _=k.attrs.globalCompositeOperation;!_||_==="source-over"||this.setAttr("globalCompositeOperation",_)}};Fu.Context=x,g.forEach(function(C){Object.defineProperty(x.prototype,C,{get(){return this._context[C]},set(k){this._context[C]=k}})});class v extends x{constructor(k,{willReadFrequently:_=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(k){const _=k.fill();this.setAttr("fillStyle",_),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const _=k._getLinearGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fillRadialGradient(k){const _=k._getRadialGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fill(k){const _=k.fill(),N=k.getFillPriority();if(_&&N==="color"){this._fillColor(k);return}const E=k.getFillPatternImage();if(E&&N==="pattern"){this._fillPattern(k);return}const P=k.getFillLinearGradientColorStops();if(P&&N==="linear-gradient"){this._fillLinearGradient(k);return}const F=k.getFillRadialGradientColorStops();if(F&&N==="radial-gradient"){this._fillRadialGradient(k);return}_?this._fillColor(k):E?this._fillPattern(k):P?this._fillLinearGradient(k):F&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const _=k.getStrokeLinearGradientStartPoint(),N=k.getStrokeLinearGradientEndPoint(),E=k.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(_.x,_.y,N.x,N.y);if(E){for(let F=0;F<E.length;F+=2)P.addColorStop(E[F],E[F+1]);this.setAttr("strokeStyle",P)}}_stroke(k){const _=k.dash(),N=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!N){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k),_&&k.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),N||this.restore()}}_applyShadow(k){var _,N,E;const P=(_=k.getShadowRGBA())!==null&&_!==void 0?_:"black",F=(N=k.getShadowBlur())!==null&&N!==void 0?N:5,A=(E=k.getShadowOffset())!==null&&E!==void 0?E:{x:0,y:0},j=k.getAbsoluteScale(),I=this.canvas.getPixelRatio(),L=j.x*I,Y=j.y*I;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",F*Math.min(Math.abs(L),Math.abs(Y))),this.setAttr("shadowOffsetX",A.x*L),this.setAttr("shadowOffsetY",A.y*Y)}}Fu.SceneContext=v;class w extends x{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const _=k.getStrokeScaleEnabled();if(!_){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k);const N=k.hitStrokeWidth(),E=N==="auto"?k.strokeWidth():N;this.setAttr("lineWidth",E),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),_||this.restore()}}}return Fu.HitContext=w,Fu}var g6;function Mb(){if(g6)return Pu;g6=1,Object.defineProperty(Pu,"__esModule",{value:!0}),Pu.HitCanvas=Pu.SceneCanvas=Pu.Canvas=void 0;const e=Bs(),t=fL(),r=tn();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),u=c.getContext("2d");return n=(function(){const d=r.Konva._global.devicePixelRatio||1,f=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return d/f})(),e.Util.releaseCanvas(c),n}let a=class{constructor(u){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const f=(u||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=f,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(u){const d=this.pixelRatio;this.pixelRatio=u,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(u){this.width=this._canvas.width=u*this.pixelRatio,this._canvas.style.width=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(u){this.height=this._canvas.height=u*this.pixelRatio,this._canvas.style.height=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(u,d){this.setWidth(u||0),this.setHeight(d||0)}toDataURL(u,d){try{return this._canvas.toDataURL(u,d)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Pu.Canvas=a;class i extends a{constructor(u={width:0,height:0,willReadFrequently:!1}){super(u),this.context=new t.SceneContext(this,{willReadFrequently:u.willReadFrequently}),this.setSize(u.width,u.height)}}Pu.SceneCanvas=i;class o extends a{constructor(u={width:0,height:0}){super(u),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(u.width,u.height)}}return Pu.HitCanvas=o,Pu}var zS={},m6;function XN(){return m6||(m6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=tn(),r=Bs();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,c=o.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=c._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(zS)),zS}var WS={},xo={},p6;function dn(){if(p6)return xo;p6=1,Object.defineProperty(xo,"__esModule",{value:!0}),xo.RGBComponent=n,xo.alphaComponent=s,xo.getNumberValidator=a,xo.getNumberOrArrayOfNumbersValidator=i,xo.getNumberOrAutoValidator=o,xo.getStringValidator=c,xo.getStringOrGradientValidator=u,xo.getFunctionValidator=d,xo.getNumberArrayValidator=f,xo.getBooleanValidator=g,xo.getComponentValidator=p;const e=tn(),t=Bs();function r(x){return t.Util._isString(x)?'"'+x+'"':Object.prototype.toString.call(x)==="[object Number]"||t.Util._isBoolean(x)?x:Object.prototype.toString.call(x)}function n(x){return x>255?255:x<0?0:Math.round(x)}function s(x){return x>1?1:x<1e-4?1e-4:x}function a(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number.'),x}}function i(x){if(e.Konva.isUnminified)return function(v,w){let C=t.Util._isNumber(v),k=t.Util._isArray(v)&&v.length==x;return!C&&!k&&t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or Array<number>('+x+")"),v}}function o(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isNumber(x)||x==="auto"||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number or "auto".'),x}}function c(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isString(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string.'),x}}function u(){if(e.Konva.isUnminified)return function(x,v){const w=t.Util._isString(x),C=Object.prototype.toString.call(x)==="[object CanvasGradient]"||x&&x.addColorStop;return w||C||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a string or a native gradient.'),x}}function d(){if(e.Konva.isUnminified)return function(x,v){return t.Util._isFunction(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a function.'),x}}function f(){if(e.Konva.isUnminified)return function(x,v){const w=Int8Array?Object.getPrototypeOf(Int8Array):null;return w&&x instanceof w||(t.Util._isArray(x)?x.forEach(function(C){t.Util._isNumber(C)||t.Util.warn('"'+v+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a array of numbers.')),x}}function g(){if(e.Konva.isUnminified)return function(x,v){return x===!0||x===!1||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a boolean.'),x}}function p(x){if(e.Konva.isUnminified)return function(v,w){return v==null||t.Util.isObject(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be an object with properties '+x),v}}return xo}var x6;function ln(){return x6||(x6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=Bs(),r=dn(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,c,u){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,c,u),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]||e.Factory.overWriteSetter(a,i,o,c)},overWriteSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),c&&c.call(this),this}},addComponentsGetterSetter(a,i,o,c,u){const d=o.length,f=t.Util._capitalize,g=n+f(i),p=s+f(i);a.prototype[g]=function(){const v={};for(let w=0;w<d;w++){const C=o[w];v[C]=this.getAttr(i+f(C))}return v};const x=(0,r.getComponentValidator)(o);a.prototype[p]=function(v){const w=this.attrs[i];c&&(v=c.call(this,v,i)),x&&x.call(this,v,i);for(const C in v)v.hasOwnProperty(C)&&this._setAttr(i+f(C),v[C]);return v||o.forEach(C=>{this._setAttr(i+f(C),void 0)}),this._fireChangeEvent(i,w,v),u&&u.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),c=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,c){t.Util.error("Adding deprecated "+i);const u=n+t.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){t.Util.error(d);const f=this.attrs[i];return f===void 0?o:f},e.Factory.addSetter(a,i,c,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,c){const u=a.prototype[c],d=n+t.Util._capitalize(o),f=s+t.Util._capitalize(o);function g(){u.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[o]=g,a.prototype[d]=g,a.prototype[f]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(WS)),WS}var y6;function Js(){if(y6)return sx;y6=1,Object.defineProperty(sx,"__esModule",{value:!0}),sx.Node=void 0;const e=Mb(),t=XN(),r=ln(),n=tn(),s=Bs(),a=dn(),i="absoluteOpacity",o="allEventListeners",c="absoluteTransform",u="absoluteScale",d="canvas",f="Change",g="children",p="konva",x="listening",v="mouseenter",w="mouseleave",C="pointerenter",k="pointerleave",_="touchenter",N="touchleave",E="set",P="Shape",F=" ",A="stage",j="transform",I="Stage",L="visible",Y=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(F);let Z=1,ae=class jT{constructor(B){this._id=Z++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(B),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(B){(B===j||B===c)&&this._cache.get(B)?this._cache.get(B).dirty=!0:B?this._cache.delete(B):this._cache.clear()}_getCache(B,V){let M=this._cache.get(B);return(M===void 0||(B===j||B===c)&&M.dirty===!0)&&(M=V.call(this),this._cache.set(B,M)),M}_calculate(B,V,M){if(!this._attachedDepsListeners.get(B)){const H=V.map(W=>W+"Change.konva").join(F);this.on(H,()=>{this._clearCache(B)}),this._attachedDepsListeners.set(B,!0)}return this._getCache(B,M)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(B){this._clearCache(B),B===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:B,filter:V,hit:M,buffer:H}=this._cache.get(d);s.Util.releaseCanvas(B,V,M,H),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(B){const V=B||{};let M={};(V.x===void 0||V.y===void 0||V.width===void 0||V.height===void 0)&&(M=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let H=Math.ceil(V.width||M.width),W=Math.ceil(V.height||M.height),R=V.pixelRatio,z=V.x===void 0?Math.floor(M.x):V.x,K=V.y===void 0?Math.floor(M.y):V.y,J=V.offset||0,se=V.drawBorder||!1,X=V.hitCanvasPixelRatio||1;if(!H||!W){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ie=Math.abs(Math.round(M.x)-z)>.5?1:0,le=Math.abs(Math.round(M.y)-K)>.5?1:0;H+=J*2+ie,W+=J*2+le,z-=J,K-=J;const ce=new e.SceneCanvas({pixelRatio:R,width:H,height:W}),be=new e.SceneCanvas({pixelRatio:R,width:0,height:0,willReadFrequently:!0}),re=new e.HitCanvas({pixelRatio:X,width:H,height:W}),pe=ce.getContext(),Ce=re.getContext(),Ae=new e.SceneCanvas({width:ce.width/ce.pixelRatio+Math.abs(z),height:ce.height/ce.pixelRatio+Math.abs(K),pixelRatio:ce.pixelRatio}),We=Ae.getContext();return re.isCache=!0,ce.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,V.imageSmoothingEnabled===!1&&(ce.getContext()._context.imageSmoothingEnabled=!1,be.getContext()._context.imageSmoothingEnabled=!1),pe.save(),Ce.save(),We.save(),pe.translate(-z,-K),Ce.translate(-z,-K),We.translate(-z,-K),Ae.x=z,Ae.y=K,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this.drawScene(ce,this,Ae),this.drawHit(re,this),this._isUnderCache=!1,pe.restore(),Ce.restore(),se&&(pe.save(),pe.beginPath(),pe.rect(0,0,H,W),pe.closePath(),pe.setAttr("strokeStyle","red"),pe.setAttr("lineWidth",5),pe.stroke(),pe.restore()),this._cache.set(d,{scene:ce,filter:be,hit:re,buffer:Ae,x:z,y:K}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(B){throw new Error('abstract "getClientRect" method call')}_transformedRect(B,V){const M=[{x:B.x,y:B.y},{x:B.x+B.width,y:B.y},{x:B.x+B.width,y:B.y+B.height},{x:B.x,y:B.y+B.height}];let H=1/0,W=1/0,R=-1/0,z=-1/0;const K=this.getAbsoluteTransform(V);return M.forEach(function(J){const se=K.point(J);H===void 0&&(H=R=se.x,W=z=se.y),H=Math.min(H,se.x),W=Math.min(W,se.y),R=Math.max(R,se.x),z=Math.max(z,se.y)}),{x:H,y:W,width:R-H,height:z-W}}_drawCachedSceneCanvas(B){B.save(),B._applyOpacity(this),B._applyGlobalCompositeOperation(this);const V=this._getCanvasCache();B.translate(V.x,V.y);const M=this._getCachedSceneCanvas(),H=M.pixelRatio;B.drawImage(M._canvas,0,0,M.width/H,M.height/H),B.restore()}_drawCachedHitCanvas(B){const V=this._getCanvasCache(),M=V.hit;B.save(),B.translate(V.x,V.y),B.drawImage(M._canvas,0,0,M.width/M.pixelRatio,M.height/M.pixelRatio),B.restore()}_getCachedSceneCanvas(){let B=this.filters(),V=this._getCanvasCache(),M=V.scene,H=V.filter,W=H.getContext(),R,z,K,J;if(B){if(!this._filterUpToDate){const se=M.pixelRatio;H.setSize(M.width/M.pixelRatio,M.height/M.pixelRatio);try{for(R=B.length,W.clear(),W.drawImage(M._canvas,0,0,M.getWidth()/se,M.getHeight()/se),z=W.getImageData(0,0,H.getWidth(),H.getHeight()),K=0;K<R;K++){if(J=B[K],typeof J!="function"){s.Util.error("Filter should be type of function, but got "+typeof J+" instead. Please check correct filters");continue}J.call(this,z),W.putImageData(z,0,0)}}catch(X){s.Util.error("Unable to apply filter. "+X.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return H}return M}on(B,V){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const M=B.split(F);for(let H=0;H<M.length;H++){const R=M[H].split("."),z=R[0],K=R[1]||"";this.eventListeners[z]||(this.eventListeners[z]=[]),this.eventListeners[z].push({name:K,handler:V})}return this}off(B,V){let M=(B||"").split(F),H=M.length,W,R,z,K,J,se;if(this._cache&&this._cache.delete(o),!B)for(R in this.eventListeners)this._off(R);for(W=0;W<H;W++)if(z=M[W],K=z.split("."),J=K[0],se=K[1],J)this.eventListeners[J]&&this._off(J,se,V);else for(R in this.eventListeners)this._off(R,se,V);return this}dispatchEvent(B){const V={target:this,type:B.type,evt:B};return this.fire(B.type,V),this}addEventListener(B,V){return this.on(B,function(M){V.call(this,M.evt)}),this}removeEventListener(B){return this.off(B),this}_delegate(B,V,M){const H=this;this.on(B,function(W){const R=W.target.findAncestors(V,!0,H);for(let z=0;z<R.length;z++)W=s.Util.cloneObject(W),W.currentTarget=R[z],M.call(R[z],W)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(A),this._clearSelfAndDescendantCache(L),this._clearSelfAndDescendantCache(x)}_remove(){this._clearCaches();const B=this.getParent();B&&B.children&&(B.children.splice(this.index,1),B._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(B){const V="get"+s.Util._capitalize(B);return s.Util._isFunction(this[V])?this[V]():this.attrs[B]}getAncestors(){let B=this.getParent(),V=[];for(;B;)V.push(B),B=B.getParent();return V}getAttrs(){return this.attrs||{}}setAttrs(B){return this._batchTransformChanges(()=>{let V,M;if(!B)return this;for(V in B)V!==g&&(M=E+s.Util._capitalize(V),s.Util._isFunction(this[M])?this[M](B[V]):this._setAttr(V,B[V]))}),this}isListening(){return this._getCache(x,this._isListening)}_isListening(B){if(!this.listening())return!1;const M=this.getParent();return M&&M!==B&&this!==B?M._isListening(B):!0}isVisible(){return this._getCache(L,this._isVisible)}_isVisible(B){if(!this.visible())return!1;const M=this.getParent();return M&&M!==B&&this!==B?M._isVisible(B):!0}shouldDrawHit(B,V=!1){if(B)return this._isVisible(B)&&this._isListening(B);const M=this.getLayer();let H=!1;t.DD._dragElements.forEach(R=>{R.dragStatus==="dragging"&&(R.node.nodeType==="Stage"||R.node.getLayer()===M)&&(H=!0)});const W=!V&&!n.Konva.hitOnDragEnabled&&(H||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!W}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let B=this.getDepth(),V=this,M=0,H,W,R,z;function K(se){for(H=[],W=se.length,R=0;R<W;R++)z=se[R],M++,z.nodeType!==P&&(H=H.concat(z.getChildren().slice())),z._id===V._id&&(R=W);H.length>0&&H[0].getDepth()<=B&&K(H)}const J=this.getStage();return V.nodeType!==I&&J&&K(J.getChildren()),M}getDepth(){let B=0,V=this.parent;for(;V;)B++,V=V.parent;return B}_batchTransformChanges(B){this._batchingTransformChange=!0,B(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(j),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(B){return this._batchTransformChanges(()=>{this.x(B.x),this.y(B.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const B=this.getStage();if(!B)return null;const V=B.getPointerPosition();if(!V)return null;const M=this.getAbsoluteTransform().copy();return M.invert(),M.point(V)}getAbsolutePosition(B){let V=!1,M=this.parent;for(;M;){if(M.isCached()){V=!0;break}M=M.parent}V&&!B&&(B=!0);const H=this.getAbsoluteTransform(B).getMatrix(),W=new s.Transform,R=this.offset();return W.m=H.slice(),W.translate(R.x,R.y),W.getTranslation()}setAbsolutePosition(B){const{x:V,y:M,...H}=this._clearTransform();this.attrs.x=V,this.attrs.y=M,this._clearCache(j);const W=this._getAbsoluteTransform().copy();return W.invert(),W.translate(B.x,B.y),B={x:this.attrs.x+W.getTranslation().x,y:this.attrs.y+W.getTranslation().y},this._setTransform(H),this.setPosition({x:B.x,y:B.y}),this._clearCache(j),this._clearSelfAndDescendantCache(c),this}_setTransform(B){let V;for(V in B)this.attrs[V]=B[V]}_clearTransform(){const B={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,B}move(B){let V=B.x,M=B.y,H=this.x(),W=this.y();return V!==void 0&&(H+=V),M!==void 0&&(W+=M),this.setPosition({x:H,y:W}),this}_eachAncestorReverse(B,V){let M=[],H=this.getParent(),W,R;if(!(V&&V._id===this._id)){for(M.unshift(this);H&&(!V||H._id!==V._id);)M.unshift(H),H=H.parent;for(W=M.length,R=0;R<W;R++)B(M[R])}}rotate(B){return this.rotation(this.rotation()+B),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const B=this.index,V=this.parent.getChildren().length;return B<V-1?(this.parent.children.splice(B,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const B=this.index,V=this.parent.getChildren().length;return B<V-1?(this.parent.children.splice(B,1),this.parent.children.splice(B+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const B=this.index;return B>0?(this.parent.children.splice(B,1),this.parent.children.splice(B-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const B=this.index;return B>0?(this.parent.children.splice(B,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(B){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(B<0||B>=this.parent.children.length)&&s.Util.warn("Unexpected value "+B+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const V=this.index;return this.parent.children.splice(V,1),this.parent.children.splice(B,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let B=this.opacity();const V=this.getParent();return V&&!V._isUnderCache&&(B*=V.getAbsoluteOpacity()),B}moveTo(B){return this.getParent()!==B&&(this._remove(),B.add(this)),this}toObject(){let B=this.getAttrs(),V,M,H,W,R;const z={attrs:{},className:this.getClassName()};for(V in B)M=B[V],R=s.Util.isObject(M)&&!s.Util._isPlainObject(M)&&!s.Util._isArray(M),!R&&(H=typeof this[V]=="function"&&this[V],delete B[V],W=H?H.call(this):null,B[V]=M,W!==M&&(z.attrs[V]=M));return s.Util._prepareToStringify(z)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(B,V,M){const H=[];V&&this._isMatch(B)&&H.push(this);let W=this.parent;for(;W;){if(W===M)return H;W._isMatch(B)&&H.push(W),W=W.parent}return H}isAncestorOf(B){return!1}findAncestor(B,V,M){return this.findAncestors(B,V,M)[0]}_isMatch(B){if(!B)return!1;if(typeof B=="function")return B(this);let V=B.replace(/ /g,"").split(","),M=V.length,H,W;for(H=0;H<M;H++)if(W=V[H],s.Util.isValidSelector(W)||(s.Util.warn('Selector "'+W+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),W.charAt(0)==="#"){if(this.id()===W.slice(1))return!0}else if(W.charAt(0)==="."){if(this.hasName(W.slice(1)))return!0}else if(this.className===W||this.nodeType===W)return!0;return!1}getLayer(){const B=this.getParent();return B?B.getLayer():null}getStage(){return this._getCache(A,this._getStage)}_getStage(){const B=this.getParent();return B?B.getStage():null}fire(B,V={},M){return V.target=V.target||this,M?this._fireAndBubble(B,V):this._fire(B,V),this}getAbsoluteTransform(B){return B?this._getAbsoluteTransform(B):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(B){let V;if(B)return V=new s.Transform,this._eachAncestorReverse(function(M){const H=M.transformsEnabled();H==="all"?V.multiply(M.getTransform()):H==="position"&&V.translate(M.x()-M.offsetX(),M.y()-M.offsetY())},B),V;{V=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(V):V.reset();const M=this.transformsEnabled();if(M==="all")V.multiply(this.getTransform());else if(M==="position"){const H=this.attrs.x||0,W=this.attrs.y||0,R=this.attrs.offsetX||0,z=this.attrs.offsetY||0;V.translate(H-R,W-z)}return V.dirty=!1,V}}getAbsoluteScale(B){let V=this;for(;V;)V._isUnderCache&&(B=V),V=V.getParent();const H=this.getAbsoluteTransform(B).decompose();return{x:H.scaleX,y:H.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(j,this._getTransform)}_getTransform(){var B,V;const M=this._cache.get(j)||new s.Transform;M.reset();const H=this.x(),W=this.y(),R=n.Konva.getAngle(this.rotation()),z=(B=this.attrs.scaleX)!==null&&B!==void 0?B:1,K=(V=this.attrs.scaleY)!==null&&V!==void 0?V:1,J=this.attrs.skewX||0,se=this.attrs.skewY||0,X=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;return(H!==0||W!==0)&&M.translate(H,W),R!==0&&M.rotate(R),(J!==0||se!==0)&&M.skew(J,se),(z!==1||K!==1)&&M.scale(z,K),(X!==0||ie!==0)&&M.translate(-1*X,-1*ie),M.dirty=!1,M}clone(B){let V=s.Util.cloneObject(this.attrs),M,H,W,R,z;for(M in B)V[M]=B[M];const K=new this.constructor(V);for(M in this.eventListeners)for(H=this.eventListeners[M],W=H.length,R=0;R<W;R++)z=H[R],z.name.indexOf(p)<0&&(K.eventListeners[M]||(K.eventListeners[M]=[]),K.eventListeners[M].push(z));return K}_toKonvaCanvas(B){B=B||{};const V=this.getClientRect(),M=this.getStage(),H=B.x!==void 0?B.x:Math.floor(V.x),W=B.y!==void 0?B.y:Math.floor(V.y),R=B.pixelRatio||1,z=new e.SceneCanvas({width:B.width||Math.ceil(V.width)||(M?M.width():0),height:B.height||Math.ceil(V.height)||(M?M.height():0),pixelRatio:R}),K=z.getContext(),J=new e.SceneCanvas({width:z.width/z.pixelRatio+Math.abs(H),height:z.height/z.pixelRatio+Math.abs(W),pixelRatio:z.pixelRatio});return B.imageSmoothingEnabled===!1&&(K._context.imageSmoothingEnabled=!1),K.save(),(H||W)&&K.translate(-1*H,-1*W),this.drawScene(z,void 0,J),K.restore(),z}toCanvas(B){return this._toKonvaCanvas(B)._canvas}toDataURL(B){B=B||{};const V=B.mimeType||null,M=B.quality||null,H=this._toKonvaCanvas(B).toDataURL(V,M);return B.callback&&B.callback(H),H}toImage(B){return new Promise((V,M)=>{try{const H=B?.callback;H&&delete B.callback,s.Util._urlToImage(this.toDataURL(B),function(W){V(W),H?.(W)})}catch(H){M(H)}})}toBlob(B){return new Promise((V,M)=>{try{const H=B?.callback;H&&delete B.callback,this.toCanvas(B).toBlob(W=>{V(W),H?.(W)},B?.mimeType,B?.quality)}catch(H){M(H)}})}setSize(B){return this.width(B.width),this.height(B.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(B,V,M){let H=this.eventListeners[B],W,R,z;for(W=0;W<H.length;W++)if(R=H[W].name,z=H[W].handler,(R!=="konva"||V==="konva")&&(!V||R===V)&&(!M||M===z)){if(H.splice(W,1),H.length===0){delete this.eventListeners[B];break}W--}}_fireChangeEvent(B,V,M){this._fire(B+f,{oldVal:V,newVal:M})}addName(B){if(!this.hasName(B)){const V=this.name(),M=V?V+" "+B:B;this.name(M)}return this}hasName(B){if(!B)return!1;const V=this.name();return V?(V||"").split(/\s/g).indexOf(B)!==-1:!1}removeName(B){const V=(this.name()||"").split(/\s/g),M=V.indexOf(B);return M!==-1&&(V.splice(M,1),this.name(V.join(" "))),this}setAttr(B,V){const M=this[E+s.Util._capitalize(B)];return s.Util._isFunction(M)?M.call(this,V):this._setAttr(B,V),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const B=this.getLayer()||this.getStage();B?.batchDraw()}}_setAttr(B,V){const M=this.attrs[B];M===V&&!s.Util.isObject(V)||(V==null?delete this.attrs[B]:this.attrs[B]=V,this._shouldFireChangeEvents&&this._fireChangeEvent(B,M,V),this._requestDraw())}_setComponentAttr(B,V,M){let H;M!==void 0&&(H=this.attrs[B],H||(this.attrs[B]=this.getAttr(B)),this.attrs[B][V]=M,this._fireChangeEvent(B,H,M))}_fireAndBubble(B,V,M){V&&this.nodeType===P&&(V.target=this);const H=[v,w,C,k,_,N];if(!(H.indexOf(B)!==-1&&(M&&(this===M||this.isAncestorOf&&this.isAncestorOf(M))||this.nodeType==="Stage"&&!M))){this._fire(B,V);const R=H.indexOf(B)!==-1&&M&&M.isAncestorOf&&M.isAncestorOf(this)&&!M.isAncestorOf(this.parent);(V&&!V.cancelBubble||!V)&&this.parent&&this.parent.isListening()&&!R&&(M&&M.parent?this._fireAndBubble.call(this.parent,B,V,M):this._fireAndBubble.call(this.parent,B,V))}}_getProtoListeners(B){var V,M,H;const W=(V=this._cache.get(o))!==null&&V!==void 0?V:{};let R=W?.[B];if(R===void 0){R=[];let z=Object.getPrototypeOf(this);for(;z;){const K=(H=(M=z.eventListeners)===null||M===void 0?void 0:M[B])!==null&&H!==void 0?H:[];R.push(...K),z=Object.getPrototypeOf(z)}W[B]=R,this._cache.set(o,W)}return R}_fire(B,V){V=V||{},V.currentTarget=this,V.type=B;const M=this._getProtoListeners(B);if(M)for(let W=0;W<M.length;W++)M[W].handler.call(this,V);const H=this.eventListeners[B];if(H)for(let W=0;W<H.length;W++)H[W].handler.call(this,V)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(B){const V=B?B.pointerId:void 0,M=this.getStage(),H=this.getAbsolutePosition();if(!M)return;const W=M._getPointerById(V)||M._changedPointerPositions[0]||H;t.DD._dragElements.set(this._id,{node:this,startPointerPos:W,offset:{x:W.x-H.x,y:W.y-H.y},dragStatus:"ready",pointerId:V})}startDrag(B,V=!0){t.DD._dragElements.has(this._id)||this._createDragElement(B);const M=t.DD._dragElements.get(this._id);M.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:B&&B.evt},V)}_setDragPosition(B,V){const M=this.getStage()._getPointerById(V.pointerId);if(!M)return;let H={x:M.x-V.offset.x,y:M.y-V.offset.y};const W=this.dragBoundFunc();if(W!==void 0){const R=W.call(this,H,B);R?H=R:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==H.x||this._lastPos.y!==H.y)&&(this.setAbsolutePosition(H),this._requestDraw()),this._lastPos=H}stopDrag(B){const V=t.DD._dragElements.get(this._id);V&&(V.dragStatus="stopped"),t.DD._endDragBefore(B),t.DD._endDragAfter(B)}setDraggable(B){this._setAttr("draggable",B),this._dragChange()}isDragging(){const B=t.DD._dragElements.get(this._id);return B?B.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(B){if(!(!(B.evt.button!==void 0)||n.Konva.dragButtons.indexOf(B.evt.button)>=0)||this.isDragging())return;let H=!1;t.DD._dragElements.forEach(W=>{this.isAncestorOf(W.node)&&(H=!0)}),H||this._createDragElement(B)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const V=t.DD._dragElements.get(this._id),M=V&&V.dragStatus==="dragging",H=V&&V.dragStatus==="ready";M?this.stopDrag():H&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(B={x:0,y:0}){const V=this.getStage();if(!V)return!1;const M={x:-B.x,y:-B.y,width:V.width()+2*B.x,height:V.height()+2*B.y};return s.Util.haveIntersection(M,this.getClientRect())}static create(B,V){return s.Util._isString(B)&&(B=JSON.parse(B)),this._createNode(B,V)}static _createNode(B,V){let M=jT.prototype.getClassName.call(B),H=B.children,W,R,z;V&&(B.attrs.container=V),n.Konva[M]||(s.Util.warn('Can not find a node with class name "'+M+'". Fallback to "Shape".'),M="Shape");const K=n.Konva[M];if(W=new K(B.attrs),H)for(R=H.length,z=0;z<R;z++)W.add(jT._createNode(H[z]));return W}};sx.Node=ae,ae.prototype.nodeType="Node",ae.prototype._attrsAffectingSize=[],ae.prototype.eventListeners={},ae.prototype.on.call(ae.prototype,Y,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(j),this._clearSelfAndDescendantCache(c)}),ae.prototype.on.call(ae.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(L)}),ae.prototype.on.call(ae.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(x)}),ae.prototype.on.call(ae.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const ee=r.Factory.addGetterSetter;return ee(ae,"zIndex"),ee(ae,"absolutePosition"),ee(ae,"position"),ee(ae,"x",0,(0,a.getNumberValidator)()),ee(ae,"y",0,(0,a.getNumberValidator)()),ee(ae,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),ee(ae,"opacity",1,(0,a.getNumberValidator)()),ee(ae,"name","",(0,a.getStringValidator)()),ee(ae,"id","",(0,a.getStringValidator)()),ee(ae,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"scale",["x","y"]),ee(ae,"scaleX",1,(0,a.getNumberValidator)()),ee(ae,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"skew",["x","y"]),ee(ae,"skewX",0,(0,a.getNumberValidator)()),ee(ae,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(ae,"offset",["x","y"]),ee(ae,"offsetX",0,(0,a.getNumberValidator)()),ee(ae,"offsetY",0,(0,a.getNumberValidator)()),ee(ae,"dragDistance",void 0,(0,a.getNumberValidator)()),ee(ae,"width",0,(0,a.getNumberValidator)()),ee(ae,"height",0,(0,a.getNumberValidator)()),ee(ae,"listening",!0,(0,a.getBooleanValidator)()),ee(ae,"preventDefault",!0,(0,a.getBooleanValidator)()),ee(ae,"filters",void 0,function(ne){return this._filterUpToDate=!1,ne}),ee(ae,"visible",!0,(0,a.getBooleanValidator)()),ee(ae,"transformsEnabled","all",(0,a.getStringValidator)()),ee(ae,"size"),ee(ae,"dragBoundFunc"),ee(ae,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(ae,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),sx}var ax={},v6;function Lb(){if(v6)return ax;v6=1,Object.defineProperty(ax,"__esModule",{value:!0}),ax.Container=void 0;const e=ln(),t=Js(),r=dn();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(c=>{const u=c._isMatch(a);return u&&o.push(c),!!(u&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const c of o){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const c=this.getLayer(),u=a||c&&c.getCanvas(),d=u&&u.getContext(),f=this._getCanvasCache(),g=f&&f.scene,p=u&&u.isCache;if(!this.isVisible()&&!p)return this;if(g){d.save();const x=this.getAbsoluteTransform(i).getMatrix();d.transform(x[0],x[1],x[2],x[3],x[4],x[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",u,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),c=a||o&&o.hitCanvas,u=c&&c.getContext(),d=this._getCanvasCache();if(d&&d.hit){u.save();const g=this.getAbsoluteTransform(i).getMatrix();u.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,o,c){var u;const d=i&&i.getContext(),f=this.clipWidth(),g=this.clipHeight(),p=this.clipFunc(),x=typeof f=="number"&&typeof g=="number"||p,v=o===this;if(x){d.save();const C=this.getAbsoluteTransform(o);let k=C.getMatrix();d.transform(k[0],k[1],k[2],k[3],k[4],k[5]),d.beginPath();let _;if(p)_=p.call(this,d,this);else{const N=this.clipX(),E=this.clipY();d.rect(N||0,E||0,f,g)}d.clip.apply(d,_),k=C.copy().invert().getMatrix(),d.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const w=!v&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";w&&(d.save(),d._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(C){C[a](i,o,c)}),w&&d.restore(),x&&d.restore()}getClientRect(a={}){var i;const o=a.skipTransform,c=a.relativeTo;let u,d,f,g,p={x:1/0,y:1/0,width:0,height:0};const x=this;(i=this.children)===null||i===void 0||i.forEach(function(C){if(!C.visible())return;const k=C.getClientRect({relativeTo:x,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(u===void 0?(u=k.x,d=k.y,f=k.x+k.width,g=k.y+k.height):(u=Math.min(u,k.x),d=Math.min(d,k.y),f=Math.max(f,k.x+k.width),g=Math.max(g,k.y+k.height)))});const v=this.find("Shape");let w=!1;for(let C=0;C<v.length;C++)if(v[C]._isVisible(this)){w=!0;break}return w&&u!==void 0?p={x:u,y:d,width:f-u,height:g-d}:p={x:0,y:0,width:0,height:0},o?p:this._transformedRect(p,c)}};return ax.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),ax}var HS={},tf={},w6;function hL(){if(w6)return tf;w6=1,Object.defineProperty(tf,"__esModule",{value:!0}),tf.getCapturedShape=n,tf.createEvent=s,tf.hasPointerCapture=a,tf.setPointerCapture=i,tf.releaseCapture=o;const e=tn(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,u){return t.get(c)===u}function i(c,u){o(c),u.getStage()&&(t.set(c,u),r&&u._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(c,u){const d=t.get(c);if(!d)return;const f=d.getStage();f&&f.content,t.delete(c),r&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return tf}var _6;function NQ(){return _6||(_6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=Bs(),r=ln(),n=Lb(),s=tn(),a=Mb(),i=XN(),o=tn(),c=hL(),u="Stage",d="string",f="px",g="mouseout",p="mouseleave",x="mouseover",v="mouseenter",w="mousemove",C="mousedown",k="mouseup",_="pointermove",N="pointerdown",E="pointerup",P="pointercancel",F="lostpointercapture",A="pointerout",j="pointerleave",I="pointerover",L="pointerenter",Y="contextmenu",Z="touchstart",ae="touchend",ee="touchmove",ne="touchcancel",B="wheel",V=5,M=[[v,"_pointerenter"],[C,"_pointerdown"],[w,"_pointermove"],[k,"_pointerup"],[p,"_pointerleave"],[Z,"_pointerdown"],[ee,"_pointermove"],[ae,"_pointerup"],[ne,"_pointercancel"],[x,"_pointerover"],[B,"_wheel"],[Y,"_contextmenu"],[N,"_pointerdown"],[_,"_pointermove"],[E,"_pointerup"],[P,"_pointercancel"],[j,"_pointerleave"],[F,"_lostpointercapture"]],H={mouse:{[A]:g,[j]:p,[I]:x,[L]:v,[_]:w,[N]:C,[E]:k,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[A]:"touchout",[j]:"touchleave",[I]:"touchover",[L]:"touchenter",[_]:ee,[N]:Z,[E]:ae,[P]:ne,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[A]:A,[j]:j,[I]:I,[L]:L,[_]:_,[N]:N,[E]:E,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},W=se=>se.indexOf("pointer")>=0?"pointer":se.indexOf("touch")>=0?"touch":"mouse",R=se=>{const X=W(se);if(X==="pointer")return s.Konva.pointerEventsEnabled&&H.pointer;if(X==="touch")return H.touch;if(X==="mouse")return H.mouse};function z(se={}){return(se.clipFunc||se.clipWidth||se.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),se}const K="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class J extends n.Container{constructor(X){super(z(X)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{z(this.attrs)}),this._checkVisibility()}_validateAdd(X){const ie=X.getType()==="Layer",le=X.getType()==="FastLayer";ie||le||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const X=this.visible()?"":"none";this.content.style.display=X}setContainer(X){if(typeof X===d){let ie;if(X.charAt(0)==="."){const le=X.slice(1);X=document.getElementsByClassName(le)[0]}else X.charAt(0)!=="#"?ie=X:ie=X.slice(1),X=document.getElementById(ie);if(!X)throw"Can not find container in document with id "+ie}return this._setAttr("container",X),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),X.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const X=this.children,ie=X.length;for(let le=0;le<ie;le++)X[le].clear();return this}clone(X){return X||(X={}),X.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,X)}destroy(){super.destroy();const X=this.content;X&&t.Util._isInDocument(X)&&this.container().removeChild(X);const ie=e.stages.indexOf(this);return ie>-1&&e.stages.splice(ie,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const X=this._pointerPositions[0]||this._changedPointerPositions[0];return X?{x:X.x,y:X.y}:(t.Util.warn(K),null)}_getPointerById(X){return this._pointerPositions.find(ie=>ie.id===X)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(X){X=X||{},X.x=X.x||0,X.y=X.y||0,X.width=X.width||this.width(),X.height=X.height||this.height();const ie=new a.SceneCanvas({width:X.width,height:X.height,pixelRatio:X.pixelRatio||1}),le=ie.getContext()._context,ce=this.children;return(X.x||X.y)&&le.translate(-1*X.x,-1*X.y),ce.forEach(function(be){if(!be.isVisible())return;const re=be._toKonvaCanvas(X);le.drawImage(re._canvas,X.x,X.y,re.getWidth()/re.getPixelRatio(),re.getHeight()/re.getPixelRatio())}),ie}getIntersection(X){if(!X)return null;const ie=this.children,le=ie.length,ce=le-1;for(let be=ce;be>=0;be--){const re=ie[be].getIntersection(X);if(re)return re}return null}_resizeDOM(){const X=this.width(),ie=this.height();this.content&&(this.content.style.width=X+f,this.content.style.height=ie+f),this.bufferCanvas.setSize(X,ie),this.bufferHitCanvas.setSize(X,ie),this.children.forEach(le=>{le.setSize({width:X,height:ie}),le.draw()})}add(X,...ie){if(arguments.length>1){for(let ce=0;ce<arguments.length;ce++)this.add(arguments[ce]);return this}super.add(X);const le=this.children.length;return le>V&&t.Util.warn("The stage has "+le+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),X.setSize({width:this.width(),height:this.height()}),X.draw(),s.Konva.isBrowser&&this.content.appendChild(X.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(X){return c.hasPointerCapture(X,this)}setPointerCapture(X){c.setPointerCapture(X,this)}releaseCapture(X){c.releaseCapture(X,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&M.forEach(([X,ie])=>{this.content.addEventListener(X,le=>{this[ie](le)},{passive:!1})})}_pointerenter(X){this.setPointersPositions(X);const ie=R(X.type);ie&&this._fire(ie.pointerenter,{evt:X,target:this,currentTarget:this})}_pointerover(X){this.setPointersPositions(X);const ie=R(X.type);ie&&this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this})}_getTargetShape(X){let ie=this[X+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this._getTargetShape(le),be=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;ce&&be?(ce._fireAndBubble(ie.pointerout,{evt:X}),ce._fireAndBubble(ie.pointerleave,{evt:X}),this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this[le+"targetShape"]=null):be&&(this._fire(ie.pointerleave,{evt:X,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:X,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);let ce=!1;this._changedPointerPositions.forEach(be=>{const re=this.getIntersection(be);if(i.DD.justDragged=!1,s.Konva["_"+le+"ListenClick"]=!0,!re||!re.isListening()){this[le+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&re.setPointerCapture(be.id),this[le+"ClickStartShape"]=re,re._fireAndBubble(ie.pointerdown,{evt:X,pointerId:be.id}),ce=!0;const pe=X.type.indexOf("touch")>=0;re.preventDefault()&&X.cancelable&&pe&&X.preventDefault()}),ce||this._fire(ie.pointerdown,{evt:X,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(X){const ie=R(X.type),le=W(X.type);if(!ie||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&X.cancelable&&X.preventDefault(),this.setPointersPositions(X),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const be={};let re=!1;const pe=this._getTargetShape(le);this._changedPointerPositions.forEach(Ce=>{const Ae=c.getCapturedShape(Ce.id)||this.getIntersection(Ce),We=Ce.id,Le={evt:X,pointerId:We},At=pe!==Ae;if(At&&pe&&(pe._fireAndBubble(ie.pointerout,{...Le},Ae),pe._fireAndBubble(ie.pointerleave,{...Le},Ae)),Ae){if(be[Ae._id])return;be[Ae._id]=!0}Ae&&Ae.isListening()?(re=!0,At&&(Ae._fireAndBubble(ie.pointerover,{...Le},pe),Ae._fireAndBubble(ie.pointerenter,{...Le},pe),this[le+"targetShape"]=Ae),Ae._fireAndBubble(ie.pointermove,{...Le})):pe&&(this._fire(ie.pointerover,{evt:X,target:this,currentTarget:this,pointerId:We}),this[le+"targetShape"]=null)}),re||this._fire(ie.pointermove,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(X){const ie=R(X.type),le=W(X.type);if(!ie)return;this.setPointersPositions(X);const ce=this[le+"ClickStartShape"],be=this[le+"ClickEndShape"],re={};let pe=!1;this._changedPointerPositions.forEach(Ce=>{const Ae=c.getCapturedShape(Ce.id)||this.getIntersection(Ce);if(Ae){if(Ae.releaseCapture(Ce.id),re[Ae._id])return;re[Ae._id]=!0}const We=Ce.id,Le={evt:X,pointerId:We};let At=!1;s.Konva["_"+le+"InDblClickWindow"]?(At=!0,clearTimeout(this[le+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+le+"InDblClickWindow"]=!0,clearTimeout(this[le+"DblTimeout"])),this[le+"DblTimeout"]=setTimeout(function(){s.Konva["_"+le+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Ae&&Ae.isListening()?(pe=!0,this[le+"ClickEndShape"]=Ae,Ae._fireAndBubble(ie.pointerup,{...Le}),s.Konva["_"+le+"ListenClick"]&&ce&&ce===Ae&&(Ae._fireAndBubble(ie.pointerclick,{...Le}),At&&be&&be===Ae&&Ae._fireAndBubble(ie.pointerdblclick,{...Le}))):(this[le+"ClickEndShape"]=null,s.Konva["_"+le+"ListenClick"]&&this._fire(ie.pointerclick,{evt:X,target:this,currentTarget:this,pointerId:We}),At&&this._fire(ie.pointerdblclick,{evt:X,target:this,currentTarget:this,pointerId:We}))}),pe||this._fire(ie.pointerup,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+le+"ListenClick"]=!1,X.cancelable&&le!=="touch"&&le!=="pointer"&&X.preventDefault()}_contextmenu(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(Y,{evt:X}):this._fire(Y,{evt:X,target:this,currentTarget:this})}_wheel(X){this.setPointersPositions(X);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(B,{evt:X}):this._fire(B,{evt:X,target:this,currentTarget:this})}_pointercancel(X){this.setPointersPositions(X);const ie=c.getCapturedShape(X.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(E,c.createEvent(X)),c.releaseCapture(X.pointerId)}_lostpointercapture(X){c.releaseCapture(X.pointerId)}setPointersPositions(X){const ie=this._getContentPosition();let le=null,ce=null;X=X||window.event,X.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(X.touches,be=>{this._pointerPositions.push({id:be.identifier,x:(be.clientX-ie.left)/ie.scaleX,y:(be.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(X.changedTouches||X.touches,be=>{this._changedPointerPositions.push({id:be.identifier,x:(be.clientX-ie.left)/ie.scaleX,y:(be.clientY-ie.top)/ie.scaleY})})):(le=(X.clientX-ie.left)/ie.scaleX,ce=(X.clientY-ie.top)/ie.scaleY,this.pointerPos={x:le,y:ce},this._pointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}],this._changedPointerPositions=[{x:le,y:ce,id:t.Util._getFirstPointerId(X)}])}_setPointerPosition(X){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(X)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const X=this.content.getBoundingClientRect();return{top:X.top,left:X.left,scaleX:X.width/this.content.clientWidth||1,scaleY:X.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const X=this.container();if(!X)throw"Stage has no container. A container is required.";X.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),X.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(X){X.batchDraw()}),this}}e.Stage=J,J.prototype.nodeType=u,(0,o._registerNode)(J),r.Factory.addGetterSetter(J,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(se=>{se.batchDraw()})})})(HS)),HS}var ix={},GS={},b6;function Wa(){return b6||(b6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=tn(),r=Bs(),n=ln(),s=Js(),a=dn(),i=tn(),o=hL(),c="hasShadow",u="shadowRGBA",d="patternImage",f="linearGradient",g="radialGradient";let p;function x(){return p||(p=r.Util.createCanvasElement().getContext("2d"),p)}e.shapes={};function v(j){const I=this.attrs.fillRule;I?j.fill(I):j.fill()}function w(j){j.stroke()}function C(j){const I=this.attrs.fillRule;I?j.fill(I):j.fill()}function k(j){j.stroke()}function _(){this._clearCache(c)}function N(){this._clearCache(u)}function E(){this._clearCache(d)}function P(){this._clearCache(f)}function F(){this._clearCache(g)}class A extends s.Node{constructor(I){super(I);let L;for(;L=r.Util.getRandomColor(),!(L&&!(L in e.shapes)););this.colorKey=L,e.shapes[L]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const L=x().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(L&&L.setTransform){const Y=new r.Transform;Y.translate(this.fillPatternX(),this.fillPatternY()),Y.rotate(t.Konva.getAngle(this.fillPatternRotation())),Y.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),Y.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Z=Y.getMatrix(),ae=typeof DOMMatrix>"u"?{a:Z[0],b:Z[1],c:Z[2],d:Z[3],e:Z[4],f:Z[5]}:new DOMMatrix(Z);L.setTransform(ae)}return L}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const L=x(),Y=this.fillLinearGradientStartPoint(),Z=this.fillLinearGradientEndPoint(),ae=L.createLinearGradient(Y.x,Y.y,Z.x,Z.y);for(let ee=0;ee<I.length;ee+=2)ae.addColorStop(I[ee],I[ee+1]);return ae}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const L=x(),Y=this.fillRadialGradientStartPoint(),Z=this.fillRadialGradientEndPoint(),ae=L.createRadialGradient(Y.x,Y.y,this.fillRadialGradientStartRadius(),Z.x,Z.y,this.fillRadialGradientEndRadius());for(let ee=0;ee<I.length;ee+=2)ae.addColorStop(I[ee],I[ee+1]);return ae}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=r.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const L=this.getStage();if(!L)return!1;const Y=L.bufferHitCanvas;return Y.getContext().clear(),this.drawHit(Y,void 0,!0),Y.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var L;if(!((L=this.attrs.perfectDrawEnabled)!==null&&L!==void 0?L:!0))return!1;const Z=I||this.hasFill(),ae=this.hasStroke(),ee=this.getAbsoluteOpacity()!==1;if(Z&&ae&&ee)return!0;const ne=this.hasShadow(),B=this.shadowForStrokeEnabled();return!!(Z&&ae&&ne&&B)}setStrokeHitEnabled(I){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let L=!1,Y=this.getParent();for(;Y;){if(Y.isCached()){L=!0;break}Y=Y.getParent()}const Z=I.skipTransform,ae=I.relativeTo||L&&this.getStage()||void 0,ee=this.getSelfRect(),B=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,V=ee.width+B,M=ee.height+B,H=!I.skipShadow&&this.hasShadow(),W=H?this.shadowOffsetX():0,R=H?this.shadowOffsetY():0,z=V+Math.abs(W),K=M+Math.abs(R),J=H&&this.shadowBlur()||0,se=z+J*2,X=K+J*2,ie={width:se,height:X,x:-(B/2+J)+Math.min(W,0)+ee.x,y:-(B/2+J)+Math.min(R,0)+ee.y};return Z?ie:this._transformedRect(ie,ae)}drawScene(I,L,Y){const Z=this.getLayer(),ae=I||Z.getCanvas(),ee=ae.getContext(),ne=this._getCanvasCache(),B=this.getSceneFunc(),V=this.hasShadow();let M;const H=L===this;if(!this.isVisible()&&!H)return this;if(ne){ee.save();const W=this.getAbsoluteTransform(L).getMatrix();return ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),this._drawCachedSceneCanvas(ee),ee.restore(),this}if(!B)return this;if(ee.save(),this._useBufferCanvas()){M=this.getStage();const W=Y||M.bufferCanvas,R=W.getContext();R.clear(),R.save(),R._applyLineJoin(this);const z=this.getAbsoluteTransform(L).getMatrix();R.transform(z[0],z[1],z[2],z[3],z[4],z[5]),B.call(this,R,this),R.restore();const K=W.pixelRatio;V&&ee._applyShadow(this),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this),ee.drawImage(W._canvas,W.x||0,W.y||0,W.width/K,W.height/K)}else{if(ee._applyLineJoin(this),!H){const W=this.getAbsoluteTransform(L).getMatrix();ee.transform(W[0],W[1],W[2],W[3],W[4],W[5]),ee._applyOpacity(this),ee._applyGlobalCompositeOperation(this)}V&&ee._applyShadow(this),B.call(this,ee,this)}return ee.restore(),this}drawHit(I,L,Y=!1){if(!this.shouldDrawHit(L,Y))return this;const Z=this.getLayer(),ae=I||Z.hitCanvas,ee=ae&&ae.getContext(),ne=this.hitFunc()||this.sceneFunc(),B=this._getCanvasCache(),V=B&&B.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),V){ee.save();const H=this.getAbsoluteTransform(L).getMatrix();return ee.transform(H[0],H[1],H[2],H[3],H[4],H[5]),this._drawCachedHitCanvas(ee),ee.restore(),this}if(!ne)return this;if(ee.save(),ee._applyLineJoin(this),!(this===L)){const H=this.getAbsoluteTransform(L).getMatrix();ee.transform(H[0],H[1],H[2],H[3],H[4],H[5])}return ne.call(this,ee,this),ee.restore(),this}drawHitFromCache(I=0){const L=this._getCanvasCache(),Y=this._getCachedSceneCanvas(),Z=L.hit,ae=Z.getContext(),ee=Z.getWidth(),ne=Z.getHeight();ae.clear(),ae.drawImage(Y._canvas,0,0,ee,ne);try{const B=ae.getImageData(0,0,ee,ne),V=B.data,M=V.length,H=r.Util._hexToRgb(this.colorKey);for(let W=0;W<M;W+=4)V[W+3]>I?(V[W]=H.r,V[W+1]=H.g,V[W+2]=H.b,V[W+3]=255):V[W+3]=0;ae.putImageData(B,0,0)}catch(B){r.Util.error("Unable to draw hit graph from cached scene canvas. "+B.message)}return this}hasPointerCapture(I){return o.hasPointerCapture(I,this)}setPointerCapture(I){o.setPointerCapture(I,this)}releaseCapture(I){o.releaseCapture(I,this)}}e.Shape=A,A.prototype._fillFunc=v,A.prototype._strokeFunc=w,A.prototype._fillFuncHit=C,A.prototype._strokeFuncHit=k,A.prototype._centroid=!1,A.prototype.nodeType="Shape",(0,i._registerNode)(A),A.prototype.eventListeners={},A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),A.prototype.on.call(A.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",E),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),A.prototype.on.call(A.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(A,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(A,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(A,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(A,"lineJoin"),n.Factory.addGetterSetter(A,"lineCap"),n.Factory.addGetterSetter(A,"sceneFunc"),n.Factory.addGetterSetter(A,"hitFunc"),n.Factory.addGetterSetter(A,"dash"),n.Factory.addGetterSetter(A,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(A,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(A,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternImage"),n.Factory.addGetterSetter(A,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(A,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(A,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(A,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(A,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(A,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(A,"fillEnabled",!0),n.Factory.addGetterSetter(A,"strokeEnabled",!0),n.Factory.addGetterSetter(A,"shadowEnabled",!0),n.Factory.addGetterSetter(A,"dashEnabled",!0),n.Factory.addGetterSetter(A,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(A,"fillPriority","color"),n.Factory.addComponentsGetterSetter(A,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(A,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(A,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(A,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(A,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(A,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(A,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(A,"fillPatternRotation",0),n.Factory.addGetterSetter(A,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(A,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(GS)),GS}var S6;function gL(){if(S6)return ix;S6=1,Object.defineProperty(ix,"__esModule",{value:!0}),ix.Layer=void 0;const e=Bs(),t=Lb(),r=Js(),n=ln(),s=Mb(),a=dn(),i=Wa(),o=tn(),c="#",u="beforeDraw",d="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=f.length;class p extends t.Container{constructor(v){super(v),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(v){return this.getContext().clear(v),this.getHitCanvas().getContext().clear(v),this}setZIndex(v){super.setZIndex(v);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),v<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[v+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const w=this.getStage();return!w||!w.content?!1:(w.content.removeChild(this.getNativeCanvasElement()),this.index<w.children.length-1?w.content.insertBefore(this.getNativeCanvasElement(),w.children[this.index+1].getCanvas()._canvas):w.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const v=this.getStage();if(v){const w=v.children;v.content&&(v.content.removeChild(this.getNativeCanvasElement()),v.content.insertBefore(this.getNativeCanvasElement(),w[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const v=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),v&&v.parentNode&&e.Util._isInDocument(v)&&v.parentNode.removeChild(v),this}getStage(){return this.parent}setSize({width:v,height:w}){return this.canvas.setSize(v,w),this.hitCanvas.setSize(v,w),this._setSmoothEnabled(),this}_validateAdd(v){const w=v.getType();w!=="Group"&&w!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(v){return v=v||{},v.width=v.width||this.getWidth(),v.height=v.height||this.getHeight(),v.x=v.x!==void 0?v.x:this.x(),v.y=v.y!==void 0?v.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,v)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(v){if(!this.isListening()||!this.isVisible())return null;let w=1,C=!1;for(;;){for(let k=0;k<g;k++){const _=f[k],N=this._getIntersection({x:v.x+_.x*w,y:v.y+_.y*w}),E=N.shape;if(E)return E;if(C=!!N.antialiased,!N.antialiased)break}if(C)w+=1;else return null}}_getIntersection(v){const w=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(v.x*w),Math.round(v.y*w),1,1).data,k=C[3];if(k===255){const _=e.Util._rgbToHex(C[0],C[1],C[2]),N=i.shapes[c+_];return N?{shape:N}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(v,w,C){const k=this.getLayer(),_=v||k&&k.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&_.getContext().clear(),t.Container.prototype.drawScene.call(this,_,w,C),this._fire(d,{node:this}),this}drawHit(v,w){const C=this.getLayer(),k=v||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,w),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(v){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(v)}getHitGraphEnabled(v){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const v=this.parent;!!this.hitCanvas._canvas.parentNode?v.content.removeChild(this.hitCanvas._canvas):v.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return ix.Layer=p,p.prototype.nodeType="Layer",(0,o._registerNode)(p),n.Factory.addGetterSetter(p,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(p,"clearBeforeDraw",!0),n.Factory.addGetterSetter(p,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),ix}var ox={},k6;function AQ(){if(k6)return ox;k6=1,Object.defineProperty(ox,"__esModule",{value:!0}),ox.FastLayer=void 0;const e=Bs(),t=gL(),r=tn();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return ox.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),ox}var lx={},C6;function JN(){if(C6)return lx;C6=1,Object.defineProperty(lx,"__esModule",{value:!0}),lx.Group=void 0;const e=Bs(),t=Lb(),r=tn();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return lx.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),lx}var cx={},T6;function QN(){if(T6)return cx;T6=1,Object.defineProperty(cx,"__esModule",{value:!0}),cx.Animation=void 0;const e=tn(),t=Bs(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Bg{constructor(a,i){this.id=Bg.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let c=0;c<o;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Bg.animations,o=i.length;for(let c=0;c<o;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Bg._addAnimation(this),this}stop(){return Bg._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,c=o.length;for(let u=0;u<c;u++)if(o[u].id===i){this.animations.splice(u,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const c=i[o],u=c.layers,d=c.func;c._updateFrameObject(r());const f=u.length;let g;if(d?g=d.call(c,c.frame)!==!1:g=!0,!!g)for(let p=0;p<f;p++){const x=u[p];x._id!==void 0&&(a[x._id]=x)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Bg;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return cx.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,cx}var VS={},E6;function jQ(){return E6||(E6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=Bs(),r=QN(),n=Js(),s=tn(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,c=3,u=["fill","stroke","shadowColor"];let d=0;class f{constructor(x,v,w,C,k,_,N){this.prop=x,this.propFunc=v,this.begin=C,this._pos=C,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=N,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=w,this._change=k-this.begin,this.pause()}fire(x){const v=this[x];v&&v()}setTime(x){x>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():x<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=x,this.update())}getTime(){return this._time}setPosition(x){this.prevPos=this._pos,this.propFunc(x),this._pos=x}getPosition(x){return x===void 0&&(x=this._time),this.func(x,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(x){this.pause(),this._time=x,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const x=this.getTimer()-this._startTime;this.state===o?this.setTime(x):this.state===c&&this.setTime(this.duration-x)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(x){const v=this,w=x.node,C=w._id,k=x.easing||e.Easings.Linear,_=!!x.yoyo;let N,E;typeof x.duration>"u"?N=.3:x.duration===0?N=.001:N=x.duration,this.node=w,this._id=d++;const P=w.getLayer()||(w instanceof s.Konva.Stage?w.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){v.tween.onEnterFrame()},P),this.tween=new f(E,function(F){v._tweenFunc(F)},k,0,1,N*1e3,_),this._addListeners(),g.attrs[C]||(g.attrs[C]={}),g.attrs[C][this._id]||(g.attrs[C][this._id]={}),g.tweens[C]||(g.tweens[C]={});for(E in x)a[E]===void 0&&this._addAttr(E,x[E]);this.reset(),this.onFinish=x.onFinish,this.onReset=x.onReset,this.onUpdate=x.onUpdate}_addAttr(x,v){const w=this.node,C=w._id;let k,_,N,E,P;const F=g.tweens[C][x];F&&delete g.attrs[C][F][x];let A=w.getAttr(x);if(t.Util._isArray(v))if(k=[],_=Math.max(v.length,A.length),x==="points"&&v.length!==A.length&&(v.length>A.length?(E=A,A=t.Util._prepareArrayForTween(A,v,w.closed())):(N=v,v=t.Util._prepareArrayForTween(v,A,w.closed()))),x.indexOf("fill")===0)for(let j=0;j<_;j++)if(j%2===0)k.push(v[j]-A[j]);else{const I=t.Util.colorToRGBA(A[j]);P=t.Util.colorToRGBA(v[j]),A[j]=I,k.push({r:P.r-I.r,g:P.g-I.g,b:P.b-I.b,a:P.a-I.a})}else for(let j=0;j<_;j++)k.push(v[j]-A[j]);else u.indexOf(x)!==-1?(A=t.Util.colorToRGBA(A),P=t.Util.colorToRGBA(v),k={r:P.r-A.r,g:P.g-A.g,b:P.b-A.b,a:P.a-A.a}):k=v-A;g.attrs[C][this._id][x]={start:A,diff:k,end:v,trueEnd:N,trueStart:E},g.tweens[C][x]=this._id}_tweenFunc(x){const v=this.node,w=g.attrs[v._id][this._id];let C,k,_,N,E,P,F,A;for(C in w){if(k=w[C],_=k.start,N=k.diff,A=k.end,t.Util._isArray(_))if(E=[],F=Math.max(_.length,A.length),C.indexOf("fill")===0)for(P=0;P<F;P++)P%2===0?E.push((_[P]||0)+N[P]*x):E.push("rgba("+Math.round(_[P].r+N[P].r*x)+","+Math.round(_[P].g+N[P].g*x)+","+Math.round(_[P].b+N[P].b*x)+","+(_[P].a+N[P].a*x)+")");else for(P=0;P<F;P++)E.push((_[P]||0)+N[P]*x);else u.indexOf(C)!==-1?E="rgba("+Math.round(_.r+N.r*x)+","+Math.round(_.g+N.g*x)+","+Math.round(_.b+N.b*x)+","+(_.a+N.a*x)+")":E=_+N*x;v.setAttr(C,E)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueEnd&&x.setAttr("points",v.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const x=this.node,v=g.attrs[x._id][this._id];v.points&&v.points.trueStart&&x.points(v.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(x){return this.tween.seek(x*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const x=this.node._id,v=this._id,w=g.tweens[x];this.pause(),this.anim&&this.anim.stop();for(const C in w)delete g.tweens[x][C];delete g.attrs[x][v],g.tweens[x]&&(Object.keys(g.tweens[x]).length===0&&delete g.tweens[x],Object.keys(g.attrs[x]).length===0&&delete g.attrs[x])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(p){const x=p.onFinish;p.node=this,p.onFinish=function(){this.destroy(),x&&x()},new g(p).play()},e.Easings={BackEaseIn(p,x,v,w){return v*(p/=w)*p*((1.70158+1)*p-1.70158)+x},BackEaseOut(p,x,v,w){return v*((p=p/w-1)*p*((1.70158+1)*p+1.70158)+1)+x},BackEaseInOut(p,x,v,w){let C=1.70158;return(p/=w/2)<1?v/2*(p*p*(((C*=1.525)+1)*p-C))+x:v/2*((p-=2)*p*(((C*=1.525)+1)*p+C)+2)+x},ElasticEaseIn(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),-(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k))+x)},ElasticEaseOut(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w)===1?x+v:(k||(k=w*.3),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),C*Math.pow(2,-10*p)*Math.sin((p*w-_)*(2*Math.PI)/k)+v+x)},ElasticEaseInOut(p,x,v,w,C,k){let _=0;return p===0?x:(p/=w/2)===2?x+v:(k||(k=w*(.3*1.5)),!C||C<Math.abs(v)?(C=v,_=k/4):_=k/(2*Math.PI)*Math.asin(v/C),p<1?-.5*(C*Math.pow(2,10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k))+x:C*Math.pow(2,-10*(p-=1))*Math.sin((p*w-_)*(2*Math.PI)/k)*.5+v+x)},BounceEaseOut(p,x,v,w){return(p/=w)<1/2.75?v*(7.5625*p*p)+x:p<2/2.75?v*(7.5625*(p-=1.5/2.75)*p+.75)+x:p<2.5/2.75?v*(7.5625*(p-=2.25/2.75)*p+.9375)+x:v*(7.5625*(p-=2.625/2.75)*p+.984375)+x},BounceEaseIn(p,x,v,w){return v-e.Easings.BounceEaseOut(w-p,0,v,w)+x},BounceEaseInOut(p,x,v,w){return p<w/2?e.Easings.BounceEaseIn(p*2,0,v,w)*.5+x:e.Easings.BounceEaseOut(p*2-w,0,v,w)*.5+v*.5+x},EaseIn(p,x,v,w){return v*(p/=w)*p+x},EaseOut(p,x,v,w){return-v*(p/=w)*(p-2)+x},EaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p+x:-v/2*(--p*(p-2)-1)+x},StrongEaseIn(p,x,v,w){return v*(p/=w)*p*p*p*p+x},StrongEaseOut(p,x,v,w){return v*((p=p/w-1)*p*p*p*p+1)+x},StrongEaseInOut(p,x,v,w){return(p/=w/2)<1?v/2*p*p*p*p*p+x:v/2*((p-=2)*p*p*p*p+2)+x},Linear(p,x,v,w){return v*p/w+x}}})(VS)),VS}var N6;function PT(){return N6||(N6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=tn(),r=Bs(),n=Js(),s=Lb(),a=NQ(),i=gL(),o=AQ(),c=JN(),u=XN(),d=Wa(),f=QN(),g=jQ(),p=fL(),x=Mb();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:c.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:f.Animation,Tween:g.Tween,Easings:g.Easings,Context:p.Context,Canvas:x.Canvas}),e.default=e.Konva})(BS)),BS}var ux={},A6;function PQ(){if(A6)return ux;A6=1,Object.defineProperty(ux,"__esModule",{value:!0}),ux.Arc=void 0;const e=ln(),t=Wa(),r=tn(),n=dn(),s=tn();class a extends t.Shape{_sceneFunc(o){const c=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,c,u),o.arc(0,0,this.innerRadius(),c,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),c=this.outerRadius(),u=this.clockwise(),d=r.Konva.getAngle(u?360-this.angle():this.angle()),f=Math.cos(Math.min(d,Math.PI)),g=1,p=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),x=Math.sin(Math.min(d,Math.PI/2)),v=f*(f>0?o:c),w=g*c,C=p*(p>0?o:c),k=x*(x>0?c:o);return{x:v,y:u?-1*k:C,width:w-v,height:k-C}}}return ux.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),ux}var dx={},fx={},j6;function mL(){if(j6)return fx;j6=1,Object.defineProperty(fx,"__esModule",{value:!0}),fx.Line=void 0;const e=ln(),t=tn(),r=Wa(),n=dn();function s(o,c,u,d,f,g,p){const x=Math.sqrt(Math.pow(u-o,2)+Math.pow(d-c,2)),v=Math.sqrt(Math.pow(f-u,2)+Math.pow(g-d,2)),w=p*x/(x+v),C=p*v/(x+v),k=u-w*(f-o),_=d-w*(g-c),N=u+C*(f-o),E=d+C*(g-c);return[k,_,N,E]}function a(o,c){const u=o.length,d=[];for(let f=2;f<u-2;f+=2){const g=s(o[f-2],o[f-1],o[f],o[f+1],o[f+2],o[f+3],c);isNaN(g[0])||(d.push(g[0]),d.push(g[1]),d.push(o[f]),d.push(o[f+1]),d.push(g[2]),d.push(g[3]))}return d}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const u=this.points(),d=u.length,f=this.tension(),g=this.closed(),p=this.bezier();if(!d)return;let x=0;if(c.beginPath(),c.moveTo(u[0],u[1]),f!==0&&d>4){const v=this.getTensionPoints(),w=v.length;for(x=g?0:4,g||c.quadraticCurveTo(v[0],v[1],v[2],v[3]);x<w-2;)c.bezierCurveTo(v[x++],v[x++],v[x++],v[x++],v[x++],v[x++]);g||c.quadraticCurveTo(v[w-2],v[w-1],u[d-2],u[d-1])}else if(p)for(x=2;x<d;)c.bezierCurveTo(u[x++],u[x++],u[x++],u[x++],u[x++],u[x++]);else for(x=2;x<d;x+=2)c.lineTo(u[x],u[x+1]);g?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),u=c.length,d=this.tension(),f=s(c[u-2],c[u-1],c[0],c[1],c[2],c[3],d),g=s(c[u-4],c[u-3],c[u-2],c[u-1],c[0],c[1],d),p=a(c,d);return[f[2],f[3]].concat(p).concat([g[0],g[1],c[u-2],c[u-1],g[2],g[3],f[0],f[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let u=c[0],d=c[0],f=c[1],g=c[1],p,x;for(let v=0;v<c.length/2;v++)p=c[v*2],x=c[v*2+1],u=Math.min(u,p),d=Math.max(d,p),f=Math.min(f,x),g=Math.max(g,x);return{x:u,y:f,width:d-u,height:g-f}}}return fx.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),fx}var hx={},KS={},P6;function FQ(){return P6||(P6=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,c)=>{let u,d;const g=c/2;u=0;for(let p=0;p<20;p++)d=g*e.tValues[20][p]+g,u+=e.cValues[20][p]*n(i,o,d);return g*u};e.getCubicArcLength=t;const r=(i,o,c)=>{c===void 0&&(c=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],f=2*i[1]-2*i[0],g=2*o[1]-2*o[0],p=4*(u*u+d*d),x=4*(u*f+d*g),v=f*f+g*g;if(p===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const w=x/(2*p),C=v/p,k=c+w,_=C-w*w,N=k*k+_>0?Math.sqrt(k*k+_):0,E=w*w+_>0?Math.sqrt(w*w+_):0,P=w+Math.sqrt(w*w+_)!==0?_*Math.log(Math.abs((k+N)/(w+E))):0;return Math.sqrt(p)/2*(k*N-w*E+P)};e.getQuadraticArcLength=r;function n(i,o,c){const u=s(1,c,i),d=s(1,c,o),f=u*u+d*d;return Math.sqrt(f)}const s=(i,o,c)=>{const u=c.length-1;let d,f;if(u===0)return 0;if(i===0){f=0;for(let g=0;g<=u;g++)f+=e.binomialCoefficients[u][g]*Math.pow(1-o,u-g)*Math.pow(o,g)*c[g];return f}else{d=new Array(u);for(let g=0;g<u;g++)d[g]=u*(c[g+1]-c[g]);return s(i-1,o,d)}},a=(i,o,c)=>{let u=1,d=i/o,f=(i-c(d))/o,g=0;for(;u>.001;){const p=c(d+f),x=Math.abs(i-p)/o;if(x<u)u=x,d+=f;else{const v=c(d-f),w=Math.abs(i-v)/o;w<u?(u=w,d-=f):f/=2}if(g++,g>500)break}return d};e.t2length=a})(KS)),KS}var F6;function ZN(){if(F6)return hx;F6=1,Object.defineProperty(hx,"__esModule",{value:!0}),hx.Path=void 0;const e=ln(),t=tn(),r=Wa(),n=FQ();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let c=!1;for(let u=0;u<o.length;u++){const d=o[u].command,f=o[u].points;switch(d){case"L":i.lineTo(f[0],f[1]);break;case"M":i.moveTo(f[0],f[1]);break;case"C":i.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":i.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const g=f[0],p=f[1],x=f[2],v=f[3],w=f[4],C=f[5],k=f[6],_=f[7],N=x>v?x:v,E=x>v?1:x/v,P=x>v?v/x:1;i.translate(g,p),i.rotate(k),i.scale(E,P),i.arc(0,0,N,w,w+C,1-_),i.scale(1/E,1/P),i.rotate(-k),i.translate(-g,-p);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(p){if(p.command==="A"){const x=p.points[4],v=p.points[5],w=p.points[4]+v;let C=Math.PI/180;if(Math.abs(x-w)<C&&(C=Math.abs(x-w)),v<0)for(let k=x-C;k>w;k-=C){const _=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(_.x,_.y)}else for(let k=x+C;k<w;k+=C){const _=s.getPointOnEllipticalArc(p.points[0],p.points[1],p.points[2],p.points[3],k,0);i.push(_.x,_.y)}}else if(p.command==="C")for(let x=0;x<=1;x+=.01){const v=s.getPointOnCubicBezier(x,p.start.x,p.start.y,p.points[0],p.points[1],p.points[2],p.points[3],p.points[4],p.points[5]);i.push(v.x,v.y)}else i=i.concat(p.points)});let o=i[0],c=i[0],u=i[1],d=i[1],f,g;for(let p=0;p<i.length/2;p++)f=i[p*2],g=i[p*2+1],isNaN(f)||(o=Math.min(o,f),c=Math.max(c,f)),isNaN(g)||(u=Math.min(u,g),d=Math.max(d,g));return{x:o,y:u,width:c-o,height:d-u}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,c,u){return Math.sqrt((c-i)*(c-i)+(u-o)*(u-o))}static getPathLength(i){let o=0;for(let c=0;c<i.length;++c)o+=i[c].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let c,u=0,d=o.length;if(!d)return null;for(;u<d&&i>o[u].pathLength;)i-=o[u].pathLength,++u;if(u===d)return c=o[u-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return o[u].command==="M"?(c=o[u].points.slice(0,2),{x:c[0],y:c[1]}):{x:o[u].start.x,y:o[u].start.y};const f=o[u],g=f.points;switch(f.command){case"L":return s.getPointOnLine(i,f.start.x,f.start.y,g[0],g[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getCubicArcLength)([f.start.x,g[0],g[2],g[4]],[f.start.y,g[1],g[3],g[5]],N)),f.start.x,f.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getQuadraticArcLength)([f.start.x,g[0],g[2]],[f.start.y,g[1],g[3]],N)),f.start.x,f.start.y,g[0],g[1],g[2],g[3]);case"A":const p=g[0],x=g[1],v=g[2],w=g[3],C=g[5],k=g[6];let _=g[4];return _+=C*i/f.pathLength,s.getPointOnEllipticalArc(p,x,v,w,_,k)}return null}static getPointOnLine(i,o,c,u,d,f,g){f=f??o,g=g??c;const p=this.getLineLength(o,c,u,d);if(p<1e-10)return{x:o,y:c};if(u===o)return{x:f,y:g+(d>c?i:-i)};const x=(d-c)/(u-o),v=Math.sqrt(i*i/(1+x*x))*(u<o?-1:1),w=x*v;if(Math.abs(g-c-x*(f-o))<1e-10)return{x:f+v,y:g+w};const C=((f-o)*(u-o)+(g-c)*(d-c))/(p*p),k=o+C*(u-o),_=c+C*(d-c),N=this.getLineLength(f,g,k,_),E=Math.sqrt(i*i-N*N),P=Math.sqrt(E*E/(1+x*x))*(u<o?-1:1),F=x*P;return{x:k+P,y:_+F}}static getPointOnCubicBezier(i,o,c,u,d,f,g,p,x){function v(E){return E*E*E}function w(E){return 3*E*E*(1-E)}function C(E){return 3*E*(1-E)*(1-E)}function k(E){return(1-E)*(1-E)*(1-E)}const _=p*v(i)+f*w(i)+u*C(i)+o*k(i),N=x*v(i)+g*w(i)+d*C(i)+c*k(i);return{x:_,y:N}}static getPointOnQuadraticBezier(i,o,c,u,d,f,g){function p(k){return k*k}function x(k){return 2*k*(1-k)}function v(k){return(1-k)*(1-k)}const w=f*p(i)+u*x(i)+o*v(i),C=g*p(i)+d*x(i)+c*v(i);return{x:w,y:C}}static getPointOnEllipticalArc(i,o,c,u,d,f){const g=Math.cos(f),p=Math.sin(f),x={x:c*Math.cos(d),y:u*Math.sin(d)};return{x:i+(x.x*g-x.y*p),y:o+(x.x*p+x.y*g)}}static parsePathData(i){if(!i)return[];let o=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let w=0;w<c.length;w++)o=o.replace(new RegExp(c[w],"g"),"|"+c[w]);const u=o.split("|"),d=[],f=[];let g=0,p=0;const x=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let v;for(let w=1;w<u.length;w++){let C=u[w],k=C.charAt(0);for(C=C.slice(1),f.length=0;v=x.exec(C);)f.push(v[0]);const _=[];for(let N=0,E=f.length;N<E;N++){if(f[N]==="00"){_.push(0,0);continue}const P=parseFloat(f[N]);isNaN(P)?_.push(0):_.push(P)}for(;_.length>0&&!isNaN(_[0]);){let N="",E=[];const P=g,F=p;let A,j,I,L,Y,Z,ae,ee,ne,B;switch(k){case"l":g+=_.shift(),p+=_.shift(),N="L",E.push(g,p);break;case"L":g=_.shift(),p=_.shift(),E.push(g,p);break;case"m":const V=_.shift(),M=_.shift();if(g+=V,p+=M,N="M",d.length>2&&d[d.length-1].command==="z"){for(let H=d.length-2;H>=0;H--)if(d[H].command==="M"){g=d[H].points[0]+V,p=d[H].points[1]+M;break}}E.push(g,p),k="l";break;case"M":g=_.shift(),p=_.shift(),N="M",E.push(g,p),k="L";break;case"h":g+=_.shift(),N="L",E.push(g,p);break;case"H":g=_.shift(),N="L",E.push(g,p);break;case"v":p+=_.shift(),N="L",E.push(g,p);break;case"V":p=_.shift(),N="L",E.push(g,p);break;case"C":E.push(_.shift(),_.shift(),_.shift(),_.shift()),g=_.shift(),p=_.shift(),E.push(g,p);break;case"c":E.push(g+_.shift(),p+_.shift(),g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="C",E.push(g,p);break;case"S":j=g,I=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),I=p+(p-A.points[3])),E.push(j,I,_.shift(),_.shift()),g=_.shift(),p=_.shift(),N="C",E.push(g,p);break;case"s":j=g,I=p,A=d[d.length-1],A.command==="C"&&(j=g+(g-A.points[2]),I=p+(p-A.points[3])),E.push(j,I,g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="C",E.push(g,p);break;case"Q":E.push(_.shift(),_.shift()),g=_.shift(),p=_.shift(),E.push(g,p);break;case"q":E.push(g+_.shift(),p+_.shift()),g+=_.shift(),p+=_.shift(),N="Q",E.push(g,p);break;case"T":j=g,I=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),I=p+(p-A.points[1])),g=_.shift(),p=_.shift(),N="Q",E.push(j,I,g,p);break;case"t":j=g,I=p,A=d[d.length-1],A.command==="Q"&&(j=g+(g-A.points[0]),I=p+(p-A.points[1])),g+=_.shift(),p+=_.shift(),N="Q",E.push(j,I,g,p);break;case"A":L=_.shift(),Y=_.shift(),Z=_.shift(),ae=_.shift(),ee=_.shift(),ne=g,B=p,g=_.shift(),p=_.shift(),N="A",E=this.convertEndpointToCenterParameterization(ne,B,g,p,ae,ee,L,Y,Z);break;case"a":L=_.shift(),Y=_.shift(),Z=_.shift(),ae=_.shift(),ee=_.shift(),ne=g,B=p,g+=_.shift(),p+=_.shift(),N="A",E=this.convertEndpointToCenterParameterization(ne,B,g,p,ae,ee,L,Y,Z);break}d.push({command:N||k,points:E,start:{x:P,y:F},pathLength:this.calcLength(P,F,N||k,E)})}(k==="z"||k==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(i,o,c,u){let d,f,g,p;const x=s;switch(c){case"L":return x.getLineLength(i,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([i,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,u[0],u[2]],[o,u[1],u[3]],1);case"A":d=0;const v=u[4],w=u[5],C=u[4]+w;let k=Math.PI/180;if(Math.abs(v-C)<k&&(k=Math.abs(v-C)),f=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],v,0),w<0)for(p=v-k;p>C;p-=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(f.x,f.y,g.x,g.y),f=g;else for(p=v+k;p<C;p+=k)g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],p,0),d+=x.getLineLength(f.x,f.y,g.x,g.y),f=g;return g=x.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],C,0),d+=x.getLineLength(f.x,f.y,g.x,g.y),d}return 0}static convertEndpointToCenterParameterization(i,o,c,u,d,f,g,p,x){const v=x*(Math.PI/180),w=Math.cos(v)*(i-c)/2+Math.sin(v)*(o-u)/2,C=-1*Math.sin(v)*(i-c)/2+Math.cos(v)*(o-u)/2,k=w*w/(g*g)+C*C/(p*p);k>1&&(g*=Math.sqrt(k),p*=Math.sqrt(k));let _=Math.sqrt((g*g*(p*p)-g*g*(C*C)-p*p*(w*w))/(g*g*(C*C)+p*p*(w*w)));d===f&&(_*=-1),isNaN(_)&&(_=0);const N=_*g*C/p,E=_*-p*w/g,P=(i+c)/2+Math.cos(v)*N-Math.sin(v)*E,F=(o+u)/2+Math.sin(v)*N+Math.cos(v)*E,A=function(ee){return Math.sqrt(ee[0]*ee[0]+ee[1]*ee[1])},j=function(ee,ne){return(ee[0]*ne[0]+ee[1]*ne[1])/(A(ee)*A(ne))},I=function(ee,ne){return(ee[0]*ne[1]<ee[1]*ne[0]?-1:1)*Math.acos(j(ee,ne))},L=I([1,0],[(w-N)/g,(C-E)/p]),Y=[(w-N)/g,(C-E)/p],Z=[(-1*w-N)/g,(-1*C-E)/p];let ae=I(Y,Z);return j(Y,Z)<=-1&&(ae=Math.PI),j(Y,Z)>=1&&(ae=0),f===0&&ae>0&&(ae=ae-2*Math.PI),f===1&&ae<0&&(ae=ae+2*Math.PI),[P,F,g,p,L,ae,v,f]}}return hx.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),hx}var O6;function OQ(){if(O6)return dx;O6=1,Object.defineProperty(dx,"__esModule",{value:!0}),dx.Arrow=void 0;const e=ln(),t=mL(),r=dn(),n=tn(),s=ZN();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const c=Math.PI*2,u=this.points();let d=u;const f=this.tension()!==0&&u.length>4;f&&(d=this.getTensionPoints());const g=this.pointerLength(),p=u.length;let x,v;if(f){const k=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],u[p-2],u[p-1]],_=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",k),N=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/_),k[0],k[1],k[2],k[3],k[4],k[5]);x=u[p-2]-N.x,v=u[p-1]-N.y}else x=u[p-2]-u[p-4],v=u[p-1]-u[p-3];const w=(Math.atan2(v,x)+c)%c,C=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[p-2],u[p-1]),o.rotate(w),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),f?(x=(d[0]+d[2])/2-u[0],v=(d[1]+d[3])/2-u[1]):(x=u[2]-u[0],v=u[3]-u[1]),o.rotate((Math.atan2(-v,-x)+c)%c),o.moveTo(0,0),o.lineTo(-g,C/2),o.lineTo(-g,-C/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),c=this.pointerWidth()/2;return{x:o.x,y:o.y-c,width:o.width,height:o.height+c*2}}}return dx.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),dx}var gx={},D6;function DQ(){if(D6)return gx;D6=1,Object.defineProperty(gx,"__esModule",{value:!0}),gx.Circle=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return gx.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),gx}var mx={},I6;function IQ(){if(I6)return mx;I6=1,Object.defineProperty(mx,"__esModule",{value:!0}),mx.Ellipse=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),o!==c&&i.scale(1,c/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return mx.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),mx}var px={},R6;function RQ(){if(R6)return px;R6=1,Object.defineProperty(px,"__esModule",{value:!0}),px.Image=void 0;const e=Bs(),t=ln(),r=Wa(),n=tn(),s=dn();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),c=this.hasShadow();return o&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const c=this.getWidth(),u=this.getHeight(),d=this.cornerRadius(),f=this.attrs.image;let g;if(f){const p=this.attrs.cropWidth,x=this.attrs.cropHeight;p&&x?g=[f,this.cropX(),this.cropY(),p,x,0,0,c,u]:g=[f,0,0,c,u]}(this.hasFill()||this.hasStroke()||d)&&(o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)),f&&(d&&o.clip(),o.drawImage.apply(o,g))}_hitFunc(o){const c=this.width(),u=this.height(),d=this.cornerRadius();o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,c;return(o=this.attrs.width)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var o,c;return(o=this.attrs.height)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(o,c,u=null){const d=e.Util.createImageElement();d.onload=function(){const f=new a({image:d});c(f)},d.onerror=u,d.crossOrigin="Anonymous",d.src=o}}return px.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),px}var _h={},M6;function MQ(){if(M6)return _h;M6=1,Object.defineProperty(_h,"__esModule",{value:!0}),_h.Tag=_h.Label=void 0;const e=ln(),t=Wa(),r=JN(),n=dn(),s=tn(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",c="up",u="right",d="down",f="left",g=a.length;class p extends r.Group{constructor(w){super(w),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(w){let C=this,k;const _=function(){C._sync()};for(k=0;k<g;k++)w.on(a[k]+i,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let w=this.getText(),C=this.getTag(),k,_,N,E,P,F,A;if(w&&C){switch(k=w.width(),_=w.height(),N=C.pointerDirection(),E=C.pointerWidth(),A=C.pointerHeight(),P=0,F=0,N){case c:P=k/2,F=-1*A;break;case u:P=k+E,F=_/2;break;case d:P=k/2,F=_+A;break;case f:P=-1*E,F=_/2;break}C.setAttrs({x:-1*P,y:-1*F,width:k,height:_}),w.setAttrs({x:-1*P,y:-1*F})}}}_h.Label=p,p.prototype.className="Label",(0,s._registerNode)(p);class x extends t.Shape{_sceneFunc(w){const C=this.width(),k=this.height(),_=this.pointerDirection(),N=this.pointerWidth(),E=this.pointerHeight(),P=this.cornerRadius();let F=0,A=0,j=0,I=0;typeof P=="number"?F=A=j=I=Math.min(P,C/2,k/2):(F=Math.min(P[0]||0,C/2,k/2),A=Math.min(P[1]||0,C/2,k/2),I=Math.min(P[2]||0,C/2,k/2),j=Math.min(P[3]||0,C/2,k/2)),w.beginPath(),w.moveTo(F,0),_===c&&(w.lineTo((C-N)/2,0),w.lineTo(C/2,-1*E),w.lineTo((C+N)/2,0)),w.lineTo(C-A,0),w.arc(C-A,A,A,Math.PI*3/2,0,!1),_===u&&(w.lineTo(C,(k-E)/2),w.lineTo(C+N,k/2),w.lineTo(C,(k+E)/2)),w.lineTo(C,k-I),w.arc(C-I,k-I,I,0,Math.PI/2,!1),_===d&&(w.lineTo((C+N)/2,k),w.lineTo(C/2,k+E),w.lineTo((C-N)/2,k)),w.lineTo(j,k),w.arc(j,k-j,j,Math.PI/2,Math.PI,!1),_===f&&(w.lineTo(0,(k+E)/2),w.lineTo(-1*N,k/2),w.lineTo(0,(k-E)/2)),w.lineTo(0,F),w.arc(F,F,F,Math.PI,Math.PI*3/2,!1),w.closePath(),w.fillStrokeShape(this)}getSelfRect(){let w=0,C=0,k=this.pointerWidth(),_=this.pointerHeight(),N=this.pointerDirection(),E=this.width(),P=this.height();return N===c?(C-=_,P+=_):N===d?P+=_:N===f?(w-=k*1.5,E+=k):N===u&&(E+=k*1.5),{x:w,y:C,width:E,height:P}}}return _h.Tag=x,x.prototype.className="Tag",(0,s._registerNode)(x),e.Factory.addGetterSetter(x,"pointerDirection",o),e.Factory.addGetterSetter(x,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(x,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),_h}var xx={},L6;function pL(){if(L6)return xx;L6=1,Object.defineProperty(xx,"__esModule",{value:!0}),xx.Rect=void 0;const e=ln(),t=Wa(),r=tn(),n=Bs(),s=dn();class a extends t.Shape{_sceneFunc(o){const c=this.cornerRadius(),u=this.width(),d=this.height();o.beginPath(),c?n.Util.drawRoundedRectPath(o,u,d,c):o.rect(0,0,u,d),o.closePath(),o.fillStrokeShape(this)}}return xx.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),xx}var yx={},B6;function LQ(){if(B6)return yx;B6=1,Object.defineProperty(yx,"__esModule",{value:!0}),yx.RegularPolygon=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let c=1;c<o.length;c++)i.lineTo(o[c].x,o[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,c=[];for(let u=0;u<i;u++)c.push({x:o*Math.sin(u*2*Math.PI/i),y:-1*o*Math.cos(u*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let o=i[0].x,c=i[0].y,u=i[0].x,d=i[0].y;return i.forEach(f=>{o=Math.min(o,f.x),c=Math.max(c,f.x),u=Math.min(u,f.y),d=Math.max(d,f.y)}),{x:o,y:u,width:c-o,height:d-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return yx.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),yx}var vx={},$6;function BQ(){if($6)return vx;$6=1,Object.defineProperty(vx,"__esModule",{value:!0}),vx.Ring=void 0;const e=ln(),t=Wa(),r=dn(),n=tn(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return vx.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),vx}var wx={},U6;function $Q(){if(U6)return wx;U6=1,Object.defineProperty(wx,"__esModule",{value:!0}),wx.Sprite=void 0;const e=ln(),t=Wa(),r=QN(),n=dn(),s=tn();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,f=this.animations()[c],g=this.frameOffsets(),p=f[d+0],x=f[d+1],v=f[d+2],w=f[d+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,v,w),o.closePath(),o.fillStrokeShape(this)),C)if(g){const k=g[c],_=u*2;o.drawImage(C,p,x,v,w,k[_+0],k[_+1],v,w)}else o.drawImage(C,p,x,v,w,0,0,v,w)}_hitFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,f=this.animations()[c],g=this.frameOffsets(),p=f[d+2],x=f[d+3];if(o.beginPath(),g){const v=g[c],w=u*2;o.rect(v[w+0],v[w+1],p,x)}else o.rect(0,0,p,x);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),c=this.animation(),u=this.animations(),d=u[c],f=d.length/4;o<f-1?this.frameIndex(o+1):this.frameIndex(0)}}return wx.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),wx}var _x={},z6;function UQ(){if(z6)return _x;z6=1,Object.defineProperty(_x,"__esModule",{value:!0}),_x.Star=void 0;const e=ln(),t=Wa(),r=dn(),n=tn();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),c=this.outerRadius(),u=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let d=1;d<u*2;d++){const f=d%2===0?c:o,g=f*Math.sin(d*Math.PI/u),p=-1*f*Math.cos(d*Math.PI/u);i.lineTo(g,p)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return _x.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),_x}var Fg={},W6;function xL(){if(W6)return Fg;W6=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.Text=void 0,Fg.stringToArray=i;const e=Bs(),t=ln(),r=Wa(),n=tn(),s=dn(),a=tn();function i(R){return[...R].reduce((z,K,J,se)=>{if(new RegExp("\\p{Emoji}","u").test(K)){const X=se[J+1];X&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(X)?(z.push(K+X),se[J+1]=""):z.push(K)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(K+(se[J+1]||""))?z.push(K+se[J+1]):J>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(K)?z[z.length-1]+=K:K&&z.push(K);return z},[])}const o="auto",c="center",u="inherit",d="justify",f="Change.konva",g="2d",p="-",x="left",v="text",w="Text",C="top",k="bottom",_="middle",N="normal",E="px ",P=" ",F="right",A="rtl",j="word",I="char",L="none",Y="",Z=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],ae=Z.length;function ee(R){return R.split(",").map(z=>{z=z.trim();const K=z.indexOf(" ")>=0,J=z.indexOf('"')>=0||z.indexOf("'")>=0;return K&&!J&&(z=`"${z}"`),z}).join(", ")}let ne;function B(){return ne||(ne=e.Util.createCanvasElement().getContext(g),ne)}function V(R){R.fillText(this._partialText,this._partialTextX,this._partialTextY)}function M(R){R.setAttr("miterLimit",2),R.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function H(R){return R=R||{},!R.fillLinearGradientColorStops&&!R.fillRadialGradientColorStops&&!R.fillPatternImage&&(R.fill=R.fill||"black"),R}class W extends r.Shape{constructor(z){super(H(z)),this._partialTextX=0,this._partialTextY=0;for(let K=0;K<ae;K++)this.on(Z[K]+f,this._setTextData);this._setTextData()}_sceneFunc(z){const K=this.textArr,J=K.length;if(!this.text())return;let se=this.padding(),X=this.fontSize(),ie=this.lineHeight()*X,le=this.verticalAlign(),ce=this.direction(),be=0,re=this.align(),pe=this.getWidth(),Ce=this.letterSpacing(),Ae=this.fill(),We=this.textDecoration(),Le=We.indexOf("underline")!==-1,At=We.indexOf("line-through")!==-1,Qe;ce=ce===u?z.direction:ce;let gt=ie/2,ht=_;if(n.Konva._fixTextRendering){const tt=this.measureSize("M");ht="alphabetic",gt=(tt.fontBoundingBoxAscent-tt.fontBoundingBoxDescent)/2+ie/2}for(ce===A&&z.setAttr("direction",ce),z.setAttr("font",this._getContextFont()),z.setAttr("textBaseline",ht),z.setAttr("textAlign",x),le===_?be=(this.getHeight()-J*ie-se*2)/2:le===k&&(be=this.getHeight()-J*ie-se*2),z.translate(se,be+se),Qe=0;Qe<J;Qe++){let tt=0,ut=0;const Dt=K[Qe],Rt=Dt.text,It=Dt.width,De=Dt.lastInParagraph;if(z.save(),re===F?tt+=pe-It-se*2:re===c&&(tt+=(pe-It-se*2)/2),Le){z.save(),z.beginPath();const Ie=n.Konva._fixTextRendering?Math.round(X/4):Math.round(X/2),Je=tt,qe=gt+ut+Ie;z.moveTo(Je,qe);const Ze=re===d&&!De?pe-se*2:It;z.lineTo(Je+Math.round(Ze),qe),z.lineWidth=X/15;const Tt=this._getLinearGradient();z.strokeStyle=Tt||Ae,z.stroke(),z.restore()}if(At){z.save(),z.beginPath();const Ie=n.Konva._fixTextRendering?-Math.round(X/4):0;z.moveTo(tt,gt+ut+Ie);const Je=re===d&&!De?pe-se*2:It;z.lineTo(tt+Math.round(Je),gt+ut+Ie),z.lineWidth=X/15;const qe=this._getLinearGradient();z.strokeStyle=qe||Ae,z.stroke(),z.restore()}if(ce!==A&&(Ce!==0||re===d)){const Ie=Rt.split(" ").length-1,Je=i(Rt);for(let qe=0;qe<Je.length;qe++){const Ze=Je[qe];Ze===" "&&!De&&re===d&&(tt+=(pe-se*2-It)/Ie),this._partialTextX=tt,this._partialTextY=gt+ut,this._partialText=Ze,z.fillStrokeShape(this),tt+=this.measureSize(Ze).width+Ce}}else Ce!==0&&z.setAttr("letterSpacing",`${Ce}px`),this._partialTextX=tt,this._partialTextY=gt+ut,this._partialText=Rt,z.fillStrokeShape(this);z.restore(),J>1&&(gt+=ie)}}_hitFunc(z){const K=this.getWidth(),J=this.getHeight();z.beginPath(),z.rect(0,0,K,J),z.closePath(),z.fillStrokeShape(this)}setText(z){const K=e.Util._isString(z)?z:z==null?"":z+"";return this._setAttr(v,K),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(z){var K,J,se,X,ie,le,ce,be,re,pe,Ce;let Ae=B(),We=this.fontSize(),Le;Ae.save(),Ae.font=this._getContextFont(),Le=Ae.measureText(z),Ae.restore();const At=We/100;return{actualBoundingBoxAscent:(K=Le.actualBoundingBoxAscent)!==null&&K!==void 0?K:71.58203125*At,actualBoundingBoxDescent:(J=Le.actualBoundingBoxDescent)!==null&&J!==void 0?J:0,actualBoundingBoxLeft:(se=Le.actualBoundingBoxLeft)!==null&&se!==void 0?se:-7.421875*At,actualBoundingBoxRight:(X=Le.actualBoundingBoxRight)!==null&&X!==void 0?X:75.732421875*At,alphabeticBaseline:(ie=Le.alphabeticBaseline)!==null&&ie!==void 0?ie:0,emHeightAscent:(le=Le.emHeightAscent)!==null&&le!==void 0?le:100*At,emHeightDescent:(ce=Le.emHeightDescent)!==null&&ce!==void 0?ce:-20*At,fontBoundingBoxAscent:(be=Le.fontBoundingBoxAscent)!==null&&be!==void 0?be:91*At,fontBoundingBoxDescent:(re=Le.fontBoundingBoxDescent)!==null&&re!==void 0?re:21*At,hangingBaseline:(pe=Le.hangingBaseline)!==null&&pe!==void 0?pe:72.80000305175781*At,ideographicBaseline:(Ce=Le.ideographicBaseline)!==null&&Ce!==void 0?Ce:-21*At,width:Le.width,height:We}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+E)+ee(this.fontFamily())}_addTextLine(z){this.align()===d&&(z=z.trim());const J=this._getTextWidth(z);return this.textArr.push({text:z,width:J,lastInParagraph:!1})}_getTextWidth(z){const K=this.letterSpacing(),J=z.length;return B().measureText(z).width+K*J}_setTextData(){let z=this.text().split(`
`),K=+this.fontSize(),J=0,se=this.lineHeight()*K,X=this.attrs.width,ie=this.attrs.height,le=X!==o&&X!==void 0,ce=ie!==o&&ie!==void 0,be=this.padding(),re=X-be*2,pe=ie-be*2,Ce=0,Ae=this.wrap(),We=Ae!==L,Le=Ae!==I&&We,At=this.ellipsis();this.textArr=[],B().font=this._getContextFont();const Qe=At?this._getTextWidth(Y):0;for(let gt=0,ht=z.length;gt<ht;++gt){let tt=z[gt],ut=this._getTextWidth(tt);if(le&&ut>re)for(;tt.length>0;){let Dt=0,Rt=i(tt).length,It="",De=0;for(;Dt<Rt;){const Ie=Dt+Rt>>>1,Je=i(tt),qe=Je.slice(0,Ie+1).join(""),Ze=this._getTextWidth(qe);(At&&ce&&Ce+se>pe?Ze+Qe:Ze)<=re?(Dt=Ie+1,It=qe,De=Ze):Rt=Ie}if(It){if(Le){const qe=i(tt),Ze=i(It),Tt=qe[Ze.length],Nt=Tt===P||Tt===p;let $t;if(Nt&&De<=re)$t=Ze.length;else{const ir=Ze.lastIndexOf(P),pr=Ze.lastIndexOf(p);$t=Math.max(ir,pr)+1}$t>0&&(Dt=$t,It=qe.slice(0,Dt).join(""),De=this._getTextWidth(It))}if(It=It.trimRight(),this._addTextLine(It),J=Math.max(J,De),Ce+=se,this._shouldHandleEllipsis(Ce)){this._tryToAddEllipsisToLastLine();break}if(tt=i(tt).slice(Dt).join("").trimLeft(),tt.length>0&&(ut=this._getTextWidth(tt),ut<=re)){this._addTextLine(tt),Ce+=se,J=Math.max(J,ut);break}}else break}else this._addTextLine(tt),Ce+=se,J=Math.max(J,ut),this._shouldHandleEllipsis(Ce)&&gt<ht-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),ce&&Ce+se>pe)break}this.textHeight=K,this.textWidth=J}_shouldHandleEllipsis(z){const K=+this.fontSize(),J=this.lineHeight()*K,se=this.attrs.height,X=se!==o&&se!==void 0,ie=this.padding(),le=se-ie*2;return!(this.wrap()!==L)||X&&z+J>le}_tryToAddEllipsisToLastLine(){const z=this.attrs.width,K=z!==o&&z!==void 0,J=this.padding(),se=z-J*2,X=this.ellipsis(),ie=this.textArr[this.textArr.length-1];!ie||!X||(K&&(this._getTextWidth(ie.text+Y)<se||(ie.text=ie.text.slice(0,ie.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ie.text+Y))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const z=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,K=this.hasShadow();return z&&K?!0:super._useBufferCanvas()}}return Fg.Text=W,W.prototype._fillFunc=V,W.prototype._strokeFunc=M,W.prototype.className=w,W.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(W),t.Factory.overWriteSetter(W,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(W,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(W,"direction",u),t.Factory.addGetterSetter(W,"fontFamily","Arial"),t.Factory.addGetterSetter(W,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"fontStyle",N),t.Factory.addGetterSetter(W,"fontVariant",N),t.Factory.addGetterSetter(W,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"align",x),t.Factory.addGetterSetter(W,"verticalAlign",C),t.Factory.addGetterSetter(W,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"wrap",j),t.Factory.addGetterSetter(W,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(W,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(W,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(W,"textDecoration",""),Fg}var bx={},H6;function zQ(){if(H6)return bx;H6=1,Object.defineProperty(bx,"__esModule",{value:!0}),bx.TextPath=void 0;const e=Bs(),t=ln(),r=Wa(),n=ZN(),s=xL(),a=dn(),i=tn(),o="",c="normal";function u(g){g.fillText(this.partialText,0,0)}function d(g){g.strokeText(this.partialText,0,0)}class f extends r.Shape{constructor(p){super(p),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(p){if(!this.attrs.data)return null;const x=this.pathLength;return p-1>x?null:n.Path.getPointAtLengthOfDataArray(p,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(p){p.setAttr("font",this._getContextFont()),p.setAttr("textBaseline",this.textBaseline()),p.setAttr("textAlign","left"),p.save();const x=this.textDecoration(),v=this.fill(),w=this.fontSize(),C=this.glyphInfo;x==="underline"&&p.beginPath();for(let k=0;k<C.length;k++){p.save();const _=C[k].p0;p.translate(_.x,_.y),p.rotate(C[k].rotation),this.partialText=C[k].text,p.fillStrokeShape(this),x==="underline"&&(k===0&&p.moveTo(0,w/2+1),p.lineTo(w,w/2+1)),p.restore()}x==="underline"&&(p.strokeStyle=v,p.lineWidth=w/20,p.stroke()),p.restore()}_hitFunc(p){p.beginPath();const x=this.glyphInfo;if(x.length>=1){const v=x[0].p0;p.moveTo(v.x,v.y)}for(let v=0;v<x.length;v++){const w=x[v].p1;p.lineTo(w.x,w.y)}p.setAttr("lineWidth",this.fontSize()),p.setAttr("strokeStyle",this.colorKey),p.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(p){return s.Text.prototype.setText.call(this,p)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(p){const v=this.dummyCanvas.getContext("2d");v.save(),v.font=this._getContextFont();const w=v.measureText(p);return v.restore(),{width:w.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:p,height:x}=this._getTextSize(this.attrs.text);if(this.textWidth=p,this.textHeight=x,this.glyphInfo=[],!this.attrs.data)return null;const v=this.letterSpacing(),w=this.align(),C=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*v,0);let _=0;w==="center"&&(_=Math.max(0,this.pathLength/2-k/2)),w==="right"&&(_=Math.max(0,this.pathLength-k));const N=(0,s.stringToArray)(this.text());let E=_;for(let P=0;P<N.length;P++){const F=this._getPointAtLength(E);if(!F)return;let A=this._getTextSize(N[P]).width+v;if(N[P]===" "&&w==="justify"){const ae=this.text().split(" ").length-1;A+=(this.pathLength-k)/ae}const j=this._getPointAtLength(E+A);if(!j)return;const I=n.Path.getLineLength(F.x,F.y,j.x,j.y);let L=0;if(C)try{L=C(N[P-1],N[P])*this.fontSize()}catch{L=0}F.x+=L,j.x+=L,this.textWidth+=L;const Y=n.Path.getPointOnLine(L+I/2,F.x,F.y,j.x,j.y),Z=Math.atan2(j.y-F.y,j.x-F.x);this.glyphInfo.push({transposeX:Y.x,transposeY:Y.y,text:N[P],rotation:Z,p0:F,p1:j}),E+=A}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const p=[];this.glyphInfo.forEach(function(E){p.push(E.p0.x),p.push(E.p0.y),p.push(E.p1.x),p.push(E.p1.y)});let x=p[0]||0,v=p[0]||0,w=p[1]||0,C=p[1]||0,k,_;for(let E=0;E<p.length/2;E++)k=p[E*2],_=p[E*2+1],x=Math.min(x,k),v=Math.max(v,k),w=Math.min(w,_),C=Math.max(C,_);const N=this.fontSize();return{x:x-N/2,y:w-N/2,width:v-x+N,height:C-w+N}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return bx.TextPath=f,f.prototype._fillFunc=u,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=u,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(f),t.Factory.addGetterSetter(f,"data"),t.Factory.addGetterSetter(f,"fontFamily","Arial"),t.Factory.addGetterSetter(f,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(f,"fontStyle",c),t.Factory.addGetterSetter(f,"align","left"),t.Factory.addGetterSetter(f,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(f,"textBaseline","middle"),t.Factory.addGetterSetter(f,"fontVariant",c),t.Factory.addGetterSetter(f,"text",o),t.Factory.addGetterSetter(f,"textDecoration",""),t.Factory.addGetterSetter(f,"kerningFunc",void 0),bx}var Sx={},G6;function WQ(){if(G6)return Sx;G6=1,Object.defineProperty(Sx,"__esModule",{value:!0}),Sx.Transformer=void 0;const e=Bs(),t=ln(),r=Js(),n=Wa(),s=pL(),a=JN(),i=tn(),o=dn(),c=tn(),u="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(A=>A+`.${u}`).join(" "),f="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],p={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},x="ontouchstart"in i.Konva._global;function v(A,j,I){if(A==="rotater")return I;j+=e.Util.degToRad(p[A]||0);const L=(e.Util.radToDeg(j)%360+360)%360;return e.Util._inRange(L,315+22.5,360)||e.Util._inRange(L,0,22.5)?"ns-resize":e.Util._inRange(L,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(L,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(L,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(L,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(L,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(L,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(L,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+L),"pointer")}const w=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(A){return{x:A.x+A.width/2*Math.cos(A.rotation)+A.height/2*Math.sin(-A.rotation),y:A.y+A.height/2*Math.cos(A.rotation)+A.width/2*Math.sin(A.rotation)}}function k(A,j,I){const L=I.x+(A.x-I.x)*Math.cos(j)-(A.y-I.y)*Math.sin(j),Y=I.y+(A.x-I.x)*Math.sin(j)+(A.y-I.y)*Math.cos(j);return{...A,rotation:A.rotation+j,x:L,y:Y}}function _(A,j){const I=C(A);return k(A,j,I)}function N(A,j,I){let L=j;for(let Y=0;Y<A.length;Y++){const Z=i.Konva.getAngle(A[Y]),ae=Math.abs(Z-j)%(Math.PI*2);Math.min(ae,Math.PI*2-ae)<I&&(L=Z)}return L}let E=0;class P extends a.Group{constructor(j){super(j),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(j){return this.setNode(j),this}setNode(j){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([j])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(j=[]){this._nodes&&this._nodes.length&&this.detach();const I=j.filter(Y=>Y.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=j=I,j.length===1&&this.useSingleNodeRotation()?this.rotation(j[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(Y=>{const Z=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(Y._attrsAffectingSize.length){const ae=Y._attrsAffectingSize.map(ee=>ee+"Change."+this._getEventNamespace()).join(" ");Y.on(ae,Z)}Y.on(g.map(ae=>ae+`.${this._getEventNamespace()}`).join(" "),Z),Y.on(`absoluteTransformChange.${this._getEventNamespace()}`,Z),this._proxyDrag(Y)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(j){let I;j.on(`dragstart.${this._getEventNamespace()}`,L=>{I=j.getAbsolutePosition(),!this.isDragging()&&j!==this.findOne(".back")&&this.startDrag(L,!1)}),j.on(`dragmove.${this._getEventNamespace()}`,L=>{if(!I)return;const Y=j.getAbsolutePosition(),Z=Y.x-I.x,ae=Y.y-I.y;this.nodes().forEach(ee=>{if(ee===j||ee.isDragging())return;const ne=ee.getAbsolutePosition();ee.setAbsolutePosition({x:ne.x+Z,y:ne.y+ae}),ee.startDrag(L)}),I=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(j=>{j.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(j,I=this.rotation(),L){const Y=j.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),Z=j.getAbsoluteScale(L),ae=j.getAbsolutePosition(L),ee=Y.x*Z.x-j.offsetX()*Z.x,ne=Y.y*Z.y-j.offsetY()*Z.y,B=(i.Konva.getAngle(j.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),V={x:ae.x+ee*Math.cos(B)+ne*Math.sin(-B),y:ae.y+ne*Math.cos(B)+ee*Math.sin(B),width:Y.width*Z.x,height:Y.height*Z.y,rotation:B};return k(V,-i.Konva.getAngle(I),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const I=[];this.nodes().map(B=>{const V=B.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),M=[{x:V.x,y:V.y},{x:V.x+V.width,y:V.y},{x:V.x+V.width,y:V.y+V.height},{x:V.x,y:V.y+V.height}],H=B.getAbsoluteTransform();M.forEach(function(W){const R=H.point(W);I.push(R)})});const L=new e.Transform;L.rotate(-i.Konva.getAngle(this.rotation()));let Y=1/0,Z=1/0,ae=-1/0,ee=-1/0;I.forEach(function(B){const V=L.point(B);Y===void 0&&(Y=ae=V.x,Z=ee=V.y),Y=Math.min(Y,V.x),Z=Math.min(Z,V.y),ae=Math.max(ae,V.x),ee=Math.max(ee,V.y)}),L.invert();const ne=L.point({x:Y,y:Z});return{x:ne.x,y:ne.y,width:ae-Y,height:ee-Z,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),w.forEach(j=>{this._createAnchor(j)}),this._createAnchor("rotater")}_createAnchor(j){const I=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:j+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:x?10:"auto"}),L=this;I.on("mousedown touchstart",function(Y){L._handleMouseDown(Y)}),I.on("dragstart",Y=>{I.stopDrag(),Y.cancelBubble=!0}),I.on("dragend",Y=>{Y.cancelBubble=!0}),I.on("mouseenter",()=>{const Y=i.Konva.getAngle(this.rotation()),Z=this.rotateAnchorCursor(),ae=v(j,Y,Z);I.getStage().content&&(I.getStage().content.style.cursor=ae),this._cursorChange=!0}),I.on("mouseout",()=>{I.getStage().content&&(I.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(I)}_createBack(){const j=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(I,L){const Y=L.getParent(),Z=Y.padding();I.beginPath(),I.rect(-Z,-Z,L.width()+Z*2,L.height()+Z*2),I.moveTo(L.width()/2,-Z),Y.rotateEnabled()&&Y.rotateLineVisible()&&I.lineTo(L.width()/2,-Y.rotateAnchorOffset()*e.Util._sign(L.height())-Z),I.fillStrokeShape(L)},hitFunc:(I,L)=>{if(!this.shouldOverdrawWholeArea())return;const Y=this.padding();I.beginPath(),I.rect(-Y,-Y,L.width()+Y*2,L.height()+Y*2),I.fillStrokeShape(L)}});this.add(j),this._proxyDrag(j),j.on("dragstart",I=>{I.cancelBubble=!0}),j.on("dragmove",I=>{I.cancelBubble=!0}),j.on("dragend",I=>{I.cancelBubble=!0}),this.on("dragmove",I=>{this.update()})}_handleMouseDown(j){if(this._transforming)return;this._movingAnchorName=j.target.name().split(" ")[0];const I=this._getNodeRect(),L=I.width,Y=I.height,Z=Math.sqrt(Math.pow(L,2)+Math.pow(Y,2));this.sin=Math.abs(Y/Z),this.cos=Math.abs(L/Z),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const ae=j.target.getAbsolutePosition(),ee=j.target.getStage().getPointerPosition();this._anchorDragOffset={x:ee.x-ae.x,y:ee.y-ae.y},E++,this._fire("transformstart",{evt:j.evt,target:this.getNode()}),this._nodes.forEach(ne=>{ne._fire("transformstart",{evt:j.evt,target:ne})})}_handleMouseMove(j){let I,L,Y;const Z=this.findOne("."+this._movingAnchorName),ae=Z.getStage();ae.setPointersPositions(j);const ee=ae.getPointerPosition();let ne={x:ee.x-this._anchorDragOffset.x,y:ee.y-this._anchorDragOffset.y};const B=Z.getAbsolutePosition();this.anchorDragBoundFunc()&&(ne=this.anchorDragBoundFunc()(B,ne,j)),Z.setAbsolutePosition(ne);const V=Z.getAbsolutePosition();if(B.x===V.x&&B.y===V.y)return;if(this._movingAnchorName==="rotater"){const se=this._getNodeRect();I=Z.x()-se.width/2,L=-Z.y()+se.height/2;let X=Math.atan2(-L,I)+Math.PI/2;se.height<0&&(X-=Math.PI);const le=i.Konva.getAngle(this.rotation())+X,ce=i.Konva.getAngle(this.rotationSnapTolerance()),re=N(this.rotationSnaps(),le,ce)-se.rotation,pe=_(se,re);this._fitNodesInto(pe,j);return}const M=this.shiftBehavior();let H;M==="inverted"?H=this.keepRatio()&&!j.shiftKey:M==="none"?H=this.keepRatio():H=this.keepRatio()||j.shiftKey;let W=this.centeredScaling()||j.altKey;if(this._movingAnchorName==="top-left"){if(H){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};Y=Math.sqrt(Math.pow(se.x-Z.x(),2)+Math.pow(se.y-Z.y(),2));const X=this.findOne(".top-left").x()>se.x?-1:1,ie=this.findOne(".top-left").y()>se.y?-1:1;I=Y*this.cos*X,L=Y*this.sin*ie,this.findOne(".top-left").x(se.x-I),this.findOne(".top-left").y(se.y-L)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(Z.y());else if(this._movingAnchorName==="top-right"){if(H){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};Y=Math.sqrt(Math.pow(Z.x()-se.x,2)+Math.pow(se.y-Z.y(),2));const X=this.findOne(".top-right").x()<se.x?-1:1,ie=this.findOne(".top-right").y()>se.y?-1:1;I=Y*this.cos*X,L=Y*this.sin*ie,this.findOne(".top-right").x(se.x+I),this.findOne(".top-right").y(se.y-L)}var R=Z.position();this.findOne(".top-left").y(R.y),this.findOne(".bottom-right").x(R.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(Z.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(Z.x());else if(this._movingAnchorName==="bottom-left"){if(H){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};Y=Math.sqrt(Math.pow(se.x-Z.x(),2)+Math.pow(Z.y()-se.y,2));const X=se.x<Z.x()?-1:1,ie=Z.y()<se.y?-1:1;I=Y*this.cos*X,L=Y*this.sin*ie,Z.x(se.x-I),Z.y(se.y+L)}R=Z.position(),this.findOne(".top-left").x(R.x),this.findOne(".bottom-right").y(R.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(Z.y());else if(this._movingAnchorName==="bottom-right"){if(H){const se=W?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};Y=Math.sqrt(Math.pow(Z.x()-se.x,2)+Math.pow(Z.y()-se.y,2));const X=this.findOne(".bottom-right").x()<se.x?-1:1,ie=this.findOne(".bottom-right").y()<se.y?-1:1;I=Y*this.cos*X,L=Y*this.sin*ie,this.findOne(".bottom-right").x(se.x+I),this.findOne(".bottom-right").y(se.y+L)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(W=this.centeredScaling()||j.altKey,W){const se=this.findOne(".top-left"),X=this.findOne(".bottom-right"),ie=se.x(),le=se.y(),ce=this.getWidth()-X.x(),be=this.getHeight()-X.y();X.move({x:-ie,y:-le}),se.move({x:ce,y:be})}const z=this.findOne(".top-left").getAbsolutePosition();I=z.x,L=z.y;const K=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),J=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:I,y:L,width:K,height:J,rotation:i.Konva.getAngle(this.rotation())},j)}_handleMouseUp(j){this._removeEvents(j)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(j){var I;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const L=this.getNode();E--,this._fire("transformend",{evt:j,target:L}),(I=this.getLayer())===null||I===void 0||I.batchDraw(),L&&this._nodes.forEach(Y=>{var Z;Y._fire("transformend",{evt:j,target:Y}),(Z=Y.getLayer())===null||Z===void 0||Z.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(j,I){const L=this._getNodeRect(),Y=1;if(e.Util._inRange(j.width,-this.padding()*2-Y,Y)){this.update();return}if(e.Util._inRange(j.height,-this.padding()*2-Y,Y)){this.update();return}const Z=new e.Transform;if(Z.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("left")>=0){const H=Z.point({x:-this.padding()*2,y:0});j.x+=H.x,j.y+=H.y,j.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y}else if(this._movingAnchorName&&j.width<0&&this._movingAnchorName.indexOf("right")>=0){const H=Z.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y,j.width+=this.padding()*2}if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("top")>=0){const H=Z.point({x:0,y:-this.padding()*2});j.x+=H.x,j.y+=H.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y,j.height+=this.padding()*2}else if(this._movingAnchorName&&j.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const H=Z.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=H.x,this._anchorDragOffset.y-=H.y,j.height+=this.padding()*2}if(this.boundBoxFunc()){const H=this.boundBoxFunc()(L,j);H?j=H:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const ae=1e7,ee=new e.Transform;ee.translate(L.x,L.y),ee.rotate(L.rotation),ee.scale(L.width/ae,L.height/ae);const ne=new e.Transform,B=j.width/ae,V=j.height/ae;this.flipEnabled()===!1?(ne.translate(j.x,j.y),ne.rotate(j.rotation),ne.translate(j.width<0?j.width:0,j.height<0?j.height:0),ne.scale(Math.abs(B),Math.abs(V))):(ne.translate(j.x,j.y),ne.rotate(j.rotation),ne.scale(B,V));const M=ne.multiply(ee.invert());this._nodes.forEach(H=>{var W;const R=H.getParent().getAbsoluteTransform(),z=H.getTransform().copy();z.translate(H.offsetX(),H.offsetY());const K=new e.Transform;K.multiply(R.copy().invert()).multiply(M).multiply(R).multiply(z);const J=K.decompose();H.setAttrs(J),(W=H.getLayer())===null||W===void 0||W.batchDraw()}),this.rotation(e.Util._getRotation(j.rotation)),this._nodes.forEach(H=>{this._fire("transform",{evt:I,target:H}),H._fire("transform",{evt:I,target:H})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(j,I){this.findOne(j).setAttrs(I)}update(){var j;const I=this._getNodeRect();this.rotation(e.Util._getRotation(I.rotation));const L=I.width,Y=I.height,Z=this.enabledAnchors(),ae=this.resizeEnabled(),ee=this.padding(),ne=this.anchorSize(),B=this.find("._anchor");B.forEach(M=>{M.setAttrs({width:ne,height:ne,offsetX:ne/2,offsetY:ne/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:ne/2+ee,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:L/2,y:0,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:L,y:0,offsetX:ne/2-ee,offsetY:ne/2+ee,visible:ae&&Z.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:Y/2,offsetX:ne/2+ee,visible:ae&&Z.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:L,y:Y/2,offsetX:ne/2-ee,visible:ae&&Z.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:Y,offsetX:ne/2+ee,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:L/2,y:Y,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:L,y:Y,offsetX:ne/2-ee,offsetY:ne/2-ee,visible:ae&&Z.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:L/2,y:-this.rotateAnchorOffset()*e.Util._sign(Y)-ee,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:L,height:Y,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const V=this.anchorStyleFunc();V&&B.forEach(M=>{V(M)}),(j=this.getLayer())===null||j===void 0||j.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const j=this.findOne("."+this._movingAnchorName);j&&j.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(j){return r.Node.prototype.clone.call(this,j)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Sx.Transformer=P,P.isTransforming=()=>E>0;function F(A){return A instanceof Array||e.Util.warn("enabledAnchors value should be an array"),A instanceof Array&&A.forEach(function(j){w.indexOf(j)===-1&&e.Util.warn("Unknown anchor name: "+j+". Available names are: "+w.join(", "))}),A||[]}return P.prototype.className="Transformer",(0,c._registerNode)(P),t.Factory.addGetterSetter(P,"enabledAnchors",w,F),t.Factory.addGetterSetter(P,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(P,"resizeEnabled",!0),t.Factory.addGetterSetter(P,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateEnabled",!0),t.Factory.addGetterSetter(P,"rotateLineVisible",!0),t.Factory.addGetterSetter(P,"rotationSnaps",[]),t.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderEnabled",!0),t.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"anchorFill","white"),t.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderDash"),t.Factory.addGetterSetter(P,"keepRatio",!0),t.Factory.addGetterSetter(P,"shiftBehavior","default"),t.Factory.addGetterSetter(P,"centeredScaling",!1),t.Factory.addGetterSetter(P,"ignoreStroke",!1),t.Factory.addGetterSetter(P,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"nodes"),t.Factory.addGetterSetter(P,"node"),t.Factory.addGetterSetter(P,"boundBoxFunc"),t.Factory.addGetterSetter(P,"anchorDragBoundFunc"),t.Factory.addGetterSetter(P,"anchorStyleFunc"),t.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),t.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Sx}var kx={},V6;function HQ(){if(V6)return kx;V6=1,Object.defineProperty(kx,"__esModule",{value:!0}),kx.Wedge=void 0;const e=ln(),t=Wa(),r=tn(),n=dn(),s=tn();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return kx.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),kx}var Cx={},K6;function GQ(){if(K6)return Cx;K6=1,Object.defineProperty(Cx,"__esModule",{value:!0}),Cx.Blur=void 0;const e=ln(),t=Js(),r=dn();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,u){const d=c.data,f=c.width,g=c.height;let p,x,v,w,C,k,_,N,E,P,F,A,j,I,L,Y,Z,ae,ee,ne;const B=u+u+1,V=f-1,M=g-1,H=u+1,W=H*(H+1)/2,R=new n,z=s[u],K=a[u];let J=null,se=R,X=null,ie=null;for(let le=1;le<B;le++)se=se.next=new n,le===H&&(J=se);se.next=R,v=x=0;for(let le=0;le<g;le++){A=j=I=L=w=C=k=_=0,N=H*(Y=d[x]),E=H*(Z=d[x+1]),P=H*(ae=d[x+2]),F=H*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*ae,_+=W*ee,se=R;for(let ce=0;ce<H;ce++)se.r=Y,se.g=Z,se.b=ae,se.a=ee,se=se.next;for(let ce=1;ce<H;ce++)p=x+((V<ce?V:ce)<<2),w+=(se.r=Y=d[p])*(ne=H-ce),C+=(se.g=Z=d[p+1])*ne,k+=(se.b=ae=d[p+2])*ne,_+=(se.a=ee=d[p+3])*ne,A+=Y,j+=Z,I+=ae,L+=ee,se=se.next;X=R,ie=J;for(let ce=0;ce<f;ce++)d[x+3]=ee=_*z>>K,ee!==0?(ee=255/ee,d[x]=(w*z>>K)*ee,d[x+1]=(C*z>>K)*ee,d[x+2]=(k*z>>K)*ee):d[x]=d[x+1]=d[x+2]=0,w-=N,C-=E,k-=P,_-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=v+((p=ce+u+1)<V?p:V)<<2,A+=X.r=d[p],j+=X.g=d[p+1],I+=X.b=d[p+2],L+=X.a=d[p+3],w+=A,C+=j,k+=I,_+=L,X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=ae=ie.b,F+=ee=ie.a,A-=Y,j-=Z,I-=ae,L-=ee,ie=ie.next,x+=4;v+=f}for(let le=0;le<f;le++){j=I=L=A=C=k=_=w=0,x=le<<2,N=H*(Y=d[x]),E=H*(Z=d[x+1]),P=H*(ae=d[x+2]),F=H*(ee=d[x+3]),w+=W*Y,C+=W*Z,k+=W*ae,_+=W*ee,se=R;for(let be=0;be<H;be++)se.r=Y,se.g=Z,se.b=ae,se.a=ee,se=se.next;let ce=f;for(let be=1;be<=u;be++)x=ce+le<<2,w+=(se.r=Y=d[x])*(ne=H-be),C+=(se.g=Z=d[x+1])*ne,k+=(se.b=ae=d[x+2])*ne,_+=(se.a=ee=d[x+3])*ne,A+=Y,j+=Z,I+=ae,L+=ee,se=se.next,be<M&&(ce+=f);x=le,X=R,ie=J;for(let be=0;be<g;be++)p=x<<2,d[p+3]=ee=_*z>>K,ee>0?(ee=255/ee,d[p]=(w*z>>K)*ee,d[p+1]=(C*z>>K)*ee,d[p+2]=(k*z>>K)*ee):d[p]=d[p+1]=d[p+2]=0,w-=N,C-=E,k-=P,_-=F,N-=X.r,E-=X.g,P-=X.b,F-=X.a,p=le+((p=be+H)<M?p:M)*f<<2,w+=A+=X.r=d[p],C+=j+=X.g=d[p+1],k+=I+=X.b=d[p+2],_+=L+=X.a=d[p+3],X=X.next,N+=Y=ie.r,E+=Z=ie.g,P+=ae=ie.b,F+=ee=ie.a,A-=Y,j-=Z,I-=ae,L-=ee,ie=ie.next,x+=f}}const o=function(u){const d=Math.round(this.blurRadius());d>0&&i(u,d)};return Cx.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Cx}var Tx={},q6;function VQ(){if(q6)return Tx;q6=1,Object.defineProperty(Tx,"__esModule",{value:!0}),Tx.Brighten=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return Tx.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Tx}var Ex={},Y6;function KQ(){if(Y6)return Ex;Y6=1,Object.defineProperty(Ex,"__esModule",{value:!0}),Ex.Contrast=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let c=150,u=150,d=150;for(let f=0;f<o;f+=4)c=i[f],u=i[f+1],d=i[f+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,c=c<0?0:c>255?255:c,u=u<0?0:u>255?255:u,d=d<0?0:d>255?255:d,i[f]=c,i[f+1]=u,i[f+2]=d};return Ex.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ex}var Nx={},X6;function qQ(){if(X6)return Nx;X6=1,Object.defineProperty(Nx,"__esModule",{value:!0}),Nx.Emboss=void 0;const e=ln(),t=Js(),r=Bs(),n=dn(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,c=this.embossDirection(),u=this.embossBlend(),d=a.data,f=a.width,g=a.height,p=f*4;let x=0,v=0,w=g;switch(c){case"top-left":x=-1,v=-1;break;case"top":x=-1,v=0;break;case"top-right":x=-1,v=1;break;case"right":x=0,v=1;break;case"bottom-right":x=1,v=1;break;case"bottom":x=1,v=0;break;case"bottom-left":x=1,v=-1;break;case"left":x=0,v=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const C=(w-1)*p;let k=x;w+k<1&&(k=0),w+k>g&&(k=0);const _=(w-1+k)*f*4;let N=f;do{const E=C+(N-1)*4;let P=v;N+P<1&&(P=0),N+P>f&&(P=0);const F=_+(N-1+P)*4,A=d[E]-d[F],j=d[E+1]-d[F+1],I=d[E+2]-d[F+2];let L=A;const Y=L>0?L:-L,Z=j>0?j:-j,ae=I>0?I:-I;if(Z>Y&&(L=j),ae>Y&&(L=I),L*=i,u){const ee=d[E]+L,ne=d[E+1]+L,B=d[E+2]+L;d[E]=ee>255?255:ee<0?0:ee,d[E+1]=ne>255?255:ne<0?0:ne,d[E+2]=B>255?255:B<0?0:B}else{let ee=o-L;ee<0?ee=0:ee>255&&(ee=255),d[E]=d[E+1]=d[E+2]=ee}}while(--N)}while(--w)};return Nx.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Nx}var Ax={},J6;function YQ(){if(J6)return Ax;J6=1,Object.defineProperty(Ax,"__esModule",{value:!0}),Ax.Enhance=void 0;const e=ln(),t=Js(),r=dn();function n(a,i,o,c,u){const d=o-i,f=u-c;if(d===0)return c+f/2;if(f===0)return c;let g=(a-i)/d;return g=f*g+c,g}const s=function(a){const i=a.data,o=i.length;let c=i[0],u=c,d,f=i[1],g=f,p,x=i[2],v=x,w;const C=this.enhance();if(C===0)return;for(let A=0;A<o;A+=4)d=i[A+0],d<c?c=d:d>u&&(u=d),p=i[A+1],p<f?f=p:p>g&&(g=p),w=i[A+2],w<x?x=w:w>v&&(v=w);u===c&&(u=255,c=0),g===f&&(g=255,f=0),v===x&&(v=255,x=0);let k,_,N,E,P,F;if(C>0)k=u+C*(255-u),_=c-C*(c-0),N=g+C*(255-g),E=f-C*(f-0),P=v+C*(255-v),F=x-C*(x-0);else{const A=(u+c)*.5;k=u+C*(u-A),_=c+C*(c-A);const j=(g+f)*.5;N=g+C*(g-j),E=f+C*(f-j);const I=(v+x)*.5;P=v+C*(v-I),F=x+C*(x-I)}for(let A=0;A<o;A+=4)i[A+0]=n(i[A+0],c,u,_,k),i[A+1]=n(i[A+1],f,g,E,N),i[A+2]=n(i[A+2],x,v,F,P)};return Ax.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ax}var jx={},Q6;function XQ(){if(Q6)return jx;Q6=1,Object.defineProperty(jx,"__esModule",{value:!0}),jx.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return jx.Grayscale=e,jx}var Px={},Z6;function JQ(){if(Z6)return Px;Z6=1,Object.defineProperty(Px,"__esModule",{value:!0}),Px.HSL=void 0;const e=ln(),t=Js(),r=dn();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=this.luminance()*127,f=o*c*Math.cos(u*Math.PI/180),g=o*c*Math.sin(u*Math.PI/180),p=.299*o+.701*f+.167*g,x=.587*o-.587*f+.33*g,v=.114*o-.114*f-.497*g,w=.299*o-.299*f-.328*g,C=.587*o+.413*f+.035*g,k=.114*o-.114*f+.293*g,_=.299*o-.3*f+1.25*g,N=.587*o-.586*f-1.05*g,E=.114*o+.886*f-.2*g;let P,F,A,j;for(let I=0;I<i;I+=4)P=a[I+0],F=a[I+1],A=a[I+2],j=a[I+3],a[I+0]=p*P+x*F+v*A+d,a[I+1]=w*P+C*F+k*A+d,a[I+2]=_*P+N*F+E*A+d,a[I+3]=j};return Px.HSL=n,Px}var Fx={},eP;function QQ(){if(eP)return Fx;eP=1,Object.defineProperty(Fx,"__esModule",{value:!0}),Fx.HSV=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=o*c*Math.cos(u*Math.PI/180),f=o*c*Math.sin(u*Math.PI/180),g=.299*o+.701*d+.167*f,p=.587*o-.587*d+.33*f,x=.114*o-.114*d-.497*f,v=.299*o-.299*d-.328*f,w=.587*o+.413*d+.035*f,C=.114*o-.114*d+.293*f,k=.299*o-.3*d+1.25*f,_=.587*o-.586*d-1.05*f,N=.114*o+.886*d-.2*f;for(let E=0;E<i;E+=4){const P=a[E+0],F=a[E+1],A=a[E+2],j=a[E+3];a[E+0]=g*P+p*F+x*A,a[E+1]=v*P+w*F+C*A,a[E+2]=k*P+_*F+N*A,a[E+3]=j}};return Fx.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Fx}var Ox={},tP;function ZQ(){if(tP)return Ox;tP=1,Object.defineProperty(Ox,"__esModule",{value:!0}),Ox.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return Ox.Invert=e,Ox}var Dx={},rP;function eZ(){if(rP)return Dx;rP=1,Object.defineProperty(Dx,"__esModule",{value:!0}),Dx.Kaleidoscope=void 0;const e=ln(),t=Js(),r=Bs(),n=dn(),s=function(o,c,u){const d=o.data,f=c.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const _=Math.sqrt(C*C+k*k);w=_>w?_:w;const N=p,E=g,P=360/E*Math.PI/180;for(let F=0;F<E;F+=1){const A=Math.sin(F*P),j=Math.cos(F*P);for(let I=0;I<N;I+=1){C=Math.floor(x+w*I/N*j),k=Math.floor(v+w*I/N*A);let L=(k*g+C)*4;const Y=d[L+0],Z=d[L+1],ae=d[L+2],ee=d[L+3];L=(F+I*g)*4,f[L+0]=Y,f[L+1]=Z,f[L+2]=ae,f[L+3]=ee}}},a=function(o,c,u){const d=o.data,f=c.data,g=o.width,p=o.height,x=u.polarCenterX||g/2,v=u.polarCenterY||p/2;let w=Math.sqrt(x*x+v*v),C=g-x,k=p-v;const _=Math.sqrt(C*C+k*k);w=_>w?_:w;const N=p,E=g,P=0;let F,A;for(C=0;C<g;C+=1)for(k=0;k<p;k+=1){const j=C-x,I=k-v,L=Math.sqrt(j*j+I*I)*N/w;let Y=(Math.atan2(I,j)*180/Math.PI+360+P)%360;Y=Y*E/360,F=Math.floor(Y),A=Math.floor(L);let Z=(A*g+F)*4;const ae=d[Z+0],ee=d[Z+1],ne=d[Z+2],B=d[Z+3];Z=(k*g+C)*4,f[Z+0]=ae,f[Z+1]=ee,f[Z+2]=ne,f[Z+3]=B}},i=function(o){const c=o.width,u=o.height;let d,f,g,p,x,v,w,C,k,_,N=Math.round(this.kaleidoscopePower());const E=Math.round(this.kaleidoscopeAngle()),P=Math.floor(c*(E%360)/360);if(N<1)return;const F=r.Util.createCanvasElement();F.width=c,F.height=u;const A=F.getContext("2d").getImageData(0,0,c,u);r.Util.releaseCanvas(F),s(o,A,{polarCenterX:c/2,polarCenterY:u/2});let j=c/Math.pow(2,N);for(;j<=8;)j=j*2,N-=1;j=Math.ceil(j);let I=j,L=0,Y=I,Z=1;for(P+j>c&&(L=I,Y=0,Z=-1),f=0;f<u;f+=1)for(d=L;d!==Y;d+=Z)g=Math.round(d+P)%c,k=(c*f+g)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],_=(c*f+d)*4,A.data[_+0]=x,A.data[_+1]=v,A.data[_+2]=w,A.data[_+3]=C;for(f=0;f<u;f+=1)for(I=Math.floor(j),p=0;p<N;p+=1){for(d=0;d<I+1;d+=1)k=(c*f+d)*4,x=A.data[k+0],v=A.data[k+1],w=A.data[k+2],C=A.data[k+3],_=(c*f+I*2-d-1)*4,A.data[_+0]=x,A.data[_+1]=v,A.data[_+2]=w,A.data[_+3]=C;I*=2}a(A,o,{})};return Dx.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Dx}var Ix={},nP;function tZ(){if(nP)return Ix;nP=1,Object.defineProperty(Ix,"__esModule",{value:!0}),Ix.Mask=void 0;const e=ln(),t=Js(),r=dn();function n(g,p,x){let v=(x*g.width+p)*4;const w=[];return w.push(g.data[v++],g.data[v++],g.data[v++],g.data[v++]),w}function s(g,p){return Math.sqrt(Math.pow(g[0]-p[0],2)+Math.pow(g[1]-p[1],2)+Math.pow(g[2]-p[2],2))}function a(g){const p=[0,0,0];for(let x=0;x<g.length;x++)p[0]+=g[x][0],p[1]+=g[x][1],p[2]+=g[x][2];return p[0]/=g.length,p[1]/=g.length,p[2]/=g.length,p}function i(g,p){const x=n(g,0,0),v=n(g,g.width-1,0),w=n(g,0,g.height-1),C=n(g,g.width-1,g.height-1),k=p||10;if(s(x,v)<k&&s(v,C)<k&&s(C,w)<k&&s(w,x)<k){const _=a([v,x,C,w]),N=[];for(let E=0;E<g.width*g.height;E++){const P=s(_,[g.data[E*4],g.data[E*4+1],g.data[E*4+2]]);N[E]=P<k?0:255}return N}}function o(g,p){for(let x=0;x<g.width*g.height;x++)g.data[4*x+3]=p[x]}function c(g,p,x){const v=[1,1,1,1,0,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const L=j*p+I,Y=v[F*w+A];P+=g[L]*Y}}k[E]=P===2040?255:0}return k}function u(g,p,x){const v=[1,1,1,1,1,1,1,1,1],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const L=j*p+I,Y=v[F*w+A];P+=g[L]*Y}}k[E]=P>=1020?255:0}return k}function d(g,p,x){const v=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],w=Math.round(Math.sqrt(v.length)),C=Math.floor(w/2),k=[];for(let _=0;_<x;_++)for(let N=0;N<p;N++){const E=_*p+N;let P=0;for(let F=0;F<w;F++)for(let A=0;A<w;A++){const j=_+F-C,I=N+A-C;if(j>=0&&j<x&&I>=0&&I<p){const L=j*p+I,Y=v[F*w+A];P+=g[L]*Y}}k[E]=P}return k}const f=function(g){const p=this.threshold();let x=i(g,p);return x&&(x=c(x,g.width,g.height),x=u(x,g.width,g.height),x=d(x,g.width,g.height),o(g,x)),g};return Ix.Mask=f,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ix}var Rx={},sP;function rZ(){if(sP)return Rx;sP=1,Object.defineProperty(Rx,"__esModule",{value:!0}),Rx.Noise=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,c=a/2;for(let u=0;u<o;u+=4)i[u+0]+=c-2*c*Math.random(),i[u+1]+=c-2*c*Math.random(),i[u+2]+=c-2*c*Math.random()};return Rx.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Rx}var Mx={},aP;function nZ(){if(aP)return Mx;aP=1,Object.defineProperty(Mx,"__esModule",{value:!0}),Mx.Pixelate=void 0;const e=ln(),t=Bs(),r=Js(),n=dn(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,c=a.height,u=Math.ceil(o/i),d=Math.ceil(c/i),f=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<u;g+=1)for(let p=0;p<d;p+=1){let x=0,v=0,w=0,C=0;const k=g*i,_=k+i,N=p*i,E=N+i;let P=0;for(let F=k;F<_;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=c)continue;const j=(o*A+F)*4;x+=f[j+0],v+=f[j+1],w+=f[j+2],C+=f[j+3],P+=1}x=x/P,v=v/P,w=w/P,C=C/P;for(let F=k;F<_;F+=1)if(!(F>=o))for(let A=N;A<E;A+=1){if(A>=c)continue;const j=(o*A+F)*4;f[j+0]=x,f[j+1]=v,f[j+2]=w,f[j+3]=C}}};return Mx.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Mx}var Lx={},iP;function sZ(){if(iP)return Lx;iP=1,Object.defineProperty(Lx,"__esModule",{value:!0}),Lx.Posterize=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,c=255/a;for(let u=0;u<o;u+=1)i[u]=Math.floor(i[u]/c)*c};return Lx.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Lx}var Bx={},oP;function aZ(){if(oP)return Bx;oP=1,Object.defineProperty(Bx,"__esModule",{value:!0}),Bx.RGB=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue();for(let d=0;d<i;d+=4){const f=(.34*a[d]+.5*a[d+1]+.16*a[d+2])/255;a[d]=f*o,a[d+1]=f*c,a[d+2]=f*u,a[d+3]=a[d+3]}};return Bx.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),Bx}var $x={},lP;function iZ(){if(lP)return $x;lP=1,Object.defineProperty($x,"__esModule",{value:!0}),$x.RGBA=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue(),d=this.alpha();for(let f=0;f<i;f+=4){const g=1-d;a[f]=o*d+a[f]*g,a[f+1]=c*d+a[f+1]*g,a[f+2]=u*d+a[f+2]*g}};return $x.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),$x}var Ux={},cP;function oZ(){if(cP)return Ux;cP=1,Object.defineProperty(Ux,"__esModule",{value:!0}),Ux.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return Ux.Sepia=e,Ux}var zx={},uP;function lZ(){if(uP)return zx;uP=1,Object.defineProperty(zx,"__esModule",{value:!0}),zx.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let c=n;do{const u=o+(c-1)*4;let d=r[u],f=r[u+1],g=r[u+2];d>127&&(d=255-d),f>127&&(f=255-f),g>127&&(g=255-g),r[u]=d,r[u+1]=f,r[u+2]=g}while(--c)}while(--i)};return zx.Solarize=e,zx}var Wx={},dP;function cZ(){if(dP)return Wx;dP=1,Object.defineProperty(Wx,"__esModule",{value:!0}),Wx.Threshold=void 0;const e=ln(),t=Js(),r=dn(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=1)i[c]=i[c]<a?0:255};return Wx.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Wx}var fP;function uZ(){if(fP)return nx;fP=1,Object.defineProperty(nx,"__esModule",{value:!0}),nx.Konva=void 0;const e=PT(),t=PQ(),r=OQ(),n=DQ(),s=IQ(),a=RQ(),i=MQ(),o=mL(),c=ZN(),u=pL(),d=LQ(),f=BQ(),g=$Q(),p=UQ(),x=xL(),v=zQ(),w=WQ(),C=HQ(),k=GQ(),_=VQ(),N=KQ(),E=qQ(),P=YQ(),F=XQ(),A=JQ(),j=QQ(),I=ZQ(),L=eZ(),Y=tZ(),Z=rZ(),ae=nZ(),ee=sZ(),ne=aZ(),B=iZ(),V=oZ(),M=lZ(),H=cZ();return nx.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:c.Path,Rect:u.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:g.Sprite,Star:p.Star,Text:x.Text,TextPath:v.TextPath,Transformer:w.Transformer,Wedge:C.Wedge,Filters:{Blur:k.Blur,Brighten:_.Brighten,Contrast:N.Contrast,Emboss:E.Emboss,Enhance:P.Enhance,Grayscale:F.Grayscale,HSL:A.HSL,HSV:j.HSV,Invert:I.Invert,Kaleidoscope:L.Kaleidoscope,Mask:Y.Mask,Noise:Z.Noise,Pixelate:ae.Pixelate,Posterize:ee.Posterize,RGB:ne.RGB,RGBA:B.RGBA,Sepia:V.Sepia,Solarize:M.Solarize,Threshold:H.Threshold}}),nx}var dZ=e_.exports,hP;function fZ(){if(hP)return e_.exports;hP=1,Object.defineProperty(dZ,"__esModule",{value:!0});const e=uZ();return e_.exports=e.Konva,e_.exports}var yL=fZ();const hZ=Ol(yL),gZ=mM({__proto__:null,default:hZ},[yL]);var fw={exports:{}},gP;function mZ(){return gP||(gP=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=PT();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=PT();e.exports=n.Konva})(fw,fw.exports)),fw.exports}var pZ=mZ();const zy=Ol(pZ);var qS={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var YS,mP;function xZ(){return mP||(mP=1,YS=function(t){var r={},n=k0(),s=fN(),a=Object.assign;function i(y){for(var b="https://reactjs.org/docs/error-decoder.html?invariant="+y,O=1;O<arguments.length;O++)b+="&args[]="+encodeURIComponent(arguments[O]);return"Minified React error #"+y+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),p=Symbol.for("react.provider"),x=Symbol.for("react.context"),v=Symbol.for("react.forward_ref"),w=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),E=Symbol.iterator;function P(y){return y===null||typeof y!="object"?null:(y=E&&y[E]||y["@@iterator"],typeof y=="function"?y:null)}function F(y){if(y==null)return null;if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y;switch(y){case d:return"Fragment";case u:return"Portal";case g:return"Profiler";case f:return"StrictMode";case w:return"Suspense";case C:return"SuspenseList"}if(typeof y=="object")switch(y.$$typeof){case x:return(y.displayName||"Context")+".Consumer";case p:return(y._context.displayName||"Context")+".Provider";case v:var b=y.render;return y=y.displayName,y||(y=b.displayName||b.name||"",y=y!==""?"ForwardRef("+y+")":"ForwardRef"),y;case k:return b=y.displayName||null,b!==null?b:F(y.type)||"Memo";case _:b=y._payload,y=y._init;try{return F(y(b))}catch{}}return null}function A(y){var b=y.type;switch(y.tag){case 24:return"Cache";case 9:return(b.displayName||"Context")+".Consumer";case 10:return(b._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return y=b.render,y=y.displayName||y.name||"",b.displayName||(y!==""?"ForwardRef("+y+")":"ForwardRef");case 7:return"Fragment";case 5:return b;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(b);case 8:return b===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof b=="function")return b.displayName||b.name||null;if(typeof b=="string")return b}return null}function j(y){var b=y,O=y;if(y.alternate)for(;b.return;)b=b.return;else{y=b;do b=y,(b.flags&4098)!==0&&(O=b.return),y=b.return;while(y)}return b.tag===3?O:null}function I(y){if(j(y)!==y)throw Error(i(188))}function L(y){var b=y.alternate;if(!b){if(b=j(y),b===null)throw Error(i(188));return b!==y?null:y}for(var O=y,U=b;;){var q=O.return;if(q===null)break;var te=q.alternate;if(te===null){if(U=q.return,U!==null){O=U;continue}break}if(q.child===te.child){for(te=q.child;te;){if(te===O)return I(q),y;if(te===U)return I(q),b;te=te.sibling}throw Error(i(188))}if(O.return!==U.return)O=q,U=te;else{for(var ve=!1,Ge=q.child;Ge;){if(Ge===O){ve=!0,O=q,U=te;break}if(Ge===U){ve=!0,U=q,O=te;break}Ge=Ge.sibling}if(!ve){for(Ge=te.child;Ge;){if(Ge===O){ve=!0,O=te,U=q;break}if(Ge===U){ve=!0,U=te,O=q;break}Ge=Ge.sibling}if(!ve)throw Error(i(189))}}if(O.alternate!==U)throw Error(i(190))}if(O.tag!==3)throw Error(i(188));return O.stateNode.current===O?y:b}function Y(y){return y=L(y),y!==null?Z(y):null}function Z(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){var b=Z(y);if(b!==null)return b;y=y.sibling}return null}function ae(y){if(y.tag===5||y.tag===6)return y;for(y=y.child;y!==null;){if(y.tag!==4){var b=ae(y);if(b!==null)return b}y=y.sibling}return null}var ee=Array.isArray,ne=t.getPublicInstance,B=t.getRootHostContext,V=t.getChildHostContext,M=t.prepareForCommit,H=t.resetAfterCommit,W=t.createInstance,R=t.appendInitialChild,z=t.finalizeInitialChildren,K=t.prepareUpdate,J=t.shouldSetTextContent,se=t.createTextInstance,X=t.scheduleTimeout,ie=t.cancelTimeout,le=t.noTimeout,ce=t.isPrimaryRenderer,be=t.supportsMutation,re=t.supportsPersistence,pe=t.supportsHydration,Ce=t.getInstanceFromNode,Ae=t.preparePortalMount,We=t.getCurrentEventPriority,Le=t.detachDeletedInstance,At=t.supportsMicrotasks,Qe=t.scheduleMicrotask,gt=t.supportsTestSelectors,ht=t.findFiberRoot,tt=t.getBoundingRect,ut=t.getTextContent,Dt=t.isHiddenSubtree,Rt=t.matchAccessibilityRole,It=t.setFocusIfFocusable,De=t.setupIntersectionObserver,Ie=t.appendChild,Je=t.appendChildToContainer,qe=t.commitTextUpdate,Ze=t.commitMount,Tt=t.commitUpdate,Nt=t.insertBefore,$t=t.insertInContainerBefore,ir=t.removeChild,pr=t.removeChildFromContainer,Nr=t.resetTextContent,dr=t.hideInstance,Vt=t.hideTextInstance,ge=t.unhideInstance,Te=t.unhideTextInstance,Fe=t.clearContainer,Me=t.cloneInstance,kt=t.createContainerChildSet,Pe=t.appendChildToContainerChildSet,He=t.finalizeContainerChildren,ke=t.replaceContainerChildren,$e=t.cloneHiddenInstance,Ue=t.cloneHiddenTextInstance,Et=t.canHydrateInstance,Ft=t.canHydrateTextInstance,zt=t.canHydrateSuspenseInstance,fr=t.isSuspenseInstancePending,nr=t.isSuspenseInstanceFallback,Dr=t.getSuspenseInstanceFallbackErrorDetails,ue=t.registerSuspenseInstanceRetry,we=t.getNextHydratableSibling,ye=t.getFirstHydratableChild,xe=t.getFirstHydratableChildWithinContainer,_e=t.getFirstHydratableChildWithinSuspenseInstance,Se=t.hydrateInstance,Ve=t.hydrateTextInstance,lt=t.hydrateSuspenseInstance,Ke=t.getNextHydratableInstanceAfterSuspenseInstance,oe=t.commitHydratedContainer,fe=t.commitHydratedSuspenseInstance,Ee=t.clearSuspenseBoundary,Ne=t.clearSuspenseBoundaryFromContainer,Ye=t.shouldDeleteUnhydratedTailInstances,ot=t.didNotMatchHydratedContainerTextInstance,pt=t.didNotMatchHydratedTextInstance,Gt;function xt(y){if(Gt===void 0)try{throw Error()}catch(O){var b=O.stack.trim().match(/\n( *(at )?)/);Gt=b&&b[1]||""}return`
`+Gt+y}var Jt=!1;function wr(y,b){if(!y||Jt)return"";Jt=!0;var O=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(b)if(b=function(){throw Error()},Object.defineProperty(b.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(b,[])}catch(Kt){var U=Kt}Reflect.construct(y,[],b)}else{try{b.call()}catch(Kt){U=Kt}y.call(b.prototype)}else{try{throw Error()}catch(Kt){U=Kt}y()}}catch(Kt){if(Kt&&U&&typeof Kt.stack=="string"){for(var q=Kt.stack.split(`
`),te=U.stack.split(`
`),ve=q.length-1,Ge=te.length-1;1<=ve&&0<=Ge&&q[ve]!==te[Ge];)Ge--;for(;1<=ve&&0<=Ge;ve--,Ge--)if(q[ve]!==te[Ge]){if(ve!==1||Ge!==1)do if(ve--,Ge--,0>Ge||q[ve]!==te[Ge]){var ft=`
`+q[ve].replace(" at new "," at ");return y.displayName&&ft.includes("<anonymous>")&&(ft=ft.replace("<anonymous>",y.displayName)),ft}while(1<=ve&&0<=Ge);break}}}finally{Jt=!1,Error.prepareStackTrace=O}return(y=y?y.displayName||y.name:"")?xt(y):""}var Sr=Object.prototype.hasOwnProperty,xr=[],Ir=-1;function rn(y){return{current:y}}function Jr(y){0>Ir||(y.current=xr[Ir],xr[Ir]=null,Ir--)}function he(y,b){Ir++,xr[Ir]=y.current,y.current=b}var vt={},kr=rn(vt),Cr=rn(!1),Nn=vt;function _n(y,b){var O=y.type.contextTypes;if(!O)return vt;var U=y.stateNode;if(U&&U.__reactInternalMemoizedUnmaskedChildContext===b)return U.__reactInternalMemoizedMaskedChildContext;var q={},te;for(te in O)q[te]=b[te];return U&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=b,y.__reactInternalMemoizedMaskedChildContext=q),q}function Zr(y){return y=y.childContextTypes,y!=null}function Be(){Jr(Cr),Jr(kr)}function Ct(y,b,O){if(kr.current!==vt)throw Error(i(168));he(kr,b),he(Cr,O)}function qt(y,b,O){var U=y.stateNode;if(b=b.childContextTypes,typeof U.getChildContext!="function")return O;U=U.getChildContext();for(var q in U)if(!(q in b))throw Error(i(108,A(y)||"Unknown",q));return a({},O,U)}function lr(y){return y=(y=y.stateNode)&&y.__reactInternalMemoizedMergedChildContext||vt,Nn=kr.current,he(kr,y),he(Cr,Cr.current),!0}function es(y,b,O){var U=y.stateNode;if(!U)throw Error(i(169));O?(y=qt(y,b,Nn),U.__reactInternalMemoizedMergedChildContext=y,Jr(Cr),Jr(kr),he(kr,y)):Jr(Cr),he(Cr,O)}var Kn=Math.clz32?Math.clz32:Gf,Mi=Math.log,B0=Math.LN2;function Gf(y){return y>>>=0,y===0?32:31-(Mi(y)/B0|0)|0}var cn=64,su=4194304;function st(y){switch(y&-y){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return y&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return y}}function mt(y,b){var O=y.pendingLanes;if(O===0)return 0;var U=0,q=y.suspendedLanes,te=y.pingedLanes,ve=O&268435455;if(ve!==0){var Ge=ve&~q;Ge!==0?U=st(Ge):(te&=ve,te!==0&&(U=st(te)))}else ve=O&~q,ve!==0?U=st(ve):te!==0&&(U=st(te));if(U===0)return 0;if(b!==0&&b!==U&&(b&q)===0&&(q=U&-U,te=b&-b,q>=te||q===16&&(te&4194240)!==0))return b;if((U&4)!==0&&(U|=O&16),b=y.entangledLanes,b!==0)for(y=y.entanglements,b&=U;0<b;)O=31-Kn(b),q=1<<O,U|=y[O],b&=~q;return U}function Yt(y,b){switch(y){case 1:case 2:case 4:return b+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function St(y,b){for(var O=y.suspendedLanes,U=y.pingedLanes,q=y.expirationTimes,te=y.pendingLanes;0<te;){var ve=31-Kn(te),Ge=1<<ve,ft=q[ve];ft===-1?((Ge&O)===0||(Ge&U)!==0)&&(q[ve]=Yt(Ge,b)):ft<=b&&(y.expiredLanes|=Ge),te&=~Ge}}function br(y){return y=y.pendingLanes&-1073741825,y!==0?y:y&1073741824?1073741824:0}function Pt(){var y=cn;return cn<<=1,(cn&4194240)===0&&(cn=64),y}function Wr(y){for(var b=[],O=0;31>O;O++)b.push(y);return b}function nn(y,b,O){y.pendingLanes|=b,b!==536870912&&(y.suspendedLanes=0,y.pingedLanes=0),y=y.eventTimes,b=31-Kn(b),y[b]=O}function rt(y,b){var O=y.pendingLanes&~b;y.pendingLanes=b,y.suspendedLanes=0,y.pingedLanes=0,y.expiredLanes&=b,y.mutableReadLanes&=b,y.entangledLanes&=b,b=y.entanglements;var U=y.eventTimes;for(y=y.expirationTimes;0<O;){var q=31-Kn(O),te=1<<q;b[q]=0,U[q]=-1,y[q]=-1,O&=~te}}function Qt(y,b){var O=y.entangledLanes|=b;for(y=y.entanglements;O;){var U=31-Kn(O),q=1<<U;q&b|y[U]&b&&(y[U]|=b),O&=~q}}var Lt=0;function bn(y){return y&=-y,1<y?4<y?(y&268435455)!==0?16:536870912:4:1}var Gr=s.unstable_scheduleCallback,Vr=s.unstable_cancelCallback,qn=s.unstable_shouldYield,Mn=s.unstable_requestPaint,Yn=s.unstable_now,oo=s.unstable_ImmediatePriority,gc=s.unstable_UserBlockingPriority,$0=s.unstable_NormalPriority,z2=s.unstable_IdlePriority,mc=null,pi=null;function vd(y){if(pi&&typeof pi.onCommitFiberRoot=="function")try{pi.onCommitFiberRoot(mc,y,void 0,(y.current.flags&128)===128)}catch{}}function U0(y,b){return y===b&&(y!==0||1/y===1/b)||y!==y&&b!==b}var Ao=typeof Object.is=="function"?Object.is:U0,Ll=null,wd=!1,_d=!1;function z0(y){Ll===null?Ll=[y]:Ll.push(y)}function d1(y){wd=!0,z0(y)}function fa(){if(!_d&&Ll!==null){_d=!0;var y=0,b=Lt;try{var O=Ll;for(Lt=1;y<O.length;y++){var U=O[y];do U=U(!0);while(U!==null)}Ll=null,wd=!1}catch(q){throw Ll!==null&&(Ll=Ll.slice(y+1)),Gr(oo,fa),q}finally{Lt=b,_d=!1}}return null}var pc=[],Bl=0,Vf=null,au=0,Va=[],Li=0,$s=null,xi=1,jo="";function Po(y,b){pc[Bl++]=au,pc[Bl++]=Vf,Vf=y,au=b}function f1(y,b,O){Va[Li++]=xi,Va[Li++]=jo,Va[Li++]=$s,$s=y;var U=xi;y=jo;var q=32-Kn(U)-1;U&=~(1<<q),O+=1;var te=32-Kn(b)+q;if(30<te){var ve=q-q%5;te=(U&(1<<ve)-1).toString(32),U>>=ve,q-=ve,xi=1<<32-Kn(b)+q|O<<q|U,jo=te+y}else xi=1<<te|O<<q|U,jo=y}function Kf(y){y.return!==null&&(Po(y,1),f1(y,1,0))}function qf(y){for(;y===Vf;)Vf=pc[--Bl],pc[Bl]=null,au=pc[--Bl],pc[Bl]=null;for(;y===$s;)$s=Va[--Li],Va[Li]=null,jo=Va[--Li],Va[Li]=null,xi=Va[--Li],Va[Li]=null}var ha=null,Ka=null,Wn=!1,Yf=!1,Fo=null;function h1(y,b){var O=qi(5,null,null,0);O.elementType="DELETED",O.stateNode=b,O.return=y,b=y.deletions,b===null?(y.deletions=[O],y.flags|=16):b.push(O)}function W0(y,b){switch(y.tag){case 5:return b=Et(b,y.type,y.pendingProps),b!==null?(y.stateNode=b,ha=y,Ka=ye(b),!0):!1;case 6:return b=Ft(b,y.pendingProps),b!==null?(y.stateNode=b,ha=y,Ka=null,!0):!1;case 13:if(b=zt(b),b!==null){var O=$s!==null?{id:xi,overflow:jo}:null;return y.memoizedState={dehydrated:b,treeContext:O,retryLane:1073741824},O=qi(18,null,null,0),O.stateNode=b,O.return=y,y.child=O,ha=y,Ka=null,!0}return!1;default:return!1}}function fp(y){return(y.mode&1)!==0&&(y.flags&128)===0}function hp(y){if(Wn){var b=Ka;if(b){var O=b;if(!W0(y,b)){if(fp(y))throw Error(i(418));b=we(O);var U=ha;b&&W0(y,b)?h1(U,O):(y.flags=y.flags&-4097|2,Wn=!1,ha=y)}}else{if(fp(y))throw Error(i(418));y.flags=y.flags&-4097|2,Wn=!1,ha=y}}}function g1(y){for(y=y.return;y!==null&&y.tag!==5&&y.tag!==3&&y.tag!==13;)y=y.return;ha=y}function H0(y){if(!pe||y!==ha)return!1;if(!Wn)return g1(y),Wn=!0,!1;if(y.tag!==3&&(y.tag!==5||Ye(y.type)&&!J(y.type,y.memoizedProps))){var b=Ka;if(b){if(fp(y))throw m1(),Error(i(418));for(;b;)h1(y,b),b=we(b)}}if(g1(y),y.tag===13){if(!pe)throw Error(i(316));if(y=y.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(i(317));Ka=Ke(y)}else Ka=ha?we(y.stateNode):null;return!0}function m1(){for(var y=Ka;y;)y=we(y)}function iu(){pe&&(Ka=ha=null,Yf=Wn=!1)}function gp(y){Fo===null?Fo=[y]:Fo.push(y)}var W2=o.ReactCurrentBatchConfig;function G0(y,b){if(Ao(y,b))return!0;if(typeof y!="object"||y===null||typeof b!="object"||b===null)return!1;var O=Object.keys(y),U=Object.keys(b);if(O.length!==U.length)return!1;for(U=0;U<O.length;U++){var q=O[U];if(!Sr.call(b,q)||!Ao(y[q],b[q]))return!1}return!0}function H2(y){switch(y.tag){case 5:return xt(y.type);case 16:return xt("Lazy");case 13:return xt("Suspense");case 19:return xt("SuspenseList");case 0:case 2:case 15:return y=wr(y.type,!1),y;case 11:return y=wr(y.type.render,!1),y;case 1:return y=wr(y.type,!0),y;default:return""}}function ou(y,b,O){if(y=O.ref,y!==null&&typeof y!="function"&&typeof y!="object"){if(O._owner){if(O=O._owner,O){if(O.tag!==1)throw Error(i(309));var U=O.stateNode}if(!U)throw Error(i(147,y));var q=U,te=""+y;return b!==null&&b.ref!==null&&typeof b.ref=="function"&&b.ref._stringRef===te?b.ref:(b=function(ve){var Ge=q.refs;ve===null?delete Ge[te]:Ge[te]=ve},b._stringRef=te,b)}if(typeof y!="string")throw Error(i(284));if(!O._owner)throw Error(i(290,y))}return y}function V0(y,b){throw y=Object.prototype.toString.call(b),Error(i(31,y==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":y))}function p1(y){var b=y._init;return b(y._payload)}function x1(y){function b(ct,Xe){if(y){var yt=ct.deletions;yt===null?(ct.deletions=[Xe],ct.flags|=16):yt.push(Xe)}}function O(ct,Xe){if(!y)return null;for(;Xe!==null;)b(ct,Xe),Xe=Xe.sibling;return null}function U(ct,Xe){for(ct=new Map;Xe!==null;)Xe.key!==null?ct.set(Xe.key,Xe):ct.set(Xe.index,Xe),Xe=Xe.sibling;return ct}function q(ct,Xe){return ct=Dc(ct,Xe),ct.index=0,ct.sibling=null,ct}function te(ct,Xe,yt){return ct.index=yt,y?(yt=ct.alternate,yt!==null?(yt=yt.index,yt<Xe?(ct.flags|=2,Xe):yt):(ct.flags|=2,Xe)):(ct.flags|=1048576,Xe)}function ve(ct){return y&&ct.alternate===null&&(ct.flags|=2),ct}function Ge(ct,Xe,yt,or){return Xe===null||Xe.tag!==6?(Xe=Vd(yt,ct.mode,or),Xe.return=ct,Xe):(Xe=q(Xe,yt),Xe.return=ct,Xe)}function ft(ct,Xe,yt,or){var Tr=yt.type;return Tr===d?hr(ct,Xe,yt.props.children,or,yt.key):Xe!==null&&(Xe.elementType===Tr||typeof Tr=="object"&&Tr!==null&&Tr.$$typeof===_&&p1(Tr)===Xe.type)?(or=q(Xe,yt.props),or.ref=ou(ct,Xe,yt),or.return=ct,or):(or=kg(yt.type,yt.key,yt.props,null,ct.mode,or),or.ref=ou(ct,Xe,yt),or.return=ct,or)}function Kt(ct,Xe,yt,or){return Xe===null||Xe.tag!==4||Xe.stateNode.containerInfo!==yt.containerInfo||Xe.stateNode.implementation!==yt.implementation?(Xe=Cg(yt,ct.mode,or),Xe.return=ct,Xe):(Xe=q(Xe,yt.children||[]),Xe.return=ct,Xe)}function hr(ct,Xe,yt,or,Tr){return Xe===null||Xe.tag!==7?(Xe=pa(yt,ct.mode,or,Tr),Xe.return=ct,Xe):(Xe=q(Xe,yt),Xe.return=ct,Xe)}function Ur(ct,Xe,yt){if(typeof Xe=="string"&&Xe!==""||typeof Xe=="number")return Xe=Vd(""+Xe,ct.mode,yt),Xe.return=ct,Xe;if(typeof Xe=="object"&&Xe!==null){switch(Xe.$$typeof){case c:return yt=kg(Xe.type,Xe.key,Xe.props,null,ct.mode,yt),yt.ref=ou(ct,null,Xe),yt.return=ct,yt;case u:return Xe=Cg(Xe,ct.mode,yt),Xe.return=ct,Xe;case _:var or=Xe._init;return Ur(ct,or(Xe._payload),yt)}if(ee(Xe)||P(Xe))return Xe=pa(Xe,ct.mode,yt,null),Xe.return=ct,Xe;V0(ct,Xe)}return null}function ar(ct,Xe,yt,or){var Tr=Xe!==null?Xe.key:null;if(typeof yt=="string"&&yt!==""||typeof yt=="number")return Tr!==null?null:Ge(ct,Xe,""+yt,or);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case c:return yt.key===Tr?ft(ct,Xe,yt,or):null;case u:return yt.key===Tr?Kt(ct,Xe,yt,or):null;case _:return Tr=yt._init,ar(ct,Xe,Tr(yt._payload),or)}if(ee(yt)||P(yt))return Tr!==null?null:hr(ct,Xe,yt,or,null);V0(ct,yt)}return null}function Un(ct,Xe,yt,or,Tr){if(typeof or=="string"&&or!==""||typeof or=="number")return ct=ct.get(yt)||null,Ge(Xe,ct,""+or,Tr);if(typeof or=="object"&&or!==null){switch(or.$$typeof){case c:return ct=ct.get(or.key===null?yt:or.key)||null,ft(Xe,ct,or,Tr);case u:return ct=ct.get(or.key===null?yt:or.key)||null,Kt(Xe,ct,or,Tr);case _:var Yr=or._init;return Un(ct,Xe,yt,Yr(or._payload),Tr)}if(ee(or)||P(or))return ct=ct.get(yt)||null,hr(Xe,ct,or,Tr,null);V0(Xe,or)}return null}function kn(ct,Xe,yt,or){for(var Tr=null,Yr=null,zr=Xe,un=Xe=0,Gs=null;zr!==null&&un<yt.length;un++){zr.index>un?(Gs=zr,zr=null):Gs=zr.sibling;var on=ar(ct,zr,yt[un],or);if(on===null){zr===null&&(zr=Gs);break}y&&zr&&on.alternate===null&&b(ct,zr),Xe=te(on,Xe,un),Yr===null?Tr=on:Yr.sibling=on,Yr=on,zr=Gs}if(un===yt.length)return O(ct,zr),Wn&&Po(ct,un),Tr;if(zr===null){for(;un<yt.length;un++)zr=Ur(ct,yt[un],or),zr!==null&&(Xe=te(zr,Xe,un),Yr===null?Tr=zr:Yr.sibling=zr,Yr=zr);return Wn&&Po(ct,un),Tr}for(zr=U(ct,zr);un<yt.length;un++)Gs=Un(zr,ct,un,yt[un],or),Gs!==null&&(y&&Gs.alternate!==null&&zr.delete(Gs.key===null?un:Gs.key),Xe=te(Gs,Xe,un),Yr===null?Tr=Gs:Yr.sibling=Gs,Yr=Gs);return y&&zr.forEach(function(Fa){return b(ct,Fa)}),Wn&&Po(ct,un),Tr}function Za(ct,Xe,yt,or){var Tr=P(yt);if(typeof Tr!="function")throw Error(i(150));if(yt=Tr.call(yt),yt==null)throw Error(i(151));for(var Yr=Tr=null,zr=Xe,un=Xe=0,Gs=null,on=yt.next();zr!==null&&!on.done;un++,on=yt.next()){zr.index>un?(Gs=zr,zr=null):Gs=zr.sibling;var Fa=ar(ct,zr,on.value,or);if(Fa===null){zr===null&&(zr=Gs);break}y&&zr&&Fa.alternate===null&&b(ct,zr),Xe=te(Fa,Xe,un),Yr===null?Tr=Fa:Yr.sibling=Fa,Yr=Fa,zr=Gs}if(on.done)return O(ct,zr),Wn&&Po(ct,un),Tr;if(zr===null){for(;!on.done;un++,on=yt.next())on=Ur(ct,on.value,or),on!==null&&(Xe=te(on,Xe,un),Yr===null?Tr=on:Yr.sibling=on,Yr=on);return Wn&&Po(ct,un),Tr}for(zr=U(ct,zr);!on.done;un++,on=yt.next())on=Un(zr,ct,un,on.value,or),on!==null&&(y&&on.alternate!==null&&zr.delete(on.key===null?un:on.key),Xe=te(on,Xe,un),Yr===null?Tr=on:Yr.sibling=on,Yr=on);return y&&zr.forEach(function(Y2){return b(ct,Y2)}),Wn&&Po(ct,un),Tr}function ol(ct,Xe,yt,or){if(typeof yt=="object"&&yt!==null&&yt.type===d&&yt.key===null&&(yt=yt.props.children),typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case c:e:{for(var Tr=yt.key,Yr=Xe;Yr!==null;){if(Yr.key===Tr){if(Tr=yt.type,Tr===d){if(Yr.tag===7){O(ct,Yr.sibling),Xe=q(Yr,yt.props.children),Xe.return=ct,ct=Xe;break e}}else if(Yr.elementType===Tr||typeof Tr=="object"&&Tr!==null&&Tr.$$typeof===_&&p1(Tr)===Yr.type){O(ct,Yr.sibling),Xe=q(Yr,yt.props),Xe.ref=ou(ct,Yr,yt),Xe.return=ct,ct=Xe;break e}O(ct,Yr);break}else b(ct,Yr);Yr=Yr.sibling}yt.type===d?(Xe=pa(yt.props.children,ct.mode,or,yt.key),Xe.return=ct,ct=Xe):(or=kg(yt.type,yt.key,yt.props,null,ct.mode,or),or.ref=ou(ct,Xe,yt),or.return=ct,ct=or)}return ve(ct);case u:e:{for(Yr=yt.key;Xe!==null;){if(Xe.key===Yr)if(Xe.tag===4&&Xe.stateNode.containerInfo===yt.containerInfo&&Xe.stateNode.implementation===yt.implementation){O(ct,Xe.sibling),Xe=q(Xe,yt.children||[]),Xe.return=ct,ct=Xe;break e}else{O(ct,Xe);break}else b(ct,Xe);Xe=Xe.sibling}Xe=Cg(yt,ct.mode,or),Xe.return=ct,ct=Xe}return ve(ct);case _:return Yr=yt._init,ol(ct,Xe,Yr(yt._payload),or)}if(ee(yt))return kn(ct,Xe,yt,or);if(P(yt))return Za(ct,Xe,yt,or);V0(ct,yt)}return typeof yt=="string"&&yt!==""||typeof yt=="number"?(yt=""+yt,Xe!==null&&Xe.tag===6?(O(ct,Xe.sibling),Xe=q(Xe,yt),Xe.return=ct,ct=Xe):(O(ct,Xe),Xe=Vd(yt,ct.mode,or),Xe.return=ct,ct=Xe),ve(ct)):O(ct,Xe)}return ol}var lu=x1(!0),y1=x1(!1),K0=rn(null),q0=null,bd=null,mp=null;function pp(){mp=bd=q0=null}function v1(y,b,O){ce?(he(K0,b._currentValue),b._currentValue=O):(he(K0,b._currentValue2),b._currentValue2=O)}function Xf(y){var b=K0.current;Jr(K0),ce?y._currentValue=b:y._currentValue2=b}function cu(y,b,O){for(;y!==null;){var U=y.alternate;if((y.childLanes&b)!==b?(y.childLanes|=b,U!==null&&(U.childLanes|=b)):U!==null&&(U.childLanes&b)!==b&&(U.childLanes|=b),y===O)break;y=y.return}}function Sd(y,b){q0=y,mp=bd=null,y=y.dependencies,y!==null&&y.firstContext!==null&&((y.lanes&b)!==0&&(zs=!0),y.firstContext=null)}function Bi(y){var b=ce?y._currentValue:y._currentValue2;if(mp!==y)if(y={context:y,memoizedValue:b,next:null},bd===null){if(q0===null)throw Error(i(308));bd=y,q0.dependencies={lanes:0,firstContext:y}}else bd=bd.next=y;return b}var xc=null;function Y0(y){xc===null?xc=[y]:xc.push(y)}function xp(y,b,O,U){var q=b.interleaved;return q===null?(O.next=O,Y0(b)):(O.next=q.next,q.next=O),b.interleaved=O,Oo(y,U)}function Oo(y,b){y.lanes|=b;var O=y.alternate;for(O!==null&&(O.lanes|=b),O=y,y=y.return;y!==null;)y.childLanes|=b,O=y.alternate,O!==null&&(O.childLanes|=b),O=y,y=y.return;return O.tag===3?O.stateNode:null}var $i=!1;function yp(y){y.updateQueue={baseState:y.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w1(y,b){y=y.updateQueue,b.updateQueue===y&&(b.updateQueue={baseState:y.baseState,firstBaseUpdate:y.firstBaseUpdate,lastBaseUpdate:y.lastBaseUpdate,shared:y.shared,effects:y.effects})}function $l(y,b){return{eventTime:y,lane:b,tag:0,payload:null,callback:null,next:null}}function Ul(y,b,O){var U=y.updateQueue;if(U===null)return null;if(U=U.shared,(Kr&2)!==0){var q=U.pending;return q===null?b.next=b:(b.next=q.next,q.next=b),U.pending=b,Oo(y,O)}return q=U.interleaved,q===null?(b.next=b,Y0(U)):(b.next=q.next,q.next=b),U.interleaved=b,Oo(y,O)}function Jf(y,b,O){if(b=b.updateQueue,b!==null&&(b=b.shared,(O&4194240)!==0)){var U=b.lanes;U&=y.pendingLanes,O|=U,b.lanes=O,Qt(y,O)}}function kd(y,b){var O=y.updateQueue,U=y.alternate;if(U!==null&&(U=U.updateQueue,O===U)){var q=null,te=null;if(O=O.firstBaseUpdate,O!==null){do{var ve={eventTime:O.eventTime,lane:O.lane,tag:O.tag,payload:O.payload,callback:O.callback,next:null};te===null?q=te=ve:te=te.next=ve,O=O.next}while(O!==null);te===null?q=te=b:te=te.next=b}else q=te=b;O={baseState:U.baseState,firstBaseUpdate:q,lastBaseUpdate:te,shared:U.shared,effects:U.effects},y.updateQueue=O;return}y=O.lastBaseUpdate,y===null?O.firstBaseUpdate=b:y.next=b,O.lastBaseUpdate=b}function yc(y,b,O,U){var q=y.updateQueue;$i=!1;var te=q.firstBaseUpdate,ve=q.lastBaseUpdate,Ge=q.shared.pending;if(Ge!==null){q.shared.pending=null;var ft=Ge,Kt=ft.next;ft.next=null,ve===null?te=Kt:ve.next=Kt,ve=ft;var hr=y.alternate;hr!==null&&(hr=hr.updateQueue,Ge=hr.lastBaseUpdate,Ge!==ve&&(Ge===null?hr.firstBaseUpdate=Kt:Ge.next=Kt,hr.lastBaseUpdate=ft))}if(te!==null){var Ur=q.baseState;ve=0,hr=Kt=ft=null,Ge=te;do{var ar=Ge.lane,Un=Ge.eventTime;if((U&ar)===ar){hr!==null&&(hr=hr.next={eventTime:Un,lane:0,tag:Ge.tag,payload:Ge.payload,callback:Ge.callback,next:null});e:{var kn=y,Za=Ge;switch(ar=b,Un=O,Za.tag){case 1:if(kn=Za.payload,typeof kn=="function"){Ur=kn.call(Un,Ur,ar);break e}Ur=kn;break e;case 3:kn.flags=kn.flags&-65537|128;case 0:if(kn=Za.payload,ar=typeof kn=="function"?kn.call(Un,Ur,ar):kn,ar==null)break e;Ur=a({},Ur,ar);break e;case 2:$i=!0}}Ge.callback!==null&&Ge.lane!==0&&(y.flags|=64,ar=q.effects,ar===null?q.effects=[Ge]:ar.push(Ge))}else Un={eventTime:Un,lane:ar,tag:Ge.tag,payload:Ge.payload,callback:Ge.callback,next:null},hr===null?(Kt=hr=Un,ft=Ur):hr=hr.next=Un,ve|=ar;if(Ge=Ge.next,Ge===null){if(Ge=q.shared.pending,Ge===null)break;ar=Ge,Ge=ar.next,ar.next=null,q.lastBaseUpdate=ar,q.shared.pending=null}}while(!0);if(hr===null&&(ft=Ur),q.baseState=ft,q.firstBaseUpdate=Kt,q.lastBaseUpdate=hr,b=q.shared.interleaved,b!==null){q=b;do ve|=q.lane,q=q.next;while(q!==b)}else te===null&&(q.shared.lanes=0);Vl|=ve,y.lanes=ve,y.memoizedState=Ur}}function _1(y,b,O){if(y=b.effects,b.effects=null,y!==null)for(b=0;b<y.length;b++){var U=y[b],q=U.callback;if(q!==null){if(U.callback=null,U=O,typeof q!="function")throw Error(i(191,q));q.call(U)}}}var vc={},lo=rn(vc),Cd=rn(vc),wc=rn(vc);function co(y){if(y===vc)throw Error(i(174));return y}function X0(y,b){he(wc,b),he(Cd,y),he(lo,vc),y=B(b),Jr(lo),he(lo,y)}function uu(){Jr(lo),Jr(Cd),Jr(wc)}function vp(y){var b=co(wc.current),O=co(lo.current);b=V(O,y.type,b),O!==b&&(he(Cd,y),he(lo,b))}function wp(y){Cd.current===y&&(Jr(lo),Jr(Cd))}var ts=rn(0);function J0(y){for(var b=y;b!==null;){if(b.tag===13){var O=b.memoizedState;if(O!==null&&(O=O.dehydrated,O===null||fr(O)||nr(O)))return b}else if(b.tag===19&&b.memoizedProps.revealOrder!==void 0){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var _p=[];function bp(){for(var y=0;y<_p.length;y++){var b=_p[y];ce?b._workInProgressVersionPrimary=null:b._workInProgressVersionSecondary=null}_p.length=0}var yi=o.ReactCurrentDispatcher,du=o.ReactCurrentBatchConfig,_c=0,Xn=null,ks=null,Us=null,Td=!1,Qf=!1,Zf=0,Ed=0;function Zs(){throw Error(i(321))}function fu(y,b){if(b===null)return!1;for(var O=0;O<b.length&&O<y.length;O++)if(!Ao(y[O],b[O]))return!1;return!0}function eh(y,b,O,U,q,te){if(_c=te,Xn=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,yi.current=y===null||y.memoizedState===null?Fp:Op,y=O(U,q),Qf){te=0;do{if(Qf=!1,Zf=0,25<=te)throw Error(i(301));te+=1,Us=ks=null,b.updateQueue=null,yi.current=Dp,y=O(U,q)}while(Qf)}if(yi.current=xu,b=ks!==null&&ks.next!==null,_c=0,Us=ks=Xn=null,Td=!1,b)throw Error(i(300));return y}function Q0(){var y=Zf!==0;return Zf=0,y}function Ui(){var y={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Us===null?Xn.memoizedState=Us=y:Us=Us.next=y,Us}function ga(){if(ks===null){var y=Xn.alternate;y=y!==null?y.memoizedState:null}else y=ks.next;var b=Us===null?Xn.memoizedState:Us.next;if(b!==null)Us=b,ks=y;else{if(y===null)throw Error(i(310));ks=y,y={memoizedState:ks.memoizedState,baseState:ks.baseState,baseQueue:ks.baseQueue,queue:ks.queue,next:null},Us===null?Xn.memoizedState=Us=y:Us=Us.next=y}return Us}function hu(y,b){return typeof b=="function"?b(y):b}function Z0(y){var b=ga(),O=b.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var U=ks,q=U.baseQueue,te=O.pending;if(te!==null){if(q!==null){var ve=q.next;q.next=te.next,te.next=ve}U.baseQueue=q=te,O.pending=null}if(q!==null){te=q.next,U=U.baseState;var Ge=ve=null,ft=null,Kt=te;do{var hr=Kt.lane;if((_c&hr)===hr)ft!==null&&(ft=ft.next={lane:0,action:Kt.action,hasEagerState:Kt.hasEagerState,eagerState:Kt.eagerState,next:null}),U=Kt.hasEagerState?Kt.eagerState:y(U,Kt.action);else{var Ur={lane:hr,action:Kt.action,hasEagerState:Kt.hasEagerState,eagerState:Kt.eagerState,next:null};ft===null?(Ge=ft=Ur,ve=U):ft=ft.next=Ur,Xn.lanes|=hr,Vl|=hr}Kt=Kt.next}while(Kt!==null&&Kt!==te);ft===null?ve=U:ft.next=Ge,Ao(U,b.memoizedState)||(zs=!0),b.memoizedState=U,b.baseState=ve,b.baseQueue=ft,O.lastRenderedState=U}if(y=O.interleaved,y!==null){q=y;do te=q.lane,Xn.lanes|=te,Vl|=te,q=q.next;while(q!==y)}else q===null&&(O.lanes=0);return[b.memoizedState,O.dispatch]}function Nd(y){var b=ga(),O=b.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=y;var U=O.dispatch,q=O.pending,te=b.memoizedState;if(q!==null){O.pending=null;var ve=q=q.next;do te=y(te,ve.action),ve=ve.next;while(ve!==q);Ao(te,b.memoizedState)||(zs=!0),b.memoizedState=te,b.baseQueue===null&&(b.baseState=te),O.lastRenderedState=te}return[te,U]}function Sp(){}function kp(y,b){var O=Xn,U=ga(),q=b(),te=!Ao(U.memoizedState,q);if(te&&(U.memoizedState=q,zs=!0),U=U.queue,rg(Ep.bind(null,O,U,y),[y]),U.getSnapshot!==b||te||Us!==null&&Us.memoizedState.tag&1){if(O.flags|=2048,gu(9,Tp.bind(null,O,U,q,b),void 0,null),jn===null)throw Error(i(349));(_c&30)!==0||Cp(O,b,q)}return q}function Cp(y,b,O){y.flags|=16384,y={getSnapshot:b,value:O},b=Xn.updateQueue,b===null?(b={lastEffect:null,stores:null},Xn.updateQueue=b,b.stores=[y]):(O=b.stores,O===null?b.stores=[y]:O.push(y))}function Tp(y,b,O,U){b.value=O,b.getSnapshot=U,Np(b)&&zl(y)}function Ep(y,b,O){return O(function(){Np(b)&&zl(y)})}function Np(y){var b=y.getSnapshot;y=y.value;try{var O=b();return!Ao(y,O)}catch{return!0}}function zl(y){var b=Oo(y,1);b!==null&&ja(b,y,1,-1)}function eg(y){var b=Ui();return typeof y=="function"&&(y=y()),b.memoizedState=b.baseState=y,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hu,lastRenderedState:y},b.queue=y,y=y.dispatch=G2.bind(null,Xn,y),[b.memoizedState,y]}function gu(y,b,O,U){return y={tag:y,create:b,destroy:O,deps:U,next:null},b=Xn.updateQueue,b===null?(b={lastEffect:null,stores:null},Xn.updateQueue=b,b.lastEffect=y.next=y):(O=b.lastEffect,O===null?b.lastEffect=y.next=y:(U=O.next,O.next=y,y.next=U,b.lastEffect=y)),y}function b1(){return ga().memoizedState}function tg(y,b,O,U){var q=Ui();Xn.flags|=y,q.memoizedState=gu(1|b,O,void 0,U===void 0?null:U)}function bc(y,b,O,U){var q=ga();U=U===void 0?null:U;var te=void 0;if(ks!==null){var ve=ks.memoizedState;if(te=ve.destroy,U!==null&&fu(U,ve.deps)){q.memoizedState=gu(b,O,te,U);return}}Xn.flags|=y,q.memoizedState=gu(1|b,O,te,U)}function S1(y,b){return tg(8390656,8,y,b)}function rg(y,b){return bc(2048,8,y,b)}function Ap(y,b){return bc(4,2,y,b)}function Ln(y,b){return bc(4,4,y,b)}function ng(y,b){if(typeof b=="function")return y=y(),b(y),function(){b(null)};if(b!=null)return y=y(),b.current=y,function(){b.current=null}}function th(y,b,O){return O=O!=null?O.concat([y]):null,bc(4,4,ng.bind(null,b,y),O)}function mu(){}function jp(y,b){var O=ga();b=b===void 0?null:b;var U=O.memoizedState;return U!==null&&b!==null&&fu(b,U[1])?U[0]:(O.memoizedState=[y,b],y)}function sg(y,b){var O=ga();b=b===void 0?null:b;var U=O.memoizedState;return U!==null&&b!==null&&fu(b,U[1])?U[0]:(y=y(),O.memoizedState=[y,b],y)}function Ad(y,b,O){return(_c&21)===0?(y.baseState&&(y.baseState=!1,zs=!0),y.memoizedState=O):(Ao(O,b)||(O=Pt(),Xn.lanes|=O,Vl|=O,y.baseState=!0),b)}function ag(y,b){var O=Lt;Lt=O!==0&&4>O?O:4,y(!0);var U=du.transition;du.transition={};try{y(!1),b()}finally{Lt=O,du.transition=U}}function pu(){return ga().memoizedState}function k1(y,b,O){var U=Hs(y);if(O={lane:U,action:O,hasEagerState:!1,eagerState:null,next:null},C1(y))Pp(b,O);else if(O=xp(y,b,O,U),O!==null){var q=Hn();ja(O,y,U,q),rh(O,b,U)}}function G2(y,b,O){var U=Hs(y),q={lane:U,action:O,hasEagerState:!1,eagerState:null,next:null};if(C1(y))Pp(b,q);else{var te=y.alternate;if(y.lanes===0&&(te===null||te.lanes===0)&&(te=b.lastRenderedReducer,te!==null))try{var ve=b.lastRenderedState,Ge=te(ve,O);if(q.hasEagerState=!0,q.eagerState=Ge,Ao(Ge,ve)){var ft=b.interleaved;ft===null?(q.next=q,Y0(b)):(q.next=ft.next,ft.next=q),b.interleaved=q;return}}catch{}finally{}O=xp(y,b,q,U),O!==null&&(q=Hn(),ja(O,y,U,q),rh(O,b,U))}}function C1(y){var b=y.alternate;return y===Xn||b!==null&&b===Xn}function Pp(y,b){Qf=Td=!0;var O=y.pending;O===null?b.next=b:(b.next=O.next,O.next=b),y.pending=b}function rh(y,b,O){if((O&4194240)!==0){var U=b.lanes;U&=y.pendingLanes,O|=U,b.lanes=O,Qt(y,O)}}var xu={readContext:Bi,useCallback:Zs,useContext:Zs,useEffect:Zs,useImperativeHandle:Zs,useInsertionEffect:Zs,useLayoutEffect:Zs,useMemo:Zs,useReducer:Zs,useRef:Zs,useState:Zs,useDebugValue:Zs,useDeferredValue:Zs,useTransition:Zs,useMutableSource:Zs,useSyncExternalStore:Zs,useId:Zs,unstable_isNewReconciler:!1},Fp={readContext:Bi,useCallback:function(y,b){return Ui().memoizedState=[y,b===void 0?null:b],y},useContext:Bi,useEffect:S1,useImperativeHandle:function(y,b,O){return O=O!=null?O.concat([y]):null,tg(4194308,4,ng.bind(null,b,y),O)},useLayoutEffect:function(y,b){return tg(4194308,4,y,b)},useInsertionEffect:function(y,b){return tg(4,2,y,b)},useMemo:function(y,b){var O=Ui();return b=b===void 0?null:b,y=y(),O.memoizedState=[y,b],y},useReducer:function(y,b,O){var U=Ui();return b=O!==void 0?O(b):b,U.memoizedState=U.baseState=b,y={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:y,lastRenderedState:b},U.queue=y,y=y.dispatch=k1.bind(null,Xn,y),[U.memoizedState,y]},useRef:function(y){var b=Ui();return y={current:y},b.memoizedState=y},useState:eg,useDebugValue:mu,useDeferredValue:function(y){return Ui().memoizedState=y},useTransition:function(){var y=eg(!1),b=y[0];return y=ag.bind(null,y[1]),Ui().memoizedState=y,[b,y]},useMutableSource:function(){},useSyncExternalStore:function(y,b,O){var U=Xn,q=Ui();if(Wn){if(O===void 0)throw Error(i(407));O=O()}else{if(O=b(),jn===null)throw Error(i(349));(_c&30)!==0||Cp(U,b,O)}q.memoizedState=O;var te={value:O,getSnapshot:b};return q.queue=te,S1(Ep.bind(null,U,te,y),[y]),U.flags|=2048,gu(9,Tp.bind(null,U,te,O,b),void 0,null),O},useId:function(){var y=Ui(),b=jn.identifierPrefix;if(Wn){var O=jo,U=xi;O=(U&~(1<<32-Kn(U)-1)).toString(32)+O,b=":"+b+"R"+O,O=Zf++,0<O&&(b+="H"+O.toString(32)),b+=":"}else O=Ed++,b=":"+b+"r"+O.toString(32)+":";return y.memoizedState=b},unstable_isNewReconciler:!1},Op={readContext:Bi,useCallback:jp,useContext:Bi,useEffect:rg,useImperativeHandle:th,useInsertionEffect:Ap,useLayoutEffect:Ln,useMemo:sg,useReducer:Z0,useRef:b1,useState:function(){return Z0(hu)},useDebugValue:mu,useDeferredValue:function(y){var b=ga();return Ad(b,ks.memoizedState,y)},useTransition:function(){var y=Z0(hu)[0],b=ga().memoizedState;return[y,b]},useMutableSource:Sp,useSyncExternalStore:kp,useId:pu,unstable_isNewReconciler:!1},Dp={readContext:Bi,useCallback:jp,useContext:Bi,useEffect:rg,useImperativeHandle:th,useInsertionEffect:Ap,useLayoutEffect:Ln,useMemo:sg,useReducer:Nd,useRef:b1,useState:function(){return Nd(hu)},useDebugValue:mu,useDeferredValue:function(y){var b=ga();return ks===null?b.memoizedState=y:Ad(b,ks.memoizedState,y)},useTransition:function(){var y=Nd(hu)[0],b=ga().memoizedState;return[y,b]},useMutableSource:Sp,useSyncExternalStore:kp,useId:pu,unstable_isNewReconciler:!1};function zi(y,b){if(y&&y.defaultProps){b=a({},b),y=y.defaultProps;for(var O in y)b[O]===void 0&&(b[O]=y[O]);return b}return b}function Ip(y,b,O,U){b=y.memoizedState,O=O(U,b),O=O==null?b:a({},b,O),y.memoizedState=O,y.lanes===0&&(y.updateQueue.baseState=O)}var nh={isMounted:function(y){return(y=y._reactInternals)?j(y)===y:!1},enqueueSetState:function(y,b,O){y=y._reactInternals;var U=Hn(),q=Hs(y),te=$l(U,q);te.payload=b,O!=null&&(te.callback=O),b=Ul(y,te,q),b!==null&&(ja(b,y,q,U),Jf(b,y,q))},enqueueReplaceState:function(y,b,O){y=y._reactInternals;var U=Hn(),q=Hs(y),te=$l(U,q);te.tag=1,te.payload=b,O!=null&&(te.callback=O),b=Ul(y,te,q),b!==null&&(ja(b,y,q,U),Jf(b,y,q))},enqueueForceUpdate:function(y,b){y=y._reactInternals;var O=Hn(),U=Hs(y),q=$l(O,U);q.tag=2,b!=null&&(q.callback=b),b=Ul(y,q,U),b!==null&&(ja(b,y,U,O),Jf(b,y,U))}};function T1(y,b,O,U,q,te,ve){return y=y.stateNode,typeof y.shouldComponentUpdate=="function"?y.shouldComponentUpdate(U,te,ve):b.prototype&&b.prototype.isPureReactComponent?!G0(O,U)||!G0(q,te):!0}function E1(y,b,O){var U=!1,q=vt,te=b.contextType;return typeof te=="object"&&te!==null?te=Bi(te):(q=Zr(b)?Nn:kr.current,U=b.contextTypes,te=(U=U!=null)?_n(y,q):vt),b=new b(O,te),y.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=nh,y.stateNode=b,b._reactInternals=y,U&&(y=y.stateNode,y.__reactInternalMemoizedUnmaskedChildContext=q,y.__reactInternalMemoizedMaskedChildContext=te),b}function ig(y,b,O,U){y=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(O,U),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(O,U),b.state!==y&&nh.enqueueReplaceState(b,b.state,null)}function Zo(y,b,O,U){var q=y.stateNode;q.props=O,q.state=y.memoizedState,q.refs={},yp(y);var te=b.contextType;typeof te=="object"&&te!==null?q.context=Bi(te):(te=Zr(b)?Nn:kr.current,q.context=_n(y,te)),q.state=y.memoizedState,te=b.getDerivedStateFromProps,typeof te=="function"&&(Ip(y,b,te,O),q.state=y.memoizedState),typeof b.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(b=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),b!==q.state&&nh.enqueueReplaceState(q,q.state,null),yc(y,O,q,U),q.state=y.memoizedState),typeof q.componentDidMount=="function"&&(y.flags|=4194308)}function yu(y,b){try{var O="",U=b;do O+=H2(U),U=U.return;while(U);var q=O}catch(te){q=`
Error generating stack: `+te.message+`
`+te.stack}return{value:y,source:b,stack:q,digest:null}}function Sc(y,b,O){return{value:y,source:null,stack:O??null,digest:b??null}}function uo(y,b){try{console.error(b.value)}catch(O){setTimeout(function(){throw O})}}var sh=typeof WeakMap=="function"?WeakMap:Map;function el(y,b,O){O=$l(-1,O),O.tag=3,O.payload={element:null};var U=b.value;return O.callback=function(){fs||(fs=!0,Cs=U),uo(y,b)},O}function og(y,b,O){O=$l(-1,O),O.tag=3;var U=y.type.getDerivedStateFromError;if(typeof U=="function"){var q=b.value;O.payload=function(){return U(q)},O.callback=function(){uo(y,b)}}var te=y.stateNode;return te!==null&&typeof te.componentDidCatch=="function"&&(O.callback=function(){uo(y,b),typeof U!="function"&&(Io===null?Io=new Set([this]):Io.add(this));var ve=b.stack;this.componentDidCatch(b.value,{componentStack:ve!==null?ve:""})}),O}function N1(y,b,O){var U=y.pingCache;if(U===null){U=y.pingCache=new sh;var q=new Set;U.set(b,q)}else q=U.get(b),q===void 0&&(q=new Set,U.set(b,q));q.has(O)||(q.add(O),y=R1.bind(null,y,b,O),b.then(y,y))}function A1(y){do{var b;if((b=y.tag===13)&&(b=y.memoizedState,b=b!==null?b.dehydrated!==null:!0),b)return y;y=y.return}while(y!==null);return null}function kc(y,b,O,U,q){return(y.mode&1)===0?(y===b?y.flags|=65536:(y.flags|=128,O.flags|=131072,O.flags&=-52805,O.tag===1&&(O.alternate===null?O.tag=17:(b=$l(-1,1),b.tag=2,Ul(O,b,1))),O.lanes|=1),y):(y.flags|=65536,y.lanes=q,y)}var ah=o.ReactCurrentOwner,zs=!1;function ea(y,b,O,U){b.child=y===null?y1(b,null,O,U):lu(b,y.child,O,U)}function lg(y,b,O,U,q){O=O.render;var te=b.ref;return Sd(b,q),U=eh(y,b,O,U,te,q),O=Q0(),y!==null&&!zs?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~q,Hl(y,b,q)):(Wn&&O&&Kf(b),b.flags|=1,ea(y,b,U,q),b.child)}function vu(y,b,O,U,q){if(y===null){var te=O.type;return typeof te=="function"&&!Hd(te)&&te.defaultProps===void 0&&O.compare===null&&O.defaultProps===void 0?(b.tag=15,b.type=te,Wl(y,b,te,U,q)):(y=kg(O.type,null,U,b,b.mode,q),y.ref=b.ref,y.return=b,b.child=y)}if(te=y.child,(y.lanes&q)===0){var ve=te.memoizedProps;if(O=O.compare,O=O!==null?O:G0,O(ve,U)&&y.ref===b.ref)return Hl(y,b,q)}return b.flags|=1,y=Dc(te,U),y.ref=b.ref,y.return=b,b.child=y}function Wl(y,b,O,U,q){if(y!==null){var te=y.memoizedProps;if(G0(te,U)&&y.ref===b.ref)if(zs=!1,b.pendingProps=U=te,(y.lanes&q)!==0)(y.flags&131072)!==0&&(zs=!0);else return b.lanes=y.lanes,Hl(y,b,q)}return tl(y,b,O,U,q)}function Bn(y,b,O){var U=b.pendingProps,q=U.children,te=y!==null?y.memoizedState:null;if(U.mode==="hidden")if((b.mode&1)===0)b.memoizedState={baseLanes:0,cachePool:null,transitions:null},he(jc,Ws),Ws|=O;else{if((O&1073741824)===0)return y=te!==null?te.baseLanes|O:O,b.lanes=b.childLanes=1073741824,b.memoizedState={baseLanes:y,cachePool:null,transitions:null},b.updateQueue=null,he(jc,Ws),Ws|=y,null;b.memoizedState={baseLanes:0,cachePool:null,transitions:null},U=te!==null?te.baseLanes:O,he(jc,Ws),Ws|=U}else te!==null?(U=te.baseLanes|O,b.memoizedState=null):U=O,he(jc,Ws),Ws|=U;return ea(y,b,q,O),b.child}function An(y,b){var O=b.ref;(y===null&&O!==null||y!==null&&y.ref!==O)&&(b.flags|=512,b.flags|=2097152)}function tl(y,b,O,U,q){var te=Zr(O)?Nn:kr.current;return te=_n(b,te),Sd(b,q),O=eh(y,b,O,U,te,q),U=Q0(),y!==null&&!zs?(b.updateQueue=y.updateQueue,b.flags&=-2053,y.lanes&=~q,Hl(y,b,q)):(Wn&&U&&Kf(b),b.flags|=1,ea(y,b,O,q),b.child)}function ma(y,b,O,U,q){if(Zr(O)){var te=!0;lr(b)}else te=!1;if(Sd(b,q),b.stateNode===null)ih(y,b),E1(b,O,U),Zo(b,O,U,q),U=!0;else if(y===null){var ve=b.stateNode,Ge=b.memoizedProps;ve.props=Ge;var ft=ve.context,Kt=O.contextType;typeof Kt=="object"&&Kt!==null?Kt=Bi(Kt):(Kt=Zr(O)?Nn:kr.current,Kt=_n(b,Kt));var hr=O.getDerivedStateFromProps,Ur=typeof hr=="function"||typeof ve.getSnapshotBeforeUpdate=="function";Ur||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Ge!==U||ft!==Kt)&&ig(b,ve,U,Kt),$i=!1;var ar=b.memoizedState;ve.state=ar,yc(b,U,ve,q),ft=b.memoizedState,Ge!==U||ar!==ft||Cr.current||$i?(typeof hr=="function"&&(Ip(b,O,hr,U),ft=b.memoizedState),(Ge=$i||T1(b,O,Ge,U,ar,ft,Kt))?(Ur||typeof ve.UNSAFE_componentWillMount!="function"&&typeof ve.componentWillMount!="function"||(typeof ve.componentWillMount=="function"&&ve.componentWillMount(),typeof ve.UNSAFE_componentWillMount=="function"&&ve.UNSAFE_componentWillMount()),typeof ve.componentDidMount=="function"&&(b.flags|=4194308)):(typeof ve.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=U,b.memoizedState=ft),ve.props=U,ve.state=ft,ve.context=Kt,U=Ge):(typeof ve.componentDidMount=="function"&&(b.flags|=4194308),U=!1)}else{ve=b.stateNode,w1(y,b),Ge=b.memoizedProps,Kt=b.type===b.elementType?Ge:zi(b.type,Ge),ve.props=Kt,Ur=b.pendingProps,ar=ve.context,ft=O.contextType,typeof ft=="object"&&ft!==null?ft=Bi(ft):(ft=Zr(O)?Nn:kr.current,ft=_n(b,ft));var Un=O.getDerivedStateFromProps;(hr=typeof Un=="function"||typeof ve.getSnapshotBeforeUpdate=="function")||typeof ve.UNSAFE_componentWillReceiveProps!="function"&&typeof ve.componentWillReceiveProps!="function"||(Ge!==Ur||ar!==ft)&&ig(b,ve,U,ft),$i=!1,ar=b.memoizedState,ve.state=ar,yc(b,U,ve,q);var kn=b.memoizedState;Ge!==Ur||ar!==kn||Cr.current||$i?(typeof Un=="function"&&(Ip(b,O,Un,U),kn=b.memoizedState),(Kt=$i||T1(b,O,Kt,U,ar,kn,ft)||!1)?(hr||typeof ve.UNSAFE_componentWillUpdate!="function"&&typeof ve.componentWillUpdate!="function"||(typeof ve.componentWillUpdate=="function"&&ve.componentWillUpdate(U,kn,ft),typeof ve.UNSAFE_componentWillUpdate=="function"&&ve.UNSAFE_componentWillUpdate(U,kn,ft)),typeof ve.componentDidUpdate=="function"&&(b.flags|=4),typeof ve.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof ve.componentDidUpdate!="function"||Ge===y.memoizedProps&&ar===y.memoizedState||(b.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Ge===y.memoizedProps&&ar===y.memoizedState||(b.flags|=1024),b.memoizedProps=U,b.memoizedState=kn),ve.props=U,ve.state=kn,ve.context=ft,U=Kt):(typeof ve.componentDidUpdate!="function"||Ge===y.memoizedProps&&ar===y.memoizedState||(b.flags|=4),typeof ve.getSnapshotBeforeUpdate!="function"||Ge===y.memoizedProps&&ar===y.memoizedState||(b.flags|=1024),U=!1)}return Ea(y,b,O,U,te,q)}function Ea(y,b,O,U,q,te){An(y,b);var ve=(b.flags&128)!==0;if(!U&&!ve)return q&&es(b,O,!1),Hl(y,b,te);U=b.stateNode,ah.current=b;var Ge=ve&&typeof O.getDerivedStateFromError!="function"?null:U.render();return b.flags|=1,y!==null&&ve?(b.child=lu(b,y.child,null,te),b.child=lu(b,null,Ge,te)):ea(y,b,Ge,te),b.memoizedState=U.state,q&&es(b,O,!0),b.child}function Cc(y){var b=y.stateNode;b.pendingContext?Ct(y,b.pendingContext,b.pendingContext!==b.context):b.context&&Ct(y,b.context,!1),X0(y,b.containerInfo)}function wu(y,b,O,U,q){return iu(),gp(q),b.flags|=256,ea(y,b,O,U),b.child}var Na={dehydrated:null,treeContext:null,retryLane:0};function jd(y){return{baseLanes:y,cachePool:null,transitions:null}}function Rp(y,b,O){var U=b.pendingProps,q=ts.current,te=!1,ve=(b.flags&128)!==0,Ge;if((Ge=ve)||(Ge=y!==null&&y.memoizedState===null?!1:(q&2)!==0),Ge?(te=!0,b.flags&=-129):(y===null||y.memoizedState!==null)&&(q|=1),he(ts,q&1),y===null)return hp(b),y=b.memoizedState,y!==null&&(y=y.dehydrated,y!==null)?((b.mode&1)===0?b.lanes=1:nr(y)?b.lanes=8:b.lanes=1073741824,null):(ve=U.children,y=U.fallback,te?(U=b.mode,te=b.child,ve={mode:"hidden",children:ve},(U&1)===0&&te!==null?(te.childLanes=0,te.pendingProps=ve):te=Gd(ve,U,0,null),y=pa(y,U,O,null),te.return=b,y.return=b,te.sibling=y,b.child=te,b.child.memoizedState=jd(O),b.memoizedState=Na,y):cg(b,ve));if(q=y.memoizedState,q!==null&&(Ge=q.dehydrated,Ge!==null))return j1(y,b,ve,U,Ge,q,O);if(te){te=U.fallback,ve=b.mode,q=y.child,Ge=q.sibling;var ft={mode:"hidden",children:U.children};return(ve&1)===0&&b.child!==q?(U=b.child,U.childLanes=0,U.pendingProps=ft,b.deletions=null):(U=Dc(q,ft),U.subtreeFlags=q.subtreeFlags&14680064),Ge!==null?te=Dc(Ge,te):(te=pa(te,ve,O,null),te.flags|=2),te.return=b,U.return=b,U.sibling=te,b.child=U,U=te,te=b.child,ve=y.child.memoizedState,ve=ve===null?jd(O):{baseLanes:ve.baseLanes|O,cachePool:null,transitions:ve.transitions},te.memoizedState=ve,te.childLanes=y.childLanes&~O,b.memoizedState=Na,U}return te=y.child,y=te.sibling,U=Dc(te,{mode:"visible",children:U.children}),(b.mode&1)===0&&(U.lanes=O),U.return=b,U.sibling=null,y!==null&&(O=b.deletions,O===null?(b.deletions=[y],b.flags|=16):O.push(y)),b.child=U,b.memoizedState=null,U}function cg(y,b){return b=Gd({mode:"visible",children:b},y.mode,0,null),b.return=y,y.child=b}function _u(y,b,O,U){return U!==null&&gp(U),lu(b,y.child,null,O),y=cg(b,b.pendingProps.children),y.flags|=2,b.memoizedState=null,y}function j1(y,b,O,U,q,te,ve){if(O)return b.flags&256?(b.flags&=-257,U=Sc(Error(i(422))),_u(y,b,ve,U)):b.memoizedState!==null?(b.child=y.child,b.flags|=128,null):(te=U.fallback,q=b.mode,U=Gd({mode:"visible",children:U.children},q,0,null),te=pa(te,q,ve,null),te.flags|=2,U.return=b,te.return=b,U.sibling=te,b.child=U,(b.mode&1)!==0&&lu(b,y.child,null,ve),b.child.memoizedState=jd(ve),b.memoizedState=Na,te);if((b.mode&1)===0)return _u(y,b,ve,null);if(nr(q))return U=Dr(q).digest,te=Error(i(419)),U=Sc(te,U,void 0),_u(y,b,ve,U);if(O=(ve&y.childLanes)!==0,zs||O){if(U=jn,U!==null){switch(ve&-ve){case 4:q=2;break;case 16:q=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:q=32;break;case 536870912:q=268435456;break;default:q=0}q=(q&(U.suspendedLanes|ve))!==0?0:q,q!==0&&q!==te.retryLane&&(te.retryLane=q,Oo(y,q),ja(U,y,q,-1))}return Wd(),U=Sc(Error(i(421))),_u(y,b,ve,U)}return fr(q)?(b.flags|=128,b.child=y.child,b=L1.bind(null,y),ue(q,b),null):(y=te.treeContext,pe&&(Ka=_e(q),ha=b,Wn=!0,Fo=null,Yf=!1,y!==null&&(Va[Li++]=xi,Va[Li++]=jo,Va[Li++]=$s,xi=y.id,jo=y.overflow,$s=b)),b=cg(b,U.children),b.flags|=4096,b)}function rl(y,b,O){y.lanes|=b;var U=y.alternate;U!==null&&(U.lanes|=b),cu(y.return,b,O)}function Pd(y,b,O,U,q){var te=y.memoizedState;te===null?y.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:U,tail:O,tailMode:q}:(te.isBackwards=b,te.rendering=null,te.renderingStartTime=0,te.last=U,te.tail=O,te.tailMode=q)}function ug(y,b,O){var U=b.pendingProps,q=U.revealOrder,te=U.tail;if(ea(y,b,U.children,O),U=ts.current,(U&2)!==0)U=U&1|2,b.flags|=128;else{if(y!==null&&(y.flags&128)!==0)e:for(y=b.child;y!==null;){if(y.tag===13)y.memoizedState!==null&&rl(y,O,b);else if(y.tag===19)rl(y,O,b);else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===b)break e;for(;y.sibling===null;){if(y.return===null||y.return===b)break e;y=y.return}y.sibling.return=y.return,y=y.sibling}U&=1}if(he(ts,U),(b.mode&1)===0)b.memoizedState=null;else switch(q){case"forwards":for(O=b.child,q=null;O!==null;)y=O.alternate,y!==null&&J0(y)===null&&(q=O),O=O.sibling;O=q,O===null?(q=b.child,b.child=null):(q=O.sibling,O.sibling=null),Pd(b,!1,q,O,te);break;case"backwards":for(O=null,q=b.child,b.child=null;q!==null;){if(y=q.alternate,y!==null&&J0(y)===null){b.child=q;break}y=q.sibling,q.sibling=O,O=q,q=y}Pd(b,!0,O,null,te);break;case"together":Pd(b,!1,null,null,void 0);break;default:b.memoizedState=null}return b.child}function ih(y,b){(b.mode&1)===0&&y!==null&&(y.alternate=null,b.alternate=null,b.flags|=2)}function Hl(y,b,O){if(y!==null&&(b.dependencies=y.dependencies),Vl|=b.lanes,(O&b.childLanes)===0)return null;if(y!==null&&b.child!==y.child)throw Error(i(153));if(b.child!==null){for(y=b.child,O=Dc(y,y.pendingProps),b.child=O,O.return=b;y.sibling!==null;)y=y.sibling,O=O.sibling=Dc(y,y.pendingProps),O.return=b;O.sibling=null}return b.child}function Tc(y,b,O){switch(b.tag){case 3:Cc(b),iu();break;case 5:vp(b);break;case 1:Zr(b.type)&&lr(b);break;case 4:X0(b,b.stateNode.containerInfo);break;case 10:v1(b,b.type._context,b.memoizedProps.value);break;case 13:var U=b.memoizedState;if(U!==null)return U.dehydrated!==null?(he(ts,ts.current&1),b.flags|=128,null):(O&b.child.childLanes)!==0?Rp(y,b,O):(he(ts,ts.current&1),y=Hl(y,b,O),y!==null?y.sibling:null);he(ts,ts.current&1);break;case 19:if(U=(O&b.childLanes)!==0,(y.flags&128)!==0){if(U)return ug(y,b,O);b.flags|=128}var q=b.memoizedState;if(q!==null&&(q.rendering=null,q.tail=null,q.lastEffect=null),he(ts,ts.current),U)break;return null;case 22:case 23:return b.lanes=0,Bn(y,b,O)}return Hl(y,b,O)}function qa(y){y.flags|=4}function bu(y,b){if(y!==null&&y.child===b.child)return!0;if((b.flags&16)!==0)return!1;for(y=b.child;y!==null;){if((y.flags&12854)!==0||(y.subtreeFlags&12854)!==0)return!1;y=y.sibling}return!0}var Ec,Nc,Ya,Xa;if(be)Ec=function(y,b){for(var O=b.child;O!==null;){if(O.tag===5||O.tag===6)R(y,O.stateNode);else if(O.tag!==4&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===b)break;for(;O.sibling===null;){if(O.return===null||O.return===b)return;O=O.return}O.sibling.return=O.return,O=O.sibling}},Nc=function(){},Ya=function(y,b,O,U,q){if(y=y.memoizedProps,y!==U){var te=b.stateNode,ve=co(lo.current);O=K(te,O,y,U,q,ve),(b.updateQueue=O)&&qa(b)}},Xa=function(y,b,O,U){O!==U&&qa(b)};else if(re){Ec=function(y,b,O,U){for(var q=b.child;q!==null;){if(q.tag===5){var te=q.stateNode;O&&U&&(te=$e(te,q.type,q.memoizedProps,q)),R(y,te)}else if(q.tag===6)te=q.stateNode,O&&U&&(te=Ue(te,q.memoizedProps,q)),R(y,te);else if(q.tag!==4){if(q.tag===22&&q.memoizedState!==null)te=q.child,te!==null&&(te.return=q),Ec(y,q,!0,!0);else if(q.child!==null){q.child.return=q,q=q.child;continue}}if(q===b)break;for(;q.sibling===null;){if(q.return===null||q.return===b)return;q=q.return}q.sibling.return=q.return,q=q.sibling}};var Ac=function(y,b,O,U){for(var q=b.child;q!==null;){if(q.tag===5){var te=q.stateNode;O&&U&&(te=$e(te,q.type,q.memoizedProps,q)),Pe(y,te)}else if(q.tag===6)te=q.stateNode,O&&U&&(te=Ue(te,q.memoizedProps,q)),Pe(y,te);else if(q.tag!==4){if(q.tag===22&&q.memoizedState!==null)te=q.child,te!==null&&(te.return=q),Ac(y,q,!0,!0);else if(q.child!==null){q.child.return=q,q=q.child;continue}}if(q===b)break;for(;q.sibling===null;){if(q.return===null||q.return===b)return;q=q.return}q.sibling.return=q.return,q=q.sibling}};Nc=function(y,b){var O=b.stateNode;if(!bu(y,b)){y=O.containerInfo;var U=kt(y);Ac(U,b,!1,!1),O.pendingChildren=U,qa(b),He(y,U)}},Ya=function(y,b,O,U,q){var te=y.stateNode,ve=y.memoizedProps;if((y=bu(y,b))&&ve===U)b.stateNode=te;else{var Ge=b.stateNode,ft=co(lo.current),Kt=null;ve!==U&&(Kt=K(Ge,O,ve,U,q,ft)),y&&Kt===null?b.stateNode=te:(te=Me(te,Kt,O,ve,U,b,y,Ge),z(te,O,U,q,ft)&&qa(b),b.stateNode=te,y?qa(b):Ec(te,b,!1,!1))}},Xa=function(y,b,O,U){O!==U?(y=co(wc.current),O=co(lo.current),b.stateNode=se(U,y,O,b),qa(b)):b.stateNode=y.stateNode}}else Nc=function(){},Ya=function(){},Xa=function(){};function Wi(y,b){if(!Wn)switch(y.tailMode){case"hidden":b=y.tail;for(var O=null;b!==null;)b.alternate!==null&&(O=b),b=b.sibling;O===null?y.tail=null:O.sibling=null;break;case"collapsed":O=y.tail;for(var U=null;O!==null;)O.alternate!==null&&(U=O),O=O.sibling;U===null?b||y.tail===null?y.tail=null:y.tail.sibling=null:U.sibling=null}}function Jn(y){var b=y.alternate!==null&&y.alternate.child===y.child,O=0,U=0;if(b)for(var q=y.child;q!==null;)O|=q.lanes|q.childLanes,U|=q.subtreeFlags&14680064,U|=q.flags&14680064,q.return=y,q=q.sibling;else for(q=y.child;q!==null;)O|=q.lanes|q.childLanes,U|=q.subtreeFlags,U|=q.flags,q.return=y,q=q.sibling;return y.subtreeFlags|=U,y.childLanes=O,b}function Su(y,b,O){var U=b.pendingProps;switch(qf(b),b.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jn(b),null;case 1:return Zr(b.type)&&Be(),Jn(b),null;case 3:return O=b.stateNode,uu(),Jr(Cr),Jr(kr),bp(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(y===null||y.child===null)&&(H0(b)?qa(b):y===null||y.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,Fo!==null&&(bg(Fo),Fo=null))),Nc(y,b),Jn(b),null;case 5:wp(b),O=co(wc.current);var q=b.type;if(y!==null&&b.stateNode!=null)Ya(y,b,q,U,O),y.ref!==b.ref&&(b.flags|=512,b.flags|=2097152);else{if(!U){if(b.stateNode===null)throw Error(i(166));return Jn(b),null}if(y=co(lo.current),H0(b)){if(!pe)throw Error(i(175));y=Se(b.stateNode,b.type,b.memoizedProps,O,y,b,!Yf),b.updateQueue=y,y!==null&&qa(b)}else{var te=W(q,U,O,y,b);Ec(te,b,!1,!1),b.stateNode=te,z(te,q,U,O,y)&&qa(b)}b.ref!==null&&(b.flags|=512,b.flags|=2097152)}return Jn(b),null;case 6:if(y&&b.stateNode!=null)Xa(y,b,y.memoizedProps,U);else{if(typeof U!="string"&&b.stateNode===null)throw Error(i(166));if(y=co(wc.current),O=co(lo.current),H0(b)){if(!pe)throw Error(i(176));if(y=b.stateNode,O=b.memoizedProps,(U=Ve(y,O,b,!Yf))&&(q=ha,q!==null))switch(q.tag){case 3:ot(q.stateNode.containerInfo,y,O,(q.mode&1)!==0);break;case 5:pt(q.type,q.memoizedProps,q.stateNode,y,O,(q.mode&1)!==0)}U&&qa(b)}else b.stateNode=se(U,y,O,b)}return Jn(b),null;case 13:if(Jr(ts),U=b.memoizedState,y===null||y.memoizedState!==null&&y.memoizedState.dehydrated!==null){if(Wn&&Ka!==null&&(b.mode&1)!==0&&(b.flags&128)===0)m1(),iu(),b.flags|=98560,q=!1;else if(q=H0(b),U!==null&&U.dehydrated!==null){if(y===null){if(!q)throw Error(i(318));if(!pe)throw Error(i(344));if(q=b.memoizedState,q=q!==null?q.dehydrated:null,!q)throw Error(i(317));lt(q,b)}else iu(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;Jn(b),q=!1}else Fo!==null&&(bg(Fo),Fo=null),q=!0;if(!q)return b.flags&65536?b:null}return(b.flags&128)!==0?(b.lanes=O,b):(O=U!==null,O!==(y!==null&&y.memoizedState!==null)&&O&&(b.child.flags|=8192,(b.mode&1)!==0&&(y===null||(ts.current&1)!==0?Zn===0&&(Zn=3):Wd())),b.updateQueue!==null&&(b.flags|=4),Jn(b),null);case 4:return uu(),Nc(y,b),y===null&&Ae(b.stateNode.containerInfo),Jn(b),null;case 10:return Xf(b.type._context),Jn(b),null;case 17:return Zr(b.type)&&Be(),Jn(b),null;case 19:if(Jr(ts),q=b.memoizedState,q===null)return Jn(b),null;if(U=(b.flags&128)!==0,te=q.rendering,te===null)if(U)Wi(q,!1);else{if(Zn!==0||y!==null&&(y.flags&128)!==0)for(y=b.child;y!==null;){if(te=J0(y),te!==null){for(b.flags|=128,Wi(q,!1),y=te.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),b.subtreeFlags=0,y=O,O=b.child;O!==null;)U=O,q=y,U.flags&=14680066,te=U.alternate,te===null?(U.childLanes=0,U.lanes=q,U.child=null,U.subtreeFlags=0,U.memoizedProps=null,U.memoizedState=null,U.updateQueue=null,U.dependencies=null,U.stateNode=null):(U.childLanes=te.childLanes,U.lanes=te.lanes,U.child=te.child,U.subtreeFlags=0,U.deletions=null,U.memoizedProps=te.memoizedProps,U.memoizedState=te.memoizedState,U.updateQueue=te.updateQueue,U.type=te.type,q=te.dependencies,U.dependencies=q===null?null:{lanes:q.lanes,firstContext:q.firstContext}),O=O.sibling;return he(ts,ts.current&1|2),b.child}y=y.sibling}q.tail!==null&&Yn()>hh&&(b.flags|=128,U=!0,Wi(q,!1),b.lanes=4194304)}else{if(!U)if(y=J0(te),y!==null){if(b.flags|=128,U=!0,y=y.updateQueue,y!==null&&(b.updateQueue=y,b.flags|=4),Wi(q,!0),q.tail===null&&q.tailMode==="hidden"&&!te.alternate&&!Wn)return Jn(b),null}else 2*Yn()-q.renderingStartTime>hh&&O!==1073741824&&(b.flags|=128,U=!0,Wi(q,!1),b.lanes=4194304);q.isBackwards?(te.sibling=b.child,b.child=te):(y=q.last,y!==null?y.sibling=te:b.child=te,q.last=te)}return q.tail!==null?(b=q.tail,q.rendering=b,q.tail=b.sibling,q.renderingStartTime=Yn(),b.sibling=null,y=ts.current,he(ts,U?y&1|2:y&1),b):(Jn(b),null);case 22:case 23:return Sg(),O=b.memoizedState!==null,y!==null&&y.memoizedState!==null!==O&&(b.flags|=8192),O&&(b.mode&1)!==0?(Ws&1073741824)!==0&&(Jn(b),be&&b.subtreeFlags&6&&(b.flags|=8192)):Jn(b),null;case 24:return null;case 25:return null}throw Error(i(156,b.tag))}function P1(y,b){switch(qf(b),b.tag){case 1:return Zr(b.type)&&Be(),y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 3:return uu(),Jr(Cr),Jr(kr),bp(),y=b.flags,(y&65536)!==0&&(y&128)===0?(b.flags=y&-65537|128,b):null;case 5:return wp(b),null;case 13:if(Jr(ts),y=b.memoizedState,y!==null&&y.dehydrated!==null){if(b.alternate===null)throw Error(i(340));iu()}return y=b.flags,y&65536?(b.flags=y&-65537|128,b):null;case 19:return Jr(ts),null;case 4:return uu(),null;case 10:return Xf(b.type._context),null;case 22:case 23:return Sg(),null;case 24:return null;default:return null}}var Fd=!1,ta=!1,Hi=typeof WeakSet=="function"?WeakSet:Set,sr=null;function Sn(y,b){var O=y.ref;if(O!==null)if(typeof O=="function")try{O(null)}catch(U){Gn(y,b,U)}else O.current=null}function Gi(y,b,O){try{O()}catch(U){Gn(y,b,U)}}var Mp=!1;function F1(y,b){for(M(y.containerInfo),sr=b;sr!==null;)if(y=sr,b=y.child,(y.subtreeFlags&1028)!==0&&b!==null)b.return=y,sr=b;else for(;sr!==null;){y=sr;try{var O=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var U=O.memoizedProps,q=O.memoizedState,te=y.stateNode,ve=te.getSnapshotBeforeUpdate(y.elementType===y.type?U:zi(y.type,U),q);te.__reactInternalSnapshotBeforeUpdate=ve}break;case 3:be&&Fe(y.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Ge){Gn(y,y.return,Ge)}if(b=y.sibling,b!==null){b.return=y.return,sr=b;break}sr=y.return}return O=Mp,Mp=!1,O}function ku(y,b,O){var U=b.updateQueue;if(U=U!==null?U.lastEffect:null,U!==null){var q=U=U.next;do{if((q.tag&y)===y){var te=q.destroy;q.destroy=void 0,te!==void 0&&Gi(b,O,te)}q=q.next}while(q!==U)}}function Od(y,b){if(b=b.updateQueue,b=b!==null?b.lastEffect:null,b!==null){var O=b=b.next;do{if((O.tag&y)===y){var U=O.create;O.destroy=U()}O=O.next}while(O!==b)}}function dg(y){var b=y.ref;if(b!==null){var O=y.stateNode;switch(y.tag){case 5:y=ne(O);break;default:y=O}typeof b=="function"?b(y):b.current=y}}function oh(y){var b=y.alternate;b!==null&&(y.alternate=null,oh(b)),y.child=null,y.deletions=null,y.sibling=null,y.tag===5&&(b=y.stateNode,b!==null&&Le(b)),y.stateNode=null,y.return=null,y.dependencies=null,y.memoizedProps=null,y.memoizedState=null,y.pendingProps=null,y.stateNode=null,y.updateQueue=null}function Lp(y){return y.tag===5||y.tag===3||y.tag===4}function Cu(y){e:for(;;){for(;y.sibling===null;){if(y.return===null||Lp(y.return))return null;y=y.return}for(y.sibling.return=y.return,y=y.sibling;y.tag!==5&&y.tag!==6&&y.tag!==18;){if(y.flags&2||y.child===null||y.tag===4)continue e;y.child.return=y,y=y.child}if(!(y.flags&2))return y.stateNode}}function lh(y,b,O){var U=y.tag;if(U===5||U===6)y=y.stateNode,b?$t(O,y,b):Je(O,y);else if(U!==4&&(y=y.child,y!==null))for(lh(y,b,O),y=y.sibling;y!==null;)lh(y,b,O),y=y.sibling}function Bp(y,b,O){var U=y.tag;if(U===5||U===6)y=y.stateNode,b?Nt(O,y,b):Ie(O,y);else if(U!==4&&(y=y.child,y!==null))for(Bp(y,b,O),y=y.sibling;y!==null;)Bp(y,b,O),y=y.sibling}var xs=null,vi=!1;function Do(y,b,O){for(O=O.child;O!==null;)fg(y,b,O),O=O.sibling}function fg(y,b,O){if(pi&&typeof pi.onCommitFiberUnmount=="function")try{pi.onCommitFiberUnmount(mc,O)}catch{}switch(O.tag){case 5:ta||Sn(O,b);case 6:if(be){var U=xs,q=vi;xs=null,Do(y,b,O),xs=U,vi=q,xs!==null&&(vi?pr(xs,O.stateNode):ir(xs,O.stateNode))}else Do(y,b,O);break;case 18:be&&xs!==null&&(vi?Ne(xs,O.stateNode):Ee(xs,O.stateNode));break;case 4:be?(U=xs,q=vi,xs=O.stateNode.containerInfo,vi=!0,Do(y,b,O),xs=U,vi=q):(re&&(U=O.stateNode.containerInfo,q=kt(U),ke(U,q)),Do(y,b,O));break;case 0:case 11:case 14:case 15:if(!ta&&(U=O.updateQueue,U!==null&&(U=U.lastEffect,U!==null))){q=U=U.next;do{var te=q,ve=te.destroy;te=te.tag,ve!==void 0&&((te&2)!==0||(te&4)!==0)&&Gi(O,b,ve),q=q.next}while(q!==U)}Do(y,b,O);break;case 1:if(!ta&&(Sn(O,b),U=O.stateNode,typeof U.componentWillUnmount=="function"))try{U.props=O.memoizedProps,U.state=O.memoizedState,U.componentWillUnmount()}catch(Ge){Gn(O,b,Ge)}Do(y,b,O);break;case 21:Do(y,b,O);break;case 22:O.mode&1?(ta=(U=ta)||O.memoizedState!==null,Do(y,b,O),ta=U):Do(y,b,O);break;default:Do(y,b,O)}}function Tu(y){var b=y.updateQueue;if(b!==null){y.updateQueue=null;var O=y.stateNode;O===null&&(O=y.stateNode=new Hi),b.forEach(function(U){var q=V2.bind(null,y,U);O.has(U)||(O.add(U),U.then(q,q))})}}function fo(y,b){var O=b.deletions;if(O!==null)for(var U=0;U<O.length;U++){var q=O[U];try{var te=y,ve=b;if(be){var Ge=ve;e:for(;Ge!==null;){switch(Ge.tag){case 5:xs=Ge.stateNode,vi=!1;break e;case 3:xs=Ge.stateNode.containerInfo,vi=!0;break e;case 4:xs=Ge.stateNode.containerInfo,vi=!0;break e}Ge=Ge.return}if(xs===null)throw Error(i(160));fg(te,ve,q),xs=null,vi=!1}else fg(te,ve,q);var ft=q.alternate;ft!==null&&(ft.return=null),q.return=null}catch(Kt){Gn(q,b,Kt)}}if(b.subtreeFlags&12854)for(b=b.child;b!==null;)ch(b,y),b=b.sibling}function ch(y,b){var O=y.alternate,U=y.flags;switch(y.tag){case 0:case 11:case 14:case 15:if(fo(b,y),Vi(y),U&4){try{ku(3,y,y.return),Od(3,y)}catch(ar){Gn(y,y.return,ar)}try{ku(5,y,y.return)}catch(ar){Gn(y,y.return,ar)}}break;case 1:fo(b,y),Vi(y),U&512&&O!==null&&Sn(O,O.return);break;case 5:if(fo(b,y),Vi(y),U&512&&O!==null&&Sn(O,O.return),be){if(y.flags&32){var q=y.stateNode;try{Nr(q)}catch(ar){Gn(y,y.return,ar)}}if(U&4&&(q=y.stateNode,q!=null)){var te=y.memoizedProps;if(O=O!==null?O.memoizedProps:te,U=y.type,b=y.updateQueue,y.updateQueue=null,b!==null)try{Tt(q,b,U,O,te,y)}catch(ar){Gn(y,y.return,ar)}}}break;case 6:if(fo(b,y),Vi(y),U&4&&be){if(y.stateNode===null)throw Error(i(162));q=y.stateNode,te=y.memoizedProps,O=O!==null?O.memoizedProps:te;try{qe(q,O,te)}catch(ar){Gn(y,y.return,ar)}}break;case 3:if(fo(b,y),Vi(y),U&4){if(be&&pe&&O!==null&&O.memoizedState.isDehydrated)try{oe(b.containerInfo)}catch(ar){Gn(y,y.return,ar)}if(re){q=b.containerInfo,te=b.pendingChildren;try{ke(q,te)}catch(ar){Gn(y,y.return,ar)}}}break;case 4:if(fo(b,y),Vi(y),U&4&&re){te=y.stateNode,q=te.containerInfo,te=te.pendingChildren;try{ke(q,te)}catch(ar){Gn(y,y.return,ar)}}break;case 13:fo(b,y),Vi(y),q=y.child,q.flags&8192&&(te=q.memoizedState!==null,q.stateNode.isHidden=te,!te||q.alternate!==null&&q.alternate.memoizedState!==null||(Bd=Yn())),U&4&&Tu(y);break;case 22:var ve=O!==null&&O.memoizedState!==null;if(y.mode&1?(ta=(O=ta)||ve,fo(b,y),ta=O):fo(b,y),Vi(y),U&8192){if(O=y.memoizedState!==null,(y.stateNode.isHidden=O)&&!ve&&(y.mode&1)!==0)for(sr=y,U=y.child;U!==null;){for(b=sr=U;sr!==null;){ve=sr;var Ge=ve.child;switch(ve.tag){case 0:case 11:case 14:case 15:ku(4,ve,ve.return);break;case 1:Sn(ve,ve.return);var ft=ve.stateNode;if(typeof ft.componentWillUnmount=="function"){var Kt=ve,hr=ve.return;try{var Ur=Kt;ft.props=Ur.memoizedProps,ft.state=Ur.memoizedState,ft.componentWillUnmount()}catch(ar){Gn(Kt,hr,ar)}}break;case 5:Sn(ve,ve.return);break;case 22:if(ve.memoizedState!==null){mg(b);continue}}Ge!==null?(Ge.return=ve,sr=Ge):mg(b)}U=U.sibling}if(be){e:if(U=null,be)for(b=y;;){if(b.tag===5){if(U===null){U=b;try{q=b.stateNode,O?dr(q):ge(b.stateNode,b.memoizedProps)}catch(ar){Gn(y,y.return,ar)}}}else if(b.tag===6){if(U===null)try{te=b.stateNode,O?Vt(te):Te(te,b.memoizedProps)}catch(ar){Gn(y,y.return,ar)}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===y)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===y)break e;for(;b.sibling===null;){if(b.return===null||b.return===y)break e;U===b&&(U=null),b=b.return}U===b&&(U=null),b.sibling.return=b.return,b=b.sibling}}}break;case 19:fo(b,y),Vi(y),U&4&&Tu(y);break;case 21:break;default:fo(b,y),Vi(y)}}function Vi(y){var b=y.flags;if(b&2){try{if(be){e:{for(var O=y.return;O!==null;){if(Lp(O)){var U=O;break e}O=O.return}throw Error(i(160))}switch(U.tag){case 5:var q=U.stateNode;U.flags&32&&(Nr(q),U.flags&=-33);var te=Cu(y);Bp(y,te,q);break;case 3:case 4:var ve=U.stateNode.containerInfo,Ge=Cu(y);lh(y,Ge,ve);break;default:throw Error(i(161))}}}catch(ft){Gn(y,y.return,ft)}y.flags&=-3}b&4096&&(y.flags&=-4097)}function Dd(y,b,O){sr=y,hg(y)}function hg(y,b,O){for(var U=(y.mode&1)!==0;sr!==null;){var q=sr,te=q.child;if(q.tag===22&&U){var ve=q.memoizedState!==null||Fd;if(!ve){var Ge=q.alternate,ft=Ge!==null&&Ge.memoizedState!==null||ta;Ge=Fd;var Kt=ta;if(Fd=ve,(ta=ft)&&!Kt)for(sr=q;sr!==null;)ve=sr,ft=ve.child,ve.tag===22&&ve.memoizedState!==null?pg(q):ft!==null?(ft.return=ve,sr=ft):pg(q);for(;te!==null;)sr=te,hg(te),te=te.sibling;sr=q,Fd=Ge,ta=Kt}gg(y)}else(q.subtreeFlags&8772)!==0&&te!==null?(te.return=q,sr=te):gg(y)}}function gg(y){for(;sr!==null;){var b=sr;if((b.flags&8772)!==0){var O=b.alternate;try{if((b.flags&8772)!==0)switch(b.tag){case 0:case 11:case 15:ta||Od(5,b);break;case 1:var U=b.stateNode;if(b.flags&4&&!ta)if(O===null)U.componentDidMount();else{var q=b.elementType===b.type?O.memoizedProps:zi(b.type,O.memoizedProps);U.componentDidUpdate(q,O.memoizedState,U.__reactInternalSnapshotBeforeUpdate)}var te=b.updateQueue;te!==null&&_1(b,te,U);break;case 3:var ve=b.updateQueue;if(ve!==null){if(O=null,b.child!==null)switch(b.child.tag){case 5:O=ne(b.child.stateNode);break;case 1:O=b.child.stateNode}_1(b,ve,O)}break;case 5:var Ge=b.stateNode;O===null&&b.flags&4&&Ze(Ge,b.type,b.memoizedProps,b);break;case 6:break;case 4:break;case 12:break;case 13:if(pe&&b.memoizedState===null){var ft=b.alternate;if(ft!==null){var Kt=ft.memoizedState;if(Kt!==null){var hr=Kt.dehydrated;hr!==null&&fe(hr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}ta||b.flags&512&&dg(b)}catch(Ur){Gn(b,b.return,Ur)}}if(b===y){sr=null;break}if(O=b.sibling,O!==null){O.return=b.return,sr=O;break}sr=b.return}}function mg(y){for(;sr!==null;){var b=sr;if(b===y){sr=null;break}var O=b.sibling;if(O!==null){O.return=b.return,sr=O;break}sr=b.return}}function pg(y){for(;sr!==null;){var b=sr;try{switch(b.tag){case 0:case 11:case 15:var O=b.return;try{Od(4,b)}catch(ft){Gn(b,O,ft)}break;case 1:var U=b.stateNode;if(typeof U.componentDidMount=="function"){var q=b.return;try{U.componentDidMount()}catch(ft){Gn(b,q,ft)}}var te=b.return;try{dg(b)}catch(ft){Gn(b,te,ft)}break;case 5:var ve=b.return;try{dg(b)}catch(ft){Gn(b,ve,ft)}}}catch(ft){Gn(b,b.return,ft)}if(b===y){sr=null;break}var Ge=b.sibling;if(Ge!==null){Ge.return=b.return,sr=Ge;break}sr=b.return}}var Gl=0,Ja=1,nl=2,Id=3,uh=4;if(typeof Symbol=="function"&&Symbol.for){var Ki=Symbol.for;Gl=Ki("selector.component"),Ja=Ki("selector.has_pseudo_class"),nl=Ki("selector.role"),Id=Ki("selector.test_id"),uh=Ki("selector.text")}function sl(y){var b=Ce(y);if(b!=null){if(typeof b.memoizedProps["data-testname"]!="string")throw Error(i(364));return b}if(y=ht(y),y===null)throw Error(i(362));return y.stateNode.current}function dh(y,b){switch(b.$$typeof){case Gl:if(y.type===b.value)return!0;break;case Ja:e:{b=b.value,y=[y,0];for(var O=0;O<y.length;){var U=y[O++],q=y[O++],te=b[q];if(U.tag!==5||!Dt(U)){for(;te!=null&&dh(U,te);)q++,te=b[q];if(q===b.length){b=!0;break e}else for(U=U.child;U!==null;)y.push(U,q),U=U.sibling}}b=!1}return b;case nl:if(y.tag===5&&Rt(y.stateNode,b.value))return!0;break;case uh:if((y.tag===5||y.tag===6)&&(y=ut(y),y!==null&&0<=y.indexOf(b.value)))return!0;break;case Id:if(y.tag===5&&(y=y.memoizedProps["data-testname"],typeof y=="string"&&y.toLowerCase()===b.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function xg(y){switch(y.$$typeof){case Gl:return"<"+(F(y.value)||"Unknown")+">";case Ja:return":has("+(xg(y)||"")+")";case nl:return'[role="'+y.value+'"]';case uh:return'"'+y.value+'"';case Id:return'[data-testname="'+y.value+'"]';default:throw Error(i(365))}}function al(y,b){var O=[];y=[y,0];for(var U=0;U<y.length;){var q=y[U++],te=y[U++],ve=b[te];if(q.tag!==5||!Dt(q)){for(;ve!=null&&dh(q,ve);)te++,ve=b[te];if(te===b.length)O.push(q);else for(q=q.child;q!==null;)y.push(q,te),q=q.sibling}}return O}function il(y,b){if(!gt)throw Error(i(363));y=sl(y),y=al(y,b),b=[],y=Array.from(y);for(var O=0;O<y.length;){var U=y[O++];if(U.tag===5)Dt(U)||b.push(U.stateNode);else for(U=U.child;U!==null;)y.push(U),U=U.sibling}return b}var yg=Math.ceil,fh=o.ReactCurrentDispatcher,Rd=o.ReactCurrentOwner,ds=o.ReactCurrentBatchConfig,Kr=0,jn=null,Qn=null,ys=0,Ws=0,jc=rn(0),Zn=0,Md=null,Vl=0,$n=0,Ld=0,Eu=null,Aa=null,Bd=0,hh=1/0,Qa=null;function Tn(){hh=Yn()+500}var fs=!1,Cs=null,Io=null,Pc=!1,ho=null,vg=0,Ts=0,gh=null,$d=-1,Ud=0;function Hn(){return(Kr&6)!==0?Yn():$d!==-1?$d:$d=Yn()}function Hs(y){return(y.mode&1)===0?1:(Kr&2)!==0&&ys!==0?ys&-ys:W2.transition!==null?(Ud===0&&(Ud=Pt()),Ud):(y=Lt,y!==0?y:We())}function ja(y,b,O,U){if(50<Ts)throw Ts=0,gh=null,Error(i(185));nn(y,O,U),((Kr&2)===0||y!==jn)&&(y===jn&&((Kr&2)===0&&($n|=O),Zn===4&&Kl(y,ys)),Pa(y,U),O===1&&Kr===0&&(b.mode&1)===0&&(Tn(),wd&&fa()))}function Pa(y,b){var O=y.callbackNode;St(y,b);var U=mt(y,y===jn?ys:0);if(U===0)O!==null&&Vr(O),y.callbackNode=null,y.callbackPriority=0;else if(b=U&-U,y.callbackPriority!==b){if(O!=null&&Vr(O),b===1)y.tag===0?d1($p.bind(null,y)):z0($p.bind(null,y)),At?Qe(function(){(Kr&6)===0&&fa()}):Gr(oo,fa),O=null;else{switch(bn(U)){case 1:O=oo;break;case 4:O=gc;break;case 16:O=$0;break;case 536870912:O=z2;break;default:O=$0}O=Kp(O,wg.bind(null,y))}y.callbackPriority=b,y.callbackNode=O}}function wg(y,b){if($d=-1,Ud=0,(Kr&6)!==0)throw Error(i(327));var O=y.callbackNode;if(ql()&&y.callbackNode!==O)return null;var U=mt(y,y===jn?ys:0);if(U===0)return null;if((U&30)!==0||(U&y.expiredLanes)!==0||b)b=Nu(y,U);else{b=U;var q=Kr;Kr|=2;var te=zp();(jn!==y||ys!==b)&&(Qa=null,Tn(),Fc(y,b));do try{Wp();break}catch(Ge){zd(y,Ge)}while(!0);pp(),fh.current=te,Kr=q,Qn!==null?b=0:(jn=null,ys=0,b=Zn)}if(b!==0){if(b===2&&(q=br(y),q!==0&&(U=q,b=_g(y,q))),b===1)throw O=Md,Fc(y,0),Kl(y,U),Pa(y,Yn()),O;if(b===6)Kl(y,U);else{if(q=y.current.alternate,(U&30)===0&&!O1(q)&&(b=Nu(y,U),b===2&&(te=br(y),te!==0&&(U=te,b=_g(y,te))),b===1))throw O=Md,Fc(y,0),Kl(y,U),Pa(y,Yn()),O;switch(y.finishedWork=q,y.finishedLanes=U,b){case 0:case 1:throw Error(i(345));case 2:Oc(y,Aa,Qa);break;case 3:if(Kl(y,U),(U&130023424)===U&&(b=Bd+500-Yn(),10<b)){if(mt(y,0)!==0)break;if(q=y.suspendedLanes,(q&U)!==U){Hn(),y.pingedLanes|=y.suspendedLanes&q;break}y.timeoutHandle=X(Oc.bind(null,y,Aa,Qa),b);break}Oc(y,Aa,Qa);break;case 4:if(Kl(y,U),(U&4194240)===U)break;for(b=y.eventTimes,q=-1;0<U;){var ve=31-Kn(U);te=1<<ve,ve=b[ve],ve>q&&(q=ve),U&=~te}if(U=q,U=Yn()-U,U=(120>U?120:480>U?480:1080>U?1080:1920>U?1920:3e3>U?3e3:4320>U?4320:1960*yg(U/1960))-U,10<U){y.timeoutHandle=X(Oc.bind(null,y,Aa,Qa),U);break}Oc(y,Aa,Qa);break;case 5:Oc(y,Aa,Qa);break;default:throw Error(i(329))}}}return Pa(y,Yn()),y.callbackNode===O?wg.bind(null,y):null}function _g(y,b){var O=Eu;return y.current.memoizedState.isDehydrated&&(Fc(y,b).flags|=256),y=Nu(y,b),y!==2&&(b=Aa,Aa=O,b!==null&&bg(b)),y}function bg(y){Aa===null?Aa=y:Aa.push.apply(Aa,y)}function O1(y){for(var b=y;;){if(b.flags&16384){var O=b.updateQueue;if(O!==null&&(O=O.stores,O!==null))for(var U=0;U<O.length;U++){var q=O[U],te=q.getSnapshot;q=q.value;try{if(!Ao(te(),q))return!1}catch{return!1}}}if(O=b.child,b.subtreeFlags&16384&&O!==null)O.return=b,b=O;else{if(b===y)break;for(;b.sibling===null;){if(b.return===null||b.return===y)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function Kl(y,b){for(b&=~Ld,b&=~$n,y.suspendedLanes|=b,y.pingedLanes&=~b,y=y.expirationTimes;0<b;){var O=31-Kn(b),U=1<<O;y[O]=-1,b&=~U}}function $p(y){if((Kr&6)!==0)throw Error(i(327));ql();var b=mt(y,0);if((b&1)===0)return Pa(y,Yn()),null;var O=Nu(y,b);if(y.tag!==0&&O===2){var U=br(y);U!==0&&(b=U,O=_g(y,U))}if(O===1)throw O=Md,Fc(y,0),Kl(y,b),Pa(y,Yn()),O;if(O===6)throw Error(i(345));return y.finishedWork=y.current.alternate,y.finishedLanes=b,Oc(y,Aa,Qa),Pa(y,Yn()),null}function Up(y){ho!==null&&ho.tag===0&&(Kr&6)===0&&ql();var b=Kr;Kr|=1;var O=ds.transition,U=Lt;try{if(ds.transition=null,Lt=1,y)return y()}finally{Lt=U,ds.transition=O,Kr=b,(Kr&6)===0&&fa()}}function Sg(){Ws=jc.current,Jr(jc)}function Fc(y,b){y.finishedWork=null,y.finishedLanes=0;var O=y.timeoutHandle;if(O!==le&&(y.timeoutHandle=le,ie(O)),Qn!==null)for(O=Qn.return;O!==null;){var U=O;switch(qf(U),U.tag){case 1:U=U.type.childContextTypes,U!=null&&Be();break;case 3:uu(),Jr(Cr),Jr(kr),bp();break;case 5:wp(U);break;case 4:uu();break;case 13:Jr(ts);break;case 19:Jr(ts);break;case 10:Xf(U.type._context);break;case 22:case 23:Sg()}O=O.return}if(jn=y,Qn=y=Dc(y.current,null),ys=Ws=b,Zn=0,Md=null,Ld=$n=Vl=0,Aa=Eu=null,xc!==null){for(b=0;b<xc.length;b++)if(O=xc[b],U=O.interleaved,U!==null){O.interleaved=null;var q=U.next,te=O.pending;if(te!==null){var ve=te.next;te.next=q,U.next=ve}O.pending=U}xc=null}return y}function zd(y,b){do{var O=Qn;try{if(pp(),yi.current=xu,Td){for(var U=Xn.memoizedState;U!==null;){var q=U.queue;q!==null&&(q.pending=null),U=U.next}Td=!1}if(_c=0,Us=ks=Xn=null,Qf=!1,Zf=0,Rd.current=null,O===null||O.return===null){Zn=1,Md=b,Qn=null;break}e:{var te=y,ve=O.return,Ge=O,ft=b;if(b=ys,Ge.flags|=32768,ft!==null&&typeof ft=="object"&&typeof ft.then=="function"){var Kt=ft,hr=Ge,Ur=hr.tag;if((hr.mode&1)===0&&(Ur===0||Ur===11||Ur===15)){var ar=hr.alternate;ar?(hr.updateQueue=ar.updateQueue,hr.memoizedState=ar.memoizedState,hr.lanes=ar.lanes):(hr.updateQueue=null,hr.memoizedState=null)}var Un=A1(ve);if(Un!==null){Un.flags&=-257,kc(Un,ve,Ge,te,b),Un.mode&1&&N1(te,Kt,b),b=Un,ft=Kt;var kn=b.updateQueue;if(kn===null){var Za=new Set;Za.add(ft),b.updateQueue=Za}else kn.add(ft);break e}else{if((b&1)===0){N1(te,Kt,b),Wd();break e}ft=Error(i(426))}}else if(Wn&&Ge.mode&1){var ol=A1(ve);if(ol!==null){(ol.flags&65536)===0&&(ol.flags|=256),kc(ol,ve,Ge,te,b),gp(yu(ft,Ge));break e}}te=ft=yu(ft,Ge),Zn!==4&&(Zn=2),Eu===null?Eu=[te]:Eu.push(te),te=ve;do{switch(te.tag){case 3:te.flags|=65536,b&=-b,te.lanes|=b;var ct=el(te,ft,b);kd(te,ct);break e;case 1:Ge=ft;var Xe=te.type,yt=te.stateNode;if((te.flags&128)===0&&(typeof Xe.getDerivedStateFromError=="function"||yt!==null&&typeof yt.componentDidCatch=="function"&&(Io===null||!Io.has(yt)))){te.flags|=65536,b&=-b,te.lanes|=b;var or=og(te,Ge,b);kd(te,or);break e}}te=te.return}while(te!==null)}Gp(O)}catch(Tr){b=Tr,Qn===O&&O!==null&&(Qn=O=O.return);continue}break}while(!0)}function zp(){var y=fh.current;return fh.current=xu,y===null?xu:y}function Wd(){(Zn===0||Zn===3||Zn===2)&&(Zn=4),jn===null||(Vl&268435455)===0&&($n&268435455)===0||Kl(jn,ys)}function Nu(y,b){var O=Kr;Kr|=2;var U=zp();(jn!==y||ys!==b)&&(Qa=null,Fc(y,b));do try{D1();break}catch(q){zd(y,q)}while(!0);if(pp(),Kr=O,fh.current=U,Qn!==null)throw Error(i(261));return jn=null,ys=0,Zn}function D1(){for(;Qn!==null;)Hp(Qn)}function Wp(){for(;Qn!==null&&!qn();)Hp(Qn)}function Hp(y){var b=B1(y.alternate,y,Ws);y.memoizedProps=y.pendingProps,b===null?Gp(y):Qn=b,Rd.current=null}function Gp(y){var b=y;do{var O=b.alternate;if(y=b.return,(b.flags&32768)===0){if(O=Su(O,b,Ws),O!==null){Qn=O;return}}else{if(O=P1(O,b),O!==null){O.flags&=32767,Qn=O;return}if(y!==null)y.flags|=32768,y.subtreeFlags=0,y.deletions=null;else{Zn=6,Qn=null;return}}if(b=b.sibling,b!==null){Qn=b;return}Qn=b=y}while(b!==null);Zn===0&&(Zn=5)}function Oc(y,b,O){var U=Lt,q=ds.transition;try{ds.transition=null,Lt=1,I1(y,b,O,U)}finally{ds.transition=q,Lt=U}return null}function I1(y,b,O,U){do ql();while(ho!==null);if((Kr&6)!==0)throw Error(i(327));O=y.finishedWork;var q=y.finishedLanes;if(O===null)return null;if(y.finishedWork=null,y.finishedLanes=0,O===y.current)throw Error(i(177));y.callbackNode=null,y.callbackPriority=0;var te=O.lanes|O.childLanes;if(rt(y,te),y===jn&&(Qn=jn=null,ys=0),(O.subtreeFlags&2064)===0&&(O.flags&2064)===0||Pc||(Pc=!0,Kp($0,function(){return ql(),null})),te=(O.flags&15990)!==0,(O.subtreeFlags&15990)!==0||te){te=ds.transition,ds.transition=null;var ve=Lt;Lt=1;var Ge=Kr;Kr|=4,Rd.current=null,F1(y,O),ch(O,y),H(y.containerInfo),y.current=O,Dd(O),Mn(),Kr=Ge,Lt=ve,ds.transition=te}else y.current=O;if(Pc&&(Pc=!1,ho=y,vg=q),te=y.pendingLanes,te===0&&(Io=null),vd(O.stateNode),Pa(y,Yn()),b!==null)for(U=y.onRecoverableError,O=0;O<b.length;O++)q=b[O],U(q.value,{componentStack:q.stack,digest:q.digest});if(fs)throw fs=!1,y=Cs,Cs=null,y;return(vg&1)!==0&&y.tag!==0&&ql(),te=y.pendingLanes,(te&1)!==0?y===gh?Ts++:(Ts=0,gh=y):Ts=0,fa(),null}function ql(){if(ho!==null){var y=bn(vg),b=ds.transition,O=Lt;try{if(ds.transition=null,Lt=16>y?16:y,ho===null)var U=!1;else{if(y=ho,ho=null,vg=0,(Kr&6)!==0)throw Error(i(331));var q=Kr;for(Kr|=4,sr=y.current;sr!==null;){var te=sr,ve=te.child;if((sr.flags&16)!==0){var Ge=te.deletions;if(Ge!==null){for(var ft=0;ft<Ge.length;ft++){var Kt=Ge[ft];for(sr=Kt;sr!==null;){var hr=sr;switch(hr.tag){case 0:case 11:case 15:ku(8,hr,te)}var Ur=hr.child;if(Ur!==null)Ur.return=hr,sr=Ur;else for(;sr!==null;){hr=sr;var ar=hr.sibling,Un=hr.return;if(oh(hr),hr===Kt){sr=null;break}if(ar!==null){ar.return=Un,sr=ar;break}sr=Un}}}var kn=te.alternate;if(kn!==null){var Za=kn.child;if(Za!==null){kn.child=null;do{var ol=Za.sibling;Za.sibling=null,Za=ol}while(Za!==null)}}sr=te}}if((te.subtreeFlags&2064)!==0&&ve!==null)ve.return=te,sr=ve;else e:for(;sr!==null;){if(te=sr,(te.flags&2048)!==0)switch(te.tag){case 0:case 11:case 15:ku(9,te,te.return)}var ct=te.sibling;if(ct!==null){ct.return=te.return,sr=ct;break e}sr=te.return}}var Xe=y.current;for(sr=Xe;sr!==null;){ve=sr;var yt=ve.child;if((ve.subtreeFlags&2064)!==0&&yt!==null)yt.return=ve,sr=yt;else e:for(ve=Xe;sr!==null;){if(Ge=sr,(Ge.flags&2048)!==0)try{switch(Ge.tag){case 0:case 11:case 15:Od(9,Ge)}}catch(Tr){Gn(Ge,Ge.return,Tr)}if(Ge===ve){sr=null;break e}var or=Ge.sibling;if(or!==null){or.return=Ge.return,sr=or;break e}sr=Ge.return}}if(Kr=q,fa(),pi&&typeof pi.onPostCommitFiberRoot=="function")try{pi.onPostCommitFiberRoot(mc,y)}catch{}U=!0}return U}finally{Lt=O,ds.transition=b}}return!1}function Vp(y,b,O){b=yu(O,b),b=el(y,b,1),y=Ul(y,b,1),b=Hn(),y!==null&&(nn(y,1,b),Pa(y,b))}function Gn(y,b,O){if(y.tag===3)Vp(y,y,O);else for(;b!==null;){if(b.tag===3){Vp(b,y,O);break}else if(b.tag===1){var U=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof U.componentDidCatch=="function"&&(Io===null||!Io.has(U))){y=yu(O,y),y=og(b,y,1),b=Ul(b,y,1),y=Hn(),b!==null&&(nn(b,1,y),Pa(b,y));break}}b=b.return}}function R1(y,b,O){var U=y.pingCache;U!==null&&U.delete(b),b=Hn(),y.pingedLanes|=y.suspendedLanes&O,jn===y&&(ys&O)===O&&(Zn===4||Zn===3&&(ys&130023424)===ys&&500>Yn()-Bd?Fc(y,0):Ld|=O),Pa(y,b)}function M1(y,b){b===0&&((y.mode&1)===0?b=1:(b=su,su<<=1,(su&130023424)===0&&(su=4194304)));var O=Hn();y=Oo(y,b),y!==null&&(nn(y,b,O),Pa(y,O))}function L1(y){var b=y.memoizedState,O=0;b!==null&&(O=b.retryLane),M1(y,O)}function V2(y,b){var O=0;switch(y.tag){case 13:var U=y.stateNode,q=y.memoizedState;q!==null&&(O=q.retryLane);break;case 19:U=y.stateNode;break;default:throw Error(i(314))}U!==null&&U.delete(b),M1(y,O)}var B1;B1=function(y,b,O){if(y!==null)if(y.memoizedProps!==b.pendingProps||Cr.current)zs=!0;else{if((y.lanes&O)===0&&(b.flags&128)===0)return zs=!1,Tc(y,b,O);zs=(y.flags&131072)!==0}else zs=!1,Wn&&(b.flags&1048576)!==0&&f1(b,au,b.index);switch(b.lanes=0,b.tag){case 2:var U=b.type;ih(y,b),y=b.pendingProps;var q=_n(b,kr.current);Sd(b,O),q=eh(null,b,U,y,q,O);var te=Q0();return b.flags|=1,typeof q=="object"&&q!==null&&typeof q.render=="function"&&q.$$typeof===void 0?(b.tag=1,b.memoizedState=null,b.updateQueue=null,Zr(U)?(te=!0,lr(b)):te=!1,b.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,yp(b),q.updater=nh,b.stateNode=q,q._reactInternals=b,Zo(b,U,y,O),b=Ea(null,b,U,!0,te,O)):(b.tag=0,Wn&&te&&Kf(b),ea(null,b,q,O),b=b.child),b;case 16:U=b.elementType;e:{switch(ih(y,b),y=b.pendingProps,q=U._init,U=q(U._payload),b.type=U,q=b.tag=K2(U),y=zi(U,y),q){case 0:b=tl(null,b,U,y,O);break e;case 1:b=ma(null,b,U,y,O);break e;case 11:b=lg(null,b,U,y,O);break e;case 14:b=vu(null,b,U,zi(U.type,y),O);break e}throw Error(i(306,U,""))}return b;case 0:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:zi(U,q),tl(y,b,U,q,O);case 1:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:zi(U,q),ma(y,b,U,q,O);case 3:e:{if(Cc(b),y===null)throw Error(i(387));U=b.pendingProps,te=b.memoizedState,q=te.element,w1(y,b),yc(b,U,null,O);var ve=b.memoizedState;if(U=ve.element,pe&&te.isDehydrated)if(te={element:U,isDehydrated:!1,cache:ve.cache,pendingSuspenseBoundaries:ve.pendingSuspenseBoundaries,transitions:ve.transitions},b.updateQueue.baseState=te,b.memoizedState=te,b.flags&256){q=yu(Error(i(423)),b),b=wu(y,b,U,O,q);break e}else if(U!==q){q=yu(Error(i(424)),b),b=wu(y,b,U,O,q);break e}else for(pe&&(Ka=xe(b.stateNode.containerInfo),ha=b,Wn=!0,Fo=null,Yf=!1),O=y1(b,null,U,O),b.child=O;O;)O.flags=O.flags&-3|4096,O=O.sibling;else{if(iu(),U===q){b=Hl(y,b,O);break e}ea(y,b,U,O)}b=b.child}return b;case 5:return vp(b),y===null&&hp(b),U=b.type,q=b.pendingProps,te=y!==null?y.memoizedProps:null,ve=q.children,J(U,q)?ve=null:te!==null&&J(U,te)&&(b.flags|=32),An(y,b),ea(y,b,ve,O),b.child;case 6:return y===null&&hp(b),null;case 13:return Rp(y,b,O);case 4:return X0(b,b.stateNode.containerInfo),U=b.pendingProps,y===null?b.child=lu(b,null,U,O):ea(y,b,U,O),b.child;case 11:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:zi(U,q),lg(y,b,U,q,O);case 7:return ea(y,b,b.pendingProps,O),b.child;case 8:return ea(y,b,b.pendingProps.children,O),b.child;case 12:return ea(y,b,b.pendingProps.children,O),b.child;case 10:e:{if(U=b.type._context,q=b.pendingProps,te=b.memoizedProps,ve=q.value,v1(b,U,ve),te!==null)if(Ao(te.value,ve)){if(te.children===q.children&&!Cr.current){b=Hl(y,b,O);break e}}else for(te=b.child,te!==null&&(te.return=b);te!==null;){var Ge=te.dependencies;if(Ge!==null){ve=te.child;for(var ft=Ge.firstContext;ft!==null;){if(ft.context===U){if(te.tag===1){ft=$l(-1,O&-O),ft.tag=2;var Kt=te.updateQueue;if(Kt!==null){Kt=Kt.shared;var hr=Kt.pending;hr===null?ft.next=ft:(ft.next=hr.next,hr.next=ft),Kt.pending=ft}}te.lanes|=O,ft=te.alternate,ft!==null&&(ft.lanes|=O),cu(te.return,O,b),Ge.lanes|=O;break}ft=ft.next}}else if(te.tag===10)ve=te.type===b.type?null:te.child;else if(te.tag===18){if(ve=te.return,ve===null)throw Error(i(341));ve.lanes|=O,Ge=ve.alternate,Ge!==null&&(Ge.lanes|=O),cu(ve,O,b),ve=te.sibling}else ve=te.child;if(ve!==null)ve.return=te;else for(ve=te;ve!==null;){if(ve===b){ve=null;break}if(te=ve.sibling,te!==null){te.return=ve.return,ve=te;break}ve=ve.return}te=ve}ea(y,b,q.children,O),b=b.child}return b;case 9:return q=b.type,U=b.pendingProps.children,Sd(b,O),q=Bi(q),U=U(q),b.flags|=1,ea(y,b,U,O),b.child;case 14:return U=b.type,q=zi(U,b.pendingProps),q=zi(U.type,q),vu(y,b,U,q,O);case 15:return Wl(y,b,b.type,b.pendingProps,O);case 17:return U=b.type,q=b.pendingProps,q=b.elementType===U?q:zi(U,q),ih(y,b),b.tag=1,Zr(U)?(y=!0,lr(b)):y=!1,Sd(b,O),E1(b,U,q),Zo(b,U,q,O),Ea(null,b,U,!0,y,O);case 19:return ug(y,b,O);case 22:return Bn(y,b,O)}throw Error(i(156,b.tag))};function Kp(y,b){return Gr(y,b)}function $1(y,b,O,U){this.tag=y,this.key=O,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=U,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qi(y,b,O,U){return new $1(y,b,O,U)}function Hd(y){return y=y.prototype,!(!y||!y.isReactComponent)}function K2(y){if(typeof y=="function")return Hd(y)?1:0;if(y!=null){if(y=y.$$typeof,y===v)return 11;if(y===k)return 14}return 2}function Dc(y,b){var O=y.alternate;return O===null?(O=qi(y.tag,b,y.key,y.mode),O.elementType=y.elementType,O.type=y.type,O.stateNode=y.stateNode,O.alternate=y,y.alternate=O):(O.pendingProps=b,O.type=y.type,O.flags=0,O.subtreeFlags=0,O.deletions=null),O.flags=y.flags&14680064,O.childLanes=y.childLanes,O.lanes=y.lanes,O.child=y.child,O.memoizedProps=y.memoizedProps,O.memoizedState=y.memoizedState,O.updateQueue=y.updateQueue,b=y.dependencies,O.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},O.sibling=y.sibling,O.index=y.index,O.ref=y.ref,O}function kg(y,b,O,U,q,te){var ve=2;if(U=y,typeof y=="function")Hd(y)&&(ve=1);else if(typeof y=="string")ve=5;else e:switch(y){case d:return pa(O.children,q,te,b);case f:ve=8,q|=8;break;case g:return y=qi(12,O,b,q|2),y.elementType=g,y.lanes=te,y;case w:return y=qi(13,O,b,q),y.elementType=w,y.lanes=te,y;case C:return y=qi(19,O,b,q),y.elementType=C,y.lanes=te,y;case N:return Gd(O,q,te,b);default:if(typeof y=="object"&&y!==null)switch(y.$$typeof){case p:ve=10;break e;case x:ve=9;break e;case v:ve=11;break e;case k:ve=14;break e;case _:ve=16,U=null;break e}throw Error(i(130,y==null?y:typeof y,""))}return b=qi(ve,O,b,q),b.elementType=y,b.type=U,b.lanes=te,b}function pa(y,b,O,U){return y=qi(7,y,U,b),y.lanes=O,y}function Gd(y,b,O,U){return y=qi(22,y,U,b),y.elementType=N,y.lanes=O,y.stateNode={isHidden:!1},y}function Vd(y,b,O){return y=qi(6,y,null,b),y.lanes=O,y}function Cg(y,b,O){return b=qi(4,y.children!==null?y.children:[],y.key,b),b.lanes=O,b.stateNode={containerInfo:y.containerInfo,pendingChildren:null,implementation:y.implementation},b}function U1(y,b,O,U,q){this.tag=b,this.containerInfo=y,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Wr(0),this.expirationTimes=Wr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wr(0),this.identifierPrefix=U,this.onRecoverableError=q,pe&&(this.mutableSourceEagerHydrationData=null)}function qp(y,b,O,U,q,te,ve,Ge,ft){return y=new U1(y,b,O,Ge,ft),b===1?(b=1,te===!0&&(b|=8)):b=0,te=qi(3,null,null,b),y.current=te,te.stateNode=y,te.memoizedState={element:U,isDehydrated:O,cache:null,transitions:null,pendingSuspenseBoundaries:null},yp(te),y}function Tg(y){if(!y)return vt;y=y._reactInternals;e:{if(j(y)!==y||y.tag!==1)throw Error(i(170));var b=y;do{switch(b.tag){case 3:b=b.stateNode.context;break e;case 1:if(Zr(b.type)){b=b.stateNode.__reactInternalMemoizedMergedChildContext;break e}}b=b.return}while(b!==null);throw Error(i(171))}if(y.tag===1){var O=y.type;if(Zr(O))return qt(y,O,b)}return b}function Au(y){var b=y._reactInternals;if(b===void 0)throw typeof y.render=="function"?Error(i(188)):(y=Object.keys(y).join(","),Error(i(268,y)));return y=Y(b),y===null?null:y.stateNode}function Eg(y,b){if(y=y.memoizedState,y!==null&&y.dehydrated!==null){var O=y.retryLane;y.retryLane=O!==0&&O<b?O:b}}function Kd(y,b){Eg(y,b),(y=y.alternate)&&Eg(y,b)}function q2(y){return y=Y(y),y===null?null:y.stateNode}function z1(){return null}return r.attemptContinuousHydration=function(y){if(y.tag===13){var b=Oo(y,134217728);if(b!==null){var O=Hn();ja(b,y,134217728,O)}Kd(y,134217728)}},r.attemptDiscreteHydration=function(y){if(y.tag===13){var b=Oo(y,1);if(b!==null){var O=Hn();ja(b,y,1,O)}Kd(y,1)}},r.attemptHydrationAtCurrentPriority=function(y){if(y.tag===13){var b=Hs(y),O=Oo(y,b);if(O!==null){var U=Hn();ja(O,y,b,U)}Kd(y,b)}},r.attemptSynchronousHydration=function(y){switch(y.tag){case 3:var b=y.stateNode;if(b.current.memoizedState.isDehydrated){var O=st(b.pendingLanes);O!==0&&(Qt(b,O|1),Pa(b,Yn()),(Kr&6)===0&&(Tn(),fa()))}break;case 13:Up(function(){var U=Oo(y,1);if(U!==null){var q=Hn();ja(U,y,1,q)}}),Kd(y,1)}},r.batchedUpdates=function(y,b){var O=Kr;Kr|=1;try{return y(b)}finally{Kr=O,Kr===0&&(Tn(),wd&&fa())}},r.createComponentSelector=function(y){return{$$typeof:Gl,value:y}},r.createContainer=function(y,b,O,U,q,te,ve){return qp(y,b,!1,null,O,U,q,te,ve)},r.createHasPseudoClassSelector=function(y){return{$$typeof:Ja,value:y}},r.createHydrationContainer=function(y,b,O,U,q,te,ve,Ge,ft){return y=qp(O,U,!0,y,q,te,ve,Ge,ft),y.context=Tg(null),O=y.current,U=Hn(),q=Hs(O),te=$l(U,q),te.callback=b??null,Ul(O,te,q),y.current.lanes=q,nn(y,q,U),Pa(y,U),y},r.createPortal=function(y,b,O){var U=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:U==null?null:""+U,children:y,containerInfo:b,implementation:O}},r.createRoleSelector=function(y){return{$$typeof:nl,value:y}},r.createTestNameSelector=function(y){return{$$typeof:Id,value:y}},r.createTextSelector=function(y){return{$$typeof:uh,value:y}},r.deferredUpdates=function(y){var b=Lt,O=ds.transition;try{return ds.transition=null,Lt=16,y()}finally{Lt=b,ds.transition=O}},r.discreteUpdates=function(y,b,O,U,q){var te=Lt,ve=ds.transition;try{return ds.transition=null,Lt=1,y(b,O,U,q)}finally{Lt=te,ds.transition=ve,Kr===0&&Tn()}},r.findAllNodes=il,r.findBoundingRects=function(y,b){if(!gt)throw Error(i(363));b=il(y,b),y=[];for(var O=0;O<b.length;O++)y.push(tt(b[O]));for(b=y.length-1;0<b;b--){O=y[b];for(var U=O.x,q=U+O.width,te=O.y,ve=te+O.height,Ge=b-1;0<=Ge;Ge--)if(b!==Ge){var ft=y[Ge],Kt=ft.x,hr=Kt+ft.width,Ur=ft.y,ar=Ur+ft.height;if(U>=Kt&&te>=Ur&&q<=hr&&ve<=ar){y.splice(b,1);break}else if(U!==Kt||O.width!==ft.width||ar<te||Ur>ve){if(!(te!==Ur||O.height!==ft.height||hr<U||Kt>q)){Kt>U&&(ft.width+=Kt-U,ft.x=U),hr<q&&(ft.width=q-Kt),y.splice(b,1);break}}else{Ur>te&&(ft.height+=Ur-te,ft.y=te),ar<ve&&(ft.height=ve-Ur),y.splice(b,1);break}}}return y},r.findHostInstance=Au,r.findHostInstanceWithNoPortals=function(y){return y=L(y),y=y!==null?ae(y):null,y===null?null:y.stateNode},r.findHostInstanceWithWarning=function(y){return Au(y)},r.flushControlled=function(y){var b=Kr;Kr|=1;var O=ds.transition,U=Lt;try{ds.transition=null,Lt=1,y()}finally{Lt=U,ds.transition=O,Kr=b,Kr===0&&(Tn(),fa())}},r.flushPassiveEffects=ql,r.flushSync=Up,r.focusWithin=function(y,b){if(!gt)throw Error(i(363));for(y=sl(y),b=al(y,b),b=Array.from(b),y=0;y<b.length;){var O=b[y++];if(!Dt(O)){if(O.tag===5&&It(O.stateNode))return!0;for(O=O.child;O!==null;)b.push(O),O=O.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Lt},r.getFindAllNodesFailureDescription=function(y,b){if(!gt)throw Error(i(363));var O=0,U=[];y=[sl(y),0];for(var q=0;q<y.length;){var te=y[q++],ve=y[q++],Ge=b[ve];if((te.tag!==5||!Dt(te))&&(dh(te,Ge)&&(U.push(xg(Ge)),ve++,ve>O&&(O=ve)),ve<b.length))for(te=te.child;te!==null;)y.push(te,ve),te=te.sibling}if(O<b.length){for(y=[];O<b.length;O++)y.push(xg(b[O]));return`findAllNodes was able to match part of the selector:
  `+(U.join(" > ")+`

No matching component was found for:
  `)+y.join(" > ")}return null},r.getPublicRootInstance=function(y){if(y=y.current,!y.child)return null;switch(y.child.tag){case 5:return ne(y.child.stateNode);default:return y.child.stateNode}},r.injectIntoDevTools=function(y){if(y={bundleType:y.bundleType,version:y.version,rendererPackageName:y.rendererPackageName,rendererConfig:y.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:q2,findFiberByHostInstance:y.findFiberByHostInstance||z1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")y=!1;else{var b=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(b.isDisabled||!b.supportsFiber)y=!0;else{try{mc=b.inject(y),pi=b}catch{}y=!!b.checkDCE}}return y},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(y,b,O,U){if(!gt)throw Error(i(363));y=il(y,b);var q=De(y,O,U).disconnect;return{disconnect:function(){q()}}},r.registerMutableSourceForHydration=function(y,b){var O=b._getVersion;O=O(b._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[b,O]:y.mutableSourceEagerHydrationData.push(b,O)},r.runWithPriority=function(y,b){var O=Lt;try{return Lt=y,b()}finally{Lt=O}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(y,b,O,U){var q=b.current,te=Hn(),ve=Hs(q);return O=Tg(O),b.context===null?b.context=O:b.pendingContext=O,b=$l(te,ve),b.payload={element:y},U=U===void 0?null:U,U!==null&&(b.callback=U),y=Ul(q,b,ve),y!==null&&(ja(y,q,ve,te),Jf(y,q,ve)),ve},r}),YS}var pP;function yZ(){return pP||(pP=1,qS.exports=xZ()),qS.exports}var vZ=yZ();const wZ=Ol(vZ);var XS={exports:{}},rf={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xP;function _Z(){return xP||(xP=1,rf.ConcurrentRoot=1,rf.ContinuousEventPriority=4,rf.DefaultEventPriority=16,rf.DiscreteEventPriority=1,rf.IdleEventPriority=536870912,rf.LegacyRoot=0),rf}var yP;function bZ(){return yP||(yP=1,XS.exports=_Z()),XS.exports}var vL=bZ(),SZ=tn();const vP={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let wP=!1,_P=!1;const e4=".react-konva-event";let wL=!1;function kZ(e){wL=e}const CZ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,TZ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,EZ={};function Bb(e,t,r=EZ){if(!wP&&"zIndex"in t&&(console.warn(TZ),wP=!0),!_P&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(CZ),_P=!0)}for(var a in r)if(!vP[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var u=!t.hasOwnProperty(a);u&&e.setAttr(a,void 0)}var d=wL||t._useStrictMode,f={},g=!1;const p={};for(var a in t)if(!vP[a]){var i=a.slice(0,2)==="on",x=r[a]!==t[a];if(i&&x){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(p[c]=t[a])}!i&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(g=!0,f[a]=t[a])}g&&(e.setAttrs(f),Of(e));for(var c in p)e.on(c+e4,p[c])}function Of(e){if(!SZ.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var JS=fN();const _L={},NZ={};zy.Node.prototype._applyProps=Bb;function AZ(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Of(e)}function jZ(e,t,r){let n=zy[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=zy.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return Bb(c,a),c}function PZ(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function FZ(e,t,r){return!1}function OZ(e){return e}function DZ(){return null}function IZ(){return null}function RZ(e,t,r,n){return NZ}function MZ(){}function LZ(e){}function BZ(e,t){return!1}function $Z(){return _L}function UZ(){return _L}const zZ=setTimeout,WZ=clearTimeout,HZ=-1;function GZ(e,t){return!1}const VZ=!1,KZ=!0,qZ=!0;function YZ(e,t){t.parent===e?t.moveToTop():e.add(t),Of(e)}function XZ(e,t){t.parent===e?t.moveToTop():e.add(t),Of(e)}function bL(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Of(e)}function JZ(e,t,r){bL(e,t,r)}function QZ(e,t){t.destroy(),t.off(e4),Of(e)}function ZZ(e,t){t.destroy(),t.off(e4),Of(e)}function eee(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function tee(e,t,r){}function ree(e,t,r,n,s){Bb(e,s,n)}function nee(e){e.hide(),Of(e)}function see(e){}function aee(e,t){(t.visible==null||t.visible)&&e.show()}function iee(e,t){}function oee(e){}function lee(){}const cee=()=>vL.DefaultEventPriority,uee=Object.freeze(Object.defineProperty({__proto__:null,appendChild:YZ,appendChildToContainer:XZ,appendInitialChild:AZ,cancelTimeout:WZ,clearContainer:oee,commitMount:tee,commitTextUpdate:eee,commitUpdate:ree,createInstance:jZ,createTextInstance:PZ,detachDeletedInstance:lee,finalizeInitialChildren:FZ,getChildHostContext:UZ,getCurrentEventPriority:cee,getPublicInstance:OZ,getRootHostContext:$Z,hideInstance:nee,hideTextInstance:see,idlePriority:JS.unstable_IdlePriority,insertBefore:bL,insertInContainerBefore:JZ,isPrimaryRenderer:VZ,noTimeout:HZ,now:JS.unstable_now,prepareForCommit:DZ,preparePortalMount:IZ,prepareUpdate:RZ,removeChild:QZ,removeChildFromContainer:ZZ,resetAfterCommit:MZ,resetTextContent:LZ,run:JS.unstable_runWithPriority,scheduleTimeout:zZ,shouldDeprioritizeSubtree:BZ,shouldSetTextContent:GZ,supportsMutation:qZ,unhideInstance:aee,unhideTextInstance:iee,warnsIfNotActing:KZ},Symbol.toStringTag,{value:"Module"}));var dee=Object.defineProperty,fee=Object.defineProperties,hee=Object.getOwnPropertyDescriptors,bP=Object.getOwnPropertySymbols,gee=Object.prototype.hasOwnProperty,mee=Object.prototype.propertyIsEnumerable,SP=(e,t,r)=>t in e?dee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,kP=(e,t)=>{for(var r in t||(t={}))gee.call(t,r)&&SP(e,r,t[r]);if(bP)for(var r of bP(t))mee.call(t,r)&&SP(e,r,t[r]);return e},pee=(e,t)=>fee(e,hee(t)),CP,TP;typeof window<"u"&&((CP=window.document)!=null&&CP.createElement||((TP=window.navigator)==null?void 0:TP.product)==="ReactNative")?S.useLayoutEffect:S.useEffect;function SL(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=SL(n,t,r);if(s)return s;n=n.sibling}}function kL(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const EP=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=EP;return}return EP.apply(this,arguments)};const t4=kL(S.createContext(null));class CL extends S.Component{render(){return S.createElement(t4.Provider,{value:this._reactInternals},this.props.children)}}function xee(){const e=S.useContext(t4);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=S.useId();return S.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=SL(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function yee(){const e=xee(),[t]=S.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==t4&&!t.has(s)&&t.set(s,S.useContext(kL(s)))}r=r.return}return t}function TL(){const e=yee();return S.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>S.createElement(t,null,S.createElement(r.Provider,pee(kP({},n),{value:e.get(r)}))),t=>S.createElement(CL,kP({},t))),[e])}function vee(e){const t=Fs.useRef({});return Fs.useLayoutEffect(()=>{t.current=e}),Fs.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const wee=e=>{const t=Fs.useRef(null),r=Fs.useRef(null),n=Fs.useRef(null),s=vee(e),a=TL(),i=o=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(o):c.current=o)};return Fs.useLayoutEffect(()=>(r.current=new zy.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=Qg.createContainer(r.current,vL.LegacyRoot,!1,null),Qg.updateContainer(Fs.createElement(a,{},e.children),n.current),()=>{zy.isBrowser&&(i(null),Qg.updateContainer(null,n.current,null),r.current.destroy())}),[]),Fs.useLayoutEffect(()=>{i(r.current),Bb(r.current,e,s),Qg.updateContainer(Fs.createElement(a,{},e.children),n.current,null)}),Fs.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Zh="Layer",_ee="FastLayer",sc="Group",bee="Label",$a="Rect",pf="Circle",See="Ellipse",kee="Wedge",ai="Line",Cee="Sprite",EL="Image",zc="Text",Tee="TextPath",Eee="Star",Nee="Ring",Aee="Arc",jee="Tag",Pee="Path",Fee="RegularPolygon",FT="Arrow",Oee="Shape",NL="Transformer",Dee="18.2.13",Qg=wZ(uee);Qg.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Fs.version,rendererPackageName:"react-konva"});const e0=Fs.forwardRef((e,t)=>Fs.createElement(CL,{},Fs.createElement(wee,{...e,forwardedRef:t}))),Iee=kZ,Ree=Object.freeze(Object.defineProperty({__proto__:null,Arc:Aee,Arrow:FT,Circle:pf,Ellipse:See,FastLayer:_ee,Group:sc,Image:EL,KonvaRenderer:Qg,Label:bee,Layer:Zh,Line:ai,Path:Pee,Rect:$a,RegularPolygon:Fee,Ring:Nee,Shape:Oee,Sprite:Cee,Stage:e0,Star:Eee,Tag:jee,Text:zc,TextPath:Tee,Transformer:NL,Wedge:kee,useContextBridge:TL,useStrictMode:Iee,version:Dee},Symbol.toStringTag,{value:"Module"})),jt=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return l.jsx(at.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},Mee=({children:e,className:t=""})=>l.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),Lee=({children:e,className:t=""})=>l.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),Bee=({children:e,className:t=""})=>l.jsx("div",{className:`py-4 ${t}`,children:e}),$ee=({children:e,className:t=""})=>l.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});jt.Header=Mee;jt.Title=Lee;jt.Body=Bee;jt.Footer=$ee;const oa=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...c})=>{const u=f=>{i&&f.target===f.currentTarget&&t()};Fs.useEffect(()=>{const f=x=>{x.key==="Escape"&&t()},g=window;g.__modalOpenCount||(g.__modalOpenCount=0);let p;return e&&(document.addEventListener("keydown",f),p=document.body.style.overflow,g.__modalOpenCount===0&&(document.body.style.overflow="hidden"),g.__modalOpenCount+=1),()=>{document.removeEventListener("keydown",f),g.__modalOpenCount&&g.__modalOpenCount>0&&(g.__modalOpenCount-=1),g.__modalOpenCount===0&&(p!==void 0?document.body.style.overflow=p||"":document.body.style.overflow="")}},[e,t]);const d={small:"max-w-md",medium:"max-w-lg",large:"max-w-4xl"};return e?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...c,children:l.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-8
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
        `,onClick:f=>f.stopPropagation(),children:[(r||a)&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&l.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&l.jsx("button",{onClick:t,className:"text-red-500 hover:text-red-700 hover:bg-red-50 transition-all duration-200 rounded-full p-2 text-2xl font-bold leading-none","aria-label":"Close modal",children:""})]}),l.jsx("div",{className:"space-y-6",children:n})]})}):null},Uee=e=>{const[t,r]=S.useState({width:800,height:600}),n=S.useRef(null),s=S.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let c=a,u=c/o;u>i&&(u=i,c=u*o),r({width:c,height:u})}},[e]);return S.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},zee=e=>{const[t,r]=S.useState({width:800,height:600}),[n,s]=S.useState({}),a=S.useCallback(()=>{if(e.current){const o=e.current.getBoundingClientRect();r({width:o.width,height:Math.max(400,o.height)})}},[e]),i=S.useCallback(o=>o<480?{stageHeight:300,blockMinSize:50,fontSize:12,padding:10,touchTargetSize:44,arrowThickness:4}:o<768?{stageHeight:400,blockMinSize:60,fontSize:14,padding:15,touchTargetSize:44,arrowThickness:4}:o<1024?{stageHeight:500,blockMinSize:70,fontSize:16,padding:20,touchTargetSize:40,arrowThickness:3}:{stageHeight:600,blockMinSize:80,fontSize:18,padding:25,touchTargetSize:32,arrowThickness:2},[]);return S.useEffect(()=>{const o=i(t.width);s(o)},[t.width,i]),S.useEffect(()=>{a();const o=()=>{a()};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[a]),{containerSize:t,responsiveSettings:n,updateSize:a}},NP={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,c=(t.width-i)/2,u=(t.height-o)/2;return{x:c,y:u,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},Wee=e=>{const t=S.useCallback((n,s)=>NP.convertToOriginal(n,s,e),[e]),r=S.useCallback((n,s)=>NP.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},Hx={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},$g={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,c=i.y+i.height/2,u=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-c,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>$g.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},QS={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},Hee=async e=>{const t=[];if(e.size>512e3){const n=(e.size/1024).toFixed(1);t.push(`Image is too large (${n}KB). Maximum allowed size is 500KB. Please compress or resize your image.`)}return new Promise(n=>{const s=new Image;s.onload=()=>{(s.width>4e3||s.height>4e3)&&t.push(`Image is too large (${s.width}x${s.height} pixels). Maximum allowed dimensions are 4000x4000 pixels. Please resize your image.`),n({valid:t.length===0,errors:t,dimensions:{width:s.width,height:s.height}})},s.onerror=()=>{t.push("Invalid image file"),n({valid:!1,errors:t})},s.src=URL.createObjectURL(e)})},Gee=(e,t=500)=>new Promise(r=>{const n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.onload=()=>{let{width:i,height:o}=a;const c=2e3;if(i>c||o>c){const f=Math.min(c/i,c/o);i*=f,o*=f}n.width=i,n.height=o,s.drawImage(a,0,0,i,o);let u=.8;const d=()=>{n.toBlob(f=>{f.size<=t*1024||u<=.1?r(f):(u-=.1,d())},"image/jpeg",u)};d()},a.onerror=()=>{r(e)},a.src=URL.createObjectURL(e)}),Vee=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=s=>t(s.target.result),n.onerror=s=>r(s),n.readAsDataURL(e)}),Kee=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return{blockMinSize:e?60:40,arrowThickness:e?4:2,touchTargetSize:e?44:32,doubleTapDelay:e?300:200,isMobile:e}},qee={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null,showImageSizeModal:!1,imageSizeError:null}},Yee=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"SHOW_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!0,imageSizeError:t.payload}};case"HIDE_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!1,imageSizeError:null}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},Xee=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,c]=S.useReducer(Yee,qee),{showNotification:u}=ka(),{makeAuthenticatedRequest:d}=Jo(),{user:f}=cs(),g=S.useRef(null),p=S.useRef(null),x=S.useRef(null),v=S.useRef({}),w=S.useRef({}),{canvasSize:C,stageRef:k}=Uee(g),{containerSize:_,responsiveSettings:N}=zee(g),[E,P]=S.useState(null);S.useEffect(()=>{if(!o.canvas.image||!g.current)return;const W=g.current?.clientWidth||800,R=g.current?.clientHeight||600,z=W/o.canvas.image.width,K=R/o.canvas.image.height,J=Math.min(z,K,1),se=o.canvas.image.width*J,X=o.canvas.image.height*J,ie=(W-se)/2,le=(R-X)/2;P({x:ie,y:le,width:se,height:X,scaleX:J,scaleY:J,scale:J,image:o.canvas.image})},[o.canvas.image,g.current?.clientWidth,g.current?.clientHeight]);const{convertToOriginal:F}=Wee(E);S.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:C})},[C]),S.useEffect(()=>{E&&c({type:"SET_IMAGE_INFO",payload:E})},[E]),S.useEffect(()=>{const W=x.current;if(!W)return;const R=o.ui.selectedBlock?.id?v.current[o.ui.selectedBlock.id]:null;R?(W.nodes([R]),W.getLayer()?.batchDraw()):(W.nodes([]),W.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const A=S.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),j=S.useCallback(async W=>{const R=W.target.files[0];if(!R){u("Please select a file","error");return}try{c({type:"SET_LOADING",payload:!0});const z=await Hee(R);if(!z.valid){c({type:"SHOW_IMAGE_SIZE_MODAL",payload:{errors:z.errors,fileSize:(R.size/1024).toFixed(1),dimensions:z.dimensions}});return}let K=R;if(R.size>500*1024){u("Image is large, compressing to meet size requirements...","info");try{K=await Gee(R,500);const X=(R.size/1024).toFixed(1),ie=(K.size/1024).toFixed(1);u(`Image compressed from ${X}KB to ${ie}KB`,"success")}catch{u("Failed to compress image. Please try a smaller image.","error");return}}const J=await Vee(K),se=new Image;se.crossOrigin="anonymous",se.onload=()=>{c({type:"SET_IMAGE",payload:se}),c({type:"SET_UI_STATE",payload:{imageUrl:J}}),u("Image uploaded successfully!","success")},se.onerror=()=>{u("Failed to load image","error")},se.src=J}catch(z){console.error("Image upload error:",z),u("Error processing image","error")}finally{c({type:"SET_LOADING",payload:!1})}},[u]),I=S.useCallback(W=>{const R=k.current;if(!R)return;const z=R.getPointerPosition();if(z){if(o.canvas.selectedTool==="create"){const K=Hx.findAtPosition(o.testData.blocks,z.x,z.y);if(K){c({type:"SET_UI_STATE",payload:{selectedBlock:K}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:z.x,y:z.y}}})}else if(o.canvas.selectedTool==="edit"){const K=Hx.findAtPosition(o.testData.blocks,z.x,z.y);c(K?{type:"SET_UI_STATE",payload:{selectedBlock:K}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const K=W.target===R,J=Hx.findAtPosition(o.testData.blocks,z.x,z.y);(K||!J)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:z.x,y:z.y}}})}}},[o.canvas.selectedTool,E,o.testData.blocks]),L=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;const K=Math.abs(z.x-o.creation.blockCreationStart.x),J=Math.abs(z.y-o.creation.blockCreationStart.y),se=10,X=Math.max(K,se),ie=Math.max(J,se);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(z.x,o.creation.blockCreationStart.x),y:Math.min(z.y,o.creation.blockCreationStart.y),width:X,height:ie,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:z.x,endY:z.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),Y=S.useCallback(W=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;const K=Math.abs(z.x-o.creation.blockCreationStart.x),J=Math.abs(z.y-o.creation.blockCreationStart.y),se=10,X=Math.max(K,se),ie=Math.max(J,se),le=Math.min(z.x,o.creation.blockCreationStart.x)+X/2,ce=Math.min(z.y,o.creation.blockCreationStart.y)+ie/2,be=Hx.generateId(),re=Hx.create(le,ce,X,ie,be),pe=QS.create(be,`Word ${o.testData.blocks.length+1}`,QS.generateId(be));c({type:"ADD_BLOCK",payload:re}),c({type:"ADD_WORD",payload:pe}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const R=k.current;if(!R)return;const z=R.getPointerPosition();if(!z)return;if($g.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,z.x,z.y,o.testData.blocks)){const K=$g.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),J=$g.snapToNearestBlock(z.x,z.y,o.testData.blocks),se=K?K.x:o.creation.arrowStart.x,X=K?K.y:o.creation.arrowStart.y,ie=J?J.x:z.x,le=J?J.y:z.y,ce=$g.generateId(),be=Kee(),re=$g.create(se,X,ie,le,K?K.blockId:null,J?J.blockId:null,ce,{strokeWidth:be.arrowThickness,isMobile:be.isMobile});c({type:"ADD_ARROW",payload:re}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),Z=S.useCallback(W=>{W.evt.preventDefault(),I(W)},[I]),ae=S.useCallback(W=>{W.evt.preventDefault(),L(W)},[L]),ee=S.useCallback(W=>{W.evt.preventDefault(),Y(W)},[Y]),ne=S.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const W=B();if(Object.keys(W).length>0){console.warn(" [MatchingTestCreator] Validation errors:",W),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let R=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const K=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),J=await K.json();if(K.ok&&J.success&&J.url)R=J.url;else throw new Error(J.message||"Upload failed")}const z=o.testData.blocks.map((K,J)=>{let se;if(E){const le=F(K.x,K.y),ce=F(K.x+K.width,K.y+K.height);se={x:le.x,y:le.y,width:Number((ce.x-le.x).toFixed(4)),height:Number((ce.y-le.y).toFixed(4))}}else se={x:Number(K.x.toFixed(4)),y:Number(K.y.toFixed(4)),width:Number(K.width.toFixed(4)),height:Number(K.height.toFixed(4))};const X=o.testData.words.find(le=>le.blockId===K.id),ie=o.testData.arrows.find(le=>le.startBlock===K.id);return{question_id:J+1,word:X?.word||`Word ${J+1}`,block_coordinates:se,has_arrow:!!ie,arrow:ie&&E?(()=>{const le=F(ie.startX,ie.startY),ce=F(ie.endX,ie.endY),be=le.x/E.originalWidth*100,re=le.y/E.originalHeight*100,pe=ce.x/E.originalWidth*100,Ce=ce.y/E.originalHeight*100;return{start_x:Number(le.x.toFixed(4)),start_y:Number(le.y.toFixed(4)),end_x:Number(ce.x.toFixed(4)),end_y:Number(ce.y.toFixed(4)),rel_start_x:Number(be.toFixed(4)),rel_start_y:Number(re.toFixed(4)),rel_end_x:Number(pe.toFixed(4)),rel_end_y:Number(Ce.toFixed(4)),image_width:E.originalWidth,image_height:E.originalHeight,style:ie.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:R,processedQuestions:z}))}catch(R){console.error("Save error:",R),u(`Error saving test: ${R.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,E,F,d,r,u,e,f]),B=S.useCallback(()=>{const W={};return e.trim()||(W.testName="Test name is required"),o.testData.blocks.length===0&&(W.blocks="At least one block is required"),W},[e,o.testData.blocks.length]),V=()=>l.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[l.jsx(et,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),l.jsx(et,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),l.jsx(et,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),l.jsx(et,{onClick:A,variant:"secondary",size:"sm",children:" Reset"}),l.jsx(et,{onClick:()=>p.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"}),l.jsx("div",{className:"text-xs text-gray-500 text-center col-span-full",children:"Max size: 500KB  Max dimensions: 4000x4000px"})]}),M=()=>l.jsx(e0,{width:_.width,height:N.stageHeight,ref:k,onMouseDown:I,onMouseMove:L,onMouseUp:Y,onTouchStart:Z,onTouchMove:ae,onTouchEnd:ee,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:l.jsxs(Zh,{children:[o.canvas.image&&E&&l.jsx(EL,{image:o.canvas.image,x:E.x,y:E.y,width:E.width,height:E.height}),o.testData.blocks.map(W=>l.jsxs(sc,{ref:R=>{R&&(w.current[W.id]=R)},draggable:o.canvas.selectedTool==="edit",x:W.x,y:W.y,onMouseEnter:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onDragEnd:R=>{const{x:z,y:K}=R.target.position();c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:z,y:K}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:W}})},children:[l.jsx($a,{ref:R=>{R&&(v.current[W.id]=R)},width:W.width,height:W.height,fill:W.fill,stroke:W.stroke,strokeWidth:W.strokeWidth,cornerRadius:W.cornerRadius,shadowColor:W.shadowColor,shadowBlur:W.shadowBlur,shadowOffset:W.shadowOffset,shadowOpacity:W.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:R=>{const{x:z,y:K}=R.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{x:z,y:K}}})},onMouseEnter:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.ui.selectedBlock?.id===W.id?"nwse-resize":"move")},onMouseLeave:R=>{const z=R.target.getStage()?.container();z&&(z.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:R=>{const z=v.current[W.id];if(!z)return;const K=Math.max(10,z.width()*z.scaleX()),J=Math.max(10,z.height()*z.scaleY());z.scaleX(1),z.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:W.id,updates:{width:K,height:J}}})}}),l.jsx(zc,{x:2,y:2,text:`${o.testData.blocks.indexOf(W)+1}`,fontSize:Math.min(N.fontSize,Math.max(8,W.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},W.id)),l.jsx(NL,{ref:x,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(W,R)=>({...R,width:Math.max(R.width,10),height:Math.max(R.height,10)})}),o.testData.arrows.map(W=>l.jsx(FT,{points:[W.startX,W.startY,W.endX,W.endY],stroke:W.stroke,fill:W.fill,strokeWidth:W.strokeWidth||N.arrowThickness,pointerLength:W.pointerLength,pointerWidth:W.pointerWidth},W.id)),o.creation.previewBlock&&l.jsx($a,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&l.jsx(FT,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),H=S.useMemo(()=>o.testData.blocks.length===0?null:l.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),l.jsx("div",{className:"space-y-2",children:o.testData.words.map(W=>{const R=o.testData.blocks.find(z=>z.id===W.blockId);return l.jsxs("div",{className:"p-2 bg-white rounded border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(R)+1]}),l.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:R.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),l.jsx("input",{type:"text",value:W.word,onChange:z=>{const K=QS.update(o.testData.words,W.blockId,z.target.value);c({type:"UPDATE_WORDS",payload:K})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},W.blockId)})})]}),[o.testData.words,o.testData.blocks]);return l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[l.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{children:l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})})})}),V(),l.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[l.jsx("div",{ref:g,className:"bg-white border overflow-auto",style:{minHeight:`${N.stageHeight}px`,maxHeight:"calc(100vh - 200px)",height:"auto",padding:`${N.padding}px`},children:M()}),H]}),l.jsx("div",{className:"bg-white border-t p-4",children:l.jsx("div",{className:"flex justify-center",children:l.jsx(et,{onClick:ne,disabled:a||o.ui.isLoading,variant:"primary",size:"lg",children:a||o.ui.isLoading?l.jsx(Hr,{size:"sm"}):"Save Test"})})}),l.jsx("input",{ref:p,type:"file",accept:"image/*,application/pdf",onChange:j,className:"hidden"}),l.jsx(oa,{isOpen:o.ui.showImageSizeModal,onClose:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),title:" Image Too Large",size:"medium",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("span",{className:"text-red-600 text-2xl mr-2",children:""}),l.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Image Size Issues"})]}),l.jsx("div",{className:"text-red-700",children:o.ui.imageSizeError?.errors.map((W,R)=>l.jsxs("div",{className:"mb-2",children:[" ",W]},R))})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Current Image Details:"}),l.jsxs("div",{className:"text-blue-700 space-y-1",children:[l.jsxs("div",{children:[" File size: ",o.ui.imageSizeError?.fileSize,"KB"]}),o.ui.imageSizeError?.dimensions&&l.jsxs("div",{children:[" Dimensions: ",o.ui.imageSizeError.dimensions.width,"  ",o.ui.imageSizeError.dimensions.height," pixels"]})]})]}),l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:" Requirements:"}),l.jsxs("div",{className:"text-green-700 space-y-1",children:[l.jsx("div",{children:" Maximum file size: 500KB"}),l.jsx("div",{children:" Maximum dimensions: 4000  4000 pixels"}),l.jsx("div",{children:" Supported formats: All image formats (JPEG, PNG, WebP, etc.)"})]})]}),l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:" How to Fix:"}),l.jsxs("div",{className:"text-yellow-700 space-y-1",children:[l.jsx("div",{children:" Use an image editor to resize your image"}),l.jsx("div",{children:" Compress the image using online tools"}),l.jsx("div",{children:" Try a different image with smaller dimensions"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(et,{onClick:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),variant:"secondary",children:"Close"}),l.jsx(et,{onClick:()=>{c({type:"HIDE_IMAGE_SIZE_MODAL"}),p.current?.click()},variant:"primary",children:"Try Another Image"})]})]})})]})},$m=S.createContext(null);function Jee(e,t){return{getTheme:function(){return t??null}}}function tu(){const e=S.useContext($m);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function Wt(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const hc=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Qee=hc&&"documentMode"in document?document.documentMode:null,Uc=hc&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),t0=hc&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),m_=!(!hc||!("InputEvent"in window)||Qee)&&"getTargetRanges"in new window.InputEvent("input"),Wy=hc&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),vm=hc&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,Zee=hc&&/Android/.test(navigator.userAgent),AL=hc&&/^(?=.*Chrome).*/i.test(navigator.userAgent),AP=hc&&Zee&&AL,p_=hc&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!AL;function jL(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const ete=1,tte=3,rte=9,nte=11,r0=0,PL=1,wm=2,ste=0,ate=1,ite=2,x_=4,y_=8,r4=128,ote=1792|(112|(3|x_|y_)|r4),n4=1,s4=2,a4=3,i4=4,o4=5,l4=6,$b=Wy||vm||p_?"":"",ed=`

`,lte=t0?"":$b,n0={bold:1,capitalize:1024,code:16,highlight:r4,italic:2,lowercase:256,strikethrough:x_,subscript:32,superscript:64,underline:y_,uppercase:512},cte={directionless:1,unmergeable:2},jP={center:s4,end:l4,justify:i4,left:n4,right:a4,start:o4},ute={[s4]:"center",[l4]:"end",[i4]:"justify",[n4]:"left",[a4]:"right",[o4]:"start"},dte={normal:0,segmented:2,token:1},fte={[ste]:"normal",[ite]:"segmented",[ate]:"token"},PP="$config";function FL(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(wt(i)&&FL(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const hte=100;let OT=!1,c4=0;function gte(e){c4=e.timeStamp}function ZS(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&Xb(e,r)!==void 0}function mte(e,t,r){const n=dc(El(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&A4(t,i,s,a,!1)}function pte(e,t,r){if(Mt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return ld(t)&&r.isAttached()}function xte(e,t,r,n){for(let s=e;s&&!xre(s);s=Iv(s)){const a=Xb(s,t);if(a!==void 0){const i=la(a,r);if(i)return vn(i)||!as(s)?void 0:[s,i]}else if(s===n)return[n,N9(r)]}}function OL(e,t,r){OT=!0;const n=performance.now()-c4>hte;try{$o(e,(()=>{const s=tr()||(function(g){return g.getEditorState().read((()=>{const p=tr();return p!==null?p.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,c=e._blockCursorElement;let u=!1,d="";for(let g=0;g<t.length;g++){const p=t[g],x=p.type,v=p.target,w=xte(v,e,o,i);if(!w)continue;const[C,k]=w;if(x==="characterData")n&&rr(k)&&ld(v)&&pte(s,v,k)&&mte(v,k,e);else if(x==="childList"){u=!0;const _=p.addedNodes;for(let P=0;P<_.length;P++){const F=_[P],A=T9(F),j=F.parentNode;if(j!=null&&F!==c&&A===null&&!ZS(F,j,e)){if(t0){const I=(as(F)?F.innerText:null)||F.nodeValue;I&&(d+=I)}j.removeChild(F)}}const N=p.removedNodes,E=N.length;if(E>0){let P=0;for(let F=0;F<E;F++){const A=N[F];(ZS(A,v,e)||c===A)&&(v.appendChild(A),P++)}E!==P&&a.set(C,k)}}}if(a.size>0)for(const[g,p]of a)p.reconcileObservedMutation(g,e);const f=r.takeRecords();if(f.length>0){for(let g=0;g<f.length;g++){const p=f[g],x=p.addedNodes,v=p.target;for(let w=0;w<x.length;w++){const C=x[w],k=C.parentNode;k==null||C.nodeName!=="BR"||ZS(C,v,e)||k.removeChild(C)}}r.takeRecords()}s!==null&&(u&&hi(s),t0&&F9(e)&&s.insertRawText(d))}))}finally{OT=!1}}function DL(e){const t=e._observer;t!==null&&OL(e,t.takeRecords(),t)}function IL(e){(function(t){c4===0&&El(t).addEventListener("textInput",gte,!0)})(e),e._observer=new MutationObserver(((t,r)=>{OL(e,t,r)}))}function yte(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=D4(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let vte=class RL{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(c,u,d){let f=d.size;if(u)for(const g in u){const p=c.get(g);p&&d.has(p)||f++}return f})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return FP(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new RL(t,r,(function(a,i,o){let c;if(o)for(const[u,d]of Object.entries(o)){const f=a.get(u);f?i.has(f)||i.set(f,f.parse(d)):(c=c||{},c[u]=d)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=FP(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function wte(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new vte(t,ML(t));return t.__state=r,r}function ML(e){return e.__state?e.__state.sharedNodeState:S9(Rv(),e.getType()).sharedNodeState}function FP(e){if(e)for(const t in e)return e}function OP(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function DP(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function IP(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function RP(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,c=e.__state,u=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||c===u||(function(d,f){if(d===f)return!0;if(d&&f&&d.size!==f.size)return!1;const g=new Set;return!(d&&OP(g,d,f)||f&&OP(g,f,d)||d&&DP(g,d,f)||f&&DP(g,f,d))})(c,u))}function MP(e,t){const r=e.mergeWithSibling(t),n=Ss()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function LP(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&rr(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(RP(t,n)){n=MP(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&rr(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(RP(n,r)){n=MP(n,r);break}break}r.remove()}}else n.remove()}function v_(e){return BP(e.anchor),BP(e.focus),e}function BP(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),rr(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!wt(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let s0,Fi,Hy,Ub,DT,IT,a0,oc,RT,Gy,va="",Bc=null,$c="",Mu="",Ug=!1,w_=!1;function __(e,t){const r=a0.get(e);if(t!==null){const n=$T(e);n.parentNode===t&&t.removeChild(n)}if(oc.has(e)||Fi._keyToDOMMap.delete(e),wt(r)){const n=S_(r,a0);MT(n,0,n.length-1,null)}r!==void 0&&j4(Gy,Hy,Ub,r,"destroyed")}function MT(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&__(a,n)}}function bh(e,t){e.setProperty("text-align",t)}const _te="40px";function LL(e,t){const r=s0.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||_te;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function BL(e,t){const r=e.style;t===0?bh(r,""):t===n4?bh(r,"left"):t===s4?bh(r,"center"):t===a4?bh(r,"right"):t===i4?bh(r,"justify"):t===o4?bh(r,"start"):t===l4&&bh(r,"end")}function LT(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(ba(n))return null;const a=n.getParentOrThrow();return ba(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function b_(e,t){const r=oc.get(e);r===void 0&&Wt(60);const n=r.createDOM(s0,Fi);if((function(s,a,i){const o=i._keyToDOMMap;(function(c,u,d){const f=`__lexicalKey_${u._key}`;c[f]=d})(a,i,s),o.set(s,a)})(e,n,Fi),rr(r)?n.setAttribute("data-lexical-text","true"):vn(r)&&n.setAttribute("data-lexical-decorator","true"),wt(r)){const s=r.__indent,a=r.__size;if(LT(n,r),s!==0&&LL(n,s),a!==0){const o=a-1;BT(S_(r,oc),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&BL(n,i),r.isInline()||$L(null,r,n),Jb(r)&&(va+=ed,Mu+=ed)}else{const s=r.getTextContent();if(vn(r)){const a=r.decorate(Fi,s0);a!==null&&UL(e,a),n.contentEditable="false"}va+=s,Mu+=s}return t!==null&&t.insertChild(n),j4(Gy,Hy,Ub,r,"created"),n}function BT(e,t,r,n,s){const a=va;va="";let i=r;for(;i<=n;++i){b_(e[i],s);const o=oc.get(e[i]);o!==null&&rr(o)&&(Bc===null&&(Bc=o.getFormat()),$c===""&&($c=o.getStyle()))}Jb(t)&&(va+=ed),s.element.__lexicalTextContent=va,va=a+va}function $P(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return Vu(n)?"line-break":vn(n)&&n.isInline()?"decorator":null}return"empty"}return null}function $L(e,t,r){const n=$P(e,a0),s=$P(t,oc);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function bte(e,t,r){var n;Bc=null,$c="",(function(s,a,i){const o=va,c=s.__size,u=a.__size;va="";const d=i.element;if(c===1&&u===1){const f=s.__first,g=a.__first;if(f===g)iy(f,d);else{const x=$T(f),v=b_(g,null);try{d.replaceChild(v,x)}catch(w){if(typeof w=="object"&&w!=null){const C=`${w.toString()} Parent: ${d.tagName}, new child: {tag: ${v.tagName} key: ${g}}, old child: {tag: ${x.tagName}, key: ${f}}.`;throw new Error(C)}throw w}__(f,null)}const p=oc.get(g);rr(p)&&(Bc===null&&(Bc=p.getFormat()),$c===""&&($c=p.getStyle()))}else{const f=S_(s,a0),g=S_(a,oc);if(f.length!==c&&Wt(227),g.length!==u&&Wt(228),c===0)u!==0&&BT(g,a,0,u-1,i);else if(u===0){if(c!==0){const p=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;MT(f,0,c-1,p?null:d),p&&(d.textContent="")}}else(function(p,x,v,w,C,k){const _=w-1,N=C-1;let E,P,F=k.getFirstChild(),A=0,j=0;for(;A<=_&&j<=N;){const Y=x[A],Z=v[j];if(Y===Z)F=ek(iy(Z,k.element)),A++,j++;else{E===void 0&&(E=new Set(x)),P===void 0&&(P=new Set(v));const ee=P.has(Y),ne=E.has(Z);if(ee)if(ne){const B=i0(Fi,Z);B===F?F=ek(iy(Z,k.element)):(k.withBefore(F).insertChild(B),iy(Z,k.element)),A++,j++}else b_(Z,k.withBefore(F)),j++;else F=ek($T(Y)),__(Y,k.element),A++}const ae=oc.get(Z);ae!==null&&rr(ae)&&(Bc===null&&(Bc=ae.getFormat()),$c===""&&($c=ae.getStyle()))}const I=A>_,L=j>N;if(I&&!L){const Y=v[N+1],Z=Y===void 0?null:Fi.getElementByKey(Y);BT(v,p,j,N,k.withBefore(Z))}else L&&!I&&MT(x,A,_,k.element)})(a,f,g,c,u,i)}Jb(a)&&(va+=ed),d.__lexicalTextContent=va,va=o+va})(e,t,t.getDOMSlot(r)),n=t,Bc==null||Bc===n.__textFormat||w_||n.setTextFormat(Bc),(function(s){$c===""||$c===s.__textStyle||w_||s.setTextStyle($c)})(t)}function S_(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&Wt(101),r.push(n),n=s.__next}return r}function iy(e,t){const r=a0.get(e);let n=oc.get(e);r!==void 0&&n!==void 0||Wt(61);const s=Ug||IT.has(e)||DT.has(e),a=i0(Fi,e);if(r===n&&!s){if(wt(r)){const i=a.__lexicalTextContent;i!==void 0&&(va+=i,Mu+=i)}else{const i=r.getTextContent();Mu+=i,va+=i}return a}if(r!==n&&s&&j4(Gy,Hy,Ub,n,"updated"),n.updateDOM(r,a,s0)){const i=b_(e,null);return t===null&&Wt(62),t.replaceChild(i,a),__(e,null),i}if(wt(r)&&wt(n)){const i=n.__indent;(Ug||i!==r.__indent)&&LL(a,i);const o=n.__format;if((Ug||o!==r.__format)&&BL(a,o),s&&(bte(r,n,a),ba(n)||n.isInline()||$L(r,n,a)),Jb(n)&&(va+=ed,Mu+=ed),(Ug||n.__dir!==r.__dir)&&(LT(a,n),ba(n)&&!Ug))for(const c of n.getChildren())wt(c)&&LT(i0(Fi,c.getKey()),c)}else{const i=n.getTextContent();if(vn(n)){const o=n.decorate(Fi,s0);o!==null&&UL(e,o)}va+=i,Mu+=i}if(!w_&&ba(n)&&n.__cachedText!==Mu){const i=n.getWritable();i.__cachedText=Mu,n=i}return a}function UL(e,t){let r=Fi._pendingDecorators;const n=Fi._decorators;if(r===null){if(n[e]===t)return;r=E9(Fi)}r[e]=t}function ek(e){let t=e.nextSibling;return t!==null&&t===Fi._blockCursorElement&&(t=t.nextSibling),t}function Ste(e,t,r,n,s,a){va="",Mu="",Ug=n===wm,Fi=r,s0=r._config,Hy=r._nodes,Ub=Fi._listeners.mutation,DT=s,IT=a,a0=e._nodeMap,oc=t._nodeMap,w_=t._readOnly,RT=new Map(r._keyToDOMMap);const i=new Map;return Gy=i,iy("root",null),Fi=void 0,Hy=void 0,DT=void 0,IT=void 0,a0=void 0,oc=void 0,s0=void 0,RT=void 0,Gy=void 0,i}function $T(e){const t=RT.get(e);return t===void 0&&Wt(75,e),t}function Or(e){return{type:e}}const zL=Or("SELECTION_CHANGE_COMMAND"),kte=Or("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),u4=Or("CLICK_COMMAND"),zh=Or("DELETE_CHARACTER_COMMAND"),sm=Or("INSERT_LINE_BREAK_COMMAND"),Vy=Or("INSERT_PARAGRAPH_COMMAND"),am=Or("CONTROLLED_TEXT_INSERTION_COMMAND"),d4=Or("PASTE_COMMAND"),UT=Or("REMOVE_TEXT_COMMAND"),Ky=Or("DELETE_WORD_COMMAND"),qy=Or("DELETE_LINE_COMMAND"),Pi=Or("FORMAT_TEXT_COMMAND"),f4=Or("UNDO_COMMAND"),h4=Or("REDO_COMMAND"),Cte=Or("KEYDOWN_COMMAND"),WL=Or("KEY_ARROW_RIGHT_COMMAND"),Tte=Or("MOVE_TO_END"),HL=Or("KEY_ARROW_LEFT_COMMAND"),Ete=Or("MOVE_TO_START"),GL=Or("KEY_ARROW_UP_COMMAND"),VL=Or("KEY_ARROW_DOWN_COMMAND"),k_=Or("KEY_ENTER_COMMAND"),KL=Or("KEY_SPACE_COMMAND"),qL=Or("KEY_BACKSPACE_COMMAND"),YL=Or("KEY_ESCAPE_COMMAND"),XL=Or("KEY_DELETE_COMMAND"),JL=Or("KEY_TAB_COMMAND"),Nte=Or("INSERT_TAB_COMMAND"),Ate=Or("INDENT_CONTENT_COMMAND"),UP=Or("OUTDENT_CONTENT_COMMAND"),QL=Or("DROP_COMMAND"),ZL=Or("FORMAT_ELEMENT_COMMAND"),e9=Or("DRAGSTART_COMMAND"),t9=Or("DRAGOVER_COMMAND"),jte=Or("DRAGEND_COMMAND"),zb=Or("COPY_COMMAND"),g4=Or("CUT_COMMAND"),zT=Or("SELECT_ALL_COMMAND"),Pte=Or("CLEAR_EDITOR_COMMAND"),Fte=Or("CLEAR_HISTORY_COMMAND"),hw=Or("CAN_REDO_COMMAND"),gw=Or("CAN_UNDO_COMMAND"),Ote=Or("FOCUS_COMMAND"),Dte=Or("BLUR_COMMAND"),Ite=Or("KEY_MODIFIER_COMMAND"),Ou=Object.freeze({}),WT=30,HT=[["keydown",function(e,t){if(vy=e.timeStamp,r9=e.key,!t.isComposing()&&!ur(t,Cte,e)&&e.key!=null){if(tk&&m8(e))return $o(t,(()=>{mw(t,rk)})),tk=!1,void(rk="");if((function(r){return Pn(r,"ArrowRight",{shiftKey:"any"})})(e))ur(t,WL,e);else if((function(r){return Pn(r,"ArrowRight",Iu)})(e))ur(t,Tte,e);else if((function(r){return Pn(r,"ArrowLeft",{shiftKey:"any"})})(e))ur(t,HL,e);else if((function(r){return Pn(r,"ArrowLeft",Iu)})(e))ur(t,Ete,e);else if((function(r){return Pn(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))ur(t,GL,e);else if((function(r){return Pn(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))ur(t,VL,e);else if((function(r){return Pn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))wy=!0,ur(t,k_,e);else if((function(r){return r.key===" "})(e))ur(t,KL,e);else if((function(r){return Uc&&Pn(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),wy=!0,ur(t,sm,!0);else if((function(r){return Pn(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))wy=!1,ur(t,k_,e);else if((function(r){return Pn(r,"Backspace",{shiftKey:"any"})||Uc&&Pn(r,"h",{ctrlKey:!0})})(e))m8(e)?ur(t,qL,e):(e.preventDefault(),ur(t,zh,!0));else if((function(r){return r.key==="Escape"})(e))ur(t,YL,e);else if((function(r){return Pn(r,"Delete",{})||Uc&&Pn(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?ur(t,XL,e):(e.preventDefault(),ur(t,zh,!1));else if((function(r){return Pn(r,"Backspace",g8)})(e))e.preventDefault(),ur(t,Ky,!0);else if((function(r){return Pn(r,"Delete",g8)})(e))e.preventDefault(),ur(t,Ky,!1);else if((function(r){return Uc&&Pn(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),ur(t,qy,!0);else if((function(r){return Uc&&(Pn(r,"Delete",{metaKey:!0})||Pn(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),ur(t,qy,!1);else if((function(r){return Pn(r,"b",Iu)})(e))e.preventDefault(),ur(t,Pi,"bold");else if((function(r){return Pn(r,"u",Iu)})(e))e.preventDefault(),ur(t,Pi,"underline");else if((function(r){return Pn(r,"i",Iu)})(e))e.preventDefault(),ur(t,Pi,"italic");else if((function(r){return Pn(r,"Tab",{shiftKey:"any"})})(e))ur(t,JL,e);else if((function(r){return Pn(r,"z",Iu)})(e))e.preventDefault(),ur(t,f4,void 0);else if((function(r){return Uc?Pn(r,"z",{metaKey:!0,shiftKey:!0}):Pn(r,"y",{ctrlKey:!0})||Pn(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),ur(t,h4,void 0);else{const r=t._editorState._selection;r===null||Mt(r)?p8(e)&&(e.preventDefault(),ur(t,zT,e)):(function(n){return Pn(n,"c",Iu)})(e)?(e.preventDefault(),ur(t,zb,e)):(function(n){return Pn(n,"x",Iu)})(e)?(e.preventDefault(),ur(t,g4,e)):p8(e)&&(e.preventDefault(),ur(t,zT,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&ur(t,Ite,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;Hm(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&$o(t,(()=>{d8(r)||(VT=!0)}))}],["compositionstart",function(e,t){$o(t,(()=>{const r=tr();if(Mt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();ci(n.key),(e.timeStamp<vy+WT||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||rr(s)&&s.getStyle()!==r.style)&&ur(t,am,lte)}}))}],["compositionend",function(e,t){t0?Gx=!0:vm||!Wy&&!p_?$o(t,(()=>{mw(t,e.data)})):(tk=!0,rk=e.data)}],["input",function(e,t){e.stopPropagation(),$o(t,(()=>{if(as(e.target)&&d8(e.target))return;const r=tr(),n=e.data,s=o9(e);if(n!=null&&Mt(r)&&a9(r,s,n,e.timeStamp,!1)){Gx&&(mw(t,n),Gx=!1);const a=r.anchor.getNode(),i=dc(El(t));if(i===null)return;const o=r.isBackward(),c=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;m_&&!r.isCollapsed()&&rr(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+u)===P9(i.anchorNode)||ur(t,am,n);const d=n.length;t0&&d>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=d),Wy||vm||p_||!t.isComposing()||(vy=0,ci(null))}else N4(!1,t,n!==null?n:void 0),Gx&&(mw(t,n||void 0),Gx=!1);(function(){li();const a=Ss();DL(a)})()}),{event:e}),zg=null}],["click",function(e,t){$o(t,(()=>{const r=tr(),n=dc(El(t)),s=Wm();if(n){if(Mt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!ba(i)&&ps().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(c,u){let d=c;for(;d!==ps()&&d!=null;){if(u(d))return d;d=d.getParent()}return null})(i,(c=>wt(c)&&!c.isInline()));wt(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(as(a)||ld(a))&&hi(x4(s,n,t,e))}}ur(t,u4,e)}))}],["cut",Ou],["copy",Ou],["dragstart",Ou],["dragover",Ou],["dragend",Ou],["paste",Ou],["focus",Ou],["blur",Ou],["drop",Ou]];m_&&HT.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=o9(r);s==="deleteCompositionText"||t0&&F9(n)||s!=="insertCompositionText"&&$o(n,(()=>{const i=tr();if(s==="deleteContentBackward"){if(i===null){const p=Wm();if(!Mt(p))return;hi(p.clone())}if(Mt(i)){const p=i.anchor.key===i.focus.key;if(o=r.timeStamp,r9==="MediaLast"&&o<vy+WT&&n.isComposing()&&p){if(ci(null),vy=0,setTimeout((()=>{$o(n,(()=>{ci(null)}))}),WT),Mt(i)){const x=i.anchor.getNode();x.markDirty(),rr(x)||Wt(142),i9(i,x)}}else{ci(null),r.preventDefault();const x=i.anchor.getNode(),v=x.getTextContent(),w=x.canInsertTextAfter(),C=i.anchor.offset===0&&i.focus.offset===v.length;let k=AP&&p&&!C&&w;if(k&&i.isCollapsed()&&(k=!vn(JT(i.anchor,!0))),!k){ur(n,zh,!0);const _=tr();AP&&Mt(_)&&_.isCollapsed()&&(Ah=_,setTimeout((()=>Ah=null)))}}return}}var o;if(!Mt(i))return;const c=r.data;zg!==null&&N4(!1,n,zg),i.dirty&&zg===null||!i.isCollapsed()||ba(i.anchor.getNode())||a===null||i.applyDOMRange(a),zg=null;const u=i.anchor,d=i.focus,f=u.getNode(),g=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":ur(n,am,r);break;case"insertFromComposition":ci(null),ur(n,am,r);break;case"insertLineBreak":ci(null),ur(n,sm,!1);break;case"insertParagraph":ci(null),wy&&!vm?(wy=!1,ur(n,sm,!1)):ur(n,Vy,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":ur(n,d4,r);break;case"deleteByComposition":(function(p,x){return p!==x||wt(p)||wt(x)||!Wh(p)||!Wh(x)})(f,g)&&ur(n,UT,r);break;case"deleteByDrag":case"deleteByCut":ur(n,UT,r);break;case"deleteContent":ur(n,zh,!1);break;case"deleteWordBackward":ur(n,Ky,!0);break;case"deleteWordForward":ur(n,Ky,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":ur(n,qy,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":ur(n,qy,!1);break;case"formatStrikeThrough":ur(n,Pi,"strikethrough");break;case"formatBold":ur(n,Pi,"bold");break;case"formatItalic":ur(n,Pi,"italic");break;case"formatUnderline":ur(n,Pi,"underline");break;case"historyUndo":ur(n,f4,void 0);break;case"historyRedo":ur(n,h4,void 0)}else{if(c===`
`)r.preventDefault(),ur(n,sm,!1);else if(c===ed)r.preventDefault(),ur(n,Vy,void 0);else if(c==null&&r.dataTransfer){const p=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(p)}else c!=null&&a9(i,a,c,r.timeStamp,!0)?(r.preventDefault(),ur(n,am,c)):zg=c;n9=r.timeStamp}}))})(e,t)]);let vy=0,r9=null,n9=0,zg=null;const C_=new WeakMap;let GT=!1,VT=!1,wy=!1,Gx=!1,tk=!1,rk="",Ah=null,s9=[0,"",0,"root",0];function a9(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),c=Ss(),u=dc(El(c)),d=u!==null?u.anchorNode:null,f=a.key,g=c.getElementByKey(f),p=r.length;return f!==i.key||!rr(o)||(!s&&(!m_||n9<n+50)||o.isDirty()&&p<2||A9(r))&&a.offset!==i.offset&&!o.isComposing()||Ru(o)||o.isDirty()&&p>1||(s||!m_)&&g!==null&&!o.isComposing()&&d!==_m(g)||u!==null&&t!==null&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(x,v){if(v.isSegmented())return!0;if(!x.isCollapsed())return!1;const w=x.anchor.offset,C=v.getParentOrThrow(),k=Wh(v);return w===0?!v.canInsertTextBefore()||!C.canInsertTextBefore()&&!v.isComposing()||k||(function(_){const N=_.getPreviousSibling();return(rr(N)||wt(N)&&N.isInline())&&!N.canInsertTextAfter()})(v):w===v.getTextContentSize()&&(!v.canInsertTextAfter()||!C.canInsertTextAfter()&&!v.isComposing()||k)})(e,o)}function zP(e,t){return ld(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function WP(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;GT&&(GT=!1,zP(n,s)&&zP(a,i)&&!Ah)||$o(t,(()=>{if(!r)return void hi(null);if(!Dv(t,n,a))return;let o=tr();if(Ah&&Mt(o)&&o.isCollapsed()){const c=o.anchor,u=Ah.anchor;(c.key===u.key&&c.offset===u.offset+1||c.offset===1&&u.getNode().is(c.getNode().getPreviousSibling()))&&(o=Ah.clone(),hi(o))}if(Ah=null,Mt(o)){const c=o.anchor,u=c.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const d=El(t).event,f=d?d.timeStamp:performance.now(),[g,p,x,v,w]=s9,C=ps(),k=t.isComposing()===!1&&C.getTextContent()==="";if(f<w+200&&c.offset===x&&c.key===v)t_(o,g,p);else if(c.type==="text")rr(u)||Wt(141),i9(o,u);else if(c.type==="element"&&!k){wt(u)||Wt(259);const _=c.getNode();_.isEmpty()?(function(N,E){const P=E.getTextFormat(),F=E.getTextStyle();t_(N,P,F)})(o,_):t_(o,0,"")}}else{const d=c.key,f=o.focus.key,g=o.getNodes(),p=g.length,x=o.isBackward(),v=x?i:s,w=x?s:i,C=x?f:d,k=x?d:f;let _=ote,N=!1;for(let E=0;E<p;E++){const P=g[E],F=P.getTextContentSize();if(rr(P)&&F!==0&&!(E===0&&P.__key===C&&v===F||E===p-1&&P.__key===k&&w===0)&&(N=!0,_&=P.getFormat(),_===0))break}o.format=N?_:0}}ur(t,zL,void 0)}))}function t_(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function i9(e,t){t_(e,t.getFormat(),t.getStyle())}function o9(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function mw(e,t){const r=e._compositionKey;if(ci(null),r!==null&&t!=null){if(t===""){const n=la(r),s=_m(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&rr(n)&&A4(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=tr();if(Mt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void ur(e,k_,null)}}}N4(!0,e,t)}function l9(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const im=new Map;function c9(e){const t=gre(e.target);if(t===null)return;const r=k9(t.anchorNode);if(r===null)return;VT&&(VT=!1,$o(r,(()=>{const c=Wm(),u=t.anchorNode;(as(u)||ld(u))&&hi(x4(c,t,r,e))})));const n=E4(r),s=n[n.length-1],a=s._key,i=im.get(a),o=i||s;o!==r&&WP(t,o,!1),WP(t,r,!0),r!==s?im.set(a,r):i&&im.delete(a)}function HP(e){e._lexicalHandled=!0}function GP(e){return e._lexicalHandled===!0}function Rte(e){const t=e.ownerDocument,r=C_.get(t);if(r===void 0)return;const n=r-1;n>=0||Wt(164),C_.set(t,n),n===0&&t.removeEventListener("selectionchange",c9);const s=Yb(e);T4(s)?((function(i){if(i._parentEditor!==null){const o=E4(i),c=o[o.length-1]._key;im.get(c)===i&&im.delete(c)}else im.delete(i._key)})(s),e.__lexicalEditor=null):s&&Wt(198);const a=l9(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function KT(e,t,r){li();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const c=tr();if(!Mt(c)||!wt(o))return c;const{anchor:u,focus:d}=c,f=u.getNode(),g=d.getNode();return QT(f,o)&&u.set(o.__key,0,"element"),QT(g,o)&&d.set(o.__key,0,"element"),c})(e);let i=!1;if(Mt(a)&&t){const o=a.anchor,c=a.focus;o.key===n&&(E_(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(E_(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else Si(a)&&t&&e.isSelected()&&e.selectPrevious();if(Mt(a)&&t&&!i){const o=e.getIndexWithinParent();Hh(e),T_(a,s,o,-1)}else Hh(e);r||ro(s)||s.canBeEmpty()||!s.isEmpty()||KT(s,t),t&&a&&ba(s)&&s.isEmpty()&&s.selectEnd()}class Um{static getType(){const{ownNodeType:t}=D4(this);return t===void 0&&Wt(64,this.name),t}static clone(t){Wt(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),ire(this,t)}getType(){return this.__type}isInline(){Wt(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=la(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||tr();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(rr(this))return n;if(Mt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(vn(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:la(t)}getParentOrThrow(){const t=this.getParent();return t===null&&Wt(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(ro(r))return wt(t)||t===this&&vn(t)||Wt(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&Wt(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:la(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:la(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=wt(this)?this:this.getParent(),n=wt(t)?t:t.getParent(),s=r&&n?n_(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=n_(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?R9(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&Wt(279),!1)))}isParentOf(t){const r=n_(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=wt(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===t)break;let d=null,f=u;do{if(f===null&&Wt(68),d=r?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),f===null)break;d!==null||s.has(f.__key)||n.push(f)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const t=Ss()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=la(this.__key);return t===null&&Wt(113),t}getWritable(){li();const t=If(),r=Ss(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=tr();if(o!==null&&o.setCachedNodes(null),i.has(s))return j_(a),a;const c=F4(a);return i.add(s),j_(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){Wt(70)}updateDOM(t,r,n){Wt(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){Wt(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of ML(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&wte(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){KT(this,!0,t)}replace(t,r){li();let n=tr();n!==null&&(n=n.clone()),lk(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),c=this.getParentOrThrow().getWritable(),u=c.__size;Hh(o);const d=s.getPreviousSibling(),f=s.getNextSibling(),g=s.__prev,p=s.__next,x=s.__parent;if(KT(s,!1,!0),d===null?c.__first=i:d.getWritable().__next=i,o.__prev=g,f===null?c.__last=i:f.getWritable().__prev=i,o.__next=p,o.__parent=x,c.__size=u,r&&(wt(this)&&wt(o)||Wt(139),this.getChildren().forEach((v=>{o.append(v)}))),Mt(n)){hi(n);const v=n.anchor,w=n.focus;v.key===a&&YP(v,o),w.key===a&&YP(w,o)}return df()===a&&ci(i),o}insertAfter(t,r=!0){li(),lk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=tr();let o=!1,c=!1;if(a!==null){const p=t.getIndexWithinParent();if(Hh(s),Mt(i)){const x=a.__key,v=i.anchor,w=i.focus;o=v.type==="element"&&v.key===x&&v.offset===p+1,c=w.type==="element"&&w.key===x&&w.offset===p+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),f=s.__key,g=n.__next;if(u===null?d.__last=f:u.getWritable().__prev=f,d.__size++,n.__next=f,s.__next=g,s.__prev=n.__key,s.__parent=n.__parent,r&&Mt(i)){const p=this.getIndexWithinParent();T_(i,d,p+1);const x=d.__key;o&&i.anchor.set(x,p+2,"element"),c&&i.focus.set(x,p+2,"element")}return t}insertBefore(t,r=!0){li(),lk(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Hh(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),c=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const d=tr();return r&&Mt(d)&&T_(d,this.getParentOrThrow(),u),t}isParentRequired(){return!1}createParentElementNode(){return ss()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){li();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(wt(n))return n.select();if(!rr(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){li();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(wt(n))return n.select(0,0);if(!rr(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Av extends Um{static getType(){return"linebreak"}static clone(t){return new Av(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&P_(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&pw(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&pw(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&P_(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&pw(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&pw(a))return!0}return!1})(t)?null:{conversion:Mte,priority:0}}}static importJSON(t){return Jc().updateFromJSON(t)}}function Mte(e){return{node:Jc()}}function Jc(){return ao(new Av)}function Vu(e){return e instanceof Av}function pw(e){return ld(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function nk(e,t){return 16&t?"code":t&r4?"mark":32&t?"sub":64&t?"sup":null}function sk(e,t){return 1&t?"strong":2&t?"em":"span"}function u9(e,t,r,n,s){const a=n.classList;let i=om(s,"base");i!==void 0&&a.add(...i),i=om(s,"underlineStrikethrough");let o=!1;const c=t&y_&&t&x_;i!==void 0&&(r&y_&&r&x_?(o=!0,c||a.add(...i)):c&&a.remove(...i));for(const u in n0){const d=n0[u];if(i=om(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){t&d&&a.remove(...i);continue}t&d&&(!c||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else t&d&&a.remove(...i)}}function d9(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?$b:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||t0){const[o,c,u]=(function(d,f){const g=d.length,p=f.length;let x=0,v=0;for(;x<g&&x<p&&d[x]===f[x];)x++;for(;v+x<g&&v+x<p&&d[g-v-1]===f[p-v-1];)v++;return[x,g-x-v,f.slice(x,p-v)]})(i,a);c!==0&&n.deleteData(o,c),n.insertData(o,u)}else n.nodeValue=a}}function VP(e,t,r,n,s,a){d9(s,e,t);const i=a.theme.text;i!==void 0&&u9(0,0,n,e,i)}function xw(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Df extends Um{static getType(){return"text"}static clone(t){return new Df(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return fte[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===df()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=n0[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return A_(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=nk(0,n),a=sk(0,n),i=s===null?a:s,o=document.createElement(i);let c=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),o.appendChild(c)),VP(c,this,0,n,this.__text,t);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=nk(0,a),c=nk(0,i),u=sk(0,a),d=sk(0,i);if((o===null?u:o)!==(c===null?d:c))return!0;if(o===c&&u!==d){const v=r.firstChild;v==null&&Wt(48);const w=document.createElement(d);return VP(w,this,0,i,s,n),r.replaceChild(w,v),!1}let f=r;c!==null&&o!==null&&(f=r.firstChild,f==null&&Wt(49)),d9(s,f,this);const g=n.theme.text;g!==void 0&&a!==i&&u9(0,a,i,f,g);const p=t.__style,x=this.__style;return p!==x&&(r.style.cssText=x),!1}static importDOM(){return{"#text":()=>({conversion:Ute,priority:0}),b:()=>({conversion:Bte,priority:0}),code:()=>({conversion:Du,priority:0}),em:()=>({conversion:Du,priority:0}),i:()=>({conversion:Du,priority:0}),mark:()=>({conversion:Du,priority:0}),s:()=>({conversion:Du,priority:0}),span:()=>({conversion:Lte,priority:0}),strong:()=>({conversion:Du,priority:0}),sub:()=>({conversion:Du,priority:0}),sup:()=>({conversion:Du,priority:0}),u:()=>({conversion:Du,priority:0})}}static importJSON(t){return Ps().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return as(r)||Wt(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=xw(r,"b")),this.hasFormat("italic")&&(r=xw(r,"i")),this.hasFormat("strikethrough")&&(r=xw(r,"s")),this.hasFormat("underline")&&(r=xw(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?n0[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?cte[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=A_(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=dte[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){li();let n=t,s=r;const a=tr(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!Mt(a))return g9(o,n,o,s,"text","text");{const c=df();c!==a.anchor.key&&c!==a.focus.key||ci(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let c=t;c<0&&(c=o+c,c<0&&(c=0));const u=tr();if(s&&Mt(u)){const f=t+o;u.setTextNodeRange(a,f,a,f)}const d=i.slice(0,c)+n+i.slice(c+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){li();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=df(),i=n.length;t.sort(((A,j)=>A-j)),t.push(i);const o=[],c=t.length;for(let A=0,j=0;A<i&&j<=c;j++){const I=t[j];I>A&&(o.push(n.slice(A,I)),A=I)}const u=o.length;if(u===1)return[r];const d=o[0],f=r.getParent();let g;const p=r.getFormat(),x=r.getStyle(),v=r.__detail;let w=!1,C=null,k=null;const _=tr();if(Mt(_)){const[A,j]=_.isBackward()?[_.focus,_.anchor]:[_.anchor,_.focus];A.type==="text"&&A.key===s&&(C=A),j.type==="text"&&j.key===s&&(k=j)}r.isSegmented()?(g=Ps(d),g.__format=p,g.__style=x,g.__detail=v,g.__state=IP(r,g),w=!0):g=r.setTextContent(d);const N=[g];for(let A=1;A<u;A++){const j=Ps(o[A]);j.__format=p,j.__style=x,j.__detail=v,j.__state=IP(r,j);const I=j.__key;a===s&&ci(I),N.push(j)}const E=C?C.offset:null,P=k?k.offset:null;let F=0;for(const A of N){if(!C&&!k)break;const j=F+A.getTextContentSize();if(C!==null&&E!==null&&E<=j&&E>=F&&(C.set(A.getKey(),E-F,"text"),E<j&&(C=null)),k!==null&&P!==null&&P<=j&&P>=F){k.set(A.getKey(),P-F,"text");break}F=j}if(f!==null){(function(I){const L=I.getPreviousSibling(),Y=I.getNextSibling();L!==null&&j_(L),Y!==null&&j_(Y)})(this);const A=f.getWritable(),j=this.getIndexWithinParent();w?(A.splice(j,0,N),this.remove()):A.splice(j,1,N),Mt(_)&&T_(_,f,j,u-1)}return N}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||Wt(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;df()===s&&ci(n);const o=tr();if(Mt(o)){const f=o.anchor,g=o.focus;f!==null&&f.key===s&&r8(f,r,n,t,i),g!==null&&g.key===s&&r8(g,r,n,t,i)}const c=t.__text,u=r?c+a:a+c;this.setTextContent(u);const d=this.getWritable();return t.remove(),d}isTextEntity(){return!1}}function Lte(e){return{forChild:m4(e.style),node:null}}function Bte(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:m4(t.style,r?void 0:"bold"),node:null}}const KP=new WeakMap;function $te(e){if(!as(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function Ute(e){const t=e;e.parentElement===null&&Wt(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=KP.get(a))===void 0&&!$te(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let c=0;c<i.length;c++)KP.set(i[c],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(Jc()):o==="	"?s.push(zm()):o!==""&&s.push(Ps(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=qP(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=qP(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:Ps(r)}}function qP(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,as(r)){const a=r.style.display;if(a===""&&!tE(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(ld(r))return r;if(r.nodeName==="BR")return null}}const zte={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Du(e){const t=zte[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:m4(e.style,t),node:null}}function Ps(e=""){return ao(new Df(e))}function rr(e){return e instanceof Df}function m4(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),c=e.verticalAlign;return u=>(rr(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),c!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),c!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),t&&!u.hasFormat(t)&&u.toggleFormat(t)),u)}class jv extends Df{static getType(){return"tab"}static clone(t){return new jv(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=om(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return zm().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&Wt(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||Wt(286),this}setDetail(t){return t!==2&&Wt(127),this}setMode(t){return t!=="normal"&&Wt(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function zm(){return ao(new jv)}function Wb(e){return e instanceof jv}class Wte{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:I9(bl(td(this,"next")),bl(td(t,"next")))<0}getNode(){const t=la(this.key);return t===null&&Wt(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,Pv()||(df()===i&&ci(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function Qc(e,t,r){return new Wte(e,t,r)}function ak(e,t){let r=t.__key,n=e.offset,s="element";if(rr(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!wt(t)){const a=t.getNextSibling();if(rr(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function YP(e,t){if(wt(t)){const r=t.getLastDescendant();wt(r)||rr(r)?ak(e,r):ak(e,t)}else ak(e,t)}class Hb{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!Si(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new Hb(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(rr(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=la(s);a!==null&&n.push(a)}return Pv()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((tr()||Wm())===this&&t[0]){const r=fi(t[0],"next");Ere(Cf(r,r))}for(const r of t)r.remove()}}function Mt(e){return e instanceof C0}class C0{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Mt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,c=new Set;for(const u of n)if(Yc(u)){const{origin:d}=u;s.length===0?o.add(d):(c.add(d),s.push(d))}else{const{origin:d}=u;wt(d)&&c.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),c0(n.focus)&&wt(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=Nl(n.focus.origin,"previous");Yc(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=M4(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!wt(u)||c.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=bl(n.anchor),d=bl(n.anchor.getFlipped()),f=p=>xf(p)?p.origin:p.getNodeAtCaret(),g=f(u)||f(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(g)}return s})(L9(b8(this),"next"));return Pv()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,c]=qT(this);let u="",d=!0;for(let f=0;f<t.length;f++){const g=t[f];if(wt(g)&&!g.isInline())d||(u+=`
`),d=!g.isEmpty();else if(d=!1,rr(g)){let p=g.getTextContent();g===r?g===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(p=o<c?p.slice(o,c):p.slice(c,o)):p=i?p.slice(o):p.slice(c):g===n&&(p=i?p.slice(0,c):p.slice(0,o)),u+=p}else!vn(g)&&!Vu(g)||g===n&&this.isCollapsed()||(u+=g.getTextContent())}return u}applyDOMRange(t){const r=Ss(),n=r.getEditorState()._selection,s=h9(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),v_(this)}clone(){const t=this.anchor,r=this.focus;return new C0(Qc(t.key,t.offset,t.type),Qc(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=A_(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=n0[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(Jc()):i==="	"?n.push(zm()):n.push(Ps(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(w,C,k,_){const N=w.getNode(),E=N.getChildAtIndex(w.offset),P=Ps();if(P.setFormat(k),P.setStyle(_),b4(E))E.splice(0,0,[P]);else{const F=ba(N)?ss().append(P):P;E===null?N.append(F):E.insertBefore(F)}w.is(C)&&C.set(P.__key,0,"text"),w.set(P.__key,0,"text")})(i,o,s,a),o.type==="element"&&d0(o,bl(td(o,"next")));const c=i.offset;let u=o.offset;const d=this.getNodes(),f=d.length;let g=d[0];rr(g)||Wt(26);const p=g.getTextContent().length,x=g.getParentOrThrow();let v=d[f-1];if(f===1&&o.type==="element"&&(u=p,o.set(i.key,u,"text")),this.isCollapsed()&&c===p&&(Ru(g)||!g.canInsertTextAfter()||!x.canInsertTextAfter()&&g.getNextSibling()===null)){let w=g.getNextSibling();if(rr(w)&&w.canInsertTextBefore()&&!Ru(w)||(w=Ps(),w.setFormat(s),w.setStyle(a),x.canInsertTextAfter()?g.insertAfter(w):x.insertAfter(w)),w.select(0,0),g=w,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(Ru(g)||!g.canInsertTextBefore()||!x.canInsertTextBefore()&&g.getPreviousSibling()===null)){let w=g.getPreviousSibling();if(rr(w)&&!Ru(w)||(w=Ps(),w.setFormat(s),x.canInsertTextBefore()?g.insertBefore(w):x.insertBefore(w)),w.select(),g=w,t!=="")return void this.insertText(t)}else if(g.isSegmented()&&c!==p){const w=Ps(g.getTextContent());w.setFormat(s),g.replace(w),g=w}else if(!this.isCollapsed()&&t!==""){const w=v.getParent();if(!x.canInsertTextBefore()||!x.canInsertTextAfter()||wt(w)&&(!w.canInsertTextBefore()||!w.canInsertTextAfter()))return this.insertText(""),f9(this.anchor,this.focus,null),void this.insertText(t)}if(f===1){if(Wh(g)){const _=Ps(t);return _.select(),void g.replace(_)}const w=g.getFormat(),C=g.getStyle();if(c!==u||w===s&&C===a){if(Wb(g)){const _=Ps(t);return _.setFormat(s),_.setStyle(a),_.select(),void g.replace(_)}}else{if(g.getTextContent()!==""){const _=Ps(t);if(_.setFormat(s),_.setStyle(a),_.select(),c===0)g.insertBefore(_,!1);else{const[N]=g.splitText(c);N.insertAfter(_,!1)}return void(_.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}g.setFormat(s),g.setStyle(a)}const k=u-c;g=g.spliceText(c,k,t,!0),g.getTextContent()===""?g.remove():this.anchor.type==="text"&&(g.isComposing()?this.anchor.offset-=t.length:(this.format=w,this.style=C))}else{const w=new Set([...g.getParentKeys(),...v.getParentKeys()]),C=wt(g)?g:g.getParentOrThrow();let k=wt(v)?v:v.getParentOrThrow(),_=v;if(!C.is(k)&&k.isInline())do _=k,k=k.getParentOrThrow();while(k.isInline());if(o.type==="text"&&(u!==0||v.getTextContent()==="")||o.type==="element"&&v.getIndexWithinParent()<u)if(rr(v)&&!Wh(v)&&u!==v.getTextContentSize()){if(v.isSegmented()){const A=Ps(v.getTextContent());v.replace(A),v=A}ba(o.getNode())||o.type!=="text"||(v=v.spliceText(0,u,"")),w.add(v.__key)}else{const A=v.getParentOrThrow();A.canBeEmpty()||A.getChildrenSize()!==1?v.remove():A.remove()}else w.add(v.__key);const N=k.getChildren(),E=new Set(d),P=C.is(k),F=C.isInline()&&g.getNextSibling()===null?C:g;for(let A=N.length-1;A>=0;A--){const j=N[A];if(j.is(g)||wt(j)&&j.isParentOf(g))break;j.isAttached()&&(!E.has(j)||j.is(_)?P||F.insertAfter(j,!1):j.remove())}if(!P){let A=k,j=null;for(;A!==null;){const I=A.getChildren(),L=I.length;(L===0||I[L-1].is(j))&&(w.delete(A.__key),j=A),A=A.getParent()}}if(Wh(g))if(c===p)g.select();else{const A=Ps(t);A.select(),g.replace(A)}else g=g.spliceText(c,p-c,t,!0),g.getTextContent()===""?g.remove():g.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let A=1;A<f;A++){const j=d[A],I=j.__key;w.has(I)||j.remove()}}}removeText(){const t=tr()===this;s_(this,Nre(b8(this))),t&&tr()!==this&&hi(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void ci(null);const n=this.getNodes(),s=[];for(const N of n)rr(N)&&s.push(N);const a=N=>{n.forEach((E=>{if(wt(E)){const P=E.getFormatFlags(t,N);E.setTextFormat(P)}}))},i=s.length;if(i===0)return this.toggleFormat(t),ci(null),void a(r);const o=this.anchor,c=this.focus,u=this.isBackward(),d=u?c:o,f=u?o:c;let g=0,p=s[0],x=d.type==="element"?0:d.offset;if(d.type==="text"&&x===p.getTextContentSize()&&(g=1,p=s[1],x=0),p==null)return;const v=p.getFormatFlags(t,r);a(v);const w=i-1;let C=s[w];const k=f.type==="text"?f.offset:C.getTextContentSize();if(p.is(C)){if(x===k)return;if(Ru(p)||x===0&&k===p.getTextContentSize())p.setFormat(v);else{const N=p.splitText(x,k),E=x===0?N[0]:N[1];E.setFormat(v),d.type==="text"&&d.set(E.__key,0,"text"),f.type==="text"&&f.set(E.__key,k-x,"text")}return void(this.format=v)}x===0||Ru(p)||([,p]=p.splitText(x),x=0),p.setFormat(v);const _=C.getFormatFlags(t,v);k>0&&(k===C.getTextContentSize()||Ru(C)||([C]=C.splitText(k)),C.setFormat(_));for(let N=g+1;N<w;N++){const E=s[N],P=E.getFormatFlags(t,_);E.setFormat(P)}d.type==="text"&&d.set(p.__key,x,"text"),f.type==="text"&&f.set(C.__key,k,"text"),this.format=v|_}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const x=tr();return Mt(x)||Wt(134),x.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=uk(r,_l),s=t[t.length-1];if(wt(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const x=ik(this);n.splice(x,0,t),s.selectEnd()}return}if(!t.some((x=>(wt(x)||vn(x))&&!x.isInline()))){wt(n)||Wt(211,r.constructor.name,r.getType());const x=ik(this);return n.splice(x,0,t),void s.selectEnd()}const a=(function(x){const v=ss();let w=null;for(let C=0;C<x.length;C++){const k=x[C],_=Vu(k);if(_||vn(k)&&k.isInline()||wt(k)&&k.isInline()||rr(k)||k.isParentRequired()){if(w===null&&(w=k.createParentElementNode(),v.append(w),_))continue;w!==null&&w.append(k)}else v.append(k),w=null}return v})(t),i=a.getLastDescendant(),o=a.getChildren(),c=!wt(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var f;wt(f=d)&&_l(f)&&!f.isEmpty()&&wt(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(wt(n)||Wt(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&Wt(212,r.constructor.name,r.getType()),(function(x,v,w){const C=v.getParentOrThrow().getLastChild();let k=v;const _=[v];for(;k!==C;)k.getNextSibling()||Wt(140),k=k.getNextSibling(),_.push(k);let N=x;for(const E of _)N=N.insertAfter(E)})(n,d));const g=uk(i,_l);c&&wt(g)&&(c.canMergeWhenEmpty()||_l(u))&&(g.append(...c.getChildren()),c.remove()),wt(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const p=wt(n)?n.getLastChild():null;Vu(p)&&g!==n&&p.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=ss();return ps().splice(this.anchor.offset,0,[i]),i.select(),i}const t=ik(this),r=uk(this.anchor.getNode(),_l);wt(r)||Wt(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=Jc();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[c,u]=qT(this);if(r===0)return[];if(r===1){if(rr(i)&&!this.isCollapsed()){const f=c>u?u:c,g=c>u?c:u,p=i.splitText(f,g),x=f===0?p[0]:p[1];return x!=null?[x]:[]}return[i]}const d=s.isBefore(a);if(rr(i)){const f=d?c:u;f===i.getTextContentSize()?t.shift():f!==0&&([,i]=i.splitText(f),t[0]=i)}if(rr(o)){const f=o.getTextContent().length,g=d?u:c;g===0?t.pop():g!==f&&([o]=o.splitText(g),t[n]=o)}return t}modify(t,r,n){if(n8(this,t,r,n))return;const s=t==="move",a=Ss(),i=dc(El(a));if(!i)return;const o=a._blockCursorElement,c=a._rootElement,u=this.focus.getNode();if(c===null||o===null||!wt(u)||u.isInline()||u.canBeEmpty()||ZT(o,a,c),this.dirty){let d=i0(a,this.anchor.key),f=i0(a,this.focus.key);this.anchor.type==="text"&&(d=_m(d)),this.focus.type==="text"&&(f=_m(f)),d&&f&&m9(i,d,this.anchor.offset,f,this.focus.offset)}if((function(d,f,g,p){d.modify(f,g,p)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),f=this.anchor.getNode(),g=ba(f)?f:fre(f);if(this.applyDOMRange(d),this.dirty=!0,!s){const p=this.getNodes(),x=[];let v=!1;for(let w=0;w<p.length;w++){const C=p[w];QT(C,g)?x.push(C):v=!0}if(v&&x.length>0)if(r){const w=x[0];wt(w)?w.selectStart():w.getParentOrThrow().selectStart()}else{const w=x[x.length-1];wt(w)?w.selectEnd():w.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||(function(w){const C=w.focus,k=w.anchor,_=k.key,N=k.offset,E=k.type;k.set(C.key,C.offset,C.type,!0),C.set(_,N,E,!0)})(this)}}n==="lineboundary"&&n8(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&wt(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(wt(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=B4(td(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(Yc(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(o.type==="merge-block")break;if(wt(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=bl(c);s_(this,Cf(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:c,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(c0(c)){if(wt(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else o={block:c.origin,type:"merge-next-block"};continue}if(vn(c.origin)){if(!c.origin.isIsolated())if(o.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&wt(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=p4();u.add(c.origin.getKey()),hi(u)}else c.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:c,block:u}=o;return s_(this,Cf(!c.origin.isEmpty()&&u.isEmpty()?U4(fi(u,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&JP(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const c=i.offset,u=o.getTextContentSize();if(o.is(s)||t&&c!==u||!t&&c!==0)return void QP(o,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,u=s.getTextContentSize();if(s.is(o)||t&&c!==0||!t&&c!==u)return void QP(s,t,c)}(function(c,u){const d=c.anchor,f=c.focus,g=d.getNode(),p=f.getNode();if(g===p&&d.type==="text"&&f.type==="text"){const x=d.offset,v=f.offset,w=x<v,C=w?x:v,k=w?v:x,_=k-1;C!==_&&(function(N){return!(A9(N)||Hte(N))})(g.getTextContent().slice(C,k))&&(u?f.set(f.key,_,f.type):d.set(d.key,_,d.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&ba(n.getParent())&&n.getPreviousSibling()===null&&JP(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function Si(e){return e instanceof Hb}function XP(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function qT(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[XP(r),XP(n)]}function JP(e,t){for(let r=t;r;r=r.getParent()){if(wt(r)){if(r.collapseAtStart(e))return!0;if(ro(r))break}if(r.getPreviousSibling())break}return!1}const Hte=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function QP(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,t&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(o,o))}function ZP(e,t,r,n){let s,a=t;if(as(e)){let i=!1;const o=e.childNodes,c=o.length,u=n._blockCursorElement;a===c&&(i=!0,a=c-1);let d=o[a],f=!1;if(d===u)d=o[a+1],f=!0;else if(u!==null){const g=u.parentNode;e===g&&t>Array.prototype.indexOf.call(g.children,u)&&a--}if(s=Zg(d),rr(s))a=yf(s,i?"next":"previous");else{let g=Zg(e);if(g===null)return null;if(wt(g)){const p=n.getElementByKey(g.getKey());p===null&&Wt(214),[g,a]=g.getDOMSlot(p).resolveChildIndex(g,p,e,t),wt(g)||Wt(215),i&&a>=g.getChildrenSize()&&(a=Math.max(0,g.getChildrenSize()-1));let v=g.getChildAtIndex(a);if(wt(v)&&(function(w,C,k){const _=w.getParent();return k===null||_===null||!_.canBeEmpty()||_!==k.getNode()})(v,0,r)){const w=i?v.getLastDescendant():v.getFirstDescendant();w===null?g=v:(v=w,g=wt(v)?v:v.getParentOrThrow()),a=0}rr(v)?(s=v,g=null,a=yf(v,i?"next":"previous")):v!==g&&i&&!f&&(wt(g)||Wt(216),a=Math.min(g.getChildrenSize(),a+1))}else{const p=g.getIndexWithinParent();a=t===0&&vn(g)&&Zg(e)===g?p:p+1,g=g.getParentOrThrow()}if(wt(g))return Qc(g.__key,a,"element")}}else s=Zg(e);return rr(s)?Qc(s.__key,yf(s,a,"clamp"),"text"):null}function e8(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&wt(i)&&i.isInline()){const o=i.getPreviousSibling();rr(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else wt(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):rr(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&wt(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&wt(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();rr(o)&&e.set(o.__key,0,"text")}}}function f9(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);e8(e,n,s),e8(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=Ss();if(a.isComposing()&&a._compositionKey!==e.key&&Mt(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function h9(e,t,r,n,s,a){if(e===null||r===null||!Dv(s,e,r))return null;const i=ZP(e,t,Mt(a)?a.anchor:null,s);if(i===null)return null;const o=ZP(r,n,Mt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const c=Zg(e),u=Zg(r);if(vn(c)&&vn(u))return null}return f9(i,o,a),[i,o]}function YT(e){return wt(e)&&!e.isInline()}function g9(e,t,r,n,s,a){const i=If(),o=new C0(Qc(e,t,s),Qc(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function Gb(){const e=Qc("root",0,"element"),t=Qc("root",0,"element");return new C0(e,t,0,"")}function p4(){return new Hb(new Set)}function x4(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",c=!OT&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,f,g;if(Mt(e)&&!c)return e.clone();if(t===null)return null;if(u=t.anchorNode,d=t.focusNode,f=t.anchorOffset,g=t.focusOffset,o&&Mt(e)&&!Dv(r,u,d))return e.clone();const p=h9(u,f,d,g,r,e);if(p===null)return null;const[x,v]=p;return new C0(x,v,Mt(e)?e.format:0,Mt(e)?e.style:"")}function tr(){return If()._selection}function Wm(){return Ss()._editorState._selection}function T_(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const c=t.__key;if(e.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(c,d,"element"),a.set(c,d,"element"),t8(e)}}else{const u=e.isBackward(),d=u?a:s,f=d.getNode(),g=u?s:a,p=g.getNode();if(t.is(f)){const x=d.offset;(r<=x&&n>0||r<x&&n<0)&&d.set(c,Math.max(0,x+n),"element")}if(t.is(p)){const x=g.offset;(r<=x&&n>0||r<x&&n<0)&&g.set(c,Math.max(0,x+n),"element")}}t8(e)}function t8(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!wt(a))return;const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(rr(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(wt(a)){const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(rr(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text")}}if(wt(i)){const o=i.getChildrenSize(),c=s>=o,u=c?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(rr(u)){let d=0;c&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function E_(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,rr(n)?(i=n.getTextContentSize(),o="text"):wt(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,rr(s)?o="text":wt(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function r8(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function m9(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function Gte(e,t,r,n,s,a,i){const o=n.anchorNode,c=n.focusNode,u=n.anchorOffset,d=n.focusOffset,f=document.activeElement;if(s.has(_9)&&f!==a||f!==null&&C4(f))return;if(!Mt(t))return void(e!==null&&Dv(r,o,c)&&n.removeAllRanges());const g=t.anchor,p=t.focus,x=g.key,v=p.key,w=i0(r,x),C=i0(r,v),k=g.offset,_=p.offset,N=t.format,E=t.style,P=t.isCollapsed();let F=w,A=C,j=!1;if(g.type==="text"){F=_m(w);const ee=g.getNode();j=ee.getFormat()!==N||ee.getStyle()!==E}else Mt(e)&&e.anchor.type==="text"&&(j=!0);var I,L,Y,Z,ae;if(p.type==="text"&&(A=_m(C)),F!==null&&A!==null&&(P&&(e===null||j||Mt(e)&&(e.format!==N||e.style!==E))&&(I=N,L=E,Y=k,Z=x,ae=performance.now(),s9=[I,L,Y,Z,ae]),u!==k||d!==_||o!==F||c!==A||n.type==="Range"&&P||(f!==null&&a.contains(f)||a.focus({preventScroll:!0}),g.type==="element"))){if(m9(n,F,k,A,_),!s.has(Qte)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const ee=Mt(t)&&t.anchor.type==="element"?F.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(ee!==null){let ne;if(ee instanceof Text){const B=document.createRange();B.selectNode(ee),ne=B.getBoundingClientRect()}else ne=ee.getBoundingClientRect();(function(B,V,M){const H=O9(M),W=P4(H);if(H===null||W===null)return;let{top:R,bottom:z}=V,K=0,J=0,se=M;for(;se!==null;){const X=se===H.body;if(X)K=0,J=El(B).innerHeight;else{const le=se.getBoundingClientRect();K=le.top,J=le.bottom}let ie=0;if(R<K?ie=-(K-R):z>J&&(ie=z-J),ie!==0)if(X)W.scrollBy(0,ie);else{const le=se.scrollTop;se.scrollTop+=ie;const ce=se.scrollTop-le;R-=ce,z-=ce}if(X)break;se=Iv(se)}})(r,ne,a)}}GT=!0}}function Vte(e){let t=tr()||Wm();t===null&&(t=ps().selectEnd()),t.insertNodes(e)}function ik(e){let t=e;e.isCollapsed()||t.removeText();const r=tr();Mt(r)&&(t=r),Mt(t)||Wt(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!_l(s);){const i=s;if([s,a]=Kte(s,a),i.is(s))break}return a}function Kte(e,t){const r=e.getParent();if(!r){const s=ss();return ps().append(s),s.select(),[ps(),0]}if(rr(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!wt(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new C0(Qc(e.__key,t,"element"),Qc(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function n8(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[d,f]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return f.set(d.key,d.offset,d.type),!0}const a=td(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let c=a,u=s==="decorators-and-blocks";if(!M9(c)){for(const d of c){u=!1;const{origin:f}=d;if(!vn(f)||f.isIsolated()||(c=d,!i||!f.isInline()))break}if(u)for(const d of B4(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(Yc(d))d.origin.isInline()||(c=d);else{if(wt(d.origin))continue;vn(d.origin)&&!d.origin.isInline()&&(c=d)}break}}if(c===a)return!1;if(o&&!i&&vn(c.origin)&&c.origin.isKeyboardSelectable()){const d=p4();return d.add(c.origin.getKey()),hi(d),!0}return c=bl(c),o&&d0(e.anchor,c),d0(e.focus,c),u||!i}let Ma=null,La=null,So=!1,ok=!1,r_=0;const s8={characterData:!0,childList:!0,subtree:!0};function Pv(){return So||Ma!==null&&Ma._readOnly}function li(){So&&Wt(13)}function p9(){r_>99&&Wt(14)}function If(){return Ma===null&&Wt(195,x9()),Ma}function Ss(){return La===null&&Wt(196,x9()),La}function x9(){let e=0;const t=new Set,r=qb.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=Yb(s);if(T4(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function qte(){return La}function a8(e,t,r){const n=t.__type,s=S9(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function i8(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function y9(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function Yte(e){return y4(e,Ss()._nodes)}function y4(e,t){const r=e.type,n=t.get(r);n===void 0&&Wt(17,r);const s=n.klass;e.type!==s.getType()&&Wt(18,s.name);const a=s.importJSON(e),i=e.children;if(wt(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const c=y4(i[o],t);a.append(c)}return a}function o8(e,t,r){const n=Ma,s=So,a=La;Ma=t,So=!0,La=e;try{return r()}finally{Ma=n,So=s,La=a}}function Lu(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,c=e._dirtyType!==r0,u=Ma,d=So,f=La,g=e._updating,p=e._observer;let x=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&p!==null){La=e,Ma=r,So=!1,e._updating=!0;try{const P=e._dirtyType,F=e._dirtyElements,A=e._dirtyLeaves;p.disconnect(),x=Ste(a,r,e,P,F,A)}catch(P){if(P instanceof Error&&e._onError(P),ok)throw P;return b9(e,null,n,r),IL(e),e._dirtyType=wm,ok=!0,Lu(e,a),void(ok=!1)}finally{p.observe(n,s8),e._updating=g,Ma=u,So=d,La=f}}r._readOnly||(r._readOnly=!0);const v=e._dirtyLeaves,w=e._dirtyElements,C=e._normalizedNodes,k=e._updateTags,_=e._deferred;c&&(e._dirtyType=r0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(P,F){const A=P._decorators;let j=P._pendingDecorators||A;const I=F._nodeMap;let L;for(L in j)I.has(L)||(j===A&&(j=E9(P)),delete j[L])})(e,r);const N=s?null:dc(El(e));if(e._editable&&N!==null&&(c||o===null||o.dirty)&&n!==null&&!k.has(Zte)){La=e,Ma=r;try{if(p!==null&&p.disconnect(),c||o===null||o.dirty){const P=e._blockCursorElement;P!==null&&ZT(P,e,n),Gte(i,o,e,N,k,n)}(function(P,F,A){let j=P._blockCursorElement;if(Mt(A)&&A.isCollapsed()&&A.anchor.type==="element"&&F.contains(document.activeElement)){const I=A.anchor,L=I.getNode(),Y=I.offset;let Z=!1,ae=null;if(Y===L.getChildrenSize())ck(L.getChildAtIndex(Y-1))&&(Z=!0);else{const ee=L.getChildAtIndex(Y);if(ee!==null&&ck(ee)){const ne=ee.getPreviousSibling();(ne===null||ck(ne))&&(Z=!0,ae=P.getElementByKey(ee.__key))}}if(Z){const ee=P.getElementByKey(L.__key);return j===null&&(P._blockCursorElement=j=(function(ne){const B=ne.theme,V=document.createElement("div");V.contentEditable="false",V.setAttribute("data-lexical-cursor","true");let M=B.blockCursor;if(M!==void 0){if(typeof M=="string"){const H=jL(M);M=B.blockCursor=H}M!==void 0&&V.classList.add(...M)}return V})(P._config)),F.style.caretColor="transparent",void(ae===null?ee.appendChild(j):ee.insertBefore(j,ae))}}j!==null&&ZT(j,P,F)})(e,n,o)}finally{p!==null&&p.observe(n,s8),La=f,Ma=u}}x!==null&&(function(P,F,A,j,I){const L=Array.from(P._listeners.mutation),Y=L.length;for(let Z=0;Z<Y;Z++){const[ae,ee]=L[Z];for(const ne of ee){const B=F.get(ne);B!==void 0&&ae(B,{dirtyLeaves:j,prevEditorState:I,updateTags:A})}}})(e,x,k,v,a),Mt(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(zL,void 0);const E=e._pendingDecorators;E!==null&&(e._decorators=E,e._pendingDecorators=null,_y("decorator",e,!0,E)),(function(P,F,A){const j=f8(F),I=f8(A);j!==I&&_y("textcontent",P,!0,I)})(e,t||a,r),_y("update",e,!0,{dirtyElements:w,dirtyLeaves:v,editorState:r,mutatedNodes:x,normalizedNodes:C,prevEditorState:t||a,tags:k}),(function(P,F){if(P._deferred=[],F.length!==0){const A=P._updating;P._updating=!0;try{for(let j=0;j<F.length;j++)F[j]()}finally{P._updating=A}}})(e,_),(function(P){const F=P._updates;if(F.length!==0){const A=F.shift();if(A){const[j,I]=A;Vb(P,j,I)}}})(e)}function _y(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function l8(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&Wt(191),o._flushSync=!0),c&&e._deferred.push(c),y9(e,i.tag)),o==null?Vb(e,a,i):a()}}return n}function Vb(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,y9(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let c=e._pendingEditorState,u=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=v9(c||o),u=!0),c._flushSync=i;const d=Ma,f=So,g=La,p=e._updating;Ma=c,So=!1,e._updating=!0,La=e;const x=e._headless||e.getRootElement()===null;S4(null);try{u&&(x?o._selection!==null&&(c._selection=o._selection.clone()):c._selection=(function(k,_){const N=k.getEditorState()._selection,E=dc(El(k));return Mt(N)||N==null?x4(N,E,k,_):N.clone()})(e,r&&r.event||null));const w=e._compositionKey;t(),a=l8(e,a),(function(k,_){const N=_.getEditorState()._selection,E=k._selection;if(Mt(E)){const P=E.anchor,F=E.focus;let A;if(P.type==="text"&&(A=P.getNode(),A.selectionTransform(N,E)),F.type==="text"){const j=F.getNode();A!==j&&j.selectionTransform(N,E)}}})(c,e),e._dirtyType!==r0&&(a?(function(k,_){const N=_._dirtyLeaves,E=k._nodeMap;for(const P of N){const F=E.get(P);rr(F)&&F.isAttached()&&F.isSimpleText()&&!F.isUnmergeable()&&LP(F)}})(c,e):(function(k,_){const N=_._dirtyLeaves,E=_._dirtyElements,P=k._nodeMap,F=df(),A=new Map;let j=N,I=j.size,L=E,Y=L.size;for(;I>0||Y>0;){if(I>0){_._dirtyLeaves=new Set;for(const Z of j){const ae=P.get(Z);rr(ae)&&ae.isAttached()&&ae.isSimpleText()&&!ae.isUnmergeable()&&LP(ae),ae!==void 0&&i8(ae,F)&&a8(_,ae,A),N.add(Z)}if(j=_._dirtyLeaves,I=j.size,I>0){r_++;continue}}_._dirtyLeaves=new Set,_._dirtyElements=new Map,L.delete("root")&&L.set("root",!0);for(const Z of L){const ae=Z[0],ee=Z[1];if(E.set(ae,ee),!ee)continue;const ne=P.get(ae);ne!==void 0&&i8(ne,F)&&a8(_,ne,A)}j=_._dirtyLeaves,I=j.size,L=_._dirtyElements,Y=L.size,r_++}_._dirtyLeaves=N,_._dirtyElements=E})(c,e),l8(e),(function(k,_,N,E){const P=k._nodeMap,F=_._nodeMap,A=[];for(const[j]of E){const I=F.get(j);I!==void 0&&(I.isAttached()||(wt(I)&&FL(I,j,P,F,A,E),P.has(j)||E.delete(j),A.push(j)))}for(const j of A)F.delete(j);for(const j of N){const I=F.get(j);I===void 0||I.isAttached()||(P.has(j)||N.delete(j),F.delete(j))}})(o,c,e._dirtyLeaves,e._dirtyElements)),w!==e._compositionKey&&(c._flushSync=!0);const C=c._selection;if(Mt(C)){const k=c._nodeMap,_=C.anchor.key,N=C.focus.key;k.get(_)!==void 0&&k.get(N)!==void 0||Wt(19)}else Si(C)&&C._nodes.size===0&&(c._selection=null)}catch(w){return w instanceof Error&&e._onError(w),e._pendingEditorState=o,e._dirtyType=wm,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Lu(e)}finally{Ma=d,So=f,La=g,e._updating=p,r_=0}e._dirtyType!==r0||e._deferred.length>0||(function(w,C){const k=C.getEditorState()._selection,_=w._selection;if(_!==null){if(_.dirty||!_.is(k))return!0}else if(k!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,Lu(e)):u&&sre((()=>{Lu(e)})):(c._flushSync=!1,u&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function $o(e,t,r){La===e&&r===void 0?t():Vb(e,t,r)}class by{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new by(this.element,t,this.after)}withAfter(t){return new by(this.element,this.before,t)}withElement(t){return this.element===t?this:new by(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&Wt(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&Wt(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&Wt(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(vm||Wy);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=c8(r,n);a.push(s);const i=c8(r,this.element);let o=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const u=a[c],d=i[c];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[t.getParentOrThrow(),o]}}function c8(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&Wt(225),r.reverse()}class Di extends Um{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return ute[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=Ss()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(rr(r)&&t.push(r),wt(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;wt(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;wt(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return wt(a)&&a.getLastDescendant()||a||null}const s=r[t];return wt(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:la(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&Wt(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:la(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&Wt(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),wt(a)&&s!==n-1&&!a.isInline()&&(t+=ed)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),wt(a)&&s!==n-1&&!a.isInline()&&(t+=ed.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=jP[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=n0[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return A_(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){li();const n=tr();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(rr(c)||wt(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(rr(c)||wt(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return Mt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):g9(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?jP[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||Wt(226,String(t),String(r),String(a));const o=i.__key,c=[],u=[],d=this.getChildAtIndex(t+r);let f=null,g=a-r+s;if(t!==0)if(t===a)f=this.getLastChild();else{const x=this.getChildAtIndex(t);x!==null&&(f=x.getPreviousSibling())}if(r>0){let x=f===null?this.getFirstChild():f.getNextSibling();for(let v=0;v<r;v++){x===null&&Wt(100);const w=x.getNextSibling(),C=x.__key;Hh(x.getWritable()),u.push(C),x=w}}let p=f;for(let x=0;x<s;x++){const v=n[x];p!==null&&v.is(p)&&(f=p=p.getPreviousSibling());const w=v.getWritable();w.__parent===o&&g--,Hh(w);const C=v.__key;if(p===null)i.__first=C,w.__prev=null;else{const k=p.getWritable();k.__next=C,w.__prev=k.__key}v.__key===o&&Wt(76),w.__parent=o,c.push(C),p=v}if(t+r===a)p!==null&&(p.getWritable().__next=null,i.__last=p.__key);else if(d!==null){const x=d.getWritable();if(p!==null){const v=p.getWritable();x.__prev=p.__key,v.__next=d.__key}else x.__prev=null}if(i.__size=g,u.length){const x=tr();if(Mt(x)){const v=new Set(u),w=new Set(c),{anchor:C,focus:k}=x;u8(C,v,w)&&E_(C,C.getNode(),this,f,d),u8(k,v,w)&&E_(k,k.getNode(),this,f,d),g!==0||this.canBeEmpty()||ro(this)||this.remove()}}return i}getDOMSlot(t){return new by(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function wt(e){return e instanceof Di}function u8(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class v4 extends Um{decorate(t,r){Wt(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function vn(e){return e instanceof v4}class Fv extends Di{static getType(){return"root"}static clone(){return new Fv}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){Wt(51)}getTextContent(){const t=this.__cachedText;return!Pv()&&Ss()._dirtyType!==r0||t===null?super.getTextContent():t}remove(){Wt(52)}replace(t){Wt(53)}insertBefore(t){Wt(54)}insertAfter(t){Wt(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)wt(s)||vn(s)||Wt(282);return super.splice(t,r,n)}static importJSON(t){return ps().updateFromJSON(t)}collapseAtStart(){return!0}}function ba(e){return e instanceof Fv}function v9(e){return new Kb(new Map(e._nodeMap))}function w4(){return new Kb(new Map([["root",new Fv]]))}function w9(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&Wt(130,r.name),wt(e)){const n=t.children;Array.isArray(n)||Wt(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=w9(s[a]);n.push(i)}}return t}class Kb{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return o8(r&&r.editor||null,this,t)}clone(t){const r=new Kb(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return o8(null,this,(()=>({root:w9(ps())})))}}const N_="historic",Xte="history-push",Sy="history-merge",Jte="paste",_9="collaboration",Qte="skip-scroll-into-view",Zte="skip-dom-selection";class _4 extends Di{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Ov extends Di{static getType(){return"paragraph"}static clone(t){return new Ov(t.__key)}createDOM(t){const r=document.createElement("p"),n=om(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:ere,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return ss().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=ss();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||rr(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function ere(e){const t=ss();return e.style&&(t.setFormat(e.style.textAlign),O4(e,t)),{node:t}}function ss(){return ao(new Ov)}function b4(e){return e instanceof Ov}const fn=0,Wg=1,tre=4;function b9(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=w4(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=r0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function rre(e){const t=e||{},r=qte(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=w4(),o=t.namespace||(s!==null?s._config.namespace:j9()),c=t.editorState,u=[Fv,Df,Av,jv,Ov,_4,...t.nodes||[]],{onError:d,html:f}=t,g=t.editable===void 0||t.editable;let p;if(e===void 0&&r!==null)p=r._nodes;else{p=new Map;for(let v=0;v<u.length;v++){let w=u[v],C=null,k=null;if(typeof w!="function"){const F=w;w=F.replace,C=F.with,k=F.withKlass||null}const{ownNodeConfig:_}=D4(w),N=w.getType(),E=w.transform(),P=new Set;_&&_.$transform&&P.add(_.$transform),E!==null&&P.add(E),p.set(N,{exportDOM:f&&f.export?f.export.get(w):void 0,klass:w,replace:C,replaceWithKlass:k,sharedNodeState:yte(u[v]),transforms:P})}}const x=new qb(i,s,p,{disableEvents:a,namespace:o,theme:n},d||console.error,(function(v,w){const C=new Map,k=new Set,_=N=>{Object.keys(N).forEach((E=>{let P=C.get(E);P===void 0&&(P=[],C.set(E,P)),P.push(N[E])}))};return v.forEach((N=>{const E=N.klass.importDOM;if(E==null||k.has(E))return;k.add(E);const P=E.call(N.klass);P!==null&&_(P)})),w&&_(w),C})(p,f?f.import:void 0),g,e);return c!==void 0&&(x._pendingEditorState=c,x._dirtyType=wm),x}class qb{constructor(t,r,n,s,a,i,o,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=r0,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=j9(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&Wt(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&Wt(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&Wt(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=v8(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const c=v8(i.getEditorState()),u=[];for(const d of o){const f=c.get(d);f&&u.push(f)}u.length!==0&&i.update((()=>{for(const d of u)for(const f of d.keys()){const g=la(f);g&&g.markDirty()}}),i._pendingEditorState===null?{tag:Sy}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return ur(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=om(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,b9(this,r,t,s),r!==null&&(this._config.disableEvents||Rte(r),n!=null&&r.classList.remove(...n)),t!==null){const a=P4(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=wm,IL(this),this._updateTags.add(Sy),Lu(this),this._config.disableEvents||(function(o,c){const u=o.ownerDocument,d=C_.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",c9),C_.set(u,(d||0)+1),o.__lexicalEditor=c;const f=l9(o);for(let g=0;g<HT.length;g++){const[p,x]=HT[g],v=typeof x=="function"?w=>{GP(w)||(HP(w),(c.isEditable()||p==="click")&&x(w,c))}:w=>{if(GP(w))return;HP(w);const C=c.isEditable();switch(p){case"cut":return C&&ur(c,g4,w);case"copy":return ur(c,zb,w);case"paste":return C&&ur(c,d4,w);case"dragstart":return C&&ur(c,e9,w);case"dragover":return C&&ur(c,t9,w);case"dragend":return C&&ur(c,jte,w);case"focus":return C&&ur(c,Ote,w);case"blur":return C&&ur(c,Dte,w);case"drop":return C&&ur(c,QL,w)}};o.addEventListener(p,v),f.push((()=>{o.removeEventListener(p,v)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Sy),Lu(this);_y("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&Wt(38);let n=t;n._readOnly&&(n=v9(t),n._selection=t._selection?t._selection.clone():null),DL(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),Lu(this)),this._pendingEditorState=n,this._dirtyType=wm,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||Lu(this)}parseEditorState(t,r){return(function(n,s,a){const i=w4(),o=Ma,c=So,u=La,d=s._dirtyElements,f=s._dirtyLeaves,g=s._cloneNotNeeded,p=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,Ma=i,So=!1,La=s,S4(null);try{const x=s._nodes;y4(n.root,x),a&&a(),i._readOnly=!0}catch(x){x instanceof Error&&s._onError(x)}finally{s._dirtyElements=d,s._dirtyLeaves=f,s._cloneNotNeeded=g,s._dirtyType=p,Ma=o,So=c,La=u}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return Lu(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):Vb(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),$o(this,(()=>{const s=tr(),a=ps();s!==null?s.dirty||hi(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),cre("focus"),ure((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=dc(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,_y("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}qb.version="0.35.0+prod.esm";let XT=null;function S4(e){XT=e}let nre=1;function S9(e,t){const r=k4(e,t);return r===void 0&&Wt(30,t),r}function k4(e,t){return e._nodes.get(t)}const sre=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function d8(e){return vn(kf(e))}function C4(e){const t=document.activeElement;if(!as(t))return!1;const r=t.nodeName;return vn(kf(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&Yb(t)==null)}function Dv(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!C4(t)&&k9(t)===e}catch{return!1}}function T4(e){return e instanceof qb}function k9(e){let t=e;for(;t!=null;){const r=Yb(t);if(T4(r))return r;t=Iv(t)}return null}function Yb(e){return e?e.__lexicalEditor:null}function Wh(e){return Wb(e)||e.isToken()}function Ru(e){return Wh(e)||e.isSegmented()}function ld(e){return Hm(e)&&e.nodeType===tte}function are(e){return Hm(e)&&e.nodeType===rte}function _m(e){let t=e;for(;t!=null;){if(ld(t))return t;t=t.firstChild}return null}function A_(e,t,r){const n=n0[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function C9(e){return rr(e)||Vu(e)||vn(e)}function ire(e,t){const r=(function(){const i=XT;return XT=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);li(),p9();const n=Ss(),s=If(),a=""+nre++;s._nodeMap.set(a,e),wt(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=PL,e.__key=a}function Hh(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,c=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),c!==null&&(c.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function j_(e){p9();const t=e.getLatest(),r=t.__parent,n=If(),s=Ss(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,u,d){let f=c;for(;f!==null;){if(d.has(f))return;const g=u.get(f);if(g===void 0)break;d.set(f,!1),f=g.__parent}})(r,a,i);const o=t.__key;s._dirtyType=PL,wt(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function ci(e){li();const t=Ss(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=la(r);n!==null&&n.getWritable()}if(e!==null){const n=la(e);n!==null&&n.getWritable()}}}function df(){return Pv()?null:Ss()._compositionKey}function la(e,t){const r=(t||If())._nodeMap.get(e);return r===void 0?null:r}function T9(e,t){const r=Xb(e,Ss());return r!==void 0?la(r,t):null}function Xb(e,t){return e[`__lexicalKey_${t._key}`]}function kf(e,t){let r=e;for(;r!=null;){const n=T9(r,t);if(n!==null)return n;r=Iv(r)}return null}function E9(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function f8(e){return e.read((()=>ps().getTextContent()))}function ps(){return N9(If())}function N9(e){return e._nodeMap.get("root")}function hi(e){li();const t=If();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Zg(e){const t=Ss(),r=(function(n,s){let a=n;for(;a!=null;){const i=Xb(a,s);if(i!==void 0)return i;a=Iv(a)}return null})(e,t);return r===null?e===t.getRootElement()?la("root"):null:la(r)}function A9(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function E4(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function j9(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function P9(e){return ld(e)?e.nodeValue:null}function N4(e,t,r){const n=dc(El(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=P9(s);const c=kf(s);if(o!==null&&rr(c)){if(o===$b&&r){const u=r.length;o=r,a=u,i=u}o!==null&&A4(c,o,a,i,e)}}}function A4(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===$b&&(o=t.slice(0,-1));const c=a.getTextContent();if(s||o!==c){if(o===""){if(ci(null),Wy||vm||p_)a.remove();else{const v=Ss();setTimeout((()=>{v.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const u=a.getParent(),d=Wm(),f=a.getTextContentSize(),g=df(),p=a.getKey();if(a.isToken()||g!==null&&p===g&&!i||Mt(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===e.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===e.__key&&d.focus.offset===f&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const x=tr();if(!Mt(x)||r===null||n===null)return void h8(a,o,x);if(x.setTextNodeRange(a,r,a,n),a.isSegmented()){const v=Ps(a.getTextContent());a.replace(v),a=v}h8(a,o,x)}}}function h8(e,t,r){if(e.setTextContent(t),Mt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=yf(e,a.offset,"clamp"))}}}function yw(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function ore(e,t){return yw(e,t,"altKey")&&yw(e,t,"ctrlKey")&&yw(e,t,"shiftKey")&&yw(e,t,"metaKey")}function Pn(e,t,r){return ore(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const Iu={ctrlKey:!Uc,metaKey:Uc},g8={altKey:Uc,ctrlKey:!Uc};function m8(e){return e.key==="Backspace"}function p8(e){return Pn(e,"a",Iu)}function lre(e){const t=ps();if(Mt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),v_(e),e}{const r=t.select(0,t.getChildrenSize());return hi(v_(r)),r}}function om(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=jL(s);return r[t]=a,a}return s}function j4(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&Wt(33,a);const c=o.klass;let u=e.get(c);u===void 0&&(u=new Map,e.set(c,u));const d=u.get(i),f=d==="destroyed"&&s==="created";(d===void 0||f)&&u.set(i,f?"updated":s)}function x8(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function JT(e,t){const r=e.offset;if(e.type==="element")return x8(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?x8(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function F9(e){const t=El(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function ur(e,t,r){return(function(n,s,a){const i=E4(n);for(let o=4;o>=0;o--)for(let c=0;c<i.length;c++){const u=i[c],d=u._commands.get(s);if(d!==void 0){const f=d[o];if(f!==void 0){const g=Array.from(f),p=g.length;let x=!1;if($o(u,(()=>{for(let v=0;v<p;v++)if(g[v](a,n))return void(x=!0)})),x)return x}}}return!1})(e,t,r)}function Jb(e){return!ba(e)&&!e.isLastChild()&&!e.isInline()}function i0(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&Wt(75,t),r}function Iv(e){const t=e.assignedSlot||e.parentElement;return eE(t)?t.host:t}function O9(e){return are(e)?e:as(e)?e.ownerDocument:null}function cre(e){li(),Ss()._updateTags.add(e)}function ure(e){li(),Ss()._deferred.push(e)}function QT(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function P4(e){const t=O9(e);return t?t.defaultView:null}function El(e){const t=e._window;return t===null&&Wt(78),t}function dre(e){return wt(e)&&e.isInline()||vn(e)&&e.isInline()}function fre(e){let t=e.getParentOrThrow();for(;t!==null;){if(ro(t))return t;t=t.getParentOrThrow()}return t}function ro(e){return ba(e)||wt(e)&&e.isShadowRoot()}function ao(e){const t=Ss(),r=e.getType(),n=k4(t,r);n===void 0&&Wt(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||Wt(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||Wt(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&Wt(203,e.constructor.name,r,o.name,o.getType()),i}return e}function lk(e,t){!ba(e.getParent())||wt(t)||vn(t)||Wt(99)}function hre(e){const t=la(e);return t===null&&Wt(63,e),t}function ck(e){return(vn(e)||wt(e)&&!e.canBeEmpty())&&!e.isInline()}function ZT(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function dc(e){return hc?(e||window).getSelection():null}function gre(e){const t=P4(e);return t?t.getSelection():null}function D9(e){return as(e)&&e.tagName==="A"}function as(e){return Hm(e)&&e.nodeType===ete}function Hm(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function eE(e){return Hm(e)&&e.nodeType===nte}function tE(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function P_(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function _l(e){if(vn(e)&&!e.isInline())return!0;if(!wt(e)||ro(e))return!1;const t=e.getFirstChild(),r=t===null||Vu(t)||rr(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function uk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Rv(){return Ss()}const y8=new WeakMap,mre=new Map;function v8(e){if(!e._readOnly&&e.isEmpty())return mre;e._readOnly||Wt(192);let t=y8.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),y8.set(e,t)),t}function F4(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function O4(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function pre(e){e.__lexicalUnmanaged=!0}function xre(e){return e.__lexicalUnmanaged===!0}function Vx(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==Um[t]}function D4(e){const t=PP in e.prototype?e.prototype[PP]():void 0,r=(function(i){return i===v4||i===Di||i===Um})(e),n=!r&&Vx(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(Vx(e,"getType")||(e.getType=()=>a),Vx(e,"clone")||(e.clone=i=>(S4(i),new e)),Vx(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!Vx(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function yre(e){const t=Rv();return li(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const vre={next:"previous",previous:"next"};class I4{constructor(t){this.origin=t}[Symbol.iterator](){return $4({hasNext:c0,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return fi(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return fi(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let c=a.getAdjacentCaret();c!==null&&o.size<t;c=c.getAdjacentCaret()){const u=c.origin.getWritable();o.set(u.getKey(),u)}for(const c of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(c.getKey()),!(u.is(c)||a.origin.is(c))){const d=c.getParent();d&&d.is(i)&&c.remove(),u.replace(c)}}else u===null&&Wt(263,Array.from(o).join(" "))}else a.insert(c);a=fi(c,this.direction)}for(const c of o.values())c.remove();return this}}class Yy extends I4{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Nl(t,this.direction)}getParentCaret(t="root"){return fi(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Gm(this.direction);return fi(this.getNodeAtCaret(),t)||Nl(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof Yy&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const wre={root:ba,shadowRoot:ro};function Gm(e){return vre[e]}function R4(e,t="root"){return wre[t](e)?null:e}class o0 extends I4{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:fi(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return wt(this.origin)?Nl(this.origin,this.direction):null}getParentCaret(t="root"){return fi(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=Gm(this.direction);return fi(this.getNodeAtCaret(),t)||Nl(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof o0&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof o0||t instanceof l0)&&this.direction===t.direction&&this.origin.is(t.origin)}}class l0 extends I4{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:u0(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return fi(R4(this.getParentAtCaret(),t),this.direction)}getFlipped(){return u0(this.origin,Gm(this.direction),this.offset)}isSamePointCaret(t){return t instanceof l0&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof o0||t instanceof l0)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return fi(this.origin,this.direction)}}function xf(e){return e instanceof l0}function c0(e){return e instanceof o0}function Yc(e){return e instanceof Yy}const _re={next:class extends l0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends l0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},bre={next:class extends o0{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends o0{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},Sre={next:class extends Yy{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends Yy{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function fi(e,t){return e?new bre[t](e):null}function u0(e,t,r){return e?new _re[t](e,yf(e,r)):null}function yf(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const u of i)c.append("v",u);o.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function w8(e,t){return new Cre(e,t)}function Nl(e,t){return wt(e)?new Sre[t](e):null}function kre(e){return e&&e.getChildCaret()||e}function M4(e){return e&&kre(e.getAdjacentCaret())}class L4{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new L4(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return xf(a)?(function(i,o){const{direction:c,origin:u}=i,d=yf(u,o==="focus"?Gm(c):c);return w8(i,d-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[w8(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=xf(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=xf(n),a=i=>i.isSameNodeCaret(n)?null:M4(i)||i.getParentCaret(t);return $4({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class Cre{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return u0(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function B4(e){return Cf(e,fi(ps(),e.direction))}function Tre(e){return Cf(e,e)}function Cf(e,t){return e.direction!==t.direction&&Wt(265),new L4(e,t,e.direction)}function $4(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function I9(e,t){const r=n_(e.origin,t.origin);switch(r===null&&Wt(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return R9(r)}}function R9(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function vw(e,t){return t.is(e)}function _8(e){return wt(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function n_(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=_8(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=_8(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(vw(e,n)||Wt(276),{commonAncestor:n,type:"ancestor"}):s===null?(vw(t,n)||Wt(277),{commonAncestor:n,type:"descendant"}):((wt(a)||vw(e,a))&&(wt(s)||vw(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||Wt(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function td(e,t){const{type:r,key:n,offset:s}=e,a=hre(e.key);return r==="text"?(rr(a)||Wt(266,a.getType(),n),u0(a,t,s)):(wt(a)||Wt(267,a.getType(),n),Are(a,e.offset,t))}function d0(e,t){const{origin:r,direction:n}=t,s=n==="next";xf(t)?e.set(r.getKey(),t.offset,"text"):c0(t)?rr(r)?e.set(r.getKey(),yf(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Yc(t)&&wt(r)||Wt(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function Ere(e){const t=tr(),r=Mt(t)?t:Gb();return s_(r,e),hi(r),r}function s_(e,t){d0(e.anchor,t.anchor),d0(e.focus,t.focus)}function b8(e){const{anchor:t,focus:r}=e,n=td(t,"next"),s=td(r,"next"),a=I9(n,s)<=0?"next":"previous";return Cf(bm(n,a),bm(s,a))}function U4(e){const{direction:t,origin:r}=e,n=fi(r,Gm(t)).getNodeAtCaret();return n?fi(n,t):Nl(r.getParentOrThrow(),t)}function S8(e,t="root"){const r=[e];for(let n=Yc(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(U4(n));return r}function dk(e){return!!e&&e.origin.isAttached()}function Nre(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=L9(e,n),i=S8(a.anchor,r),o=S8(a.focus.getFlipped(),r),c=new Set,u=[];for(const x of a.iterNodeCarets(r))if(Yc(x))c.add(x.origin.getKey());else if(c0(x)){const{origin:v}=x;wt(v)&&!c.has(v.getKey())||u.push(v)}for(const x of u)x.remove();for(const x of a.getTextSlices()){if(!x)continue;const{origin:v}=x.caret,w=v.getTextContentSize(),C=U4(fi(v,n)),k=v.getMode();if(Math.abs(x.distance)===w&&s==="removeEmptySlices"||k==="token"&&x.distance!==0)C.remove();else if(x.distance!==0){s="removeEmptySlices";let _=x.removeTextSlice();const N=x.caret.origin;if(k==="segmented"){const E=_.origin,P=Ps(E.getTextContent()).setStyle(E.getStyle()).setFormat(E.getFormat());C.replaceOrInsert(P),_=u0(P,n,_.offset)}N.is(i[0].origin)&&(i[0]=_),N.is(o[0].origin)&&(o[0]=_.getFlipped())}}let d,f;for(const x of i)if(dk(x)){d=bl(x);break}for(const x of o)if(dk(x)){f=bl(x);break}const g=(function(x,v,w){if(!x||!v)return null;const C=x.getParentAtCaret(),k=v.getParentAtCaret();if(!C||!k)return null;const _=C.getParents().reverse();_.push(C);const N=k.getParents().reverse();N.push(k);const E=Math.min(_.length,N.length);let P;for(P=0;P<E&&_[P]===N[P];P++);const F=(I,L)=>{let Y;for(let Z=P;Z<I.length;Z++){const ae=I[Z];if(ro(ae))return;!Y&&L(ae)&&(Y=ae)}return Y},A=F(_,_l),j=A&&F(N,(I=>w.has(I.getKey())&&_l(I)));return A&&j?[A,j]:null})(d,f,c);if(g){const[x,v]=g;Nl(x,"previous").splice(0,v.getChildren()),v.remove()}const p=[d,f,...i,...o].find(dk);if(p)return Tre(bm(bl(p),e.direction));Wt(269,JSON.stringify(i.map((x=>x.origin.__key))))}function bl(e){const t=(function(s){let a=s;for(;Yc(a);){const i=M4(a);if(!Yc(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(rr(t.origin))return xf(t)?t:u0(t.origin,r,r);const n=t.getAdjacentCaret();return c0(n)&&rr(n.origin)?u0(n.origin,r,Gm(r)):t}function M9(e){return xf(e)&&e.offset!==yf(e.origin,e.direction)}function bm(e,t){return e.direction===t?e:e.getFlipped()}function L9(e,t){return e.direction===t?e:Cf(bm(e.focus,t),bm(e.anchor,t))}function Are(e,t,r){let n=Nl(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return bm(n,r)}const B9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,jre=B9?S.useLayoutEffect:S.useEffect,ww={tag:Sy};function $9({initialConfig:e,children:t}){const r=S.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:c}=e,u=Jee(null,n),d=rre({editable:e.editable,html:c,namespace:s,nodes:a,onError:f=>i(f,d),theme:n});return(function(f,g){if(g!==null){if(g===void 0)f.update((()=>{const p=ps();if(p.isEmpty()){const x=ss();p.append(x);const v=B9?document.activeElement:null;(tr()!==null||v!==null&&v===f.getRootElement())&&x.select()}}),ww);else if(g!==null)switch(typeof g){case"string":{const p=f.parseEditorState(g);f.setEditorState(p,ww);break}case"object":f.setEditorState(g,ww);break;case"function":f.update((()=>{ps().isEmpty()&&g(f)}),ww)}}})(d,o),[d,u]}),[]);return jre((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),l.jsx($m.Provider,{value:r,children:t})}const Pre=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function Fre(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function Ore(){return(function(e){const[t]=tu(),r=S.useMemo((()=>e(t)),[t,e]),[n,s]=S.useState((()=>r.initialValueFn())),a=S.useRef(n);return Pre((()=>{const{initialValueFn:i,subscribe:o}=r,c=i();return a.current!==c&&(a.current=c,s(c)),o((u=>{a.current=u,s(u)}))}),[r,e]),n})(Fre)}function Dre(){return ps().getTextContent()}function Ire(e,t=!0){if(e)return!1;let r=Dre();return t&&(r=r.trim()),r===""}function Rre(e){if(!Ire(e,!1))return!1;const t=ps().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(vn(s))return!1;if(wt(s)){if(!b4(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const c=a[n];if(!rr(c))return!1}}}return!0}function U9(e){return()=>Rre(e)}const rE=new Map;function z9(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function k8(e){let t=rE.get(e);return t===void 0&&(t=z9(e),rE.set(e,t)),t}function W9(e){const t=Rv().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function H9(e){return W9(ba(e)?e:e.getParentOrThrow())}function C8(e){const t=H9(e);return t!==null&&t.direction==="rtl"}function G9(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!Ru(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),c=t.is(i),u=t.is(o);if(c||u){const[d,f]=qT(e),g=i.is(o),p=t.is(a?o:i),x=t.is(a?i:o);let v,w=0;g?(w=d>f?f:d,v=d>f?d:f):p?(w=a?f:d,v=void 0):x&&(w=0,v=a?d:f),t.__text=t.__text.slice(w,v)}}return t}function Mre(e){const t=e.getStyle(),r=z9(t);rE.set(t,r)}function Lre(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function lm(e,t,r=Lre){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=Gb(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const c=fk(i.getNode(),_l),u=fk(o.getNode(),_l);wt(c)&&s.set(c.getKey(),c),wt(u)&&s.set(u.getKey(),u)}for(const i of e.getNodes())if(wt(i)&&_l(i))s.set(i.getKey(),i);else if(n===null){const o=fk(i,_l);wt(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const c=t();r(o,c),o.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is(tr())&&hi(a)}function V9(e){const t=K9(e);return t!==null&&t.writingMode==="vertical-rl"}function K9(e){const t=e.anchor.getNode();return wt(t)?W9(t):H9(t)}function T8(e,t){let r=V9(e)?!t:t;q9(e)&&(r=!r);const n=td(e.focus,r?"previous":"next");if(M9(n))return!1;for(const s of B4(n)){if(Yc(s))return!s.origin.isInline();if(!wt(s.origin)){if(vn(s.origin))return!0;break}}return!1}function Bre(e,t,r,n){e.modify(t?"extend":"move",r,n)}function q9(e){const t=K9(e);return t!==null&&t.direction==="rtl"}function E8(e,t,r){const n=q9(e);let s;s=V9(e)||n?!r:r,Bre(e,t,s,"character")}function fk(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function $re(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Y9=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Ure=Y9&&"documentMode"in document?document.documentMode:null;!(!Y9||!("InputEvent"in window)||Ure)&&"getTargetRanges"in new window.InputEvent("input");function X9(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function T0(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function wa(e,...t){const r=X9(...t);r.length>0&&e.classList.add(...r)}function vf(e,...t){const r=X9(...t);r.length>0&&e.classList.remove(...r)}function zre(e){return e?e.getAdjacentCaret():null}function Wre(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function Hre(e){const t=Qb(e,(r=>wt(r)&&!r.isInline()));return wt(t)||$re(4,e.__key),t}const Qb=(e,t)=>{let r=e;for(;r!==ps()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function Oh(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function J9(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(wt(s))for(const a of Gre(s))n.push(a);return r}function Gre(e){return Vre(Nl(e,"previous"))}function Vre(e){return $4({hasNext:c0,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function Kre(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const c=o.args;if(c){const[u,d,f,g,p,x]=c;e.update((()=>{const v=tr();if(Mt(v)){const w=v.anchor;let C=w.getNode(),k=0,_=0;if(rr(C)&&u>=0&&d>=0&&(k=u,_=u+d,v.setTextNodeRange(C,k,C,_)),k===_&&f===""||(v.insertRawText(f),C=w.getNode()),rr(C)){k=g,_=g+p;const N=C.getTextContentSize();k=k>N?N:k,_=_>N?N:_,v.setTextNodeRange(C,k,C,_)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function qre(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!Z9.has(i.nodeName)){const o=eB(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof _4&&i.insertAfter(Jc());for(const i of a){const o=i.getChildren();for(const c of o)i.insertBefore(c);i.remove()}})(s),n}function Yre(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=ps().getChildren();for(let s=0;s<n.length;s++)Q9(e,n[s],r,t);return r.innerHTML}function Q9(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=wt(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let p=F4(t);p=rr(p)&&n!==null?G9(n,p):p,i=p}const o=wt(i)?i.getChildren():[],c=k4(e,i.getType());let u;u=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:d,after:f}=u;if(!d)return!1;const g=document.createDocumentFragment();for(let p=0;p<o.length;p++){const x=o[p],v=Q9(e,x,g,n);!s&&wt(t)&&v&&t.extractWithChild(x,n,"html")&&(s=!0)}if(s&&!a){if((as(d)||eE(d))&&d.append(g),r.append(d),f){const p=f.call(i,d);p&&(eE(d)?d.replaceChildren(p):d.replaceWith(p))}}else r.append(g);return s}const Z9=new Set(["STYLE","SCRIPT"]);function eB(e,t,r,n,s=new Map,a){let i=[];if(Z9.has(e.nodeName))return i;let o=null;const c=(function(x,v){const{nodeName:w}=x,C=v._htmlConversions.get(w.toLowerCase());let k=null;if(C!==void 0)for(const _ of C){const N=_(x);N!==null&&(k===null||(k.priority||0)<=(N.priority||0))&&(k=N)}return k!==null?k.conversion:null})(e,t),u=c?c(e):null;let d=null;if(u!==null){d=u.after;const x=u.node;if(o=Array.isArray(x)?x[x.length-1]:x,o!==null){for(const[,v]of s)if(o=v(o,a),!o)break;o&&i.push(...Array.isArray(x)?x:[o])}u.forChild!=null&&s.set(e.nodeName,u.forChild)}const f=e.childNodes;let g=[];const p=(o==null||!ro(o))&&(o!=null&&YT(o)||n);for(let x=0;x<f.length;x++)g.push(...eB(f[x],t,r,p,new Map(s),o));return d!=null&&(g=d(g)),P_(e)&&(g=Xre(e,g,p?()=>{const x=new _4;return r.push(x),x}:ss)),o==null?g.length>0?i=i.concat(g):P_(e)&&(function(x){return x.nextSibling==null||x.previousSibling==null?!1:tE(x.nextSibling)&&tE(x.previousSibling)})(e)&&(i=i.concat(Jc())):wt(o)&&o.append(...g),i}function Xre(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(YT(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&YT(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function F_(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function Jre(e,t=tr()){return t==null&&F_(166),Mt(t)&&t.isCollapsed()||t.getNodes().length===0?"":Yre(e,t)}function Qre(e,t=tr()){return t==null&&F_(166),Mt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(Zre(e,t))}function N8(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return A8(r,ene(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(c):c})(s),"text/html");return A8(r,qre(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Mt(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let c=0;c<o.length;c++){const u=tr();if(Mt(u)){const d=o[c];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([zm()]):u.insertText(d)}}}else t.insertRawText(i)}function A8(e,t,r){e.dispatchCommand(kte,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Mt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=td(s,"previous");if(i)if(xf(i))a=i.origin;else{const o=Cf(i,Nl(ps(),"next").getFlipped());for(const c of o){if(rr(c.origin)){a=c.origin;break}if(wt(c.origin)&&!c.origin.isInline())break}}if(a&&rr(a)){const o=a.getFormat(),c=a.getStyle();n.format===o&&n.style===c||(n.format=o,n.style=c,n.dirty=!0)}}})(r))}function tB(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=wt(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let u=F4(r);u=rr(u)&&t!==null?G9(t,u):u,i=u}const o=wt(i)?i.getChildren():[],c=(function(u){const d=u.exportJSON(),f=u.constructor;if(d.type!==f.getType()&&F_(58,f.name),wt(u)){const g=d.children;Array.isArray(g)||F_(59,f.name)}return d})(i);if(rr(i)){const u=i.__text;u.length>0?c.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],f=tB(e,t,d,c.children);!s&&wt(r)&&f&&r.extractWithChild(d,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let u=0;u<c.children.length;u++){const d=c.children[u];n.push(d)}return s}function Zre(e,t){const r=[],n=ps().getChildren();for(let s=0;s<n.length;s++)tB(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function ene(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=Yte(n);rr(s)&&Mre(s),t.push(s)}return t}let Og=null;async function j8(e,t,r){if(Og!==null)return!1;if(t!==null)return new Promise(((u,d)=>{e.update((()=>{u(P8(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=dc(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const c=new Range;return c.setStart(o,0),c.setEnd(o,1),i.removeAllRanges(),i.addRange(c),new Promise(((u,d)=>{const f=e.registerCommand(zb,(g=>(Oh(g,ClipboardEvent)&&(f(),Og!==null&&(window.clearTimeout(Og),Og=null),u(P8(e,g,r))),!0)),tre);Og=window.setTimeout((()=>{f(),Og=null,u(!1)}),50),a.execCommand("copy"),o.remove()}))}function P8(e,t,r){if(r===void 0){const s=dc(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Dv(e,a,i))return!1;const o=tr();if(o===null)return!1;r=rne(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(nne(n,r),!0)}const tne=[["text/html",Jre],["application/x-lexical-editor",Qre]];function rne(e=tr()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=Rv();for(const[n,s]of tne){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function nne(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function F8(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const Vm=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,sne=Vm&&"documentMode"in document?document.documentMode:null,ane=!(!Vm||!("InputEvent"in window)||sne)&&"getTargetRanges"in new window.InputEvent("input"),ine=Vm&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),O8=Vm&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,one=Vm&&/^(?=.*Chrome).*/i.test(navigator.userAgent),lne=Vm&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!one,D8=Or("DRAG_DROP_PASTE_FILE");let Mv=class rB extends Di{static getType(){return"quote"}static clone(t){return new rB(t.__key)}createDOM(t){const r=document.createElement("blockquote");return wa(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:cne,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Lv().updateFromJSON(t)}insertNewAfter(t,r){const n=ss(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=ss();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function Lv(){return ao(new Mv)}function I8(e){return e instanceof Mv}let Bv=class nB extends Di{static getType(){return"heading"}static clone(t){return new nB(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];wa(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Dg,priority:0}),h2:t=>({conversion:Dg,priority:0}),h3:t=>({conversion:Dg,priority:0}),h4:t=>({conversion:Dg,priority:0}),h5:t=>({conversion:Dg,priority:0}),h6:t=>({conversion:Dg,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&R8(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>R8(t)?{conversion:r=>({node:ff("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(as(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return ff(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?ss():ff(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=ss();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?ss():ff(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function R8(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Dg(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=ff(t),e.style!==null&&(O4(e,r),r.setFormat(e.style.textAlign))),{node:r}}function cne(e){const t=Lv();return e.style!==null&&(t.setFormat(e.style.textAlign),O4(e,t)),{node:t}}function ff(e="h1"){return ao(new Bv(e))}function une(e){return e instanceof Bv}function _w(e){let t=null;if(Oh(e,DragEvent)?t=e.dataTransfer:Oh(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function M8(e){const t=tr();if(!Mt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=Qb(a,(u=>wt(u)&&!u.isInline()));if(o===null)continue;const c=o.getKey();o.canIndent()&&!r.has(c)&&(r.add(c),e(o))}return r.size>0}function L8(e){const t=kf(e);return vn(t)}function hk(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function dne(e){return T0(e.registerCommand(u4,(t=>{const r=tr();return!!Si(r)&&(r.clear(),!0)}),fn),e.registerCommand(zh,(t=>{const r=tr();return Mt(r)?(r.deleteCharacter(t),!0):!!Si(r)&&(r.deleteNodes(),!0)}),fn),e.registerCommand(Ky,(t=>{const r=tr();return!!Mt(r)&&(r.deleteWord(t),!0)}),fn),e.registerCommand(qy,(t=>{const r=tr();return!!Mt(r)&&(r.deleteLine(t),!0)}),fn),e.registerCommand(am,(t=>{const r=tr();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)N8(n,r,e);else if(Mt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),fn),e.registerCommand(UT,(()=>{const t=tr();return!!Mt(t)&&(t.removeText(),!0)}),fn),e.registerCommand(Pi,(t=>{const r=tr();return!!Mt(r)&&(r.formatText(t),!0)}),fn),e.registerCommand(ZL,(t=>{const r=tr();if(!Mt(r)&&!Si(r))return!1;const n=r.getNodes();for(const s of n){const a=Qb(s,(i=>wt(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),fn),e.registerCommand(sm,(t=>{const r=tr();return!!Mt(r)&&(r.insertLineBreak(t),!0)}),fn),e.registerCommand(Vy,(()=>{const t=tr();return!!Mt(t)&&(t.insertParagraph(),!0)}),fn),e.registerCommand(Nte,(()=>(Vte([zm()]),!0)),fn),e.registerCommand(Ate,(()=>M8((t=>{const r=t.getIndent();t.setIndent(r+1)}))),fn),e.registerCommand(UP,(()=>M8((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),fn),e.registerCommand(GL,(t=>{const r=tr();if(Si(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Mt(r)){const n=JT(r.focus,!0);if(!t.shiftKey&&vn(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),fn),e.registerCommand(VL,(t=>{const r=tr();if(Si(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Mt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===ps().getChildrenSize()})(r))return t.preventDefault(),!0;const n=JT(r.focus,!1);if(!t.shiftKey&&vn(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),fn),e.registerCommand(HL,(t=>{const r=tr();if(Si(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),C8(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Mt(r))return!1;if(T8(r,!0)){const n=t.shiftKey;return t.preventDefault(),E8(r,n,!0),!0}return!1}),fn),e.registerCommand(WL,(t=>{const r=tr();if(Si(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),C8(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Mt(r))return!1;const n=t.shiftKey;return!!T8(r,!1)&&(t.preventDefault(),E8(r,n,!1),!0)}),fn),e.registerCommand(qL,(t=>{if(L8(t.target))return!1;const r=tr();if(Mt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(ba(a))return!1;const i=Hre(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(UP,void 0);if(O8&&navigator.language==="ko-KR")return!1}else if(!Si(r))return!1;return t.preventDefault(),e.dispatchCommand(zh,!0)}),fn),e.registerCommand(XL,(t=>{if(L8(t.target))return!1;const r=tr();return!(!Mt(r)&&!Si(r))&&(t.preventDefault(),e.dispatchCommand(zh,!1))}),fn),e.registerCommand(k_,(t=>{const r=tr();if(!Mt(r))return!1;if(hk(r),t!==null){if((O8||ine||lne)&&ane)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(sm,!1)}return e.dispatchCommand(Vy,void 0)}),fn),e.registerCommand(YL,(()=>{const t=tr();return!!Mt(t)&&(e.blur(),!0)}),fn),e.registerCommand(QL,(t=>{const[,r]=_w(t);if(r.length>0){const s=F8(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=kf(i);if(o!==null){const c=Gb();if(rr(o))c.anchor.set(o.getKey(),a,"text"),c.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),f=o.getIndexWithinParent()+1;c.anchor.set(d,f,"element"),c.focus.set(d,f,"element")}const u=v_(c);hi(u)}e.dispatchCommand(D8,r)}return t.preventDefault(),!0}const n=tr();return!!Mt(n)}),fn),e.registerCommand(e9,(t=>{const[r]=_w(t),n=tr();return!(r&&!Mt(n))}),fn),e.registerCommand(t9,(t=>{const[r]=_w(t),n=tr();if(r&&!Mt(n))return!1;const s=F8(t.clientX,t.clientY);if(s!==null){const a=kf(s.node);vn(a)&&t.preventDefault()}return!0}),fn),e.registerCommand(zT,(()=>(lre(),!0)),fn),e.registerCommand(zb,(t=>(j8(e,Oh(t,ClipboardEvent)?t:null),!0)),fn),e.registerCommand(g4,(t=>((async function(r,n){await j8(n,Oh(r,ClipboardEvent)?r:null),n.update((()=>{const s=tr();Mt(s)?s.removeText():Si(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),fn),e.registerCommand(d4,(t=>{const[,r,n]=_w(t);return r.length>0&&!n?(e.dispatchCommand(D8,r),!0):Hm(t.target)&&C4(t.target)?!1:tr()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=tr(),o=Oh(s,InputEvent)||Oh(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&N8(o,i,a)}),{tag:Jte})})(t,e),!0)}),fn),e.registerCommand(KL,(t=>{const r=tr();return Mt(r)&&hk(r),!1}),fn),e.registerCommand(JL,(t=>{const r=tr();return Mt(r)&&hk(r),!1}),fn))}const nE=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function B8(e){return e.getEditorState().read(U9(e.isComposing()))}function sB({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=tu(),s=(function(a,i){const[o,c]=S.useState((()=>a.getDecorators()));return nE((()=>a.registerDecoratorListener((u=>{iT.flushSync((()=>{c(u)}))}))),[a]),S.useEffect((()=>{c(a.getDecorators())}),[a]),S.useMemo((()=>{const u=[],d=Object.keys(o);for(let f=0;f<d.length;f++){const g=d[f],p=l.jsx(i,{onError:v=>a._onError(v),children:l.jsx(S.Suspense,{fallback:null,children:o[g]})}),x=a.getElementByKey(g);x!==null&&u.push(iT.createPortal(p,x,g))}return u}),[i,o,a])})(n,r);return(function(a){nE((()=>T0(dne(a),Kre(a))),[a])})(n),l.jsxs(l.Fragment,{children:[e,l.jsx(fne,{content:t}),s]})}function fne({content:e}){const[t]=tu(),r=(function(s){const[a,i]=S.useState((()=>B8(s)));return nE((()=>{function o(){const c=B8(s);i(c)}return o(),T0(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=Ore();return r?typeof e=="function"?e(n):e:null}const aB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?S.useLayoutEffect:S.useEffect;function hne({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:c,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:f,ariaRequired:g,autoCapitalize:p,className:x,id:v,role:w="textbox",spellCheck:C=!0,style:k,tabIndex:_,"data-testid":N,...E},P){const[F,A]=S.useState(e.isEditable()),j=S.useCallback((L=>{L&&L.ownerDocument&&L.ownerDocument.defaultView?e.setRootElement(L):e.setRootElement(null)}),[e]),I=S.useMemo((()=>(function(...L){return Y=>{L.forEach((Z=>{typeof Z=="function"?Z(Y):Z!=null&&(Z.current=Y)}))}})(P,j)),[j,P]);return aB((()=>(A(e.isEditable()),e.registerEditableListener((L=>{A(L)})))),[e]),l.jsx("div",{"aria-activedescendant":F?t:void 0,"aria-autocomplete":F?r:"none","aria-controls":F?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":F&&w==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":c,"aria-labelledby":u,"aria-multiline":d,"aria-owns":F?f:void 0,"aria-readonly":!F||void 0,"aria-required":g,autoCapitalize:p,className:x,contentEditable:F,"data-testid":N,id:v,ref:I,role:w,spellCheck:C,style:k,tabIndex:_,...E})}const gne=S.forwardRef(hne);function $8(e){return e.getEditorState().read(U9(e.isComposing()))}const iB=S.forwardRef(mne);function mne(e,t){const{placeholder:r,...n}=e,[s]=tu();return l.jsxs(l.Fragment,{children:[l.jsx(gne,{editor:s,...n,ref:t}),r!=null&&l.jsx(pne,{editor:s,content:r})]})}function pne({content:e,editor:t}){const r=(function(i){const[o,c]=S.useState((()=>$8(i)));return aB((()=>{function u(){const d=$8(i);c(d)}return u(),T0(i.registerUpdateListener((()=>{u()})),i.registerEditableListener((()=>{u()})))}),[i]),o})(t),[n,s]=S.useState(t.isEditable());if(S.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:l.jsx("div",{"aria-hidden":!0,children:a})}const bw=0,sE=1,aE=2,tc=0,xne=1,U8=2,yne=3,vne=4;function wne(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return tc;const a=t._selection,i=e._selection;if(s)return xne;if(!(Mt(a)&&Mt(i)&&i.isCollapsed()&&a.isCollapsed()))return tc;const o=(function(C,k,_){const N=C._nodeMap,E=[];for(const P of k){const F=N.get(P);F!==void 0&&E.push(F)}for(const[P,F]of _){if(!F)continue;const A=N.get(P);A===void 0||ba(A)||E.push(A)}return E})(t,r,n);if(o.length===0)return tc;if(o.length>1){const C=t._nodeMap,k=C.get(a.anchor.key),_=C.get(i.anchor.key);return k&&_&&!e._nodeMap.has(k.__key)&&rr(k)&&k.__text.length===1&&a.anchor.offset===1?U8:tc}const c=o[0],u=e._nodeMap.get(c.__key);if(!rr(u)||!rr(c)||u.__mode!==c.__mode)return tc;const d=u.__text,f=c.__text;if(d===f)return tc;const g=a.anchor,p=i.anchor;if(g.key!==p.key||g.type!=="text")return tc;const x=g.offset,v=p.offset,w=f.length-d.length;return w===1&&v===x-1?U8:w===-1&&v===x+1?yne:w===-1&&v===x?vne:tc}function _ne(e,t){let r=Date.now(),n=tc;return(s,a,i,o,c,u)=>{const d=Date.now();if(u.has(N_))return n=tc,r=d,aE;const f=wne(s,a,o,c,e.isComposing()),g=(()=>{const p=i===null||i.editor===e,x=u.has(Xte);if(!x&&p&&u.has(Sy))return bw;if(s===null)return sE;const v=a._selection;return o.size>0||c.size>0?x===!1&&f!==tc&&f===n&&d<r+t&&p||o.size===1&&(function(w,C,k){const _=C._nodeMap.get(w),N=k._nodeMap.get(w),E=C._selection,P=k._selection;return!(Mt(E)&&Mt(P)&&E.anchor.type==="element"&&E.focus.type==="element"&&P.anchor.type==="text"&&P.focus.type==="text"||!rr(_)||!rr(N)||_.__parent!==N.__parent)&&JSON.stringify(C.read((()=>_.exportJSON())))===JSON.stringify(k.read((()=>N.exportJSON())))})(Array.from(o)[0],s,a)?bw:sE:v!==null?bw:aE})();return r=d,n=f,g}}function z8(e){e.undoStack=[],e.redoStack=[],e.current=null}function bne(e,t,r){const n=_ne(e,r);return T0(e.registerCommand(f4,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(c.length!==0){const u=i.current,d=c.pop();u!==null&&(o.push(u),a.dispatchCommand(hw,!0)),c.length===0&&a.dispatchCommand(gw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:N_})}})(e,t),!0)),fn),e.registerCommand(h4,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(c.push(u),a.dispatchCommand(gw,!0));const d=o.pop();o.length===0&&a.dispatchCommand(hw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:N_})}})(e,t),!0)),fn),e.registerCommand(Pte,(()=>(z8(t),!1)),fn),e.registerCommand(Fte,(()=>(z8(t),e.dispatchCommand(hw,!1),e.dispatchCommand(gw,!1),!0)),fn),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:c,tags:u})=>{const d=t.current,f=t.redoStack,g=t.undoStack,p=d===null?null:d.editorState;if(d!==null&&a===p)return;const x=n(i,a,d,o,c,u);if(x===sE)f.length!==0&&(t.redoStack=[],e.dispatchCommand(hw,!1)),d!==null&&(g.push({...d}),e.dispatchCommand(gw,!0));else if(x===aE)return;t.current={editor:e,editorState:a}})))}function Sne(){return{current:null,redoStack:[],undoStack:[]}}function oB({delay:e,externalHistoryState:t}){const[r]=tu();return(function(n,s,a=1e3){const i=S.useMemo((()=>s||Sne()),[s]);S.useEffect((()=>bne(n,i,a)),[a,n,i])})(r,t,e),null}function lB({defaultSelection:e}){const[t]=tu();return S.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function iE(e,t){return iE=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},iE(e,t)}var W8={error:null},kne=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(a=e.call.apply(e,[this].concat(o))||this).state=W8,a.resetErrorBoundary=function(){for(var u,d=arguments.length,f=new Array(d),g=0;g<d;g++)f[g]=arguments[g];a.props.onReset==null||(u=a.props).onReset.apply(u,f),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,iE(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(W8)},s.componentDidCatch=function(a,i){var o,c;(o=(c=this.props).onError)==null||o.call(c,a,i)},s.componentDidUpdate=function(a,i){var o,c,u,d,f=this.state.error,g=this.props.resetKeys;f!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=g)===void 0&&(d=[]),u.length!==d.length||u.some((function(p,x){return!Object.is(p,d[x])})))&&((o=(c=this.props).onResetKeysChange)==null||o.call(c,a.resetKeys,g),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,c=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(S.isValidElement(u))return u;if(typeof o=="function")return o(d);if(c)return S.createElement(c,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(S.Component);function cB({children:e,onError:t}){return l.jsx(kne,{fallback:l.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const z4=/^(\d+(?:\.\d+)?)px$/,cm={BOTH:3,NO_STATUS:0,ROW:1};class Km extends Di{static getType(){return"tablecell"}static clone(t){return new Km(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:H8,priority:0}),th:t=>({conversion:H8,priority:0})}}static importJSON(t){return uB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=cm.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),oE(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),wa(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(as(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...oE(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=cm.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==cm.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function oE(e){return e==="middle"||e==="bottom"}function H8(e){const t=e,r=e.nodeName.toLowerCase();let n;z4.test(t.style.width)&&(n=parseFloat(t.style.width));const s=uB(r==="th"?cm.ROW:cm.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;oE(i)&&(s.__verticalAlign=i);const o=t.style,c=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=c.includes("line-through"),f=o.fontStyle==="italic",g=c.includes("underline");return{after:p=>{const x=[];let v=null;const w=()=>{if(v){const C=v.getFirstChild();Vu(C)&&v.getChildrenSize()===1&&C.remove()}};for(const C of p)dre(C)||rr(C)||Vu(C)?(rr(C)&&(u&&C.toggleFormat("bold"),d&&C.toggleFormat("strikethrough"),f&&C.toggleFormat("italic"),g&&C.toggleFormat("underline")),v?v.append(C):(v=ss().append(C),x.push(v))):(x.push(C),w(),v=null);return w(),x.length===0&&x.push(ss()),x},node:s}}function uB(e=cm.NO_STATUS,t=1,r){return ao(new Km(e,t,r))}function Xy(e){return e instanceof Km}function lE(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class qm extends Di{static getType(){return"tablerow"}static clone(t){return new qm(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:Cne,priority:0})}}static importJSON(t){return dB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),wa(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Cne(e){const t=e;let r;return z4.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>J9(n,Xy),node:dB(r)}}function dB(e){return ao(new qm(e))}function fB(e){return e instanceof qm}const hB=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,Tne=hB&&"documentMode"in document?document.documentMode:null;hB&&"InputEvent"in window&&!Tne&&new window.InputEvent("input");function Ene(e,t,r){const n=[];let s=null,a=null;function i(c){let u=n[c];return u===void 0&&(n[c]=u=[]),u}const o=e.getChildren();for(let c=0;c<o.length;c++){const u=o[c];fB(u)||lE(209);const d=i(c);for(let f=u.getFirstChild(),g=0;f!=null;f=f.getNextSibling()){for(Xy(f)||lE(147);d[g]!==void 0;)g++;const p={cell:f,startColumn:g,startRow:c},{__rowSpan:x,__colSpan:v}=f;for(let w=0;w<x&&!(c+w>=o.length);w++){const C=i(c+w);for(let k=0;k<v;k++)C[g+k]=p}}}return[n,s,a]}function Kx(e){return as(e)&&e.nodeName==="TABLE"}function Nne(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;Xy(r)&&(n=r)}return null}function Ane(e,t,r){return Nne(e,kf(t,r))}function G8(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}vf(e,...n),wa(e,...s)}const jne=new WeakSet;function V8(e=Rv()){return jne.has(e)}class $v extends Di{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new $v(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:Pne,priority:1})}}static importJSON(t){return gB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=Kx(t)?t:t.querySelector("table");return Kx(r)||lE(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),pre(s),wa(n,t.theme.table),this.updateTableElement(null,n,t),V8(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?wa(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,c){c>0?(wa(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(vf(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,c){c>0?(wa(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(vf(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(wa(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(vf(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const c=s.querySelector("colgroup");if(!c)return;const u=[];for(let d=0;d<i;d++){const f=document.createElement("col"),g=o&&o[d];g&&(f.style.width=`${g}px`),u.push(f)}c.replaceChildren(...u)})(r,0,this.getColumnCount(),this.getColWidths()),G8(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===V8()||(as(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!Kx(s)&&as(s)&&(s=s.querySelector("table")),!Kx(s))return null;G8(s,t._config,this.getFormatType());const[a]=Ene(this),i=new Map;for(const d of a)for(const f of d){const g=f.cell.getKey();i.has(g)||i.set(g,{colSpan:f.cell.getColSpan(),startColumn:f.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const f=d.getAttribute("data-temporary-table-cell-lexical-key");if(f){const g=i.get(f);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),g){i.delete(f);for(let p=0;p<g.colSpan;p++)o.add(p+g.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((f,g)=>o.has(g)));c.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const f of u)d.appendChild(f);s.append(d)}return s},element:!Kx(n)&&as(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const c=i[o];if(c==null)continue;const{elem:u}=c,d=Ane(this,u);if(d!==null&&t.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=kf(s.elem);return Xy(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{Xy(n)&&(r+=n.getColSpan())})),r}}function Pne(e){const t=gB();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!z4.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>J9(n,fB),node:t}}function gB(){return ao(new $v)}function hf(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function cE(e){let t=1,r=e.getParent();for(;r!=null;){if(Cn(r)){const n=r.getParent();if(qr(n)){t++,r=n.getParent();continue}hf(40)}return t}return t}function uE(e){let t=e.getParent();qr(t)||hf(40);let r=t;for(;r!==null;)r=r.getParent(),qr(r)&&(t=r);return t}function mB(e){let t=[];const r=e.getChildren().filter(Cn);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();qr(a)?t=t.concat(mB(a)):t.push(s)}return t}function Wc(e){return Cn(e)&&qr(e.getFirstChild())}function K8(e){return qo().append(e)}function pB(e,t){return Cn(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function q8(e){const t=tr();if(t!==null){let r=t.getNodes();if(Mt(t)){const s=t.getStartEndPoints();s===null&&hf(143);const[a]=s,i=a.getNode(),o=i.getParent();if(ro(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const u=ss();i.append(u),r=u.select().getNodes()}}else if(pB(i,r)){const c=ko(e);if(ro(o)){i.replace(c);const u=qo();wt(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),c.append(u)}else if(Cn(i)){const u=i.getParentOrThrow();f0(c,u.getChildren()),u.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(wt(a)&&a.isEmpty()&&!Cn(a)&&!n.has(a.getKey())){Y8(a,e);continue}let i=C9(a)?a.getParent():Cn(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(qr(i)){if(!n.has(o)){const c=ko(e);f0(c,i.getChildren()),i.replace(c),n.add(o)}break}{const c=i.getParent();if(ro(c)&&!n.has(o)){n.add(o),Y8(i,e);break}i=c}}}}}function f0(e,t){e.splice(e.getChildrenSize(),0,t)}function Y8(e,t){if(qr(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=qo();let a;if(f0(s,e.getChildren()),qr(r)&&t===r.getListType())r.append(s),qr(n)&&t===n.getListType()&&(f0(r,n.getChildren()),n.remove()),a=r;else if(qr(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=ko(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function W4(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&Wc(r)&&Wc(n)&&(W4(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function Fne(){const e=tr();if(Mt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(pB(n,r))t.add(uE(n));else for(let s=0;s<r.length;s++){const a=r[s];if(C9(a)){const i=Wre(a,cd);i!=null&&t.add(uE(i))}}for(const s of t){let a=s;const i=mB(s);for(const o of i){const c=ss().setTextStyle(e.style).setTextFormat(e.format);f0(c,o.getChildren()),a.insertAfter(c),a=c,o.__key===e.anchor.key&&d0(e.anchor,bl(Nl(c,"next"))),o.__key===e.focus.key&&d0(e.focus,bl(Nl(c,"next"))),o.remove()}s.remove()}}}function xB(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())Cn(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),qr(n.getFirstChild())||r++)}function One(e){const t=new Set;if(Wc(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(Wc(n)&&Wc(s)){const a=s.getFirstChild();if(qr(a)){a.append(e);const i=n.getFirstChild();qr(i)&&(f0(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(Wc(n)){const a=n.getFirstChild();if(qr(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(Wc(s)){const a=s.getFirstChild();qr(a)&&a.append(e)}else if(qr(r)){const a=qo().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=ko(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function Dne(e){if(Wc(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(qr(r?r.getParent():void 0)&&Cn(r)&&qr(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=qo(),o=ko(a);i.append(o),e.getPreviousSiblings().forEach((d=>o.append(d)));const c=qo(),u=ko(a);c.append(u),f0(u,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function Ine(){const e=tr();if(!Mt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!Cn(t)||t.getChildrenSize()!==0)return!1;const r=uE(t),n=t.getParent();qr(n)||hf(40);const s=n.getParent();let a;if(ro(s))a=ss(),r.insertAfter(a);else{if(!Cn(s))return!1;a=qo(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=ko(n.getListType());if(Cn(a)){const c=qo();c.append(o),a.insertAfter(c)}else a.insertAfter(o);o.append(...i)}return(function(o){let c=o;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const u=c.getParent();if(u==null||!Cn(u)&&!qr(u))break;c=u}c.remove()})(t),!0}function O_(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let cd=class extends Di{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();qr(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Di,importDOM:{li:()=>({conversion:Rne,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();qr(s)&&s.getListType()==="check"&&(function(o,c,u,d){qr(c.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&c.__checked===u.__checked||o.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,c,u){const d=[],f=[],g=c.list,p=g?g.listitem:void 0;let x;if(g&&g.nested&&(x=g.nested.listitem),p!==void 0&&d.push(...O_(p)),g){const v=u.getParent(),w=qr(v)&&v.getListType()==="check",C=u.getChecked();w&&!C||f.push(g.listitemUnchecked),w&&C||f.push(g.listitemChecked),w&&d.push(C?g.listitemChecked:g.listitemUnchecked)}if(x!==void 0){const v=O_(x);u.getChildren().some((w=>qr(w)))?d.push(...v):f.push(...v)}f.length>0&&vf(o,...f),d.length>0&&wa(o,...d)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,c,u){const d=k8(c.__textStyle);for(const f in d)o.style.setProperty(`--listitem-marker-${f}`,d[f]);if(u)for(const f in k8(u.__textStyle))f in d||o.style.removeProperty(`--listitem-marker-${f}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(wt(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(Cn(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!qr(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=ko(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(wt(t)||hf(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(qr(n)||hf(39),Cn(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=ko(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&Wc(r)&&Wc(n)&&(W4(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=qo().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=ss();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=Cn(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(c,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return qr(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;Cn(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&hf(117),(t=Math.floor(t))>=0||hf(199);let r=this.getIndent();for(;r!==t;)r<t?(One(this),r++):(Dne(this),r--);return this}canInsertAfter(t){return Cn(t)}canReplaceWith(t){return Cn(t)}canMergeWith(t){return Cn(t)||b4(t)}extractWithChild(t,r){if(!Mt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return ko("bullet")}canMergeWhenEmpty(){return!0}};function Rne(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return Mne(r)}const t=e.getAttribute("aria-checked");return{node:qo(t==="true"||t!=="false"&&void 0)}}function Mne(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:qo(e.hasAttribute("checked"))}}function qo(e){return ao(new cd(void 0,e))}function Cn(e){return e instanceof cd}let Rf=class extends Di{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();qr(n)&&r.getListType()===n.getListType()&&W4(r,n)})(t),xB(t)},extends:Di,importDOM:{ol:()=>({conversion:J8,priority:0}),ul:()=>({conversion:J8,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=Bne[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,X8(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(X8(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return as(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];Cn(i)||(s===n&&(s=[...n]),s[a]=qo().append(!wt(i)||qr(i)||i.isInline()?i:Ps(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return Cn(t)}};function X8(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=cE(r)-1,c=o%i.length,u=i[c],d=a[r.__tag];let f;const g=a.nested,p=a.checklist;if(g!==void 0&&g.list&&(f=g.list),d!==void 0&&n.push(d),p!==void 0&&r.__listType==="check"&&n.push(p),u!==void 0){n.push(...O_(u));for(let x=0;x<i.length;x++)x!==c&&s.push(r.__tag+x)}if(f!==void 0){const x=O_(f);o>1?n.push(...x):s.push(...x)}}s.length>0&&vf(e,...s),n.length>0&&wa(e,...n)}function Lne(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(Cn(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{qr(a)&&t.push(K8(a))}))}else t.push(K8(n))}return t}function J8(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=ko("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(as(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?ko("check"):ko("bullet")),{after:Lne,node:r}}const Bne={ol:"number",ul:"bullet"};function ko(e="number",t=1){return ao(new Rf(e,t))}function qr(e){return e instanceof Rf}const $ne=Or("UPDATE_LIST_START_COMMAND"),H4=Or("INSERT_UNORDERED_LIST_COMMAND"),G4=Or("INSERT_ORDERED_LIST_COMMAND"),V4=Or("REMOVE_LIST_COMMAND");function Une(e){return T0(e.registerCommand(G4,(()=>(q8("number"),!0)),Wg),e.registerCommand($ne,(t=>{const{listNodeKey:r,newStart:n}=t,s=la(r);return!!qr(s)&&(s.getListType()==="number"&&(s.setStart(n),xB(s)),!0)}),Wg),e.registerCommand(H4,(()=>(q8("bullet"),!0)),Wg),e.registerCommand(V4,(()=>(Fne(),!0)),Wg),e.registerCommand(Vy,(()=>Ine()),Wg),e.registerNodeTransform(cd,(t=>{const r=t.getFirstChild();if(r){if(rr(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=tr();Mt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Df,(t=>{const r=t.getParent();if(Cn(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function zne(e){const t=r=>{const n=r.getParent();if(qr(r.getFirstChild())||!qr(n))return;const s=Qb(r,(a=>Cn(a)&&qr(a.getParent())&&Cn(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(Cn(s)){const a=s.getPreviousSibling();if(Cn(a)){const i=(function(c){let u=c,d=u.getFirstChild();for(;qr(d);){const f=d.getLastChild();if(!Cn(f))break;u=f,d=u.getFirstChild()}return u})(a),o=i.getParent();if(qr(o)){const c=cE(o);c+1<cE(n)&&r.setIndent(c)}}}};return e.registerNodeTransform(Rf,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(qr(s)){for(const a of s.getChildren())if(Cn(a)){t(a);const i=a.getFirstChild();qr(i)&&n.push(i)}}}}))}var gk={exports:{}},Q8;function Wne(){return Q8||(Q8=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(_){return _ instanceof c?new c(_.type,k(_.content),_.alias):Array.isArray(_)?_.map(k):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(_,N){N=N||{};var E,P;switch(o.util.type(_)){case"Object":if(P=o.util.objId(_),N[P])return N[P];E={},N[P]=E;for(var F in _)_.hasOwnProperty(F)&&(E[F]=k(_[F],N));return E;case"Array":return P=o.util.objId(_),N[P]?N[P]:(E=[],N[P]=E,_.forEach(function(A,j){E[j]=k(A,N)}),E);default:return _}},getLanguage:function(k){for(;k;){var _=s.exec(k.className);if(_)return _[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,_){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(E){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(E.stack)||[])[1];if(k){var _=document.getElementsByTagName("script");for(var N in _)if(_[N].src==k)return _[N]}return null}},isActive:function(k,_,N){for(var E="no-"+_;k;){var P=k.classList;if(P.contains(_))return!0;if(P.contains(E))return!1;k=k.parentElement}return!!N}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,_){var N=o.util.clone(o.languages[k]);for(var E in _)N[E]=_[E];return N},insertBefore:function(k,_,N,E){E=E||o.languages;var P=E[k],F={};for(var A in P)if(P.hasOwnProperty(A)){if(A==_)for(var j in N)N.hasOwnProperty(j)&&(F[j]=N[j]);N.hasOwnProperty(A)||(F[A]=P[A])}var I=E[k];return E[k]=F,o.languages.DFS(o.languages,function(L,Y){Y===I&&L!=k&&(this[L]=F)}),F},DFS:function k(_,N,E,P){P=P||{};var F=o.util.objId;for(var A in _)if(_.hasOwnProperty(A)){N.call(_,A,_[A],E||A);var j=_[A],I=o.util.type(j);I==="Object"&&!P[F(j)]?(P[F(j)]=!0,k(j,N,null,P)):I==="Array"&&!P[F(j)]&&(P[F(j)]=!0,k(j,N,A,P))}}},plugins:{},highlightAll:function(k,_){o.highlightAllUnder(document,k,_)},highlightAllUnder:function(k,_,N){var E={callback:N,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",E),E.elements=Array.prototype.slice.apply(E.container.querySelectorAll(E.selector)),o.hooks.run("before-all-elements-highlight",E);for(var P=0,F;F=E.elements[P++];)o.highlightElement(F,_===!0,E.callback)},highlightElement:function(k,_,N){var E=o.util.getLanguage(k),P=o.languages[E];o.util.setLanguage(k,E);var F=k.parentElement;F&&F.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(F,E);var A=k.textContent,j={element:k,language:E,grammar:P,code:A};function I(Y){j.highlightedCode=Y,o.hooks.run("before-insert",j),j.element.innerHTML=j.highlightedCode,o.hooks.run("after-highlight",j),o.hooks.run("complete",j),N&&N.call(j.element)}if(o.hooks.run("before-sanity-check",j),F=j.element.parentElement,F&&F.nodeName.toLowerCase()==="pre"&&!F.hasAttribute("tabindex")&&F.setAttribute("tabindex","0"),!j.code){o.hooks.run("complete",j),N&&N.call(j.element);return}if(o.hooks.run("before-highlight",j),!j.grammar){I(o.util.encode(j.code));return}if(_&&n.Worker){var L=new Worker(o.filename);L.onmessage=function(Y){I(Y.data)},L.postMessage(JSON.stringify({language:j.language,code:j.code,immediateClose:!0}))}else I(o.highlight(j.code,j.grammar,j.language))},highlight:function(k,_,N){var E={code:k,grammar:_,language:N};if(o.hooks.run("before-tokenize",E),!E.grammar)throw new Error('The language "'+E.language+'" has no grammar.');return E.tokens=o.tokenize(E.code,E.grammar),o.hooks.run("after-tokenize",E),c.stringify(o.util.encode(E.tokens),E.language)},tokenize:function(k,_){var N=_.rest;if(N){for(var E in N)_[E]=N[E];delete _.rest}var P=new f;return g(P,P.head,k),d(k,P,_,P.head,0),x(P)},hooks:{all:{},add:function(k,_){var N=o.hooks.all;N[k]=N[k]||[],N[k].push(_)},run:function(k,_){var N=o.hooks.all[k];if(!(!N||!N.length))for(var E=0,P;P=N[E++];)P(_)}},Token:c};n.Prism=o;function c(k,_,N,E){this.type=k,this.content=_,this.alias=N,this.length=(E||"").length|0}c.stringify=function k(_,N){if(typeof _=="string")return _;if(Array.isArray(_)){var E="";return _.forEach(function(I){E+=k(I,N)}),E}var P={type:_.type,content:k(_.content,N),tag:"span",classes:["token",_.type],attributes:{},language:N},F=_.alias;F&&(Array.isArray(F)?Array.prototype.push.apply(P.classes,F):P.classes.push(F)),o.hooks.run("wrap",P);var A="";for(var j in P.attributes)A+=" "+j+'="'+(P.attributes[j]||"").replace(/"/g,"&quot;")+'"';return"<"+P.tag+' class="'+P.classes.join(" ")+'"'+A+">"+P.content+"</"+P.tag+">"};function u(k,_,N,E){k.lastIndex=_;var P=k.exec(N);if(P&&E&&P[1]){var F=P[1].length;P.index+=F,P[0]=P[0].slice(F)}return P}function d(k,_,N,E,P,F){for(var A in N)if(!(!N.hasOwnProperty(A)||!N[A])){var j=N[A];j=Array.isArray(j)?j:[j];for(var I=0;I<j.length;++I){if(F&&F.cause==A+","+I)return;var L=j[I],Y=L.inside,Z=!!L.lookbehind,ae=!!L.greedy,ee=L.alias;if(ae&&!L.pattern.global){var ne=L.pattern.toString().match(/[imsuy]*$/)[0];L.pattern=RegExp(L.pattern.source,ne+"g")}for(var B=L.pattern||L,V=E.next,M=P;V!==_.tail&&!(F&&M>=F.reach);M+=V.value.length,V=V.next){var H=V.value;if(_.length>k.length)return;if(!(H instanceof c)){var W=1,R;if(ae){if(R=u(B,M,k,Z),!R||R.index>=k.length)break;var se=R.index,z=R.index+R[0].length,K=M;for(K+=V.value.length;se>=K;)V=V.next,K+=V.value.length;if(K-=V.value.length,M=K,V.value instanceof c)continue;for(var J=V;J!==_.tail&&(K<z||typeof J.value=="string");J=J.next)W++,K+=J.value.length;W--,H=k.slice(M,K),R.index-=M}else if(R=u(B,0,H,Z),!R)continue;var se=R.index,X=R[0],ie=H.slice(0,se),le=H.slice(se+X.length),ce=M+H.length;F&&ce>F.reach&&(F.reach=ce);var be=V.prev;ie&&(be=g(_,be,ie),M+=ie.length),p(_,be,W);var re=new c(A,Y?o.tokenize(X,Y):X,ee,X);if(V=g(_,be,re),le&&g(_,V,le),W>1){var pe={cause:A+","+I,reach:ce};d(k,_,N,V.prev,M,pe),F&&pe.reach>F.reach&&(F.reach=pe.reach)}}}}}}function f(){var k={value:null,prev:null,next:null},_={value:null,prev:k,next:null};k.next=_,this.head=k,this.tail=_,this.length=0}function g(k,_,N){var E=_.next,P={value:N,prev:_,next:E};return _.next=P,E.prev=P,k.length++,P}function p(k,_,N){for(var E=_.next,P=0;P<N&&E!==k.tail;P++)E=E.next;_.next=E,E.prev=_,k.length-=P}function x(k){for(var _=[],N=k.head.next;N!==k.tail;)_.push(N.value),N=N.next;return _}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(k){var _=JSON.parse(k.data),N=_.language,E=_.code,P=_.immediateClose;n.postMessage(o.highlight(E,o.languages[N],N)),P&&n.close()},!1)),o;var v=o.util.currentScript();v&&(o.filename=v.src,v.hasAttribute("data-manual")&&(o.manual=!0));function w(){o.manual||o.highlightAll()}if(!o.manual){var C=document.readyState;C==="loading"||C==="interactive"&&v&&v.defer?document.addEventListener("DOMContentLoaded",w):window.requestAnimationFrame?window.requestAnimationFrame(w):window.setTimeout(w,16)}return o})(t);e.exports&&(e.exports=r),typeof c_<"u"&&(c_.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(v,w){return" Error "+v+" while fetching file: "+w},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",c="loading",u="loaded",d="failed",f="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+c+'"])';function g(v,w,C){var k=new XMLHttpRequest;k.open("GET",v,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?w(k.responseText):k.status>=400?C(s(k.status,k.statusText)):C(a))},k.send(null)}function p(v){var w=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(v||"");if(w){var C=Number(w[1]),k=w[2],_=w[3];return k?_?[C,Number(_)]:[C,void 0]:[C,C]}}r.hooks.add("before-highlightall",function(v){v.selector+=", "+f}),r.hooks.add("before-sanity-check",function(v){var w=v.element;if(w.matches(f)){v.code="",w.setAttribute(o,c);var C=w.appendChild(document.createElement("CODE"));C.textContent=n;var k=w.getAttribute("data-src"),_=v.language;if(_==="none"){var N=(/\.(\w+)$/.exec(k)||[,"none"])[1];_=i[N]||N}r.util.setLanguage(C,_),r.util.setLanguage(w,_);var E=r.plugins.autoloader;E&&E.loadLanguages(_),g(k,function(P){w.setAttribute(o,u);var F=p(w.getAttribute("data-range"));if(F){var A=P.split(/\r\n?|\n/g),j=F[0],I=F[1]==null?A.length:F[1];j<0&&(j+=A.length),j=Math.max(0,Math.min(j-1,A.length)),I<0&&(I+=A.length),I=Math.max(0,Math.min(I,A.length)),P=A.slice(j,I).join(`
`),w.hasAttribute("data-start")||w.setAttribute("data-start",String(j+1))}C.textContent=P,r.highlightElement(C)},function(P){w.setAttribute(o,d),C.textContent=P})}}),r.plugins.fileHighlight={highlight:function(w){for(var C=(w||document).querySelectorAll(f),k=0,_;_=C[k++];)r.highlightElement(_)}};var x=!1;r.fileHighlight=function(){x||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),x=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(gk)),gk.exports}Wne();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(f){d!==f&&(e.languages.markdown[d].inside.content.inside[f]=e.languages.markdown[f])})}),e.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function f(g){if(!(!g||typeof g=="string"))for(var p=0,x=g.length;p<x;p++){var v=g[p];if(v.type!=="code"){f(v.content);continue}var w=v.content[1],C=v.content[3];if(w&&C&&w.type==="code-language"&&C.type==="code-block"&&typeof w.content=="string"){var k=w.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var _="language-"+k;C.alias?typeof C.alias=="string"?C.alias=[C.alias,_]:C.alias.push(_):C.alias=[_]}}}f(d.tokens)}),e.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var f="",g=0,p=d.classes.length;g<p;g++){var x=d.classes[g],v=/language-(.+)/.exec(x);if(v){f=v[1];break}}var w=e.languages[f];if(w)d.content=e.highlight(u(d.content),w,f);else if(f&&f!=="none"&&e.plugins.autoloader){var C="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=C,e.plugins.autoloader.loadLanguages(f,function(){var k=document.getElementById(C);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[f],f))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function u(d){var f=d.replace(i,"");return f=f.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(g,p){if(p=p.toLowerCase(),p[0]==="#"){var x;return p[1]==="x"?x=parseInt(p.slice(2),16):x=Number(p.slice(1)),c(x)}else{var v=o[p];return v||g}}),f}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var Z8={},eF;function Hne(){return eF||(eF=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),Z8}Hne();var tF={},rF;function Gne(){return rF||(rF=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),tF}Gne();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var nF={},sF;function Vne(){return sF||(sF=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),nF}Vne();var aF={},iF;function Kne(){return iF||(iF=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),aF}Kne();var oF={},lF;function qne(){return lF||(lF=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),oF}qne();function yB(e,t){for(const r of e.childNodes){if(as(r)&&r.tagName===t)return!0;yB(r,t)}return!1}const oy="data-language",qx="data-highlight-language",Sw="data-theme";class E0 extends Di{static getType(){return"code"}static clone(t){return new E0(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");wa(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(oy,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(qx,n));const s=this.getTheme();s&&r.setAttribute(Sw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(oy,s):a&&r.removeAttribute(oy);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(qx,s):r.removeAttribute(qx):i&&s&&r.setAttribute(qx,s);const o=this.__theme,c=t.__theme;o?o!==c&&r.setAttribute(Sw,o):c&&r.removeAttribute(Sw);const u=this.__style,d=t.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");wa(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(oy,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(qx,n));const s=this.getTheme();s&&r.setAttribute(Sw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||yB(t,"BR"))?{conversion:cF,priority:1}:null,div:()=>({conversion:Yne,priority:1}),pre:()=>({conversion:cF,priority:0}),table:t=>mk(t)?{conversion:Xne,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&mk(n)?{conversion:uF,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&mk(r)?{conversion:uF,priority:3}:null}}}static importJSON(t){return zu().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=ss();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(rr(o)){let c=Qne(o);const u=[];for(;;)if(Wb(c))u.push(zm()),c=c.getNextSibling();else{if(!_B(c))break;{let w=0;const C=c.getTextContent(),k=c.getTextContentSize();for(;w<k&&C[w]===" ";)w++;if(w!==0&&u.push(wB(" ".repeat(w))),w!==k)break;c=c.getNextSibling()}}const d=o.splitText(a.offset)[0],f=a.offset===0?0:1,g=d.getIndexWithinParent()+f,p=o.getParentOrThrow(),x=[Jc(),...u];p.splice(g,0,x);const v=u[u.length-1];v?v.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(K4(o)){const{offset:c}=t.anchor;o.splice(c,0,[Jc()]),o.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=ss();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function zu(e,t){return yre(E0).setLanguage(e).setTheme(t)}function K4(e){return e instanceof E0}function cF(e){return{node:zu(e.getAttribute(oy))}}function Yne(e){const t=e,r=dF(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(dF(s))return!0;s=s.parentElement}return!1})(t)?{node:r?zu():null}:{node:null}}function Xne(){return{node:zu()}}function uF(){return{node:null}}function dF(e){return e.style.fontFamily.match("monospace")!==null}function mk(e){return e.classList.contains("js-file-line-container")}let Zb=class vB extends Df{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new vB(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=pk(t.theme,this.__highlightType);return wa(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=pk(n.theme,t.__highlightType),i=pk(n.theme,this.__highlightType);return a!==i&&(a&&vf(r,a),i&&wa(r,i)),s}static importJSON(t){return wB().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return zu()}};function pk(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function wB(e="",t){return ao(new Zb(e,t))}function _B(e){return e instanceof Zb}function Jne(e,t){let r=e;for(let n=fi(e,t);n&&(_B(n.origin)||Wb(n.origin));n=zre(n))r=n.origin;return r}function Qne(e){return Jne(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const Zne=new Set(["http:","https:","mailto:","sms:","tel:"]);class Mf extends Di{static getType(){return"link"}static clone(t){return new Mf(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),wa(r,t.theme.link),r}updateLinkDOM(t,r,n){if(D9(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:ese,priority:1})}}static importJSON(t){return D_().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=hF(t);try{const r=new URL(hF(t));if(!Zne.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=D_(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Mt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function ese(e){let t=null;if(D9(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=D_(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function D_(e="",t){return ao(new Mf(e,t))}function tse(e){return e instanceof Mf}class Ym extends Mf{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new Ym(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return fF().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(wt(n)){const s=fF(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function fF(e="",t){return ao(new Ym(e,t))}function rse(e){return e instanceof Ym}const nse=/^\+?[0-9\s()-]{5,}$/;function hF(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:nse.test(e)?`tel:${e}`:`https://${e}`}function dE(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function sse(e){const t=dE(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const gF=/[!-/:-@[-`{-~\s]/;function ase(e){return rr(e)&&!e.hasFormat("code")}function ise(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function mF(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(bB(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function bB(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function ose(e,t=e2){const r=sse(t),n=dE(r.textFormat,(({tag:i})=>i[i.length-1])),s=dE(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const c=i.dependencies;for(const u of c)e.hasNode(u)||ise(173,u.getType())}}const a=(i,o,c)=>{(function(u,d,f,g){const p=u.getParent();if(!ro(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[f-1]!==" ")return!1;for(const{regExp:v,replace:w}of g){const C=x.match(v);if(C&&C[0].length===(C[0].endsWith(" ")?f:f-1)){const k=d.getNextSiblings(),[_,N]=d.splitText(f);if(w(u,N?[N,...k]:k,C,!1)!==!1)return _.remove(),!0}}return!1})(i,o,c,r.element)||(function(u,d,f,g){const p=u.getParent();if(!ro(p)||u.getFirstChild()!==d)return!1;const x=d.getTextContent();if(x[f-1]!==" ")return!1;for(const{regExpStart:v,replace:w,regExpEnd:C}of g){if(C&&!("optional"in C)||C&&"optional"in C&&!C.optional)continue;const k=x.match(v);if(k&&k[0].length===(k[0].endsWith(" ")?f:f-1)){const _=d.getNextSiblings(),[N,E]=d.splitText(f);if(w(u,E?[E,..._]:_,k,null,null,!1)!==!1)return N.remove(),!0}}return!1})(i,o,c,r.multilineElement)||(function(u,d,f){let g=u.getTextContent();const p=f[g[d-1]];if(p==null)return!1;d<g.length&&(g=g.slice(0,d));for(const x of p){if(!x.replace||!x.regExp)continue;const v=g.match(x.regExp);if(v===null)continue;const w=v.index||0,C=w+v[0].length;let k;return w===0?[k]=u.splitText(C):[,k]=u.splitText(w,C),k.selectNext(0,0),x.replace(k,v),!0}return!1})(o,c,s)||(function(u,d,f){const g=u.getTextContent(),p=d-1,x=g[p],v=f[x];if(!v)return!1;for(const w of v){const{tag:C}=w,k=C.length,_=p-k+1;if(k>1&&!bB(g,_,C,0,k)||g[_-1]===" ")continue;const N=g[p+1];if(w.intraword===!1&&N&&!gF.test(N))continue;const E=u;let P=E,F=mF(g,_,C),A=P;for(;F<0&&(A=A.getPreviousSibling())&&!Vu(A);)if(rr(A)){if(A.hasFormat("code"))continue;const B=A.getTextContent();P=A,F=mF(B,B.length,C)}if(F<0||P===E&&F+k===_)continue;const j=P.getTextContent();if(F>0&&j[F-1]===x)continue;const I=j[F-1];if(w.intraword===!1&&I&&!gF.test(I))continue;const L=E.getTextContent(),Y=L.slice(0,_)+L.slice(p+1);E.setTextContent(Y);const Z=P===E?Y:j;P.setTextContent(Z.slice(0,F)+Z.slice(F+k));const ae=tr(),ee=Gb();hi(ee);const ne=p-k*(P===E?2:1)+1;ee.anchor.set(P.__key,F,"text"),ee.focus.set(E.__key,ne,"text");for(const B of w.format)ee.hasFormat(B)||ee.formatText(B);ee.anchor.set(ee.focus.key,ee.focus.offset,ee.focus.type);for(const B of w.format)ee.hasFormat(B)&&ee.toggleFormat(B);return Mt(ae)&&(ee.format=ae.format),!0}})(o,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:c,prevEditorState:u})=>{if(i.has(_9)||i.has(N_)||e.isComposing())return;const d=c.read(tr),f=u.read(tr);if(!Mt(f)||!Mt(d)||!d.isCollapsed()||d.is(f))return;const g=d.anchor.key,p=d.anchor.offset,x=c._nodeMap.get(g);!rr(x)||!o.has(g)||p!==1&&p>f.anchor.offset+1||e.update((()=>{if(!ase(x))return;const v=x.getParent();v===null||K4(v)||a(v,x,d.anchor.offset)}))}))}const lse=/^(\s*)(\d{1,})\.\s/,cse=/^(\s*)[-*+]\s/,use=/^(#{1,6})\s/,dse=/^>\s/,fse=/^[ \t]*```([\w-]+)?/,hse=/[ \t]*```$/,SB=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},kB=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=qo(e==="check"?n[3]==="x":void 0);if(qr(i)&&i.getListType()===e){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),t.remove()}else if(qr(a)&&a.getListType()===e)a.append(o),t.remove();else{const u=ko(e,e==="number"?Number(n[2]):void 0);u.append(o),t.replace(u)}o.append(...r),s||o.select(0,0);const c=(function(u){const d=u.match(/\t/g),f=u.match(/ /g);let g=0;return d&&(g+=d.length),f&&(g+=Math.floor(f.length/4)),g})(n[1]);c&&o.setIndent(c)},q4=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(Cn(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(qr(d)){n.push(q4(d,t,r+1));continue}}const o=" ".repeat(4*r),c=e.getListType(),u=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+t(i)),a++}return n.join(`
`)},gse={dependencies:[Bv],export:(e,t)=>{if(!une(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:use,replace:SB((e=>{const t="h"+e[1].length;return ff(t)})),type:"element"},mse={dependencies:[Mv],export:(e,t)=>{if(!I8(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:dse,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(I8(a))return a.splice(a.getChildrenSize(),0,[Jc(),...t]),void e.remove()}const s=Lv();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},pse={dependencies:[E0],export:e=>{if(!K4(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:hse},regExpStart:fse,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=zu(),o=r[1]+s[0]):(i=zu(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=zu(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const c=Ps(o);i.append(c),e.append(i)}else t&&SB((c=>zu(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},xse={dependencies:[Rf,cd],export:(e,t)=>qr(e)?q4(e,t,0):null,regExp:cse,replace:kB("bullet"),type:"element"},yse={dependencies:[Rf,cd],export:(e,t)=>qr(e)?q4(e,t,0):null,regExp:lse,replace:kB("number"),type:"element"},vse={format:["code"],tag:"`",type:"text-format"},wse={format:["highlight"],tag:"==",type:"text-format"},_se={format:["bold","italic"],tag:"***",type:"text-format"},bse={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Sse={format:["bold"],tag:"**",type:"text-format"},kse={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Cse={format:["strikethrough"],tag:"~~",type:"text-format"},Tse={format:["italic"],tag:"*",type:"text-format"},Ese={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Nse={dependencies:[Mf],export:(e,t,r)=>{if(!tse(e)||rse(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=D_(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let c=r,u="";if(i<o)return;if(i>o){const f=r.split("[");u="["+f[0],c=f.slice(1).join("[")}const d=Ps(c);return d.setFormat(e.getFormat()),a.append(d),e.replace(a),u&&a.insertBefore(Ps(u)),d},trigger:")",type:"text-match"},Ase=[gse,mse,xse,yse],jse=[pse],Pse=[vse,_se,bse,Sse,kse,wse,Tse,Ese,Cse],Fse=[Nse],e2=[...Ase,...jse,...Pse,...Fse];function pF(e,t){return e.getEditorState().read((()=>{const r=la(t);return r!==null&&r.isSelected()}))}function Ose(e){const[t]=tu(),[r,n]=S.useState((()=>pF(t,e)));return S.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(pF(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,S.useCallback((s=>{t.update((()=>{let a=tr();Si(a)||(a=p4(),hi(a)),Si(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),S.useCallback((()=>{t.update((()=>{const s=tr();Si(s)&&s.clear()}))}),[t])]}function Dse({nodeKey:e}){const[t]=tu(),[r,n,s]=Ose(e);return S.useEffect((()=>T0(t.registerCommand(u4,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Wg))),[s,t,r,e,n]),S.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?wa(a,i):vf(a,i))}),[t,r,e]),null}class Uv extends v4{static getType(){return"horizontalrule"}static clone(t){return new Uv(t.__key)}static importJSON(t){return Y4().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:Ise,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return wa(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return l.jsx(Dse,{nodeKey:this.__key})}}function Ise(){return{node:Y4()}}function Y4(){return ao(new Uv)}function Rse(e){return e instanceof Uv}const Mse=[{dependencies:[Uv],export:e=>Rse(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=Y4();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...e2];function CB({transformers:e=Mse}){const[t]=tu();return S.useEffect((()=>ose(t,e)),[t,e]),null}function TB({hasStrictIndent:e=!1}){const[t]=tu();return S.useEffect((()=>{if(!t.hasNodes([Rf,cd]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),S.useEffect((()=>{if(e)return zne(t)}),[t,e]),(function(r){S.useEffect((()=>Une(r)),[r])})(t),null}const Lse=({onChange:e})=>{const[t]=S.useContext($m)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{ps().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Bse=()=>{const[e]=S.useContext($m)||[],t=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"bold")},[e]),r=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"italic")},[e]),n=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"underline")},[e]),s=S.useCallback(()=>{e&&e.dispatchCommand(Pi,"strikethrough")},[e]),a=S.useCallback(p=>{e&&e.update(()=>{const x=tr();Mt(x)&&lm(x,()=>ff(p))})},[e]),i=S.useCallback(()=>{e&&e.update(()=>{const p=tr();Mt(p)&&lm(p,()=>ss())})},[e]);S.useCallback(()=>{e&&e.update(()=>{const p=tr();Mt(p)&&lm(p,()=>Lv())})},[e]);const o=S.useCallback(()=>{e&&e.dispatchCommand(H4)},[e]),c=S.useCallback(()=>{e&&e.dispatchCommand(G4)},[e]),u=S.useCallback(()=>{e&&e.dispatchCommand(V4)},[e]),d=S.useCallback(p=>{e&&e.update(()=>{const x=tr();Mt(x)&&x.getNodes().forEach(v=>{rr(v)&&v.setStyle(`color: ${p}`)})})},[e]),f=S.useCallback(p=>{e&&e.update(()=>{const x=tr();Mt(x)&&x.getNodes().forEach(w=>{if(rr(w)){const C=w.getStyle(),k=C?C.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",_=k?`${k}; font-size: ${p}px;`:`font-size: ${p}px;`;w.setStyle(_)}})})},[e]),g=S.useCallback(p=>{e&&e.dispatchCommand(ZL,p)},[e]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),l.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),l.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),l.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),l.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),l.jsx("button",{type:"button",onClick:()=>f(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),l.jsx("button",{type:"button",onClick:()=>f(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),l.jsx("button",{type:"button",onClick:()=>f(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),l.jsx("button",{type:"button",onClick:()=>f(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),l.jsx("button",{type:"button",onClick:()=>g("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),l.jsx("button",{type:"button",onClick:()=>g("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),l.jsx("button",{type:"button",onClick:()=>g("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},$se=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Bv,Rf,cd,Mv,E0,Zb,$v,Km,qm,Ym,Mf],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs($9,{initialConfig:n,children:[l.jsx(Bse,{}),l.jsx(Lse,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(sB,{contentEditable:l.jsx(iB,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:cB}),l.jsx(oB,{}),l.jsx(lB,{}),l.jsx(TB,{}),l.jsx(CB,{transformers:e2})]})]})})},Use=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=cs(),{post:o}=Jo(),{showNotification:c}=ka(),[u,d]=S.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[f,g]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{d(C=>({...C,test_name:e||""}))},[e]);const p=()=>{if(u.num_questions>=3){g(_=>({..._,error:"Maximum 3 questions allowed for performance reasons"}));return}const k={id:Math.max(...u.questions.map(_=>_.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};d(_=>({..._,num_questions:_.num_questions+1,questions:[..._.questions,k]}))},x=C=>{u.questions.length<=1||d(k=>({...k,num_questions:k.num_questions-1,questions:k.questions.filter(_=>_.id!==C)}))},v=(C,k)=>{d(_=>({..._,questions:_.questions.map(N=>N.id===C?{...N,question_json:k}:N)}))},w=async()=>{if(!u.test_name.trim()){g(C=>({...C,error:"Test name is required"}));return}if(u.questions.some(C=>!C.question_json.trim())){g(C=>({...C,error:"All questions must have content"}));return}g(C=>({...C,isLoading:!0,error:null}));try{const C={test_name:u.test_name,num_questions:u.num_questions,passing_score:u.passing_score,questions:u.questions.map((k,_)=>({question_id:_+1,question_json:k.question_json,canvas_width:k.canvas_width,canvas_height:k.canvas_height,max_canvas_width:k.max_canvas_width,max_canvas_height:k.max_canvas_height}))};t&&t(C)}catch(C){console.error("Error preparing drawing test:",C),g(k=>({...k,error:"Failed to prepare drawing test. Please try again."})),c("Failed to prepare drawing test","error")}finally{g(C=>({...C,isLoading:!1}))}};return l.jsxs("div",{className:"drawing-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",u.num_questions,"/3)"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),l.jsxs(et,{onClick:p,disabled:u.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),l.jsx("div",{className:"space-y-4",children:u.questions.map((C,k)=>l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",k+1]}),u.questions.length>1&&l.jsx(et,{onClick:()=>x(C.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),l.jsx($se,{value:C.question_json,onChange:_=>v(C.id,_),placeholder:""})]})]},C.id))})]}),f.error&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:f.error}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(et,{onClick:r,variant:"secondary",disabled:f.isLoading,children:"Cancel"}),l.jsx(et,{onClick:w,variant:"primary",disabled:f.isLoading||!u.test_name.trim(),className:"flex items-center gap-2",children:f.isLoading?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})},zse=({onChange:e})=>{const[t]=S.useContext($m)||[];return S.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{ps().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Wse=({onAddBlank:e,blankCount:t})=>{const[r]=S.useContext($m)||[],n=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"bold")},[r]),s=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"italic")},[r]),a=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"underline")},[r]),i=S.useCallback(()=>{r&&r.dispatchCommand(Pi,"strikethrough")},[r]),o=S.useCallback(x=>{r&&r.update(()=>{const v=tr();Mt(v)&&lm(v,()=>ff(x))})},[r]),c=S.useCallback(()=>{r&&r.update(()=>{const x=tr();Mt(x)&&lm(x,()=>ss())})},[r]),u=S.useCallback(()=>{r&&r.update(()=>{const x=tr();Mt(x)&&lm(x,()=>Lv())})},[r]),d=S.useCallback(()=>{r&&r.dispatchCommand(H4)},[r]),f=S.useCallback(()=>{r&&r.dispatchCommand(G4)},[r]),g=S.useCallback(()=>{r&&r.dispatchCommand(V4)},[r]),p=S.useCallback(()=>{!r||!e||(r.update(()=>{const x=tr();if(Mt(x)){const w=`${t+1}_________`,C=Ps(w);C.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),x.insertNodes([C])}}),e())},[r,e,t]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),l.jsx("button",{type:"button",onClick:f,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),l.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&l.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:l.jsxs("button",{type:"button",onClick:p,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},Hse=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Bv,Rf,cd,Mv,E0,Zb,$v,Km,qm,Ym,Mf],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs($9,{initialConfig:a,children:[l.jsx(Wse,{onAddBlank:n,blankCount:s}),l.jsx(zse,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(sB,{contentEditable:l.jsx(iB,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:cB}),l.jsx(oB,{}),l.jsx(lB,{}),l.jsx(TB,{}),l.jsx(CB,{transformers:e2})]})]})})},Gse=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=cs(),{post:c}=Jo(),{showNotification:u}=ka(),[d,f]=S.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[g,p]=S.useState({isLoading:!1,error:null,showPreview:!0});S.useEffect(()=>{f(F=>({...F,test_name:e||"",allowed_time:t}))},[e,t]);const x=F=>{f(A=>({...A,test_text:F}))},v=()=>{const A={id:d.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};f(j=>({...j,blanks:[...j.blanks,A],num_blanks:j.num_blanks+1}))},w=F=>{f(A=>({...A,blanks:A.blanks.filter(j=>j.id!==F),num_blanks:A.num_blanks-1}))},C=F=>{f(A=>({...A,blanks:A.blanks.map(j=>j.id===F?{...j,options:[...j.options,""]}:j)}))},k=(F,A)=>{f(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,options:I.options.filter((L,Y)=>Y!==A),correct_answer:I.correct_answer===String.fromCharCode(65+A)?"":I.correct_answer}:I)}))},_=(F,A,j)=>{f(I=>({...I,blanks:I.blanks.map(L=>L.id===F?{...L,options:L.options.map((Y,Z)=>Z===A?j:Y)}:L)}))},N=(F,A)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:F,question:A}),f(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,question:A}:I)})),console.log(" [DEBUG] updateBlankQuestion completed")},E=(F,A)=>{f(j=>({...j,blanks:j.blanks.map(I=>I.id===F?{...I,correct_answer:A}:I)}))},P=async()=>{if(!d.test_name.trim()){p(F=>({...F,error:"Test name is required"}));return}if(!d.test_text.trim()){p(F=>({...F,error:"Test text is required"}));return}if(d.blanks.length===0){p(F=>({...F,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",d.blanks),d.blanks.forEach((F,A)=>{console.log(` [DEBUG] Blank ${A+1}:`,{question:F.question,questionTrimmed:F.question?.trim(),correct_answer:F.correct_answer,options:F.options})}),d.separate_type===!1){if(d.blanks.some(F=>!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),p(F=>({...F,error:"All blanks must have correct answers"}));return}}else if(d.blanks.some(F=>!F.question.trim()||!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),p(F=>({...F,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),p(F=>({...F,isLoading:!0,error:null}));try{const F={test_name:d.test_name,test_text:d.test_text,num_questions:d.blanks.length,num_blanks:d.blanks.length,separate_type:d.separate_type,passing_score:d.passing_score,allowed_time:d.allowed_time,blanks:d.blanks.map((A,j)=>({question_id:j+1,question_json:A.question,question:A.question,options:A.options,correct_answer:A.correct_answer,blank_positions:{},blank_options:A.options||[],correct_answers:[A.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",F),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(F),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(F){console.error("Error preparing fill blanks test:",F),p(A=>({...A,error:"Failed to prepare fill blanks test. Please try again."})),u("Failed to prepare fill blanks test","error")}finally{p(F=>({...F,isLoading:!1}))}};return l.jsxs("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test with text content and multiple choice blanks"}),g.error&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!0?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(F=>({...F,separate_type:!0})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!0,onChange:()=>f(F=>({...F,separate_type:!0})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Separate Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Multiple choice questions below the text"})]}),l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!1?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(F=>({...F,separate_type:!1})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!1,onChange:()=>f(F=>({...F,separate_type:!1})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Inline Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dropdown for option inside the text"})]})]}),l.jsx(Hse,{value:d.test_text,onChange:x,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:v,blankCount:d.blanks.length})]}),d.separate_type===!0&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>l.jsxs(jt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Configuration"]}),l.jsx(et,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",F.id," *"]}),l.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:F.question,onChange:j=>N(F.id,j.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:j||"",onChange:L=>_(F.id,I,L.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(et,{variant:"danger",size:"small",onClick:()=>k(F.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),F.options.length<6&&l.jsx(et,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",j]},I))]})]})]},F.id))}),d.separate_type===!1&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,A)=>l.jsxs(jt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Options"]}),l.jsx(et,{variant:"danger",size:"small",onClick:()=>w(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((j,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:j||"",onChange:L=>_(F.id,I,L.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(et,{variant:"danger",size:"small",onClick:()=>k(F.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),F.options.length<6&&l.jsx(et,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:j=>E(F.id,j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(j=>j.trim().length>0).map((j,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",j]},I))]})]})]},F.id))}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[l.jsx(et,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),l.jsx(et,{onClick:P,variant:"primary",disabled:a||d.blanks.length===0,children:a?l.jsx(Hr,{size:"sm"}):"Save Test"})]})]})},Vse=[{value:"A1",label:"A1 (Beginner)",description:"Basic vocabulary, simple sentences"},{value:"A2",label:"A2 (Elementary)",description:"Everyday vocabulary, present/past tenses"},{value:"B1",label:"B1 (Intermediate)",description:"Varied vocabulary, complex sentences"},{value:"B2",label:"B2 (Upper-Intermediate)",description:"Advanced vocabulary, sophisticated structures"},{value:"C1",label:"C1 (Advanced)",description:"Nuanced vocabulary, complex discourse"},{value:"C2",label:"C2 (Proficiency)",description:"Native-like fluency and accuracy"}],Kse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=ka(),[o,c]=S.useState({min_words:50,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}),[u,d]=S.useState(!1),f=S.useCallback((C,k)=>{c(_=>({..._,[C]:k}))},[]),g=S.useCallback((C,k,_)=>{c(N=>({...N,questions:N.questions.map((E,P)=>P===C?{...E,[k]:_}:E)}))},[]),p=S.useCallback(()=>{c(C=>({...C,questions:[...C.questions,{question_id:C.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}))},[]),x=S.useCallback(C=>{o.questions.length>1&&c(k=>({...k,questions:k.questions.filter((_,N)=>N!==C)}))},[o.questions.length]),v=S.useCallback(()=>{const C={};return o.min_words<10&&(C.min_words="Minimum word count must be at least 10 words"),o.questions.forEach((k,_)=>{k.prompt.trim()||(C[`question_${_}_prompt`]="Question prompt is required")}),C},[o]),w=S.useCallback(async C=>{C.preventDefault();const k=v();if(Object.keys(k).length>0){i("Please fix the validation errors","error");return}d(!0);try{const _={test_name:e,time_limit:300,min_duration:30,max_duration:600,max_attempts:3,min_words:o.min_words,passing_score:50,allowed_time:null,questions:o.questions.map((N,E)=>({question_id:E+1,prompt:N.prompt,expected_duration:N.expected_duration,difficulty_level:N.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",_),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(_),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(_){console.error("Error preparing speaking test:",_),i("Failed to prepare speaking test","error")}finally{d(!1)}},[o,v,i,t,e]);return u||s?l.jsxs("div",{className:"flex items-center justify-center p-8",children:[l.jsx(Hr,{}),l.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):l.jsxs("div",{className:"speaking-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),l.jsxs("form",{onSubmit:w,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),l.jsx("input",{type:"number",min:"10",max:"1000",value:o.min_words,onChange:C=>f("min_words",parseInt(C.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),l.jsx(et,{type:"button",variant:"outline",onClick:p,children:"Add Question"})]}),o.questions.length>1&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Multiple Questions Detected"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["You have ",o.questions.length," questions in this test.",l.jsx("strong",{children:" Only one question will be randomly selected"})," and shown to each student. This ensures fair distribution across your question pool."]})})]})]})}),o.questions.map((C,k)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"font-medium",children:["Question ",k+1]}),o.questions.length>1&&l.jsx(et,{type:"button",variant:"outline",size:"sm",onClick:()=>x(k),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),l.jsx("textarea",{value:C.prompt,onChange:_=>g(k,"prompt",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${k}_prompt`]&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${k}_prompt`]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),l.jsx("input",{type:"number",min:"10",max:"600",value:C.expected_duration||"",onChange:_=>g(k,"expected_duration",_.target.value?parseInt(_.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEFR Level"}),l.jsx("select",{value:C.difficulty_level,onChange:_=>g(k,"difficulty_level",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:Vse.map(_=>l.jsxs("option",{value:_.value,children:[_.label," - ",_.description]},_.value))}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the appropriate CEFR level for this question. This will be used by AI to evaluate students appropriately."})]})]})]})]},k))]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[l.jsx(et,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),l.jsx(et,{type:"submit",variant:"primary",disabled:u||s,children:u||s?"Creating...":"Create Speaking Test"})]})]})]})},EB=(e,t)=>{const[r,n]=S.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=S.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=S.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},t2=()=>{const e=S.useCallback((c,u=null)=>{try{const d=window.localStorage.getItem(c);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${c}":`,d),u}},[]),t=S.useCallback((c,u)=>{try{window.localStorage.setItem(c,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${c}":`,d)}},[]),r=S.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(u){console.error(`Error removing localStorage key "${c}":`,u)}},[]),n=S.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=S.useCallback(()=>{try{const c={};for(let g=0;g<window.localStorage.length;g++){const p=window.localStorage.key(g);p&&(c[p]=window.localStorage.getItem(p))}const u=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),f=document.createElement("a");f.href=d,f.download="localStorage_backup.json",f.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=S.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=S.useCallback(()=>{try{const c={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(c[d]=window.localStorage.getItem(d))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),o=S.useCallback(c=>{try{Object.entries(c).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},qse=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onSave:c,isEditing:u=!1,isSaving:d=!1,validationErrors:f={},showCorrectAnswers:g=!1,studentId:p=null})=>{const{getItem:x,setItem:v}=t2();ka(),S.useRef(null);const[w,C]=S.useState(""),[k,_]=S.useState(""),[N,E]=S.useState(""),[P,F]=S.useState(!1),[A,j]=S.useState(!0),[I,L]=S.useState(""),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(null);S.useEffect(()=>{if(e&&(E(e.question||""),_(e.correct_answer||""),n==="student"&&p)){const se=x(`test_progress_${p}_${r}_${t}_${e.question_id}`);se&&C(se)}},[e,t,r,n,x]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" TrueFalseQuestion syncing with parent studentAnswer:",a),C(a))},[a,n]),S.useEffect(()=>{if(n==="student"&&w&&t&&e?.question_id&&p){const se=setTimeout(()=>{Z(!0),v(`test_progress_${p}_${r}_${t}_${e.question_id}`,w),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},1e3);return()=>clearTimeout(se)}},[w,t,r,e?.question_id,n,p,v]),S.useEffect(()=>{if(n==="teacher"&&(N||k)){const se=setTimeout(()=>{Z(!0);const X={question:N,correct_answer:k,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,X),ee(new Date().toLocaleTimeString()),setTimeout(()=>Z(!1),1e3)},2e3);return()=>clearTimeout(se)}},[N,k,t,r,n,v]);const ne=S.useCallback(se=>{n==="student"&&(C(se),i&&i(e.question_id,se),M(se))},[n,e?.question_id,i]),B=S.useCallback(se=>{E(se),o&&o(e.question_id,se),H(se)},[e?.question_id,o]),V=S.useCallback(se=>{_(se),o&&o(e.question_id,{...e,correct_answer:se}),W(se)},[e,o]),M=S.useCallback(se=>{if(n==="student"){if(!se){j(!1),L("Please select an answer");return}j(!0),L("")}},[n]),H=S.useCallback(se=>{if(n==="teacher"){if(!se||se.trim().length<10){j(!1),L("Question must be at least 10 characters long");return}j(!0),L("")}},[n]),W=S.useCallback(se=>{if(n==="teacher"){if(!se){j(!1),L("Please select a correct answer");return}j(!0),L("")}},[n]),R=S.useCallback(()=>{if(n!=="teacher"||!c)return;const se={question_id:e.question_id,question:N,correct_answer:k,type:"true_false"};c(se)},[n,c,e?.question_id,N,k]),z=S.useCallback(se=>se?se.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),K=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),ae&&!Y&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",ae]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:z(N)}}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="true"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:w==="true",onChange:()=>ne("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${g&&k==="false"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:w==="false",onChange:()=>ne("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!A&&I&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:I})]}),J=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[Y&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),ae&&!Y&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",ae]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:N,onChange:se=>B(se.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:k==="true",onChange:()=>V("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${k==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:k==="false",onChange:()=>V("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${k==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:k==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!A&&I&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:I}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(et,{variant:"success",onClick:R,disabled:!A||d,className:"w-full sm:w-auto",children:d?l.jsx(Hr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:"true-false-question-container",children:n==="student"?K():J()})},Yse=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",studentAnswer:s,onAnswerChange:a,onQuestionChange:i,onOptionAdd:o,onOptionRemove:c,onSave:u,isEditing:d=!1,isSaving:f=!1,validationErrors:g={},showCorrectAnswers:p=!1,studentId:x=null,displayNumber:v})=>{const{getItem:w,setItem:C}=t2(),{showNotification:k}=ka();S.useRef(null);const[_,N]=S.useState(""),[E,P]=S.useState(["","","",""]),[F,A]=S.useState(""),[j,I]=S.useState(""),[L,Y]=S.useState(!1),[Z,ae]=S.useState(!0),[ee,ne]=S.useState(""),[B,V]=S.useState(!1),[M,H]=S.useState(null);S.useEffect(()=>{if(e&&(I(e.question||""),P(e.options||["","","",""]),A(e.correct_answer||""),n==="student"&&x)){const Ce=w(`test_progress_${x}_${r}_${t}_${e.question_id}`);Ce&&N(Ce)}},[e,t,r,n,w]),S.useEffect(()=>{n==="student"&&s!==void 0&&s!==null&&(console.log(" MultipleChoiceQuestion syncing with parent studentAnswer:",s),N(s))},[s,n]),S.useEffect(()=>{if(n==="student"&&_&&t&&e?.question_id&&x){const Ce=setTimeout(()=>{V(!0),C(`test_progress_${x}_${r}_${t}_${e.question_id}`,_),H(new Date().toLocaleTimeString()),setTimeout(()=>V(!1),1e3)},1e3);return()=>clearTimeout(Ce)}},[_,t,r,e?.question_id,n,x,C]),S.useEffect(()=>{if(n==="teacher"&&(j||E.some(Ce=>Ce.trim()))){const Ce=setTimeout(()=>{V(!0);const Ae={question:j,options:E,correct_answer:F,timestamp:Date.now()};C(`teacher_form_${r}_${t}`,Ae),H(new Date().toLocaleTimeString()),setTimeout(()=>V(!1),1e3)},2e3);return()=>clearTimeout(Ce)}},[j,E,F,t,r,n,C]),S.useCallback(Ce=>{if(n!=="student")return;const Ae=String(Ce);N(Ae),a&&a(e.question_id,Ae),se(Ae)},[n,e?.question_id,a]);const W=S.useCallback(Ce=>{I(Ce),i&&i(e.question_id,Ce),X(Ce)},[e?.question_id,i]),R=S.useCallback((Ce,Ae)=>{const We=[...E];We[Ce]=Ae,P(We),i&&i(e.question_id,{...e,options:We}),ie(We)},[E,e,i]),z=S.useCallback(Ce=>{A(Ce),i&&i(e.question_id,{...e,correct_answer:Ce}),le(Ce)},[e,i]),K=S.useCallback(()=>{if(E.length<6){const Ce=[...E,""];P(Ce),o&&o(e.question_id,Ce)}else k("Maximum 6 options allowed","warning")},[E,e?.question_id,o,k]),J=S.useCallback(Ce=>{if(E.length>2){const Ae=E.filter((We,Le)=>Le!==Ce);if(P(Ae),F===String.fromCharCode(65+Ce))A("");else if(F&&String.fromCharCode(65+Ce)<F){const We=String.fromCharCode(65+Ce-1);A(We)}c&&c(e.question_id,Ae)}else k("Minimum 2 options required","warning")},[E,F,e?.question_id,c,k]),se=S.useCallback(Ce=>{if(n==="student"){if(!Ce){ae(!1),ne("Please select an answer");return}ae(!0),e?.correct_answer&&Ce===e.correct_answer?ne(" Correct answer!"):e?.correct_answer?ne(" Incorrect answer"):ne("Answer selected")}},[n,e?.correct_answer]),X=S.useCallback(Ce=>!Ce||Ce.trim().length<10?(ae(!1),ne("Question must be at least 10 characters long"),!1):(ae(!0),ne(""),!0),[]),ie=S.useCallback(Ce=>{if(n!=="teacher")return;if(Ce.filter(We=>We.trim().length>0).length<2){ae(!1),ne("At least 2 options must be filled");return}if(Ce.some(We=>We.trim().length>0&&We.trim().length<3)){ae(!1),ne("Each option must be at least 3 characters long");return}ae(!0),ne("")},[n]),le=S.useCallback(Ce=>{if(n==="teacher"){if(!Ce){ae(!1),ne("Please select a correct answer");return}ae(!0),ne("")}},[n]),ce=S.useCallback(()=>{if(n!=="teacher"||!u)return;const Ce={question_id:e.question_id,question:j,options:E.filter(Ae=>Ae.trim().length>0),correct_answer:F,type:"multiple_choice"};u(Ce)},[n,u,e?.question_id,j,E,F]),be=S.useCallback(Ce=>Ce?Ce.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[B&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),M&&!B&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:j,onChange:Ce=>W(Ce.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),l.jsx(et,{variant:"secondary",size:"small",onClick:K,disabled:E.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),l.jsx("div",{className:"space-y-3",children:E.map((Ce,Ae)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+Ae)}),l.jsx("input",{type:"text",value:Ce,onChange:We=>R(Ae,We.target.value),placeholder:`Option ${String.fromCharCode(65+Ae)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),E.length>2&&l.jsx(et,{variant:"danger",size:"small",onClick:()=>J(Ae),className:"px-2 py-1 text-sm",children:""})]},Ae))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{id:`correct_${e?.question_id}`,value:F,onChange:Ce=>z(Ce.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[l.jsx("option",{value:"",children:"Select correct answer"}),E.map((Ce,Ae)=>{if(!Ce.trim())return null;const We=String.fromCharCode(65+Ae);return l.jsxs("option",{value:We,children:[We,") ",Ce]},Ae)})]})]})]}),!Z&&ee&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(et,{variant:"success",onClick:ce,disabled:!Z||f,className:"w-full sm:w-auto",children:f?l.jsx(Hr,{size:"small"}):"Save Question"})})]}):l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[B&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),M&&!B&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",M]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:be(j)}}),l.jsx("div",{className:"space-y-3",children:E.map((Ce,Ae)=>l.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${_===String.fromCharCode(65+Ae)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+Ae),checked:_===String.fromCharCode(65+Ae),onChange:We=>{N(We.target.value),a&&a(e?.question_id,We.target.value)},className:"mr-3"}),l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+Ae)}),l.jsx("span",{className:"flex-1",children:Ce||`Option ${String.fromCharCode(65+Ae)}`})]},Ae))}),!Z&&ee&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:ee})]})},Xse=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onAnswerAdd:c,onAnswerRemove:u,onSave:d,isEditing:f=!1,isSaving:g=!1,validationErrors:p={},showCorrectAnswers:x=!1,studentId:v=null})=>{const{getItem:w,setItem:C}=t2(),{showNotification:k}=ka(),_=S.useRef(null),[N,E]=S.useState(""),[P,F]=S.useState([""]),[A,j]=S.useState(!1),[I,L]=S.useState(!0),[Y,Z]=S.useState(""),[ae,ee]=S.useState(!1);S.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const X=`test_progress_${v}_${r}_${t}_${e.question_id}`,ie=w(X);ie&&E(ie)}},[e?.question_id,r,t,n,v,w]),S.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" InputQuestion syncing with parent studentAnswer:",a),E(a))},[a,n]),S.useEffect(()=>{n==="teacher"&&e?.answers&&F(e.answers.length>0?e.answers:[""])},[e?.answers,n]),S.useEffect(()=>{if(n==="student"&&N&&e?.question_id&&t&&r&&v){const X=setTimeout(()=>{ee(!0),C(`test_progress_${v}_${r}_${t}_${e.question_id}`,N),setTimeout(()=>ee(!1),1e3)},1e3);return()=>clearTimeout(X)}},[N,e?.question_id,r,t,n,v,C]),S.useEffect(()=>{if(n==="teacher"&&P&&o){const X=setTimeout(()=>{o({...e,answers:P.filter(ie=>ie.trim())})},500);return()=>clearTimeout(X)}},[P,e,n,o]);const ne=S.useCallback(X=>{E(X);const ie=X.trim().length>0;L(ie),Z(ie?"":"Please enter an answer"),i&&i(e.question_id,X)},[e?.question_id,i]),B=S.useCallback((X,ie)=>{const le=[...P];le[X]=ie,F(le),i&&i(e.question_id,le)},[P,e?.question_id,i]),V=S.useCallback(()=>{if(n==="teacher"){const X=[...P,""];F(X),c&&c(e.question_id,X)}},[P,e?.question_id,n,c]),M=S.useCallback(X=>{if(n==="teacher"&&P.length>1){const ie=P.filter((le,ce)=>ce!==X);F(ie),u&&u(e.question_id,ie)}},[P,e?.question_id,n,u]),H=S.useCallback(()=>{if(n==="student"){const X=N.trim().length>0;return L(X),Z(X?"":"Please enter an answer"),X}else if(n==="teacher"){const X=P.some(ie=>ie.trim().length>0);return L(X),Z(X?"":"Please enter at least one correct answer"),X}return!0},[N,P,n]),W=S.useCallback(X=>X?X.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),R=S.useCallback(()=>{j(!0)},[]),z=S.useCallback(()=>{j(!1),H()},[H]),K=S.useCallback(X=>{X.key==="Enter"&&n==="student"&&N.trim()&&(C(`test_progress_${r}_${t}_${e.question_id}`,N),k("Answer saved","success"))},[N,r,t,e?.question_id,n,C,k]),J=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),ae&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:W(e.question)}}),l.jsx("div",{className:"space-y-3",children:l.jsx("input",{ref:_,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:N,onChange:X=>ne(X.target.value),onFocus:R,onBlur:z,onKeyPress:K,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${I?A?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!I,"aria-describedby":I?void 0:`error-${e.question_id}`})}),x&&e.correct_answers&&l.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),l.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((X,ie)=>l.jsxs("li",{className:"text-green-700 text-sm",children:[" ",X]},ie))})]})]}),se=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),g&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:X=>o&&o({...e,question:X.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${p.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),p.question&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.question})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),l.jsx(et,{type:"button",variant:"secondary",size:"small",onClick:V,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),l.jsx("div",{className:"space-y-3",children:P.map((X,ie)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:ie+1}),l.jsx("input",{type:"text",value:X,onChange:le=>B(ie,le.target.value),placeholder:`Correct answer ${ie+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":ie}),P.length>1&&l.jsx(et,{type:"button",variant:"danger",size:"small",onClick:()=>M(ie),className:"px-2 py-1 text-sm",children:" Remove"})]},ie))}),p.answers&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:p.answers})]})]}),d&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(et,{type:"button",variant:"success",onClick:d,disabled:g,className:"w-full sm:w-auto",children:g?l.jsx(Hr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:`input-question-container ${n} ${A?"focused":""}`,children:n==="student"?J():se()})},Xm=(e,t,r)=>{const[n,s]=S.useState(!1),[a,i]=S.useState(0),[o,c]=S.useState(!1),u=S.useRef(!1);S.useEffect(()=>{if(!e||!t||!r)return;const w=`anti_cheating_${r}_${e}_${t}`,C=Rs(w);C&&(i(C.tabSwitches||0),c(C.isCheating||!1))},[e,t,r]);const d=S.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const w=Date.now();setTimeout(()=>{const C=Date.now()-w;console.log(" Timer completed - time hidden:",C,"ms"),C>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const _=k+1,N=_>=2;console.log(" Tab switch count updated:",{newCount:_,cheating:N}),c(N);const E=`anti_cheating_${r}_${e}_${t}`;return vs(E,{tabSwitches:_,isCheating:N},120*1e3),_})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),f=S.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),g=S.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",f),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[f]),p=S.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",f),console.log(" Anti-cheating event listeners removed")},[f]),x=S.useCallback(()=>{const w={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",w),w},[o,a]),v=S.useCallback(()=>{r&&e&&t&&Rm(r,e,t),i(0),c(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:g,stopTracking:p,clearData:v,getCheatingData:x,tabSwitches:a,isCheating:o,isTracking:n}},Jse=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=S.useState(null),[o,c]=S.useState(null);S.useEffect(()=>{(async()=>{try{const[ut,Dt]=await Promise.all([Zi(()=>Promise.resolve().then(()=>Ree),void 0),Zi(()=>Promise.resolve().then(()=>gZ),void 0)]);i(ut),c(Dt.default)}catch(ut){console.error("Failed to load Konva:",ut)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,f]=S.useState({}),[g,p]=S.useState({}),[x,v]=S.useState(0),[w,C]=S.useState(!1),[k,_]=S.useState(null),[N,E]=S.useState(0),[P,F]=S.useState(0),[A,j]=S.useState(null),[I,L]=S.useState(null),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(!1),[ne,B]=S.useState(!1),{showNotification:V}=ka(),{makeAuthenticatedRequest:M}=Jo(),{user:H}=cs(),{startTracking:W,stopTracking:R,getCheatingData:z,clearData:K}=Xm("matching_type",e?.id,H?.student_id||H?.id),J=S.useRef(null),se=S.useRef(null),X=S.useRef(null),ie=S.useRef(0),[le,ce]=S.useState(400);S.useRef({});const be=S.useCallback(()=>{Z(!0)},[]),re=S.useCallback(()=>{p({}),f({}),Z(!1)},[]),pe=S.useCallback(()=>{ee(!0)},[]),Ce=S.useCallback(()=>{ee(!1),r()},[r]),Ae=S.useMemo(()=>{if(!e)return null;const tt=e.blocks.map(Rt=>{let It=Rt.coordinates;if(typeof It=="string")try{It=JSON.parse(It)}catch(De){console.error(" Failed to parse coordinates:",De),It={x:0,y:0,width:100,height:100}}return It={x:(typeof It.x=="number"?It.x:Number(It.x))||0,y:(typeof It.y=="number"?It.y:Number(It.y))||0,width:(typeof It.width=="number"?It.width:Number(It.width))||30,height:(typeof It.height=="number"?It.height:Number(It.height))||10},{id:Rt.id,word:Rt.word,coordinates:It,hasArrow:Rt.hasArrow,arrow:Rt.arrow}}),ut=Array.isArray(e.arrows)?e.arrows:[],Dt=e.words.map(Rt=>({id:Rt.id,word:Rt.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:tt,arrows:ut,words:Dt}},[e]);S.useEffect(()=>{if(!e?.image_url)return;const tt=new Image;tt.crossOrigin="anonymous",tt.onload=()=>{console.log(" Image loaded successfully"),E(tt.width),F(tt.height);const ut=J.current?.clientWidth||800,Dt=J.current?.clientHeight||600,Rt=ut/tt.width,It=Dt/tt.height,De=Math.min(Rt,It,1),Ie=tt.width*De,Je=tt.height*De,qe=(ut-Ie)/2,Ze=(Dt-Je)/2;_({x:qe,y:Ze,width:Ie,height:Je,scaleX:De,scaleY:De,scale:De,image:tt}),ie.current=J.current?.clientWidth||800,console.log(" Image info calculated:",{x:qe,y:Ze,width:Ie,height:Je,scaleX:De,scaleY:De})},tt.onerror=()=>{console.error(" Failed to load image"),V("Failed to load test image","error")},tt.src=e.image_url},[e?.image_url,V]),S.useEffect(()=>{if(!Ae||!k)return;const tt=ie.current||J.current?.clientWidth||800,ut=12,Dt=38;let Rt=k.x,It=k.y+k.height+ut;const De=k.x+k.width,Ie={};Ae.words.forEach(Ze=>{if(!Object.prototype.hasOwnProperty.call(g,Ze.id)){const Tt=typeof Ze.word=="string"?Ze.word:"",Nt=Math.max(60,Tt.length*8+20);Rt+Nt>Math.min(tt-ut,De)&&(Rt=k.x,It+=Dt),d[Ze.id]||(Ie[Ze.id]={x:Rt,y:It}),Rt+=Nt+ut}}),Object.keys(Ie).length&&f(Ze=>({...Ze,...Ie}));const Je=Object.values(Ie).reduce((Ze,Tt)=>Math.max(Ze,Tt.y),It),qe=Math.max(k.y+k.height+ut,Je+Dt+ut);ce(Math.max(400,Math.ceil(qe)))},[Ae,k,g,d]);const We=S.useCallback(()=>{if(!k||!Ae)return[];const tt=u();return tt?Ae.blocks.map(ut=>{const Dt=ut.coordinates;let Rt,It,De,Ie;Rt=k.x+Dt.x*(k.scale??k.scaleX),It=k.y+Dt.y*(k.scale??k.scaleY),De=Dt.width*(k.scale??k.scaleX),Ie=Dt.height*(k.scale??k.scaleY);const Je=g[ut.id];return l.jsxs(tt.Group,{children:[l.jsx(tt.Rect,{x:Rt,y:It,width:De,height:Ie,fill:Je?"rgba(40, 167, 69, 0.4)":A===ut.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:Je?"#28a745":A===ut.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:Je?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),Je&&l.jsx(tt.KonvaText,{x:Rt+5,y:It+Ie/2-10,width:De-10,height:20,text:Ae.words.find(qe=>qe.id===Je)?.word||"",fontSize:Math.min(12,De/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},ut.id)}):[]},[k,Ae,g,a]),Le=S.useCallback(()=>{if(!k||!Ae)return[];const tt=u();return tt?(console.log(" Processing arrows:",Ae.arrows),Ae.arrows.map(ut=>{if(console.log(" Arrow data:",ut),!ut.start||!ut.end)return console.warn(" Arrow missing start/end coordinates:",ut),null;let Dt,Rt,It,De;if(ut.rel_start_x!==null&&ut.rel_start_y!==null&&ut.rel_end_x!==null&&ut.rel_end_y!==null&&ut.image_width&&ut.image_height&&ut.image_width>0&&ut.image_height>0){const Ie=ut.image_width,Je=ut.image_height,qe=k.width/Ie,Ze=k.height/Je;Dt=k.x+Number(ut.rel_start_x)/100*Ie*qe,Rt=k.y+Number(ut.rel_start_y)/100*Je*Ze,It=k.x+Number(ut.rel_end_x)/100*Ie*qe,De=k.y+Number(ut.rel_end_y)/100*Je*Ze}else{const Ie=k.scale??k.scaleX??1,Je=Number(ut.start.x),qe=Number(ut.start.y),Ze=Number(ut.end.x),Tt=Number(ut.end.y);Je<=k.width+1&&Ze<=k.width+1&&qe<=k.height+1&&Tt<=k.height+1?(Dt=k.x+(isNaN(Je)?0:Je),Rt=k.y+(isNaN(qe)?0:qe),It=k.x+(isNaN(Ze)?0:Ze),De=k.y+(isNaN(Tt)?0:Tt)):(Dt=k.x+(isNaN(Je)?0:Je)*Ie,Rt=k.y+(isNaN(qe)?0:qe)*Ie,It=k.x+(isNaN(Ze)?0:Ze)*Ie,De=k.y+(isNaN(Tt)?0:Tt)*Ie)}return l.jsx(tt.Arrow,{points:[Dt,Rt,It,De],stroke:ut.style?.color||"#dc3545",fill:ut.style?.color||"#dc3545",strokeWidth:ut.style?.thickness||3,pointerLength:10,pointerWidth:10},ut.id)}).filter(Boolean)):[]},[k,Ae,a]),At=S.useCallback(()=>{if(!Ae)return[];const tt=u();return tt?Ae.words.map(ut=>{const Dt=d[ut.id]||{x:0,y:0},Rt=typeof ut.word=="string"?ut.word:"",It=Math.max(60,Rt.length*8+20);return Object.values(g).includes(ut.id)?null:l.jsxs(tt.Group,{x:Dt.x,y:Dt.y,draggable:!0,onDragEnd:Ie=>Qe(Ie,ut.id),children:[l.jsx(tt.Rect,{width:It,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),l.jsx(tt.KonvaText,{text:Rt,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:It,height:34,listening:!1})]},ut.id)}):[]},[Ae,d,g,k,a]),Qe=S.useCallback((tt,ut)=>{const Dt=tt.target.x(),Rt=tt.target.y();if(f(Nt=>({...Nt,[ut]:{x:Dt,y:Rt}})),!k||!Ae)return;const It=Ae.words.find(Nt=>Nt.id===ut);if(!It)return;const De=typeof It.word=="string"?It.word:"",Ie=Math.max(60,De.length*8+20),Je={x:Dt,y:Rt,width:Ie,height:34},qe=k.scale??k.scaleX??1,Ze=(Nt,$t)=>!($t.x>Nt.x+Nt.width||$t.x+$t.width<Nt.x||$t.y>Nt.y+Nt.height||$t.y+$t.height<Nt.y),Tt=Ae.blocks.find(Nt=>{const $t=Nt.coordinates,ir={x:k.x+$t.x*qe,y:k.y+$t.y*qe,width:$t.width*qe,height:$t.height*qe};return Ze(Je,ir)});if(Tt){p(dr=>({...dr,[Tt.id]:ut}));const Nt=Tt.coordinates,$t=k.x+Nt.x*qe,ir=k.y+Nt.y*qe,pr=Nt.width*qe,Nr=Nt.height*qe;f(dr=>({...dr,[ut]:{x:$t+(pr-Ie)/2,y:ir+(Nr-34)/2}})),V(`Word "${It.word}" placed in block`,"success")}},[k,Ae,V]),gt=S.useCallback(()=>{if(!Ae)return 0;const tt=Ae.words.length,ut=Object.keys(g).length;return tt>0?ut/tt*100:0},[Ae,g]);S.useEffect(()=>{const tt=gt();v(tt)},[gt]),S.useEffect(()=>{if(e&&!I){const tt=new Date;L(tt),console.log(" Test timer started at:",tt.toISOString()),W(),console.log(" Anti-cheating tracking started")}},[e,I,W]);const ht=S.useCallback(async()=>{if(Ae){C(!0);try{const tt=Ae.words.length;let ut=0;console.log(" Scoring check - placedWords:",g),console.log(" Scoring check - blocks:",Ae.blocks.map(Vt=>({id:Vt.id,word:Vt.word}))),console.log(" Scoring check - words:",Ae.words.map(Vt=>({id:Vt.id,word:Vt.word}))),Ae.blocks.forEach(Vt=>{const ge=g[Vt.id];if(console.log(` Block ${Vt.id} (expects "${Vt.word}") has placed word ID: ${ge}`),ge){const Te=Ae.words.find(Fe=>Fe.id===ge);console.log(" Placed word:",Te),Te&&Te.word===Vt.word?(ut++,console.log(` Correct! Block ${Vt.id} has correct word "${Te.word}"`)):console.log(` Incorrect! Block ${Vt.id} expected "${Vt.word}" but got "${Te?.word||"nothing"}"`)}else console.log(` Block ${Vt.id} has no word placed`)});const Dt=ut,Rt=tt;console.log(` Final Score: ${Dt}/${Rt} (${Math.round(Dt/Rt*100)}%)`);const It=new Date,De=I?Math.round((It-I)/1e3):0,Ie=I?I.toISOString():It.toISOString();console.log(" Test timing:",{startedAt:Ie,endTime:It.toISOString(),timeTaken:`${De} seconds`});const Je=z();console.log(" Anti-cheating data for submission:",Je);const qe=H.student_id,Ze=`retest_assignment_id_${qe}_matching_type_${e.id}`,Tt=localStorage.getItem(Ze),{academicCalendarService:Nt}=await Zi(async()=>{const{academicCalendarService:Vt}=await Promise.resolve().then(()=>n2);return{academicCalendarService:Vt}},void 0);await Nt.loadAcademicCalendar();const ir=Nt.getCurrentTerm()?.id;if(!ir)throw new Error("No current academic period found");const pr={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:qe,academic_period_id:ir,answers:g,score:Dt,maxScore:Rt,time_taken:De,started_at:Ie,submitted_at:It.toISOString(),caught_cheating:Je.caught_cheating,visibility_change_times:Je.visibility_change_times,retest_assignment_id:Tt?Number(Tt):null,parent_test_id:e.id};console.log(" Submitting test data:",pr);const dr=await(await M("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pr)})).json();if(console.log(" Submission response:",dr),dr.success){if(V("Test submitted successfully!","success"),R(),K(),H?.student_id&&Rm(H.student_id,"matching_type",e.id),!!Tt&&H?.student_id){let Te=3;try{const kt=localStorage.getItem(`student_active_tests_${H.student_id}`);if(kt){const He=JSON.parse(kt)?.tests?.find(ke=>ke.test_id===e.id&&ke.test_type==="matching_type");He&&(Te=He.retest_attempts_left||He.max_attempts||3)}}catch(kt){console.error("Error checking active tests cache:",kt)}const Me=(Dt>0&&Rt>0?Dt/Rt*100:0)>=50;if(Me){const kt=`retest_attempt${Te}_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(kt,"true"),console.log(" Passed retest, marking last-slot key:",kt);let Pe=0;for(let $e=1;$e<=10;$e++){const Ue=`retest_attempt${$e}_${H.student_id}_matching_type_${e.id}`;localStorage.getItem(Ue)==="true"&&Pe++}const He=`test_completed_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(He,"true"),console.log(" Marked retest as completed (student passed):",He);const ke=`retest_attempts_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(ke,JSON.stringify({used:Pe,max:Te})),console.log(" Set retest attempts metadata (student passed):",ke,{used:Pe,max:Te})}else{let kt=1;for(let Ue=1;Ue<=10;Ue++){const Et=`retest_attempt${Ue}_${H.student_id}_matching_type_${e.id}`;if(localStorage.getItem(Et)!=="true"){kt=Ue;break}}const Pe=`retest_attempt${kt}_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Pe,"true"),console.log(" Marked retest attempt as completed:",Pe);let He=0;for(let Ue=1;Ue<=10;Ue++){const Et=`retest_attempt${Ue}_${H.student_id}_matching_type_${e.id}`;localStorage.getItem(Et)==="true"&&He++}const ke=Te-He,$e=ke<=0||Me;if(console.log(" Retest completion check:",{usedAttempts:He,maxAttempts:Te,attemptsLeft:ke,passed:Me,shouldComplete:$e}),$e){const Ue=`test_completed_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Ue,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",Ue);const Et=`retest_attempts_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Et,JSON.stringify({used:He,max:Te})),console.log(" Set retest attempts metadata (attempts exhausted):",Et,{used:He,max:Te})}}}else if(H?.student_id){const Te=`test_completed_${H.student_id}_matching_type_${e.id}`;localStorage.setItem(Te,"true"),console.log(" Test marked as completed in localStorage:",Te)}if(H?.student_id){const{setCachedData:Te,CACHE_TTL:Fe}=await Zi(async()=>{const{setCachedData:kt,CACHE_TTL:Pe}=await Promise.resolve().then(()=>Vg);return{setCachedData:kt,CACHE_TTL:Pe}},void 0),Me=`student_results_table_${H.student_id}`;Te(Me,dr,Fe.student_results_table),console.log(" Test results cached with key:",Me)}const ge=`retest1_${qe}_matching_type_${e.id}`;localStorage.removeItem(ge),localStorage.removeItem(Ze),t&&t(Dt)}else throw new Error(dr.message||"Failed to submit test")}catch(tt){console.error(" Error submitting test:",tt),V(`Error submitting test: ${tt.message}`,"error")}finally{C(!1)}}},[Ae,g,e,H,I,M,V,t]);return!e||!Ae?l.jsx(Hr,{}):l.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(et,{onClick:pe,variant:"outline",size:"sm",children:"Back to Cabinet"})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(x),"%"]})]})]}),l.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:l.jsx("div",{className:"lg:col-span-3",children:l.jsxs(jt,{className:"p-4",children:[l.jsx("div",{className:"mb-4 text-center",children:l.jsx(et,{onClick:be,variant:"secondary",children:"Reset"})}),l.jsx("div",{ref:J,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${le}px`},children:k&&a?(()=>{const{Stage:tt,Layer:ut,KonvaImage:Dt}=u();return l.jsxs(tt,{ref:se,width:J.current?.clientWidth||800,height:le,children:[l.jsxs(ut,{children:[l.jsx(Dt,{ref:X,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),We(),Le()]}),l.jsx(ut,{listening:!0,children:At()})]})})():k?l.jsxs("div",{className:"flex items-center justify-center h-full",children:[l.jsx(Hr,{size:"lg"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),l.jsx("div",{className:"mt-4 text-center",children:l.jsx(et,{onClick:()=>B(!0),disabled:w||x<100,children:w?"Submitting...":"Submit Test"})})]})})}),l.jsx(oa,{isOpen:Y,onClose:()=>Z(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>Z(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:re,variant:"primary",children:"Reset"})]})]})}),l.jsx(oa,{isOpen:ae,onClose:()=>ee(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>ee(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:Ce,variant:"primary",children:"Go Back"})]})]})}),l.jsx(oa,{isOpen:ne,onClose:()=>B(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>B(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{B(!1),ht()},variant:"primary",children:"Submit"})]})]})})]})})},Qse=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=cs(),{makeAuthenticatedRequest:o}=Jo(),{showNotification:c}=ka(),[u,d]=S.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[f,g]=S.useState("drag"),[p,x]=S.useState(!1),[v,w]=S.useState(null),C=S.useCallback(()=>{d(F=>[...F,{leftWord:"",rightWord:""}])},[]),k=S.useCallback(F=>{u.length>1&&d(A=>A.filter((j,I)=>I!==F))},[u.length]),_=S.useCallback((F,A)=>{d(j=>j.map((I,L)=>L===F?{...I,leftWord:A}:I))},[]),N=S.useCallback((F,A)=>{d(j=>j.map((I,L)=>L===F?{...I,rightWord:A}:I))},[]),E=S.useCallback(()=>u.every(F=>F.leftWord.trim()&&F.rightWord.trim()),[u]),P=S.useCallback(async()=>{if(!E()){c("Please fill in all word pairs","error");return}x(!0),w(null);try{const F=u.map((j,I)=>({question_id:I+1,left_word:j.leftWord.trim(),right_word:j.rightWord.trim()})),A={test_name:e,num_questions:F.length,interaction_type:f,questions:F};console.log(" Saving word matching test:",A),t({testName:e,numQuestions:F.length,interactionType:f,wordPairs:u,questions:F})}catch(F){console.error("Error saving word matching test:",F),w(F.message),c("Failed to save test: "+F.message,"error")}finally{x(!1)}},[e,u,f,E,o,c,t]);return l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-0",children:[l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${f==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("drag"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:f==="drag",onChange:()=>g("drag"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",l.jsx("br",{})," Visual feedback on placement",l.jsx("br",{})," Mobile-friendly"]})]}),l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${f==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("arrow"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:f==="arrow",onChange:()=>g("arrow"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",l.jsx("br",{})," Better for visual learners",l.jsx("br",{})," Requires precision"]})]})]})]})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"word-pairs-section",children:[l.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),l.jsx(et,{onClick:C,size:"sm",children:"+ Add Pair"})]}),l.jsx("div",{className:"pairs-list space-y-3 p-0 md:p-4",children:u.map((F,A)=>l.jsxs("div",{className:"word-pair-row flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-gray-50 rounded-lg border",children:[l.jsx("div",{className:"pair-number flex-shrink-0",children:l.jsx("span",{className:"number-badge w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs md:text-sm font-semibold",children:A+1})}),l.jsx("div",{className:"left-word flex-1",children:l.jsx("input",{type:"text",value:F.leftWord,onChange:j=>_(A,j.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-lg md:text-xl",children:""}),l.jsx("div",{className:"right-word flex-1",children:l.jsx("input",{type:"text",value:F.rightWord,onChange:j=>N(A,j.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-actions flex-shrink-0",children:l.jsx(et,{onClick:()=>k(A),variant:"outline",size:"sm",className:"remove-btn w-6 h-6 md:w-8 md:h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},A))})]})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"preview-section",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),l.jsx("div",{className:"preview-pairs space-y-2",children:u.map((F,A)=>l.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[l.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[A+1,"."]}),l.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:F.leftWord||"Left word"}),l.jsx("span",{className:"preview-arrow text-gray-500",children:""}),l.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:F.rightWord||"Right word"})]},A))})]})}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx(et,{onClick:P,disabled:!E()||p,className:"px-8",children:p?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),l.jsx(et,{onClick:r,variant:"secondary",children:"Cancel"})]}),v&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600",children:v})})]})},Zse=(e,t)=>{const[r,n,s]=EB(`test_progress_${e}_${t}`,{}),[a,i]=S.useState(!1),[o,c]=S.useState(0),[u,d]=S.useState(0),[f,g]=S.useState(!1),[p,x]=S.useState(null),v=S.useRef(null),w=S.useRef(null),C=S.useCallback((M,H)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(W=>({...W,[M]:H})),console.log(`Saved progress for question ${M}:`,H)},[n]),k=S.useCallback(M=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[M]||null,[r]),_=S.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const M=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${M}`);const H=Object.keys(r).length>0;s(),console.log(H?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),N=S.useCallback(()=>{v.current&&(N(v.current),v.current=null),w.current&&(N(w.current),w.current=null)},[]),E=S.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),w.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),I()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),P=S.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const M=j(),H=u>0?Math.round(M/u*100):0;return console.log(`[DEBUG] Progress: ${M}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${H}%`),{answeredQuestions:M,totalQuestions:u,percentage:H}},[e,t,u]),F=S.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const M=j();console.log(`[DEBUG] Submit button state check: ${M}/${u} questions answered`);const H=M===u&&u>0;return console.log(H?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),H},[u]),A=S.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const M=Object.keys(r).length;c(M),console.log(`[DEBUG] Restored ${M} answered questions`)}catch(M){console.error("[ERROR] Failed to load saved progress:",M),x(M.message)}},[e,t,r]),j=S.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const M=Object.keys(r).length;return c(M),console.log(`[DEBUG] Found ${M} answered questions`),M},[e,r]),I=S.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(M){console.error("[ERROR] Failed to save progress:",M),x(M.message)}},[e,t,r]),L=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`,H=localStorage.getItem(M)==="true";return i(H),H}catch(M){return console.error("Error checking test completion:",M),!1}},[e,t]),Y=S.useCallback(()=>{try{const M=`test_completed_${e}_${t}`;localStorage.setItem(M,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(M){console.error("Error marking test completed:",M)}},[e,t]),Z=S.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),Y()},[e,t,Y]),ae=S.useCallback(M=>{try{const H=`test_creation_state_${e}_${t}`;localStorage.setItem(H,JSON.stringify(M)),console.log("Test creation state saved:",M)}catch(H){console.error("Error saving test creation state:",H)}},[e,t]),ee=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`;localStorage.removeItem(M),console.log("Test creation state cleared")}catch(M){console.error("Error clearing test creation state:",M)}},[e,t]),ne=S.useCallback((M,H)=>{try{const W=`test_step_${e}_${t}_${M}`;localStorage.setItem(W,JSON.stringify(H)),console.log(`Step ${M} data saved:`,H)}catch(W){console.error(`Error saving step ${M} data:`,W)}},[e,t]),B=S.useCallback(M=>{try{const H=`test_step_${e}_${t}_${M}`,W=localStorage.getItem(H);return W?JSON.parse(W):null}catch(H){return console.error(`Error restoring step ${M} data:`,H),null}},[e,t]),V=S.useCallback(()=>{try{const M=`test_creation_state_${e}_${t}`,H=localStorage.getItem(M);return H?JSON.parse(H):null}catch(M){return console.error("Error restoring test creation state:",M),null}},[e,t]);return S.useEffect(()=>()=>{N()},[e,t,E,A,N]),S.useEffect(()=>{j()},[r,j]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:f,error:p,saveProgress:C,getProgress:k,clearProgress:_,clearInterval:N,setupProgressTracking:E,updateProgress:P,updateSubmitButton:F,loadProgress:A,getAnsweredCount:j,saveProgressForPage:I,checkCompleted:L,markCompleted:Y,markCompletedUI:Z,saveState:ae,clearState:ee,saveStepData:ne,restoreStepData:B,restoreState:V,setTotalQuestions:d,setError:x}},eae=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=cs(),{makeAuthenticatedRequest:s}=Jo(),{showNotification:a}=ka(),[i,o]=S.useState({width:window.innerWidth,height:window.innerHeight});S.useEffect(()=>{const De=()=>{o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]);const{getCheatingData:c,stopTracking:u,clearData:d}=Xm(),[f,g]=S.useState(null),[p,x]=S.useState({}),[v,w]=S.useState(null),C=S.useRef(null),[k,_]=S.useState(800),N={VERY_SMALL:400,MOBILE:600,TABLET:900},E={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},P={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:80,MARGIN:50},F=i.width<N.VERY_SMALL,A=i.width>=N.VERY_SMALL&&i.width<N.MOBILE,j=i.width>=N.MOBILE&&i.width<N.TABLET;i.width>=N.TABLET;const I=F?E.VERY_SMALL:A?E.MOBILE:j?E.TABLET:E.DESKTOP;S.useEffect(()=>{const De=()=>{if(C.current){const Je=C.current.clientWidth;console.log(" Container width detected:",Je),Je>0&&_(Je)}};De();const Ie=[setTimeout(De,50),setTimeout(De,100),setTimeout(De,200),setTimeout(De,500)];return window.addEventListener("resize",De),()=>{Ie.forEach(Je=>clearTimeout(Je)),window.removeEventListener("resize",De)}},[f]);const L=P.BLOCK_WIDTH*I,Y=P.BLOCK_HEIGHT*I,Z=P.BLOCK_SPACING*I,ae=P.MARGIN*I,ee=ae;console.log(" Mobile Debug:",{screenWidth:i.width,containerWidth:C.current?.clientWidth,canvasWidth:k,scale:I,blockWidth:L,margin:ae,leftBlockX:ee,displayDataLoaded:!!f});const ne=ee+L+20+L+ae,B=ne<=k;let V,M=L,H=Y;if(B)V=Math.min(Math.max(ee+L+20,k-L-ae),k-L-ae);else{const De=k-ae*2,Ie=Math.floor((De-20)/2);M=Math.max(60,Ie),H=Math.max(30,H*(M/L)),V=ee+M+20,console.log(" Very small screen - adjusted block size:",{availableWidth:De,maxBlockWidth:Ie,actualBlockWidth:M,actualBlockHeight:H})}console.log(" Right Block Position:",{rightBlockX:V,rightBlockRightEdge:V+M,canvasWidth:k,fits:V+M<=k,canFitSideBySide:B,minRequiredWidth:ne});const W=ae,R={DRAGGED_WORD:Math.max(8,14*I),ORIGINAL_WORD:Math.max(10,16*I),LEFT_WORD:Math.max(10,14*I)},z=Math.max(1,3*I),K=S.useCallback((De,Ie,Je)=>{if(!De)return H;const qe=Ie*.55,Ze=Math.floor(Je/qe),Tt=Math.ceil(De.length/Ze),Nt=Ie*1.1,$t=12*I,ir=Tt*Nt+$t,pr=Math.max(H*.8,30*I);return Math.max(pr,ir)},[H,I]),se=S.useCallback(()=>{if(!f?.leftWords||!f?.rightWords)return P.CANVAS_HEIGHT*I;let De=ae*2;for(let Je=0;Je<f.leftWords.length;Je++){const qe=f.leftWords[Je],Ze=f.rightWords[Je],Tt=K(qe,R.LEFT_WORD,M),Nt=K(Ze,R.ORIGINAL_WORD,M),$t=Math.max(Tt,Nt);De+=$t,Je<f.leftWords.length-1&&(De+=20*I)}const Ie=P.CANVAS_HEIGHT*I;return Math.max(Ie,De)},[f,K,R,M,ae,I])();S.useCallback((De,Ie)=>{if(!De||!Ie)return Z;const Je=De.map((Tt,Nt)=>{const $t=Ie[Nt],ir=K(Tt,R.LEFT_WORD,M),pr=K($t,R.ORIGINAL_WORD,M);return Math.max(ir,pr)}),qe=Math.max(...Je),Ze=20*I;return qe+Ze},[Z,K,R,M,I]);const ie=S.useCallback(()=>{if(!f?.leftWords||!f?.rightWords)return[];const De=[];let Ie=ae;for(let Je=0;Je<f.leftWords.length;Je++){const qe=f.leftWords[Je],Ze=f.rightWords[Je],Tt=K(qe,R.LEFT_WORD,M),Nt=K(Ze,R.ORIGINAL_WORD,M),$t=Math.max(Tt,Nt);De.push({y:Ie,leftHeight:Tt,rightHeight:Nt,rowHeight:$t}),Ie+=$t+20*I}return De},[f,K,R,M,ae,I])(),[le,ce]=S.useState([]),[be,re]=S.useState(!1),[pe,Ce]=S.useState(!1),[Ae,We]=S.useState(null),[Le,At]=S.useState(!1),[Qe,gt]=S.useState(!1);S.useEffect(()=>{if(e){if(console.log(" WordMatchingStudent: Initializing test data:",e),console.log(" Interaction type:",e.interaction_type),console.log(" Left words:",e.leftWords),console.log(" Right words:",e.rightWords),console.log(" Correct pairs:",e.correctPairs),!Array.isArray(e.leftWords)||!Array.isArray(e.rightWords)){console.error(" Invalid data structure - leftWords or rightWords not arrays:",{leftWords:e.leftWords,rightWords:e.rightWords});return}if(g(e),We(new Date),n?.student_id){const De=`test_progress_${n.student_id}_word_matching_${e.id}`,Ie=Rs(De);Ie&&(x(Ie.answers||{}),ce(Ie.arrows||[]),We(new Date(Ie.startTime)),console.log(" Test progress restored:",Ie))}}},[e,n?.student_id]),S.useEffect(()=>{if(f&&Ae&&n?.student_id){const De=setInterval(()=>{const Ie={answers:p,arrows:le,startTime:Ae.toISOString()},Je=`test_progress_${n.student_id}_word_matching_${e.id}`;vs(Je,Ie,Is.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(De)}},[f,p,le,Ae,n?.student_id,e?.id]);const ht=S.useCallback((De,Ie)=>{if(console.log(" handleWordClick called:",{side:De,index:Ie,interactionType:e?.interaction_type,selectedWord:v}),e?.interaction_type!=="arrow"){console.log(" Not arrow mode, ignoring click");return}if(v){if(v.side===De&&v.index===Ie)console.log(" Deselecting word"),w(null);else if(v.side!==De){console.log(" Creating arrow connection:",{startWord:v,endWord:{side:De,index:Ie}});const Je={id:Date.now().toString(),startWord:v,endWord:{side:De,index:Ie},color:"#3B82F6"};ce(qe=>{const Ze=[...qe,Je];return console.log(" Updated arrows:",Ze),Ze}),x(qe=>{const Ze={...qe,[v.index]:Ie};return console.log(" Updated answers:",Ze),Ze}),w(null)}}else console.log(" Selecting word:",{side:De,index:Ie}),w({side:De,index:Ie})},[v,e?.interaction_type]);S.useCallback((De,Ie)=>{e.interaction_type==="drag"&&x(Je=>({...Je,[De]:Ie}))},[e?.interaction_type]);const tt=S.useCallback(()=>{At(!0)},[]),ut=S.useCallback(()=>{x({}),ce([]),w(null),At(!1)},[]),Dt=S.useCallback(()=>{gt(!0)},[]),Rt=S.useCallback(()=>{gt(!1),r&&r()},[r]),It=S.useCallback(async()=>{if(f){re(!0);try{const De=f?.leftWords?.length||0;let Ie=0,Je={};e.interaction_type==="drag"?Object.entries(p).forEach(([Pe,He])=>{const ke=f?.correctPairs?.[Pe];He===ke&&Ie++,Je[Pe]=He}):le.forEach(Pe=>{const He=Pe.startWord.side==="left"?Pe.startWord.index:Pe.endWord.index,ke=Pe.startWord.side==="right"?Pe.startWord.index:Pe.endWord.index;f?.correctPairs?.[He]===ke&&Ie++,Je[He]=ke});const qe=Ie,Ze=De;console.log(` Final Score: ${qe}/${Ze} (${Math.round(qe/Ze*100)}%)`);const Tt=new Date,Nt=Ae?Math.round((Tt-Ae)/1e3):0,$t=Ae?Ae.toISOString():Tt.toISOString(),ir=c(),pr=n.student_id,Nr=`retest_assignment_id_${pr}_word_matching_${e.id}`,dr=localStorage.getItem(Nr),{academicCalendarService:Vt}=await Zi(async()=>{const{academicCalendarService:Pe}=await Promise.resolve().then(()=>n2);return{academicCalendarService:Pe}},void 0);await Vt.loadAcademicCalendar();const Te=Vt.getCurrentTerm()?.id;if(!Te)throw new Error("No current academic period found");const Fe={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:pr,academic_period_id:Te,parent_test_id:e.id,retest_assignment_id:dr?Number(dr):null,interaction_type:e.interaction_type,answers:Je,score:qe,maxScore:Ze,time_taken:Nt,started_at:$t,submitted_at:Tt.toISOString(),caught_cheating:ir.caught_cheating,visibility_change_times:ir.visibility_change_times};console.log(" Submission data being sent:",Fe),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Me=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fe)});console.log(" Submission response received:",Me.status);const kt=await Me.json();if(kt.success){if(a("Test submitted successfully!","success"),u(),d(),n?.student_id&&Rm(n.student_id,"word_matching",e.id),!!dr&&n?.student_id){let He=3;try{const Ue=localStorage.getItem(`student_active_tests_${n.student_id}`);if(Ue){const Ft=JSON.parse(Ue)?.tests?.find(zt=>zt.test_id===e.id&&zt.test_type==="word_matching");Ft&&(He=Ft.retest_attempts_left||Ft.max_attempts||3)}}catch(Ue){console.error("Error checking active tests cache:",Ue)}const $e=(qe>0&&Ze>0?qe/Ze*100:0)>=50;if($e){const Ue=`retest_attempt${He}_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Ue,"true"),console.log(" Passed retest, marking last-slot key:",Ue);let Et=0;for(let fr=1;fr<=10;fr++){const nr=`retest_attempt${fr}_${n.student_id}_word_matching_${e.id}`;localStorage.getItem(nr)==="true"&&Et++}const Ft=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Ft,"true"),console.log(" Marked retest as completed (student passed):",Ft);const zt=`retest_attempts_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(zt,JSON.stringify({used:Et,max:He})),console.log(" Set retest attempts metadata (student passed):",zt,{used:Et,max:He})}else{let Ue=1;for(let nr=1;nr<=10;nr++){const Dr=`retest_attempt${nr}_${n.student_id}_word_matching_${e.id}`;if(localStorage.getItem(Dr)!=="true"){Ue=nr;break}}const Et=`retest_attempt${Ue}_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Et,"true"),console.log(" Marked retest attempt as completed:",Et);let Ft=0;for(let nr=1;nr<=10;nr++){const Dr=`retest_attempt${nr}_${n.student_id}_word_matching_${e.id}`;localStorage.getItem(Dr)==="true"&&Ft++}const zt=He-Ft,fr=zt<=0||$e;if(console.log(" Retest completion check:",{usedAttempts:Ft,maxAttempts:He,attemptsLeft:zt,passed:$e,shouldComplete:fr}),fr){const nr=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(nr,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",nr);const Dr=`retest_attempts_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Dr,JSON.stringify({used:Ft,max:He})),console.log(" Set retest attempts metadata (attempts exhausted):",Dr,{used:Ft,max:He})}}}else if(n?.student_id){const He=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(He,"true"),console.log(" Test marked as completed in localStorage:",He)}if(n?.student_id){const He=`student_results_table_${n.student_id}`;vs(He,kt,Is.student_results_table),console.log(" Test results cached with key:",He)}if(n?.student_id){const He=`retest1_${pr}_word_matching_${e.id}`;localStorage.removeItem(He),localStorage.removeItem(Nr)}t&&t(qe),re(!1)}else throw new Error(kt.message||"Failed to submit test")}catch(De){console.error("Error submitting test:",De),re(!1)}}},[f,p,le,e,n,Ae,c,u,d,s,t]);return f?l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[l.jsx(oa,{isOpen:be,onClose:()=>{},title:"Submitting",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(Hr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(et,{onClick:Dt,variant:"outline",size:"sm",disabled:be,children:"Back to Cabinet"})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"text-left",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),l.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?l.jsx(jt,{className:"mb-6",children:l.jsx("div",{ref:C,className:"relative w-full",children:l.jsx(e0,{width:k,height:se,className:`border-2 border-gray-200 rounded-lg ${be?"pointer-events-none opacity-50":""}`,children:l.jsxs(Zh,{children:[f.leftWords.map((De,Ie)=>{const Je=p[Ie]!==void 0,qe=K(De,R.LEFT_WORD,M),Ze=ie[Ie],Tt=Ze?Ze.y:W+Ie*Z;return l.jsxs(sc,{x:ee,y:Tt,draggable:!Je,onDragStart:Nt=>{Nt.target.moveToTop()},onDragEnd:Nt=>{Nt.target.getStage();const $t=f.rightWords,ir=M+60,pr=H+30,Nr=V-30,dr=W-15;console.log(" Drop detection - Word dropped at:",Nt.target.x(),Nt.target.y());for(let Vt=0;Vt<$t.length;Vt++){const ge=ie[Vt],Te=ge?ge.y:dr+Vt*Z,Fe=Nr,Me=Nr+ir,kt=Te,Pe=Te+pr;if(console.log(` Checking drop zone ${Vt}:`,{left:Fe,right:Me,top:kt,bottom:Pe,word:$t[Vt]}),Nt.target.x()>=Fe&&Nt.target.x()<=Me&&Nt.target.y()>=kt&&Nt.target.y()<=Pe){console.log(` Match found! Word "${f.leftWords[Ie]}" matched with "${$t[Vt]}"`),x(He=>({...He,[Ie]:Vt}));break}}console.log(" No match found, resetting position"),Nt.target.position({x:ee,y:Tt})},children:[l.jsx($a,{width:M,height:qe,fill:Je?"#e5e7eb":"#3b82f6",stroke:Je?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Je?.5:1}),l.jsx(zc,{text:De,x:M/2,y:qe/2,fontSize:R.LEFT_WORD,fontFamily:"Arial",fill:Je?"#dc2626":"white",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:qe/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Ie}`)}),f.rightWords.map((De,Ie)=>{const Je=K(De,R.ORIGINAL_WORD,M),qe=ie[Ie],Ze=qe?qe.y:W+Ie*Z,Tt=Object.keys(p).find(Nt=>p[Nt]===Ie);return l.jsxs(sc,{x:V,y:Ze,children:[l.jsx($a,{width:M,height:Je,fill:Tt?"#10b981":"#f3f4f6",stroke:Tt?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),l.jsx(zc,{text:De,x:M/2,y:Je/2,fontSize:R.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Je/2,wrap:"word",ellipsis:!0,listening:!1}),Tt&&l.jsx(zc,{text:f.leftWords[Tt],x:M/2,y:Je/4,fontSize:R.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Je/8,wrap:"word",ellipsis:!0})]},`right-${Ie}`)})]})})})}):l.jsx(jt,{className:"mb-6",children:l.jsx("div",{ref:C,className:"relative w-full",children:l.jsx(e0,{width:k,height:se,className:`border-2 border-gray-200 rounded-lg ${be?"pointer-events-none opacity-50":""}`,children:l.jsxs(Zh,{children:[f?.leftWords?.map((De,Ie)=>{const Je=K(De,R.LEFT_WORD,M),qe=ie[Ie],Ze=qe?qe.y:W+Ie*Z,Tt=v?.side==="left"&&v?.index===Ie;return l.jsxs(sc,{x:ee,y:Ze,onClick:()=>ht("left",Ie),children:[l.jsx($a,{width:M,height:Je,fill:Tt?"#3b82f6":"#f3f4f6",stroke:Tt?"#1d4ed8":"#d1d5db",strokeWidth:Tt?3:2,cornerRadius:8}),l.jsx(zc,{text:De,x:M/2,y:Je/2,fontSize:R.LEFT_WORD,fontFamily:"Arial",fill:Tt?"white":"#374151",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Je/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${Ie}`)}),f?.rightWords?.map((De,Ie)=>{const Je=K(De,R.ORIGINAL_WORD,M),qe=ie[Ie],Ze=qe?qe.y:W+Ie*Z,Tt=v?.side==="right"&&v?.index===Ie;return l.jsxs(sc,{x:V,y:Ze,onClick:()=>ht("right",Ie),children:[l.jsx($a,{width:M,height:Je,fill:Tt?"#3b82f6":"#f3f4f6",stroke:Tt?"#1d4ed8":"#d1d5db",strokeWidth:Tt?3:2,cornerRadius:8}),l.jsx(zc,{text:De,x:M/2,y:Je/2,fontSize:R.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:M,offsetX:M/2,offsetY:Je/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${Ie}`)}),le.map((De,Ie)=>{const Je=f?.leftWords?.[De.startWord.index],qe=f?.rightWords?.[De.endWord.index],Ze=K(Je,R.LEFT_WORD,M),Tt=K(qe,R.ORIGINAL_WORD,M),Nt=ie[De.startWord.index],$t=ie[De.endWord.index],ir=Nt?Nt.y+Ze/2:W+De.startWord.index*Z+Ze/2,pr=$t?$t.y+Tt/2:W+De.endWord.index*Z+Tt/2;return l.jsx(ai,{points:[ee+M+20,ir,V-20,pr],stroke:De.color||"#3b82f6",strokeWidth:z,lineCap:"round",lineJoin:"round"},Ie)})]})})})}),l.jsx(jt,{children:l.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${be?"pointer-events-none opacity-50":""}`,children:[l.jsx(et,{onClick:tt,variant:"outline",disabled:be,children:"Reset"}),l.jsx(et,{onClick:()=>Ce(!0),disabled:be,className:"px-8",children:be?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),l.jsx(oa,{isOpen:Le&&!be,onClose:()=>At(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>At(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:ut,variant:"primary",children:"Reset"})]})]})}),l.jsx(oa,{isOpen:Qe,onClose:()=>gt(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>gt(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:Rt,variant:"primary",children:"Leave"})]})]})}),l.jsx(oa,{isOpen:pe,onClose:()=>Ce(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>Ce(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{Ce(!1),It()},variant:"primary",children:"Submit"})]})]})})]}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Hr,{size:"lg"})})},tae=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:c,onSelect:u,onUpdate:d,onDelete:f})=>{const[g,p]=S.useState(!1),x=S.useRef(!1),v=S.useRef(null),w=S.useRef({x:0,y:0}),C=S.useRef(null),k=5,_=()=>{x.current=!0,p(!0)},N=()=>{if(x.current=!1,p(!1),C.current)try{C.current.draggable(!1)}catch{}},E=()=>{v.current&&(clearTimeout(v.current),v.current=null)};S.useEffect(()=>()=>{E()},[]),S.useEffect(()=>{if(C.current)try{C.current.draggable(x.current)}catch{}},[g]);const P=A=>{A.cancelBubble=!0,d(e,{isEditing:!0})},F=A=>{d(e,{x:A.target.x(),y:A.target.y()})};return l.jsxs(sc,{ref:C,x:t,y:r,draggable:g,dragBoundFunc:A=>x.current?A:{x:t,y:r},name:"textbox-group",onClick:A=>{A.cancelBubble=!0,u(e)},onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblClick:P,onDblTap:P,onPointerDown:A=>{A.cancelBubble=!0;const j=A.evt||{};w.current={x:j.clientX??0,y:j.clientY??0},E(),v.current=setTimeout(()=>{_()},400)},onPointerMove:A=>{if(!v.current)return;const j=A.evt||{},I=Math.abs((j.clientX??0)-w.current.x),L=Math.abs((j.clientY??0)-w.current.y);(I>k||L>k)&&E()},onPointerUp:A=>{A.cancelBubble=!0,E(),N()},onPointerLeave:()=>{E(),N()},onDragEnd:A=>{F(A),N()},children:[l.jsx($a,{width:n,height:s,fill:c?"#fef3c7":"#ffffff",stroke:c?"#f59e0b":"#d1d5db",strokeWidth:c?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1},name:"textbox-rect",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}}),l.jsx(zc,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word",name:"textbox-text",onTap:A=>{A.cancelBubble=!0,u(e),E()},onDblTap:A=>{A.cancelBubble=!0,P(A)}})]})},rae=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=S.useRef(null);S.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const c=u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),a(o.current.value)):u.key==="Escape"&&i()};return l.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:c,onBlur:()=>a(o.current.value)})},nae=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:c,isPanning:u,isFullscreen:d,constrainPanPosition:f,handleWheel:g,stageRef:p,setIsPanning:x,responsiveDimensions:v,canvasSize:w,question:C,textBoxes:k,setTextBoxes:_,selectedTextBox:N,setSelectedTextBox:E,handleTextBoxSelect:P,handleTextBoxUpdate:F,handleTextBoxDelete:A,isEditingText:j,editingTextBox:I,setIsEditingText:L,setEditingTextBox:Y,setCurrentTool:Z})=>{const[ae,ee]=S.useState(!1),[ne,B]=S.useState([]),[V,M]=S.useState(null),[H,W]=S.useState(null),R=S.useRef(null),[z,K]=S.useState(.25),[J,se]=S.useState({x:0,y:0}),X=S.useRef(null),ie=S.useRef(null),le=S.useRef(!1),ce=6;S.useEffect(()=>{const ke=()=>{const $e=R.current;if(!$e)return;const Ue=$e.clientWidth||1,Et=$e.clientHeight||1,Ft=Math.min(Ue/(w.width||1),Et/(w.height||1));K(Math.min(Ft,1))};return ke(),window.addEventListener("resize",ke),()=>window.removeEventListener("resize",ke)},[w.width,w.height,d]);const be=ke=>{const $e=p.current,Ue=$e.getPointerPosition();if(s==="pan"){if(Me(ke.target))try{$e.draggable(!1),le.current=!0}catch{}return}if(s==="text"){const Ft={x:(Ue.x-$e.x())/$e.scaleX(),y:(Ue.y-$e.y())/$e.scaleY()};X.current={...Ft},ie.current={x:Ue.x,y:Ue.y};return}ee(!0);const Et={x:(Ue.x-$e.x())/$e.scaleX(),y:(Ue.y-$e.y())/$e.scaleY()};W(Et),s==="pencil"?B([{x:Et.x,y:Et.y,color:a,thickness:i}]):s==="eraser"?B([{x:Et.x,y:Et.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&M({type:s,startX:Et.x,startY:Et.y,endX:Et.x,endY:Et.y,color:a,thickness:i})},re=ke=>{const $e=p.current,Ue=$e.getPointerPosition(),Et={x:(Ue.x-$e.x())/$e.scaleX(),y:(Ue.y-$e.y())/$e.scaleY()};if(se(Et),s!=="pan"){if(s==="text"&&X.current&&ie.current){const Ft=Math.abs(Ue.x-ie.current.x),zt=Math.abs(Ue.y-ie.current.y);(Ft>ce||zt>ce)&&(X.current=null)}if(ae)if(s==="pencil"){const Ft=[...ne,{x:Et.x,y:Et.y,color:a,thickness:i}];B(Ft)}else if(s==="eraser"){const Ft=[...ne,{x:Et.x,y:Et.y,color:a,thickness:i,tool:"eraser"}];B(Ft)}else["line","rectangle","circle"].includes(s)&&V&&M({...V,endX:Et.x,endY:Et.y})}},pe=ke=>{const $e=p.current;if(s==="pan"){if(le.current){try{$e.draggable(!0)}catch{}le.current=!1}return}if(s==="text"&&X.current){const Ue=ke&&ke.target;if(Ue&&typeof Ue.name=="function"&&Ue.name()==="canvas-bg"){const Ft={id:Date.now(),x:X.current.x,y:X.current.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};_(zt=>[...zt,Ft]),E(Ft.id)}X.current=null,ie.current=null}if(ae){if(s==="pencil"){const Ue=[...r,ne];n(Ue),B([])}else if(s==="eraser"){const Ue=[...r,ne];n(Ue),B([])}else if(["line","rectangle","circle"].includes(s)&&V){const Ue=[...r,V];n(Ue),M(null)}ee(!1),W(null)}},[Ce,Ae]=S.useState(null),[We,Le]=S.useState(null),[At,Qe]=S.useState(!1),[gt,ht]=S.useState(null),[tt,ut]=S.useState(!1),[Dt,Rt]=S.useState(!1),[It,De]=S.useState([]),[Ie,Je]=S.useState(null),[qe,Ze]=S.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Tt=null;const $t=(window.devicePixelRatio||1)>1.5,ir={scaleDelta:$t?.03:.04,centerDelta:$t?4:6,minTouchDistance:8,gestureHysteresis:.02},pr=()=>{ut(!1),ht(null),Ae(null),Le(null),ee(!1),W(null),Rt(!1),Je(null),Tt&&(cancelAnimationFrame(Tt),Tt=null),p.current&&p.current.stop()},Nr=ke=>{if(ke.length<2)return 0;const $e=ke[0],Ue=ke[1];return Math.sqrt(Math.pow(Ue.clientX-$e.clientX,2)+Math.pow(Ue.clientY-$e.clientY,2))},dr=ke=>{if(ke.length<2)return null;const $e=ke[0],Ue=ke[1];return{x:($e.clientX+Ue.clientX)/2,y:($e.clientY+Ue.clientY)/2}},Vt=ke=>{De($e=>[...$e,{type:ke,timestamp:Date.now()}].slice(-5))},ge=()=>{const ke=Date.now(),$e=It.filter(Ft=>ke-Ft.timestamp<500);if($e.length<2)return 0;const Ue=$e[$e.length-1],Et=$e[$e.length-2];return Ue.type===Et.type?ir.gestureHysteresis:0},Te=(ke,$e)=>{Ze(Ue=>({totalGestures:Ue.totalGestures+1,zoomGestures:ke.includes("zoom")?Ue.zoomGestures+1:Ue.zoomGestures,panGestures:ke.includes("pan")?Ue.panGestures+1:Ue.panGestures,combinedGestures:ke==="zoom+pan"?Ue.combinedGestures+1:Ue.combinedGestures,averageResponseTime:(Ue.averageResponseTime+$e)/2}))},Fe=(ke,$e,Ue,Et)=>{const Ft=p.current,zt=Ft.scaleX(),fr=Ft.position();let nr=zt,Dr=fr;if(ke){const ye=Ue/Ce,xe=zt*ye,_e=C?.max_canvas_width||1536,Se=C?.max_canvas_height||2048,Ve=_e/w.width,lt=Se/w.height,Ke=Math.min(Ve,lt,1);nr=Math.max(.25,Math.min(Ke,xe));const oe=Et,fe={x:(oe.x-Ft.x())/zt,y:(oe.y-Ft.y())/zt};Dr={x:oe.x-fe.x*nr,y:oe.y-fe.y*nr}}if($e){const ye=Et.x-We.x,xe=Et.y-We.y;ke?Dr={x:Dr.x+ye,y:Dr.y+xe}:Dr={x:fr.x+ye,y:fr.y+xe}}Tt||(Tt=requestAnimationFrame(()=>{Ft.scale({x:nr,y:nr}),Ft.position(Dr),Ft.batchDraw(),Tt=null})),ke&&$e?(ht("zoom+pan"),Rt(!0)):ke?(ht("zoom"),Rt(!0)):$e&&ht("pan");const we=Date.now()-(Ie||Date.now());Te(ke&&$e?"zoom+pan":ke?"zoom":"pan",we),console.log(" Combined gesture",{doZoom:ke,doPan:$e,scale:nr.toFixed(2),pos:Dr})},Me=ke=>{if(!ke||typeof ke.name!="function")return!1;if((ke.name()||"").includes("textbox-"))return!0;const Ue=ke.getParent&&ke.getParent();return Ue&&typeof Ue.name=="function"&&(Ue.name()||"").includes("textbox-")},kt=ke=>{const $e=ke.evt.touches,Ue=ke.target;if(Me(Ue)){if(s==="pan"&&p.current)try{p.current.draggable(!1),le.current=!0}catch{}return}$e.length===2?(ke.evt.preventDefault(),ut(!0),ht(null),Ae(Nr($e)),Le(dr($e)),ee(!1),Je(Date.now())):$e.length===1&&(ut(!1),ht(null),be(ke))},Pe=ke=>{const $e=ke.evt.touches,Ue=ke.target;if(!Me(Ue))if($e.length===2&&tt){ke.evt.preventDefault();const Et=p.current,Ft=Nr($e),zt=dr($e);if(Ce&&We&&Et&&Ft>ir.minTouchDistance){const fr=Math.abs(Ft/Ce-1),nr=Math.sqrt(Math.pow(zt.x-We.x,2)+Math.pow(zt.y-We.y,2)),Dr=ge(),ue=ir.scaleDelta-Dr,we=ir.centerDelta-Dr*10,ye=fr>ue,xe=nr>we;(ye||xe)&&(Fe(ye,xe,Ft,zt),ye&&xe?Vt("zoom+pan"):ye?Vt("zoom"):xe&&Vt("pan")),console.log(" Gesture Debug",{scaleDelta:fr.toFixed(3),centerDelta:nr.toFixed(1),doZoom:ye,doPan:xe,hysteresis:Dr.toFixed(3),adjustedScaleDelta:ue.toFixed(3),adjustedCenterDelta:we.toFixed(1),gestureHistory:It.slice(-3)})}Ae(Ft),Le(zt)}else $e.length===1&&!tt&&(ke.evt.preventDefault(),re())},He=ke=>{const $e=ke.evt.touches,Ue=ke.target;Me(Ue)||($e.length===0?(pe(ke),pr(),Rt(!1)):$e.length===1&&(ut(!1),ht(null),Ae(null),Le(null),Rt(!1)))};return l.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:l.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:l.jsxs("div",{className:"relative",style:{border:d&&(v.width<window.innerWidth-40||v.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[l.jsx("div",{ref:R,className:"w-full h-full",style:{touchAction:"manipulation"},children:l.jsx(e0,{ref:p,width:v.width,height:v.height,scaleX:d?v.zoom:o,scaleY:d?v.zoom:o,onMouseDown:be,onMousemove:re,onMouseup:pe,onTouchStart:kt,onTouchMove:Pe,onTouchEnd:He,onWheel:g||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&x(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(x(!1),f)){const ke=p.current,$e=R.current,Ue=$e?.clientWidth||v.width,Et=$e?.clientHeight||v.height,Ft=w.width*ke.scaleX(),zt=w.height*ke.scaleY(),fr=ke.x(),nr=ke.y();(fr>Ue||fr<-Ft||nr>Et||nr<-zt)&&f(ke)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",v.width,"x",v.height),console.log(" DrawingTestStudent - Canvas size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(w.width*o),"x",Math.round(w.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(w.width*o*w.height*o))},children:l.jsxs(Zh,{children:[l.jsx($a,{x:0,y:0,width:w.width,height:w.height,fill:"white",name:"canvas-bg"}),r.map((ke,$e)=>{if(Array.isArray(ke)){const Ue=ke[0]?.tool==="eraser";return l.jsx(ai,{points:ke.flatMap(Et=>[Et.x,Et.y]),stroke:Ue?"black":ke[0]?.color||"#000000",strokeWidth:Ue?(ke[0]?.thickness||2)*7:ke[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:Ue?"destination-out":"source-over"},$e)}else{if(ke.type==="line")return l.jsx(ai,{points:[ke.startX,ke.startY,ke.endX,ke.endY],stroke:ke.color,strokeWidth:ke.thickness,lineCap:"round"},$e);if(ke.type==="rectangle"){const Ue=Math.abs(ke.endX-ke.startX),Et=Math.abs(ke.endY-ke.startY),Ft=Math.min(ke.startX,ke.endX),zt=Math.min(ke.startY,ke.endY);return l.jsx($a,{x:Ft,y:zt,width:Ue,height:Et,stroke:ke.color,strokeWidth:ke.thickness,fill:"transparent"},$e)}else if(ke.type==="circle"){const Ue=Math.sqrt(Math.pow(ke.endX-ke.startX,2)+Math.pow(ke.endY-ke.startY,2))/2,Et=(ke.startX+ke.endX)/2,Ft=(ke.startY+ke.endY)/2;return l.jsx(pf,{x:Et,y:Ft,radius:Ue,stroke:ke.color,strokeWidth:ke.thickness,fill:"transparent"},$e)}}return null}),k.map(ke=>l.jsx(tae,{...ke,isSelected:N===ke.id,onSelect:P,onUpdate:F,onDelete:A},ke.id)),s==="pencil"&&l.jsx(ai,{points:ne.flatMap(ke=>[ke.x,ke.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&l.jsx(ai,{points:ne.flatMap(ke=>[ke.x,ke.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),V&&V.type==="line"&&l.jsx(ai,{points:[V.startX,V.startY,V.endX,V.endY],stroke:V.color,strokeWidth:V.thickness,lineCap:"round"}),V&&V.type==="rectangle"&&l.jsx($a,{x:Math.min(V.startX,V.endX),y:Math.min(V.startY,V.endY),width:Math.abs(V.endX-V.startX),height:Math.abs(V.endY-V.startY),stroke:V.color,strokeWidth:V.thickness,fill:"transparent"}),V&&V.type==="circle"&&l.jsx(pf,{x:(V.startX+V.endX)/2,y:(V.startY+V.endY)/2,radius:Math.sqrt(Math.pow(V.endX-V.startX,2)+Math.pow(V.endY-V.startY,2))/2,stroke:V.color,strokeWidth:V.thickness,fill:"transparent"}),s==="eraser"&&l.jsx(pf,{x:J.x,y:J.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&l.jsx(ai,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&l.jsx(ai,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&l.jsx(ai,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&l.jsx(ai,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),j&&I&&l.jsx(rae,{x:I.x,y:I.y,width:I.width,height:I.height,initialText:I.text,onSave:ke=>{F(I.id,{text:ke}),L(!1),Y(null)},onCancel:()=>{L(!1),Y(null)}}),l.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[l.jsx("button",{onClick:()=>{const ke=p.current,$e=ke.scaleX(),Ue=C?.max_canvas_width||1536,Et=C?.max_canvas_height||2048,Ft=Ue/w.width,zt=Et/w.height,fr=Math.min(Ft,zt,5),nr=Math.min(fr,ke.scaleX()*1.2);ke.scale({x:nr,y:nr}),ke.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",$e.toFixed(2),"->",nr.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*nr),"x",Math.round(w.height*nr)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*nr*w.height*nr),"pixels"),c(nr)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),l.jsx("button",{onClick:()=>{const ke=p.current,$e=ke.scaleX(),Ue=Math.max(.25,ke.scaleX()*.8);ke.scale({x:Ue,y:Ue}),ke.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",$e.toFixed(2),"->",Ue.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(w.width*Ue),"x",Math.round(w.height*Ue)),console.log(" DrawingTestStudent - New resolution:",Math.round(w.width*Ue*w.height*Ue),"pixels"),c(Ue)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),l.jsx("button",{onClick:()=>{const ke=p.current,$e=ke.scaleX();ke.scale({x:1,y:1}),ke.position({x:0,y:0}),ke.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",$e.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",w.width,"x",w.height),console.log(" DrawingTestStudent - Reset resolution:",w.width*w.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),l.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},sae=({content:e})=>{if(!e)return l.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return l.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},aae=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{ka();const[o,c]=S.useState([]),[u,d]=S.useState(!0),[f,g]=S.useState("pencil"),[p,x]=S.useState("#000000"),[v,w]=S.useState(2),[C,k]=S.useState([]),[_,N]=S.useState(-1),[E,P]=S.useState({width:600,height:800}),[F,A]=S.useState(1),[j,I]=S.useState(!1),[L,Y]=S.useState(!1),[Z,ae]=S.useState(!1),[ee,ne]=S.useState([]),[B,V]=S.useState(null),[M,H]=S.useState(!1),[W,R]=S.useState(null),z=_>0,K=_<C.length-1,[J,se]=S.useState(!1),X=S.useRef(null),ie=S.useRef(null),[le,ce]=S.useState({width:600,height:800}),be=S.useRef(!1),[re,pe]=S.useState(.25),Ce=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];S.useEffect(()=>{const De=()=>{ae(window.innerWidth>=1024)};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[]),S.useEffect(()=>{if(e){const De=e.max_canvas_width||1536,Ie=e.max_canvas_height||2048,Je=e.canvas_width||600,qe=e.canvas_height||800;if(P({width:De,height:Ie}),be.current)console.log(" DrawingTestStudent - Preserving user zoom:",F.toFixed(2));else{A(1),be.current=!0;const Tt=(Je-De*1)/2,Nt=(qe-Ie*1)/2;if(!isNaN(Tt)&&!isNaN(Nt)&&X.current){const $t={x:Tt,y:Nt};X.current.position($t),X.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",De,"x",Ie),console.log(" DrawingTestStudent - Viewport size:",Je,"x",qe),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",De*Ie,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(De/Ie).toFixed(2))}if(r&&typeof r=="string")try{const Ze=JSON.parse(r);Ze.lines?c(Ze.lines):c(Ze),Ze.textBoxes&&ne(Ze.textBoxes)}catch{console.log("No valid drawing data found")}d(!1)}},[e,r]),S.useEffect(()=>{const De=()=>{const Ie=ie.current;if(!Ie)return;const Je=Ie.clientWidth||1,qe=Ie.clientHeight||1,Ze=Math.min(Je/(E.width||1),qe/(E.height||1));pe(Math.min(Ze,1))};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[E.width,E.height,J]);const Ae=De=>{c(De);const Ie={lines:De,textBoxes:ee};n(e.question_id,JSON.stringify(Ie)),We(De,ee)},We=(De,Ie=ee)=>{const Je=C.slice(0,_+1);Je.push({lines:[...De],textBoxes:[...Ie]}),k(Je),N(Je.length-1)},Le=()=>{if(z){const De=_-1,Ie=C[De];if(Ie&&typeof Ie=="object"&&Ie.lines){c([...Ie.lines]),ne([...Ie.textBoxes]);const Je={lines:Ie.lines,textBoxes:Ie.textBoxes};n(e.question_id,JSON.stringify(Je))}else{const Je=Ie||[];c([...Je]),n(e.question_id,JSON.stringify(Je))}N(De)}},At=()=>{if(K){const De=_+1,Ie=C[De];if(Ie&&typeof Ie=="object"&&Ie.lines){c([...Ie.lines]),ne([...Ie.textBoxes]);const Je={lines:Ie.lines,textBoxes:Ie.textBoxes};n(e.question_id,JSON.stringify(Je))}else{const Je=Ie||[];c([...Je]),n(e.question_id,JSON.stringify(Je))}N(De)}},Qe=()=>{c([]),ne([]),V(null),n(e.question_id,"")},gt=De=>{V(De)},ht=(De,Ie)=>{const Je=ee.map(Ze=>Ze.id===De?{...Ze,...Ie}:Ze);ne(Je),We(o,Je);const qe={lines:o,textBoxes:Je};if(n(e.question_id,JSON.stringify(qe)),Ie.isEditing){const Ze=ee.find(Tt=>Tt.id===De);R(Ze),H(!0)}},tt=De=>{const Ie=ee.filter(qe=>qe.id!==De);ne(Ie),B===De&&V(null),We(o,Ie);const Je={lines:o,textBoxes:Ie};n(e.question_id,JSON.stringify(Je))},ut=()=>{if(J){const Je=e?.canvas_width||600,qe=e?.canvas_height||800,Ze=window.innerWidth-40,Tt=window.innerHeight-40,Nt=Ze/Je,$t=Tt/qe,ir=Math.min(Nt,$t,1);return{width:Je,height:qe,zoom:ir}}const De=e?.canvas_width||600,Ie=e?.canvas_height||800;return{width:De,height:Ie,zoom:1}};S.useEffect(()=>{const De=()=>{ce(ut())};return De(),window.addEventListener("resize",De),()=>window.removeEventListener("resize",De)},[J,E]);const Dt=De=>{De.evt.preventDefault();const Ie=X.current,Je=Ie.scaleX(),qe=Ie.getPointerPosition(),Ze={x:(qe.x-Ie.x())/Je,y:(qe.y-Ie.y())/Je},Tt=De.evt.deltaY>0?Je*.9:Je*1.1,Nt=e?.max_canvas_width||1536,$t=e?.max_canvas_height||2048,ir=Nt/E.width,pr=$t/E.height,Nr=Math.min(ir,pr,1),dr=Math.max(re,Math.min(Nr,Tt)),Vt={x:qe.x-Ze.x*dr,y:qe.y-Ze.y*dr};if(dr<=re&&ie.current){const ge=ie.current.clientWidth||1,Te=ie.current.clientHeight||1;Vt.x=(ge-E.width*dr)/2,Vt.y=(Te-E.height*dr)/2}Ie.scale({x:dr,y:dr}),Ie.position(Vt),Ie.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",Je.toFixed(2),"->",dr.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(E.width*dr),"x",Math.round(E.height*dr)),console.log(" DrawingTestStudent - New resolution:",Math.round(E.width*dr*E.height*dr),"pixels"),A(dr),be.current=!0},Rt=De=>{const Ie=De.scaleX(),Je=ie.current,qe=Je?.clientWidth||le.width,Ze=Je?.clientHeight||le.height,Tt=E.width*Ie,Nt=E.height*Ie;if(Ie<=re){const Fe=(qe-Tt)/2,Me=(Ze-Nt)/2;De.position({x:Fe,y:Me}),De.batchDraw();return}if(Tt<=qe&&Nt<=Ze){const Fe=(qe-Tt)/2,Me=(Ze-Nt)/2;De.position({x:Fe,y:Me}),De.batchDraw();return}const $t=Math.max(0,Tt-qe),ir=Math.max(0,Nt-Ze),pr=-$t,Nr=-ir,dr=De.x(),Vt=De.y(),ge=Math.max(pr,Math.min($t,dr)),Te=Math.max(Nr,Math.min(ir,Vt));(ge!==dr||Te!==Vt)&&(De.position({x:ge,y:Te}),De.batchDraw())},It=()=>{if(J)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const De=ie.current;De&&(De.requestFullscreen?De.requestFullscreen():De.webkitRequestFullscreen?De.webkitRequestFullscreen():De.msRequestFullscreen&&De.msRequestFullscreen())}};return S.useEffect(()=>{const De=()=>{se(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",De),document.addEventListener("webkitfullscreenchange",De),document.addEventListener("msfullscreenchange",De),()=>{document.removeEventListener("fullscreenchange",De),document.removeEventListener("webkitfullscreenchange",De),document.removeEventListener("msfullscreenchange",De)}},[]),S.useEffect(()=>()=>{X.current&&X.current.stop()},[]),u?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx(Hr,{})}):e?l.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${J?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!J&&l.jsx("div",{className:"mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!J&&e.question_json&&e.question_json.trim()&&l.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),l.jsx("div",{className:"text-gray-700",children:l.jsx(sae,{content:e.question_json})})]}),!J&&l.jsx(jt,{className:"p-1 sm:p-2 mb-2",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),l.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[l.jsx("button",{onClick:()=>g("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),l.jsx("button",{onClick:()=>g("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),l.jsx("button",{onClick:()=>g("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),l.jsx("button",{onClick:()=>g("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),l.jsx("button",{onClick:()=>g("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),l.jsx("button",{onClick:()=>g("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),l.jsx("button",{onClick:()=>g("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Le,disabled:!z,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${z?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),l.jsx("button",{onClick:At,disabled:!K,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${K?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(!j),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:p}}),l.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),j&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:l.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:Ce.map(De=>l.jsx("button",{onClick:()=>{x(De),I(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${p===De?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:De},title:De},De))})})]}),l.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[l.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),l.jsx("input",{type:"range",min:"1",max:"10",value:v,onChange:De=>w(parseInt(De.target.value)),className:"w-16 sm:w-20"}),l.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[v,"px"]})]}),l.jsx(et,{onClick:Qe,variant:"secondary",size:"sm",children:"Clear"})]})}),l.jsx(jt,{paddingClass:"p-0 sm:p-2",children:l.jsxs("div",{ref:ie,className:"w-full drawing-canvas-container relative p-0 m-0",children:[l.jsx(nae,{width:E.width,height:E.height,lines:o,onDrawingChange:Ae,currentTool:f,currentColor:p,currentThickness:v,zoom:F,onZoomChange:A,isPanning:L,isFullscreen:J,constrainPanPosition:Rt,handleWheel:Dt,stageRef:X,setIsPanning:Y,responsiveDimensions:le,canvasSize:E,question:e,textBoxes:ee,setTextBoxes:ne,selectedTextBox:B,setSelectedTextBox:V,handleTextBoxSelect:gt,handleTextBoxUpdate:ht,handleTextBoxDelete:tt,isEditingText:M,editingTextBox:W,setIsEditingText:H,setEditingTextBox:R,setCurrentTool:g}),l.jsx("button",{onClick:It,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:J?"Exit Fullscreen":"Enter Fullscreen",children:J?l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},xk={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),c=await o.json();return await this.handleLoginResponse(o,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await Ns.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await Ns.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await Ns.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await Ns.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await Ns.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},iae=()=>{const e=Eo(),{login:t,setUserData:r,isAuthenticated:n,user:s}=cs(),[a,i]=S.useState({username:"",password:""}),[o,c]=S.useState(!1),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,x]=S.useState(!1);S.useEffect(()=>{v()},[]);const v=S.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const L=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());L&&L.role?console.log("User role from JWT:",L.role):console.log("No valid role found in JWT, showing login")}catch(L){console.error("Error decoding JWT token:",L)}}else console.log("No valid JWT session found, showing login")},[]),w=S.useCallback(async L=>{if(L.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),A("Please wait for the logout process to complete.","warning");return}const{username:Y,password:Z}=a;if(!Y||!Z){d("Please enter both username and password");return}c(!0),d("");try{let ae,ee;Y==="admin"?(ae=await xk.adminLogin({username:Y,password:Z}),ee=Qi.ADMIN):/^\d+$/.test(Y)?(ae=await xk.studentLogin({username:Y,password:Z}),ee=Qi.STUDENT):(ae=await xk.teacherLogin({username:Y,password:Z}),ee=Qi.TEACHER);let ne,B;if(ae.response?(ne=ae,B=ae.response):(ne=await ae.json(),B=ae),await C(B,ee,ne)){A("Login successful!","success");try{if("credentials"in navigator&&window.PasswordCredential&&a?.username&&a?.password){const V=new window.PasswordCredential({id:String(a.username),password:String(a.password)});await navigator.credentials.store(V)}}catch{}try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(ae){console.error("Login error:",ae),d("Invalid username or password")}finally{c(!1)}},[a]),C=S.useCallback(async(L,Y,Z)=>{if(L.ok&&Z.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),P(),!1;try{Z.token&&(window.tokenManager.setTokens(Z.token,Y),Z.refreshToken&&window.tokenManager.setRefreshToken(Z.refreshToken),console.log("JWT token stored successfully"));const ae={...Z.data,...Z,role:Y};return r(ae),await k(ae),!0}catch(ae){return console.error("Error handling login response:",ae),P(ae),!1}}else return console.error("Login failed:",Z.error||"Unknown error"),d(Z.error||"Login failed. Please check your credentials."),!1},[t]),k=S.useCallback(async L=>{if(console.log("Handling post-login actions for role:",L.role),p){console.log(" Post-login already handled, skipping");return}x(!0);try{switch(L.role){case Qi.STUDENT:await _(L),e("/student");break;case Qi.TEACHER:await N(L),e("/teacher");break;case Qi.ADMIN:await E(L),e("/admin");break;default:console.error("Unknown user role:",L.role),P()}}catch(Y){console.error("Error in post-login actions:",Y),P(Y)}},[e,p]);S.useEffect(()=>{n||x(!1)},[n]);const _=S.useCallback(async L=>{console.log("Populating student info:",L)},[]),N=S.useCallback(async L=>{console.log("Populating teacher info:",L)},[]),E=S.useCallback(async L=>{console.log("Populating admin info:",L)},[]),P=S.useCallback((L=null)=>{console.error("Login failure:",L),d("Login failed. Please check your credentials and try again."),F()},[]),F=S.useCallback(()=>{i({username:"",password:""}),d(""),c(!1)},[]),A=S.useCallback((L,Y)=>{const Z={id:Date.now(),message:L,type:Y,timestamp:new Date};g(ae=>[...ae,Z]),setTimeout(()=>{g(ae=>ae.filter(ee=>ee.id!==Z.id))},N0.NOTIFICATION_DURATION)},[]),j=S.useCallback(L=>{const{name:Y,value:Z}=L.target;i(ae=>({...ae,[Y]:Z})),u&&d("")},[u]),I=S.useCallback(L=>{L.key==="Enter"&&!o&&w(L)},[w,o]);return l.jsxs(at.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsxs(at.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsxs(at.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx(at.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:l.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),l.jsx(at.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),l.jsx(at.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),l.jsxs(at.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[l.jsx(at.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),l.jsxs("form",{onSubmit:w,className:"space-y-6",children:[l.jsxs(at.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),l.jsx(at.input,{type:"text",id:"username",name:"username",value:a.username,onChange:j,onKeyDown:I,placeholder:"Enter your username",required:!0,autoComplete:"username",autoCapitalize:"none",spellCheck:!1,disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsxs(at.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsx(at.input,{type:"password",id:"password",name:"password",value:a.password,onChange:j,onKeyDown:I,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsx(wo,{children:u&&l.jsx(at.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:l.jsx("p",{className:"text-sm text-red-600",children:u})})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:l.jsx(et,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:l.jsx(wo,{children:f.map(L=>l.jsx(at.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:l.jsx(uc,{type:L.type,message:L.message,onClose:()=>g(Y=>Y.filter(Z=>Z.id!==L.id))})},L.id))})})]})},hs={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],users:n.status==="fulfilled"?n.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.teacher_id||t.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.admin_id||t.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},NB=S.createContext(),AB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState([]),[o,c]=S.useState([]),[u,d]=S.useState([]),[f,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(!1),[_,N]=S.useState(null),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,I]=S.useState(!1),[L,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState(null),B=S.useCallback(async()=>{try{k(!0),N(null);const Te=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",Te);const Fe=Rs(Te);if(Fe){console.log(" UserContext: Cache HIT! Using cached student data"),s(Fe),V(Fe);return}console.log(" UserContext: Cache MISS! Fetching from API");const Me=await hs.getStudentData();if(Me)s(Me),V(Me),console.log(" UserContext: Caching student data with key:",Te),vs(Te,Me,Is.student_subjects);else throw new Error("No subjects data received")}catch(ge){N(ge.message||"Failed to load student data"),console.error("Error loading student data:",ge)}finally{k(!1)}},[t?.student_id,t?.id]),V=ge=>{console.log("Displaying student subjects:",ge),s(ge)},M=S.useCallback(async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),N("No valid teacher session found");return}const Te=`teacher_subjects_${t?.teacher_id||t?.id||""}`,Fe=Rs(Te);if(Fe){s(Fe),Fe.length===0?$t():H(Fe);return}const Me=await hs.getTeacherSubjects();if(Me.success)s(Me.subjects),vs(Te,Me.subjects,Is.teacher_subjects),Me.subjects.length===0?$t():H(Me.subjects);else throw new Error(Me.message||"Failed to load teacher data")}catch(ge){N(ge.message||"Failed to load teacher data"),console.error("Error loading teacher data:",ge)}finally{k(!1)}},[t?.teacher_id,t?.id]),H=ge=>{console.log("Showing main cabinet with subjects:",ge),s(ge)},W=ge=>{console.log("Displaying grade buttons:",ge),c(ge)},R=async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),N("No valid admin session found");return}await Promise.all([pe(),ht(),se()])}catch(ge){N(ge.message||"Failed to load admin data"),console.error("Error loading admin data:",ge)}finally{k(!1)}},z=ge=>{console.log(" populateStudentInfoDirectly called with:",ge);try{r(ge),console.log(" Set student profile:",ge)}catch(Te){console.error("Error populating student info:",Te)}},K=ge=>{console.log("=== populateStudentInfo called ==="),r(ge)},J=ge=>{console.log("=== populateTeacherInfo called ==="),r(ge)},se=S.useCallback(async()=>{try{k(!0);const ge="admin_users_",Te=Rs(ge);if(Te){d(Te),X(Te);return}const Fe=await hs.getAllUsers();if(Fe.success)d(Fe.users),X(Fe.users),vs(ge,Fe.users,Is.admin_users);else throw new Error(Fe.message||"Failed to load users")}catch(ge){N(ge.message||"Failed to load users"),console.error("Error loading users:",ge)}finally{k(!1)}},[]),X=ge=>{console.log("Displaying all users:",ge),d(ge)},ie=(ge,Te)=>{console.log("Displaying users table:",ge,Te),d(ge)},le=()=>{console.log("Toggling users content")},ce=()=>{console.log("Showing add user form"),P(!0)},be=()=>{console.log("Hiding add user form"),P(!1)},re=ge=>{console.log("Editing user row:",ge);const Te=u.find(Fe=>Fe.id===ge);Y(Te)},pe=S.useCallback(async()=>{try{const ge="admin_teachers_",Te=Rs(ge);if(Te){g(Te),Ce(Te);return}const Fe=await hs.getAllTeachers();if(Fe.success)g(Fe.teachers),Ce(Fe.teachers),vs(ge,Fe.teachers,Is.admin_teachers);else throw new Error(Fe.message||"Failed to load teachers")}catch(ge){N(ge.message||"Failed to load teachers"),console.error("Error loading teachers:",ge)}},[]),Ce=ge=>{console.log("Displaying all teachers:",ge),g(ge)},Ae=(ge,Te)=>{console.log("Displaying teachers table:",ge,Te),g(ge)},We=()=>{console.log("Toggling teachers content")},Le=()=>{console.log("Showing add teacher form"),A(!0)},At=()=>{console.log("Hiding add teacher form"),A(!1)},Qe=ge=>{console.log("Editing teacher:",ge);const Te=f.find(Fe=>Fe.id===ge);ae(Te)},gt=ge=>{console.log("Editing teacher row:",ge);const Te=f.find(Fe=>Fe.id===ge);ae(Te)},ht=S.useCallback(async()=>{try{const ge="admin_subjects_",Te=Rs(ge);if(Te){x(Te),tt(Te);return}const Fe=await hs.getAllSubjects();if(Fe.success)x(Fe.subjects),tt(Fe.subjects),vs(ge,Fe.subjects,Is.admin_subjects);else throw new Error(Fe.message||"Failed to load subjects")}catch(ge){N(ge.message||"Failed to load subjects"),console.error("Error loading subjects:",ge)}},[]),tt=ge=>{console.log("Displaying all subjects:",ge),x(ge)},ut=(ge,Te)=>{console.log("Displaying subjects table:",ge,Te),x(ge)},Dt=()=>{console.log("Toggling subjects content")},Rt=()=>{console.log("Showing add subject form"),I(!0)},It=()=>{console.log("Hiding add subject form"),I(!1)},De=ge=>{console.log("Editing subject row:",ge);const Te=p.find(Fe=>Fe.id===ge);ne(Te)},Ie=ge=>{console.log("Displaying academic year:",ge),w(ge)},Je=()=>{console.log("Showing add academic year form")},qe=()=>{console.log("Hiding add academic year form")},Ze=ge=>{console.log("Handling add academic year:",ge)},Tt=()=>{console.log("Toggling academic year content")},Nt=()=>{console.log("Showing academic year editor")},$t=()=>{console.log("Showing subject selection")},ir=()=>{console.log("Showing main cabinet")},pr=ge=>{r(Te=>({...Te,...ge}))},Nr=()=>{r(null),s([]),i([]),c([]),d([]),g([]),x([]),w([]),N(null)},dr=S.useCallback(ge=>{Nr(),ge&&mN(ge)},[]),Vt={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:f,allSubjects:p,academicYears:v,isLoading:C,error:_,showUserForm:E,showTeacherForm:F,showSubjectForm:j,editingUser:L,editingTeacher:Z,editingSubject:ee,loadStudentData:B,displayStudentSubjects:V,populateStudentInfoDirectly:z,populateStudentInfo:K,loadTeacherData:M,showMainCabinetWithSubjects:H,displayGradeButtons:W,populateTeacherInfo:J,showSubjectSelection:$t,showMainCabinet:ir,loadAdminData:R,getAllUsers:se,displayAllUsers:X,displayUsersTable:ie,toggleUsersContent:le,showAddUserForm:ce,hideAddUserForm:be,editUserRow:re,loadAllTeachers:pe,displayAllTeachers:Ce,displayTeachersTable:Ae,toggleTeachersContent:We,showAddTeacherForm:Le,hideAddTeacherForm:At,editTeacher:Qe,editTeacherRow:gt,loadAllSubjects:ht,displayAllSubjects:tt,displaySubjectsTable:ut,toggleSubjectsContent:Dt,showAddSubjectForm:Rt,hideAddSubjectForm:It,editSubjectRow:De,displayAcademicYear:Ie,showAddAcademicYearForm:Je,hideAddAcademicYearForm:qe,handleAddAcademicYear:Ze,toggleAcademicYearContent:Tt,showAcademicYearEditor:Nt,updateUserProfile:pr,clearUserData:Nr,clearUserDataWithCache:dr,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:d,setAllTeachers:g,setAllSubjects:x,setAcademicYears:w,setError:N};return l.jsx(NB.Provider,{value:Vt,children:e})},r2=()=>{const e=S.useContext(NB);if(!e)throw new Error("useUser must be used within a UserProvider");return e},Yx={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",UPDATE_SPEAKING_TEST_SCORE:"/.netlify/functions/update-speaking-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},On={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},Qi={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const N0={NOTIFICATION_DURATION:3e3},wf=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&Sm(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},Jy=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case On.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case On.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case On.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case On.MATCHING:r=e.correct_answer||e.answer;break;case On.WORD_MATCHING:r=e.correct_answer||e.answer;break;case On.DRAWING:r="Drawing required";break;case On.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},Sm=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case On.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case On.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const c=parseInt(o,10),u=c>=0?c:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case On.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const u=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1})}else{const o=t.toLowerCase().trim(),c=e.correct_answer.toLowerCase().trim();o===c?n=!0:c&&o.includes(c)?c.length===1?n=o.startsWith(c)||o.endsWith(c):n=!0:n=!1}break;case On.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case On.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case On.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case On.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))o=c.toUpperCase();else if(/^\d+$/.test(c)){const u=parseInt(c,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(o=String.fromCharCode(65+c))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n};class oae{constructor(){this.academicCalendar=null,this.loaded=!1}async loadAcademicCalendar(){if(this.loaded)return this.academicCalendar;try{const t=async n=>{const s=await fetch(n,{headers:{Accept:"application/json"},credentials:"include"}),a=s.headers&&s.headers.get&&s.headers.get("content-type")||"";if(!s.ok)throw new Error(`HTTP ${s.status}`);if(!a.includes("application/json"))throw new Error("Non-JSON response");return await s.json()};let r=null;if(r=await t("/academic_year.json"),!Array.isArray(r))throw new Error("Invalid academic calendar format");return this.academicCalendar=r,this.loaded=!0,console.log(" Academic calendar loaded:",this.academicCalendar.length,"terms"),this.academicCalendar}catch(t){return console.error(" Error loading academic calendar:",t),null}}getCurrentTerm(){if(!this.academicCalendar)return null;const t=new Date;return this.academicCalendar.find(n=>{const s=new Date(n.start_date),a=new Date(n.end_date);return t>=s&&t<=a})}getCurrentSemester(){const t=this.getCurrentTerm();if(!t)return null;const r=t.semester,n=this.academicCalendar.filter(s=>s.semester===r&&s.academic_year===t.academic_year);return{semester:r,currentTerm:t,allTerms:n}}getCurrentAcademicPeriodId(){return this.getCurrentTerm()?.id||null}getSemesterTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.semester===t):[]}getAcademicYearTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.academic_year===t):[]}getCurrentSemesterWithTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,allTerms:s,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getCurrentSemesterTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getTermById(t){return this.academicCalendar?this.academicCalendar.find(r=>r.id===t):null}isCurrentTerm(t){return this.getCurrentTerm()?.id===t}getAcademicYears(){return this.academicCalendar?[...new Set(this.academicCalendar.map(r=>r.academic_year))].sort():[]}getAcademicYearSemesterTerms(t,r){return this.academicCalendar?this.academicCalendar.filter(n=>n.academic_year===t&&n.semester===r):[]}}const rd=new oae,n2=Object.freeze(Object.defineProperty({__proto__:null,academicCalendarService:rd},Symbol.toStringTag,{value:"Module"})),hn={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(e=!1){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests",r=e?`${t}?ts=${Date.now()}`:t;console.log("[DEBUG] Fetching teacher tests from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Teacher tests data received:",s),s.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),s.tests;throw new Error(s.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const N=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(N.success)a=N.test_info;else throw new Error("Failed to get test information")}catch(_){console.error("Error getting test info:",_);const N=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:N.length}}const i=await this.getTestQuestions(e,t);let o,c;if(e==="drawing")o=null,c=null;else{const _=n?.answers_by_id?n.answers_by_id:r;o=wf(i,_,e).score,c=a.num_questions}const u=this.transformAnswersForSubmission(r,e),d=a.teacher_id||null,f=a.subject_id||null,g=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null);await rd.loadAcademicCalendar();const x=rd.getCurrentTerm()?.id;if(!x)throw new Error("No current academic period found");const v={test_id:t,test_name:a.test_name,test_type:e,teacher_id:d,subject_id:f,student_id:g,academic_period_id:x,answers:u,score:o,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",v.retest_assignment_id);let w;switch(e){case"multiple_choice":w="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":w="/.netlify/functions/submit-true-false-test";break;case"input":w="/.netlify/functions/submit-input-test";break;case"matching_type":w="/.netlify/functions/submit-matching-type-test";break;case"word_matching":w="/.netlify/functions/submit-word-matching-test";break;case"drawing":w="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":w="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",w),console.log("Submission data:",v),console.log("Submission data JSON:",JSON.stringify(v,null,2)),console.log(" Final submission retest_assignment_id:",v.retest_assignment_id);const C=await window.tokenManager.makeAuthenticatedRequest(w,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(v)});if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const k=await C.json();if(console.log("Test submission result:",k),k.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:c,result:k};throw new Error(k.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await Ns.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await Ns.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await Ns.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await Ns.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await Ns.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await Ns.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await Ns.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await Ns.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await Ns.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await Ns.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await Ns.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await Ns.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await Ns.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await Ns.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await Ns.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await Ns.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await Ns.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":const i=r.correct_answers||[],o=t.toLowerCase().trim();return i.some(c=>{const u=c.toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1});case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},jB=S.createContext(),PB=({children:e})=>{const[t,r]=S.useState(null),[n,s]=S.useState([]),[a,i]=S.useState({}),[o,c]=S.useState({}),[u,d]=S.useState(!1),[f,g]=S.useState(null),[p,x]=S.useState([]),[v,w]=S.useState(!1),[C,k]=S.useState(null),[_,N]=S.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[E,P]=S.useState(null),[F,A]=S.useState(0),{getItem:j,setItem:I,removeItem:L}=EB();S.useEffect(()=>{let ge;return u&&E&&(ge=setInterval(()=>{const Te=Math.floor((Date.now()-E)/1e3);A(Te)},1e3)),()=>{ge&&clearInterval(ge)}},[u,E]);const Y=async(ge,Te)=>{try{w(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${ge}, testId: ${Te}`);const Fe=await hn.getTestInfo(ge,Te);console.log("[DEBUG] Test info retrieved:",Fe);const Me=await hn.getTestQuestions(ge,Te);console.log("[DEBUG] Test questions retrieved:",Me),r({...Fe,testType:ge,testId:Te}),s(Me),d(!0),P(Date.now()),A(0),Z(ge,Te),console.log("[DEBUG] Test loaded successfully")}catch(Fe){k(Fe.message||"Failed to load test"),console.error("Error loading test:",Fe)}finally{w(!1)}},Z=(ge,Te)=>{try{const Fe=`test_progress_${ge}_${Te}`,Me=j(Fe);Me&&(i(Me.answers||{}),c(Me.progress||{}))}catch(Fe){console.error("Error loading saved progress:",Fe)}},ae=(ge,Te,Fe,Me)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Pe=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${ge}_${Te}`,He={...a,[Fe]:Me},ke={...o,[Fe]:{answered:!0,timestamp:Date.now()}};i(He),c(ke),I(Pe,{answers:He,progress:ke,lastSaved:Date.now()}),console.log(`Saved progress for question ${Fe}:`,Me)}catch(kt){console.error("Error saving test progress:",kt)}},ee=(ge,Te,Fe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const kt=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${ge}_${Te}`;return j(kt)?.answers?.[Fe]||null}catch(Me){return console.error("Error getting test progress:",Me),null}},ne=(ge,Te)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${ge}, testId: ${Te}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Fe=window.tokenManager?.getDecodedToken()?.sub||"unknown",Me=`test_progress_${Fe}_${ge}_${Te}`;console.log(`[DEBUG] Removing localStorage key: ${Me}`);const kt=j(Me)!==null;L(Me),i({}),c({});for(let Pe=0;Pe<localStorage.length;Pe++){const He=localStorage.key(Pe);He&&He.startsWith(`test_progress_${Fe}_${ge}_${Te}_`)&&(localStorage.removeItem(He),console.log(`[DEBUG] Cleared individual question key: ${He}`))}console.log(kt?`[DEBUG] Progress cleared for test ${ge}_${Te}`:`[DEBUG] No progress found to clear for test ${ge}_${Te}`)}catch(Fe){console.error("Error clearing test progress:",Fe)}},B=async(ge,Te,Fe="")=>{try{w(!0),k(null),console.log("Submitting test:",{testType:ge,testId:Te});const Me=se(ge,Te);if(Object.keys(Me).length===0){k("Please answer at least one question before submitting.");return}let kt;try{kt=await hn.getTestInfo(ge,Te)}catch(Ft){console.error("Error getting test info:",Ft);const zt=await hn.getTestQuestions(ge,Te);kt={test_name:`Test ${Te}`,num_questions:zt.length}}const Pe=await hn.getTestQuestions(ge,Te),He=wf(Pe,Me,ge),ke=kt.num_questions,$e=ie(Me,ge),Ue={test_id:Te,test_name:kt.test_name,score:He,maxScore:ke,answers:$e},Et=await hn.submitTest(ge,Te,Ue);if(Et.success){if(g(Et.result),W(ge,Te,Fe),ne(ge,Te),Fe){const Ft=`student_results_table_${Fe}`;ge!=="drawing"?(console.log(" TestContext: Caching test results after submission with key:",Ft),vs(Ft,Et.result,Is.student_results_table)):console.log(" TestContext: Skipping cache for drawing test submission (teacher-scored).")}return Fe&&Rm(Fe,ge,Te),d(!1),Et.results}else throw new Error(Et.message||"Test submission failed")}catch(Me){throw k(Me.message||"Failed to submit test"),Me}finally{w(!1)}},V=(ge,Te,Fe)=>{g({testType:ge,testId:Te,answers:Fe}),d(!1)},M=()=>{r(null),s([]),i({}),c({}),d(!1),g(null),k(null),P(null),A(0)},H=(ge,Te,Fe="")=>{try{const Me=`test_completed_${Fe}_${ge}_${Te}`;return j(Me)===!0}catch(Me){return console.error("Error checking test completion:",Me),!1}},W=(ge,Te,Fe="")=>{try{const Me=`test_completed_${Fe}_${ge}_${Te}`;I(Me,!0)}catch(Me){console.error("Error marking test completed:",Me)}},R=ge=>Object.keys(a).length,z=()=>{const ge=R(t?.testType),Te=n.length;return{canSubmit:ge===Te,answeredCount:ge,totalQuestions:Te}},K=()=>{t&&ne(t.testType,t.testId),M()},J=(ge="")=>{try{const Te=`student_results_table_${ge}`;console.log(" TestContext: Clearing test results cache:",Te),localStorage.removeItem(Te),console.log(" TestContext: Test results cache cleared")}catch(Te){console.error("Error clearing test results cache:",Te)}},se=(ge,Te)=>({...a}),X=(ge,Te,Fe=null)=>{try{if(!ge)return"No answer";switch(Te){case"true_false":return ge?"True":"False";case"multiple_choice":if(Fe&&typeof ge=="string"&&!isNaN(parseInt(ge))){const Me=parseInt(ge),kt=`option_${String.fromCharCode(97+Me)}`,Pe=Fe[kt];if(Pe)return Pe}return String(ge).toUpperCase();case"input":return String(ge);case"matching_type":return typeof ge=="object"?Object.entries(ge).map(([Me,kt])=>`${Me}  ${kt}`).join(", "):String(ge);case"word_matching":return typeof ge=="object"?Object.entries(ge).map(([Me,kt])=>`${Me}  ${kt}`).join(", "):String(ge);case"drawing":return"Drawing submitted";default:return String(ge)}}catch(Me){return console.error("Error formatting student answer:",Me),"Error displaying answer"}},ie=(ge,Te)=>{try{if(!ge||typeof ge!="object")return{};const Fe={};return Object.entries(ge).forEach(([Me,kt])=>{if(kt!=null)switch(Te){case"true_false":Fe[Me]=!!kt;break;case"multiple_choice":Fe[Me]=String(kt).toUpperCase();break;case"input":Fe[Me]=String(kt).trim();break;case"matching_type":typeof kt=="object"?Fe[Me]=kt:Fe[Me]=String(kt);break;case"word_matching":typeof kt=="object"?Fe[Me]=kt:Fe[Me]=String(kt);break;case"drawing":Fe[Me]=kt;break;default:Fe[Me]=kt}}),Fe}catch(Fe){return console.error("Error transforming answers for submission:",Fe),ge||{}}},le=S.useCallback(async(ge="")=>{try{w(!0);const Te=`student_active_tests_${ge}`,Fe=Rs(Te);if(Fe)return x(Fe),Fe;const Me=await hn.getActiveTests();return x(Me),vs(Te,Me,Is.student_active_tests),Me}catch(Te){return k(Te.message||"Failed to load active tests"),x([]),[]}finally{w(!1)}},[]),ce=async()=>{try{return w(!0),await hn.getTeacherTests()}catch(ge){return k(ge.message||"Failed to load teacher tests"),[]}finally{w(!1)}},be=async ge=>{try{return w(!0),await hn.createTest(ge)}catch(Te){throw k(Te.message||"Failed to create test"),Te}finally{w(!1)}},re=async(ge,Te)=>{try{return w(!0),await hn.deleteTest(ge,Te)}catch(Fe){throw k(Fe.message||"Failed to delete test"),Fe}finally{w(!1)}},pe=async(ge,Te)=>{try{return await hn.getTestInfo(ge,Te)}catch(Fe){throw console.error("Error getting test info:",Fe),Fe}},Ce=async(ge,Te)=>{try{return await hn.getTestQuestions(ge,Te)}catch(Fe){throw console.error("Error getting test questions:",Fe),Fe}},Ae=async(ge,Te,Fe)=>{try{console.log("Showing test results:",{testType:ge,testId:Te,studentAnswers:Fe});const Me=await pe(ge,Te),kt=await Ce(ge,Te);At(Me,kt,ge,Fe),d(!1),console.log("Test results displayed successfully")}catch(Me){console.error("Error showing test results:",Me),k("Failed to display test results"),g({testType:ge,testId:Te,answers:Fe,showResults:!0,error:"Could not load detailed results"}),d(!1)}},We=async(ge,Te,Fe)=>{try{w(!0);const Me=await pe(ge,Te),kt=await Ce(ge,Te);At(Me,kt,ge,Fe)}catch(Me){k(Me.message||"Failed to load test results")}finally{w(!1)}},Le=S.useCallback(async(ge="")=>{try{w(!0);const Te=`student_results_table_${ge}`;console.log(" TestContext: Checking cache for key:",Te);const Fe=Rs(Te);if(Fe)return console.log(" TestContext: Cache HIT! Using cached test results"),g(Fe),Fe;console.log(" TestContext: Cache MISS! Fetching from API");const Me=await hn.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Me),console.log(" TestContext: Results data:",Me?.results||Me),console.log(" TestContext: Results length:",Me?.results?.length||0),g(Me),console.log(" TestContext: Caching test results with key:",Te),console.log(" TestContext: Results being cached:",Me),console.log(" TestContext: Results.results being cached:",Me.results),vs(Te,Me,Is.student_results_table),Me}catch(Te){throw console.error("Error loading test results:",Te),k(Te.message||"Failed to load test results"),Te}finally{w(!1)}},[]),At=(ge,Te,Fe,Me)=>{try{console.log("Displaying test results:",{testInfo:ge,questions:Te,testType:Fe,studentAnswers:Me});const kt=wf(Te,Me,Fe),Pe=ge?.num_questions||Te?.length||0,He=Pe>0?Math.round(kt/Pe*100):0,ke=He>=60,$e=Te.map((Ue,Et)=>{const Ft=Ue.question_id||Ue.id,zt=Me[Ft],fr=Sm(Ue,zt,Fe);return{questionNumber:Et+1,question:Ue.question||Ue.question_text,userAnswer:X(zt,Fe),correctAnswer:Jy(Ue,Fe),isCorrect:fr,questionType:Fe}});g({testInfo:ge,questions:Te,testType:Fe,studentAnswers:Me,showResults:!0,score:kt,totalQuestions:Pe,percentage:He,passed:ke,questionAnalysis:$e,timestamp:new Date().toISOString()}),c(Ue=>({...Ue,score:kt,totalQuestions:Pe,percentage:He,passed:ke,lastUpdated:Date.now()})),Qe(),console.log(`Test results displayed: ${kt}/${Pe} (${He}%) - ${ke?"PASSED":"FAILED"}`)}catch(kt){console.error("Error displaying test results:",kt),k("Failed to display test results")}},Qe=S.useCallback(()=>{try{console.log("Setting up test results page event listeners");const ge=Pe=>{if(Pe.key==="Escape"&&K(),Pe.ctrlKey&&Pe.key==="p"&&(Pe.preventDefault(),window.print()),Pe.key==="Enter"&&f&&!f.passed){const He=document.getElementById("retake-test-button");He&&He.click()}},Te=()=>{window.print()},Fe=()=>{if(f){const Pe=`Test: ${f.testInfo?.test_name||"Test"}
Score: ${f.score}/${f.totalQuestions} (${f.percentage}%)
Status: ${f.passed?"PASSED":"FAILED"}
Completed: ${new Date(f.timestamp).toLocaleString()}`;navigator.clipboard.writeText(Pe).then(()=>{console.log("Results copied to clipboard")}).catch(He=>{console.error("Failed to copy results:",He)})}};document.addEventListener("keydown",ge);const Me=document.getElementById("print-results");Me&&Me.addEventListener("click",Te);const kt=document.getElementById("copy-results");return kt&&kt.addEventListener("click",Fe),()=>{document.removeEventListener("keydown",ge),Me&&Me.removeEventListener("click",Te),kt&&kt.removeEventListener("click",Fe)}}catch(ge){console.error("Error setting up test results page event listeners:",ge)}},[K,f]),gt=async(ge,Te,Fe)=>{try{w(!0),k(null),console.log("Viewing test details:",{testType:ge,testId:Te,testName:Fe}),N({isOpen:!0,testType:ge,testId:Te,testName:Fe,questions:[],isLoading:!0});const Me=await hn.getTestQuestions(ge,Te);Me&&Me.length>0?(N({isOpen:!0,testType:ge,testId:Te,testName:Fe,questions:Me,isLoading:!1}),console.log(`Test details loaded: ${Me.length} questions`)):(k("Could not load test questions. Please try again."),N({isOpen:!0,testType:ge,testId:Te,testName:Fe,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Me){console.error("Error loading test details:",Me),k("Error loading test details. Please try again."),N({isOpen:!0,testType:ge,testId:Te,testName:Fe,questions:[],isLoading:!1,error:Me.message||"Failed to load test details"})}finally{w(!1)}},ht=(ge,Te,Fe,Me)=>{try{console.log("Showing test details modal:",{testType:ge,testId:Te,testName:Fe,questions:Me}),N({isOpen:!0,testType:ge,testId:Te,testName:Fe,questions:Me||[],isLoading:!1,error:null})}catch(kt){console.error("Error showing test details modal:",kt),k("Failed to show test details modal")}},tt=()=>{try{console.log("Closing test details modal"),N({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(ge){console.error("Error closing test details modal:",ge)}},ut=(ge,Te)=>{try{switch(Te){case"multiple_choice":return l.jsxs("div",{className:"answer-options",children:[l.jsx("p",{children:l.jsx("strong",{children:"Options:"})}),l.jsxs("p",{children:["A) ",ge.option_a||"No text"]}),l.jsxs("p",{children:["B) ",ge.option_b||"No text"]}),ge.option_c&&l.jsxs("p",{children:["C) ",ge.option_c]}),ge.option_d&&l.jsxs("p",{children:["D) ",ge.option_d]}),ge.option_e&&l.jsxs("p",{children:["E) ",ge.option_e]}),ge.option_f&&l.jsxs("p",{children:["F) ",ge.option_f]}),l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ge.correct_answer||"Not specified"]})})]});case"true_false":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ge.correct_answer?"True":"False"]})})});case"input":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ge.correct_answer||"Not specified"]})})});case"matching_type":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ge.correct_answer?JSON.stringify(ge.correct_answer):"Not specified"]})})});case"word_matching":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ge.correct_answer?JSON.stringify(ge.correct_answer):"Not specified"]})})});default:return l.jsx("p",{children:"Unknown question type"})}}catch(Fe){return console.error("Error formatting question answer display:",Fe),l.jsx("p",{children:"Error displaying question"})}},Dt=(ge,Te)=>{try{console.log("Navigating to test:",{testType:ge,testId:Te}),r({testType:ge,testId:Te}),d(!0),Y(ge,Te)}catch(Fe){console.error("Error navigating to test:",Fe),k("Failed to navigate to test")}},Rt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),d(!1),g(null),k(null)}catch(ge){console.error("Error hiding test sections:",ge)}},It=(ge,Te,Fe,Me)=>{try{console.log("Displaying test on page:",{testInfo:ge,questions:Te,testType:Fe,testId:Me}),r({...ge,testType:Fe,testId:Me}),s(Te),d(!0),Z(Fe,Me),Nt(Fe,Me),Ze(Fe,Me)}catch(kt){console.error("Error displaying test on page:",kt),k("Failed to display test on page")}},De=(ge,Te,Fe)=>{try{return console.log("Rendering questions for page:",{questions:ge,testType:Te,testId:Fe}),!ge||!Array.isArray(ge)?(console.warn("Invalid questions array for rendering"),[]):ge.map((Me,kt)=>{const Pe=He=>{const ke={...a,[Me.question_id]:He};i(ke),ae(Te,Fe,Me.question_id,He)};return{question:Me,index:kt,testType:Te,testId:Fe,studentAnswer:a[Me.question_id]||"",onAnswerChange:Pe}})}catch(Me){return console.error("Error rendering questions for page:",Me),[]}},Ie=S.useCallback((ge,Te)=>{try{if(!ge||!Te){console.warn("Cannot save progress: missing testType or testId");return}const Fe=`test_progress_${ge}_${Te}`,Me={answers:a,progress:o,lastSaved:Date.now(),testType:ge,testId:Te};I(Fe,Me),console.log(`Progress saved for test ${ge}_${Te}:`,Me)}catch(Fe){console.error("Error saving progress for page:",Fe)}},[a,o,I]),Je=S.useCallback(ge=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(Fe=>Fe==null?!1:typeof Fe=="string"?Fe.trim()!=="":typeof Fe=="object"?Object.keys(Fe).length>0:!0).length}catch(Te){return console.error("Error getting answered questions count for page:",Te),0}},[a]),qe=S.useCallback((ge,Te)=>{try{console.log("Updating progress display for page:",{testType:ge,testId:Te});const Fe=Je(ge),Me=n.length,kt=Me>0?Math.round(Fe/Me*100):0,Pe=Fe===Me&&Me>0;c(Ue=>({...Ue,answeredCount:Fe,totalQuestions:Me,percentage:kt,canSubmit:Pe,remainingQuestions:Me-Fe,lastUpdated:Date.now()}));const He=document.getElementById("progress-bar"),ke=document.getElementById("progress-text"),$e=document.getElementById("submit-test-button");return He&&(He.style.width=`${kt}%`,He.className=He.className.replace(/bg-\w+-\d+/,""),kt>=100?He.classList.add("bg-green-500"):kt>=80?He.classList.add("bg-blue-500"):kt>=60?He.classList.add("bg-yellow-500"):kt>=40?He.classList.add("bg-orange-500"):He.classList.add("bg-red-500")),ke&&(ke.textContent=`${Fe}/${Me} questions answered (${kt}%)`),$e&&($e.disabled=!Pe,Pe?($e.textContent=" Submit Test",$e.classList.remove("bg-gray-400"),$e.classList.add("bg-green-600","hover:bg-green-700")):($e.textContent=` Complete ${Me-Fe} more question${Me-Fe!==1?"s":""}`,$e.classList.remove("bg-green-600","hover:bg-green-700"),$e.classList.add("bg-gray-400"))),{answeredCount:Fe,totalQuestions:Me,percentage:kt,canSubmit:Pe}}catch(Fe){return console.error("Error updating progress display for page:",Fe),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,Je]),Ze=S.useCallback((ge,Te)=>{try{console.log("Setting up test page event listeners:",{testType:ge,testId:Te});const Fe=setInterval(()=>{Object.keys(a).length>0&&(Ie(ge,Te),console.log("Auto-saved progress for test:",ge,Te))},3e4),Me=setInterval(()=>{qe(ge,Te)},2e3),kt=Ue=>{Ue.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&K(),Ue.ctrlKey&&Ue.key==="s"&&(Ue.preventDefault(),Ie(ge,Te),console.log("Manual save triggered")),Ue.key},Pe=Ue=>{Object.keys(a).length>0&&(Ue.preventDefault(),Ue.returnValue="Your test progress will be saved. Are you sure you want to leave?")},He=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),Ie(ge,Te))},ke=()=>{console.log("Window focused - updating progress"),qe(ge,Te)},$e=()=>{console.log("Window blurred - saving progress"),Ie(ge,Te)};return document.addEventListener("keydown",kt),window.addEventListener("beforeunload",Pe),document.addEventListener("visibilitychange",He),window.addEventListener("focus",ke),window.addEventListener("blur",$e),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${ge}_${Te}`]=Fe,window.testIntervals[`progress_${ge}_${Te}`]=Me,()=>{clearInterval(Fe),clearInterval(Me),document.removeEventListener("keydown",kt),window.removeEventListener("beforeunload",Pe),document.removeEventListener("visibilitychange",He),window.removeEventListener("focus",ke),window.removeEventListener("blur",$e),window.testIntervals&&(delete window.testIntervals[`autosave_${ge}_${Te}`],delete window.testIntervals[`progress_${ge}_${Te}`])}}catch(Fe){console.error("Error setting up test page event listeners:",Fe)}},[a,Ie,qe,K]),Tt=S.useCallback(()=>{try{const ge=Je(t?.testType),Te=n.length,Fe=ge===Te&&Te>0,Me=document.getElementById("submit-test-button");return Me&&(Me.disabled=!Fe,Me.textContent=Fe?"Submit Test":`Complete ${Te-ge} more questions`),{canSubmit:Fe,answeredCount:ge,totalQuestions:Te}}catch(ge){return console.error("Error updating submit button state for page:",ge),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,Je]),Nt=S.useCallback((ge,Te)=>{try{console.log("Setting up progress tracking for page:",{testType:ge,testId:Te});const Fe=setInterval(()=>{qe(ge,Te),Tt()},1e3),Me=setInterval(()=>{Object.keys(a).length>0&&Ie(ge,Te)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${ge}_${Te}`]=Fe,window.testIntervals[`autosave_${ge}_${Te}`]=Me,()=>{clearInterval(Fe),clearInterval(Me),window.testIntervals&&(delete window.testIntervals[`progress_${ge}_${Te}`],delete window.testIntervals[`autosave_${ge}_${Te}`])}}catch(Fe){console.error("Error setting up progress tracking for page:",Fe)}},[a,qe,Tt,Ie]),$t=S.useCallback(async(ge,Te)=>{const Fe=document.getElementById("submit-test-button");try{const Me=Je(ge),kt=n.length;if(Me<kt){k(`Please answer all ${kt} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;Fe&&(Fe.disabled=!0,Fe.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await B(ge,Te)&&(ne(ge,Te),V(ge,Te,a),console.log("Test submitted successfully!"))}catch(Me){console.error("Error submitting test from page:",Me),k("Failed to submit test. Please try again."),Fe&&(Fe.disabled=!1,Fe.textContent="Submit Test")}},[Je,n.length,B,ne,V,a]),ir=S.useCallback(()=>{try{if(!t)return null;const ge=["true_false","multiple_choice","input","matching_type","word_matching"];return ge.includes(t.testType)?t.testType:ge.includes(t.test_type)?t.test_type:null}catch(ge){return console.error("Error getting current test type:",ge),null}},[t]),pr=S.useCallback((ge,Te)=>{try{console.log("Clearing progress tracking interval:",{testType:ge,testId:Te});const Fe=`progress_interval_${ge}_${Te}`,Me=`autosave_interval_${ge}_${Te}`;window.testIntervals&&(window.testIntervals[Fe]&&(clearInterval(window.testIntervals[Fe]),delete window.testIntervals[Fe]),window.testIntervals[Me]&&(clearInterval(window.testIntervals[Me]),delete window.testIntervals[Me])),console.log(`Cleared progress tracking intervals for test ${ge}_${Te}`)}catch(Fe){console.error("Error clearing progress tracking interval:",Fe)}},[]),Vt={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:f,activeTests:p,isLoading:v,error:C,testDetailsModal:_,testStartTime:E,timeElapsed:F,loadTestForPage:Y,submitTest:B,navigateToTestResults:V,navigateBackToCabinet:M,clearTestDataAndReturnToCabinet:K,saveTestProgress:ae,getTestProgress:ee,clearTestProgress:ne,loadSavedProgressForPage:Z,isTestCompleted:H,markTestCompleted:W,markTestCompletedInUI:(ge,Te)=>{console.log("Marking test completed in UI:",{testType:ge,testId:Te}),W(ge,Te)},getAnsweredQuestionsCount:R,updateSubmitButtonState:z,updateSubmitButtonStateForPage:Tt,loadStudentActiveTests:le,loadActiveTests:le,loadTeacherActiveTests:ce,getTestInfo:pe,getTestQuestions:Ce,createTest:be,deleteTest:re,showTestResults:Ae,loadTestResults:Le,loadTestResultsForPage:We,displayTestResultsOnPage:At,setupTestResultsPageEventListeners:Qe,clearTestResultsCache:J,viewTestDetails:gt,showTestDetailsModal:ht,closeTestDetailsModal:tt,getQuestionAnswerDisplay:ut,navigateToTest:Dt,hideTestSections:Rt,displayTestOnPage:It,renderQuestionsForPage:De,setupTestPageEventListeners:Ze,setupProgressTrackingForPage:Nt,updateProgressDisplayForPage:qe,submitTestFromPage:$t,getAnsweredQuestionsCountForPage:Je,getCurrentTestType:ir,saveProgressForPage:Ie,clearProgressTrackingInterval:pr,collectTestAnswers:se,calculateTestScore:wf,checkAnswerCorrectness:Sm,formatStudentAnswerForDisplay:X,getCorrectAnswer:Jy,transformAnswersForSubmission:ie,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const Te=Date.now()-360*60*60*1e3,Fe=[];for(let Me=0;Me<localStorage.length;Me++){const kt=localStorage.key(Me);if(!(!kt||!((kt.startsWith("test_")||kt.startsWith("student_")||kt.startsWith("teacher_")||kt.startsWith("admin_")||kt.includes("progress")||kt.includes("answers"))&&!kt.includes("test_completed_"))))try{const He=localStorage.getItem(kt);if(!He){Fe.push(kt);continue}let ke=null;if(He.startsWith("{")||He.startsWith("[")){const $e=JSON.parse(He),Ue=$e.timestamp||$e.lastSaved||$e.lastTickAt||$e.createdAt||$e.updatedAt||$e.startedAt||$e.started_at||$e.created_at;Ue&&(ke=new Date(Ue).getTime())}if(!ke){const $e=`${kt}__ts`,Ue=localStorage.getItem($e);Ue&&(ke=parseInt(Ue)||null)}if(!ke)continue;ke<Te&&Fe.push(kt)}catch{continue}}return Fe.forEach(Me=>{console.log(`Removing old localStorage key: ${Me}`),L(Me)}),console.log(`Cleared ${Fe.length} old test-related items from localStorage`),{success:!0,clearedCount:Fe.length}}catch(ge){return console.error("Error clearing old test data:",ge),{success:!1,error:ge.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:d,setTestResults:g,setError:k};return l.jsx(jB.Provider,{value:Vt,children:e})},zv=()=>{const e=S.useContext(jB);if(!e)throw new Error("useTest must be used within a TestProvider");return e},ly=window.location.hostname==="mathayomwatsing.netlify.app";ly&&(console.log=()=>{},console.debug=()=>{},console.info=()=>{},console.warn=()=>{});const me={debug:(e,...t)=>{ly||console.log(e,...t)},warn:(e,...t)=>{ly||console.warn(e,...t)},error:(e,...t)=>{console.error(e,...t)},info:(e,...t)=>{ly||console.info(e,...t)},isEnabled:()=>!ly},Wv=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:c,totalQuestions:u,percentage:d,passed:f,questionAnalysis:g,timestamp:p}=e,x=C=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[C]||C,v=C=>C>=80?"text-green-600 bg-green-50":C>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",w=C=>C?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):l.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),l.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),l.jsxs("p",{className:"text-sm text-gray-500",children:[x(o),"  Completed on ",new Date(p).toLocaleDateString()]})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${w(f)}`,children:f?" PASSED":" FAILED"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c}),l.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:u}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:`text-3xl font-bold ${v(d).split(" ")[0]}`,children:[d,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:l.jsx(at.div,{className:`h-3 rounded-full ${v(d).split(" ")[1]}`,initial:{width:0},animate:{width:`${d}%`},transition:{duration:1,ease:"easeOut"}})}),l.jsx("div",{className:"flex flex-wrap gap-3",children:l.jsx(et,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:g.map((C,k)=>l.jsxs(at.div,{className:`p-4 rounded-lg border-2 ${C.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",C.questionNumber]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.isCorrect?" Correct":" Incorrect"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),l.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:C.question})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),l.jsx("p",{className:`p-3 rounded ${C.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.userAnswer||"No answer provided"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),l.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:C.correctAnswer})]})]})]},k))})]}),l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.filter(C=>C.isCorrect).length}),l.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),l.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.filter(C=>!C.isCorrect).length}),l.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(g.filter(C=>C.isCorrect).length/u*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),l.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u}),l.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},FB=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const o=f=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[f]||f,c=f=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[f]||"",u=(f,g)=>{switch(g){case"multiple_choice":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[f.option_a&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),l.jsx("span",{className:"text-gray-700",children:f.option_a})]}),f.option_b&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),l.jsx("span",{className:"text-gray-700",children:f.option_b})]}),f.option_c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),l.jsx("span",{className:"text-gray-700",children:f.option_c})]}),f.option_d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),l.jsx("span",{className:"text-gray-700",children:f.option_d})]}),f.option_e&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),l.jsx("span",{className:"text-gray-700",children:f.option_e})]}),f.option_f&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:f.option_f})]})]})]});case"true_false":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),l.jsx("span",{className:"text-gray-700",children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},d=(f,g)=>{if(!f.correct_answer)return null;let p="";switch(g){case"multiple_choice":p=f.correct_answer.toUpperCase();break;case"true_false":p=f.correct_answer?"True":"False";break;case"input":p=f.correct_answer;break;case"matching_type":p=typeof f.correct_answer=="object"?JSON.stringify(f.correct_answer):f.correct_answer;break;default:p=String(f.correct_answer)}return l.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[l.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),l.jsx("p",{className:"text-green-700 font-mono",children:p})]})};return l.jsx(wo,{children:l.jsxs(at.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[l.jsx(at.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs(at.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-2xl",children:c(r)}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(et,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),l.jsx(et,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),l.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):l.jsx("div",{className:"space-y-6",children:a.map((f,g)=>l.jsxs(at.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1,duration:.3},children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",g+1]}),l.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:f.question||f.question_text})}),u(f,r),d(f,r)]},f.id||f.question_id||g))})}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[l.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&l.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),l.jsx("div",{className:"flex items-center space-x-3",children:l.jsx(et,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},lae=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=t>0?Math.round(e/t*100):0,c=t-e,u=g=>{const p=Math.floor(g/3600),x=Math.floor(g%3600/60),v=g%60;return p>0?`${p}:${x.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`:`${x}:${v.toString().padStart(2,"0")}`},d=g=>g>=100?"bg-green-500":g>=80?"bg-blue-500":g>=60?"bg-yellow-500":g>=40?"bg-orange-500":"bg-red-500",f=g=>g>=100?"text-green-600":g>=80?"text-blue-600":g>=60?"text-yellow-600":g>=40?"text-orange-600":"text-red-600";return l.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsx("span",{className:"text-sm font-mono text-gray-600",children:u(r)})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),l.jsxs("span",{className:`text-sm font-semibold ${f(o)}`,children:[o,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:l.jsx(at.div,{className:`h-full ${d(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),l.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:c}),l.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),l.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),l.jsx("div",{className:"mb-4",children:e===t?l.jsx(at.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):c===1?l.jsx(at.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):l.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:l.jsxs("span",{className:"text-gray-600 font-medium",children:[c," questions remaining"]})})}),a&&l.jsx("div",{className:"flex justify-center",children:l.jsx(at.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Test"})]})})})]})},cae=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:c})=>{if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),l.jsx(et,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[u,d]=S.useState({}),[f,g]=S.useState(!1),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState(!1),[_,N]=S.useState(null),{showNotification:E}=ka(),{makeAuthenticatedRequest:P}=Jo(),{user:F}=cs(),{startTracking:A,stopTracking:j,getCheatingData:I,clearData:L}=Xm("fill_blanks",n,F?.student_id||F?.id);t2();const Y=S.useCallback((ne,B)=>{try{let V=ne;if(typeof ne=="string"&&ne.startsWith("{"))try{const R=JSON.parse(ne);R.root&&R.root.children&&(V=R.root.children.map(z=>z.children?z.children.map(K=>K.style&&K.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":K.text||"").join(""):"").join(" "))}catch(R){console.error("Error parsing Lexical JSON:",R)}let M=V;B.forEach((R,z)=>{const K=`[${z+1}_________]`;M=M.replace("[BLANK_PLACEHOLDER]",K)});const W=M.split(/(\[\d+_________\])/).map((R,z)=>R.match(/\[\d+_________\]/)?l.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:R},z):l.jsx("span",{children:R},z));return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(V){return console.error("Error rendering text with blanks:",V),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),Z=S.useCallback((ne,B)=>{try{let V=ne;if(typeof ne=="string"&&ne.startsWith("{"))try{const R=JSON.parse(ne);R.root&&R.root.children&&(V=R.root.children.map(z=>z.children?z.children.map(K=>K.style&&K.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":K.text||"").join(""):"").join(" "))}catch(R){console.error("Error parsing Lexical JSON:",R)}const M=[];B.forEach((R,z)=>{const K=u[R.id],J=K?R.options[K.charCodeAt(0)-65]:null,se=J?l.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(R.id),children:J},z):l.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>w(R.id),children:[z+1,"_________"]},z);M.push(se),V=V.replace("[BLANK_PLACEHOLDER]",`__BLANK_${R.id}__`)});const H=V.split(/__BLANK_\d+__/),W=[];for(let R=0;R<H.length;R++)H[R]&&W.push(l.jsx("span",{children:H[R]},`text-${R}`)),R<M.length&&W.push(M[R]);return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:W})})}catch(V){return console.error("Error rendering text with inline blanks:",V),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[u]),ae=S.useCallback((ne,B)=>{const V={...u,[ne]:B};d(V),c&&c(ne,B)},[u,c]),ee=S.useCallback(ne=>l.jsx("div",{className:"space-y-6",children:ne.map((B,V)=>{const M=B.blank_options||B.options||[];B.correct_answers;const H=B.question_json||B.question||`Blank ${V+1}`;return console.log(` Blank ${V+1} question text:`,H),l.jsxs(jt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",V+1]}),l.jsx("p",{className:"text-gray-600 mb-4",children:H})]}),l.jsx("div",{className:"space-y-3",children:M.filter(W=>W&&W.trim().length>0).map((W,R)=>l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[l.jsx("input",{type:"radio",name:`blank_${B.question_id||B.id||V}`,value:String.fromCharCode(65+R),checked:u[B.question_id||B.id||V]===String.fromCharCode(65+R),onChange:z=>ae(B.question_id||B.id||V,z.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+R)}),l.jsx("span",{className:"text-gray-700",children:W})]})]},R))})]},B.question_id||B.id||V)})}),[u,ae]);return S.useEffect(()=>{if(n&&F?.student_id){x(new Date),A(),console.log(" Anti-cheating tracking started for fill blanks test");const B=`test_progress_${F.student_id}_fill_blanks_${n}`,V=Rs(B);V&&(d(V.answers||{}),x(new Date(V.startTime)),console.log(" Fill blanks test progress restored:",V))}},[n,F?.student_id,t,A]),S.useEffect(()=>{if(p&&F?.student_id&&n){const ne=setInterval(()=>{const B={answers:u,startTime:p.toISOString()},V=`test_progress_${F.student_id}_fill_blanks_${n}`;vs(V,B,Is.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(ne)}},[p,u,F?.student_id,n]),S.useEffect(()=>()=>{j(),L(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[j,L]),S.useCallback(async()=>{g(!0);try{const ne=t.length;let B=0;t.forEach((pe,Ce)=>{const Ae=u[pe.id];Ae&&Ae===pe.correct_answer&&B++});const V=B,M=ne;console.log(` Fill Blanks Score: ${V}/${M} (${Math.round(V/M*100)}%)`);const H=new Date,W=p?Math.round((H-p)/1e3):0,R=p?p.toISOString():H.toISOString(),z=I();console.log(" Anti-cheating data for fill blanks submission:",z);const K=F.student_id,J=`retest_assignment_id_${K}_fill_blanks_${n}`,se=localStorage.getItem(J),{academicCalendarService:X}=await Zi(async()=>{const{academicCalendarService:pe}=await Promise.resolve().then(()=>n2);return{academicCalendarService:pe}},void 0);await X.loadAcademicCalendar();const le=X.getCurrentTerm()?.id;if(!le)throw new Error("No current academic period found");const ce={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:K,academic_period_id:le,parent_test_id:n,retest_assignment_id:se?Number(se):null,answers:u,score:V,maxScore:M,time_taken:W,started_at:R,submitted_at:H.toISOString(),caught_cheating:z.caught_cheating,visibility_change_times:z.visibility_change_times};console.log(" Submitting fill blanks test:",ce);const re=await(await P("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ce)})).json();if(re.success){if(E("Test submitted successfully!","success"),j(),L(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),F?.student_id&&(Rm(F.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),!!se&&F?.student_id){let Ce=3;try{const Le=localStorage.getItem(`student_active_tests_${F.student_id}`);if(Le){const Qe=JSON.parse(Le)?.tests?.find(gt=>gt.test_id===n&&gt.test_type==="fill_blanks");Qe&&(Ce=Qe.retest_attempts_left||Qe.max_attempts||3)}}catch(Le){console.error("Error checking active tests cache:",Le)}const We=(V>0&&M>0?V/M*100:0)>=50;if(We){const Le=`retest_attempt${Ce}_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(Le,"true"),console.log(" Passed retest, marking last-slot key:",Le);let At=0;for(let ht=1;ht<=10;ht++){const tt=`retest_attempt${ht}_${F.student_id}_fill_blanks_${n}`;localStorage.getItem(tt)==="true"&&At++}const Qe=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(Qe,"true"),console.log(" Marked retest as completed (student passed):",Qe);const gt=`retest_attempts_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(gt,JSON.stringify({used:At,max:Ce})),console.log(" Set retest attempts metadata (student passed):",gt,{used:At,max:Ce})}else{let Le=1;for(let tt=1;tt<=10;tt++){const ut=`retest_attempt${tt}_${F.student_id}_fill_blanks_${n}`;if(localStorage.getItem(ut)!=="true"){Le=tt;break}}const At=`retest_attempt${Le}_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(At,"true"),console.log(" Marked retest attempt as completed:",At);let Qe=0;for(let tt=1;tt<=10;tt++){const ut=`retest_attempt${tt}_${F.student_id}_fill_blanks_${n}`;localStorage.getItem(ut)==="true"&&Qe++}const gt=Ce-Qe,ht=gt<=0||We;if(console.log(" Retest completion check:",{usedAttempts:Qe,maxAttempts:Ce,attemptsLeft:gt,passed:We,shouldComplete:ht}),ht){const tt=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(tt,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",tt);const ut=`retest_attempts_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(ut,JSON.stringify({used:Qe,max:Ce})),console.log(" Set retest attempts metadata (attempts exhausted):",ut,{used:Qe,max:Ce})}}}else if(F?.student_id){const Ce=`test_completed_${F.student_id}_fill_blanks_${n}`;localStorage.setItem(Ce,"true"),console.log(" Fill blanks test marked as completed in localStorage:",Ce)}if(F?.student_id){const Ce=`retest1_${K}_fill_blanks_${n}`;localStorage.removeItem(Ce),localStorage.removeItem(J)}if(F?.student_id){const Ce=`student_results_table_${F.student_id}`;vs(Ce,re,Is.student_results_table),console.log(" Fill blanks test results cached with key:",Ce)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(V)},2e3)}else throw new Error(re.message||"Failed to submit test")}catch(ne){console.error("Error submitting test:",ne),E("Error submitting test. Please try again.","error")}finally{g(!1)}},[u,t,n,s,a,i,p,I,j,L,P,E,o,F]),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:l.jsxs(jt,{children:[f&&l.jsx(jt.Header,{children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx(Hr,{size:"small"}),l.jsx("span",{children:"Submitting..."})]})})}),l.jsx(jt.Body,{children:r===!0?l.jsxs(l.Fragment,{children:[Y(e,t),ee(t)]}):l.jsx(l.Fragment,{children:Z(e,t)})}),r===!1&&v&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),l.jsx("div",{className:"space-y-2",children:t.find(ne=>ne.id===v)?.options.filter(ne=>ne.trim().length>0).map((ne,B)=>l.jsxs("button",{onClick:()=>{ae(v,String.fromCharCode(65+B)),w(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[l.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+B),")"]}),ne]},B))}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx(et,{onClick:()=>w(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),l.jsx(jt.Footer,{children:l.jsx("div",{className:"flex gap-3"})})]})})};let uae=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const km=new uae;window.tokenManager=km;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{km.init()}):km.init());const OB=async(e,t,r,n,s=!1)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,termId:n,forceRefresh:s});const a=s?`&_t=${Date.now()}`:"",o=await(await km.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}${a}`,{cache:s?"no-cache":"default",headers:s?{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}:{}})).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",o.students?.length||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},DB=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await km.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},dae=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await km.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},fae=async(e,t,r,n,s={})=>{try{const a=await OB(e,t,r,n);if(!a.success)return a;let i=a.results;return s.subject&&(i=i.filter(o=>o.subject&&o.subject.toLowerCase().includes(s.subject.toLowerCase()))),s.testType&&(i=i.filter(o=>o.test_type===s.testType)),s.minScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100>=s.minScore)),s.maxScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100<=s.maxScore)),s.passed!==void 0&&(i=i.filter(o=>o.score>=o.passing_score===s.passed)),{success:!0,results:i,count:i.length,originalCount:a.results.length}}catch(a){return console.error("Error filtering teacher student results:",a),{success:!1,error:a.message,results:[]}}},hae=async(e,t,r={})=>{try{const n=await DB(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},gae={getTeacherStudentResults:OB,getStudentResultsView:DB,getClassSummary:dae,getTeacherStudentResultsFiltered:fae,getStudentResultsViewFiltered:hae};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mae=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),pae=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),xF=e=>{const t=pae(e);return t.charAt(0).toUpperCase()+t.slice(1)},IB=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),xae=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vae=S.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>S.createElement("svg",{ref:c,...yae,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:IB("lucide",s),...!a&&!xae(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>S.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=(e,t)=>{const r=S.forwardRef(({className:n,...s},a)=>S.createElement(vae,{ref:a,iconNode:t,className:IB(`lucide-${mae(xF(e))}`,`lucide-${e}`,n),...s}));return r.displayName=xF(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wae=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],_ae=Jm("download",wae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bae=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],Sae=Jm("maximize-2",bae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kae=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Cae=Jm("rotate-cw",kae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],RB=Jm("x",Tae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Nae=Jm("zoom-in",Eae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aae=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],jae=Jm("zoom-out",Aae),Ql={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},MB={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},Sh={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},yF={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},vF={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},I_={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},LB=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},Pae=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?Fae(t):t):e,Fae=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},Oae=(e,t=Date.now())=>{const r=LB(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>I_.COMPRESSION_THRESHOLD}},wF=(e,t,r)=>{const n=Oae(t),s=LB(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>I_.MAX_MEMORY_KB&&(i=Dae(a)),i.length>I_.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},Dae=e=>e.map(t=>t.memoryUsage>I_.COMPRESSION_THRESHOLD?{...t,data:Pae(t.data),compressed:!0}:t),_F=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?Iae(r.data):[...r.data]:[]},Iae=e=>[...e],bF=e=>e>0,SF=(e,t)=>e<t-1,Rae=()=>({history:[],index:-1}),Mae=()=>{const[e,t]=S.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=S.useState([]),[s,a]=S.useState([]),i=S.useCallback(E=>{t(P=>({...P,...E}))},[]),o=S.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),c=S.useCallback(E=>{const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,isDrawing:!0,currentLine:[P]})):["line","rectangle","circle"].includes(e.currentTool)&&t(F=>({...F,isDrawing:!0,currentShape:{type:e.currentTool,startX:E.x,startY:E.y,endX:E.x,endY:E.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),u=S.useCallback(E=>{if(!e.isDrawing)return;const P={x:E.x,y:E.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,currentLine:[...F.currentLine,P]})):e.currentShape&&t(F=>({...F,currentShape:{...F.currentShape,endX:E.x,endY:E.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),d=S.useCallback(()=>{if(!e.isDrawing)return;let E=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(E=[...r,e.currentLine],n(E)):e.currentShape&&(E=[...r,e.currentShape],n(E)),E!==r){const P=wF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:P.history,historyIndex:P.index}))}else t(P=>({...P,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),f=S.useCallback(E=>Math.round(E*vF.ERASER_TO_THICKNESS_RATIO),[]),g=S.useCallback(E=>Math.round(E*vF.THICKNESS_TO_ERASER_RATIO),[]),p=S.useCallback(E=>{t(P=>({...P,currentThickness:E,eraserSize:f(E)}))},[f]),x=S.useCallback(E=>{t(P=>({...P,eraserSize:E,currentThickness:g(E)}))},[g]),v=S.useCallback(E=>{const P=wF(e.drawingHistory,E,e.historyIndex);t(F=>({...F,drawingHistory:P.history,historyIndex:P.index}))},[e.drawingHistory,e.historyIndex]),w=S.useCallback(()=>{if(bF(e.historyIndex)){const E=e.historyIndex-1,P=_F(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),C=S.useCallback(()=>{if(SF(e.historyIndex,e.drawingHistory.length)){const E=e.historyIndex+1,P=_F(e.drawingHistory,E);n([...P]),t(F=>({...F,historyIndex:E}))}},[e.historyIndex,e.drawingHistory]),k=S.useCallback(()=>{const E=Rae();t(P=>({...P,drawingHistory:E.history,historyIndex:E.index}))},[]),_=bF(e.historyIndex),N=SF(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:c,continueDrawing:u,finishDrawing:d,handleThicknessChange:p,handleEraserSizeChange:x,saveToHistoryState:v,undo:w,redo:C,clearHistoryState:k,canUndoState:_,canRedoState:N}},kF={SCALE_DELTA:.05,CENTER_DELTA:20},em=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},af=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},Lae=(e,t)=>{if(e.length!==2||!t)return null;const r=em(e),n=em(t),s=af(e),a=af(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>kF.SCALE_DELTA?"zoom":o>kF.CENTER_DELTA?"pan":null},Bae=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},Hg=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},dl={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},R_={color:"#000000",thickness:2},CF=(e,t,r)=>({x:e.x,y:e.y,color:t||R_.color,thickness:r||R_.thickness}),$ae=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||R_.color,thickness:s||R_.thickness}),BB=(e,t,r,n,s,a)=>{const i=e-r,o=t-n,c=s-r,u=a-n,d=i*c+o*u,f=c*c+u*u;let g=-1;f!==0&&(g=d/f);let p,x;g<0?(p=r,x=n):g>1?(p=s,x=a):(p=r+g*c,x=n+g*u);const v=e-p,w=t-x;return Math.sqrt(v*v+w*w)},Uae=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},zae=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],c=n[i+1],u=BB(e,t,o.x,o.y,c.x,c.y);u<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:u})}return s},Wae=(e,t,r,n)=>{const s=zae(t,r,n,e);return s.length===0?[e]:Uae(e,s)},Hae=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},TF=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=Wae(a,e,t,r);s.push(...i)}else a.type==="line"?BB(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(Hae(e,t,r,a)||s.push(a));return s},Gae=(e,t,r,n,s,a,i,o,c)=>{const[u,d]=S.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),f=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),e.currentTool===dl.PAN)return;const F=P.target.getStage(),A=Hg(P,F),j=CF(A,e.currentColor,e.currentThickness);e.currentTool===dl.PENCIL?t(I=>({...I,isDrawing:!0,currentLine:[j]})):[dl.LINE,dl.RECTANGLE,dl.CIRCLE].includes(e.currentTool)&&t(I=>({...I,isDrawing:!0,currentShape:$ae(e.currentTool,A,A,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),g=S.useCallback(P=>{const F=TF(P.x,P.y,e.eraserSize,r);n(F),s(F)},[e.eraserSize,r,n,s]),p=S.useCallback(P=>{o&&(a(),v("Undo",P))},[o,a]),x=S.useCallback(P=>{c&&(i(),v("Redo",P))},[c,i]),v=S.useCallback((P,F)=>{const A=F.target.getStage(),j=Hg(F,A),I=new Konva.Circle({x:j.x,y:j.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});A.add(I),I.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{I.destroy()}})},[]),w=S.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),!e.isDrawing)return;const F=P.target.getStage(),A=Hg(P,F),j=CF(A,e.currentColor,e.currentThickness);e.currentTool===dl.PENCIL?t(I=>({...I,currentLine:[...I.currentLine,j]})):e.currentShape&&t(I=>({...I,currentShape:{...I.currentShape,endX:A.x,endY:A.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),C=S.useCallback(P=>{P&&P.evt&&(P.evt.preventDefault(),P.evt.stopPropagation()),e.isDrawing&&(e.currentTool===dl.PENCIL&&e.currentLine.length>0?n(F=>[...F,e.currentLine]):e.currentShape&&n(F=>[...F,e.currentShape]),t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),k=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2)d({isActive:!0,type:"pan",lastDistance:em(F),lastCenter:af(F)});else if(F.length===1)if(e.currentTool===dl.ERASER){const A=P.target.getStage(),j=Hg(P,A);g(j)}else e.currentTool===dl.UNDO?p(P):e.currentTool===dl.REDO?x(P):f(P)},[em,af,f,e.currentTool,g,p,x]),_=S.useCallback(Bae(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;if(F.length===2&&u.isActive){const A=Lae(F,u);if(A==="zoom"){const j=em(F),I=af(F),L=j/u.lastDistance,Y=Math.max(.25,Math.min(1,e.zoom*L));t(Z=>({...Z,zoom:Y,position:{x:I.x-(I.x-Z.position.x)*(Y/Z.zoom),y:I.y-(I.y-Z.position.y)*(Y/Z.zoom)}}))}else if(A==="pan"){const j=af(F),I=j.x-u.lastCenter.x,L=j.y-u.lastCenter.y;t(Y=>({...Y,position:{x:Y.position.x+I,y:Y.position.y+L}}))}d(j=>({...j,lastDistance:em(F),lastCenter:af(F)}))}else if(F.length===1)if(e.currentTool===dl.ERASER){const A=P.target.getStage(),j=Hg(P,A),I=TF(j.x,j.y,e.eraserSize,r);n(I)}else if(e.currentTool===dl.PAN){const A=af(F),j=A.x-u.lastCenter.x,I=A.y-u.lastCenter.y;t(L=>({...L,position:{x:L.position.x+j,y:L.position.y+I}})),d(L=>({...L,lastCenter:A}))}else w(P)}),[u,e.zoom,t,w]),N=S.useCallback(P=>{_(P)},[_]),E=S.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const F=P.evt.touches;F.length===0?(C(P),d({isActive:!1,type:null,lastDistance:null,lastCenter:null})):F.length===1&&d(A=>({...A,isActive:!1}))},[C]);return{handleTouchStart:k,handleTouchMove:N,handleTouchEnd:E,handleEraserStart:g,handleUndoTouch:p,handleRedoTouch:x,showTouchFeedback:v}},Vae=(e,t)=>{const[r,n]=S.useState(e.MIN),[s,a]=S.useState({x:0,y:0}),i=S.useCallback((g,p,x)=>{const v=Math.max(e.MIN,Math.min(e.MAX,g));if(p){const w=v/r,C={x:p.x-(p.x-s.x)*w,y:p.y-(p.y-s.y)*w};return{zoom:v,position:C}}else{const w=t.width*v,C=t.height*v,k={x:(x.width-w)/2,y:(x.height-C)/2};return{zoom:v,position:k}}},[r,s,e,t]),o=S.useCallback(()=>{const g=Math.min(r*(1+e.STEP),e.MAX);n(g)},[r,e]),c=S.useCallback(()=>{const g=Math.max(r/(1+e.STEP),e.MIN);n(g)},[r,e]),u=S.useCallback((g,p,x)=>{const v=i(g,p,x);n(v.zoom),a(v.position)},[i]),d=S.useCallback((g,p)=>{a(x=>({x:x.x+g,y:x.y+p}))},[]),f=S.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:c,handleZoomToPoint:u,handlePan:d,resetZoom:f}},Kae=e=>{const[t,r]=S.useState([]),[n,s]=S.useState(0),a=S.useCallback(f=>{if(console.log("parseDrawingData - input drawing:",f),console.log("parseDrawingData - drawing.answers:",f?.answers),!f?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof f.answers=="string"){console.log("parseDrawingData - parsing string answers");const g=JSON.parse(f.answers);return console.log("parseDrawingData - parsed string result:",g),g&&typeof g=="object"&&g.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),g}if(f.answers&&typeof f.answers=="object"&&f.answers.lines)return console.log("parseDrawingData - answers is new format object"),f.answers;if(Array.isArray(f.answers)){if(console.log("parseDrawingData - answers is array"),f.answers.every(p=>typeof p=="string"))try{const p=f.answers.map(x=>{try{return JSON.parse(x)}catch{return x}});return console.log("parseDrawingData - parsed array elements"),p}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),f.answers}return f.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(g){return console.error("Error parsing drawing data:",g),[]}},[]),i=S.useCallback(f=>{if(console.log("processQuestions - input answers:",f),console.log("processQuestions - answers type:",typeof f),console.log("processQuestions - answers isArray:",Array.isArray(f)),f&&typeof f=="object"&&f.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",f.lines?.length),console.log("processQuestions - textBoxes count:",f.textBoxes?.length);const p=o(f.lines);return console.log("processQuestions - canvas groups:",p),console.log("processQuestions - number of canvas groups:",p.length),p.map((x,v)=>(console.log(`processQuestions - canvas ${v} strokes:`,x),console.log(`processQuestions - canvas ${v} stroke count:`,x.length),{questionNumber:v+1,drawingData:x,textBoxes:f.textBoxes||[]}))}if(Array.isArray(f)&&f.every(p=>p&&typeof p=="object"&&p.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),f.map((p,x)=>({questionNumber:x+1,drawingData:p.lines||[],textBoxes:p.textBoxes||[]}));if(!Array.isArray(f))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",f.length,"answers (old format)");const g=o(f);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((p,x)=>(console.log(`processQuestions - canvas ${x} strokes:`,p),console.log(`processQuestions - canvas ${x} stroke count:`,p.length),{questionNumber:x+1,drawingData:p,textBoxes:[]}))},[]),o=S.useCallback(f=>{console.log("groupStrokesByCanvas - input answers:",f);const g=c(f);return console.log("groupStrokesByCanvas - using strategy:",g),g==="by_question_boundary"?u(f):g==="by_stroke_type"?d(f):[f]},[]),c=S.useCallback(f=>{console.log("determineGroupingStrategy - analyzing answers:",f);let g=0,p=0;return f.forEach(x=>{Array.isArray(x)?g++:typeof x=="object"&&p++}),console.log("determineGroupingStrategy - arrayCount:",g,"objectCount:",p),g>0&&p>0?"by_stroke_type":f.length>3?"by_question_boundary":"single_canvas"},[]),u=S.useCallback(f=>{console.log("groupByQuestionBoundary - grouping answers:",f);const g=[];let p=[];const x=Math.ceil(f.length/2);for(let v=0;v<f.length;v++)p.push(f[v]),(v+1)%x===0&&v<f.length-1&&(g.push([...p]),p=[]);return p.length>0&&g.push(p),console.log("groupByQuestionBoundary - result:",g),g},[]),d=S.useCallback(f=>{console.log("groupByStrokeType - grouping answers:",f);const g=[],p=[];f.forEach(v=>{Array.isArray(v)?g.push(v):typeof v=="object"&&p.push(v)});const x=[];return g.length>0&&x.push(g),p.length>0&&x.push(p),console.log("groupByStrokeType - result:",x),x},[]);return S.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const f=a(e);console.log("useDataParsing - parsed answers:",f),console.log("useDataParsing - parsed answers type:",typeof f),console.log("useDataParsing - parsed answers length:",f?.length);const g=i(f);console.log("useDataParsing - processed questions:",g),console.log("useDataParsing - processed questions length:",g?.length),g.length>0&&(console.log("useDataParsing - first question drawingData:",g[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",g[0]?.drawingData?.length)),r(g),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},EF={MIN:.25,INITIAL:1},qae=(e,t)=>{const[r,n]=S.useState(!1),[s,a]=S.useState(null),i=S.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:EF.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),o=S.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:EF.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},$B=S.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:c,mousePosition:u,isMouseOverCanvas:d,isEraserDrawing:f},g)=>{const p=S.useRef(null),[x,v]=S.useState(.25),[w,C]=S.useState(null),[k,_]=S.useState({x:0,y:0}),[N,E]=S.useState(!1),P=S.useCallback(({x:H,y:W,size:R,visible:z,isDrawing:K})=>!z||!H||!W?null:l.jsx(pf,{x:H,y:W,radius:R/2,stroke:yF.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:K?.8:yF.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),F=S.useCallback(H=>{if(r.currentTool===Sh.ERASER){const W=H.target.getStage(),R=Hg(H,W);_(R)}},[r.currentTool]),A=S.useCallback(()=>{r.currentTool===Sh.ERASER&&E(!0)},[r.currentTool]),j=S.useCallback(()=>{E(!1)},[]);S.useEffect(()=>{const H=g.current;if(H)return H.on("mousemove",F),H.on("mouseenter",A),H.on("mouseleave",j),()=>{H.off("mousemove",F),H.off("mouseenter",A),H.off("mouseleave",j)}},[F,A,j,g]),S.useEffect(()=>{const H=n.width??n.WIDTH,W=n.height??n.HEIGHT,R=()=>{const z=p.current;if(!z)return;const K=z.clientWidth||1,J=z.clientHeight||1,se=Math.abs(r.rotation%180)===90,X=se?W:H,ie=se?H:W,le=Math.min(K/(X||1),J/(ie||1));v(Math.min(le,1))};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const I=S.useMemo(()=>{const H=p.current;if(!H||!w)return 0;const W=H.clientWidth||1,R=H.clientHeight||1,z=Math.min(W/Math.max(w.width,1),R/Math.max(w.height,1));return Math.min(z,MB.MAX)},[w]),L=S.useMemo(()=>Math.max(s,x||1),[s,x]),Y=S.useMemo(()=>{const H=n.width??n.WIDTH,W=n.height??n.HEIGHT;if(!p.current)return{x:0,y:0};const R=p.current.clientWidth||1,z=p.current.clientHeight||1,K=(R-H*L)/2,J=(z-W*L)/2;return s<=x?{x:K,y:J}:{x:a.x!==void 0?a.x:K,y:a.y!==void 0?a.y:J}},[a,s,x,L,n.width,n.height,w,I]);S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){C(null);return}let H=1/0,W=1/0,R=-1/0,z=-1/0;const K=(ie,le)=>{Number.isFinite(ie)&&Number.isFinite(le)&&(ie<H&&(H=ie),le<W&&(W=le),ie>R&&(R=ie),le>z&&(z=le))};if(e.forEach(ie=>{if(Array.isArray(ie))ie.forEach(le=>K(le.x,le.y));else if(ie&&typeof ie=="object"){if(ie.type==="line")K(ie.startX,ie.startY),K(ie.endX,ie.endY);else if(ie.type==="rectangle")K(ie.startX,ie.startY),K(ie.endX,ie.endY);else if(ie.type==="circle"){const le=Math.sqrt(Math.pow(ie.endX-ie.startX,2)+Math.pow(ie.endY-ie.startY,2))/2,ce=(ie.startX+ie.endX)/2,be=(ie.startY+ie.endY)/2;K(ce-le,be-le),K(ce+le,be+le)}}}),!Number.isFinite(H)||!Number.isFinite(W)||!Number.isFinite(R)||!Number.isFinite(z)){C(null);return}const J=16,se=Math.max(1,R-H+J*2),X=Math.max(1,z-W+J*2);C({minX:H-J,minY:W-J,width:se,height:X})},[e]),S.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),S.useEffect(()=>{const H=n.width??n.WIDTH,W=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:H,height:W}),console.log("CanvasViewer - zoom:",s,"fitZoom:",x,"displayScale:",L),console.log("CanvasViewer - stagePosition:",Y)},[n,s,x,L,Y]);const Z=(H,W)=>{if(console.log(`CanvasViewer - rendering element ${W}:`,H),Array.isArray(H))return console.log(`CanvasViewer - rendering line with ${H.length} points`),l.jsx(ai,{points:H.flatMap(R=>[R.x,R.y]),stroke:H[0]?.color||"#000000",strokeWidth:H[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},W);if(H.type==="line")return l.jsx(ai,{points:[H.startX,H.startY,H.endX,H.endY],stroke:H.color,strokeWidth:H.thickness,lineCap:"round"},W);if(H.type==="rectangle"){const R=Math.abs(H.endX-H.startX),z=Math.abs(H.endY-H.startY),K=Math.min(H.startX,H.endX),J=Math.min(H.startY,H.endY);return l.jsx($a,{x:K,y:J,width:R,height:z,stroke:H.color,strokeWidth:H.thickness,fill:"transparent"},W)}else if(H.type==="circle"){const R=Math.sqrt(Math.pow(H.endX-H.startX,2)+Math.pow(H.endY-H.startY,2))/2,z=(H.startX+H.endX)/2,K=(H.startY+H.endY)/2;return l.jsx(pf,{x:z,y:K,radius:R,stroke:H.color,strokeWidth:H.thickness,fill:"transparent"},W)}return null},ae=()=>{if(!r.isDrawing)return null;if(r.currentTool===Sh.PENCIL&&r.currentLine.length>0)return l.jsx(ai,{points:r.currentLine.flatMap(H=>[H.x,H.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:H,startX:W,startY:R,endX:z,endY:K,color:J,thickness:se}=r.currentShape;if(H===Sh.LINE)return l.jsx(ai,{points:[W,R,z,K],stroke:J,strokeWidth:se,lineCap:"round"});if(H===Sh.RECTANGLE){const X=Math.abs(z-W),ie=Math.abs(K-R),le=Math.min(W,z),ce=Math.min(R,K);return l.jsx($a,{x:le,y:ce,width:X,height:ie,stroke:J,strokeWidth:se,fill:"transparent"})}else if(H===Sh.CIRCLE){const X=Math.sqrt(Math.pow(z-W,2)+Math.pow(K-R,2))/2,ie=(W+z)/2,le=(R+K)/2;return l.jsx(pf,{x:ie,y:le,radius:X,stroke:J,strokeWidth:se,fill:"transparent"})}}return null},ee=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},ne={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},B=S.useCallback(H=>{H.preventDefault(),H.stopPropagation()},[]),V=S.useCallback(H=>{H.preventDefault(),H.stopPropagation()},[]),M=S.useCallback(H=>{H.preventDefault(),H.stopPropagation()},[]);return l.jsx("div",{style:{...ee,touchAction:"none",WebkitTouchCallout:"none"},ref:p,className:"select-none",onTouchStart:B,onTouchMove:V,onTouchEnd:M,children:l.jsx("div",{style:{...ne,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:B,onTouchMove:V,onTouchEnd:M,children:l.jsx(e0,{ref:g,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:L,scaleY:L,x:Y.x,y:Y.y,onTouchStart:i,onTouchMove:o,onTouchEnd:c,children:l.jsxs(Zh,{children:[l.jsx($a,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((H,W)=>(console.log(`CanvasViewer - mapping item ${W}:`,H),Z(H,W))),t&&t.map((H,W)=>l.jsx($a,{x:H.x,y:H.y,width:H.width,height:H.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${W}`)),t&&t.map((H,W)=>l.jsx(zc,{x:H.x+8,y:H.y+8,width:H.width-16,height:H.height-16,text:H.text,fontSize:H.fontSize||14,fill:H.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${W}`)),ae(),r.currentTool===Sh.ERASER&&l.jsx(P,{x:k.x,y:k.y,size:r.eraserSize,visible:N,isDrawing:f})]})})})})});$B.displayName="CanvasViewer";function Yae({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=S.useState(1),[a,i]=S.useState({x:0,y:0}),o=S.useRef({width:1,height:1}),c=S.useRef(.01),u=S.useRef(0),d=S.useRef(!1),f=S.useCallback(()=>{const N=t?.width??t?.WIDTH??0,E=t?.height??t?.HEIGHT??0,P=Math.abs(r%180)===90;return{width:P?E:N,height:P?N:E}},[t,r]),g=S.useCallback(()=>{const N=e?.current;if(!N)return{width:1,height:1};const E=N.clientWidth||1,P=N.clientHeight||1;return o.current={width:E,height:P},{width:E,height:P}},[e]),p=S.useCallback(()=>{const{width:N,height:E}=o.current,{width:P,height:F}=f(),A=N/Math.max(P,1),j=E/Math.max(F,1);return Math.min(A,j,1)*.98},[f]),x=S.useCallback(N=>{const{width:E,height:P}=o.current,{width:F,height:A}=f(),j=Math.max(c.current,Math.min(N,1.5));let I=(E-F*j)/2,L=(P-A*j)/2;const Y=E-F*j,Z=P-A*j;I=Math.min(Math.max(0,I),Math.max(0,Y)),L=Math.min(Math.max(0,L),Math.max(0,Z));try{console.log("[Camera] centerAtScale",{targetScale:N,clampedScale:j,container:{containerW:E,containerH:P},canvas:{canvasW:F,canvasH:A},translate:{x:I,y:L},rotation:r})}catch{}i({x:I,y:L}),s(j)},[f]),v=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=f(),A=p();let j=(N-P*A)/2,I=(E-F*A)/2;const L=N-P*A,Y=E-F*A;j=Math.min(Math.max(0,j),Math.max(0,L)),I=Math.min(Math.max(0,I),Math.max(0,Y));try{console.log("[Camera] fitCanvas",{scale:A,container:{containerW:N,containerH:E},canvas:{canvasW:P,canvasH:F},translate:{x:j,y:I},rotation:r})}catch{}s(A),i({x:j,y:I}),c.current=A,d.current=!1},[f,g,p]),w=S.useCallback(()=>{const{width:N,height:E}=g(),{width:P,height:F}=f(),A=(N-P)/2,j=(E-F)/2;s(1),i({x:A,y:j})},[f,g]),C=S.useCallback((N,E)=>{const{width:P,height:F}=o.current,{width:A,height:j}=f(),I=Math.max(c.current,Math.min(N,1.5));if(E&&Number.isFinite(E.x)&&Number.isFinite(E.y)){const L={x:(E.x-a.x)/n,y:(E.y-a.y)/n},Y=E.x-L.x*I,Z=E.y-L.y*I;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:I})}catch{}s(I),i({x:Y,y:Z}),u.current=Date.now()+400,d.current=!0}else{let L=(P-A*I)/2,Y=(F-j*I)/2;const Z=P-A*I,ae=F-j*I;L=Math.min(Math.max(0,L),Math.max(0,Z)),Y=Math.min(Math.max(0,Y),Math.max(0,ae));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:I})}catch{}s(I),i({x:L,y:Y}),u.current=Date.now()+400,d.current=!0}},[f,n,a]),k=S.useCallback((N,E)=>{const P=n*N,{width:F,height:A}=o.current,j={x:F/2,y:A/2};C(P,E||j)},[n,C]),_=S.useCallback((N,E)=>{i(P=>({x:P.x+N,y:P.y+E})),u.current=Date.now()+200,d.current=!0},[]);return S.useEffect(()=>{const N=e?.current;if(!N)return;const E=new ResizeObserver(()=>{g();const P=p();if(c.current=P,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}x(n)}});return E.observe(N),g(),()=>E.disconnect()},[e,g,p,x,n]),S.useEffect(()=>{d.current=!1,c.current=p(),x(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,p,x,n]),S.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:x,fitCanvas:v,oneToOne:w,zoomTo:C,zoomByFactor:k,panBy:_}),[n,a,x,v,w,C,k,_])}const Xx=new Map,UB=S.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer",onTextBoxEdit:i},o)=>{const c=S.useRef(null),u=S.useRef(null),d=Yae({containerRef:c,canvasSize:r,rotation:n}),[f,g]=S.useState({width:1,height:1}),p=S.useRef(null),x=S.useRef(null),[v,w]=S.useState(null);S.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),S.useEffect(()=>{typeof s=="function"&&s(d.scale);try{console.log("[ViewerCanvas] scale changed",{scale:d.scale})}catch{}if(a){const M=Xx.get(a)||{};Xx.set(a,{...M,scale:d.scale})}},[d.scale,s]),S.useEffect(()=>{if(a){const M=Xx.get(a)||{};Xx.set(a,{...M,translate:{x:d.translate.x,y:d.translate.y}})}},[a,d.translate.x,d.translate.y]),S.useImperativeHandle(o,()=>({zoomIn:M=>d.zoomByFactor(1.1,M),zoomOut:M=>d.zoomByFactor(1/1.1,M),fitCanvas:()=>d.fitCanvas(),oneToOne:()=>d.oneToOne(),getScale:()=>d.scale,getStage:()=>u.current,getPointerPosition:()=>u.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const M=u.current;if(!M)return null;const H=r?.width??r?.WIDTH??1536,W=r?.height??r?.HEIGHT??2048,R={scaleX:M.scaleX(),scaleY:M.scaleY(),x:M.x(),y:M.y(),width:M.width(),height:M.height()},z=p.current,K=x.current,J=z?{x:z.x(),y:z.y(),scaleX:z.scaleX(),scaleY:z.scaleY()}:null,se=K?{x:K.x(),y:K.y(),rotation:K.rotation()}:null;try{return M.scale({x:1,y:1}),M.position({x:0,y:0}),M.size({width:H,height:W}),z&&(z.position({x:0,y:0}),z.scale({x:1,y:1})),K&&(K.position({x:0,y:0}),K.rotation(0)),M.batchDraw(),M.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:H,height:W})}finally{K&&se&&(K.position({x:se.x,y:se.y}),K.rotation(se.rotation)),z&&J&&(z.position({x:J.x,y:J.y}),z.scale({x:J.scaleX,y:J.scaleY})),M.scale({x:R.scaleX,y:R.scaleY}),M.position({x:R.x,y:R.y}),M.size({width:R.width,height:R.height}),M.batchDraw()}}}),[d]),S.useEffect(()=>{const M=c.current;if(!M)return;const H=()=>{g({width:M.clientWidth||1,height:M.clientHeight||1})};H();const W=new ResizeObserver(H);return W.observe(M),()=>W.disconnect()},[]),S.useEffect(()=>{if(!Array.isArray(e)||e.length===0){w(null);return}let M=1/0,H=1/0,W=-1/0,R=-1/0;const z=(X,ie)=>{Number.isFinite(X)&&Number.isFinite(ie)&&(X<M&&(M=X),ie<H&&(H=ie),X>W&&(W=X),ie>R&&(R=ie))};if(e.forEach(X=>{if(Array.isArray(X))X.forEach(ie=>z(ie.x,ie.y));else if(X&&typeof X=="object"){if(X.type==="line")z(X.startX,X.startY),z(X.endX,X.endY);else if(X.type==="rectangle")z(X.startX,X.startY),z(X.endX,X.endY);else if(X.type==="circle"){const ie=Math.hypot(X.endX-X.startX,X.endY-X.startY)/2,le=(X.startX+X.endX)/2,ce=(X.startY+X.endY)/2;z(le-ie,ce-ie),z(le+ie,ce+ie)}}}),!Number.isFinite(M)||!Number.isFinite(H)||!Number.isFinite(W)||!Number.isFinite(R)){w(null);return}const K=16,J=Math.max(1,W-M+K*2),se=Math.max(1,R-H+K*2);w({minX:M-K,minY:H-K,width:J,height:se,centerX:M-K+J/2,centerY:H-K+se/2})},[e]);const C=S.useMemo(()=>{if(!v)return{scale:1,x:0,y:0};const M=r?.width??r?.WIDTH??1536,H=r?.height??r?.HEIGHT??2048,W=Math.min(M/Math.max(1,v.width),H/Math.max(1,v.height),1),R=v.width*W,z=v.height*W,K=(M-R)/2,J=(H-z)/2,se=K-v.minX*W,X=J-v.minY*W;return{scale:W,x:se,y:X}},[v,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),k=S.useRef(!1);S.useEffect(()=>{if(k.current)return;const M=a?Xx.get(a):null;M&&Number.isFinite(M.scale)&&M.translate&&Number.isFinite(M.translate.x)&&Number.isFinite(M.translate.y)?(d.setScale(M.scale),d.setTranslate(M.translate)):d.fitCanvas(),k.current=!0},[a,d]),S.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:d.scale,translate:d.translate})}catch{}d.fitCanvas()},[n]),S.useEffect(()=>{d.centerAtScale(d.scale)},[n]);const _=M=>{M.evt.preventDefault();const H=u.current;if(!H)return;const W=H.getPointerPosition(),R=Math.pow(1.0015,-M.evt.deltaY);d.zoomByFactor(R,W)},N=S.useRef(!1),E=S.useRef({x:0,y:0}),P=()=>{const M=c.current;if(!M)return 1;const H=M.clientWidth||1,W=M.clientHeight||1,R=r?.width??r?.WIDTH??1,z=r?.height??r?.HEIGHT??1,K=Math.abs(n%180)===90,J=K?z:R,se=K?R:z,X=Math.min(H/J,W/se);return Math.min(X,1)},F=M=>{const H=P();d.scale<=H||(N.current=!0,E.current={x:M.evt.clientX,y:M.evt.clientY})},A=M=>{if(!N.current)return;const H=M.evt.clientX-E.current.x,W=M.evt.clientY-E.current.y;E.current={x:M.evt.clientX,y:M.evt.clientY},d.panBy(H,W)},j=()=>{N.current=!1},I=1536,L=2048,Y=(M,H)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${H}:`,M),Array.isArray(M))return console.log(`[ViewerCanvas] Array item with ${M.length} points:`,M.slice(0,3)),l.jsx(ai,{points:M.flatMap(W=>[W.x,W.y]),stroke:M[0]?.color||"#000000",strokeWidth:M[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},H);if(M?.type==="line")return l.jsx(ai,{points:[M.startX,M.startY,M.endX,M.endY],stroke:M.color,strokeWidth:M.thickness,lineCap:"round"},H);if(M?.type==="rectangle"){const W=Math.abs(M.endX-M.startX),R=Math.abs(M.endY-M.startY),z=Math.min(M.startX,M.endX),K=Math.min(M.startY,M.endY);return l.jsx($a,{x:z,y:K,width:W,height:R,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},H)}else if(M?.type==="circle"){const W=Math.sqrt(Math.pow(M.endX-M.startX,2)+Math.pow(M.endY-M.startY,2))/2,R=(M.startX+M.endX)/2,z=(M.startY+M.endY)/2;return l.jsx(pf,{x:R,y:z,radius:W,stroke:M.color,strokeWidth:M.thickness,fill:"transparent"},H)}return null},Z=S.useRef(new Map),ae=S.useRef(null),ee=S.useRef({x:0,y:0}),ne=S.useCallback(M=>{const H=c.current;H&&(H.setPointerCapture?.(M.pointerId),Z.current.set(M.pointerId,{x:M.clientX,y:M.clientY}),E.current={x:M.clientX,y:M.clientY})},[]),B=S.useCallback(M=>{const H=Z.current;if(H.has(M.pointerId)){if(H.set(M.pointerId,{x:M.clientX,y:M.clientY}),H.size===2){const W=Array.from(H.values()),R=W[1].x-W[0].x,z=W[1].y-W[0].y,K=Math.hypot(R,z),J={x:(W[0].x+W[1].x)/2,y:(W[0].y+W[1].y)/2},se=u.current,X=se&&se.getPointerPosition()||J;if(ae.current!=null){const ie=K/Math.max(1,ae.current);d.zoomByFactor(ie,X)}ae.current=K,ee.current=X}else if(H.size===1){const W=P();if(d.scale<=W)return;const R=M.clientX-E.current.x,z=M.clientY-E.current.y;E.current={x:M.clientX,y:M.clientY},d.panBy(R,z)}}},[]),V=S.useCallback(M=>{const H=c.current;H&&(H.releasePointerCapture?.(M.pointerId),Z.current.delete(M.pointerId),Z.current.size<2&&(ae.current=null),N.current=!1)},[]);return l.jsx("div",{ref:c,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onPointerDown:ne,onPointerMove:B,onPointerUp:V,children:l.jsx(e0,{ref:u,width:f.width,height:f.height,onWheel:_,onMouseDown:F,onMouseMove:A,onMouseUp:j,onMouseLeave:j,children:l.jsx(Zh,{children:l.jsx(sc,{ref:p,x:d.translate.x,y:d.translate.y,scaleX:d.scale,scaleY:d.scale,children:(()=>{const M=(n%360+360)%360;let H=0,W=0;M===90?H=L:M===180?(H=I,W=L):M===270&&(W=I);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:M,tx:H,ty:W,canvasW:I,canvasH:L})}catch{}return l.jsxs(sc,{ref:x,x:H,y:W,rotation:n,children:[l.jsx($a,{x:0,y:0,width:I,height:L,fill:"white"}),l.jsxs(sc,{x:C.x,y:C.y,scaleX:C.scale,scaleY:C.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((R,z)=>Y(R,z))):null,Array.isArray(t)&&t.map((R,z)=>l.jsxs(sc,{x:R.x,y:R.y,children:[l.jsx($a,{width:R.width,height:R.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),l.jsx(zc,{text:R.text,x:8,y:8,width:Math.max(0,(R.width||0)-16),height:Math.max(0,(R.height||0)-16),fontSize:R.fontSize||14,fill:R.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${z}`))]})]})})()})})})})});UB.displayName="ViewerCanvas";const Xae=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[l.jsx(et,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:l.jsx(Nae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(et,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:l.jsx(jae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(et,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:l.jsx(Cae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(et,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:l.jsx(_ae,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(et,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?l.jsx(RB,{className:"w-4 h-4 mx-auto my-auto"}):l.jsx(Sae,{className:"w-4 h-4 mx-auto my-auto"})})]}),Jae=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:l.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(et,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),l.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),l.jsx(et,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),zB=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1,onSaveScore:i})=>{const{drawingState:o,setDrawingState:c,drawingData:u,setDrawingData:d,textBoxes:f,setTextBoxes:g,saveToHistoryState:p,undo:x,redo:v,canUndoState:w,canRedoState:C}=Mae(),{questionsData:k,currentQuestionIndex:_,setCurrentQuestionIndex:N}=Kae(e),{zoom:E,position:P,handleZoomIn:F,handleZoomOut:A}=Vae(MB,Ql),{isFullscreen:j,enterFullscreen:I,exitFullscreen:L}=qae(o,c),{handleTouchStart:Y,handleTouchMove:Z,handleTouchEnd:ae}=Gae(o,c,u,d,p,x,v,w,C),ee=S.useRef(null),ne=S.useRef(null),[B,V]=S.useState(1),[M,H]=S.useState(""),[W,R]=S.useState("");S.useEffect(()=>{if(console.log("DrawingModal - questionsData:",k),console.log("DrawingModal - currentQuestionIndex:",_),k.length>0){const ce=k[_]?.drawingData||[],be=k[_]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",ce),console.log("DrawingModal - setting textBoxes:",be),d(ce),g(be)}},[k,_,d,g]),S.useEffect(()=>{t&&e&&(H((Number.isFinite(e.score)?e.score:0).toString()),R("10"))},[t,e]);const z=()=>{_>0&&N(_-1)},K=()=>{_<k.length-1&&N(_+1)},J=()=>{w&&x()},se=()=>{C&&v()};S.useEffect(()=>{const ce=be=>{(be.ctrlKey||be.metaKey)&&(be.key==="z"&&!be.shiftKey?(be.preventDefault(),J()):(be.key==="y"||be.key==="z"&&be.shiftKey)&&(be.preventDefault(),se()))};return document.addEventListener("keydown",ce),()=>document.removeEventListener("keydown",ce)},[J,se]);const X=()=>{c(ce=>({...ce,rotation:(ce.rotation+90)%360}))},ie=()=>{if(a&&ne.current){const pe=ne.current.exportPNGFullCanvas();if(!pe)return;const Ce=document.createElement("a");Ce.href=pe,Ce.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce);return}const ce=ee.current;if(!ce)return;const be=ce.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Ql.WIDTH,height:Ql.HEIGHT}),re=document.createElement("a");re.href=be,re.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(re),re.click(),document.body.removeChild(re)},le=async()=>{if(!a)return r();const ce=parseInt(M,10),be=10;Number.isFinite(ce)&&(typeof i=="function"?await i({resultId:e.id,score:Math.max(0,Math.min(10,ce)),maxScore:be}):(n&&n(e.id,ce),s&&s(e.id,be))),r()};return!t||!e?null:l.jsx(wo,{children:l.jsx(at.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:l.jsxs(at.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:ce=>ce.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),l.jsx(et,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:l.jsx(RB,{className:"w-5 h-5"})})]}),k.length>1&&l.jsx(Jae,{currentQuestion:_,totalQuestions:k.length,onPrevious:z,onNext:K,drawingDataLength:k[_]?.drawingData?.length||0}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[l.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?l.jsx(UB,{ref:ne,drawingData:u,textBoxes:f,canvasSize:{width:Ql.WIDTH,height:Ql.HEIGHT,WIDTH:Ql.WIDTH,HEIGHT:Ql.HEIGHT},rotation:o.rotation,onScaleChange:V}):l.jsx($B,{ref:ee,drawingData:u,textBoxes:f,drawingState:o,canvasSize:{width:Ql.WIDTH,height:Ql.HEIGHT,WIDTH:Ql.WIDTH,HEIGHT:Ql.HEIGHT},zoom:E,position:P,onTouchStart:Y,onTouchMove:Z,onTouchEnd:ae,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),l.jsx(Xae,{zoom:a?B:E,onZoomIn:()=>{if(a&&ne.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:ne.current.getScale?.()})}catch{}ne.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:ne.current.getScale?.()})}catch{}},0)}else F()},onZoomOut:()=>{if(a&&ne.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:ne.current.getScale?.()})}catch{}ne.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:ne.current.getScale?.()})}catch{}},0)}else A()},onRotate:X,onDownload:ie,onFullscreen:j?L:I,isFullscreen:j}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?B:E)*100),"%"]})]}),a&&l.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),l.jsx("input",{type:"number",min:"0",max:10,value:M,onChange:ce=>H(ce.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max:"}),l.jsx("input",{type:"number",value:10,disabled:!0,className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded bg-gray-100"})]}),l.jsx(et,{onClick:le,variant:"primary",size:"sm",children:"Save"})]})})]})]})})})},WB=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const c=Eo(),{user:u,isAuthenticated:d}=cs(),{testResults:f,loadTestResults:g}=zv(),[p,x]=S.useState(!0),[v,w]=S.useState(""),[C,k]=S.useState([]),[_,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState([]),[j,I]=S.useState(0),[L,Y]=S.useState(0),[Z,ae]=S.useState(!1),[ee,ne]=S.useState(null),B=S.useCallback(X=>{const ie=X.best_retest_score||X.score,le=X.best_retest_max_score||X.max_score,ce=Math.round(ie/le*100);return{score:ie,maxScore:le,percentage:ce}},[]);S.useEffect(()=>{V()},[e,t]),S.useEffect(()=>{!e&&!t&&(f&&f.results?(me.debug(" Using cached test results from TestContext"),N(f.results),x(!1)):H())},[e,t,f]);const V=S.useCallback(async()=>{me.debug(" Initializing Student Results...");try{if(x(!0),w(""),!d||!u){me.debug(" User not authenticated"),w("User not authenticated");return}if(u.role!==Qi.STUDENT){me.error(" Invalid user role for student results:",u.role),w("Access denied. Student role required.");return}me.debug(" Loading test results..."),await g(u?.student_id||u?.id||""),e&&t&&r&&(me.debug(" Loading specific test results..."),await M(e,t,r)),me.debug(" Student Results initialization complete!")}catch(X){me.error(" Error initializing student results:",X),w("Failed to initialize student results")}finally{x(!1)}},[d,u,e,t,r,g]),M=S.useCallback(async(X,ie,le)=>{me.debug(" Loading specific test results:",X,ie);try{const ce=await hn.getTestInfo(X,ie);me.debug(" Test info loaded:",ce),P(ce);const be=await hn.getTestQuestions(X,ie);me.debug(" Test questions loaded:",be),A(be);const re=wf(be,le,X).score,pe=be.length>0?Math.round(re/be.length*100):0;I(re),Y(pe),me.debug(" Test results calculated:",{score:re,percentage:pe})}catch(ce){throw me.error(" Error loading specific test results:",ce),ce}},[]),H=S.useCallback(async(X=0)=>{me.debug(" Loading all student results using existing test results API...",X>0?`(retry ${X})`:"");try{if(!(u?.student_id||u?.sub))throw new Error("Student ID not found");const le=await hn.getStudentTestResults();if(le.success){me.debug(" All student results loaded:",le.results.length,"results");const ce=le.results.map(be=>({...be,caught_cheating:be.caught_cheating||!1,visibility_change_times:be.visibility_change_times||0}));N(ce),ne(new Date),le.results.length===0&&X===0&&(me.debug(" No results found, retrying in 2 seconds..."),setTimeout(()=>{H(1)},2e3))}else throw new Error(le.error||"Failed to load student results")}catch(ie){me.error(" Error loading all student results:",ie),w(ie.message)}},[u]),W=S.useCallback(X=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[X]||X,[]),R=S.useCallback(X=>{if(!X||X.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No results available"})});const ie=a?X:X.slice(0,o);return l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),l.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map((le,ce)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:l.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:W(le.subject)})}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:le.teacher_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:le.test_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:l.jsx("div",{className:"flex flex-col items-center space-y-1",children:le.test_type==="drawing"?le.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:be,maxScore:re,percentage:pe}=B(le);return pe>=80?"bg-green-100 text-green-800":pe>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:be,maxScore:re,percentage:pe}=B(le);return`${be}/${re} (${pe}%)`})()}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):le.test_type==="speaking"?le.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:be,maxScore:re,percentage:pe}=B(le);return pe>=80?"bg-green-100 text-green-800":pe>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:be,maxScore:re,percentage:pe}=B(le);return`${be}/${re} (${pe}%)`})()}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${(()=>{const{score:be,maxScore:re,percentage:pe}=B(le);return pe>=80?"bg-green-100 text-green-800":pe>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"})()}`,children:(()=>{const{score:be,maxScore:re,percentage:pe}=B(le);return`${be}/${re} (${pe}%)`})()})})}),l.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(le.submitted_at).toLocaleDateString()})]},ce))})]}),X.length>o&&i&&l.jsx("div",{className:"text-center pt-4",children:l.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${X.length-o} More`})})]})},[W,a,o,i]),z=S.useCallback((X,ie)=>{if(me.debug(" formatAnswer called with:",{answer:X,testType:ie,answerType:typeof X}),!X)return"No answer";switch(ie){case"true_false":const le=typeof X=="boolean"?X:X==="true";return me.debug(" Boolean answer processed:",le),le?"True":"False";case"multiple_choice":return X.toUpperCase();case"input":return X;case"word_matching":return typeof X=="object"?Object.entries(X).map(([ce,be])=>`${ce}  ${be}`).join(", "):X;case"drawing":return"Drawing submitted";default:return X}},[]),K=S.useCallback(()=>!E||!F||!r?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",E.test_name||E.title||"Test"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:j}),l.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:F.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-3xl font-bold ${L>=80?"text-green-600":L>=60?"text-yellow-600":"text-red-600"}`,children:[L,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),l.jsx("div",{className:"space-y-4",children:F.map((X,ie)=>{const le=r[ie],ce=Jy(X,e),be=Sm(X,le,e);return l.jsxs("div",{className:`border rounded-lg p-4 ${be?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ie+1]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${be?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:be?"Correct":"Incorrect"})]}),l.jsx("p",{className:"text-gray-700 mb-3",children:X.question}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:z(le,e)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:z(ce,e)})]})]})]},ie)})})]})]}),[E,F,r,e,j,L,Jy,Sm,z]),J=S.useCallback(()=>{if(!_||_.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const X={};return _.forEach(ie=>{const le=ie.subject||"Unknown Subject";X[le]||(X[le]=[]),X[le].push(ie)}),l.jsx("div",{className:"space-y-6",children:Object.entries(X).map(([ie,le])=>l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ie})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:le.map((ce,be)=>{const{score:re,maxScore:pe,percentage:Ce}=B(ce),Ae=Ce>=80?"text-green-600":Ce>=60?"text-yellow-600":"text-red-600";return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:ce.test_name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:ce.teacher_name||"Unknown"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l.jsxs("span",{className:Ae,children:[re,"/",pe," (",Ce,"%)"]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(ce.submitted_at).toLocaleDateString()})]},be)})})]})})]},ie))})},[_]);S.useCallback(()=>{me.debug(" Clearing test data and returning to cabinet..."),P(null),A([]),setStudentAnswers(null),I(0),Y(0),ae(!1),n?n():c("/student")},[n,c]);const se=S.useCallback(()=>{me.debug(" Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return S.useCallback((X,ie)=>{const le={id:Date.now(),message:X,type:ie,timestamp:new Date};k(ce=>[...ce,le]),setTimeout(()=>{k(ce=>ce.filter(be=>be.id!==le.id))},N0.NOTIFICATION_DURATION)},[]),p?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):v?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:v}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{children:[p?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Hr,{size:"md"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):v?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-red-600",children:v})]}):R(_),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>l.jsx(uc,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))})]}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[E&&l.jsx(et,{variant:"outline",onClick:()=>ae(!Z),children:Z?"Hide Details":"Show Details"}),l.jsx(et,{variant:"outline",onClick:se,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Z&&E?K():J()}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:C.map(X=>l.jsx(uc,{type:X.type,message:X.message,onClose:()=>k(ie=>ie.filter(le=>le.id!==X.id))},X.id))}),selectedDrawing&&l.jsx(zB,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},Qae=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Eo(),{user:s,isAuthenticated:a,logout:i}=cs(),{studentData:o,loadStudentData:c}=r2(),{activeTests:u,testResults:d,loadActiveTests:f,loadTestResults:g,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=zv(),[w,C]=S.useState(!0),[k,_]=S.useState(""),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(!1),[I,L]=S.useState(null),[Y,Z]=S.useState(null),[ae,ee]=S.useState(new Set),[ne,B]=S.useState(!1),[V,M]=S.useState(!1),[H,W]=S.useState(!1),[R,z]=S.useState(!1);S.useEffect(()=>{K()},[]),S.useEffect(()=>()=>{W(!1)},[]),S.useEffect(()=>{if(H){const pe=setTimeout(()=>{W(!1)},1e3);return()=>clearTimeout(pe)}},[H]);const K=S.useCallback(async()=>{me.debug(" Initializing Student Cabinet...");try{if(C(!0),_(""),!a||!s){me.debug(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==Qi.STUDENT){me.error(" Invalid user role for student cabinet:",s.role),_("Access denied. Student role required.");return}me.debug(" Loading active tests (single API call)...");const pe=s?.student_id||s?.id||"";if(J(pe)){me.debug(" Cache refresh triggered - clearing cache");try{const Ae=`student_active_tests_${pe}`,We=`student_results_table_${pe}`;localStorage.removeItem(Ae),localStorage.removeItem(We)}catch{}}else me.debug(" Using existing cache - no refresh needed");try{localStorage.removeItem(`student_active_tests_${pe}`)}catch{}await f(pe),me.debug(" Student Cabinet initialization complete!")}catch(pe){me.error(" Error initializing student cabinet:",pe),_("Failed to initialize student cabinet")}finally{C(!1)}},[a,s,n]),J=S.useCallback(pe=>{if(window.studentCabinetRefreshRequested)return window.studentCabinetRefreshRequested=!1,me.debug(" Manual refresh requested"),!0;if(window.recentTestCompleted)return window.recentTestCompleted=!1,me.debug(" Test completed - cache refresh triggered"),!0;const Ce=localStorage.getItem(`last_cabinet_refresh_${pe}`);if(Ce&&Date.now()-parseInt(Ce)>1800*1e3)return me.debug(" Time-based refresh triggered"),!0;try{for(let Ae=0;Ae<localStorage.length;Ae++){const We=localStorage.key(Ae);if(We&&We.startsWith(`retest_assignment_id_${pe}_`))return me.debug(" Retest assignment key detected, forcing cache refresh:",We),!0}}catch{}return me.debug(" No refresh triggers - using existing cache"),!1},[]);S.useCallback(async()=>{me.debug(" Calculating average score...");try{if(d&&d.length>0){const pe=d.reduce((Ae,We)=>{const Le=We.best_retest_score||We.score,At=We.best_retest_max_score||We.max_score;return typeof Le=="number"&&typeof At=="number"&&At>0?Ae+Math.round(Le/At*100):Ae},0),Ce=Math.round(pe/d.length);Z(Ce),me.debug(" Average score calculated:",Ce)}}catch(pe){me.error(" Error calculating average score:",pe)}},[d]),S.useEffect(()=>{if(H){me.debug(" Skipping completed tests initialization during navigation");return}const pe=s?.student_id||s?.id;if(!pe){me.debug(" Student ID not available yet, skipping localStorage initialization");return}const Ce=new Set;for(let Ae=0;Ae<localStorage.length;Ae++){const We=localStorage.key(Ae);if(We&&We.startsWith(`test_completed_${pe}_`)&&localStorage.getItem(We)==="true"){const At=We.replace(`test_completed_${pe}_`,"").split("_");if(At.length>=2){const Qe=At[0],gt=At.slice(1).join("_"),ht=`${Qe}_${gt}`;Ce.add(ht),me.debug(" Found completed test in localStorage:",ht)}}}ee(Ce),z(!0),me.debug(" Initialized completed tests from localStorage:",Array.from(Ce))},[s?.student_id,s?.id,H]),S.useEffect(()=>{me.debug(" testResults structure:",d);const pe=d?.results||d;if(me.debug(" resultsArray:",pe),pe&&pe.length>0){const Ce=s?.student_id||s?.id||"",Ae=new Set;pe.forEach(We=>{const Le=`${We.test_type}_${We.test_id}`;Ae.add(Le),localStorage.setItem(`test_completed_${Ce}_${We.test_type}_${We.test_id}`,"true")}),ee(We=>{const Le=new Set([...We,...Ae]);return me.debug(" Updated completed tests (merged):",Array.from(Le)),Le})}},[d,s?.student_id,s?.id]);const se=S.useCallback(async(pe,Ce,Ae=!1,We=null)=>{me.debug(" Checking test completion:",pe,Ce,"retestAvailable:",Ae);try{const Le=s?.student_id||s?.id||"";if(Ae){me.debug(" Retest available from backend, checking attempt limits.");const ht=[];for(let Dt=1;Dt<=10;Dt++){const Rt=`retest_attempt${Dt}_${Le}_${pe}_${Ce}`;localStorage.getItem(Rt)==="true"&&ht.push(Rt)}const tt=ht.length,ut=We?.retest_attempts_left||We?.max_attempts||3;return me.debug(" Current attempts:",tt,"Max attempts:",ut,"Attempt keys:",ht),tt>=ut?(me.debug(" Maximum retest attempts reached in localStorage"),!0):(me.debug(" Retest attempts available, allowing start."),!1)}const At=`test_completed_${Le}_${pe}_${Ce}`,Qe=localStorage.getItem(At);if(me.debug(" localStorage key:",At),me.debug(" localStorage value:",Qe),pe==="word_matching"){me.debug(" Debug: All localStorage keys for student",Le);for(let ht=0;ht<localStorage.length;ht++){const tt=localStorage.key(ht);tt&&tt.includes(Le)&&tt.includes("word_matching")&&me.debug(" Found word_matching key:",tt,"=",localStorage.getItem(tt))}}if(Qe==="true")return me.debug(" Found completion status in local storage:",Qe),!0;const gt=d?.results||d;return gt&&gt.length>0&&(me.debug(" Checking database results:",gt.length,"results"),gt.some(tt=>(me.debug(" Checking result:",tt.test_type,tt.test_id,"vs",pe,Ce),tt.test_type===pe&&tt.test_id===Ce)))?(me.debug(" Found completion status in database results"),localStorage.setItem(At,"true"),!0):(me.debug(" Test not completed according to local storage or database"),!1)}catch(Le){return me.error(" Error checking test completion:",Le),!1}},[d,s?.student_id,s?.id]),X=S.useCallback((pe,Ce)=>{const Ae={id:Date.now(),message:pe,type:Ce,timestamp:new Date};E(We=>[...We,Ae]),setTimeout(()=>{E(We=>We.filter(Le=>Le.id!==Ae.id))},N0.NOTIFICATION_DURATION)},[]),ie=S.useCallback(async pe=>{me.debug(" Showing test details:",pe);try{await p(pe.test_type,pe.test_id,pe.test_name)}catch(Ce){me.error("Error loading test details:",Ce),X("Failed to load test details","error")}},[p,X]),le=S.useCallback(pe=>{me.debug(" Starting test:",pe);const Ce=`${pe.test_type}_${pe.test_id}`;if(ae.has(Ce)&&!pe?.retest_available){X("This test has already been completed","warning");return}if(me.debug(" Checking retest conditions:"),me.debug(" test.retest_available:",pe?.retest_available),me.debug(" testKey:",Ce),me.debug(" completedTests.has(testKey):",ae.has(Ce)),me.debug(" completedTests:",Array.from(ae)),pe?.retest_available){const Ae=s?.student_id||s?.id||"",We=`retest1_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(We,"true"),me.debug(" Set retest key:",We);try{const Le=`test_completed_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.removeItem(Le);const At=`${pe.test_type}_${pe.test_id}`;localStorage.removeItem(At),me.debug(" Cleared completion keys for retest:",Le,At);const Qe=`retest_in_progress_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(Qe,"1"),me.debug(" Set in-progress retest lock:",Qe);try{const gt=`anti_cheating_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.removeItem(gt);const ht=`speaking_test_data_${Ae}_${pe.test_id}`;localStorage.removeItem(ht);const tt=`speaking_progress_${pe.test_id}`;localStorage.removeItem(tt);const ut=`_${Ae}_${pe.test_type}_${pe.test_id}`,Dt=[];for(let It=0;It<localStorage.length;It++){const De=localStorage.key(It);De&&(De.endsWith(ut)||De.includes(`answers_${Ae}_${pe.test_type}_${pe.test_id}`)||De.includes(`progress_${Ae}_${pe.test_type}_${pe.test_id}`)||De.includes(`state_${Ae}_${pe.test_type}_${pe.test_id}`)||De.includes(`selected_${Ae}_${pe.test_type}_${pe.test_id}`))&&Dt.push(De)}Dt.forEach(It=>localStorage.removeItem(It)),me.debug(" Cleared generic cached keys for retest start:",Dt);const Rt=`retest_attempts_${Ae}_${pe.test_type}_${pe.test_id}`;me.debug(" Cleared per-test cached keys for retest start:",{antiCheatKey:gt,speakingCacheKey:ht,speakingProgressKey:tt})}catch{}}catch{}if(me.debug(" Test retest_assignment_id:",pe.retest_assignment_id),me.debug(" Test retest_assignment_id type:",typeof pe.retest_assignment_id),pe?.retest_assignment_id){const Le=`retest_assignment_id_${Ae}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(Le,String(pe.retest_assignment_id)),me.debug(" Set retest assignment ID:",Le,"=",pe.retest_assignment_id)}else me.debug(" No retest assignment ID found in test data")}else me.debug(" Retest assignment ID storage skipped - retest not available");if(W(!0),me.debug(" Set isStartingTest to true for test:",pe.test_type),pe.test_type==="matching_type"){me.debug(" Redirecting to matching test page for testId:",pe.test_id),n(`/student/matching-test/${pe.test_id}`);return}if(pe.test_type==="word_matching"){me.debug(" Redirecting to word matching test page for testId:",pe.test_id),n(`/student/word-matching-test/${pe.test_id}`);return}if(pe.test_type==="speaking"){me.debug(" Redirecting to speaking test page for testId:",pe.test_id),n(`/student/speaking-test/${pe.test_id}`);return}n(`/student/test/${pe.test_type}/${pe.test_id}`)},[n,ae,X,s?.student_id,s?.id]),ce=S.useCallback(()=>{B(pe=>!pe)},[]),be=S.useCallback(()=>{M(pe=>!pe)},[]),re=S.useCallback(async pe=>{if(me.debug(" Starting test:",pe),H){me.debug(" Test already starting, ignoring click");return}try{if(await se(pe.test_type,pe.test_id,pe?.retest_available,pe)&&!pe?.retest_available){X("This test has already been completed","warning");return}le(pe)}catch(Ce){me.error(" Error starting test:",Ce),X("Failed to start test. Please try again.","error")}},[se,le,X,H]);return S.useCallback(pe=>{me.debug(" Viewing test details:",pe),ie(pe)},[ie]),w?l.jsx(at.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsxs(at.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx(Hr,{size:"lg"}),l.jsx(at.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?l.jsx(at.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsx(at.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:l.jsxs(at.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[l.jsx(at.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),l.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-6",children:k}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs(at.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(at.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(at.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(at.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),l.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),l.jsxs(at.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(at.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(wo,{children:e&&l.jsx(at.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(at.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(at.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),l.jsxs(at.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:l.jsx("div",{className:"lg:col-span-1 space-y-6",children:Y!==null&&l.jsx(at.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"Average Score"})}),l.jsx(jt.Body,{children:l.jsxs(at.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[l.jsxs(at.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[Y,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{className:"text-center",children:"Active Tests"})}),l.jsx(jt.Body,{children:u&&u.length>0?l.jsxs("div",{className:"relative",children:[me.debug(" Rendering overlay, isStartingTest:",H),H&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),l.jsxs("div",{className:"space-y-4",children:[(ne?u:u.slice(0,3)).map((pe,Ce)=>l.jsx(at.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:ne?0:.7+Ce*.1,duration:.3},whileHover:{scale:1.02},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[l.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:pe.test_name}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:pe.subject}),l.jsx("span",{className:"text-gray-500",children:pe.teacher_name}),l.jsxs("span",{className:"text-gray-500",children:[l.jsx("span",{className:"sm:hidden",children:new Date(pe.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),l.jsx("span",{className:"hidden sm:inline",children:new Date(pe.assigned_at).toLocaleDateString()})]})]})}),l.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Ae=`${pe.test_type}_${pe.test_id}`,We=ae.has(Ae);if(!R)return l.jsx(et,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."});if(We&&pe?.retest_available){const Le=s?.student_id||s?.id||"";let At=!1;try{const Qe=localStorage.getItem(`retest_attempts_${Le}_${pe.test_type}_${pe.test_id}`);if(Qe){const gt=JSON.parse(Qe);typeof gt?.used=="number"&&typeof gt?.max=="number"&&gt.used>=gt.max&&(At=!0)}}catch{}return At?l.jsx(et,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):l.jsx(et,{variant:"primary",size:"sm",onClick:()=>re(pe),disabled:H,children:"Start Retest"})}return We?l.jsx(et,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(me.debug(" Button render, isStartingTest:",H,"test:",pe.test_type),l.jsx(et,{variant:"primary",size:"sm",onClick:()=>re(pe),disabled:H,children:"Start Test"}))})()})]})},`${pe.test_type}_${pe.test_id}`)),u.length>3&&l.jsx("div",{className:"text-center pt-2",children:l.jsx("button",{onClick:ce,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:ne?"Show Less":`Show ${u.length-3} More`})})]})]}):l.jsxs(at.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[l.jsx(at.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"Test Results"})}),l.jsx(jt.Body,{children:d&&d.showResults?l.jsx(Wv,{testResults:d,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(pe,Ce)=>{f(),setTestResults(null)},isLoading:w}):l.jsx(WB,{compact:!0,showAll:V,onToggleShowAll:be,maxInitial:3})})]})})]})]}),l.jsx(FB,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(pe=>l.jsx(uc,{type:pe.type,message:pe.message,onClose:()=>E(Ce=>Ce.filter(Ae=>Ae.id!==pe.id))},pe.id))})]})},Zae=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[c,u]=S.useState(0),[d,f]=S.useState(0),[g,p]=S.useState(!0);if(S.useEffect(()=>{const w=()=>{try{const C=wf(t,n,r).score,k=e?.num_questions||t?.length||0,_=k>0?Math.round(C/k*100):0;u(C),f(_),p(!1)}catch(C){console.error("Error calculating test results:",C),u(0),f(0),p(!1)}};t&&t.length>0?w():p(!1)},[t,n,r,e,wf]),g)return l.jsx("div",{className:"flex justify-center items-center min-h-64",children:l.jsx("div",{className:"text-lg",children:"Calculating results..."})});const x=e?.num_questions||t?.length||0,v=e?.test_name||e?.title||"Test";return l.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"results-header text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",v]}),l.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"results-summary",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",c," / ",x," (",d,"%)"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d>=80?"bg-green-500":d>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${d}%`}})}),l.jsx("div",{className:"text-center",children:l.jsx("p",{className:`text-lg font-medium ${d>=80?"text-green-600":d>=60?"text-yellow-600":"text-red-600"}`,children:d>=80?"Excellent!":d>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&l.jsx(jt,{className:"mb-6",children:l.jsxs("div",{className:"questions-review",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:t.map((w,C)=>{const k=n[String(w.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",C+1,":",{question:w,studentAnswer:k,testType:r});const _=a(w,k,r);return console.log(" TestResultsDisplay - isCorrect result:",_),l.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${_?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[l.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[l.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",C+1]}),l.jsx("span",{className:`text-2xl font-bold ${_?"text-green-600":"text-red-600"}`,children:_?"":""})]}),l.jsx("div",{className:"question-text mb-3",children:l.jsx("p",{className:"text-gray-700 font-medium",children:w.question})}),l.jsxs("div",{className:"answer-section space-y-2",children:[l.jsxs("p",{className:"student-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",l.jsx("span",{className:`font-medium ${_?"text-green-700":"text-red-700"}`,children:i(k,r,w)})]}),!_&&l.jsxs("p",{className:"correct-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",l.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(w.correct_answer||"").toUpperCase():i(o(w,r),r,w)})]})]})]},w.question_id||C)})})]})}),l.jsx(jt,{children:l.jsx("div",{className:"results-actions text-center",children:l.jsx(et,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})};class eie{constructor(){this.activeRequests=new Map,this.completedRequests=new Map,this.maxCacheSize=100,this.cacheTimeout=3e4}generateKey(t,r,n={}){const s=Object.keys(n).sort().reduce((a,i)=>(a[i]=n[i],a),{});return`${t}_${r}_${JSON.stringify(s)}`}isRequestInProgress(t){return this.activeRequests.has(t)}getCachedResult(t){const r=this.completedRequests.get(t);return r&&Date.now()-r.timestamp<this.cacheTimeout?r.result:null}startRequest(t,r){return this.activeRequests.set(t,r),r.finally(()=>{this.activeRequests.delete(t)}),r}cacheResult(t,r){if(this.completedRequests.size>=this.maxCacheSize){const n=this.completedRequests.keys().next().value;this.completedRequests.delete(n)}this.completedRequests.set(t,{result:r,timestamp:Date.now()})}async deduplicateApiCall(t,r,n,s){const a=this.generateKey(t,r,n);if(this.isRequestInProgress(a))return console.log(" API deduplication: Request already in progress, waiting...",a),this.activeRequests.get(a);const i=this.getCachedResult(a);if(i)return console.log(" API deduplication: Using cached result",a),i;console.log(" API deduplication: Making new request",a);const o=this.startRequest(a,s());try{const c=await o;return this.cacheResult(a,c),c}catch(c){throw c}}clearCache(){this.activeRequests.clear(),this.completedRequests.clear(),console.log(" API deduplication: Cache cleared")}}const NF=new eie,tie=(e,t)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>e.apply(null,n),t)}},rie=({onBackToCabinet:e,currentTest:t})=>{const r=Eo(),{user:n,isAuthenticated:s}=cs(),{activeTests:a,loadActiveTests:i}=zv(),o=S.useCallback(tie((Pe,He,ke)=>{try{if(window.skipInitialProgressSave&&ke.answers&&ke.answers.length===0){me.debug(" Skipping empty progress save during restoration"),window.skipInitialProgressSave=!1;return}const Ue=`test_progress_${n?.student_id||n?.id||"unknown"}_${Pe}_${He}`,Et=localStorage.getItem(Ue);if(Et&&ke.answers&&ke.answers.length===0)try{const Ft=JSON.parse(Et);if(Ft.answers&&Ft.answers.length>0){me.debug(" Skipping empty progress save - existing progress is better:",Ft.answers);return}}catch{}localStorage.setItem(Ue,JSON.stringify(ke)),me.debug(`Saved test progress for ${Pe}_${He}:`,ke)}catch($e){me.error("Error saving test progress:",$e)}},1e3),[n?.student_id,n?.id]),c=S.useCallback((Pe,He,ke)=>{o(Pe,He,ke)},[o]),u=S.useCallback((Pe,He)=>{try{const $e=`test_progress_${n?.student_id||n?.id||"unknown"}_${Pe}_${He}`,Ue=localStorage.getItem($e);return Ue?JSON.parse(Ue):null}catch(ke){return me.error("Error getting test progress:",ke),null}},[n?.student_id,n?.id]),d=S.useCallback((Pe,He)=>{try{const ke=n?.student_id||n?.id||"unknown",$e=`test_progress_${ke}_${Pe}_${He}`;localStorage.removeItem($e);for(let Ue=0;Ue<localStorage.length;Ue++){const Et=localStorage.key(Ue);Et&&Et.startsWith(`test_progress_${ke}_${Pe}_${He}_`)&&(localStorage.removeItem(Et),me.debug(` Cleared individual question key: ${Et}`))}me.debug(`Cleared test progress for ${Pe}_${He}`)}catch(ke){me.error("Error clearing test progress:",ke)}},[n?.student_id,n?.id]),[f,g]=S.useState(!0),[p,x]=S.useState(!1),[v,w]=S.useState(""),[C,k]=S.useState(!1),[_,N]=S.useState(""),[E,P]=S.useState([]),[F,A]=S.useState(t?"test":"list"),[j,I]=S.useState(null),[L,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState([]),[B,V]=S.useState([]),[M,H]=S.useState(0),[W,R]=S.useState(0),[z,K]=S.useState(null),J=Fs.useRef(null),se=Fs.useRef(null),[X,ie]=S.useState(!1),[le,ce]=S.useState(!1),[be,re]=S.useState(null),[pe,Ce]=S.useState(null),[Ae,We]=S.useState(!1),[Le,At]=S.useState(!1),[Qe,gt]=S.useState({isInitialized:!1,initializationId:null,lastTestId:null,initializationCount:0}),[ht,tt]=S.useState({isRestored:!1,restoredTestId:null,restorationCount:0}),{startTracking:ut,stopTracking:Dt,getCheatingData:Rt,clearData:It,isCheating:De,tabSwitches:Ie}=Xm(j?.test_type,j?.test_id,n?.student_id||n?.id);S.useEffect(()=>{(()=>{const He=[];for(let ke=0;ke<localStorage.length;ke++){const $e=localStorage.key(ke);if($e&&$e.startsWith("test_progress_")&&!$e.includes("_51712_")&&!$e.includes("_51736_")){const Ue=$e.split("_");Ue.length===4&&Ue[0]==="test"&&Ue[1]==="progress"&&He.push($e)}}He.forEach(ke=>{localStorage.removeItem(ke),me.debug(" Cleared old cache key:",ke)})})()},[]);const Je=S.useCallback(()=>{const Pe=j?.test_id,He=n?.student_id||n?.id;if(!He||!Pe)return me.debug(" Skipping initialization - missing required data:",{studentId:He,currentTestId:Pe}),!1;const ke=`${He}_${Pe}_${Date.now()}`;return Qe.isInitialized&&Qe.lastTestId===Pe?(me.debug(" Already initialized for this test - skipping"),!1):Qe.initializationId?(me.debug(" Initialization in progress - skipping duplicate"),!1):(me.debug(" Starting initialization:",ke),gt({isInitialized:!1,initializationId:ke,lastTestId:Pe}),!0)},[Qe,j,n?.student_id,n?.id]),qe=S.useCallback(()=>{gt(Pe=>({...Pe,isInitialized:!0,initializationId:null})),me.debug(" Initialization completed")},[]),Ze=S.useCallback(async()=>{me.debug(" Initializing Student Tests...");try{if(g(!0),N(""),!s||!n){me.debug(" User not authenticated"),N("User not authenticated");return}if(n.role!==Qi.STUDENT){me.error(" Invalid user role for student tests:",n.role),N("Access denied. Student role required.");return}me.debug(" Loading active tests..."),await i(),qe(),me.debug(" Student Tests initialization complete!")}catch(Pe){me.error(" Error initializing student tests:",Pe),N("Failed to initialize student tests")}finally{g(!1)}},[s,n,i,qe]);S.useEffect(()=>{Je()&&Ze()},[Je,Ze]),S.useEffect(()=>{t&&(me.debug(" Auto-starting test from prop:",t),k(!0),$t(t))},[t]),S.useCallback(async()=>{me.debug(" Loading student active tests...");try{const Pe=await hn.getActiveTests();me.debug(" Active tests loaded:",Pe);const He=Pe.map(ke=>({...ke,subject_id:ke.subject_id||ke.subjectId,teacher_id:ke.teacher_id||ke.teacherId,is_active:ke.is_active!==void 0?ke.is_active:!0,created_at:ke.created_at||ke.createdAt,updated_at:ke.updated_at||ke.updatedAt}));return Ce(new Date),He}catch(Pe){throw me.error(" Error loading active tests:",Pe),Pe}},[]),S.useCallback(async(Pe,He)=>{me.debug(" Checking test completion:",Pe,He);try{const ke=u(Pe,He);return ke&&ke.completed}catch(ke){return me.error(" Error checking test completion:",ke),!1}},[u]),S.useEffect(()=>{if(ee.length>0&&j?.test_id){const Pe=setTimeout(()=>{let He=!1;const ke=new Array(ee.length).fill("");if(ee.forEach(($e,Ue)=>{const Ft=`test_progress_${n?.student_id||n?.id||"unknown"}_${L}_${j?.test_id}_${$e.question_id}`,zt=localStorage.getItem(Ft);if(zt){const fr=zt.replace(/^"(.*)"$/,"$1");ke[Ue]=fr,He=!0}}),He){V(ke);const $e=ke.filter(Et=>Et&&typeof Et=="string"&&Et.trim()!=="").length,Ue=ee.length>0?$e/ee.length*100:0;H(Ue)}},100);return()=>clearTimeout(Pe)}},[ee,L,j?.test_id]);const Tt=S.useCallback(async(Pe,He)=>{me.debug(" Marking test as completed:",Pe,He);try{const ke=u(Pe,He)||{};ke.completed=!0,ke.completedAt=new Date().toISOString(),c(Pe,He,ke);const Ue=`test_completed_${n?.student_id||n?.id||""}_${Pe}_${He}`;localStorage.setItem(Ue,"true"),me.debug(" Test completion marked in localStorage:",Ue),me.debug(" localStorage value after setting:",localStorage.getItem(Ue)),ge("Test marked as completed","success")}catch(ke){me.error(" Error marking test as completed:",ke),ge("Failed to mark test as completed","error")}},[u,c]),Nt=S.useCallback(Pe=>{me.debug(" Showing test details:",Pe),re(Pe),ce(!0)},[]),$t=S.useCallback(async Pe=>{me.debug(" Starting test:",Pe);let He=Date.now(),ke;try{w(""),x(!0),He=Date.now();const $e=()=>{const Ne=Date.now()-He,ot=Math.max(0,250-Ne);setTimeout(()=>{g(!1),x(!1)},ot)};let Ue=!1;ke=setTimeout(()=>{Ue=!0,w("Loading is taking longer than expected...")},15e3);const Ft=`test_completed_${n?.student_id||n?.id||""}_${Pe.test_type}_${Pe.test_id}`,zt=localStorage.getItem(Ft)==="true";if(zt&&!Pe?.retest_available){me.debug(" Test already completed, redirecting to main cabinet"),ge("This test has already been completed","info"),r("/student");return}if(zt&&Pe?.retest_available&&me.debug(" Test completed but retest available, allowing retest"),Pe.test_type===On.MATCHING){me.debug(" Redirecting to matching test page for testId:",Pe.test_id),r(`/student/matching-test/${Pe.test_id}`);return}if(Pe.test_type===On.WORD_MATCHING){me.debug(" Redirecting to word matching test page for testId:",Pe.test_id),r(`/student/word-matching-test/${Pe.test_id}`);return}I(Pe),Y(Pe.test_type),tt({isRestored:!1,restoredTestId:null,restorationCount:0});const[fr,nr]=await Promise.all([NF.deduplicateApiCall("GET",`test-info-${Pe.test_type}-${Pe.test_id}`,{testType:Pe.test_type,testId:Pe.test_id},()=>hn.getTestInfo(Pe.test_type,Pe.test_id)),NF.deduplicateApiCall("GET",`test-questions-${Pe.test_type}-${Pe.test_id}`,{testType:Pe.test_type,testId:Pe.test_id},()=>hn.getTestQuestions(Pe.test_type,Pe.test_id))]);ae(fr);let Dr=nr;try{if(!!fr?.is_shuffled){const Ye=n?.student_id||n?.id||"unknown",ot=`${Ye}:${Pe.test_type}:${Pe.test_id}`,pt=Array.from(ot).reduce((Jt,wr)=>(Jt<<5)-Jt+wr.charCodeAt(0),0)>>>0,Gt=`test_shuffle_order_${Ye}_${Pe.test_type}_${Pe.test_id}`,xt=localStorage.getItem(Gt);if(xt){const Jt=JSON.parse(xt),wr=new Map(nr.map(Sr=>[Sr.question_id,Sr]));Dr=Jt.map(Sr=>wr.get(Sr)).filter(Boolean)}else{const wr=function(xr){return function(){var Ir=xr+=1831565813;return Ir=Math.imul(Ir^Ir>>>15,Ir|1),Ir^=Ir+Math.imul(Ir^Ir>>>7,Ir|61),((Ir^Ir>>>14)>>>0)/4294967296}}(pt);Dr=[...nr];for(let xr=Dr.length-1;xr>0;xr--){const Ir=Math.floor(wr()*(xr+1));[Dr[xr],Dr[Ir]]=[Dr[Ir],Dr[xr]]}const Sr=Dr.map(xr=>xr.question_id);localStorage.setItem(Gt,JSON.stringify(Sr))}}}catch(Ne){me.error("Shuffle error (ignored):",Ne)}ne(Dr),$e();const ue=Pe.test_id;if(ht.isRestored&&ht.restoredTestId===ue){me.debug(" Progress already restored for this test - skipping");return}me.debug(" Starting progress restoration for test:",Pe.test_type,Pe.test_id),tt(Ne=>({...Ne,restorationCount:Ne.restorationCount+1}));const we=n?.student_id||n?.id||"unknown",ye=`test_progress_${we}_${Pe.test_type}_${Pe.test_id}`,xe=localStorage.getItem(ye);me.debug(" Checking main progress key:",ye),me.debug(" Main progress data:",xe);let _e=new Array(nr.length).fill("");if(xe)try{const Ne=JSON.parse(xe);me.debug(" Parsed progress data:",Ne),Ne.answers&&Array.isArray(Ne.answers)&&(_e=Ne.answers,me.debug(" Loaded answers from main progress:",_e))}catch(Ne){me.error(" Error parsing main progress:",Ne)}nr.forEach((Ne,Ye)=>{const ot=`test_progress_${we}_${Pe.test_type}_${Pe.test_id}_${Ne.question_id}`,pt=localStorage.getItem(ot);if(me.debug(` Checking individual answer for question ${Ne.question_id}:`,pt),pt){const Gt=pt.replace(/^"(.*)"$/,"$1");_e[Ye]=Gt,me.debug(` Loaded individual answer for question ${Ne.question_id}:`,Gt)}}),me.debug(" Final initial answers after loading all sources:",_e);const Se=_e.filter(Ne=>Ne&&typeof Ne=="string"&&Ne.trim()!=="").length;if(Se>0){me.debug(` Restoring progress: ${Se}/${nr.length} questions answered`),V(_e);const Ne=nr.length>0?Se/nr.length*100:0;H(Ne),me.debug(` Progress restored: ${Ne}% complete`)}else me.debug(" No existing progress found - starting fresh"),V(_e),H(0);tt(Ne=>({...Ne,isRestored:!0,restoredTestId:ue})),Se>0&&(me.debug(" Existing progress found - preventing overwrite during initialization"),window.skipInitialProgressSave=!0);const Ve=Number(fr?.allowed_time||0),lt=n?.student_id||n?.id||"unknown";if(J.current=`test_timer_${lt}_${Pe.test_type}_${Pe.test_id}`,Ve>0)try{const Ne=localStorage.getItem(J.current),Ye=Date.now();if(Ne){const ot=JSON.parse(Ne),pt=Math.floor((Ye-new Date(ot.lastTickAt).getTime())/1e3),Gt=Math.max(0,Number(ot.remainingSeconds||Ve)-Math.max(0,pt));R(Gt),se.current=Ye}else R(Ve),se.current=Ye,localStorage.setItem(J.current,JSON.stringify({remainingSeconds:Ve,lastTickAt:new Date(Ye).toISOString(),startedAt:new Date(Ye).toISOString()}))}catch(Ne){me.error("Timer cache init error:",Ne),R(Ve)}else R(0);const Ke=new Date;K(Ke),me.debug(" Test timer started at:",Ke.toISOString());const oe=n?.student_id||n?.id||"unknown",fe=`anti_cheating_${oe}_${Pe.test_type}_${Pe.test_id}`,Ee=localStorage.getItem(fe);if(me.debug(" Checking for anti-cheating data with key:",fe),me.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),me.debug(" Current test details:",{testType:Pe.test_type,testId:Pe.test_id,studentId:oe}),Ee)try{const Ne=JSON.parse(Ee);me.debug(" Found existing anti-cheating data for THIS test:",Ne),me.debug(" Visibility change times for this test:",Ne.tabSwitches||0),me.debug(" Cheating status for this test:",Ne.isCheating||!1),Ne.isCheating&&(me.debug(" WARNING: Student has been flagged for cheating in THIS test!"),me.debug(" Tab switches detected in this test:",Ne.tabSwitches),ge(` Warning: Suspicious activity detected in this test (${Ne.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(Ne){me.error(" Error parsing existing anti-cheating data:",Ne)}else me.debug(" No existing anti-cheating data found for this test - starting fresh");ut(),me.debug(" Anti-cheating tracking started"),A("test"),me.debug(" Test started successfully")}catch($e){me.error(" Error starting test:",$e),ge("Failed to start test","error"),w("Failed to load test data. Please try again.")}finally{const $e=Date.now()-He,Et=Math.max(0,250-$e);setTimeout(()=>{g(!1),x(!1)},Et),k(!1);try{ke&&clearTimeout(ke)}catch{}}},[u]),ir=S.useCallback(async()=>{if(!j||!Z||!ee||!B){ge("No test data to submit","error");return}me.debug(" Submitting test:",j);try{ie(!0);const Pe=wf(ee,B,j.test_type),He=new Date,ke=z?Math.round((He-z)/1e3):0,$e=z?z.toISOString():He.toISOString();me.debug(" Test timing:",{startedAt:$e,endTime:He.toISOString(),timeTaken:`${ke} seconds`});const Ue=Rt();me.debug(" Anti-cheating data for submission:",Ue);const Et={};ee.forEach((zt,fr)=>{Et[zt.question_id]=B[fr]??""}),j.test_type==="drawing"&&(me.debug(" Drawing test answers being submitted:",B),me.debug(" Drawing test answers type:",typeof B[0]),me.debug(" Drawing test answers content:",B[0]));const Ft=await hn.submitTest(j.test_type,j.test_id,B,{time_taken:(()=>{const zt=Number(Z?.allowed_time||0);return zt>0?Math.min(ke,zt):ke})(),started_at:$e,submitted_at:He.toISOString(),answers_by_id:Et,question_order:ee.map(zt=>zt.question_id),caught_cheating:Ue.caught_cheating,visibility_change_times:Ue.visibility_change_times,retest_assignment_id:(()=>{const fr=`retest_assignment_id_${n?.student_id||n?.id||""}_${j.test_type}_${j.test_id}`,nr=localStorage.getItem(fr);return me.debug(" Frontend retest key:",fr),me.debug(" Frontend retest assignment ID from localStorage:",nr),me.debug(" Frontend retest assignment ID converted:",nr?Number(nr):null),me.debug(" Frontend current test data:",j),me.debug(" Frontend current test retest_assignment_id:",j.retest_assignment_id),nr?Number(nr):null})(),parent_test_id:j.test_id},n);if(me.debug(" Test submission result:",Ft),Ft.success){window.recentTestCompleted=!0,me.debug(" Test completed - cache refresh triggered");const zt=n?.student_id||n?.id||"",fr=`retest_assignment_id_${zt}_${j.test_type}_${j.test_id}`;if(!!localStorage.getItem(fr)){const xe=j?.retest_attempts_left||j?.max_attempts||3,_e=(Ft?.percentage_score??0)>=50;if(_e){const Se=`retest_attempt${xe}_${zt}_${j.test_type}_${j.test_id}`;localStorage.setItem(Se,"true"),me.debug(" Passed retest, marking last-slot key:",Se);let Ve=0;for(let Ke=1;Ke<=10;Ke++){const oe=`retest_attempt${Ke}_${zt}_${j.test_type}_${j.test_id}`;localStorage.getItem(oe)==="true"&&Ve++}if(zt&&j.test_type&&j.test_id){const Ke=`test_completed_${zt}_${j.test_type}_${j.test_id}`;localStorage.setItem(Ke,"true"),me.debug(" Marked retest as completed (student passed):",Ke);const oe=`retest_attempts_${zt}_${j.test_type}_${j.test_id}`;localStorage.setItem(oe,JSON.stringify({used:Ve,max:xe})),me.debug(" Set retest attempts metadata (student passed):",oe,{used:Ve,max:xe})}const lt=`retest1_${zt}_${j.test_type}_${j.test_id}`;localStorage.removeItem(lt)}else{let Se=1;for(let fe=1;fe<=10;fe++){const Ee=`retest_attempt${fe}_${zt}_${j.test_type}_${j.test_id}`;if(localStorage.getItem(Ee)!=="true"){Se=fe;break}}const Ve=`retest_attempt${Se}_${zt}_${j.test_type}_${j.test_id}`;localStorage.setItem(Ve,"true"),me.debug(" Marked retest attempt as completed:",Ve);let lt=0;for(let fe=1;fe<=10;fe++){const Ee=`retest_attempt${fe}_${zt}_${j.test_type}_${j.test_id}`;localStorage.getItem(Ee)==="true"&&lt++}const Ke=xe-lt,oe=Ke<=0||_e;if(me.debug(" Retest completion check:",{usedAttempts:lt,maxAttempts:xe,attemptsLeft:Ke,passed:_e,shouldComplete:oe}),oe&&zt&&j.test_type&&j.test_id){const fe=`test_completed_${zt}_${j.test_type}_${j.test_id}`;localStorage.setItem(fe,"true"),me.debug(" Marked retest as completed (attempts exhausted or passed):",fe);const Ee=`retest_attempts_${zt}_${j.test_type}_${j.test_id}`;localStorage.setItem(Ee,JSON.stringify({used:lt,max:xe})),me.debug(" Set retest attempts metadata (attempts exhausted):",Ee,{used:lt,max:xe})}if(lt>=xe){const fe=`retest1_${zt}_${j.test_type}_${j.test_id}`;localStorage.removeItem(fe)}}}if(me.debug(" Marking test as completed..."),await Tt(j.test_type,j.test_id),j.test_type!=="drawing"){me.debug(" Caching test results after submission...");const _e=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:Se,CACHE_TTL:Ve}=await Zi(async()=>{const{setCachedData:lt,CACHE_TTL:Ke}=await Promise.resolve().then(()=>Vg);return{setCachedData:lt,CACHE_TTL:Ke}},void 0);Se(_e,Ft,Ve.student_results_table),me.debug(" Test results cached with key:",_e)}else me.debug(" Drawing test submitted - not caching results (will appear after teacher grades)");me.debug(" Clearing test progress..."),d(j.test_type,j.test_id);try{const xe=n?.student_id||n?.id||"unknown",_e=`test_timer_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(_e);const Se=`test_shuffle_order_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(Se)}catch{}if(n?.student_id){const xe=`test_completed_${n.student_id}_${j.test_type}_${j.test_id}`;localStorage.setItem(xe,"true"),me.debug(" Test marked as completed in localStorage:",xe)}try{const xe=n?.student_id||n?.id||"",_e=`retest1_${xe}_${j.test_type}_${j.test_id}`,Se=`retest_assignment_id_${xe}_${j.test_type}_${j.test_id}`;localStorage.removeItem(_e),localStorage.removeItem(Se),me.debug(" Cleared retest keys:",_e,Se)}catch(xe){me.warn("Failed to clear retest keys:",xe)}me.debug(" Clearing test progress and anti-cheating data for THIS test only...");const Dr=n?.student_id||n?.id||"unknown",ue=[],we=`test_progress_${Dr}_${j.test_type}_${j.test_id}`,ye=`anti_cheating_${Dr}_${j.test_type}_${j.test_id}`;for(let xe=0;xe<localStorage.length;xe++){const _e=localStorage.key(xe);_e&&(_e===we||_e===ye)&&ue.push(_e)}ue.forEach(xe=>{localStorage.removeItem(xe),me.debug(` Cleared for THIS test only: ${xe}`)}),me.debug(" Clearing anti-cheating data..."),Dt(),It(),j.test_type!=="drawing"?A("results"):r("/student"),ge("Test submitted successfully!","success"),me.debug(" Test submitted successfully")}else throw me.error(" Test submission failed:",Ft.error),new Error(Ft.error||"Failed to submit test")}catch(Pe){me.error(" Error submitting test:",Pe),ge("Failed to submit test","error")}finally{ie(!1)}},[j,Z,ee,B,Tt,d]);S.useCallback(()=>(me.debug(" Collecting test answers..."),B),[B]);const pr=S.useCallback(()=>{if(!ee||!B)return;const Pe=B.filter(ke=>ke&&typeof ke=="string"&&ke.trim()!=="").length,He=ee.length>0?Pe/ee.length*100:0;if(H(He),me.debug(` Progress updated: ${Pe}/${ee.length} questions answered (${Math.round(He)}%)`),j){const ke={answers:B,progress:He,lastSaved:new Date().toISOString()};c(j.test_type,j.test_id,ke)}},[ee,B,j,c]);S.useEffect(()=>{pr()},[pr]);const Nr=S.useCallback(()=>{if(!B)return 0;const Pe=B.filter(He=>He&&typeof He=="string"&&He.trim()!=="").length;return me.debug(" getAnsweredCount:",{studentAnswers:B,answeredCount:Pe,totalQuestions:ee?.length}),Pe},[B,ee]),dr=S.useCallback(()=>{if(me.debug(" Navigating back to cabinet..."),j&&n?.student_id){me.debug(" Cabinet navigation detected - counting as cheating attempt");const He=`anti_cheating_${n?.student_id||n?.id||"unknown"}_${j.test_type}_${j.test_id}`,ke=localStorage.getItem(He);let $e=0,Ue=!1;if(ke)try{const fr=JSON.parse(ke);$e=fr.tabSwitches||0,Ue=fr.isCheating||!1}catch(fr){me.error(" Error parsing existing anti-cheating data:",fr)}const Et=$e+1,Ft=Et>=2;me.debug(` Tab switch count: ${$e}  ${Et} (cheating: ${Ft})`);const zt={tabSwitches:Et,isCheating:Ft,lastUpdated:new Date().toISOString()};localStorage.setItem(He,JSON.stringify(zt)),me.debug(" Anti-cheating data updated for cabinet navigation:",zt)}e?e():r("/student")},[e,r,j,n?.student_id]);S.useCallback(()=>{me.debug(" Showing test results..."),A("results")},[]);const Vt=S.useCallback((Pe,He,ke=null)=>{switch(me.debug(" Formatting student answer for display:",Pe,"testType:",He,"question:",ke),He){case On.MULTIPLE_CHOICE:if(Pe.toString().startsWith("Option "))return Pe;if(ke&&typeof Pe=="string"&&!isNaN(parseInt(Pe))){const $e=parseInt(Pe),Ue=`option_${String.fromCharCode(97+$e)}`,Et=ke[Ue];if(Et)return me.debug(" Converted",Pe,"to option text:",Et),Et;{const Ft=String.fromCharCode(65+$e);return me.debug(" Converted",Pe,"to",Ft),Ft}}else{if(typeof Pe=="string"&&isNaN(parseInt(Pe)))return me.debug(" Already formatted text:",Pe),Pe;{const $e=String.fromCharCode(65+parseInt(Pe));return me.debug(" Converted",Pe,"to",$e),$e}}case On.TRUE_FALSE:return Pe==="true"?"True":"False";case On.INPUT:return Pe;case On.MATCHING:return typeof Pe=="object"?JSON.stringify(Pe):Pe;case On.WORD_MATCHING:return typeof Pe=="object"?JSON.stringify(Pe):Pe;case On.DRAWING:return Pe&&Pe.trim()!==""?"Drawing submitted":"No drawing";case On.FILL_BLANKS:return Pe;default:return me.warn(" Unknown test type for answer formatting:",He),Pe}},[]),ge=S.useCallback((Pe,He)=>{const ke={id:Date.now(),message:Pe,type:He,timestamp:new Date};P($e=>[...$e,ke]),setTimeout(()=>{P($e=>$e.filter(Ue=>Ue.id!==ke.id))},N0.NOTIFICATION_DURATION)},[]);S.useEffect(()=>{pr()},[pr]),S.useEffect(()=>{if(F!=="test")return;const Pe=Number(Z?.allowed_time||0);if(!Pe)return;const He=setInterval(()=>{R(ke=>{const $e=Math.max(0,ke-1);try{const Ue=Date.now();se.current||(se.current=Ue),J.current&&localStorage.setItem(J.current,JSON.stringify({remainingSeconds:$e,lastTickAt:new Date(Ue).toISOString(),startedAt:z?z.toISOString():new Date(Ue-(Pe-$e)*1e3).toISOString()}))}catch{}return $e===0&&ir(),$e})},1e3);return()=>clearInterval(He)},[F,Z?.allowed_time,ir,z]);const Te=S.useCallback((Pe,He)=>{if(!Pe)return null;const ke=($e,Ue)=>{const Et=[...B];Et[He]=Ue,V(Et),me.debug(` Answer changed: question ${$e} = ${Ue}`),me.debug(" Updated studentAnswers:",Et)};switch(j.test_type){case On.TRUE_FALSE:return l.jsx(qse,{question:Pe,questionIndex:He,studentAnswer:B[He]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:L,displayNumber:He+1});case On.MULTIPLE_CHOICE:return l.jsx(Yse,{question:Pe,questionIndex:He,studentAnswer:B[He]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:L,displayNumber:He+1});case On.INPUT:return l.jsx(Xse,{question:Pe,questionIndex:He,studentAnswer:B[He]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:L,displayNumber:He+1});case On.MATCHING:return me.error("Matching test reached renderQuestion - this should not happen"),l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),l.jsx(et,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case On.DRAWING:return l.jsx(aae,{question:Pe,questionIndex:He,studentAnswer:B[He]||"",onAnswerChange:ke,mode:"student",testId:j?.test_id,testType:L});case On.FILL_BLANKS:return He===0?l.jsx(cae,{testText:Z?.test_text,blanks:(ee||[]).map(($e,Ue)=>({id:$e.question_id||Ue+1,options:$e.blank_options||[],correct_answer:$e.correct_answers?.[0]||$e.correct_answer,question:$e.question_json||""})),separateType:Z?.separate_type,testId:j?.test_id,testName:Z?.test_name||j?.test_name,teacherId:Z?.teacher_id||j?.teacher_id,subjectId:Z?.subject_id||j?.subject_id,onTestComplete:ir,onAnswerChange:($e,Ue)=>{const Et=ee.findIndex(Ft=>Ft.question_id===$e);if(Et!==-1){const Ft=[...B];Ft[Et]=Ue,V(Ft),me.debug(` Fill Blanks answer changed: question ${$e} = ${Ue}`)}}},`fill-blanks-${j?.test_id}-${Z?.test_name}`):null;default:return l.jsx("div",{children:"Unsupported question type"})}},[j,B,L]);function Fe(){return!j||!Z||!ee?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:Z.test_name||Z.title||"Test"})}),l.jsx("div",{className:"mb-4",children:l.jsx(lae,{answeredCount:Nr(),totalQuestions:ee.length,percentage:Math.round(M),timeElapsed:Number(Z?.allowed_time||0)>0?W:0,showDetails:!0})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),l.jsx("div",{className:"space-y-8",children:ee.map((Pe,He)=>l.jsx("div",{className:"question-container",children:Te(Pe,He)},Pe.question_id||He))})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(et,{variant:"primary",size:"lg",onClick:()=>We(!0),disabled:X||Nr()<ee.length,loading:X,children:X?"Submitting...":`Submit Test (${Nr()}/${ee.length})`})})]})}if(f)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(_)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:_}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx(oa,{isOpen:Le,onClose:()=>At(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>At(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{At(!1),dr()},variant:"primary",children:"Go Back"})]})]})}),l.jsx(oa,{isOpen:Ae,onClose:()=>We(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>We(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{We(!1),ir()},variant:"primary",children:"Submit"})]})]})}),l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),l.jsx(et,{variant:"outline",onClick:()=>At(!0),children:"Back to Cabinet"})]})})}),De&&F==="results"&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",Ie," times during the test."]})})]})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&F==="list"&&Me(),F==="test"&&Fe(),F==="results"&&kt()]}),F==="test"&&p&&l.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),v&&l.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),l.jsx(FB,{isOpen:le,onClose:()=>ce(!1),testType:be?.test_type,testId:be?.test_id,testName:be?.test_name,questions:be?.questions,isLoading:f}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(Pe=>l.jsx(uc,{type:Pe.type,message:Pe.message,onClose:()=>P(He=>He.filter(ke=>ke.id!==Pe.id))},Pe.id))})]});function Me(){return!a||a.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):l.jsx("div",{className:"space-y-6",children:a.map((Pe,He)=>l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Pe.test_name}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Subject:"})," ",Pe.subject]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Pe.teacher_name]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",Pe.test_type]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Pe.assigned_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(et,{variant:"outline",onClick:()=>Nt(Pe),disabled:C||f,children:"View Details"}),l.jsx(et,{variant:"primary",onClick:()=>$t(Pe),disabled:C||f,children:C?"Starting...":"Start Test"})]})]})},He))})}function kt(){if(!j||!Z||!ee||!B)return null;const Pe={};return B.forEach((He,ke)=>{if(ee[ke]){const $e=ee[ke].question_id||ee[ke].id||ke;Pe[String($e)]=He,me.debug(" Converting answer:",{index:ke,questionId:$e,answer:He,question:ee[ke]})}}),me.debug(" Final answersObject:",Pe),me.debug(" Questions structure:",ee.map(He=>({id:He.question_id,correct_answer:He.correct_answer}))),l.jsx(Zae,{testInfo:Z,questions:ee,testType:j.test_type,studentAnswers:Pe,onBackToCabinet:dr,checkAnswerCorrectness:Sm,formatStudentAnswerForDisplay:Vt,getCorrectAnswer:Jy})}},nie=()=>{const{testId:e}=Fb(),t=Eo(),{user:r}=cs(),{makeAuthenticatedRequest:n}=Jo(),{showNotification:s}=ka(),[a,i]=S.useState(null),[o,c]=S.useState(!0),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,x]=S.useState(!1);Xm("matching_type",a?.id);const v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const N=`test_completed_${r.student_id}_matching_type_${e}`,E=localStorage.getItem(N)==="true",P=`retest1_${r.student_id}_matching_type_${e}`,F=localStorage.getItem(P)==="true";return E&&!F?(me.debug(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),c(!1);return}if(!v())try{c(!0),d(null);const N=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Failed to load test data");const E=await N.json();if(!E.success)throw new Error(E.message||"Failed to load test");const P=E.data;me.debug(" Test data from get-matching-type-test:",P);const F=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!F.ok)throw new Error("Failed to load test questions");const A=await F.json();if(!A.success)throw new Error(A.message||"Failed to load test questions");me.debug(" Questions data from get-test-questions:",A);const j={id:P.test_id,test_name:P.test_name,teacher_id:P.teacher_id,subject_id:P.subject_id,image_url:P.image_url,image:null,blocks:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const I=A.questions[0];return Array.isArray(I.blocks)?I.blocks.map((L,Y)=>{let Z=L.block_coordinates||L.coordinates||(typeof L.x=="number"?{x:L.x,y:L.y,width:L.width,height:L.height}:null);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}return(!Z||typeof Z!="object")&&(Z={x:0,y:0,width:30,height:10}),Z={x:(typeof Z.x=="number"?Z.x:Number(Z.x))||0,y:(typeof Z.y=="number"?Z.y:Number(Z.y))||0,width:(typeof Z.width=="number"?Z.width:Number(Z.width))||30,height:(typeof Z.height=="number"?Z.height:Number(Z.height))||10},{id:L.block_id||L.question_id||L.id||Y+1,word:L.word||`Word ${Y+1}`,coordinates:Z,hasArrow:!!L.has_arrow,arrow:L.arrow||null}}):A.questions.map(L=>{me.debug(" Processing question:",L);let Y;try{Y=typeof L.block_coordinates=="string"?JSON.parse(L.block_coordinates):L.block_coordinates}catch{Y={x:0,y:0,width:100,height:100}}return(!Y||typeof Y!="object")&&(Y={x:0,y:0,width:100,height:100}),Y={x:(typeof Y.x=="number"?Y.x:Number(Y.x))||0,y:(typeof Y.y=="number"?Y.y:Number(Y.y))||0,width:(typeof Y.width=="number"?Y.width:Number(Y.width))||100,height:(typeof Y.height=="number"?Y.height:Number(Y.height))||100},{id:L.question_id,word:L.word,coordinates:Y,hasArrow:L.has_arrow,arrow:L.arrow}})}return[]})(),words:(()=>{if(Array.isArray(A.questions)&&A.questions.length>0){const I=A.questions[0];if(Array.isArray(I.words)){const L=I.words,Y=Array.isArray(I.blocks)?I.blocks:[];return typeof L[0]=="string"?L.map((ae,ee)=>({id:`w_${Y[ee]?.question_id||Y[ee]?.block_id||A.questions[ee]?.question_id||ee+1}_${ee}`,word:String(ae),blockId:null,isPlaced:!1,isCorrect:!1})):L.map((ae,ee)=>({id:`w_${ae.question_id||ae.id||ee+1}_${ee}`,word:ae.word||String(ae.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return A.questions.map(L=>({id:`w_${L.question_id}`,word:L.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:P.arrows?P.arrows.map(I=>(me.debug(" Processing arrow:",I),{id:I.id,questionId:I.question_id,blockId:I.block_id||I.question_id,start:{x:Number(I.start_x)||0,y:Number(I.start_y)||0},end:{x:Number(I.end_x)||0,y:Number(I.end_y)||0},rel_start_x:I.rel_start_x!==null?Number(I.rel_start_x):null,rel_start_y:I.rel_start_y!==null?Number(I.rel_start_y):null,rel_end_x:I.rel_end_x!==null?Number(I.rel_end_x):null,rel_end_y:I.rel_end_y!==null?Number(I.rel_end_y):null,image_width:I.image_width?Number(I.image_width):null,image_height:I.image_height?Number(I.image_height):null,style:(typeof I.style=="string"?JSON.parse(I.style):I.style)||{color:"#dc3545",thickness:3}})):[]};if(P.image_url){const I=new Image;I.crossOrigin="anonymous",I.onload=()=>{j.image=I,i(j),c(!1)},I.onerror=()=>{me.warn("Failed to load test image"),i(j),c(!1)},I.src=P.image_url}else i(j),c(!1)}catch(N){me.error("Error loading test data:",N),d(N.message||"Failed to load test"),c(!1)}},[e,n]);S.useEffect(()=>{r?.student_id&&w()},[w,r?.student_id]);const C=S.useCallback(async N=>{me.debug("Test completed:",N),s("Test completed successfully!","success");const E=parseInt(N)||0,P=a?.blocks?.length||a?.words?.length||0,F=P>0?Math.round(E/P*100):0,A={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:E,totalQuestions:P,percentage:F,passed:F>=60,questionAnalysis:a?.questions?.map((j,I)=>({questionNumber:I+1,isCorrect:I<E,userAnswer:I<E?`Matched: ${j.word}`:"Not answered",correctAnswer:`Match: ${j.word}`}))||Array.from({length:P},(j,I)=>({questionNumber:I+1,isCorrect:I<E,userAnswer:I<E?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};me.debug(" Using test results data:",A),g(A),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]),_=S.useCallback(()=>{x(!1),g(null),w()},[w]);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:u}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?p&&f?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Wv,{testResults:f,onBackToCabinet:k,onRetakeTest:_,isLoading:!1})}):l.jsx(Jse,{testData:a,onTestComplete:C,onBackToCabinet:k}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(jt,{className:"max-w-md w-full",children:l.jsxs(jt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},sie=()=>{const{testId:e}=Fb(),t=Eo(),{user:r}=cs(),{makeAuthenticatedRequest:n}=Jo(),{showNotification:s}=ka(),[a,i]=S.useState(null),[o,c]=S.useState(!0),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,x]=S.useState(!1),v=S.useCallback(()=>{if(!r?.student_id||!e)return!1;const _=`test_completed_${r.student_id}_word_matching_${e}`,N=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(N)==="true"?!1:localStorage.getItem(_)==="true"},[r?.student_id,e]),w=S.useCallback(async()=>{if(!e){d("Test ID is required"),c(!1);return}if(v()){s("This test has already been completed","warning"),t("/student");return}c(!0),d(null);try{const _=`word_matching_test_${e}`,N=Rs(_);if(N){if(me.debug(" Word matching test loaded from cache:",N),N.id){let F=N,A=Array.isArray(F.correctPairs)?F.correctPairs:F.correctPairs&&typeof F.correctPairs=="object"?Object.keys(F.correctPairs).map(j=>[Number(j),F.correctPairs[j]]).sort((j,I)=>j[0]-I[0]).map(([,j])=>j):null;if(Array.isArray(F.leftWords)&&Array.isArray(F.rightWords)&&Array.isArray(A)){const j=F.rightWords.map((ee,ne)=>ne),I=F.leftWords.map((ee,ne)=>ne);for(let ee=j.length-1;ee>0;ee--){const ne=Math.floor(Math.random()*(ee+1));[j[ee],j[ne]]=[j[ne],j[ee]]}for(let ee=I.length-1;ee>0;ee--){const ne=Math.floor(Math.random()*(ee+1));[I[ee],I[ne]]=[I[ne],I[ee]]}const L=j.map(ee=>F.rightWords[ee]),Y=I.map(ee=>F.leftWords[ee]),Z=new Map(j.map((ee,ne)=>[ee,ne])),ae=I.map(ee=>{const ne=A[ee];return Z.get(ne)});F={...F,leftWords:Y,rightWords:L,correctPairs:ae}}i(F)}else{let A={id:N.test_id,test_id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,num_questions:N.num_questions,interaction_type:N.interaction_type,passing_score:N.passing_score,created_at:N.created_at,updated_at:N.updated_at,leftWords:N.leftWords,rightWords:N.rightWords,correctPairs:N.correctPairs,originalPairs:N.originalPairs},j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(I=>[Number(I),A.correctPairs[I]]).sort((I,L)=>I[0]-L[0]).map(([,I])=>I):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const I=A.rightWords.map((ne,B)=>B),L=A.leftWords.map((ne,B)=>B);for(let ne=I.length-1;ne>0;ne--){const B=Math.floor(Math.random()*(ne+1));[I[ne],I[B]]=[I[B],I[ne]]}for(let ne=L.length-1;ne>0;ne--){const B=Math.floor(Math.random()*(ne+1));[L[ne],L[B]]=[L[B],L[ne]]}const Y=I.map(ne=>A.rightWords[ne]),Z=L.map(ne=>A.leftWords[ne]),ae=new Map(I.map((ne,B)=>[ne,B])),ee=L.map(ne=>{const B=j[ne];return ae.get(B)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A)}c(!1);return}const P=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(P.success){const F={id:P.data.test_id,test_id:P.data.test_id,test_name:P.data.test_name,teacher_id:P.data.teacher_id,subject_id:P.data.subject_id,num_questions:P.data.num_questions,interaction_type:P.data.interaction_type,passing_score:P.data.passing_score,created_at:P.data.created_at,updated_at:P.data.updated_at,leftWords:P.data.leftWords,rightWords:P.data.rightWords,correctPairs:P.data.correctPairs,originalPairs:P.data.originalPairs};let A=F,j=Array.isArray(A.correctPairs)?A.correctPairs:A.correctPairs&&typeof A.correctPairs=="object"?Object.keys(A.correctPairs).map(I=>[Number(I),A.correctPairs[I]]).sort((I,L)=>I[0]-L[0]).map(([,I])=>I):null;if(Array.isArray(A.leftWords)&&Array.isArray(A.rightWords)&&Array.isArray(j)){const I=A.rightWords.map((ne,B)=>B),L=A.leftWords.map((ne,B)=>B);for(let ne=I.length-1;ne>0;ne--){const B=Math.floor(Math.random()*(ne+1));[I[ne],I[B]]=[I[B],I[ne]]}for(let ne=L.length-1;ne>0;ne--){const B=Math.floor(Math.random()*(ne+1));[L[ne],L[B]]=[L[B],L[ne]]}const Y=I.map(ne=>A.rightWords[ne]),Z=L.map(ne=>A.leftWords[ne]),ae=new Map(I.map((ne,B)=>[ne,B])),ee=L.map(ne=>{const B=j[ne];return ae.get(B)});A={...A,leftWords:Z,rightWords:Y,correctPairs:ee}}i(A),vs(_,A,Is.word_matching_test),me.debug(" Word matching test loaded from API and cached:",F)}else throw new Error(P.message||"Failed to load test")}catch(_){me.error("Error loading word matching test:",_),d(_.message),s("Failed to load test: "+_.message,"error")}finally{c(!1)}},[e,v,n,s,t]),C=S.useCallback(async _=>{me.debug("Test completed:",_),s("Test completed successfully!","success");const N=parseInt(_)||0,E=a?.num_questions||0,P=E>0?Math.round(N/E*100):0,F={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:N,totalQuestions:E,percentage:P,passed:P>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?`${A.left}  ${A.right}`:"Not answered",correctAnswer:`${A.left}  ${A.right}`})):Array.from({length:E},(A,j)=>({questionNumber:j+1,isCorrect:j<N,userAnswer:j<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};me.debug(" Using test results data:",F),g(F),x(!0)},[a,s]),k=S.useCallback(()=>{t("/student")},[t]);return S.useEffect(()=>{w()},[w]),o?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsxs(jt,{className:"p-8 text-center",children:[l.jsx(Hr,{size:"lg",className:"mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):u?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(jt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-red-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:u}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?p&&f?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(Wv,{testResults:f,onBackToCabinet:()=>{g(null),x(!1),t("/student")},onRetakeTest:(_,N)=>{g(null),x(!1),w()},isLoading:!1})}):l.jsx(at.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:l.jsx(eae,{testData:a,onTestComplete:C,onBackToCabinet:k})}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(jt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-gray-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},aie=S.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,minWords:n=50,maxAttempts:s=3,currentAttempt:a=1},i)=>{const[o,c]=S.useState(!1),[u,d]=S.useState(!1),[f,g]=S.useState(0),[p,x]=S.useState(null),[v,w]=S.useState(null),[C,k]=S.useState("good"),_=S.useRef(null),N=S.useRef([]),E=S.useRef(null),P=S.useRef(null),F=S.useRef(null),A=S.useRef(null),j=S.useRef(null);S.useImperativeHandle(i,()=>({startRecording:()=>I(),stopRecording:()=>L(),pauseRecording:()=>Y(),resumeRecording:()=>Z()}));const I=S.useCallback(async()=>{try{if(w(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");if(!window.isSecureContext&&!window.location.hostname.includes("localhost"))throw new Error("Microphone access requires HTTPS. Please use a secure connection.");const V=window.AudioContext||window.webkitAudioContext;F.current||(F.current=new V),F.current.state!=="running"&&await F.current.resume().catch(()=>{}),console.log(" Requesting microphone permission...");const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1}});console.log(" Microphone permission granted"),E.current=M;try{let K=document.getElementById("ios-audio-sink");K||(K=document.createElement("audio"),K.id="ios-audio-sink",K.muted=!0,K.playsInline=!0,K.style.display="none",document.body.appendChild(K)),K.srcObject=M,await K.play().catch(()=>{})}catch{}const H=F.current.createAnalyser();F.current.createMediaStreamSource(M).connect(H),H.fftSize=256,A.current=H,ae();let R="audio/webm;codecs=opus";typeof MediaRecorder<"u"&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(R)&&(MediaRecorder.isTypeSupported("audio/mp4")?R="audio/mp4":MediaRecorder.isTypeSupported("audio/aac")?R="audio/aac":R="");const z=new MediaRecorder(M,R?{mimeType:R}:void 0);_.current=z,N.current=[],z.ondataavailable=K=>{K.data.size>0&&N.current.push(K.data)},z.onstop=()=>{const K=R&&R.startsWith("audio/")?R:"audio/webm",J=new Blob(N.current,{type:K});x(J),e(J,f),E.current&&E.current.getTracks().forEach(se=>se.stop()),j.current&&cancelAnimationFrame(j.current)},z.start(1e3),c(!0),g(0),P.current=setInterval(()=>{g(K=>{const J=K+1;return J>=r&&L(),J})},1e3)}catch(V){console.error("Error starting recording:",V);const M=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;V.name==="NotAllowedError"?w(M?"Microphone access denied. Please go to Settings > Safari > Microphone and allow access, then refresh the page.":"Microphone access denied. Please allow microphone access in your browser settings and try again."):V.name==="NotFoundError"?w("No microphone found. Please connect a microphone and try again."):V.name==="NotSupportedError"?w("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox."):V.message.includes("HTTPS")?w("Microphone access requires HTTPS. Please use a secure connection."):w(`Failed to access microphone: ${V.message}`)}},[r]),L=S.useCallback(()=>{if(_.current&&o&&(_.current.stop(),c(!1),d(!1),P.current&&clearInterval(P.current),f<t)){w(`Recording must be at least ${t} seconds long.`);return}},[o,f,t,p,e]),Y=S.useCallback(()=>{_.current&&o&&!u&&(_.current.pause(),d(!0),P.current&&clearInterval(P.current))},[o,u]),Z=S.useCallback(()=>{_.current&&o&&u&&(_.current.resume(),d(!1),P.current=setInterval(()=>{g(V=>{const M=V+1;return M>=r&&L(),M})},1e3))},[o,u,r,L]),ae=S.useCallback(()=>{if(!A.current)return;const V=A.current,M=new Uint8Array(V.frequencyBinCount),H=()=>{V.getByteFrequencyData(M);const W=M.reduce((R,z)=>R+z,0)/M.length;W<10?k("poor"):W<30?k("fair"):k("good"),o&&(j.current=requestAnimationFrame(H))};H()},[o]),ee=V=>{const M=Math.floor(V/60),H=V%60;return`${M}:${H.toString().padStart(2,"0")}`},ne=()=>{switch(C){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},B=()=>{switch(C){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return l.jsxs("div",{className:"audio-recorder bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Record Your Response"}),l.jsx("p",{className:"text-gray-600",children:"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:ee(f)}),l.jsx("div",{className:`text-sm ${ne()}`,children:B()}),u&&l.jsx("div",{className:"text-yellow-600 font-semibold mt-2",children:" Recording Paused"})]}),o&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(V,M)=>l.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},M))})}),l.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center mb-6",children:o?l.jsxs(l.Fragment,{children:[u?l.jsxs("button",{onClick:Z,className:"w-full sm:w-auto bg-green-600 text-white px-6 py-4 rounded-full hover:bg-green-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Resume"})]}):l.jsxs("button",{onClick:Y,className:"w-full sm:w-auto bg-yellow-600 text-white px-6 py-4 rounded-full hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Pause"})]}),l.jsxs("button",{onClick:L,className:"w-full sm:w-auto bg-gray-600 text-white px-6 py-4 rounded-full hover:bg-gray-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Stop & Submit"})]})]}):l.jsxs("button",{onClick:I,className:"w-full sm:w-auto bg-red-600 text-white px-6 py-4 rounded-full hover:bg-red-700 flex items-center justify-center space-x-2 min-h-[48px] text-lg font-semibold",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Start Recording"})]})}),v&&l.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:v})}),l.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Attempt ",a," of ",s,a<s&&l.jsx("span",{className:"ml-2 text-blue-600",children:"(You can re-record if needed)"})]})]})}),HB=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const[s,a]=S.useState(!1),[i,o]=S.useState(0),[c,u]=S.useState(0),[d,f]=S.useState(1),[g,p]=S.useState(1),[x,v]=S.useState(!0),[w,C]=S.useState(""),[k,_]=S.useState(!1),[N,E]=S.useState(null),[P,F]=S.useState(!1),A=S.useRef(null),j=S.useRef(null),I=S.useRef(!1);S.useEffect(()=>()=>{I.current=!0},[]),S.useEffect(()=>{let M=!1;if(t)M||C(t);else if(e){if(!e||e.size===0){M||v(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),M||v(!1);return}const H=URL.createObjectURL(e);return M||C(H),()=>{M=!0,URL.revokeObjectURL(H)}}return()=>{M=!0}},[e,t]),S.useEffect(()=>{let M=!1;const H=R=>{try{const z=new URL(R);return/\/storage\/v1\/object\/public\//.test(z.pathname)}catch{return!1}};async function W(R){if(!R||P||/\/object\/sign\//.test(R)||!H(R))return R;try{const K=new URL(R).pathname.replace(/^\/storage\/v1\/object\/public\//,""),J=K.split("/")[0],se=K.substring(J.length+1),X=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(J)}&file_path=${encodeURIComponent(se)}`);if(X.ok){const{url:ie}=await X.json();if(!M&&!I.current){F(!0);try{await fetch(ie,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}C(ie)}return ie}}catch{}return R}return(async()=>{if(t){const R=await W(t);try{await fetch(R,{headers:{Range:"bytes=0-1"},mode:"cors"})}catch{}!M&&!I.current&&!P&&C(R)}})(),()=>{M=!0}},[t,P]),S.useEffect(()=>{let M=!1;return w&&(M||(_(!1),E(null),v(!0))),()=>{M=!0}},[w]),S.useEffect(()=>{if(A.current&&w){const M=A.current;let H=!1;try{M.src=w}catch{}M.load();const W=()=>{if(H||I.current)return;let re=M.duration;if(re===1/0)try{M.currentTime=1e101,M.ontimeupdate=()=>{if(H||I.current)return;M.ontimeupdate=null;const pe=M.duration;H||(u(isFinite(pe)&&pe>0?pe:0),M.currentTime=0,v(!1))};return}catch(pe){console.warn("Seek trick failed:",pe)}if(isNaN(re)||!isFinite(re)||re<=0){const pe=M.seekable&&M.seekable.length>0&&isFinite(M.seekable.end(0)),Ce=!pe&&M.buffered&&M.buffered.length>0&&isFinite(M.buffered.end(M.buffered.length-1));pe?re=M.seekable.end(0):Ce&&(re=M.buffered.end(M.buffered.length-1))}isNaN(re)||!isFinite(re)||re<=0?(console.warn("Invalid audio duration after fallbacks:",re),r&&r>0?H||u(r):H||u(0)):H||u(re),H||v(!1)},R=()=>{H||I.current||W()},z=()=>{H||I.current||W()},K=()=>{H||I.current||W()},J=()=>{H||I.current||W()},se=()=>{H||I.current||o(M.currentTime)},X=()=>{H||I.current||(a(!1),o(0))},ie=()=>{H||I.current||a(!0)},le=()=>{H||I.current||a(!1)},ce=re=>{if(H||I.current)return;console.error("Audio loading error:",re),console.error("Audio error details:",{error:M.error,networkState:M.networkState,readyState:M.readyState,src:M.src,currentSrc:M.currentSrc});const pe=M.error?.code;pe===4&&_(!0),E(M.error||{code:pe}),v(!1)},be=setTimeout(()=>{H||I.current||M.readyState===0&&v(!1)},6e3);return M.addEventListener("loadedmetadata",R),M.addEventListener("durationchange",z),M.addEventListener("canplay",K),M.addEventListener("canplaythrough",J),M.addEventListener("timeupdate",se),M.addEventListener("ended",X),M.addEventListener("play",ie),M.addEventListener("pause",le),M.addEventListener("error",ce),()=>{H=!0,clearTimeout(be),M.removeEventListener("loadedmetadata",R),M.removeEventListener("durationchange",z),M.removeEventListener("canplay",K),M.removeEventListener("canplaythrough",J),M.removeEventListener("timeupdate",se),M.removeEventListener("ended",X),M.removeEventListener("play",ie),M.removeEventListener("pause",le),M.removeEventListener("error",ce),M.pause(),M.src="",M.load()}}},[w,r]),S.useEffect(()=>{let M=!1;return r&&r>0&&(isNaN(c)||!isFinite(c)||c<=0)&&(M||u(r)),()=>{M=!0}},[r,c]);const L=()=>{A.current&&(s?A.current.pause():A.current.play().catch(M=>{console.error("Play failed:",M)}))},Y=M=>{if(A.current&&j.current&&c>0){const H=j.current.getBoundingClientRect(),W=M.clientX-H.left,R=H.width,z=Math.max(0,Math.min(c,W/R*c));isFinite(z)&&z>=0&&(A.current.currentTime=z,o(z))}},Z=M=>{const H=parseFloat(M.target.value);f(H),A.current&&(A.current.volume=H)},ae=M=>{const H=parseFloat(M.target.value);p(H),A.current&&(A.current.playbackRate=H)},ee=M=>{if(isNaN(M))return"0:00";const H=Math.floor(M/60),W=Math.floor(M%60);return`${H}:${W.toString().padStart(2,"0")}`};if(!e&&!t)return l.jsx("div",{className:`audio-player ${n}`,children:l.jsx("div",{className:"text-center text-gray-500 py-8",children:"No audio available"})});const B=(M=>{try{const W=(M||"").toLowerCase().split("?")[0].split("#")[0];return W.endsWith(".webm")?"audio/webm":W.endsWith(".mp3")?"audio/mpeg":W.endsWith(".m4a")?"audio/mp4":W.endsWith(".aac")?"audio/aac":W.endsWith(".wav")?"audio/wav":void 0}catch{return}})(w||t),V=Fs.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return l.jsxs("div",{className:`audio-player bg-gray-50 rounded-lg p-4 ${n}`,children:[l.jsx("audio",{ref:A,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:l.jsx("source",{src:w,type:B})}),x?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading audio..."})]}):k?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"This audio format isn't supported by your browser."}),w?l.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,B?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",B]}):null,l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Browser WebM support: ",V?"Yes":"No",!V&&" - Try using Chrome, Firefox, or Edge"]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Preferred format: WebM"})]}):N?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"Playback failed. Please try opening the audio directly."}),w?l.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,B?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",B]}):null]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{ref:j,className:"w-full bg-gray-200 rounded-full h-3 cursor-pointer hover:h-4 transition-all min-h-[24px]",onClick:Y,children:l.jsx("div",{className:"bg-blue-600 h-3 rounded-full transition-all",style:{width:`${i/c*100}%`}})}),l.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mt-2 font-medium",children:[l.jsx("span",{children:ee(i)}),l.jsx("span",{children:ee(c)})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:L,className:"bg-blue-600 text-white p-3 rounded-full hover:bg-blue-700 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:s?l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-5 h-5 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:d,onChange:Z,className:"w-24 h-3 bg-gray-200 rounded-lg appearance-none cursor-pointer min-h-[20px]"}),l.jsxs("span",{className:"text-sm text-gray-600 w-10 font-medium",children:[Math.round(d*100),"%"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Speed:"}),l.jsxs("select",{value:g,onChange:ae,className:"text-sm border border-gray-300 rounded px-2 py-1",children:[l.jsx("option",{value:"0.5",children:"0.5x"}),l.jsx("option",{value:"0.75",children:"0.75x"}),l.jsx("option",{value:"1",children:"1x"}),l.jsx("option",{value:"1.25",children:"1.25x"}),l.jsx("option",{value:"1.5",children:"1.5x"}),l.jsx("option",{value:"2",children:"2x"})]})]})]})]})]})},iie=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:o,maxAttempts:c,isSubmitting:u=!1})=>{const[d,f]=S.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const g=(w,C)=>{const k=w/C*100;return k>=80?"text-green-600":k>=60?"text-yellow-600":"text-red-600"},p=(w,C)=>{const k=w/C*100;return k>=90?"A+":k>=80?"A":k>=70?"B":k>=60?"C":k>=50?"D":"F"},x=()=>p(t?.overall_score||0,100),v=()=>g(t?.overall_score||0,100);return console.log(" FeedbackDisplay received scores:",t),console.log(" Individual score values:",{grammar_score:t?.grammar_score,vocabulary_score:t?.vocabulary_score,pronunciation_score:t?.pronunciation_score,fluency_score:t?.fluency_score,content_score:t?.content_score}),l.jsxs("div",{className:"feedback-display bg-white rounded-lg shadow-lg p-3 sm:p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Speaking Test Results"}),l.jsx("p",{className:"text-gray-600",children:"Review your performance and decide whether to submit or re-record."})]}),l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-3 sm:p-6 rounded-lg mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-4xl font-bold ${v()}`,children:[t?.overall_score||0,"/100"]}),l.jsxs("div",{className:`text-2xl font-semibold ${v()} mt-2`,children:["Grade: ",x()]}),l.jsx("div",{className:"text-gray-600 mt-2",children:t?.overall_score>=80?"Excellent work!":t?.overall_score>=60?"Good job!":t?.overall_score>=50?"Not bad, but could be better.":"Keep practicing!"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Grammar"}),l.jsxs("span",{className:`font-bold ${g(t?.grammar_score||0,25)}`,children:[t?.grammar_score||0,"/25"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.grammar_mistakes||0," mistakes found"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Vocabulary"}),l.jsxs("span",{className:`font-bold ${g(t?.vocabulary_score||0,20)}`,children:[t?.vocabulary_score||0,"/20"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.vocabulary_mistakes||0," vocabulary issues"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Pronunciation"}),l.jsxs("span",{className:`font-bold ${g(t?.pronunciation_score||0,15)}`,children:[t?.pronunciation_score||0,"/15"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Clarity and accuracy"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-orange-600 h-2 rounded-full",style:{width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Fluency"}),l.jsxs("span",{className:`font-bold ${g(t?.fluency_score||0,20)}`,children:[t?.fluency_score||0,"/20"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Pace, pauses, and flow"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Content"}),l.jsxs("span",{className:`font-bold ${g(t?.content_score||0,20)}`,children:[t?.content_score||0,"/20"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"How well addressed the prompt"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-indigo-600 h-2 rounded-full",style:{width:`${Math.min((t?.content_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Word Count"}),l.jsxs("span",{className:"font-bold text-gray-700",children:[t?.word_count||0," words"]})]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total words spoken"}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-gray-600 h-2 rounded-full",style:{width:`${Math.min((t?.word_count||0)/100*100,100)}%`}})})]})]}),r&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Recording"}),l.jsx(HB,{audioBlob:r,recordingTime:n})]}),t?.feedback&&l.jsx("div",{className:"mb-6 bg-gradient-to-r from-green-50 to-blue-50 p-3 sm:p-6 rounded-lg border border-green-200",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("span",{className:"text-green-600 text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:"font-semibold text-green-800 mb-3 text-lg",children:"AI Feedback"}),l.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.feedback})]})]})}),t?.improved_transcript&&l.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[l.jsx("span",{className:"text-green-600 text-lg",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-green-800 mb-2",children:"Improved Version"}),l.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Here's how your response could be improved with better grammar and vocabulary:"})]})]}),l.jsx("div",{className:"bg-white border border-green-200 rounded p-3",children:l.jsx("p",{className:"text-gray-800 leading-relaxed",children:t.improved_transcript})})]}),l.jsx("div",{className:"mb-6",children:l.jsx("button",{onClick:()=>f(!d),className:"text-blue-600 hover:text-blue-800 text-sm",children:d?"Hide Details":"Show Details"})}),d&&l.jsxs("div",{className:"mb-6 bg-blue-50 p-3 sm:p-4 rounded-lg",children:[l.jsx("h4",{className:"font-semibold mb-3",children:"Detailed Analysis"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Word Count Analysis:"}),l.jsxs("span",{className:"ml-2 text-gray-700",children:["You spoke ",t?.word_count||0," words.",t?.word_count>=50?" Great job meeting the minimum requirement!":" Consider speaking more to meet the minimum word requirement."]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Grammar Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.grammar_mistakes===0?"Perfect grammar!":`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((w,C)=>l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-red-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-600",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Vocabulary Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.vocabulary_mistakes===0?"Excellent vocabulary usage!":`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`}),t?.vocabulary_corrections&&t.vocabulary_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.vocabulary_corrections.map((w,C)=>l.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-purple-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-purple-600",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:w.correction})]}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",w.explanation]})]})]})},C))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Pronunciation Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.pronunciation_corrections&&t.pronunciation_corrections.length>0?`Found ${t.pronunciation_corrections.length} pronunciation ${t.pronunciation_corrections.length===1?"tip":"tips"} to help improve clarity.`:"Great pronunciation! Your speech was clear and easy to understand."})]}),t?.pronunciation_corrections&&t.pronunciation_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Pronunciation Tips:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.pronunciation_corrections.map((w,C)=>l.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-orange-600 font-mono text-sm",children:""}),l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-orange-700",children:w.word}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-700",children:w.correction})]})})]})},C))})]}),t?.language_use_corrections&&t.language_use_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Language Use Suggestions:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.language_use_corrections.map((w,C)=>l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded p-2 sm:p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-blue-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-700",children:w.mistake}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-700",children:w.suggestion})]}),w.explanation&&l.jsxs("div",{className:"text-xs text-blue-700 mt-1",children:[l.jsx("strong",{children:"Why:"})," ",w.explanation]})]})]})},C))})]})]})]}),l.jsxs("div",{className:"text-sm text-gray-600 mb-3",children:["Attempt ",o," of ",c]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-center",children:[i&&l.jsxs("button",{onClick:s,className:"w-full sm:w-auto bg-yellow-600 text-white px-4 py-2.5 rounded-lg hover:bg-yellow-700 flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Re-record"})]}),l.jsx("button",{onClick:a,disabled:u,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium ${u?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:u?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Final"})]})})]}),!i&&l.jsx("div",{className:"mt-4 p-2 sm:p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("p",{className:"text-yellow-800 text-sm",children:[l.jsx("strong",{children:"Maximum attempts reached."}),' This is your final attempt. Click "Submit Final" to complete the test.']})})]})},oie=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=S.useState("recording"),[i,o]=S.useState(null),[c,u]=S.useState(""),[d,f]=S.useState(null),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState(!1),[k,_]=S.useState(null),[N,E]=S.useState(1),[P]=S.useState(e.max_attempts||3),[F,A]=S.useState(!1),[j,I]=S.useState(0),[L,Y]=S.useState(!1),[Z,ae]=S.useState(0),[ee,ne]=S.useState(null),B=Jo(),{user:V}=cs(),{makeAuthenticatedRequest:M}=B,H=S.useRef(null);S.useEffect(()=>{if(e?.test_id&&V?.student_id){const ce=`speaking_attempts_${V.student_id}_${e.test_id}`,be=localStorage.getItem(ce);if(be){const re=parseInt(be,10);re>0&&re<=P&&(E(re),console.log(" Loaded attempts from localStorage:",re))}}},[e,V,P]),S.useEffect(()=>{if(e&&!ee){const ce=new Date;ne(ce),console.log(" Speaking test timer started at:",ce.toISOString())}},[e,ee]),S.useEffect(()=>{let ce=0;s==="recording"?ce=25:s==="processing"?ce=50:s==="feedback"?ce=75:s==="completed"&&(ce=100),ae(ce)},[s]),S.useEffect(()=>{(async()=>{try{if(!window.isSecureContext&&!window.location.hostname.includes("localhost")){_("Microphone access requires HTTPS. Please use a secure connection.");return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){_("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");return}if(navigator.permissions)try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?(A(!0),console.log(" Microphone permission already granted")):console.log(" Microphone permission not yet granted - user will need to click record button")}catch(be){console.log(" Could not check microphone permission status:",be)}}catch(be){console.error(" Error checking microphone permission:",be)}})()},[]),S.useEffect(()=>{const ce=setInterval(()=>{i&&s==="recording"&&W()},3e4);return()=>clearInterval(ce)},[i,s]);const W=S.useCallback(async()=>{try{const ce={test_id:e.test_id,audio_blob:i?await R(i):null,attempt_number:N,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(ce))}catch(ce){console.error("Failed to save progress:",ce)}},[e.test_id,i,N,s]),R=ce=>new Promise((be,re)=>{const pe=new FileReader;pe.onloadend=()=>{const Ae=pe.result.split(",")[1];be(Ae)},pe.onerror=re,pe.readAsDataURL(ce)}),z=S.useCallback(ce=>{if(e?.test_id&&V?.student_id){const be=`speaking_attempts_${V.student_id}_${e.test_id}`;localStorage.setItem(be,ce.toString()),console.log(" Saved attempts to localStorage:",ce)}},[e,V]),K=S.useCallback(async(ce,be,re,pe,Ce)=>{if(e?.test_id&&V?.student_id)try{const{setCachedData:Ae,CACHE_TTL:We}=await Zi(async()=>{const{setCachedData:gt,CACHE_TTL:ht}=await Promise.resolve().then(()=>Vg);return{setCachedData:gt,CACHE_TTL:ht}},void 0),Le=`speaking_test_data_${V.student_id}_${e.test_id}`,Qe={audioBlob:ce?await R(ce):null,transcript:be,scores:re,recordingTime:pe,currentStep:Ce,timestamp:Date.now()};Ae(Le,Qe,We.speaking_test_data),console.log(" Saved speaking test data to cache:",Le)}catch(Ae){console.error("Failed to save speaking test data to cache:",Ae)}},[e,V]),J=S.useCallback(async()=>{if(e?.test_id&&V?.student_id)try{const{getCachedData:ce}=await Zi(async()=>{const{getCachedData:pe}=await Promise.resolve().then(()=>Vg);return{getCachedData:pe}},void 0),be=`speaking_test_data_${V.student_id}_${e.test_id}`,re=ce(be);if(re){if(console.log(" Loaded speaking test data from cache:",re),re.audioBlob){const pe=new Blob([Uint8Array.from(atob(re.audioBlob),Ce=>Ce.charCodeAt(0))],{type:"audio/webm"});o(pe)}return re.transcript&&u(re.transcript),re.scores&&f(re.scores),re.recordingTime&&I(re.recordingTime),re.currentStep&&a(re.currentStep),!0}}catch(ce){console.error("Failed to load speaking test data from cache:",ce)}return!1},[e,V]);S.useEffect(()=>{if(e?.test_id&&V?.student_id){try{const ce=V.student_id,be=`retest_assignment_id_${ce}_speaking_${e.test_id}`,re=`retest_in_progress_${ce}_speaking_${e.test_id}`;if(!!localStorage.getItem(be)||!!localStorage.getItem(re)){const Ce=`speaking_test_data_${ce}_${e.test_id}`,Ae=`anti_cheating_${ce}_speaking_${e.test_id}`,We=`speaking_progress_${e.test_id}`;localStorage.removeItem(Ce),localStorage.removeItem(Ae),localStorage.removeItem(We),console.log(" Cleared speaking per-test cache for retest start:",{cacheKey:Ce,antiCheatKey:Ae,progressKey:We})}}catch{}J()}},[e,V,J]),S.useEffect(()=>{e?.test_id&&V?.student_id&&(i||c||d)&&K(i,c,d,j,s)},[i,c,d,j,s,e,V,K]);const se=S.useCallback(async(ce,be)=>{if(L){console.log(" Already processing, skipping duplicate call");return}console.log(" Recording completed, duration:",be),Y(!0),o(ce),I(be),a("processing"),_(null);try{const re=await R(ce),pe=new Date,Ce=e.start_time?Math.round((pe-e.start_time)/1e3):0,Ae=e.start_time?new Date(e.start_time).toISOString():pe.toISOString(),We=V.student_id,Le=`retest_assignment_id_${We}_speaking_${e.test_id}`,At=localStorage.getItem(Le),Qe={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:We,question_id:e.question_id||1,audio_blob:re,audio_duration:ce.duration||0,time_taken:Ce,started_at:Ae,submitted_at:pe.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:At?Number(At):null,parent_test_id:e.test_id};console.log(" Submitting speaking test:",Qe),console.log(" Processing audio with AI...");try{const ht=await(await M("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e.test_id,question_id:e.question_id||1,audio_blob:re})})).json();if(ht.success){console.log(" AI Analysis Result:",ht),u(ht.transcript);const tt=ht.transcript?ht.transcript.split(/\s+/).filter(Rt=>Rt.length>0).length:0;console.log(" Word Count Verification:",{aiCount:ht.word_count,actualCount:tt,transcript:ht.transcript});const ut=tt,Dt={overall_score:ht.overall_score,word_count:ut,grammar_score:ht.grammar_score,vocabulary_score:ht.vocabulary_score,pronunciation_score:ht.pronunciation_score,fluency_score:ht.fluency_score,content_score:ht.content_score,grammar_mistakes:ht.grammar_mistakes,vocabulary_mistakes:ht.vocabulary_mistakes,feedback:ht.feedback,improved_transcript:ht.improved_transcript,grammar_corrections:ht.grammar_corrections||[],vocabulary_corrections:ht.vocabulary_corrections||[],language_use_corrections:ht.language_use_corrections||[],pronunciation_corrections:ht.pronunciation_corrections||[],ai_feedback:ht.ai_feedback||null};console.log(" Mapped Scores:",Dt),console.log(" Individual scores check:",{grammar_score:ht.grammar_score,vocabulary_score:ht.vocabulary_score,pronunciation_score:ht.pronunciation_score,fluency_score:ht.fluency_score,content_score:ht.content_score}),f(Dt),a("feedback")}else throw new Error(ht.message||"Failed to process audio with AI");localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(gt){console.error("Speaking test submission error:",gt),gt.message.includes("No valid authentication token found")?(_("Your session has expired. Please refresh the page and try again."),setTimeout(()=>{window.location.reload()},3e3)):_(gt.message),a("recording")}}catch(re){console.error("Speaking test submission error:",re),_(re.message),a("recording")}finally{Y(!1)}},[e,V,M,N,z,L]);S.useEffect(()=>{s==="processing"&&!c&&!d&&(console.log(' Detected stuck "processing" state on reload. Attempting recovery...'),i?(console.log(" Resuming processing from cached audio blob..."),se(i,j)):(console.log(" No cached audio blob found. Resetting to recording step."),a("recording")))},[s,c,d,i,j,se]);const X=S.useCallback(()=>{if(N<P){o(null),u(""),f(null),_(null),Y(!1);const ce=N+1;E(ce),z(ce),a("recording")}else _("Maximum attempts reached")},[N,P,z]),ie=S.useCallback(async()=>{if(!(!c||!d)){p(!0);try{const ce=new Date,be=e.start_time?Math.round((ce-e.start_time)/1e3):0,re=e.start_time?new Date(e.start_time).toISOString():ce.toISOString(),pe=V.student_id,Ce=`retest_assignment_id_${pe}_speaking_${e.test_id}`,Ae=localStorage.getItem(Ce),{academicCalendarService:We}=await Zi(async()=>{const{academicCalendarService:tt}=await Promise.resolve().then(()=>n2);return{academicCalendarService:tt}},void 0);await We.loadAcademicCalendar();const At=We.getCurrentTerm()?.id;if(!At)throw new Error("No current academic period found");const Qe={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:pe,academic_period_id:At,question_id:e.question_id||1,audio_blob:i?await R(i):null,audio_duration:i?.duration||0,time_taken:be,started_at:re,submitted_at:ce.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:Ae?Number(Ae):null,parent_test_id:e.test_id,transcript:c,scores:d,final_submission:!0};console.log(" Final submission:",Qe),console.log(" Making final submission request...");const gt=await M("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Qe)});console.log(" Final submission response status:",gt.status);const ht=await gt.json();if(console.log(" Final submission result:",ht),ht.success){if(V?.student_id){const Ze=`test_completed_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(Ze,"true"),console.log(" Speaking test marked as completed in localStorage:",Ze);const Tt=`retest_in_progress_${V.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Tt),console.log(" Cleared in-progress retest lock:",Tt);const Nt=`speaking_attempts_${V.student_id}_${e.test_id}`;localStorage.removeItem(Nt),console.log(" Cleared attempts from localStorage upon submission");const{clearTestData:$t}=await Zi(async()=>{const{clearTestData:ir}=await Promise.resolve().then(()=>Vg);return{clearTestData:ir}},void 0);$t(V.student_id,"speaking_test_data",e.test_id),console.log(" Cleared speaking test data from cache upon submission");try{const ir=`anti_cheating_${V.student_id}_speaking_${e.test_id}`;localStorage.removeItem(ir),console.log(" Cleared anti-cheating key:",ir)}catch{}}console.log(" Caching speaking test results after submission...");const ut=`student_results_table_${V?.student_id||V?.id||"unknown"}`,{setCachedData:Dt,getCachedData:Rt,CACHE_TTL:It,clearTestData:De}=await Zi(async()=>{const{setCachedData:Ze,getCachedData:Tt,CACHE_TTL:Nt,clearTestData:$t}=await Promise.resolve().then(()=>Vg);return{setCachedData:Ze,getCachedData:Tt,CACHE_TTL:Nt,clearTestData:$t}},void 0),Ie={id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(d.overall_score/10),max_score:10,percentage:d.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),subject:"Listening and Speaking",teacher_name:e.teacher_name||"Unknown"};let Je={success:!0,results:[],count:0};try{const Ze=Rt(ut);Ze&&Array.isArray(Ze.results)&&(Je.results=Ze.results.slice())}catch{}if(Je.results.unshift(Ie),Je.count=Je.results.length,Dt(ut,Je,It.student_results_table),console.log(" Speaking test results cached (merged) with key:",ut),V?.student_id&&De(V.student_id,"speaking",e.test_id),!!Ae&&V?.student_id){let Ze=3;try{const $t=localStorage.getItem(`student_active_tests_${V.student_id}`);if($t){const pr=JSON.parse($t)?.tests?.find(Nr=>Nr.test_id===e.test_id&&Nr.test_type==="speaking");pr&&(Ze=pr.retest_attempts_left||pr.max_attempts||3)}}catch($t){console.error("Error checking active tests cache:",$t)}const Nt=(d?.overall_score??0)>=50;if(Nt){const $t=`retest_attempt${Ze}_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem($t,"true"),console.log(" Passed retest, marking last-slot key:",$t);let ir=0;for(let dr=1;dr<=10;dr++){const Vt=`retest_attempt${dr}_${V.student_id}_speaking_${e.test_id}`;localStorage.getItem(Vt)==="true"&&ir++}const pr=`test_completed_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(pr,"true"),console.log(" Marked retest as completed (student passed):",pr);const Nr=`retest_attempts_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(Nr,JSON.stringify({used:ir,max:Ze})),console.log(" Set retest attempts metadata (student passed):",Nr,{used:ir,max:Ze})}else{let $t=1;for(let Vt=1;Vt<=10;Vt++){const ge=`retest_attempt${Vt}_${V.student_id}_speaking_${e.test_id}`;if(localStorage.getItem(ge)!=="true"){$t=Vt;break}}const ir=`retest_attempt${$t}_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(ir,"true"),console.log(" Marked retest attempt as completed:",ir);let pr=0;for(let Vt=1;Vt<=10;Vt++){const ge=`retest_attempt${Vt}_${V.student_id}_speaking_${e.test_id}`;localStorage.getItem(ge)==="true"&&pr++}const Nr=Ze-pr,dr=Nr<=0||Nt;if(console.log(" Retest completion check:",{usedAttempts:pr,maxAttempts:Ze,attemptsLeft:Nr,passed:Nt,shouldComplete:dr}),dr){const Vt=`test_completed_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(Vt,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",Vt);const ge=`retest_attempts_${V.student_id}_speaking_${e.test_id}`;localStorage.setItem(ge,JSON.stringify({used:pr,max:Ze})),console.log(" Set retest attempts metadata (attempts exhausted):",ge,{used:pr,max:Ze})}}}if(V?.student_id){const Ze=`retest1_${V.student_id}_speaking_${e.test_id}`,Tt=`retest_assignment_id_${V.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Ze),localStorage.removeItem(Tt)}try{n&&n(d.overall_score),typeof r=="function"&&r()}catch{}return}else throw new Error(ht.message||"Failed to submit speaking test")}catch(ce){console.error("Speaking test submission error:",ce),_(ce.message)}finally{p(!1)}}},[e,V,M,c,d,i,N,t]);S.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:c,scores:d,attempt_number:N})},[e.test_id,c,d,N,t]);const le=()=>{switch(s){case"recording":return l.jsxs("div",{className:"speaking-test-recording",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:e.test_name}),l.jsxs("div",{className:"mb-6 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Instructions:"}),l.jsx("p",{className:"text-gray-700 mb-4",children:e.prompt}),l.jsx("div",{className:"bg-blue-50 p-3 sm:p-4 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),l.jsx(aie,{ref:H,onRecordingComplete:se,minDuration:0,maxDuration:e.max_duration||600,minWords:e.min_words||50,maxAttempts:P,currentAttempt:N}),k&&l.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:k})})]});case"processing":return l.jsxs("div",{className:"transcription-status bg-white rounded-lg shadow-lg p-4 sm:p-8 text-center",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Processing Your Speech"}),l.jsx("p",{className:"text-lg text-blue-600",children:"Please wait while we process your audio..."})]}),l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),l.jsx(iie,{transcript:c,scores:d,audioBlob:i,recordingTime:j,onReRecord:X,onFinalSubmit:()=>v(!0),canReRecord:N<P,attemptNumber:N,maxAttempts:P,isSubmitting:g});case"completed":const ce={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:d?.overall_score||0,totalQuestions:1,percentage:d?.overall_score||0,passed:(d?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:c,correctAnswer:"Speaking test completed",isCorrect:!0,score:d?.overall_score||0,maxScore:100,feedback:`Word Count: ${d?.word_count||0}, Grammar: ${d?.grammar_score||0}/40, Vocabulary: ${d?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return l.jsx("div",{className:"speaking-test-completed",children:l.jsx(Wv,{testResults:ce,onBackToCabinet:()=>C(!0),onRetakeTest:()=>{a("recording"),u(""),f(null),o(null),E(1)},isLoading:!1})});default:return null}};return l.jsxs("div",{children:[l.jsx(oa,{isOpen:x&&!g,onClose:()=>v(!1),title:"Submit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>v(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{v(!1),ie()},variant:"primary",children:"Submit"})]})]})}),l.jsx(oa,{isOpen:w,onClose:()=>C(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>C(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{C(!1),typeof r=="function"&&r()},variant:"primary",children:"Go Back"})]})]})}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-3 sm:p-6",children:[k&&l.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:k})}),le()]})]})},lie=e=>function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296},cie=(e,t,r)=>{if(e.length===1)return e[0];const n=`${r}:speaking:${t}`,s=Array.from(n).reduce((o,c)=>(o<<5)-o+c.charCodeAt(0),0)>>>0,a=lie(s),i=Math.floor(a()*e.length);return e[i]},uie=()=>{const{testId:e}=Fb(),t=Eo(),{user:r}=cs(),n=Jo(),{showNotification:s}=ka(),[a,i]=S.useState(null),[o,c]=S.useState([]),[u,d]=S.useState(null),[f,g]=S.useState(!0),[p,x]=S.useState(null),[v,w]=S.useState(!1),[C,k]=S.useState(null),[_,N]=S.useState(!1),{startTracking:E,stopTracking:P}=Xm("speaking",e,r?.student_id||r?.id);S.useEffect(()=>{F(),A()},[e]),S.useEffect(()=>{if(a&&!v){me.debug(" Speaking test - initializing anti-cheating tracking");const Y=r?.student_id||r?.id||"unknown",Z=`anti_cheating_${Y}_speaking_${e}`,ae=localStorage.getItem(Z);if(me.debug(" Checking for anti-cheating data with key:",Z),me.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),me.debug(" Current test details:",{testType:"speaking",testId:e,studentId:Y}),ae)try{const ee=JSON.parse(ae);me.debug(" Found existing anti-cheating data for THIS speaking test:",ee),me.debug(" Visibility change times for this test:",ee.tabSwitches||0),me.debug(" Cheating status for this test:",ee.isCheating||!1),ee.isCheating&&(me.debug(" WARNING: Student has been flagged for cheating in THIS speaking test!"),me.debug(" Tab switches detected in this test:",ee.tabSwitches),s(` Warning: Suspicious activity detected in this speaking test (${ee.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(ee){me.error(" Error parsing existing anti-cheating data:",ee)}else me.debug(" No existing anti-cheating data found for this speaking test - starting fresh");E(),me.debug(" Anti-cheating tracking started for speaking test")}return()=>{a&&(me.debug(" Cleaning up anti-cheating tracking for speaking test"),P())}},[a,v,e,r?.student_id,r?.id,E,P,s]);const F=async()=>{try{g(!0);const Y=await n.getSpeakingTest(e);if(Y.success)i(Y.test);else throw new Error(Y.message||"Failed to load test");const Z=await n.getSpeakingTestQuestions(e);if(Z.success){const ae=Z.questions;c(ae);const ee=r?.student_id||r?.id,ne=cie(ae,e,ee);d(ne),me.debug(" Selected question for student:",{studentId:ee,testId:e,totalQuestions:ae.length,selectedQuestion:ne?.id,selectedPrompt:ne?.prompt?.substring(0,50)+"..."})}}catch(Y){me.error("Error loading test data:",Y),x(Y.message)}finally{g(!1)}},A=()=>{const Z=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(Z)==="true"){w(!0);const ee=localStorage.getItem(`speaking_test_result_${e}`);ee&&k(JSON.parse(ee))}},j=async Y=>{try{w(!0),k(Y),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(Y)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(Z){me.error("Error handling test completion:",Z)}},I=()=>{if(me.debug(" Navigating back to cabinet from speaking test..."),a&&r?.student_id){me.debug(" Cabinet navigation detected - counting as cheating attempt");const Z=`anti_cheating_${r?.student_id||r?.id||"unknown"}_speaking_${e}`,ae=localStorage.getItem(Z);let ee=0,ne=!1;if(ae)try{const H=JSON.parse(ae);ee=H.tabSwitches||0,ne=H.isCheating||!1}catch(H){me.error(" Error parsing existing anti-cheating data:",H)}const B=ee+1,V=B>=2;me.debug(` Tab switch count: ${ee}  ${B} (cheating: ${V})`);const M={tabSwitches:B,isCheating:V,lastUpdated:new Date().toISOString()};localStorage.setItem(Z,JSON.stringify(M)),me.debug(" Anti-cheating data updated for cabinet navigation:",M)}t("/student")};if(f)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(et,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Loading speaking test..."})]})})})]});if(p)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(et,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-600 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-6",children:p})]})})})]});if(v&&C)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test Results"})}),l.jsx(et,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx(Wv,{testType:"speaking",testData:a,result:C,onRetake:()=>{w(!1),k(null);const Y=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${Y}_speaking_${e}`)}})})]});if(!a||o.length===0)return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(et,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load test information"})]})})})]});const L=u;return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx(oa,{isOpen:_,onClose:()=>N(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(et,{onClick:()=>N(!1),variant:"secondary",children:"Cancel"}),l.jsx(et,{onClick:()=>{N(!1),I()},variant:"primary",children:"Go Back"})]})]})}),l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Speaking Test"})}),l.jsx(et,{variant:"outline",onClick:()=>N(!0),children:"Back to Cabinet"})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.length>1&&u&&l.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:"i"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Question Selection"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["This test has ",o.length," questions. You have been assigned ",l.jsxs("strong",{children:["Question ",u.question_number]}),"."]})})]})]})}),l.jsx(oie,{testData:{...a,test_id:parseInt(e),question_id:L?.id,prompt:L?.prompt,start_time:Date.now()},onComplete:j,onExit:I,onTestComplete:j})]})]})},die=()=>{const{testType:e,testId:t}=Fb(),r=Eo(),{activeTests:n}=zv(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return l.jsx(rie,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},fie=()=>{const e=Eo(),{user:t,isAuthenticated:r,isLoading:n}=cs(),[s,a]=S.useState(!1),[i,o]=S.useState(!0),[c,u]=S.useState(""),[d,f]=S.useState([]),[g,p]=S.useState(!1),[x,v]=S.useState(!1),[w,C]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=S.useCallback(async()=>{me.debug(" Initializing Student Application...");try{if(o(!0),u(""),!r||!t){me.debug(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==Qi.STUDENT){me.error(" Invalid user role for student app:",t.role),u("Access denied. Student role required.");return}me.debug(" Initializing event listeners..."),_(),me.debug(" Setting up back to cabinet button listeners..."),N(),me.debug(" Setting up password change form listener..."),E(),me.debug(" Loading student data..."),await P(),me.debug(" Exposing student functions globally..."),F(),me.debug(" Populating student info from user data..."),Z(t),a(!0),me.debug(" Student Application initialization complete!")}catch(ne){me.error(" Error initializing student app:",ne),u("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);S.useEffect(()=>{n||k()},[n,r,t,k]);const _=S.useCallback(()=>{me.debug(" Setting up student event listeners...");const ne=V=>{g&&!V.target.closest(".student-menu")&&p(!1)},B=V=>{V.key==="Escape"&&g&&p(!1)};return document.addEventListener("click",ne),document.addEventListener("keydown",B),()=>{document.removeEventListener("click",ne),document.removeEventListener("keydown",B)}},[g]),N=S.useCallback(()=>{me.debug(" Setting up back to cabinet listeners...")},[]),E=S.useCallback(()=>{me.debug(" Setting up password change form...")},[]),P=S.useCallback(async()=>{me.debug(" Loading student data...");try{me.debug(" Student data loaded successfully")}catch(ne){throw me.error(" Error loading student data:",ne),ne}},[]),F=S.useCallback(()=>{me.debug(" Exposing student functions globally..."),window.toggleStudentMenu=A,window.showChangePasswordTab=j,window.hideChangePasswordTab=I,window.navigateBackToCabinet=Y,window.handlePasswordChange=L,window.populateStudentInfoDirectly=Z,me.debug(" All student functions exposed globally")},[]),A=S.useCallback(()=>{me.debug(" toggleStudentMenu called"),p(ne=>{const B=!ne;return me.debug(" Menu state changed from",ne,"to",B),B}),me.debug(" Toggled dropdown menu")},[]),j=S.useCallback(()=>{me.debug(" showChangePasswordTab called"),v(!0),p(!1)},[]),I=S.useCallback(()=>{me.debug(" hideChangePasswordTab called"),v(!1),C({currentPassword:"",newPassword:"",confirmPassword:""})},[]),L=S.useCallback(async ne=>{ne.preventDefault(),me.debug(" handlePasswordChange called");const{currentPassword:B,newPassword:V,confirmPassword:M}=w;if(!B||!V||!M){ae("Please fill in all fields","error");return}if(V!==M){ae("New passwords do not match","error");return}if(V.length<6){ae("New password must be at least 6 characters long","error");return}const H=/[a-zA-Z]/.test(V),W=/[0-9]/.test(V);if(!H||!W){ae("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){ae("Session expired. Please login again.","error");return}const R=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const z=await hs.changePassword({studentId:R,currentPassword:B,newPassword:V});z.success?(ae("Password changed successfully!","success"),I()):ae(z.message||"Failed to change password","error")}catch(z){me.error("Password change error:",z),ae("Failed to change password. Please try again.","error")}finally{o(!1)}},[w,t]),Y=S.useCallback(()=>{if(me.debug("[DEBUG] navigateBackToCabinet called"),!r||!t){me.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===Qi.STUDENT?(me.debug("[DEBUG] Navigating to student cabinet"),e("/student")):(me.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),Z=S.useCallback(ne=>{me.debug(" populateStudentInfoDirectly called with:",ne);try{me.debug(" Student info populated successfully")}catch(B){me.error(" Error populating student info:",B)}},[]),ae=S.useCallback((ne,B)=>{const V={id:Date.now(),message:ne,type:B,timestamp:new Date};f(M=>[...M,V]),setTimeout(()=>{f(M=>M.filter(H=>H.id!==V.id))},N0.NOTIFICATION_DURATION)},[]),ee=S.useCallback(ne=>{const{name:B,value:V}=ne.target;C(M=>({...M,[B]:V}))},[]);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:c}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{className:"bg-gray-50",children:[l.jsxs(gN,{children:[l.jsx(Os,{path:"/",element:l.jsxs("div",{className:"student-app",children:[l.jsx(Qae,{isMenuOpen:g,onToggleMenu:A,onShowPasswordChange:j}),x&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),l.jsxs("form",{onSubmit:L,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:w.currentPassword,onChange:ee,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:w.newPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:w.confirmPassword,onChange:ee,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(et,{type:"button",variant:"secondary",onClick:I,className:"flex-1",children:"Cancel"}),l.jsx(et,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),l.jsx(Os,{path:"/test/:testType/:testId",element:l.jsx(die,{})}),l.jsx(Os,{path:"matching-test/:testId",element:l.jsx(nie,{})}),l.jsx(Os,{path:"word-matching-test/:testId",element:l.jsx(sie,{})}),l.jsx(Os,{path:"speaking-test/:testId",element:l.jsx(uie,{})}),l.jsx(Os,{path:"/results",element:l.jsx(WB,{})})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(ne=>l.jsx(uc,{type:ne.type,message:ne.message,onClose:()=>f(B=>B.filter(V=>V.id!==ne.id))},ne.id))})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},hie=()=>l.jsx(OM,{children:l.jsx(PB,{children:l.jsx(AB,{children:l.jsx(fie,{})})})}),gie=({result:e,isOpen:t,onClose:r,initialTab:n="overview",editingSpeakingScore:s,tempSpeakingScore:a,isSavingSpeakingScore:i,onStartSpeakingScoreEdit:o,onSaveSpeakingScore:c,onCancelSpeakingScoreEdit:u,onTempSpeakingScoreChange:d})=>{const[f,g]=S.useState(n),p=S.useRef(!1);if(S.useEffect(()=>()=>{p.current=!0},[]),S.useEffect(()=>{t&&g(n)},[t,n]),!t||!e)return null;const x={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let v=e?.__audioUrl||void 0;const w=v?void 0:e?.answers;typeof w=="string"?v=w:w&&typeof w=="object"&&(v=w.audio_url),S.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof w=="object"&&w?.transcript?w.transcript:void 0,hasAnswers:!!w,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[C,k]=S.useState("");S.useEffect(()=>{const N=new AbortController;let E=!1;const P=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof w=="object"&&w?.transcript)&&e?.test_id&&P&&(async()=>{try{const F=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(P)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:F});const A=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),j=await fetch(F,{headers:{Authorization:A?`Bearer ${A}`:""},signal:N.signal});console.log("[SpeakingReview] Transcript API response:",{ok:j.ok,status:j.status});const I=await j.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",I),!E&&!p.current&&(j.ok?k(I.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",I?.error||"unknown error"))}catch(F){F.name!=="AbortError"&&!p.current&&console.error("[SpeakingReview] Transcript fetch error:",F)}})(),()=>{E=!0;try{N.abort()}catch{}}},[e]);const _={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:v,transcript:e.transcript||C||(typeof w=="object"&&w?.transcript?w.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[l.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",x.test_name]}),l.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"analysis",label:"AI Analysis"},{id:"scoring",label:"Scoring"}].map(N=>l.jsx("button",{onClick:()=>g(N.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${f===N.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:N.label},N.id))})}),l.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[f==="overview"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:x.test_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[_.score," / ",_.max_score]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.time_taken?`${Math.floor(_.time_taken/60)}:${(_.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.submitted_at?new Date(_.submitted_at).toLocaleString():"N/A"})]})]})}),f==="audio"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),_.audio_url?l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx(HB,{audioUrl:_.audio_url,className:"w-full"})})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No audio recording available"})})]}),f==="transcript"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),_.transcript?l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:_.transcript})}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No transcript available"})})]}),f==="analysis"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Analysis Results"}),(()=>{let N=e.ai_feedback;if(N&&typeof N=="string")try{N=JSON.parse(N)}catch{N=null}return N?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Overall Performance"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-800",children:N.overall_score||0}),l.jsx("div",{className:"text-sm text-gray-600",children:"Overall Score (0-100)"})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Category Breakdown"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[N.grammar_score||0,"/25"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Grammar"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-green-600",children:[N.vocabulary_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Vocabulary"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[N.pronunciation_score||0,"/15"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Pronunciation"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[N.fluency_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Fluency"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-red-600",children:[N.content_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Content"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Metrics"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Word Count:"}),l.jsx("span",{className:"text-sm font-medium",children:N.word_count||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Grammar Mistakes:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:N.grammar_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Vocabulary Issues:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:N.vocabulary_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty Level:"}),l.jsx("span",{className:"text-sm font-medium",children:N.difficulty_level||"N/A"})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"AI Feedback"}),N.feedback?l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:N.feedback})}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("p",{className:"text-sm",children:"No AI feedback available"})})]})]}),N.improved_transcript&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Improved Transcript"}),l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:N.improved_transcript})})]}),N.grammar_corrections&&N.grammar_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Grammar Corrections"}),l.jsx("div",{className:"space-y-3",children:N.grammar_corrections.map((E,P)=>l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-800",children:"Mistake:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Correction:"})," ",E.correction]}),E.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.vocabulary_corrections&&N.vocabulary_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Vocabulary Improvements"}),l.jsx("div",{className:"space-y-3",children:N.vocabulary_corrections.map((E,P)=>l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-yellow-800",children:"Original:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Better:"})," ",E.correction]}),E.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",E.explanation]})]},P))})]}),N.language_use_corrections&&N.language_use_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Language Use Suggestions"}),l.jsx("div",{className:"space-y-3",children:N.language_use_corrections.map((E,P)=>l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Original:"})," ",E.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Suggestion:"})," ",E.suggestion]}),E.explanation&&l.jsx("div",{className:"text-xs text-blue-700 mt-1",children:E.explanation})]},P))})]})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No AI analysis available for this result"})})})()]}),f==="scoring"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Score Details"}),s?l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 place-items-center",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Score"}),l.jsx("input",{type:"number",min:"0",max:_.max_score,value:a,onChange:N=>d(N.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Max Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.max_score," (Fixed)"]})]})]}),l.jsxs("div",{className:"flex justify-center space-x-3",children:[l.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Score"}),l.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("div",{className:"grid grid-cols-1 place-items-center gap-2",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Current Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.score," / ",_.max_score]})]})}),l.jsx("button",{onClick:()=>o(e.id,_.score),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 mx-auto",children:"Edit Score"})]})]})]}),l.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})},mie=({isOpen:e,onClose:t,testResult:r,questions:n,isLoadingQuestions:s})=>{const a=w=>{if(!w)return{};if(typeof w=="string")try{return JSON.parse(w)}catch{return{}}return w||{}},i=S.useMemo(()=>{const w=r?.answers;if(console.log(" [TestAnswerModal] Raw testResult.answers:",w),console.log(" [TestAnswerModal] Raw testResult.answers type:",typeof w),w&&typeof w=="object"&&w.answers_by_id)return console.log(" [TestAnswerModal] Found answers_by_id format"),console.log(" [TestAnswerModal] answers_by_id:",w.answers_by_id),console.log(" [TestAnswerModal] question_order:",w.question_order),w.answers_by_id||{};const C=a(w);return console.log(" [TestAnswerModal] Parsed student answers:",C),console.log(" [TestAnswerModal] Full testResult:",r),C},[r?.answers]),o=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.correct_answer,F=E===P,A=j=>{const I=`option_${j.toLowerCase()}`;return w[I]||j};return l.jsxs("tr",{className:F?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:w.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:E?l.jsxs("span",{className:`font-medium ${F?"text-green-700":"text-red-700"}`,children:[E," - ",A(E)]}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:[P," - ",A(P)]}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:F?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},_)})})]})}),c=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.correct_answer;let F;typeof E=="boolean"?F=E:typeof E=="string"?F=E.toLowerCase().trim()==="true":E===1||E==="1"?F=!0:E===0||E==="0"?F=!1:F=!!E;let A;typeof P=="boolean"?A=P:typeof P=="string"?A=P.toLowerCase().trim()==="true":A=!!P;const j=F===A;C===0&&console.log(" [TestAnswerModal] True/False First Question Debug:",{questionIdStr:_,studentAnswer:E,studentAnswerType:typeof E,normalizedStudentAnswer:F,correctAnswer:P,correctAnswerType:typeof P,normalizedCorrectAnswer:A,isCorrect:j});const I=E!=null?F:null,L=A;return l.jsxs("tr",{className:j?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:w.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:I!==null?l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${I?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:I?"True":"False"}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm",children:l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${L?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:L?"True":"False"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:j?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},_)})})]})}),u=()=>{if(!n||n.length===0)return l.jsx("p",{className:"text-gray-500",children:"No questions available"});const w=(C,k)=>{if(!C||!k||k.length===0)return!1;const _=String(C).toLowerCase().trim();return k.some(N=>{const E=String(N).toLowerCase().trim();return _===E||E.length>=2&&_.includes(E)?!0:E.length===1?_.startsWith(E)||_.endsWith(E):!1})};return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer(s)"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((C,k)=>{const _=C.question_id||C.id||k+1,N=String(_),E=Number(_),P=i[N]!==void 0?i[N]:i[E]!==void 0?i[E]:i[_]!==void 0?i[_]:void 0,F=Array.isArray(C.correct_answers)?C.correct_answers:C.correct_answer?[C.correct_answer]:[],A=w(P,F);return k===0&&console.log(" [TestAnswerModal] First question debug:",{questionIdNum:_,questionIdStr:N,questionIdNumKey:E,studentAnswer:P,studentAnswers:i,studentAnswersKeys:Object.keys(i),correctAnswers:F,question:C}),l.jsxs("tr",{className:A?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:k+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:C.question}),l.jsx("td",{className:"px-4 py-3 text-sm",children:P?l.jsx("span",{className:`font-medium ${A?"text-green-700":"text-red-700"}`,children:P}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F.length>0?l.jsx("div",{className:"space-y-1",children:F.map((j,I)=>l.jsx("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:j},I))}):l.jsx("span",{className:"text-gray-400",children:"No correct answer defined"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:A?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},N)})})]})})},d=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Left Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=w.left_word,F=w.right_word;let A=null,j=!1;if(E){if(typeof E=="object")A=E.definition||E.right||E.word,j=E.word===P&&(E.definition||E.right)===F;else if(typeof E=="string")try{const I=JSON.parse(E);A=I.definition||I.right||I.word,j=I.word===P&&(I.definition||I.right)===F}catch{A=E}}return l.jsxs("tr",{className:j?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:C+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:P}),l.jsx("td",{className:"px-4 py-3 text-sm",children:A?l.jsx("span",{className:j?"text-green-700 font-medium":"text-red-700 font-medium",children:A}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:F}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:j?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},_)})})]})}),f=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"space-y-6",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k);C===0&&console.log(" [TestAnswerModal] Fill Blanks First Question Debug:",{questionIdNum:k,questionIdStr:_,questionIdNumKey:N,question:w,studentAnswers:i,studentAnswersKeys:Object.keys(i),correctAnswers:w.correct_answers});const E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0,P=Array.isArray(w.correct_answers)?w.correct_answers:[];let F=[];return Array.isArray(E)?F=E:E!=null?F=[E]:F=[],l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Question ",C+1]}),l.jsxs("div",{className:"space-y-3",children:[w.question_json&&l.jsx("div",{className:"text-sm text-gray-700 mb-4",children:typeof w.question_json=="string"?w.question_json:w.question_json.text||w.question_json.question||"Question text not available"}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Blank #"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map((A,j)=>{let I=F[j];const L=j+1,Y=String(L),Z=Number(L);(I==null||I==="")&&(I=i[Y]!==void 0?i[Y]:i[Z]!==void 0?i[Z]:I),C===0&&j===0&&console.log(" [TestAnswerModal] Fill Blanks First Blank Debug:",{blankIndex:j,potentialBlankId:L,potentialBlankIdStr:Y,potentialBlankIdNum:Z,studentAns:I,studentAnswersForQ:F,correctAns:A,studentAnswersKeys:Object.keys(i)});const ae=String(I||"").trim().toLowerCase()===String(A||"").trim().toLowerCase();return l.jsxs("tr",{className:ae?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:j+1}),l.jsx("td",{className:"px-4 py-2 text-sm",children:I?l.jsx("span",{className:ae?"text-green-700 font-medium":"text-red-700 font-medium",children:String(I)}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:String(A)}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:ae?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:""}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:""})})]},j)})})]})]})]},_)})}),g=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Matching type tests require visual comparison. Answers stored as connection pairs."}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Connection"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((w,C)=>{const k=w.question_id||w.id||C+1,_=String(k),N=Number(k),E=i[_]!==void 0?i[_]:i[N]!==void 0?i[N]:i[k]!==void 0?i[k]:void 0;return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:w.word}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:E?typeof E=="object"?JSON.stringify(E):E:l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})})]},_)})})]})})]}),p=()=>{if(!r)return null;const w=r.test_type||r.testType;if(s)return l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx(Hr,{size:"lg"}),l.jsx("span",{className:"ml-4 text-gray-600",children:"Loading questions..."})]});if(!n||n.length===0)return l.jsxs("div",{className:"text-center py-8",children:[l.jsx("p",{className:"text-gray-500",children:"Unable to load questions for this test."}),l.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Test ID: ",r.test_id,", Type: ",w]})]});switch(w){case"multiple_choice":return o();case"true_false":return c();case"input":return u();case"word_matching":return d();case"fill_blanks":return f();case"matching_type":return g();default:return l.jsxs("div",{className:"text-center py-8",children:[l.jsxs("p",{className:"text-gray-500",children:['Test type "',w,'" is not supported for answer viewing.']}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Drawing and Speaking tests have their own dedicated modals."})]})}};if(!r)return null;r.test_type||r.testType;const x=`${r.name||""} ${r.surname||""}`.trim(),v=`${r.test_name||"Test"} - ${x||r.student_id}`;return l.jsxs(oa,{isOpen:e,onClose:t,title:v,size:"large",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[l.jsxs("div",{className:"flex space-x-6",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Score"}),l.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[r.best_retest_score!==null&&r.best_retest_score!==void 0?`${r.best_retest_score} / ${r.best_retest_max_score||r.max_score||0}`:`${r.score||0} / ${r.max_score||0}`,r.best_retest_score!==null&&r.best_retest_score!==void 0&&l.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Retest Best)"})]})]}),r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0&&r.best_retest_percentage>0||r.percentage&&r.percentage>0?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Percentage"}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0?`${r.best_retest_percentage.toFixed(1)}%`:`${r.percentage?.toFixed(1)||"0.0"}%`})]}):null,r.subject&&r.subject!=="N/A"?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Subject"}),l.jsx("div",{className:"text-sm font-medium text-gray-700",children:r.subject})]}):null]}),r.submitted_at&&l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Submitted"}),l.jsx("div",{className:"text-sm text-gray-700",children:new Date(r.submitted_at).toLocaleString()})]})]}),l.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:p()}),r.caught_cheating&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-red-800",children:[" This test was flagged for suspicious activity (visibility changes: ",r.visibility_change_times||0,")"]})})]})};class yk extends Fs.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[l.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var M_={};M_.version="0.18.5";var GB=1252,pie=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],X4={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},J4=function(e){pie.indexOf(e)!=-1&&(GB=X4[0]=e)};function xie(){J4(1252)}var ac=function(e){J4(e)};function Q4(){ac(1200),xie()}function AF(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function yie(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function VB(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var cy=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?yie(e.slice(2)):t==254&&r==255?VB(e.slice(2)):t==65279?e.slice(1):e},kw=function(t){return String.fromCharCode(t)},jF=function(t){return String.fromCharCode(t)},Qy,gf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Zy(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=gf.charAt(a)+gf.charAt(i)+gf.charAt(o)+gf.charAt(c);return t}function Yo(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=gf.indexOf(e.charAt(u++)),i=gf.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=gf.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=gf.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var en=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ud=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Tf(e){return en?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function PF(e){return en?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ho=function(t){return en?ud(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function s2(e){if(typeof ArrayBuffer>"u")return Ho(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Lf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function vie(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Z4(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Z4(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Ba=en?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ud(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function wie(e){for(var t=[],r=0,n=e.length+250,s=Tf(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Tf(65535),n=65530)}return t.push(s.slice(0,r)),Ba(t)}var no=/\u0000/g,uy=/[\u0001-\u0006]/g;function um(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ic(e,t){var r=""+e;return r.length>=t?r:Ds("0",t-r.length)+r}function e3(e,t){var r=""+e;return r.length>=t?r:Ds(" ",t-r.length)+r}function L_(e,t){var r=""+e;return r.length>=t?r:r+Ds(" ",t-r.length)}function _ie(e,t){var r=""+Math.round(e);return r.length>=t?r:Ds("0",t-r.length)+r}function bie(e,t){var r=""+e;return r.length>=t?r:Ds("0",t-r.length)+r}var FF=Math.pow(2,32);function Ig(e,t){if(e>FF||e<-FF)return _ie(e,t);var r=Math.round(e);return bie(r,t)}function B_(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var OF=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vk=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Sie(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Fr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},DF={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},kie={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function $_(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*i+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var g=Math.floor(n*o/d);return[g,n*o-g*d,d]}function Dh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=jie(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var KB=new Date(1899,11,31,0,0,0),Cie=KB.getTime(),Tie=new Date(1900,2,1,0,0,0);function qB(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Tie&&(r+=1440*60*1e3),(r-(Cie+(e.getTimezoneOffset()-KB.getTimezoneOffset())*6e4))/(1440*60*1e3)}function t3(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Eie(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Nie(e){var t=e<0?12:11,r=t3(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Aie(e){var t=t3(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function ev(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Nie(e):t===10?r=e.toFixed(10).substr(0,12):r=Aie(e),t3(Eie(r.toUpperCase()))}function h0(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):ev(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Al(14,qB(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function jie(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Pie(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return vk[r.m-1][1];case 5:return vk[r.m-1][0];default:return vk[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return OF[r.q][0];default:return OF[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ic(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=ic(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?ic(c,u):"";return d}function mf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var YB=/%/g;function Fie(e,t,r){var n=t.replace(YB,""),s=t.length-n.length;return Ku(e,n,r*Math.pow(10,2*s))+Ds("%",s)}function Oie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ku(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function XB(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+XB(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var JB=/# (\?+)( ?)\/( ?)(\d+)/;function Die(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?Ds(" ",e[1].length+1+e[4].length):e3(i,e[1].length)+e[2]+"/"+e[3]+ic(o,e[4].length))}function Iie(e,t,r){return r+(t===0?"":""+t)+Ds(" ",e[1].length+2+e[4].length)}var QB=/^#*0*\.([0#]+)/,ZB=/\).*[0#]/,e$=/\(###\) ###\\?-####/;function Xi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function IF(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function RF(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Rie(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Mie(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function hl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?hl("n",n,r):"("+hl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Oie(e,t,r);if(t.indexOf("%")!==-1)return Fie(e,t,r);if(t.indexOf("E")!==-1)return XB(t,r);if(t.charCodeAt(0)===36)return"$"+hl(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ig(c,t.length);if(t.match(/^[#?]+$/))return s=Ig(r,0),s==="0"&&(s=""),s.length>t.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(JB))return Die(a,c,u);if(t.match(/^#+0+$/))return u+Ig(c,t.length-t.indexOf("0"));if(a=t.match(QB))return s=IF(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Xi(a[1])).replace(/\.$/,"."+Xi(a[1])).replace(/\.(\d*)$/,function(x,v){return"."+v+Ds("0",Xi(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+IF(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+mf(Ig(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+hl(e,t,-r):mf(""+(Math.floor(r)+Rie(r,a[1].length)))+"."+ic(RF(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return hl(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=um(hl(e,t.replace(/[\\-]/g,""),r)),i=0,um(um(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(e$))return s=hl(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=$_(c,Math.pow(10,i)-1,!1),s=""+u,d=Ku("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=L_(o[2],i),d.length<a[4].length&&(d=Xi(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=$_(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?e3(o[1],i)+a[2]+"/"+a[3]+L_(o[2],i):Ds(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Ig(r,0),t.length<=s.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,g=t.length-s.length-f;return Xi(t.substr(0,f)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=RF(r,a[1].length),r<0?"-"+hl(e,t,-r):mf(Mie(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ic(0,3-x.length):"")+x})+"."+ic(i,a[1].length);switch(t){case"###,##0.00":return hl(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=mf(Ig(c,0));return p!=="0"?u+p:"";case"###,###.00":return hl(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return hl(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Lie(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Ku(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Bie(e,t,r){var n=t.replace(YB,""),s=t.length-n.length;return Ku(e,n,r*Math.pow(10,2*s))+Ds("%",s)}function t$(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+t$(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Mc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(ZB)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Mc("n",n,r):"("+Mc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Lie(e,t,r);if(t.indexOf("%")!==-1)return Bie(e,t,r);if(t.indexOf("E")!==-1)return t$(t,r);if(t.charCodeAt(0)===36)return"$"+Mc(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+ic(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(JB))return Iie(a,c,u);if(t.match(/^#+0+$/))return u+ic(c,t.length-t.indexOf("0"));if(a=t.match(QB))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Xi(a[1])).replace(/\.$/,"."+Xi(a[1])),s=s.replace(/\.(\d*)$/,function(x,v){return"."+v+Ds("0",Xi(a[1]).length-v.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+mf(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Mc(e,t,-r):mf(""+r)+"."+Ds("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Mc(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=um(Mc(e,t.replace(/[\\-]/g,""),r)),i=0,um(um(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return i<s.length?s.charAt(i++):x==="0"?"0":""}));if(t.match(e$))return s=Mc(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=$_(c,Math.pow(10,i)-1,!1),s=""+u,d=Ku("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=L_(o[2],i),d.length<a[4].length&&(d=Xi(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=$_(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?e3(o[1],i)+a[2]+"/"+a[3]+L_(o[2],i):Ds(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Xi(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,g=t.length-s.length-f;return Xi(t.substr(0,f)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Mc(e,t,-r):mf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?ic(0,3-x.length):"")+x})+"."+ic(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=mf(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return Mc(e,t.slice(0,t.lastIndexOf(".")),r)+Xi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ku(e,t,r){return(r|0)===r?Mc(e,t,r):hl(e,t,r)}function $ie(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var r$=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Qm(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":B_(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(r$))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Uie(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,f,g="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!B_(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),x=p==="("||p===")"?p:"t";s[s.length]={t:x,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=Dh(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Dh(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var v={t:o,v:o};if(u==null&&(u=Dh(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(v.v=u.H>=12?"P":"A"),v.t="T",g="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(v.v=u.H>=12?"PM":"AM"),v.t="T",i+=5,g="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(v.v=u.H>=12?"":""),v.t="T",i+=5,g="h"):(v.t="t",++i),u==null&&v.t==="T")return"";s[s.length]=v,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(r$)){if(u==null&&(u=Dh(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",Qm(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var w=0,C=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=g,c="h",w<1&&(w=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(C=Math.max(C,k[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&s[i].v.match(/[Hh]/)&&(w=1),w<2&&s[i].v.match(/[Mm]/)&&(w=2),w<3&&s[i].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Pie(s[i].t.charCodeAt(0),s[i].v,u,C),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;_+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=h0(t,r);break}var E="",P,F;if(_.length>0){_.charCodeAt(0)==40?(P=t<0&&_.charCodeAt(0)===45?-t:t,F=Ku("n",_,P)):(P=t<0&&n>1?-t:t,F=Ku("n",_,P),P<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),N=F.length-1;var A=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){A=i;break}var j=s.length;if(A===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=F.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=F.substr(0,N+1),N=-1),s[i].t="t",j=i);N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v)}else if(A!==s.length&&F.indexOf("E")===-1){for(N=F.indexOf(".")-1,i=A;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(d+1);d>=0;--d)N>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(E=F.charAt(N--)+E);s[i].v=E,s[i].t="t",j=i}for(N>=0&&j<s.length&&(s[j].v=F.substr(0,N+1)+s[j].v),N=F.indexOf(".")+1,i=A;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==A)){for(d=s[i].v.indexOf(".")>-1&&i===A?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,d);d<s[i].v.length;++d)N<F.length&&(E+=F.charAt(N++));s[i].v=E,s[i].t="t",j=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Ku(s[i].t,s[i].v,P),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var MF=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function LF(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function zie(e,t){var r=$ie(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(MF),o=r[1].match(MF);return LF(t,i)?[n,r[0]]:LF(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Al(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Fr)[e],n==null&&(n=r.table&&r.table[DF[e]]||Fr[DF[e]]),n==null&&(n=kie[e]||"General");break}if(B_(n,0))return h0(t,r);t instanceof Date&&(t=qB(t,r.date1904));var s=zie(n,t);if(B_(s[1]))return h0(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Uie(s[1],t,r,s[0])}function qu(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Fr[r]==null){t<0&&(t=r);continue}if(Fr[r]==e){t=r;break}}t<0&&(t=391)}return Fr[t]=e,t}function a2(e){for(var t=0;t!=392;++t)e[t]!==void 0&&qu(e[t],t)}function Zm(){Fr=Sie()}var Wie={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},n$=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Hie(e){var t=typeof e=="number"?Fr[e]:e;return t=t.replace(n$,"(\\d+)"),new RegExp("^"+t+"$")}function Gie(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(n$)||[]).forEach(function(f,g){var p=parseInt(r[g+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var Vie=(function(){var e={};e.version="1.2.0";function t(){for(var F=0,A=new Array(256),j=0;j!=256;++j)F=j,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,A[j]=F;return typeof Int32Array<"u"?new Int32Array(A):A}var r=t();function n(F){var A=0,j=0,I=0,L=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)L[I]=F[I];for(I=0;I!=256;++I)for(j=F[I],A=256+I;A<4096;A+=256)j=L[A]=j>>>8^F[j&255];var Y=[];for(I=1;I!=16;++I)Y[I-1]=typeof Int32Array<"u"?L.subarray(I*256,I*256+256):L.slice(I*256,I*256+256);return Y}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],f=s[6],g=s[7],p=s[8],x=s[9],v=s[10],w=s[11],C=s[12],k=s[13],_=s[14];function N(F,A){for(var j=A^-1,I=0,L=F.length;I<L;)j=j>>>8^r[(j^F.charCodeAt(I++))&255];return~j}function E(F,A){for(var j=A^-1,I=F.length-15,L=0;L<I;)j=_[F[L++]^j&255]^k[F[L++]^j>>8&255]^C[F[L++]^j>>16&255]^w[F[L++]^j>>>24]^v[F[L++]]^x[F[L++]]^p[F[L++]]^g[F[L++]]^f[F[L++]]^d[F[L++]]^u[F[L++]]^c[F[L++]]^o[F[L++]]^i[F[L++]]^a[F[L++]]^r[F[L++]];for(I+=15;L<I;)j=j>>>8^r[(j^F[L++])&255];return~j}function P(F,A){for(var j=A^-1,I=0,L=F.length,Y=0,Z=0;I<L;)Y=F.charCodeAt(I++),Y<128?j=j>>>8^r[(j^Y)&255]:Y<2048?(j=j>>>8^r[(j^(192|Y>>6&31))&255],j=j>>>8^r[(j^(128|Y&63))&255]):Y>=55296&&Y<57344?(Y=(Y&1023)+64,Z=F.charCodeAt(I++)&1023,j=j>>>8^r[(j^(240|Y>>8&7))&255],j=j>>>8^r[(j^(128|Y>>2&63))&255],j=j>>>8^r[(j^(128|Z>>6&15|(Y&3)<<4))&255],j=j>>>8^r[(j^(128|Z&63))&255]):(j=j>>>8^r[(j^(224|Y>>12&15))&255],j=j>>>8^r[(j^(128|Y>>6&63))&255],j=j>>>8^r[(j^(128|Y&63))&255]);return~j}return e.table=r,e.bstr=N,e.buf=E,e.str=P,e})(),Er=(function(){var t={};t.version="1.2.1";function r(ue,we){for(var ye=ue.split("/"),xe=we.split("/"),_e=0,Se=0,Ve=Math.min(ye.length,xe.length);_e<Ve;++_e){if(Se=ye[_e].length-xe[_e].length)return Se;if(ye[_e]!=xe[_e])return ye[_e]<xe[_e]?-1:1}return ye.length-xe.length}function n(ue){if(ue.charAt(ue.length-1)=="/")return ue.slice(0,-1).indexOf("/")===-1?ue:n(ue.slice(0,-1));var we=ue.lastIndexOf("/");return we===-1?ue:ue.slice(0,we+1)}function s(ue){if(ue.charAt(ue.length-1)=="/")return s(ue.slice(0,-1));var we=ue.lastIndexOf("/");return we===-1?ue:ue.slice(we+1)}function a(ue,we){typeof we=="string"&&(we=new Date(we));var ye=we.getHours();ye=ye<<6|we.getMinutes(),ye=ye<<5|we.getSeconds()>>>1,ue.write_shift(2,ye);var xe=we.getFullYear()-1980;xe=xe<<4|we.getMonth()+1,xe=xe<<5|we.getDate(),ue.write_shift(2,xe)}function i(ue){var we=ue.read_shift(2)&65535,ye=ue.read_shift(2)&65535,xe=new Date,_e=ye&31;ye>>>=5;var Se=ye&15;ye>>>=4,xe.setMilliseconds(0),xe.setFullYear(ye+1980),xe.setMonth(Se-1),xe.setDate(_e);var Ve=we&31;we>>>=5;var lt=we&63;return we>>>=6,xe.setHours(we),xe.setMinutes(lt),xe.setSeconds(Ve<<1),xe}function o(ue){oi(ue,0);for(var we={},ye=0;ue.l<=ue.length-4;){var xe=ue.read_shift(2),_e=ue.read_shift(2),Se=ue.l+_e,Ve={};switch(xe){case 21589:ye=ue.read_shift(1),ye&1&&(Ve.mtime=ue.read_shift(4)),_e>5&&(ye&2&&(Ve.atime=ue.read_shift(4)),ye&4&&(Ve.ctime=ue.read_shift(4))),Ve.mtime&&(Ve.mt=new Date(Ve.mtime*1e3));break}ue.l=Se,we[xe]=Ve}return we}var c;function u(){return c||(c={})}function d(ue,we){if(ue[0]==80&&ue[1]==75)return ge(ue,we);if((ue[0]|32)==109&&(ue[1]|32)==105)return Ue(ue,we);if(ue.length<512)throw new Error("CFB file size "+ue.length+" < 512");var ye=3,xe=512,_e=0,Se=0,Ve=0,lt=0,Ke=0,oe=[],fe=ue.slice(0,512);oi(fe,0);var Ee=f(fe);switch(ye=Ee[0],ye){case 3:xe=512;break;case 4:xe=4096;break;case 0:if(Ee[1]==0)return ge(ue,we);default:throw new Error("Major Version: Expected 3 or 4 saw "+ye)}xe!==512&&(fe=ue.slice(0,xe),oi(fe,28));var Ne=ue.slice(0,xe);g(fe,ye);var Ye=fe.read_shift(4,"i");if(ye===3&&Ye!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ye);fe.l+=4,Ve=fe.read_shift(4,"i"),fe.l+=4,fe.chk("00100000","Mini Stream Cutoff Size: "),lt=fe.read_shift(4,"i"),_e=fe.read_shift(4,"i"),Ke=fe.read_shift(4,"i"),Se=fe.read_shift(4,"i");for(var ot=-1,pt=0;pt<109&&(ot=fe.read_shift(4,"i"),!(ot<0));++pt)oe[pt]=ot;var Gt=p(ue,xe);w(Ke,Se,Gt,xe,oe);var xt=k(Gt,Ve,oe,xe);xt[Ve].name="!Directory",_e>0&&lt!==Z&&(xt[lt].name="!MiniFAT"),xt[oe[0]].name="!FAT",xt.fat_addrs=oe,xt.ssz=xe;var Jt={},wr=[],Sr=[],xr=[];_(Ve,xt,Gt,wr,_e,Jt,Sr,lt),x(Sr,xr,wr),wr.shift();var Ir={FileIndex:Sr,FullPaths:xr};return we&&we.raw&&(Ir.raw={header:Ne,sectors:Gt}),Ir}function f(ue){if(ue[ue.l]==80&&ue[ue.l+1]==75)return[0,0];ue.chk(ae,"Header Signature: "),ue.l+=16;var we=ue.read_shift(2,"u");return[ue.read_shift(2,"u"),we]}function g(ue,we){var ye=9;switch(ue.l+=2,ye=ue.read_shift(2)){case 9:if(we!=3)throw new Error("Sector Shift: Expected 9 saw "+ye);break;case 12:if(we!=4)throw new Error("Sector Shift: Expected 12 saw "+ye);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ye)}ue.chk("0600","Mini Sector Shift: "),ue.chk("000000000000","Reserved: ")}function p(ue,we){for(var ye=Math.ceil(ue.length/we)-1,xe=[],_e=1;_e<ye;++_e)xe[_e-1]=ue.slice(_e*we,(_e+1)*we);return xe[ye-1]=ue.slice(ye*we),xe}function x(ue,we,ye){for(var xe=0,_e=0,Se=0,Ve=0,lt=0,Ke=ye.length,oe=[],fe=[];xe<Ke;++xe)oe[xe]=fe[xe]=xe,we[xe]=ye[xe];for(;lt<fe.length;++lt)xe=fe[lt],_e=ue[xe].L,Se=ue[xe].R,Ve=ue[xe].C,oe[xe]===xe&&(_e!==-1&&oe[_e]!==_e&&(oe[xe]=oe[_e]),Se!==-1&&oe[Se]!==Se&&(oe[xe]=oe[Se])),Ve!==-1&&(oe[Ve]=xe),_e!==-1&&xe!=oe[xe]&&(oe[_e]=oe[xe],fe.lastIndexOf(_e)<lt&&fe.push(_e)),Se!==-1&&xe!=oe[xe]&&(oe[Se]=oe[xe],fe.lastIndexOf(Se)<lt&&fe.push(Se));for(xe=1;xe<Ke;++xe)oe[xe]===xe&&(Se!==-1&&oe[Se]!==Se?oe[xe]=oe[Se]:_e!==-1&&oe[_e]!==_e&&(oe[xe]=oe[_e]));for(xe=1;xe<Ke;++xe)if(ue[xe].type!==0){if(lt=xe,lt!=oe[lt])do lt=oe[lt],we[xe]=we[lt]+"/"+we[xe];while(lt!==0&&oe[lt]!==-1&&lt!=oe[lt]);oe[xe]=-1}for(we[0]+="/",xe=1;xe<Ke;++xe)ue[xe].type!==2&&(we[xe]+="/")}function v(ue,we,ye){for(var xe=ue.start,_e=ue.size,Se=[],Ve=xe;ye&&_e>0&&Ve>=0;)Se.push(we.slice(Ve*Y,Ve*Y+Y)),_e-=Y,Ve=jh(ye,Ve*4);return Se.length===0?_t(0):Ba(Se).slice(0,ue.size)}function w(ue,we,ye,xe,_e){var Se=Z;if(ue===Z){if(we!==0)throw new Error("DIFAT chain shorter than expected")}else if(ue!==-1){var Ve=ye[ue],lt=(xe>>>2)-1;if(!Ve)return;for(var Ke=0;Ke<lt&&(Se=jh(Ve,Ke*4))!==Z;++Ke)_e.push(Se);w(jh(Ve,xe-4),we-1,ye,xe,_e)}}function C(ue,we,ye,xe,_e){var Se=[],Ve=[];_e||(_e=[]);var lt=xe-1,Ke=0,oe=0;for(Ke=we;Ke>=0;){_e[Ke]=!0,Se[Se.length]=Ke,Ve.push(ue[Ke]);var fe=ye[Math.floor(Ke*4/xe)];if(oe=Ke*4&lt,xe<4+oe)throw new Error("FAT boundary crossed: "+Ke+" 4 "+xe);if(!ue[fe])break;Ke=jh(ue[fe],oe)}return{nodes:Se,data:XF([Ve])}}function k(ue,we,ye,xe){var _e=ue.length,Se=[],Ve=[],lt=[],Ke=[],oe=xe-1,fe=0,Ee=0,Ne=0,Ye=0;for(fe=0;fe<_e;++fe)if(lt=[],Ne=fe+we,Ne>=_e&&(Ne-=_e),!Ve[Ne]){Ke=[];var ot=[];for(Ee=Ne;Ee>=0;){ot[Ee]=!0,Ve[Ee]=!0,lt[lt.length]=Ee,Ke.push(ue[Ee]);var pt=ye[Math.floor(Ee*4/xe)];if(Ye=Ee*4&oe,xe<4+Ye)throw new Error("FAT boundary crossed: "+Ee+" 4 "+xe);if(!ue[pt]||(Ee=jh(ue[pt],Ye),ot[Ee]))break}Se[Ne]={nodes:lt,data:XF([Ke])}}return Se}function _(ue,we,ye,xe,_e,Se,Ve,lt){for(var Ke=0,oe=xe.length?2:0,fe=we[ue].data,Ee=0,Ne=0,Ye;Ee<fe.length;Ee+=128){var ot=fe.slice(Ee,Ee+128);oi(ot,64),Ne=ot.read_shift(2),Ye=l3(ot,0,Ne-oe),xe.push(Ye);var pt={name:Ye,type:ot.read_shift(1),color:ot.read_shift(1),L:ot.read_shift(4,"i"),R:ot.read_shift(4,"i"),C:ot.read_shift(4,"i"),clsid:ot.read_shift(16),state:ot.read_shift(4,"i"),start:0,size:0},Gt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);Gt!==0&&(pt.ct=N(ot,ot.l-8));var xt=ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2)+ot.read_shift(2);xt!==0&&(pt.mt=N(ot,ot.l-8)),pt.start=ot.read_shift(4,"i"),pt.size=ot.read_shift(4,"i"),pt.size<0&&pt.start<0&&(pt.size=pt.type=0,pt.start=Z,pt.name=""),pt.type===5?(Ke=pt.start,_e>0&&Ke!==Z&&(we[Ke].name="!StreamData")):pt.size>=4096?(pt.storage="fat",we[pt.start]===void 0&&(we[pt.start]=C(ye,pt.start,we.fat_addrs,we.ssz)),we[pt.start].name=pt.name,pt.content=we[pt.start].data.slice(0,pt.size)):(pt.storage="minifat",pt.size<0?pt.size=0:Ke!==Z&&pt.start!==Z&&we[Ke]&&(pt.content=v(pt,we[Ke].data,(we[lt]||{}).data))),pt.content&&oi(pt.content,0),Se[Ye]=pt,Ve.push(pt)}}function N(ue,we){return new Date((zo(ue,we+4)/1e7*Math.pow(2,32)+zo(ue,we)/1e7-11644473600)*1e3)}function E(ue,we){return u(),d(c.readFileSync(ue),we)}function P(ue,we){var ye=we&&we.type;switch(ye||en&&Buffer.isBuffer(ue)&&(ye="buffer"),ye||"base64"){case"file":return E(ue,we);case"base64":return d(Ho(Yo(ue)),we);case"binary":return d(Ho(ue),we)}return d(ue,we)}function F(ue,we){var ye=we||{},xe=ye.root||"Root Entry";if(ue.FullPaths||(ue.FullPaths=[]),ue.FileIndex||(ue.FileIndex=[]),ue.FullPaths.length!==ue.FileIndex.length)throw new Error("inconsistent CFB structure");ue.FullPaths.length===0&&(ue.FullPaths[0]=xe+"/",ue.FileIndex[0]={name:xe,type:5}),ye.CLSID&&(ue.FileIndex[0].clsid=ye.CLSID),A(ue)}function A(ue){var we="Sh33tJ5";if(!Er.find(ue,"/"+we)){var ye=_t(4);ye[0]=55,ye[1]=ye[3]=50,ye[2]=54,ue.FileIndex.push({name:we,type:2,content:ye,size:4,L:69,R:69,C:69}),ue.FullPaths.push(ue.FullPaths[0]+we),j(ue)}}function j(ue,we){F(ue);for(var ye=!1,xe=!1,_e=ue.FullPaths.length-1;_e>=0;--_e){var Se=ue.FileIndex[_e];switch(Se.type){case 0:xe?ye=!0:(ue.FileIndex.pop(),ue.FullPaths.pop());break;case 1:case 2:case 5:xe=!0,isNaN(Se.R*Se.L*Se.C)&&(ye=!0),Se.R>-1&&Se.L>-1&&Se.R==Se.L&&(ye=!0);break;default:ye=!0;break}}if(!(!ye&&!we)){var Ve=new Date(1987,1,19),lt=0,Ke=Object.create?Object.create(null):{},oe=[];for(_e=0;_e<ue.FullPaths.length;++_e)Ke[ue.FullPaths[_e]]=!0,ue.FileIndex[_e].type!==0&&oe.push([ue.FullPaths[_e],ue.FileIndex[_e]]);for(_e=0;_e<oe.length;++_e){var fe=n(oe[_e][0]);xe=Ke[fe],xe||(oe.push([fe,{name:s(fe).replace("/",""),type:1,clsid:ne,ct:Ve,mt:Ve,content:null}]),Ke[fe]=!0)}for(oe.sort(function(Ye,ot){return r(Ye[0],ot[0])}),ue.FullPaths=[],ue.FileIndex=[],_e=0;_e<oe.length;++_e)ue.FullPaths[_e]=oe[_e][0],ue.FileIndex[_e]=oe[_e][1];for(_e=0;_e<oe.length;++_e){var Ee=ue.FileIndex[_e],Ne=ue.FullPaths[_e];if(Ee.name=s(Ne).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||ne,_e===0)Ee.C=oe.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Ne.slice(-1)=="/"){for(lt=_e+1;lt<oe.length&&n(ue.FullPaths[lt])!=Ne;++lt);for(Ee.C=lt>=oe.length?-1:lt,lt=_e+1;lt<oe.length&&n(ue.FullPaths[lt])!=n(Ne);++lt);Ee.R=lt>=oe.length?-1:lt,Ee.type=1}else n(ue.FullPaths[_e+1]||"")==n(Ne)&&(Ee.R=_e+1),Ee.type=2}}}function I(ue,we){var ye=we||{};if(ye.fileType=="mad")return Et(ue,ye);switch(j(ue),ye.fileType){case"zip":return Fe(ue,ye)}var xe=(function(Ye){for(var ot=0,pt=0,Gt=0;Gt<Ye.FileIndex.length;++Gt){var xt=Ye.FileIndex[Gt];if(xt.content){var Jt=xt.content.length;Jt>0&&(Jt<4096?ot+=Jt+63>>6:pt+=Jt+511>>9)}}for(var wr=Ye.FullPaths.length+3>>2,Sr=ot+7>>3,xr=ot+127>>7,Ir=Sr+pt+wr+xr,rn=Ir+127>>7,Jr=rn<=109?0:Math.ceil((rn-109)/127);Ir+rn+Jr+127>>7>rn;)Jr=++rn<=109?0:Math.ceil((rn-109)/127);var he=[1,Jr,rn,xr,wr,pt,ot,0];return Ye.FileIndex[0].size=ot<<6,he[7]=(Ye.FileIndex[0].start=he[0]+he[1]+he[2]+he[3]+he[4]+he[5])+(he[6]+7>>3),he})(ue),_e=_t(xe[7]<<9),Se=0,Ve=0;{for(Se=0;Se<8;++Se)_e.write_shift(1,ee[Se]);for(Se=0;Se<8;++Se)_e.write_shift(2,0);for(_e.write_shift(2,62),_e.write_shift(2,3),_e.write_shift(2,65534),_e.write_shift(2,9),_e.write_shift(2,6),Se=0;Se<3;++Se)_e.write_shift(2,0);for(_e.write_shift(4,0),_e.write_shift(4,xe[2]),_e.write_shift(4,xe[0]+xe[1]+xe[2]+xe[3]-1),_e.write_shift(4,0),_e.write_shift(4,4096),_e.write_shift(4,xe[3]?xe[0]+xe[1]+xe[2]-1:Z),_e.write_shift(4,xe[3]),_e.write_shift(-4,xe[1]?xe[0]-1:Z),_e.write_shift(4,xe[1]),Se=0;Se<109;++Se)_e.write_shift(-4,Se<xe[2]?xe[1]+Se:-1)}if(xe[1])for(Ve=0;Ve<xe[1];++Ve){for(;Se<236+Ve*127;++Se)_e.write_shift(-4,Se<xe[2]?xe[1]+Se:-1);_e.write_shift(-4,Ve===xe[1]-1?Z:Ve+1)}var lt=function(Ye){for(Ve+=Ye;Se<Ve-1;++Se)_e.write_shift(-4,Se+1);Ye&&(++Se,_e.write_shift(-4,Z))};for(Ve=Se=0,Ve+=xe[1];Se<Ve;++Se)_e.write_shift(-4,B.DIFSECT);for(Ve+=xe[2];Se<Ve;++Se)_e.write_shift(-4,B.FATSECT);lt(xe[3]),lt(xe[4]);for(var Ke=0,oe=0,fe=ue.FileIndex[0];Ke<ue.FileIndex.length;++Ke)fe=ue.FileIndex[Ke],fe.content&&(oe=fe.content.length,!(oe<4096)&&(fe.start=Ve,lt(oe+511>>9)));for(lt(xe[6]+7>>3);_e.l&511;)_e.write_shift(-4,B.ENDOFCHAIN);for(Ve=Se=0,Ke=0;Ke<ue.FileIndex.length;++Ke)fe=ue.FileIndex[Ke],fe.content&&(oe=fe.content.length,!(!oe||oe>=4096)&&(fe.start=Ve,lt(oe+63>>6)));for(;_e.l&511;)_e.write_shift(-4,B.ENDOFCHAIN);for(Se=0;Se<xe[4]<<2;++Se){var Ee=ue.FullPaths[Se];if(!Ee||Ee.length===0){for(Ke=0;Ke<17;++Ke)_e.write_shift(4,0);for(Ke=0;Ke<3;++Ke)_e.write_shift(4,-1);for(Ke=0;Ke<12;++Ke)_e.write_shift(4,0);continue}fe=ue.FileIndex[Se],Se===0&&(fe.start=fe.size?fe.start-1:Z);var Ne=Se===0&&ye.root||fe.name;if(oe=2*(Ne.length+1),_e.write_shift(64,Ne,"utf16le"),_e.write_shift(2,oe),_e.write_shift(1,fe.type),_e.write_shift(1,fe.color),_e.write_shift(-4,fe.L),_e.write_shift(-4,fe.R),_e.write_shift(-4,fe.C),fe.clsid)_e.write_shift(16,fe.clsid,"hex");else for(Ke=0;Ke<4;++Ke)_e.write_shift(4,0);_e.write_shift(4,fe.state||0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,0),_e.write_shift(4,fe.start),_e.write_shift(4,fe.size),_e.write_shift(4,0)}for(Se=1;Se<ue.FileIndex.length;++Se)if(fe=ue.FileIndex[Se],fe.size>=4096)if(_e.l=fe.start+1<<9,en&&Buffer.isBuffer(fe.content))fe.content.copy(_e,_e.l,0,fe.size),_e.l+=fe.size+511&-512;else{for(Ke=0;Ke<fe.size;++Ke)_e.write_shift(1,fe.content[Ke]);for(;Ke&511;++Ke)_e.write_shift(1,0)}for(Se=1;Se<ue.FileIndex.length;++Se)if(fe=ue.FileIndex[Se],fe.size>0&&fe.size<4096)if(en&&Buffer.isBuffer(fe.content))fe.content.copy(_e,_e.l,0,fe.size),_e.l+=fe.size+63&-64;else{for(Ke=0;Ke<fe.size;++Ke)_e.write_shift(1,fe.content[Ke]);for(;Ke&63;++Ke)_e.write_shift(1,0)}if(en)_e.l=_e.length;else for(;_e.l<_e.length;)_e.write_shift(1,0);return _e}function L(ue,we){var ye=ue.FullPaths.map(function(Ke){return Ke.toUpperCase()}),xe=ye.map(function(Ke){var oe=Ke.split("/");return oe[oe.length-(Ke.slice(-1)=="/"?2:1)]}),_e=!1;we.charCodeAt(0)===47?(_e=!0,we=ye[0].slice(0,-1)+we):_e=we.indexOf("/")!==-1;var Se=we.toUpperCase(),Ve=_e===!0?ye.indexOf(Se):xe.indexOf(Se);if(Ve!==-1)return ue.FileIndex[Ve];var lt=!Se.match(uy);for(Se=Se.replace(no,""),lt&&(Se=Se.replace(uy,"!")),Ve=0;Ve<ye.length;++Ve)if((lt?ye[Ve].replace(uy,"!"):ye[Ve]).replace(no,"")==Se||(lt?xe[Ve].replace(uy,"!"):xe[Ve]).replace(no,"")==Se)return ue.FileIndex[Ve];return null}var Y=64,Z=-2,ae="d0cf11e0a1b11ae1",ee=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:ae,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function V(ue,we,ye){u();var xe=I(ue,ye);c.writeFileSync(we,xe)}function M(ue){for(var we=new Array(ue.length),ye=0;ye<ue.length;++ye)we[ye]=String.fromCharCode(ue[ye]);return we.join("")}function H(ue,we){var ye=I(ue,we);switch(we&&we.type||"buffer"){case"file":return u(),c.writeFileSync(we.filename,ye),ye;case"binary":return typeof ye=="string"?ye:M(ye);case"base64":return Zy(typeof ye=="string"?ye:M(ye));case"buffer":if(en)return Buffer.isBuffer(ye)?ye:ud(ye);case"array":return typeof ye=="string"?Ho(ye):ye}return ye}var W;function R(ue){try{var we=ue.InflateRaw,ye=new we;if(ye._processChunk(new Uint8Array([3,0]),ye._finishFlushFlag),ye.bytesRead)W=ue;else throw new Error("zlib does not expose bytesRead")}catch(xe){console.error("cannot use native zlib: "+(xe.message||xe))}}function z(ue,we){if(!W)return dr(ue,we);var ye=W.InflateRaw,xe=new ye,_e=xe._processChunk(ue.slice(ue.l),xe._finishFlushFlag);return ue.l+=xe.bytesRead,_e}function K(ue){return W?W.deflateRawSync(ue):qe(ue)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(ue){var we=(ue<<1|ue<<11)&139536|(ue<<5|ue<<15)&558144;return(we>>16|we>>8|we)&255}for(var le=typeof Uint8Array<"u",ce=le?new Uint8Array(256):[],be=0;be<256;++be)ce[be]=ie(be);function re(ue,we){var ye=ce[ue&255];return we<=8?ye>>>8-we:(ye=ye<<8|ce[ue>>8&255],we<=16?ye>>>16-we:(ye=ye<<8|ce[ue>>16&255],ye>>>24-we))}function pe(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=6?0:ue[xe+1]<<8))>>>ye&3}function Ce(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=5?0:ue[xe+1]<<8))>>>ye&7}function Ae(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=4?0:ue[xe+1]<<8))>>>ye&15}function We(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=3?0:ue[xe+1]<<8))>>>ye&31}function Le(ue,we){var ye=we&7,xe=we>>>3;return(ue[xe]|(ye<=1?0:ue[xe+1]<<8))>>>ye&127}function At(ue,we,ye){var xe=we&7,_e=we>>>3,Se=(1<<ye)-1,Ve=ue[_e]>>>xe;return ye<8-xe||(Ve|=ue[_e+1]<<8-xe,ye<16-xe)||(Ve|=ue[_e+2]<<16-xe,ye<24-xe)||(Ve|=ue[_e+3]<<24-xe),Ve&Se}function Qe(ue,we,ye){var xe=we&7,_e=we>>>3;return xe<=5?ue[_e]|=(ye&7)<<xe:(ue[_e]|=ye<<xe&255,ue[_e+1]=(ye&7)>>8-xe),we+3}function gt(ue,we,ye){var xe=we&7,_e=we>>>3;return ye=(ye&1)<<xe,ue[_e]|=ye,we+1}function ht(ue,we,ye){var xe=we&7,_e=we>>>3;return ye<<=xe,ue[_e]|=ye&255,ye>>>=8,ue[_e+1]=ye,we+8}function tt(ue,we,ye){var xe=we&7,_e=we>>>3;return ye<<=xe,ue[_e]|=ye&255,ye>>>=8,ue[_e+1]=ye&255,ue[_e+2]=ye>>>8,we+16}function ut(ue,we){var ye=ue.length,xe=2*ye>we?2*ye:we+5,_e=0;if(ye>=we)return ue;if(en){var Se=PF(xe);if(ue.copy)ue.copy(Se);else for(;_e<ue.length;++_e)Se[_e]=ue[_e];return Se}else if(le){var Ve=new Uint8Array(xe);if(Ve.set)Ve.set(ue);else for(;_e<ye;++_e)Ve[_e]=ue[_e];return Ve}return ue.length=xe,ue}function Dt(ue){for(var we=new Array(ue),ye=0;ye<ue;++ye)we[ye]=0;return we}function Rt(ue,we,ye){var xe=1,_e=0,Se=0,Ve=0,lt=0,Ke=ue.length,oe=le?new Uint16Array(32):Dt(32);for(Se=0;Se<32;++Se)oe[Se]=0;for(Se=Ke;Se<ye;++Se)ue[Se]=0;Ke=ue.length;var fe=le?new Uint16Array(Ke):Dt(Ke);for(Se=0;Se<Ke;++Se)oe[_e=ue[Se]]++,xe<_e&&(xe=_e),fe[Se]=0;for(oe[0]=0,Se=1;Se<=xe;++Se)oe[Se+16]=lt=lt+oe[Se-1]<<1;for(Se=0;Se<Ke;++Se)lt=ue[Se],lt!=0&&(fe[Se]=oe[lt+16]++);var Ee=0;for(Se=0;Se<Ke;++Se)if(Ee=ue[Se],Ee!=0)for(lt=re(fe[Se],xe)>>xe-Ee,Ve=(1<<xe+4-Ee)-1;Ve>=0;--Ve)we[lt|Ve<<Ee]=Ee&15|Se<<4;return xe}var It=le?new Uint16Array(512):Dt(512),De=le?new Uint16Array(32):Dt(32);if(!le){for(var Ie=0;Ie<512;++Ie)It[Ie]=0;for(Ie=0;Ie<32;++Ie)De[Ie]=0}(function(){for(var ue=[],we=0;we<32;we++)ue.push(5);Rt(ue,De,32);var ye=[];for(we=0;we<=143;we++)ye.push(8);for(;we<=255;we++)ye.push(9);for(;we<=279;we++)ye.push(7);for(;we<=287;we++)ye.push(8);Rt(ye,It,288)})();var Je=(function(){for(var we=le?new Uint8Array(32768):[],ye=0,xe=0;ye<X.length-1;++ye)for(;xe<X[ye+1];++xe)we[xe]=ye;for(;xe<32768;++xe)we[xe]=29;var _e=le?new Uint8Array(259):[];for(ye=0,xe=0;ye<se.length-1;++ye)for(;xe<se[ye+1];++xe)_e[xe]=ye;function Se(lt,Ke){for(var oe=0;oe<lt.length;){var fe=Math.min(65535,lt.length-oe),Ee=oe+fe==lt.length;for(Ke.write_shift(1,+Ee),Ke.write_shift(2,fe),Ke.write_shift(2,~fe&65535);fe-- >0;)Ke[Ke.l++]=lt[oe++]}return Ke.l}function Ve(lt,Ke){for(var oe=0,fe=0,Ee=le?new Uint16Array(32768):[];fe<lt.length;){var Ne=Math.min(65535,lt.length-fe);if(Ne<10){for(oe=Qe(Ke,oe,+(fe+Ne==lt.length)),oe&7&&(oe+=8-(oe&7)),Ke.l=oe/8|0,Ke.write_shift(2,Ne),Ke.write_shift(2,~Ne&65535);Ne-- >0;)Ke[Ke.l++]=lt[fe++];oe=Ke.l*8;continue}oe=Qe(Ke,oe,+(fe+Ne==lt.length)+2);for(var Ye=0;Ne-- >0;){var ot=lt[fe];Ye=(Ye<<5^ot)&32767;var pt=-1,Gt=0;if((pt=Ee[Ye])&&(pt|=fe&-32768,pt>fe&&(pt-=32768),pt<fe))for(;lt[pt+Gt]==lt[fe+Gt]&&Gt<250;)++Gt;if(Gt>2){ot=_e[Gt],ot<=22?oe=ht(Ke,oe,ce[ot+1]>>1)-1:(ht(Ke,oe,3),oe+=5,ht(Ke,oe,ce[ot-23]>>5),oe+=3);var xt=ot<8?0:ot-4>>2;xt>0&&(tt(Ke,oe,Gt-se[ot]),oe+=xt),ot=we[fe-pt],oe=ht(Ke,oe,ce[ot]>>3),oe-=3;var Jt=ot<4?0:ot-2>>1;Jt>0&&(tt(Ke,oe,fe-pt-X[ot]),oe+=Jt);for(var wr=0;wr<Gt;++wr)Ee[Ye]=fe&32767,Ye=(Ye<<5^lt[fe])&32767,++fe;Ne-=Gt-1}else ot<=143?ot=ot+48:oe=gt(Ke,oe,1),oe=ht(Ke,oe,ce[ot]),Ee[Ye]=fe&32767,++fe}oe=ht(Ke,oe,0)-1}return Ke.l=(oe+7)/8|0,Ke.l}return function(Ke,oe){return Ke.length<8?Se(Ke,oe):Ve(Ke,oe)}})();function qe(ue){var we=_t(50+Math.floor(ue.length*1.1)),ye=Je(ue,we);return we.slice(0,ye)}var Ze=le?new Uint16Array(32768):Dt(32768),Tt=le?new Uint16Array(32768):Dt(32768),Nt=le?new Uint16Array(128):Dt(128),$t=1,ir=1;function pr(ue,we){var ye=We(ue,we)+257;we+=5;var xe=We(ue,we)+1;we+=5;var _e=Ae(ue,we)+4;we+=4;for(var Se=0,Ve=le?new Uint8Array(19):Dt(19),lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ke=1,oe=le?new Uint8Array(8):Dt(8),fe=le?new Uint8Array(8):Dt(8),Ee=Ve.length,Ne=0;Ne<_e;++Ne)Ve[J[Ne]]=Se=Ce(ue,we),Ke<Se&&(Ke=Se),oe[Se]++,we+=3;var Ye=0;for(oe[0]=0,Ne=1;Ne<=Ke;++Ne)fe[Ne]=Ye=Ye+oe[Ne-1]<<1;for(Ne=0;Ne<Ee;++Ne)(Ye=Ve[Ne])!=0&&(lt[Ne]=fe[Ye]++);var ot=0;for(Ne=0;Ne<Ee;++Ne)if(ot=Ve[Ne],ot!=0){Ye=ce[lt[Ne]]>>8-ot;for(var pt=(1<<7-ot)-1;pt>=0;--pt)Nt[Ye|pt<<ot]=ot&7|Ne<<3}var Gt=[];for(Ke=1;Gt.length<ye+xe;)switch(Ye=Nt[Le(ue,we)],we+=Ye&7,Ye>>>=3){case 16:for(Se=3+pe(ue,we),we+=2,Ye=Gt[Gt.length-1];Se-- >0;)Gt.push(Ye);break;case 17:for(Se=3+Ce(ue,we),we+=3;Se-- >0;)Gt.push(0);break;case 18:for(Se=11+Le(ue,we),we+=7;Se-- >0;)Gt.push(0);break;default:Gt.push(Ye),Ke<Ye&&(Ke=Ye);break}var xt=Gt.slice(0,ye),Jt=Gt.slice(ye);for(Ne=ye;Ne<286;++Ne)xt[Ne]=0;for(Ne=xe;Ne<30;++Ne)Jt[Ne]=0;return $t=Rt(xt,Ze,286),ir=Rt(Jt,Tt,30),we}function Nr(ue,we){if(ue[0]==3&&!(ue[1]&3))return[Tf(we),2];for(var ye=0,xe=0,_e=PF(we||1<<18),Se=0,Ve=_e.length>>>0,lt=0,Ke=0;(xe&1)==0;){if(xe=Ce(ue,ye),ye+=3,xe>>>1)xe>>1==1?(lt=9,Ke=5):(ye=pr(ue,ye),lt=$t,Ke=ir);else{ye&7&&(ye+=8-(ye&7));var oe=ue[ye>>>3]|ue[(ye>>>3)+1]<<8;if(ye+=32,oe>0)for(!we&&Ve<Se+oe&&(_e=ut(_e,Se+oe),Ve=_e.length);oe-- >0;)_e[Se++]=ue[ye>>>3],ye+=8;continue}for(;;){!we&&Ve<Se+32767&&(_e=ut(_e,Se+32767),Ve=_e.length);var fe=At(ue,ye,lt),Ee=xe>>>1==1?It[fe]:Ze[fe];if(ye+=Ee&15,Ee>>>=4,(Ee>>>8&255)===0)_e[Se++]=Ee;else{if(Ee==256)break;Ee-=257;var Ne=Ee<8?0:Ee-4>>2;Ne>5&&(Ne=0);var Ye=Se+se[Ee];Ne>0&&(Ye+=At(ue,ye,Ne),ye+=Ne),fe=At(ue,ye,Ke),Ee=xe>>>1==1?De[fe]:Tt[fe],ye+=Ee&15,Ee>>>=4;var ot=Ee<4?0:Ee-2>>1,pt=X[Ee];for(ot>0&&(pt+=At(ue,ye,ot),ye+=ot),!we&&Ve<Ye&&(_e=ut(_e,Ye+100),Ve=_e.length);Se<Ye;)_e[Se]=_e[Se-pt],++Se}}}return we?[_e,ye+7>>>3]:[_e.slice(0,Se),ye+7>>>3]}function dr(ue,we){var ye=ue.slice(ue.l||0),xe=Nr(ye,we);return ue.l+=xe[1],xe[0]}function Vt(ue,we){if(ue)typeof console<"u"&&console.error(we);else throw new Error(we)}function ge(ue,we){var ye=ue;oi(ye,0);var xe=[],_e=[],Se={FileIndex:xe,FullPaths:_e};F(Se,{root:we.root});for(var Ve=ye.length-4;(ye[Ve]!=80||ye[Ve+1]!=75||ye[Ve+2]!=5||ye[Ve+3]!=6)&&Ve>=0;)--Ve;ye.l=Ve+4,ye.l+=4;var lt=ye.read_shift(2);ye.l+=6;var Ke=ye.read_shift(4);for(ye.l=Ke,Ve=0;Ve<lt;++Ve){ye.l+=20;var oe=ye.read_shift(4),fe=ye.read_shift(4),Ee=ye.read_shift(2),Ne=ye.read_shift(2),Ye=ye.read_shift(2);ye.l+=8;var ot=ye.read_shift(4),pt=o(ye.slice(ye.l+Ee,ye.l+Ee+Ne));ye.l+=Ee+Ne+Ye;var Gt=ye.l;ye.l=ot+4,Te(ye,oe,fe,Se,pt),ye.l=Gt}return Se}function Te(ue,we,ye,xe,_e){ue.l+=2;var Se=ue.read_shift(2),Ve=ue.read_shift(2),lt=i(ue);if(Se&8257)throw new Error("Unsupported ZIP encryption");for(var Ke=ue.read_shift(4),oe=ue.read_shift(4),fe=ue.read_shift(4),Ee=ue.read_shift(2),Ne=ue.read_shift(2),Ye="",ot=0;ot<Ee;++ot)Ye+=String.fromCharCode(ue[ue.l++]);if(Ne){var pt=o(ue.slice(ue.l,ue.l+Ne));(pt[21589]||{}).mt&&(lt=pt[21589].mt),((_e||{})[21589]||{}).mt&&(lt=_e[21589].mt)}ue.l+=Ne;var Gt=ue.slice(ue.l,ue.l+oe);switch(Ve){case 8:Gt=z(ue,fe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ve)}var xt=!1;Se&8&&(Ke=ue.read_shift(4),Ke==134695760&&(Ke=ue.read_shift(4),xt=!0),oe=ue.read_shift(4),fe=ue.read_shift(4)),oe!=we&&Vt(xt,"Bad compressed size: "+we+" != "+oe),fe!=ye&&Vt(xt,"Bad uncompressed size: "+ye+" != "+fe),zt(xe,Ye,Gt,{unsafe:!0,mt:lt})}function Fe(ue,we){var ye=we||{},xe=[],_e=[],Se=_t(1),Ve=ye.compression?8:0,lt=0,Ke=0,oe=0,fe=0,Ee=0,Ne=ue.FullPaths[0],Ye=Ne,ot=ue.FileIndex[0],pt=[],Gt=0;for(Ke=1;Ke<ue.FullPaths.length;++Ke)if(Ye=ue.FullPaths[Ke].slice(Ne.length),ot=ue.FileIndex[Ke],!(!ot.size||!ot.content||Ye=="Sh33tJ5")){var xt=fe,Jt=_t(Ye.length);for(oe=0;oe<Ye.length;++oe)Jt.write_shift(1,Ye.charCodeAt(oe)&127);Jt=Jt.slice(0,Jt.l),pt[Ee]=Vie.buf(ot.content,0);var wr=ot.content;Ve==8&&(wr=K(wr)),Se=_t(30),Se.write_shift(4,67324752),Se.write_shift(2,20),Se.write_shift(2,lt),Se.write_shift(2,Ve),ot.mt?a(Se,ot.mt):Se.write_shift(4,0),Se.write_shift(-4,pt[Ee]),Se.write_shift(4,wr.length),Se.write_shift(4,ot.content.length),Se.write_shift(2,Jt.length),Se.write_shift(2,0),fe+=Se.length,xe.push(Se),fe+=Jt.length,xe.push(Jt),fe+=wr.length,xe.push(wr),Se=_t(46),Se.write_shift(4,33639248),Se.write_shift(2,0),Se.write_shift(2,20),Se.write_shift(2,lt),Se.write_shift(2,Ve),Se.write_shift(4,0),Se.write_shift(-4,pt[Ee]),Se.write_shift(4,wr.length),Se.write_shift(4,ot.content.length),Se.write_shift(2,Jt.length),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(4,0),Se.write_shift(4,xt),Gt+=Se.l,_e.push(Se),Gt+=Jt.length,_e.push(Jt),++Ee}return Se=_t(22),Se.write_shift(4,101010256),Se.write_shift(2,0),Se.write_shift(2,0),Se.write_shift(2,Ee),Se.write_shift(2,Ee),Se.write_shift(4,Gt),Se.write_shift(4,fe),Se.write_shift(2,0),Ba([Ba(xe),Ba(_e),Se])}var Me={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function kt(ue,we){if(ue.ctype)return ue.ctype;var ye=ue.name||"",xe=ye.match(/\.([^\.]+)$/);return xe&&Me[xe[1]]||we&&(xe=(ye=we).match(/[\.\\]([^\.\\])+$/),xe&&Me[xe[1]])?Me[xe[1]]:"application/octet-stream"}function Pe(ue){for(var we=Zy(ue),ye=[],xe=0;xe<we.length;xe+=76)ye.push(we.slice(xe,xe+76));return ye.join(`\r
`)+`\r
`}function He(ue){var we=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var fe=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(fe.length==1?"0"+fe:fe)});we=we.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),we.charAt(0)==`
`&&(we="=0D"+we.slice(1)),we=we.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ye=[],xe=we.split(`\r
`),_e=0;_e<xe.length;++_e){var Se=xe[_e];if(Se.length==0){ye.push("");continue}for(var Ve=0;Ve<Se.length;){var lt=76,Ke=Se.slice(Ve,Ve+lt);Ke.charAt(lt-1)=="="?lt--:Ke.charAt(lt-2)=="="?lt-=2:Ke.charAt(lt-3)=="="&&(lt-=3),Ke=Se.slice(Ve,Ve+lt),Ve+=lt,Ve<Se.length&&(Ke+="="),ye.push(Ke)}}return ye.join(`\r
`)}function ke(ue){for(var we=[],ye=0;ye<ue.length;++ye){for(var xe=ue[ye];ye<=ue.length&&xe.charAt(xe.length-1)=="=";)xe=xe.slice(0,xe.length-1)+ue[++ye];we.push(xe)}for(var _e=0;_e<we.length;++_e)we[_e]=we[_e].replace(/[=][0-9A-Fa-f]{2}/g,function(Se){return String.fromCharCode(parseInt(Se.slice(1),16))});return Ho(we.join(`\r
`))}function $e(ue,we,ye){for(var xe="",_e="",Se="",Ve,lt=0;lt<10;++lt){var Ke=we[lt];if(!Ke||Ke.match(/^\s*$/))break;var oe=Ke.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":xe=oe[2].trim();break;case"content-type":Se=oe[2].trim();break;case"content-transfer-encoding":_e=oe[2].trim();break}}switch(++lt,_e.toLowerCase()){case"base64":Ve=Ho(Yo(we.slice(lt).join("")));break;case"quoted-printable":Ve=ke(we.slice(lt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+_e)}var fe=zt(ue,xe.slice(ye.length),Ve,{unsafe:!0});Se&&(fe.ctype=Se)}function Ue(ue,we){if(M(ue.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ye=we&&we.root||"",xe=(en&&Buffer.isBuffer(ue)?ue.toString("binary"):M(ue)).split(`\r
`),_e=0,Se="";for(_e=0;_e<xe.length;++_e)if(Se=xe[_e],!!/^Content-Location:/i.test(Se)&&(Se=Se.slice(Se.indexOf("file")),ye||(ye=Se.slice(0,Se.lastIndexOf("/")+1)),Se.slice(0,ye.length)!=ye))for(;ye.length>0&&(ye=ye.slice(0,ye.length-1),ye=ye.slice(0,ye.lastIndexOf("/")+1),Se.slice(0,ye.length)!=ye););var Ve=(xe[1]||"").match(/boundary="(.*?)"/);if(!Ve)throw new Error("MAD cannot find boundary");var lt="--"+(Ve[1]||""),Ke=[],oe=[],fe={FileIndex:Ke,FullPaths:oe};F(fe);var Ee,Ne=0;for(_e=0;_e<xe.length;++_e){var Ye=xe[_e];Ye!==lt&&Ye!==lt+"--"||(Ne++&&$e(fe,xe.slice(Ee,_e),ye),Ee=_e)}return fe}function Et(ue,we){var ye=we||{},xe=ye.boundary||"SheetJS";xe="------="+xe;for(var _e=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+xe.slice(2)+'"',"","",""],Se=ue.FullPaths[0],Ve=Se,lt=ue.FileIndex[0],Ke=1;Ke<ue.FullPaths.length;++Ke)if(Ve=ue.FullPaths[Ke].slice(Se.length),lt=ue.FileIndex[Ke],!(!lt.size||!lt.content||Ve=="Sh33tJ5")){Ve=Ve.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Gt){return"_x"+Gt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Gt){return"_u"+Gt.charCodeAt(0).toString(16)+"_"});for(var oe=lt.content,fe=en&&Buffer.isBuffer(oe)?oe.toString("binary"):M(oe),Ee=0,Ne=Math.min(1024,fe.length),Ye=0,ot=0;ot<=Ne;++ot)(Ye=fe.charCodeAt(ot))>=32&&Ye<128&&++Ee;var pt=Ee>=Ne*4/5;_e.push(xe),_e.push("Content-Location: "+(ye.root||"file:///C:/SheetJS/")+Ve),_e.push("Content-Transfer-Encoding: "+(pt?"quoted-printable":"base64")),_e.push("Content-Type: "+kt(lt,Ve)),_e.push(""),_e.push(pt?He(fe):Pe(fe))}return _e.push(xe+`--\r
`),_e.join(`\r
`)}function Ft(ue){var we={};return F(we,ue),we}function zt(ue,we,ye,xe){var _e=xe&&xe.unsafe;_e||F(ue);var Se=!_e&&Er.find(ue,we);if(!Se){var Ve=ue.FullPaths[0];we.slice(0,Ve.length)==Ve?Ve=we:(Ve.slice(-1)!="/"&&(Ve+="/"),Ve=(Ve+we).replace("//","/")),Se={name:s(we),type:2},ue.FileIndex.push(Se),ue.FullPaths.push(Ve),_e||Er.utils.cfb_gc(ue)}return Se.content=ye,Se.size=ye?ye.length:0,xe&&(xe.CLSID&&(Se.clsid=xe.CLSID),xe.mt&&(Se.mt=xe.mt),xe.ct&&(Se.ct=xe.ct)),Se}function fr(ue,we){F(ue);var ye=Er.find(ue,we);if(ye){for(var xe=0;xe<ue.FileIndex.length;++xe)if(ue.FileIndex[xe]==ye)return ue.FileIndex.splice(xe,1),ue.FullPaths.splice(xe,1),!0}return!1}function nr(ue,we,ye){F(ue);var xe=Er.find(ue,we);if(xe){for(var _e=0;_e<ue.FileIndex.length;++_e)if(ue.FileIndex[_e]==xe)return ue.FileIndex[_e].name=s(ye),ue.FullPaths[_e]=ye,!0}return!1}function Dr(ue){j(ue,!0)}return t.find=L,t.read=P,t.parse=d,t.write=H,t.writeFile=V,t.utils={cfb_new:Ft,cfb_add:zt,cfb_del:fr,cfb_mov:nr,cfb_gc:Dr,ReadShift:ky,CheckField:C$,prep_blob:oi,bconcat:Ba,use_zlib:R,_deflateRaw:qe,_inflateRaw:dr,consts:B},t})();function Kie(e){return typeof e=="string"?s2(e):Array.isArray(e)?vie(e):e}function Hv(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s2(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Hc(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([Kie(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Lf(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function qie(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Ls(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function BF(e,t){for(var r=[],n=Ls(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function i2(e){for(var t=[],r=Ls(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function o2(e){for(var t=[],r=Ls(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function Yie(e){for(var t=[],r=Ls(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var U_=new Date(1899,11,30,0,0,0);function Sa(e,t){var r=e.getTime(),n=U_.getTime()+(e.getTimezoneOffset()-U_.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var s$=new Date,Xie=U_.getTime()+(s$.getTimezoneOffset()-U_.getTimezoneOffset())*6e4,$F=s$.getTimezoneOffset();function l2(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Xie),t.getTimezoneOffset()!==$F&&t.setTime(t.getTime()+(t.getTimezoneOffset()-$F)*6e4),t}function Jie(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var UF=new Date("2017-02-19T19:06:09.000Z"),a$=isNaN(UF.getFullYear())?new Date("2/19/17"):UF,Qie=a$.getFullYear()==2017;function is(e,t){var r=new Date(e);if(Qie)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(a$.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function g0(e,t){if(en&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Hc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Hc(VB(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Hc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Hc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function os(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=os(e[r]));return t}function Ds(e,t){for(var r="";r.length<t;)r+=e;return r}function lc(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var Zie=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cm(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Zie.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var eoe=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function i$(e){return e?e.content&&e.type?g0(e.content,!0):e.data?cy(e.data):e.asNodeBuffer&&en?cy(e.asNodeBuffer().toString("binary")):e.asBinary?cy(e.asBinary()):e._data&&e._data.getContent?cy(g0(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function o$(e){if(!e)return null;if(e.data)return AF(e.data);if(e.asNodeBuffer&&en)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?AF(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function toe(e){return e&&e.name.slice(-4)===".bin"?o$(e):i$(e)}function yl(e,t){for(var r=e.FullPaths||Ls(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function r3(e,t){var r=yl(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function sa(e,t,r){if(!r)return toe(r3(e,t));if(!t)return null;try{return sa(e,t)}catch{return null}}function Go(e,t,r){if(!r)return i$(r3(e,t));if(!t)return null;try{return Go(e,t)}catch{return null}}function roe(e,t,r){return o$(r3(e,t))}function zF(e){for(var t=e.FullPaths||Ls(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Qr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return en?n=ud(r):n=wie(r),Er.utils.cfb_add(e,t,n)}Er.utils.cfb_add(e,t,r)}else e.file(t,r)}function n3(){return Er.utils.cfb_new()}function l$(e,t){switch(t.type){case"base64":return Er.read(e,{type:"base64"});case"binary":return Er.read(e,{type:"binary"});case"buffer":case"array":return Er.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function dy(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Qs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,noe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,WF=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,soe=/<[^>]*>/g,Ri=Qs.match(WF)?WF:soe,aoe=/<\w*:/,ioe=/<(\/?)\w+:/;function Lr(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(noe),o=0,c="",u=0,d="",f="",g=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(g=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+g,f.length-g),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var p=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[p]&&d.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function ru(e){return e.replace(ioe,"<$1")}var c$={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},s3=i2(c$),mn=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return c$[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),a3=/[&<>'"]/g,ooe=/[\u0000-\u0008\u000b-\u001f]/g;function Rn(e){var t=e+"";return t.replace(a3,function(r){return s3[r]}).replace(ooe,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function HF(e){return Rn(e).replace(/ /g,"_x0020_")}var u$=/[\u0000-\u001f]/g;function i3(e){var t=e+"";return t.replace(a3,function(r){return s3[r]}).replace(/\n/g,"<br/>").replace(u$,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function loe(e){var t=e+"";return t.replace(a3,function(r){return s3[r]}).replace(u$,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var GF=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function coe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ns(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function wk(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function VF(e){var t=Tf(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function KF(e){return ud(e,"binary").toString("utf8")}var Cw="foo bar baz",zn=en&&(KF(Cw)==wk(Cw)&&KF||VF(Cw)==wk(Cw)&&VF)||wk,Hc=en?function(e){return ud(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},tv=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),d$=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),uoe=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),doe=/<\/?(?:vt:)?variant>/g,foe=/<(?:vt:)([^>]*)>([\s\S]*)</;function qF(e,t){var r=Lr(e),n=e.match(uoe(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(doe,"").match(foe);i&&s.push({v:zn(i[2]),t:i[1]})}),s}var f$=/(^\s|\s$|\n)/;function ui(e,t){return"<"+e+(t.match(f$)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function rv(e){return Ls(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Zt(e,t,r){return"<"+e+(r!=null?rv(r):"")+(t!=null?(t.match(f$)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function fE(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function hoe(e,t){switch(typeof e){case"string":var r=Zt("vt:lpwstr",Rn(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Zt((e|0)==e?"vt:i4":"vt:r8",Rn(String(e)));case"boolean":return Zt("vt:bool",e?"true":"false")}if(e instanceof Date)return Zt("vt:filetime",fE(e));throw new Error("Unable to serialize "+e)}function o3(e){if(en&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return zn(Lf(Z4(e)));throw new Error("Bad input format: expected Buffer or string")}var nv=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,_a={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},A0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Uo={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function goe(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function moe(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var YF=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},XF=en?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ud(t)})):YF(e)}:YF,JF=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Wu(e,s)));return n.join("").replace(no,"")},l3=en?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(no,""):JF(e,t,r)}:JF,QF=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},h$=en?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):QF(e,t,r)}:QF,ZF=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Gg(e,s)));return n.join("")},Gv=en?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):ZF(t,r,n)}:ZF,g$=function(e,t){var r=zo(e,t);return r>0?Gv(e,t+4,t+4+r-1):""},m$=g$,p$=function(e,t){var r=zo(e,t);return r>0?Gv(e,t+4,t+4+r-1):""},x$=p$,y$=function(e,t){var r=2*zo(e,t);return r>0?Gv(e,t+4,t+4+r-1):""},v$=y$,w$=function(t,r){var n=zo(t,r);return n>0?l3(t,r+4,r+4+n):""},_$=w$,b$=function(e,t){var r=zo(e,t);return r>0?Gv(e,t+4,t+4+r):""},S$=b$,k$=function(e,t){return goe(e,t)},z_=k$,c3=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};en&&(m$=function(t,r){if(!Buffer.isBuffer(t))return g$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},x$=function(t,r){if(!Buffer.isBuffer(t))return p$(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},v$=function(t,r){if(!Buffer.isBuffer(t))return y$(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},_$=function(t,r){if(!Buffer.isBuffer(t))return w$(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},S$=function(t,r){if(!Buffer.isBuffer(t))return b$(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},z_=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):k$(t,r)},c3=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Gg=function(e,t){return e[t]},Wu=function(e,t){return e[t+1]*256+e[t]},poe=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},zo=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jh=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},xoe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ky(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,en&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Wu(this,u)),u+=2;e*=2;break;case"utf8":r=Gv(this,this.l,this.l+e);break;case"utf16le":e*=2,r=l3(this,this.l,this.l+e);break;case"wstr":return ky.call(this,e,"dbcs");case"lpstr-ansi":r=m$(this,this.l),e=4+zo(this,this.l);break;case"lpstr-cp":r=x$(this,this.l),e=4+zo(this,this.l);break;case"lpwstr":r=v$(this,this.l),e=4+2*zo(this,this.l);break;case"lpp4":e=4+zo(this,this.l),r=_$(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+zo(this,this.l),r=S$(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Gg(this,this.l+e++))!==0;)a.push(kw(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Wu(this,this.l+e))!==0;)a.push(kw(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Gg(this,u),this.l=u+1,o=ky.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(kw(Wu(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Gg(this,u),this.l=u+1,o=ky.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(kw(Gg(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Gg(this,this.l),this.l++,n;case 2:return n=(t==="i"?poe:Wu)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?jh:xoe)(this,this.l),this.l+=4,n):(s=zo(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=z_(this,this.l):s=z_([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=h$(this,this.l,e);break}}return this.l+=e,r}var yoe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},voe=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},woe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function _oe(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)woe(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,yoe(this,t,this.l);break;case 8:if(n=8,r==="f"){moe(this,t,this.l);break}case 16:break;case-4:n=4,voe(this,t,this.l);break}return this.l+=n,this}function C$(e,t){var r=h$(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function oi(e,t){e.l=t,e.read_shift=ky,e.chk=C$,e.write_shift=_oe}function Ii(e,t){e.l+=t}function _t(e){var t=Tf(e);return oi(t,0),t}function dd(e,t,r){if(e){var n,s,a;oi(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=cv[o]||cv[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,o))return}}}function Co(){var e=[],t=en?256:2048,r=function(u){var d=_t(u);return oi(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Ba(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Ot(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=cv[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&c3(r)&&e.push(r)}}function Cy(e,t,r){var n=os(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function eO(e,t,r){var n=os(e);return n.s=Cy(n.s,t.s,r),n.e=Cy(n.e,t.s,r),n}function Ty(e,t){if(e.cRel&&e.c<0)for(e=os(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=os(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Rr(e);return!e.cRel&&e.cRel!=null&&(r=koe(r)),!e.rRel&&e.rRel!=null&&(r=boe(r)),r}function _k(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+_s(e.s.c)+":"+(e.e.cRel?"":"$")+_s(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Xs(e.s.r)+":"+(e.e.rRel?"":"$")+Xs(e.e.r):Ty(e.s,t.biff)+":"+Ty(e.e,t.biff)}function u3(e){return parseInt(Soe(e),10)-1}function Xs(e){return""+(e+1)}function boe(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Soe(e){return e.replace(/\$(\d+)$/,"$1")}function d3(e){for(var t=Coe(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function _s(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function koe(e){return e.replace(/^([A-Z])/,"$$$1")}function Coe(e){return e.replace(/^\$([A-Z])/,"$1")}function Toe(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function bs(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function Rr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function To(e){var t=e.indexOf(":");return t==-1?{s:bs(e),e:bs(e)}:{s:bs(e.slice(0,t)),e:bs(e.slice(t+1))}}function Xr(e,t){return typeof t>"u"||typeof t=="number"?Xr(e.s,e.e):(typeof e!="string"&&(e=Rr(e)),typeof t!="string"&&(t=Rr(t)),e==t?e:e+":"+t)}function pn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function tO(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Al(e.z,r?Sa(t):t)}catch{}try{return e.w=Al((e.XF||{}).numFmtId||(r?14:0),r?Sa(t):t)}catch{return""+t}}function nd(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?fd[e.v]||e.v:t==null?tO(e,e.v):tO(e,t))}function Bf(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function T$(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?bs(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=pn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[f].length;++g)if(!(typeof t[f][g]>"u")){var p={v:t[f][g]},x=i+f,v=o+g;if(u.s.r>x&&(u.s.r=x),u.s.c>v&&(u.s.c=v),u.e.r<x&&(u.e.r=x),u.e.c<v&&(u.e.c=v),t[f][g]&&typeof t[f][g]=="object"&&!Array.isArray(t[f][g])&&!(t[f][g]instanceof Date))p=t[f][g];else if(Array.isArray(p.v)&&(p.f=t[f][g][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Fr[14],n.cellDates?(p.t="d",p.w=Al(p.z,Sa(p.v))):(p.t="n",p.v=Sa(p.v),p.w=Al(p.z,p.v))):p.t="s";if(s)a[x]||(a[x]=[]),a[x][v]&&a[x][v].z&&(p.z=a[x][v].z),a[x][v]=p;else{var w=Rr({c:v,r:x});a[w]&&a[w].z&&(p.z=a[w].z),a[w]=p}}}return u.s.c<1e7&&(a["!ref"]=Xr(u)),a}function ep(e,t){return T$(null,e,t)}function Eoe(e){return e.read_shift(4,"i")}function cc(e,t){return t||(t=_t(4)),t.write_shift(4,e),t}function Oi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Ua(e,t){var r=!1;return t==null&&(r=!0,t=_t(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Noe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Aoe(e,t){return t||(t=_t(4)),t.write_shift(2,0),t.write_shift(2,0),t}function f3(e,t){var r=e.l,n=e.read_shift(1),s=Oi(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(Noe(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function joe(e,t){var r=!1;return t==null&&(r=!0,t=_t(15+4*e.t.length)),t.write_shift(1,0),Ua(e.t,t),r?t.slice(0,t.l):t}var Poe=f3;function Foe(e,t){var r=!1;return t==null&&(r=!0,t=_t(23+4*e.t.length)),t.write_shift(1,1),Ua(e.t,t),t.write_shift(4,1),Aoe({},t),r?t.slice(0,t.l):t}function Dl(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function j0(e,t){return t==null&&(t=_t(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function P0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function F0(e,t){return t==null&&(t=_t(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var Ooe=Oi,E$=Ua;function h3(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function W_(e,t){var r=!1;return t==null&&(r=!0,t=_t(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var Doe=Oi,hE=h3,g3=W_;function m3(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?z_([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):jh(t,0)>>2;return r?s/100:s}function N$(e,t){t==null&&(t=_t(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function A$(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function Ioe(e,t){return t||(t=_t(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var O0=A$,tp=Ioe;function Ai(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function m0(e,t){return(t||_t(8)).write_shift(8,e,"f")}function Roe(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Gh[s];u&&(t.rgb=av(u));break;case 2:t.rgb=av([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function H_(e,t){if(t||(t=_t(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function Moe(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function Loe(e,t){t||(t=_t(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function j$(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Boe(e){return j$(e,1)}function $oe(e){return j$(e,2)}var p3=2,yo=3,Tw=11,rO=12,G_=19,Ew=64,Uoe=65,zoe=71,Woe=4108,Hoe=4126,Ia=80,P$=81,Goe=[Ia,P$],gE={1:{n:"CodePage",t:p3},2:{n:"Category",t:Ia},3:{n:"PresentationFormat",t:Ia},4:{n:"ByteCount",t:yo},5:{n:"LineCount",t:yo},6:{n:"ParagraphCount",t:yo},7:{n:"SlideCount",t:yo},8:{n:"NoteCount",t:yo},9:{n:"HiddenCount",t:yo},10:{n:"MultimediaClipCount",t:yo},11:{n:"ScaleCrop",t:Tw},12:{n:"HeadingPairs",t:Woe},13:{n:"TitlesOfParts",t:Hoe},14:{n:"Manager",t:Ia},15:{n:"Company",t:Ia},16:{n:"LinksUpToDate",t:Tw},17:{n:"CharacterCount",t:yo},19:{n:"SharedDoc",t:Tw},22:{n:"HyperlinksChanged",t:Tw},23:{n:"AppVersion",t:yo,p:"version"},24:{n:"DigSig",t:Uoe},26:{n:"ContentType",t:Ia},27:{n:"ContentStatus",t:Ia},28:{n:"Language",t:Ia},29:{n:"Version",t:Ia},255:{},2147483648:{n:"Locale",t:G_},2147483651:{n:"Behavior",t:G_},1919054434:{}},mE={1:{n:"CodePage",t:p3},2:{n:"Title",t:Ia},3:{n:"Subject",t:Ia},4:{n:"Author",t:Ia},5:{n:"Keywords",t:Ia},6:{n:"Comments",t:Ia},7:{n:"Template",t:Ia},8:{n:"LastAuthor",t:Ia},9:{n:"RevNumber",t:Ia},10:{n:"EditTime",t:Ew},11:{n:"LastPrinted",t:Ew},12:{n:"CreatedDate",t:Ew},13:{n:"ModifiedDate",t:Ew},14:{n:"PageCount",t:yo},15:{n:"WordCount",t:yo},16:{n:"CharCount",t:yo},17:{n:"Thumbnail",t:zoe},18:{n:"Application",t:Ia},19:{n:"DocSecurity",t:yo},255:{},2147483648:{n:"Locale",t:G_},2147483651:{n:"Behavior",t:G_},1919054434:{}},nO={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Voe=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Koe(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var qoe=Koe([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Gh=os(qoe),fd={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},F$={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},pE={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nw={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function x3(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Yoe(e){var t=x3();if(!e||!e.match)return t;var r={};if((e.match(Ri)||[]).forEach(function(n){var s=Lr(n);switch(s[0].replace(aoe,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[pE[s.ContentType]]!==void 0&&t[pE[s.ContentType]].push(s.PartName);break}}),t.xmlns!==_a.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function O$(e,t){var r=Yie(pE),n=[],s;n[n.length]=Qs,n[n.length]=Zt("Types",null,{xmlns:_a.CT,"xmlns:xsd":_a.xsd,"xmlns:xsi":_a.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Zt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Zt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Nw[c][t.bookType]||Nw[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Zt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Nw[c][t.bookType]||Nw[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Zt("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var an={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sv(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ey(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Ri)||[]).forEach(function(s){var a=Lr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:dy(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function dm(e){var t=[Qs,Zt("Relationships",null,{xmlns:_a.RELS})];return Ls(e["!id"]).forEach(function(r){t[t.length]=Zt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Dn(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[an.HLINK,an.XPATH,an.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var Xoe="application/vnd.oasis.opendocument.spreadsheet";function Joe(e,t){for(var r=o3(e),n,s;n=nv.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Lr(n[0],!1),s.path=="/"&&s.type!==Xoe)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Qoe(e){var t=[Qs];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function sO(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function Zoe(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function ele(e){var t=[Qs];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(sO(e[r][0],e[r][1])),t.push(Zoe("",e[r][0]));return t.push(sO("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function D$(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+M_.version+"</meta:generator></office:meta></office:document-meta>"}var Tl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],tle=(function(){for(var e=new Array(Tl.length),t=0;t<Tl.length;++t){var r=Tl[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function I$(e){var t={};e=zn(e);for(var r=0;r<Tl.length;++r){var n=Tl[r],s=e.match(tle[r]);s!=null&&s.length>0&&(t[n[1]]=mn(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=is(t[n[1]]))}return t}function bk(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=Rn(t),n[n.length]=r?Zt(e,t,r):ui(e,t))}function R$(e,t){var r=t||{},n=[Qs,Zt("cp:coreProperties",null,{"xmlns:cp":_a.CORE_PROPS,"xmlns:dc":_a.dc,"xmlns:dcterms":_a.dcterms,"xmlns:dcmitype":_a.dcmitype,"xmlns:xsi":_a.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&bk("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:fE(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&bk("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:fE(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Tl.length;++a){var i=Tl[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&bk(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Vh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],M$=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function L$(e,t,r,n){var s=[];if(typeof e=="string")s=qF(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?qF(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function rle(e,t,r){var n={};return t||(t={}),e=zn(e),Vh.forEach(function(s){var a=(e.match(tv(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=mn(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&L$(n.HeadingPairs,n.TitlesOfParts,t,r),t}function B$(e){var t=[],r=Zt;return e||(e={}),e.Application="SheetJS",t[t.length]=Qs,t[t.length]=Zt("Properties",null,{xmlns:_a.EXT_PROPS,"xmlns:vt":_a.vt}),Vh.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=Rn(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Rn(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var nle=/<[^>]+>[^<]*/g;function sle(e,t){var r={},n="",s=e.match(nle);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Lr(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=mn(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=mn(d);break;case"bool":r[n]=ns(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=is(d);break;case"cy":case"error":r[n]=mn(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function $$(e){var t=[Qs,Zt("Properties",null,{xmlns:_a.CUST_PROPS,"xmlns:vt":_a.vt})];if(!e)return t.join("");var r=1;return Ls(e).forEach(function(s){++r,t[t.length]=Zt("property",hoe(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Rn(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var xE={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Sk;function ale(e,t,r){Sk||(Sk=i2(xE)),t=Sk[t]||t,e[t]=r}function ile(e,t){var r=[];return Ls(xE).map(function(n){for(var s=0;s<Tl.length;++s)if(Tl[s][1]==n)return Tl[s];for(s=0;s<Vh.length;++s)if(Vh[s][1]==n)return Vh[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(ui(xE[n[1]]||n[1],s))}}),Zt("DocumentProperties",r.join(""),{xmlns:Uo.o})}function ole(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Ls(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Tl.length;++i)if(a==Tl[i][1])return;for(i=0;i<Vh.length;++i)if(a==Vh[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Zt(HF(a),o,{"dt:dt":c}))}}),t&&Ls(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Zt(HF(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Uo.o+'">'+s.join("")+"</"+n+">"}function y3(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function lle(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=_t(8);return i.write_shift(4,n),i.write_shift(4,s),i}function U$(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function z$(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function W$(e,t,r){return t===31?z$(e):U$(e,t,r)}function yE(e,t,r){return W$(e,t,r===!1?0:4)}function cle(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return W$(e,t,0)}function ule(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(no,""),e.l-s&2&&(e.l+=2)}return r}function dle(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(no,"");return r}function fle(e){var t=e.l,r=V_(e,P$);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=V_(e,yo);return[r,n]}function hle(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(fle(e));return r}function aO(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(no,"").replace(uy,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function H$(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function gle(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function V_(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==rO&&n!==t&&Goe.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===rO?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return U$(e,n,4).replace(no,"");case 31:return z$(e);case 64:return y3(e);case 65:return H$(e);case 71:return gle(e);case 80:return yE(e,n,!a.raw).replace(no,"");case 81:return cle(e,n).replace(no,"");case 4108:return hle(e);case 4126:case 4127:return n==4127?ule(e):dle(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function iO(e,t){var r=_t(4),n=_t(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=_t(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=lle(t);break;case 31:case 80:for(n=_t(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Ba([r,n])}function oO(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(k,_){return k[1]-_[1]});var g={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var x=t[a[i][0]];if(g[x.n]=V_(e,x.t,{raw:!0}),x.p==="version"&&(g[x.n]=String(g[x.n]>>16)+"."+("0000"+String(g[x.n]&65535)).slice(-4)),x.n=="CodePage")switch(g[x.n]){case 0:g[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ac(o=g[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[x.n])}}else if(a[i][0]===1){if(o=g.CodePage=V_(e,p3),ac(o),c!==-1){var v=e.l;e.l=a[c][1],u=aO(e,o),e.l=v}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=aO(e,o)}else{var w=u[a[i][0]],C;switch(e[e.l]){case 65:e.l+=4,C=H$(e);break;case 30:e.l+=4,C=yE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=yE(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Ks(e,4);break;case 64:e.l+=4,C=is(y3(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[w]=C}}return e.l=r+n,g}var G$=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function mle(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function lO(e,t,r){var n=_t(8),s=[],a=[],i=8,o=0,c=_t(8),u=_t(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=_t(8),u.write_shift(4,0),s.unshift(u);var d=[_t(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=_t(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Ba(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(G$.indexOf(e[o][0])>-1||M$.indexOf(e[o][0])>-1)&&e[o][1]!=null){var g=e[o][1],p=0;if(t){p=+t[e[o][0]];var x=r[p];if(x.p=="version"&&typeof g=="string"){var v=g.split(".");g=(+v[0]<<16)+(+v[1]||0)}c=iO(x.t,g)}else{var w=mle(g);w==-1&&(w=31,g=String(g)),c=iO(w,g)}a.push(c),u=_t(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var C=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,C),C+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Ba([n].concat(s).concat(a))}function cO(e,t,r){var n=e.content;if(!n)return{};oi(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Er.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=oO(n,t),g={SystemIdentifier:u};for(var p in f)g[p]=f[p];if(g.FMTID=a,s===1)return g;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var x;try{x=oO(n,null)}catch{}for(p in x)g[p]=x[p];return g.FMTID=[a,i],g}function uO(e,t,r,n,s,a){var i=_t(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Er.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=lO(e,r,n);if(o.push(c),s){var u=lO(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Ba(o)}function nf(e,t){return e.read_shift(t),null}function ple(e,t){t||(t=_t(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function xle(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ks(e,t){return e.read_shift(t)===1}function Ji(e,t){return t||(t=_t(2)),t.write_shift(2,+!!e),t}function aa(e){return e.read_shift(2,"u")}function vl(e,t){return t||(t=_t(2)),t.write_shift(2,e),t}function V$(e,t){return xle(e,t,aa)}function yle(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function K$(e,t,r){return r||(r=_t(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Vv(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function vle(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function wle(e){var t=e.t||"",r=_t(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=_t(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Ba(s)}function p0(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Kv(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):p0(e,n,r)}function D0(e,t,r){if(r.biff>5)return Kv(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function q$(e,t,r){return r||(r=_t(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function _le(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ble(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(no,"");return n&&(e.l+=24),s}function Sle(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(no,"");return r+i}function kle(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ble(e);case"0303000000000000c000000000000046":return Sle(e);default:throw new Error("Unsupported Moniker "+r)}}function Aw(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(no,""):"";return r}function dO(e,t){t||(t=_t(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Cle(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",d,f;s&16&&(a=Aw(e,r-e.l)),s&128&&(i=Aw(e,r-e.l)),(s&257)===257&&(o=Aw(e,r-e.l)),(s&257)===1&&(c=kle(e,r-e.l)),s&8&&(u=Aw(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=y3(e)),e.l=r;var g=i||o||c||"";g&&u&&(g+="#"+u),g||(g="#"+u),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var p={Target:g};return d&&(p.guid=d),f&&(p.time=f),a&&(p.Tooltip=a),p}function Tle(e){var t=_t(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),dO(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&dO(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Y$(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function X$(e,t){var r=Y$(e);return r[3]=0,r}function nu(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function x0(e,t,r,n){return n||(n=_t(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Ele(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function Nle(e,t,r){return t===0?"":D0(e,t,r)}function Ale(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function J$(e){var t=e.read_shift(2),r=m3(e);return[t,r]}function jle(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Vv(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function c2(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function Q$(e,t){return t||(t=_t(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Z$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var Ple=Z$;function eU(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function Fle(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function Ole(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function bi(e){e.l+=2,e.l+=e.read_shift(2)}var Dle={0:bi,4:bi,5:bi,6:bi,7:Ole,8:bi,9:bi,10:bi,11:bi,12:bi,13:Fle,14:bi,15:bi,16:bi,17:bi,18:bi,19:bi,20:bi,21:eU};function Ile(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(Dle[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function jw(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function v3(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=_t(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function Rle(e,t){return t===0||e.read_shift(2),1200}function Mle(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=D0(e,0,r);return e.read_shift(t+n-e.l),s}function Lle(e,t){var r=!t||t.biff==8,n=_t(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Ble(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function $le(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Vv(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function Ule(e,t){var r=!t||t.biff>=8?2:1,n=_t(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function zle(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(vle(e));return a.Count=n,a.Unique=s,a}function Wle(e,t){var r=_t(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=wle(e[s]);var a=Ba([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function Hle(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function Gle(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Vle(e){var t=Ele(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Kle(e){return e.read_shift(2),e.read_shift(4)}function fO(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function qle(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function Yle(){var e=_t(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Xle(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Jle(e){var t=_t(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Qle(){}function Zle(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vv(e,0,r),n}function ece(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=_t(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function tce(e){var t=nu(e);return t.isst=e.read_shift(4),t}function rce(e,t,r,n){var s=_t(10);return x0(e,t,n,s),s.write_shift(4,r),s}function nce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=nu(e);r.biff==2&&e.l++;var a=Kv(e,n-e.l,r);return s.val=a,s}function sce(e,t,r,n,s){var a=!s||s.biff==8,i=_t(8+ +a+(1+a)*r.length);return x0(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function ace(e,t,r){var n=e.read_shift(2),s=D0(e,0,r);return[n,s]}function ice(e,t,r,n){var s=r&&r.biff==5;n||(n=_t(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var oce=D0;function hO(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function lce(e,t){var r=t.biff==8||!t.biff?4:2,n=_t(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function cce(e){var t=e.read_shift(2),r=e.read_shift(2),n=J$(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function uce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(J$(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function dce(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function fce(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=Voe[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function hce(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=fce(e,t,n.fStyle,r),n}function gO(e,t,r,n){var s=r&&r.biff==5;n||(n=_t(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function gce(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function mce(e){var t=_t(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function mO(e,t,r){var n=nu(e);(r.biff==2||t==9)&&++e.l;var s=yle(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function pce(e,t,r,n,s,a){var i=_t(8);return x0(e,t,n,i),K$(r,a,i),i}function xce(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=nu(e),s=Ai(e);return n.val=s,n}function yce(e,t,r,n){var s=_t(14);return x0(e,t,n,s),m0(r,s),s}var pO=Nle;function vce(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=p0(e,a),o=[];n>e.l;)o.push(Kv(e));return[a,s,i,o]}function xO(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=jle(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var wce=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function yO(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=p0(e,i,r);s&32&&(u=wce[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:Ihe(e,d,r,o);return{chKey:a,Name:u,itab:c,rgce:f}}function tU(e,t,r){if(r.biff<8)return _ce(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(Ale(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function _ce(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Vv(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function bce(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=p0(e,n,r),i=p0(e,s,r);return[a,i]}function Sce(e,t,r){var n=Z$(e);e.l++;var s=e.read_shift(1);return t-=8,[Rhe(e,t,r),s,n]}function vO(e,t,r){var n=Ple(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Ohe(e,t,r)]}function kce(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Cce(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=D0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Tce(e,t,r){return Cce(e,t,r)}function Ece(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(c2(e));return r}function Nce(e){var t=_t(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)Q$(e[r],t);return t}function Ace(e,t,r){if(r&&r.biff<8)return Pce(e,t,r);var n=eU(e),s=Ile(e,t-22,n[1]);return{cmo:n,ft:s}}var jce={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Pce(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((jce[n]||Ii)(e,t,r)),{cmo:[s,n,a],ft:i}}function Fce(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=_le(e,6,r);var o=e.read_shift(2);e.read_shift(2),aa(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=p0(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function Oce(e,t){var r=c2(e);e.l+=16;var n=Cle(e,t-24);return[r,n]}function Dce(e){var t=_t(24),r=bs(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Ba([t,Tle(e[1])])}function Ice(e,t){e.read_shift(2);var r=c2(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(no,""),[r,n]}function Rce(e){var t=e[1].Tooltip,r=_t(10+2*(t.length+1));r.write_shift(2,2048);var n=bs(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function Mce(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=nO[r]||r,r=e.read_shift(2),t[1]=nO[r]||r,t}function Lce(e){return e||(e=_t(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Bce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X$(e));return r}function $ce(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(X$(e));return r}function Uce(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function rU(e,t,r){if(!r.cellStyles)return Ii(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function zce(e,t){var r=_t(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Wce(e,t){var r={};return t<32||(e.l+=16,r.header=Ai(e),r.footer=Ai(e),e.l+=2),r}function Hce(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function Gce(e){for(var t=_t(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var Vce=nu,Kce=V$,qce=Kv;function Yce(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function Xce(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=nu(e);++e.l;var s=D0(e,t-7,r);return n.t="str",n.val=s,n}function Jce(e){var t=nu(e);++e.l;var r=Ai(e);return t.t="n",t.val=r,t}function Qce(e,t,r){var n=_t(15);return Jv(n,e,t),n.write_shift(8,r,"f"),n}function Zce(e){var t=nu(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function eue(e,t,r){var n=_t(9);return Jv(n,e,t),n.write_shift(2,r),n}function tue(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function rue(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function nue(e,t,r){var n=e.l+t,s=nu(e),a=e.read_shift(2),i=p0(e,a,r);return e.l=n,s.t="str",s.val=i,s}var sue=[2,3,48,49,131,139,140,245],vE=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=i2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=Tf(1);switch(c.type){case"base64":d=Ho(Yo(o));break;case"binary":d=Ho(o);break;case"buffer":case"array":d=o;break}oi(d,0);var f=d.read_shift(1),g=!!(f&136),p=!1,x=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,g=!0;break;case 49:p=!0,g=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var v=0,w=521;f==2&&(v=d.read_shift(2)),d.l+=3,f!=2&&(v=d.read_shift(4)),v>1048576&&(v=1e6),f!=2&&(w=d.read_shift(2));var C=d.read_shift(2),k=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(k=e[d[d.l]]),d.l+=1,d.l+=2),x&&(d.l+=36);for(var _=[],N={},E=Math.min(d.length,f==2?521:w-10-(p?264:0)),P=x?32:11;d.l<E&&d[d.l]!=13;)switch(N={},N.name=Qy.utils.decode(k,d.slice(d.l,d.l+P)).replace(/[\u0000\r\n].*$/g,""),d.l+=P,N.type=String.fromCharCode(d.read_shift(1)),f!=2&&!x&&(N.offset=d.read_shift(4)),N.len=d.read_shift(1),f==2&&(N.offset=d.read_shift(2)),N.dec=d.read_shift(1),N.name.length&&_.push(N),f!=2&&(d.l+=x?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(d[d.l]!==13&&(d.l=w-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=w;var F=0,A=0;for(u[0]=[],A=0;A!=_.length;++A)u[0][A]=_[A].name;for(;v-- >0;){if(d[d.l]===42){d.l+=C;continue}for(++d.l,u[++F]=[],A=0,A=0;A!=_.length;++A){var j=d.slice(d.l,d.l+_[A].len);d.l+=_[A].len,oi(j,0);var I=Qy.utils.decode(k,j);switch(_[A].type){case"C":I.trim().length&&(u[F][A]=I.replace(/\s+$/,""));break;case"D":I.length===8?u[F][A]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):u[F][A]=I;break;case"F":u[F][A]=parseFloat(I.trim());break;case"+":case"I":u[F][A]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":u[F][A]=!0;break;case"N":case"F":u[F][A]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[F][A]="##MEMO##"+(x?parseInt(I.trim(),10):j.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(u[F][A]=+I||0);break;case"@":u[F][A]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":u[F][A]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":u[F][A]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][A]=-j.read_shift(-8,"f");break;case"B":if(p&&_[A].len==8){u[F][A]=j.read_shift(8,"f");break}case"G":case"P":j.l+=_[A].len;break;case"0":if(_[A].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[A].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=ep(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,c){try{return Bf(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&ac(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Co(),f=Y_(o,{header:1,raw:!0,cellDates:!0}),g=f[0],p=f.slice(1),x=o["!cols"]||[],v=0,w=0,C=0,k=1;for(v=0;v<g.length;++v){if(((x[v]||{}).DBF||{}).name){g[v]=x[v].DBF.name,++C;continue}if(g[v]!=null){if(++C,typeof g[v]=="number"&&(g[v]=g[v].toString(10)),typeof g[v]!="string")throw new Error("DBF Invalid column name "+g[v]+" |"+typeof g[v]+"|");if(g.indexOf(g[v])!==v){for(w=0;w<1024;++w)if(g.indexOf(g[v]+"_"+w)==-1){g[v]+="_"+w;break}}}}var _=pn(o["!ref"]),N=[],E=[],P=[];for(v=0;v<=_.e.c-_.s.c;++v){var F="",A="",j=0,I=[];for(w=0;w<p.length;++w)p[w][v]!=null&&I.push(p[w][v]);if(I.length==0||g[v]==null){N[v]="?";continue}for(w=0;w<I.length;++w){switch(typeof I[w]){case"number":A="B";break;case"string":A="C";break;case"boolean":A="L";break;case"object":A=I[w]instanceof Date?"D":"C";break;default:A="C"}j=Math.max(j,String(I[w]).length),F=F&&F!=A?"C":A}j>250&&(j=250),A=((x[v]||{}).DBF||{}).type,A=="C"&&x[v].DBF.len>j&&(j=x[v].DBF.len),F=="B"&&A=="N"&&(F="N",P[v]=x[v].DBF.dec,j=x[v].DBF.len),E[v]=F=="C"||A=="N"?j:a[F]||0,k+=E[v],N[v]=F}var L=d.next(32);for(L.write_shift(4,318902576),L.write_shift(4,p.length),L.write_shift(2,296+32*C),L.write_shift(2,k),v=0;v<4;++v)L.write_shift(4,0);for(L.write_shift(4,0|(+t[GB]||3)<<8),v=0,w=0;v<g.length;++v)if(g[v]!=null){var Y=d.next(32),Z=(g[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Y.write_shift(1,Z,"sbcs"),Y.write_shift(1,N[v]=="?"?"C":N[v],"sbcs"),Y.write_shift(4,w),Y.write_shift(1,E[v]||a[N[v]]||0),Y.write_shift(1,P[v]||0),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(1,0),Y.write_shift(4,0),Y.write_shift(4,0),w+=E[v]||a[N[v]]||0}var ae=d.next(264);for(ae.write_shift(4,13),v=0;v<65;++v)ae.write_shift(4,0);for(v=0;v<p.length;++v){var ee=d.next(k);for(ee.write_shift(1,0),w=0;w<g.length;++w)if(g[w]!=null)switch(N[w]){case"L":ee.write_shift(1,p[v][w]==null?63:p[v][w]?84:70);break;case"B":ee.write_shift(8,p[v][w]||0,"f");break;case"N":var ne="0";for(typeof p[v][w]=="number"&&(ne=p[v][w].toFixed(P[w]||0)),C=0;C<E[w]-ne.length;++C)ee.write_shift(1,32);ee.write_shift(1,ne,"sbcs");break;case"D":p[v][w]?(ee.write_shift(4,("0000"+p[v][w].getFullYear()).slice(-4),"sbcs"),ee.write_shift(2,("00"+(p[v][w].getMonth()+1)).slice(-2),"sbcs"),ee.write_shift(2,("00"+p[v][w].getDate()).slice(-2),"sbcs")):ee.write_shift(8,"00000000","sbcs");break;case"C":var B=String(p[v][w]!=null?p[v][w]:"").slice(0,E[w]);for(ee.write_shift(1,B,"sbcs"),C=0;C<E[w]-B.length;++C)ee.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),nU=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Ls(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,p){var x=e[p];return typeof x=="number"?jF(x):x},n=function(g,p,x){var v=p.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return v==59?g:jF(v)};e["|"]=254;function s(g,p){switch(p.type){case"base64":return a(Yo(g),p);case"binary":return a(g,p);case"buffer":return a(en&&Buffer.isBuffer(g)?g.toString("binary"):Lf(g),p);case"array":return a(g0(g),p)}throw new Error("Unrecognized type "+p.type)}function a(g,p){var x=g.split(/[\n\r]+/),v=-1,w=-1,C=0,k=0,_=[],N=[],E=null,P={},F=[],A=[],j=[],I=0,L;for(+p.codepage>=0&&ac(+p.codepage);C!==x.length;++C){I=0;var Y=x[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Z=Y.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),ae=Z[0],ee;if(Y.length>0)switch(ae){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&N.push(Y.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,B=!1,V=!1,M=!1,H=-1,W=-1;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"A":break;case"X":w=parseInt(Z[k].slice(1))-1,B=!0;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,B||(w=0),L=_.length;L<=v;++L)_[L]=[];break;case"K":ee=Z[k].slice(1),ee.charAt(0)==='"'?ee=ee.slice(1,ee.length-1):ee==="TRUE"?ee=!0:ee==="FALSE"?ee=!1:isNaN(lc(ee))?isNaN(Cm(ee).getDate())||(ee=is(ee)):(ee=lc(ee),E!==null&&Qm(E)&&(ee=l2(ee))),ne=!0;break;case"E":M=!0;var R=fm(Z[k].slice(1),{r:v,c:w});_[v][w]=[_[v][w],R];break;case"S":V=!0,_[v][w]=[_[v][w],"S5S"];break;case"G":break;case"R":H=parseInt(Z[k].slice(1))-1;break;case"C":W=parseInt(Z[k].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}if(ne&&(_[v][w]&&_[v][w].length==2?_[v][w][0]=ee:_[v][w]=ee,E=null),V){if(M)throw new Error("SYLK shared formula cannot have own formula");var z=H>-1&&_[H][W];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");_[v][w][1]=_U(z[1],{r:v-H,c:w-W})}break;case"F":var K=0;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"X":w=parseInt(Z[k].slice(1))-1,++K;break;case"Y":for(v=parseInt(Z[k].slice(1))-1,L=_.length;L<=v;++L)_[L]=[];break;case"M":I=parseInt(Z[k].slice(1))/20;break;case"F":break;case"G":break;case"P":E=N[parseInt(Z[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=Z[k].slice(1).split(" "),L=parseInt(j[0],10);L<=parseInt(j[1],10);++L)I=parseInt(j[2],10),A[L-1]=I===0?{hidden:!0}:{wch:I},Ef(A[L-1]);break;case"C":w=parseInt(Z[k].slice(1))-1,A[w]||(A[w]={});break;case"R":v=parseInt(Z[k].slice(1))-1,F[v]||(F[v]={}),I>0?(F[v].hpt=I,F[v].hpx=Em(I)):I===0&&(F[v].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}K<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+Y)}}return F.length>0&&(P["!rows"]=F),A.length>0&&(P["!cols"]=A),p&&p.sheetRows&&(_=_.slice(0,p.sheetRows)),[_,P]}function i(g,p){var x=s(g,p),v=x[0],w=x[1],C=ep(v,p);return Ls(w).forEach(function(k){C[k]=w[k]}),C}function o(g,p){return Bf(i(g,p),p)}function c(g,p,x,v){var w="C;Y"+(x+1)+";X"+(v+1)+";K";switch(g.t){case"n":w+=g.v||0,g.f&&!g.F&&(w+=";E"+C3(g.f,{r:x,c:v}));break;case"b":w+=g.v?"TRUE":"FALSE";break;case"e":w+=g.w||g.v;break;case"d":w+='"'+(g.w||g.v)+'"';break;case"s":w+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(g,p){p.forEach(function(x,v){var w="F;W"+(v+1)+" "+(v+1)+" ";x.hidden?w+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=iv(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=ov(x.wpx)),typeof x.wch=="number"&&(w+=Math.round(x.wch))),w.charAt(w.length-1)!=" "&&g.push(w)})}function d(g,p){p.forEach(function(x,v){var w="F;";x.hidden?w+="M0;":x.hpt?w+="M"+20*x.hpt+";":x.hpx&&(w+="M"+20*lv(x.hpx)+";"),w.length>2&&g.push(w+"R"+(v+1))})}function f(g,p){var x=["ID;PWXL;N;E"],v=[],w=pn(g["!ref"]),C,k=Array.isArray(g),_=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),g["!cols"]&&u(x,g["!cols"]),g["!rows"]&&d(x,g["!rows"]),x.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var N=w.s.r;N<=w.e.r;++N)for(var E=w.s.c;E<=w.e.c;++E){var P=Rr({r:N,c:E});C=k?(g[N]||[])[E]:g[P],!(!C||C.v==null&&(!C.f||C.F))&&v.push(c(C,g,N,E))}return x.join(_)+_+v.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:f}})(),sU=(function(){function e(a,i){switch(i.type){case"base64":return t(Yo(a),i);case"binary":return t(a,i);case"buffer":return t(en&&Buffer.isBuffer(a)?a.toString("binary"):Lf(a),i);case"array":return t(g0(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var g=o[d].trim().split(","),p=g[0],x=g[1];++d;for(var v=o[d]||"";(v.match(/["]/g)||[]).length&1&&d<o.length-1;)v+=`
`+o[++d];switch(v=v.trim(),+p){case-1:if(v==="BOT"){f[++c]=[],u=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?f[c][u]=!0:v==="FALSE"?f[c][u]=!1:isNaN(lc(x))?isNaN(Cm(x).getDate())?f[c][u]=x:f[c][u]=is(x):f[c][u]=lc(x),++u;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),f[c][u++]=v!==""?v:null;break}if(v==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return ep(e(a,i),i)}function n(a,i){return Bf(r(a,i),i)}var s=(function(){var a=function(c,u,d,f,g){c.push(u),c.push(d+","+f),c.push('"'+g.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=pn(c["!ref"]),f,g=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var p=d.s.r;p<=d.e.r;++p){i(u,-1,0,"BOT");for(var x=d.s.c;x<=d.e.c;++x){var v=Rr({r:p,c:x});if(f=g?(c[p]||[])[x]:c[v],!f){i(u,1,0,"");continue}switch(f.t){case"n":var w=f.w;!w&&f.v!=null&&(w=f.v),w==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,w,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Al(f.z||Fr[14],Sa(is(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var C=`\r
`,k=u.join(C);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),aU=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,g){for(var p=f.split(`
`),x=-1,v=-1,w=0,C=[];w!==p.length;++w){var k=p[w].trim().split(":");if(k[0]==="cell"){var _=bs(k[1]);if(C.length<=_.r)for(x=C.length;x<=_.r;++x)C[x]||(C[x]=[]);switch(x=_.r,v=_.c,k[2]){case"t":C[x][v]=e(k[3]);break;case"v":C[x][v]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":C[x][v]=!!+k[4];break;default:C[x][v]=+k[4];break}k[2]=="vtf"&&(C[x][v]=[C[x][v],N])}}}return g&&g.sheetRows&&(C=C.slice(0,g.sheetRows)),C}function n(f,g){return ep(r(f,g),g)}function s(f,g){return Bf(n(f,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var g=[],p=[],x,v="",w=To(f["!ref"]),C=Array.isArray(f),k=w.s.r;k<=w.e.r;++k)for(var _=w.s.c;_<=w.e.c;++_)if(v=Rr({r:k,c:_}),x=C?(f[k]||[])[_]:f[v],!(!x||x.v==null||x.t==="z")){switch(p=["cell",v,"t"],x.t){case"s":case"str":p.push(t(x.v));break;case"n":x.f?(p[2]="vtf",p[3]="n",p[4]=x.v,p[5]=t(x.f)):(p[2]="v",p[3]=x.v);break;case"b":p[2]="vt"+(x.f?"f":"c"),p[3]="nl",p[4]=x.v?"1":"0",p[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var N=Sa(is(x.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=x.w||Al(x.z||Fr[14],N);break;case"e":continue}g.push(p.join(":"))}return g.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function d(f){return[a,i,o,i,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),Tm=(function(){function e(d,f,g,p,x){x.raw?f[g][p]=d:d===""||(d==="TRUE"?f[g][p]=!0:d==="FALSE"?f[g][p]=!1:isNaN(lc(d))?isNaN(Cm(d).getDate())?f[g][p]=d:f[g][p]=is(d):f[g][p]=lc(d))}function t(d,f){var g=f||{},p=[];if(!d||d.length===0)return p;for(var x=d.split(/[\r\n]/),v=x.length-1;v>=0&&x[v].length===0;)--v;for(var w=10,C=0,k=0;k<=v;++k)C=x[k].indexOf(" "),C==-1?C=x[k].length:C++,w=Math.max(w,C);for(k=0;k<=v;++k){p[k]=[];var _=0;for(e(x[k].slice(0,w).trim(),p,k,_,g),_=1;_<=(x[k].length-w)/10+1;++_)e(x[k].slice(w+(_-1)*10,w+_*10).trim(),p,k,_,g)}return g.sheetRows&&(p=p.slice(0,g.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},g=!1,p=0,x=0;p<d.length;++p)(x=d.charCodeAt(p))==34?g=!g:!g&&x in r&&(f[x]=(f[x]||0)+1);x=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p]);if(!x.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&x.push([f[p],p])}return x.sort(function(v,w){return v[0]-w[0]||n[v[1]]-n[w[1]]}),r[x.pop()[1]]||44}function a(d,f){var g=f||{},p="",x=g.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(p=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(p=d.charAt(4),d=d.slice(6)):p=s(d.slice(0,1024)):g&&g.FS?p=g.FS:p=s(d.slice(0,1024));var w=0,C=0,k=0,_=0,N=0,E=p.charCodeAt(0),P=!1,F=0,A=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var j=g.dateNF!=null?Hie(g.dateNF):null;function I(){var L=d.slice(_,N),Y={};if(L.charAt(0)=='"'&&L.charAt(L.length-1)=='"'&&(L=L.slice(1,-1).replace(/""/g,'"')),L.length===0)Y.t="z";else if(g.raw)Y.t="s",Y.v=L;else if(L.trim().length===0)Y.t="s",Y.v=L;else if(L.charCodeAt(0)==61)L.charCodeAt(1)==34&&L.charCodeAt(L.length-1)==34?(Y.t="s",Y.v=L.slice(2,-1).replace(/""/g,'"')):vfe(L)?(Y.t="n",Y.f=L.slice(1)):(Y.t="s",Y.v=L);else if(L=="TRUE")Y.t="b",Y.v=!0;else if(L=="FALSE")Y.t="b",Y.v=!1;else if(!isNaN(k=lc(L)))Y.t="n",g.cellText!==!1&&(Y.w=L),Y.v=k;else if(!isNaN(Cm(L).getDate())||j&&L.match(j)){Y.z=g.dateNF||Fr[14];var Z=0;j&&L.match(j)&&(L=Gie(L,g.dateNF,L.match(j)||[]),Z=1),g.cellDates?(Y.t="d",Y.v=is(L,Z)):(Y.t="n",Y.v=Sa(is(L,Z))),g.cellText!==!1&&(Y.w=Al(Y.z,Y.v instanceof Date?Sa(Y.v):Y.v)),g.cellNF||delete Y.z}else Y.t="s",Y.v=L;if(Y.t=="z"||(g.dense?(x[w]||(x[w]=[]),x[w][C]=Y):x[Rr({c:C,r:w})]=Y),_=N+1,A=d.charCodeAt(_),v.e.c<C&&(v.e.c=C),v.e.r<w&&(v.e.r=w),F==E)++C;else if(C=0,++w,g.sheetRows&&g.sheetRows<=w)return!0}e:for(;N<d.length;++N)switch(F=d.charCodeAt(N)){case 34:A===34&&(P=!P);break;case E:case 10:case 13:if(!P&&I())break e;break}return N-_>0&&I(),x["!ref"]=Xr(v),x}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):ep(t(d,f),f)}function o(d,f){var g="",p=f.type=="string"?[0,0,0,0]:O3(d,f);switch(f.type){case"base64":g=Yo(d);break;case"binary":g=d;break;case"buffer":f.codepage==65001?g=d.toString("utf8"):f.codepage&&typeof Qy<"u"||(g=en&&Buffer.isBuffer(d)?d.toString("binary"):Lf(d));break;case"array":g=g0(d);break;case"string":g=d;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?g=zn(g.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?g=zn(g):f.type=="binary"&&typeof Qy<"u",g.slice(0,19)=="socialcalc:version:"?aU.to_sheet(f.type=="string"?g:zn(g),f):i(g,f)}function c(d,f){return Bf(o(d,f),f)}function u(d){for(var f=[],g=pn(d["!ref"]),p,x=Array.isArray(d),v=g.s.r;v<=g.e.r;++v){for(var w=[],C=g.s.c;C<=g.e.c;++C){var k=Rr({r:v,c:C});if(p=x?(d[v]||[])[C]:d[k],!p||p.v==null){w.push("          ");continue}for(var _=(p.w||(nd(p),p.w)||"").slice(0,10);_.length<10;)_+=" ";w.push(_+(C===0?" ":""))}f.push(w.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function aue(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=nU.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return Tm.to_workbook(e,t)}}var Kh=(function(){function e(R,z,K){if(R){oi(R,R.l||0);for(var J=K.Enum||H;R.l<R.length;){var se=R.read_shift(2),X=J[se]||J[65535],ie=R.read_shift(2),le=R.l+ie,ce=X.f&&X.f(R,ie,K);if(R.l=le,z(ce,X,se))return}}}function t(R,z){switch(z.type){case"base64":return r(Ho(Yo(R)),z);case"binary":return r(Ho(R),z);case"buffer":case"array":return r(R,z)}throw"Unsupported type "+z.type}function r(R,z){if(!R)return R;var K=z||{},J=K.dense?[]:{},se="Sheet1",X="",ie=0,le={},ce=[],be=[],re={s:{r:0,c:0},e:{r:0,c:0}},pe=K.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)K.Enum=H,e(R,function(Le,At,Qe){switch(Qe){case 0:K.vers=Le,Le>=4096&&(K.qpro=!0);break;case 6:re=Le;break;case 204:Le&&(X=Le);break;case 222:X=Le;break;case 15:case 51:K.qpro||(Le[1].v=Le[1].v.slice(1));case 13:case 14:case 16:Qe==14&&(Le[2]&112)==112&&(Le[2]&15)>1&&(Le[2]&15)<15&&(Le[1].z=K.dateNF||Fr[14],K.cellDates&&(Le[1].t="d",Le[1].v=l2(Le[1].v))),K.qpro&&Le[3]>ie&&(J["!ref"]=Xr(re),le[se]=J,ce.push(se),J=K.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ie=Le[3],se=X||"Sheet"+(ie+1),X="");var gt=K.dense?(J[Le[0].r]||[])[Le[0].c]:J[Rr(Le[0])];if(gt){gt.t=Le[1].t,gt.v=Le[1].v,Le[1].z!=null&&(gt.z=Le[1].z),Le[1].f!=null&&(gt.f=Le[1].f);break}K.dense?(J[Le[0].r]||(J[Le[0].r]=[]),J[Le[0].r][Le[0].c]=Le[1]):J[Rr(Le[0])]=Le[1];break}},K);else if(R[2]==26||R[2]==14)K.Enum=W,R[2]==14&&(K.qpro=!0,R.l=0),e(R,function(Le,At,Qe){switch(Qe){case 204:se=Le;break;case 22:Le[1].v=Le[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Le[3]>ie&&(J["!ref"]=Xr(re),le[se]=J,ce.push(se),J=K.dense?[]:{},re={s:{r:0,c:0},e:{r:0,c:0}},ie=Le[3],se="Sheet"+(ie+1)),pe>0&&Le[0].r>=pe)break;K.dense?(J[Le[0].r]||(J[Le[0].r]=[]),J[Le[0].r][Le[0].c]=Le[1]):J[Rr(Le[0])]=Le[1],re.e.c<Le[0].c&&(re.e.c=Le[0].c),re.e.r<Le[0].r&&(re.e.r=Le[0].r);break;case 27:Le[14e3]&&(be[Le[14e3][0]]=Le[14e3][1]);break;case 1537:be[Le[0]]=Le[1],Le[0]==ie&&(se=Le[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(J["!ref"]=Xr(re),le[X||se]=J,ce.push(X||se),!be.length)return{SheetNames:ce,Sheets:le};for(var Ce={},Ae=[],We=0;We<be.length;++We)le[ce[We]]?(Ae.push(be[We]||ce[We]),Ce[be[We]]=le[be[We]]||le[ce[We]]):(Ae.push(be[We]),Ce[be[We]]={"!ref":"A1"});return{SheetNames:Ae,Sheets:Ce}}function n(R,z){var K=z||{};if(+K.codepage>=0&&ac(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Co(),se=pn(R["!ref"]),X=Array.isArray(R),ie=[];er(J,0,a(1030)),er(J,6,c(se));for(var le=Math.min(se.e.r,8191),ce=se.s.r;ce<=le;++ce)for(var be=Xs(ce),re=se.s.c;re<=se.e.c;++re){ce===se.s.r&&(ie[re]=_s(re));var pe=ie[re]+be,Ce=X?(R[ce]||[])[re]:R[pe];if(!(!Ce||Ce.t=="z"))if(Ce.t=="n")(Ce.v|0)==Ce.v&&Ce.v>=-32768&&Ce.v<=32767?er(J,13,p(ce,re,Ce.v)):er(J,14,v(ce,re,Ce.v));else{var Ae=nd(Ce);er(J,15,f(ce,re,Ae.slice(0,239)))}}return er(J,1),J.end()}function s(R,z){var K=z||{};if(+K.codepage>=0&&ac(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Co();er(J,0,i(R));for(var se=0,X=0;se<R.SheetNames.length;++se)(R.Sheets[R.SheetNames[se]]||{})["!ref"]&&er(J,27,M(R.SheetNames[se],X++));var ie=0;for(se=0;se<R.SheetNames.length;++se){var le=R.Sheets[R.SheetNames[se]];if(!(!le||!le["!ref"])){for(var ce=pn(le["!ref"]),be=Array.isArray(le),re=[],pe=Math.min(ce.e.r,8191),Ce=ce.s.r;Ce<=pe;++Ce)for(var Ae=Xs(Ce),We=ce.s.c;We<=ce.e.c;++We){Ce===ce.s.r&&(re[We]=_s(We));var Le=re[We]+Ae,At=be?(le[Ce]||[])[We]:le[Le];if(!(!At||At.t=="z"))if(At.t=="n")er(J,23,I(Ce,We,ie,At.v));else{var Qe=nd(At);er(J,22,F(Ce,We,ie,Qe.slice(0,239)))}}++ie}}return er(J,1),J.end()}function a(R){var z=_t(2);return z.write_shift(2,R),z}function i(R){var z=_t(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var K=0,J=0,se=0,X=0;X<R.SheetNames.length;++X){var ie=R.SheetNames[X],le=R.Sheets[ie];if(!(!le||!le["!ref"])){++se;var ce=To(le["!ref"]);K<ce.e.r&&(K=ce.e.r),J<ce.e.c&&(J=ce.e.c)}}return K>8191&&(K=8191),z.write_shift(2,K),z.write_shift(1,se),z.write_shift(1,J),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(R,z,K){var J={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&K.qpro?(J.s.c=R.read_shift(1),R.l++,J.s.r=R.read_shift(2),J.e.c=R.read_shift(1),R.l++,J.e.r=R.read_shift(2),J):(J.s.c=R.read_shift(2),J.s.r=R.read_shift(2),z==12&&K.qpro&&(R.l+=2),J.e.c=R.read_shift(2),J.e.r=R.read_shift(2),z==12&&K.qpro&&(R.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function c(R){var z=_t(8);return z.write_shift(2,R.s.c),z.write_shift(2,R.s.r),z.write_shift(2,R.e.c),z.write_shift(2,R.e.r),z}function u(R,z,K){var J=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(J[0].c=R.read_shift(1),J[3]=R.read_shift(1),J[0].r=R.read_shift(2),R.l+=2):(J[2]=R.read_shift(1),J[0].c=R.read_shift(2),J[0].r=R.read_shift(2)),J}function d(R,z,K){var J=R.l+z,se=u(R,z,K);if(se[1].t="s",K.vers==20768){R.l++;var X=R.read_shift(1);return se[1].v=R.read_shift(X,"utf8"),se}return K.qpro&&R.l++,se[1].v=R.read_shift(J-R.l,"cstr"),se}function f(R,z,K){var J=_t(7+K.length);J.write_shift(1,255),J.write_shift(2,z),J.write_shift(2,R),J.write_shift(1,39);for(var se=0;se<J.length;++se){var X=K.charCodeAt(se);J.write_shift(1,X>=128?95:X)}return J.write_shift(1,0),J}function g(R,z,K){var J=u(R,z,K);return J[1].v=R.read_shift(2,"i"),J}function p(R,z,K){var J=_t(7);return J.write_shift(1,255),J.write_shift(2,z),J.write_shift(2,R),J.write_shift(2,K,"i"),J}function x(R,z,K){var J=u(R,z,K);return J[1].v=R.read_shift(8,"f"),J}function v(R,z,K){var J=_t(13);return J.write_shift(1,255),J.write_shift(2,z),J.write_shift(2,R),J.write_shift(8,K,"f"),J}function w(R,z,K){var J=R.l+z,se=u(R,z,K);if(se[1].v=R.read_shift(8,"f"),K.qpro)R.l=J;else{var X=R.read_shift(2);N(R.slice(R.l,R.l+X),se),R.l+=X}return se}function C(R,z,K){var J=z&32768;return z&=-32769,z=(J?R:0)+(z>=8192?z-16384:z),(J?"":"$")+(K?_s(z):Xs(z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(R,z){oi(R,0);for(var K=[],J=0,se="",X="",ie="",le="";R.l<R.length;){var ce=R[R.l++];switch(ce){case 0:K.push(R.read_shift(8,"f"));break;case 1:X=C(z[0].c,R.read_shift(2),!0),se=C(z[0].r,R.read_shift(2),!1),K.push(X+se);break;case 2:{var be=C(z[0].c,R.read_shift(2),!0),re=C(z[0].r,R.read_shift(2),!1);X=C(z[0].c,R.read_shift(2),!0),se=C(z[0].r,R.read_shift(2),!1),K.push(be+re+":"+X+se)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(R.read_shift(2));break;case 6:{for(var pe="";ce=R[R.l++];)pe+=String.fromCharCode(ce);K.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:le=K.pop(),ie=K.pop(),K.push(["AND","OR"][ce-20]+"("+ie+","+le+")");break;default:if(ce<32&&_[ce])le=K.pop(),ie=K.pop(),K.push(ie+_[ce]+le);else if(k[ce]){if(J=k[ce][1],J==69&&(J=R[R.l++]),J>K.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+K.join("|")+"|");return}var Ce=K.slice(-J);K.length-=J,K.push(k[ce][0]+"("+Ce.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}K.length==1?z[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function E(R){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=R.read_shift(2),z[3]=R[R.l++],z[0].c=R[R.l++],z}function P(R,z){var K=E(R);return K[1].t="s",K[1].v=R.read_shift(z-4,"cstr"),K}function F(R,z,K,J){var se=_t(6+J.length);se.write_shift(2,R),se.write_shift(1,K),se.write_shift(1,z),se.write_shift(1,39);for(var X=0;X<J.length;++X){var ie=J.charCodeAt(X);se.write_shift(1,ie>=128?95:ie)}return se.write_shift(1,0),se}function A(R,z){var K=E(R);K[1].v=R.read_shift(2);var J=K[1].v>>1;if(K[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return K[1].v=J,K}function j(R,z){var K=E(R),J=R.read_shift(4),se=R.read_shift(4),X=R.read_shift(2);if(X==65535)return J===0&&se===3221225472?(K[1].t="e",K[1].v=15):J===0&&se===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var ie=X&32768;return X=(X&32767)-16446,K[1].v=(1-ie*2)*(se*Math.pow(2,X+32)+J*Math.pow(2,X)),K}function I(R,z,K,J){var se=_t(14);if(se.write_shift(2,R),se.write_shift(1,K),se.write_shift(1,z),J==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var X=0,ie=0,le=0,ce=0;return J<0&&(X=1,J=-J),ie=Math.log2(J)|0,J/=Math.pow(2,ie-31),ce=J>>>0,(ce&2147483648)==0&&(J/=2,++ie,ce=J>>>0),J-=ce,ce|=2147483648,ce>>>=0,J*=Math.pow(2,32),le=J>>>0,se.write_shift(4,le),se.write_shift(4,ce),ie+=16383+(X?32768:0),se.write_shift(2,ie),se}function L(R,z){var K=j(R);return R.l+=z-14,K}function Y(R,z){var K=E(R),J=R.read_shift(4);return K[1].v=J>>6,K}function Z(R,z){var K=E(R),J=R.read_shift(8,"f");return K[1].v=J,K}function ae(R,z){var K=Z(R);return R.l+=z-10,K}function ee(R,z){return R[R.l+z-1]==0?R.read_shift(z,"cstr"):""}function ne(R,z){var K=R[R.l++];K>z-1&&(K=z-1);for(var J="";J.length<K;)J+=String.fromCharCode(R[R.l++]);return J}function B(R,z,K){if(!(!K.qpro||z<21)){var J=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var se=R.read_shift(z-21,"cstr");return[J,se]}}function V(R,z){for(var K={},J=R.l+z;R.l<J;){var se=R.read_shift(2);if(se==14e3){for(K[se]=[0,""],K[se][0]=R.read_shift(2);R[R.l];)K[se][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return K}function M(R,z){var K=_t(5+R.length);K.write_shift(2,14e3),K.write_shift(2,z);for(var J=0;J<R.length;++J){var se=R.charCodeAt(J);K[K.l++]=se>127?95:se}return K[K.l++]=0,K}var H={0:{n:"BOF",f:aa},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:x},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ee},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},W={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:A},25:{n:"FORMULA19",f:L},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:V},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:Y},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:ae},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function iue(e){var t={},r=e.match(Ri),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Lr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=X4[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var oue=(function(){var e=tv("t"),t=tv("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:mn(i[1])},c=a.match(t);return c&&(o.s=iue(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),lue=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),cue=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,uue=/<(?:\w+:)?r>/,due=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function w3(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=mn(zn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=zn(e),r&&(n.h=i3(n.t))):e.match(uue)&&(n.r=zn(e),n.t=mn(zn((e.replace(due,"").match(cue)||[]).join("").replace(Ri,""))),r&&(n.h=lue(oue(n.r)))),n):{t:""}}var fue=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,hue=/<(?:\w+:)?(?:si|sstItem)>/g,gue=/<\/(?:\w+:)?(?:si|sstItem)>/;function mue(e,t){var r=[],n="";if(!e)return r;var s=e.match(fue);if(s){n=s[2].replace(hue,"").split(gue);for(var a=0;a!=n.length;++a){var i=w3(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Lr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var pue=/^\s|\s$|[\t\n\r]/;function iU(e,t){if(!t.bookSST)return"";var r=[Qs];r[r.length]=Zt("sst",null,{xmlns:A0[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(pue)&&(a+=' xml:space="preserve"'),a+=">"+Rn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function xue(e){return[e.read_shift(4),e.read_shift(4)]}function yue(e,t){var r=[],n=!1;return dd(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function vue(e,t){return t||(t=_t(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var wue=joe;function _ue(e){var t=Co();Ot(t,159,vue(e));for(var r=0;r<e.length;++r)Ot(t,19,wue(e[r]));return Ot(t,160),t.end()}function oU(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Yu(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function bue(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Yu(e,4),t.U=Yu(e,4),t.W=Yu(e,4),t}function Sue(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function kue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Sue(e));return t}function Cue(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Tue(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Yu(e,4),t.U=Yu(e,4),t.W=Yu(e,4),t}function Eue(e){var t=Tue(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function lU(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function cU(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Nue(e){var t=Yu(e);switch(t.Minor){case 2:return[t.Minor,Aue(e)];case 3:return[t.Minor,jue()];case 4:return[t.Minor,Pue(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Aue(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=lU(e,r),s=cU(e,e.length-e.l);return{t:"Std",h:n,v:s}}function jue(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Pue(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Ri,function(a){var i=Lr(a);switch(ru(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Fue(e,t){var r={},n=r.EncryptionVersionInfo=Yu(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=lU(e,s),t-=s,r.EncryptionVerifier=cU(e,t),r}function Oue(e){var t={},r=t.EncryptionVersionInfo=Yu(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function _3(e){var t=0,r,n=oU(e),s=n.length+1,a,i,o,c,u;for(r=Tf(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var uU=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=oU(i),c=a(o),u=o.length,d=Tf(16),f=0;f!=16;++f)d[f]=0;var g,p,x;for((u&1)===1&&(g=c>>8,d[u]=s(e[0],g),--u,g=c&255,p=o[o.length-1],d[u]=s(p,g));u>0;)--u,g=c>>8,d[u]=s(o[u],g),--u,g=c&255,d[u]=s(o[u],g);for(u=15,x=15-o.length;x>0;)g=c>>8,d[u]=s(e[x],g),--u,--x,g=c&255,d[u]=s(o[u],g),--u,--x;return d}})(),Due=function(e,t,r,n,s){s||(s=t),n||(n=uU(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},Iue=function(e){var t=0,r=uU(e);return function(n){var s=Due("",n,t,r);return t=s[1],s[0]}};function Rue(e,t,r,n){var s={key:aa(e),verificationBytes:aa(e)};return r.password&&(s.verifier=_3(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=Iue(r.password)),s}function Mue(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Oue(e):n.Data=Fue(e,t),n}function Lue(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Mue(e,t-2,n):Rue(e,r.biff>=8?t:t-2,r,n),n}var dU=(function(){function e(s,a){switch(a.type){case"base64":return t(Yo(s),a);case"binary":return t(s,a);case"buffer":return t(en&&Buffer.isBuffer(s)?s.toString("binary"):Lf(s),a);case"array":return t(g0(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var g=/\\\w+\b/g,p=0,x,v=-1;x=g.exec(d);){switch(x[0]){case"\\cell":var w=d.slice(p,g.lastIndex-x[0].length);if(w[0]==" "&&(w=w.slice(1)),++v,w.length){var C={v:w,t:"s"};Array.isArray(o)?o[f][v]=C:o[Rr({r:f,c:v})]=C}break}p=g.lastIndex}v>u.e.c&&(u.e.c=v)}),o["!ref"]=Xr(u),o}function r(s,a){return Bf(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=pn(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=Rr({r:u,c:d});o=c?(s[u]||[])[d]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(nd(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function Bue(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function av(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function $ue(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function Uue(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function K_(e,t){if(t===0)return e;var r=$ue(Bue(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),av(Uue(r))}var fU=6,zue=15,Wue=1,Ei=fU;function iv(e){return Math.floor((e+Math.round(128/Ei)/256)*Ei)}function ov(e){return Math.floor((e-5)/Ei*100+.5)/100}function q_(e){return Math.round((e*Ei+5)/Ei*256)/256}function kk(e){return q_(ov(iv(e)))}function b3(e){var t=Math.abs(e-kk(e)),r=Ei;if(t>.005)for(Ei=Wue;Ei<zue;++Ei)Math.abs(e-kk(e))<=t&&(t=Math.abs(e-kk(e)),r=Ei);Ei=r}function Ef(e){e.width?(e.wpx=iv(e.width),e.wch=ov(e.wpx),e.MDW=Ei):e.wpx?(e.wch=ov(e.wpx),e.width=q_(e.wch),e.MDW=Ei):typeof e.wch=="number"&&(e.width=q_(e.wch),e.wpx=iv(e.width),e.MDW=Ei),e.customWidth&&delete e.customWidth}var Hue=96,hU=Hue;function lv(e){return e*96/hU}function Em(e){return e*hU/96}var Gue={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Vue(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Ri)||[]).forEach(function(i){var o=Lr(i);switch(ru(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=ns(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=ns(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function Kue(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Ri)||[]).forEach(function(i){var o=Lr(i);switch(ru(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function que(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Ri)||[]).forEach(function(i){var o=Lr(i);switch(ru(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=zn(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?ns(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?ns(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?ns(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?ns(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?ns(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?ns(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?ns(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=X4[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=ns(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Gh[s.color.index];s.color.index==81&&(c=Gh[1]),c||(c=Gh[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=K_(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Yue(e,t,r){t.NumberFmt=[];for(var n=Ls(Fr),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Fr[n[s]];var a=e[0].match(Ri);if(a)for(s=0;s<a.length;++s){var i=Lr(a[s]);switch(ru(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=mn(zn(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}qu(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Xue(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Zt("numFmt",null,{numFmtId:n,formatCode:Rn(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Zt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Pw=["numFmtId","fillId","fontId","borderId","xfId"],Fw=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Jue(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Ri)||[]).forEach(function(a){var i=Lr(a),o=0;switch(ru(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<Pw.length;++o)n[Pw[o]]&&(n[Pw[o]]=parseInt(n[Pw[o]],10));for(o=0;o<Fw.length;++o)n[Fw[o]]&&(n[Fw[o]]=ns(n[Fw[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=ns(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Que(e){var t=[];return t[t.length]=Zt("cellXfs",null),e.forEach(function(r){t[t.length]=Zt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Zt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Zue=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&Yue(f,d,u),(f=o.match(s))&&que(f,d,c,u),(f=o.match(n))&&Kue(f,d,c,u),(f=o.match(a))&&Vue(f,d,c,u),(f=o.match(r))&&Jue(f,d,u),d}})();function gU(e,t){var r=[Qs,Zt("styleSheet",null,{xmlns:A0[0],"xmlns:vt":_a.vt})],n;return e.SSF&&(n=Xue(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Que(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function ede(e,t){var r=e.read_shift(2),n=Oi(e);return[r,n]}function tde(e,t,r){r||(r=_t(6+4*t.length)),r.write_shift(2,e),Ua(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function rde(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=Moe(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=Roe(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Oi(e),n}function nde(e,t){t||(t=_t(153)),t.write_shift(2,e.sz*20),Loe(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),H_(e.color,t);var n=0;return n=2,t.write_shift(1,n),Ua(e.name,t),t.length>t.l?t.slice(0,t.l):t}var sde=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Ck,ade=Ii;function wO(e,t){t||(t=_t(84)),Ck||(Ck=i2(sde));var r=Ck[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(H_({auto:1},t),H_({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function ide(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function mU(e,t,r){r||(r=_t(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Jx(e,t){return t||(t=_t(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var ode=Ii;function lde(e,t){return t||(t=_t(51)),t.write_shift(1,0),Jx(null,t),Jx(null,t),Jx(null,t),Jx(null,t),Jx(null,t),t.length>t.l?t.slice(0,t.l):t}function cde(e,t){return t||(t=_t(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),W_(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function ude(e,t,r){var n=_t(2052);return n.write_shift(4,e),W_(t,n),W_(r,n),n.length>n.l?n.slice(0,n.l):n}function dde(e,t,r){var n={};n.NumberFmt=[];for(var s in Fr)n.NumberFmt[s]=Fr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return dd(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],qu(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=K_(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function fde(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Ot(e,615,cc(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ot(e,44,tde(s,t[s]))}),Ot(e,616))}}function hde(e){var t=1;Ot(e,611,cc(t)),Ot(e,43,nde({sz:12,color:{theme:1},name:"Calibri",family:2})),Ot(e,612)}function gde(e){var t=2;Ot(e,603,cc(t)),Ot(e,45,wO({patternType:"none"})),Ot(e,45,wO({patternType:"gray125"})),Ot(e,604)}function mde(e){var t=1;Ot(e,613,cc(t)),Ot(e,46,lde()),Ot(e,614)}function pde(e){var t=1;Ot(e,626,cc(t)),Ot(e,47,mU({numFmtId:0},65535)),Ot(e,627)}function xde(e,t){Ot(e,617,cc(t.length)),t.forEach(function(r){Ot(e,47,mU(r,0))}),Ot(e,618)}function yde(e){var t=1;Ot(e,619,cc(t)),Ot(e,48,cde({xfId:0,name:"Normal"})),Ot(e,620)}function vde(e){var t=0;Ot(e,505,cc(t)),Ot(e,506)}function wde(e){var t=0;Ot(e,508,ude(t,"TableStyleMedium9","PivotStyleMedium4")),Ot(e,509)}function _de(e,t){var r=Co();return Ot(r,278),fde(r,e.SSF),hde(r),gde(r),mde(r),pde(r),xde(r,t.cellXfs),yde(r),vde(r),wde(r),Ot(r,279),r.end()}var bde=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Sde(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Ri)||[]).forEach(function(s){var a=Lr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[bde.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function kde(){}function Cde(){}var Tde=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Ede=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Nde=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Ade(e,t,r){t.themeElements={};var n;[["clrScheme",Tde,Sde],["fontScheme",Ede,kde],["fmtScheme",Nde,Cde]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var jde=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function pU(e,t){(!e||e.length===0)&&(e=S3());var r,n={};if(!(r=e.match(jde)))throw new Error("themeElements not found in theme");return Ade(r[0],n,t),n.raw=e,n}function S3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Qs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Pde(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=l$(a,{type:"array"})}catch{return}var o=Go(i,"theme/theme/theme1.xml",!0);if(o)return pU(o,r)}}function Fde(e){return e.read_shift(4)}function Ode(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Dde(e,4);break;case 2:t.xclrValue=Y$(e);break;case 3:t.xclrValue=Fde(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Dde(e,t){return Ii(e,t)}function Ide(e,t){return Ii(e,t)}function Rde(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Ode(e);break;case 6:n[1]=Ide(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Mde(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(Rde(e,r-e.l));return{ixfe:n,ext:a}}function Lde(e,t){t.forEach(function(r){r[0]})}function Bde(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Oi(e)}}function $de(e){var t=_t(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Ua(e.name,t),t.slice(0,t.l)}function Ude(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function zde(e){var t=_t(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Wde(e,t){var r=_t(8+2*t.length);return r.write_shift(4,e),Ua(t,r),r.slice(0,r.l)}function Hde(e){return e.l+=4,e.read_shift(4)!=0}function Gde(e,t){var r=_t(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Vde(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return dd(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function Kde(){var e=Co();return Ot(e,332),Ot(e,334,cc(1)),Ot(e,335,$de({name:"XLDAPR",version:12e4,flags:3496657072})),Ot(e,336),Ot(e,339,Wde(1,"XLDAPR")),Ot(e,52),Ot(e,35,cc(514)),Ot(e,4096,cc(0)),Ot(e,4097,vl(1)),Ot(e,36),Ot(e,53),Ot(e,340),Ot(e,337,Gde(1)),Ot(e,51,zde([[1,0]])),Ot(e,338),Ot(e,333),e.end()}function qde(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Ri,function(o){var c=Lr(o);switch(ru(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function xU(){var e=[Qs];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function Yde(e){var t=[];if(!e)return t;var r=1;return(e.match(Ri)||[]).forEach(function(n){var s=Lr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function Xde(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Rr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Jde(e,t,r){var n=[];return dd(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Qde(e,t,r,n){if(!e)return e;var s=n||{},a=!1;dd(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function Zde(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var tm=1024;function yU(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Zt("xml",null,{"xmlns:v":Uo.v,"xmlns:o":Uo.o,"xmlns:x":Uo.x,"xmlns:mv":Uo.mv}).replace(/\/>/,">"),Zt("o:shapelayout",Zt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Zt("v:shapetype",[Zt("v:stroke",null,{joinstyle:"miter"}),Zt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];tm<e*1e3;)tm+=1e3;return t.forEach(function(a){var i=bs(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Zt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Zt("v:fill",c,o),d={on:"t",obscured:"t"};++tm,s=s.concat(["<v:shape"+rv({id:"_x0000_s"+tm,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Zt("v:shadow",null,d),Zt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ui("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),ui("x:AutoFill","False"),ui("x:Row",String(i.r)),ui("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function _O(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=bs(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=pn(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Xr(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function efe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Lr(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=bs(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!f&&!!f[1]&&w3(f[1])||{r:"",t:"",h:""};u.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),u.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=g.h),n.push(u)}}}}),n}function vU(e){var t=[Qs,Zt("comments",null,{xmlns:A0[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=Rn(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(Rn(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(ui("t",Rn(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(ui("t",Rn(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function tfe(e,t){var r=[],n=!1,s={},a=0;return e.replace(Ri,function(o,c){var u=Lr(o);switch(ru(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function rfe(e,t,r){var n=[Qs,Zt("ThreadedComments",null,{xmlns:_a.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Zt("threadedComment",ui("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function nfe(e,t){var r=[],n=!1;return e.replace(Ri,function(a){var i=Lr(a);switch(ru(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function sfe(e){var t=[Qs,Zt("personList",null,{xmlns:_a.TCMNT,"xmlns:x":A0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Zt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function afe(e){var t={};t.iauthor=e.read_shift(4);var r=O0(e);return t.rfx=r.s,t.ref=Rr(r.s),e.l+=16,t}function ife(e,t){return t==null&&(t=_t(36)),t.write_shift(4,e[1].iauthor),tp(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var ofe=Oi;function lfe(e){return Ua(e.slice(0,54))}function cfe(e,t){var r=[],n=[],s={},a=!1;return dd(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function ufe(e){var t=Co(),r=[];return Ot(t,628),Ot(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Ot(t,632,lfe(s.a)))})}),Ot(t,631),Ot(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:bs(n[0]),e:bs(n[0])};Ot(t,635,ife([a,s])),s.t&&s.t.length>0&&Ot(t,637,Foe(s)),Ot(t,636),delete s.iauthor})}),Ot(t,634),Ot(t,629),t.end()}var dfe="application/vnd.ms-office.vbaProject";function ffe(e){var t=Er.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Er.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Er.write(t)}function hfe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Er.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var wU=["xlsb","xlsm","xlam","biff8","xla"];function gfe(){return{"!type":"dialog"}}function mfe(){return{"!type":"dialog"}}function pfe(){return{"!type":"macro"}}function xfe(){return{"!type":"macro"}}var fm=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+_s(d)+(c?"":"$")+Xs(u)}return function(s,a){return t=a,s.replace(e,r)}})(),k3=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,C3=(function(){return function(t,r){return t.replace(k3,function(n,s,a,i,o,c){var u=d3(i)-(a?0:r.c),d=u3(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",g=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+g})}})();function _U(e,t){return e.replace(k3,function(r,n,s,a,i,o){return n+(s=="$"?s+a:_s(d3(a)+t.c))+(i=="$"?i+o:Xs(u3(o)+t.r))})}function yfe(e,t,r){var n=To(t),s=n.s,a=bs(r),i={r:a.r-s.r,c:a.c-s.c};return _U(e,i)}function vfe(e){return e.length!=1}function bO(e){return e.replace(/_xlfn\./g,"")}function na(e){e.l+=1}function Nf(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function bU(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return SU(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Nf(e),o=Nf(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function SU(e){var t=Nf(e),r=Nf(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function wfe(e,t,r){if(r.biff<8)return SU(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Nf(e),i=Nf(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function kU(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return _fe(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Nf(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function _fe(e){var t=Nf(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function bfe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Sfe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return kfe(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function kfe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function Cfe(e,t,r){var n=(e[e.l++]&96)>>5,s=bU(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function Tfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=bU(e,a,r);return[n,s,i]}function Efe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function Nfe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function Afe(e,t,r){var n=(e[e.l++]&96)>>5,s=wfe(e,t-1,r);return[n,s]}function jfe(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function SO(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Pfe(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function Ffe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Ofe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Dfe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Ife(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function CU(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Rfe(e){return e.read_shift(2),CU(e)}function Mfe(e){return e.read_shift(2),CU(e)}function Lfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=kU(e,0,r);return[n,s]}function Bfe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=Sfe(e,0,r);return[n,s]}function $fe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=kU(e,0,r);return[n,s,a]}function Ufe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[Hhe[s],NU[s],n]}function zfe(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Wfe(e);return[s,(a[0]===0?NU:Whe)[a[1]]]}function Wfe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Hfe(e,t,r){e.l+=r&&r.biff==2?3:4}function Gfe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Vfe(e){return e.l++,fd[e.read_shift(1)]}function Kfe(e){return e.l++,e.read_shift(2)}function qfe(e){return e.l++,e.read_shift(1)!==0}function Yfe(e){return e.l++,Ai(e)}function Xfe(e,t,r){return e.l++,Vv(e,t-1,r)}function Jfe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ks(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=fd[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ai(e);break;case 2:r[1]=D0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Qfe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?O0:c2)(e));return s}function Zfe(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=Jfe(e,r.biff);return i}function ehe(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function the(e,t,r){if(r.biff==5)return rhe(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function rhe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function nhe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function she(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function ahe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function ihe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var ohe=Ii,lhe=Ii,che=Ii;function qv(e,t,r){return e.l+=2,[bfe(e)]}function T3(e){return e.l+=6,[]}var uhe=qv,dhe=T3,fhe=T3,hhe=qv;function TU(e){return e.l+=2,[aa(e),e.read_shift(2)&1]}var ghe=qv,mhe=TU,phe=T3,xhe=qv,yhe=qv,vhe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function whe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=vhe[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function _he(e){return e.l+=2,[e.read_shift(4)]}function bhe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function She(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function khe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Che(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function The(e){return e.l+=4,[0,0]}var kO={1:{n:"PtgExp",f:Gfe},2:{n:"PtgTbl",f:che},3:{n:"PtgAdd",f:na},4:{n:"PtgSub",f:na},5:{n:"PtgMul",f:na},6:{n:"PtgDiv",f:na},7:{n:"PtgPower",f:na},8:{n:"PtgConcat",f:na},9:{n:"PtgLt",f:na},10:{n:"PtgLe",f:na},11:{n:"PtgEq",f:na},12:{n:"PtgGe",f:na},13:{n:"PtgGt",f:na},14:{n:"PtgNe",f:na},15:{n:"PtgIsect",f:na},16:{n:"PtgUnion",f:na},17:{n:"PtgRange",f:na},18:{n:"PtgUplus",f:na},19:{n:"PtgUminus",f:na},20:{n:"PtgPercent",f:na},21:{n:"PtgParen",f:na},22:{n:"PtgMissArg",f:na},23:{n:"PtgStr",f:Xfe},26:{n:"PtgSheet",f:bhe},27:{n:"PtgEndSheet",f:She},28:{n:"PtgErr",f:Vfe},29:{n:"PtgBool",f:qfe},30:{n:"PtgInt",f:Kfe},31:{n:"PtgNum",f:Yfe},32:{n:"PtgArray",f:jfe},33:{n:"PtgFunc",f:Ufe},34:{n:"PtgFuncVar",f:zfe},35:{n:"PtgName",f:ehe},36:{n:"PtgRef",f:Lfe},37:{n:"PtgArea",f:Cfe},38:{n:"PtgMemArea",f:nhe},39:{n:"PtgMemErr",f:ohe},40:{n:"PtgMemNoMem",f:lhe},41:{n:"PtgMemFunc",f:she},42:{n:"PtgRefErr",f:ahe},43:{n:"PtgAreaErr",f:Efe},44:{n:"PtgRefN",f:Bfe},45:{n:"PtgAreaN",f:Afe},46:{n:"PtgMemAreaN",f:khe},47:{n:"PtgMemNoMemN",f:Che},57:{n:"PtgNameX",f:the},58:{n:"PtgRef3d",f:$fe},59:{n:"PtgArea3d",f:Tfe},60:{n:"PtgRefErr3d",f:ihe},61:{n:"PtgAreaErr3d",f:Nfe},255:{}},Ehe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Nhe={1:{n:"PtgElfLel",f:TU},2:{n:"PtgElfRw",f:xhe},3:{n:"PtgElfCol",f:uhe},6:{n:"PtgElfRwV",f:yhe},7:{n:"PtgElfColV",f:hhe},10:{n:"PtgElfRadical",f:ghe},11:{n:"PtgElfRadicalS",f:phe},13:{n:"PtgElfColS",f:dhe},15:{n:"PtgElfColSV",f:fhe},16:{n:"PtgElfRadicalLel",f:mhe},25:{n:"PtgList",f:whe},29:{n:"PtgSxName",f:_he},255:{}},Ahe={0:{n:"PtgAttrNoop",f:The},1:{n:"PtgAttrSemi",f:Ife},2:{n:"PtgAttrIf",f:Ofe},4:{n:"PtgAttrChoose",f:Pfe},8:{n:"PtgAttrGoto",f:Ffe},16:{n:"PtgAttrSum",f:Hfe},32:{n:"PtgAttrBaxcel",f:SO},33:{n:"PtgAttrBaxcel",f:SO},64:{n:"PtgAttrSpace",f:Rfe},65:{n:"PtgAttrSpaceSemi",f:Mfe},128:{n:"PtgAttrIfError",f:Dfe},255:{}};function Yv(e,t,r,n){if(n.biff<8)return Ii(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Zfe(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Qfe(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Ii(e,t)),a}function Xv(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=kO[a]||kO[Ehe[a]],(a===24||a===25)&&(s=(a===24?Nhe:Ahe)[e[e.l+1]]),!s||!s.f?Ii(e,t):i.push([s.n,s.f(e,t,r)]);return i}function jhe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Phe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Fhe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function EU(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function CO(e,t,r){var n=EU(e,t,r);return n=="#REF"?n:Fhe(n,r)}function Ti(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,f=0,g=0,p,x="";if(!e[0]||!e[0][0])return"";for(var v=-1,w="",C=0,k=e[0].length;C<k;++C){var _=e[0][C];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),v>=0){switch(e[0][v][1][0]){case 0:w=Ds(" ",e[0][v][1][1]);break;case 1:w=Ds("\r",e[0][v][1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}u=u+w,v=-1}o.push(u+Phe[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Cy(_[1][1],i,s),o.push(Ty(d,a));break;case"PtgRefN":d=r?Cy(_[1][1],r,s):_[1][1],o.push(Ty(d,a));break;case"PtgRef3d":f=_[1][1],d=Cy(_[1][2],i,s),x=CO(n,f,s),o.push(x+"!"+Ty(d,a));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],E=_[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,E==="User"&&(E=P.shift()),o.push(E+"("+P.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":p=eO(_[1][1],r?{s:r}:i,s),o.push(_k(p,s));break;case"PtgArea":p=eO(_[1][1],i,s),o.push(_k(p,s));break;case"PtgArea3d":f=_[1][1],p=_[1][2],x=CO(n,f,s),o.push(x+"!"+_k(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=_[1][2];var F=(n.names||[])[g-1]||(n[0]||[])[g],A=F?F.Name:"SH33TJSNAME"+String(g);A&&A.slice(0,6)=="_xlfn."&&!s.xlfn&&(A=A.slice(6)),o.push(A);break;case"PtgNameX":var j=_[1][1];g=_[1][2];var I;if(s.biff<=5)j<0&&(j=-j),n[j]&&(I=n[j][g]);else{var L="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][g]&&n[j][g].itab>0&&(L=n.SheetNames[n[j][g].itab-1]+"!"):L=n.SheetNames[g-1]+"!"),n[j]&&n[j][g])L+=n[j][g].Name;else if(n[0]&&n[0][g])L+=n[0][g].Name;else{var Y=(EU(n,j,s)||"").split(";;");Y[g-1]?L=Y[g-1]:L+="SH33TJSERRX"}o.push(L);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var Z="(",ae=")";if(v>=0){switch(w="",e[0][v][1][0]){case 2:Z=Ds(" ",e[0][v][1][1])+Z;break;case 3:Z=Ds("\r",e[0][v][1][1])+Z;break;case 4:ae=Ds(" ",e[0][v][1][1])+ae;break;case 5:ae=Ds("\r",e[0][v][1][1])+ae;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}o.push(Z+o.pop()+ae);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var ee={c:r.c,r:r.r};if(n.sharedf[Rr(d)]){var ne=n.sharedf[Rr(d)];o.push(Ti(ne,i,ee,n,s))}else{var B=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(Ti(u[1],i,ee,n,s)),B=!0;break}B||o.push(_[1])}break;case"PtgArray":o.push("{"+jhe(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var V=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&v>=0&&V.indexOf(e[0][C][0])==-1){_=e[0][v];var M=!0;switch(_[1][0]){case 4:M=!1;case 0:w=Ds(" ",_[1][1]);break;case 5:M=!1;case 1:w=Ds("\r",_[1][1]);break;default:if(w="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((M?w:"")+o.pop()+(M?"":w)),v=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function Ohe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ii(e,t-2)];var o=Xv(e,i,r);return t!==i+s&&(a=Yv(e,t-i-s,o,r)),e.l=n,[o,a]}function Dhe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ii(e,t-2)];var o=Xv(e,i,r);return t!==i+s&&(a=Yv(e,t-i-s,o,r)),e.l=n,[o,a]}function Ihe(e,t,r,n){var s=e.l+t,a=Xv(e,n,r),i;return s!==e.l&&(i=Yv(e,s-e.l,a,r)),[a,i]}function Rhe(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Xv(e,a,r);return a==65535?[[],Ii(e,t-2)]:(t!==a+2&&(s=Yv(e,n-a-2,i,r)),[i,s])}function Mhe(e){var t;if(Wu(e,e.l+6)!==65535)return[Ai(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Lhe(e){if(e==null){var t=_t(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return m0(e);return m0(0)}function Tk(e,t,r){var n=e.l+t,s=nu(e);r.biff==2&&++e.l;var a=Mhe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Dhe(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function Bhe(e,t,r,n,s){var a=x0(t,r,s),i=Lhe(e.v),o=_t(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=_t(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Ba([a,i,o,u]);return f}function u2(e,t,r){var n=e.read_shift(4),s=Xv(e,n,r),a=e.read_shift(4),i=a>0?Yv(e,a,s,r):null;return[s,i]}var $he=u2,d2=u2,Uhe=u2,zhe=u2,Whe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},NU={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Hhe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function TO(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Ghe(e){var t="of:="+e.replace(k3,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Ek(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Vhe(e){return e.replace(/\./,"!")}var Ny={},hm={},Ay=typeof Map<"u";function E3(e,t,r){var n=0,s=e.length;if(r){if(Ay?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Ay?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Ay?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function f2(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ei=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ov(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=q_(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function qh(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $f(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){qu(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function AU(e,t,r,n,s,a){try{n.cellNF&&(e.z=Fr[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=is(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Fr[t]==null&&qu(Wie[t]||"General",t),e.t==="e")e.w=e.w||fd[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ev(e.v);else if(e.t==="d"){var i=Sa(e.v);(i|0)===i?e.w=i.toString(10):e.w=ev(i)}else{if(e.v===void 0)return"";e.w=h0(e.v,hm)}else e.t==="d"?e.w=Al(t,Sa(e.v),hm):e.w=Al(t,e.v,hm)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=K_(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=K_(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function Khe(e,t,r){if(e&&e["!ref"]){var n=pn(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qhe(e,t){var r=pn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Xr(r))}var Yhe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Xhe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Jhe=/<(?:\w:)?hyperlink [^>]*>/mg,Qhe=/"(\w*:\w*)"/,Zhe=/<(?:\w:)?col\b[^>]*[\/]?>/g,e0e=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,t0e=/<(?:\w:)?pageMargins[^>]*\/>/g,jU=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,r0e=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,n0e=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function s0e(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(Xhe);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var g=u.match(jU);g?N3(g[0],o,s,r):(g=u.match(r0e))&&i0e(g[0],g[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var x=u.slice(p,p+50).match(Qhe);x&&qhe(o,x[1])}var v=u.match(n0e);v&&v[1]&&v0e(v[1],s);var w=[];if(t.cellStyles){var C=u.match(Zhe);C&&g0e(w,C)}f&&b0e(f[1],o,t,c,a,i);var k=d.match(e0e);k&&(o["!autofilter"]=p0e(k[0]));var _=[],N=d.match(Yhe);if(N)for(p=0;p!=N.length;++p)_[p]=pn(N[p].slice(N[p].indexOf('"')+1));var E=d.match(Jhe);E&&d0e(o,E,n);var P=d.match(t0e);if(P&&(o["!margins"]=f0e(Lr(P[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Xr(c)),t.sheetRows>0&&o["!ref"]){var F=pn(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>c.e.r&&(F.e.r=c.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>c.e.c&&(F.e.c=c.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Xr(F))}return w.length>0&&(o["!cols"]=w),_.length>0&&(o["!merges"]=_),o}function a0e(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Xr(e[r])+'"/>';return t+"</mergeCells>"}function N3(e,t,r,n){var s=Lr(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=mn(zn(s.codeName)))}function i0e(e,t,r,n,s){N3(e.slice(0,e.indexOf(">")),r,n,s)}function o0e(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Hc(Rn(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Zt("outlinePr",null,u)}!a&&!o||(s[s.length]=Zt("sheetPr",o,i))}var l0e=["objects","scenarios","selectLockedCells","selectUnlockedCells"],c0e=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function u0e(e){var t={sheet:1};return l0e.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),c0e.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=_3(e.password).toString(16).toUpperCase()),Zt("sheetProtection",null,t)}function d0e(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Lr(zn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+mn(a.location))):(a.Target="#"+mn(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=pn(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=Rr({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function f0e(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function h0e(e){return qh(e),Zt("pageMargins",null,e)}function g0e(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Lr(t[n],!0);s.hidden&&(s.hidden=ns(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,b3(s.width)),Ef(s);a<=i;)e[a++]=os(s)}}function m0e(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Zt("col",null,f2(s,n)));return r[r.length]="</cols>",r.join("")}function p0e(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function x0e(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Xr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=To(s);i.s.r==i.e.r&&(i.e.r=To(t["!ref"]).e.r,s=Xr(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Zt("autoFilter",null,{ref:s})}var y0e=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function v0e(e,t){t.Views||(t.Views=[{}]),(e.match(y0e)||[]).forEach(function(r,n){var s=Lr(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),ns(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function w0e(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Zt("sheetViews",Zt("sheetView",null,s),{})}function _0e(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=fd[e.v];break;case"d":n&&n.cellDates?s=is(e.v,-1).toISOString():(e=os(e),e.t="n",s=""+(e.v=Sa(is(e.v)))),typeof e.z>"u"&&(e.z=Fr[14]);break;default:s=e.v;break}var o=ui("v",Rn(s)),c={r:t},u=$f(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=ui("v",""+E3(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Zt("f",Rn(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Zt("c",o,c)}var b0e=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=tv("v"),i=tv("f");return function(c,u,d,f,g,p){for(var x=0,v="",w=[],C=[],k=0,_=0,N=0,E="",P,F,A=0,j=0,I,L,Y=0,Z=0,ae=Array.isArray(p.CellXf),ee,ne=[],B=[],V=Array.isArray(u),M=[],H={},W=!1,R=!!d.sheetStubs,z=c.split(t),K=0,J=z.length;K!=J;++K){v=z[K].trim();var se=v.length;if(se!==0){var X=0;e:for(x=0;x<se;++x)switch(v[x]){case">":if(v[x-1]!="/"){++x;break e}if(d&&d.cellStyles){if(F=Lr(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,d.sheetRows&&d.sheetRows<A)continue;H={},W=!1,F.ht&&(W=!0,H.hpt=parseFloat(F.ht),H.hpx=Em(H.hpt)),F.hidden=="1"&&(W=!0,H.hidden=!0),F.outlineLevel!=null&&(W=!0,H.level=+F.outlineLevel),W&&(M[A-1]=H)}break;case"<":X=x;break}if(X>=x)break;if(F=Lr(v.slice(X,x),!0),A=F.r!=null?parseInt(F.r,10):A+1,j=-1,!(d.sheetRows&&d.sheetRows<A)){f.s.r>A-1&&(f.s.r=A-1),f.e.r<A-1&&(f.e.r=A-1),d&&d.cellStyles&&(H={},W=!1,F.ht&&(W=!0,H.hpt=parseFloat(F.ht),H.hpx=Em(H.hpt)),F.hidden=="1"&&(W=!0,H.hidden=!0),F.outlineLevel!=null&&(W=!0,H.level=+F.outlineLevel),W&&(M[A-1]=H)),w=v.slice(x).split(e);for(var ie=0;ie!=w.length&&w[ie].trim().charAt(0)=="<";++ie);for(w=w.slice(ie),x=0;x!=w.length;++x)if(v=w[x].trim(),v.length!==0){if(C=v.match(r),k=x,_=0,N=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,C!=null&&C.length===2){for(k=0,E=C[1],_=0;_!=E.length&&!((N=E.charCodeAt(_)-64)<1||N>26);++_)k=26*k+N;--k,j=k}else++j;for(_=0;_!=v.length&&v.charCodeAt(_)!==62;++_);if(++_,F=Lr(v.slice(0,_),!0),F.r||(F.r=Rr({r:A-1,c:j})),E=v.slice(_),P={t:""},(C=E.match(a))!=null&&C[1]!==""&&(P.v=mn(C[1])),d.cellFormula){if((C=E.match(i))!=null&&C[1]!==""){if(P.f=mn(zn(C[1])).replace(/\r\n/g,`
`),d.xlfn||(P.f=bO(P.f)),C[0].indexOf('t="array"')>-1)P.F=(E.match(s)||[])[1],P.F.indexOf(":")>-1&&ne.push([pn(P.F),P.F]);else if(C[0].indexOf('t="shared"')>-1){L=Lr(C[0]);var le=mn(zn(C[1]));d.xlfn||(le=bO(le)),B[parseInt(L.si,10)]=[L,le,F.r]}}else(C=E.match(/<f[^>]*\/>/))&&(L=Lr(C[0]),B[L.si]&&(P.f=yfe(B[L.si][1],B[L.si][2],F.r)));var ce=bs(F.r);for(_=0;_<ne.length;++_)ce.r>=ne[_][0].s.r&&ce.r<=ne[_][0].e.r&&ce.c>=ne[_][0].s.c&&ce.c<=ne[_][0].e.c&&(P.F=ne[_][1])}if(F.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(R)P.t="z";else continue;else P.t=F.t||"n";switch(f.s.c>j&&(f.s.c=j),f.e.c<j&&(f.e.c=j),P.t){case"n":if(P.v==""||P.v==null){if(!R)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!R)continue;P.t="z"}else I=Ny[parseInt(P.v,10)],P.v=I.t,P.r=I.r,d.cellHTML&&(P.h=I.h);break;case"str":P.t="s",P.v=P.v!=null?zn(P.v):"",d.cellHTML&&(P.h=i3(P.v));break;case"inlineStr":C=E.match(n),P.t="s",C!=null&&(I=w3(C[1]))?(P.v=I.t,d.cellHTML&&(P.h=I.h)):P.v="";break;case"b":P.v=ns(P.v);break;case"d":d.cellDates?P.v=is(P.v,1):(P.v=Sa(is(P.v,1)),P.t="n");break;case"e":(!d||d.cellText!==!1)&&(P.w=P.v),P.v=F$[P.v];break}if(Y=Z=0,ee=null,ae&&F.s!==void 0&&(ee=p.CellXf[F.s],ee!=null&&(ee.numFmtId!=null&&(Y=ee.numFmtId),d.cellStyles&&ee.fillId!=null&&(Z=ee.fillId))),AU(P,Y,Z,d,g,p),d.cellDates&&ae&&P.t=="n"&&Qm(Fr[Y])&&(P.t="d",P.v=l2(P.v)),F.cm&&d.xlmeta){var be=(d.xlmeta.Cell||[])[+F.cm-1];be&&be.type=="XLDAPR"&&(P.D=!0)}if(V){var re=bs(F.r);u[re.r]||(u[re.r]=[]),u[re.r][re.c]=P}else u[F.r]=P}}}}M.length>0&&(u["!rows"]=M)}})();function S0e(e,t,r,n){var s=[],a=[],i=pn(e["!ref"]),o="",c,u="",d=[],f=0,g=0,p=e["!rows"],x=Array.isArray(e),v={r:u},w,C=-1;for(g=i.s.c;g<=i.e.c;++g)d[g]=_s(g);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=Xs(f),g=i.s.c;g<=i.e.c;++g){c=d[g]+u;var k=x?(e[f]||[])[g]:e[c];k!==void 0&&(o=_0e(k,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[f])&&(v={r:u},p&&p[f]&&(w=p[f],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=lv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level)),s[s.length]=Zt("row",a.join(""),v))}if(p)for(;f<p.length;++f)p&&p[f]&&(v={r:f+1},w=p[f],w.hidden&&(v.hidden=1),C=-1,w.hpx?C=lv(w.hpx):w.hpt&&(C=w.hpt),C>-1&&(v.ht=C,v.customHeight=1),w.level&&(v.outlineLevel=w.level),s[s.length]=Zt("row","",v));return s.join("")}function PU(e,t,r,n){var s=[Qs,Zt("worksheet",null,{xmlns:A0[0],"xmlns:r":_a.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=pn(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Xr(d)}n||(n={}),c["!comments"]=[];var f=[];o0e(c,r,e,t,s),s[s.length]=Zt("dimension",null,{ref:u}),s[s.length]=w0e(c,t,e,r),t.sheetFormat&&(s[s.length]=Zt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=m0e(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=S0e(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=u0e(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=x0e(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=a0e(c["!merges"]));var g=-1,p,x=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(v){v[1].Target&&(p={ref:v[0]},v[1].Target.charAt(0)!="#"&&(x=Dn(n,-1,Rn(v[1].Target).replace(/#.*$/,""),an.HLINK),p["r:id"]="rId"+x),(g=v[1].Target.indexOf("#"))>-1&&(p.location=Rn(v[1].Target.slice(g+1))),v[1].Tooltip&&(p.tooltip=Rn(v[1].Tooltip)),s[s.length]=Zt("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=h0e(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=ui("ignoredErrors",Zt("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(x=Dn(n,-1,"../drawings/drawing"+(e+1)+".xml",an.DRAW),s[s.length]=Zt("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=f),c["!comments"].length>0&&(x=Dn(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",an.VML),s[s.length]=Zt("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function k0e(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function C0e(e,t,r){var n=_t(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=lv(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,g=-1,p=d<<10;p<d+1<<10;++p){u.c=p;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[Rr(u)];x&&(f<0&&(f=p),g=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,g))}var v=n.l;return n.l=c,n.write_shift(4,o),n.l=v,n.length>n.l?n.slice(0,n.l):n}function T0e(e,t,r,n){var s=C0e(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Ot(e,0,s)}var E0e=O0,N0e=tp;function A0e(){}function j0e(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Ooe(e),r}function P0e(e,t,r){r==null&&(r=_t(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return H_({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),E$(e,r),r.slice(0,r.l)}function F0e(e){var t=Dl(e);return[t]}function O0e(e,t,r){return r==null&&(r=_t(8)),j0(t,r)}function D0e(e){var t=P0(e);return[t]}function I0e(e,t,r){return r==null&&(r=_t(4)),F0(t,r)}function R0e(e){var t=Dl(e),r=e.read_shift(1);return[t,r,"b"]}function M0e(e,t,r){return r==null&&(r=_t(9)),j0(t,r),r.write_shift(1,e.v?1:0),r}function L0e(e){var t=P0(e),r=e.read_shift(1);return[t,r,"b"]}function B0e(e,t,r){return r==null&&(r=_t(5)),F0(t,r),r.write_shift(1,e.v?1:0),r}function $0e(e){var t=Dl(e),r=e.read_shift(1);return[t,r,"e"]}function U0e(e,t,r){return r==null&&(r=_t(9)),j0(t,r),r.write_shift(1,e.v),r}function z0e(e){var t=P0(e),r=e.read_shift(1);return[t,r,"e"]}function W0e(e,t,r){return r==null&&(r=_t(8)),F0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function H0e(e){var t=Dl(e),r=e.read_shift(4);return[t,r,"s"]}function G0e(e,t,r){return r==null&&(r=_t(12)),j0(t,r),r.write_shift(4,t.v),r}function V0e(e){var t=P0(e),r=e.read_shift(4);return[t,r,"s"]}function K0e(e,t,r){return r==null&&(r=_t(8)),F0(t,r),r.write_shift(4,t.v),r}function q0e(e){var t=Dl(e),r=Ai(e);return[t,r,"n"]}function Y0e(e,t,r){return r==null&&(r=_t(16)),j0(t,r),m0(e.v,r),r}function FU(e){var t=P0(e),r=Ai(e);return[t,r,"n"]}function X0e(e,t,r){return r==null&&(r=_t(12)),F0(t,r),m0(e.v,r),r}function J0e(e){var t=Dl(e),r=m3(e);return[t,r,"n"]}function Q0e(e,t,r){return r==null&&(r=_t(12)),j0(t,r),N$(e.v,r),r}function Z0e(e){var t=P0(e),r=m3(e);return[t,r,"n"]}function ege(e,t,r){return r==null&&(r=_t(8)),F0(t,r),N$(e.v,r),r}function tge(e){var t=Dl(e),r=f3(e);return[t,r,"is"]}function rge(e){var t=Dl(e),r=Oi(e);return[t,r,"str"]}function nge(e,t,r){return r==null&&(r=_t(12+4*e.v.length)),j0(t,r),Ua(e.v,r),r.length>r.l?r.slice(0,r.l):r}function sge(e){var t=P0(e),r=Oi(e);return[t,r,"str"]}function age(e,t,r){return r==null&&(r=_t(8+4*e.v.length)),F0(t,r),Ua(e.v,r),r.length>r.l?r.slice(0,r.l):r}function ige(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}function oge(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}function lge(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=Ai(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}function cge(e,t,r){var n=e.l+t,s=Dl(e);s.r=r["!row"];var a=Oi(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=d2(e,n-e.l,r);i[3]=Ti(o,null,s,r.supbooks,r)}else e.l=n;return i}var uge=O0,dge=tp;function fge(e,t){return t==null&&(t=_t(4)),t.write_shift(4,e),t}function hge(e,t){var r=e.l+t,n=O0(e),s=h3(e),a=Oi(e),i=Oi(e),o=Oi(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function gge(e,t){var r=_t(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));tp({s:bs(e[0]),e:bs(e[0])},r),g3("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Ua(s||"",r),Ua(e[1].Tooltip||"",r),Ua("",r),r.slice(0,r.l)}function mge(){}function pge(e,t,r){var n=e.l+t,s=A$(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=$he(e,n-e.l,r);i[1]=o}else e.l=n;return i}function xge(e,t,r){var n=e.l+t,s=O0(e),a=[s];if(r.cellFormula){var i=zhe(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function yge(e,t,r){r==null&&(r=_t(18));var n=f2(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var OU=["left","right","top","bottom","header","footer"];function vge(e){var t={};return OU.forEach(function(r){t[r]=Ai(e)}),t}function wge(e,t){return t==null&&(t=_t(48)),qh(e),OU.forEach(function(r){m0(e[r],t)}),t}function _ge(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function bge(e,t,r){r==null&&(r=_t(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Sge(e){var t=_t(24);return t.write_shift(4,4),t.write_shift(4,1),tp(e,t),t}function kge(e,t){return t==null&&(t=_t(66)),t.write_shift(2,e.password?_3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Cge(){}function Tge(){}function Ege(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,g=!1,p,x,v,w,C,k,_,N,E,P=[];o.biff=12,o["!row"]=0;var F=0,A=!1,j=[],I={},L=o.supbooks||s.supbooks||[[]];if(L.sharedf=I,L.arrayf=j,L.SheetNames=s.SheetNames||s.Sheets.map(function(V){return V.name}),!o.supbooks&&(o.supbooks=L,s.Names))for(var Y=0;Y<s.Names.length;++Y)L[0][Y+1]=s.Names[Y];var Z=[],ae=[],ee=!1;cv[16]={n:"BrtShortReal",f:FU};var ne;if(dd(e,function(M,H,W){if(!g)switch(W){case 148:u=M;break;case 0:p=M,o.sheetRows&&o.sheetRows<=p.r&&(g=!0),N=Xs(w=p.r),o["!row"]=p.r,(M.hidden||M.hpt||M.level!=null)&&(M.hpt&&(M.hpx=Em(M.hpt)),ae[M.r]=M);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(x={t:M[2]},M[2]){case"n":x.v=M[1];break;case"s":_=Ny[M[1]],x.v=_.t,x.r=_.r;break;case"b":x.v=!!M[1];break;case"e":x.v=M[1],o.cellText!==!1&&(x.w=fd[x.v]);break;case"str":x.t="s",x.v=M[1];break;case"is":x.t="s",x.v=M[1].t;break}if((v=i.CellXf[M[0].iStyleRef])&&AU(x,v.numFmtId,null,o,a,i),C=M[0].c==-1?C+1:M[0].c,o.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[_s(C)+N]=x,o.cellFormula){for(A=!1,F=0;F<j.length;++F){var R=j[F];p.r>=R[0].s.r&&p.r<=R[0].e.r&&C>=R[0].s.c&&C<=R[0].e.c&&(x.F=Xr(R[0]),A=!0)}!A&&M.length>3&&(x.f=M[3])}if(d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),o.cellDates&&v&&x.t=="n"&&Qm(Fr[v.numFmtId])){var z=Dh(x.v);z&&(x.t="d",x.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;x={t:"z",v:void 0},C=M[0].c==-1?C+1:M[0].c,o.dense?(c[w]||(c[w]=[]),c[w][C]=x):c[_s(C)+N]=x,d.s.r>p.r&&(d.s.r=p.r),d.s.c>C&&(d.s.c=C),d.e.r<p.r&&(d.e.r=p.r),d.e.c<C&&(d.e.c=C),ne&&(ne.type=="XLDAPR"&&(x.D=!0),ne=void 0);break;case 176:P.push(M);break;case 49:ne=((o.xlmeta||{}).Cell||[])[M-1];break;case 494:var K=n["!id"][M.relId];for(K?(M.Target=K.Target,M.loc&&(M.Target+="#"+M.loc),M.Rel=K):M.relId==""&&(M.Target="#"+M.loc),w=M.rfx.s.r;w<=M.rfx.e.r;++w)for(C=M.rfx.s.c;C<=M.rfx.e.c;++C)o.dense?(c[w]||(c[w]=[]),c[w][C]||(c[w][C]={t:"z",v:void 0}),c[w][C].l=M):(k=Rr({c:C,r:w}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=M);break;case 426:if(!o.cellFormula)break;j.push(M),E=o.dense?c[w][C]:c[_s(C)+N],E.f=Ti(M[1],d,{r:p.r,c:C},L,o),E.F=Xr(M[0]);break;case 427:if(!o.cellFormula)break;I[Rr(M[0].s)]=M[1],E=o.dense?c[w][C]:c[_s(C)+N],E.f=Ti(M[1],d,{r:p.r,c:C},L,o);break;case 60:if(!o.cellStyles)break;for(;M.e>=M.s;)Z[M.e--]={width:M.w/256,hidden:!!(M.flags&1),level:M.level},ee||(ee=!0,b3(M.w/256)),Ef(Z[M.e+1]);break;case 161:c["!autofilter"]={ref:Xr(M)};break;case 476:c["!margins"]=M;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),M.name&&(s.Sheets[r].CodeName=M.name),(M.above||M.left)&&(c["!outline"]={above:M.above,left:M.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),M.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!H.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+W.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Xr(u||d)),o.sheetRows&&c["!ref"]){var B=pn(c["!ref"]);o.sheetRows<=+B.e.r&&(B.e.r=o.sheetRows-1,B.e.r>d.e.r&&(B.e.r=d.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>d.e.c&&(B.e.c=d.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Xr(B))}return P.length>0&&(c["!merges"]=P),Z.length>0&&(c["!cols"]=Z),ae.length>0&&(c["!rows"]=ae),c}function Nge(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=os(t),t.z=t.z||Fr[14],t.v=Sa(is(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=$f(s.cellXfs,t,s),t.l&&a["!links"].push([Rr(c),t.l]),t.c&&a["!comments"].push([Rr(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=E3(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?Ot(e,18,K0e(t,c)):Ot(e,7,G0e(t,c))):(c.t="str",i?Ot(e,17,age(t,c)):Ot(e,6,nge(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?Ot(e,13,ege(t,c)):Ot(e,2,Q0e(t,c)):i?Ot(e,16,X0e(t,c)):Ot(e,5,Y0e(t,c)),!0;case"b":return c.t="b",i?Ot(e,15,B0e(t,c)):Ot(e,4,M0e(t,c)),!0;case"e":return c.t="e",i?Ot(e,14,W0e(t,c)):Ot(e,3,U0e(t,c)),!0}return i?Ot(e,12,I0e(t,c)):Ot(e,1,O0e(t,c)),!0}function Age(e,t,r,n){var s=pn(t["!ref"]||"A1"),a,i="",o=[];Ot(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=Xs(d),T0e(e,t,s,d);var f=!1;if(d<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){d===s.s.r&&(o[g]=_s(g)),a=o[g]+i;var p=c?(t[d]||[])[g]:t[a];if(!p){f=!1;continue}f=Nge(e,p,d,g,n,t,f)}}Ot(e,146)}function jge(e,t){!t||!t["!merges"]||(Ot(e,177,fge(t["!merges"].length)),t["!merges"].forEach(function(r){Ot(e,176,dge(r))}),Ot(e,178))}function Pge(e,t){!t||!t["!cols"]||(Ot(e,390),t["!cols"].forEach(function(r,n){r&&Ot(e,60,yge(n,r))}),Ot(e,391))}function Fge(e,t){!t||!t["!ref"]||(Ot(e,648),Ot(e,649,Sge(pn(t["!ref"]))),Ot(e,650))}function Oge(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=Dn(r,-1,n[1].Target.replace(/#.*$/,""),an.HLINK);Ot(e,494,gge(n,s))}}),delete t["!links"]}function Dge(e,t,r,n){if(t["!comments"].length>0){var s=Dn(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",an.VML);Ot(e,551,g3("rId"+s)),t["!legacy"]=s}}function Ige(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Xr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=To(a);o.s.r==o.e.r&&(o.e.r=To(t["!ref"]).e.r,a=Xr(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ot(e,161,tp(pn(a))),Ot(e,162)}}function Rge(e,t,r){Ot(e,133),Ot(e,137,bge(t,r)),Ot(e,138),Ot(e,134)}function Mge(e,t){t["!protect"]&&Ot(e,535,kge(t["!protect"]))}function Lge(e,t,r,n){var s=Co(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=pn(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Ot(s,129),(r.vbaraw||i["!outline"])&&Ot(s,147,P0e(o,i["!outline"])),Ot(s,148,N0e(c)),Rge(s,i,r.Workbook),Pge(s,i),Age(s,i,e,t),Mge(s,i),Ige(s,i,r,e),jge(s,i),Oge(s,i,n),i["!margins"]&&Ot(s,476,wge(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&Fge(s,i),Dge(s,i,e,n),Ot(s,130),s.end()}function Bge(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=mn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function $ge(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var g=Bge(f);d.s.r=d.s.c=0,d.e.c=o,u=_s(o),g[0].forEach(function(p,x){i[u+Xs(x)]={t:"n",v:p,z:g[1]},c=x}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=Xr(d)),i}function Uge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(jU);return o&&N3(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function zge(e,t){e.l+=10;var r=Oi(e);return{name:r}}function Wge(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return dd(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var A3=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Hge=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Gge=[],Vge=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function EO(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=ns(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function NO(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ns(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function DU(e){NO(e.WBProps,A3),NO(e.CalcPr,Vge),EO(e.WBView,Hge),EO(e.Sheets,Gge),hm.date1904=ns(e.WBProps.date1904)}function Kge(e){return!e.Workbook||!e.Workbook.WBProps?"false":ns(e.Workbook.WBProps.date1904)?"true":"false"}var qge="][*?/\\".split("");function IU(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return qge.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Yge(e,t,r){e.forEach(function(n,s){IU(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function Xge(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Yge(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Khe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Jge=/<\w+:workbook/;function Qge(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Ri,function(c,u){var d=Lr(c);switch(ru(d[0])){case"<?xml":break;case"<workbook":c.match(Jge)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":A3.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=ns(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=zn(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=mn(zn(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=zn(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),ns(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=mn(zn(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),A0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return DU(r),r}function RU(e){var t=[Qs];t[t.length]=Zt("workbook",null,{xmlns:A0[0],"xmlns:r":_a.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(A3.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Zt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:Rn(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Zt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Zt("definedName",Rn(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Zge(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=hE(e),r.name=Oi(e),r}function eme(e,t){return t||(t=_t(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),g3(e.strRelID,t),Ua(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function tme(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Oi(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function rme(e,t){t||(t=_t(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),E$(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function nme(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function sme(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=Doe(e),i=Uhe(e,0,r),o=h3(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function ame(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],cv[16]={n:"BrtFRTArchID$",f:nme},dd(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Ti(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),DU(r),r.Names=a,r.supbooks=i,r}function ime(e,t){Ot(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Ot(e,156,eme(s))}Ot(e,144)}function ome(e,t){t||(t=_t(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Ua("SheetJS",t),Ua(M_.version,t),Ua(M_.version,t),Ua("7262",t),t.length>t.l?t.slice(0,t.l):t}function lme(e,t){t||(t=_t(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function cme(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Ot(e,135),Ot(e,158,lme(s)),Ot(e,136))}}function ume(e,t){var r=Co();return Ot(r,131),Ot(r,128,ome()),Ot(r,153,rme(e.Workbook&&e.Workbook.WBProps||null)),cme(r,e),ime(r,e),Ot(r,132),r.end()}function dme(e,t,r){return t.slice(-4)===".bin"?ame(e,r):Qge(e,r)}function fme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Ege(e,n,r,s,a,i,o):s0e(e,n,r,s,a,i,o)}function hme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Wge(e,n,r,s,a):Uge(e,n,r,s,a)}function gme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?pfe():xfe()}function mme(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?gfe():mfe()}function pme(e,t,r,n){return t.slice(-4)===".bin"?dde(e,r,n):Zue(e,r,n)}function xme(e,t,r){return pU(e,r)}function yme(e,t,r){return t.slice(-4)===".bin"?yue(e,r):mue(e,r)}function vme(e,t,r){return t.slice(-4)===".bin"?cfe(e,r):efe(e,r)}function wme(e,t,r){return t.slice(-4)===".bin"?Jde(e):Yde(e)}function _me(e,t,r,n){return r.slice(-4)===".bin"?Qde(e,t,r,n):void 0}function bme(e,t,r){return t.slice(-4)===".bin"?Vde(e,t,r):qde(e,t,r)}function Sme(e,t,r){return(t.slice(-4)===".bin"?ume:RU)(e)}function kme(e,t,r,n,s){return(t.slice(-4)===".bin"?Lge:PU)(e,r,n,s)}function Cme(e,t,r){return(t.slice(-4)===".bin"?_de:gU)(e,r)}function Tme(e,t,r){return(t.slice(-4)===".bin"?_ue:iU)(e,r)}function Eme(e,t,r){return(t.slice(-4)===".bin"?ufe:vU)(e)}function Nme(e){return(e.slice(-4)===".bin"?Kde:xU)()}var MU=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,LU=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Zl(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(MU),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(LU),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function Ame(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(MU),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(LU),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var jy;function jme(e,t){var r=jy[e]||mn(e);return r==="General"?h0(t):Al(r,t)}function Pme(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ns(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=is(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[mn(t)]=s}function Fme(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||fd[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ev(e.v):e.w=h0(e.v):e.w=jme(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=jy[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Qm(n)){var s=Dh(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function Ome(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Gue[n.Pattern]||n.Pattern)}e[t.ID]=t}function Dme(e,t,r,n,s,a,i,o,c,u){var d="General",f=n.StyleID,g={};u=u||{};var p=[],x=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&p.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ns(e);break;case"String":n.t="s",n.r=GF(mn(e)),n.v=e.indexOf("<")>-1?mn(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(is(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=mn(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=F$[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=GF(t||e));break}if(Fme(n,d,u),u.cellFormula!==!1)if(n.Formula){var v=mn(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=fm(v,s),delete n.Formula,n.ArrayRange=="RC"?n.F=fm("RC:RC",s):n.ArrayRange&&(n.F=fm(n.ArrayRange,s),c.push([pn(n.F),n.F]))}else for(x=0;x<c.length;++x)s.r>=c[x][0].s.r&&s.r<=c[x][0].e.r&&s.c>=c[x][0].s.c&&s.c<=c[x][0].e.c&&(n.F=c[x][1]);u.cellStyles&&(p.forEach(function(w){!g.patternType&&w.patternType&&(g.patternType=w.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function Ime(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Nk(e,t){var r=t||{};Zm();var n=cy(o3(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=zn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=os(r);return i.type="string",Tm.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(At){s.indexOf("<"+At)>=0&&(a=!0)}),a)return wpe(n,r);jy={"General Number":"General","General Date":Fr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Fr[15],"Short Date":Fr[14],"Long Time":Fr[19],"Medium Time":Fr[18],"Short Time":Fr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Fr[2],Standard:Fr[4],Percent:Fr[10],Scientific:Fr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],g=r.dense?[]:{},p="",x={},v={},w=Zl('<Data ss:Type="String">'),C=0,k=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},P={},F="",A=0,j=[],I={},L={},Y=0,Z=[],ae=[],ee={},ne=[],B,V=!1,M=[],H=[],W={},R=0,z=0,K={Sheets:[],WBProps:{date1904:!1}},J={};nv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";o=nv.exec(n);)switch(o[3]=(se=o[3]).toLowerCase()){case"data":if(se=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?Dme(n.slice(C,o.index),F,w,c[c.length-1][0]=="comment"?ee:x,{c:k,r:_},E,ne[k],v,M,r):(F="",w=Zl(o[0]),C=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(ae.length>0&&(x.c=ae),(!r.sheetRows||r.sheetRows>_)&&x.v!==void 0&&(r.dense?(g[_]||(g[_]=[]),g[_][k]=x):g[_s(k)+Xs(_)]=x),x.HRef&&(x.l={Target:mn(x.HRef)},x.HRefScreenTip&&(x.l.Tooltip=x.HRefScreenTip),delete x.HRef,delete x.HRefScreenTip),(x.MergeAcross||x.MergeDown)&&(R=k+(parseInt(x.MergeAcross,10)|0),z=_+(parseInt(x.MergeDown,10)|0),j.push({s:{c:k,r:_},e:{c:R,r:z}})),!r.sheetStubs)x.MergeAcross?k=R+1:++k;else if(x.MergeAcross||x.MergeDown){for(var X=k;X<=R;++X)for(var ie=_;ie<=z;++ie)(X>k||ie>_)&&(r.dense?(g[ie]||(g[ie]=[]),g[ie][X]={t:"z"}):g[_s(X)+Xs(ie)]={t:"z"});k=R+1}else++k;else x=Ame(o[0]),x.Index&&(k=+x.Index-1),k<N.s.c&&(N.s.c=k),k>N.e.c&&(N.e.c=k),o[0].slice(-2)==="/>"&&++k,ae=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(v=Zl(o[0]),v.Index&&(_=+v.Index-1)),k=0,++_):(v=Zl(o[0]),v.Index&&(_=+v.Index-1),W={},(v.AutoFitHeight=="0"||v.Height)&&(W.hpx=parseInt(v.Height,10),W.hpt=lv(W.hpx),H[_]=W),v.Hidden=="1"&&(W.hidden=!0,H[_]=W));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(g["!ref"]=Xr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Xr(N))),j.length&&(g["!merges"]=j),ne.length>0&&(g["!cols"]=ne),H.length>0&&(g["!rows"]=H),d[p]=g}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,c.push([o[3],!1]),u=Zl(o[0]),p=mn(u.Name),g=r.dense?[]:{},j=[],M=[],H=[],J={name:p,Hidden:0},K.Sheets.push(J);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ne=[],V=!1}break;case"style":o[1]==="/"?Ome(E,P,r):P=Zl(o[0]);break;case"numberformat":P.nf=mn(Zl(o[0]).Format||"General"),jy[P.nf]&&(P.nf=jy[P.nf]);for(var le=0;le!=392&&Fr[le]!=P.nf;++le);if(le==392){for(le=57;le!=392;++le)if(Fr[le]==null){qu(P.nf,le);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(B=Zl(o[0]),B.Hidden&&(B.hidden=!0,delete B.Hidden),B.Width&&(B.wpx=parseInt(B.Width,10)),!V&&B.wpx>10){V=!0,Ei=fU;for(var ce=0;ce<ne.length;++ce)ne[ce]&&Ef(ne[ce])}V&&Ef(B),ne[B.Index-1||ne.length]=B;for(var be=0;be<+B.Span;++be)ne[ne.length]=os(B);break;case"namedrange":if(o[1]==="/")break;K.Names||(K.Names=[]);var re=Lr(o[0]),pe={Name:re.Name,Ref:fm(re.RefersTo.slice(1),{r:0,c:0})};K.Sheets.length>0&&(pe.Sheet=K.Sheets.length-1),K.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(A,o.index):A=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Zl(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?ale(I,se,n.slice(Y,o.index)):Y=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Ime(ee),ae.push(ee)}else c.push([o[3],!1]),u=Zl(o[0]),ee={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ce=Zl(o[0]);g["!autofilter"]={ref:fm(Ce.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return OO(n,r);var Ae=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ae=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ae=!1}break;case"excelworkbook":switch(o[3]){case"date1904":K.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ae=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ae=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(Y,o.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else Y=o.index+o[0].length;break;case"header":g["!margins"]||qh(g["!margins"]={},"xlml"),isNaN(+Lr(o[0]).Margin)||(g["!margins"].header=+Lr(o[0]).Margin);break;case"footer":g["!margins"]||qh(g["!margins"]={},"xlml"),isNaN(+Lr(o[0]).Margin)||(g["!margins"].footer=+Lr(o[0]).Margin);break;case"pagemargins":var We=Lr(o[0]);g["!margins"]||qh(g["!margins"]={},"xlml"),isNaN(+We.Top)||(g["!margins"].top=+We.Top),isNaN(+We.Left)||(g["!margins"].left=+We.Left),isNaN(+We.Right)||(g["!margins"].right=+We.Right),isNaN(+We.Bottom)||(g["!margins"].bottom=+We.Bottom);break;case"displayrighttoleft":K.Views||(K.Views=[]),K.Views[0]||(K.Views[0]={}),K.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ae=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ae=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ae=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ae=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ae=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ae=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ae=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ae=!1}break;case"smarttags":break;default:Ae=!1;break}if(Ae||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Pme(L,se,Z,n.slice(Y,o.index)):(Z=o,Y=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Le={};return!r.bookSheets&&!r.bookProps&&(Le.Sheets=d),Le.SheetNames=f,Le.Workbook=K,Le.SSF=os(Fr),Le.Props=I,Le.Custprops=L,Le}function wE(e,t){switch(P3(t=t||{}),t.type||"base64"){case"base64":return Nk(Yo(e),t);case"binary":case"buffer":case"file":return Nk(e,t);case"array":return Nk(Lf(e),t)}}function Rme(e,t){var r=[];return e.Props&&r.push(ile(e.Props,t)),e.Custprops&&r.push(ole(e.Props,e.Custprops)),r.join("")}function Mme(){return""}function Lme(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Zt("NumberFormat",null,{"ss:Format":Rn(Fr[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Zt("Style",a.join(""),i))}),Zt("Styles",r.join(""))}function BU(e){return Zt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+C3(e.Ref,{r:0,c:0})})}function Bme(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(BU(s)))}return Zt("Names",r.join(""))}function $me(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(BU(o)))}return a.join("")}function Ume(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Zt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Zt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Zt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Zt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(ui("ProtectContents","True")),e["!protect"].objects&&s.push(ui("ProtectObjects","True")),e["!protect"].scenarios&&s.push(ui("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(ui("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(ui("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Zt("WorksheetOptions",s.join(""),{xmlns:Uo.x})}function zme(e){return e.map(function(t){var r=coe(t.t||""),n=Zt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Zt("Comment",n,{"ss:Author":t.a})}).join("")}function Wme(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Rn(C3(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=bs(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Rn(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Rn(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",g=String(e.v);break;case"b":f="Boolean",g=e.v?"1":"0";break;case"e":f="Error",g=fd[e.v];break;case"d":f="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Fr[14]);break;case"s":f="String",g=loe(e.v||"");break}var p=$f(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var x=e.v!=null?g:"",v=e.t=="z"?"":'<Data ss:Type="'+f+'">'+x+"</Data>";return(e.c||[]).length>0&&(v+=zme(e.c)),Zt("Cell",v,o)}function Hme(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Em(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Gme(e,t,r,n){if(!e["!ref"])return"";var s=pn(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,C){Ef(w);var k=!!w.width,_=f2(C,w),N={"ss:Index":C+1};k&&(N["ss:Width"]=iv(_.width)),w.hidden&&(N["ss:Hidden"]="1"),o.push(Zt("Column",null,N))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[Hme(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var g=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(g=!0);break}if(!g){var p={r:u,c:f},x=Rr(p),v=c?(e[u]||[])[f]:e[x];d.push(Wme(v,x,e,t,r,n,p))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function Vme(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?$me(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?Gme(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(Ume(a,t,e,r)),n.join("")}function Kme(e,t){t||(t={}),e.SSF||(e.SSF=os(Fr)),e.SSF&&(Zm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$f(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(Rme(e,t)),r.push(Mme()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Zt("Worksheet",Vme(n,t,e),{"ss:Name":Rn(e.SheetNames[n])}));return r[2]=Lme(e,t),r[3]=Bme(e),Qs+Zt("Workbook",r.join(""),{xmlns:Uo.ss,"xmlns:o":Uo.o,"xmlns:x":Uo.x,"xmlns:ss":Uo.ss,"xmlns:dt":Uo.dt,"xmlns:html":Uo.html})}function qme(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Boe(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=$oe(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Yme=[60,1084,2066,2165,2175];function Xme(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=Wu(r,r.l),u=_E[c],d=0;u!=null&&Yme.indexOf(c)>-1;)a=Wu(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=_E[c=Wu(r,r.l)];var f=Ba(i);oi(f,0);var g=0;f.lens=[];for(var p=0;p<i.length;++p)f.lens.push(g),g+=i[p].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function Rc(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Fr[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||fd[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=ev(e.v):e.w=h0(e.v):e.w=Al(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&Qm(Fr[n]||String(n))){var s=Dh(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function Ow(e,t,r){return{v:e,ixfe:t,t:r}}function Jme(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",d={},f,g="",p,x,v,w,C={},k=[],_,N,E=[],P=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},A={},j=function(qe){return qe<8?Gh[qe]:qe<64&&P[qe-8]||Gh[qe]},I=function(qe,Ze,Tt){var Nt=Ze.XF.data;if(!(!Nt||!Nt.patternType||!Tt||!Tt.cellStyles)){Ze.s={},Ze.s.patternType=Nt.patternType;var $t;($t=av(j(Nt.icvFore)))&&(Ze.s.fgColor={rgb:$t}),($t=av(j(Nt.icvBack)))&&(Ze.s.bgColor={rgb:$t})}},L=function(qe,Ze,Tt){if(!(W>1)&&!(Tt.sheetRows&&qe.r>=Tt.sheetRows)){if(Tt.cellStyles&&Ze.XF&&Ze.XF.data&&I(qe,Ze,Tt),delete Ze.ixfe,delete Ze.XF,f=qe,g=Rr(qe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),qe.r<i.s.r&&(i.s.r=qe.r),qe.c<i.s.c&&(i.s.c=qe.c),qe.r+1>i.e.r&&(i.e.r=qe.r+1),qe.c+1>i.e.c&&(i.e.c=qe.c+1),Tt.cellFormula&&Ze.f){for(var Nt=0;Nt<k.length;++Nt)if(!(k[Nt][0].s.c>qe.c||k[Nt][0].s.r>qe.r)&&!(k[Nt][0].e.c<qe.c||k[Nt][0].e.r<qe.r)){Ze.F=Xr(k[Nt][0]),(k[Nt][0].s.c!=qe.c||k[Nt][0].s.r!=qe.r)&&delete Ze.f,Ze.f&&(Ze.f=""+Ti(k[Nt][1],i,qe,M,Y));break}}Tt.dense?(s[qe.r]||(s[qe.r]=[]),s[qe.r][qe.c]=Ze):s[g]=Ze}},Y={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(Y.password=t.password);var Z,ae=[],ee=[],ne=[],B=[],V=!1,M=[];M.SheetNames=Y.snames,M.sharedf=Y.sharedf,M.arrayf=Y.arrayf,M.names=[],M.XTI=[];var H=0,W=0,R=0,z=[],K=[],J;Y.codepage=1200,ac(1200);for(var se=!1;e.l<e.length-1;){var X=e.l,ie=e.read_shift(2);if(ie===0&&H===10)break;var le=e.l===e.length?0:e.read_shift(2),ce=_E[ie];if(ce&&ce.f){if(t.bookSheets&&H===133&&ie!==133)break;if(H=ie,ce.r===2||ce.r==12){var be=e.read_shift(2);if(le-=2,!Y.enc&&be!==ie&&((be&255)<<8|be>>8)!==ie)throw new Error("rt mismatch: "+be+"!="+ie);ce.r==12&&(e.l+=10,le-=10)}var re={};if(ie===10?re=ce.f(e,le,Y):re=Xme(ie,ce,e,le,Y),W==0&&[9,521,1033,2057].indexOf(H)===-1)continue;switch(ie){case 34:r.opts.Date1904=F.WBProps.date1904=re;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(Y.enc||(e.l=0),Y.enc=re,!t.password)throw new Error("File is password-protected");if(re.valid==null)throw new Error("Encryption scheme unsupported");if(!re.valid)throw new Error("Password is incorrect");break;case 92:Y.lastuser=re;break;case 66:var pe=Number(re);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}ac(Y.codepage=pe),se=!0;break;case 317:Y.rrtabid=re;break;case 25:Y.winlocked=re;break;case 439:r.opts.RefreshAll=re;break;case 12:r.opts.CalcCount=re;break;case 16:r.opts.CalcDelta=re;break;case 17:r.opts.CalcIter=re;break;case 13:r.opts.CalcMode=re;break;case 14:r.opts.CalcPrecision=re;break;case 95:r.opts.CalcSaveRecalc=re;break;case 15:Y.CalcRefMode=re;break;case 2211:r.opts.FullCalc=re;break;case 129:re.fDialog&&(s["!type"]="dialog"),re.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),re.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(re);break;case 430:M.push([re]),M[M.length-1].XTI=[];break;case 35:case 547:M[M.length-1].push(re);break;case 24:case 536:J={Name:re.Name,Ref:Ti(re.rgce,i,null,M,Y)},re.itab>0&&(J.Sheet=re.itab-1),M.names.push(J),M[0]||(M[0]=[],M[0].XTI=[]),M[M.length-1].push(re),re.Name=="_xlnm._FilterDatabase"&&re.itab>0&&re.rgce&&re.rgce[0]&&re.rgce[0][0]&&re.rgce[0][0][0]=="PtgArea3d"&&(K[re.itab-1]={ref:Xr(re.rgce[0][0][1][2])});break;case 22:Y.ExternCount=re;break;case 23:M.length==0&&(M[0]=[],M[0].XTI=[]),M[M.length-1].XTI=M[M.length-1].XTI.concat(re),M.XTI=M.XTI.concat(re);break;case 2196:if(Y.biff<8)break;J!=null&&(J.Comment=re[1]);break;case 18:s["!protect"]=re;break;case 19:re!==0&&Y.WTF&&console.error("Password verifier: "+re);break;case 133:a[re.pos]=re,Y.snames.push(re.name);break;case 10:{if(--W)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Xr(i),t.sheetRows&&t.sheetRows<=i.e.r){var Ce=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Xr(i),i.e.r=Ce}i.e.r++,i.e.c++}ae.length>0&&(s["!merges"]=ae),ee.length>0&&(s["!objects"]=ee),ne.length>0&&(s["!cols"]=ne),B.length>0&&(s["!rows"]=B),F.Sheets.push(A)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(Y.biff===8&&(Y.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[re.BIFFVer]||8),Y.biffguess=re.BIFFVer==0,re.BIFFVer==0&&re.dt==4096&&(Y.biff=5,se=!0,ac(Y.codepage=28591)),Y.biff==8&&re.BIFFVer==0&&re.dt==16&&(Y.biff=2),W++)break;if(s=t.dense?[]:{},Y.biff<8&&!se&&(se=!0,ac(Y.codepage=t.codepage||1252)),Y.biff<5||re.BIFFVer==0&&re.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ae={pos:e.l-le,name:u};a[Ae.pos]=Ae,Y.snames.push(u)}else u=(a[X]||{name:""}).name;re.dt==32&&(s["!type"]="chart"),re.dt==64&&(s["!type"]="macro"),ae=[],ee=[],Y.arrayf=k=[],ne=[],B=[],V=!1,A={Hidden:(a[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[re.r]||[])[re.c]:s[Rr({c:re.c,r:re.r})])&&++re.c,_={ixfe:re.ixfe,XF:E[re.ixfe]||{},v:re.val,t:"n"},R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:re.c,r:re.r},_,t);break;case 5:case 517:_={ixfe:re.ixfe,XF:E[re.ixfe],v:re.val,t:re.t},R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:re.c,r:re.r},_,t);break;case 638:_={ixfe:re.ixfe,XF:E[re.ixfe],v:re.rknum,t:"n"},R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:re.c,r:re.r},_,t);break;case 189:for(var We=re.c;We<=re.C;++We){var Le=re.rkrec[We-re.c][0];_={ixfe:Le,XF:E[Le],v:re.rkrec[We-re.c][1],t:"n"},R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:We,r:re.r},_,t)}break;case 6:case 518:case 1030:{if(re.val=="String"){o=re;break}if(_=Ow(re.val,re.cell.ixfe,re.tt),_.XF=E[_.ixfe],t.cellFormula){var At=re.formula;if(At&&At[0]&&At[0][0]&&At[0][0][0]=="PtgExp"){var Qe=At[0][0][1][0],gt=At[0][0][1][1],ht=Rr({r:Qe,c:gt});C[ht]?_.f=""+Ti(re.formula,i,re.cell,M,Y):_.F=((t.dense?(s[Qe]||[])[gt]:s[ht])||{}).F}else _.f=""+Ti(re.formula,i,re.cell,M,Y)}R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L(re.cell,_,t),o=re}break;case 7:case 519:if(o)o.val=re,_=Ow(re,o.cell.ixfe,"s"),_.XF=E[_.ixfe],t.cellFormula&&(_.f=""+Ti(o.formula,i,o.cell,M,Y)),R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(re);var tt=Rr(re[0].s);if(p=t.dense?(s[re[0].s.r]||[])[re[0].s.c]:s[tt],t.cellFormula&&p){if(!o||!tt||!p)break;p.f=""+Ti(re[1],i,re[0],M,Y),p.F=Xr(re[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;C[Rr(o.cell)]=re[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[Rr(o.cell)],(p||{}).f=""+Ti(re[0],i,f,M,Y)}}break;case 253:_=Ow(c[re.isst].t,re.ixfe,"s"),c[re.isst].h&&(_.h=c[re.isst].h),_.XF=E[_.ixfe],R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:re.c,r:re.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:re.ixfe,XF:E[re.ixfe],t:"z"},R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:re.c,r:re.r},_,t));break;case 190:if(t.sheetStubs)for(var ut=re.c;ut<=re.C;++ut){var Dt=re.ixfe[ut-re.c];_={ixfe:Dt,XF:E[Dt],t:"z"},R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:ut,r:re.r},_,t)}break;case 214:case 516:case 4:_=Ow(re.val,re.ixfe,"s"),_.XF=E[_.ixfe],R>0&&(_.z=z[_.ixfe>>8&63]),Rc(_,t,r.opts.Date1904),L({c:re.c,r:re.r},_,t);break;case 0:case 512:W===1&&(i=re);break;case 252:c=re;break;case 1054:if(Y.biff==4){z[R++]=re[1];for(var Rt=0;Rt<R+163&&Fr[Rt]!=re[1];++Rt);Rt>=163&&qu(re[1],R+163)}else qu(re[1],re[0]);break;case 30:{z[R++]=re;for(var It=0;It<R+163&&Fr[It]!=re;++It);It>=163&&qu(re,R+163)}break;case 229:ae=ae.concat(re);break;case 93:ee[re.cmo[0]]=Y.lastobj=re;break;case 438:Y.lastobj.TxO=re;break;case 127:Y.lastobj.ImData=re;break;case 440:for(w=re[0].s.r;w<=re[0].e.r;++w)for(v=re[0].s.c;v<=re[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Rr({c:v,r:w})],p&&(p.l=re[1]);break;case 2048:for(w=re[0].s.r;w<=re[0].e.r;++w)for(v=re[0].s.c;v<=re[0].e.c;++v)p=t.dense?(s[w]||[])[v]:s[Rr({c:v,r:w})],p&&p.l&&(p.l.Tooltip=re[1]);break;case 28:{if(Y.biff<=5&&Y.biff>=2)break;p=t.dense?(s[re[0].r]||[])[re[0].c]:s[Rr(re[0])];var De=ee[re[2]];p||(t.dense?(s[re[0].r]||(s[re[0].r]=[]),p=s[re[0].r][re[0].c]={t:"z"}):p=s[Rr(re[0])]={t:"z"},i.e.r=Math.max(i.e.r,re[0].r),i.s.r=Math.min(i.s.r,re[0].r),i.e.c=Math.max(i.e.c,re[0].c),i.s.c=Math.min(i.s.c,re[0].c)),p.c||(p.c=[]),x={a:re[1],t:De.TxO.t},p.c.push(x)}break;case 2173:Lde(E[re.ixfe],re.ext);break;case 125:{if(!Y.cellStyles)break;for(;re.e>=re.s;)ne[re.e--]={width:re.w/256,level:re.level||0,hidden:!!(re.flags&1)},V||(V=!0,b3(re.w/256)),Ef(ne[re.e+1])}break;case 520:{var Ie={};re.level!=null&&(B[re.r]=Ie,Ie.level=re.level),re.hidden&&(B[re.r]=Ie,Ie.hidden=!0),re.hpt&&(B[re.r]=Ie,Ie.hpt=re.hpt,Ie.hpx=Em(re.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||qh(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=re;break;case 161:s["!margins"]||qh(s["!margins"]={}),s["!margins"].header=re.header,s["!margins"].footer=re.footer;break;case 574:re.RTL&&(F.Views[0].RTL=!0);break;case 146:P=re;break;case 2198:Z=re;break;case 140:N=re;break;case 442:u?A.CodeName=re||A.name:F.WBProps.CodeName=re||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=le}return r.SheetNames=Ls(a).sort(function(Je,qe){return Number(Je)-Number(qe)}).map(function(Je){return a[Je].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&K.forEach(function(Je,qe){r.Sheets[r.SheetNames[qe]]["!autofilter"]=Je}),r.Strings=c,r.SSF=os(Fr),Y.enc&&(r.Encryption=Y.enc),Z&&(r.Themes=Z),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),M.names.length>0&&(F.Names=M.names),r.Workbook=F,r}var Py={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Qme(e,t,r){var n=Er.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=cO(n,gE,Py.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Er.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=cO(i,mE,Py.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(L$(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function Zme(e,t){var r=[],n=[],s=[],a=0,i,o=BF(gE,"n"),c=BF(mE,"n");if(e.Props)for(i=Ls(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Ls(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)G$.indexOf(s[a][0])>-1||M$.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Er.utils.cfb_add(t,"/SummaryInformation",uO(n,Py.SI,c,mE)),(r.length||u.length)&&Er.utils.cfb_add(t,"/DocumentSummaryInformation",uO(r,Py.DSI,o,gE,u.length?u:null,Py.UDI))}function $U(e,t){t||(t={}),P3(t),Q4(),t.codepage&&J4(t.codepage);var r,n;if(e.FullPaths){if(Er.find(e,"/encryption"))throw new Error("File is password-protected");r=Er.find(e,"!CompObj"),n=Er.find(e,"/Workbook")||Er.find(e,"/Book")}else{switch(t.type){case"base64":e=Ho(Yo(e));break;case"binary":e=Ho(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}oi(e,0),n={content:e}}var s,a;if(r&&qme(r),t.bookProps&&!t.bookSheets)s={};else{var i=en?"buffer":"array";if(n&&n.content)s=Jme(n.content,t);else if((a=Er.find(e,"PerfectOffice_MAIN"))&&a.content)s=Kh.to_workbook(a.content,(t.type=i,t));else if((a=Er.find(e,"NativeContent_MAIN"))&&a.content)s=Kh.to_workbook(a.content,(t.type=i,t));else throw(a=Er.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Er.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=ffe(e))}var o={};return e.FullPaths&&Qme(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function epe(e,t){var r=t||{},n=Er.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Er.utils.cfb_add(n,s,UU(e,r)),r.biff==8&&(e.Props||e.Custprops)&&Zme(e,n),r.biff==8&&e.vbaraw&&hfe(n,Er.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var cv={0:{f:k0e},1:{f:F0e},2:{f:J0e},3:{f:$0e},4:{f:R0e},5:{f:q0e},6:{f:rge},7:{f:H0e},8:{f:cge},9:{f:lge},10:{f:ige},11:{f:oge},12:{f:D0e},13:{f:Z0e},14:{f:z0e},15:{f:L0e},16:{f:FU},17:{f:sge},18:{f:V0e},19:{f:f3},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:sme},40:{},42:{},43:{f:rde},44:{f:ede},45:{f:ade},46:{f:ode},47:{f:ide},48:{},49:{f:Eoe},50:{},51:{f:Ude},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:rU},62:{f:tge},63:{f:Xde},64:{f:Cge},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ii,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:_ge},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:j0e},148:{f:E0e,p:16},151:{f:mge},152:{},153:{f:tme},154:{},155:{},156:{f:Zge},157:{},158:{},159:{T:1,f:xue},160:{T:-1},161:{T:1,f:O0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:uge},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Bde},336:{T:-1},337:{f:Hde,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:hE},357:{},358:{},359:{},360:{T:1},361:{},362:{f:tU},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pge},427:{f:xge},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:vge},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:A0e},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:hge},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:hE},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:ofe},633:{T:1},634:{T:-1},635:{T:1,f:afe},636:{T:-1},637:{f:Poe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:zge},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Tge},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},_E={6:{f:Tk},10:{f:nf},12:{f:aa},13:{f:aa},14:{f:Ks},15:{f:Ks},16:{f:Ai},17:{f:Ks},18:{f:Ks},19:{f:aa},20:{f:pO},21:{f:pO},23:{f:tU},24:{f:yO},25:{f:Ks},26:{},27:{},28:{f:Tce},29:{},34:{f:Ks},35:{f:xO},38:{f:Ai},39:{f:Ai},40:{f:Ai},41:{f:Ai},42:{f:Ks},43:{f:Ks},47:{f:Lue},49:{f:Zle},51:{f:aa},60:{},61:{f:qle},64:{f:Ks},65:{f:Qle},66:{f:aa},77:{},80:{},81:{},82:{},85:{f:aa},89:{},90:{},91:{},92:{f:Mle},93:{f:Ace},94:{},95:{f:Ks},96:{},97:{},99:{f:Ks},125:{f:rU},128:{f:gce},129:{f:Ble},130:{f:aa},131:{f:Ks},132:{f:Ks},133:{f:$le},134:{},140:{f:Mce},141:{f:aa},144:{},146:{f:$ce},151:{},152:{},153:{},154:{},155:{},156:{f:aa},157:{},158:{},160:{f:Kce},161:{f:Wce},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:uce},190:{f:dce},193:{f:nf},197:{},198:{},199:{},200:{},201:{},202:{f:Ks},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:aa},220:{},221:{f:Ks},222:{},224:{f:hce},225:{f:Rle},226:{f:nf},227:{},229:{f:Ece},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:zle},253:{f:tce},255:{f:Hle},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:V$},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ks},353:{f:nf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:vce},431:{f:Ks},432:{},433:{},434:{},437:{},438:{f:Fce},439:{f:Ks},440:{f:Oce},441:{},442:{f:Kv},443:{},444:{f:aa},445:{},446:{},448:{f:nf},449:{f:Kle,r:2},450:{f:nf},512:{f:hO},513:{f:Vce},515:{f:xce},516:{f:nce},517:{f:mO},519:{f:qce},520:{f:Gle},523:{},545:{f:vO},549:{f:fO},566:{},574:{f:Xle},638:{f:cce},659:{},1048:{},1054:{f:ace},1084:{},1212:{f:Sce},2048:{f:Ice},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:jw},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:nf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:Uce,r:12},2173:{f:Mde,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ks,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:bce,r:12},2197:{},2198:{f:Pde,r:12},2199:{},2200:{},2201:{},2202:{f:kce,r:12},2203:{f:nf},2204:{},2205:{},2206:{},2207:{},2211:{f:Vle},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:aa},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:Hce},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:Bce},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:hO},1:{},2:{f:Zce},3:{f:Jce},4:{f:Xce},5:{f:mO},7:{f:tue},8:{},9:{f:jw},11:{},22:{f:aa},30:{f:oce},31:{},32:{},33:{f:vO},36:{},37:{f:fO},50:{f:rue},62:{},52:{},67:{},68:{f:aa},69:{},86:{},126:{},127:{f:Yce},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:nue},223:{},234:{},354:{},421:{},518:{f:Tk},521:{f:jw},536:{f:yO},547:{f:xO},561:{},579:{},1030:{f:Tk},1033:{f:jw},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function er(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&c3(r)&&e.push(r)}}function tpe(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return er(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function Jv(e,t,r){return e||(e=_t(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function rpe(e,t,r,n){var s=_t(9);return Jv(s,e,t),K$(r,n||"b",s),s}function npe(e,t,r){var n=_t(8+2*r.length);return Jv(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function spe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Sa(is(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?er(e,2,eue(r,n,s)):er(e,3,Qce(r,n,s));return;case"b":case"e":er(e,5,rpe(r,n,t.v,t.t));return;case"s":case"str":er(e,4,npe(r,n,(t.v||"").slice(0,255)));return}er(e,1,Jv(null,r,n))}function ape(e,t,r,n){var s=Array.isArray(t),a=pn(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Xr(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Xs(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=_s(d)),i=c[d]+o;var f=s?(t[u]||[])[d]:t[i];f&&spe(e,f,u,d)}}}function ipe(e,t){for(var r=t||{},n=Co(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return er(n,r.biff==4?1033:r.biff==3?521:9,v3(e,16,r)),ape(n,e.Sheets[e.SheetNames[s]],s,r),er(n,10),n.end()}function ope(e,t,r){er(e,49,ece({sz:12,name:"Arial"},r))}function lpe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&er(e,1054,ice(s,t[s],r))})}function cpe(e,t){var r=_t(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),er(e,2151,r),r=_t(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),Q$(pn(t["!ref"]||"A1"),r),r.write_shift(4,4),er(e,2152,r)}function upe(e,t){for(var r=0;r<16;++r)er(e,224,gO({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){er(e,224,gO(n,0,t))})}function dpe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];er(e,440,Dce(n)),n[1].Tooltip&&er(e,2048,Rce(n))}delete t["!links"]}function fpe(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&er(e,125,zce(f2(s,n),s))})}}function hpe(e,t,r,n,s){var a=16+$f(s.cellXfs,t,s);if(t.v==null&&!t.bf){er(e,513,x0(r,n,a));return}if(t.bf)er(e,6,Bhe(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Sa(is(t.v)):t.v;er(e,515,yce(r,n,i,a));break;case"b":case"e":er(e,517,pce(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=E3(s.Strings,t.v,s.revStrings);er(e,253,rce(r,n,o,a))}else er(e,516,sce(r,n,(t.v||"").slice(0,255),a,s));break;default:er(e,513,x0(r,n,a))}}function gpe(e,t,r){var n=Co(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",g=[],p=pn(a["!ref"]||"A1"),x=u?65536:16384;if(p.e.c>255||p.e.r>=x){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,x-1)}er(n,2057,v3(r,16,t)),er(n,13,vl(1)),er(n,12,vl(100)),er(n,15,Ji(!0)),er(n,17,Ji(!1)),er(n,16,m0(.001)),er(n,95,Ji(!0)),er(n,42,Ji(!1)),er(n,43,Ji(!1)),er(n,130,vl(1)),er(n,128,mce()),er(n,131,Ji(!1)),er(n,132,Ji(!1)),u&&fpe(n,a["!cols"]),er(n,512,lce(p,t)),u&&(a["!links"]=[]);for(var v=p.s.r;v<=p.e.r;++v){f=Xs(v);for(var w=p.s.c;w<=p.e.c;++w){v===p.s.r&&(g[w]=_s(w)),d=g[w]+f;var C=c?(a[v]||[])[w]:a[d];C&&(hpe(n,C,v,w,t),u&&C.l&&a["!links"].push([d,C.l]))}}var k=o.CodeName||o.name||s;return u&&er(n,574,Jle((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&er(n,229,Nce(a["!merges"])),u&&dpe(n,a),er(n,442,q$(k)),u&&cpe(n,a),er(n,10),n.end()}function mpe(e,t,r){var n=Co(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(er(n,2057,v3(e,5,r)),r.bookType=="xla"&&er(n,135),er(n,225,o?vl(1200):null),er(n,193,ple(2)),c&&er(n,191),c&&er(n,192),er(n,226),er(n,92,Lle("SheetJS",r)),er(n,66,vl(o?1200:1252)),o&&er(n,353,vl(0)),o&&er(n,448),er(n,317,Gce(e.SheetNames.length)),o&&e.vbaraw&&er(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";er(n,442,q$(u))}er(n,156,vl(17)),er(n,25,Ji(!1)),er(n,18,Ji(!1)),er(n,19,vl(0)),o&&er(n,431,Ji(!1)),o&&er(n,444,vl(0)),er(n,61,Yle()),er(n,64,Ji(!1)),er(n,141,vl(0)),er(n,34,Ji(Kge(e)=="true")),er(n,14,Ji(!0)),o&&er(n,439,Ji(!1)),er(n,218,vl(0)),ope(n,e,r),lpe(n,e.SSF,r),upe(n,r),o&&er(n,352,Ji(!1));var d=n.end(),f=Co();o&&er(f,140,Lce()),o&&r.Strings&&tpe(f,252,Wle(r.Strings)),er(f,10);var g=f.end(),p=Co(),x=0,v=0;for(v=0;v<e.SheetNames.length;++v)x+=(o?12:11)+(o?2:1)*e.SheetNames[v].length;var w=d.length+x+g.length;for(v=0;v<e.SheetNames.length;++v){var C=a[v]||{};er(p,133,Ule({pos:w,hs:C.Hidden||0,dt:0,name:e.SheetNames[v]},r)),w+=t[v].length}var k=p.end();if(x!=k.length)throw new Error("BS8 "+x+" != "+k.length);var _=[];return d.length&&_.push(d),k.length&&_.push(k),g.length&&_.push(g),Ba(_)}function ppe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=os(Fr)),e&&e.SSF&&(Zm(),a2(e.SSF),r.revssf=o2(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,F3(r),r.cellXfs=[],$f(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=gpe(s,r,e);return n.unshift(mpe(e,n,r)),Ba(n)}function UU(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=To(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return ppe(e,t);case 4:case 3:case 2:return ipe(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function AO(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=eoe(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,g=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var v=c[i].trim(),w=v.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(w!="<td"&&w!="<th")){var C=v.split(/<\/t[dh]>/i);for(o=0;o<C.length;++o){var k=C[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var E=0;E<x.length;++E){var P=x[E];P.s.c==d&&P.s.r<u&&u<=P.e.r&&(d=P.e.c+1,E=-1)}var F=Lr(k.slice(0,k.indexOf(">")));g=F.colspan?+F.colspan:1,((f=+F.rowspan)>1||g>1)&&x.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+g-1}});var A=F.t||F["data-t"]||"";if(!_.length){d+=g;continue}if(_=d$(_),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>d&&(p.s.c=d),p.e.c<d&&(p.e.c=d),!_.length){d+=g;continue}var j={t:"s",v:_};r.raw||!_.trim().length||A=="s"||(_==="TRUE"?j={t:"b",v:!0}:_==="FALSE"?j={t:"b",v:!1}:isNaN(lc(_))?isNaN(Cm(_).getDate())||(j={t:"d",v:is(_)},r.cellDates||(j={t:"n",v:Sa(j.v)}),j.z=r.dateNF||Fr[14]):j={t:"n",v:lc(_)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=j):n[Rr({r:u,c:d})]=j,d+=g}}}}return n["!ref"]=Xr(p),x.length&&(n["!merges"]=x),n}function xpe(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=Rr({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],g=f&&f.v!=null&&(f.h||i3(f.w||(nd(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+f.l.Target+'">'+g+"</a>")),p.id=(n.id||"sjs")+"-"+d,a.push(Zt("td",g,p))}}var x="<tr>";return x+a.join("")+"</tr>"}var ype='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vpe="</body></html>";function wpe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Bf(AO(r[0],t),t);var n=I3();return r.forEach(function(s,a){R3(n,AO(s,t),"Sheet"+(a+1))}),n}function _pe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function zU(e,t){var r=t||{},n=r.header!=null?r.header:ype,s=r.footer!=null?r.footer:vpe,a=[n],i=To(e["!ref"]);r.dense=Array.isArray(e),a.push(_pe(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(xpe(e,i,o,r));return a.push("</table>"+s),a.join("")}function WU(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?bs(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=To(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],g=0,p=e["!rows"]||(e["!rows"]=[]),x=0,v=0,w=0,C=0,k=0,_=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&v<c;++x){var N=o[x];if(jO(N)){if(n.display)continue;p[v]={hidden:!0}}var E=N.children;for(w=C=0;w<E.length;++w){var P=E[w];if(!(n.display&&jO(P))){var F=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):d$(P.innerHTML),A=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<f.length;++g){var j=f[g];j.s.c==C+a&&j.s.r<v+s&&v+s<=j.e.r&&(C=j.e.c+1-a,g=-1)}_=+P.getAttribute("colspan")||1,((k=+P.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:v+s,c:C+a},e:{r:v+s+(k||1)-1,c:C+a+(_||1)-1}});var I={t:"s",v:F},L=P.getAttribute("data-t")||P.getAttribute("t")||"";F!=null&&(F.length==0?I.t=L||"z":n.raw||F.trim().length==0||L=="s"||(F==="TRUE"?I={t:"b",v:!0}:F==="FALSE"?I={t:"b",v:!1}:isNaN(lc(F))?isNaN(Cm(F).getDate())||(I={t:"d",v:is(F)},n.cellDates||(I={t:"n",v:Sa(I.v)}),I.z=n.dateNF||Fr[14]):I={t:"n",v:lc(F)})),I.z===void 0&&A!=null&&(I.z=A);var Y="",Z=P.getElementsByTagName("A");if(Z&&Z.length)for(var ae=0;ae<Z.length&&!(Z[ae].hasAttribute("href")&&(Y=Z[ae].getAttribute("href"),Y.charAt(0)!="#"));++ae);Y&&Y.charAt(0)!="#"&&(I.l={Target:Y}),n.dense?(e[v+s]||(e[v+s]=[]),e[v+s][C+a]=I):e[Rr({c:C+a,r:v+s})]=I,u.e.c<C+a&&(u.e.c=C+a),C+=_}}++v}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,v-1+s),e["!ref"]=Xr(u),v>=c&&(e["!fullref"]=Xr((u.e.r=o.length-x+v-1+s,u))),e}function HU(e,t){var r=t||{},n=r.dense?[]:{};return WU(n,e,t)}function bpe(e,t){return Bf(HU(e,t),t)}function jO(e){var t="",r=Spe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Spe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kpe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=mn(t.replace(/<[^>]*>/g,""));return[r]}var PO={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function GU(e,t){var r=t||{},n=o3(e),s=[],a,i,o={name:""},c="",u=0,d,f,g={},p=[],x=r.dense?[]:{},v,w,C={value:""},k="",_=0,N=[],E=-1,P=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},A=0,j={},I=[],L={},Y=0,Z=0,ae=[],ee=1,ne=1,B=[],V={Names:[]},M={},H=["",""],W=[],R={},z="",K=0,J=!1,se=!1,X=0;for(nv.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=nv.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?x["!ref"]=Xr(F):x["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(x["!fullref"]=x["!ref"],F.e.r=r.sheetRows-1,x["!ref"]=Xr(F)),I.length&&(x["!merges"]=I),ae.length&&(x["!rows"]=ae),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),p.push(d.name),g[d.name]=x,se=!1):v[0].charAt(v[0].length-2)!=="/"&&(d=Lr(v[0],!1),E=P=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,x=r.dense?[]:{},I=[],ae=[],se=!0);break;case"table-row-group":v[1]==="/"?--A:++A;break;case"table-row":case"":if(v[1]==="/"){E+=ee,ee=1;break}if(f=Lr(v[0],!1),f.?E=f.-1:E==-1&&(E=0),ee=+f["number-rows-repeated"]||1,ee<10)for(X=0;X<ee;++X)A>0&&(ae[E+X]={level:A});P=-1;break;case"covered-table-cell":v[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(x[E]||(x[E]=[]),x[E][P]={t:"z"}):x[Rr({r:E,c:P})]={t:"z"}),k="",N=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++P,C=Lr(v[0],!1),ne=parseInt(C["number-columns-repeated"]||"1",10),w={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(w.f=TO(mn(C.formula))),(C.||C["value-type"])=="string"&&(w.t="s",w.v=mn(C["string-value"]||""),r.dense?(x[E]||(x[E]=[]),x[E][P]=w):x[Rr({r:E,c:P})]=w),P+=ne-1;else if(v[1]!=="/"){++P,k="",_=0,N=[],ne=1;var ie=ee?E+ee-1:E;if(P>F.e.c&&(F.e.c=P),P<F.s.c&&(F.s.c=P),E<F.s.r&&(F.s.r=E),ie>F.e.r&&(F.e.r=ie),C=Lr(v[0],!1),W=[],R={},w={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=mn(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(Y=parseInt(C["number-matrix-rows-spanned"],10)||0,Z=parseInt(C["number-matrix-columns-spanned"],10)||0,L={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},w.F=Xr(L),B.push([L,w.F])),C.formula)w.f=TO(C.formula);else for(X=0;X<B.length;++X)E>=B[X][0].s.r&&E<=B[X][0].e.r&&P>=B[X][0].s.c&&P<=B[X][0].e.c&&(w.F=B[X][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(Y=parseInt(C["number-rows-spanned"],10)||0,Z=parseInt(C["number-columns-spanned"],10)||0,L={s:{r:E,c:P},e:{r:E+Y-1,c:P+Z-1}},I.push(L)),C["number-columns-repeated"]&&(ne=parseInt(C["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=ns(C["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(C.value);break;case"percentage":w.t="n",w.v=parseFloat(C.value);break;case"currency":w.t="n",w.v=parseFloat(C.value);break;case"date":w.t="d",w.v=is(C["date-value"]),r.cellDates||(w.t="n",w.v=Sa(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=Jie(C["time-value"])/86400,r.cellDates&&(w.t="d",w.v=l2(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(C.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",C["string-value"]!=null&&(k=mn(C["string-value"]),N=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(J=!1,w.t==="s"&&(w.v=k||"",N.length&&(w.R=N),J=_==0),M.Target&&(w.l=M),W.length>0&&(w.c=W,W=[]),k&&r.cellText!==!1&&(w.w=k),J&&(w.t="z",delete w.v),(!J||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var le=0;le<ee;++le){if(ne=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(x[E+le]||(x[E+le]=[]),x[E+le][P]=le==0?w:os(w);--ne>0;)x[E+le][P+ne]=os(w);else for(x[Rr({r:E+le,c:P})]=w;--ne>0;)x[Rr({r:E+le,c:P+ne})]=os(w);F.e.c<=P&&(F.e.c=P)}ne=parseInt(C["number-columns-repeated"]||"1",10),P+=ne-1,ne=0,w={},k="",N=[]}M={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a;R.t=k,N.length&&(R.R=N),R.a=z,W.push(R)}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);z="",K=0,k="",_=0,N=[];break;case"creator":v[1]==="/"?z=n.slice(K,v.index):K=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&s.push([v[3],!1]);k="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(j[o.name]=c,(a=s.pop())[0]!==v[3])throw"Bad state: "+a}else v[0].charAt(v[0].length-2)!=="/"&&(c="",o=Lr(v[0],!1),s.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Lr(v[0],!1),c+=PO[v[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Lr(v[0],!1),c+=PO[v[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,v.index);break}else u=v.index+v[0].length;break;case"named-range":i=Lr(v[0],!1),H=Ek(i["cell-range-address"]);var ce={Name:i.name,Ref:H[0]+"!"+H[1]};se&&(ce.Sheet=p.length),V.Names.push(ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(v[1]==="/"&&(!C||!C["string-value"])){var be=kpe(n.slice(_,v.index));k=(k.length>0?k+`
`:"")+be[0]}else Lr(v[0],!1),_=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{H=Ek(Lr(v[0])["target-range-address"]),g[H[0]]["!autofilter"]={ref:H[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(M=Lr(v[0],!1),!M.href)break;M.Target=mn(M.href),delete M.href,M.Target.charAt(0)=="#"&&M.Target.indexOf(".")>-1?(H=Ek(M.Target.slice(1)),M.Target="#"+H[0]+"!"+H[1]):M.Target.match(/^\.\.[\\\/]/)&&(M.Target=M.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var re={Sheets:g,SheetNames:p,Workbook:V};return r.bookSheets&&delete re.Sheets,re}function FO(e,t){t=t||{},yl(e,"META-INF/manifest.xml")&&Joe(sa(e,"META-INF/manifest.xml"),t);var r=Go(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=GU(zn(r),t);return yl(e,"meta.xml")&&(n.Props=I$(sa(e,"meta.xml"))),n}function OO(e,t){return GU(e,t)}var Cpe=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+rv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Qs+t}})(),DO=(function(){var e=function(a){return Rn(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+Rn(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=To(a["!ref"]||"A1"),g=a["!merges"]||[],p=0,x=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var v="",w=a["!rows"]||[];for(u=0;u<f.s.r;++u)v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+v+`></table:table-row>
`);for(;u<=f.e.r;++u){for(v=w[u]?' table:style-name="ro'+w[u].ods+'"':"",c.push("        <table:table-row"+v+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var C=!1,k={},_="";for(p=0;p!=g.length;++p)if(!(g[p].s.c>d)&&!(g[p].s.r>u)&&!(g[p].e.c<d)&&!(g[p].e.r<u)){(g[p].s.c!=d||g[p].s.r!=u)&&(C=!0),k["table:number-columns-spanned"]=g[p].e.c-g[p].s.c+1,k["table:number-rows-spanned"]=g[p].e.r-g[p].s.r+1;break}if(C){c.push(r);continue}var N=Rr({r:u,c:d}),E=x?(a[u]||[])[d]:a[N];if(E&&E.f&&(k["table:formula"]=Rn(Ghe(E.f)),E.F&&E.F.slice(0,N.length)==N)){var P=To(E.F);k["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,k["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":_=E.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=E.v?"true":"false";break;case"n":_=E.w||String(E.v||0),k["office:value-type"]="float",k["office:value"]=E.v||0;break;case"s":case"str":_=E.v==null?"":E.v,k["office:value-type"]="string";break;case"d":_=E.w||is(E.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=is(E.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var F=e(_);if(E.l&&E.l.Target){var A=E.l.Target;A=A.charAt(0)=="#"?"#"+Vhe(A.slice(1)):A,A.charAt(0)!="#"&&!A.match(/^\w+:/)&&(A="../"+A),F=Zt("text:a",F,{"xlink:href":A.replace(/&/g,"&amp;")})}c.push("          "+Zt("table:table-cell",Zt("text:p",F,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ef(f),f.ods=o;var g=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Qs],u=rv({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=rv({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(D$().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function VU(e,t){if(t.bookType=="fods")return DO(e,t);var r=n3(),n="",s=[],a=[];return n="mimetype",Qr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Qr(r,n,DO(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Qr(r,n,Cpe(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Qr(r,n,Qs+D$()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Qr(r,n,ele(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Qr(r,n,Qoe(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function y0(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function bE(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):zn(Lf(e))}function Tpe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ho(Hc(e))}function Epe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Af(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function IO(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Npe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Ape(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function uv(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Fn(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Ms(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function yn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=uv(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=uv(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function ri(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(Fn(n*8+s.type)),s.type==2&&t.push(Fn(s.data.length)),t.push(s.data))})}),Af(t)}function j3(e,t){return e?.map(function(r){return t(r.data)})||[]}function gl(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=uv(e,n),a=yn(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Ms(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=yn(o.data),u=Ms(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Ms(a[3][0].data)>>>0>0),r.push(i)}return r}function Rg(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Fn(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Fn(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:Fn(i.data.length)}],n[2].push({data:ri(i.meta),type:2})});var a=ri(n);t.push(Fn(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Af(t)}function jpe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=uv(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Af(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=Af(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function ml(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jpe(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Af(t)}function Mg(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=Fn(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Af(t)}function Ppe(e,t,r,n){var s=y0(e),a=s.getUint32(4,!0),i=(n>1?12:8)+IO(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=IO(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function Fpe(e,t,r){var n=y0(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=Npe(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function Ak(e,t){var r=new Uint8Array(32),n=y0(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,Ape(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function jk(e,t){var r=new Uint8Array(32),n=y0(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function Ope(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Ppe(e,t,r,e[0]);case 5:return Fpe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ci(e){var t=yn(e);return uv(t[1][0].data)}function RO(e,t){var r=yn(t.data),n=Ms(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=yn(i.data),c=Ms(o[1][0].data)>>>0;switch(n){case 1:a[c]=bE(o[3][0].data);break;case 8:{var u=e[Ci(o[9][0].data)][0],d=yn(u.data),f=e[Ci(d[1][0].data)][0],g=Ms(f.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var p=yn(f.data);a[c]=p[3].map(function(x){return bE(x.data)}).join("")}break}}),a}function Dpe(e,t){var r,n,s,a,i,o,c,u,d,f,g,p,x,v,w=yn(e),C=Ms(w[1][0].data)>>>0,k=Ms(w[2][0].data)>>>0,_=((n=(r=w[8])==null?void 0:r[0])==null?void 0:n.data)&&Ms(w[8][0].data)>0||!1,N,E;if((a=(s=w[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=w[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(c=w[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=w[4])==null?void 0:d[0])!=null&&f.data&&t!=1)N=(p=(g=w[4])==null?void 0:g[0])==null?void 0:p.data,E=(v=(x=w[3])==null?void 0:x[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=_?4:1,F=y0(N),A=[],j=0;j<N.length/2;++j){var I=F.getUint16(j*2,!0);I<65535&&A.push([j,I])}if(A.length!=k)throw"Expected ".concat(k," cells, found ").concat(A.length);var L=[];for(j=0;j<A.length-1;++j)L[A[j][0]]=E.subarray(A[j][1]*P,A[j+1][1]*P);return A.length>=1&&(L[A[A.length-1][0]]=E.subarray(A[A.length-1][1]*P)),{R:C,cells:L}}function Ipe(e,t){var r,n=yn(t.data),s=(r=n?.[7])!=null&&r[0]?Ms(n[7][0].data)>>>0>0?1:0:-1,a=j3(n[5],function(i){return Dpe(i,s)});return{nrows:Ms(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function Rpe(e,t,r){var n,s=yn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Ms(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Ms(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Xr(a);var i=yn(s[4][0].data),o=RO(e,e[Ci(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?RO(e,e[Ci(i[17][0].data)][0]):[],u=yn(i[3][0].data),d=0;u[1].forEach(function(f){var g=yn(f.data),p=e[Ci(g[2][0].data)][0],x=Ms(p.meta[1][0].data);if(x!=6002)throw new Error("6001 unexpected reference to ".concat(x));var v=Ipe(e,p);v.data.forEach(function(w,C){w.forEach(function(k,_){var N=Rr({r:d+C,c:_}),E=Ope(k,o,c);E&&(r[N]=E)})}),d+=v.nrows})}function Mpe(e,t){var r=yn(t.data),n={"!ref":"A1"},s=e[Ci(r[2][0].data)],a=Ms(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return Rpe(e,s[0],n),n}function Lpe(e,t){var r,n=yn(t.data),s={name:(r=n[1])!=null&&r[0]?bE(n[1][0].data):"",sheets:[]},a=j3(n[2],Ci);return a.forEach(function(i){e[i].forEach(function(o){var c=Ms(o.meta[1][0].data);c==6e3&&s.sheets.push(Mpe(e,o))})}),s}function Bpe(e,t){var r=I3(),n=yn(t.data),s=j3(n[1],Ci);if(s.forEach(function(a){e[a].forEach(function(i){var o=Ms(i.meta[1][0].data);if(o==2){var c=Lpe(e,i);c.sheets.forEach(function(u,d){R3(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Pk(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=ml(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=gl(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Ms(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=Ms(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return Bpe(a,o)}function $pe(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Ms(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=y0(e[7][0].data),d=0,f=[],g=y0(e[4][0].data),p=0,x=[],v=0;v<t.length;++v){if(t[v]==null){u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535);continue}u.setUint16(v*2,d,!0),g.setUint16(v*2,p,!0);var w,C;switch(typeof t[v]){case"string":w=Ak({t:"s",v:t[v]},r),C=jk({t:"s",v:t[v]},r);break;case"number":w=Ak({t:"n",v:t[v]},r),C=jk({t:"n",v:t[v]},r);break;case"boolean":w=Ak({t:"b",v:t[v]},r),C=jk({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}f.push(w),d+=w.length,x.push(C),p+=C.length,++c}for(e[2][0].data=Fn(c);v<e[7][0].data.length/2;++v)u.setUint16(v*2,65535,!0),g.setUint16(v*2,65535,!0);return e[6][0].data=Af(f),e[3][0].data=Af(x),c}function Upe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=To(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Xr(n)));var a=Y_(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(z){return z.forEach(function(K){typeof K=="string"&&i.push(K)})});var o={},c=[],u=Er.read(t.numbers,{type:"base64"});u.FileIndex.map(function(z,K){return[z,u.FullPaths[K]]}).forEach(function(z){var K=z[0],J=z[1];if(K.type==2&&K.name.match(/\.iwa/)){var se=K.content,X=ml(se),ie=gl(X);ie.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:J,type:Ms(le.messages[0].meta[1][0].data)}})}}),c.sort(function(z,K){return z-K});var d=c.filter(function(z){return z>1}).map(function(z){return[z,Fn(z)]});u.FileIndex.map(function(z,K){return[z,u.FullPaths[K]]}).forEach(function(z){var K=z[0];if(z[1],!!K.name.match(/\.iwa/)){var J=gl(ml(K.content));J.forEach(function(se){se.messages.forEach(function(X){d.forEach(function(ie){se.messages.some(function(le){return Ms(le.meta[1][0].data)!=11006&&Epe(le.data,ie[1])})&&o[ie[0]].deps.push(se.id)})})})}});for(var f=Er.find(u,o[1].location),g=gl(ml(f.content)),p,x=0;x<g.length;++x){var v=g[x];v.id==1&&(p=v)}var w=Ci(yn(p.messages[0].data)[1][0].data);for(f=Er.find(u,o[w].location),g=gl(ml(f.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=Ci(yn(p.messages[0].data)[2][0].data),f=Er.find(u,o[w].location),g=gl(ml(f.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);for(w=Ci(yn(p.messages[0].data)[2][0].data),f=Er.find(u,o[w].location),g=gl(ml(f.content)),x=0;x<g.length;++x)v=g[x],v.id==w&&(p=v);var C=yn(p.messages[0].data);{C[6][0].data=Fn(n.e.r+1),C[7][0].data=Fn(n.e.c+1);var k=Ci(C[46][0].data),_=Er.find(u,o[k].location),N=gl(ml(_.content));{for(var E=0;E<N.length&&N[E].id!=k;++E);if(N[E].id!=k)throw"Bad ColumnRowUIDMapArchive";var P=yn(N[E].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var F=0;F<=n.e.c;++F){var A=[];A[1]=A[2]=[{type:0,data:Fn(F+420690)}],P[1].push({type:2,data:ri(A)}),P[2].push({type:0,data:Fn(F)}),P[3].push({type:0,data:Fn(F)})}P[4]=[],P[5]=[],P[6]=[];for(var j=0;j<=n.e.r;++j)A=[],A[1]=A[2]=[{type:0,data:Fn(j+726270)}],P[4].push({type:2,data:ri(A)}),P[5].push({type:0,data:Fn(j)}),P[6].push({type:0,data:Fn(j)});N[E].messages[0].data=ri(P)}_.content=Mg(Rg(N)),_.size=_.content.length,delete C[46];var I=yn(C[4][0].data);{I[7][0].data=Fn(n.e.r+1);var L=yn(I[1][0].data),Y=Ci(L[2][0].data);_=Er.find(u,o[Y].location),N=gl(ml(_.content));{if(N[0].id!=Y)throw"Bad HeaderStorageBucket";var Z=yn(N[0].messages[0].data);for(j=0;j<a.length;++j){var ae=yn(Z[2][0].data);ae[1][0].data=Fn(j),ae[4][0].data=Fn(a[j].length),Z[2][j]={type:Z[2][0].type,data:ri(ae)}}N[0].messages[0].data=ri(Z)}_.content=Mg(Rg(N)),_.size=_.content.length;var ee=Ci(I[2][0].data);_=Er.find(u,o[ee].location),N=gl(ml(_.content));{if(N[0].id!=ee)throw"Bad HeaderStorageBucket";for(Z=yn(N[0].messages[0].data),F=0;F<=n.e.c;++F)ae=yn(Z[2][0].data),ae[1][0].data=Fn(F),ae[4][0].data=Fn(n.e.r+1),Z[2][F]={type:Z[2][0].type,data:ri(ae)};N[0].messages[0].data=ri(Z)}_.content=Mg(Rg(N)),_.size=_.content.length;var ne=Ci(I[4][0].data);(function(){for(var z=Er.find(u,o[ne].location),K=gl(ml(z.content)),J,se=0;se<K.length;++se){var X=K[se];X.id==ne&&(J=X)}var ie=yn(J.messages[0].data);{ie[3]=[];var le=[];i.forEach(function(re,pe){le[1]=[{type:0,data:Fn(pe)}],le[2]=[{type:0,data:Fn(1)}],le[3]=[{type:2,data:Tpe(re)}],ie[3].push({type:2,data:ri(le)})})}J.messages[0].data=ri(ie);var ce=Rg(K),be=Mg(ce);z.content=be,z.size=z.content.length})();var B=yn(I[3][0].data);{var V=B[1][0];delete B[2];var M=yn(V.data);{var H=Ci(M[2][0].data);(function(){for(var z=Er.find(u,o[H].location),K=gl(ml(z.content)),J,se=0;se<K.length;++se){var X=K[se];X.id==H&&(J=X)}var ie=yn(J.messages[0].data);{delete ie[6],delete B[7];var le=new Uint8Array(ie[5][0].data);ie[5]=[];for(var ce=0,be=0;be<=n.e.r;++be){var re=yn(le);ce+=$pe(re,a[be],i),re[1][0].data=Fn(be),ie[5].push({data:ri(re),type:2})}ie[1]=[{type:0,data:Fn(n.e.c+1)}],ie[2]=[{type:0,data:Fn(n.e.r+1)}],ie[3]=[{type:0,data:Fn(ce)}],ie[4]=[{type:0,data:Fn(n.e.r+1)}]}J.messages[0].data=ri(ie);var pe=Rg(K),Ce=Mg(pe);z.content=Ce,z.size=z.content.length})()}V.data=ri(M)}I[3][0].data=ri(B)}C[4][0].data=ri(I)}p.messages[0].data=ri(C);var W=Rg(g),R=Mg(W);return f.content=R,f.size=f.content.length,u}function KU(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function P3(e){KU([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function F3(e){KU([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function zpe(e){return an.WS.indexOf(e)>-1?"sheet":e==an.CS?"chart":e==an.DS?"dialog":e==an.MS?"macro":e&&e.length?e:"sheet"}function Wpe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,zpe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Hpe(e,t,r,n,s,a,i,o,c,u,d,f){try{a[n]=Ey(Go(e,r,!0),t);var g=sa(e,t),p;switch(o){case"sheet":p=fme(g,t,s,c,a[n],u,d,f);break;case"chart":if(p=hme(g,t,s,c,a[n],u,d,f),!p||!p["!drawel"])break;var x=dy(p["!drawel"].Target,t),v=sv(x),w=Zde(Go(e,x,!0),Ey(Go(e,v,!0),x)),C=dy(w,x),k=sv(C);p=$ge(Go(e,C,!0),C,c,Ey(Go(e,k,!0),C),u,p);break;case"macro":p=gme(g,t,s,c,a[n],u,d,f);break;case"dialog":p=mme(g,t,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var _=[];a&&a[n]&&Ls(a[n]).forEach(function(N){var E="";if(a[n][N].Type==an.CMNT){E=dy(a[n][N].Target,t);var P=vme(sa(e,E,!0),E,c);if(!P||!P.length)return;_O(p,P,!1)}a[n][N].Type==an.TCMNT&&(E=dy(a[n][N].Target,t),_=_.concat(tfe(sa(e,E,!0),c)))}),_&&_.length&&_O(p,_,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function fl(e){return e.charAt(0)=="/"?e.slice(1):e}function Gpe(e,t){if(Zm(),t=t||{},P3(t),yl(e,"META-INF/manifest.xml")||yl(e,"objectdata.xml"))return FO(e,t);if(yl(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Pk<"u"){if(e.FileIndex)return Pk(e);var r=Er.utils.cfb_new();return zF(e).forEach(function(ae){Qr(r,ae,roe(e,ae))}),Pk(r)}throw new Error("Unsupported NUMBERS file")}if(!yl(e,"[Content_Types].xml"))throw yl(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):yl(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zF(e),s=Yoe(Go(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",sa(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!sa(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(Ny=[],s.sst)try{Ny=yme(sa(e,fl(s.sst)),s.sst,t)}catch(ae){if(t.WTF)throw ae}t.cellStyles&&s.themes.length&&(c=xme(Go(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=pme(sa(e,fl(s.style)),s.style,c,t))}s.links.map(function(ae){try{var ee=Ey(Go(e,sv(fl(ae))),ae);return _me(sa(e,fl(ae)),ee,ae,t)}catch{}});var d=dme(sa(e,fl(s.workbooks[0])),s.workbooks[0],t),f={},g="";s.coreprops.length&&(g=sa(e,fl(s.coreprops[0]),!0),g&&(f=I$(g)),s.extprops.length!==0&&(g=sa(e,fl(s.extprops[0]),!0),g&&rle(g,f,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Go(e,fl(s.custprops[0]),!0),g&&(p=sle(g,t)));var x={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(ee){return ee.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(x.Props=f,x.Custprops=p),t.bookSheets&&typeof i<"u"&&(x.SheetNames=i),t.bookSheets?x.SheetNames:t.bookProps))return x;i={};var v={};t.bookDeps&&s.calcchain&&(v=wme(sa(e,fl(s.calcchain)),s.calcchain));var w=0,C={},k,_;{var N=d.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var E=0;E!=N.length;++E)f.SheetNames[E]=N[E].name}var P=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),A=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");yl(e,A)||(A="xl/_rels/workbook."+P+".rels");var j=Ey(Go(e,A,!0),A.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=bme(sa(e,fl(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=nfe(sa(e,fl(s.people[0])),t)),j&&(j=Wpe(j,d.Sheets));var I=sa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=f.Worksheets;++w){var L="sheet";if(j&&j[w]?(k="xl/"+j[w][1].replace(/[\/]?xl\//,""),yl(e,k)||(k=j[w][1]),yl(e,k)||(k=A.replace(/_rels\/.*$/,"")+j[w][1]),L=j[w][2]):(k="xl/worksheets/sheet"+(w+1-I)+"."+P,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(f.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var Y=!1,Z=0;Z!=t.sheets.length;++Z)typeof t.sheets[Z]=="number"&&t.sheets[Z]==w&&(Y=1),typeof t.sheets[Z]=="string"&&t.sheets[Z].toLowerCase()==f.SheetNames[w].toLowerCase()&&(Y=1);if(!Y)continue e}}Hpe(e,k,_,f.SheetNames[w],w,C,i,L,t,d,c,u)}return x={Directory:s,Workbook:d,Props:f,Custprops:p,Deps:v,Sheets:i,SheetNames:f.SheetNames,Strings:Ny,Styles:u,Themes:c,SSF:os(Fr)},t&&t.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(ae,ee){ae=ae.replace(/^Root Entry[\/]/,""),x.keys.push(ae),x.files[ae]=e.FileIndex[ee]}))),t&&t.bookVBA&&(s.vba.length>0?x.vbaraw=sa(e,fl(s.vba[0]),!0):s.defaults&&s.defaults.bin===dfe&&(x.vbaraw=sa(e,"xl/vbaProject.bin",!0))),x}function Vpe(e,t){var r=t||{},n="Workbook",s=Er.find(e,n);try{if(n="/!DataSpaces/Version",s=Er.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(bue(s.content),n="/!DataSpaces/DataSpaceMap",s=Er.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=kue(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Er.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Cue(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Er.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Eue(s.content)}catch{}if(n="/EncryptionInfo",s=Er.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Nue(s.content);if(n="/EncryptedPackage",s=Er.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function Kpe(e,t){return t.bookType=="ods"?VU(e,t):t.bookType=="numbers"?Upe(e,t):t.bookType=="xlsb"?qpe(e,t):Ype(e,t)}function qpe(e,t){tm=1024,e&&!e.SSF&&(e.SSF=os(Fr)),e&&e.SSF&&(Zm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ay?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=wU.indexOf(t.bookType)>-1,s=x3();F3(t=t||{});var a=n3(),i="",o=0;if(t.cellXfs=[],$f(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qr(a,i,R$(e.Props,t)),s.coreprops.push(i),Dn(t.rels,2,i,an.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Qr(a,i,B$(e.Props)),s.extprops.push(i),Dn(t.rels,3,i,an.EXT_PROPS),e.Custprops!==e.Props&&Ls(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qr(a,i,$$(e.Custprops)),s.custprops.push(i),Dn(t.rels,4,i,an.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],g=(f||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Qr(a,i,kme(o-1,i,t,e,d)),s.sheets.push(i),Dn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,an.WS[0])}if(f){var p=f["!comments"],x=!1,v="";p&&p.length>0&&(v="xl/comments"+o+"."+r,Qr(a,v,Eme(p,v)),s.comments.push(v),Dn(d,-1,"../comments"+o+"."+r,an.CMNT),x=!0),f["!legacy"]&&x&&Qr(a,"xl/drawings/vmlDrawing"+o+".vml",yU(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Qr(a,sv(i),dm(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qr(a,i,Tme(t.Strings,i,t)),s.strs.push(i),Dn(t.wbrels,-1,"sharedStrings."+r,an.SST)),i="xl/workbook."+r,Qr(a,i,Sme(e,i)),s.workbooks.push(i),Dn(t.rels,1,i,an.WB),i="xl/theme/theme1.xml",Qr(a,i,S3(e.Themes,t)),s.themes.push(i),Dn(t.wbrels,-1,"theme/theme1.xml",an.THEME),i="xl/styles."+r,Qr(a,i,Cme(e,i,t)),s.styles.push(i),Dn(t.wbrels,-1,"styles."+r,an.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Qr(a,i,e.vbaraw),s.vba.push(i),Dn(t.wbrels,-1,"vbaProject.bin",an.VBA)),i="xl/metadata."+r,Qr(a,i,Nme(i)),s.metadata.push(i),Dn(t.wbrels,-1,"metadata."+r,an.XLMETA),Qr(a,"[Content_Types].xml",O$(s,t)),Qr(a,"_rels/.rels",dm(t.rels)),Qr(a,"xl/_rels/workbook."+r+".rels",dm(t.wbrels)),delete t.revssf,delete t.ssf,a}function Ype(e,t){tm=1024,e&&!e.SSF&&(e.SSF=os(Fr)),e&&e.SSF&&(Zm(),a2(e.SSF),t.revssf=o2(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Ay?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=wU.indexOf(t.bookType)>-1,s=x3();F3(t=t||{});var a=n3(),i="",o=0;if(t.cellXfs=[],$f(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",Qr(a,i,R$(e.Props,t)),s.coreprops.push(i),Dn(t.rels,2,i,an.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Qr(a,i,B$(e.Props)),s.extprops.push(i),Dn(t.rels,3,i,an.EXT_PROPS),e.Custprops!==e.Props&&Ls(e.Custprops||{}).length>0&&(i="docProps/custom.xml",Qr(a,i,$$(e.Custprops)),s.custprops.push(i),Dn(t.rels,4,i,an.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},g=e.Sheets[e.SheetNames[o-1]],p=(g||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,Qr(a,i,PU(o-1,t,e,f)),s.sheets.push(i),Dn(t.wbrels,-1,"worksheets/sheet"+o+"."+r,an.WS[0])}if(g){var x=g["!comments"],v=!1,w="";if(x&&x.length>0){var C=!1;x.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(C=!0)})}),C&&(w="xl/threadedComments/threadedComment"+o+"."+r,Qr(a,w,rfe(x,d,t)),s.threadedcomments.push(w),Dn(f,-1,"../threadedComments/threadedComment"+o+"."+r,an.TCMNT)),w="xl/comments"+o+"."+r,Qr(a,w,vU(x)),s.comments.push(w),Dn(f,-1,"../comments"+o+"."+r,an.CMNT),v=!0}g["!legacy"]&&v&&Qr(a,"xl/drawings/vmlDrawing"+o+".vml",yU(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}f["!id"].rId1&&Qr(a,sv(i),dm(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,Qr(a,i,iU(t.Strings,t)),s.strs.push(i),Dn(t.wbrels,-1,"sharedStrings."+r,an.SST)),i="xl/workbook."+r,Qr(a,i,RU(e)),s.workbooks.push(i),Dn(t.rels,1,i,an.WB),i="xl/theme/theme1.xml",Qr(a,i,S3(e.Themes,t)),s.themes.push(i),Dn(t.wbrels,-1,"theme/theme1.xml",an.THEME),i="xl/styles."+r,Qr(a,i,gU(e,t)),s.styles.push(i),Dn(t.wbrels,-1,"styles."+r,an.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",Qr(a,i,e.vbaraw),s.vba.push(i),Dn(t.wbrels,-1,"vbaProject.bin",an.VBA)),i="xl/metadata."+r,Qr(a,i,xU()),s.metadata.push(i),Dn(t.wbrels,-1,"metadata."+r,an.XLMETA),d.length>1&&(i="xl/persons/person.xml",Qr(a,i,sfe(d)),s.people.push(i),Dn(t.wbrels,-1,"persons/person.xml",an.PEOPLE)),Qr(a,"[Content_Types].xml",O$(s,t)),Qr(a,"_rels/.rels",dm(t.rels)),Qr(a,"xl/_rels/workbook."+r+".rels",dm(t.wbrels)),delete t.revssf,delete t.ssf,a}function O3(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Yo(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Xpe(e,t){return Er.find(e,"EncryptedPackage")?Vpe(e,t):$U(e,t)}function Jpe(e,t){var r,n=e,s=t||{};return s.type||(s.type=en&&Buffer.isBuffer(e)?"buffer":"base64"),r=l$(n,s),Gpe(r,s)}function qU(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return wE(e.slice(r),t);default:break e}return Tm.to_workbook(e,t)}function Qpe(e,t){var r="",n=O3(e,t);switch(t.type){case"base64":r=Yo(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=g0(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=zn(r)),t.type="binary",qU(r,t)}function Zpe(e,t){var r=e;return t.type=="base64"&&(r=Yo(r)),r=Qy.utils.decode(1200,r.slice(2),"str"),t.type="binary",qU(r,t)}function exe(e){return e.match(/[^\x00-\x7F]/)?Hc(e):e}function Fk(e,t,r,n){return n?(r.type="string",Tm.to_workbook(e,r)):Tm.to_workbook(t,r)}function SE(e,t){Q4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return SE(new Uint8Array(e),(r=os(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),hm={},r.dateNF&&(hm.dateNF=r.dateNF),r.type||(r.type=en&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=en?"buffer":"binary",n=qie(e),typeof Uint8Array<"u"&&!en&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=exe(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=os(r),r.type="array",SE(Z4(n),r)}switch((s=O3(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Xpe(Er.read(n,r),r);break;case 9:if(s[1]<=8)return $U(n,r);break;case 60:return wE(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return aue(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return sU.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Jpe(n,r):Fk(e,n,r,a);case 239:return s[3]===60?wE(n,r):Fk(e,n,r,a);case 255:if(s[1]===254)return Zpe(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Kh.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Kh.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return vE.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return dU.to_workbook(n,r);break;case 10:case 13:case 32:return Qpe(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return sue.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?vE.to_workbook(n,r):Fk(e,n,r,a)}function YU(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Hv(t.file,Er.write(e,{type:en?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Er.write(e,t)}function txe(e,t){var r=os(t||{}),n=Kpe(e,r);return rxe(n,r)}function rxe(e,t){var r={},n=en?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Er.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(s2(s))}return t.password&&typeof encrypt_agile<"u"?YU(encrypt_agile(s,t.password),t):t.type==="file"?Hv(t.file,s):t.type=="string"?zn(s):s}function nxe(e,t){var r=t||{},n=epe(e,r);return YU(n,r)}function Lc(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Zy(Hc(n));case"binary":return Hc(n);case"string":return e;case"file":return Hv(t.file,n,"utf8");case"buffer":return en?ud(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Lc(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function sxe(e,t){switch(t.type){case"base64":return Zy(e);case"binary":return e;case"string":return e;case"file":return Hv(t.file,e,"binary");case"buffer":return en?ud(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dw(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Zy(r):t.type=="string"?zn(r):r;case"file":return Hv(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function XU(e,t){Q4(),Xge(e);var r=os(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=XU(e,r);return r.type="array",s2(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Lc(Kme(e,r),r);case"slk":case"sylk":return Lc(nU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Lc(zU(e.Sheets[e.SheetNames[s]],r),r);case"txt":return sxe(JU(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Lc(D3(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Lc(sU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return Dw(vE.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Lc(Tm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Lc(dU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Lc(aU.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Lc(VU(e,r),r);case"wk1":return Dw(Kh.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return Dw(Kh.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Dw(UU(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),nxe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return txe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function axe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function ixe(e,t,r){var n={};return n.type="file",n.file=t,axe(n),XU(e,n)}function oxe(e,t,r,n,s,a,i,o){var c=Xs(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var x=i?e[r][p]:e[n[p]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;a[p]!=null&&(g[a[p]]=u);continue}var v=x.v;switch(x.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(a[p]!=null){if(v==null)if(x.t=="e"&&v===null)g[a[p]]=null;else if(u!==void 0)g[a[p]]=u;else if(d&&v===null)g[a[p]]=null;else continue;else g[a[p]]=d&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?v:nd(x,v,o);v!=null&&(f=!1)}}return{row:g,isempty:f}}function Y_(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=pn(d);break;case"number":c=pn(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=Xs(c.s.r),g=[],p=[],x=0,v=0,w=Array.isArray(e),C=c.s.r,k=0,_={};w&&!e[C]&&(e[C]=[]);var N=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(N[k]||{}).hidden)switch(g[k]=_s(k),r=w?e[C][k]:e[g[k]+f],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=g[k];break;case 3:a[k]=u.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=nd(r,null,u),v=_[i]||0,!v)_[i]=1;else{do o=i+"_"+v++;while(_[o]);_[i]=v,_[o]=1}a[k]=o}for(C=c.s.r+s;C<=c.e.r;++C)if(!(E[C]||{}).hidden){var P=oxe(e,c,C,g,n,a,w,u);(P.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[x++]=P.row)}return p.length=x,p}var MO=/"/g;function lxe(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",f=Xs(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var p=o.dense?(e[r]||[])[g]:e[n[g]+f];if(p==null)d="";else if(p.v!=null){c=!1,d=""+(o.rawNumbers&&p.t=="n"?p.v:nd(p,null,o));for(var x=0,v=0;x!==d.length;++x)if((v=d.charCodeAt(x))===s||v===a||v===34||o.forceQuotes){d='"'+d.replace(MO,'""')+'"';break}d=="ID"&&(d='"ID"')}else p.f!=null&&!p.F?(c=!1,d="="+p.f,d.indexOf(",")>=0&&(d='"'+d.replace(MO,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function D3(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=pn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],x=s.s.c;x<=s.e.c;++x)(g[x]||{}).hidden||(f[x]=_s(x));for(var v=0,w=s.s.r;w<=s.e.r;++w)(p[w]||{}).hidden||(d=lxe(e,s,w,f,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((v++?o:"")+d)));return delete n.dense,r.join("")}function JU(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=D3(e,t);return r}function cxe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=pn(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=_s(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=Xs(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function QU(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?bs(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var f=pn(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var g=n.header||[],p=0;t.forEach(function(v,w){Ls(v).forEach(function(C){(p=g.indexOf(C))==-1&&(g[p=g.length]=C);var k=v[C],_="z",N="",E=Rr({c:o+p,r:i+w+s});u=dv(a,E),k&&typeof k=="object"&&!(k instanceof Date)?a[E]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=Sa(k)),N=n.dateNF||Fr[14]):k===null&&n.nullError&&(_="e",k=0),u?(u.t=_,u.v=k,delete u.w,delete u.R,N&&(u.z=N)):a[E]=u={t:_,v:k},N&&(u.z=N))})}),d.e.c=Math.max(d.e.c,o+g.length-1);var x=Xs(i);if(s)for(p=0;p<g.length;++p)a[_s(p+o)+x]={t:"s",v:g[p]};return a["!ref"]=Xr(d),a}function uxe(e,t){return QU(null,e,t)}function dv(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=bs(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?dv(e,Rr(t)):dv(e,Rr({r:t,c:r||0}))}function dxe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function I3(){return{SheetNames:[],Sheets:{}}}function R3(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(IU(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function fxe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=dxe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function hxe(e,t){return e.z=t,e}function ZU(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function gxe(e,t,r){return ZU(e,"#"+t,r)}function mxe(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function pxe(e,t,r,n){for(var s=typeof t!="string"?t:pn(t),a=typeof t=="string"?t:Xr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=dv(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var a_={encode_col:_s,encode_row:Xs,encode_cell:Rr,encode_range:Xr,decode_col:d3,decode_row:u3,split_cell:Toe,decode_cell:bs,decode_range:To,format_cell:nd,sheet_add_aoa:T$,sheet_add_json:QU,sheet_add_dom:WU,aoa_to_sheet:ep,json_to_sheet:uxe,table_to_sheet:HU,table_to_book:bpe,sheet_to_csv:D3,sheet_to_txt:JU,sheet_to_json:Y_,sheet_to_html:zU,sheet_to_formulae:cxe,sheet_to_row_object_array:Y_,sheet_get_cell:dv,book_new:I3,book_append_sheet:R3,book_set_sheet_visibility:fxe,cell_set_number_format:hxe,cell_set_hyperlink:ZU,cell_set_internal_link:gxe,cell_add_comment:mxe,sheet_set_array_formula:pxe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const ez=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n,forceRefreshOnMount:s=!1})=>{Eo(),Pb();const{user:a,isAuthenticated:i}=cs(),{showNotification:o}=ka(),c=S.useCallback(st=>{let mt=null;if(typeof st?.percentage=="number"&&!Number.isNaN(st.percentage))return mt=Math.round(st.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:st.percentage,rounded:mt,result:st}),mt;const Yt=st?.retest_best_score??st?.score,St=st?.retest_best_max_score??st?.max_score,br=Number(Yt??0),Pt=Number(St??0);return Pt>0&&(mt=Math.round(br/Pt*100)),mt},[]);S.useCallback(st=>{const mt=c(st);return mt===null?"text-gray-600":mt<50?"text-red-600 font-semibold":mt<70?"text-yellow-600":"text-green-600"},[c]),S.useCallback(st=>{const mt=c(st);return mt!==null&&mt<50},[c]);const[u,d]=S.useState(null),[f,g]=S.useState(!0),[p,x]=S.useState(""),[v,w]=S.useState([]),[C,k]=S.useState(null),[_,N]=S.useState(!1),[E,P]=S.useState([]),[F,A]=S.useState([]),[j,I]=S.useState([1,2]),[L,Y]=S.useState(null),[Z,ae]=S.useState(null),[ee,ne]=S.useState(null),[B,V]=S.useState("main"),[M,H]=S.useState(null),[W,R]=S.useState(null),z=M||t,K=W||r,[J,se]=S.useState(null),[X,ie]=S.useState({}),[le,ce]=S.useState(!1),[be,re]=S.useState(new Set),[pe,Ce]=S.useState(!0),[Ae,We]=S.useState(null),[Le,At]=S.useState(null),[Qe,gt]=S.useState(!1),[ht,tt]=S.useState(!1),[ut,Dt]=S.useState(!1),Rt=S.useRef(null),[It,De]=S.useState(null),[Ie,Je]=S.useState(!1),[qe,Ze]=S.useState(null),[Tt,Nt]=S.useState(!1),[$t,ir]=S.useState(null),[pr,Nr]=S.useState(""),[dr,Vt]=S.useState(""),[ge,Te]=S.useState(!1),[Fe,Me]=S.useState(!1),[kt,Pe]=S.useState(null),[He,ke]=S.useState(""),[$e,Ue]=S.useState(!1),[Et,Ft]=S.useState(new Set),[zt,fr]=S.useState({}),[nr,Dr]=S.useState(!1),[ue,we]=S.useState(null),[ye,xe]=S.useState(""),[_e,Se]=S.useState(!1),[Ve,lt]=S.useState(null),[Ke,oe]=S.useState(null),[fe,Ee]=S.useState(!1),[Ne,Ye]=S.useState(!1),[ot,pt]=S.useState({}),Gt=S.useRef(new Set),xt=S.useRef({}),Jt=S.useRef(null);S.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(Et)),Gt.current=Et},[Et]),S.useEffect(()=>{console.log(" columnScores state changed:",zt),xt.current=zt},[zt]);const wr=S.useCallback(st=>{console.log(" Toggling test collapse for:",st),re(mt=>{const Yt=new Set(mt);return Yt.has(st)?(Yt.delete(st),console.log(" Expanding test:",st)):(Yt.add(st),console.log(" Collapsing test:",st)),console.log(" New collapsed tests:",Array.from(Yt)),Yt})},[]),Sr=S.useCallback(()=>{if(Rt.current){const{scrollLeft:st,scrollWidth:mt,clientWidth:Yt}=Rt.current;tt(st>0),Dt(st<mt-Yt-1)}},[]);S.useEffect(()=>{Ir()},[]),S.useEffect(()=>{if(L&&Rt.current){const st=setTimeout(Sr,100);return()=>clearTimeout(st)}},[L,Sr]),S.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(be))},[be]);const xr=S.useCallback(async(st,mt=!1)=>{try{ce(!0);const Yt=a?.teacher_id,St=`${z}/${K}`,br=await gae.getTeacherStudentResults(Yt,z,St,st,mt);if(br.success){console.log(" Results loaded for term:",st,br.results?.length||0,"results"),console.log(" Students loaded:",br.students?.length||0,"students");const Pt=[],Wr=new Set,nn=new Set;br.results&&br.results.length>0&&br.results.forEach(Lt=>{Lt.test_name&&!Wr.has(Lt.test_name)&&(Wr.add(Lt.test_name),Pt.push({test_name:Lt.test_name,test_type:Lt.test_type,subject:Lt.subject})),Lt.subject&&nn.add(Lt.subject)});const rt=(br.students||[]).map(Lt=>{const bn={};return(br.results||[]).filter(Vr=>Vr.student_id===Lt.student_id).forEach(Vr=>{Vr.test_name&&(bn[Vr.test_name]={id:Vr.id,test_type:Vr.test_type,test_id:Vr.test_id,subject_id:Vr.subject_id,score:Vr.score,max_score:Vr.max_score,retest_offered:Vr.retest_offered,caught_cheating:Vr.caught_cheating,visibility_change_times:Vr.visibility_change_times,answers:Vr.answers,ai_feedback:Vr.ai_feedback,name:Vr.name,surname:Vr.surname,test_name:Vr.test_name})}),{...Lt,...bn}}),Qt={results:br.results||[],students:rt,class:rt,unique_tests:Pt,subjects:Array.from(nn),count:br.count||0,student_count:br.student_count||0};console.log(" Processed results data:",{uniqueTests:Pt.length,subjects:Array.from(nn),resultsCount:br.results?.length||0,studentsWithScores:rt.length,sampleStudent:rt[0]}),Y(Qt),ie(Qt),ne(new Date)}}catch(Yt){console.error(" Error loading results for term:",Yt),Y(null),ie(null)}finally{ce(!1)}},[a,z,K]);S.useEffect(()=>{(async()=>{try{gt(!0),await rd.loadAcademicCalendar();const mt=rd.getCurrentSemesterTerms();At(mt),mt?.currentTerm&&(We(mt.currentTerm.id),z&&K&&xr(mt.currentTerm.id,s))}catch(mt){console.error(" Error initializing academic calendar:",mt)}finally{gt(!1)}})()},[z,K,xr,s]),S.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),Le?.currentTerm&&(We(Le.currentTerm.id),xr(Le.currentTerm.id,s)))},[t,r,Le,xr,s]);const Ir=S.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(g(!0),x(""),!i||!a){console.log(" User not authenticated"),x("User not authenticated");return}if(a.role!==Qi.TEACHER){console.error(" Invalid user role for teacher results:",a.role),x("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await rn(),console.log(" TODO: Load academic calendar service"),console.log(" Teacher results initialization complete!")}catch(st){console.error(" Error initializing teacher results:",st),x("Failed to initialize teacher results")}finally{g(!1)}},[i,a]),rn=S.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const st=`teacher_data_${a?.teacher_id||a?.id||""}`;let mt=Rs(st);mt&&mt.subjects&&mt.subjects.length>0&&(mt.subjects.some(rt=>rt.subject&&rt.classes&&rt.classes.length>0)||(console.log(" Cached data has invalid subject structure, forcing refresh"),localStorage.removeItem(st),mt=null)),mt?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),mt=await hs.getTeacherData(),console.log(" Teacher data loaded:",mt),vs(st,mt,Is.teacher_subjects)),d(mt);const Yt=[];mt&&mt.subjects&&(console.log(" Teacher subjects structure:",mt.subjects),mt.subjects.forEach(nn=>{console.log(" Processing subject:",nn),nn.classes&&nn.classes.forEach(rt=>{rt.grade&&rt.class&&Yt.push({grade:rt.grade,class:rt.class,subject:nn.subject||nn.name||"Unknown Subject"})})})),A(Yt),console.log(" Available classes from teacher data:",Yt);const St=`teacher_tests_${a?.teacher_id||a?.id||""}`,br=Rs(St);br&&br.some(nn=>nn.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(St));let Pt=Rs(St);Pt?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),Pt=await hn.getTeacherTests(),console.log(" Teacher tests loaded:",Pt),vs(St,Pt,Is.teacher_tests));const Wr=Pt.flatMap(nn=>nn.assignments||[]);w(Wr),console.log(" Raw assignments data:",Wr),console.log(" Teacher assignments loaded:",Wr.length)}catch(st){console.error(" Error loading teacher assignments:",st),o("Failed to load teacher assignments","error")}},[o]),Jr=S.useCallback(async(st,mt)=>{console.log(" Showing classes for grade:",st,"class:",mt),H(st),R(mt),k(null),Y(null),st&&mt&&console.log(" TODO: Implement academic calendar service for term selection")},[]);S.useCallback((st,mt)=>{console.log(" Showing semesters for class:",st,mt),k(null),Y(null),console.log(" TODO: Implement academic calendar service for term selection")},[]),S.useCallback((st,mt)=>{console.log(" Class clicked:",st,mt),N(!0),console.log(" TODO: Implement academic calendar service for term selection")},[]);const he=S.useCallback(async(st,mt=!1)=>{!z||!K||(console.log(" Loading results for semester:",st,"forceRefresh:",mt),k(st),Le?.currentTerm&&await xr(Le.currentTerm.id,mt))},[z,K,Le,xr]),vt=S.useCallback(()=>Le?l.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Current Semester: ",Le?.semester===1?"Semester 1":"Semester 2"]}),l.jsx("div",{className:"flex space-x-4",children:Le?.terms.map(st=>l.jsx(at.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${st.isCurrent?"bg-blue-600 text-white shadow-lg":Ae===st.id?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>{We(st.id),xr(st.id)},whileHover:{scale:1.05},whileTap:{scale:.95},children:st.label},st.id))})]}):l.jsx("div",{className:"flex space-x-4 mb-6",children:l.jsx("div",{className:"px-6 py-3 rounded-lg bg-gray-200 text-gray-500",children:"Loading terms..."})}),[Le,Ae,xr]);S.useCallback(st=>st.reduce((mt,Yt)=>(mt[Yt.student_id]||(mt[Yt.student_id]=[]),mt[Yt.student_id].push(Yt),mt),{}),[]),S.useCallback(st=>{if(st.length===0)return 0;const mt=st.reduce((Yt,St)=>Yt+(St.percentage||0),0);return Math.round(mt/st.length)},[]),S.useCallback(st=>{st.score<st.passing_score&&window.confirm("Give another try?")&&kr(st.student_id,st.test_id)},[]);const kr=S.useCallback(async(st,mt)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:st,testId:mt})})).ok&&(K&&he(C,!0),o("Test made accessible to student","success"))}catch(Yt){console.error("Error resetting test attempt:",Yt),o("Failed to reset test attempt","error")}},[K,C,he,o]),Cr=S.useCallback((st,mt)=>{if(st===null||mt===null)return"";const Yt=Math.round(st/mt*100);return Yt>=80?"text-green-600 bg-green-50":Yt>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),Nn=S.useCallback(st=>{De(st),Je(!0)},[]),_n=S.useCallback((st,mt="overview",Yt)=>{try{const br=!!st?.ai_feedback,Pt=typeof st?.ai_feedback;let Wr=[];if(br)if(Pt==="string")try{Wr=Object.keys(JSON.parse(st.ai_feedback))}catch{Wr=["<invalid json>"]}else Pt==="object"&&(Wr=Object.keys(st.ai_feedback||{}));console.log("[AI DEBUG] Opening speaking result",{hasAi:br,aiType:Pt,aiKeys:Wr})}catch{}const St={...st,__initialTab:mt};Yt&&(St.__audioUrl=Yt),Ze(St),Nt(!0)},[]),Zr=S.useCallback(async(st,mt)=>{if(!st||!mt)return console.error("fetchTestQuestions: Missing testType or testId",{testType:st,testId:mt}),null;const Yt=`${st}_${mt}`;if(ot[Yt])return console.log(" Using cached questions for",Yt),ot[Yt];Ye(!0);try{console.log(" Fetching questions for",{testType:st,testId:mt});const St=await hn.getTestQuestions(st,mt);return console.log(" Questions fetched:",St?.length||0,"questions"),pt(br=>({...br,[Yt]:St})),St}catch(St){return console.error(" Error fetching test questions:",St),o("Failed to load test questions","error"),null}finally{Ye(!1)}},[ot,o]),Be=S.useCallback(async(st,mt)=>{if(console.log(" Opening answer modal for:",{testResult:st,test:mt}),console.log(" [handleViewAnswers] testResult.answers:",st?.answers),console.log(" [handleViewAnswers] testResult.answers type:",typeof st?.answers),console.log(" [handleViewAnswers] Full testResult keys:",st?Object.keys(st):"null"),st.test_type==="drawing"||mt?.test_type==="drawing"){Nn(st);return}if(st.test_type==="speaking"||mt?.test_type==="speaking"){_n(st);return}const Yt=st.test_type||mt?.test_type;if(Yt==="word_matching"||Yt==="matching_type"){o("Word matching and picture matching tests have separate view mechanisms","info");return}lt(st),oe(null),Ee(!0),Ye(!0);const St=st.test_id||mt?.test_id;if(!Yt||!St){o("Unable to load test questions: Missing test type or ID","error"),Ye(!1);return}try{const br=await Zr(Yt,St);br?oe(br):o("Failed to load test questions","error")}finally{Ye(!1)}},[Zr,Nn,_n,o]);S.useCallback((st,mt,Yt)=>{ir({resultId:st,score:mt,maxScore:Yt}),Nr(mt?.toString()||""),Vt(Yt?.toString()||""),Me(!0)},[]),S.useCallback(st=>{Nr(st)},[]),S.useCallback(st=>{Vt(st)},[]),S.useCallback(async()=>{if($t){Te(!0);try{const st={resultId:$t.resultId,score:parseInt(pr)||0,maxScore:parseInt(dr)||1};(await fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)})).ok?(o("Score updated successfully","success"),K&&he(C,!0),ir(null),Nr(""),Vt(""),Me(!1)):o("Failed to update score","error")}catch(st){console.error("Error updating score:",st),o("Failed to update score","error")}finally{Te(!1)}}},[$t,pr,dr,K,C,he,o]),S.useCallback(()=>{ir(null),Nr(""),Vt(""),Me(!1)},[]);const Ct=S.useCallback((st,mt)=>{Pe({resultId:st,score:mt}),ke(mt.toString())},[]),qt=S.useCallback(async()=>{if(kt){Ue(!0);try{const st={resultId:kt.resultId,score:parseInt(He)||0},mt=await fetch(Yx.UPDATE_SPEAKING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)});if(mt.ok){const Yt=await mt.json();o("Speaking test score updated successfully","success"),qe&&Ze(St=>({...St,score:Yt.score,percentage:Yt.percentage})),K&&he(C,!0),Pe(null),ke("")}else{const Yt=await mt.json();o(Yt.error||"Failed to update speaking test score","error")}}catch(st){console.error("Error updating speaking test score:",st),o("Failed to update speaking test score","error")}finally{Ue(!1)}}},[kt,He,K,C,he,o]),lr=S.useCallback(()=>{Pe(null),ke("")},[]),es=(st,mt)=>{console.log(" Starting column editing for drawing test:",st),console.log(" Current editingColumns before update:",Array.from(Et)),console.log(" Results data passed to function:",mt),Ft(Yt=>{const St=new Set(Yt).add(st);return console.log(" Updated editingColumns:",Array.from(St)),St}),console.log(" Initializing column scores for test:",st),console.log(" Results data:",mt),console.log(" Results.class:","null"),console.log(" No results or class data available")},Kn=S.useCallback(st=>{Ft(mt=>{const Yt=new Set(mt);return Yt.delete(st),Yt}),fr(mt=>{const Yt={...mt};return delete Yt[st],Yt})},[]),Mi=S.useCallback((st,mt,Yt,St)=>{const br=St.toString();xt.current[st]||(xt.current[st]={}),xt.current[st][mt]||(xt.current[st][mt]={}),xt.current[st][mt][Yt]=br;const Pt=parseInt(St)||0;fr(Wr=>({...Wr,[st]:{...Wr[st],[mt]:{...Wr[st]?.[mt],[Yt]:Pt}}}))},[]);S.useCallback(async st=>{if(xt.current[st]){Dr(!0);try{const mt=Object.entries(xt.current[st]).map(([Pt,Wr])=>({resultId:Wr.resultId,score:parseInt(Wr.score)||0,maxScore:parseInt(Wr.maxScore)||100}));console.log(" Saving column scores for",st,":",mt);const Yt=mt.map(Pt=>(console.log(" Sending update:",Pt),fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Pt)})));(await Promise.all(Yt)).every(Pt=>Pt.ok)?(o(`Scores updated successfully for ${st}`,"success"),K&&he(C,!0),Kn(st)):o("Failed to update some scores","error")}catch(mt){console.error("Error updating column scores:",mt),o("Failed to update scores","error")}finally{Dr(!1)}}},[zt,K,C,he,o,Kn]);const B0=S.useCallback((st,mt,Yt)=>!mt||mt.length===0?l.jsx(at.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(at.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:l.jsxs(at.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[l.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:St=>{Rt.current&&(Rt.current.scrollLeft=St.target.scrollLeft)},children:l.jsx("div",{className:"min-w-full h-1",children:l.jsx("div",{className:"h-1",style:{width:`${(Yt.length+5)*120}px`}})})}),l.jsx("div",{ref:Rt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:St=>{Sr(St);const br=St.target.previousElementSibling;br&&(br.scrollLeft=St.target.scrollLeft)},children:l.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[l.jsx("thead",{children:l.jsxs(at.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 ${pe?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[180px] bg-blue-50 cursor-pointer select-none"}`,onClick:St=>{St.preventDefault(),St.stopPropagation(),Ce(!pe)},title:"Toggle student name columns",children:pe?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),Yt.map((St,br)=>{const Pt=be.has(St.test_name),Wr=St.test_type==="drawing",nn=Gt.current.has(St.test_name);return console.log(` Rendering test ${St.test_name}:`,{isDrawingTest:Wr,isEditingColumn:nn,editingColumns:Array.from(Gt.current),test_type:St.test_type}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${Pt?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:rt=>{rt.preventDefault(),rt.stopPropagation(),wr(St.test_name)},children:Pt?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:St.test_name,children:St.test_name.length>8?St.test_name.substring(0,8)+"...":St.test_name}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},br)})]})}),l.jsx("tbody",{children:l.jsx(wo,{children:mt.map((St,br)=>l.jsxs(at.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${br%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+br*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:St.student_id}),pe?l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Pt=>{Pt.preventDefault(),Pt.stopPropagation(),Ce(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:St.name}),l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:St.surname})]}),l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:St.number??br+1}),l.jsx(at.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:St.nickname||"-"}),Yt.map((Pt,Wr)=>{const nn=be.has(Pt.test_name),rt=St[Pt.test_name];return nn?(console.log(" Rendering collapsed column for test:",Pt.test_name),l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Qt=>{Qt.preventDefault(),Qt.stopPropagation(),console.log(" Clicked on collapsed arrow for:",Pt.test_name),wr(Pt.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Wr)):l.jsx(at.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:Qt=>{console.debug("[TeacherResults] Main table TD clicked",{testResult:rt,student:St.student_id});const Lt=rt?.test_type||Pt?.test_type;if(Lt==="drawing"||Lt==="speaking"||Lt==="word_matching"||Lt==="matching_type")return;const bn=c(rt);if(bn!==null&&bn<50){if(rt?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:St.student_id,test:Pt}),n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r})}else Be(rt,Pt)},children:rt&&rt.test_type==="drawing"?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("button",{onClick:()=>Nn(rt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const Qt=`${Pt.test_name}|${St.student_id}`,Lt=ue===Qt,bn=Number.isFinite(rt?.score)?rt.score:0;if(!Lt){const Gr=c(rt),Vr=Gr!==null&&Gr<50,qn=Gr!==null&&Gr>=50&&Gr<70,Mn=rt?.retest_offered===!0,Yn=Gr===null?"text-gray-600":Vr?"text-red-600 font-semibold":qn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Yn} cursor-pointer hover:opacity-90 ${Mn?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Vr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:oo=>{oo.preventDefault(),oo.stopPropagation(),Vr&&!Mn?n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r}):(we(Qt),xe(String(bn)))},title:Mn?"Retest offered":Vr?"Offer retest":"Double-click to edit score",children:[(()=>{const oo=rt.retest_best_score??rt.score,gc=rt.retest_best_max_score??rt.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Vr?"text-red-700":"",children:oo}),"/",l.jsx("span",{children:gc})]})})(),rt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})}return l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:10,value:ye,onChange:Gr=>xe(Gr.target.value),onBlur:async()=>{const Gr=Math.max(0,Math.min(10,parseFloat(ye||"0")));Se(!0);try{const Vr={resultId:rt?.id,score:Gr,maxScore:10},qn=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:qn?`Bearer ${qn}`:""},body:JSON.stringify(Vr)})).ok)throw new Error("Failed to save")}catch{}finally{Se(!1),we(null),he(C,!0)}},onKeyDown:async Gr=>{Gr.key==="Enter"?Gr.currentTarget.blur():Gr.key==="Escape"&&we(null)},className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",disabled:_e}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",value:10,className:"w-12 px-2 py-1 text-xs border border-gray-300 bg-gray-100 rounded",disabled:!0})]})})(),rt.caught_cheating&&rt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",rt.visibility_change_times,")"]})]}):rt&&(rt.test_type==="speaking"||Pt.test_type==="speaking")?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const Qt=rt?.answers;let Lt;if(typeof Qt=="string")if(/^https?:\/\//i.test(Qt))Lt=Qt;else try{Lt=JSON.parse(Qt)?.audio_url}catch{}else Qt&&typeof Qt=="object"&&(Lt=Qt.audio_url);return!Lt&&rt?.audio_url&&(Lt=rt.audio_url),l.jsx(l.Fragment,{children:l.jsx("button",{onClick:()=>_n({...rt,__studentId:St.student_id},"audio",Lt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"Results"})})})(),(()=>{const Qt=Gt.current.has(Pt.test_name);return console.log(` Score cell for ${Pt.test_name}:`,{isEditing:Qt,editingColumns:Array.from(Gt.current),test_name:Pt.test_name}),Qt})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:rt.max_score||100,value:xt.current[Pt.test_name]?.[St.student_id]?.score||rt.score||"",onChange:Qt=>Mi(Pt.test_name,St.student_id,"score",Qt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:xt.current[Pt.test_name]?.[St.student_id]?.maxScore||rt.max_score||100,onChange:Qt=>Mi(Pt.test_name,St.student_id,"maxScore",Qt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",Pt.test_name),console.log(" Results state at double-click:",L),console.log(" Test result:",rt),console.log(" Student:",St),console.log(" Test:",Pt),rt&&rt.id?(console.log(" Starting column editing for speaking test:",Pt.test_name),es(Pt.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const Qt=c(rt),Lt=Qt!==null&&Qt<50,bn=Qt!==null&&Qt>=50&&Qt<70,Gr=rt.retest_offered,Vr=Qt===null?"text-gray-600":Lt?"text-red-600 font-semibold":bn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Vr} cursor-pointer hover:opacity-90 ${Gr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Lt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:qn=>{qn.preventDefault(),qn.stopPropagation(),Lt&&!Gr&&(console.log(" Offering retest for speaking test:",Pt.test_name),n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r}))},title:Gr?"Retest offered":Lt?"Offer retest":'Use "View Results" button to review',children:[(()=>{const qn=rt.retest_best_score??rt.score,Mn=rt.retest_best_max_score??rt.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Lt?"text-red-700":"",children:qn}),"/",l.jsx("span",{children:Mn})]})})(),rt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),rt.caught_cheating&&rt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",rt.visibility_change_times,")"]})]})]}):rt&&rt.score!==null&&rt.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const Qt=c(rt),Lt=Qt!==null&&Qt<50,bn=Qt!==null&&Qt>=50&&Qt<70,Gr=Qt===null?"text-gray-600":Lt?"text-red-600 font-semibold":bn?"text-yellow-600":"text-green-600",Vr=rt?.retest_offered===!0;return l.jsxs(at.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${Gr} cursor-pointer hover:opacity-90 ${Vr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Lt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:qn=>{qn.preventDefault(),qn.stopPropagation();const Mn=rt?.test_type||Pt?.test_type;if(!(Mn==="drawing"||Mn==="speaking")){if(rt?.retest_offered){o("Retest is already offered","info");return}Lt?n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r}):Be(rt,Pt)}},title:Vr?"Retest offered":Lt?"Offer retest":"",children:[(()=>{const qn=rt.retest_best_score??rt.score,Mn=rt.retest_best_max_score??rt.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Lt?"text-red-700":"",children:qn}),"/",l.jsx("span",{children:Mn})]})})(),rt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),rt.caught_cheating&&rt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",rt.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Wr)})]},br))})})]})})]})}),[Cr,be,wr,pe]),Gf=S.useCallback((st,mt,Yt)=>!mt||mt.length===0?l.jsx(at.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(at.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:l.jsx(at.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:l.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[l.jsx("thead",{children:l.jsxs(at.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-3 text-left font-semibold text-gray-700 ${pe?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[160px] bg-blue-50 cursor-pointer select-none"}`,onClick:St=>{St.preventDefault(),St.stopPropagation(),Ce(!pe)},title:"Toggle student name columns",children:pe?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-3 h-3 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),Yt.map((St,br)=>(St.test_type,Gt.current.has(St.test_name),l.jsx(at.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+br*.05},children:l.jsx("div",{className:"flex flex-col space-y-1",children:l.jsx("span",{className:"text-xs",children:St.test_name.length>10?St.test_name.substring(0,10)+"...":St.test_name})})},br)))]})}),l.jsx("tbody",{children:l.jsx(wo,{children:mt.map((St,br)=>l.jsxs(at.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${br%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+br*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:St.student_id}),pe?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-xs w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Pt=>{Pt.preventDefault(),Pt.stopPropagation(),Ce(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:St.name}),l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:St.surname})]}),l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:St.number??br+1}),l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:St.nickname||"-"}),Yt.map((Pt,Wr)=>{const nn=be.has(Pt.test_name),rt=St[Pt.test_name];return nn?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:Qt=>{Qt.preventDefault(),Qt.stopPropagation(),wr(Pt.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},Wr):l.jsx(at.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:Qt=>{console.debug("[TeacherResults] TD clicked",{testResult:rt,student:St.student_id});const Lt=rt?.test_type||Pt?.test_type;if(Lt==="drawing"||Lt==="speaking")return;const bn=c(rt);if(bn!==null&&bn<50){if(rt?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:St.student_id}),n({failedStudentIds:[St.student_id],test_type:rt.test_type,original_test_id:rt.test_id,subject_id:rt.subject_id,grade:t,class:r})}else Be(rt,Pt)},children:rt&&(rt.test_type==="drawing"||Pt.test_type==="drawing"||rt.test_type==="speaking"||Pt.test_type==="speaking"||rt.score!==null&&rt.score!==void 0)?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[rt.test_type==="drawing"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Nn(rt),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),Gt.current.has(Pt.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:rt.max_score||100,value:xt.current[Pt.test_name]?.[St.student_id]?.score||rt.score||"",onChange:Qt=>Mi(Pt.test_name,St.student_id,"score",Qt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:xt.current[Pt.test_name]?.[St.student_id]?.maxScore||rt.max_score||100,onChange:Qt=>Mi(Pt.test_name,St.student_id,"maxScore",Qt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):(()=>{const Qt=c(rt),Lt=Qt!==null&&Qt<50,bn=Qt!==null&&Qt>=50&&Qt<70,Gr=rt.retest_offered,Vr=Qt===null?"text-gray-600":Lt?"text-red-600 font-semibold":bn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Vr} cursor-pointer hover:opacity-90 ${Gr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Lt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>es(Pt.test_name),onClick:qn=>{qn.preventDefault(),qn.stopPropagation();const Mn=rt?.test_type||Pt?.test_type;if(!(Mn==="drawing"||Mn==="speaking"))if(Lt){if(rt?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r})}else Be(rt,Pt)},title:Gr?"Retest offered":Lt?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:Lt?"text-red-700":"",children:rt.score}),"/",l.jsx("span",{children:rt.max_score}),rt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):rt.test_type==="speaking"||Pt.test_type==="speaking"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>_n({...rt,__studentId:St.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),kt&&kt.resultId===rt.result_id?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:rt.max_score||100,value:He,onChange:Qt=>ke(Qt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("button",{onClick:()=>qt(),disabled:$e,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50",children:$e?"Saving...":"Save"}),l.jsx("button",{onClick:()=>lr(),disabled:$e,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):(()=>{const Qt=c(rt),Lt=Qt!==null&&Qt<50,bn=Qt!==null&&Qt>=50&&Qt<70,Gr=rt.retest_offered,Vr=Qt===null?"text-gray-600":Lt?"text-red-600 font-semibold":bn?"text-yellow-600":"text-green-600";return l.jsxs(at.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${Vr} cursor-pointer hover:opacity-90 ${Gr?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Lt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>{Pe({resultId:rt.result_id,score:rt.score}),ke(rt.score?.toString()||"")},onClick:qn=>{qn.preventDefault(),qn.stopPropagation();const Mn=rt?.test_type||Pt?.test_type;if(!(Mn==="drawing"||Mn==="speaking"))if(Lt){if(rt?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r})}else Be(rt,Pt)},title:Gr?"Retest offered":Lt?"Offer retest":"Click to view answers, double-click to edit score",children:[l.jsx("span",{className:Lt?"text-red-700":"",children:rt.score||0}),"/",l.jsx("span",{children:rt.max_score||100}),rt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):(()=>{const Qt=c(rt),Lt=Qt!==null&&Qt<50,bn=Qt!==null&&Qt>=50&&Qt<70,Gr=Qt!==null&&Qt>=70,Vr=rt?.retest_offered===!0;console.debug("[TeacherResults] Render pill",{studentId:St.student_id,pct:Qt,isRed:Lt,isYellow:bn,isGreen:Gr,score:rt.score,max:rt.max_score,percentageField:rt.percentage});const Mn=`px-1 py-0.5 rounded text-xs font-medium ${Qt===null?"text-gray-600":Lt?"text-red-600 font-semibold":bn?"text-yellow-600":"text-green-600"} cursor-pointer hover:opacity-90 pointer-events-auto ${Vr?"bg-blue-50 text-blue-700 border border-blue-200":""}`;return l.jsxs(at.div,{className:Mn,style:Lt?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onClick:Yn=>{Yn.preventDefault(),Yn.stopPropagation();const oo=rt?.test_type||Pt?.test_type;if(!(oo==="drawing"||oo==="speaking"))if(Lt){if(rt?.retest_offered){o("Retest is already offered","info");return}const gc=window.getComputedStyle(Yn.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:St.student_id,className:Mn,computedColor:gc}),n({failedStudentIds:[St.student_id],test_type:Pt.test_type,original_test_id:rt?.test_id||Pt.test_id,subject_id:rt?.subject_id||Pt.subject_id,grade:t,class:r})}else Be(rt,Pt)},title:Vr?"Retest offered":Lt?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:Lt?"text-red-700":"",children:rt.score}),"/",l.jsx("span",{children:rt.max_score}),rt.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),rt.caught_cheating&&rt.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",rt.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},Wr)})]},br))})})]})})})}),[Cr,be,wr,pe]),cn=S.useCallback(()=>{if(!L)return null;console.log(" renderResults - results:",L),console.log(" renderResults - results.class:",L.class),console.log(" renderResults - results.unique_tests:",L.unique_tests);const st=L.class&&Array.isArray(L.class)&&L.class.length>0;if(console.log(" renderResults - hasStudentData:",st),!st)return console.log(" renderResults - No student data, showing no students message"),l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const mt=L.unique_tests||[];return console.log(" renderResults - uniqueTests:",mt),Jt.current=L,l.jsxs("div",{className:"space-y-6",children:[l.jsxs(at.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[l.jsxs(at.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",z,", Class ",z,"/",K,", Semester ",C]}),l.jsxs(at.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",L.subjects?.length||0," subject(s)"]}),l.jsxs(at.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[l.jsx("button",{onClick:()=>{const Yt=L.unique_tests?.map(St=>St.test_name)||[];re(new Set(Yt))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),l.jsx("button",{onClick:()=>re(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),l.jsxs(at.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[l.jsx(at.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),l.jsx("div",{className:"hidden md:block",children:B0("All Subjects",L.class,mt)}),l.jsx("div",{className:"md:hidden",children:Gf("All Subjects",L.class,mt)})]})]})},[L,B0,z,K,C]),su=S.useCallback(()=>{if(!L||!L.class||!L.unique_tests)return;const st=["Student ID","Name","Surname","No.","Nickname",...L.unique_tests.map(Wr=>Wr.test_name)],mt=L.class.map((Wr,nn)=>{const rt=[];return rt.push(Wr.student_id),rt.push(Wr.name),rt.push(Wr.surname),rt.push(Wr.number??nn+1),rt.push(Wr.nickname||"-"),L.unique_tests.forEach(Qt=>{const Lt=Wr[Qt.test_name];Lt&&Lt.score!==null&&Lt.score!==void 0?rt.push(`${Lt.score}/${Lt.max_score}`):rt.push("-")}),rt}),Yt=a_.aoa_to_sheet([st,...mt]),St=a_.book_new(),br=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...L.unique_tests.map(()=>({wch:15}))];Yt["!cols"]=br,a_.book_append_sheet(St,Yt,"Class Results");const Pt=`class-results-${z}-${K}-semester-${C}.xlsx`;ixe(St,Pt),o("Excel file exported successfully!","success")},[L,z,K,C,o]);return f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):p?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:p}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex justify-between items-center py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",ee?ee.toLocaleString():"Never"]})]})})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),F.length>0?(()=>{const st=F.reduce((mt,Yt)=>{const St=Yt.subject||"Unknown Subject";return mt[St]||(mt[St]=[]),mt[St].push(Yt),mt},{});return l.jsx("div",{className:"space-y-6",children:Object.entries(st).map(([mt,Yt])=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 flex flex-col sm:flex-row sm:items-center items-center",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),mt]}),l.jsxs("span",{className:"ml-0 sm:ml-2 text-sm text-gray-500 mt-1 sm:mt-0",children:["(",Yt.length," classes)"]})]}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Yt.map((St,br)=>l.jsxs(et,{variant:z===St.grade&&K===St.class?"primary":"outline",onClick:()=>Jr(St.grade,St.class),className:"px-3 py-1 text-xs font-medium min-w-[60px]",children:[St.grade,"/",St.class]},`${St.grade}-${St.class}-${br}`))})]},mt))})})():l.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),K&&vt(),K&&L&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[z," ",K," - Test Results ",Ae?`(Term ${Le?.terms.find(st=>st.id===Ae)?.term})`:""]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:su,children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),l.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),cn()]}),K&&!L&&l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-200 border-t-blue-500"}),l.jsx("span",{className:"text-gray-600",children:"Loading results"})]})})})]})}),It&&Ie&&l.jsx(yk,{children:l.jsx(zB,{drawing:It,isOpen:Ie,onClose:()=>Je(!1),isTeacherView:!0,onSaveScore:async({resultId:st,score:mt,maxScore:Yt})=>{try{const St=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(Yx.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:St?`Bearer ${St}`:""},body:JSON.stringify({resultId:st,score:mt,maxScore:Yt})})).ok)throw new Error("Failed to save");await he(C,!0)}catch{o("Failed to save drawing score","error")}}})}),l.jsx(yk,{children:l.jsx(mie,{isOpen:fe,onClose:()=>{Ee(!1),lt(null),oe(null)},testResult:Ve,questions:Ke,isLoadingQuestions:Ne})}),qe&&Tt&&l.jsx(yk,{children:l.jsx(gie,{result:qe,isOpen:Tt,onClose:()=>Nt(!1),initialTab:qe.__initialTab||"overview",editingSpeakingScore:kt,tempSpeakingScore:He,isSavingSpeakingScore:$e,onStartSpeakingScoreEdit:Ct,onSaveSpeakingScore:qt,onCancelSpeakingScoreEdit:lr,onTempSpeakingScoreChange:ke})})]})},xxe={getTestPerformance:async(e,t=null)=>{try{await rd.loadAcademicCalendar();const n=rd.getCurrentTerm()?.id;if(!n)throw new Error("No current academic period found");console.log(` Fetching test performance for teacher ${e}, period ${n}, class: ${t||"all"}`);let s=`/.netlify/functions/get-test-performance?teacher_id=${e}&academic_period_id=${n}`;if(t){const[o,c]=t.split("/"),u=o.startsWith("M")?o:`M${o}`;s+=`&grade=${u}&class=${c}`}const a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to fetch performance data");return console.log(` Performance data loaded: ${i.count} tests`),i.data}catch(r){throw console.error(" Error fetching test performance:",r),r}}};function tz(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=tz(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function ls(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=tz(e))&&(n&&(n+=" "),n+=t);return n}var Ok={},Dk={},LO;function yxe(){return LO||(LO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Dk)),Dk}var Ik={},BO;function rz(){return BO||(BO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Ik)),Ik}var Rk={},$O;function nz(){return $O||($O=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Rk)),Rk}var Mk={},UO;function M3(){return UO||(UO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],s=r.length;if(s===0)return n;let a=0,i="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<s;){const u=r[a];o?u==="\\"&&a+1<s?(a++,i+=r[a]):u===o?o="":i+=u:c?u==='"'||u==="'"?o=u:u==="]"?(c=!1,n.push(i),i=""):i+=u:u==="["?(c=!0,i&&(n.push(i),i="")):u==="."?i&&(n.push(i),i=""):i+=u,a++}return i&&n.push(i),n}e.toPath=t})(Mk)),Mk}var zO;function L3(){return zO||(zO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yxe(),r=rz(),n=nz(),s=M3();function a(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?a(o,s.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return i(o,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function i(o,c,u){if(c.length===0)return u;let d=o;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=a})(Ok)),Ok}var Lk,WO;function vxe(){return WO||(WO=1,Lk=L3().get),Lk}var wxe=vxe();const h2=Ol(wxe);var Bk={exports:{}},En={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HO;function _xe(){if(HO)return En;HO=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,f=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,p=e?Symbol.for("react.memo"):60115,x=e?Symbol.for("react.lazy"):60116,v=e?Symbol.for("react.block"):60121,w=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,k=e?Symbol.for("react.scope"):60119;function _(E){if(typeof E=="object"&&E!==null){var P=E.$$typeof;switch(P){case t:switch(E=E.type,E){case c:case u:case n:case a:case s:case f:return E;default:switch(E=E&&E.$$typeof,E){case o:case d:case x:case p:case i:return E;default:return P}}case r:return P}}}function N(E){return _(E)===u}return En.AsyncMode=c,En.ConcurrentMode=u,En.ContextConsumer=o,En.ContextProvider=i,En.Element=t,En.ForwardRef=d,En.Fragment=n,En.Lazy=x,En.Memo=p,En.Portal=r,En.Profiler=a,En.StrictMode=s,En.Suspense=f,En.isAsyncMode=function(E){return N(E)||_(E)===c},En.isConcurrentMode=N,En.isContextConsumer=function(E){return _(E)===o},En.isContextProvider=function(E){return _(E)===i},En.isElement=function(E){return typeof E=="object"&&E!==null&&E.$$typeof===t},En.isForwardRef=function(E){return _(E)===d},En.isFragment=function(E){return _(E)===n},En.isLazy=function(E){return _(E)===x},En.isMemo=function(E){return _(E)===p},En.isPortal=function(E){return _(E)===r},En.isProfiler=function(E){return _(E)===a},En.isStrictMode=function(E){return _(E)===s},En.isSuspense=function(E){return _(E)===f},En.isValidElementType=function(E){return typeof E=="string"||typeof E=="function"||E===n||E===u||E===a||E===s||E===f||E===g||typeof E=="object"&&E!==null&&(E.$$typeof===x||E.$$typeof===p||E.$$typeof===i||E.$$typeof===o||E.$$typeof===d||E.$$typeof===w||E.$$typeof===C||E.$$typeof===k||E.$$typeof===v)},En.typeOf=_,En}var GO;function bxe(){return GO||(GO=1,Bk.exports=_xe()),Bk.exports}bxe();var Sl=e=>e===0?0:e>0?1:-1,jl=e=>typeof e=="number"&&e!=+e,Ih=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,$r=e=>(typeof e=="number"||e instanceof Number)&&!jl(e),Zc=e=>$r(e)||typeof e=="string",Sxe=0,fv=e=>{var t=++Sxe;return"".concat(e||"").concat(t)},jf=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!$r(t)&&typeof t!="string")return n;var a;if(Ih(t)){if(r==null)return n;var i=t.indexOf("%");a=r*parseFloat(t.slice(0,i))/100}else a=+t;return jl(a)&&(a=n),s&&r!=null&&a>r&&(a=r),a},sz=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function Bu(e,t,r){return $r(e)&&$r(t)?e+r*(t-e):t}function az(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):h2(n,t))===r)}var za=e=>e===null||typeof e>"u",B3=e=>za(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),kxe=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function $3(e){if(typeof e!="string")return!1;var t=kxe;return t.includes(e)}var Cxe=["viewBox","children"],VO=["points","pathLength"],$k={svg:Cxe,polygon:VO,polyline:VO},U3=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(S.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(s=>{$3(s)&&(n[s]=(a=>r[s](r,a)))}),n},Txe=(e,t,r)=>n=>(e(t,r,n),null),Exe=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(s=>{var a=e[s];$3(s)&&typeof a=="function"&&(n||(n={}),n[s]=Txe(a,t,r))}),n},Nxe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function iz(e){if(typeof e!="string")return!1;var t=Nxe;return t.includes(e)}function I0(e){var t=Object.entries(e).filter(r=>{var[n]=r;return iz(n)});return Object.fromEntries(t)}var oz=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Axe=(e,t,r,n)=>{var s;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(s=n&&$k?.[n])!==null&&s!==void 0?s:[],i=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&a.includes(t)||iz(t)),c=!!r&&$3(t);return i||o||c},gi=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(S.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(a=>{var i;Axe((i=n)===null||i===void 0?void 0:i[a],a,t,r)&&(s[a]=n[a])}),s},jxe=["children","width","height","viewBox","className","style","title","desc"];function kE(){return kE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kE.apply(null,arguments)}function Pxe(e,t){if(e==null)return{};var r,n,s=Fxe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Fxe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var lz=S.forwardRef((e,t)=>{var{children:r,width:n,height:s,viewBox:a,className:i,style:o,title:c,desc:u}=e,d=Pxe(e,jxe),f=a||{width:n,height:s,x:0,y:0},g=ls("recharts-surface",i);return S.createElement("svg",kE({},gi(d,!0,"svg"),{className:g,width:n,height:s,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),S.createElement("title",null,c),S.createElement("desc",null,u),r)}),Oxe=["children","className"];function CE(){return CE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},CE.apply(null,arguments)}function Dxe(e,t){if(e==null)return{};var r,n,s=Ixe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Ixe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rp=S.forwardRef((e,t)=>{var{children:r,className:n}=e,s=Dxe(e,Oxe),a=ls("recharts-layer",n);return S.createElement("g",CE({className:a},gi(s,!0),{ref:t}),r)}),Rxe=S.createContext(null);function As(e){return function(){return e}}const TE=Math.PI,EE=2*TE,Th=1e-6,Mxe=EE-Th;function cz(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Lxe(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return cz;const r=10**t;return function(n){this._+=n[0];for(let s=1,a=n.length;s<a;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class Bxe{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?cz:Lxe(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,a,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+a},${this._y1=+i}`}arcTo(t,r,n,s,a){if(t=+t,r=+r,n=+n,s=+s,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,o=this._y1,c=n-t,u=s-r,d=i-t,f=o-r,g=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(g>Th)if(!(Math.abs(f*c-u*d)>Th)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let p=n-i,x=s-o,v=c*c+u*u,w=p*p+x*x,C=Math.sqrt(v),k=Math.sqrt(g),_=a*Math.tan((TE-Math.acos((v+g-w)/(2*C*k)))/2),N=_/k,E=_/C;Math.abs(N-1)>Th&&this._append`L${t+N*d},${r+N*f}`,this._append`A${a},${a},0,0,${+(f*p>d*x)},${this._x1=t+E*c},${this._y1=r+E*u}`}}arc(t,r,n,s,a,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(s),c=n*Math.sin(s),u=t+o,d=r+c,f=1^i,g=i?s-a:a-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>Th||Math.abs(this._y1-d)>Th)&&this._append`L${u},${d}`,n&&(g<0&&(g=g%EE+EE),g>Mxe?this._append`A${n},${n},0,1,${f},${t-o},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:g>Th&&this._append`A${n},${n},0,${+(g>=TE)},${f},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function uz(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new Bxe(t)}function z3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function dz(e){this._context=e}dz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function g2(e){return new dz(e)}function fz(e){return e[0]}function hz(e){return e[1]}function gz(e,t){var r=As(!0),n=null,s=g2,a=null,i=uz(o);e=typeof e=="function"?e:e===void 0?fz:As(e),t=typeof t=="function"?t:t===void 0?hz:As(t);function o(c){var u,d=(c=z3(c)).length,f,g=!1,p;for(n==null&&(a=s(p=i())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===g&&((g=!g)?a.lineStart():a.lineEnd()),g&&a.point(+e(f,u,c),+t(f,u,c));if(p)return a=null,p+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:As(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:As(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:As(!!c),o):r},o.curve=function(c){return arguments.length?(s=c,n!=null&&(a=s(n)),o):s},o.context=function(c){return arguments.length?(c==null?n=a=null:a=s(n=c),o):n},o}function Iw(e,t,r){var n=null,s=As(!0),a=null,i=g2,o=null,c=uz(u);e=typeof e=="function"?e:e===void 0?fz:As(+e),t=typeof t=="function"?t:As(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?hz:As(+r);function u(f){var g,p,x,v=(f=z3(f)).length,w,C=!1,k,_=new Array(v),N=new Array(v);for(a==null&&(o=i(k=c())),g=0;g<=v;++g){if(!(g<v&&s(w=f[g],g,f))===C)if(C=!C)p=g,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=g-1;x>=p;--x)o.point(_[x],N[x]);o.lineEnd(),o.areaEnd()}C&&(_[g]=+e(w,g,f),N[g]=+t(w,g,f),o.point(n?+n(w,g,f):_[g],r?+r(w,g,f):N[g]))}if(k)return o=null,k+""||null}function d(){return gz().defined(s).curve(i).context(a)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:As(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:As(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:As(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:As(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:As(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:As(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(s=typeof f=="function"?f:As(!!f),u):s},u.curve=function(f){return arguments.length?(i=f,a!=null&&(o=i(a)),u):i},u.context=function(f){return arguments.length?(f==null?a=o=null:o=i(a=f),u):a},u}class mz{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function $xe(e){return new mz(e,!0)}function Uxe(e){return new mz(e,!1)}function X_(){}function J_(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function pz(e){this._context=e}pz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:J_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:J_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zxe(e){return new pz(e)}function xz(e){this._context=e}xz.prototype={areaStart:X_,areaEnd:X_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:J_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Wxe(e){return new xz(e)}function yz(e){this._context=e}yz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:J_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Hxe(e){return new yz(e)}function vz(e){this._context=e}vz.prototype={areaStart:X_,areaEnd:X_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Gxe(e){return new vz(e)}function KO(e){return e<0?-1:1}function qO(e,t,r){var n=e._x1-e._x0,s=t-e._x1,a=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),o=(a*s+i*n)/(n+s);return(KO(a)+KO(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(o))||0}function YO(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Uk(e,t,r){var n=e._x0,s=e._y0,a=e._x1,i=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,s+o*t,a-o,i-o*r,a,i)}function Q_(e){this._context=e}Q_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Uk(this,this._t0,YO(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Uk(this,YO(this,r=qO(this,e,t)),r);break;default:Uk(this,this._t0,r=qO(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function wz(e){this._context=new _z(e)}(wz.prototype=Object.create(Q_.prototype)).point=function(e,t){Q_.prototype.point.call(this,t,e)};function _z(e){this._context=e}_z.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,a){this._context.bezierCurveTo(t,e,n,r,a,s)}};function Vxe(e){return new Q_(e)}function Kxe(e){return new wz(e)}function bz(e){this._context=e}bz.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=XO(e),s=XO(t),a=0,i=1;i<r;++a,++i)this._context.bezierCurveTo(n[0][a],s[0][a],n[1][a],s[1][a],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function XO(e){var t,r=e.length-1,n,s=new Array(r),a=new Array(r),i=new Array(r);for(s[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,a[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/a[t-1],a[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/a[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/a[t];for(a[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-s[t+1];return[s,a]}function qxe(e){return new bz(e)}function m2(e,t){this._context=e,this._t=t}m2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Yxe(e){return new m2(e,.5)}function Xxe(e){return new m2(e,0)}function Jxe(e){return new m2(e,1)}function Nm(e,t){if((i=e.length)>1)for(var r=1,n,s,a=e[t[0]],i,o=a.length;r<i;++r)for(s=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function NE(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Qxe(e,t){return e[t]}function Zxe(e){const t=[];return t.key=e,t}function eye(){var e=As([]),t=NE,r=Nm,n=Qxe;function s(a){var i=Array.from(e.apply(this,arguments),Zxe),o,c=i.length,u=-1,d;for(const f of a)for(o=0,++u;o<c;++o)(i[o][u]=[0,+n(f,i[o].key,u,a)]).data=f;for(o=0,d=z3(t(i));o<c;++o)i[d[o]].index=o;return r(i,d),i}return s.keys=function(a){return arguments.length?(e=typeof a=="function"?a:As(Array.from(a)),s):e},s.value=function(a){return arguments.length?(n=typeof a=="function"?a:As(+a),s):n},s.order=function(a){return arguments.length?(t=a==null?NE:typeof a=="function"?a:As(Array.from(a)),s):t},s.offset=function(a){return arguments.length?(r=a??Nm,s):r},s}function tye(e,t){if((n=e.length)>0){for(var r,n,s=0,a=e[0].length,i;s<a;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}Nm(e,t)}}function rye(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,a=n.length;r<a;++r){for(var i=0,o=0;i<s;++i)o+=e[i][r][1]||0;n[r][1]+=n[r][0]=-o/2}Nm(e,t)}}function nye(e,t){if(!(!((i=e.length)>0)||!((a=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,a,i;n<a;++n){for(var o=0,c=0,u=0;o<i;++o){for(var d=e[t[o]],f=d[n][1]||0,g=d[n-1][1]||0,p=(f-g)/2,x=0;x<o;++x){var v=e[t[x]],w=v[n][1]||0,C=v[n-1][1]||0;p+=w-C}c+=f,u+=p*f}s[n-1][1]+=s[n-1][0]=r,c&&(r-=u/c)}s[n-1][1]+=s[n-1][0]=r,Nm(e,t)}}var zk={},Wk={},JO;function sye(){return JO||(JO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const s=new Map;for(let a=0;a<r.length;a++){const i=r[a],o=n(i);s.has(o)||s.set(o,i)}return Array.from(s.values())}e.uniqBy=t})(Wk)),Wk}var Hk={},QO;function Sz(){return QO||(QO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Hk)),Hk}var Gk={},Vk={},Kk={},ZO;function aye(){return ZO||(ZO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Kk)),Kk}var eD;function W3(){return eD||(eD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=aye();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Vk)),Vk}var qk={},tD;function iye(){return tD||(tD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(qk)),qk}var rD;function oye(){return rD||(rD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W3(),r=iye();function n(s){return r.isObjectLike(s)&&t.isArrayLike(s)}e.isArrayLikeObject=n})(Gk)),Gk}var Yk={},Xk={},nD;function lye(){return nD||(nD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L3();function r(n){return function(s){return t.get(s,n)}}e.property=r})(Xk)),Xk}var Jk={},Qk={},Zk={},eC={},sD;function kz(){return sD||(sD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(eC)),eC}var tC={},aD;function Cz(){return aD||(aD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(tC)),tC}var rC={},iD;function Tz(){return iD||(iD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(rC)),rC}var oD;function cye(){return oD||(oD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H3(),r=kz(),n=Cz(),s=Tz();function a(f,g,p){return typeof p!="function"?t.isMatch(f,g):i(f,g,function x(v,w,C,k,_,N){const E=p(v,w,C,k,_,N);return E!==void 0?!!E:i(v,w,x,N)},new Map)}function i(f,g,p,x){if(g===f)return!0;switch(typeof g){case"object":return o(f,g,p,x);case"function":return Object.keys(g).length>0?i(f,{...g},p,x):s.eq(f,g);default:return r.isObject(f)?typeof g=="string"?g==="":!0:s.eq(f,g)}}function o(f,g,p,x){if(g==null)return!0;if(Array.isArray(g))return u(f,g,p,x);if(g instanceof Map)return c(f,g,p,x);if(g instanceof Set)return d(f,g,p,x);const v=Object.keys(g);if(f==null)return v.length===0;if(v.length===0)return!0;if(x&&x.has(g))return x.get(g)===f;x&&x.set(g,f);try{for(let w=0;w<v.length;w++){const C=v[w];if(!n.isPrimitive(f)&&!(C in f)||g[C]===void 0&&f[C]!==void 0||g[C]===null&&f[C]!==null||!p(f[C],g[C],C,f,g,x))return!1}return!0}finally{x&&x.delete(g)}}function c(f,g,p,x){if(g.size===0)return!0;if(!(f instanceof Map))return!1;for(const[v,w]of g.entries()){const C=f.get(v);if(p(C,w,v,f,g,x)===!1)return!1}return!0}function u(f,g,p,x){if(g.length===0)return!0;if(!Array.isArray(f))return!1;const v=new Set;for(let w=0;w<g.length;w++){const C=g[w];let k=!1;for(let _=0;_<f.length;_++){if(v.has(_))continue;const N=f[_];let E=!1;if(p(N,C,w,f,g,x)&&(E=!0),E){v.add(_),k=!0;break}}if(!k)return!1}return!0}function d(f,g,p,x){return g.size===0?!0:f instanceof Set?u([...f],[...g],p,x):!1}e.isMatchWith=a,e.isSetMatch=d})(Zk)),Zk}var lD;function H3(){return lD||(lD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cye();function r(n,s){return t.isMatchWith(n,s,()=>{})}e.isMatch=r})(Qk)),Qk}var nC={},sC={},aC={},cD;function uye(){return cD||(cD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(aC)),aC}var iC={},uD;function Ez(){return uD||(uD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(iC)),iC}var oC={},dD;function Nz(){return dD||(dD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",s="[object Boolean]",a="[object Arguments]",i="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",g="[object ArrayBuffer]",p="[object Object]",x="[object Error]",v="[object DataView]",w="[object Uint8Array]",C="[object Uint8ClampedArray]",k="[object Uint16Array]",_="[object Uint32Array]",N="[object BigUint64Array]",E="[object Int8Array]",P="[object Int16Array]",F="[object Int32Array]",A="[object BigInt64Array]",j="[object Float32Array]",I="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=g,e.arrayTag=d,e.bigInt64ArrayTag=A,e.bigUint64ArrayTag=N,e.booleanTag=s,e.dataViewTag=v,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=j,e.float64ArrayTag=I,e.functionTag=f,e.int16ArrayTag=P,e.int32ArrayTag=F,e.int8ArrayTag=E,e.mapTag=c,e.numberTag=n,e.objectTag=p,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=i,e.uint16ArrayTag=k,e.uint32ArrayTag=_,e.uint8ArrayTag=w,e.uint8ClampedArrayTag=C})(oC)),oC}var lC={},fD;function dye(){return fD||(fD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(lC)),lC}var hD;function Az(){return hD||(hD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uye(),r=Ez(),n=Nz(),s=Cz(),a=dye();function i(d,f){return o(d,void 0,d,new Map,f)}function o(d,f,g,p=new Map,x=void 0){const v=x?.(d,f,g,p);if(v!==void 0)return v;if(s.isPrimitive(d))return d;if(p.has(d))return p.get(d);if(Array.isArray(d)){const w=new Array(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return Object.hasOwn(d,"index")&&(w.index=d.index),Object.hasOwn(d,"input")&&(w.input=d.input),w}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const w=new RegExp(d.source,d.flags);return w.lastIndex=d.lastIndex,w}if(d instanceof Map){const w=new Map;p.set(d,w);for(const[C,k]of d)w.set(C,o(k,C,g,p,x));return w}if(d instanceof Set){const w=new Set;p.set(d,w);for(const C of d)w.add(o(C,void 0,g,p,x));return w}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const w=new(Object.getPrototypeOf(d)).constructor(d.length);p.set(d,w);for(let C=0;C<d.length;C++)w[C]=o(d[C],C,g,p,x);return w}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const w=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return p.set(d,w),c(w,d,g,p,x),w}if(typeof File<"u"&&d instanceof File){const w=new File([d],d.name,{type:d.type});return p.set(d,w),c(w,d,g,p,x),w}if(d instanceof Blob){const w=new Blob([d],{type:d.type});return p.set(d,w),c(w,d,g,p,x),w}if(d instanceof Error){const w=new d.constructor;return p.set(d,w),w.message=d.message,w.name=d.name,w.stack=d.stack,w.cause=d.cause,c(w,d,g,p,x),w}if(typeof d=="object"&&u(d)){const w=Object.create(Object.getPrototypeOf(d));return p.set(d,w),c(w,d,g,p,x),w}return d}function c(d,f,g=d,p,x){const v=[...Object.keys(f),...t.getSymbols(f)];for(let w=0;w<v.length;w++){const C=v[w],k=Object.getOwnPropertyDescriptor(d,C);(k==null||k.writable)&&(d[C]=o(f[C],C,g,p,x))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=i,e.cloneDeepWithImpl=o,e.copyProperties=c})(sC)),sC}var gD;function fye(){return gD||(gD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(nC)),nC}var mD;function hye(){return mD||(mD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H3(),r=fye();function n(s){return s=r.cloneDeep(s),a=>t.isMatch(a,s)}e.matches=n})(Jk)),Jk}var cC={},uC={},dC={},pD;function gye(){return pD||(pD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Az(),r=Nz();function n(s,a){return t.cloneDeepWith(s,(i,o,c,u)=>{const d=a?.(i,o,c,u);if(d!==void 0)return d;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new s.constructor(s?.valueOf());return t.copyProperties(f,s),f}case r.argumentsTag:{const f={};return t.copyProperties(f,s),f.length=s.length,f[Symbol.iterator]=s[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(dC)),dC}var xD;function mye(){return xD||(xD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gye();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(uC)),uC}var fC={},hC={},yD;function jz(){return yD||(yD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,s=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<s;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(hC)),hC}var gC={},vD;function pye(){return vD||(vD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ez();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(gC)),gC}var wD;function xye(){return wD||(wD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rz(),r=jz(),n=pye(),s=M3();function a(i,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&i?.[o]==null?c=s.toPath(o):c=[o],c.length===0)return!1;let u=i;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=a})(fC)),fC}var _D;function yye(){return _D||(_D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=H3(),r=nz(),n=mye(),s=L3(),a=xye();function i(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=s.get(u,o);return d===void 0?a.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=i})(cC)),cC}var bD;function vye(){return bD||(bD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Sz(),r=lye(),n=hye(),s=yye();function a(i){if(i==null)return t.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?s.matchesProperty(i[0],i[1]):n.matches(i);case"string":case"symbol":case"number":return r.property(i)}}e.iteratee=a})(Yk)),Yk}var SD;function wye(){return SD||(SD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=sye(),r=Sz(),n=oye(),s=vye();function a(i,o=r.identity){return n.isArrayLikeObject(i)?t.uniqBy(Array.from(i),s.iteratee(o)):[]}e.uniqBy=a})(zk)),zk}var mC,kD;function _ye(){return kD||(kD=1,mC=wye().uniqBy),mC}var bye=_ye();const CD=Ol(bye);function Sye(e,t,r){return t===!0?CD(e,r):typeof t=="function"?CD(e,t):e}var pC={exports:{}},xC={},yC={exports:{}},vC={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TD;function kye(){if(TD)return vC;TD=1;var e=k0();function t(f,g){return f===g&&(f!==0||1/f===1/g)||f!==f&&g!==g}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(f,g){var p=g(),x=n({inst:{value:p,getSnapshot:g}}),v=x[0].inst,w=x[1];return a(function(){v.value=p,v.getSnapshot=g,c(v)&&w({inst:v})},[f,p,g]),s(function(){return c(v)&&w({inst:v}),f(function(){c(v)&&w({inst:v})})},[f]),i(p),p}function c(f){var g=f.getSnapshot;f=f.value;try{var p=g();return!r(f,p)}catch{return!0}}function u(f,g){return g()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return vC.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,vC}var ED;function Cye(){return ED||(ED=1,yC.exports=kye()),yC.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ND;function Tye(){if(ND)return xC;ND=1;var e=k0(),t=Cye();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return xC.useSyncExternalStoreWithSelector=function(u,d,f,g,p){var x=a(null);if(x.current===null){var v={hasValue:!1,value:null};x.current=v}else v=x.current;x=o(function(){function C(P){if(!k){if(k=!0,_=P,P=g(P),p!==void 0&&v.hasValue){var F=v.value;if(p(F,P))return N=F}return N=P}if(F=N,n(_,P))return F;var A=g(P);return p!==void 0&&p(F,A)?(_=P,F):(_=P,N=A)}var k=!1,_,N,E=f===void 0?null:f;return[function(){return C(d())},E===null?void 0:function(){return C(E())}]},[d,f,g,p]);var w=s(u,x[0],x[1]);return i(function(){v.hasValue=!0,v.value=w},[w]),c(w),w},xC}var AD;function Eye(){return AD||(AD=1,pC.exports=Tye()),pC.exports}var Nye=Eye(),G3=S.createContext(null),Aye=e=>e,io=()=>{var e=S.useContext(G3);return e?e.store.dispatch:Aye},i_=()=>{},jye=()=>i_,Pye=(e,t)=>e===t;function Pr(e){var t=S.useContext(G3);return Nye.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:jye,t?t.store.getState:i_,t?t.store.getState:i_,t?e:i_,Pye)}function Fye(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Oye(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Dye(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var jD=e=>Array.isArray(e)?e:[e];function Iye(e){const t=Array.isArray(e[0])?e[0]:e;return Dye(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Rye(e,t){const r=[],{length:n}=e;for(let s=0;s<n;s++)r.push(e[s].apply(null,t));return r}var Mye=class{constructor(e){this.value=e}deref(){return this.value}},Lye=typeof WeakRef<"u"?WeakRef:Mye,Bye=0,PD=1;function Rw(){return{s:Bye,v:void 0,o:null,p:null}}function Pz(e,t={}){let r=Rw();const{resultEqualityCheck:n}=t;let s,a=0;function i(){let o=r;const{length:c}=arguments;for(let f=0,g=c;f<g;f++){const p=arguments[f];if(typeof p=="function"||typeof p=="object"&&p!==null){let x=o.o;x===null&&(o.o=x=new WeakMap);const v=x.get(p);v===void 0?(o=Rw(),x.set(p,o)):o=v}else{let x=o.p;x===null&&(o.p=x=new Map);const v=x.get(p);v===void 0?(o=Rw(),x.set(p,o)):o=v}}const u=o;let d;if(o.s===PD)d=o.v;else if(d=e.apply(null,arguments),a++,n){const f=s?.deref?.()??s;f!=null&&n(f,d)&&(d=f,a!==0&&a--),s=typeof d=="object"&&d!==null||typeof d=="function"?new Lye(d):d}return u.s=PD,u.v=d,d}return i.clearCache=()=>{r=Rw(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function $ye(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...s)=>{let a=0,i=0,o,c={},u=s.pop();typeof u=="object"&&(c=u,u=s.pop()),Fye(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:g=[],argsMemoize:p=Pz,argsMemoizeOptions:x=[]}=d,v=jD(g),w=jD(x),C=Iye(s),k=f(function(){return a++,u.apply(null,arguments)},...v),_=p(function(){i++;const E=Rye(C,arguments);return o=k.apply(null,E),o},...w);return Object.assign(_,{resultFunc:u,memoizedResultFunc:k,dependencies:C,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:f,argsMemoize:p})};return Object.assign(n,{withTypes:()=>n}),n}var bt=$ye(Pz),Uye=Object.assign((e,t=bt)=>{Oye(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,o,c)=>(i[r[c]]=o,i),{}))},{withTypes:()=>Uye}),wC={},_C={},bC={},FD;function zye(){return FD||(FD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,s,a)=>{if(n!==s){const i=t(n),o=t(s);if(i===o&&i===0){if(n<s)return a==="desc"?1:-1;if(n>s)return a==="desc"?-1:1}return a==="desc"?o-i:i-o}return 0};e.compareValues=r})(bC)),bC}var SC={},kC={},OD;function Fz(){return OD||(OD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(kC)),kC}var DD;function Wye(){return DD||(DD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fz(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(a,i){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||i!=null&&Object.hasOwn(i,a)}e.isKey=s})(SC)),SC}var ID;function Hye(){return ID||(ID=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zye(),r=Wye(),n=M3();function s(a,i,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(p=>String(p));const u=(p,x)=>{let v=p;for(let w=0;w<x.length&&v!=null;++w)v=v[x[w]];return v},d=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:u(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?u(x,p):typeof x=="object"?x[p]:x,f=i.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:n.toPath(p)}));return a.map(p=>({original:p,criteria:f.map(x=>d(x,p))})).slice().sort((p,x)=>{for(let v=0;v<f.length;v++){const w=t.compareValues(p.criteria[v],x.criteria[v],o[v]);if(w!==0)return w}return 0}).map(p=>p.original)}e.orderBy=s})(_C)),_C}var CC={},RD;function Gye(){return RD||(RD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const s=[],a=Math.floor(n),i=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<a?i(d,c+1):s.push(d)}};return i(r,0),s}e.flatten=t})(CC)),CC}var TC={},MD;function Oz(){return MD||(MD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jz(),r=W3(),n=kz(),s=Tz();function a(i,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?s.eq(c[o],i):!1}e.isIterateeCall=a})(TC)),TC}var LD;function Vye(){return LD||(LD=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hye(),r=Gye(),n=Oz();function s(a,...i){const o=i.length;return o>1&&n.isIterateeCall(a,i[0],i[1])?i=[]:o>2&&n.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(a,r.flatten(i),["asc"])}e.sortBy=s})(wC)),wC}var EC,BD;function Kye(){return BD||(BD=1,EC=Vye().sortBy),EC}var qye=Kye();const p2=Ol(qye);var Dz=e=>e.legend.settings,Yye=e=>e.legend.size,Xye=e=>e.legend.payload;bt([Xye,Dz],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?p2(n,r):n});var Mw=1;function Jye(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=S.useState({height:0,left:0,top:0,width:0}),n=S.useCallback(s=>{if(s!=null){var a=s.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-t.height)>Mw||Math.abs(i.left-t.left)>Mw||Math.abs(i.top-t.top)>Mw||Math.abs(i.width-t.width)>Mw)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function ni(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Qye=typeof Symbol=="function"&&Symbol.observable||"@@observable",$D=Qye,NC=()=>Math.random().toString(36).substring(7).split("").join("."),Zye={INIT:`@@redux/INIT${NC()}`,REPLACE:`@@redux/REPLACE${NC()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${NC()}`},Z_=Zye;function V3(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function Iz(e,t,r){if(typeof e!="function")throw new Error(ni(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ni(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ni(1));return r(Iz)(e,t)}let n=e,s=t,a=new Map,i=a,o=0,c=!1;function u(){i===a&&(i=new Map,a.forEach((w,C)=>{i.set(C,w)}))}function d(){if(c)throw new Error(ni(3));return s}function f(w){if(typeof w!="function")throw new Error(ni(4));if(c)throw new Error(ni(5));let C=!0;u();const k=o++;return i.set(k,w),function(){if(C){if(c)throw new Error(ni(6));C=!1,u(),i.delete(k),a=null}}}function g(w){if(!V3(w))throw new Error(ni(7));if(typeof w.type>"u")throw new Error(ni(8));if(typeof w.type!="string")throw new Error(ni(17));if(c)throw new Error(ni(9));try{c=!0,s=n(s,w)}finally{c=!1}return(a=i).forEach(k=>{k()}),w}function p(w){if(typeof w!="function")throw new Error(ni(10));n=w,g({type:Z_.REPLACE})}function x(){const w=f;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(ni(11));function k(){const N=C;N.next&&N.next(d())}return k(),{unsubscribe:w(k)}},[$D](){return this}}}return g({type:Z_.INIT}),{dispatch:g,subscribe:f,getState:d,replaceReducer:p,[$D]:x}}function eve(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Z_.INIT})>"u")throw new Error(ni(12));if(typeof r(void 0,{type:Z_.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ni(13))})}function Rz(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const i=t[a];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let s;try{eve(r)}catch(a){s=a}return function(i={},o){if(s)throw s;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],g=r[f],p=i[f],x=g(p,o);if(typeof x>"u")throw o&&o.type,new Error(ni(14));u[f]=x,c=c||x!==p}return c=c||n.length!==Object.keys(i).length,c?u:i}}function eb(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function tve(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(ni(15))};const i={getState:s.getState,dispatch:(c,...u)=>a(c,...u)},o=e.map(c=>c(i));return a=eb(...o)(s.dispatch),{...s,dispatch:a}}}function Mz(e){return V3(e)&&"type"in e&&typeof e.type=="string"}var Lz=Symbol.for("immer-nothing"),UD=Symbol.for("immer-draftable"),Xo=Symbol.for("immer-state");function rc(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Am=Object.getPrototypeOf;function v0(e){return!!e&&!!e[Xo]}function sd(e){return e?Bz(e)||Array.isArray(e)||!!e[UD]||!!e.constructor?.[UD]||Qv(e)||y2(e):!1}var rve=Object.prototype.constructor.toString();function Bz(e){if(!e||typeof e!="object")return!1;const t=Am(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===rve}function tb(e,t){x2(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function x2(e){const t=e[Xo];return t?t.type_:Array.isArray(e)?1:Qv(e)?2:y2(e)?3:0}function AE(e,t){return x2(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function $z(e,t,r){const n=x2(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function nve(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Qv(e){return e instanceof Map}function y2(e){return e instanceof Set}function Eh(e){return e.copy_||e.base_}function jE(e,t){if(Qv(e))return new Map(e);if(y2(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=Bz(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Xo];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const i=s[a],o=n[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(Am(e),n)}else{const n=Am(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function K3(e,t=!1){return v2(e)||v0(e)||!sd(e)||(x2(e)>1&&Object.defineProperties(e,{set:{value:Lw},add:{value:Lw},clear:{value:Lw},delete:{value:Lw}}),Object.freeze(e),t&&Object.values(e).forEach(r=>K3(r,!0))),e}function Lw(){rc(2)}function v2(e){return Object.isFrozen(e)}var sve={};function w0(e){const t=sve[e];return t||rc(0,e),t}var hv;function Uz(){return hv}function ave(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function zD(e,t){t&&(w0("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function PE(e){FE(e),e.drafts_.forEach(ive),e.drafts_=null}function FE(e){e===hv&&(hv=e.parent_)}function WD(e){return hv=ave(hv,e)}function ive(e){const t=e[Xo];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function HD(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Xo].modified_&&(PE(t),rc(4)),sd(e)&&(e=rb(t,e),t.parent_||nb(t,e)),t.patches_&&w0("Patches").generateReplacementPatches_(r[Xo].base_,e,t.patches_,t.inversePatches_)):e=rb(t,r,[]),PE(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==Lz?e:void 0}function rb(e,t,r){if(v2(t))return t;const n=t[Xo];if(!n)return tb(t,(s,a)=>GD(e,n,t,s,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return nb(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let a=s,i=!1;n.type_===3&&(a=new Set(s),s.clear(),i=!0),tb(a,(o,c)=>GD(e,n,s,o,c,r,i)),nb(e,s,!1),r&&e.patches_&&w0("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function GD(e,t,r,n,s,a,i){if(v0(s)){const o=a&&t&&t.type_!==3&&!AE(t.assigned_,n)?a.concat(n):void 0,c=rb(e,s,o);if($z(r,n,c),v0(c))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(sd(s)&&!v2(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;rb(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(Qv(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&nb(e,s)}}function nb(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&K3(t,r)}function ove(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:Uz(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=q3;r&&(s=[n],a=gv);const{revoke:i,proxy:o}=Proxy.revocable(s,a);return n.draft_=o,n.revoke_=i,o}var q3={get(e,t){if(t===Xo)return e;const r=Eh(e);if(!AE(r,t))return lve(e,r,t);const n=r[t];return e.finalized_||!sd(n)?n:n===AC(e.base_,t)?(jC(e),e.copy_[t]=DE(n,e)):n},has(e,t){return t in Eh(e)},ownKeys(e){return Reflect.ownKeys(Eh(e))},set(e,t,r){const n=zz(Eh(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=AC(Eh(e),t),a=s?.[Xo];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(nve(r,s)&&(r!==void 0||AE(e.base_,t)))return!0;jC(e),OE(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return AC(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,jC(e),OE(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Eh(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){rc(11)},getPrototypeOf(e){return Am(e.base_)},setPrototypeOf(){rc(12)}},gv={};tb(q3,(e,t)=>{gv[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});gv.deleteProperty=function(e,t){return gv.set.call(this,e,t,void 0)};gv.set=function(e,t,r){return q3.set.call(this,e[0],t,r,e[0])};function AC(e,t){const r=e[Xo];return(r?Eh(r):e)[t]}function lve(e,t,r){const n=zz(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function zz(e,t){if(!(t in e))return;let r=Am(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Am(r)}}function OE(e){e.modified_||(e.modified_=!0,e.parent_&&OE(e.parent_))}function jC(e){e.copy_||(e.copy_=jE(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var cve=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const i=this;return function(c=a,...u){return i.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&rc(6),n!==void 0&&typeof n!="function"&&rc(7);let s;if(sd(t)){const a=WD(this),i=DE(t,void 0);let o=!0;try{s=r(i),o=!1}finally{o?PE(a):FE(a)}return zD(a,n),HD(s,a)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===Lz&&(s=void 0),this.autoFreeze_&&K3(s,!0),n){const a=[],i=[];w0("Patches").generateReplacementPatches_(t,s,a,i),n(a,i)}return s}else rc(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,c=>t(c,...o));let n,s;return[this.produce(t,r,(i,o)=>{n=i,s=o}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){sd(e)||rc(8),v0(e)&&(e=Xu(e));const t=WD(this),r=DE(e,void 0);return r[Xo].isManual_=!0,FE(t),r}finishDraft(e,t){const r=e&&e[Xo];(!r||!r.isManual_)&&rc(9);const{scope_:n}=r;return zD(n,t),HD(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=w0("Patches").applyPatches_;return v0(e)?n(e,t):this.produce(e,s=>n(s,t))}};function DE(e,t){const r=Qv(e)?w0("MapSet").proxyMap_(e,t):y2(e)?w0("MapSet").proxySet_(e,t):ove(e,t);return(t?t.scope_:Uz()).drafts_.push(r),r}function Xu(e){return v0(e)||rc(10,e),Wz(e)}function Wz(e){if(!sd(e)||v2(e))return e;const t=e[Xo];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=jE(e,t.scope_.immer_.useStrictShallowCopy_)}else r=jE(e,!0);return tb(r,(n,s)=>{$z(r,n,Wz(s))}),t&&(t.finalized_=!1),r}var uve=new cve,Hz=uve.produce;function Gz(e){return({dispatch:r,getState:n})=>s=>a=>typeof a=="function"?a(r,n,e):s(a)}var dve=Gz(),fve=Gz,hve=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?eb:eb.apply(null,arguments)};function Pl(e,t){function r(...n){if(t){let s=t(...n);if(!s)throw new Error(Ko(0));return{type:e,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>Mz(n)&&n.type===e,r}var Vz=class fy extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,fy.prototype)}static get[Symbol.species](){return fy}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new fy(...t[0].concat(this)):new fy(...t.concat(this))}};function VD(e){return sd(e)?Hz(e,()=>{}):e}function Bw(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function gve(e){return typeof e=="boolean"}var mve=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:a=!0}=t??{};let i=new Vz;return r&&(gve(r)?i.push(dve):i.push(fve(r.extraArgument))),i},pve="RTK_autoBatch",KD=e=>t=>{setTimeout(t,e)},xve=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let s=!0,a=!1,i=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:KD(10):e.type==="callback"?e.queueNotification:KD(e.timeout),u=()=>{i=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>s&&d(),g=n.subscribe(f);return o.add(d),()=>{g(),o.delete(d)}},dispatch(d){try{return s=!d?.meta?.[pve],a=!s,a&&(i||(i=!0,c(u))),n.dispatch(d)}finally{s=!0}}})},yve=e=>function(r){const{autoBatch:n=!0}=r??{};let s=new Vz(e);return n&&s.push(xve(typeof n=="object"?n:void 0)),s};function vve(e){const t=mve(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(V3(r))o=Rz(r);else throw new Error(Ko(1));let c;typeof n=="function"?c=n(t):c=t();let u=eb;s&&(u=hve({trace:!1,...typeof s=="object"&&s}));const d=tve(...c),f=yve(d);let g=typeof i=="function"?i(f):f();const p=u(...g);return Iz(o,a,p)}function Kz(e){const t={},r=[];let n;const s={addCase(a,i){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Ko(28));if(o in t)throw new Error(Ko(29));return t[o]=i,s},addAsyncThunk(a,i){return i.pending&&(t[a.pending.type]=i.pending),i.rejected&&(t[a.rejected.type]=i.rejected),i.fulfilled&&(t[a.fulfilled.type]=i.fulfilled),i.settled&&r.push({matcher:a.settled,reducer:i.settled}),s},addMatcher(a,i){return r.push({matcher:a,reducer:i}),s},addDefaultCase(a){return n=a,s}};return e(s),[t,r,n]}function wve(e){return typeof e=="function"}function _ve(e,t){let[r,n,s]=Kz(t),a;if(wve(e))a=()=>VD(e());else{const o=VD(e);a=()=>o}function i(o=a(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,f)=>{if(f)if(v0(d)){const p=f(d,c);return p===void 0?d:p}else{if(sd(d))return Hz(d,g=>f(g,c));{const g=f(d,c);if(g===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return g}}return d},o)}return i.getInitialState=a,i}var bve="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",Sve=(e=21)=>{let t="",r=e;for(;r--;)t+=bve[Math.random()*64|0];return t},kve=Symbol.for("rtk-slice-createasyncthunk");function Cve(e,t){return`${e}/${t}`}function Tve({creators:e}={}){const t=e?.asyncThunk?.[kve];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(Ko(11));const i=(typeof n.reducers=="function"?n.reducers(Nve()):n.reducers)||{},o=Object.keys(i),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(_,N){const E=typeof _=="string"?_:_.type;if(!E)throw new Error(Ko(12));if(E in c.sliceCaseReducersByType)throw new Error(Ko(13));return c.sliceCaseReducersByType[E]=N,u},addMatcher(_,N){return c.sliceMatchers.push({matcher:_,reducer:N}),u},exposeAction(_,N){return c.actionCreators[_]=N,u},exposeCaseReducer(_,N){return c.sliceCaseReducersByName[_]=N,u}};o.forEach(_=>{const N=i[_],E={reducerName:_,type:Cve(s,_),createNotation:typeof n.reducers=="function"};jve(N)?Fve(E,N,u,t):Ave(E,N,u)});function d(){const[_={},N=[],E=void 0]=typeof n.extraReducers=="function"?Kz(n.extraReducers):[n.extraReducers],P={..._,...c.sliceCaseReducersByType};return _ve(n.initialState,F=>{for(let A in P)F.addCase(A,P[A]);for(let A of c.sliceMatchers)F.addMatcher(A.matcher,A.reducer);for(let A of N)F.addMatcher(A.matcher,A.reducer);E&&F.addDefaultCase(E)})}const f=_=>_,g=new Map,p=new WeakMap;let x;function v(_,N){return x||(x=d()),x(_,N)}function w(){return x||(x=d()),x.getInitialState()}function C(_,N=!1){function E(F){let A=F[_];return typeof A>"u"&&N&&(A=Bw(p,E,w)),A}function P(F=f){const A=Bw(g,N,()=>new WeakMap);return Bw(A,F,()=>{const j={};for(const[I,L]of Object.entries(n.selectors??{}))j[I]=Eve(L,F,()=>Bw(p,F,w),N);return j})}return{reducerPath:_,getSelectors:P,get selectors(){return P(E)},selectSlice:E}}const k={name:s,reducer:v,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:w,...C(a),injectInto(_,{reducerPath:N,...E}={}){const P=N??a;return _.inject({reducerPath:P,reducer:v},E),{...k,...C(P,!0)}}};return k}}function Eve(e,t,r,n){function s(a,...i){let o=t(a);return typeof o>"u"&&n&&(o=r()),e(o,...i)}return s.unwrapped=e,s}var Qo=Tve();function Nve(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function Ave({type:e,reducerName:t,createNotation:r},n,s){let a,i;if("reducer"in n){if(r&&!Pve(n))throw new Error(Ko(17));a=n.reducer,i=n.prepare}else a=n;s.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,i?Pl(e,i):Pl(e))}function jve(e){return e._reducerDefinitionType==="asyncThunk"}function Pve(e){return e._reducerDefinitionType==="reducerWithPrepare"}function Fve({type:e,reducerName:t},r,n,s){if(!s)throw new Error(Ko(18));const{payloadCreator:a,fulfilled:i,pending:o,rejected:c,settled:u,options:d}=r,f=s(e,a,d);n.exposeAction(t,f),i&&n.addCase(f.fulfilled,i),o&&n.addCase(f.pending,o),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:i||$w,pending:o||$w,rejected:c||$w,settled:u||$w})}function $w(){}var Ove="task",qz="listener",Yz="completed",Y3="cancelled",Dve=`task-${Y3}`,Ive=`task-${Yz}`,IE=`${qz}-${Y3}`,Rve=`${qz}-${Yz}`,w2=class{constructor(e){this.code=e,this.message=`${Ove} ${Y3} (reason: ${e})`}name="TaskAbortError";message},X3=(e,t)=>{if(typeof e!="function")throw new TypeError(Ko(32))},sb=()=>{},Xz=(e,t=sb)=>(e.catch(t),e),Jz=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Yh=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Xh=e=>{if(e.aborted){const{reason:t}=e;throw new w2(t)}};function Qz(e,t){let r=sb;return new Promise((n,s)=>{const a=()=>s(new w2(e.reason));if(e.aborted){a();return}r=Jz(e,a),t.finally(()=>r()).then(n,s)}).finally(()=>{r=sb})}var Mve=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof w2?"cancelled":"rejected",error:r}}finally{t?.()}},ab=e=>t=>Xz(Qz(e,t).then(r=>(Xh(e),r))),Zz=e=>{const t=ab(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:gm}=Object,qD={},_2="listenerMiddleware",Lve=(e,t)=>{const r=n=>Jz(e,()=>Yh(n,e.reason));return(n,s)=>{X3(n);const a=new AbortController;r(a);const i=Mve(async()=>{Xh(e),Xh(a.signal);const o=await n({pause:ab(a.signal),delay:Zz(a.signal),signal:a.signal});return Xh(a.signal),o},()=>Yh(a,Ive));return s?.autoJoin&&t.push(i.catch(sb)),{result:ab(e)(i),cancel(){Yh(a,Dve)}}}},Bve=(e,t)=>{const r=async(n,s)=>{Xh(t);let a=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,g)=>{g.unsubscribe(),c([f,g.getState(),g.getOriginalState()])}});a=()=>{d(),u()}})];s!=null&&o.push(new Promise(c=>setTimeout(c,s,null)));try{const c=await Qz(t,Promise.race(o));return Xh(t),c}finally{a()}};return(n,s)=>Xz(r(n,s))},eW=e=>{let{type:t,actionCreator:r,matcher:n,predicate:s,effect:a}=e;if(t)s=Pl(t).match;else if(r)t=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(Ko(21));return X3(a),{predicate:s,type:t,effect:a}},tW=gm(e=>{const{type:t,predicate:r,effect:n}=eW(e);return{id:Sve(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ko(22))}}},{withTypes:()=>tW}),YD=(e,t)=>{const{type:r,effect:n,predicate:s}=eW(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===s)&&a.effect===n)},RE=e=>{e.pending.forEach(t=>{Yh(t,IE)})},$ve=e=>()=>{e.forEach(RE),e.clear()},XD=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},rW=gm(Pl(`${_2}/add`),{withTypes:()=>rW}),Uve=Pl(`${_2}/removeAll`),nW=gm(Pl(`${_2}/remove`),{withTypes:()=>nW}),zve=(...e)=>{console.error(`${_2}/error`,...e)},Zv=(e={})=>{const t=new Map,{extra:r,onError:n=zve}=e;X3(n);const s=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),f=>{d.unsubscribe(),f?.cancelActive&&RE(d)}),a=d=>{const f=YD(t,d)??tW(d);return s(f)};gm(a,{withTypes:()=>a});const i=d=>{const f=YD(t,d);return f&&(f.unsubscribe(),d.cancelActive&&RE(f)),!!f};gm(i,{withTypes:()=>i});const o=async(d,f,g,p)=>{const x=new AbortController,v=Bve(a,x.signal),w=[];try{d.pending.add(x),await Promise.resolve(d.effect(f,gm({},g,{getOriginalState:p,condition:(C,k)=>v(C,k).then(Boolean),take:v,delay:Zz(x.signal),pause:ab(x.signal),extra:r,signal:x.signal,fork:Lve(x.signal,w),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((C,k,_)=>{C!==x&&(Yh(C,IE),_.delete(C))})},cancel:()=>{Yh(x,IE),d.pending.delete(x)},throwIfCancelled:()=>{Xh(x.signal)}})))}catch(C){C instanceof w2||XD(n,C,{raisedBy:"effect"})}finally{await Promise.all(w),Yh(x,Rve),d.pending.delete(x)}},c=$ve(t);return{middleware:d=>f=>g=>{if(!Mz(g))return f(g);if(rW.match(g))return a(g.payload);if(Uve.match(g)){c();return}if(nW.match(g))return i(g.payload);let p=d.getState();const x=()=>{if(p===qD)throw new Error(Ko(23));return p};let v;try{if(v=f(g),t.size>0){const w=d.getState(),C=Array.from(t.values());for(const k of C){let _=!1;try{_=k.predicate(g,w,p)}catch(N){_=!1,XD(n,N,{raisedBy:"predicate"})}_&&o(k,g,d,x)}}}finally{p=qD}return v},startListening:a,stopListening:i,clearListeners:c}};function Ko(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Wve={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},sW=Qo({name:"chartLayout",initialState:Wve,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,s,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(s=t.payload.bottom)!==null&&s!==void 0?s:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:Hve,setLayout:Gve,setChartSize:Vve,setScale:Kve}=sW.actions,qve=sW.reducer;function JD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function QD(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JD(Object(r),!0).forEach(function(n){Yve(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Yve(e,t,r){return(t=Xve(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Xve(e){var t=Jve(e,"string");return typeof t=="symbol"?t:t+""}function Jve(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ib=Math.PI/180,Qve=e=>e*180/Math.PI,di=(e,t,r,n)=>({x:e+Math.cos(-ib*n)*r,y:t+Math.sin(-ib*n)*r}),Zve=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},e1e=(e,t)=>{var{x:r,y:n}=e,{x:s,y:a}=t;return Math.sqrt((r-s)**2+(n-a)**2)},t1e=(e,t)=>{var{x:r,y:n}=e,{cx:s,cy:a}=t,i=e1e({x:r,y:n},{x:s,y:a});if(i<=0)return{radius:i,angle:0};var o=(r-s)/i,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:i,angle:Qve(c),angleInRadian:c}},r1e=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),s=Math.floor(r/360),a=Math.min(n,s);return{startAngle:t-a*360,endAngle:r-a*360}},n1e=(e,t)=>{var{startAngle:r,endAngle:n}=t,s=Math.floor(r/360),a=Math.floor(n/360),i=Math.min(s,a);return e+i*360},s1e=(e,t)=>{var{x:r,y:n}=e,{radius:s,angle:a}=t1e({x:r,y:n},t),{innerRadius:i,outerRadius:o}=t;if(s<i||s>o||s===0)return null;var{startAngle:c,endAngle:u}=r1e(t),d=a,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?QD(QD({},t),{},{radius:s,angle:n1e(d,t)}):null};function aW(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function ZD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function wl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZD(Object(r),!0).forEach(function(n){a1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function a1e(e,t,r){return(t=i1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i1e(e){var t=o1e(e,"string");return typeof t=="symbol"?t:t+""}function o1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(e,t,r){return za(e)||za(t)?r:Zc(t)?h2(e,t,r):typeof t=="function"?t(e):r}var l1e=(e,t,r,n,s)=>{var a,i=-1,o=(a=t?.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,f=c>=o-1?r[0].coordinate:r[c+1].coordinate,g=void 0;if(Sl(d-u)!==Sl(f-d)){var p=[];if(Sl(f-d)===Sl(s[1]-s[0])){g=f;var x=d+s[1]-s[0];p[0]=Math.min(x,(x+u)/2),p[1]=Math.max(x,(x+u)/2)}else{g=u;var v=f+s[1]-s[0];p[0]=Math.min(d,(v+d)/2),p[1]=Math.max(d,(v+d)/2)}var w=[Math.min(d,(g+d)/2),Math.max(d,(g+d)/2)];if(e>w[0]&&e<=w[1]||e>=p[0]&&e<=p[1]){({index:i}=r[c]);break}}else{var C=Math.min(u,f),k=Math.max(u,f);if(e>(C+d)/2&&e<=(k+d)/2){({index:i}=r[c]);break}}}else if(t){for(var _=0;_<o;_++)if(_===0&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_>0&&_<o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_===o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2){({index:i}=t[_]);break}}return i},c1e=(e,t,r)=>{if(t&&r){var{width:n,height:s}=r,{align:a,verticalAlign:i,layout:o}=t;if((o==="vertical"||o==="horizontal"&&i==="middle")&&a!=="center"&&$r(e[a]))return wl(wl({},e),{},{[a]:e[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&i!=="middle"&&$r(e[i]))return wl(wl({},e),{},{[i]:e[i]+(s||0)})}return e},Uf=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",iW=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var s,a,i=e.map(o=>(o.coordinate===t&&(s=!0),o.coordinate===r&&(a=!0),o.coordinate));return s||i.push(t),a||i.push(r),i},oW=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:s,range:a,scale:i,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:g,axisType:p}=e;if(!i)return null;var x=o==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,v=s==="category"&&i.bandwidth?i.bandwidth()/x:0;if(v=p==="angleAxis"&&a&&a.length>=2?Sl(a[0]-a[1])*2*v:v,f||g){var w=(f||g||[]).map((C,k)=>{var _=n?n.indexOf(C):C;return{coordinate:i(_)+v,value:C,offset:v,index:k}});return w.filter(C=>!jl(C.coordinate))}return c&&u?u.map((C,k)=>({coordinate:i(C)+v,value:C,index:k,offset:v})):i.ticks&&d!=null?i.ticks(d).map((C,k)=>({coordinate:i(C)+v,value:C,offset:v,index:k})):i.domain().map((C,k)=>({coordinate:i(C)+v,value:n?n[C]:C,index:k,offset:v}))},eI=1e-4,u1e=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),s=Math.min(n[0],n[1])-eI,a=Math.max(n[0],n[1])+eI,i=e(t[0]),o=e(t[r-1]);(i<s||i>a||o<s||o>a)&&e.domain([t[0],t[r-1]])}},d1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0,i=0;i<t;++i){var o=jl(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1]):(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1])}},f1e=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0;a<t;++a){var i=jl(e[a][r][1])?e[a][r][0]:e[a][r][1];i>=0?(e[a][r][0]=s,e[a][r][1]=s+i,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},h1e={sign:d1e,expand:tye,none:Nm,silhouette:rye,wiggle:nye,positive:f1e},g1e=(e,t,r)=>{var n=h1e[r],s=eye().keys(t).value((a,i)=>+so(a,i,0)).order(NE).offset(n);return s(e)};function tI(e){var{axis:t,ticks:r,bandSize:n,entry:s,index:a,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!za(s[t.dataKey])){var o=az(r,"value",s[t.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=so(s,za(i)?t.dataKey:i);return za(c)?null:t.scale(c)}var m1e=e=>{var t=e.flat(2).filter($r);return[Math.min(...t),Math.max(...t)]},p1e=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],x1e=(e,t,r)=>{if(e!=null)return p1e(Object.keys(e).reduce((n,s)=>{var a=e[s],{stackedData:i}=a,o=i.reduce((c,u)=>{var d=aW(u,t,r),f=m1e(d);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},rI=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,nI=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,ME=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var s=p2(t,d=>d.coordinate),a=1/0,i=1,o=s.length;i<o;i++){var c=s[i],u=s[i-1];a=Math.min((c.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function sI(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:s,name:a}=e;return wl(wl({},t),{},{dataKey:r,payload:n,value:s,name:a})}function lW(e,t){if(e)return String(e);if(typeof t=="string")return t}function y1e(e,t,r,n,s){if(r==="horizontal"||r==="vertical"){var a=e>=s.left&&e<=s.left+s.width&&t>=s.top&&t<=s.top+s.height;return a?{x:e,y:t}:null}return n?s1e({x:e,y:t},n):null}var v1e=(e,t,r,n)=>{var s=t.find(u=>u&&u.index===r);if(s){if(e==="horizontal")return{x:s.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,{radius:i}=n;return wl(wl(wl({},n),di(n.cx,n.cy,i,a)),{},{angle:a,radius:i})}var o=s.coordinate,{angle:c}=n;return wl(wl(wl({},n),di(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},w1e=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,hd=e=>e.layout.width,gd=e=>e.layout.height,_1e=e=>e.layout.scale,cW=e=>e.layout.margin,b2=bt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),S2=bt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),b1e="data-recharts-item-index",S1e="data-recharts-item-data-key",e1=60;function aI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Uw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aI(Object(r),!0).forEach(function(n){k1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k1e(e,t,r){return(t=C1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C1e(e){var t=T1e(e,"string");return typeof t=="symbol"?t:t+""}function T1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var E1e=e=>e.brush.height;function N1e(e){var t=S2(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:e1;return r+s}return r},0)}function A1e(e){var t=S2(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:e1;return r+s}return r},0)}function j1e(e){var t=b2(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function P1e(e){var t=b2(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var mi=bt([hd,gd,cW,E1e,N1e,A1e,j1e,P1e,Dz,Yye],(e,t,r,n,s,a,i,o,c,u)=>{var d={left:(r.left||0)+s,right:(r.right||0)+a},f={top:(r.top||0)+i,bottom:(r.bottom||0)+o},g=Uw(Uw({},f),d),p=g.bottom;g.bottom+=n,g=c1e(g,c,u);var x=e-g.left-g.right,v=t-g.top-g.bottom;return Uw(Uw({brushBottom:p},g),{},{width:Math.max(x,0),height:Math.max(v,0)})}),F1e=bt(mi,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),uW=bt(hd,gd,(e,t)=>({x:0,y:0,width:e,height:t})),O1e=S.createContext(null),Il=()=>S.useContext(O1e)!=null,k2=e=>e.brush,C2=bt([k2,mi,cW],(e,t,r)=>({height:e.height,x:$r(e.x)?e.x:t.left,y:$r(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:$r(e.width)?e.width:t.width})),J3=()=>{var e,t=Il(),r=Pr(F1e),n=Pr(C2),s=(e=Pr(k2))===null||e===void 0?void 0:e.padding;return!t||!n||!s?r:{width:n.width-s.left-s.right,height:n.height-s.top-s.bottom,x:s.left,y:s.top}},D1e={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},dW=()=>{var e;return(e=Pr(mi))!==null&&e!==void 0?e:D1e},fW=()=>Pr(hd),hW=()=>Pr(gd),us=e=>e.layout.layoutType,Q3=()=>Pr(us),I1e={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},gW=Qo({name:"legend",initialState:I1e,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Xu(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:$3e,setLegendSettings:U3e,addLegendPayload:R1e,removeLegendPayload:M1e}=gW.actions,L1e=gW.reducer;function LE(){return LE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},LE.apply(null,arguments)}function iI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function PC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?iI(Object(r),!0).forEach(function(n){B1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function B1e(e,t,r){return(t=$1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $1e(e){var t=U1e(e,"string");return typeof t=="symbol"?t:t+""}function U1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function z1e(e){return Array.isArray(e)&&Zc(e[0])&&Zc(e[1])?e.join(" ~ "):e}var W1e=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:s={},payload:a,formatter:i,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:g=!1}=e,p=()=>{if(a&&a.length){var E={padding:0,margin:0},P=(o?p2(a,o):a).map((F,A)=>{if(F.type==="none")return null;var j=F.formatter||i||z1e,{value:I,name:L}=F,Y=I,Z=L;if(j){var ae=j(I,L,F,A,a);if(Array.isArray(ae))[Y,Z]=ae;else if(ae!=null)Y=ae;else return null}var ee=PC({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},n);return S.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(A),style:ee},Zc(Z)?S.createElement("span",{className:"recharts-tooltip-item-name"},Z):null,Zc(Z)?S.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,S.createElement("span",{className:"recharts-tooltip-item-value"},Y),S.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return S.createElement("ul",{className:"recharts-tooltip-item-list",style:E},P)}return null},x=PC({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=PC({margin:0},s),w=!za(d),C=w?d:"",k=ls("recharts-default-tooltip",c),_=ls("recharts-tooltip-label",u);w&&f&&a!==void 0&&a!==null&&(C=f(d,a));var N=g?{role:"status","aria-live":"assertive"}:{};return S.createElement("div",LE({className:k,style:x},N),S.createElement("p",{className:_,style:v},S.isValidElement(C)?C:"".concat(C)),p())},Qx="recharts-tooltip-wrapper",H1e={visibility:"hidden"};function G1e(e){var{coordinate:t,translateX:r,translateY:n}=e;return ls(Qx,{["".concat(Qx,"-right")]:$r(r)&&t&&$r(t.x)&&r>=t.x,["".concat(Qx,"-left")]:$r(r)&&t&&$r(t.x)&&r<t.x,["".concat(Qx,"-bottom")]:$r(n)&&t&&$r(t.y)&&n>=t.y,["".concat(Qx,"-top")]:$r(n)&&t&&$r(t.y)&&n<t.y})}function oI(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(a&&$r(a[n]))return a[n];var d=r[n]-o-(s>0?s:0),f=r[n]+s;if(t[n])return i[n]?d:f;var g=c[n];if(g==null)return 0;if(i[n]){var p=d,x=g;return p<x?Math.max(f,g):Math.max(d,g)}if(u==null)return 0;var v=f+o,w=g+u;return v>w?Math.max(d,g):Math.max(f,g)}function V1e(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function K1e(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:s,reverseDirection:a,tooltipBox:i,useTranslate3d:o,viewBox:c}=e,u,d,f;return i.height>0&&i.width>0&&r?(d=oI({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=oI({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=V1e({translateX:d,translateY:f,useTranslate3d:o})):u=H1e,{cssProperties:u,cssClasses:G1e({translateX:d,translateY:f,coordinate:r})}}function lI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function zw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lI(Object(r),!0).forEach(function(n){BE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BE(e,t,r){return(t=q1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function q1e(e){var t=Y1e(e,"string");return typeof t=="symbol"?t:t+""}function Y1e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class X1e extends S.PureComponent{constructor(){super(...arguments),BE(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),BE(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,s,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(s=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:s,children:a,coordinate:i,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:g,viewBox:p,wrapperStyle:x,lastBoundingBox:v,innerRef:w,hasPortalFromProps:C}=this.props,{cssClasses:k,cssProperties:_}=K1e({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:g,viewBox:p}),N=C?{}:zw(zw({transition:c&&t?"transform ".concat(n,"ms ").concat(s):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),E=zw(zw({},N),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return S.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:E,ref:w},a)}}var J1e=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),np={devToolsEnabled:!1,isSsr:J1e()},mW=()=>Pr(e=>e.rootProps.accessibilityLayer);function fc(e){return Number.isFinite(e)}function ob(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function $E(){return $E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},$E.apply(null,arguments)}function cI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function uI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cI(Object(r),!0).forEach(function(n){Q1e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Q1e(e,t,r){return(t=Z1e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z1e(e){var t=ewe(e,"string");return typeof t=="symbol"?t:t+""}function ewe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dI={curveBasisClosed:Wxe,curveBasisOpen:Hxe,curveBasis:zxe,curveBumpX:$xe,curveBumpY:Uxe,curveLinearClosed:Gxe,curveLinear:g2,curveMonotoneX:Vxe,curveMonotoneY:Kxe,curveNatural:qxe,curveStep:Yxe,curveStepAfter:Jxe,curveStepBefore:Xxe},Ww=e=>fc(e.x)&&fc(e.y),Zx=e=>e.x,ey=e=>e.y,twe=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(B3(e));return(r==="curveMonotone"||r==="curveBump")&&t?dI["".concat(r).concat(t==="vertical"?"Y":"X")]:dI[r]||g2},rwe=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:s,connectNulls:a=!1}=e,i=twe(t,s),o=a?r.filter(Ww):r,c;if(Array.isArray(n)){var u=a?n.filter(f=>Ww(f)):n,d=o.map((f,g)=>uI(uI({},f),{},{base:u[g]}));return s==="vertical"?c=Iw().y(ey).x1(Zx).x0(f=>f.base.x):c=Iw().x(Zx).y1(ey).y0(f=>f.base.y),c.defined(Ww).curve(i),c(d)}return s==="vertical"&&$r(n)?c=Iw().y(ey).x1(Zx).x0(n):$r(n)?c=Iw().x(Zx).y1(ey).y0(n):c=gz().x(Zx).y(ey),c.defined(Ww).curve(i),c(o)},pW=e=>{var{className:t,points:r,path:n,pathRef:s}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?rwe(e):n;return S.createElement("path",$E({},I0(e),U3(e),{className:ls("recharts-curve",t),d:a===null?void 0:a,ref:s}))},nwe=["x","y","top","left","width","height","className"];function UE(){return UE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},UE.apply(null,arguments)}function fI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function swe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fI(Object(r),!0).forEach(function(n){awe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function awe(e,t,r){return(t=iwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iwe(e){var t=owe(e,"string");return typeof t=="symbol"?t:t+""}function owe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lwe(e,t){if(e==null)return{};var r,n,s=cwe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function cwe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var uwe=(e,t,r,n,s,a)=>"M".concat(e,",").concat(s,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),dwe=e=>{var{x:t=0,y:r=0,top:n=0,left:s=0,width:a=0,height:i=0,className:o}=e,c=lwe(e,nwe),u=swe({x:t,y:r,top:n,left:s,width:a,height:i},c);return!$r(t)||!$r(r)||!$r(a)||!$r(i)||!$r(n)||!$r(s)?null:S.createElement("path",UE({},gi(u,!0),{className:ls("recharts-cross",o),d:uwe(t,r,a,i,n,s)}))};function fwe(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function hI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function hwe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hI(Object(r),!0).forEach(function(n){gwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gwe(e,t,r){return(t=mwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mwe(e){var t=pwe(e,"string");return typeof t=="symbol"?t:t+""}function pwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Rl(e,t){var r=hwe({},e),n=t,s=Object.keys(t),a=s.reduce((i,o)=>(i[o]===void 0&&n[o]!==void 0&&(i[o]=n[o]),i),r);return a}function xwe(){}function gI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function mI(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gI(Object(r),!0).forEach(function(n){ywe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ywe(e,t,r){return(t=vwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vwe(e){var t=wwe(e,"string");return typeof t=="symbol"?t:t+""}function wwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var _we=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),bwe=(e,t,r)=>e.map(n=>"".concat(_we(n)," ").concat(t,"ms ").concat(r)).join(","),Swe=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(s=>n.includes(s))),mv=(e,t)=>Object.keys(t).reduce((r,n)=>mI(mI({},r),{},{[n]:e(n,t[n])}),{});function pI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ii(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pI(Object(r),!0).forEach(function(n){kwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function kwe(e,t,r){return(t=Cwe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Cwe(e){var t=Twe(e,"string");return typeof t=="symbol"?t:t+""}function Twe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lb=(e,t,r)=>e+(t-e)*r,zE=e=>{var{from:t,to:r}=e;return t!==r},xW=(e,t,r)=>{var n=mv((s,a)=>{if(zE(a)){var[i,o]=e(a.from,a.to,a.velocity);return ii(ii({},a),{},{from:i,velocity:o})}return a},t);return r<1?mv((s,a)=>zE(a)?ii(ii({},a),{},{velocity:lb(a.velocity,n[s].velocity,r),from:lb(a.from,n[s].from,r)}):a,t):xW(e,n,r-1)};function Ewe(e,t,r,n,s,a){var i,o=n.reduce((g,p)=>ii(ii({},g),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>mv((g,p)=>p.from,o),u=()=>!Object.values(o).filter(zE).length,d=null,f=g=>{i||(i=g);var p=g-i,x=p/r.dt;o=xW(r,o,x),s(ii(ii(ii({},e),t),c())),i=g,u()||(d=a.setTimeout(f))};return()=>(d=a.setTimeout(f),()=>{d()})}function Nwe(e,t,r,n,s,a,i){var o=null,c=s.reduce((f,g)=>ii(ii({},f),{},{[g]:[e[g],t[g]]}),{}),u,d=f=>{u||(u=f);var g=(f-u)/n,p=mv((v,w)=>lb(...w,r(g)),c);if(a(ii(ii(ii({},e),t),p)),g<1)o=i.setTimeout(d);else{var x=mv((v,w)=>lb(...w,r(1)),c);a(ii(ii(ii({},e),t),x))}};return()=>(o=i.setTimeout(d),()=>{o()})}const Awe=(e,t,r,n,s,a)=>{var i=Swe(e,t);return r.isStepper===!0?Ewe(e,t,r,i,s,a):Nwe(e,t,r,n,i,s,a)};var cb=1e-4,yW=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],vW=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),xI=(e,t)=>r=>{var n=yW(e,t);return vW(n,r)},jwe=(e,t)=>r=>{var n=yW(e,t),s=[...n.map((a,i)=>a*i).slice(1),0];return vW(s,r)},yI=function(){for(var t,r,n,s,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(i.length===1)switch(i[0]){case"linear":[t,n,r,s]=[0,0,1,1];break;case"ease":[t,n,r,s]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,s]=[.42,0,1,1];break;case"ease-out":[t,n,r,s]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,s]=[0,0,.58,1];break;default:{var c=i[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,s]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else i.length===4&&([t,n,r,s]=i);var u=xI(t,r),d=xI(n,s),f=jwe(t,r),g=x=>x>1?1:x<0?0:x,p=x=>{for(var v=x>1?1:x,w=v,C=0;C<8;++C){var k=u(w)-v,_=f(w);if(Math.abs(k-v)<cb||_<cb)return d(w);w=g(w-k/_)}return d(w)};return p.isStepper=!1,p},Pwe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:s=17}=t,a=(i,o,c)=>{var u=-(i-o)*r,d=c*n,f=c+(u-d)*s/1e3,g=c*s/1e3+i;return Math.abs(g-o)<cb&&Math.abs(f)<cb?[o,0]:[g,f]};return a.isStepper=!0,a.dt=s,a},Fwe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return yI(e);case"spring":return Pwe();default:if(e.split("(")[0]==="cubic-bezier")return yI(e)}return typeof e=="function"?e:null};function Owe(e){var t,r=()=>null,n=!1,s=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[c,...u]=o;if(typeof c=="number"){s=e.setTimeout(a.bind(null,u),c);return}a(c),s=e.setTimeout(a.bind(null,u));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,s&&(s(),s=null),a(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}class Dwe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),s=null,a=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(a))};return s=requestAnimationFrame(a),()=>{cancelAnimationFrame(s)}}}function Iwe(){return Owe(new Dwe)}var Rwe=S.createContext(Iwe);function Mwe(e,t){var r=S.useContext(Rwe);return S.useMemo(()=>t??r(e),[e,t,r])}var Lwe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},vI={t:0},FC={t:1};function wW(e){var t=Rl(e,Lwe),{isActive:r,canBegin:n,duration:s,easing:a,begin:i,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=Mwe(t.animationId,t.animationManager),[f,g]=S.useState(r?vI:FC),p=S.useRef(null);return S.useEffect(()=>{r||g(FC)},[r]),S.useEffect(()=>{if(!r||!n)return xwe;var x=Awe(vI,FC,Fwe(a),s,g,d.getTimeoutController()),v=()=>{p.current=x()};return d.start([c,i,v,s,o]),()=>{d.stop(),p.current&&p.current(),o()}},[r,n,s,a,i,c,o,d]),u(f.t)}function _W(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=S.useRef(fv(t)),n=S.useRef(e);return n.current!==e&&(r.current=fv(t),n.current=e),r.current}function wI(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _I(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wI(Object(r),!0).forEach(function(n){Bwe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wI(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bwe(e,t,r){return(t=$we(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $we(e){var t=Uwe(e,"string");return typeof t=="symbol"?t:t+""}function Uwe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ub(){return ub=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ub.apply(null,arguments)}var bI=(e,t,r,n,s)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(a>0&&s instanceof Array){for(var d=[0,0,0,0],f=0,g=4;f<g;f++)d[f]=s[f]>a?a:s[f];u="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+i*d[1])),u+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-i*d[3])),u+="Z"}else if(a>0&&s===+s&&s>0){var p=Math.min(a,s);u="M ".concat(e,",").concat(t+i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+o*p,",").concat(t,`
            L `).concat(e+r-o*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r,",").concat(t+i*p,`
            L `).concat(e+r,",").concat(t+n-i*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r-o*p,",").concat(t+n,`
            L `).concat(e+o*p,",").concat(t+n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+n-i*p," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},zwe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Wwe=e=>{var t=Rl(e,zwe),r=S.useRef(null),[n,s]=S.useState(-1);S.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ae=r.current.getTotalLength();ae&&s(ae)}catch{}},[]);var{x:a,y:i,width:o,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:g,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:v}=t,w=S.useRef(o),C=S.useRef(c),k=S.useRef(a),_=S.useRef(i),N=S.useMemo(()=>({x:a,y:i,width:o,height:c,radius:u}),[a,i,o,c,u]),E=_W(N,"rectangle-");if(a!==+a||i!==+i||o!==+o||c!==+c||o===0||c===0)return null;var P=ls("recharts-rectangle",d);if(!v)return S.createElement("path",ub({},gi(t,!0),{className:P,d:bI(a,i,o,c,u)}));var F=w.current,A=C.current,j=k.current,I=_.current,L="0px ".concat(n===-1?1:n,"px"),Y="".concat(n,"px 0px"),Z=bwe(["strokeDasharray"],g,typeof f=="string"?f:void 0);return S.createElement(wW,{animationId:E,key:E,canBegin:n>0,duration:g,easing:f,isActive:v,begin:p},ae=>{var ee=Bu(F,o,ae),ne=Bu(A,c,ae),B=Bu(j,a,ae),V=Bu(I,i,ae);r.current&&(w.current=ee,C.current=ne,k.current=B,_.current=V);var M;return x?ae>0?M={transition:Z,strokeDasharray:Y}:M={strokeDasharray:L}:M={strokeDasharray:Y},S.createElement("path",ub({},gi(t,!0),{className:P,d:bI(B,V,ee,ne,u),ref:r,style:_I(_I({},M),t.style)}))})};function bW(e){var{cx:t,cy:r,radius:n,startAngle:s,endAngle:a}=e,i=di(t,r,n,s),o=di(t,r,n,a);return{points:[i,o],cx:t,cy:r,radius:n,startAngle:s,endAngle:a}}function WE(){return WE=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},WE.apply(null,arguments)}var Hwe=(e,t)=>{var r=Sl(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Hw=e=>{var{cx:t,cy:r,radius:n,angle:s,sign:a,isExternal:i,cornerRadius:o,cornerIsExternal:c}=e,u=o*(i?1:-1)+n,d=Math.asin(o/u)/ib,f=c?s:s+a*d,g=di(t,r,u,f),p=di(t,r,n,f),x=c?s-a*d:s,v=di(t,r,u*Math.cos(d*ib),x);return{center:g,circleTangency:p,lineTangency:v,theta:d}},SW=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:i}=e,o=Hwe(a,i),c=a+o,u=di(t,r,s,a),d=di(t,r,s,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var g=di(t,r,n,a),p=di(t,r,n,c);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(g.x,",").concat(g.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},Gwe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=Sl(u-c),{circleTangency:f,lineTangency:g,theta:p}=Hw({cx:t,cy:r,radius:s,angle:c,sign:d,cornerRadius:a,cornerIsExternal:o}),{circleTangency:x,lineTangency:v,theta:w}=Hw({cx:t,cy:r,radius:s,angle:u,sign:-d,cornerRadius:a,cornerIsExternal:o}),C=o?Math.abs(c-u):Math.abs(c-u)-p-w;if(C<0)return i?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):SW({cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:c,endAngle:u});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(v.x,",").concat(v.y,`
  `);if(n>0){var{circleTangency:_,lineTangency:N,theta:E}=Hw({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:P,lineTangency:F,theta:A}=Hw({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),j=o?Math.abs(c-u):Math.abs(c-u)-E-A;if(j<0&&a===0)return"".concat(k,"L").concat(t,",").concat(r,"Z");k+="L".concat(F.x,",").concat(F.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(P.x,",").concat(P.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(j>180),",").concat(+(d>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(N.x,",").concat(N.y,"Z")}else k+="L".concat(t,",").concat(r,"Z");return k},Vwe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Kwe=e=>{var t=Rl(e,Vwe),{cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(a<s||u===d)return null;var g=ls("recharts-sector",f),p=a-s,x=jf(i,p,0,!0),v;return x>0&&Math.abs(u-d)<360?v=Gwe({cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:Math.min(x,p/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):v=SW({cx:r,cy:n,innerRadius:s,outerRadius:a,startAngle:u,endAngle:d}),S.createElement("path",WE({},gi(t,!0),{className:g,d:v}))};function qwe(e,t,r){var n,s,a,i;if(e==="horizontal")n=t.x,a=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:f}=t,g=di(o,c,u,f),p=di(o,c,d,f);n=g.x,s=g.y,a=p.x,i=p.y}else return bW(t);return[{x:n,y:s},{x:a,y:i}]}var OC={},DC={},IC={},SI;function Ywe(){return SI||(SI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fz();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(IC)),IC}var kI;function Xwe(){return kI||(kI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ywe();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(DC)),DC}var CI;function Jwe(){return CI||(CI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oz(),r=Xwe();function n(s,a,i){i&&typeof i!="number"&&t.isIterateeCall(s,a,i)&&(a=i=void 0),s=r.toFinite(s),a===void 0?(a=s,s=0):a=r.toFinite(a),i=i===void 0?s<a?1:-1:r.toFinite(i);const o=Math.max(Math.ceil((a-s)/(i||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=s,s+=i;return c}e.range=n})(OC)),OC}var RC,TI;function Qwe(){return TI||(TI=1,RC=Jwe().range),RC}var Zwe=Qwe();const kW=Ol(Zwe);function _f(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function e_e(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Z3(e){let t,r,n;e.length!==2?(t=_f,r=(o,c)=>_f(e(o),c),n=(o,c)=>e(o)-c):(t=e===_f||e===e_e?e:t_e,r=e,n=e);function s(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){const f=s(o,c,u,d-1);return f>u&&n(o[f-1],c)>-n(o[f],c)?f-1:f}return{left:s,center:i,right:a}}function t_e(){return 0}function CW(e){return e===null?NaN:+e}function*r_e(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const n_e=Z3(_f),t1=n_e.right;Z3(CW).center;class EI extends Map{constructor(t,r=i_e){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(NI(this,t))}has(t){return super.has(NI(this,t))}set(t,r){return super.set(s_e(this,t),r)}delete(t){return super.delete(a_e(this,t))}}function NI({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function s_e({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function a_e({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function i_e(e){return e!==null&&typeof e=="object"?e.valueOf():e}function o_e(e=_f){if(e===_f)return TW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function TW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const l_e=Math.sqrt(50),c_e=Math.sqrt(10),u_e=Math.sqrt(2);function db(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),a=n/Math.pow(10,s),i=a>=l_e?10:a>=c_e?5:a>=u_e?2:1;let o,c,u;return s<0?(u=Math.pow(10,-s)/i,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,s)*i,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?db(e,t,r*2):[o,c,u]}function HE(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,a,i]=n?db(t,e,r):db(e,t,r);if(!(a>=s))return[];const o=a-s+1,c=new Array(o);if(n)if(i<0)for(let u=0;u<o;++u)c[u]=(a-u)/-i;else for(let u=0;u<o;++u)c[u]=(a-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(s+u)/-i;else for(let u=0;u<o;++u)c[u]=(s+u)*i;return c}function GE(e,t,r){return t=+t,e=+e,r=+r,db(e,t,r)[2]}function VE(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?GE(t,e,r):GE(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function AI(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function jI(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function EW(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?TW:o_e(s);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),g=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),p=Math.max(r,Math.floor(t-u*f/c+g)),x=Math.min(n,Math.floor(t+(c-u)*f/c+g));EW(e,t,p,x,s)}const a=e[t];let i=r,o=n;for(ty(e,r,t),s(e[n],a)>0&&ty(e,r,n);i<o;){for(ty(e,i,o),++i,--o;s(e[i],a)<0;)++i;for(;s(e[o],a)>0;)--o}s(e[r],a)===0?ty(e,r,o):(++o,ty(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function ty(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function d_e(e,t,r){if(e=Float64Array.from(r_e(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return jI(e);if(t>=1)return AI(e);var n,s=(n-1)*t,a=Math.floor(s),i=AI(EW(e,a).subarray(0,a+1)),o=jI(e.subarray(a+1));return i+(o-i)*(s-a)}}function f_e(e,t,r=CW){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,a=Math.floor(s),i=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return i+(o-i)*(s-a)}}function h_e(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(s);++n<s;)a[n]=e+n*r;return a}function Ml(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function md(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const KE=Symbol("implicit");function eA(){var e=new EI,t=[],r=[],n=KE;function s(a){let i=e.get(a);if(i===void 0){if(n!==KE)return n;e.set(a,i=t.push(a)-1)}return r[i%r.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new EI;for(const i of a)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return eA(t,r).unknown(n)},Ml.apply(s,arguments),s}function tA(){var e=eA().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,a,i,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var g=t().length,p=s<n,x=p?s:n,v=p?n:s;a=(v-x)/Math.max(1,g-c+u*2),o&&(a=Math.floor(a)),x+=(v-x-a*(g-c))*d,i=a*(1-c),o&&(x=Math.round(x),i=Math.round(i));var w=h_e(g).map(function(C){return x+a*C});return r(p?w.reverse():w)}return e.domain=function(g){return arguments.length?(t(g),f()):t()},e.range=function(g){return arguments.length?([n,s]=g,n=+n,s=+s,f()):[n,s]},e.rangeRound=function(g){return[n,s]=g,n=+n,s=+s,o=!0,f()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(g){return arguments.length?(o=!!g,f()):o},e.padding=function(g){return arguments.length?(c=Math.min(1,u=+g),f()):c},e.paddingInner=function(g){return arguments.length?(c=Math.min(1,g),f()):c},e.paddingOuter=function(g){return arguments.length?(u=+g,f()):u},e.align=function(g){return arguments.length?(d=Math.max(0,Math.min(1,g)),f()):d},e.copy=function(){return tA(t(),[n,s]).round(o).paddingInner(c).paddingOuter(u).align(d)},Ml.apply(f(),arguments)}function NW(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return NW(t())},e}function g_e(){return NW(tA.apply(null,arguments).paddingInner(1))}function rA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function AW(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function r1(){}var pv=.7,fb=1/pv,mm="\\s*([+-]?\\d+)\\s*",xv="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Xc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",m_e=/^#([0-9a-f]{3,8})$/,p_e=new RegExp(`^rgb\\(${mm},${mm},${mm}\\)$`),x_e=new RegExp(`^rgb\\(${Xc},${Xc},${Xc}\\)$`),y_e=new RegExp(`^rgba\\(${mm},${mm},${mm},${xv}\\)$`),v_e=new RegExp(`^rgba\\(${Xc},${Xc},${Xc},${xv}\\)$`),w_e=new RegExp(`^hsl\\(${xv},${Xc},${Xc}\\)$`),__e=new RegExp(`^hsla\\(${xv},${Xc},${Xc},${xv}\\)$`),PI={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};rA(r1,yv,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:FI,formatHex:FI,formatHex8:b_e,formatHsl:S_e,formatRgb:OI,toString:OI});function FI(){return this.rgb().formatHex()}function b_e(){return this.rgb().formatHex8()}function S_e(){return jW(this).formatHsl()}function OI(){return this.rgb().formatRgb()}function yv(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=m_e.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?DI(t):r===3?new bo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Gw(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Gw(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=p_e.exec(e))?new bo(t[1],t[2],t[3],1):(t=x_e.exec(e))?new bo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=y_e.exec(e))?Gw(t[1],t[2],t[3],t[4]):(t=v_e.exec(e))?Gw(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=w_e.exec(e))?MI(t[1],t[2]/100,t[3]/100,1):(t=__e.exec(e))?MI(t[1],t[2]/100,t[3]/100,t[4]):PI.hasOwnProperty(e)?DI(PI[e]):e==="transparent"?new bo(NaN,NaN,NaN,0):null}function DI(e){return new bo(e>>16&255,e>>8&255,e&255,1)}function Gw(e,t,r,n){return n<=0&&(e=t=r=NaN),new bo(e,t,r,n)}function k_e(e){return e instanceof r1||(e=yv(e)),e?(e=e.rgb(),new bo(e.r,e.g,e.b,e.opacity)):new bo}function qE(e,t,r,n){return arguments.length===1?k_e(e):new bo(e,t,r,n??1)}function bo(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}rA(bo,qE,AW(r1,{brighter(e){return e=e==null?fb:Math.pow(fb,e),new bo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?pv:Math.pow(pv,e),new bo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new bo(Jh(this.r),Jh(this.g),Jh(this.b),hb(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:II,formatHex:II,formatHex8:C_e,formatRgb:RI,toString:RI}));function II(){return`#${Rh(this.r)}${Rh(this.g)}${Rh(this.b)}`}function C_e(){return`#${Rh(this.r)}${Rh(this.g)}${Rh(this.b)}${Rh((isNaN(this.opacity)?1:this.opacity)*255)}`}function RI(){const e=hb(this.opacity);return`${e===1?"rgb(":"rgba("}${Jh(this.r)}, ${Jh(this.g)}, ${Jh(this.b)}${e===1?")":`, ${e})`}`}function hb(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Jh(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Rh(e){return e=Jh(e),(e<16?"0":"")+e.toString(16)}function MI(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new nc(e,t,r,n)}function jW(e){if(e instanceof nc)return new nc(e.h,e.s,e.l,e.opacity);if(e instanceof r1||(e=yv(e)),!e)return new nc;if(e instanceof nc)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),a=Math.max(t,r,n),i=NaN,o=a-s,c=(a+s)/2;return o?(t===a?i=(r-n)/o+(r<n)*6:r===a?i=(n-t)/o+2:i=(t-r)/o+4,o/=c<.5?a+s:2-a-s,i*=60):o=c>0&&c<1?0:i,new nc(i,o,c,e.opacity)}function T_e(e,t,r,n){return arguments.length===1?jW(e):new nc(e,t,r,n??1)}function nc(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}rA(nc,T_e,AW(r1,{brighter(e){return e=e==null?fb:Math.pow(fb,e),new nc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?pv:Math.pow(pv,e),new nc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new bo(MC(e>=240?e-240:e+120,s,n),MC(e,s,n),MC(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new nc(LI(this.h),Vw(this.s),Vw(this.l),hb(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=hb(this.opacity);return`${e===1?"hsl(":"hsla("}${LI(this.h)}, ${Vw(this.s)*100}%, ${Vw(this.l)*100}%${e===1?")":`, ${e})`}`}}));function LI(e){return e=(e||0)%360,e<0?e+360:e}function Vw(e){return Math.max(0,Math.min(1,e||0))}function MC(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const nA=e=>()=>e;function E_e(e,t){return function(r){return e+r*t}}function N_e(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function A_e(e){return(e=+e)==1?PW:function(t,r){return r-t?N_e(t,r,e):nA(isNaN(t)?r:t)}}function PW(e,t){var r=t-e;return r?E_e(e,r):nA(isNaN(e)?t:e)}const BI=(function e(t){var r=A_e(t);function n(s,a){var i=r((s=qE(s)).r,(a=qE(a)).r),o=r(s.g,a.g),c=r(s.b,a.b),u=PW(s.opacity,a.opacity);return function(d){return s.r=i(d),s.g=o(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=e,n})(1);function j_e(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(a){for(s=0;s<r;++s)n[s]=e[s]*(1-a)+t[s]*a;return n}}function P_e(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function F_e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),a=new Array(r),i;for(i=0;i<n;++i)s[i]=sp(e[i],t[i]);for(;i<r;++i)a[i]=t[i];return function(o){for(i=0;i<n;++i)a[i]=s[i](o);return a}}function O_e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function gb(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function D_e(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=sp(e[s],t[s]):n[s]=t[s];return function(a){for(s in r)n[s]=r[s](a);return n}}var YE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,LC=new RegExp(YE.source,"g");function I_e(e){return function(){return e}}function R_e(e){return function(t){return e(t)+""}}function M_e(e,t){var r=YE.lastIndex=LC.lastIndex=0,n,s,a,i=-1,o=[],c=[];for(e=e+"",t=t+"";(n=YE.exec(e))&&(s=LC.exec(t));)(a=s.index)>r&&(a=t.slice(r,a),o[i]?o[i]+=a:o[++i]=a),(n=n[0])===(s=s[0])?o[i]?o[i]+=s:o[++i]=s:(o[++i]=null,c.push({i,x:gb(n,s)})),r=LC.lastIndex;return r<t.length&&(a=t.slice(r),o[i]?o[i]+=a:o[++i]=a),o.length<2?c[0]?R_e(c[0].x):I_e(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function sp(e,t){var r=typeof t,n;return t==null||r==="boolean"?nA(t):(r==="number"?gb:r==="string"?(n=yv(t))?(t=n,BI):M_e:t instanceof yv?BI:t instanceof Date?O_e:P_e(t)?j_e:Array.isArray(t)?F_e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?D_e:gb)(e,t)}function sA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function L_e(e,t){t===void 0&&(t=e,e=sp);for(var r=0,n=t.length-1,s=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(s,s=t[++r]);return function(i){var o=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return a[o](i-o)}}function B_e(e){return function(){return e}}function mb(e){return+e}var $I=[0,1];function to(e){return e}function XE(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:B_e(isNaN(t)?NaN:.5)}function $_e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function U_e(e,t,r){var n=e[0],s=e[1],a=t[0],i=t[1];return s<n?(n=XE(s,n),a=r(i,a)):(n=XE(n,s),a=r(a,i)),function(o){return a(n(o))}}function z_e(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),a=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=XE(e[i],e[i+1]),a[i]=r(t[i],t[i+1]);return function(o){var c=t1(e,o,1,n)-1;return a[c](s[c](o))}}function n1(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function T2(){var e=$I,t=$I,r=sp,n,s,a,i=to,o,c,u;function d(){var g=Math.min(e.length,t.length);return i!==to&&(i=$_e(e[0],e[g-1])),o=g>2?z_e:U_e,c=u=null,f}function f(g){return g==null||isNaN(g=+g)?a:(c||(c=o(e.map(n),t,r)))(n(i(g)))}return f.invert=function(g){return i(s((u||(u=o(t,e.map(n),gb)))(g)))},f.domain=function(g){return arguments.length?(e=Array.from(g,mb),d()):e.slice()},f.range=function(g){return arguments.length?(t=Array.from(g),d()):t.slice()},f.rangeRound=function(g){return t=Array.from(g),r=sA,d()},f.clamp=function(g){return arguments.length?(i=g?!0:to,d()):i!==to},f.interpolate=function(g){return arguments.length?(r=g,d()):r},f.unknown=function(g){return arguments.length?(a=g,f):a},function(g,p){return n=g,s=p,d()}}function aA(){return T2()(to,to)}function W_e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function pb(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function jm(e){return e=pb(Math.abs(e)),e?e[1]:NaN}function H_e(e,t){return function(r,n){for(var s=r.length,a=[],i=0,o=e[0],c=0;s>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(s-=o,s+o)),!((c+=o+1)>n));)o=e[i=(i+1)%e.length];return a.reverse().join(t)}}function G_e(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var V_e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vv(e){if(!(t=V_e.exec(e)))throw new Error("invalid format: "+e);var t;return new iA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}vv.prototype=iA.prototype;function iA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}iA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function K_e(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var FW;function q_e(e,t){var r=pb(e,t);if(!r)return e+"";var n=r[0],s=r[1],a=s-(FW=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return a===i?n:a>i?n+new Array(a-i+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+pb(e,Math.max(0,t+a-1))[0]}function UI(e,t){var r=pb(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const zI={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:W_e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>UI(e*100,t),r:UI,s:q_e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function WI(e){return e}var HI=Array.prototype.map,GI=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Y_e(e){var t=e.grouping===void 0||e.thousands===void 0?WI:H_e(HI.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?WI:G_e(HI.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=vv(f);var g=f.fill,p=f.align,x=f.sign,v=f.symbol,w=f.zero,C=f.width,k=f.comma,_=f.precision,N=f.trim,E=f.type;E==="n"?(k=!0,E="g"):zI[E]||(_===void 0&&(_=12),N=!0,E="g"),(w||g==="0"&&p==="=")&&(w=!0,g="0",p="=");var P=v==="$"?r:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",F=v==="$"?n:/[%p]/.test(E)?i:"",A=zI[E],j=/[defgprs%]/.test(E);_=_===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function I(L){var Y=P,Z=F,ae,ee,ne;if(E==="c")Z=A(L)+Z,L="";else{L=+L;var B=L<0||1/L<0;if(L=isNaN(L)?c:A(Math.abs(L),_),N&&(L=K_e(L)),B&&+L==0&&x!=="+"&&(B=!1),Y=(B?x==="("?x:o:x==="-"||x==="("?"":x)+Y,Z=(E==="s"?GI[8+FW/3]:"")+Z+(B&&x==="("?")":""),j){for(ae=-1,ee=L.length;++ae<ee;)if(ne=L.charCodeAt(ae),48>ne||ne>57){Z=(ne===46?s+L.slice(ae+1):L.slice(ae))+Z,L=L.slice(0,ae);break}}}k&&!w&&(L=t(L,1/0));var V=Y.length+L.length+Z.length,M=V<C?new Array(C-V+1).join(g):"";switch(k&&w&&(L=t(M+L,M.length?C-Z.length:1/0),M=""),p){case"<":L=Y+L+Z+M;break;case"=":L=Y+M+L+Z;break;case"^":L=M.slice(0,V=M.length>>1)+Y+L+Z+M.slice(V);break;default:L=M+Y+L+Z;break}return a(L)}return I.toString=function(){return f+""},I}function d(f,g){var p=u((f=vv(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(jm(g)/3)))*3,v=Math.pow(10,-x),w=GI[8+x/3];return function(C){return p(v*C)+w}}return{format:u,formatPrefix:d}}var Kw,oA,OW;X_e({thousands:",",grouping:[3],currency:["$",""]});function X_e(e){return Kw=Y_e(e),oA=Kw.format,OW=Kw.formatPrefix,Kw}function J_e(e){return Math.max(0,-jm(Math.abs(e)))}function Q_e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(jm(t)/3)))*3-jm(Math.abs(e)))}function Z_e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,jm(t)-jm(e))+1}function DW(e,t,r,n){var s=VE(e,t,r),a;switch(n=vv(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=Q_e(s,i))&&(n.precision=a),OW(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=Z_e(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=J_e(s))&&(n.precision=a-(n.type==="%")*2);break}}return oA(n)}function zf(e){var t=e.domain;return e.ticks=function(r){var n=t();return HE(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return DW(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,a=n.length-1,i=n[s],o=n[a],c,u,d=10;for(o<i&&(u=i,i=o,o=u,u=s,s=a,a=u);d-- >0;){if(u=GE(i,o,r),u===c)return n[s]=i,n[a]=o,t(n);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function IW(){var e=aA();return e.copy=function(){return n1(e,IW())},Ml.apply(e,arguments),zf(e)}function RW(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,mb),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return RW(e).unknown(t)},e=arguments.length?Array.from(e,mb):[0,1],zf(r)}function MW(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],a=e[n],i;return a<s&&(i=r,r=n,n=i,i=s,s=a,a=i),e[r]=t.floor(s),e[n]=t.ceil(a),e}function VI(e){return Math.log(e)}function KI(e){return Math.exp(e)}function ebe(e){return-Math.log(-e)}function tbe(e){return-Math.exp(-e)}function rbe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function nbe(e){return e===10?rbe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function sbe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function qI(e){return(t,r)=>-e(-t,r)}function lA(e){const t=e(VI,KI),r=t.domain;let n=10,s,a;function i(){return s=sbe(n),a=nbe(n),r()[0]<0?(s=qI(s),a=qI(a),e(ebe,tbe)):e(VI,KI),t}return t.base=function(o){return arguments.length?(n=+o,i()):n},t.domain=function(o){return arguments.length?(r(o),i()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let g=s(u),p=s(d),x,v;const w=o==null?10:+o;let C=[];if(!(n%1)&&p-g<w){if(g=Math.floor(g),p=Math.ceil(p),u>0){for(;g<=p;++g)for(x=1;x<n;++x)if(v=g<0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}}else for(;g<=p;++g)for(x=n-1;x>=1;--x)if(v=g>0?x/a(-g):x*a(g),!(v<u)){if(v>d)break;C.push(v)}C.length*2<w&&(C=HE(u,d,w))}else C=HE(g,p,Math.min(p-g,w)).map(a);return f?C.reverse():C},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=vv(c)).precision==null&&(c.trim=!0),c=oA(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let f=d/a(Math.round(s(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(MW(r(),{floor:o=>a(Math.floor(s(o))),ceil:o=>a(Math.ceil(s(o)))})),t}function LW(){const e=lA(T2()).domain([1,10]);return e.copy=()=>n1(e,LW()).base(e.base()),Ml.apply(e,arguments),e}function YI(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function XI(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function cA(e){var t=1,r=e(YI(t),XI(t));return r.constant=function(n){return arguments.length?e(YI(t=+n),XI(t)):t},zf(r)}function BW(){var e=cA(T2());return e.copy=function(){return n1(e,BW()).constant(e.constant())},Ml.apply(e,arguments)}function JI(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function abe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function ibe(e){return e<0?-e*e:e*e}function uA(e){var t=e(to,to),r=1;function n(){return r===1?e(to,to):r===.5?e(abe,ibe):e(JI(r),JI(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},zf(t)}function dA(){var e=uA(T2());return e.copy=function(){return n1(e,dA()).exponent(e.exponent())},Ml.apply(e,arguments),e}function obe(){return dA.apply(null,arguments).exponent(.5)}function QI(e){return Math.sign(e)*e*e}function lbe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function $W(){var e=aA(),t=[0,1],r=!1,n;function s(a){var i=lbe(e(a));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(a){return e.invert(QI(a))},s.domain=function(a){return arguments.length?(e.domain(a),s):e.domain()},s.range=function(a){return arguments.length?(e.range((t=Array.from(a,mb)).map(QI)),s):t.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(r=!!a,s):r},s.clamp=function(a){return arguments.length?(e.clamp(a),s):e.clamp()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return $W(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Ml.apply(s,arguments),zf(s)}function UW(){var e=[],t=[],r=[],n;function s(){var i=0,o=Math.max(1,t.length);for(r=new Array(o-1);++i<o;)r[i-1]=f_e(e,i/o);return a}function a(i){return i==null||isNaN(i=+i)?n:t[t1(r,i)]}return a.invertExtent=function(i){var o=t.indexOf(i);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(_f),s()},a.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return UW().domain(e).range(t).unknown(n)},Ml.apply(a,arguments)}function zW(){var e=0,t=1,r=1,n=[.5],s=[0,1],a;function i(c){return c!=null&&c<=c?s[t1(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},i.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,o()):s.slice()},i.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(c){return arguments.length&&(a=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return zW().domain([e,t]).range(s).unknown(a)},Ml.apply(zf(i),arguments)}function WW(){var e=[.5],t=[0,1],r,n=1;function s(a){return a!=null&&a<=a?t[t1(e,a,0,n)]:r}return s.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return WW().domain(e).range(t).unknown(r)},Ml.apply(s,arguments)}const BC=new Date,$C=new Date;function Ca(e,t,r,n){function s(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(e(a=new Date(+a)),a),s.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),s.round=a=>{const i=s(a),o=s.ceil(a);return a-i<o-a?i:o},s.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),s.range=(a,i,o)=>{const c=[];if(a=s.ceil(a),o=o==null?1:Math.floor(o),!(a<i)||!(o>0))return c;let u;do c.push(u=new Date(+a)),t(a,o),e(a);while(u<a&&a<i);return c},s.filter=a=>Ca(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,o)=>{if(i>=i)if(o<0)for(;++o<=0;)for(;t(i,-1),!a(i););else for(;--o>=0;)for(;t(i,1),!a(i););}),r&&(s.count=(a,i)=>(BC.setTime(+a),$C.setTime(+i),e(BC),e($C),Math.floor(r(BC,$C))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(n?i=>n(i)%a===0:i=>s.count(0,i)%a===0):s)),s}const xb=Ca(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);xb.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Ca(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):xb);xb.range;const Hu=1e3,kl=Hu*60,Gu=kl*60,ad=Gu*24,fA=ad*7,ZI=ad*30,UC=ad*365,Mh=Ca(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Hu)},(e,t)=>(t-e)/Hu,e=>e.getUTCSeconds());Mh.range;const hA=Ca(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hu)},(e,t)=>{e.setTime(+e+t*kl)},(e,t)=>(t-e)/kl,e=>e.getMinutes());hA.range;const gA=Ca(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*kl)},(e,t)=>(t-e)/kl,e=>e.getUTCMinutes());gA.range;const mA=Ca(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Hu-e.getMinutes()*kl)},(e,t)=>{e.setTime(+e+t*Gu)},(e,t)=>(t-e)/Gu,e=>e.getHours());mA.range;const pA=Ca(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Gu)},(e,t)=>(t-e)/Gu,e=>e.getUTCHours());pA.range;const s1=Ca(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*kl)/ad,e=>e.getDate()-1);s1.range;const E2=Ca(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ad,e=>e.getUTCDate()-1);E2.range;const HW=Ca(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/ad,e=>Math.floor(e/ad));HW.range;function R0(e){return Ca(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*kl)/fA)}const N2=R0(0),yb=R0(1),cbe=R0(2),ube=R0(3),Pm=R0(4),dbe=R0(5),fbe=R0(6);N2.range;yb.range;cbe.range;ube.range;Pm.range;dbe.range;fbe.range;function M0(e){return Ca(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/fA)}const A2=M0(0),vb=M0(1),hbe=M0(2),gbe=M0(3),Fm=M0(4),mbe=M0(5),pbe=M0(6);A2.range;vb.range;hbe.range;gbe.range;Fm.range;mbe.range;pbe.range;const xA=Ca(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());xA.range;const yA=Ca(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());yA.range;const id=Ca(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());id.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ca(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});id.range;const od=Ca(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());od.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Ca(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});od.range;function GW(e,t,r,n,s,a){const i=[[Mh,1,Hu],[Mh,5,5*Hu],[Mh,15,15*Hu],[Mh,30,30*Hu],[a,1,kl],[a,5,5*kl],[a,15,15*kl],[a,30,30*kl],[s,1,Gu],[s,3,3*Gu],[s,6,6*Gu],[s,12,12*Gu],[n,1,ad],[n,2,2*ad],[r,1,fA],[t,1,ZI],[t,3,3*ZI],[e,1,UC]];function o(u,d,f){const g=d<u;g&&([u,d]=[d,u]);const p=f&&typeof f.range=="function"?f:c(u,d,f),x=p?p.range(u,+d+1):[];return g?x.reverse():x}function c(u,d,f){const g=Math.abs(d-u)/f,p=Z3(([,,w])=>w).right(i,g);if(p===i.length)return e.every(VE(u/UC,d/UC,f));if(p===0)return xb.every(Math.max(VE(u,d,f),1));const[x,v]=i[g/i[p-1][2]<i[p][2]/g?p-1:p];return x.every(v)}return[o,c]}const[xbe,ybe]=GW(od,yA,A2,HW,pA,gA),[vbe,wbe]=GW(id,xA,N2,s1,mA,hA);function zC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function WC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ry(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function _be(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,a=e.days,i=e.shortDays,o=e.months,c=e.shortMonths,u=ny(s),d=sy(s),f=ny(a),g=sy(a),p=ny(i),x=sy(i),v=ny(o),w=sy(o),C=ny(c),k=sy(c),_={a:B,A:V,b:M,B:H,c:null,d:aR,e:aR,f:Hbe,g:e2e,G:r2e,H:Ube,I:zbe,j:Wbe,L:VW,m:Gbe,M:Vbe,p:W,q:R,Q:lR,s:cR,S:Kbe,u:qbe,U:Ybe,V:Xbe,w:Jbe,W:Qbe,x:null,X:null,y:Zbe,Y:t2e,Z:n2e,"%":oR},N={a:z,A:K,b:J,B:se,c:null,d:iR,e:iR,f:o2e,g:x2e,G:v2e,H:s2e,I:a2e,j:i2e,L:qW,m:l2e,M:c2e,p:X,q:ie,Q:lR,s:cR,S:u2e,u:d2e,U:f2e,V:h2e,w:g2e,W:m2e,x:null,X:null,y:p2e,Y:y2e,Z:w2e,"%":oR},E={a:I,A:L,b:Y,B:Z,c:ae,d:nR,e:nR,f:Mbe,g:rR,G:tR,H:sR,I:sR,j:Obe,L:Rbe,m:Fbe,M:Dbe,p:j,q:Pbe,Q:Bbe,s:$be,S:Ibe,u:Tbe,U:Ebe,V:Nbe,w:Cbe,W:Abe,x:ee,X:ne,y:rR,Y:tR,Z:jbe,"%":Lbe};_.x=P(r,_),_.X=P(n,_),_.c=P(t,_),N.x=P(r,N),N.X=P(n,N),N.c=P(t,N);function P(le,ce){return function(be){var re=[],pe=-1,Ce=0,Ae=le.length,We,Le,At;for(be instanceof Date||(be=new Date(+be));++pe<Ae;)le.charCodeAt(pe)===37&&(re.push(le.slice(Ce,pe)),(Le=eR[We=le.charAt(++pe)])!=null?We=le.charAt(++pe):Le=We==="e"?" ":"0",(At=ce[We])&&(We=At(be,Le)),re.push(We),Ce=pe+1);return re.push(le.slice(Ce,pe)),re.join("")}}function F(le,ce){return function(be){var re=ry(1900,void 0,1),pe=A(re,le,be+="",0),Ce,Ae;if(pe!=be.length)return null;if("Q"in re)return new Date(re.Q);if("s"in re)return new Date(re.s*1e3+("L"in re?re.L:0));if(ce&&!("Z"in re)&&(re.Z=0),"p"in re&&(re.H=re.H%12+re.p*12),re.m===void 0&&(re.m="q"in re?re.q:0),"V"in re){if(re.V<1||re.V>53)return null;"w"in re||(re.w=1),"Z"in re?(Ce=WC(ry(re.y,0,1)),Ae=Ce.getUTCDay(),Ce=Ae>4||Ae===0?vb.ceil(Ce):vb(Ce),Ce=E2.offset(Ce,(re.V-1)*7),re.y=Ce.getUTCFullYear(),re.m=Ce.getUTCMonth(),re.d=Ce.getUTCDate()+(re.w+6)%7):(Ce=zC(ry(re.y,0,1)),Ae=Ce.getDay(),Ce=Ae>4||Ae===0?yb.ceil(Ce):yb(Ce),Ce=s1.offset(Ce,(re.V-1)*7),re.y=Ce.getFullYear(),re.m=Ce.getMonth(),re.d=Ce.getDate()+(re.w+6)%7)}else("W"in re||"U"in re)&&("w"in re||(re.w="u"in re?re.u%7:"W"in re?1:0),Ae="Z"in re?WC(ry(re.y,0,1)).getUTCDay():zC(ry(re.y,0,1)).getDay(),re.m=0,re.d="W"in re?(re.w+6)%7+re.W*7-(Ae+5)%7:re.w+re.U*7-(Ae+6)%7);return"Z"in re?(re.H+=re.Z/100|0,re.M+=re.Z%100,WC(re)):zC(re)}}function A(le,ce,be,re){for(var pe=0,Ce=ce.length,Ae=be.length,We,Le;pe<Ce;){if(re>=Ae)return-1;if(We=ce.charCodeAt(pe++),We===37){if(We=ce.charAt(pe++),Le=E[We in eR?ce.charAt(pe++):We],!Le||(re=Le(le,be,re))<0)return-1}else if(We!=be.charCodeAt(re++))return-1}return re}function j(le,ce,be){var re=u.exec(ce.slice(be));return re?(le.p=d.get(re[0].toLowerCase()),be+re[0].length):-1}function I(le,ce,be){var re=p.exec(ce.slice(be));return re?(le.w=x.get(re[0].toLowerCase()),be+re[0].length):-1}function L(le,ce,be){var re=f.exec(ce.slice(be));return re?(le.w=g.get(re[0].toLowerCase()),be+re[0].length):-1}function Y(le,ce,be){var re=C.exec(ce.slice(be));return re?(le.m=k.get(re[0].toLowerCase()),be+re[0].length):-1}function Z(le,ce,be){var re=v.exec(ce.slice(be));return re?(le.m=w.get(re[0].toLowerCase()),be+re[0].length):-1}function ae(le,ce,be){return A(le,t,ce,be)}function ee(le,ce,be){return A(le,r,ce,be)}function ne(le,ce,be){return A(le,n,ce,be)}function B(le){return i[le.getDay()]}function V(le){return a[le.getDay()]}function M(le){return c[le.getMonth()]}function H(le){return o[le.getMonth()]}function W(le){return s[+(le.getHours()>=12)]}function R(le){return 1+~~(le.getMonth()/3)}function z(le){return i[le.getUTCDay()]}function K(le){return a[le.getUTCDay()]}function J(le){return c[le.getUTCMonth()]}function se(le){return o[le.getUTCMonth()]}function X(le){return s[+(le.getUTCHours()>=12)]}function ie(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var ce=P(le+="",_);return ce.toString=function(){return le},ce},parse:function(le){var ce=F(le+="",!1);return ce.toString=function(){return le},ce},utcFormat:function(le){var ce=P(le+="",N);return ce.toString=function(){return le},ce},utcParse:function(le){var ce=F(le+="",!0);return ce.toString=function(){return le},ce}}}var eR={"-":"",_:" ",0:"0"},Ha=/^\s*\d+/,bbe=/^%/,Sbe=/[\\^$*+?|[\]().{}]/g;function wn(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",a=s.length;return n+(a<r?new Array(r-a+1).join(t)+s:s)}function kbe(e){return e.replace(Sbe,"\\$&")}function ny(e){return new RegExp("^(?:"+e.map(kbe).join("|")+")","i")}function sy(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Cbe(e,t,r){var n=Ha.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Tbe(e,t,r){var n=Ha.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Ebe(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function Nbe(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function Abe(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function tR(e,t,r){var n=Ha.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function rR(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function jbe(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Pbe(e,t,r){var n=Ha.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function Fbe(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function nR(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function Obe(e,t,r){var n=Ha.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function sR(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function Dbe(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function Ibe(e,t,r){var n=Ha.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function Rbe(e,t,r){var n=Ha.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function Mbe(e,t,r){var n=Ha.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function Lbe(e,t,r){var n=bbe.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function Bbe(e,t,r){var n=Ha.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function $be(e,t,r){var n=Ha.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function aR(e,t){return wn(e.getDate(),t,2)}function Ube(e,t){return wn(e.getHours(),t,2)}function zbe(e,t){return wn(e.getHours()%12||12,t,2)}function Wbe(e,t){return wn(1+s1.count(id(e),e),t,3)}function VW(e,t){return wn(e.getMilliseconds(),t,3)}function Hbe(e,t){return VW(e,t)+"000"}function Gbe(e,t){return wn(e.getMonth()+1,t,2)}function Vbe(e,t){return wn(e.getMinutes(),t,2)}function Kbe(e,t){return wn(e.getSeconds(),t,2)}function qbe(e){var t=e.getDay();return t===0?7:t}function Ybe(e,t){return wn(N2.count(id(e)-1,e),t,2)}function KW(e){var t=e.getDay();return t>=4||t===0?Pm(e):Pm.ceil(e)}function Xbe(e,t){return e=KW(e),wn(Pm.count(id(e),e)+(id(e).getDay()===4),t,2)}function Jbe(e){return e.getDay()}function Qbe(e,t){return wn(yb.count(id(e)-1,e),t,2)}function Zbe(e,t){return wn(e.getFullYear()%100,t,2)}function e2e(e,t){return e=KW(e),wn(e.getFullYear()%100,t,2)}function t2e(e,t){return wn(e.getFullYear()%1e4,t,4)}function r2e(e,t){var r=e.getDay();return e=r>=4||r===0?Pm(e):Pm.ceil(e),wn(e.getFullYear()%1e4,t,4)}function n2e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+wn(t/60|0,"0",2)+wn(t%60,"0",2)}function iR(e,t){return wn(e.getUTCDate(),t,2)}function s2e(e,t){return wn(e.getUTCHours(),t,2)}function a2e(e,t){return wn(e.getUTCHours()%12||12,t,2)}function i2e(e,t){return wn(1+E2.count(od(e),e),t,3)}function qW(e,t){return wn(e.getUTCMilliseconds(),t,3)}function o2e(e,t){return qW(e,t)+"000"}function l2e(e,t){return wn(e.getUTCMonth()+1,t,2)}function c2e(e,t){return wn(e.getUTCMinutes(),t,2)}function u2e(e,t){return wn(e.getUTCSeconds(),t,2)}function d2e(e){var t=e.getUTCDay();return t===0?7:t}function f2e(e,t){return wn(A2.count(od(e)-1,e),t,2)}function YW(e){var t=e.getUTCDay();return t>=4||t===0?Fm(e):Fm.ceil(e)}function h2e(e,t){return e=YW(e),wn(Fm.count(od(e),e)+(od(e).getUTCDay()===4),t,2)}function g2e(e){return e.getUTCDay()}function m2e(e,t){return wn(vb.count(od(e)-1,e),t,2)}function p2e(e,t){return wn(e.getUTCFullYear()%100,t,2)}function x2e(e,t){return e=YW(e),wn(e.getUTCFullYear()%100,t,2)}function y2e(e,t){return wn(e.getUTCFullYear()%1e4,t,4)}function v2e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Fm(e):Fm.ceil(e),wn(e.getUTCFullYear()%1e4,t,4)}function w2e(){return"+0000"}function oR(){return"%"}function lR(e){return+e}function cR(e){return Math.floor(+e/1e3)}var Lg,XW,JW;_2e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function _2e(e){return Lg=_be(e),XW=Lg.format,Lg.parse,JW=Lg.utcFormat,Lg.utcParse,Lg}function b2e(e){return new Date(e)}function S2e(e){return e instanceof Date?+e:+new Date(+e)}function vA(e,t,r,n,s,a,i,o,c,u){var d=aA(),f=d.invert,g=d.domain,p=u(".%L"),x=u(":%S"),v=u("%I:%M"),w=u("%I %p"),C=u("%a %d"),k=u("%b %d"),_=u("%B"),N=u("%Y");function E(P){return(c(P)<P?p:o(P)<P?x:i(P)<P?v:a(P)<P?w:n(P)<P?s(P)<P?C:k:r(P)<P?_:N)(P)}return d.invert=function(P){return new Date(f(P))},d.domain=function(P){return arguments.length?g(Array.from(P,S2e)):g().map(b2e)},d.ticks=function(P){var F=g();return e(F[0],F[F.length-1],P??10)},d.tickFormat=function(P,F){return F==null?E:u(F)},d.nice=function(P){var F=g();return(!P||typeof P.range!="function")&&(P=t(F[0],F[F.length-1],P??10)),P?g(MW(F,P)):d},d.copy=function(){return n1(d,vA(e,t,r,n,s,a,i,o,c,u))},d}function k2e(){return Ml.apply(vA(vbe,wbe,id,xA,N2,s1,mA,hA,Mh,XW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function C2e(){return Ml.apply(vA(xbe,ybe,od,yA,A2,E2,pA,gA,Mh,JW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function j2(){var e=0,t=1,r,n,s,a,i=to,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:i(s===0?.5:(f=(a(f)-r)*s,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=a(e=+e),n=a(t=+t),s=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(i=f,u):i};function d(f){return function(g){var p,x;return arguments.length?([p,x]=g,i=f(p,x),u):[i(0),i(1)]}}return u.range=d(sp),u.rangeRound=d(sA),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return a=f,r=f(e),n=f(t),s=r===n?0:1/(n-r),u}}function Wf(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function QW(){var e=zf(j2()(to));return e.copy=function(){return Wf(e,QW())},md.apply(e,arguments)}function ZW(){var e=lA(j2()).domain([1,10]);return e.copy=function(){return Wf(e,ZW()).base(e.base())},md.apply(e,arguments)}function eH(){var e=cA(j2());return e.copy=function(){return Wf(e,eH()).constant(e.constant())},md.apply(e,arguments)}function wA(){var e=uA(j2());return e.copy=function(){return Wf(e,wA()).exponent(e.exponent())},md.apply(e,arguments)}function T2e(){return wA.apply(null,arguments).exponent(.5)}function tH(){var e=[],t=to;function r(n){if(n!=null&&!isNaN(n=+n))return t((t1(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(_f),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,a)=>d_e(e,a/n))},r.copy=function(){return tH(t).domain(e)},md.apply(r,arguments)}function P2(){var e=0,t=.5,r=1,n=1,s,a,i,o,c,u=to,d,f=!1,g;function p(v){return isNaN(v=+v)?g:(v=.5+((v=+d(v))-a)*(n*v<n*a?o:c),u(f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,s=d(e=+e),a=d(t=+t),i=d(r=+r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(u=v,p):u};function x(v){return function(w){var C,k,_;return arguments.length?([C,k,_]=w,u=L_e(v,[C,k,_]),p):[u(0),u(.5),u(1)]}}return p.range=x(sp),p.rangeRound=x(sA),p.unknown=function(v){return arguments.length?(g=v,p):g},function(v){return d=v,s=v(e),a=v(t),i=v(r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,p}}function rH(){var e=zf(P2()(to));return e.copy=function(){return Wf(e,rH())},md.apply(e,arguments)}function nH(){var e=lA(P2()).domain([.1,1,10]);return e.copy=function(){return Wf(e,nH()).base(e.base())},md.apply(e,arguments)}function sH(){var e=cA(P2());return e.copy=function(){return Wf(e,sH()).constant(e.constant())},md.apply(e,arguments)}function _A(){var e=uA(P2());return e.copy=function(){return Wf(e,_A()).exponent(e.exponent())},md.apply(e,arguments)}function E2e(){return _A.apply(null,arguments).exponent(.5)}const hy=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:tA,scaleDiverging:rH,scaleDivergingLog:nH,scaleDivergingPow:_A,scaleDivergingSqrt:E2e,scaleDivergingSymlog:sH,scaleIdentity:RW,scaleImplicit:KE,scaleLinear:IW,scaleLog:LW,scaleOrdinal:eA,scalePoint:g_e,scalePow:dA,scaleQuantile:UW,scaleQuantize:zW,scaleRadial:$W,scaleSequential:QW,scaleSequentialLog:ZW,scaleSequentialPow:wA,scaleSequentialQuantile:tH,scaleSequentialSqrt:T2e,scaleSequentialSymlog:eH,scaleSqrt:obe,scaleSymlog:BW,scaleThreshold:WW,scaleTime:k2e,scaleUtc:C2e,tickFormat:DW},Symbol.toStringTag,{value:"Module"}));var Hf=e=>e.chartData,N2e=bt([Hf],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),bA=(e,t,r,n)=>n?N2e(e):Hf(e);function Om(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(fc(t)&&fc(r))return!0}return!1}function uR(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function A2e(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,s,a;if(fc(r))s=r;else if(typeof r=="function")return;if(fc(n))a=n;else if(typeof n=="function")return;var i=[s,a];if(Om(i))return i}}function j2e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Om(n))return uR(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[s,a]=e,i,o;if(s==="auto")t!=null&&(i=Math.min(...t));else if($r(s))i=s;else if(typeof s=="function")try{t!=null&&(i=s(t?.[0]))}catch{}else if(typeof s=="string"&&rI.test(s)){var c=rI.exec(s);if(c==null||t==null)i=void 0;else{var u=+c[1];i=t[0]-u}}else i=t?.[0];if(a==="auto")t!=null&&(o=Math.max(...t));else if($r(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[1]))}catch{}else if(typeof a=="string"&&nI.test(a)){var d=nI.exec(a);if(d==null||t==null)o=void 0;else{var f=+d[1];o=t[1]+f}}else o=t?.[1];var g=[i,o];if(Om(g))return t==null?g:uR(g,t,r)}}}var ap=1e9,P2e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},kA,ms=!0,Fl="[DecimalError] ",Qh=Fl+"Invalid argument: ",SA=Fl+"Exponent out of range: ",ip=Math.floor,Nh=Math.pow,F2e=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Vo,Ra=1e7,rs=7,aH=9007199254740991,wb=ip(aH/rs),mr={};mr.absoluteValue=mr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};mr.comparedTo=mr.cmp=function(e){var t,r,n,s,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===s?0:n>s^a.s<0?1:-1};mr.decimalPlaces=mr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*rs;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};mr.dividedBy=mr.div=function(e){return Ju(this,new this.constructor(e))};mr.dividedToIntegerBy=mr.idiv=function(e){var t=this,r=t.constructor;return Vn(Ju(t,new r(e),0,1),r.precision)};mr.equals=mr.eq=function(e){return!this.cmp(e)};mr.exponent=function(){return ua(this)};mr.greaterThan=mr.gt=function(e){return this.cmp(e)>0};mr.greaterThanOrEqualTo=mr.gte=function(e){return this.cmp(e)>=0};mr.isInteger=mr.isint=function(){return this.e>this.d.length-2};mr.isNegative=mr.isneg=function(){return this.s<0};mr.isPositive=mr.ispos=function(){return this.s>0};mr.isZero=function(){return this.s===0};mr.lessThan=mr.lt=function(e){return this.cmp(e)<0};mr.lessThanOrEqualTo=mr.lte=function(e){return this.cmp(e)<1};mr.logarithm=mr.log=function(e){var t,r=this,n=r.constructor,s=n.precision,a=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Vo))throw Error(Fl+"NaN");if(r.s<1)throw Error(Fl+(r.s?"NaN":"-Infinity"));return r.eq(Vo)?new n(0):(ms=!1,t=Ju(wv(r,a),wv(e,a),a),ms=!0,Vn(t,s))};mr.minus=mr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?lH(t,e):iH(t,(e.s=-e.s,e))};mr.modulo=mr.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(Fl+"NaN");return r.s?(ms=!1,t=Ju(r,e,0,1).times(e),ms=!0,r.minus(t)):Vn(new n(r),s)};mr.naturalExponential=mr.exp=function(){return oH(this)};mr.naturalLogarithm=mr.ln=function(){return wv(this)};mr.negated=mr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};mr.plus=mr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?iH(t,e):lH(t,(e.s=-e.s,e))};mr.precision=mr.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Qh+e);if(t=ua(s)+1,n=s.d.length-1,r=n*rs+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};mr.squareRoot=mr.sqrt=function(){var e,t,r,n,s,a,i,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(Fl+"NaN")}for(e=ua(o),ms=!1,s=Math.sqrt(+o),s==0||s==1/0?(t=Gc(o.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=ip((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(s.toString()),r=c.precision,s=i=r+3;;)if(a=n,n=a.plus(Ju(o,a,i+2)).times(.5),Gc(a.d).slice(0,i)===(t=Gc(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(Vn(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;i+=4}return ms=!0,Vn(n,r)};mr.times=mr.mul=function(e){var t,r,n,s,a,i,o,c,u,d=this,f=d.constructor,g=d.d,p=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=g.length,u=p.length,c<u&&(a=g,g=p,p=a,i=c,c=u,u=i),a=[],i=c+u,n=i;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,s=c+n;s>n;)o=a[s]+p[n]*g[s-n-1]+t,a[s--]=o%Ra|0,t=o/Ra|0;a[s]=(a[s]+t)%Ra|0}for(;!a[--i];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,ms?Vn(e,f.precision):e};mr.toDecimalPlaces=mr.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(eu(e,0,ap),t===void 0?t=n.rounding:eu(t,0,8),Vn(r,e+ua(r)+1,t))};mr.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=_0(n,!0):(eu(e,0,ap),t===void 0?t=s.rounding:eu(t,0,8),n=Vn(new s(n),e+1,t),r=_0(n,!0,e+1)),r};mr.toFixed=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?_0(s):(eu(e,0,ap),t===void 0?t=a.rounding:eu(t,0,8),n=Vn(new a(s),e+ua(s)+1,t),r=_0(n.abs(),!1,e+ua(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};mr.toInteger=mr.toint=function(){var e=this,t=e.constructor;return Vn(new t(e),ua(e)+1,t.rounding)};mr.toNumber=function(){return+this};mr.toPower=mr.pow=function(e){var t,r,n,s,a,i,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Vo);if(o=new c(o),!o.s){if(e.s<1)throw Error(Fl+"Infinity");return o}if(o.eq(Vo))return o;if(n=c.precision,e.eq(Vo))return Vn(o,n);if(t=e.e,r=e.d.length-1,i=t>=r,a=o.s,i){if((r=d<0?-d:d)<=aH){for(s=new c(Vo),t=Math.ceil(n/rs+4),ms=!1;r%2&&(s=s.times(o),fR(s.d,t)),r=ip(r/2),r!==0;)o=o.times(o),fR(o.d,t);return ms=!0,e.s<0?new c(Vo).div(s):Vn(s,n)}}else if(a<0)throw Error(Fl+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,ms=!1,s=e.times(wv(o,n+u)),ms=!0,s=oH(s),s.s=a,s};mr.toPrecision=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?(r=ua(s),n=_0(s,r<=a.toExpNeg||r>=a.toExpPos)):(eu(e,1,ap),t===void 0?t=a.rounding:eu(t,0,8),s=Vn(new a(s),e,t),r=ua(s),n=_0(s,e<=r||r<=a.toExpNeg,e)),n};mr.toSignificantDigits=mr.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(eu(e,1,ap),t===void 0?t=n.rounding:eu(t,0,8)),Vn(new n(r),e,t)};mr.toString=mr.valueOf=mr.val=mr.toJSON=mr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=ua(e),r=e.constructor;return _0(e,t<=r.toExpNeg||t>=r.toExpPos)};function iH(e,t){var r,n,s,a,i,o,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),ms?Vn(t,f):t;if(c=e.d,u=t.d,i=e.e,s=t.e,c=c.slice(),a=i-s,a){for(a<0?(n=c,a=-a,o=u.length):(n=u,s=i,o=c.length),i=Math.ceil(f/rs),o=i>o?i+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=u.length,o-a<0&&(a=o,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/Ra|0,c[a]%=Ra;for(r&&(c.unshift(r),++s),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=s,ms?Vn(t,f):t}function eu(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Qh+e)}function Gc(e){var t,r,n,s=e.length-1,a="",i=e[0];if(s>0){for(a+=i,t=1;t<s;t++)n=e[t]+"",r=rs-n.length,r&&(a+=of(r)),a+=n;i=e[t],n=i+"",r=rs-n.length,r&&(a+=of(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var Ju=(function(){function e(n,s){var a,i=0,o=n.length;for(n=n.slice();o--;)a=n[o]*s+i,n[o]=a%Ra|0,i=a/Ra|0;return i&&n.unshift(i),n}function t(n,s,a,i){var o,c;if(a!=i)c=a>i?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=s[o]){c=n[o]>s[o]?1:-1;break}return c}function r(n,s,a){for(var i=0;a--;)n[a]-=i,i=n[a]<s[a]?1:0,n[a]=i*Ra+n[a]-s[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,a,i){var o,c,u,d,f,g,p,x,v,w,C,k,_,N,E,P,F,A,j=n.constructor,I=n.s==s.s?1:-1,L=n.d,Y=s.d;if(!n.s)return new j(n);if(!s.s)throw Error(Fl+"Division by zero");for(c=n.e-s.e,F=Y.length,E=L.length,p=new j(I),x=p.d=[],u=0;Y[u]==(L[u]||0);)++u;if(Y[u]>(L[u]||0)&&--c,a==null?k=a=j.precision:i?k=a+(ua(n)-ua(s))+1:k=a,k<0)return new j(0);if(k=k/rs+2|0,u=0,F==1)for(d=0,Y=Y[0],k++;(u<E||d)&&k--;u++)_=d*Ra+(L[u]||0),x[u]=_/Y|0,d=_%Y|0;else{for(d=Ra/(Y[0]+1)|0,d>1&&(Y=e(Y,d),L=e(L,d),F=Y.length,E=L.length),N=F,v=L.slice(0,F),w=v.length;w<F;)v[w++]=0;A=Y.slice(),A.unshift(0),P=Y[0],Y[1]>=Ra/2&&++P;do d=0,o=t(Y,v,F,w),o<0?(C=v[0],F!=w&&(C=C*Ra+(v[1]||0)),d=C/P|0,d>1?(d>=Ra&&(d=Ra-1),f=e(Y,d),g=f.length,w=v.length,o=t(f,v,g,w),o==1&&(d--,r(f,F<g?A:Y,g))):(d==0&&(o=d=1),f=Y.slice()),g=f.length,g<w&&f.unshift(0),r(v,f,w),o==-1&&(w=v.length,o=t(Y,v,F,w),o<1&&(d++,r(v,F<w?A:Y,w))),w=v.length):o===0&&(d++,v=[0]),x[u++]=d,o&&v[0]?v[w++]=L[N]||0:(v=[L[N]],w=1);while((N++<E||v[0]!==void 0)&&k--)}return x[0]||x.shift(),p.e=c,Vn(p,i?a+ua(p)+1:a)}})();function oH(e,t){var r,n,s,a,i,o,c=0,u=0,d=e.constructor,f=d.precision;if(ua(e)>16)throw Error(SA+ua(e));if(!e.s)return new d(Vo);for(ms=!1,o=f,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(Nh(2,u))/Math.LN10*2+5|0,o+=n,r=s=a=new d(Vo),d.precision=o;;){if(s=Vn(s.times(e),o),r=r.times(++c),i=a.plus(Ju(s,r,o)),Gc(i.d).slice(0,o)===Gc(a.d).slice(0,o)){for(;u--;)a=Vn(a.times(a),o);return d.precision=f,t==null?(ms=!0,Vn(a,f)):a}a=i}}function ua(e){for(var t=e.e*rs,r=e.d[0];r>=10;r/=10)t++;return t}function HC(e,t,r){if(t>e.LN10.sd())throw ms=!0,r&&(e.precision=r),Error(Fl+"LN10 precision limit exceeded");return Vn(new e(e.LN10),t)}function of(e){for(var t="";e--;)t+="0";return t}function wv(e,t){var r,n,s,a,i,o,c,u,d,f=1,g=10,p=e,x=p.d,v=p.constructor,w=v.precision;if(p.s<1)throw Error(Fl+(p.s?"NaN":"-Infinity"));if(p.eq(Vo))return new v(0);if(t==null?(ms=!1,u=w):u=t,p.eq(10))return t==null&&(ms=!0),HC(v,u);if(u+=g,v.precision=u,r=Gc(x),n=r.charAt(0),a=ua(p),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)p=p.times(e),r=Gc(p.d),n=r.charAt(0),f++;a=ua(p),n>1?(p=new v("0."+r),a++):p=new v(n+"."+r.slice(1))}else return c=HC(v,u+2,w).times(a+""),p=wv(new v(n+"."+r.slice(1)),u-g).plus(c),v.precision=w,t==null?(ms=!0,Vn(p,w)):p;for(o=i=p=Ju(p.minus(Vo),p.plus(Vo),u),d=Vn(p.times(p),u),s=3;;){if(i=Vn(i.times(d),u),c=o.plus(Ju(i,new v(s),u)),Gc(c.d).slice(0,u)===Gc(o.d).slice(0,u))return o=o.times(2),a!==0&&(o=o.plus(HC(v,u+2,w).times(a+""))),o=Ju(o,new v(f),u),v.precision=w,t==null?(ms=!0,Vn(o,w)):o;o=c,s+=2}}function dR(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=ip(r/rs),e.d=[],n=(r+1)%rs,r<0&&(n+=rs),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=rs;n<s;)e.d.push(+t.slice(n,n+=rs));t=t.slice(n),n=rs-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),ms&&(e.e>wb||e.e<-wb))throw Error(SA+r)}else e.s=0,e.e=0,e.d=[0];return e}function Vn(e,t,r){var n,s,a,i,o,c,u,d,f=e.d;for(i=1,a=f[0];a>=10;a/=10)i++;if(n=t-i,n<0)n+=rs,s=t,u=f[d=0];else{if(d=Math.ceil((n+1)/rs),a=f.length,d>=a)return e;for(u=a=f[d],i=1;a>=10;a/=10)i++;n%=rs,s=n-rs+i}if(r!==void 0&&(a=Nh(10,i-s-1),o=u/a%10|0,c=t<0||f[d+1]!==void 0||u%a,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?s>0?u/Nh(10,i-s):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(a=ua(e),f.length=1,t=t-a-1,f[0]=Nh(10,(rs-t%rs)%rs),e.e=ip(-t/rs)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,a=1,d--):(f.length=d+1,a=Nh(10,rs-n),f[d]=s>0?(u/Nh(10,i-s)%Nh(10,s)|0)*a:0),c)for(;;)if(d==0){(f[0]+=a)==Ra&&(f[0]=1,++e.e);break}else{if(f[d]+=a,f[d]!=Ra)break;f[d--]=0,a=1}for(n=f.length;f[--n]===0;)f.pop();if(ms&&(e.e>wb||e.e<-wb))throw Error(SA+ua(e));return e}function lH(e,t){var r,n,s,a,i,o,c,u,d,f,g=e.constructor,p=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),ms?Vn(t,p):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),i=u-n,i){for(d=i<0,d?(r=c,i=-i,o=f.length):(r=f,n=u,o=c.length),s=Math.max(Math.ceil(p/rs),o)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=c.length,o=f.length,d=s<o,d&&(o=s),s=0;s<o;s++)if(c[s]!=f[s]){d=c[s]<f[s];break}i=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),o=c.length,s=f.length-o;s>0;--s)c[o++]=0;for(s=f.length;s>i;){if(c[--s]<f[s]){for(a=s;a&&c[--a]===0;)c[a]=Ra-1;--c[a],c[s]+=Ra}c[s]-=f[s]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,ms?Vn(t,p):t):new g(0)}function _0(e,t,r){var n,s=ua(e),a=Gc(e.d),i=a.length;return t?(r&&(n=r-i)>0?a=a.charAt(0)+"."+a.slice(1)+of(n):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(s<0?"e":"e+")+s):s<0?(a="0."+of(-s-1)+a,r&&(n=r-i)>0&&(a+=of(n))):s>=i?(a+=of(s+1-i),r&&(n=r-s-1)>0&&(a=a+"."+of(n))):((n=s+1)<i&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(a+="."),a+=of(n))),e.s<0?"-"+a:a}function fR(e,t){if(e.length>t)return e.length=t,!0}function cH(e){var t,r,n;function s(a){var i=this;if(!(i instanceof s))return new s(a);if(i.constructor=s,a instanceof s){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Qh+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return dR(i,a.toString())}else if(typeof a!="string")throw Error(Qh+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,F2e.test(a))dR(i,a);else throw Error(Qh+a)}if(s.prototype=mr,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=cH,s.config=s.set=O2e,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function O2e(e){if(!e||typeof e!="object")throw Error(Fl+"Object expected");var t,r,n,s=["precision",1,ap,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(ip(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(Qh+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Qh+r+": "+n);return this}var kA=cH(P2e);Vo=new kA(1);const In=kA;var D2e=e=>e,uH={},dH=e=>e===uH,hR=e=>function t(){return arguments.length===0||arguments.length===1&&dH(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},fH=(e,t)=>e===1?t:hR(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var a=n.filter(i=>i!==uH).length;return a>=e?t(...n):fH(e-a,hR(function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];var u=n.map(d=>dH(d)?o.shift():d);return t(...u,...o)}))}),F2=e=>fH(e.length,e),JE=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},I2e=F2((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),R2e=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return D2e;var s=r.reverse(),a=s[0],i=s.slice(1);return function(){return i.reduce((o,c)=>c(o),a(...arguments))}},QE=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),hH=e=>{var t=null,r=null;return function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t&&s.every((i,o)=>{var c;return i===((c=t)===null||c===void 0?void 0:c[o])})||(t=s,r=e(...s)),r}};function gH(e){var t;return e===0?t=1:t=Math.floor(new In(e).abs().log(10).toNumber())+1,t}function mH(e,t,r){for(var n=new In(e),s=0,a=[];n.lt(t)&&s<1e5;)a.push(n.toNumber()),n=n.add(r),s++;return a}F2((e,t,r)=>{var n=+e,s=+t;return n+r*(s-n)});F2((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});F2((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var pH=e=>{var[t,r]=e,[n,s]=[t,r];return t>r&&([n,s]=[r,t]),[n,s]},xH=(e,t,r)=>{if(e.lte(0))return new In(0);var n=gH(e.toNumber()),s=new In(10).pow(n),a=e.div(s),i=n!==1?.05:.1,o=new In(Math.ceil(a.div(i).toNumber())).add(r).mul(i),c=o.mul(s);return t?new In(c.toNumber()):new In(Math.ceil(c.toNumber()))},M2e=(e,t,r)=>{var n=new In(1),s=new In(e);if(!s.isint()&&r){var a=Math.abs(e);a<1?(n=new In(10).pow(gH(e)-1),s=new In(Math.floor(s.div(n).toNumber())).mul(n)):a>1&&(s=new In(Math.floor(e)))}else e===0?s=new In(Math.floor((t-1)/2)):r||(s=new In(Math.floor(e)));var i=Math.floor((t-1)/2),o=R2e(I2e(c=>s.add(new In(c-i).mul(n)).toNumber()),JE);return o(0,t)},yH=function(t,r,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new In(0),tickMin:new In(0),tickMax:new In(0)};var i=xH(new In(r).sub(t).div(n-1),s,a),o;t<=0&&r>=0?o=new In(0):(o=new In(t).add(r).div(2),o=o.sub(new In(o).mod(i)));var c=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new In(r).sub(o).div(i).toNumber()),d=c+u+1;return d>n?yH(t,r,n,s,a+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:i,tickMin:o.sub(new In(c).mul(i)),tickMax:o.add(new In(u).mul(i))})};function L2e(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[i,o]=pH([t,r]);if(i===-1/0||o===1/0){var c=o===1/0?[i,...JE(0,n-1).map(()=>1/0)]:[...JE(0,n-1).map(()=>-1/0),o];return t>r?QE(c):c}if(i===o)return M2e(i,n,s);var{step:u,tickMin:d,tickMax:f}=yH(i,o,a,s,0),g=mH(d,f.add(new In(.1).mul(u)),u);return t>r?QE(g):g}function B2e(e,t){var[r,n]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=pH([r,n]);if(a===-1/0||i===1/0)return[r,n];if(a===i)return[a];var o=Math.max(t,2),c=xH(new In(i).sub(a).div(o-1),s,0),u=[...mH(new In(a),new In(i),c),i];return s===!1&&(u=u.map(d=>Math.round(d))),r>n?QE(u):u}var $2e=hH(L2e),U2e=hH(B2e),z2e=e=>e.rootProps.barCategoryGap,O2=e=>e.rootProps.stackOffset,CA=e=>e.options.chartName,TA=e=>e.rootProps.syncId,vH=e=>e.rootProps.syncMethod,EA=e=>e.options.eventEmitter,$u={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Bo={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},D2=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},W2e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:$u.angleAxisId,includeHidden:!1,name:void 0,reversed:$u.reversed,scale:$u.scale,tick:$u.tick,tickCount:void 0,ticks:void 0,type:$u.type,unit:void 0},H2e={allowDataOverflow:Bo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Bo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Bo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Bo.scale,tick:Bo.tick,tickCount:Bo.tickCount,ticks:void 0,type:Bo.type,unit:void 0},G2e={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:$u.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$u.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$u.scale,tick:$u.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},V2e={allowDataOverflow:Bo.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Bo.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Bo.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Bo.scale,tick:Bo.tick,tickCount:Bo.tickCount,ticks:void 0,type:"category",unit:void 0},NA=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?G2e:W2e,AA=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?V2e:H2e,I2=e=>e.polarOptions,jA=bt([hd,gd,mi],Zve),wH=bt([I2,jA],(e,t)=>{if(e!=null)return jf(e.innerRadius,t,0)}),_H=bt([I2,jA],(e,t)=>{if(e!=null)return jf(e.outerRadius,t,t*.8)}),K2e=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},bH=bt([I2],K2e);bt([NA,bH],D2);var SH=bt([jA,wH,_H],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});bt([AA,SH],D2);var kH=bt([us,I2,wH,_H,hd,gd],(e,t,r,n,s,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:o,startAngle:c,endAngle:u}=t;return{cx:jf(i,s,s/2),cy:jf(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),da=(e,t)=>t,R2=(e,t,r)=>r;function CH(e){return e?.id}var Ta=e=>{var t=us(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},op=e=>e.tooltip.settings.axisId,Ga=e=>{var t=Ta(e),r=op(e);return a1(e,t,r)},TH=bt([Ga],e=>e?.dataKey);function EH(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:s,dataKey:a}=r,i=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=CH(o);u.forEach((f,g)=>{var p=a==null||s?g:String(so(f,a,null)),x=so(f,o.dataKey,0),v;i.has(p)?v=i.get(p):v={},Object.assign(v,{[d]:x}),i.set(p,v)})}}),Array.from(i.values())}function PA(e){return e.stackId!=null&&e.dataKey!=null}function gR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _b(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gR(Object(r),!0).forEach(function(n){q2e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function q2e(e,t,r){return(t=Y2e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2e(e){var t=X2e(e,"string");return typeof t=="symbol"?t:t+""}function X2e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZE=[0,"auto"],Mo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},NH=(e,t)=>e.cartesianAxis.xAxis[t],pd=(e,t)=>{var r=NH(e,t);return r??Mo},Lo={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ZE,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:e1},AH=(e,t)=>e.cartesianAxis.yAxis[t],xd=(e,t)=>{var r=AH(e,t);return r??Lo},J2e={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},FA=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??J2e},No=(e,t,r)=>{switch(t){case"xAxis":return pd(e,r);case"yAxis":return xd(e,r);case"zAxis":return FA(e,r);case"angleAxis":return NA(e,r);case"radiusAxis":return AA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Q2e=(e,t,r)=>{switch(t){case"xAxis":return pd(e,r);case"yAxis":return xd(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},a1=(e,t,r)=>{switch(t){case"xAxis":return pd(e,r);case"yAxis":return xd(e,r);case"angleAxis":return NA(e,r);case"radiusAxis":return AA(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},jH=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function PH(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var FH=e=>e.graphicalItems.cartesianItems,Z2e=bt([da,R2],PH),OH=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),i1=bt([FH,No,Z2e],OH),DH=bt([i1],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(PA)),IH=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),RH=bt([i1],IH),MH=e=>e.map(t=>t.data).filter(Boolean).flat(1),eSe=bt([i1],MH),LH=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:s}=t;return e.length>0?e:r.slice(n,s+1)},OA=bt([eSe,bA],LH),BH=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:so(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(s=>({value:so(s,n)}))):e.map(n=>({value:n})),M2=bt([OA,No,i1],BH);function $H(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function L0(e){return e.filter(t=>Zc(t)||t instanceof Date).map(Number).filter(t=>jl(t)===!1)}function tSe(e,t,r){return!r||typeof t!="number"||jl(t)?[]:r.length?L0(r.flatMap(n=>{var s=so(e,n.dataKey),a,i;if(Array.isArray(s)?[a,i]=s:a=i=s,!(!fc(a)||!fc(i)))return[t-a,t+i]})):[]}var rSe=bt([DH,bA,Ga],EH),UH=(e,t,r)=>{var n={},s=t.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),n);return Object.fromEntries(Object.entries(s).map(a=>{var[i,o]=a,c=o.map(CH);return[i,{stackedData:g1e(e,c,r),graphicalItems:o}]}))},nSe=bt([rSe,DH,O2],UH),zH=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:s}=t;if(r!=="zAxis"){var a=x1e(e,n,s);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},sSe=bt([nSe,Hf,da],zH),WH=(e,t,r,n,s)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var o,c,u=(o=n[i.id])===null||o===void 0?void 0:o.filter(f=>$H(s,f)),d=so(a,(c=t.dataKey)!==null&&c!==void 0?c:i.dataKey);return{value:d,errorDomain:tSe(a,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:so(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),L2=e=>e.errorBars,HH=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>$H(r,n));bt([RH,L2,da],HH);var aSe=bt([OA,No,RH,L2,da],WH);function iSe(e){var{value:t}=e;if(Zc(t)||t instanceof Date)return t}var mR=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=L0(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},oSe=(e,t,r)=>{var n=e.map(iSe).filter(s=>s!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&sz(n))?kW(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},DA=e=>{var t;if(e==null||!("domain"in e))return ZE;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=L0(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:ZE},bb=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r.filter(Boolean);if(s.length!==0){var a=s.flat(),i=Math.min(...a),o=Math.max(...a);return[i,o]}},GH=e=>e.referenceElements.dots,lp=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),lSe=bt([GH,da,R2],lp),VH=e=>e.referenceElements.areas,cSe=bt([VH,da,R2],lp),KH=e=>e.referenceElements.lines,uSe=bt([KH,da,R2],lp),qH=(e,t)=>{var r=L0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},dSe=bt(lSe,da,qH),YH=(e,t)=>{var r=L0(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},fSe=bt([cSe,da],YH),XH=(e,t)=>{var r=L0(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},hSe=bt(uSe,da,XH),gSe=bt(dSe,hSe,fSe,(e,t,r)=>bb(e,r,t)),mSe=bt([No],DA),JH=(e,t,r,n,s,a,i)=>{var o=A2e(t,e.allowDataOverflow);if(o!=null)return o;var c=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",u=c?bb(r,s,mR(n)):bb(s,mR(n));return j2e(t,u,e.allowDataOverflow)},pSe=bt([No,mSe,sSe,aSe,gSe,us,da],JH),xSe=[0,1],QH=(e,t,r,n,s,a,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:o,type:c}=e,u=Uf(t,a);return u&&o==null?kW(0,r.length):c==="category"?oSe(n,e,u):s==="expand"?xSe:i}},IA=bt([No,us,OA,M2,O2,da,pSe],QH),ZH=(e,t,r,n,s)=>{if(e!=null){var{scale:a,type:i}=e;if(a==="auto")return t==="radial"&&s==="radiusAxis"?"band":t==="radial"&&s==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(B3(a));return o in hy?o:"point"}}},o1=bt([No,us,jH,CA,da],ZH);function ySe(e){if(e!=null){if(e in hy)return hy[e]();var t="scale".concat(B3(e));if(t in hy)return hy[t]()}}function RA(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var s=ySe(t);if(s!=null){var a=s.domain(r).range(n);return u1e(a),a}}}var eG=(e,t,r)=>{var n=DA(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Om(e))return $2e(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Om(e))return U2e(e,t.tickCount,t.allowDecimals)}},MA=bt([IA,a1,o1],eG),tG=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&Om(t)&&Array.isArray(r)&&r.length>0){var s=t[0],a=r[0],i=t[1],o=r[r.length-1];return[Math.min(s,a),Math.max(i,o)]}return t},vSe=bt([No,IA,MA,da],tG),wSe=bt(M2,No,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(L0(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var s=n[n.length-1]-n[0];if(s===0)return 1/0;for(var a=0;a<n.length-1;a++){var i=n[a+1]-n[a];r=Math.min(r,i)}return r/s}}),rG=bt(wSe,us,z2e,mi,(e,t,r,n)=>n,(e,t,r,n,s)=>{if(!fc(e))return 0;var a=t==="vertical"?n.height:n.width;if(s==="gap")return e*a/2;if(s==="no-gap"){var i=jf(r,e*a),o=e*a/2;return o-i-(o-i)/a*i}return 0}),_Se=(e,t)=>{var r=pd(e,t);return r==null||typeof r.padding!="string"?0:rG(e,"xAxis",t,r.padding)},bSe=(e,t)=>{var r=xd(e,t);return r==null||typeof r.padding!="string"?0:rG(e,"yAxis",t,r.padding)},SSe=bt(pd,_Se,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:s}=e;return typeof s=="string"?{left:t,right:t}:{left:((r=s.left)!==null&&r!==void 0?r:0)+t,right:((n=s.right)!==null&&n!==void 0?n:0)+t}}),kSe=bt(xd,bSe,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:s}=e;return typeof s=="string"?{top:t,bottom:t}:{top:((r=s.top)!==null&&r!==void 0?r:0)+t,bottom:((n=s.bottom)!==null&&n!==void 0?n:0)+t}}),CSe=bt([mi,SSe,C2,k2,(e,t,r)=>r],(e,t,r,n,s)=>{var{padding:a}=n;return s?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),TSe=bt([mi,us,kSe,C2,k2,(e,t,r)=>r],(e,t,r,n,s,a)=>{var{padding:i}=s;return a?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),l1=(e,t,r,n)=>{var s;switch(t){case"xAxis":return CSe(e,r,n);case"yAxis":return TSe(e,r,n);case"zAxis":return(s=FA(e,r))===null||s===void 0?void 0:s.range;case"angleAxis":return bH(e);case"radiusAxis":return SH(e,r);default:return}},nG=bt([No,l1],D2),cp=bt([No,o1,vSe,nG],RA);bt([i1,L2,da],HH);function sG(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var B2=(e,t)=>t,$2=(e,t,r)=>r,ESe=bt(b2,B2,$2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(sG)),NSe=bt(S2,B2,$2,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(sG)),aG=(e,t)=>({width:e.width,height:t.height}),ASe=(e,t)=>{var r=typeof t.width=="number"?t.width:e1;return{width:r,height:e.height}},jSe=bt(mi,pd,aG),PSe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},FSe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},OSe=bt(gd,mi,ESe,B2,$2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=aG(t,o);i==null&&(i=PSe(t,n,e));var u=n==="top"&&!s||n==="bottom"&&s;a[o.id]=i-Number(u)*c.height,i+=(u?-1:1)*c.height}),a}),DSe=bt(hd,mi,NSe,B2,$2,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=ASe(t,o);i==null&&(i=FSe(t,n,e));var u=n==="left"&&!s||n==="right"&&s;a[o.id]=i-Number(u)*c.width,i+=(u?-1:1)*c.width}),a}),ISe=(e,t)=>{var r=pd(e,t);if(r!=null)return OSe(e,r.orientation,r.mirror)},RSe=bt([mi,pd,ISe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:e.left,y:0}:{x:e.left,y:s}}}),MSe=(e,t)=>{var r=xd(e,t);if(r!=null)return DSe(e,r.orientation,r.mirror)},LSe=bt([mi,xd,MSe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:0,y:e.top}:{x:s,y:e.top}}}),BSe=bt(mi,xd,(e,t)=>{var r=typeof t.width=="number"?t.width:e1;return{width:r,height:e.height}}),iG=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:s,type:a,dataKey:i}=r,o=Uf(e,n),c=t.map(u=>u.value);if(i&&o&&a==="category"&&s&&sz(c))return c}},LA=bt([us,M2,No,da],iG),oG=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:s,scale:a}=r,i=Uf(e,n);if(i&&(s==="number"||a!=="auto"))return t.map(o=>o.value)}},BA=bt([us,M2,a1,da],oG),pR=bt([us,Q2e,o1,cp,LA,BA,l1,MA,da],(e,t,r,n,s,a,i,o,c)=>{if(t==null)return null;var u=Uf(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:a,duplicateDomain:s,isCategorical:u,niceTicks:o,range:i,realScaleType:r,scale:n}}),$Se=(e,t,r,n,s,a,i,o,c)=>{if(!(t==null||n==null)){var u=Uf(e,c),{type:d,ticks:f,tickCount:g}=t,p=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=d==="category"&&n.bandwidth?n.bandwidth()/p:0;x=c==="angleAxis"&&a!=null&&a.length>=2?Sl(a[0]-a[1])*2*x:x;var v=f||s;if(v){var w=v.map((C,k)=>{var _=i?i.indexOf(C):C;return{index:k,coordinate:n(_)+x,value:C,offset:x}});return w.filter(C=>!jl(C.coordinate))}return u&&o?o.map((C,k)=>({coordinate:n(C)+x,value:C,index:k,offset:x})):n.ticks?n.ticks(g).map(C=>({coordinate:n(C)+x,value:C,offset:x})):n.domain().map((C,k)=>({coordinate:n(C)+x,value:i?i[C]:C,index:k,offset:x}))}},lG=bt([us,a1,o1,cp,MA,l1,LA,BA,da],$Se),USe=(e,t,r,n,s,a,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Uf(e,i),{tickCount:c}=t,u=0;return u=i==="angleAxis"&&n?.length>=2?Sl(n[0]-n[1])*2*u:u,o&&a?a.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:s?s[d]:d,index:f,offset:u}))}},cG=bt([us,a1,cp,l1,LA,BA,da],USe),uG=bt(No,cp,(e,t)=>{if(!(e==null||t==null))return _b(_b({},e),{},{scale:t})}),zSe=bt([No,o1,IA,nG],RA);bt((e,t,r)=>FA(e,r),zSe,(e,t)=>{if(!(e==null||t==null))return _b(_b({},e),{},{scale:t})});var WSe=bt([us,b2,S2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),dG=e=>e.options.defaultTooltipEventType,fG=e=>e.options.validateTooltipEventTypes;function hG(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function $A(e,t){var r=dG(e),n=fG(e);return hG(t,r,n)}function HSe(e){return Pr(t=>$A(t,e))}var gG=(e,t)=>{var r,n=Number(t);if(!(jl(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},GSe=e=>e.tooltip.settings,cf={active:!1,index:null,dataKey:void 0,coordinate:void 0},VSe={itemInteraction:{click:cf,hover:cf},axisInteraction:{click:cf,hover:cf},keyboardInteraction:cf,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},mG=Qo({name:"tooltip",initialState:VSe,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Xu(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:KSe,removeTooltipEntrySettings:qSe,setTooltipSettingsState:YSe,setActiveMouseOverItemIndex:XSe,mouseLeaveItem:z3e,mouseLeaveChart:pG,setActiveClickItemIndex:W3e,setMouseOverAxisIndex:xG,setMouseClickAxisIndex:JSe,setSyncInteraction:eN,setKeyboardInteraction:tN}=mG.actions,QSe=mG.reducer;function xR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xR(Object(r),!0).forEach(function(n){ZSe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZSe(e,t,r){return(t=eke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eke(e){var t=tke(e,"string");return typeof t=="symbol"?t:t+""}function tke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rke(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function nke(e){return e.index!=null}var yG=(e,t,r,n)=>{if(t==null)return cf;var s=rke(e,t,r);if(s==null)return cf;if(s.active)return s;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(nke(s)){if(a)return qw(qw({},s),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return qw(qw({},cf),{},{coordinate:s.coordinate})},UA=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!fc(n))return r;var s=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(s,Math.min(n,a)))},vG=(e,t,r,n,s,a,i,o)=>{if(!(a==null||o==null)){var c=i[0],u=c==null?void 0:o(c.positions,a);if(u!=null)return u;var d=s?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},wG=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var s;return r==="hover"?s=e.itemInteraction.hover.dataKey:s=e.itemInteraction.click.dataKey,s==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===s})},c1=e=>e.options.tooltipPayloadSearcher,up=e=>e.tooltip;function yR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function vR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yR(Object(r),!0).forEach(function(n){ske(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ske(e,t,r){return(t=ake(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ake(e){var t=ike(e,"string");return typeof t=="symbol"?t:t+""}function ike(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oke(e,t){return e??t}var _G=(e,t,r,n,s,a,i)=>{if(!(t==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((g,p)=>{var x,{dataDefinedOnItem:v,settings:w}=p,C=oke(v,o),k=Array.isArray(C)?aW(C,u,d):C,_=(x=w?.dataKey)!==null&&x!==void 0?x:n,N=w?.nameKey,E;if(n&&Array.isArray(k)&&!Array.isArray(k[0])&&i==="axis"?E=az(k,n,s):E=a(k,t,c,N),Array.isArray(E))E.forEach(F=>{var A=vR(vR({},w),{},{name:F.name,unit:F.unit,color:void 0,fill:void 0});g.push(sI({tooltipEntrySettings:A,dataKey:F.dataKey,payload:F.payload,value:so(F.payload,F.dataKey),name:F.name}))});else{var P;g.push(sI({tooltipEntrySettings:w,dataKey:_,payload:E,value:so(E,_),name:(P=so(E,N))!==null&&P!==void 0?P:w?.name}))}return g},f)}},zA=bt([Ga,us,jH,CA,Ta],ZH),lke=bt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),cke=bt([Ta,op],PH),u1=bt([lke,Ga,cke],OH),uke=bt([u1],e=>e.filter(PA)),dke=bt([u1],MH),dp=bt([dke,Hf],LH),fke=bt([uke,Hf,Ga],EH),WA=bt([dp,Ga,u1],BH),hke=bt([Ga],DA),gke=bt([u1],e=>e.filter(PA)),mke=bt([fke,gke,O2],UH),pke=bt([mke,Hf,Ta],zH),xke=bt([u1],IH),yke=bt([dp,Ga,xke,L2,Ta],WH),vke=bt([GH,Ta,op],lp),wke=bt([vke,Ta],qH),_ke=bt([VH,Ta,op],lp),bke=bt([_ke,Ta],YH),Ske=bt([KH,Ta,op],lp),kke=bt([Ske,Ta],XH),Cke=bt([wke,kke,bke],bb),Tke=bt([Ga,hke,pke,yke,Cke,us,Ta],JH),bG=bt([Ga,us,dp,WA,O2,Ta,Tke],QH),Eke=bt([bG,Ga,zA],eG),Nke=bt([Ga,bG,Eke,Ta],tG),SG=e=>{var t=Ta(e),r=op(e),n=!1;return l1(e,t,r,n)},kG=bt([Ga,SG],D2),CG=bt([Ga,zA,Nke,kG],RA),Ake=bt([us,WA,Ga,Ta],iG),jke=bt([us,WA,Ga,Ta],oG),Pke=(e,t,r,n,s,a,i,o)=>{if(t){var{type:c}=t,u=Uf(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=o==="angleAxis"&&s!=null&&s?.length>=2?Sl(s[0]-s[1])*2*f:f,u&&i?i.map((g,p)=>({coordinate:n(g)+f,value:g,index:p,offset:f})):n.domain().map((g,p)=>({coordinate:n(g)+f,value:a?a[g]:g,index:p,offset:f}))}}},yd=bt([us,Ga,zA,CG,SG,Ake,jke,Ta],Pke),HA=bt([dG,fG,GSe],(e,t,r)=>hG(r.shared,e,t)),TG=e=>e.tooltip.settings.trigger,GA=e=>e.tooltip.settings.defaultIndex,U2=bt([up,HA,TG,GA],yG),_v=bt([U2,dp],UA),EG=bt([yd,_v],gG),Fke=bt([U2],e=>{if(e)return e.dataKey}),NG=bt([up,HA,TG,GA],wG),Oke=bt([hd,gd,us,mi,yd,GA,NG,c1],vG),Dke=bt([U2,Oke],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Ike=bt([U2],e=>e.active),Rke=bt([NG,_v,Hf,TH,EG,c1,HA],_G),Mke=bt([Rke],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function wR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _R(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wR(Object(r),!0).forEach(function(n){Lke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lke(e,t,r){return(t=Bke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bke(e){var t=$ke(e,"string");return typeof t=="symbol"?t:t+""}function $ke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Uke=()=>Pr(Ga),zke=()=>{var e=Uke(),t=Pr(yd),r=Pr(CG);return ME(_R(_R({},e),{},{scale:r}),t)},Wke=()=>Pr(CA),VA=(e,t)=>t,AG=(e,t,r)=>r,KA=(e,t,r,n)=>n,Hke=bt(yd,e=>p2(e,t=>t.coordinate)),qA=bt([up,VA,AG,KA],yG),jG=bt([qA,dp],UA),Gke=(e,t,r)=>{if(t!=null){var n=up(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},PG=bt([up,VA,AG,KA],wG),Sb=bt([hd,gd,us,mi,yd,KA,PG,c1],vG),Vke=bt([qA,Sb],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),FG=bt(yd,jG,gG),Kke=bt([PG,jG,Hf,TH,FG,c1,VA],_G),qke=bt([qA],e=>({isActive:e.active,activeIndex:e.index})),Yke=(e,t,r,n,s,a,i,o)=>{if(!(!e||!t||!n||!s||!a)){var c=y1e(e.chartX,e.chartY,t,r,o);if(c){var u=w1e(c,t),d=l1e(u,i,a,n,s),f=v1e(t,a,d,c);return{activeIndex:String(d),activeCoordinate:f}}}};function rN(){return rN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rN.apply(null,arguments)}function bR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Yw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bR(Object(r),!0).forEach(function(n){Xke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Xke(e,t,r){return(t=Jke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Jke(e){var t=Qke(e,"string");return typeof t=="symbol"?t:t+""}function Qke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zke(e){var{coordinate:t,payload:r,index:n,offset:s,tooltipAxisBandSize:a,layout:i,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,f=r,g=n;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var p,x;if(u==="ScatterChart")p=d,x=dwe;else if(u==="BarChart")p=fwe(i,d,s,a),x=Wwe;else if(i==="radial"){var{cx:v,cy:w,radius:C,startAngle:k,endAngle:_}=bW(d);p={cx:v,cy:w,startAngle:k,endAngle:_,innerRadius:C,outerRadius:C},x=Kwe}else p={points:qwe(i,d,s)},x=pW;var N=typeof o=="object"&&"className"in o?o.className:void 0,E=Yw(Yw(Yw(Yw({stroke:"#ccc",pointerEvents:"none"},s),p),gi(o,!1)),{},{payload:f,payloadIndex:g,className:ls("recharts-tooltip-cursor",N)});return S.isValidElement(o)?S.cloneElement(o,E):S.createElement(x,E)}function eCe(e){var t=zke(),r=dW(),n=Q3(),s=Wke();return S.createElement(Zke,rN({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:s}))}var OG=S.createContext(null),tCe=()=>S.useContext(OG),GC={exports:{}},SR;function rCe(){return SR||(SR=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function a(c,u,d,f,g){if(typeof d!="function")throw new TypeError("The listener must be a function");var p=new s(d,f||c,g),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],p]:c._events[x].push(p):(c._events[x]=p,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var g=0,p=f.length,x=new Array(p);g<p;g++)x[g]=f[g].fn;return x},o.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,g,p,x){var v=r?r+u:u;if(!this._events[v])return!1;var w=this._events[v],C=arguments.length,k,_;if(w.fn){switch(w.once&&this.removeListener(u,w.fn,void 0,!0),C){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,d),!0;case 3:return w.fn.call(w.context,d,f),!0;case 4:return w.fn.call(w.context,d,f,g),!0;case 5:return w.fn.call(w.context,d,f,g,p),!0;case 6:return w.fn.call(w.context,d,f,g,p,x),!0}for(_=1,k=new Array(C-1);_<C;_++)k[_-1]=arguments[_];w.fn.apply(w.context,k)}else{var N=w.length,E;for(_=0;_<N;_++)switch(w[_].once&&this.removeListener(u,w[_].fn,void 0,!0),C){case 1:w[_].fn.call(w[_].context);break;case 2:w[_].fn.call(w[_].context,d);break;case 3:w[_].fn.call(w[_].context,d,f);break;case 4:w[_].fn.call(w[_].context,d,f,g);break;default:if(!k)for(E=1,k=new Array(C-1);E<C;E++)k[E-1]=arguments[E];w[_].fn.apply(w[_].context,k)}}return!0},o.prototype.on=function(u,d,f){return a(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return a(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,g){var p=r?r+u:u;if(!this._events[p])return this;if(!d)return i(this,p),this;var x=this._events[p];if(x.fn)x.fn===d&&(!g||x.once)&&(!f||x.context===f)&&i(this,p);else{for(var v=0,w=[],C=x.length;v<C;v++)(x[v].fn!==d||g&&!x[v].once||f&&x[v].context!==f)&&w.push(x[v]);w.length?this._events[p]=w.length===1?w[0]:w:i(this,p)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(GC)),GC.exports}var nCe=rCe();const sCe=Ol(nCe);var bv=new sCe,nN="recharts.syncEvent.tooltip",kR="recharts.syncEvent.brush";function aCe(e,t){if(t){var r=Number.parseInt(t,10);if(!jl(r))return e?.[r]}}var iCe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},DG=Qo({name:"options",initialState:iCe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),oCe=DG.reducer,{createEventEmitter:lCe}=DG.actions;function cCe(e){return e.tooltip.syncInteraction}var uCe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},IG=Qo({name:"chartData",initialState:uCe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:CR,setDataStartEndIndexes:dCe,setComputedData:H3e}=IG.actions,fCe=IG.reducer,hCe=["x","y"];function TR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function kh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TR(Object(r),!0).forEach(function(n){gCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gCe(e,t,r){return(t=mCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mCe(e){var t=pCe(e,"string");return typeof t=="symbol"?t:t+""}function pCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xCe(e,t){if(e==null)return{};var r,n,s=yCe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function yCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var RG=()=>{};function vCe(){var e=Pr(TA),t=Pr(EA),r=io(),n=Pr(vH),s=Pr(yd),a=Q3(),i=J3(),o=Pr(c=>c.rootProps.className);S.useEffect(()=>{if(e==null)return RG;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var g;if(i&&d!==null&&d!==void 0&&(g=d.payload)!==null&&g!==void 0&&g.coordinate){var p=d.payload.coordinate,{x,y:v}=p,w=xCe(p,hCe),C=kh(kh(kh({},w),typeof x=="number"&&{x:Math.max(i.x,Math.min(x,i.x+i.width))}),typeof v=="number"&&{y:Math.max(i.y,Math.min(v,i.y+i.height))}),k=kh(kh({},d),{},{payload:kh(kh({},d.payload),{},{coordinate:C})});r(k)}else r(d);return}if(s!=null){var _;if(typeof n=="function"){var N={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},E=n(s,N);_=s[E]}else n==="value"&&(_=s.find(Z=>String(Z.value)===d.payload.label));var{coordinate:P}=d.payload;if(_==null||d.payload.active===!1||P==null||i==null){r(eN({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:F,y:A}=P,j=Math.min(F,i.x+i.width),I=Math.min(A,i.y+i.height),L={x:a==="horizontal"?_.coordinate:j,y:a==="horizontal"?I:_.coordinate},Y=eN({active:d.payload.active,coordinate:L,dataKey:d.payload.dataKey,index:String(_.index),label:d.payload.label});r(Y)}}};return bv.on(nN,c),()=>{bv.off(nN,c)}},[o,r,t,e,n,s,a,i])}function wCe(){var e=Pr(TA),t=Pr(EA),r=io();S.useEffect(()=>{if(e==null)return RG;var n=(s,a,i)=>{t!==i&&e===s&&r(dCe(a))};return bv.on(kR,n),()=>{bv.off(kR,n)}},[r,t,e])}function _Ce(){var e=io();S.useEffect(()=>{e(lCe())},[e]),vCe(),wCe()}function bCe(e,t,r,n,s,a){var i=Pr(g=>Gke(g,e,t)),o=Pr(EA),c=Pr(TA),u=Pr(vH),d=Pr(cCe),f=d?.active;S.useEffect(()=>{if(!f&&c!=null&&o!=null){var g=eN({active:a,coordinate:r,dataKey:i,index:s,label:typeof n=="number"?String(n):n});bv.emit(nN,c,g,o)}},[f,r,i,s,n,o,c,u,a])}function ER(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function NR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ER(Object(r),!0).forEach(function(n){SCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ER(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SCe(e,t,r){return(t=kCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kCe(e){var t=CCe(e,"string");return typeof t=="symbol"?t:t+""}function CCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TCe(e){return e.dataKey}function ECe(e,t){return S.isValidElement(e)?S.cloneElement(e,t):typeof e=="function"?S.createElement(e,t):S.createElement(W1e,t)}var AR=[],NCe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!np.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function ACe(e){var t=Rl(e,NCe),{active:r,allowEscapeViewBox:n,animationDuration:s,animationEasing:a,content:i,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:f,reverseDirection:g,useTranslate3d:p,wrapperStyle:x,cursor:v,shared:w,trigger:C,defaultIndex:k,portal:_,axisId:N}=t,E=io(),P=typeof k=="number"?String(k):k;S.useEffect(()=>{E(YSe({shared:w,trigger:C,axisId:N,active:r,defaultIndex:P}))},[E,w,C,N,r,P]);var F=J3(),A=mW(),j=HSe(w),{activeIndex:I,isActive:L}=Pr(J=>qke(J,j,C,P)),Y=Pr(J=>Kke(J,j,C,P)),Z=Pr(J=>FG(J,j,C,P)),ae=Pr(J=>Vke(J,j,C,P)),ee=Y,ne=tCe(),B=r??L,[V,M]=Jye([ee,B]),H=j==="axis"?Z:void 0;bCe(j,C,ae,H,I,B);var W=_??ne;if(W==null)return null;var R=ee??AR;B||(R=AR),o&&R.length&&(R=Sye(ee.filter(J=>J.value!=null&&(J.hide!==!0||t.includeHidden)),d,TCe));var z=R.length>0,K=S.createElement(X1e,{allowEscapeViewBox:n,animationDuration:s,animationEasing:a,isAnimationActive:c,active:B,coordinate:ae,hasPayload:z,offset:u,position:f,reverseDirection:g,useTranslate3d:p,viewBox:F,wrapperStyle:x,lastBoundingBox:V,innerRef:M,hasPortalFromProps:!!_},ECe(i,NR(NR({},t),{},{payload:R,label:H,active:B,coordinate:ae,accessibilityLayer:A})));return S.createElement(S.Fragment,null,iT.createPortal(K,W),B&&S.createElement(eCe,{cursor:v,tooltipEventType:j,coordinate:ae,payload:ee,index:I}))}var VC={},KC={},qC={},jR;function jCe(){return jR||(jR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:s,edges:a}={}){let i,o=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),d=()=>{o!==null&&(r.apply(i,o),i=void 0,o=null)},f=()=>{u&&d(),v()};let g=null;const p=()=>{g!=null&&clearTimeout(g),g=setTimeout(()=>{g=null,f()},n)},x=()=>{g!==null&&(clearTimeout(g),g=null)},v=()=>{x(),i=void 0,o=null},w=()=>{d()},C=function(...k){if(s?.aborted)return;i=this,o=k;const _=g==null;p(),c&&_&&d()};return C.schedule=p,C.cancel=v,C.flush=w,s?.addEventListener("abort",v,{once:!0}),C}e.debounce=t})(qC)),qC}var PR;function PCe(){return PR||(PR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jCe();function r(n,s=0,a={}){typeof a!="object"&&(a={});const{leading:i=!1,trailing:o=!0,maxWait:c}=a,u=Array(2);i&&(u[0]="leading"),o&&(u[1]="trailing");let d,f=null;const g=t.debounce(function(...v){d=n.apply(this,v),f=null},s,{edges:u}),p=function(...v){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,v),f=Date.now(),g.cancel(),g.schedule(),d):(g.apply(this,v),d)},x=()=>(g.flush(),d);return p.cancel=g.cancel,p.flush=x,p}e.debounce=r})(KC)),KC}var FR;function FCe(){return FR||(FR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PCe();function r(n,s=0,a={}){const{leading:i=!0,trailing:o=!0}=a;return t.debounce(n,s,{leading:i,maxWait:s,trailing:o})}e.throttle=r})(VC)),VC}var YC,OR;function OCe(){return OR||(OR=1,YC=FCe().throttle),YC}var DCe=OCe();const ICe=Ol(DCe);var Fy=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a]};function DR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function XC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DR(Object(r),!0).forEach(function(n){RCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RCe(e,t,r){return(t=MCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MCe(e){var t=LCe(e,"string");return typeof t=="symbol"?t:t+""}function LCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var BCe=S.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:s="100%",height:a="100%",minWidth:i=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:f,className:g,onResize:p,style:x={}}=e,v=S.useRef(null),w=S.useRef();w.current=p,S.useImperativeHandle(t,()=>v.current);var[C,k]=S.useState({containerWidth:n.width,containerHeight:n.height}),_=S.useCallback((E,P)=>{k(F=>{var A=Math.round(E),j=Math.round(P);return F.containerWidth===A&&F.containerHeight===j?F:{containerWidth:A,containerHeight:j}})},[]);S.useEffect(()=>{var E=j=>{var I,{width:L,height:Y}=j[0].contentRect;_(L,Y),(I=w.current)===null||I===void 0||I.call(w,L,Y)};d>0&&(E=ICe(E,d,{trailing:!0,leading:!1}));var P=new ResizeObserver(E),{width:F,height:A}=v.current.getBoundingClientRect();return _(F,A),P.observe(v.current),()=>{P.disconnect()}},[_,d]);var N=S.useMemo(()=>{var{containerWidth:E,containerHeight:P}=C;if(E<0||P<0)return null;Fy(Ih(s)||Ih(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,a),Fy(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=Ih(s)?E:s,A=Ih(a)?P:a;return r&&r>0&&(F?A=F/r:A&&(F=A*r),c&&A>c&&(A=c)),Fy(F>0||A>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,A,s,a,i,o,r),S.Children.map(u,j=>S.cloneElement(j,{width:F,height:A,style:XC({width:F,height:A},j.props.style)}))},[r,u,a,c,o,i,C,s]);return S.createElement("div",{id:f?"".concat(f):void 0,className:ls("recharts-responsive-container",g),style:XC(XC({},x),{},{width:s,height:a,minWidth:i,minHeight:o,maxHeight:c}),ref:v},S.createElement("div",{style:{width:0,height:0,overflow:"visible"}},N))});function $Ce(e,t,r){return(t=UCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UCe(e){var t=zCe(e,"string");return typeof t=="symbol"?t:t+""}function zCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class WCe{constructor(t){$Ce(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function IR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function HCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IR(Object(r),!0).forEach(function(n){GCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GCe(e,t,r){return(t=VCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VCe(e){var t=KCe(e,"string");return typeof t=="symbol"?t:t+""}function KCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qCe={cacheSize:2e3,enableCache:!0},MG=HCe({},qCe),RR=new WCe(MG.cacheSize),YCe={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},MR="recharts_measurement_span";function XCe(e,t){var r=t.fontSize||"",n=t.fontFamily||"",s=t.fontWeight||"",a=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(s,"|").concat(a,"|").concat(i,"|").concat(o)}var LR=(e,t)=>{try{var r=document.getElementById(MR);r||(r=document.createElement("span"),r.setAttribute("id",MR),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,YCe,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Oy=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||np.isSsr)return{width:0,height:0};if(!MG.enableCache)return LR(t,r);var n=XCe(t,r),s=RR.get(n);if(s)return s;var a=LR(t,r);return RR.set(n,a),a},BR=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,$R=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,JCe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,QCe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,LG={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},ZCe=Object.keys(LG),rm="NaN";function eTe(e,t){return e*LG[t]}class vo{static parse(t){var r,[,n,s]=(r=QCe.exec(t))!==null&&r!==void 0?r:[];return new vo(parseFloat(n),s??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,jl(t)&&(this.unit=""),r!==""&&!JCe.test(r)&&(this.num=NaN,this.unit=""),ZCe.includes(r)&&(this.num=eTe(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new vo(NaN,""):new vo(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new vo(NaN,""):new vo(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vo(NaN,""):new vo(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new vo(NaN,""):new vo(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return jl(this.num)}}function BG(e){if(e.includes(rm))return rm;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,s,a]=(r=BR.exec(t))!==null&&r!==void 0?r:[],i=vo.parse(n??""),o=vo.parse(a??""),c=s==="*"?i.multiply(o):i.divide(o);if(c.isNaN())return rm;t=t.replace(BR,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,g]=(u=$R.exec(t))!==null&&u!==void 0?u:[],p=vo.parse(d??""),x=vo.parse(g??""),v=f==="+"?p.add(x):p.subtract(x);if(v.isNaN())return rm;t=t.replace($R,v.toString())}return t}var UR=/\(([^()]*)\)/;function tTe(e){for(var t=e,r;(r=UR.exec(t))!=null;){var[,n]=r;t=t.replace(UR,BG(n))}return t}function rTe(e){var t=e.replace(/\s+/g,"");return t=tTe(t),t=BG(t),t}function nTe(e){try{return rTe(e)}catch{return rm}}function JC(e){var t=nTe(e.slice(5,-1));return t===rm?"":t}var sTe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],aTe=["dx","dy","angle","className","breakAll"];function sN(){return sN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sN.apply(null,arguments)}function zR(e,t){if(e==null)return{};var r,n,s=iTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function iTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $G=/[ \f\n\r\t\v\u2028\u2029]+/,UG=e=>{var{children:t,breakAll:r,style:n}=e;try{var s=[];za(t)||(r?s=t.toString().split(""):s=t.toString().split($G));var a=s.map(o=>({word:o,width:Oy(o,n).width})),i=r?0:Oy("",n).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},oTe=(e,t,r,n,s)=>{var{maxLines:a,children:i,style:o,breakAll:c}=e,u=$r(a),d=i,f=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return L.reduce((Y,Z)=>{var{word:ae,width:ee}=Z,ne=Y[Y.length-1];if(ne&&(n==null||s||ne.width+ee+r<Number(n)))ne.words.push(ae),ne.width+=ee+r;else{var B={words:[ae],width:ee};Y.push(B)}return Y},[])},g=f(t),p=I=>I.reduce((L,Y)=>L.width>Y.width?L:Y);if(!u||s)return g;var x=g.length>a||p(g).width>Number(n);if(!x)return g;for(var v="",w=I=>{var L=d.slice(0,I),Y=UG({breakAll:c,style:o,children:L+v}).wordsWithComputedWidth,Z=f(Y),ae=Z.length>a||p(Z).width>Number(n);return[ae,Z]},C=0,k=d.length-1,_=0,N;C<=k&&_<=d.length-1;){var E=Math.floor((C+k)/2),P=E-1,[F,A]=w(P),[j]=w(E);if(!F&&!j&&(C=E+1),F&&j&&(k=E-1),!F&&j){N=A;break}_++}return N||g},WR=e=>{var t=za(e)?[]:e.toString().split($G);return[{words:t}]},lTe=e=>{var{width:t,scaleToFit:r,children:n,style:s,breakAll:a,maxLines:i}=e;if((t||r)&&!np.isSsr){var o,c,u=UG({breakAll:a,children:n,style:s});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;o=d,c=f}else return WR(n);return oTe({breakAll:a,children:n,maxLines:i,style:s},o,c,t,r)}return WR(n)},HR="#808080",YA=S.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:s="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=HR}=e,d=zR(e,sTe),f=S.useMemo(()=>lTe({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:g,dy:p,angle:x,className:v,breakAll:w}=d,C=zR(d,aTe);if(!Zc(r)||!Zc(n)||f.length===0)return null;var k=r+($r(g)?g:0),_=n+($r(p)?p:0),N;switch(c){case"start":N=JC("calc(".concat(a,")"));break;case"middle":N=JC("calc(".concat((f.length-1)/2," * -").concat(s," + (").concat(a," / 2))"));break;default:N=JC("calc(".concat(f.length-1," * -").concat(s,")"));break}var E=[];if(i){var P=f[0].width,{width:F}=d;E.push("scale(".concat($r(F)?F/P:1,")"))}return x&&E.push("rotate(".concat(x,", ").concat(k,", ").concat(_,")")),E.length&&(C.transform=E.join(" ")),S.createElement("text",sN({},gi(C,!0),{ref:t,x:k,y:_,className:ls("recharts-text",v),textAnchor:o,fill:u.includes("url")?HR:u}),f.map((A,j)=>{var I=A.words.join(w?"":" ");return S.createElement("tspan",{x:k,dy:j===0?N:s,key:"".concat(I,"-").concat(j)},I)}))});YA.displayName="Text";var cTe=["labelRef"];function uTe(e,t){if(e==null)return{};var r,n,s=dTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function dTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function GR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function qs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GR(Object(r),!0).forEach(function(n){fTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fTe(e,t,r){return(t=hTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hTe(e){var t=gTe(e,"string");return typeof t=="symbol"?t:t+""}function gTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Uu(){return Uu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Uu.apply(null,arguments)}var zG=S.createContext(null),mTe=e=>{var{x:t,y:r,width:n,height:s,children:a}=e,i=S.useMemo(()=>({x:t,y:r,width:n,height:s}),[t,r,n,s]);return S.createElement(zG.Provider,{value:i},a)},WG=()=>{var e=S.useContext(zG),t=J3();return e||t},pTe=S.createContext(null),xTe=()=>{var e=S.useContext(pTe),t=Pr(kH);return e||t},yTe=e=>{var{value:t,formatter:r}=e,n=za(e.children)?t:e.children;return typeof r=="function"?r(n):n},XA=e=>e!=null&&typeof e=="function",vTe=(e,t)=>{var r=Sl(t-e),n=Math.min(Math.abs(t-e),360);return r*n},wTe=(e,t,r,n,s)=>{var{offset:a,className:i}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:g,clockWise:p}=s,x=(u+d)/2,v=vTe(f,g),w=v>=0?1:-1,C,k;switch(t){case"insideStart":C=f+w*a,k=p;break;case"insideEnd":C=g-w*a,k=!p;break;case"end":C=g+w*a,k=p;break;default:throw new Error("Unsupported position ".concat(t))}k=v<=0?k:!k;var _=di(o,c,x,C),N=di(o,c,x,C+(k?1:-1)*359),E="M".concat(_.x,",").concat(_.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(k?0:1,`,
    `).concat(N.x,",").concat(N.y),P=za(e.id)?fv("recharts-radial-line-"):e.id;return S.createElement("text",Uu({},n,{dominantBaseline:"central",className:ls("recharts-radial-bar-label",i)}),S.createElement("defs",null,S.createElement("path",{id:P,d:E})),S.createElement("textPath",{xlinkHref:"#".concat(P)},r))},_Te=(e,t,r)=>{var{cx:n,cy:s,innerRadius:a,outerRadius:i,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:f}=di(n,s,i+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"end"};var g=(a+i)/2,{x:p,y:x}=di(n,s,g,u);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},HG=e=>"cx"in e&&$r(e.cx),bTe=(e,t)=>{var{parentViewBox:r,offset:n,position:s}=e,a;r!=null&&!HG(r)&&(a=r);var{x:i,y:o,width:c,height:u}=t,d=u>=0?1:-1,f=d*n,g=d>0?"end":"start",p=d>0?"start":"end",x=c>=0?1:-1,v=x*n,w=x>0?"end":"start",C=x>0?"start":"end";if(s==="top"){var k={x:i+c/2,y:o-d*n,textAnchor:"middle",verticalAnchor:g};return qs(qs({},k),a?{height:Math.max(o-a.y,0),width:c}:{})}if(s==="bottom"){var _={x:i+c/2,y:o+u+f,textAnchor:"middle",verticalAnchor:p};return qs(qs({},_),a?{height:Math.max(a.y+a.height-(o+u),0),width:c}:{})}if(s==="left"){var N={x:i-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"};return qs(qs({},N),a?{width:Math.max(N.x-a.x,0),height:u}:{})}if(s==="right"){var E={x:i+c+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"};return qs(qs({},E),a?{width:Math.max(a.x+a.width-E.x,0),height:u}:{})}var P=a?{width:c,height:u}:{};return s==="insideLeft"?qs({x:i+v,y:o+u/2,textAnchor:C,verticalAnchor:"middle"},P):s==="insideRight"?qs({x:i+c-v,y:o+u/2,textAnchor:w,verticalAnchor:"middle"},P):s==="insideTop"?qs({x:i+c/2,y:o+f,textAnchor:"middle",verticalAnchor:p},P):s==="insideBottom"?qs({x:i+c/2,y:o+u-f,textAnchor:"middle",verticalAnchor:g},P):s==="insideTopLeft"?qs({x:i+v,y:o+f,textAnchor:C,verticalAnchor:p},P):s==="insideTopRight"?qs({x:i+c-v,y:o+f,textAnchor:w,verticalAnchor:p},P):s==="insideBottomLeft"?qs({x:i+v,y:o+u-f,textAnchor:C,verticalAnchor:g},P):s==="insideBottomRight"?qs({x:i+c-v,y:o+u-f,textAnchor:w,verticalAnchor:g},P):s&&typeof s=="object"&&($r(s.x)||Ih(s.x))&&($r(s.y)||Ih(s.y))?qs({x:i+jf(s.x,c),y:o+jf(s.y,u),textAnchor:"end",verticalAnchor:"end"},P):qs({x:i+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},P)},STe={offset:5};function lf(e){var t=Rl(e,STe),{viewBox:r,position:n,value:s,children:a,content:i,className:o="",textBreakAll:c,labelRef:u}=t,d=xTe(),f=WG(),g=n==="center"?f:d??f,p=r||g;if(!p||za(s)&&za(a)&&!S.isValidElement(i)&&typeof i!="function")return null;var x=qs(qs({},t),{},{viewBox:p});if(S.isValidElement(i)){var{labelRef:v}=x,w=uTe(x,cTe);return S.cloneElement(i,w)}var C;if(typeof i=="function"){if(C=S.createElement(i,x),S.isValidElement(C))return C}else C=yTe(t);var k=HG(p),_=gi(t,!0);if(k&&(n==="insideStart"||n==="insideEnd"||n==="end"))return wTe(t,n,C,_,p);var N=k?_Te(p,t.offset,t.position):bTe(t,p);return S.createElement(YA,Uu({ref:u,className:ls("recharts-label",o)},_,N,{breakAll:c}),C)}lf.displayName="Label";var kTe=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?S.createElement(lf,Uu({key:"label-implicit"},n)):Zc(e)?S.createElement(lf,Uu({key:"label-implicit",value:e},n)):S.isValidElement(e)?e.type===lf?S.cloneElement(e,qs({key:"label-implicit"},n)):S.createElement(lf,Uu({key:"label-implicit",content:e},n)):XA(e)?S.createElement(lf,Uu({key:"label-implicit",content:e},n)):e&&typeof e=="object"?S.createElement(lf,Uu({},e,{key:"label-implicit"},n)):null};function CTe(e){var{label:t}=e,r=WG();return kTe(t,r)||null}var QC={},ZC={},VR;function TTe(){return VR||(VR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(ZC)),ZC}var eT={},KR;function ETe(){return KR||(KR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(eT)),eT}var qR;function NTe(){return qR||(qR=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=TTe(),r=ETe(),n=W3();function s(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=s})(QC)),QC}var tT,YR;function ATe(){return YR||(YR=1,tT=NTe().last),tT}var jTe=ATe();const PTe=Ol(jTe);var FTe=["valueAccessor"],OTe=["dataKey","clockWise","id","textBreakAll"];function kb(){return kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kb.apply(null,arguments)}function XR(e,t){if(e==null)return{};var r,n,s=DTe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function DTe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ITe=e=>Array.isArray(e.value)?PTe(e.value):e.value,GG=S.createContext(void 0),RTe=GG.Provider,VG=S.createContext(void 0);VG.Provider;function MTe(){return S.useContext(GG)}function LTe(){return S.useContext(VG)}function o_(e){var{valueAccessor:t=ITe}=e,r=XR(e,FTe),{dataKey:n,clockWise:s,id:a,textBreakAll:i}=r,o=XR(r,OTe),c=MTe(),u=LTe(),d=c||u;return!d||!d.length?null:S.createElement(rp,{className:"recharts-label-list"},d.map((f,g)=>{var p,x=za(n)?t(f,g):so(f&&f.payload,n),v=za(a)?{}:{id:"".concat(a,"-").concat(g)};return S.createElement(lf,kb({},gi(f,!0),o,v,{fill:(p=r.fill)!==null&&p!==void 0?p:f.fill,parentViewBox:f.parentViewBox,value:x,textBreakAll:i,viewBox:f.viewBox,key:"label-".concat(g),index:g}))}))}o_.displayName="LabelList";function BTe(e){var{label:t}=e;return t?t===!0?S.createElement(o_,{key:"labelList-implicit"}):S.isValidElement(t)||XA(t)?S.createElement(o_,{key:"labelList-implicit",content:t}):typeof t=="object"?S.createElement(o_,kb({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function aN(){return aN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aN.apply(null,arguments)}var KG=e=>{var{cx:t,cy:r,r:n,className:s}=e,a=ls("recharts-dot",s);return t===+t&&r===+r&&n===+n?S.createElement("circle",aN({},I0(e),U3(e),{className:a,cx:t,cy:r,r:n})):null},$Te={radiusAxis:{},angleAxis:{}},qG=Qo({name:"polarAxis",initialState:$Te,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:G3e,removeRadiusAxis:V3e,addAngleAxis:K3e,removeAngleAxis:q3e}=qG.actions,UTe=qG.reducer;function zTe(e){var{fn:t,args:r}=e,n=io(),s=Il();return S.useEffect(()=>{if(!s){var a=t(r);return n(KSe(a)),()=>{n(qSe(a))}}},[t,r,n,s]),null}var WTe=()=>{};function HTe(e){var{legendPayload:t}=e,r=io(),n=Il();return S.useEffect(()=>n?WTe:(r(R1e(t)),()=>{r(M1e(t))}),[r,n,t]),null}var rT,GTe=()=>{var[e]=S.useState(()=>fv("uid-"));return e},VTe=(rT=pM.useId)!==null&&rT!==void 0?rT:GTe;function KTe(e,t){var r=VTe();return t||(e?"".concat(e,"-").concat(r):r)}var qTe=S.createContext(void 0),YTe=e=>{var{id:t,type:r,children:n}=e,s=KTe("recharts-".concat(r),t);return S.createElement(qTe.Provider,{value:s},n(s))},XTe={cartesianItems:[],polarItems:[]},YG=Qo({name:"graphicalItems",initialState:XTe,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,s=Xu(e).cartesianItems.indexOf(r);s>-1&&(e.cartesianItems[s]=n)},removeCartesianGraphicalItem(e,t){var r=Xu(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Xu(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:JTe,replaceCartesianGraphicalItem:QTe,removeCartesianGraphicalItem:ZTe,addPolarGraphicalItem:Y3e,removePolarGraphicalItem:X3e}=YG.actions,eEe=YG.reducer;function tEe(e){var t=io(),r=S.useRef(null);return S.useEffect(()=>{r.current===null?t(JTe(e)):r.current!==e&&t(QTe({prev:r.current,next:e})),r.current=e},[t,e]),S.useEffect(()=>()=>{r.current&&(t(ZTe(r.current)),r.current=null)},[t]),null}function JR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function QR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(r),!0).forEach(function(n){rEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function rEe(e,t,r){return(t=nEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nEe(e){var t=sEe(e,"string");return typeof t=="symbol"?t:t+""}function sEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aEe={xAxis:{},yAxis:{},zAxis:{}},XG=Qo({name:"cartesianAxis",initialState:aEe,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=QR(QR({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:iEe,removeXAxis:oEe,addYAxis:lEe,removeYAxis:cEe,addZAxis:J3e,removeZAxis:Q3e,updateYAxisWidth:uEe}=XG.actions,dEe=XG.reducer,fEe=bt([mi],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),hEe=bt([fEe,hd,gd],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),JA=()=>Pr(hEe),gEe=()=>Pr(Mke);function ZR(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function eM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZR(Object(r),!0).forEach(function(n){mEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZR(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mEe(e,t,r){return(t=pEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pEe(e){var t=xEe(e,"string");return typeof t=="symbol"?t:t+""}function xEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yEe=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:s,dataKey:a}=e;if(s===!1||t.x==null||t.y==null)return null;var i=eM(eM({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},gi(s,!1)),U3(s)),o;return S.isValidElement(s)?o=S.cloneElement(s,i):typeof s=="function"?o=s(i):o=S.createElement(KG,i),S.createElement(rp,{className:"recharts-active-dot"},o)};function vEe(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:s}=e,a=Pr(_v),i=gEe();if(t==null||i==null)return null;var o=t.find(c=>i.includes(c.payload));return za(o)?null:yEe({point:o,childIndex:Number(a),mainColor:r,dataKey:s,activeDot:n})}var wEe={},JG=Qo({name:"errorBars",initialState:wEe,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:s}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?s:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(s=>s.dataKey!==n.dataKey||s.direction!==n.direction))}}}),{addErrorBar:Z3e,replaceErrorBar:eAe,removeErrorBar:tAe}=JG.actions,_Ee=JG.reducer,bEe=["children"];function SEe(e,t){if(e==null)return{};var r,n,s=kEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function kEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var CEe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},TEe=S.createContext(CEe);function EEe(e){var{children:t}=e,r=SEe(e,bEe);return S.createElement(TEe.Provider,{value:r},t)}function QG(e,t){var r,n,s=Pr(u=>pd(u,e)),a=Pr(u=>xd(u,t)),i=(r=s?.allowDataOverflow)!==null&&r!==void 0?r:Mo.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:Lo.allowDataOverflow,c=i||o;return{needClip:c,needClipX:i,needClipY:o}}function NEe(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,s=JA(),{needClipX:a,needClipY:i,needClip:o}=QG(t,r);if(!o)return null;var{x:c,y:u,width:d,height:f}=s;return S.createElement("clipPath",{id:"clipPath-".concat(n)},S.createElement("rect",{x:a?c:c-d/2,y:i?u:u-f/2,width:a?d:d*2,height:i?f:f*2}))}var AEe=e=>{var{chartData:t}=e,r=io(),n=Il();return S.useEffect(()=>n?()=>{}:(r(CR(t)),()=>{r(CR(void 0))}),[t,r,n]),null},tM={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ZG=Qo({name:"brush",initialState:tM,reducers:{setBrushSettings(e,t){return t.payload==null?tM:t.payload}}}),{setBrushSettings:rAe}=ZG.actions,jEe=ZG.reducer;function PEe(e,t,r){return(t=FEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FEe(e){var t=OEe(e,"string");return typeof t=="symbol"?t:t+""}function OEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class QA{static create(t){return new QA(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],s=r[r.length-1];return n<=s?t>=n&&t<=s:t>=s&&t<=n}}PEe(QA,"EPS",1e-4);function DEe(e){return(e%180+180)%180}var IEe=function(t){var{width:r,height:n}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=DEe(s),i=a*Math.PI/180,o=Math.atan(n/r),c=i>o&&i<Math.PI-o?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},REe={dots:[],areas:[],lines:[]},eV=Qo({name:"referenceElements",initialState:REe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Xu(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Xu(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Xu(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:nAe,removeDot:sAe,addArea:aAe,removeArea:iAe,addLine:oAe,removeLine:lAe}=eV.actions,MEe=eV.reducer,LEe=S.createContext(void 0),BEe=e=>{var{children:t}=e,[r]=S.useState("".concat(fv("recharts"),"-clip")),n=JA();if(n==null)return null;var{x:s,y:a,width:i,height:o}=n;return S.createElement(LEe.Provider,{value:r},S.createElement("defs",null,S.createElement("clipPath",{id:r},S.createElement("rect",{x:s,y:a,height:o,width:i}))),t)};function Dm(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function tV(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)n.push(e[s]);return n}function $Ee(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return IEe(n,r)}function UEe(e,t,r){var n=r==="width",{x:s,y:a,width:i,height:o}=e;return t===1?{start:n?s:a,end:n?s+i:a+o}:{start:n?s+i:a+o,end:n?s:a}}function Cb(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-s)<=0}function zEe(e,t){return tV(e,t+1)}function WEe(e,t,r,n,s){for(var a=(n||[]).slice(),{start:i,end:o}=t,c=0,u=1,d=i,f=function(){var x=n?.[c];if(x===void 0)return{v:tV(n,u)};var v=c,w,C=()=>(w===void 0&&(w=r(x,v)),w),k=x.coordinate,_=c===0||Cb(e,k,C,d,o);_||(c=0,d=i,u+=1),_&&(d=k+e*(C()/2+s),c+=u)},g;u<=a.length;)if(g=f(),g)return g.v;return[]}function rM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ki(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rM(Object(r),!0).forEach(function(n){HEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HEe(e,t,r){return(t=GEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GEe(e){var t=VEe(e,"string");return typeof t=="symbol"?t:t+""}function VEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KEe(e,t,r,n,s){for(var a=(n||[]).slice(),i=a.length,{start:o}=t,{end:c}=t,u=function(g){var p=a[g],x,v=()=>(x===void 0&&(x=r(p,g)),x);if(g===i-1){var w=e*(p.coordinate+e*v()/2-c);a[g]=p=ki(ki({},p),{},{tickCoord:w>0?p.coordinate-w*e:p.coordinate})}else a[g]=p=ki(ki({},p),{},{tickCoord:p.coordinate});var C=Cb(e,p.tickCoord,v,o,c);C&&(c=p.tickCoord-e*(v()/2+s),a[g]=ki(ki({},p),{},{isShow:!0}))},d=i-1;d>=0;d--)u(d);return a}function qEe(e,t,r,n,s,a){var i=(n||[]).slice(),o=i.length,{start:c,end:u}=t;if(a){var d=n[o-1],f=r(d,o-1),g=e*(d.coordinate+e*f/2-u);i[o-1]=d=ki(ki({},d),{},{tickCoord:g>0?d.coordinate-g*e:d.coordinate});var p=Cb(e,d.tickCoord,()=>f,c,u);p&&(u=d.tickCoord-e*(f/2+s),i[o-1]=ki(ki({},d),{},{isShow:!0}))}for(var x=a?o-1:o,v=function(k){var _=i[k],N,E=()=>(N===void 0&&(N=r(_,k)),N);if(k===0){var P=e*(_.coordinate-e*E()/2-c);i[k]=_=ki(ki({},_),{},{tickCoord:P<0?_.coordinate-P*e:_.coordinate})}else i[k]=_=ki(ki({},_),{},{tickCoord:_.coordinate});var F=Cb(e,_.tickCoord,E,c,u);F&&(c=_.tickCoord+e*(E()/2+s),i[k]=ki(ki({},_),{},{isShow:!0}))},w=0;w<x;w++)v(w);return i}function ZA(e,t,r){var{tick:n,ticks:s,viewBox:a,minTickGap:i,orientation:o,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!s||!s.length||!n)return[];if($r(c)||np.isSsr){var g;return(g=zEe(s,$r(c)?c:0))!==null&&g!==void 0?g:[]}var p=[],x=o==="top"||o==="bottom"?"width":"height",v=d&&x==="width"?Oy(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},w=(_,N)=>{var E=typeof u=="function"?u(_.value,N):_.value;return x==="width"?$Ee(Oy(E,{fontSize:t,letterSpacing:r}),v,f):Oy(E,{fontSize:t,letterSpacing:r})[x]},C=s.length>=2?Sl(s[1].coordinate-s[0].coordinate):1,k=UEe(a,C,x);return c==="equidistantPreserveStart"?WEe(C,k,w,s,i):(c==="preserveStart"||c==="preserveStartEnd"?p=qEe(C,k,w,s,i,c==="preserveStartEnd"):p=KEe(C,k,w,s,i),p.filter(_=>_.isShow))}var YEe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:s=0,tickMargin:a=0}=e,i=0;if(t){t.forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>i&&(i=f.width)}});var o=r?r.getBoundingClientRect().width:0,c=s+a,u=i+c+o+(r?n:0);return Math.round(u)}return 0},XEe=["axisLine","width","height","className","hide","ticks"],JEe=["viewBox"],QEe=["viewBox"];function iN(e,t){if(e==null)return{};var r,n,s=ZEe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function ZEe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function b0(){return b0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b0.apply(null,arguments)}function nM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ya(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nM(Object(r),!0).forEach(function(n){eNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eNe(e,t,r){return(t=tNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tNe(e){var t=rNe(e,"string");return typeof t=="symbol"?t:t+""}function rNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ej={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function nNe(e){var{x:t,y:r,width:n,height:s,orientation:a,mirror:i,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=ya(ya(ya({},c),gi(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!i||a==="bottom"&&i);u=ya(ya({},u),{},{x1:t,y1:r+d*s,x2:t+n,y2:r+d*s})}else{var f=+(a==="left"&&!i||a==="right"&&i);u=ya(ya({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+s})}return S.createElement("line",b0({},u,{className:ls("recharts-cartesian-axis-line",h2(o,"className"))}))}function sNe(e,t,r,n,s,a,i,o,c){var u,d,f,g,p,x,v=o?-1:1,w=e.tickSize||i,C=$r(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":u=d=e.coordinate,g=r+ +!o*s,f=g-v*w,x=f-v*c,p=C;break;case"left":f=g=e.coordinate,d=t+ +!o*n,u=d-v*w,p=u-v*c,x=C;break;case"right":f=g=e.coordinate,d=t+ +o*n,u=d+v*w,p=u+v*c,x=C;break;default:u=d=e.coordinate,g=r+ +o*s,f=g+v*w,x=f+v*c,p=C;break}return{line:{x1:u,y1:f,x2:d,y2:g},tick:{x:p,y:x}}}function aNe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function iNe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function oNe(e){var{option:t,tickProps:r,value:n}=e,s,a=ls(r.className,"recharts-cartesian-axis-tick-value");if(S.isValidElement(t))s=S.cloneElement(t,ya(ya({},r),{},{className:a}));else if(typeof t=="function")s=t(ya(ya({},r),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=ls(i,t?.className)),s=S.createElement(YA,b0({},r,{className:i}),n)}return s}function lNe(e){var{ticks:t=[],tick:r,tickLine:n,stroke:s,tickFormatter:a,unit:i,padding:o,tickTextProps:c,orientation:u,mirror:d,x:f,y:g,width:p,height:x,tickSize:v,tickMargin:w,fontSize:C,letterSpacing:k,getTicksConfig:_,events:N}=e,E=ZA(ya(ya({},_),{},{ticks:t}),C,k),P=aNe(u,d),F=iNe(u,d),A=I0(_),j=gi(r,!1),I=ya(ya({},A),{},{fill:"none"},gi(n,!1)),L=E.map((Y,Z)=>{var{line:ae,tick:ee}=sNe(Y,f,g,p,x,u,v,d,w),ne=ya(ya(ya(ya({textAnchor:P,verticalAnchor:F},A),{},{stroke:"none",fill:s},j),ee),{},{index:Z,payload:Y,visibleTicksCount:E.length,tickFormatter:a,padding:o},c);return S.createElement(rp,b0({className:"recharts-cartesian-axis-tick",key:"tick-".concat(Y.value,"-").concat(Y.coordinate,"-").concat(Y.tickCoord)},Exe(N,Y,Z)),n&&S.createElement("line",b0({},I,ae,{className:ls("recharts-cartesian-axis-tick-line",h2(n,"className"))})),r&&S.createElement(oNe,{option:r,tickProps:ne,value:"".concat(typeof a=="function"?a(Y.value,Z):Y.value).concat(i||"")}))});return L.length>0?S.createElement("g",{className:"recharts-cartesian-axis-ticks"},L):null}var cNe=S.forwardRef((e,t)=>{var{axisLine:r,width:n,height:s,className:a,hide:i,ticks:o}=e,c=iN(e,XEe),[u,d]=S.useState(""),[f,g]=S.useState(""),p=S.useRef([]);S.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var v;return YEe({ticks:p.current,label:(v=e.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var x=S.useCallback(v=>{if(v){var w=v.getElementsByClassName("recharts-cartesian-axis-tick-value");p.current=Array.from(w);var C=w[0];if(C){var k=window.getComputedStyle(C),_=k.fontSize,N=k.letterSpacing;(_!==u||N!==f)&&(d(_),g(N))}}},[u,f]);return i||n!=null&&n<=0||s!=null&&s<=0?null:S.createElement(rp,{className:ls("recharts-cartesian-axis",a),ref:x},S.createElement(nNe,{x:e.x,y:e.y,width:n,height:s,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:I0(e)}),S.createElement(lNe,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:f,getTicksConfig:e,events:c}),S.createElement(mTe,{x:e.x,y:e.y,width:e.width,height:e.height},S.createElement(CTe,{label:e.label}),e.children))}),uNe=S.memo(cNe,(e,t)=>{var{viewBox:r}=e,n=iN(e,JEe),{viewBox:s}=t,a=iN(t,QEe);return Dm(r,s)&&Dm(n,a)}),tj=S.forwardRef((e,t)=>{var r=Rl(e,ej);return S.createElement(uNe,b0({},r,{ref:t}))});tj.displayName="CartesianAxis";var dNe=["x1","y1","x2","y2","key"],fNe=["offset"],hNe=["xAxisId","yAxisId"],gNe=["xAxisId","yAxisId"];function sM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sM(Object(r),!0).forEach(function(n){mNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mNe(e,t,r){return(t=pNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pNe(e){var t=xNe(e,"string");return typeof t=="symbol"?t:t+""}function xNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Lh(){return Lh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lh.apply(null,arguments)}function Tb(e,t){if(e==null)return{};var r,n,s=yNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function yNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vNe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:s,width:a,height:i,ry:o}=e;return S.createElement("rect",{x:n,y:s,ry:o,width:a,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function rV(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:s,x2:a,y2:i,key:o}=t,c=Tb(t,dNe),u=I0(c),{offset:d}=u,f=Tb(u,fNe);r=S.createElement("line",Lh({},f,{x1:n,y1:s,x2:a,y2:i,fill:"none",key:o}))}return r}function wNe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=Tb(e,hNe),c=s.map((u,d)=>{var f=Ni(Ni({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return rV(n,f)});return S.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function _Ne(e){var{y:t,height:r,vertical:n=!0,verticalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=Tb(e,gNe),c=s.map((u,d)=>{var f=Ni(Ni({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return rV(n,f)});return S.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function bNe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:s,width:a,height:i,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(f=>Math.round(f+s-s)).sort((f,g)=>f-g);s!==u[0]&&u.unshift(0);var d=u.map((f,g)=>{var p=!u[g+1],x=p?s+i-f:u[g+1]-f;if(x<=0)return null;var v=g%t.length;return S.createElement("rect",{key:"react-".concat(g),y:f,x:n,height:x,width:a,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function SNe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:s,y:a,width:i,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+s-s)).sort((f,g)=>f-g);s!==u[0]&&u.unshift(0);var d=u.map((f,g)=>{var p=!u[g+1],x=p?s+i-f:u[g+1]-f;if(x<=0)return null;var v=g%r.length;return S.createElement("rect",{key:"react-".concat(g),x:f,y:a,width:x,height:o,stroke:"none",fill:r[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return S.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var kNe=(e,t)=>{var{xAxis:r,width:n,height:s,offset:a}=e;return iW(ZA(Ni(Ni(Ni({},ej),r),{},{ticks:oW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.left,a.left+a.width,t)},CNe=(e,t)=>{var{yAxis:r,width:n,height:s,offset:a}=e;return iW(ZA(Ni(Ni(Ni({},ej),r),{},{ticks:oW(r),viewBox:{x:0,y:0,width:n,height:s}})),a.top,a.top+a.height,t)},TNe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function nV(e){var t=fW(),r=hW(),n=dW(),s=Ni(Ni({},Rl(e,TNe)),{},{x:$r(e.x)?e.x:n.left,y:$r(e.y)?e.y:n.top,width:$r(e.width)?e.width:n.width,height:$r(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:i,x:o,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:g,verticalValues:p}=s,x=Il(),v=Pr(j=>pR(j,"xAxis",a,x)),w=Pr(j=>pR(j,"yAxis",i,x));if(!$r(u)||u<=0||!$r(d)||d<=0||!$r(o)||o!==+o||!$r(c)||c!==+c)return null;var C=s.verticalCoordinatesGenerator||kNe,k=s.horizontalCoordinatesGenerator||CNe,{horizontalPoints:_,verticalPoints:N}=s;if((!_||!_.length)&&typeof k=="function"){var E=g&&g.length,P=k({yAxis:w?Ni(Ni({},w),{},{ticks:E?g:w.ticks}):void 0,width:t,height:r,offset:n},E?!0:f);Fy(Array.isArray(P),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof P,"]")),Array.isArray(P)&&(_=P)}if((!N||!N.length)&&typeof C=="function"){var F=p&&p.length,A=C({xAxis:v?Ni(Ni({},v),{},{ticks:F?p:v.ticks}):void 0,width:t,height:r,offset:n},F?!0:f);Fy(Array.isArray(A),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof A,"]")),Array.isArray(A)&&(N=A)}return S.createElement("g",{className:"recharts-cartesian-grid"},S.createElement(vNe,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),S.createElement(bNe,Lh({},s,{horizontalPoints:_})),S.createElement(SNe,Lh({},s,{verticalPoints:N})),S.createElement(wNe,Lh({},s,{offset:n,horizontalPoints:_,xAxis:v,yAxis:w})),S.createElement(_Ne,Lh({},s,{offset:n,verticalPoints:N,xAxis:v,yAxis:w})))}nV.displayName="CartesianGrid";var sV=(e,t,r,n)=>uG(e,"xAxis",t,n),aV=(e,t,r,n)=>cG(e,"xAxis",t,n),iV=(e,t,r,n)=>uG(e,"yAxis",r,n),oV=(e,t,r,n)=>cG(e,"yAxis",r,n),ENe=bt([us,sV,iV,aV,oV],(e,t,r,n,s)=>Uf(e,"xAxis")?ME(t,n,!1):ME(r,s,!1)),NNe=(e,t,r,n,s)=>s;function ANe(e){return e.type==="line"}var jNe=bt([FH,NNe],(e,t)=>e.filter(ANe).find(r=>r.id===t)),PNe=bt([us,sV,iV,aV,oV,jNe,ENe,bA],(e,t,r,n,s,a,i,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(a==null||t==null||r==null||n==null||s==null||n.length===0||s.length===0||i==null)){var{dataKey:f,data:g}=a,p;if(g!=null&&g.length>0?p=g:p=c?.slice(u,d+1),p!=null)return ZNe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:s,dataKey:f,bandSize:i,displayedData:p})}}),FNe=["id"],ONe=["type","layout","connectNulls","needClip"],DNe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function aM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Wo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?aM(Object(r),!0).forEach(function(n){INe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):aM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function INe(e,t,r){return(t=RNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RNe(e){var t=MNe(e,"string");return typeof t=="symbol"?t:t+""}function MNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rj(e,t){if(e==null)return{};var r,n,s=LNe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function LNe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function S0(){return S0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S0.apply(null,arguments)}var BNe=e=>{var{dataKey:t,name:r,stroke:n,legendType:s,hide:a}=e;return[{inactive:a,dataKey:t,type:s,color:n,value:lW(r,t),payload:e}]};function $Ne(e){var{dataKey:t,data:r,stroke:n,strokeWidth:s,fill:a,name:i,hide:o,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:a,dataKey:t,nameKey:void 0,name:lW(i,t),hide:o,type:e.tooltipType,color:e.stroke,unit:c}}}var lV=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function UNe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],s=0;s<t;++s)n=[...n,...r];return n}var zNe=(e,t,r)=>{var n=r.reduce((f,g)=>f+g);if(!n)return lV(t,e);for(var s=Math.floor(e/n),a=e%n,i=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>a){o=[...r.slice(0,c),a-u];break}var d=o.length%2===0?[0,i]:[i];return[...UNe(r,s),...o,...d].map(f=>"".concat(f,"px")).join(", ")};function WNe(e,t){var r;if(S.isValidElement(e))r=S.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=ls("recharts-line-dot",typeof e!="boolean"?e.className:"");r=S.createElement(KG,S0({},t,{className:n}))}return r}function HNe(e,t){return e==null?!1:t?!0:e.length===1}function GNe(e){var{clipPathId:t,points:r,props:n}=e,{dot:s,dataKey:a,needClip:i}=n;if(!HNe(r,s))return null;var{id:o}=n,c=rj(n,FNe),u=oz(s),d=I0(c),f=gi(s,!0),g=r.map((x,v)=>{var w=Wo(Wo(Wo({key:"dot-".concat(v),r:3},d),f),{},{index:v,cx:x.x,cy:x.y,dataKey:a,value:x.value,payload:x.payload,points:r});return WNe(s,w)}),p={clipPath:i?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):void 0};return S.createElement(rp,S0({className:"recharts-line-dots",key:"dots"},p),g)}function VNe(e){var{showLabels:t,children:r,points:n}=e,s=S.useMemo(()=>n?.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return Wo(Wo({},i),{},{value:a.value,payload:a.payload,viewBox:i,parentViewBox:void 0,fill:void 0})}),[n]);return S.createElement(RTe,{value:t?s:null},r)}function iM(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:s,props:a}=e,{type:i,layout:o,connectNulls:c,needClip:u}=a,d=rj(a,ONe),f=Wo(Wo({},gi(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:o,connectNulls:c,strokeDasharray:s??a.strokeDasharray});return S.createElement(S.Fragment,null,n?.length>1&&S.createElement(pW,S0({},f,{pathRef:r})),S.createElement(GNe,{points:n,clipPathId:t,props:a}))}function KNe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function qNe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:s,longestAnimatedLengthRef:a}=e,{points:i,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:g,width:p,height:x,onAnimationEnd:v,onAnimationStart:w}=r,C=s.current,k=_W(r,"recharts-line-"),[_,N]=S.useState(!1),E=!_,P=S.useCallback(()=>{typeof v=="function"&&v(),N(!1)},[v]),F=S.useCallback(()=>{typeof w=="function"&&w(),N(!0)},[w]),A=KNe(n.current),j=a.current;return S.createElement(VNe,{points:i,showLabels:E},r.children,S.createElement(wW,{animationId:k,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:P,onAnimationStart:F,key:k},I=>{var L=Bu(j,A+j,I),Y=Math.min(L,A),Z;if(c)if(o){var ae="".concat(o).split(/[,\s]+/gim).map(B=>parseFloat(B));Z=zNe(Y,A,ae)}else Z=lV(A,Y);else Z=o==null?void 0:String(o);if(C){var ee=C.length/i.length,ne=I===1?i:i.map((B,V)=>{var M=Math.floor(V*ee);if(C[M]){var H=C[M];return Wo(Wo({},B),{},{x:Bu(H.x,B.x,I),y:Bu(H.y,B.y,I)})}return g?Wo(Wo({},B),{},{x:Bu(p*2,B.x,I),y:Bu(x/2,B.y,I)}):Wo(Wo({},B),{},{x:B.x,y:B.y})});return s.current=ne,S.createElement(iM,{props:r,points:ne,clipPathId:t,pathRef:n,strokeDasharray:Z})}return I>0&&A>0&&(s.current=i,a.current=Y),S.createElement(iM,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:Z})}),S.createElement(BTe,{label:r.label}))}function YNe(e){var{clipPathId:t,props:r}=e,n=S.useRef(null),s=S.useRef(0),a=S.useRef(null);return S.createElement(qNe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:s,pathRef:a})}var XNe=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:so(e.payload,t)});class JNe extends S.Component{render(){var t,{hide:r,dot:n,points:s,className:a,xAxisId:i,yAxisId:o,top:c,left:u,width:d,height:f,id:g,needClip:p}=this.props;if(r)return null;var x=ls("recharts-line",a),v=g,{r:w=3,strokeWidth:C=2}=(t=gi(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},k=oz(n),_=w*2+C;return S.createElement(S.Fragment,null,S.createElement(rp,{className:x},p&&S.createElement("defs",null,S.createElement(NEe,{clipPathId:v,xAxisId:i,yAxisId:o}),!k&&S.createElement("clipPath",{id:"clipPath-dots-".concat(v)},S.createElement("rect",{x:u-_/2,y:c-_/2,width:d+_,height:f+_}))),S.createElement(EEe,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:XNe,errorBarOffset:0},S.createElement(YNe,{props:this.props,clipPathId:v}))),S.createElement(vEe,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var cV={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!np.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function QNe(e){var t=Rl(e,cV),{activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:f,legendType:g,xAxisId:p,yAxisId:x,id:v}=t,w=rj(t,DNe),{needClip:C}=QG(p,x),k=JA(),_=Q3(),N=Il(),E=Pr(I=>PNe(I,p,x,N,v));if(_!=="horizontal"&&_!=="vertical"||E==null||k==null)return null;var{height:P,width:F,x:A,y:j}=k;return S.createElement(JNe,S0({},w,{id:v,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,isAnimationActive:d,hide:u,label:f,legendType:g,xAxisId:p,yAxisId:x,points:E,layout:_,height:P,width:F,left:A,top:j,needClip:C}))}function ZNe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:s,yAxisTicks:a,dataKey:i,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var f=so(u,i);if(t==="horizontal"){var g=tI({axis:r,ticks:s,bandSize:o,entry:u,index:d}),p=za(f)?null:n.scale(f);return{x:g,y:p,value:f,payload:u}}var x=za(f)?null:r.scale(f),v=tI({axis:n,ticks:a,bandSize:o,entry:u,index:d});return x==null||v==null?null:{x,y:v,value:f,payload:u}}).filter(Boolean)}function e4e(e){var t=Rl(e,cV),r=Il();return S.createElement(YTe,{id:t.id,type:"line"},n=>S.createElement(S.Fragment,null,S.createElement(HTe,{legendPayload:BNe(t)}),S.createElement(zTe,{fn:$Ne,args:t}),S.createElement(tEe,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),S.createElement(QNe,S0({},t,{id:n}))))}var uV=S.memo(e4e);uV.displayName="Line";var t4e=["dangerouslySetInnerHTML","ticks"],r4e=["id"],n4e=["domain"],s4e=["domain"];function oN(){return oN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},oN.apply(null,arguments)}function Eb(e,t){if(e==null)return{};var r,n,s=a4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function a4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function i4e(e){var t=io();return S.useEffect(()=>(t(iEe(e)),()=>{t(oEe(e))}),[e,t]),null}var o4e=e=>{var{xAxisId:t,className:r}=e,n=Pr(uW),s=Il(),a="xAxis",i=Pr(w=>cp(w,a,t,s)),o=Pr(w=>lG(w,a,t,s)),c=Pr(w=>jSe(w,t)),u=Pr(w=>RSe(w,t)),d=Pr(w=>NH(w,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:f,ticks:g}=e,p=Eb(e,t4e),{id:x}=d,v=Eb(d,r4e);return S.createElement(tj,oN({},p,v,{scale:i,x:u.x,y:u.y,width:c.width,height:c.height,className:ls("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},l4e={allowDataOverflow:Mo.allowDataOverflow,allowDecimals:Mo.allowDecimals,allowDuplicatedCategory:Mo.allowDuplicatedCategory,height:Mo.height,hide:!1,mirror:Mo.mirror,orientation:Mo.orientation,padding:Mo.padding,reversed:Mo.reversed,scale:Mo.scale,tickCount:Mo.tickCount,type:Mo.type,xAxisId:0},c4e=e=>{var t,r,n,s,a,i=Rl(e,l4e);return S.createElement(S.Fragment,null,S.createElement(i4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(o4e,i))},u4e=(e,t)=>{var{domain:r}=e,n=Eb(e,n4e),{domain:s}=t,a=Eb(t,s4e);return Dm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Dm({domain:r},{domain:s}):!1},dV=S.memo(c4e,u4e);dV.displayName="XAxis";var d4e=["dangerouslySetInnerHTML","ticks"],f4e=["id"],h4e=["domain"],g4e=["domain"];function lN(){return lN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lN.apply(null,arguments)}function Nb(e,t){if(e==null)return{};var r,n,s=m4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function m4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function p4e(e){var t=io();return S.useEffect(()=>(t(lEe(e)),()=>{t(cEe(e))}),[e,t]),null}var x4e=e=>{var{yAxisId:t,className:r,width:n,label:s}=e,a=S.useRef(null),i=S.useRef(null),o=Pr(uW),c=Il(),u=io(),d="yAxis",f=Pr(E=>cp(E,d,t,c)),g=Pr(E=>BSe(E,t)),p=Pr(E=>LSe(E,t)),x=Pr(E=>lG(E,d,t,c)),v=Pr(E=>AH(E,t));if(S.useLayoutEffect(()=>{if(!(n!=="auto"||!g||XA(s)||S.isValidElement(s)||v==null)){var E=a.current;if(E){var P=E.getCalculatedWidth();Math.round(g.width)!==Math.round(P)&&u(uEe({id:t,width:P}))}}},[x,g,u,s,t,n,v]),g==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:w,ticks:C}=e,k=Nb(e,d4e),{id:_}=v,N=Nb(v,f4e);return S.createElement(tj,lN({},k,N,{ref:a,labelRef:i,scale:f,x:p.x,y:p.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:g.width,height:g.height,className:ls("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:x}))},y4e={allowDataOverflow:Lo.allowDataOverflow,allowDecimals:Lo.allowDecimals,allowDuplicatedCategory:Lo.allowDuplicatedCategory,hide:!1,mirror:Lo.mirror,orientation:Lo.orientation,padding:Lo.padding,reversed:Lo.reversed,scale:Lo.scale,tickCount:Lo.tickCount,type:Lo.type,width:Lo.width,yAxisId:0},v4e=e=>{var t,r,n,s,a,i=Rl(e,y4e);return S.createElement(S.Fragment,null,S.createElement(p4e,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),S.createElement(x4e,i))},w4e=(e,t)=>{var{domain:r}=e,n=Nb(e,h4e),{domain:s}=t,a=Nb(t,g4e);return Dm(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:Dm({domain:r},{domain:s}):!1},fV=S.memo(v4e,w4e);fV.displayName="YAxis";var nT={exports:{}},sT={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oM;function _4e(){if(oM)return sT;oM=1;var e=k0();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,i=e.useMemo,o=e.useDebugValue;return sT.useSyncExternalStoreWithSelector=function(c,u,d,f,g){var p=s(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=i(function(){function w(E){if(!C){if(C=!0,k=E,E=f(E),g!==void 0&&x.hasValue){var P=x.value;if(g(P,E))return _=P}return _=E}if(P=_,r(k,E))return P;var F=f(E);return g!==void 0&&g(P,F)?(k=E,P):(k=E,_=F)}var C=!1,k,_,N=d===void 0?null:d;return[function(){return w(u())},N===null?void 0:function(){return w(N())}]},[u,d,f,g]);var v=n(c,p[0],p[1]);return a(function(){x.hasValue=!0,x.value=v},[v]),o(v),v},sT}var lM;function b4e(){return lM||(lM=1,nT.exports=_4e()),nT.exports}b4e();function S4e(e){e()}function k4e(){let e=null,t=null;return{clear(){e=null,t=null},notify(){S4e(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var cM={notify(){},get:()=>[]};function C4e(e,t){let r,n=cM,s=0,a=!1;function i(v){d();const w=n.subscribe(v);let C=!1;return()=>{C||(C=!0,w(),f())}}function o(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return a}function d(){s++,r||(r=e.subscribe(c),n=k4e())}function f(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=cM)}function g(){a||(a=!0,d())}function p(){a&&(a=!1,f())}const x={addNestedSub:i,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:g,tryUnsubscribe:p,getListeners:()=>n};return x}var T4e=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",E4e=T4e(),N4e=()=>typeof navigator<"u"&&navigator.product==="ReactNative",A4e=N4e(),j4e=()=>E4e||A4e?S.useLayoutEffect:S.useEffect,P4e=j4e(),F4e=Symbol.for("react-redux-context"),O4e=typeof globalThis<"u"?globalThis:{};function D4e(){if(!S.createContext)return{};const e=O4e[F4e]??=new Map;let t=e.get(S.createContext);return t||(t=S.createContext(null),e.set(S.createContext,t)),t}var I4e=D4e();function R4e(e){const{children:t,context:r,serverState:n,store:s}=e,a=S.useMemo(()=>{const c=C4e(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),i=S.useMemo(()=>s.getState(),[s]);P4e(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,i]);const o=r||I4e;return S.createElement(o.Provider,{value:a},t)}var M4e=R4e,L4e=(e,t)=>t,nj=bt([L4e,us,kH,Ta,kG,yd,Hke,mi],Yke),sj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},hV=Pl("mouseClick"),gV=Zv();gV.startListening({actionCreator:hV,effect:(e,t)=>{var r=e.payload,n=nj(t.getState(),sj(r));n?.activeIndex!=null&&t.dispatch(JSe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var cN=Pl("mouseMove"),mV=Zv();mV.startListening({actionCreator:cN,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=$A(n,n.tooltip.settings.shared),a=nj(n,sj(r));s==="axis"&&(a?.activeIndex!=null?t.dispatch(xG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(pG()))}});var uM={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},pV=Qo({name:"rootProps",initialState:uM,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:uM.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),B4e=pV.reducer,{updateOptions:$4e}=pV.actions,xV=Qo({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:cAe}=xV.actions,U4e=xV.reducer,yV=Pl("keyDown"),vV=Pl("focus"),aj=Zv();aj.startListening({actionCreator:yV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number(UA(s,dp(r))),o=yd(r);if(a==="Enter"){var c=Sb(r,"axis","hover",String(s.index));t.dispatch(tN({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:c}));return}var u=WSe(r),d=u==="left-to-right"?1:-1,f=a==="ArrowRight"?1:-1,g=i+f*d;if(!(o==null||g>=o.length||g<0)){var p=Sb(r,"axis","hover",String(g));t.dispatch(tN({active:!0,activeIndex:g.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});aj.startListening({actionCreator:vV,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip;if(!s.active&&s.index==null){var a="0",i=Sb(r,"axis","hover",String(a));t.dispatch(tN({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}});var pl=Pl("externalEvent"),wV=Zv();wV.startListening({actionCreator:pl,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Dke(r),activeDataKey:Fke(r),activeIndex:_v(r),activeLabel:EG(r),activeTooltipIndex:_v(r),isTooltipActive:Ike(r)};e.payload.handler(n,e.payload.reactEvent)}}});var z4e=bt([up],e=>e.tooltipItemPayloads),W4e=bt([z4e,c1,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var s=e.find(o=>o.settings.dataKey===n);if(s!=null){var{positions:a}=s;if(a!=null){var i=t(a,r);return i}}}),_V=Pl("touchMove"),bV=Zv();bV.startListening({actionCreator:_V,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=$A(n,n.tooltip.settings.shared);if(s==="axis"){var a=nj(n,sj({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&t.dispatch(xG({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(s==="item"){var i,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(b1e),d=(i=c.getAttribute(S1e))!==null&&i!==void 0?i:void 0,f=W4e(t.getState(),u,d);t.dispatch(XSe({activeDataKey:d,activeIndex:u,activeCoordinate:f}))}}});var H4e=Rz({brush:jEe,cartesianAxis:dEe,chartData:fCe,errorBars:_Ee,graphicalItems:eEe,layout:qve,legend:L1e,options:oCe,polarAxis:UTe,polarOptions:U4e,referenceElements:MEe,rootProps:B4e,tooltip:QSe}),G4e=function(t){return vve({reducer:H4e,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([gV.middleware,mV.middleware,aj.middleware,wV.middleware,bV.middleware]),devTools:np.devToolsEnabled})};function V4e(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,s=Il(),a=S.useRef(null);if(s)return r;a.current==null&&(a.current=G4e(t));var i=G3;return S.createElement(M4e,{context:i,store:a.current},r)}function K4e(e){var{layout:t,width:r,height:n,margin:s}=e,a=io(),i=Il();return S.useEffect(()=>{i||(a(Gve(t)),a(Vve({width:r,height:n})),a(Hve(s)))},[a,i,t,r,n,s]),null}function q4e(e){var t=io();return S.useEffect(()=>{t($4e(e))},[t,e]),null}var Y4e=["children"];function X4e(e,t){if(e==null)return{};var r,n,s=J4e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function J4e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Ab(){return Ab=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ab.apply(null,arguments)}var Q4e={width:"100%",height:"100%"},Z4e=S.forwardRef((e,t)=>{var r=fW(),n=hW(),s=mW();if(!ob(r)||!ob(n))return null;var{children:a,otherAttributes:i,title:o,desc:c}=e,u,d;return typeof i.tabIndex=="number"?u=i.tabIndex:u=s?0:void 0,typeof i.role=="string"?d=i.role:d=s?"application":void 0,S.createElement(lz,Ab({},i,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:Q4e,ref:t}),a)}),e3e=e=>{var{children:t}=e,r=Pr(C2);if(!r)return null;var{width:n,height:s,y:a,x:i}=r;return S.createElement(lz,{width:n,height:s,x:i,y:a},t)},dM=S.forwardRef((e,t)=>{var{children:r}=e,n=X4e(e,Y4e),s=Il();return s?S.createElement(e3e,null,r):S.createElement(Z4e,Ab({ref:t},n),r)});function t3e(){var e=io(),[t,r]=S.useState(null),n=Pr(_1e);return S.useEffect(()=>{if(t!=null){var s=t.getBoundingClientRect(),a=s.width/t.offsetWidth;fc(a)&&a!==n&&e(Kve(a))}},[t,e,n]),r}function fM(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function r3e(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?fM(Object(r),!0).forEach(function(n){n3e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fM(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n3e(e,t,r){return(t=s3e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s3e(e){var t=a3e(e,"string");return typeof t=="symbol"?t:t+""}function a3e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var i3e=S.forwardRef((e,t)=>{var{children:r,className:n,height:s,onClick:a,onContextMenu:i,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:g,onTouchEnd:p,onTouchMove:x,onTouchStart:v,style:w,width:C}=e,k=io(),[_,N]=S.useState(null),[E,P]=S.useState(null);_Ce();var F=t3e(),A=S.useCallback(R=>{F(R),typeof t=="function"&&t(R),N(R),P(R)},[F,t,N,P]),j=S.useCallback(R=>{k(hV(R)),k(pl({handler:a,reactEvent:R}))},[k,a]),I=S.useCallback(R=>{k(cN(R)),k(pl({handler:u,reactEvent:R}))},[k,u]),L=S.useCallback(R=>{k(pG()),k(pl({handler:d,reactEvent:R}))},[k,d]),Y=S.useCallback(R=>{k(cN(R)),k(pl({handler:f,reactEvent:R}))},[k,f]),Z=S.useCallback(()=>{k(vV())},[k]),ae=S.useCallback(R=>{k(yV(R.key))},[k]),ee=S.useCallback(R=>{k(pl({handler:i,reactEvent:R}))},[k,i]),ne=S.useCallback(R=>{k(pl({handler:o,reactEvent:R}))},[k,o]),B=S.useCallback(R=>{k(pl({handler:c,reactEvent:R}))},[k,c]),V=S.useCallback(R=>{k(pl({handler:g,reactEvent:R}))},[k,g]),M=S.useCallback(R=>{k(pl({handler:v,reactEvent:R}))},[k,v]),H=S.useCallback(R=>{k(_V(R)),k(pl({handler:x,reactEvent:R}))},[k,x]),W=S.useCallback(R=>{k(pl({handler:p,reactEvent:R}))},[k,p]);return S.createElement(OG.Provider,{value:_},S.createElement(Rxe.Provider,{value:E},S.createElement("div",{className:ls("recharts-wrapper",n),style:r3e({position:"relative",cursor:"default",width:C,height:s},w),onClick:j,onContextMenu:ee,onDoubleClick:ne,onFocus:Z,onKeyDown:ae,onMouseDown:B,onMouseEnter:I,onMouseLeave:L,onMouseMove:Y,onMouseUp:V,onTouchEnd:W,onTouchMove:H,onTouchStart:M,ref:A},r)))}),o3e=["children","className","width","height","style","compact","title","desc"];function l3e(e,t){if(e==null)return{};var r,n,s=c3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function c3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var u3e=S.forwardRef((e,t)=>{var{children:r,className:n,width:s,height:a,style:i,compact:o,title:c,desc:u}=e,d=l3e(e,o3e),f=I0(d);return o?S.createElement(dM,{otherAttributes:f,title:c,desc:u},r):S.createElement(i3e,{className:n,style:i,width:s,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},S.createElement(dM,{otherAttributes:f,title:c,desc:u,ref:t},S.createElement(BEe,null,r)))}),d3e=["width","height"];function uN(){return uN=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},uN.apply(null,arguments)}function f3e(e,t){if(e==null)return{};var r,n,s=h3e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function h3e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var g3e={top:5,right:5,bottom:5,left:5},m3e={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:g3e,reverseStackOrder:!1,syncMethod:"index"},p3e=S.forwardRef(function(t,r){var n,s=Rl(t.categoricalChartProps,m3e),{width:a,height:i}=s,o=f3e(s,d3e);if(!ob(a)||!ob(i))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:g}=t,p={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return S.createElement(V4e,{preloadedState:{options:p},reduxStoreName:(n=g.id)!==null&&n!==void 0?n:c},S.createElement(AEe,{chartData:g.data}),S.createElement(K4e,{width:a,height:i,layout:s.layout,margin:s.margin}),S.createElement(q4e,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),S.createElement(u3e,uN({},o,{width:a,height:i,ref:r})))}),x3e=["axis"],y3e=S.forwardRef((e,t)=>S.createElement(p3e,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:x3e,tooltipPayloadSearcher:aCe,categoricalChartProps:e,ref:t}));const v3e=({data:e=[],loading:t=!1,error:r=null})=>{if(t)return l.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:l.jsx("div",{className:"spinner-border text-primary",role:"status",children:l.jsx("span",{className:"visually-hidden",children:"Loading..."})})});if(r)return l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("h5",{className:"alert-heading",children:"Error Loading Performance Data"}),l.jsx("p",{children:r})]});if(!e||e.length===0)return l.jsx("div",{className:"text-center text-muted",style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsxs("div",{children:[l.jsx("h5",{children:"No Test Data Available"}),l.jsx("p",{children:"No tests have been completed yet for the current term."})]})});const n=e.map(s=>({testName:s.test_name,testDate:s.submitted_at,averageScore:parseFloat(s.average_score),totalStudents:s.total_students,testId:s.test_id}));return l.jsxs("div",{className:"test-performance-graph",children:[l.jsx("div",{style:{width:"100%",height:"400px"},children:l.jsx(BCe,{children:l.jsxs(y3e,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[l.jsx(nV,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),l.jsx(dV,{dataKey:"testDate",tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),stroke:"#666",fontSize:12}),l.jsx(fV,{domain:[0,100],tickFormatter:s=>`${s}%`,stroke:"#666",fontSize:12}),l.jsx(ACe,{formatter:(s,a)=>[`${parseFloat(s).toFixed(1)}%`,"Average Score"],labelFormatter:s=>{const a=n.find(i=>i.testDate===s);if(a){const i=new Date(s);return`${a.testName} (${i.toLocaleDateString("en-US",{month:"long",day:"numeric"})})`}return s},contentStyle:{backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),l.jsx(uV,{type:"monotone",dataKey:"averageScore",stroke:"#007bff",strokeWidth:3,connectNulls:!0,dot:{r:6,fill:"#007bff",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#ff6b35",stroke:"#fff",strokeWidth:2}})]})})}),l.jsx("div",{className:"mt-3",children:l.jsxs("div",{className:"row",children:[l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Total Tests: "}),l.jsx("strong",{children:n.length})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Average Score: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(i=>i.averageScore!==null&&i.averageScore!==void 0&&!isNaN(i.averageScore));return s.length===0?"N/A":`${(s.reduce((i,o)=>i+o.averageScore,0)/s.length).toFixed(1)}%`})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Best Test: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(a=>a.averageScore!==null&&a.averageScore!==void 0&&!isNaN(a.averageScore));return s.length===0?"N/A":s.reduce((a,i)=>i.averageScore>a.averageScore?i:a).testName})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Latest Test: "}),l.jsx("strong",{children:n.length>0?n[n.length-1].testName:"N/A"})]})})]})})]})},hM=({onBackToLogin:e})=>{const t=Eo(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=cs(),{teacherData:i,loadTeacherData:o}=r2(),{activeTests:c,loadActiveTests:u}=zv(),{showNotification:d,notifications:f}=ka(),[g,p]=S.useState(!0),[x,v]=S.useState(""),[w,C]=S.useState("main"),[k,_]=S.useState([]),[N,E]=S.useState([]),[P,F]=S.useState(null),[A,j]=S.useState(null),[I,L]=S.useState(null),[Y,Z]=S.useState(!1),[ae,ee]=S.useState(!1),[ne,B]=S.useState(null),[V,M]=S.useState(!1),[H,W]=S.useState(null),[R,z]=S.useState(!1),[K,J]=S.useState(null),[se,X]=S.useState(null),[ie,le]=S.useState([]),[ce,be]=S.useState(!1),[re,pe]=S.useState(null),[Ce,Ae]=S.useState([]),[We,Le]=S.useState(!1),[At,Qe]=S.useState(null),[gt,ht]=S.useState(null),[tt,ut]=S.useState(!1),[Dt,Rt]=S.useState(!1),[It,De]=S.useState(0),[Ie,Je]=S.useState(!1),[qe,Ze]=S.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Tt,Nt]=S.useState([]),[$t,ir]=S.useState([]),[pr,Nr]=S.useState(!1),[dr,Vt]=S.useState(!1),[ge,Te]=S.useState(null),[Fe,Me]=S.useState([]),[kt,Pe]=S.useState(!1),[He,ke]=S.useState("subject");S.useEffect(()=>{Dr()},[]),S.useEffect(()=>{const Be=Ct=>{tt&&!Ct.target.closest(".relative")&&ut(!1),Dt&&!Ct.target.closest(".relative")&&Rt(!1)};return document.addEventListener("mousedown",Be),()=>{document.removeEventListener("mousedown",Be)}},[tt,Dt]);const $e=S.useCallback(()=>{me.debug(" showChangePasswordTab called"),Je(!0),ut(!1),Rt(!1)},[]),Ue=S.useCallback(()=>{me.debug(" hideChangePasswordTab called"),Je(!1),Ze({currentPassword:"",newPassword:"",confirmPassword:""})},[]),Et=S.useCallback(async()=>{if(!r)return;const{currentPassword:Be,newPassword:Ct,confirmPassword:qt}=qe;if(!Be||!Ct||!qt){d("Please fill in all fields","error");return}if(Ct!==qt){d("New passwords do not match","error");return}if(Ct.length<6){d("New password must be at least 6 characters long","error");return}const lr=/[a-zA-Z]/.test(Ct),es=/[0-9]/.test(Ct);if(!lr||!es){d("New password must contain both letters and numbers","error");return}try{const Kn=await hs.changePassword({username:r.username,currentPassword:Be,newPassword:Ct});Kn.success?(d("Password changed successfully!","success"),Ue()):d(Kn.message||"Failed to change password","error")}catch(Kn){me.error("Password change error:",Kn),d("Failed to change password. Please try again.","error")}},[r,qe,d]),Ft=S.useCallback(Be=>{const{name:Ct,value:qt}=Be.target;Ze(lr=>({...lr,[Ct]:qt}))},[]),zt=S.useCallback(async()=>{me.debug(" Loading teacher data...");try{const Be=await hs.getTeacherData();return me.debug(" Teacher data loaded:",Be),X(new Date),Be}catch(Be){throw me.error(" Error loading teacher data:",Be),Be}},[]),fr=S.useCallback(async(Be=null)=>{me.debug(" Loading teacher subjects...");try{if(!Be){const lr=`teacher_subjects_${r?.teacher_id||r?.id||""}`,es=Rs(lr);if(es)return me.debug(" Using cached teacher subjects"),_(es),es}let Ct=Be,qt;if(Be?(me.debug(" Using passed teacher data for subjects"),qt=hs.getTeacherSubjects(Be.subjects)):(me.debug(" No teacher data passed, fetching from API"),Ct=await hs.getTeacherData(),me.debug(" Raw teacher data:",Ct),qt=hs.getTeacherSubjects(Ct.subjects)),me.debug(" Teacher subjects loaded:",qt),_(qt),!Be){const lr=`teacher_subjects_${r?.teacher_id||r?.id||""}`;vs(lr,qt,Is.teacher_subjects)}return me.debug(" Available classes for performance chart:",qt[0]?.classes||[]),me.debug(" Performance chart will load when user clicks on a class"),qt}catch(Ct){throw me.error(" Error loading teacher subjects:",Ct),Ct}},[r?.teacher_id,r?.id]),nr=S.useCallback(async()=>{me.debug(" Loading teacher active tests...");try{const Be=`teacher_tests_${r?.teacher_id||r?.id||""}`,Ct=Rs(Be);Ct&&Ct.some(es=>es.test_type==="drawing")&&(me.debug(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Be));const qt=Rs(Be);if(qt)return me.debug(" Using cached teacher tests"),E(qt),qt;const lr=await hn.getTeacherTests();return me.debug(" Teacher tests loaded:",lr),E(lr),vs(Be,lr,Is.teacher_tests),lr}catch(Be){throw me.error(" Error loading teacher tests:",Be),Be}},[r?.teacher_id,r?.id]),Dr=S.useCallback(async()=>{me.debug(" Initializing Teacher Cabinet...");try{if(p(!0),v(""),!n||!r){me.debug(" User not authenticated"),v("User not authenticated");return}if(r.role!==Qi.TEACHER){me.error(" Invalid user role for teacher cabinet:",r.role),v("Access denied. Teacher role required.");return}me.debug(" Loading teacher data...");const Be=await zt();me.debug(" Loading subjects and tests in parallel...");const[Ct,qt]=await Promise.allSettled([fr(Be),nr()]);let lr=!1;Ct.status==="rejected"&&(me.warn(" Subjects loading failed:",Ct.reason),lr=!0),qt.status==="rejected"&&(me.warn(" Tests loading failed:",qt.reason),lr=!0),lr&&d("Some data failed to load, but you can continue","warning"),me.debug(" Teacher Cabinet initialization complete!")}catch(Be){me.error(" Error initializing teacher cabinet:",Be),v("Failed to initialize teacher cabinet")}finally{p(!1)}},[n,r,zt,fr,nr,d]),ue=S.useCallback(()=>{me.debug(" Showing subject selection prompt..."),Z(!0),we(),ke("subject")},[]),we=S.useCallback(async()=>{me.debug(" Loading available subjects..."),Nr(!0);try{const Be=await hs.getSubjectsForSelection();Nt(Be),me.debug(" Available subjects loaded:",Be)}catch(Be){me.error(" Error loading available subjects:",Be),d("Failed to load subjects","error")}finally{Nr(!1)}},[]),ye=S.useCallback(Be=>{if(!Be){Te(null);return}const Ct=Tt.find(qt=>qt.subject_id==Be);Ct&&(Te(Ct),Me([]),ke("classes"))},[Tt]),xe=S.useCallback((Be,Ct)=>{Me(qt=>qt.some(lr=>lr.grade===Be&&lr.class===Ct)?qt.filter(lr=>!(lr.grade===Be&&lr.class===Ct)):[...qt,{grade:Be,class:Ct}])},[]),_e=S.useCallback(()=>{if(!ge||Fe.length===0){d("Please select at least one class","warning");return}const Be={subject_id:parseInt(ge.subject_id),subject_name:ge.subject,classes:Fe};ir(Ct=>[...Ct,Be]),Te(null),Me([]),ke("subject"),d(`Added ${ge.subject} with ${Fe.length} classes`,"success")},[ge,Fe]),Se=S.useCallback(Be=>{ir(Ct=>Ct.filter((qt,lr)=>lr!==Be))},[]),Ve=S.useCallback(async(Be,Ct,qt)=>{me.debug(" Deleting teacher subject:",{subjectId:Be,grade:Ct,classNumber:qt});try{const lr={subjectId:Be,grade:Ct,class:qt};me.debug(" Sending delete request with data:",lr);const es=await hs.deleteTeacherSubject(lr);if(es.success)d("Subject assignment deleted successfully!","success"),await fr();else throw new Error(es.error||"Failed to delete subject assignment")}catch(lr){me.error(" Error deleting subject assignment:",lr),d("Error deleting subject assignment. Please try again.","error")}},[fr,d]),lt=S.useCallback((Be,Ct,qt,lr)=>{J({subjectId:Be,subjectName:Ct,grade:qt,classNumber:lr}),z(!0)},[]),Ke=S.useCallback(async()=>{K&&(await Ve(K.subjectId,K.grade,K.classNumber),z(!1),J(null))},[K,Ve]),oe=S.useCallback(()=>{z(!1),J(null)},[]),fe=S.useCallback(async()=>{if($t.length===0){d("Please select at least one subject","warning");return}Vt(!0);try{const Be=await hs.saveTeacherSubjects($t);if(Be.success)d("Subjects saved successfully!","success"),Z(!1),ir([]),ke("subject"),await fr();else throw new Error(Be.error||"Failed to save subjects")}catch(Be){me.error(" Error saving teacher subjects:",Be),d("Failed to save subjects","error")}finally{Vt(!1)}},[$t,fr]);S.useCallback(async Be=>{me.debug(" Saving teacher subjects:",Be);try{const Ct=await hs.saveTeacherSubjects(Be);if(Ct.success)d("Subjects saved successfully!","success"),await fr(),Z(!1);else throw new Error(Ct.error||"Failed to save subjects")}catch(Ct){me.error(" Error saving teacher subjects:",Ct),d("Failed to save subjects","error")}},[fr]);const Ee=S.useCallback(()=>{me.debug(" Showing active tests..."),C("tests")},[]),Ne=S.useCallback(Be=>{me.debug(" Showing test details:",Be),B(Be),ee(!0)},[]);S.useCallback(async(Be,Ct,qt)=>{me.debug(" Removing class assignment:",Be,Ct,qt);try{const lr=await hn.removeClassAssignment(Be,Ct,qt);if(lr.success)d("Assignment removed successfully!","success"),await nr();else throw new Error(lr.error||"Failed to remove assignment")}catch(lr){me.error(" Error removing class assignment:",lr),d("Failed to remove assignment","error")}},[nr]);const Ye=S.useCallback(async(Be,Ct)=>{me.debug(" Marking test as completed:",Be,Ct),pe(Ct);try{const qt=await hn.markTestCompleted(Be,Ct);if(qt.success){d("Test marked as completed!","success");const lr=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(lr),me.debug(" Cleared teacher tests cache"),await nr()}else throw new Error(qt.error||"Failed to mark test as completed")}catch(qt){me.error(" Error marking test as completed:",qt),d("Failed to mark test as completed","error")}finally{pe(null)}},[nr,d,r?.teacher_id,r?.id]),ot=S.useCallback(async()=>{me.debug(" Refreshing active tests data...");try{const Be=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Be),me.debug(" Cache cleared, forcing fresh API call"),me.debug(" Making direct API call to get-teacher-active-tests with noCache");const Ct=await hn.getTeacherTests(!0);me.debug(" Direct API call returned:",Ct),E(Ct),me.debug(" activeTestsData state updated:",Ct),d(`Tests refreshed successfully! Found ${Ct?.length||0} tests.`,"success")}catch(Be){me.error(" Error refreshing tests:",Be),d("Failed to refresh tests","error")}},[r?.teacher_id,r?.id]),pt=S.useCallback(async(Be=null)=>{if(r?.teacher_id){Le(!0),Qe(null);try{me.debug(" Loading test performance data for class:",Be);const Ct=await xxe.getTestPerformance(r.teacher_id,Be);Ae(Ct),me.debug(" Test performance data loaded:",Ct.length,"tests")}catch(Ct){me.error(" Error loading test performance data:",Ct),Qe(Ct.message)}finally{Le(!1)}}},[r?.teacher_id]);S.useCallback((Be,Ct)=>{me.debug(" Showing class results:",Be,Ct),me.debug(" Class click - grade:",Be,"className:",Ct),j(Be),L(Ct),C("results");const qt=`${Be}/${Ct}`;me.debug(" Loading performance data for clicked class:",qt),ht(qt),pt(qt)},[pt]);const[Gt,xt]=S.useState([]),[Jt,wr]=S.useState([]),Sr=S.useCallback(async()=>{try{const Ct=await(await Zi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);xt(Ct)}catch(Be){me.warn("Failed to load retests",Be)}},[r]);S.useCallback(async Be=>{try{const qt=await(await Zi(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(Be);wr(qt)}catch(Ct){me.warn("Failed to load retest targets",Ct)}},[]);const[xr,Ir]=S.useState(!1),[rn,Jr]=S.useState(!1);S.useEffect(()=>{me.debug("[TeacherCabinet] showRetestModal state changed:",xr)},[xr]);const[he,vt]=S.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),kr=S.useCallback(async Be=>{me.debug("[TeacherCabinet] openRetestModal called with:",Be);const{test_type:Ct,original_test_id:qt,subject_id:lr,failedStudentIds:es=[],grade:Kn,class:Mi}=Be||{};vt({test_type:Ct||"multiple_choice",original_test_id:qt||"",subject_id:lr||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:es}),Kn!==void 0&&j(Kn),Mi!==void 0&&L(Mi),me.debug("[TeacherCabinet] Setting showRetestModal to true"),Ir(!0)},[]),Cr=S.useCallback(async()=>{Jr(!0);try{const Be=await Zi(()=>import("./retestService-C6b0YDiD.js"),[]),Ct=new Date,qt=new Date(Ct.getTime()+he.window_days*24*60*60*1e3),lr={...he,teacher_id:r.teacher_id,grade:A,class:I,window_start:Ct.toISOString(),window_end:qt.toISOString()};me.debug("[Retest][TeacherCabinet] Prepared payload:",JSON.stringify(lr)),me.debug("[Retest][TeacherCabinet] Selected students count:",(lr.student_ids||[]).length,"IDs:",lr.student_ids),await Be.retestService.createRetestAssignment(lr),d("Retest created","success"),Ir(!1),Sr(),De(es=>es+1)}catch(Be){me.error("Create retest error",Be),d(Be.message||"Failed to create retest","error")}finally{Jr(!1)}},[he,A,I,Sr]);if(g)return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2"})]});if(x)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:x}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs(at.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(at.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(at.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),l.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),l.jsxs(at.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx("div",{className:"hidden md:block",children:l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>ut(!tt),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[l.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:tt?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),tt&&l.jsxs(at.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("button",{onClick:()=>{ut(!1),$e()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{ut(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("button",{onClick:()=>Rt(!Dt),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Dt&&l.jsxs(at.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),l.jsxs("button",{onClick:()=>{Rt(!1),$e()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Rt(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})]})]})})}),l.jsx(at.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:l.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((Be,Ct)=>l.jsxs(at.button,{onClick:()=>Be.key==="tests"?Ee():C(Be.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 flex-1 sm:flex-none ${w===Be.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+Ct*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[l.jsx("span",{className:"sm:hidden",children:Be.shortLabel}),l.jsx("span",{className:"hidden sm:inline",children:Be.label})]},Be.key))})})}),l.jsx(at.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:l.jsxs(wo,{mode:"wait",children:[w==="main"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Nn()},"main"),w==="subjects"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:_n()},"subjects"),w==="tests"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Zr()},"tests"),w==="results"&&l.jsx(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(ez,{selectedGrade:A,selectedClass:I,onBackToCabinet:()=>C("main"),openRetestModal:kr,forceRefreshOnMount:It>0},It)},"results")]})}),Y&&l.jsx(oa,{isOpen:Y,onClose:()=>{Z(!1),ke("subject"),ir([]),Te(null),Me([])},title:"Select Subjects and Classes",size:"large",children:l.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[He==="subject"&&l.jsxs(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),pr?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):l.jsxs("select",{value:ge?.subject_id||"",onChange:Be=>ye(Be.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Select a subject"}),Tt.map(Be=>l.jsx("option",{value:Be.subject_id,children:Be.subject},Be.subject_id))]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(et,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(et,{variant:"primary",onClick:()=>ke("classes"),disabled:!ge,children:"Next: Select Classes"})]})]}),He==="classes"&&ge&&l.jsxs(at.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",ge.subject]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),l.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6,7].map(Be=>{let Ct;return Be===1||Be===2||Be===3?Ct=[15,16]:Be===4||Be===5||Be===6?Ct=[13,14]:Be===7?Ct=[69]:Ct=[],l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",Be]}),l.jsx("div",{className:"space-y-1",children:Ct.map(qt=>l.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[l.jsx("input",{type:"checkbox",checked:Fe.some(lr=>lr.grade===Be.toString()&&lr.class===qt.toString()),onChange:()=>xe(Be.toString(),qt.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",qt]})]},qt))})]},Be)})})})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(et,{variant:"outline",onClick:()=>ke("subject"),children:"Back to Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(et,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(et,{variant:"primary",onClick:_e,disabled:Fe.length===0,children:"Add Subject"})]})]})]}),$t.length>0&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:$t.map((Be,Ct)=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:Be.subject_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",Be.classes.map(qt=>`Grade ${qt.grade} Class ${qt.class}`).join(", ")]})]}),l.jsx("button",{onClick:()=>Se(Ct),className:"text-red-600 hover:text-red-800 p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Ct))})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(et,{variant:"outline",onClick:()=>ke("subject"),children:"Add More Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(et,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(et,{variant:"primary",onClick:fe,disabled:dr,className:"relative",children:dr?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save All Subjects"})]})]})]})]})}),xr&&l.jsxs(oa,{isOpen:xr,onClose:()=>Ir(!1),title:"Create Retest",size:"medium",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:he.window_days,onChange:Be=>vt(Ct=>({...Ct,window_days:Number(Be.target.value)})),children:[l.jsx("option",{value:1,children:"1 day"}),l.jsx("option",{value:2,children:"2 days"}),l.jsx("option",{value:3,children:"3 days"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:he.max_attempts,onChange:Be=>vt(Ct=>({...Ct,max_attempts:Number(Be.target.value)})),children:[l.jsx("option",{value:1,children:"1 attempt"}),l.jsx("option",{value:2,children:"2 attempts"}),l.jsx("option",{value:3,children:"3 attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>Ir(!1),disabled:rn,className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),l.jsx("button",{onClick:Cr,disabled:rn,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:rn?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm"}),"Creating Retest..."]}):"Create Retest"})]})]}),ae&&ne&&l.jsxs(oa,{isOpen:ae,onClose:()=>ee(!1),title:"Test Details",size:"large",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:ne.test_name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),l.jsx("p",{className:"text-sm text-gray-900",children:ne.subject})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),l.jsx("p",{className:"text-sm text-gray-900",children:ne.test_type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),l.jsx("p",{className:"text-sm text-gray-900",children:new Date(ne.created_at).toLocaleDateString()})]}),ne.assignments&&ne.assignments.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:ne.assignments.map((Be,Ct)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[Be.grade,"/",Be.class]},Ct))})]})]}),l.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:l.jsx(et,{variant:"outline",onClick:()=>ee(!1),children:"Close"})})]}),R&&K&&l.jsx(oa,{isOpen:R,onClose:oe,title:"Delete Subject Assignment",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",l.jsx("span",{className:"font-semibold text-gray-900",children:K.subjectName})," ","in Grade ",K.grade,", Class ",K.classNumber,"?"]}),l.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(et,{variant:"outline",onClick:oe,children:"Cancel"}),l.jsx(et,{variant:"danger",onClick:Ke,children:"Delete Assignment"})]})]})}),l.jsx(at.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:f.map(Be=>l.jsx(at.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:l.jsx("div",{className:`p-4 rounded-lg shadow-lg ${Be.type==="success"?"bg-green-600 text-white":Be.type==="error"?"bg-red-600 text-white":Be.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:Be.message}),l.jsx("button",{onClick:()=>setNotifications(Ct=>Ct.filter(qt=>qt.id!==Be.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},Be.id))}),Ie&&l.jsx(oa,{isOpen:Ie,onClose:Ue,title:"Change Password",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",name:"currentPassword",value:qe.currentPassword,onChange:Ft,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",name:"newPassword",value:qe.newPassword,onChange:Ft,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",name:"confirmPassword",value:qe.confirmPassword,onChange:Ft,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(et,{type:"button",variant:"secondary",onClick:Ue,className:"flex-1",children:"Cancel"}),l.jsx(et,{type:"button",onClick:Et,className:"flex-1",children:"Change Password"})]})]})})]});function Nn(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"My Subjects & Classes"})}),l.jsx(jt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),l.jsx(et,{variant:"outline",onClick:()=>C("subjects"),children:"Manage Subjects"})]}):l.jsx("div",{className:"space-y-6",children:k.map((Be,Ct)=>l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+Ct*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Be.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[Be.classes?.length||0," classes"]})]}),Be.classes&&Be.classes.length>0?l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Be.classes.map((qt,lr)=>l.jsx(at.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+Ct*.1+lr*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(et,{variant:"outline",size:"sm",onClick:()=>{j(qt.grade),L(qt.class),C("results")},className:"font-medium",children:[qt.grade,"/",qt.class]})},lr))}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},Be.id))})})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:l.jsxs(jt,{children:[l.jsxs(jt.Header,{children:[l.jsx(jt.Title,{children:"Test Performance Overview"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Test performance over time with average scores"})]}),l.jsx(jt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const Be=[];return k.forEach(Ct=>{Ct.classes&&Ct.classes.forEach(qt=>{const lr=`${qt.grade}/${qt.class}`;Be.find(es=>es.key===lr)||Be.push({key:lr,grade:qt.grade,class:qt.class,subject:Ct.name})})}),Be})().map((Be,Ct)=>l.jsxs("button",{onClick:()=>{me.debug(" Class button clicked:",Be.key),ht(Be.key),pt(Be.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${gt===Be.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[Be.grade,"/",Be.class]},Be.key))}),gt?l.jsx("div",{className:"mt-4",children:l.jsx(v3e,{data:Ce,loading:We,error:At})}):l.jsxs("div",{className:"mt-4 text-center text-muted py-4",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"Select a class above to view test performance data"})]})]})})]})})]})}function _n(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(jt.Title,{children:"Subject Management"}),l.jsx(et,{variant:"primary",onClick:ue,children:"Add Subject"})]})})})}),k.length===0?l.jsx(at.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(at.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),l.jsx(et,{variant:"primary",onClick:ue,size:"lg",children:"Add Your First Subject"})]})})})}):l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:l.jsxs(jt,{children:[l.jsx(jt.Header,{children:l.jsx(jt.Title,{children:"Your Subjects"})}),l.jsx(jt.Body,{children:l.jsx("div",{className:"space-y-4",children:k.map((Be,Ct)=>l.jsx(at.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+Ct*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:l.jsx("div",{className:"flex justify-between items-start",children:l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:Be.name}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Be.classes?.map((qt,lr)=>l.jsxs(at.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+Ct*.1+lr*.05,duration:.2},whileHover:{scale:1.1},children:[l.jsxs("span",{children:[qt.grade," - ",qt.className]}),l.jsx("button",{onClick:()=>lt(Be.id,Be.name,qt.grade,qt.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},lr))||l.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},Ct))})})]})})]})}function Zr(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(jt.Title,{children:"Active Tests"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(et,{variant:"outline",onClick:ot,children:"Refresh"}),l.jsx(et,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),N.length===0?l.jsx(at.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(jt,{children:l.jsx(jt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(at.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),l.jsx(et,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:N.map((Be,Ct)=>l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+Ct*.1,duration:.3},whileHover:{scale:1.01},children:l.jsx(jt,{children:l.jsx(jt.Body,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:Be.test_name}),l.jsx("span",{className:"hidden sm:inline-block bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:Be.test_type}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Assignments:"}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:Be.assignments?.length||0})]}),Be.assignments&&Be.assignments.length>0&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:Be.assignments.map((qt,lr)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[qt.grade,"/",qt.class]},lr))})]}),l.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(Be.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[l.jsx("div",{className:"sm:hidden",children:l.jsx(et,{variant:"outline",onClick:()=>Ne(Be),size:"sm",className:"text-xs",title:`Type: ${Be.test_type} | Assignments: ${Be.assignments?.length||0} | Classes: ${Be.assignments?.map(qt=>`${qt.grade}/${qt.class}`).join(", ")||"None"} | ${new Date(Be.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),l.jsx("div",{className:"hidden sm:block",children:l.jsx(et,{variant:"outline",onClick:()=>Ne(Be),size:"sm",children:"Details"})}),l.jsx(et,{variant:"success",onClick:()=>Ye(Be.test_type,Be.test_id),size:"sm",disabled:re===Be.test_id,children:re===Be.test_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete"})]})]})})})},Ct))})]})}},w3e={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},gM=()=>{const{user:e}=cs();Zse();const{notifications:t,showNotification:r,removeNotification:n}=ka(),[s,a]=S.useState(!1),[i,o]=S.useState(!1),[c,u]=S.useState("typeSelection"),[d,f]=S.useState(!1),[g,p]=S.useState(null),[x,v]=S.useState([]),[w,C]=S.useState(!1),[k,_]=S.useState(!1),[N,E]=S.useState(!1),[P,F]=S.useState(!1),[A,j]=S.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[I,L]=S.useState([]),[Y,Z]=S.useState(null);S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null),S.useRef(null);const ae=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),W(),console.log(" Test creation initialization complete")},[e,r]),ee=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),ne(),u("typeSelection"),V("testTypeSelection")},[e,r]),ne=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),f(!0)},[e]),B=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),f(!1)},[e]),V=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",oe),console.log("  Call stack:",new Error().stack);const fe={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},Ee={isInTestCreation:!0,currentStep:oe,timestamp:Date.now(),excelState:fe};localStorage.setItem("test_creation_state",JSON.stringify(Ee)),console.log(" Saved test creation state:",Ee);const Ne={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":Ne.testName=A.testName||"",Ne.numQuestions=A.numQuestions||"",Ne.numOptions=A.numOptions||"",Ne.questions=A.questions||{};break;case"trueFalseForm":Ne.testName=A.testName||"",Ne.numQuestions=A.numQuestions||"",Ne.questions=A.questions||{};break;case"inputForm":Ne.testName=A.testName||"",Ne.numQuestions=A.numQuestions||"",Ne.questions=A.questions||{};break;case"formCreation":Ne.testName=A.testName||"",Ne.numQuestions=A.numQuestions||"",Ne.numOptions=A.numOptions||"",Ne.questions=A.questions||{},Ne.enableTimer=!!A.enableTimer,Ne.timerMinutes=A.timerMinutes||"",Ne.isShuffled=!!A.isShuffled;break;case"assignment":case"testAssignment":Ne.testName=A.testName||"",Ne.numQuestions=A.numQuestions||"",Ne.numOptions=A.numOptions||"",Ne.questions=A.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",oe);break}Object.keys(Ne).length>0&&(localStorage.setItem(`form_data_${oe}`,JSON.stringify(Ne)),console.log(" Saved form data for step:",oe,Ne))},[e,A]),M=S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const oe=[];for(let fe=0;fe<localStorage.length;fe++){const Ee=localStorage.key(fe);Ee&&(Ee.includes("test")||Ee.includes("form")||Ee.includes("question"))&&oe.push(Ee)}oe.forEach(fe=>{localStorage.removeItem(fe),console.log(" Removed localStorage key:",fe)}),console.log(" Cleared test creation state from localStorage")},[e]);S.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),p(null),L([]),Z(null),console.log(" Cleared all test form fields")},[e]);const H=S.useCallback(()=>{console.log(" Resetting Excel upload state..."),Ze({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(fe=>{const Ee=document.querySelector(`.excel-upload-btn[data-test-type="${fe}"]`);Ee&&(Ee.style.display="none",console.log(" Excel button hidden for:",fe));const Ne=document.querySelector(`.excel-hint[data-test-type="${fe}"]`);Ne&&(Ne.style.display="none",console.log(" Excel hint hidden for:",fe));const Ye=document.querySelector(`.excel-file-input[data-test-type="${fe}"]`);Ye&&(Ye.value="",console.log(" File input cleared for:",fe))}),console.log(" Excel upload state reset complete")},[]),W=S.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(fe=>{const Ee=document.getElementById(fe);Ee&&Ee.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${fe}`)})}),console.log(" Form auto-save setup complete")},[]);S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",oe),console.log("  Call stack:",new Error().stack);const fe={};switch(oe){case"testTypeSelection":break;case"multipleChoiceForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.numOptions=A.numOptions||"",fe.questions=A.questions||{};break;case"trueFalseForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.questions=A.questions||{};break;case"inputForm":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.questions=A.questions||{};break;case"formCreation":fe.testName=A.testName||"",fe.numQuestions=A.numQuestions||"",fe.numOptions=A.numOptions||"",fe.questions=A.questions||{};break;default:console.log(" Unknown step for form data save:",oe);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:oe,data:fe,timestamp:Date.now()})),console.log(" Saved form data for step:",oe,fe)},[e,A]);const R=S.useCallback(async oe=>{console.log(" Restoring form data for step:",oe);try{const fe=localStorage.getItem(`form_data_${oe}`);if(fe){const Ee=JSON.parse(fe);console.log(" Restored form data:",Ee),j(Ne=>{const Ye={...Ne,...Ee};return console.log(" Updated formData with restored data:",Ye),console.log(" Matching test data in restored data:",Ye.matchingTestData),Ye}),Object.keys(Ee).forEach(Ne=>{const Ye=document.getElementById(Ne);Ye&&Ee[Ne]!==void 0&&(Ye.value=Ee[Ne])}),console.log(" Form data restored for step:",oe)}else console.log(" No saved data found for step:",oe)}catch(fe){console.error(" Error restoring form data:",fe)}},[e]),z=S.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(Ee=>{const Ne=document.getElementById(Ee);Ne&&Ne.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${Ee}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(Ee=>{Ee.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),K=S.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),J=S.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(fe=>{fe.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),se=S.useCallback(oe=>{console.log(" showExcelUploadButton called with testType:",oe);const fe=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;Ze(Ee=>({...Ee,[fe]:{...Ee[fe],buttonVisible:!0}}))},[]),X=S.useCallback(oe=>{console.log(" showExcelHint called with testType:",oe);const fe=oe==="multiple-choice"?"multipleChoice":oe==="true-false"?"trueFalse":oe==="input"?"input":oe;Ze(Ee=>({...Ee,[fe]:{...Ee[fe],hintVisible:!0}}))},[]),ie=S.useCallback(async(oe,fe,Ee)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:oe,testType:fe,testId:Ee}),v(oe),console.log(" Test assignment options displayed for:",{testType:fe,testId:Ee,classesCount:oe.length})},[e]),le=S.useCallback(async(oe,fe)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const Ne=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",Ne),Ne.success&&Ne.subjects&&Ne.subjects.length>0?(console.log("Teacher subjects loaded:",Ne.subjects),v(Ne.subjects),ie(Ne.subjects,oe,fe)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(Ee){console.error("Error loading teacher grades and classes:",Ee),r("Error loading teacher grades and classes","error")}},[e,r,ie]),ce=S.useCallback(async()=>{if(console.log(" Loading available classes..."),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}try{const fe=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log(" Teacher subjects response:",fe),fe.success&&fe.subjects&&fe.subjects.length>0?(console.log(" Teacher subjects loaded:",fe.subjects),v(fe.subjects)):(console.log("No teacher subjects found"),v([]),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(oe){console.error(" Error loading available classes:",oe),r("Failed to load available classes","error")}},[e,r]);S.useCallback(async(oe,fe)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}ne(),V("testAssignment"),Z(fe),p(oe),u("testAssignment"),le(oe,fe),console.log(" Test assignment interface shown for:",{testType:oe,testId:fe})},[i,e,ne,V,le]);const be=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",oe),oe.length===0){Le([]);return}Le(oe),console.log(" Active tests displayed:",oe.length,"tests")},[e]);S.useCallback(async(oe,fe)=>{try{console.log(" Loading test questions for:",{testType:oe,testId:fe});const Ee=await hn.getTestQuestions(fe,oe);return console.log(" Test questions loaded:",Ee),Ee}catch(Ee){throw console.error("Error loading test questions:",Ee),Ee}},[]),S.useCallback((oe,fe,Ee,Ne)=>{console.log(" Showing teacher test details modal:",{testType:oe,testId:fe,testName:Ee,questionsCount:Ne.length}),console.log("Test Details:",{testType:oe,testId:fe,testName:Ee,questions:Ne.map(Ye=>({id:Ye.question_id,question:Ye.question,correctAnswer:Ye.correct_answer}))}),r(`Test details for "${Ee}" loaded successfully.`,"success")},[r]);const re=S.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const oe=await hn.getTeacherTests();console.log(" DEBUG: Tests loaded:",oe),oe&&oe.length>0?(console.log(" DEBUG: Success! Displaying",oe.length,"tests"),be(oe)):(console.log(" DEBUG: No tests found"),Le([]))}catch(oe){console.error(" DEBUG: Error loading active tests:",oe),r("Error loading active tests.","error")}},[r,be]),pe=S.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}}),L([]),o(!1),a(!1),M()},[r,M]),Ce=S.useCallback(async(oe,fe)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",oe),console.log(" Test ID:",fe),console.log(" Current formData:",A),console.log(" Selected Classes:",I),console.log(" User:",e),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",e.teacher_id),I.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request..."),await rd.loadAcademicCalendar();const Ne=rd.getCurrentTerm()?.id;if(!Ne)throw new Error("No current academic period found");const Ye=I.map(xt=>{const Jt={grade:parseInt(xt.grade),class:parseInt(xt.class),subject_id:parseInt(xt.subject_id),academic_period_id:Ne,due_date:null};return console.log(" Created assignment:",Jt),Jt});if(console.log(" Final assignments array:",Ye),oe==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const xt=A.matchingTestData;if(console.log(" Matching test data from formData:",xt),!xt){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let Jt;xt.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),Jt=xt.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",xt.blocks),console.log(" Words:",xt.words),console.log(" Arrows:",xt.arrows),Jt=xt.blocks.map((xr,Ir)=>{const rn=xt.words.find(kr=>kr.blockId===xr.id)?.word||`Word ${Ir+1}`,Jr=xt.arrows.some(kr=>kr.startBlock===xr.id),he=xt.arrows.find(kr=>kr.startBlock===xr.id)||null,vt={question_id:Ir+1,word:rn,block_coordinates:{x:xr.x,y:xr.y,width:xr.width,height:xr.height},has_arrow:Jr,arrow:he?{startX:he.startX,startY:he.startY,endX:he.endX,endY:he.endY,style:he.style||{}}:null};return console.log(` Question ${Ir+1}:`,vt),vt})),console.log(" Final questions array:",Jt);const wr={teacher_id:e.teacher_id,test_name:A.testName,image_url:xt.imageUrl,num_blocks:xt.blocks.length,questions:Jt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Ye};console.log(" Final matching test data payload:",wr),console.log(" Calling testService.saveMatchingTest...");const Sr=await hn.saveMatchingTest(wr);console.log(" API Response:",Sr),Sr.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create matching test:",Sr.message),r("Error creating and assigning matching test: "+Sr.message,"error")),F(!1);return}if(oe==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const xt=A.wordMatchingData;if(console.log(" Word matching test data from formData:",xt),!xt){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const Jt=xt.wordPairs.map((xr,Ir)=>({question_id:Ir+1,left_word:xr.leftWord,right_word:xr.rightWord}));console.log(" Final word matching questions array:",Jt);const wr={teacher_id:e.teacher_id,test_type:"word_matching",test_name:A.testName,num_questions:xt.wordPairs.length,interaction_type:xt.interactionType||"drag",questions:Jt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Ye};console.log(" Final word matching test data payload:",wr),console.log(" Calling testService.assignTestToClasses for word matching...");const Sr=await hn.assignTestToClasses(wr);console.log(" API Response:",Sr),Sr.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create word matching test:",Sr.message),r("Error creating and assigning word matching test: "+Sr.message,"error")),F(!1);return}if(oe==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const xt=A.drawingData;if(console.log(" Drawing test data from formData:",xt),!xt){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const Jt=xt.questions||[];console.log(" Drawing questions array:",Jt);const wr={teacher_id:e.teacher_id,test_type:"drawing",test_name:A.testName,num_questions:xt.num_questions,passing_score:xt.passing_score,questions:Jt,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,assignments:Ye};console.log(" Final drawing test data payload:",wr),console.log(" Calling testService.assignTestToClasses...");const Sr=await hn.assignTestToClasses(wr);console.log(" API Response:",Sr),Sr.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create drawing test:",Sr.message),r("Error creating and assigning drawing test: "+Sr.message,"error")),F(!1);return}if(oe==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const xt=A.fillBlanksData;if(console.log(" Fill blanks test data from formData:",xt),!xt){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const Jt=xt.blanks||[];console.log(" Fill blanks questions array:",Jt);const wr={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:A.testName,test_text:xt.test_text,num_questions:xt.num_questions,num_blanks:xt.num_blanks,separate_type:xt.separate_type,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:Jt,assignments:Ye};console.log(" Final fill blanks test data payload:",wr),console.log(" Calling testService.assignTestToClasses...");const Sr=await hn.assignTestToClasses(wr);console.log(" API Response:",Sr),Sr.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create fill blanks test:",Sr.message),r("Error creating and assigning fill blanks test: "+Sr.message,"error")),F(!1);return}if(oe==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xr=>setTimeout(xr,100));const xt=A.speakingData;if(console.log(" Speaking test data from formData:",xt),!xt){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const Jt={teacher_id:e.teacher_id,test_type:"speaking",test_name:A.testName,time_limit:xt.time_limit,min_duration:xt.min_duration,max_duration:xt.max_duration,max_attempts:xt.max_attempts,min_words:xt.min_words,passing_score:xt.passing_score,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,questions:xt.questions,assignments:Ye};console.log(" Final speaking test data payload:",Jt),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const Sr=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Jt)})).json();console.log(" API Response:",Sr),Sr.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),o(!0),Ae()):(console.error(" Failed to create speaking test:",Sr.message),r("Error creating and assigning speaking test: "+Sr.message,"error")),F(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",A.questions);const ot=Object.keys(A.questions).map(xt=>{const Jt=A.questions[xt];console.log(` Processing question ${xt}:`,Jt);let wr;if(oe==="input")wr={correct_answers:Jt.correct_answers||[Jt.correctAnswer||""]};else if(oe==="trueFalse"){const xr=Jt.correct_answer||Jt.correctAnswer||Jt.correct_answers?.[0]||"";wr={correct_answer:xr==="true"}}else wr={correct_answer:Jt.correctAnswer||Jt.correct_answer||Jt.correct_answers?.[0]||""};const Sr={question_id:parseInt(xt),question:Jt.question,...wr,options:Jt.options||[]};return console.log(` Question ${xt} correct_answers:`,Jt.correct_answers),console.log(` Question ${xt} correctAnswer:`,Jt.correctAnswer),console.log(` Converted question ${xt}:`,Sr),Sr});console.log(" Final questions array:",ot);const pt={teacher_id:e.teacher_id,test_type:w3e[oe],test_name:A.testName,num_questions:A.numQuestions,num_options:A.numOptions,questions:ot,allowed_time:A.enableTimer?Math.max(0,Math.floor(Number(A.timerMinutes||0)*60)):null,is_shuffled:!!A.isShuffled,assignments:Ye};console.log(" Final test data payload:",pt),console.log(" Setting isAssigningTest to true..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(xt=>setTimeout(xt,100)),console.log(" Calling testService.assignTestToClasses...");const Gt=await hn.assignTestToClasses(pt);console.log(" API Response:",Gt),Gt.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Ae()):(console.error(" Failed to create and assign test:",Gt.message),r("Error creating and assigning test: "+Gt.message,"error"))}catch(Ee){console.error(" Exception in assignTestToClasses:",Ee),console.error("Error creating and assigning test:",Ee),r("Error creating and assigning test. Please try again.","error")}finally{F(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,I,A,r,pe]),Ae=S.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),p(null),Z(null),L([]),B(),M(),pe(),console.log(" Returned to main cabinet")}catch(oe){console.error("Error returning to main cabinet:",oe)}},[B,M,pe]),[We,Le]=S.useState([]),[At,Qe]=S.useState(!1);S.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await re(),r("Active tests data refreshed.","success")}catch(oe){console.error("Error refreshing active tests data:",oe),r("Error refreshing data.","error")}},[re,r]);const[gt,ht]=S.useState([]),[tt,ut]=S.useState([]),[Dt,Rt]=S.useState(!1),[It,De]=S.useState(!1),Ie=S.useCallback(async oe=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",oe),ht(oe),console.log(" Existing subjects displayed in selection:",oe.length,"subjects")},[e]);S.useCallback(async()=>{try{console.log("Loading existing subjects...");const oe=await hs.getTeacherSubjects();console.log("Existing subjects loaded:",oe),oe&&oe.length>0?Ie(oe):(console.log("No existing subjects found"),ht([]))}catch(oe){console.error("Error loading existing subjects:",oe),r("Error loading subjects.","error")}},[r,Ie]);const Je=S.useCallback(oe=>{console.log("Checking for outside click...");const fe=document.getElementById("dropdownMenu"),Ee=document.querySelector("[data-menu-button]");fe&&!fe.contains(oe.target)&&!Ee?.contains(oe.target)&&(console.log("Outside click detected, closing menu"),fe.classList.remove("show"),document.removeEventListener("click",Je))},[]),[qe,Ze]=S.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Tt=S.useCallback((oe,fe)=>{const Ee=oe.target.files[0];if(!Ee)return;if(!Ee.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),oe.target.value="";return}if(Ee.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),oe.target.value="";return}E(!0);const Ne=new FileReader;Ne.onload=function(Ye){try{console.log(" File loaded, processing data...");const ot=new Uint8Array(Ye.target.result),pt=SE(ot,{type:"array"}),Gt=pt.SheetNames[0],xt=pt.Sheets[Gt],Jt=a_.sheet_to_json(xt,{header:1});console.log(" Parsed Excel data:",Jt),$t(Jt,fe),E(!1)}catch(ot){console.error("Error processing Excel file:",ot),r("Error reading Excel file: "+ot.message,"error"),oe.target.value="",E(!1)}},Ne.onerror=function(){r("Failed to read file","error"),oe.target.value="",E(!1)},Ne.readAsArrayBuffer(Ee)},[r]),Nt=S.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const oe=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${oe.length} Excel upload buttons`),oe.forEach((fe,Ee)=>{const Ne=fe.dataset.testType,Ye=document.querySelector(`.excel-file-input[data-test-type="${Ne}"]`);console.log(` Processing button ${Ee+1}: testType=${Ne}, fileInput=${Ye?"found":"not found"}`),Ye?(fe._excelClickHandler&&fe.removeEventListener("click",fe._excelClickHandler),Ye._excelChangeHandler&&Ye.removeEventListener("change",Ye._excelChangeHandler),fe._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${Ne}`),Ye.click()},Ye._excelChangeHandler=ot=>{console.log(` File input changed for test type: ${Ne}`),Tt(ot,Ne)},fe.addEventListener("click",fe._excelClickHandler),Ye.addEventListener("change",Ye._excelChangeHandler),console.log(` Excel upload initialized for test type: ${Ne}`)):console.warn(` File input not found for test type: ${Ne}`)}),console.log(" Excel upload initialization complete")},[Tt]),$t=S.useCallback((oe,fe)=>{const Ee=oe.filter(xt=>Array.isArray(xt)&&xt.length>0&&xt.some(Jt=>Jt&&Jt.toString().trim()!==""));console.log(" Original Excel data rows:",oe.length),console.log(" Filtered Excel data rows:",Ee.length);const Ye=ir(Ee,fe).dataRows;if(Ye.length===0){const xt="No data rows found after header processing. Please check your Excel file.";r(xt,"error"),alert(xt),Fe(fe);return}console.log(` Processing Excel data for test type: ${fe}`),console.log(" Data rows after header processing:",Ye);const ot=dr(Ye,fe);if(console.log(" Recognition result:",ot),!ot.recognized){console.log(` Excel data recognition failed for test type: ${fe}`);const xt="Excel data recognition failed. Please check your file format.";r(xt,"error"),alert(xt),Fe(fe);return}console.log(` Excel data recognition successful for test type: ${fe}`);const pt=Ye.length,Gt=Te(fe);if(Gt===0)console.log(` No question count specified, using CSV count: ${pt}`),j(xt=>({...xt,numQuestions:pt}));else if(pt!==Gt){const xt=`Your CSV file has ${pt} data rows, but you specified ${Gt} questions.

Please either:
1. Change your question count to ${pt}, or
2. Fix your CSV file to have exactly ${Gt} data rows

Then try uploading again.`;r(xt,"error"),Fe(fe);return}Me(Ye,fe)},[r]),ir=S.useCallback((oe,fe)=>{if(oe.length===0)return{hasHeaders:!1,headerRow:null,dataRows:oe};const Ee=oe[0],Ne=pr(fe);if(Nr(Ee,Ne).isLikelyHeader){const ot=`The first row of your Excel file looks like it contains headers:

"${Ee.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(ot))return{hasHeaders:!0,headerRow:Ee,dataRows:oe.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:oe}},[]),pr=S.useCallback(oe=>{switch(oe){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),Nr=S.useCallback((oe,fe)=>{if(!oe||oe.length===0)return{isLikelyHeader:!1};if(oe.length<fe.expectedColumns)return{isLikelyHeader:!1};const Ee=oe.join(" ").toLowerCase(),Ne=fe.keywords.filter(ot=>Ee.includes(ot.toLowerCase()));return{isLikelyHeader:Ne.length>fe.keywords.length/2,keywordMatches:Ne}},[]),dr=S.useCallback((oe,fe)=>{if(oe.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${fe}`),console.log(" Excel data to validate:",oe);const Ee=Vt(oe,fe);if(console.log(" Recognition result:",Ee),!Ee.matches){const Ne=`Your Excel file doesn't match the expected format.

Required format:
${ge(fe)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",Ne),console.log(" Calling showNotification with message:",Ne),r(Ne,"error"),console.log(" showNotification called"),alert(Ne),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${fe}`),{recognized:!0,data:oe}},[r]),Vt=S.useCallback((oe,fe)=>{if(fe==="multipleChoice")for(let Ee=0;Ee<oe.length;Ee++){const Ne=oe[Ee];if(Ne.length<4)return{matches:!1,issue:`Row ${Ee+1} has ${Ne.length} columns but needs at least 4`};if(!Ne[0]||Ne[0].toString().trim()==="")return{matches:!1,issue:`Row ${Ee+1} has no question in column 1`};if(!Ne[1]||Ne[1].toString().trim()==="")return{matches:!1,issue:`Row ${Ee+1} has no correct answer in column 2`}}else if(fe==="trueFalse")for(let Ee=0;Ee<oe.length;Ee++){const Ne=oe[Ee];if(Ne.length<2)return{matches:!1,issue:`Row ${Ee+1} has ${Ne.length} columns but needs at least 2`};if(!Ne[0]||Ne[0].toString().trim()==="")return{matches:!1,issue:`Row ${Ee+1} has no question in column 1`};const Ye=Ne[1]?.toString().trim().toLowerCase();if(!Ye||!["true","false","t","f"].includes(Ye))return{matches:!1,issue:`Row ${Ee+1} has invalid correct answer in column 2 (must be True/False)`}}else if(fe==="input")for(let Ee=0;Ee<oe.length;Ee++){const Ne=oe[Ee];if(Ne.length<2)return{matches:!1,issue:`Row ${Ee+1} has ${Ne.length} columns but needs at least 2`};if(!Ne[0]||Ne[0].toString().trim()==="")return{matches:!1,issue:`Row ${Ee+1} has no question in column 1`};if(!Ne[1]||Ne[1].toString().trim()==="")return{matches:!1,issue:`Row ${Ee+1} has no correct answer in column 2`}}return{matches:!0}},[]),ge=S.useCallback(oe=>{switch(oe){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),Te=S.useCallback(oe=>A.numQuestions||0,[A.numQuestions]),Fe=S.useCallback(oe=>{console.log(` Clearing file input for test type: ${oe}`)},[]),Me=S.useCallback((oe,fe)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${fe}`),fe){case"multipleChoice":case"multiple-choice":kt(oe);break;case"trueFalse":case"true-false":Pe(oe);break;case"input":He(oe);break;default:console.log(` Unknown test type: ${fe}`)}},[]),kt=S.useCallback(oe=>{console.log(" populateMultipleChoiceFromExcel called with:",oe);const fe=Math.max(...oe.map(Ye=>Ye.length-2)),Ee=Math.min(fe,6);console.log(` Excel data has ${fe} option columns, using ${Ee} options`),j(Ye=>({...Ye,numOptions:Ee}));const Ne={};oe.forEach((Ye,ot)=>{const pt=ot+1;console.log(` Row ${ot+1} data:`,Ye);const Gt={question:(Ye[0]||"").toString().trim(),options:[],correctAnswer:(Ye[1]||"").toString().trim().toUpperCase()};console.log(` Question ${pt} correctAnswer:`,Gt.correctAnswer),["A","B","C","D","E","F"].slice(0,Ee).forEach((wr,Sr)=>{const xr=(Ye[Sr+2]||"").toString().trim();console.log(` Option ${Sr} (${wr}):`,xr),Gt.options.push(xr)}),Ne[pt]=Gt}),j(Ye=>{const ot={...Ye,questions:Ne};return console.log(" Updating form data with:",ot),ot}),console.log(" Populated multiple choice questions from Excel:",Ne),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),z(),ke("multiple-choice")},[A.numOptions,z,r]),Pe=S.useCallback(oe=>{console.log(" populateTrueFalseFromExcel called with:",oe);const fe={};oe.forEach((Ee,Ne)=>{const Ye=Ne+1,ot={question:(Ee[0]||"").toString().trim(),correctAnswer:Ee[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};fe[Ye]=ot}),j(Ee=>({...Ee,questions:fe})),console.log(" Populated true/false questions from Excel:",fe),r(`Successfully loaded ${oe.length} questions from CSV file!`,"success"),K(),ke("true-false")},[K,r]),He=S.useCallback(oe=>{console.log(" populateInputFromExcel called with:",oe);const fe={};oe.forEach((Ee,Ne)=>{const Ye=Ne+1,ot=[];for(let Gt=1;Gt<Ee.length;Gt++){const xt=(Ee[Gt]||"").toString().trim();xt&&ot.push(xt)}const pt={question:(Ee[0]||"").toString().trim(),correctAnswer:ot[0]||"",correct_answers:ot};console.log(` Excel question ${Ye} data:`,pt),fe[Ye]=pt}),j(Ee=>({...Ee,questions:fe})),console.log(" Populated input questions from Excel:",fe),r(`Successfully loaded ${oe.length} questions from Excel file!`,"success"),J(),ke("input")},[J,r]),ke=S.useCallback(oe=>{switch(console.log(` Reattaching form event listeners for test type: ${oe}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(Ee=>{Ee.removeEventListener("input",()=>{}),Ee.removeAttribute("data-listener-attached")}),oe){case"multiple-choice":z();break;case"true-false":K();break;case"input":J();break;default:console.warn("Unknown test type for event listener reattachment:",oe)}console.log(` Form event listeners reattached for test type: ${oe}`)},[z,K,J]),$e=S.useCallback(()=>{const oe=localStorage.getItem("test_creation_state");if(!oe)return console.log(" No test creation state found in localStorage"),!1;try{const fe=JSON.parse(oe);console.log(" Found test creation state:",fe);const Ee=Date.now()-fe.timestamp,Ne=1800*1e3;if(Ee>Ne)return console.log(" Test creation state is too old, clearing it"),M(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),ne(),fe.excelState&&H(),fe.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),p("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),p("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),p("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return R(fe.currentStep),!0}catch(fe){return console.error(" Error restoring test creation state:",fe),M(),!1}},[M,ne,H,R]);S.useEffect(()=>{console.log(" Initializing Teacher Tests..."),ae(),$e(),ce(),Nt()},[ae,$e,ce,Nt]),S.useEffect(()=>{A.numQuestions>0&&g&&g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{Nt()},100))},[A.numQuestions,g,Nt]);const Ue=oe=>{console.log(" Test type selected:",oe),console.log(" Setting testType to:",oe),p(oe),u("formCreation"),j({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),V("formCreation"),setTimeout(()=>{Nt()},100)},Et=(oe,fe)=>{j(Ee=>({...Ee,[oe]:fe}))},Ft=(oe,fe,Ee)=>{j(Ne=>({...Ne,questions:{...Ne.questions,[oe]:{...Ne.questions[oe],[fe]:Ee}}}))},zt=(oe,fe,Ee,Ne=0)=>{const Ye={};for(let ot=1;ot<=Ee;ot++)oe==="multipleChoice"?Ye[ot]={question:"",options:Array.from({length:Ne},()=>""),correctAnswer:""}:oe==="trueFalse"?Ye[ot]={question:"",correctAnswer:""}:oe==="input"&&(Ye[ot]={question:"",correct_answers:[""]});j(ot=>({...ot,questions:Ye})),oe==="multipleChoice"?(se("multiple-choice"),X("multiple-choice")):oe==="trueFalse"?(se("true-false"),X("true-false")):oe==="input"&&(se("input"),X("input"))},fr=async()=>{if(!g||!A.testName||!A.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),V("testAssignment",A),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},nr=(oe,fe,Ee,Ne,Ye)=>{L(Ee?ot=>[...ot,{grade:oe,class:fe,subject_id:Ne,subject:Ye}]:ot=>ot.filter(pt=>!(pt.grade===oe&&pt.class===fe&&pt.subject_id===Ne)))},Dr=S.useCallback(async oe=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),console.log(" [DEBUG] Current formData:",A),console.log(" [DEBUG] Current testType:",g),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",c),_(!0);try{const fe=oe.blocks.map((Ye,ot)=>{const pt=oe.words.find(Jt=>Jt.blockId===Ye.id)?.word||`Word ${ot+1}`,Gt=oe.arrows.some(Jt=>Jt.startBlock===Ye.id),xt=oe.arrows.find(Jt=>Jt.startBlock===Ye.id)||null;return{question_id:ot+1,word:pt,block_coordinates:{x:Ye.x,y:Ye.y,width:Ye.width,height:Ye.height},has_arrow:Gt,arrow:xt?{startX:xt.startX,startY:xt.startY,endX:xt.endX,endY:xt.endY,style:xt.style||{}}:null}}),Ee={teacher_id:e.teacher_id,test_name:A.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:oe.imageUrl,num_blocks:oe.blocks.length,questions:fe,assignments:[]};console.log(" Sending matching test payload:",Ee);const Ne={...A,testName:Ee.test_name,numQuestions:Ee.num_blocks,numOptions:0,questions:fe.reduce((Ye,ot,pt)=>(Ye[pt+1]={question:ot.word,correctAnswer:ot.word,options:[]},Ye),{}),matchingTestData:oe};console.log(" Assignment form data:",Ne),j(Ne),V("testAssignment",Ne),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(fe){console.error(" Error saving matching test:",fe),r("Failed to save matching test: "+fe.message,"error")}finally{_(!1)}},[e,A,g,r,V]),ue=S.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),we=S.useCallback(async oe=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,wordMatchingData:oe,numQuestions:oe.numQuestions||oe.wordPairs?.length||0})),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(fe){console.error("Error saving word matching test:",fe),r("Failed to save word matching test: "+fe.message,"error")}finally{_(!1)}},[r]),ye=S.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),xe=S.useCallback(async oe=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,drawingData:oe,numQuestions:oe.num_questions||oe.questions?.length||0})),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving drawing test:",fe),r("Error saving drawing test","error")}finally{_(!1)}},[r]),_e=S.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Se=S.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ve=S.useCallback(async oe=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,fillBlanksData:oe,numQuestions:oe.num_questions||oe.blanks?.length||0})),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving fill blanks test:",fe),r("Error saving fill blanks test","error")}finally{_(!1)}},[r]),lt=S.useCallback(()=>{console.log(" Cancelling speaking test creation"),u("typeSelection"),j({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ke=S.useCallback(async oe=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",oe),_(!0);try{j(fe=>({...fe,speakingData:oe,numQuestions:oe.questions?.length||0})),u("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(fe){console.error(" Error saving speaking test:",fe),r("Error saving speaking test","error")}finally{_(!1)}},[r]);return l.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs(wo,{mode:"wait",children:[c==="typeSelection"&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs(et,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),l.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:oe,title:fe,description:Ee,icon:Ne})=>l.jsx(at.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Ue(oe),children:l.jsxs(jt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"mb-3 flex justify-center",children:l.jsx("img",{src:Ne,alt:fe,className:"w-12 h-12 object-contain"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:fe}),l.jsx("p",{className:"text-sm text-gray-600",children:Ee})]})},oe))})]}),c==="formCreation"&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"flex space-x-2",children:l.jsx(et,{variant:"outline",onClick:ee,children:" Back to Test Types"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",g==="multipleChoice"?"Multiple Choice":g==="trueFalse"?"True/False":g==="input"?"Input":g==="drawing"?"Drawing":g==="fillBlanks"?"Fill Blanks":g==="wordMatching"?"Word Matching":g==="speaking"?"Speaking":"Picture Matching"," Test"]}),l.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),l.jsx("input",{type:"text",value:A.testName,onChange:oe=>Et("testName",oe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),g!=="matching"&&g!=="wordMatching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"50",value:A.numQuestions,onChange:oe=>{const fe=parseInt(oe.target.value)||0;Et("numQuestions",fe),fe>0&&zt(g,A.testName,fe,A.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),l.jsx("input",{type:"number",min:"2",max:"6",value:A.numOptions,onChange:oe=>{const fe=parseInt(oe.target.value)||0;Et("numOptions",fe),fe>0&&fe<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),A.numQuestions>0&&zt(g,A.testName,A.numQuestions,fe)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),g!=="speaking"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!A.enableTimer,onChange:oe=>Et("enableTimer",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),A.enableTimer&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),l.jsx("input",{type:"number",min:"1",max:"1440",value:A.timerMinutes,onChange:oe=>Et("timerMinutes",oe.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]})]}),g!=="drawing"&&g!=="matching"&&g!=="wordMatching"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!A.isShuffled,onChange:oe=>Et("isShuffled",oe.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})})]})]})}),g==="matching"&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),l.jsx(Xee,{testName:A.testName,onTestSaved:Dr,onCancel:ue,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]})}),g==="wordMatching"&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),l.jsx(Qse,{testName:A.testName,onTestSaved:we,onCancel:ye,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]})}),g==="drawing"&&l.jsxs(jt,{children:[console.log(" Rendering DrawingTestCreator, testType:",g),l.jsx(Use,{testName:A.testName,onTestSaved:xe,onCancel:_e,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g==="fillBlanks"&&l.jsxs(jt,{children:[console.log(" Rendering FillBlanksTestCreator, testType:",g),l.jsx(Gse,{testName:A.testName,allowedTime:A.enableTimer&&parseInt(A.timerMinutes)||null,onTestSaved:Ve,onCancel:Se,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g==="speaking"&&l.jsxs(jt,{children:[console.log(" Rendering SpeakingTestCreator, testType:",g),l.jsx(Kse,{testName:A.testName,onTestSaved:Ke,onCancel:lt,onBackToCabinet:Ae,isSaving:k,validationErrors:{}})]}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&A.numQuestions>0&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),l.jsxs("div",{className:"space-y-6",children:[g==="multipleChoice"&&qe.multipleChoice?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Multiple Choice Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),l.jsx("div",{children:"Column 3: Option A text"}),l.jsx("div",{children:"Column 4: Option B text"}),l.jsx("div",{children:"Column 5: Option C text"}),l.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),g==="trueFalse"&&qe.trueFalse?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-xs text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),g==="input"&&qe.input?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Input Test Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Answer 1"}),l.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&A.numQuestions>0&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),A.numQuestions>0&&l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),l.jsx("div",{className:"space-y-6",children:Object.keys(A.questions).map(oe=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",oe]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),l.jsx("textarea",{value:A.questions[oe]?.question||"",onChange:fe=>Ft(oe,"question",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),l.jsx("div",{className:"space-y-2",children:A.questions[oe]?.options?.map((fe,Ee)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+Ee),":"]}),l.jsx("input",{type:"text",value:fe,onChange:Ne=>{const Ye=[...A.questions[oe].options];Ye[Ee]=Ne.target.value,Ft(oe,"options",Ye)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+Ee)}`})]},Ee))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),g==="multipleChoice"?l.jsx("div",{children:l.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:fe=>Ft(oe,"correctAnswer",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),A.questions[oe]?.options?.map((fe,Ee)=>l.jsx("option",{value:String.fromCharCode(65+Ee),children:String.fromCharCode(65+Ee)},Ee))]})}):g==="trueFalse"?l.jsxs("select",{value:A.questions[oe]?.correctAnswer||"",onChange:fe=>Ft(oe,"correctAnswer",fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),l.jsx("option",{value:"true",children:"True"}),l.jsx("option",{value:"false",children:"False"})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:A.questions[oe]?.correct_answers?.[0]||"",onChange:fe=>{const Ne=[...A.questions[oe]?.correct_answers||[""]];Ne[0]=fe.target.value,Ft(oe,"correct_answers",Ne)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),A.questions[oe]?.correct_answers?.slice(1).map((fe,Ee)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"text",value:fe,onChange:Ne=>{const Ye=[...A.questions[oe]?.correct_answers||[]];Ye[Ee+1]=Ne.target.value,Ft(oe,"correct_answers",Ye)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${Ee+2}`}),l.jsx("button",{type:"button",onClick:()=>{const Ne=[...A.questions[oe]?.correct_answers||[]];Ne.splice(Ee+1,1),Ft(oe,"correct_answers",Ne)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},Ee))||[],l.jsx("button",{type:"button",onClick:()=>{const Ee=[...A.questions[oe]?.correct_answers||[""],""];Ft(oe,"correct_answers",Ee)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},oe))})]})}),A.testName&&A.numQuestions>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(et,{onClick:fr,disabled:k,className:"px-8",children:k?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&l.jsxs(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs(et,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),l.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),l.jsx(et,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),l.jsx(jt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),x.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),l.jsx("div",{className:"mt-4",children:l.jsx(et,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):l.jsx("div",{className:"space-y-6",children:x.map(oe=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:oe.subject}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:oe.classes.map(fe=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:I.some(Ee=>Ee.grade===fe.grade&&Ee.class===fe.class&&Ee.subject_id===oe.subject_id),onChange:Ee=>nr(fe.grade,fe.class,Ee.target.checked,oe.subject_id,oe.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[fe.grade,"/",fe.class]})]},`${fe.grade}-${fe.class}-${oe.subject_id}`))})]},oe.subject_id))})]})}),I.length>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(et,{onClick:()=>Ce(g,null),disabled:w,className:"px-8",children:w?l.jsxs(l.Fragment,{children:[l.jsx(Hr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${I.length} Class${I.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",P),P&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(oe=>l.jsx(uc,{type:oe.type,message:oe.message,duration:oe.duration,onClose:()=>n(oe.id)},oe.id))})]})},_3e=({onDataLoaded:e,onError:t})=>{const r=Eo(),{user:n,isAuthenticated:s}=cs(),{teacherData:a,loadTeacherData:i}=r2(),[o,c]=S.useState(!0),[u,d]=S.useState(""),[f,g]=S.useState([]),[p,x]=S.useState(null),[v,w]=S.useState([]),[C,k]=S.useState([]),[_,N]=S.useState([]),[E,P]=S.useState(null),[F,A]=S.useState(0);S.useEffect(()=>{ae()},[]),S.useCallback(async ne=>{console.log(" Teacher login attempt...");try{const B=await hs.teacherLogin(ne);if(B.success)return Z("Login successful!","success"),await j(),B;throw new Error(B.error||"Login failed")}catch(B){throw console.error(" Teacher login error:",B),Z("Login failed. Please check your credentials.","error"),B}},[]);const j=S.useCallback(async()=>{console.log(" Loading teacher data...");try{if(c(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==Qi.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const ne=await hs.getTeacherData();if(ne&&ne.success)console.log(" Teacher data loaded successfully:",ne),x(ne.teacher||n),ne.subjects&&(w(ne.subjects),console.log(" Teacher subjects loaded:",ne.subjects.length)),ne.grades&&k(ne.grades),ne.classes&&N(ne.classes),P(new Date),A(B=>B+1),e&&e(ne),Z("Teacher data loaded successfully!","success");else throw new Error(ne?.error||"Failed to load teacher data")}catch(ne){console.error(" Error loading teacher data:",ne);const B=ne.message||"Failed to load teacher data";d(B),t&&t(ne),Z(B,"error")}finally{c(!1)}},[s,n,e,t]),I=S.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);S.useCallback(ne=>{console.log(" Showing main cabinet with subjects:",ne),ne&&w(ne),r("/teacher/cabinet")},[r]);const L=S.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(B=>({id:B,name:`Grade ${B}`,classes:Y(B)}))),[]),Y=S.useCallback(ne=>Array.from({length:10},(V,M)=>M+1).map(V=>({id:`${ne}-${V}`,name:`Class ${V}`,grade:ne,classNumber:V})),[]),Z=S.useCallback((ne,B)=>{const V={id:Date.now(),message:ne,type:B,timestamp:new Date};g(M=>[...M,V]),setTimeout(()=>{g(M=>M.filter(H=>H.id!==V.id))},N0.NOTIFICATION_DURATION)},[]),ae=S.useCallback(async()=>{console.log(" Initializing teacher data..."),await j()},[j]),ee=S.useCallback(async()=>{console.log(" Refreshing teacher data..."),await j()},[j]);return S.useCallback(async ne=>{console.log(" Updating teacher profile:",ne);try{const B=await hs.updateUserProfile(ne);if(B.success)return x(V=>({...V,...ne})),Z("Profile updated successfully!","success"),B;throw new Error(B.error||"Failed to update profile")}catch(B){throw console.error(" Error updating teacher profile:",B),Z("Failed to update profile","error"),B}},[]),S.useCallback(async ne=>{console.log(" Changing teacher password...");try{const B=await hs.changePassword(ne);if(B.success)return Z("Password changed successfully!","success"),B;throw new Error(B.error||"Failed to change password")}catch(B){throw console.error(" Error changing teacher password:",B),Z("Failed to change password","error"),B}},[]),o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:u}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx(et,{variant:"primary",onClick:ee,children:"Retry"}),l.jsx(et,{variant:"outline",onClick:I,children:"Go Back"})]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",E?E.toLocaleString():"Never"," | Version: ",F]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(et,{variant:"outline",onClick:ee,children:"Refresh Data"}),l.jsx(et,{variant:"outline",onClick:I,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),p?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.name||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.username||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.email||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),l.jsx("p",{className:"text-sm text-gray-900",children:p.role||"N/A"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",v.length,")"]}),v.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:v.map((ne,B)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:ne.name}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ne.description||"No description"}),ne.classes&&ne.classes.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:ne.classes.map((V,M)=>l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[V.grade," - ",V.className]},M))})]})]},B))}):l.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L().map(ne=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:ne.name}),l.jsx("div",{className:"grid grid-cols-5 gap-1",children:ne.classes.map(B=>l.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",B),children:B.classNumber},B.id))})]},ne.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:v.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-green-600",children:C.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:_.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:F}),l.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:f.map(ne=>l.jsx(uc,{type:ne.type,message:ne.message,onClose:()=>g(B=>B.filter(V=>V.id!==ne.id))},ne.id))})]})},b3e=({onBackToCabinet:e})=>{const t=Eo(),{user:r,isAuthenticated:n}=cs(),{teacherData:s}=r2(),[a,i]=S.useState(!0),[o,c]=S.useState(""),[u,d]=S.useState([]),[f,g]=S.useState([]),[p,x]=S.useState([]),[v,w]=S.useState([]),[C,k]=S.useState(null),[_,N]=S.useState([]),[E,P]=S.useState(!1),[F,A]=S.useState(!1),[j,I]=S.useState(!1),[L,Y]=S.useState(!1),[Z,ae]=S.useState(null),[ee,ne]=S.useState(!0),[B,V]=S.useState(null);S.useEffect(()=>{Le()},[]),S.useCallback(Qe=>{console.log(" Rendering existing subjects:",Qe),g(Qe)},[]);const M=S.useCallback(()=>{console.log(" Showing subject selection prompt..."),P(!0),ne(!1),H()},[]),H=S.useCallback(async()=>{console.log(" Loading existing subjects...");try{const Qe=await hs.getTeacherSubjects();Qe.success&&Qe.subjects&&Qe.subjects.length>0?(console.log(" Existing subjects found:",Qe.subjects),W(Qe.subjects)):(console.log(" No existing subjects found"),w([]))}catch(Qe){console.error(" Error loading existing subjects:",Qe),We("Failed to load existing subjects","error")}},[]),W=S.useCallback(Qe=>{console.log(" Rendering subject selection:",Qe);const gt=[];Qe.forEach(ht=>{ht.classes&&Array.isArray(ht.classes)&&ht.classes.forEach(tt=>{gt.push({id:`${ht.subject_id}-${tt.grade}-${tt.class}`,subjectId:ht.subject_id,subjectName:ht.subject,grade:tt.grade,class:tt.class,displayText:`${ht.subject} - ${tt.grade}/${tt.class}`})})}),w(gt),console.log(" Processed subjects for selection:",gt)},[]),R=S.useCallback(async Qe=>{if(console.log(" Saving teacher subjects:",Qe),!Qe||Qe.length===0){We("Please select at least one subject and class combination.","warning");return}try{const gt=Qe.reduce((tt,ut)=>{const Dt=tt.find(Rt=>Rt.subject_id===ut.subjectId);return Dt?Dt.classes.push({grade:ut.grade,class:ut.class}):tt.push({subject_id:ut.subjectId,classes:[{grade:ut.grade,class:ut.class}]}),tt},[]);console.log(" Transformed data for backend:",gt);const ht=await hs.saveTeacherSubjects(gt);if(ht.success)We("Subjects saved successfully!","success"),P(!1),ne(!0),V(new Date),await H();else throw new Error(ht.error||"Failed to save subjects")}catch(gt){console.error(" Error saving subjects:",gt),We("Error saving subjects. Please try again.","error")}},[]),z=S.useCallback(()=>{console.log(" Toggling subject dropdown..."),A(Qe=>!Qe),I(!1)},[]),K=S.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const Qe=await hs.getAllSubjects();if(Qe.success)x(Qe.subjects||[]),console.log(" Available subjects loaded:",Qe.subjects?.length||0);else throw new Error(Qe.error||"Failed to load subjects")}catch(Qe){console.error(" Error loading subjects for dropdown:",Qe),We("Failed to load subjects","error")}},[]),J=S.useCallback(Qe=>{console.log(" Subject selected:",Qe);const gt=p.find(ht=>ht.subject_id===parseInt(Qe));gt&&(k(gt),I(!0),A(!1),se())},[p]),se=S.useCallback(()=>{console.log(" Loading grades and classes...")},[]),X=S.useCallback((Qe,gt)=>{console.log(" Saving classes for subject:",Qe,gt);const ht={id:`${Qe.subject_id}-${Date.now()}`,subjectId:Qe.subject_id,subjectName:Qe.subject,grade:gt.grade,class:gt.class,displayText:`${Qe.subject} - ${gt.grade}/${gt.class}`};w(tt=>[...tt,ht]),k(null),N([]),I(!1),le(`Added ${Qe.subject} for ${gt.grade}/${gt.class}`)},[]),ie=S.useCallback(()=>{console.log(" Resetting subject selection..."),k(null),N([]),A(!1),I(!1)},[]),le=S.useCallback(Qe=>{console.log(" Showing message:",Qe),We(Qe,"success")},[]),ce=S.useCallback(Qe=>{console.log(" Showing confirmation modal:",Qe),ae(Qe),Y(!0)},[]),be=S.useCallback(()=>{console.log(" Hiding confirmation modal..."),Y(!1),ae(null)},[]),re=S.useCallback(()=>{console.log(" Confirming save subjects..."),be(),R(v)},[v,R,be]),pe=S.useCallback(()=>{console.log(" Cancelling save subjects..."),be()},[be]),Ce=S.useCallback(Qe=>{console.log(" Removing subject:",Qe),w(gt=>gt.filter(ht=>ht.id!==Qe)),We("Subject removed","info")},[]);S.useCallback(()=>{console.log(" Showing edit subjects button..."),ne(!0)},[]),S.useCallback(()=>{console.log(" Hiding edit subjects button..."),ne(!1)},[]);const Ae=S.useCallback(Qe=>{console.log(" Generating class buttons for grade:",Qe);let gt;return Qe===1||Qe===2?gt=["15","16"]:Qe===3?gt=["15","16"]:Qe===4?gt=["13","14"]:Qe===5||Qe===6?gt=["13","14"]:gt=[],gt.map(ht=>({id:`${Qe}-${ht}`,grade:Qe,class:ht,displayText:`${Qe}/${ht}`}))},[]);S.useCallback((Qe,gt)=>{console.log(" Showing class results:",Qe,gt),t("/teacher/results")},[t]);const We=S.useCallback((Qe,gt)=>{const ht={id:Date.now(),message:Qe,type:gt,timestamp:new Date};d(tt=>[...tt,ht]),setTimeout(()=>{d(tt=>tt.filter(ut=>ut.id!==ht.id))},N0.NOTIFICATION_DURATION)},[]),Le=S.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log(" User not authenticated"),c("User not authenticated");return}if(r.role!==Qi.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await H(),await K(),console.log(" Teacher subjects initialization complete!")}catch(Qe){console.error(" Error initializing teacher subjects:",Qe),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,H,K]),At=S.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Hr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:o}),l.jsx(et,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",B?B.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[ee&&l.jsx(et,{variant:"primary",onClick:M,children:"Edit Subjects"}),l.jsx(et,{variant:"outline",onClick:At,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[!E&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs(et,{variant:"primary",onClick:M,className:"px-6 py-2",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),f.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((Qe,gt)=>l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:Qe.subject}),Qe.classes&&Qe.classes.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Qe.classes.map((ht,tt)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",ht.grade," - Class ",ht.class]},tt))})]})]}),l.jsx("div",{className:"ml-4",children:l.jsx(et,{variant:"outline",size:"sm",onClick:()=>Ce(Qe.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},gt))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),l.jsxs(et,{variant:"primary",onClick:M,className:"px-6 py-3",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),E&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs(et,{variant:"outline",onClick:z,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:C?C.subject:"Select a subject"}),l.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&l.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:p.map(Qe=>l.jsx("button",{onClick:()=>J(Qe.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:l.jsx("span",{className:"text-gray-900 font-medium",children:Qe.subject})},Qe.subject_id))})]})]}),j&&C&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",C.subject]}),l.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(Qe=>l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:l.jsx("span",{className:"text-white font-bold text-xs",children:Qe})}),l.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",Qe]})]}),l.jsx("div",{className:"space-y-3",children:Ae(Qe).map(gt=>l.jsx(et,{variant:"outline",size:"sm",onClick:()=>X(C,gt),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:gt.displayText},gt.id))})]},Qe))})]}),v.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.map(Qe=>l.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex-1",children:l.jsx("span",{className:"text-sm font-semibold text-purple-900",children:Qe.displayText})}),l.jsx(et,{variant:"outline",size:"sm",onClick:()=>Ce(Qe.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Qe.id))})]}),l.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[l.jsx("div",{className:"text-sm text-gray-500",children:v.length>0?`${v.length} subject${v.length>1?"s":""} selected`:"No subjects selected"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs(et,{variant:"outline",onClick:()=>{P(!1),ne(!0),ie()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),l.jsxs(et,{variant:"primary",onClick:()=>ce({type:"save",data:v}),disabled:v.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),j?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),L&&l.jsx(oa,{isOpen:L,onClose:be,title:"Confirm Save",variant:"confirmation",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",Z?.data?.length||0," subject assignments?"]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(et,{variant:"outline",onClick:pe,children:"Cancel"}),l.jsx(et,{variant:"primary",onClick:re,children:"Save"})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(Qe=>l.jsx(uc,{type:Qe.type,message:Qe.message,onClose:()=>d(gt=>gt.filter(ht=>ht.id!==Qe.id))},Qe.id))})]})},S3e=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=cs(),[s,a]=S.useState("cabinet");return!r||t!=="teacher"?l.jsx(pm,{to:"/login",replace:!0}):n?l.jsxs("div",{className:"teacher-app-loading",children:[l.jsx(Hr,{}),l.jsx("p",{children:"Loading teacher interface..."})]}):l.jsx("div",{className:"teacher-app",children:l.jsxs(gN,{children:[l.jsx(Os,{path:"/",element:l.jsx(hM,{})}),l.jsx(Os,{path:"/cabinet",element:l.jsx(hM,{})}),l.jsx(Os,{path:"/tests",element:l.jsx(gM,{})}),l.jsx(Os,{path:"/tests/create",element:l.jsx(gM,{})}),l.jsx(Os,{path:"/data",element:l.jsx(_3e,{})}),l.jsx(Os,{path:"/subjects",element:l.jsx(b3e,{})}),l.jsx(Os,{path:"/results",element:l.jsx(ez,{})}),l.jsx(Os,{path:"*",element:l.jsx(pm,{to:"/teacher",replace:!0})})]})})},Oe={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},k3e=()=>{const{user:e,isAdmin:t,logout:r}=cs(),{get:n,post:s,delete:a}=Jo(),i=S.useCallback(async()=>{try{g({type:"info",message:"Checking for overdue assignments..."});const he=await s("/.netlify/functions/check-overdue-assignments",{});if(he&&he.success){const vt=he.overdue_count||0;vt>0?g({type:"success",message:`Found and marked ${vt} overdue assignments as inactive.`}):g({type:"info",message:"No overdue assignments found."})}else g({type:"error",message:he?.error||"Failed to check assignments"})}catch(he){g({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",he)}},[s]),[o,c]=S.useState(!1),[u,d]=S.useState(null),[f,g]=S.useState(null),[p,x]=S.useState(!1),[v,w]=S.useState(!1),[C,k]=S.useState(!1),[_,N]=S.useState(!1),[E,P]=S.useState(""),[F,A]=S.useState(null),[j,I]=S.useState({}),[L,Y]=S.useState(null),[Z,ae]=S.useState({}),[ee,ne]=S.useState(null),[B,V]=S.useState({}),[M,H]=S.useState([]),[W,R]=S.useState(""),[z,K]=S.useState(""),[J,se]=S.useState(""),[X,ie]=S.useState(!0),[le,ce]=S.useState(!1),[be,re]=S.useState([]),[pe,Ce]=S.useState(""),[Ae,We]=S.useState(""),[Le,At]=S.useState(""),[Qe,gt]=S.useState(!1),[ht,tt]=S.useState(!1),[ut,Dt]=S.useState([]),[Rt,It]=S.useState([]),[De,Ie]=S.useState([]),[Je,qe]=S.useState([]),[Ze,Tt]=S.useState(!1),[Nt,$t]=S.useState(!1),[ir,pr]=S.useState(!1),[Nr,dr]=S.useState(!1),[Vt,ge]=S.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[Te,Fe]=S.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[Me,kt]=S.useState({subject_id:"",subject:"",description:"",is_active:!0}),[Pe,He]=S.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});S.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),ke()},[]),S.useEffect(()=>{const he=vt=>{Qe&&!vt.target.closest(".admin-menu")&&gt(!1)};return document.addEventListener("mousedown",he),()=>{document.removeEventListener("mousedown",he)}},[Qe]);const ke=S.useCallback(async()=>{try{c(!0),await Ft(),console.log("Admin app initialized")}catch(he){d("Failed to initialize admin app"),console.error("Admin app initialization error:",he)}finally{c(!1)}},[]),$e=S.useCallback(()=>{gt(he=>!he)},[]),Ue=S.useCallback(()=>{tt(!0),gt(!1)},[]),Et=S.useCallback(()=>{tt(!1)},[]),Ft=S.useCallback(async()=>{try{await Promise.all([zt(),fr(),nr(),Dr()])}catch(he){console.error("Error loading admin data:",he),d("Failed to load admin data")}},[]),zt=S.useCallback(async()=>{try{const he="admin_users_",vt=Rs(he);if(vt){console.log(" Using cached users data"),Dt(vt);return}const kr=await n("/.netlify/functions/get-all-users");console.log(" Users response:",kr);const Cr=kr.users||[];Dt(Cr),vs(he,Cr,Is.admin_users),console.log(" Users set to state:",Cr)}catch(he){console.error("Error loading users:",he)}},[n]),fr=S.useCallback(async()=>{try{const he="admin_teachers_",vt=Rs(he);if(vt){console.log(" Using cached teachers data"),It(vt);return}const kr=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",kr);const Cr=kr.teachers||[];It(Cr),vs(he,Cr,Is.admin_teachers),console.log(" Teachers set to state:",Cr)}catch(he){console.error("Error loading teachers:",he)}},[n]),nr=S.useCallback(async()=>{try{const he="admin_subjects_",vt=Rs(he);if(vt){console.log(" Using cached subjects data"),Ie(vt);return}const kr=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",kr);const Cr=kr.subjects||[];Ie(Cr),vs(he,Cr,Is.admin_subjects),console.log(" Subjects set to state:",Cr)}catch(he){console.error("Error loading subjects:",he)}},[n]),Dr=S.useCallback(async()=>{try{const he="admin_academic_years_",vt=Rs(he);if(vt){console.log(" Using cached academic years data"),qe(vt);return}const Cr=(await n("/.netlify/functions/get-academic-year")).academic_years||[];qe(Cr),vs(he,Cr,Is.admin_academic_years)}catch(he){console.error("Error loading academic year:",he)}},[n]),ue=S.useCallback(async()=>{try{if(N(!_),!_){const[he,vt]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",he),console.log(" Assignments response:",vt);const kr=he.tests||[],Nn=(vt.assignments||[]).reduce((Zr,Be)=>{const Ct=`${Be.test_type}-${Be.test_id}`;return Zr[Ct]||(Zr[Ct]=[]),Zr[Ct].push(Be),Zr},{}),_n=kr.map(Zr=>{const Be=`${Zr.test_type}-${Zr.test_id}`,Ct=Nn[Be]||[],qt=Ct.some(lr=>lr.is_active);return{...Zr,is_active:qt,assignments:Ct}});H(_n),console.log(" All tests with status set to state:",_n)}}catch(he){console.error("Error loading tests:",he),g({type:"error",message:"Failed to load tests"})}},[n,_]),we=S.useCallback((he,vt)=>{ge(kr=>({...kr,[he]:vt}))},[]),ye=S.useCallback((he,vt)=>{Fe(kr=>({...kr,[he]:vt}))},[]),xe=S.useCallback((he,vt)=>{kt(kr=>({...kr,[he]:vt}))},[]);S.useCallback(()=>{console.log(" Testing local storage...");try{const he={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(he));const vt=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",vt),g({type:"success",message:"Local storage test successful"})}catch(he){console.error(" Local storage test failed:",he),g({type:"error",message:"Local storage test failed"})}},[]),S.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),g({type:"success",message:"Local storage cleared"})}catch(he){console.error(" Error clearing local storage:",he),g({type:"error",message:"Error clearing local storage"})}},[]),S.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const vt=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",vt),g({type:"success",message:`Found ${vt.length} teachers`})}catch(he){console.error(" Error checking teacher subjects:",he),g({type:"error",message:"Error checking teacher subjects"})}},[n]);const _e=S.useCallback(async he=>{he.preventDefault();try{console.log(" Submitting user:",Vt);const vt=await s("/.netlify/functions/add-user",Vt);vt.success?(g({type:"success",message:"User added successfully"}),Tt(!1),ge({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),zt()):g({type:"error",message:vt.message||"Failed to add user"})}catch(vt){console.error(" Error adding user:",vt),g({type:"error",message:"Error adding user"})}},[Vt,s,zt]),Se=S.useCallback(async he=>{he.preventDefault();try{console.log(" Submitting teacher:",Te);const vt=await s("/.netlify/functions/add-teacher",Te);vt.success?(g({type:"success",message:"Teacher added successfully"}),$t(!1),Fe({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),fr()):g({type:"error",message:vt.message||"Failed to add teacher"})}catch(vt){console.error(" Error adding teacher:",vt),g({type:"error",message:"Error adding teacher"})}},[Te,s,fr]),Ve=S.useCallback(async he=>{he.preventDefault();try{console.log(" Submitting subject:",Me);const vt=await s("/.netlify/functions/add-subject",Me);vt.success?(g({type:"success",message:"Subject added successfully"}),pr(!1),kt({subject_id:"",subject:"",description:"",is_active:!0}),nr()):g({type:"error",message:vt.message||"Failed to add subject"})}catch(vt){console.error(" Error adding subject:",vt),g({type:"error",message:"Error adding subject"})}},[Me,s,nr]),lt=S.useCallback(he=>{A(he),I({name:he.name||"",surname:he.surname||"",grade:he.grade||"",class:he.class||"",student_id:he.student_id||"",nickname:he.nickname||"",password:he.password||"",is_active:he.is_active!==void 0?he.is_active:!0})},[]),Ke=S.useCallback(async()=>{try{const he=[];Object.keys(j).forEach(vt=>{vt!=="student_id"&&j[vt]!==F[vt]&&he.push({fieldName:vt,newValue:j[vt]})});for(const vt of he)await s("/.netlify/functions/update-user",{userId:F.student_id,fieldName:vt.fieldName,newValue:vt.newValue});g({type:"success",message:"User updated successfully!"}),A(null),I({}),zt()}catch{g({type:"error",message:"Failed to update user"})}},[j,F,s,zt]),oe=S.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:he})).success&&(g({type:"success",message:"User deleted successfully!"}),zt())}catch{g({type:"error",message:"Failed to delete user"})}},[s,zt]),fe=S.useCallback(he=>{Y(he),ae({teacher_id:he.teacher_id||"",username:he.username||"",password:he.password||"",first_name:he.first_name||"",last_name:he.last_name||"",is_active:he.is_active!==void 0?he.is_active:!0})},[]),Ee=S.useCallback(async()=>{try{const he=[];Object.keys(Z).forEach(vt=>{vt!=="teacher_id"&&Z[vt]!==L[vt]&&he.push({fieldName:vt,newValue:Z[vt]})});for(const vt of he)await s("/.netlify/functions/update-teacher",{teacherId:L.teacher_id,fieldName:vt.fieldName,newValue:vt.newValue});g({type:"success",message:"Teacher updated successfully!"}),Y(null),ae({}),fr()}catch{g({type:"error",message:"Failed to update teacher"})}},[Z,L,s,fr]),Ne=S.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:he})).success&&(g({type:"success",message:"Teacher deleted successfully!"}),fr())}catch{g({type:"error",message:"Failed to delete teacher"})}},[s,fr]),Ye=S.useCallback(he=>{ne(he),V({subject_id:he.subject_id||"",subject:he.subject||""})},[]),ot=S.useCallback(async()=>{try{const he=[];Object.keys(B).forEach(vt=>{vt!=="subject_id"&&B[vt]!==ee[vt]&&he.push({fieldName:vt,newValue:B[vt]})});for(const vt of he)await s("/.netlify/functions/update-subject",{subjectId:ee.subject_id,fieldName:vt.fieldName,newValue:vt.newValue});g({type:"success",message:"Subject updated successfully!"}),ne(null),V({}),nr()}catch{g({type:"error",message:"Failed to update subject"})}},[B,ee,s,nr]),pt=S.useCallback(async he=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const vt=await s("/.netlify/functions/delete-subject",{subjectId:he});vt.success?(g({type:"success",message:"Subject deleted successfully!"}),nr()):g({type:"error",message:vt.message||"Failed to delete subject"})}catch{g({type:"error",message:"Failed to delete subject"})}},[s,nr]),Gt=S.useCallback((he,vt)=>{He(kr=>({...kr,[he]:vt}))},[]),xt=S.useCallback(async he=>{if(he.preventDefault(),!Pe.startDate||!Pe.endDate||!Pe.teacherId){g({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const vt=await s("/.netlify/functions/delete-test-data",Pe);vt.success?(g({type:"success",message:`Successfully deleted ${vt.deletedCount} test records!`}),dr(!1),He({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):g({type:"error",message:vt.message||"Failed to delete test data"})}catch{g({type:"error",message:"Failed to delete test data"})}},[Pe,s]),Jt=S.useCallback(async(he,vt,kr)=>{try{const Cr=await n("/.netlify/functions/get-test-assignments");if(Cr.success&&Cr.assignments){const Nn=Cr.assignments.filter(_n=>_n.test_id===parseInt(he)&&_n.test_type===vt);if(Nn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const _n of Nn){const Zr=await s("/.netlify/functions/remove-assignment",{teacher_id:kr,assignment_id:_n.assignment_id,test_type:vt,test_id:he});if(!Zr.success){g({type:"error",message:`Failed to complete test: ${Zr.message}`});return}}g({type:"success",message:"Test marked as complete successfully!"}),await ue()}else g({type:"error",message:"Failed to get test assignments"})}catch(Cr){console.error("Error completing test:",Cr),g({type:"error",message:"Failed to complete test"})}},[s,n,ue]),wr=S.useCallback(async(he,vt,kr)=>{try{const Cr=await n("/.netlify/functions/get-test-assignments");if(Cr.success&&Cr.assignments){const Nn=Cr.assignments.filter(_n=>_n.test_id===parseInt(he)&&_n.test_type===vt);if(Nn.length===0){g({type:"error",message:"No assignments found for this test"});return}for(const _n of Nn){const Zr=await s("/.netlify/functions/remove-assignment",{teacher_id:kr,assignment_id:_n.assignment_id,test_type:vt,test_id:he,mark_active:!0});if(!Zr.success){g({type:"error",message:`Failed to reactivate test: ${Zr.message}`});return}}g({type:"success",message:"Test marked as active successfully!"}),await ue()}else g({type:"error",message:"Failed to get test assignments"})}catch(Cr){console.error("Error reactivating test:",Cr),g({type:"error",message:"Failed to reactivate test"})}},[s,n,ue]),Sr=S.useCallback(async()=>{try{if(ce(!le),!le){const he=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",he),re(he.tests||[]),console.log(" Actual tests set to state:",he.tests||[])}}catch(he){console.error("Error loading actual tests:",he),g({type:"error",message:"Failed to load tests"})}},[n,le]),xr=S.useCallback(async(he,vt,kr)=>{try{const Cr=await s("/.netlify/functions/delete-test",{test_id:he,test_type:vt,teacher_id:kr});Cr.success?(g({type:"success",message:"Test deleted successfully!"}),await Sr()):g({type:"error",message:`Failed to delete test: ${Cr.message}`})}catch(Cr){console.error("Error deleting test:",Cr),g({type:"error",message:"Failed to delete test"})}},[s,Sr]),Ir=E?ut.filter(he=>he.grade.toString()===E):ut,rn=M.filter(he=>{const vt=!W||he.teacher_id===W,kr=!z||new Date(he.created_at)>=new Date(z),Cr=!J||new Date(he.created_at)<=new Date(J+"T23:59:59"),Nn=X?he.is_active:!he.is_active;return vt&&kr&&Cr&&Nn}),Jr=be.filter(he=>{const vt=!pe||he.teacher_id===pe,kr=!Ae||new Date(he.created_at)>=new Date(Ae),Cr=!Le||new Date(he.created_at)<=new Date(Le+"T23:59:59");return vt&&kr&&Cr});return l.jsxs(at.div,{id:"admin-cabinet-main",className:Oe.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(at.div,{className:Oe.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:Oe.headerContent,children:l.jsxs("div",{className:Oe.headerFlex,children:[l.jsxs(at.div,{className:Oe.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(at.div,{className:Oe.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:Oe.adminText,children:e?.username||"Administrator"}),l.jsx("p",{className:Oe.adminSubtext,children:"Administrator Dashboard"})]})]}),l.jsxs(at.div,{className:Oe.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:$e,className:Oe.menuButton,style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(at.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Qe?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(wo,{children:Qe&&l.jsx(at.div,{className:Oe.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(at.button,{onClick:Ue,className:Oe.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(at.button,{onClick:()=>{$e(),r()},className:Oe.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&l.jsx(Hr,{text:"Loading..."}),u&&l.jsx(uc,{type:"error",message:u,onClose:()=>d(null)}),f&&l.jsx(uc,{type:f.type,message:f.message,onClose:()=>g(null)}),ht&&l.jsx("div",{className:Oe.modalOverlay,children:l.jsxs("div",{className:Oe.modalContent,children:[l.jsx("h2",{className:Oe.modalTitle,children:"Change Password"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{htmlFor:"currentPassword",className:Oe.formLabel,children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",className:Oe.formInput})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{htmlFor:"newPassword",className:Oe.formLabel,children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",className:Oe.formInput})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{htmlFor:"confirmPassword",className:Oe.formLabel,children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",className:Oe.formInput})]}),l.jsxs("div",{className:Oe.modalActions,children:[l.jsx(et,{type:"button",variant:"secondary",onClick:Et,className:"flex-1",children:"Cancel"}),l.jsx(et,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),l.jsx(at.div,{className:Oe.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:l.jsxs("div",{className:"space-y-6",children:[l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsx(jt.Header,{className:Oe.cardHeader,children:l.jsx(jt.Title,{className:Oe.cardTitle,children:"User Management"})}),l.jsxs(jt.Body,{className:Oe.cardBody,children:[l.jsxs("div",{className:Oe.buttonGroup,children:[l.jsx(et,{variant:"primary",onClick:()=>Tt(!0),className:Oe.buttonPrimary,children:"Add User"}),l.jsx(et,{variant:"secondary",onClick:()=>{zt(),x(!p)},className:Oe.buttonSecondary,children:p?"Hide Users Table":"Get All Users "})]}),l.jsx(wo,{children:Ze&&l.jsxs(at.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),l.jsxs("form",{onSubmit:_e,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGrid,children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Grade"}),l.jsx("input",{type:"text",value:Vt.grade,onChange:he=>we("grade",he.target.value),className:Oe.formInput,placeholder:"Enter grade"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Class"}),l.jsx("input",{type:"text",value:Vt.class,onChange:he=>we("class",he.target.value),className:Oe.formInput,placeholder:"Enter class"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Number"}),l.jsx("input",{type:"text",value:Vt.number,onChange:he=>we("number",he.target.value),className:Oe.formInput,placeholder:"Enter number"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Student ID"}),l.jsx("input",{type:"text",value:Vt.student_id,onChange:he=>we("student_id",he.target.value),className:Oe.formInput,placeholder:"Enter student ID"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Name"}),l.jsx("input",{type:"text",value:Vt.name,onChange:he=>we("name",he.target.value),className:Oe.formInput,placeholder:"Enter name"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Surname"}),l.jsx("input",{type:"text",value:Vt.surname,onChange:he=>we("surname",he.target.value),className:Oe.formInput,placeholder:"Enter surname"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Nickname"}),l.jsx("input",{type:"text",value:Vt.nickname,onChange:he=>we("nickname",he.target.value),className:Oe.formInput,placeholder:"Enter nickname"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Vt.password,onChange:he=>we("password",he.target.value),className:Oe.formInput,placeholder:"Enter password"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"userActive",checked:Vt.is_active,onChange:he=>we("is_active",he.target.checked),className:Oe.formCheckbox}),l.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(et,{type:"button",variant:"secondary",onClick:()=>Tt(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(et,{type:"submit",variant:"primary",className:Oe.buttonPrimary,children:"Add User"})]})]})]})}),p&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",Ir.length," of ",ut.length,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),l.jsxs("select",{value:E,onChange:he=>P(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Grades"}),[...new Set(ut.map(he=>he.grade))].sort().map(he=>l.jsxs("option",{value:he,children:["Grade ",he]},he))]})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Grade"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Class"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Student ID"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Number"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Nickname"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:Ir.map((he,vt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsxs("td",{className:Oe.tableCell,children:[he.name," ",he.surname]}),l.jsx("td",{className:Oe.tableCell,children:he.grade}),l.jsx("td",{className:Oe.tableCell,children:he.class}),l.jsx("td",{className:Oe.tableCell,children:he.student_id}),l.jsx("td",{className:Oe.tableCell,children:he.number}),l.jsx("td",{className:Oe.tableCell,children:he.nickname}),l.jsx("td",{className:Oe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>lt(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>oe(he.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.id||vt))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsxs(jt.Header,{className:Oe.cardHeader,children:[l.jsx(jt.Title,{className:Oe.cardTitle,children:"Teacher Management"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),l.jsx(et,{variant:"primary",onClick:()=>$t(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),l.jsx(et,{variant:"secondary",onClick:()=>{fr(),w(!v)},className:"text-xs whitespace-nowrap",children:v?"Hide Teachers Table":"Get All Teachers "})]})]}),l.jsxs(jt.Body,{className:Oe.cardBody,children:[l.jsx(wo,{children:Nt&&l.jsxs(at.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),l.jsxs("form",{onSubmit:Se,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGrid,children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Teacher ID"}),l.jsx("input",{type:"text",value:Te.teacher_id,onChange:he=>ye("teacher_id",he.target.value),className:Oe.formInput,placeholder:"Enter teacher ID"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Username"}),l.jsx("input",{type:"text",value:Te.username,onChange:he=>ye("username",he.target.value),className:Oe.formInput,placeholder:"Enter username"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Te.password,onChange:he=>ye("password",he.target.value),className:Oe.formInput,placeholder:"Enter password"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"First Name"}),l.jsx("input",{type:"text",value:Te.first_name,onChange:he=>ye("first_name",he.target.value),className:Oe.formInput,placeholder:"Enter first name"})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Last Name"}),l.jsx("input",{type:"text",value:Te.last_name,onChange:he=>ye("last_name",he.target.value),className:Oe.formInput,placeholder:"Enter last name"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacherActive",checked:Te.is_active,onChange:he=>ye("is_active",he.target.checked),className:Oe.formCheckbox}),l.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(et,{type:"button",variant:"secondary",onClick:()=>$t(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(et,{type:"submit",variant:"primary",className:Oe.buttonPrimary,children:"Add Teacher"})]})]})]})}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:j.name,onChange:he=>I({...j,name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),l.jsx("input",{type:"text",value:j.surname,onChange:he=>I({...j,surname:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),l.jsx("input",{type:"number",value:j.grade,onChange:he=>I({...j,grade:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("input",{type:"number",value:j.class,onChange:he=>I({...j,class:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",value:j.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),l.jsx("input",{type:"text",value:j.nickname,onChange:he=>I({...j,nickname:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:j.password,onChange:he=>I({...j,password:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:j.is_active,onChange:he=>I({...j,is_active:he.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{A(null),I({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:Ke,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),v&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",Rt.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Teacher ID"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Username"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Password"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Status"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:Rt.map((he,vt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:he.teacher_id}),l.jsxs("td",{className:Oe.tableCell,children:[he.first_name," ",he.last_name]}),l.jsx("td",{className:Oe.tableCell,children:he.username}),l.jsx("td",{className:Oe.tableCell,children:he.password}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("span",{className:he.is_active?Oe.statusActive:Oe.statusInactive,children:he.is_active?"Active":"Inactive"})}),l.jsx("td",{className:Oe.tableCell,children:new Date(he.created_at).toLocaleDateString()}),l.jsx("td",{className:Oe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>fe(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>Ne(he.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.teacher_id||vt))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsx(jt.Header,{className:Oe.cardHeader,children:l.jsx(jt.Title,{className:Oe.cardTitle,children:"Subject Management"})}),l.jsxs(jt.Body,{className:Oe.cardBody,children:[l.jsxs("div",{className:Oe.buttonGroup,children:[l.jsx(et,{variant:"primary",onClick:()=>pr(!0),className:Oe.buttonPrimary,children:"Add Subject"}),l.jsx(et,{variant:"secondary",onClick:()=>{nr(),k(!C)},className:Oe.buttonSecondary,children:C?"Hide Subjects Table":"Get All Subjects "})]}),l.jsx(wo,{children:ir&&l.jsxs(at.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),l.jsxs("form",{onSubmit:Ve,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Subject Name"}),l.jsx("input",{type:"text",value:Me.subject,onChange:he=>xe("subject",he.target.value),className:Oe.formInput,placeholder:"Enter subject name",required:!0}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(et,{type:"button",variant:"secondary",onClick:()=>pr(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(et,{type:"submit",variant:"primary",className:Oe.buttonPrimary,children:"Add Subject"})]})]})]})}),L&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),l.jsx("input",{type:"text",value:Z.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",value:Z.username,onChange:he=>ae({...Z,username:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:Z.password,onChange:he=>ae({...Z,password:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),l.jsx("input",{type:"text",value:Z.first_name,onChange:he=>ae({...Z,first_name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),l.jsx("input",{type:"text",value:Z.last_name,onChange:he=>ae({...Z,last_name:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:Z.is_active,onChange:he=>ae({...Z,is_active:he.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{Y(null),ae({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:Ee,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),ee&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),l.jsx("input",{type:"text",value:B.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{type:"text",value:B.subject,onChange:he=>V({...B,subject:he.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>ne(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:ot,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),C&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",De.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Subject ID"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Subject Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:De.map((he,vt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:he.subject_id}),l.jsx("td",{className:Oe.tableCell,children:he.subject}),l.jsx("td",{className:Oe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Ye(he),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>pt(he.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},he.subject_id||vt))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsx(jt.Header,{className:Oe.cardHeader,children:l.jsx(jt.Title,{className:Oe.cardTitle,children:"Test Data Deletion"})}),l.jsxs(jt.Body,{className:Oe.cardBody,children:[l.jsx("div",{className:Oe.buttonGroup,children:l.jsx(et,{variant:"danger",onClick:()=>dr(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),l.jsx(wo,{children:Nr&&l.jsxs(at.div,{className:Oe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),l.jsxs("form",{onSubmit:xt,className:"space-y-4",children:[l.jsxs("div",{className:Oe.formGrid,children:[l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Start Date *"}),l.jsx("input",{type:"date",value:Pe.startDate,onChange:he=>Gt("startDate",he.target.value),className:Oe.formInput,required:!0})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"End Date *"}),l.jsx("input",{type:"date",value:Pe.endDate,onChange:he=>Gt("endDate",he.target.value),className:Oe.formInput,required:!0})]})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Teacher ID *"}),l.jsxs("select",{value:Pe.teacherId,onChange:he=>Gt("teacherId",he.target.value),className:Oe.formInput,required:!0,children:[l.jsx("option",{value:"",children:"Select a teacher"}),Rt.map(he=>l.jsxs("option",{value:he.teacher_id,children:[he.teacher_id," - ",he.first_name," ",he.last_name]},he.teacher_id))]})]}),l.jsxs("div",{className:Oe.formGroup,children:[l.jsx("label",{className:Oe.formLabel,children:"Subject (Optional)"}),l.jsxs("select",{value:Pe.subjectId,onChange:he=>Gt("subjectId",he.target.value),className:Oe.formInput,children:[l.jsx("option",{value:"",children:"All subjects"}),De.map(he=>l.jsx("option",{value:he.subject_id,children:he.subject},he.subject_id))]})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),l.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[l.jsx("p",{children:"This will permanently delete:"}),l.jsxs("ul",{className:"list-disc list-inside mt-1",children:[l.jsx("li",{children:"All test records within the date range"}),l.jsx("li",{children:"All test questions and answers"}),l.jsx("li",{children:"All test results and submissions"}),l.jsx("li",{children:"All test assignments"}),l.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),l.jsxs("div",{className:Oe.formActions,children:[l.jsx(et,{type:"button",variant:"secondary",onClick:()=>dr(!1),className:Oe.buttonSecondary,children:"Cancel"}),l.jsx(et,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsx(jt.Header,{className:Oe.cardHeader,children:l.jsx(jt.Title,{className:Oe.cardTitle,children:"Assignments Management"})}),l.jsxs(jt.Body,{className:Oe.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(et,{variant:"primary",onClick:ue,className:Oe.buttonPrimary,children:_?"Hide Assignments Table":"Get All Assignments "})}),_&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"-mb-px flex space-x-8",children:[l.jsx("button",{onClick:()=>ie(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${X?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),l.jsx("button",{onClick:()=>ie(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${X?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),_&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[X?"Active":"Inactive"," Assignments (",rn.length," of ",M.filter(he=>X?he.is_active:!he.is_active).length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:W,onChange:he=>R(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Rt.map(he=>l.jsxs("option",{value:he.teacher_id,children:[he.first_name," ",he.last_name]},he.teacher_id))]}),l.jsx("input",{type:"date",value:z,onChange:he=>K(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:J,onChange:he=>se(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:rn.map((he,vt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:he.test_name}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:he.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Oe.tableCell,children:he.teacher_name}),l.jsx("td",{className:Oe.tableCell,children:he.num_questions}),l.jsx("td",{className:Oe.tableCell,children:new Date(he.created_at).toLocaleDateString()}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:X?l.jsx("button",{onClick:()=>Jt(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):l.jsx("button",{onClick:()=>wr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${he.test_type}-${he.test_id}-${vt}`))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsx(jt.Header,{className:Oe.cardHeader,children:l.jsx(jt.Title,{className:Oe.cardTitle,children:"Test Management"})}),l.jsxs(jt.Body,{className:Oe.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(et,{variant:"primary",onClick:Sr,className:Oe.buttonPrimary,children:le?"Hide Tests Table":"Get All Tests "})}),le&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Jr.length," of ",be.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:pe,onChange:he=>Ce(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Rt.map(he=>l.jsxs("option",{value:he.teacher_id,children:[he.first_name," ",he.last_name]},he.teacher_id))]}),l.jsx("input",{type:"date",value:Ae,onChange:he=>We(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Le,onChange:he=>At(he.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Oe.table,children:[l.jsx("thead",{className:Oe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Oe.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Oe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Oe.tableBody,children:Jr.map((he,vt)=>l.jsxs("tr",{className:Oe.tableRow,children:[l.jsx("td",{className:Oe.tableCell,children:he.test_name}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:he.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Oe.tableCell,children:he.teacher_name}),l.jsx("td",{className:Oe.tableCell,children:he.num_questions}),l.jsx("td",{className:Oe.tableCell,children:new Date(he.created_at).toLocaleDateString()}),l.jsx("td",{className:Oe.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>xr(he.test_id,he.test_type,he.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${he.test_type}-${he.test_id}-${vt}`))})]})})})]})]})]})}),l.jsx(at.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(jt,{className:Oe.cardContainer,children:[l.jsx(jt.Header,{className:Oe.cardHeader,children:l.jsx(jt.Title,{className:Oe.cardTitle,children:"Debug & Testing"})}),l.jsx(jt.Body,{className:Oe.cardBody})]})})]})})]})},C3e=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=cs(),{get:n}=Jo(),{showNotification:s}=ka();S.useEffect(()=>{a()},[]);const a=S.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),c(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=S.useCallback(()=>{console.log(" Initializing global event listeners...");const d=f=>{f.ctrlKey&&f.key==="k"&&(f.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=S.useCallback(async()=>{try{console.log(" Loading admin data...");const[d,f,g,p]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);d.status==="fulfilled"&&d.value?.success&&console.log(" Users loaded:",d.value.users?.length||0),f.status==="fulfilled"&&f.value?.success&&console.log(" Teachers loaded:",f.value.teachers?.length||0),g.status==="fulfilled"&&g.value?.success&&console.log(" Subjects loaded:",g.value.subjects?.length||0),p.status==="fulfilled"&&p.value?.success&&console.log(" Academic years loaded:",p.value.academic_years?.length||0),console.log(" Admin data loading completed")}catch(d){throw console.error(" Error loading admin data:",d),d}},[n]),c=S.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=S.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const f=document.getElementById("allSubjectsContainer"),g=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!f){console.error(" allSubjectsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const f=document.getElementById("addSubjectForm");f&&(f.style.display="block")},window.hideAddSubjectForm=()=>{const f=document.getElementById("addSubjectForm"),g=document.getElementById("newSubjectForm");f&&(f.style.display="none"),g&&g.reset()},window.showAddAcademicYearForm=()=>{const f=document.getElementById("addAcademicYearForm");f&&(f.style.display="block")},window.hideAddAcademicYearForm=()=>{const f=document.getElementById("addAcademicYearForm"),g=document.getElementById("newAcademicYearForm");f&&(f.style.display="none"),g&&g.reset()},window.toggleUsersContent=()=>{const f=document.getElementById("allUsersContainer"),g=document.querySelector('button[onclick="toggleUsersContent()"]');if(!f){console.error(" allUsersContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const f=document.getElementById("addUserForm");f&&(f.style.display="block")},window.hideAddUserForm=()=>{const f=document.getElementById("addUserForm"),g=document.getElementById("newUserForm");f&&(f.style.display="none"),g&&g.reset()},window.showAddTeacherForm=()=>{const f=document.getElementById("addTeacherForm");f&&(f.style.display="block")},window.hideAddTeacherForm=()=>{const f=document.getElementById("addTeacherForm"),g=document.getElementById("newTeacherForm");f&&(f.style.display="none"),g&&g.reset()},window.toggleTeachersContent=()=>{const f=document.getElementById("allTeachersContainer"),g=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!f){console.error(" allTeachersContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const f=document.getElementById("allTestsContainer"),g=document.querySelector('button[onclick="toggleTestsContent()"]');if(!f){console.error(" allTestsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const f=document.getElementById("allAssignmentsContainer"),g=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!f){console.error(" allAssignmentsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const f=document.getElementById("allResultsContainer"),g=document.querySelector('button[onclick="toggleResultsContent()"]');if(!f){console.error(" allResultsContainer not found");return}if(!g){console.error(" Button not found");return}const p=f.style.display!=="none";f.style.display=p?"none":"block",g.textContent=p?"Show Results":"Hide Results"};const d={};window.toggleSection=f=>{console.log(` toggleSection called with sectionId: ${f}`);const g=Date.now();if(d[f]&&g-d[f]<300){console.log(` Ignoring rapid successive call for ${f}`);return}d[f]=g;const p=document.getElementById(f);if(!p){console.error(` Section with id '${f}' not found!`);return}const x=p.style.display!=="none";p.style.display=x?"none":"block";const v=document.querySelector(`button[onclick="toggleSection('${f}')"]`);v&&(v.textContent=x?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const f=document.querySelectorAll(".section-header");console.log(` Found ${f.length} section headers`),f.forEach((g,p)=>{const x=g.textContent.trim();if(console.log(` Processing header ${p+1}:`,x),g.dataset.listenerAdded==="true"){console.log(` Skipping header ${x} - listener already added`);return}g.addEventListener("click",()=>{const v=g.dataset.sectionId;v&&window.toggleSection(v)}),g.dataset.listenerAdded="true",console.log(` Added click listener to header: ${x}`)})},window.makeFieldEditable=f=>{const g=f.textContent;f.dataset.field;const p=document.createElement("input");p.type="text",p.value=g,p.className="editable-input";const x=document.createElement("button");x.textContent="Save",x.className="btn-save",x.onclick=()=>window.saveField(f,p,x,v);const v=document.createElement("button");v.textContent="Cancel",v.className="btn-cancel",v.onclick=()=>{f.textContent=g,f.style.display="block",p.remove(),x.remove(),v.remove()},f.style.display="none",f.parentNode.insertBefore(p,f),f.parentNode.insertBefore(x,f),f.parentNode.insertBefore(v,f)},window.saveField=(f,g,p,x)=>{const v=g.value.trim(),w=f.dataset.field,C=f.dataset.recordId;if(!v){alert("Field cannot be empty");return}console.log(`Saving field ${w} for record ${C} with value: ${v}`),f.textContent=v,f.style.display="block",g.remove(),p.remove(),x.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const f=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(f){return console.error(" localStorage error:",f),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const f={};for(let v=0;v<localStorage.length;v++){const w=localStorage.key(v);f[w]=localStorage.getItem(w)}const g=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),p=URL.createObjectURL(g),x=document.createElement("a");x.href=p,x.download="localStorage-backup.json",x.click(),URL.revokeObjectURL(p)},console.log(" Admin functions exposed globally")},[]);return e()?l.jsx(k3e,{}):l.jsxs("div",{className:"admin-error",children:[l.jsx("h2",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access the admin dashboard."}),l.jsx("button",{onClick:r,children:"Return to Login"})]})},aT=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=cs();return s?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?l.jsx(pm,{to:"/unauthorized",replace:!0}):e:l.jsx(pm,{to:"/login",replace:!0})},T3e=()=>l.jsxs("div",{className:"unauthorized-page",children:[l.jsx("h1",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access this page."})]}),E3e=()=>l.jsx(OM,{children:l.jsx(PB,{children:l.jsx(AB,{children:l.jsx(VK,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx("div",{className:"app",children:l.jsxs(gN,{children:[l.jsx(Os,{path:"/login",element:l.jsx(iae,{})}),l.jsx(Os,{path:"/unauthorized",element:l.jsx(T3e,{})}),l.jsx(Os,{path:"/student/*",element:l.jsx(aT,{allowedRoles:["student"],children:l.jsx(hie,{})})}),l.jsx(Os,{path:"/teacher/*",element:l.jsx(aT,{allowedRoles:["teacher"],children:l.jsx(S3e,{})})}),l.jsx(Os,{path:"/admin/*",element:l.jsx(aT,{allowedRoles:["admin"],children:l.jsx(C3e,{})})}),l.jsx(Os,{path:"/",element:l.jsx(pm,{to:"/login",replace:!0})}),l.jsx(Os,{path:"*",element:l.jsx(pm,{to:"/login",replace:!0})})]})})})})})});class N3e{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data",this.startIntegrityMonitoring()}startIntegrityMonitoring(){setInterval(()=>{this.performIntegrityCheck()},3e4)}performIntegrityCheck(){const t=localStorage.getItem(this.tokenKey);t&&!this.validateTokenFormat(t)&&(console.warn("Integrity check failed - corrupted token detected"),this.restoreFromBackup()||(console.warn("No valid backup available - clearing authentication"),this.clearAuth()))}getToken(){const t=localStorage.getItem(this.tokenKey);return t&&!this.validateTokenFormat(t)?(console.warn("Corrupted token detected in storage - clearing it"),this.clearAuth(),null):t}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){if(!this.validateTokenFormat(t))return console.error("Invalid token format - refusing to store corrupted token"),!1;try{this.decodeToken(t);const r=localStorage.getItem(this.tokenKey);return r&&localStorage.setItem(`${this.tokenKey}_backup`,r),localStorage.setItem(this.tokenKey,t),console.log("Token stored successfully with backup"),!0}catch(r){return console.error("Failed to store token - token is corrupted:",r),!1}}restoreFromBackup(){const t=localStorage.getItem(`${this.tokenKey}_backup`);return t&&this.validateTokenFormat(t)?(console.log("Restoring token from backup"),localStorage.setItem(this.tokenKey,t),!0):!1}validateTokenFormat(t){if(!t||typeof t!="string")return console.warn("Token validation failed: not a string"),!1;if(!t.includes("."))return console.warn("Token validation failed: not a JWT format"),!1;const r=t.split(".");if(r.length!==3)return console.warn("Token validation failed: not 3 parts"),!1;for(let n=0;n<r.length;n++)try{atob(r[n].replace(/-/g,"+").replace(/_/g,"/"))}catch{return console.warn(`Token validation failed: part ${n} is not valid base64`),!1}return!0}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){return this.setToken(t)?(this.setUserData({role:r}),localStorage.setItem("accessToken",t),!0):(console.error("Failed to set token - token validation failed"),!1)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),!1;const r=t.split(".");if(r.length!==3)return console.warn("Invalid token format - not 3 parts"),this.clearAuth(),!1;const n=JSON.parse(atob(r[1])),s=Date.now()/1e3;return n.exp>s}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){try{localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey),localStorage.removeItem(`${this.tokenKey}_backup`)}catch(t){console.error("Failed to clear localStorage - possible corruption:",t),this.forceClearAllAuthData()}}forceClearAllAuthData(){["auth_token","accessToken","userRole","userData","refresh_token","auth_token_backup"].forEach(r=>{try{localStorage.removeItem(r)}catch(n){console.warn(`Failed to remove ${r}:`,n)}})}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),null;const r=t.split(".");return r.length!==3?(console.warn("Invalid token format - not 3 parts"),this.clearAuth(),null):JSON.parse(atob(r[1]))}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const dN=new N3e;window.tokenManager=dN;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{dN.init()}):dN.init());class SV{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new SV;typeof l_<"u"&&l_.exports&&(l_.exports=SV);const A3e=()=>{const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e))},j3e=()=>{A3e(),eK.createRoot(document.getElementById("root")).render(l.jsx(Fs.StrictMode,{children:l.jsx(E3e,{})}))};j3e()});export default P3e();
