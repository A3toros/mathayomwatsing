var DP=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var are=DP((gre,M1)=>{function C3(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var O1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _p(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lv={exports:{}},Sg={},Bv={exports:{}},Lr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vk;function IP(){if(vk)return Lr;vk=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.iterator;function g(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function b(H,O,z){this.props=H,this.context=O,this.refs=w,this.updater=z||y}b.prototype.isReactComponent={},b.prototype.setState=function(H,O){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,O,"setState")},b.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function E(){}E.prototype=b.prototype;function k(H,O,z){this.props=H,this.context=O,this.refs=w,this.updater=z||y}var _=k.prototype=new E;_.constructor=k,v(_,b.prototype),_.isPureReactComponent=!0;var N=Array.isArray,A=Object.prototype.hasOwnProperty,P={current:null},R={key:!0,ref:!0,__self:!0,__source:!0};function T(H,O,z){var Y,J={},te=null,ee=null;if(O!=null)for(Y in O.ref!==void 0&&(ee=O.ref),O.key!==void 0&&(te=""+O.key),O)A.call(O,Y)&&!R.hasOwnProperty(Y)&&(J[Y]=O[Y]);var ie=arguments.length-2;if(ie===1)J.children=z;else if(1<ie){for(var me=Array(ie),Ce=0;Ce<ie;Ce++)me[Ce]=arguments[Ce+2];J.children=me}if(H&&H.defaultProps)for(Y in ie=H.defaultProps,ie)J[Y]===void 0&&(J[Y]=ie[Y]);return{$$typeof:e,type:H,key:te,ref:ee,props:J,_owner:P.current}}function D(H,O){return{$$typeof:e,type:H.type,key:O,ref:H.ref,props:H.props,_owner:H._owner}}function I(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function K(H){var O={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(z){return O[z]})}var X=/\/+/g;function Z(H,O){return typeof H=="object"&&H!==null&&H.key!=null?K(""+H.key):O.toString(36)}function oe(H,O,z,Y,J){var te=typeof H;(te==="undefined"||te==="boolean")&&(H=null);var ee=!1;if(H===null)ee=!0;else switch(te){case"string":case"number":ee=!0;break;case"object":switch(H.$$typeof){case e:case t:ee=!0}}if(ee)return ee=H,J=J(ee),H=Y===""?"."+Z(ee,0):Y,N(J)?(z="",H!=null&&(z=H.replace(X,"$&/")+"/"),oe(J,O,z,"",function(Ce){return Ce})):J!=null&&(I(J)&&(J=D(J,z+(!J.key||ee&&ee.key===J.key?"":(""+J.key).replace(X,"$&/")+"/")+H)),O.push(J)),1;if(ee=0,Y=Y===""?".":Y+":",N(H))for(var ie=0;ie<H.length;ie++){te=H[ie];var me=Y+Z(te,ie);ee+=oe(te,O,z,me,J)}else if(me=g(H),typeof me=="function")for(H=me.call(H),ie=0;!(te=H.next()).done;)te=te.value,me=Y+Z(te,ie++),ee+=oe(te,O,z,me,J);else if(te==="object")throw O=String(H),Error("Objects are not valid as a React child (found: "+(O==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":O)+"). If you meant to render a collection of children, use an array instead.");return ee}function q(H,O,z){if(H==null)return H;var Y=[],J=0;return oe(H,Y,"","",function(te){return O.call(z,te,J++)}),Y}function re(H){if(H._status===-1){var O=H._result;O=O(),O.then(function(z){(H._status===0||H._status===-1)&&(H._status=1,H._result=z)},function(z){(H._status===0||H._status===-1)&&(H._status=2,H._result=z)}),H._status===-1&&(H._status=0,H._result=O)}if(H._status===1)return H._result.default;throw H._result}var M={current:null},W={transition:null},B={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:W,ReactCurrentOwner:P};function G(){throw Error("act(...) is not supported in production builds of React.")}return Lr.Children={map:q,forEach:function(H,O,z){q(H,function(){O.apply(this,arguments)},z)},count:function(H){var O=0;return q(H,function(){O++}),O},toArray:function(H){return q(H,function(O){return O})||[]},only:function(H){if(!I(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Lr.Component=b,Lr.Fragment=r,Lr.Profiler=s,Lr.PureComponent=k,Lr.StrictMode=n,Lr.Suspense=c,Lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,Lr.act=G,Lr.cloneElement=function(H,O,z){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var Y=v({},H.props),J=H.key,te=H.ref,ee=H._owner;if(O!=null){if(O.ref!==void 0&&(te=O.ref,ee=P.current),O.key!==void 0&&(J=""+O.key),H.type&&H.type.defaultProps)var ie=H.type.defaultProps;for(me in O)A.call(O,me)&&!R.hasOwnProperty(me)&&(Y[me]=O[me]===void 0&&ie!==void 0?ie[me]:O[me])}var me=arguments.length-2;if(me===1)Y.children=z;else if(1<me){ie=Array(me);for(var Ce=0;Ce<me;Ce++)ie[Ce]=arguments[Ce+2];Y.children=ie}return{$$typeof:e,type:H.type,key:J,ref:te,props:Y,_owner:ee}},Lr.createContext=function(H){return H={$$typeof:i,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:a,_context:H},H.Consumer=H},Lr.createElement=T,Lr.createFactory=function(H){var O=T.bind(null,H);return O.type=H,O},Lr.createRef=function(){return{current:null}},Lr.forwardRef=function(H){return{$$typeof:o,render:H}},Lr.isValidElement=I,Lr.lazy=function(H){return{$$typeof:f,_payload:{_status:-1,_result:H},_init:re}},Lr.memo=function(H,O){return{$$typeof:d,type:H,compare:O===void 0?null:O}},Lr.startTransition=function(H){var O=W.transition;W.transition={};try{H()}finally{W.transition=O}},Lr.unstable_act=G,Lr.useCallback=function(H,O){return M.current.useCallback(H,O)},Lr.useContext=function(H){return M.current.useContext(H)},Lr.useDebugValue=function(){},Lr.useDeferredValue=function(H){return M.current.useDeferredValue(H)},Lr.useEffect=function(H,O){return M.current.useEffect(H,O)},Lr.useId=function(){return M.current.useId()},Lr.useImperativeHandle=function(H,O,z){return M.current.useImperativeHandle(H,O,z)},Lr.useInsertionEffect=function(H,O){return M.current.useInsertionEffect(H,O)},Lr.useLayoutEffect=function(H,O){return M.current.useLayoutEffect(H,O)},Lr.useMemo=function(H,O){return M.current.useMemo(H,O)},Lr.useReducer=function(H,O,z){return M.current.useReducer(H,O,z)},Lr.useRef=function(H){return M.current.useRef(H)},Lr.useState=function(H){return M.current.useState(H)},Lr.useSyncExternalStore=function(H,O,z){return M.current.useSyncExternalStore(H,O,z)},Lr.useTransition=function(){return M.current.useTransition()},Lr.version="18.3.1",Lr}var wk;function ky(){return wk||(wk=1,Bv.exports=IP()),Bv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _k;function MP(){if(_k)return Sg;_k=1;var e=ky(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,d){var f,p={},g=null,y=null;d!==void 0&&(g=""+d),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(y=c.ref);for(f in c)n.call(c,f)&&!a.hasOwnProperty(f)&&(p[f]=c[f]);if(o&&o.defaultProps)for(f in c=o.defaultProps,c)p[f]===void 0&&(p[f]=c[f]);return{$$typeof:t,type:o,key:g,ref:y,props:p,_owner:s.current}}return Sg.Fragment=r,Sg.jsx=i,Sg.jsxs=i,Sg}var bk;function OP(){return bk||(bk=1,Lv.exports=MP()),Lv.exports}var l=OP(),C=ky();const es=_p(C),LP=C3({__proto__:null,default:es},[C]);var Jx={},Uv={exports:{}},pi={},$v={exports:{}},Wv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sk;function BP(){return Sk||(Sk=1,(function(e){function t(W,B){var G=W.length;W.push(B);e:for(;0<G;){var H=G-1>>>1,O=W[H];if(0<s(O,B))W[H]=B,W[G]=O,G=H;else break e}}function r(W){return W.length===0?null:W[0]}function n(W){if(W.length===0)return null;var B=W[0],G=W.pop();if(G!==B){W[0]=G;e:for(var H=0,O=W.length,z=O>>>1;H<z;){var Y=2*(H+1)-1,J=W[Y],te=Y+1,ee=W[te];if(0>s(J,G))te<O&&0>s(ee,J)?(W[H]=ee,W[te]=G,H=te):(W[H]=J,W[Y]=G,H=Y);else if(te<O&&0>s(ee,G))W[H]=ee,W[te]=G,H=te;else break e}}return B}function s(W,B){var G=W.sortIndex-B.sortIndex;return G!==0?G:W.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],d=[],f=1,p=null,g=3,y=!1,v=!1,w=!1,b=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(W){for(var B=r(d);B!==null;){if(B.callback===null)n(d);else if(B.startTime<=W)n(d),B.sortIndex=B.expirationTime,t(c,B);else break;B=r(d)}}function N(W){if(w=!1,_(W),!v)if(r(c)!==null)v=!0,re(A);else{var B=r(d);B!==null&&M(N,B.startTime-W)}}function A(W,B){v=!1,w&&(w=!1,E(T),T=-1),y=!0;var G=g;try{for(_(B),p=r(c);p!==null&&(!(p.expirationTime>B)||W&&!K());){var H=p.callback;if(typeof H=="function"){p.callback=null,g=p.priorityLevel;var O=H(p.expirationTime<=B);B=e.unstable_now(),typeof O=="function"?p.callback=O:p===r(c)&&n(c),_(B)}else n(c);p=r(c)}if(p!==null)var z=!0;else{var Y=r(d);Y!==null&&M(N,Y.startTime-B),z=!1}return z}finally{p=null,g=G,y=!1}}var P=!1,R=null,T=-1,D=5,I=-1;function K(){return!(e.unstable_now()-I<D)}function X(){if(R!==null){var W=e.unstable_now();I=W;var B=!0;try{B=R(!0,W)}finally{B?Z():(P=!1,R=null)}}else P=!1}var Z;if(typeof k=="function")Z=function(){k(X)};else if(typeof MessageChannel<"u"){var oe=new MessageChannel,q=oe.port2;oe.port1.onmessage=X,Z=function(){q.postMessage(null)}}else Z=function(){b(X,0)};function re(W){R=W,P||(P=!0,Z())}function M(W,B){T=b(function(){W(e.unstable_now())},B)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){v||y||(v=!0,re(A))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(W){switch(g){case 1:case 2:case 3:var B=3;break;default:B=g}var G=g;g=B;try{return W()}finally{g=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,B){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var G=g;g=W;try{return B()}finally{g=G}},e.unstable_scheduleCallback=function(W,B,G){var H=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?H+G:H):G=H,W){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=G+O,W={id:f++,callback:B,priorityLevel:W,startTime:G,expirationTime:O,sortIndex:-1},G>H?(W.sortIndex=G,t(d,W),r(c)===null&&W===r(d)&&(w?(E(T),T=-1):w=!0,M(N,G-H))):(W.sortIndex=O,t(c,W),v||y||(v=!0,re(A))),W},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(W){var B=g;return function(){var G=g;g=B;try{return W.apply(this,arguments)}finally{g=G}}}})(Wv)),Wv}var kk;function y2(){return kk||(kk=1,$v.exports=BP()),$v.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ck;function UP(){if(Ck)return pi;Ck=1;var e=ky(),t=y2();function r(u){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+u,S=1;S<arguments.length;S++)h+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(u,h){i(u,h),i(u+"Capture",h)}function i(u,h){for(s[u]=h,u=0;u<h.length;u++)n.add(h[u])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function g(u){return c.call(p,u)?!0:c.call(f,u)?!1:d.test(u)?p[u]=!0:(f[u]=!0,!1)}function y(u,h,S,F){if(S!==null&&S.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return F?!1:S!==null?!S.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function v(u,h,S,F){if(h===null||typeof h>"u"||y(u,h,S,F))return!0;if(F)return!1;if(S!==null)switch(S.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function w(u,h,S,F,U,Q,de){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=F,this.attributeNamespace=U,this.mustUseProperty=S,this.propertyName=u,this.type=h,this.sanitizeURL=Q,this.removeEmptyString=de}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){b[u]=new w(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var h=u[0];b[h]=new w(h,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){b[u]=new w(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){b[u]=new w(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){b[u]=new w(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){b[u]=new w(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){b[u]=new w(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){b[u]=new w(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){b[u]=new w(u,5,!1,u.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function k(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var h=u.replace(E,k);b[h]=new w(h,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var h=u.replace(E,k);b[h]=new w(h,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var h=u.replace(E,k);b[h]=new w(h,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){b[u]=new w(u,1,!1,u.toLowerCase(),null,!1,!1)}),b.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){b[u]=new w(u,1,!1,u.toLowerCase(),null,!0,!0)});function _(u,h,S,F){var U=b.hasOwnProperty(h)?b[h]:null;(U!==null?U.type!==0:F||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(v(h,S,U,F)&&(S=null),F||U===null?g(h)&&(S===null?u.removeAttribute(h):u.setAttribute(h,""+S)):U.mustUseProperty?u[U.propertyName]=S===null?U.type===3?!1:"":S:(h=U.attributeName,F=U.attributeNamespace,S===null?u.removeAttribute(h):(U=U.type,S=U===3||U===4&&S===!0?"":""+S,F?u.setAttributeNS(F,h,S):u.setAttribute(h,S))))}var N=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),P=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),K=Symbol.for("react.context"),X=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),oe=Symbol.for("react.suspense_list"),q=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),M=Symbol.for("react.offscreen"),W=Symbol.iterator;function B(u){return u===null||typeof u!="object"?null:(u=W&&u[W]||u["@@iterator"],typeof u=="function"?u:null)}var G=Object.assign,H;function O(u){if(H===void 0)try{throw Error()}catch(S){var h=S.stack.trim().match(/\n( *(at )?)/);H=h&&h[1]||""}return`
`+H+u}var z=!1;function Y(u,h){if(!u||z)return"";z=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(st){var F=st}Reflect.construct(u,[],h)}else{try{h.call()}catch(st){F=st}u.call(h.prototype)}else{try{throw Error()}catch(st){F=st}u()}}catch(st){if(st&&F&&typeof st.stack=="string"){for(var U=st.stack.split(`
`),Q=F.stack.split(`
`),de=U.length-1,je=Q.length-1;1<=de&&0<=je&&U[de]!==Q[je];)je--;for(;1<=de&&0<=je;de--,je--)if(U[de]!==Q[je]){if(de!==1||je!==1)do if(de--,je--,0>je||U[de]!==Q[je]){var Re=`
`+U[de].replace(" at new "," at ");return u.displayName&&Re.includes("<anonymous>")&&(Re=Re.replace("<anonymous>",u.displayName)),Re}while(1<=de&&0<=je);break}}}finally{z=!1,Error.prepareStackTrace=S}return(u=u?u.displayName||u.name:"")?O(u):""}function J(u){switch(u.tag){case 5:return O(u.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return u=Y(u.type,!1),u;case 11:return u=Y(u.type.render,!1),u;case 1:return u=Y(u.type,!0),u;default:return""}}function te(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case R:return"Fragment";case P:return"Portal";case D:return"Profiler";case T:return"StrictMode";case Z:return"Suspense";case oe:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case K:return(u.displayName||"Context")+".Consumer";case I:return(u._context.displayName||"Context")+".Provider";case X:var h=u.render;return u=u.displayName,u||(u=h.displayName||h.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case q:return h=u.displayName||null,h!==null?h:te(u.type)||"Memo";case re:h=u._payload,u=u._init;try{return te(u(h))}catch{}}return null}function ee(u){var h=u.type;switch(u.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=h.render,u=u.displayName||u.name||"",h.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return te(h);case 8:return h===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function ie(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function me(u){var h=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Ce(u){var h=me(u)?"checked":"value",S=Object.getOwnPropertyDescriptor(u.constructor.prototype,h),F=""+u[h];if(!u.hasOwnProperty(h)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var U=S.get,Q=S.set;return Object.defineProperty(u,h,{configurable:!0,get:function(){return U.call(this)},set:function(de){F=""+de,Q.call(this,de)}}),Object.defineProperty(u,h,{enumerable:S.enumerable}),{getValue:function(){return F},setValue:function(de){F=""+de},stopTracking:function(){u._valueTracker=null,delete u[h]}}}}function Oe(u){u._valueTracker||(u._valueTracker=Ce(u))}function fe(u){if(!u)return!1;var h=u._valueTracker;if(!h)return!0;var S=h.getValue(),F="";return u&&(F=me(u)?u.checked?"true":"false":u.value),u=F,u!==S?(h.setValue(u),!0):!1}function pe(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function He(u,h){var S=h.checked;return G({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??u._wrapperState.initialChecked})}function Ye(u,h){var S=h.defaultValue==null?"":h.defaultValue,F=h.checked!=null?h.checked:h.defaultChecked;S=ie(h.value!=null?h.value:S),u._wrapperState={initialChecked:F,initialValue:S,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function ot(u,h){h=h.checked,h!=null&&_(u,"checked",h,!1)}function Ve(u,h){ot(u,h);var S=ie(h.value),F=h.type;if(S!=null)F==="number"?(S===0&&u.value===""||u.value!=S)&&(u.value=""+S):u.value!==""+S&&(u.value=""+S);else if(F==="submit"||F==="reset"){u.removeAttribute("value");return}h.hasOwnProperty("value")?tt(u,h.type,S):h.hasOwnProperty("defaultValue")&&tt(u,h.type,ie(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(u.defaultChecked=!!h.defaultChecked)}function Rt(u,h,S){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var F=h.type;if(!(F!=="submit"&&F!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+u._wrapperState.initialValue,S||h===u.value||(u.value=h),u.defaultValue=h}S=u.name,S!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,S!==""&&(u.name=S)}function tt(u,h,S){(h!=="number"||pe(u.ownerDocument)!==u)&&(S==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+S&&(u.defaultValue=""+S))}var Le=Array.isArray;function De(u,h,S,F){if(u=u.options,h){h={};for(var U=0;U<S.length;U++)h["$"+S[U]]=!0;for(S=0;S<u.length;S++)U=h.hasOwnProperty("$"+u[S].value),u[S].selected!==U&&(u[S].selected=U),U&&F&&(u[S].defaultSelected=!0)}else{for(S=""+ie(S),h=null,U=0;U<u.length;U++){if(u[U].value===S){u[U].selected=!0,F&&(u[U].defaultSelected=!0);return}h!==null||u[U].disabled||(h=u[U])}h!==null&&(h.selected=!0)}}function Je(u,h){if(h.dangerouslySetInnerHTML!=null)throw Error(r(91));return G({},h,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function _t(u,h){var S=h.value;if(S==null){if(S=h.children,h=h.defaultValue,S!=null){if(h!=null)throw Error(r(92));if(Le(S)){if(1<S.length)throw Error(r(93));S=S[0]}h=S}h==null&&(h=""),S=h}u._wrapperState={initialValue:ie(S)}}function ht(u,h){var S=ie(h.value),F=ie(h.defaultValue);S!=null&&(S=""+S,S!==u.value&&(u.value=S),h.defaultValue==null&&u.defaultValue!==S&&(u.defaultValue=S)),F!=null&&(u.defaultValue=""+F)}function It(u){var h=u.textContent;h===u._wrapperState.initialValue&&h!==""&&h!==null&&(u.value=h)}function Mt(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function rt(u,h){return u==null||u==="http://www.w3.org/1999/xhtml"?Mt(h):u==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var qe,pt=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,S,F,U){MSApp.execUnsafeLocalFunction(function(){return u(h,S,F,U)})}:u})(function(u,h){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=h;else{for(qe=qe||document.createElement("div"),qe.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=qe.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;h.firstChild;)u.appendChild(h.firstChild)}});function lt(u,h){if(h){var S=u.firstChild;if(S&&S===u.lastChild&&S.nodeType===3){S.nodeValue=h;return}}u.textContent=h}var wt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Lt=["Webkit","ms","Moz","O"];Object.keys(wt).forEach(function(u){Lt.forEach(function(h){h=h+u.charAt(0).toUpperCase()+u.substring(1),wt[h]=wt[u]})});function Ht(u,h,S){return h==null||typeof h=="boolean"||h===""?"":S||typeof h!="number"||h===0||wt.hasOwnProperty(u)&&wt[u]?(""+h).trim():h+"px"}function Ie(u,h){u=u.style;for(var S in h)if(h.hasOwnProperty(S)){var F=S.indexOf("--")===0,U=Ht(S,h[S],F);S==="float"&&(S="cssFloat"),F?u.setProperty(S,U):u[S]=U}}var at=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gt(u,h){if(h){if(at[u]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(r(137,u));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(r(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(r(61))}if(h.style!=null&&typeof h.style!="object")throw Error(r(62))}}function At(u,h){if(u.indexOf("-")===-1)return typeof h.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ot=null;function Jt(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Ae=null,ye=null,he=null;function _e(u){if(u=gd(u)){if(typeof Ae!="function")throw Error(r(280));var h=u.stateNode;h&&(h=ws(h),Ae(u.stateNode,u.type,h))}}function $e(u){ye?he?he.push(u):he=[u]:ye=u}function St(){if(ye){var u=ye,h=he;if(he=ye=null,_e(u),h)for(u=0;u<h.length;u++)_e(h[u])}}function ct(u,h){return u(h)}function zt(){}var qt=!1;function Vt(u,h,S){if(qt)return u(h,S);qt=!0;try{return ct(u,h,S)}finally{qt=!1,(ye!==null||he!==null)&&(zt(),St())}}function gr(u,h){var S=u.stateNode;if(S===null)return null;var F=ws(S);if(F===null)return null;S=F[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(F=!F.disabled)||(u=u.type,F=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!F;break e;default:u=!1}if(u)return null;if(S&&typeof S!="function")throw Error(r(231,h,typeof S));return S}var Fr=!1;if(o)try{var fr={};Object.defineProperty(fr,"passive",{get:function(){Fr=!0}}),window.addEventListener("test",fr,fr),window.removeEventListener("test",fr,fr)}catch{Fr=!1}function cr(u,h,S,F,U,Q,de,je,Re){var st=Array.prototype.slice.call(arguments,3);try{h.apply(S,st)}catch(Nt){this.onError(Nt)}}var Pr=!1,Xr=null,ue=!1,ke=null,ge={onError:function(u){Pr=!0,Xr=u}};function ve(u,h,S,F,U,Q,de,je,Re){Pr=!1,Xr=null,cr.apply(ge,arguments)}function Se(u,h,S,F,U,Q,de,je,Re){if(ve.apply(this,arguments),Pr){if(Pr){var st=Xr;Pr=!1,Xr=null}else throw Error(r(198));ue||(ue=!0,ke=st)}}function Ee(u){var h=u,S=u;if(u.alternate)for(;h.return;)h=h.return;else{u=h;do h=u,(h.flags&4098)!==0&&(S=h.return),u=h.return;while(u)}return h.tag===3?S:null}function We(u){if(u.tag===13){var h=u.memoizedState;if(h===null&&(u=u.alternate,u!==null&&(h=u.memoizedState)),h!==null)return h.dehydrated}return null}function ut(u){if(Ee(u)!==u)throw Error(r(188))}function Ge(u){var h=u.alternate;if(!h){if(h=Ee(u),h===null)throw Error(r(188));return h!==u?null:u}for(var S=u,F=h;;){var U=S.return;if(U===null)break;var Q=U.alternate;if(Q===null){if(F=U.return,F!==null){S=F;continue}break}if(U.child===Q.child){for(Q=U.child;Q;){if(Q===S)return ut(U),u;if(Q===F)return ut(U),h;Q=Q.sibling}throw Error(r(188))}if(S.return!==F.return)S=U,F=Q;else{for(var de=!1,je=U.child;je;){if(je===S){de=!0,S=U,F=Q;break}if(je===F){de=!0,F=U,S=Q;break}je=je.sibling}if(!de){for(je=Q.child;je;){if(je===S){de=!0,S=Q,F=U;break}if(je===F){de=!0,F=Q,S=U;break}je=je.sibling}if(!de)throw Error(r(189))}}if(S.alternate!==F)throw Error(r(190))}if(S.tag!==3)throw Error(r(188));return S.stateNode.current===S?u:h}function le(u){return u=Ge(u),u!==null?se(u):null}function se(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var h=se(u);if(h!==null)return h;u=u.sibling}return null}var ce=t.unstable_scheduleCallback,we=t.unstable_cancelCallback,Te=t.unstable_shouldYield,Be=t.unstable_requestPaint,be=t.unstable_now,nt=t.unstable_getCurrentPriorityLevel,vt=t.unstable_ImmediatePriority,Fe=t.unstable_UserBlockingPriority,mt=t.unstable_NormalPriority,Xt=t.unstable_LowPriority,Rr=t.unstable_IdlePriority,Ar=null,hr=null;function er(u){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(Ar,u,void 0,(u.current.flags&128)===128)}catch{}}var Kt=Math.clz32?Math.clz32:dt,ae=Math.log,Ne=Math.LN2;function dt(u){return u>>>=0,u===0?32:31-(ae(u)/Ne|0)|0}var Ct=64,Dr=4194304;function _r(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function fn(u,h){var S=u.pendingLanes;if(S===0)return 0;var F=0,U=u.suspendedLanes,Q=u.pingedLanes,de=S&268435455;if(de!==0){var je=de&~U;je!==0?F=_r(je):(Q&=de,Q!==0&&(F=_r(Q)))}else de=S&~U,de!==0?F=_r(de):Q!==0&&(F=_r(Q));if(F===0)return 0;if(h!==0&&h!==F&&(h&U)===0&&(U=F&-F,Q=h&-h,U>=Q||U===16&&(Q&4194240)!==0))return h;if((F&4)!==0&&(F|=S&16),h=u.entangledLanes,h!==0)for(u=u.entanglements,h&=F;0<h;)S=31-Kt(h),U=1<<S,F|=u[S],h&=~U;return F}function wo(u,h){switch(u){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oi(u,h){for(var S=u.suspendedLanes,F=u.pingedLanes,U=u.expirationTimes,Q=u.pendingLanes;0<Q;){var de=31-Kt(Q),je=1<<de,Re=U[de];Re===-1?((je&S)===0||(je&F)!==0)&&(U[de]=wo(je,h)):Re<=h&&(u.expiredLanes|=je),Q&=~je}}function Us(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function bn(){var u=Ct;return Ct<<=1,(Ct&4194240)===0&&(Ct=64),u}function $s(u){for(var h=[],S=0;31>S;S++)h.push(u);return h}function Il(u,h,S){u.pendingLanes|=h,h!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,h=31-Kt(h),u[h]=S}function ov(u,h){var S=u.pendingLanes&~h;u.pendingLanes=h,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=h,u.mutableReadLanes&=h,u.entangledLanes&=h,h=u.entanglements;var F=u.eventTimes;for(u=u.expirationTimes;0<S;){var U=31-Kt(S),Q=1<<U;h[U]=0,F[U]=-1,u[U]=-1,S&=~Q}}function R0(u,h){var S=u.entangledLanes|=h;for(u=u.entanglements;S;){var F=31-Kt(S),U=1<<F;U&h|u[F]&h&&(u[F]|=h),S&=~U}}var Hr=0;function Zu(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Pc,Rc,Jp,Zp,Tf,Ef=!1,Dc=[],li=null,Xo=null,zi=null,Or=new Map,Ic=new Map,Hi=[],ex="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function tx(u,h){switch(u){case"focusin":case"focusout":li=null;break;case"dragenter":case"dragleave":Xo=null;break;case"mouseover":case"mouseout":zi=null;break;case"pointerover":case"pointerout":Or.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ic.delete(h.pointerId)}}function ed(u,h,S,F,U,Q){return u===null||u.nativeEvent!==Q?(u={blockedOn:h,domEventName:S,eventSystemFlags:F,nativeEvent:Q,targetContainers:[U]},h!==null&&(h=gd(h),h!==null&&Rc(h)),u):(u.eventSystemFlags|=F,h=u.targetContainers,U!==null&&h.indexOf(U)===-1&&h.push(U),u)}function ys(u,h,S,F,U){switch(h){case"focusin":return li=ed(li,u,h,S,F,U),!0;case"dragenter":return Xo=ed(Xo,u,h,S,F,U),!0;case"mouseover":return zi=ed(zi,u,h,S,F,U),!0;case"pointerover":var Q=U.pointerId;return Or.set(Q,ed(Or.get(Q)||null,u,h,S,F,U)),!0;case"gotpointercapture":return Q=U.pointerId,Ic.set(Q,ed(Ic.get(Q)||null,u,h,S,F,U)),!0}return!1}function Nf(u){var h=al(u.target);if(h!==null){var S=Ee(h);if(S!==null){if(h=S.tag,h===13){if(h=We(S),h!==null){u.blockedOn=h,Tf(u.priority,function(){Jp(S)});return}}else if(h===3&&S.stateNode.current.memoizedState.isDehydrated){u.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Af(u){if(u.blockedOn!==null)return!1;for(var h=u.targetContainers;0<h.length;){var S=Pf(u.domEventName,u.eventSystemFlags,h[0],u.nativeEvent);if(S===null){S=u.nativeEvent;var F=new S.constructor(S.type,S);Ot=F,S.target.dispatchEvent(F),Ot=null}else return h=gd(S),h!==null&&Rc(h),u.blockedOn=S,!1;h.shift()}return!0}function jf(u,h,S){Af(u)&&S.delete(h)}function lv(){Ef=!1,li!==null&&Af(li)&&(li=null),Xo!==null&&Af(Xo)&&(Xo=null),zi!==null&&Af(zi)&&(zi=null),Or.forEach(jf),Ic.forEach(jf)}function Yo(u,h){u.blockedOn===h&&(u.blockedOn=null,Ef||(Ef=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,lv)))}function Sa(u){function h(U){return Yo(U,u)}if(0<Dc.length){Yo(Dc[0],u);for(var S=1;S<Dc.length;S++){var F=Dc[S];F.blockedOn===u&&(F.blockedOn=null)}}for(li!==null&&Yo(li,u),Xo!==null&&Yo(Xo,u),zi!==null&&Yo(zi,u),Or.forEach(h),Ic.forEach(h),S=0;S<Hi.length;S++)F=Hi[S],F.blockedOn===u&&(F.blockedOn=null);for(;0<Hi.length&&(S=Hi[0],S.blockedOn===null);)Nf(S),S.blockedOn===null&&Hi.shift()}var Mc=N.ReactCurrentBatchConfig,Ff=!0;function Ei(u,h,S,F){var U=Hr,Q=Mc.transition;Mc.transition=null;try{Hr=1,Oc(u,h,S,F)}finally{Hr=U,Mc.transition=Q}}function _o(u,h,S,F){var U=Hr,Q=Mc.transition;Mc.transition=null;try{Hr=4,Oc(u,h,S,F)}finally{Hr=U,Mc.transition=Q}}function Oc(u,h,S,F){if(Ff){var U=Pf(u,h,S,F);if(U===null)qf(u,h,F,Lc,S),tx(u,F);else if(ys(U,u,h,S,F))F.stopPropagation();else if(tx(u,F),h&4&&-1<ex.indexOf(u)){for(;U!==null;){var Q=gd(U);if(Q!==null&&Pc(Q),Q=Pf(u,h,S,F),Q===null&&qf(u,h,F,Lc,S),Q===U)break;U=Q}U!==null&&F.stopPropagation()}else qf(u,h,F,null,S)}}var Lc=null;function Pf(u,h,S,F){if(Lc=null,u=Jt(F),u=al(u),u!==null)if(h=Ee(u),h===null)u=null;else if(S=h.tag,S===13){if(u=We(h),u!==null)return u;u=null}else if(S===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;u=null}else h!==u&&(u=null);return Lc=u,null}function rx(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nt()){case vt:return 1;case Fe:return 4;case mt:case Xt:return 16;case Rr:return 536870912;default:return 16}default:return 16}}var As=null,Qo=null,bo=null;function td(){if(bo)return bo;var u,h=Qo,S=h.length,F,U="value"in As?As.value:As.textContent,Q=U.length;for(u=0;u<S&&h[u]===U[u];u++);var de=S-u;for(F=1;F<=de&&h[S-F]===U[Q-F];F++);return bo=U.slice(u,1<F?1-F:void 0)}function Ml(u){var h=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&h===13&&(u=13)):u=h,u===10&&(u=13),32<=u||u===13?u:0}function na(){return!0}function Wa(){return!1}function is(u){function h(S,F,U,Q,de){this._reactName=S,this._targetInst=U,this.type=F,this.nativeEvent=Q,this.target=de,this.currentTarget=null;for(var je in u)u.hasOwnProperty(je)&&(S=u[je],this[je]=S?S(Q):Q[je]);return this.isDefaultPrevented=(Q.defaultPrevented!=null?Q.defaultPrevented:Q.returnValue===!1)?na:Wa,this.isPropagationStopped=Wa,this}return G(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=na)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=na)},persist:function(){},isPersistent:na}),h}var ka={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ni=is(ka),Ai=G({},ka,{view:0,detail:0}),nx=is(Ai),rd,nd,js,sa=G({},Ai,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ll,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==js&&(js&&u.type==="mousemove"?(rd=u.screenX-js.screenX,nd=u.screenY-js.screenY):nd=rd=0,js=u),rd)},movementY:function(u){return"movementY"in u?u.movementY:nd}}),vn=is(sa),sd=G({},sa,{dataTransfer:0}),ji=is(sd),sx=G({},Ai,{relatedTarget:0}),Rf=is(sx),D0=G({},ka,{animationName:0,elapsedTime:0,pseudoElement:0}),I0=is(D0),ax=G({},ka,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Df=is(ax),ix=G({},ka,{data:0}),Ol=is(ix),M0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},If={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uv(u){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(u):(u=If[u])?!!h[u]:!1}function Ll(){return uv}var Mf=G({},Ai,{key:function(u){if(u.key){var h=M0[u.key]||u.key;if(h!=="Unidentified")return h}return u.type==="keypress"?(u=Ml(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?cv[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ll,charCode:function(u){return u.type==="keypress"?Ml(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Ml(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),ox=is(Mf),lx=G({},sa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bl=is(lx),cx=G({},Ai,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ll}),Of=is(cx),Lf=G({},ka,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bc=is(Lf),O0=G({},sa,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),L0=is(O0),ux=[9,13,27,32],ad=o&&"CompositionEvent"in window,Ul=null;o&&"documentMode"in document&&(Ul=document.documentMode);var Uc=o&&"TextEvent"in window&&!Ul,za=o&&(!ad||Ul&&8<Ul&&11>=Ul),Jo=" ",Bf=!1;function B0(u,h){switch(u){case"keyup":return ux.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fi(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var Ha=!1;function U0(u,h){switch(u){case"compositionend":return Fi(h);case"keypress":return h.which!==32?null:(Bf=!0,Jo);case"textInput":return u=h.data,u===Jo&&Bf?null:u;default:return null}}function dx(u,h){if(Ha)return u==="compositionend"||!ad&&B0(u,h)?(u=td(),bo=Qo=As=null,Ha=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return za&&h.locale!=="ko"?null:h.data;default:return null}}var So={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ko(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h==="input"?!!So[u.type]:h==="textarea"}function id(u,h,S,F){$e(F),h=Xf(h,"onChange"),0<h.length&&(S=new Ni("onChange","change",null,S,F),u.push({event:S,listeners:h}))}var $c=null,Zo=null;function fx(u){Q0(u,0)}function el(u){var h=ls(u);if(fe(h))return u}function ci(u,h){if(u==="change")return h}var Wc=!1;if(o){var tl;if(o){var ui="oninput"in document;if(!ui){var Uf=document.createElement("div");Uf.setAttribute("oninput","return;"),ui=typeof Uf.oninput=="function"}tl=ui}else tl=!1;Wc=tl&&(!document.documentMode||9<document.documentMode)}function $l(){$c&&($c.detachEvent("onpropertychange",$0),Zo=$c=null)}function $0(u){if(u.propertyName==="value"&&el(Zo)){var h=[];id(h,Zo,u,Jt(u)),Vt(fx,h)}}function W0(u,h,S){u==="focusin"?($l(),$c=h,Zo=S,$c.attachEvent("onpropertychange",$0)):u==="focusout"&&$l()}function An(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return el(Zo)}function $f(u,h){if(u==="click")return el(h)}function z0(u,h){if(u==="input"||u==="change")return el(h)}function H0(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var Ca=typeof Object.is=="function"?Object.is:H0;function Wl(u,h){if(Ca(u,h))return!0;if(typeof u!="object"||u===null||typeof h!="object"||h===null)return!1;var S=Object.keys(u),F=Object.keys(h);if(S.length!==F.length)return!1;for(F=0;F<S.length;F++){var U=S[F];if(!c.call(h,U)||!Ca(u[U],h[U]))return!1}return!0}function rl(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Sn(u,h){var S=rl(u);u=0;for(var F;S;){if(S.nodeType===3){if(F=u+S.textContent.length,u<=h&&F>=h)return{node:S,offset:h-u};u=F}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=rl(S)}}function Kn(u,h){return u&&h?u===h?!0:u&&u.nodeType===3?!1:h&&h.nodeType===3?Kn(u,h.parentNode):"contains"in u?u.contains(h):u.compareDocumentPosition?!!(u.compareDocumentPosition(h)&16):!1:!1}function os(){for(var u=window,h=pe();h instanceof u.HTMLIFrameElement;){try{var S=typeof h.contentWindow.location.href=="string"}catch{S=!1}if(S)u=h.contentWindow;else break;h=pe(u.document)}return h}function zc(u){var h=u&&u.nodeName&&u.nodeName.toLowerCase();return h&&(h==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||h==="textarea"||u.contentEditable==="true")}function od(u){var h=os(),S=u.focusedElem,F=u.selectionRange;if(h!==S&&S&&S.ownerDocument&&Kn(S.ownerDocument.documentElement,S)){if(F!==null&&zc(S)){if(h=F.start,u=F.end,u===void 0&&(u=h),"selectionStart"in S)S.selectionStart=h,S.selectionEnd=Math.min(u,S.value.length);else if(u=(h=S.ownerDocument||document)&&h.defaultView||window,u.getSelection){u=u.getSelection();var U=S.textContent.length,Q=Math.min(F.start,U);F=F.end===void 0?Q:Math.min(F.end,U),!u.extend&&Q>F&&(U=F,F=Q,Q=U),U=Sn(S,Q);var de=Sn(S,F);U&&de&&(u.rangeCount!==1||u.anchorNode!==U.node||u.anchorOffset!==U.offset||u.focusNode!==de.node||u.focusOffset!==de.offset)&&(h=h.createRange(),h.setStart(U.node,U.offset),u.removeAllRanges(),Q>F?(u.addRange(h),u.extend(de.node,de.offset)):(h.setEnd(de.node,de.offset),u.addRange(h)))}}for(h=[],u=S;u=u.parentNode;)u.nodeType===1&&h.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<h.length;S++)u=h[S],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var ld=o&&"documentMode"in document&&11>=document.documentMode,Hc=null,vs=null,zl=null,cd=!1;function Wf(u,h,S){var F=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;cd||Hc==null||Hc!==pe(F)||(F=Hc,"selectionStart"in F&&zc(F)?F={start:F.selectionStart,end:F.selectionEnd}:(F=(F.ownerDocument&&F.ownerDocument.defaultView||window).getSelection(),F={anchorNode:F.anchorNode,anchorOffset:F.anchorOffset,focusNode:F.focusNode,focusOffset:F.focusOffset}),zl&&Wl(zl,F)||(zl=F,F=Xf(vs,"onSelect"),0<F.length&&(h=new Ni("onSelect","select",null,h,S),u.push({event:h,listeners:F}),h.target=Hc)))}function Ga(u,h){var S={};return S[u.toLowerCase()]=h.toLowerCase(),S["Webkit"+u]="webkit"+h,S["Moz"+u]="moz"+h,S}var Fs={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionend:Ga("Transition","TransitionEnd")},Hl={},zf={};o&&(zf=document.createElement("div").style,"AnimationEvent"in window||(delete Fs.animationend.animation,delete Fs.animationiteration.animation,delete Fs.animationstart.animation),"TransitionEvent"in window||delete Fs.transitionend.transition);function Gc(u){if(Hl[u])return Hl[u];if(!Fs[u])return u;var h=Fs[u],S;for(S in h)if(h.hasOwnProperty(S)&&S in zf)return Hl[u]=h[S];return u}var G0=Gc("animationend"),V0=Gc("animationiteration"),K0=Gc("animationstart"),q0=Gc("transitionend"),X0=new Map,Y0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Co(u,h){X0.set(u,h),a(h,[u])}for(var Hf=0;Hf<Y0.length;Hf++){var Gl=Y0[Hf],hx=Gl.toLowerCase(),Gf=Gl[0].toUpperCase()+Gl.slice(1);Co(hx,"on"+Gf)}Co(G0,"onAnimationEnd"),Co(V0,"onAnimationIteration"),Co(K0,"onAnimationStart"),Co("dblclick","onDoubleClick"),Co("focusin","onFocus"),Co("focusout","onBlur"),Co(q0,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gx=new Set("cancel close invalid load scroll toggle".split(" ").concat(nl));function Vf(u,h,S){var F=u.type||"unknown-event";u.currentTarget=S,Se(F,h,void 0,u),u.currentTarget=null}function Q0(u,h){h=(h&4)!==0;for(var S=0;S<u.length;S++){var F=u[S],U=F.event;F=F.listeners;e:{var Q=void 0;if(h)for(var de=F.length-1;0<=de;de--){var je=F[de],Re=je.instance,st=je.currentTarget;if(je=je.listener,Re!==Q&&U.isPropagationStopped())break e;Vf(U,je,st),Q=Re}else for(de=0;de<F.length;de++){if(je=F[de],Re=je.instance,st=je.currentTarget,je=je.listener,Re!==Q&&U.isPropagationStopped())break e;Vf(U,je,st),Q=Re}}}if(ue)throw u=ke,ue=!1,ke=null,u}function hn(u,h){var S=h[Qf];S===void 0&&(S=h[Qf]=new Set);var F=u+"__bubble";S.has(F)||(J0(h,u,2,!1),S.add(F))}function Kf(u,h,S){var F=0;h&&(F|=4),J0(S,u,F,h)}var ud="_reactListening"+Math.random().toString(36).slice(2);function Vl(u){if(!u[ud]){u[ud]=!0,n.forEach(function(S){S!=="selectionchange"&&(gx.has(S)||Kf(S,!1,u),Kf(S,!0,u))});var h=u.nodeType===9?u:u.ownerDocument;h===null||h[ud]||(h[ud]=!0,Kf("selectionchange",!1,h))}}function J0(u,h,S,F){switch(rx(h)){case 1:var U=Ei;break;case 4:U=_o;break;default:U=Oc}S=U.bind(null,h,S,u),U=void 0,!Fr||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(U=!0),F?U!==void 0?u.addEventListener(h,S,{capture:!0,passive:U}):u.addEventListener(h,S,!0):U!==void 0?u.addEventListener(h,S,{passive:U}):u.addEventListener(h,S,!1)}function qf(u,h,S,F,U){var Q=F;if((h&1)===0&&(h&2)===0&&F!==null)e:for(;;){if(F===null)return;var de=F.tag;if(de===3||de===4){var je=F.stateNode.containerInfo;if(je===U||je.nodeType===8&&je.parentNode===U)break;if(de===4)for(de=F.return;de!==null;){var Re=de.tag;if((Re===3||Re===4)&&(Re=de.stateNode.containerInfo,Re===U||Re.nodeType===8&&Re.parentNode===U))return;de=de.return}for(;je!==null;){if(de=al(je),de===null)return;if(Re=de.tag,Re===5||Re===6){F=Q=de;continue e}je=je.parentNode}}F=F.return}Vt(function(){var st=Q,Nt=Jt(S),Ft=[];e:{var Et=X0.get(u);if(Et!==void 0){var Zt=Ni,sr=u;switch(u){case"keypress":if(Ml(S)===0)break e;case"keydown":case"keyup":Zt=ox;break;case"focusin":sr="focus",Zt=Rf;break;case"focusout":sr="blur",Zt=Rf;break;case"beforeblur":case"afterblur":Zt=Rf;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Zt=vn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Zt=ji;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Zt=Of;break;case G0:case V0:case K0:Zt=I0;break;case q0:Zt=Bc;break;case"scroll":Zt=nx;break;case"wheel":Zt=L0;break;case"copy":case"cut":case"paste":Zt=Df;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Zt=Bl}var ar=(h&4)!==0,fs=!ar&&u==="scroll",Ke=ar?Et!==null?Et+"Capture":null:Et;ar=[];for(var Me=st,Qe;Me!==null;){Qe=Me;var Dt=Qe.stateNode;if(Qe.tag===5&&Dt!==null&&(Qe=Dt,Ke!==null&&(Dt=gr(Me,Ke),Dt!=null&&ar.push(Vc(Me,Dt,Qe)))),fs)break;Me=Me.return}0<ar.length&&(Et=new Zt(Et,sr,null,S,Nt),Ft.push({event:Et,listeners:ar}))}}if((h&7)===0){e:{if(Et=u==="mouseover"||u==="pointerover",Zt=u==="mouseout"||u==="pointerout",Et&&S!==Ot&&(sr=S.relatedTarget||S.fromElement)&&(al(sr)||sr[Vi]))break e;if((Zt||Et)&&(Et=Nt.window===Nt?Nt:(Et=Nt.ownerDocument)?Et.defaultView||Et.parentWindow:window,Zt?(sr=S.relatedTarget||S.toElement,Zt=st,sr=sr?al(sr):null,sr!==null&&(fs=Ee(sr),sr!==fs||sr.tag!==5&&sr.tag!==6)&&(sr=null)):(Zt=null,sr=st),Zt!==sr)){if(ar=vn,Dt="onMouseLeave",Ke="onMouseEnter",Me="mouse",(u==="pointerout"||u==="pointerover")&&(ar=Bl,Dt="onPointerLeave",Ke="onPointerEnter",Me="pointer"),fs=Zt==null?Et:ls(Zt),Qe=sr==null?Et:ls(sr),Et=new ar(Dt,Me+"leave",Zt,S,Nt),Et.target=fs,Et.relatedTarget=Qe,Dt=null,al(Nt)===st&&(ar=new ar(Ke,Me+"enter",sr,S,Nt),ar.target=Qe,ar.relatedTarget=fs,Dt=ar),fs=Dt,Zt&&sr)t:{for(ar=Zt,Ke=sr,Me=0,Qe=ar;Qe;Qe=Kl(Qe))Me++;for(Qe=0,Dt=Ke;Dt;Dt=Kl(Dt))Qe++;for(;0<Me-Qe;)ar=Kl(ar),Me--;for(;0<Qe-Me;)Ke=Kl(Ke),Qe--;for(;Me--;){if(ar===Ke||Ke!==null&&ar===Ke.alternate)break t;ar=Kl(ar),Ke=Kl(Ke)}ar=null}else ar=null;Zt!==null&&mx(Ft,Et,Zt,ar,!1),sr!==null&&fs!==null&&mx(Ft,fs,sr,ar,!0)}}e:{if(Et=st?ls(st):window,Zt=Et.nodeName&&Et.nodeName.toLowerCase(),Zt==="select"||Zt==="input"&&Et.type==="file")var ir=ci;else if(ko(Et))if(Wc)ir=z0;else{ir=An;var ur=W0}else(Zt=Et.nodeName)&&Zt.toLowerCase()==="input"&&(Et.type==="checkbox"||Et.type==="radio")&&(ir=$f);if(ir&&(ir=ir(u,st))){id(Ft,ir,S,Nt);break e}ur&&ur(u,Et,st),u==="focusout"&&(ur=Et._wrapperState)&&ur.controlled&&Et.type==="number"&&tt(Et,"number",Et.value)}switch(ur=st?ls(st):window,u){case"focusin":(ko(ur)||ur.contentEditable==="true")&&(Hc=ur,vs=st,zl=null);break;case"focusout":zl=vs=Hc=null;break;case"mousedown":cd=!0;break;case"contextmenu":case"mouseup":case"dragend":cd=!1,Wf(Ft,S,Nt);break;case"selectionchange":if(ld)break;case"keydown":case"keyup":Wf(Ft,S,Nt)}var dr;if(ad)e:{switch(u){case"compositionstart":var wr="onCompositionStart";break e;case"compositionend":wr="onCompositionEnd";break e;case"compositionupdate":wr="onCompositionUpdate";break e}wr=void 0}else Ha?B0(u,S)&&(wr="onCompositionEnd"):u==="keydown"&&S.keyCode===229&&(wr="onCompositionStart");wr&&(za&&S.locale!=="ko"&&(Ha||wr!=="onCompositionStart"?wr==="onCompositionEnd"&&Ha&&(dr=td()):(As=Nt,Qo="value"in As?As.value:As.textContent,Ha=!0)),ur=Xf(st,wr),0<ur.length&&(wr=new Ol(wr,u,null,S,Nt),Ft.push({event:wr,listeners:ur}),dr?wr.data=dr:(dr=Fi(S),dr!==null&&(wr.data=dr)))),(dr=Uc?U0(u,S):dx(u,S))&&(st=Xf(st,"onBeforeInput"),0<st.length&&(Nt=new Ol("onBeforeInput","beforeinput",null,S,Nt),Ft.push({event:Nt,listeners:st}),Nt.data=dr))}Q0(Ft,h)})}function Vc(u,h,S){return{instance:u,listener:h,currentTarget:S}}function Xf(u,h){for(var S=h+"Capture",F=[];u!==null;){var U=u,Q=U.stateNode;U.tag===5&&Q!==null&&(U=Q,Q=gr(u,S),Q!=null&&F.unshift(Vc(u,Q,U)),Q=gr(u,h),Q!=null&&F.push(Vc(u,Q,U))),u=u.return}return F}function Kl(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function mx(u,h,S,F,U){for(var Q=h._reactName,de=[];S!==null&&S!==F;){var je=S,Re=je.alternate,st=je.stateNode;if(Re!==null&&Re===F)break;je.tag===5&&st!==null&&(je=st,U?(Re=gr(S,Q),Re!=null&&de.unshift(Vc(S,Re,je))):U||(Re=gr(S,Q),Re!=null&&de.push(Vc(S,Re,je)))),S=S.return}de.length!==0&&u.push({event:h,listeners:de})}var dv=/\r\n?/g,px=/\u0000|\uFFFD/g;function Z0(u){return(typeof u=="string"?u:""+u).replace(dv,`
`).replace(px,"")}function dd(u,h,S){if(h=Z0(h),Z0(u)!==h&&S)throw Error(r(425))}function ql(){}var eg=null,tg=null;function rg(u,h){return u==="textarea"||u==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var Va=typeof setTimeout=="function"?setTimeout:void 0,ng=typeof clearTimeout=="function"?clearTimeout:void 0,fd=typeof Promise=="function"?Promise:void 0,xx=typeof queueMicrotask=="function"?queueMicrotask:typeof fd<"u"?function(u){return fd.resolve(null).then(u).catch(yx)}:Va;function yx(u){setTimeout(function(){throw u})}function Yf(u,h){var S=h,F=0;do{var U=S.nextSibling;if(u.removeChild(S),U&&U.nodeType===8)if(S=U.data,S==="/$"){if(F===0){u.removeChild(U),Sa(h);return}F--}else S!=="$"&&S!=="$?"&&S!=="$!"||F++;S=U}while(S);Sa(h)}function Gi(u){for(;u!=null;u=u.nextSibling){var h=u.nodeType;if(h===1||h===3)break;if(h===8){if(h=u.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return u}function Xl(u){u=u.previousSibling;for(var h=0;u;){if(u.nodeType===8){var S=u.data;if(S==="$"||S==="$!"||S==="$?"){if(h===0)return u;h--}else S==="/$"&&h++}u=u.previousSibling}return null}var sl=Math.random().toString(36).slice(2),di="__reactFiber$"+sl,hd="__reactProps$"+sl,Vi="__reactContainer$"+sl,Qf="__reactEvents$"+sl,vx="__reactListeners$"+sl,wx="__reactHandles$"+sl;function al(u){var h=u[di];if(h)return h;for(var S=u.parentNode;S;){if(h=S[Vi]||S[di]){if(S=h.alternate,h.child!==null||S!==null&&S.child!==null)for(u=Xl(u);u!==null;){if(S=u[di])return S;u=Xl(u)}return h}u=S,S=u.parentNode}return null}function gd(u){return u=u[di]||u[Vi],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function ls(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(r(33))}function ws(u){return u[hd]||null}var Jf=[],Yl=-1;function To(u){return{current:u}}function gn(u){0>Yl||(u.current=Jf[Yl],Jf[Yl]=null,Yl--)}function sn(u,h){Yl++,Jf[Yl]=u.current,u.current=h}var Ki={},Ps=To(Ki),Ws=To(!1),il=Ki;function Ql(u,h){var S=u.type.contextTypes;if(!S)return Ki;var F=u.stateNode;if(F&&F.__reactInternalMemoizedUnmaskedChildContext===h)return F.__reactInternalMemoizedMaskedChildContext;var U={},Q;for(Q in S)U[Q]=h[Q];return F&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=h,u.__reactInternalMemoizedMaskedChildContext=U),U}function zs(u){return u=u.childContextTypes,u!=null}function Kc(){gn(Ws),gn(Ps)}function sg(u,h,S){if(Ps.current!==Ki)throw Error(r(168));sn(Ps,h),sn(Ws,S)}function Zf(u,h,S){var F=u.stateNode;if(h=h.childContextTypes,typeof F.getChildContext!="function")return S;F=F.getChildContext();for(var U in F)if(!(U in h))throw Error(r(108,ee(u)||"Unknown",U));return G({},S,F)}function Jl(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||Ki,il=Ps.current,sn(Ps,u),sn(Ws,Ws.current),!0}function _x(u,h,S){var F=u.stateNode;if(!F)throw Error(r(169));S?(u=Zf(u,h,il),F.__reactInternalMemoizedMergedChildContext=u,gn(Ws),gn(Ps),sn(Ps,u)):gn(Ws),sn(Ws,S)}var qi=null,qc=!1,eh=!1;function md(u){qi===null?qi=[u]:qi.push(u)}function Eo(u){qc=!0,md(u)}function ol(){if(!eh&&qi!==null){eh=!0;var u=0,h=Hr;try{var S=qi;for(Hr=1;u<S.length;u++){var F=S[u];do F=F(!0);while(F!==null)}qi=null,qc=!1}catch(U){throw qi!==null&&(qi=qi.slice(u+1)),ce(vt,ol),U}finally{Hr=h,eh=!1}}return null}var aa=[],Zl=0,ll=null,cl=0,ia=[],oa=0,ul=null,Ka=1,kn="";function ec(u,h){aa[Zl++]=cl,aa[Zl++]=ll,ll=u,cl=h}function bx(u,h,S){ia[oa++]=Ka,ia[oa++]=kn,ia[oa++]=ul,ul=u;var F=Ka;u=kn;var U=32-Kt(F)-1;F&=~(1<<U),S+=1;var Q=32-Kt(h)+U;if(30<Q){var de=U-U%5;Q=(F&(1<<de)-1).toString(32),F>>=de,U-=de,Ka=1<<32-Kt(h)+U|S<<U|F,kn=Q+u}else Ka=1<<Q|S<<U|F,kn=u}function Xc(u){u.return!==null&&(ec(u,1),bx(u,1,0))}function _s(u){for(;u===ll;)ll=aa[--Zl],aa[Zl]=null,cl=aa[--Zl],aa[Zl]=null;for(;u===ul;)ul=ia[--oa],ia[oa]=null,kn=ia[--oa],ia[oa]=null,Ka=ia[--oa],ia[oa]=null}var qa=null,Gt=null,en=!1,Xa=null;function ag(u,h){var S=to(5,null,null,0);S.elementType="DELETED",S.stateNode=h,S.return=u,h=u.deletions,h===null?(u.deletions=[S],u.flags|=16):h.push(S)}function Sx(u,h){switch(u.tag){case 5:var S=u.type;return h=h.nodeType!==1||S.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(u.stateNode=h,qa=u,Gt=Gi(h.firstChild),!0):!1;case 6:return h=u.pendingProps===""||h.nodeType!==3?null:h,h!==null?(u.stateNode=h,qa=u,Gt=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(S=ul!==null?{id:Ka,overflow:kn}:null,u.memoizedState={dehydrated:h,treeContext:S,retryLane:1073741824},S=to(18,null,null,0),S.stateNode=h,S.return=u,u.child=S,qa=u,Gt=null,!0):!1;default:return!1}}function tc(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Yc(u){if(en){var h=Gt;if(h){var S=h;if(!Sx(u,h)){if(tc(u))throw Error(r(418));h=Gi(S.nextSibling);var F=qa;h&&Sx(u,h)?ag(F,S):(u.flags=u.flags&-4097|2,en=!1,qa=u)}}else{if(tc(u))throw Error(r(418));u.flags=u.flags&-4097|2,en=!1,qa=u}}}function th(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;qa=u}function pd(u){if(u!==qa)return!1;if(!en)return th(u),en=!0,!1;var h;if((h=u.tag!==3)&&!(h=u.tag!==5)&&(h=u.type,h=h!=="head"&&h!=="body"&&!rg(u.type,u.memoizedProps)),h&&(h=Gt)){if(tc(u))throw ig(),Error(r(418));for(;h;)ag(u,h),h=Gi(h.nextSibling)}if(th(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(r(317));e:{for(u=u.nextSibling,h=0;u;){if(u.nodeType===8){var S=u.data;if(S==="/$"){if(h===0){Gt=Gi(u.nextSibling);break e}h--}else S!=="$"&&S!=="$!"&&S!=="$?"||h++}u=u.nextSibling}Gt=null}}else Gt=qa?Gi(u.stateNode.nextSibling):null;return!0}function ig(){for(var u=Gt;u;)u=Gi(u.nextSibling)}function rc(){Gt=qa=null,en=!1}function xd(u){Xa===null?Xa=[u]:Xa.push(u)}var og=N.ReactCurrentBatchConfig;function $n(u,h,S){if(u=S.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(r(309));var F=S.stateNode}if(!F)throw Error(r(147,u));var U=F,Q=""+u;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===Q?h.ref:(h=function(de){var je=U.refs;de===null?delete je[Q]:je[Q]=de},h._stringRef=Q,h)}if(typeof u!="string")throw Error(r(284));if(!S._owner)throw Error(r(290,u))}return u}function Ta(u,h){throw u=Object.prototype.toString.call(h),Error(r(31,u==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":u))}function Pi(u){var h=u._init;return h(u._payload)}function rh(u){function h(Ke,Me){if(u){var Qe=Ke.deletions;Qe===null?(Ke.deletions=[Me],Ke.flags|=16):Qe.push(Me)}}function S(Ke,Me){if(!u)return null;for(;Me!==null;)h(Ke,Me),Me=Me.sibling;return null}function F(Ke,Me){for(Ke=new Map;Me!==null;)Me.key!==null?Ke.set(Me.key,Me):Ke.set(Me.index,Me),Me=Me.sibling;return Ke}function U(Ke,Me){return Ke=pu(Ke,Me),Ke.index=0,Ke.sibling=null,Ke}function Q(Ke,Me,Qe){return Ke.index=Qe,u?(Qe=Ke.alternate,Qe!==null?(Qe=Qe.index,Qe<Me?(Ke.flags|=2,Me):Qe):(Ke.flags|=2,Me)):(Ke.flags|=1048576,Me)}function de(Ke){return u&&Ke.alternate===null&&(Ke.flags|=2),Ke}function je(Ke,Me,Qe,Dt){return Me===null||Me.tag!==6?(Me=Pv(Qe,Ke.mode,Dt),Me.return=Ke,Me):(Me=U(Me,Qe),Me.return=Ke,Me)}function Re(Ke,Me,Qe,Dt){var ir=Qe.type;return ir===R?Nt(Ke,Me,Qe.props.children,Dt,Qe.key):Me!==null&&(Me.elementType===ir||typeof ir=="object"&&ir!==null&&ir.$$typeof===re&&Pi(ir)===Me.type)?(Dt=U(Me,Qe.props),Dt.ref=$n(Ke,Me,Qe),Dt.return=Ke,Dt):(Dt=Hx(Qe.type,Qe.key,Qe.props,null,Ke.mode,Dt),Dt.ref=$n(Ke,Me,Qe),Dt.return=Ke,Dt)}function st(Ke,Me,Qe,Dt){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==Qe.containerInfo||Me.stateNode.implementation!==Qe.implementation?(Me=Rv(Qe,Ke.mode,Dt),Me.return=Ke,Me):(Me=U(Me,Qe.children||[]),Me.return=Ke,Me)}function Nt(Ke,Me,Qe,Dt,ir){return Me===null||Me.tag!==7?(Me=Nd(Qe,Ke.mode,Dt,ir),Me.return=Ke,Me):(Me=U(Me,Qe),Me.return=Ke,Me)}function Ft(Ke,Me,Qe){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return Me=Pv(""+Me,Ke.mode,Qe),Me.return=Ke,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case A:return Qe=Hx(Me.type,Me.key,Me.props,null,Ke.mode,Qe),Qe.ref=$n(Ke,null,Me),Qe.return=Ke,Qe;case P:return Me=Rv(Me,Ke.mode,Qe),Me.return=Ke,Me;case re:var Dt=Me._init;return Ft(Ke,Dt(Me._payload),Qe)}if(Le(Me)||B(Me))return Me=Nd(Me,Ke.mode,Qe,null),Me.return=Ke,Me;Ta(Ke,Me)}return null}function Et(Ke,Me,Qe,Dt){var ir=Me!==null?Me.key:null;if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number")return ir!==null?null:je(Ke,Me,""+Qe,Dt);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case A:return Qe.key===ir?Re(Ke,Me,Qe,Dt):null;case P:return Qe.key===ir?st(Ke,Me,Qe,Dt):null;case re:return ir=Qe._init,Et(Ke,Me,ir(Qe._payload),Dt)}if(Le(Qe)||B(Qe))return ir!==null?null:Nt(Ke,Me,Qe,Dt,null);Ta(Ke,Qe)}return null}function Zt(Ke,Me,Qe,Dt,ir){if(typeof Dt=="string"&&Dt!==""||typeof Dt=="number")return Ke=Ke.get(Qe)||null,je(Me,Ke,""+Dt,ir);if(typeof Dt=="object"&&Dt!==null){switch(Dt.$$typeof){case A:return Ke=Ke.get(Dt.key===null?Qe:Dt.key)||null,Re(Me,Ke,Dt,ir);case P:return Ke=Ke.get(Dt.key===null?Qe:Dt.key)||null,st(Me,Ke,Dt,ir);case re:var ur=Dt._init;return Zt(Ke,Me,Qe,ur(Dt._payload),ir)}if(Le(Dt)||B(Dt))return Ke=Ke.get(Qe)||null,Nt(Me,Ke,Dt,ir,null);Ta(Me,Dt)}return null}function sr(Ke,Me,Qe,Dt){for(var ir=null,ur=null,dr=Me,wr=Me=0,Xs=null;dr!==null&&wr<Qe.length;wr++){dr.index>wr?(Xs=dr,dr=null):Xs=dr.sibling;var Yr=Et(Ke,dr,Qe[wr],Dt);if(Yr===null){dr===null&&(dr=Xs);break}u&&dr&&Yr.alternate===null&&h(Ke,dr),Me=Q(Yr,Me,wr),ur===null?ir=Yr:ur.sibling=Yr,ur=Yr,dr=Xs}if(wr===Qe.length)return S(Ke,dr),en&&ec(Ke,wr),ir;if(dr===null){for(;wr<Qe.length;wr++)dr=Ft(Ke,Qe[wr],Dt),dr!==null&&(Me=Q(dr,Me,wr),ur===null?ir=dr:ur.sibling=dr,ur=dr);return en&&ec(Ke,wr),ir}for(dr=F(Ke,dr);wr<Qe.length;wr++)Xs=Zt(dr,Ke,wr,Qe[wr],Dt),Xs!==null&&(u&&Xs.alternate!==null&&dr.delete(Xs.key===null?wr:Xs.key),Me=Q(Xs,Me,wr),ur===null?ir=Xs:ur.sibling=Xs,ur=Xs);return u&&dr.forEach(function(xu){return h(Ke,xu)}),en&&ec(Ke,wr),ir}function ar(Ke,Me,Qe,Dt){var ir=B(Qe);if(typeof ir!="function")throw Error(r(150));if(Qe=ir.call(Qe),Qe==null)throw Error(r(151));for(var ur=ir=null,dr=Me,wr=Me=0,Xs=null,Yr=Qe.next();dr!==null&&!Yr.done;wr++,Yr=Qe.next()){dr.index>wr?(Xs=dr,dr=null):Xs=dr.sibling;var xu=Et(Ke,dr,Yr.value,Dt);if(xu===null){dr===null&&(dr=Xs);break}u&&dr&&xu.alternate===null&&h(Ke,dr),Me=Q(xu,Me,wr),ur===null?ir=xu:ur.sibling=xu,ur=xu,dr=Xs}if(Yr.done)return S(Ke,dr),en&&ec(Ke,wr),ir;if(dr===null){for(;!Yr.done;wr++,Yr=Qe.next())Yr=Ft(Ke,Yr.value,Dt),Yr!==null&&(Me=Q(Yr,Me,wr),ur===null?ir=Yr:ur.sibling=Yr,ur=Yr);return en&&ec(Ke,wr),ir}for(dr=F(Ke,dr);!Yr.done;wr++,Yr=Qe.next())Yr=Zt(dr,Ke,wr,Yr.value,Dt),Yr!==null&&(u&&Yr.alternate!==null&&dr.delete(Yr.key===null?wr:Yr.key),Me=Q(Yr,Me,wr),ur===null?ir=Yr:ur.sibling=Yr,ur=Yr);return u&&dr.forEach(function(RP){return h(Ke,RP)}),en&&ec(Ke,wr),ir}function fs(Ke,Me,Qe,Dt){if(typeof Qe=="object"&&Qe!==null&&Qe.type===R&&Qe.key===null&&(Qe=Qe.props.children),typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case A:e:{for(var ir=Qe.key,ur=Me;ur!==null;){if(ur.key===ir){if(ir=Qe.type,ir===R){if(ur.tag===7){S(Ke,ur.sibling),Me=U(ur,Qe.props.children),Me.return=Ke,Ke=Me;break e}}else if(ur.elementType===ir||typeof ir=="object"&&ir!==null&&ir.$$typeof===re&&Pi(ir)===ur.type){S(Ke,ur.sibling),Me=U(ur,Qe.props),Me.ref=$n(Ke,ur,Qe),Me.return=Ke,Ke=Me;break e}S(Ke,ur);break}else h(Ke,ur);ur=ur.sibling}Qe.type===R?(Me=Nd(Qe.props.children,Ke.mode,Dt,Qe.key),Me.return=Ke,Ke=Me):(Dt=Hx(Qe.type,Qe.key,Qe.props,null,Ke.mode,Dt),Dt.ref=$n(Ke,Me,Qe),Dt.return=Ke,Ke=Dt)}return de(Ke);case P:e:{for(ur=Qe.key;Me!==null;){if(Me.key===ur)if(Me.tag===4&&Me.stateNode.containerInfo===Qe.containerInfo&&Me.stateNode.implementation===Qe.implementation){S(Ke,Me.sibling),Me=U(Me,Qe.children||[]),Me.return=Ke,Ke=Me;break e}else{S(Ke,Me);break}else h(Ke,Me);Me=Me.sibling}Me=Rv(Qe,Ke.mode,Dt),Me.return=Ke,Ke=Me}return de(Ke);case re:return ur=Qe._init,fs(Ke,Me,ur(Qe._payload),Dt)}if(Le(Qe))return sr(Ke,Me,Qe,Dt);if(B(Qe))return ar(Ke,Me,Qe,Dt);Ta(Ke,Qe)}return typeof Qe=="string"&&Qe!==""||typeof Qe=="number"?(Qe=""+Qe,Me!==null&&Me.tag===6?(S(Ke,Me.sibling),Me=U(Me,Qe),Me.return=Ke,Ke=Me):(S(Ke,Me),Me=Pv(Qe,Ke.mode,Dt),Me.return=Ke,Ke=Me),de(Ke)):S(Ke,Me)}return fs}var nc=rh(!0),fi=rh(!1),yd=To(null),Ya=null,Qc=null,nh=null;function sh(){nh=Qc=Ya=null}function ah(u){var h=yd.current;gn(yd),u._currentValue=h}function ih(u,h,S){for(;u!==null;){var F=u.alternate;if((u.childLanes&h)!==h?(u.childLanes|=h,F!==null&&(F.childLanes|=h)):F!==null&&(F.childLanes&h)!==h&&(F.childLanes|=h),u===S)break;u=u.return}}function No(u,h){Ya=u,nh=Qc=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&h)!==0&&(ne=!0),u.firstContext=null)}function la(u){var h=u._currentValue;if(nh!==u)if(u={context:u,memoizedValue:h,next:null},Qc===null){if(Ya===null)throw Error(r(308));Qc=u,Ya.dependencies={lanes:0,firstContext:u}}else Qc=Qc.next=u;return h}var Xi=null;function Jc(u){Xi===null?Xi=[u]:Xi.push(u)}function vd(u,h,S,F){var U=h.interleaved;return U===null?(S.next=S,Jc(h)):(S.next=U.next,U.next=S),h.interleaved=S,Qa(u,F)}function Qa(u,h){u.lanes|=h;var S=u.alternate;for(S!==null&&(S.lanes|=h),S=u,u=u.return;u!==null;)u.childLanes|=h,S=u.alternate,S!==null&&(S.childLanes|=h),S=u,u=u.return;return S.tag===3?S.stateNode:null}var Yi=!1;function wd(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function oh(u,h){u=u.updateQueue,h.updateQueue===u&&(h.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function Qi(u,h){return{eventTime:u,lane:h,tag:0,payload:null,callback:null,next:null}}function Ji(u,h,S){var F=u.updateQueue;if(F===null)return null;if(F=F.shared,(Vr&2)!==0){var U=F.pending;return U===null?h.next=h:(h.next=U.next,U.next=h),F.pending=h,Qa(u,S)}return U=F.interleaved,U===null?(h.next=h,Jc(F)):(h.next=U.next,U.next=h),F.interleaved=h,Qa(u,S)}function lh(u,h,S){if(h=h.updateQueue,h!==null&&(h=h.shared,(S&4194240)!==0)){var F=h.lanes;F&=u.pendingLanes,S|=F,h.lanes=S,R0(u,S)}}function _d(u,h){var S=u.updateQueue,F=u.alternate;if(F!==null&&(F=F.updateQueue,S===F)){var U=null,Q=null;if(S=S.firstBaseUpdate,S!==null){do{var de={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};Q===null?U=Q=de:Q=Q.next=de,S=S.next}while(S!==null);Q===null?U=Q=h:Q=Q.next=h}else U=Q=h;S={baseState:F.baseState,firstBaseUpdate:U,lastBaseUpdate:Q,shared:F.shared,effects:F.effects},u.updateQueue=S;return}u=S.lastBaseUpdate,u===null?S.firstBaseUpdate=h:u.next=h,S.lastBaseUpdate=h}function Zc(u,h,S,F){var U=u.updateQueue;Yi=!1;var Q=U.firstBaseUpdate,de=U.lastBaseUpdate,je=U.shared.pending;if(je!==null){U.shared.pending=null;var Re=je,st=Re.next;Re.next=null,de===null?Q=st:de.next=st,de=Re;var Nt=u.alternate;Nt!==null&&(Nt=Nt.updateQueue,je=Nt.lastBaseUpdate,je!==de&&(je===null?Nt.firstBaseUpdate=st:je.next=st,Nt.lastBaseUpdate=Re))}if(Q!==null){var Ft=U.baseState;de=0,Nt=st=Re=null,je=Q;do{var Et=je.lane,Zt=je.eventTime;if((F&Et)===Et){Nt!==null&&(Nt=Nt.next={eventTime:Zt,lane:0,tag:je.tag,payload:je.payload,callback:je.callback,next:null});e:{var sr=u,ar=je;switch(Et=h,Zt=S,ar.tag){case 1:if(sr=ar.payload,typeof sr=="function"){Ft=sr.call(Zt,Ft,Et);break e}Ft=sr;break e;case 3:sr.flags=sr.flags&-65537|128;case 0:if(sr=ar.payload,Et=typeof sr=="function"?sr.call(Zt,Ft,Et):sr,Et==null)break e;Ft=G({},Ft,Et);break e;case 2:Yi=!0}}je.callback!==null&&je.lane!==0&&(u.flags|=64,Et=U.effects,Et===null?U.effects=[je]:Et.push(je))}else Zt={eventTime:Zt,lane:Et,tag:je.tag,payload:je.payload,callback:je.callback,next:null},Nt===null?(st=Nt=Zt,Re=Ft):Nt=Nt.next=Zt,de|=Et;if(je=je.next,je===null){if(je=U.shared.pending,je===null)break;Et=je,je=Et.next,Et.next=null,U.lastBaseUpdate=Et,U.shared.pending=null}}while(!0);if(Nt===null&&(Re=Ft),U.baseState=Re,U.firstBaseUpdate=st,U.lastBaseUpdate=Nt,h=U.shared.interleaved,h!==null){U=h;do de|=U.lane,U=U.next;while(U!==h)}else Q===null&&(U.shared.lanes=0);kd|=de,u.lanes=de,u.memoizedState=Ft}}function On(u,h,S){if(u=h.effects,h.effects=null,u!==null)for(h=0;h<u.length;h++){var F=u[h],U=F.callback;if(U!==null){if(F.callback=null,F=S,typeof U!="function")throw Error(r(191,U));U.call(F)}}}var kr={},an=To(kr),Cn=To(kr),Wn=To(kr);function cs(u){if(u===kr)throw Error(r(174));return u}function dl(u,h){switch(sn(Wn,h),sn(Cn,u),sn(an,kr),u=h.nodeType,u){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:rt(null,"");break;default:u=u===8?h.parentNode:h,h=u.namespaceURI||null,u=u.tagName,h=rt(h,u)}gn(an),sn(an,h)}function Tn(){gn(an),gn(Cn),gn(Wn)}function eu(u){cs(Wn.current);var h=cs(an.current),S=rt(h,u.type);h!==S&&(sn(Cn,u),sn(an,S))}function Ao(u){Cn.current===u&&(gn(an),gn(Cn))}var mn=To(0);function tu(u){for(var h=u;h!==null;){if(h.tag===13){var S=h.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var sc=[];function Hs(){for(var u=0;u<sc.length;u++)sc[u]._workInProgressVersionPrimary=null;sc.length=0}var ru=N.ReactCurrentDispatcher,bd=N.ReactCurrentBatchConfig,ca=0,nn=null,Ln=null,qn=null,Ri=!1,fl=!1,hi=0,ch=0;function Xn(){throw Error(r(321))}function Sd(u,h){if(h===null)return!1;for(var S=0;S<h.length&&S<u.length;S++)if(!Ca(u[S],h[S]))return!1;return!0}function nu(u,h,S,F,U,Q){if(ca=Q,nn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,ru.current=u===null||u.memoizedState===null?hv:ml,u=S(F,U),fl){Q=0;do{if(fl=!1,hi=0,25<=Q)throw Error(r(301));Q+=1,qn=Ln=null,h.updateQueue=null,ru.current=gh,u=S(F,U)}while(fl)}if(ru.current=ou,h=Ln!==null&&Ln.next!==null,ca=0,qn=Ln=nn=null,Ri=!1,h)throw Error(r(300));return u}function su(){var u=hi!==0;return hi=0,u}function wn(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?nn.memoizedState=qn=u:qn=qn.next=u,qn}function us(){if(Ln===null){var u=nn.alternate;u=u!==null?u.memoizedState:null}else u=Ln.next;var h=qn===null?nn.memoizedState:qn.next;if(h!==null)qn=h,Ln=u;else{if(u===null)throw Error(r(310));Ln=u,u={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},qn===null?nn.memoizedState=qn=u:qn=qn.next=u}return qn}function Gs(u,h){return typeof h=="function"?h(u):h}function Vs(u){var h=us(),S=h.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=u;var F=Ln,U=F.baseQueue,Q=S.pending;if(Q!==null){if(U!==null){var de=U.next;U.next=Q.next,Q.next=de}F.baseQueue=U=Q,S.pending=null}if(U!==null){Q=U.next,F=F.baseState;var je=de=null,Re=null,st=Q;do{var Nt=st.lane;if((ca&Nt)===Nt)Re!==null&&(Re=Re.next={lane:0,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null}),F=st.hasEagerState?st.eagerState:u(F,st.action);else{var Ft={lane:Nt,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null};Re===null?(je=Re=Ft,de=F):Re=Re.next=Ft,nn.lanes|=Nt,kd|=Nt}st=st.next}while(st!==null&&st!==Q);Re===null?de=F:Re.next=je,Ca(F,h.memoizedState)||(ne=!0),h.memoizedState=F,h.baseState=de,h.baseQueue=Re,S.lastRenderedState=F}if(u=S.interleaved,u!==null){U=u;do Q=U.lane,nn.lanes|=Q,kd|=Q,U=U.next;while(U!==u)}else U===null&&(S.lanes=0);return[h.memoizedState,S.dispatch]}function uh(u){var h=us(),S=h.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=u;var F=S.dispatch,U=S.pending,Q=h.memoizedState;if(U!==null){S.pending=null;var de=U=U.next;do Q=u(Q,de.action),de=de.next;while(de!==U);Ca(Q,h.memoizedState)||(ne=!0),h.memoizedState=Q,h.baseQueue===null&&(h.baseState=Q),S.lastRenderedState=Q}return[Q,F]}function dh(){}function fh(u,h){var S=nn,F=us(),U=h(),Q=!Ca(F.memoizedState,U);if(Q&&(F.memoizedState=U,ne=!0),F=F.queue,dg(lg.bind(null,S,F,u),[u]),F.getSnapshot!==h||Q||qn!==null&&qn.memoizedState.tag&1){if(S.flags|=2048,au(9,jo.bind(null,S,F,U,h),void 0,null),qs===null)throw Error(r(349));(ca&30)!==0||kx(S,h,U)}return U}function kx(u,h,S){u.flags|=16384,u={getSnapshot:h,value:S},h=nn.updateQueue,h===null?(h={lastEffect:null,stores:null},nn.updateQueue=h,h.stores=[u]):(S=h.stores,S===null?h.stores=[u]:S.push(u))}function jo(u,h,S,F){h.value=S,h.getSnapshot=F,cg(h)&&hh(u)}function lg(u,h,S){return S(function(){cg(h)&&hh(u)})}function cg(u){var h=u.getSnapshot;u=u.value;try{var S=h();return!Ca(u,S)}catch{return!0}}function hh(u){var h=Qa(u,1);h!==null&&Do(h,u,1,-1)}function hl(u){var h=wn();return typeof u=="function"&&(u=u()),h.memoizedState=h.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:u},h.queue=u,u=u.dispatch=jx.bind(null,nn,u),[h.memoizedState,u]}function au(u,h,S,F){return u={tag:u,create:h,destroy:S,deps:F,next:null},h=nn.updateQueue,h===null?(h={lastEffect:null,stores:null},nn.updateQueue=h,h.lastEffect=u.next=u):(S=h.lastEffect,S===null?h.lastEffect=u.next=u:(F=S.next,S.next=u,u.next=F,h.lastEffect=u)),u}function ug(){return us().memoizedState}function iu(u,h,S,F){var U=wn();nn.flags|=u,U.memoizedState=au(1|h,S,void 0,F===void 0?null:F)}function ac(u,h,S,F){var U=us();F=F===void 0?null:F;var Q=void 0;if(Ln!==null){var de=Ln.memoizedState;if(Q=de.destroy,F!==null&&Sd(F,de.deps)){U.memoizedState=au(h,S,Q,F);return}}nn.flags|=u,U.memoizedState=au(1|h,S,Q,F)}function Cx(u,h){return iu(8390656,8,u,h)}function dg(u,h){return ac(2048,8,u,h)}function fg(u,h){return ac(4,2,u,h)}function hg(u,h){return ac(4,4,u,h)}function gl(u,h){if(typeof h=="function")return u=u(),h(u),function(){h(null)};if(h!=null)return u=u(),h.current=u,function(){h.current=null}}function Tx(u,h,S){return S=S!=null?S.concat([u]):null,ac(4,4,gl.bind(null,h,u),S)}function Fo(){}function gg(u,h){var S=us();h=h===void 0?null:h;var F=S.memoizedState;return F!==null&&h!==null&&Sd(h,F[1])?F[0]:(S.memoizedState=[u,h],u)}function _n(u,h){var S=us();h=h===void 0?null:h;var F=S.memoizedState;return F!==null&&h!==null&&Sd(h,F[1])?F[0]:(u=u(),S.memoizedState=[u,h],u)}function Ex(u,h,S){return(ca&21)===0?(u.baseState&&(u.baseState=!1,ne=!0),u.memoizedState=S):(Ca(S,h)||(S=bn(),nn.lanes|=S,kd|=S,u.baseState=!0),h)}function Nx(u,h){var S=Hr;Hr=S!==0&&4>S?S:4,u(!0);var F=bd.transition;bd.transition={};try{u(!1),h()}finally{Hr=S,bd.transition=F}}function Ax(){return us().memoizedState}function fv(u,h,S){var F=gu(u);if(S={lane:F,action:S,hasEagerState:!1,eagerState:null,next:null},mg(u))Fx(h,S);else if(S=vd(u,h,S,F),S!==null){var U=Za();Do(S,u,F,U),Ja(S,h,F)}}function jx(u,h,S){var F=gu(u),U={lane:F,action:S,hasEagerState:!1,eagerState:null,next:null};if(mg(u))Fx(h,U);else{var Q=u.alternate;if(u.lanes===0&&(Q===null||Q.lanes===0)&&(Q=h.lastRenderedReducer,Q!==null))try{var de=h.lastRenderedState,je=Q(de,S);if(U.hasEagerState=!0,U.eagerState=je,Ca(je,de)){var Re=h.interleaved;Re===null?(U.next=U,Jc(h)):(U.next=Re.next,Re.next=U),h.interleaved=U;return}}catch{}finally{}S=vd(u,h,U,F),S!==null&&(U=Za(),Do(S,u,F,U),Ja(S,h,F))}}function mg(u){var h=u.alternate;return u===nn||h!==null&&h===nn}function Fx(u,h){fl=Ri=!0;var S=u.pending;S===null?h.next=h:(h.next=S.next,S.next=h),u.pending=h}function Ja(u,h,S){if((S&4194240)!==0){var F=h.lanes;F&=u.pendingLanes,S|=F,h.lanes=S,R0(u,S)}}var ou={readContext:la,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},hv={readContext:la,useCallback:function(u,h){return wn().memoizedState=[u,h===void 0?null:h],u},useContext:la,useEffect:Cx,useImperativeHandle:function(u,h,S){return S=S!=null?S.concat([u]):null,iu(4194308,4,gl.bind(null,h,u),S)},useLayoutEffect:function(u,h){return iu(4194308,4,u,h)},useInsertionEffect:function(u,h){return iu(4,2,u,h)},useMemo:function(u,h){var S=wn();return h=h===void 0?null:h,u=u(),S.memoizedState=[u,h],u},useReducer:function(u,h,S){var F=wn();return h=S!==void 0?S(h):h,F.memoizedState=F.baseState=h,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:h},F.queue=u,u=u.dispatch=fv.bind(null,nn,u),[F.memoizedState,u]},useRef:function(u){var h=wn();return u={current:u},h.memoizedState=u},useState:hl,useDebugValue:Fo,useDeferredValue:function(u){return wn().memoizedState=u},useTransition:function(){var u=hl(!1),h=u[0];return u=Nx.bind(null,u[1]),wn().memoizedState=u,[h,u]},useMutableSource:function(){},useSyncExternalStore:function(u,h,S){var F=nn,U=wn();if(en){if(S===void 0)throw Error(r(407));S=S()}else{if(S=h(),qs===null)throw Error(r(349));(ca&30)!==0||kx(F,h,S)}U.memoizedState=S;var Q={value:S,getSnapshot:h};return U.queue=Q,Cx(lg.bind(null,F,Q,u),[u]),F.flags|=2048,au(9,jo.bind(null,F,Q,S,h),void 0,null),S},useId:function(){var u=wn(),h=qs.identifierPrefix;if(en){var S=kn,F=Ka;S=(F&~(1<<32-Kt(F)-1)).toString(32)+S,h=":"+h+"R"+S,S=hi++,0<S&&(h+="H"+S.toString(32)),h+=":"}else S=ch++,h=":"+h+"r"+S.toString(32)+":";return u.memoizedState=h},unstable_isNewReconciler:!1},ml={readContext:la,useCallback:gg,useContext:la,useEffect:dg,useImperativeHandle:Tx,useInsertionEffect:fg,useLayoutEffect:hg,useMemo:_n,useReducer:Vs,useRef:ug,useState:function(){return Vs(Gs)},useDebugValue:Fo,useDeferredValue:function(u){var h=us();return Ex(h,Ln.memoizedState,u)},useTransition:function(){var u=Vs(Gs)[0],h=us().memoizedState;return[u,h]},useMutableSource:dh,useSyncExternalStore:fh,useId:Ax,unstable_isNewReconciler:!1},gh={readContext:la,useCallback:gg,useContext:la,useEffect:dg,useImperativeHandle:Tx,useInsertionEffect:fg,useLayoutEffect:hg,useMemo:_n,useReducer:uh,useRef:ug,useState:function(){return uh(Gs)},useDebugValue:Fo,useDeferredValue:function(u){var h=us();return Ln===null?h.memoizedState=u:Ex(h,Ln.memoizedState,u)},useTransition:function(){var u=uh(Gs)[0],h=us().memoizedState;return[u,h]},useMutableSource:dh,useSyncExternalStore:fh,useId:Ax,unstable_isNewReconciler:!1};function Rs(u,h){if(u&&u.defaultProps){h=G({},h),u=u.defaultProps;for(var S in u)h[S]===void 0&&(h[S]=u[S]);return h}return h}function lu(u,h,S,F){h=u.memoizedState,S=S(F,h),S=S==null?h:G({},h,S),u.memoizedState=S,u.lanes===0&&(u.updateQueue.baseState=S)}var cu={isMounted:function(u){return(u=u._reactInternals)?Ee(u)===u:!1},enqueueSetState:function(u,h,S){u=u._reactInternals;var F=Za(),U=gu(u),Q=Qi(F,U);Q.payload=h,S!=null&&(Q.callback=S),h=Ji(u,Q,U),h!==null&&(Do(h,u,U,F),lh(h,u,U))},enqueueReplaceState:function(u,h,S){u=u._reactInternals;var F=Za(),U=gu(u),Q=Qi(F,U);Q.tag=1,Q.payload=h,S!=null&&(Q.callback=S),h=Ji(u,Q,U),h!==null&&(Do(h,u,U,F),lh(h,u,U))},enqueueForceUpdate:function(u,h){u=u._reactInternals;var S=Za(),F=gu(u),U=Qi(S,F);U.tag=2,h!=null&&(U.callback=h),h=Ji(u,U,F),h!==null&&(Do(h,u,F,S),lh(h,u,F))}};function mh(u,h,S,F,U,Q,de){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(F,Q,de):h.prototype&&h.prototype.isPureReactComponent?!Wl(S,F)||!Wl(U,Q):!0}function Px(u,h,S){var F=!1,U=Ki,Q=h.contextType;return typeof Q=="object"&&Q!==null?Q=la(Q):(U=zs(h)?il:Ps.current,F=h.contextTypes,Q=(F=F!=null)?Ql(u,U):Ki),h=new h(S,Q),u.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=cu,u.stateNode=h,h._reactInternals=u,F&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=U,u.__reactInternalMemoizedMaskedChildContext=Q),h}function pg(u,h,S,F){u=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(S,F),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(S,F),h.state!==u&&cu.enqueueReplaceState(h,h.state,null)}function ph(u,h,S,F){var U=u.stateNode;U.props=S,U.state=u.memoizedState,U.refs={},wd(u);var Q=h.contextType;typeof Q=="object"&&Q!==null?U.context=la(Q):(Q=zs(h)?il:Ps.current,U.context=Ql(u,Q)),U.state=u.memoizedState,Q=h.getDerivedStateFromProps,typeof Q=="function"&&(lu(u,h,Q,S),U.state=u.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof U.getSnapshotBeforeUpdate=="function"||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(h=U.state,typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount(),h!==U.state&&cu.enqueueReplaceState(U,U.state,null),Zc(u,S,U,F),U.state=u.memoizedState),typeof U.componentDidMount=="function"&&(u.flags|=4194308)}function ic(u,h){try{var S="",F=h;do S+=J(F),F=F.return;while(F);var U=S}catch(Q){U=`
Error generating stack: `+Q.message+`
`+Q.stack}return{value:u,source:h,stack:U,digest:null}}function xh(u,h,S){return{value:u,source:null,stack:S??null,digest:h??null}}function uu(u,h){try{console.error(h.value)}catch(S){setTimeout(function(){throw S})}}var gv=typeof WeakMap=="function"?WeakMap:Map;function Rx(u,h,S){S=Qi(-1,S),S.tag=3,S.payload={element:null};var F=h.value;return S.callback=function(){Lx||(Lx=!0,kv=F),uu(u,h)},S}function m(u,h,S){S=Qi(-1,S),S.tag=3;var F=u.type.getDerivedStateFromError;if(typeof F=="function"){var U=h.value;S.payload=function(){return F(U)},S.callback=function(){uu(u,h)}}var Q=u.stateNode;return Q!==null&&typeof Q.componentDidCatch=="function"&&(S.callback=function(){uu(u,h),typeof F!="function"&&(fu===null?fu=new Set([this]):fu.add(this));var de=h.stack;this.componentDidCatch(h.value,{componentStack:de!==null?de:""})}),S}function x(u,h,S){var F=u.pingCache;if(F===null){F=u.pingCache=new gv;var U=new Set;F.set(h,U)}else U=F.get(h),U===void 0&&(U=new Set,F.set(h,U));U.has(S)||(U.add(S),u=bP.bind(null,u,h,S),h.then(u,u))}function j(u){do{var h;if((h=u.tag===13)&&(h=u.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return u;u=u.return}while(u!==null);return null}function L(u,h,S,F,U){return(u.mode&1)===0?(u===h?u.flags|=65536:(u.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(h=Qi(-1,1),h.tag=2,Ji(S,h,1))),S.lanes|=1),u):(u.flags|=65536,u.lanes=U,u)}var V=N.ReactCurrentOwner,ne=!1;function xe(u,h,S,F){h.child=u===null?fi(h,null,S,F):nc(h,u.child,S,F)}function Ue(u,h,S,F,U){S=S.render;var Q=h.ref;return No(h,U),F=nu(u,h,S,F,Q,U),S=su(),u!==null&&!ne?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~U,Ks(u,h,U)):(en&&S&&Xc(h),h.flags|=1,xe(u,h,F,U),h.child)}function it(u,h,S,F,U){if(u===null){var Q=S.type;return typeof Q=="function"&&!Fv(Q)&&Q.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(h.tag=15,h.type=Q,Pt(u,h,Q,F,U)):(u=Hx(S.type,null,F,h,h.mode,U),u.ref=h.ref,u.return=h,h.child=u)}if(Q=u.child,(u.lanes&U)===0){var de=Q.memoizedProps;if(S=S.compare,S=S!==null?S:Wl,S(de,F)&&u.ref===h.ref)return Ks(u,h,U)}return h.flags|=1,u=pu(Q,F),u.ref=h.ref,u.return=h,h.child=u}function Pt(u,h,S,F,U){if(u!==null){var Q=u.memoizedProps;if(Wl(Q,F)&&u.ref===h.ref)if(ne=!1,h.pendingProps=F=Q,(u.lanes&U)!==0)(u.flags&131072)!==0&&(ne=!0);else return h.lanes=u.lanes,Ks(u,h,U)}return Yt(u,h,S,F,U)}function rr(u,h,S){var F=h.pendingProps,U=F.children,Q=u!==null?u.memoizedState:null;if(F.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},sn(vh,Di),Di|=S;else{if((S&1073741824)===0)return u=Q!==null?Q.baseLanes|S:S,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:u,cachePool:null,transitions:null},h.updateQueue=null,sn(vh,Di),Di|=u,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},F=Q!==null?Q.baseLanes:S,sn(vh,Di),Di|=F}else Q!==null?(F=Q.baseLanes|S,h.memoizedState=null):F=S,sn(vh,Di),Di|=F;return xe(u,h,U,S),h.child}function br(u,h){var S=h.ref;(u===null&&S!==null||u!==null&&u.ref!==S)&&(h.flags|=512,h.flags|=2097152)}function Yt(u,h,S,F,U){var Q=zs(S)?il:Ps.current;return Q=Ql(h,Q),No(h,U),S=nu(u,h,S,F,Q,U),F=su(),u!==null&&!ne?(h.updateQueue=u.updateQueue,h.flags&=-2053,u.lanes&=~U,Ks(u,h,U)):(en&&F&&Xc(h),h.flags|=1,xe(u,h,S,U),h.child)}function pn(u,h,S,F,U){if(zs(S)){var Q=!0;Jl(h)}else Q=!1;if(No(h,U),h.stateNode===null)Ur(u,h),Px(h,S,F),ph(h,S,F,U),F=!0;else if(u===null){var de=h.stateNode,je=h.memoizedProps;de.props=je;var Re=de.context,st=S.contextType;typeof st=="object"&&st!==null?st=la(st):(st=zs(S)?il:Ps.current,st=Ql(h,st));var Nt=S.getDerivedStateFromProps,Ft=typeof Nt=="function"||typeof de.getSnapshotBeforeUpdate=="function";Ft||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==F||Re!==st)&&pg(h,de,F,st),Yi=!1;var Et=h.memoizedState;de.state=Et,Zc(h,F,de,U),Re=h.memoizedState,je!==F||Et!==Re||Ws.current||Yi?(typeof Nt=="function"&&(lu(h,S,Nt,F),Re=h.memoizedState),(je=Yi||mh(h,S,je,F,Et,Re,st))?(Ft||typeof de.UNSAFE_componentWillMount!="function"&&typeof de.componentWillMount!="function"||(typeof de.componentWillMount=="function"&&de.componentWillMount(),typeof de.UNSAFE_componentWillMount=="function"&&de.UNSAFE_componentWillMount()),typeof de.componentDidMount=="function"&&(h.flags|=4194308)):(typeof de.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=F,h.memoizedState=Re),de.props=F,de.state=Re,de.context=st,F=je):(typeof de.componentDidMount=="function"&&(h.flags|=4194308),F=!1)}else{de=h.stateNode,oh(u,h),je=h.memoizedProps,st=h.type===h.elementType?je:Rs(h.type,je),de.props=st,Ft=h.pendingProps,Et=de.context,Re=S.contextType,typeof Re=="object"&&Re!==null?Re=la(Re):(Re=zs(S)?il:Ps.current,Re=Ql(h,Re));var Zt=S.getDerivedStateFromProps;(Nt=typeof Zt=="function"||typeof de.getSnapshotBeforeUpdate=="function")||typeof de.UNSAFE_componentWillReceiveProps!="function"&&typeof de.componentWillReceiveProps!="function"||(je!==Ft||Et!==Re)&&pg(h,de,F,Re),Yi=!1,Et=h.memoizedState,de.state=Et,Zc(h,F,de,U);var sr=h.memoizedState;je!==Ft||Et!==sr||Ws.current||Yi?(typeof Zt=="function"&&(lu(h,S,Zt,F),sr=h.memoizedState),(st=Yi||mh(h,S,st,F,Et,sr,Re)||!1)?(Nt||typeof de.UNSAFE_componentWillUpdate!="function"&&typeof de.componentWillUpdate!="function"||(typeof de.componentWillUpdate=="function"&&de.componentWillUpdate(F,sr,Re),typeof de.UNSAFE_componentWillUpdate=="function"&&de.UNSAFE_componentWillUpdate(F,sr,Re)),typeof de.componentDidUpdate=="function"&&(h.flags|=4),typeof de.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof de.componentDidUpdate!="function"||je===u.memoizedProps&&Et===u.memoizedState||(h.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===u.memoizedProps&&Et===u.memoizedState||(h.flags|=1024),h.memoizedProps=F,h.memoizedState=sr),de.props=F,de.state=sr,de.context=Re,F=st):(typeof de.componentDidUpdate!="function"||je===u.memoizedProps&&Et===u.memoizedState||(h.flags|=4),typeof de.getSnapshotBeforeUpdate!="function"||je===u.memoizedProps&&Et===u.memoizedState||(h.flags|=1024),F=!1)}return tn(u,h,S,F,Q,U)}function tn(u,h,S,F,U,Q){br(u,h);var de=(h.flags&128)!==0;if(!F&&!de)return U&&_x(h,S,!1),Ks(u,h,Q);F=h.stateNode,V.current=h;var je=de&&typeof S.getDerivedStateFromError!="function"?null:F.render();return h.flags|=1,u!==null&&de?(h.child=nc(h,u.child,null,Q),h.child=nc(h,null,je,Q)):xe(u,h,je,Q),h.memoizedState=F.state,U&&_x(h,S,!0),h.child}function ua(u){var h=u.stateNode;h.pendingContext?sg(u,h.pendingContext,h.pendingContext!==h.context):h.context&&sg(u,h.context,!1),dl(u,h.containerInfo)}function Zi(u,h,S,F,U){return rc(),xd(U),h.flags|=256,xe(u,h,S,F),h.child}var et={dehydrated:null,treeContext:null,retryLane:0};function ze(u){return{baseLanes:u,cachePool:null,transitions:null}}function ft(u,h,S){var F=h.pendingProps,U=mn.current,Q=!1,de=(h.flags&128)!==0,je;if((je=de)||(je=u!==null&&u.memoizedState===null?!1:(U&2)!==0),je?(Q=!0,h.flags&=-129):(u===null||u.memoizedState!==null)&&(U|=1),sn(mn,U&1),u===null)return Yc(h),u=h.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((h.mode&1)===0?h.lanes=1:u.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(de=F.children,u=F.fallback,Q?(F=h.mode,Q=h.child,de={mode:"hidden",children:de},(F&1)===0&&Q!==null?(Q.childLanes=0,Q.pendingProps=de):Q=Gx(de,F,0,null),u=Nd(u,F,S,null),Q.return=h,u.return=h,Q.sibling=u,h.child=Q,h.child.memoizedState=ze(S),h.memoizedState=et,u):Qt(h,de));if(U=u.memoizedState,U!==null&&(je=U.dehydrated,je!==null))return Er(u,h,de,F,je,U,S);if(Q){Q=F.fallback,de=h.mode,U=u.child,je=U.sibling;var Re={mode:"hidden",children:F.children};return(de&1)===0&&h.child!==U?(F=h.child,F.childLanes=0,F.pendingProps=Re,h.deletions=null):(F=pu(U,Re),F.subtreeFlags=U.subtreeFlags&14680064),je!==null?Q=pu(je,Q):(Q=Nd(Q,de,S,null),Q.flags|=2),Q.return=h,F.return=h,F.sibling=Q,h.child=F,F=Q,Q=h.child,de=u.child.memoizedState,de=de===null?ze(S):{baseLanes:de.baseLanes|S,cachePool:null,transitions:de.transitions},Q.memoizedState=de,Q.childLanes=u.childLanes&~S,h.memoizedState=et,F}return Q=u.child,u=Q.sibling,F=pu(Q,{mode:"visible",children:F.children}),(h.mode&1)===0&&(F.lanes=S),F.return=h,F.sibling=null,u!==null&&(S=h.deletions,S===null?(h.deletions=[u],h.flags|=16):S.push(u)),h.child=F,h.memoizedState=null,F}function Qt(u,h){return h=Gx({mode:"visible",children:h},u.mode,0,null),h.return=u,u.child=h}function or(u,h,S,F){return F!==null&&xd(F),nc(h,u.child,null,S),u=Qt(h,h.pendingProps.children),u.flags|=2,h.memoizedState=null,u}function Er(u,h,S,F,U,Q,de){if(S)return h.flags&256?(h.flags&=-257,F=xh(Error(r(422))),or(u,h,de,F)):h.memoizedState!==null?(h.child=u.child,h.flags|=128,null):(Q=F.fallback,U=h.mode,F=Gx({mode:"visible",children:F.children},U,0,null),Q=Nd(Q,U,de,null),Q.flags|=2,F.return=h,Q.return=h,F.sibling=Q,h.child=F,(h.mode&1)!==0&&nc(h,u.child,null,de),h.child.memoizedState=ze(de),h.memoizedState=et,Q);if((h.mode&1)===0)return or(u,h,de,null);if(U.data==="$!"){if(F=U.nextSibling&&U.nextSibling.dataset,F)var je=F.dgst;return F=je,Q=Error(r(419)),F=xh(Q,F,void 0),or(u,h,de,F)}if(je=(de&u.childLanes)!==0,ne||je){if(F=qs,F!==null){switch(de&-de){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}U=(U&(F.suspendedLanes|de))!==0?0:U,U!==0&&U!==Q.retryLane&&(Q.retryLane=U,Qa(u,U),Do(F,u,U,-1))}return jv(),F=xh(Error(r(421))),or(u,h,de,F)}return U.data==="$?"?(h.flags|=128,h.child=u.child,h=SP.bind(null,u),U._reactRetry=h,null):(u=Q.treeContext,Gt=Gi(U.nextSibling),qa=h,en=!0,Xa=null,u!==null&&(ia[oa++]=Ka,ia[oa++]=kn,ia[oa++]=ul,Ka=u.id,kn=u.overflow,ul=h),h=Qt(h,F.children),h.flags|=4096,h)}function Sr(u,h,S){u.lanes|=h;var F=u.alternate;F!==null&&(F.lanes|=h),ih(u.return,h,S)}function Wr(u,h,S,F,U){var Q=u.memoizedState;Q===null?u.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:F,tail:S,tailMode:U}:(Q.isBackwards=h,Q.rendering=null,Q.renderingStartTime=0,Q.last=F,Q.tail=S,Q.tailMode=U)}function ds(u,h,S){var F=h.pendingProps,U=F.revealOrder,Q=F.tail;if(xe(u,h,F.children,S),F=mn.current,(F&2)!==0)F=F&1|2,h.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=h.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Sr(u,S,h);else if(u.tag===19)Sr(u,S,h);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===h)break e;for(;u.sibling===null;){if(u.return===null||u.return===h)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}F&=1}if(sn(mn,F),(h.mode&1)===0)h.memoizedState=null;else switch(U){case"forwards":for(S=h.child,U=null;S!==null;)u=S.alternate,u!==null&&tu(u)===null&&(U=S),S=S.sibling;S=U,S===null?(U=h.child,h.child=null):(U=S.sibling,S.sibling=null),Wr(h,!1,U,S,Q);break;case"backwards":for(S=null,U=h.child,h.child=null;U!==null;){if(u=U.alternate,u!==null&&tu(u)===null){h.child=U;break}u=U.sibling,U.sibling=S,S=U,U=u}Wr(h,!0,S,null,Q);break;case"together":Wr(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Ur(u,h){(h.mode&1)===0&&u!==null&&(u.alternate=null,h.alternate=null,h.flags|=2)}function Ks(u,h,S){if(u!==null&&(h.dependencies=u.dependencies),kd|=h.lanes,(S&h.childLanes)===0)return null;if(u!==null&&h.child!==u.child)throw Error(r(153));if(h.child!==null){for(u=h.child,S=pu(u,u.pendingProps),h.child=S,S.return=h;u.sibling!==null;)u=u.sibling,S=S.sibling=pu(u,u.pendingProps),S.return=h;S.sibling=null}return h.child}function mv(u,h,S){switch(h.tag){case 3:ua(h),rc();break;case 5:eu(h);break;case 1:zs(h.type)&&Jl(h);break;case 4:dl(h,h.stateNode.containerInfo);break;case 10:var F=h.type._context,U=h.memoizedProps.value;sn(yd,F._currentValue),F._currentValue=U;break;case 13:if(F=h.memoizedState,F!==null)return F.dehydrated!==null?(sn(mn,mn.current&1),h.flags|=128,null):(S&h.child.childLanes)!==0?ft(u,h,S):(sn(mn,mn.current&1),u=Ks(u,h,S),u!==null?u.sibling:null);sn(mn,mn.current&1);break;case 19:if(F=(S&h.childLanes)!==0,(u.flags&128)!==0){if(F)return ds(u,h,S);h.flags|=128}if(U=h.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),sn(mn,mn.current),F)break;return null;case 22:case 23:return h.lanes=0,rr(u,h,S)}return Ks(u,h,S)}var HS,pv,GS,VS;HS=function(u,h){for(var S=h.child;S!==null;){if(S.tag===5||S.tag===6)u.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===h)break;for(;S.sibling===null;){if(S.return===null||S.return===h)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},pv=function(){},GS=function(u,h,S,F){var U=u.memoizedProps;if(U!==F){u=h.stateNode,cs(an.current);var Q=null;switch(S){case"input":U=He(u,U),F=He(u,F),Q=[];break;case"select":U=G({},U,{value:void 0}),F=G({},F,{value:void 0}),Q=[];break;case"textarea":U=Je(u,U),F=Je(u,F),Q=[];break;default:typeof U.onClick!="function"&&typeof F.onClick=="function"&&(u.onclick=ql)}gt(S,F);var de;S=null;for(st in U)if(!F.hasOwnProperty(st)&&U.hasOwnProperty(st)&&U[st]!=null)if(st==="style"){var je=U[st];for(de in je)je.hasOwnProperty(de)&&(S||(S={}),S[de]="")}else st!=="dangerouslySetInnerHTML"&&st!=="children"&&st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(s.hasOwnProperty(st)?Q||(Q=[]):(Q=Q||[]).push(st,null));for(st in F){var Re=F[st];if(je=U?.[st],F.hasOwnProperty(st)&&Re!==je&&(Re!=null||je!=null))if(st==="style")if(je){for(de in je)!je.hasOwnProperty(de)||Re&&Re.hasOwnProperty(de)||(S||(S={}),S[de]="");for(de in Re)Re.hasOwnProperty(de)&&je[de]!==Re[de]&&(S||(S={}),S[de]=Re[de])}else S||(Q||(Q=[]),Q.push(st,S)),S=Re;else st==="dangerouslySetInnerHTML"?(Re=Re?Re.__html:void 0,je=je?je.__html:void 0,Re!=null&&je!==Re&&(Q=Q||[]).push(st,Re)):st==="children"?typeof Re!="string"&&typeof Re!="number"||(Q=Q||[]).push(st,""+Re):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&(s.hasOwnProperty(st)?(Re!=null&&st==="onScroll"&&hn("scroll",u),Q||je===Re||(Q=[])):(Q=Q||[]).push(st,Re))}S&&(Q=Q||[]).push("style",S);var st=Q;(h.updateQueue=st)&&(h.flags|=4)}},VS=function(u,h,S,F){S!==F&&(h.flags|=4)};function xg(u,h){if(!en)switch(u.tailMode){case"hidden":h=u.tail;for(var S=null;h!==null;)h.alternate!==null&&(S=h),h=h.sibling;S===null?u.tail=null:S.sibling=null;break;case"collapsed":S=u.tail;for(var F=null;S!==null;)S.alternate!==null&&(F=S),S=S.sibling;F===null?h||u.tail===null?u.tail=null:u.tail.sibling=null:F.sibling=null}}function Ea(u){var h=u.alternate!==null&&u.alternate.child===u.child,S=0,F=0;if(h)for(var U=u.child;U!==null;)S|=U.lanes|U.childLanes,F|=U.subtreeFlags&14680064,F|=U.flags&14680064,U.return=u,U=U.sibling;else for(U=u.child;U!==null;)S|=U.lanes|U.childLanes,F|=U.subtreeFlags,F|=U.flags,U.return=u,U=U.sibling;return u.subtreeFlags|=F,u.childLanes=S,h}function fP(u,h,S){var F=h.pendingProps;switch(_s(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ea(h),null;case 1:return zs(h.type)&&Kc(),Ea(h),null;case 3:return F=h.stateNode,Tn(),gn(Ws),gn(Ps),Hs(),F.pendingContext&&(F.context=F.pendingContext,F.pendingContext=null),(u===null||u.child===null)&&(pd(h)?h.flags|=4:u===null||u.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Xa!==null&&(Ev(Xa),Xa=null))),pv(u,h),Ea(h),null;case 5:Ao(h);var U=cs(Wn.current);if(S=h.type,u!==null&&h.stateNode!=null)GS(u,h,S,F,U),u.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!F){if(h.stateNode===null)throw Error(r(166));return Ea(h),null}if(u=cs(an.current),pd(h)){F=h.stateNode,S=h.type;var Q=h.memoizedProps;switch(F[di]=h,F[hd]=Q,u=(h.mode&1)!==0,S){case"dialog":hn("cancel",F),hn("close",F);break;case"iframe":case"object":case"embed":hn("load",F);break;case"video":case"audio":for(U=0;U<nl.length;U++)hn(nl[U],F);break;case"source":hn("error",F);break;case"img":case"image":case"link":hn("error",F),hn("load",F);break;case"details":hn("toggle",F);break;case"input":Ye(F,Q),hn("invalid",F);break;case"select":F._wrapperState={wasMultiple:!!Q.multiple},hn("invalid",F);break;case"textarea":_t(F,Q),hn("invalid",F)}gt(S,Q),U=null;for(var de in Q)if(Q.hasOwnProperty(de)){var je=Q[de];de==="children"?typeof je=="string"?F.textContent!==je&&(Q.suppressHydrationWarning!==!0&&dd(F.textContent,je,u),U=["children",je]):typeof je=="number"&&F.textContent!==""+je&&(Q.suppressHydrationWarning!==!0&&dd(F.textContent,je,u),U=["children",""+je]):s.hasOwnProperty(de)&&je!=null&&de==="onScroll"&&hn("scroll",F)}switch(S){case"input":Oe(F),Rt(F,Q,!0);break;case"textarea":Oe(F),It(F);break;case"select":case"option":break;default:typeof Q.onClick=="function"&&(F.onclick=ql)}F=U,h.updateQueue=F,F!==null&&(h.flags|=4)}else{de=U.nodeType===9?U:U.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=Mt(S)),u==="http://www.w3.org/1999/xhtml"?S==="script"?(u=de.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof F.is=="string"?u=de.createElement(S,{is:F.is}):(u=de.createElement(S),S==="select"&&(de=u,F.multiple?de.multiple=!0:F.size&&(de.size=F.size))):u=de.createElementNS(u,S),u[di]=h,u[hd]=F,HS(u,h,!1,!1),h.stateNode=u;e:{switch(de=At(S,F),S){case"dialog":hn("cancel",u),hn("close",u),U=F;break;case"iframe":case"object":case"embed":hn("load",u),U=F;break;case"video":case"audio":for(U=0;U<nl.length;U++)hn(nl[U],u);U=F;break;case"source":hn("error",u),U=F;break;case"img":case"image":case"link":hn("error",u),hn("load",u),U=F;break;case"details":hn("toggle",u),U=F;break;case"input":Ye(u,F),U=He(u,F),hn("invalid",u);break;case"option":U=F;break;case"select":u._wrapperState={wasMultiple:!!F.multiple},U=G({},F,{value:void 0}),hn("invalid",u);break;case"textarea":_t(u,F),U=Je(u,F),hn("invalid",u);break;default:U=F}gt(S,U),je=U;for(Q in je)if(je.hasOwnProperty(Q)){var Re=je[Q];Q==="style"?Ie(u,Re):Q==="dangerouslySetInnerHTML"?(Re=Re?Re.__html:void 0,Re!=null&&pt(u,Re)):Q==="children"?typeof Re=="string"?(S!=="textarea"||Re!=="")&&lt(u,Re):typeof Re=="number"&&lt(u,""+Re):Q!=="suppressContentEditableWarning"&&Q!=="suppressHydrationWarning"&&Q!=="autoFocus"&&(s.hasOwnProperty(Q)?Re!=null&&Q==="onScroll"&&hn("scroll",u):Re!=null&&_(u,Q,Re,de))}switch(S){case"input":Oe(u),Rt(u,F,!1);break;case"textarea":Oe(u),It(u);break;case"option":F.value!=null&&u.setAttribute("value",""+ie(F.value));break;case"select":u.multiple=!!F.multiple,Q=F.value,Q!=null?De(u,!!F.multiple,Q,!1):F.defaultValue!=null&&De(u,!!F.multiple,F.defaultValue,!0);break;default:typeof U.onClick=="function"&&(u.onclick=ql)}switch(S){case"button":case"input":case"select":case"textarea":F=!!F.autoFocus;break e;case"img":F=!0;break e;default:F=!1}}F&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Ea(h),null;case 6:if(u&&h.stateNode!=null)VS(u,h,u.memoizedProps,F);else{if(typeof F!="string"&&h.stateNode===null)throw Error(r(166));if(S=cs(Wn.current),cs(an.current),pd(h)){if(F=h.stateNode,S=h.memoizedProps,F[di]=h,(Q=F.nodeValue!==S)&&(u=qa,u!==null))switch(u.tag){case 3:dd(F.nodeValue,S,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&dd(F.nodeValue,S,(u.mode&1)!==0)}Q&&(h.flags|=4)}else F=(S.nodeType===9?S:S.ownerDocument).createTextNode(F),F[di]=h,h.stateNode=F}return Ea(h),null;case 13:if(gn(mn),F=h.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(en&&Gt!==null&&(h.mode&1)!==0&&(h.flags&128)===0)ig(),rc(),h.flags|=98560,Q=!1;else if(Q=pd(h),F!==null&&F.dehydrated!==null){if(u===null){if(!Q)throw Error(r(318));if(Q=h.memoizedState,Q=Q!==null?Q.dehydrated:null,!Q)throw Error(r(317));Q[di]=h}else rc(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Ea(h),Q=!1}else Xa!==null&&(Ev(Xa),Xa=null),Q=!0;if(!Q)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=S,h):(F=F!==null,F!==(u!==null&&u.memoizedState!==null)&&F&&(h.child.flags|=8192,(h.mode&1)!==0&&(u===null||(mn.current&1)!==0?Ds===0&&(Ds=3):jv())),h.updateQueue!==null&&(h.flags|=4),Ea(h),null);case 4:return Tn(),pv(u,h),u===null&&Vl(h.stateNode.containerInfo),Ea(h),null;case 10:return ah(h.type._context),Ea(h),null;case 17:return zs(h.type)&&Kc(),Ea(h),null;case 19:if(gn(mn),Q=h.memoizedState,Q===null)return Ea(h),null;if(F=(h.flags&128)!==0,de=Q.rendering,de===null)if(F)xg(Q,!1);else{if(Ds!==0||u!==null&&(u.flags&128)!==0)for(u=h.child;u!==null;){if(de=tu(u),de!==null){for(h.flags|=128,xg(Q,!1),F=de.updateQueue,F!==null&&(h.updateQueue=F,h.flags|=4),h.subtreeFlags=0,F=S,S=h.child;S!==null;)Q=S,u=F,Q.flags&=14680066,de=Q.alternate,de===null?(Q.childLanes=0,Q.lanes=u,Q.child=null,Q.subtreeFlags=0,Q.memoizedProps=null,Q.memoizedState=null,Q.updateQueue=null,Q.dependencies=null,Q.stateNode=null):(Q.childLanes=de.childLanes,Q.lanes=de.lanes,Q.child=de.child,Q.subtreeFlags=0,Q.deletions=null,Q.memoizedProps=de.memoizedProps,Q.memoizedState=de.memoizedState,Q.updateQueue=de.updateQueue,Q.type=de.type,u=de.dependencies,Q.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),S=S.sibling;return sn(mn,mn.current&1|2),h.child}u=u.sibling}Q.tail!==null&&be()>wh&&(h.flags|=128,F=!0,xg(Q,!1),h.lanes=4194304)}else{if(!F)if(u=tu(de),u!==null){if(h.flags|=128,F=!0,S=u.updateQueue,S!==null&&(h.updateQueue=S,h.flags|=4),xg(Q,!0),Q.tail===null&&Q.tailMode==="hidden"&&!de.alternate&&!en)return Ea(h),null}else 2*be()-Q.renderingStartTime>wh&&S!==1073741824&&(h.flags|=128,F=!0,xg(Q,!1),h.lanes=4194304);Q.isBackwards?(de.sibling=h.child,h.child=de):(S=Q.last,S!==null?S.sibling=de:h.child=de,Q.last=de)}return Q.tail!==null?(h=Q.tail,Q.rendering=h,Q.tail=h.sibling,Q.renderingStartTime=be(),h.sibling=null,S=mn.current,sn(mn,F?S&1|2:S&1),h):(Ea(h),null);case 22:case 23:return Av(),F=h.memoizedState!==null,u!==null&&u.memoizedState!==null!==F&&(h.flags|=8192),F&&(h.mode&1)!==0?(Di&1073741824)!==0&&(Ea(h),h.subtreeFlags&6&&(h.flags|=8192)):Ea(h),null;case 24:return null;case 25:return null}throw Error(r(156,h.tag))}function hP(u,h){switch(_s(h),h.tag){case 1:return zs(h.type)&&Kc(),u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 3:return Tn(),gn(Ws),gn(Ps),Hs(),u=h.flags,(u&65536)!==0&&(u&128)===0?(h.flags=u&-65537|128,h):null;case 5:return Ao(h),null;case 13:if(gn(mn),u=h.memoizedState,u!==null&&u.dehydrated!==null){if(h.alternate===null)throw Error(r(340));rc()}return u=h.flags,u&65536?(h.flags=u&-65537|128,h):null;case 19:return gn(mn),null;case 4:return Tn(),null;case 10:return ah(h.type._context),null;case 22:case 23:return Av(),null;case 24:return null;default:return null}}var Dx=!1,Na=!1,gP=typeof WeakSet=="function"?WeakSet:Set,nr=null;function yh(u,h){var S=u.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(F){Yn(u,h,F)}else S.current=null}function xv(u,h,S){try{S()}catch(F){Yn(u,h,F)}}var KS=!1;function mP(u,h){if(eg=Ff,u=os(),zc(u)){if("selectionStart"in u)var S={start:u.selectionStart,end:u.selectionEnd};else e:{S=(S=u.ownerDocument)&&S.defaultView||window;var F=S.getSelection&&S.getSelection();if(F&&F.rangeCount!==0){S=F.anchorNode;var U=F.anchorOffset,Q=F.focusNode;F=F.focusOffset;try{S.nodeType,Q.nodeType}catch{S=null;break e}var de=0,je=-1,Re=-1,st=0,Nt=0,Ft=u,Et=null;t:for(;;){for(var Zt;Ft!==S||U!==0&&Ft.nodeType!==3||(je=de+U),Ft!==Q||F!==0&&Ft.nodeType!==3||(Re=de+F),Ft.nodeType===3&&(de+=Ft.nodeValue.length),(Zt=Ft.firstChild)!==null;)Et=Ft,Ft=Zt;for(;;){if(Ft===u)break t;if(Et===S&&++st===U&&(je=de),Et===Q&&++Nt===F&&(Re=de),(Zt=Ft.nextSibling)!==null)break;Ft=Et,Et=Ft.parentNode}Ft=Zt}S=je===-1||Re===-1?null:{start:je,end:Re}}else S=null}S=S||{start:0,end:0}}else S=null;for(tg={focusedElem:u,selectionRange:S},Ff=!1,nr=h;nr!==null;)if(h=nr,u=h.child,(h.subtreeFlags&1028)!==0&&u!==null)u.return=h,nr=u;else for(;nr!==null;){h=nr;try{var sr=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(sr!==null){var ar=sr.memoizedProps,fs=sr.memoizedState,Ke=h.stateNode,Me=Ke.getSnapshotBeforeUpdate(h.elementType===h.type?ar:Rs(h.type,ar),fs);Ke.__reactInternalSnapshotBeforeUpdate=Me}break;case 3:var Qe=h.stateNode.containerInfo;Qe.nodeType===1?Qe.textContent="":Qe.nodeType===9&&Qe.documentElement&&Qe.removeChild(Qe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Dt){Yn(h,h.return,Dt)}if(u=h.sibling,u!==null){u.return=h.return,nr=u;break}nr=h.return}return sr=KS,KS=!1,sr}function yg(u,h,S){var F=h.updateQueue;if(F=F!==null?F.lastEffect:null,F!==null){var U=F=F.next;do{if((U.tag&u)===u){var Q=U.destroy;U.destroy=void 0,Q!==void 0&&xv(h,S,Q)}U=U.next}while(U!==F)}}function Ix(u,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var S=h=h.next;do{if((S.tag&u)===u){var F=S.create;S.destroy=F()}S=S.next}while(S!==h)}}function yv(u){var h=u.ref;if(h!==null){var S=u.stateNode;switch(u.tag){case 5:u=S;break;default:u=S}typeof h=="function"?h(u):h.current=u}}function qS(u){var h=u.alternate;h!==null&&(u.alternate=null,qS(h)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(h=u.stateNode,h!==null&&(delete h[di],delete h[hd],delete h[Qf],delete h[vx],delete h[wx])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function XS(u){return u.tag===5||u.tag===3||u.tag===4}function YS(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||XS(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function vv(u,h,S){var F=u.tag;if(F===5||F===6)u=u.stateNode,h?S.nodeType===8?S.parentNode.insertBefore(u,h):S.insertBefore(u,h):(S.nodeType===8?(h=S.parentNode,h.insertBefore(u,S)):(h=S,h.appendChild(u)),S=S._reactRootContainer,S!=null||h.onclick!==null||(h.onclick=ql));else if(F!==4&&(u=u.child,u!==null))for(vv(u,h,S),u=u.sibling;u!==null;)vv(u,h,S),u=u.sibling}function wv(u,h,S){var F=u.tag;if(F===5||F===6)u=u.stateNode,h?S.insertBefore(u,h):S.appendChild(u);else if(F!==4&&(u=u.child,u!==null))for(wv(u,h,S),u=u.sibling;u!==null;)wv(u,h,S),u=u.sibling}var da=null,Po=!1;function du(u,h,S){for(S=S.child;S!==null;)QS(u,h,S),S=S.sibling}function QS(u,h,S){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(Ar,S)}catch{}switch(S.tag){case 5:Na||yh(S,h);case 6:var F=da,U=Po;da=null,du(u,h,S),da=F,Po=U,da!==null&&(Po?(u=da,S=S.stateNode,u.nodeType===8?u.parentNode.removeChild(S):u.removeChild(S)):da.removeChild(S.stateNode));break;case 18:da!==null&&(Po?(u=da,S=S.stateNode,u.nodeType===8?Yf(u.parentNode,S):u.nodeType===1&&Yf(u,S),Sa(u)):Yf(da,S.stateNode));break;case 4:F=da,U=Po,da=S.stateNode.containerInfo,Po=!0,du(u,h,S),da=F,Po=U;break;case 0:case 11:case 14:case 15:if(!Na&&(F=S.updateQueue,F!==null&&(F=F.lastEffect,F!==null))){U=F=F.next;do{var Q=U,de=Q.destroy;Q=Q.tag,de!==void 0&&((Q&2)!==0||(Q&4)!==0)&&xv(S,h,de),U=U.next}while(U!==F)}du(u,h,S);break;case 1:if(!Na&&(yh(S,h),F=S.stateNode,typeof F.componentWillUnmount=="function"))try{F.props=S.memoizedProps,F.state=S.memoizedState,F.componentWillUnmount()}catch(je){Yn(S,h,je)}du(u,h,S);break;case 21:du(u,h,S);break;case 22:S.mode&1?(Na=(F=Na)||S.memoizedState!==null,du(u,h,S),Na=F):du(u,h,S);break;default:du(u,h,S)}}function JS(u){var h=u.updateQueue;if(h!==null){u.updateQueue=null;var S=u.stateNode;S===null&&(S=u.stateNode=new gP),h.forEach(function(F){var U=kP.bind(null,u,F);S.has(F)||(S.add(F),F.then(U,U))})}}function Ro(u,h){var S=h.deletions;if(S!==null)for(var F=0;F<S.length;F++){var U=S[F];try{var Q=u,de=h,je=de;e:for(;je!==null;){switch(je.tag){case 5:da=je.stateNode,Po=!1;break e;case 3:da=je.stateNode.containerInfo,Po=!0;break e;case 4:da=je.stateNode.containerInfo,Po=!0;break e}je=je.return}if(da===null)throw Error(r(160));QS(Q,de,U),da=null,Po=!1;var Re=U.alternate;Re!==null&&(Re.return=null),U.return=null}catch(st){Yn(U,h,st)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)ZS(h,u),h=h.sibling}function ZS(u,h){var S=u.alternate,F=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(Ro(h,u),pl(u),F&4){try{yg(3,u,u.return),Ix(3,u)}catch(ar){Yn(u,u.return,ar)}try{yg(5,u,u.return)}catch(ar){Yn(u,u.return,ar)}}break;case 1:Ro(h,u),pl(u),F&512&&S!==null&&yh(S,S.return);break;case 5:if(Ro(h,u),pl(u),F&512&&S!==null&&yh(S,S.return),u.flags&32){var U=u.stateNode;try{lt(U,"")}catch(ar){Yn(u,u.return,ar)}}if(F&4&&(U=u.stateNode,U!=null)){var Q=u.memoizedProps,de=S!==null?S.memoizedProps:Q,je=u.type,Re=u.updateQueue;if(u.updateQueue=null,Re!==null)try{je==="input"&&Q.type==="radio"&&Q.name!=null&&ot(U,Q),At(je,de);var st=At(je,Q);for(de=0;de<Re.length;de+=2){var Nt=Re[de],Ft=Re[de+1];Nt==="style"?Ie(U,Ft):Nt==="dangerouslySetInnerHTML"?pt(U,Ft):Nt==="children"?lt(U,Ft):_(U,Nt,Ft,st)}switch(je){case"input":Ve(U,Q);break;case"textarea":ht(U,Q);break;case"select":var Et=U._wrapperState.wasMultiple;U._wrapperState.wasMultiple=!!Q.multiple;var Zt=Q.value;Zt!=null?De(U,!!Q.multiple,Zt,!1):Et!==!!Q.multiple&&(Q.defaultValue!=null?De(U,!!Q.multiple,Q.defaultValue,!0):De(U,!!Q.multiple,Q.multiple?[]:"",!1))}U[hd]=Q}catch(ar){Yn(u,u.return,ar)}}break;case 6:if(Ro(h,u),pl(u),F&4){if(u.stateNode===null)throw Error(r(162));U=u.stateNode,Q=u.memoizedProps;try{U.nodeValue=Q}catch(ar){Yn(u,u.return,ar)}}break;case 3:if(Ro(h,u),pl(u),F&4&&S!==null&&S.memoizedState.isDehydrated)try{Sa(h.containerInfo)}catch(ar){Yn(u,u.return,ar)}break;case 4:Ro(h,u),pl(u);break;case 13:Ro(h,u),pl(u),U=u.child,U.flags&8192&&(Q=U.memoizedState!==null,U.stateNode.isHidden=Q,!Q||U.alternate!==null&&U.alternate.memoizedState!==null||(Sv=be())),F&4&&JS(u);break;case 22:if(Nt=S!==null&&S.memoizedState!==null,u.mode&1?(Na=(st=Na)||Nt,Ro(h,u),Na=st):Ro(h,u),pl(u),F&8192){if(st=u.memoizedState!==null,(u.stateNode.isHidden=st)&&!Nt&&(u.mode&1)!==0)for(nr=u,Nt=u.child;Nt!==null;){for(Ft=nr=Nt;nr!==null;){switch(Et=nr,Zt=Et.child,Et.tag){case 0:case 11:case 14:case 15:yg(4,Et,Et.return);break;case 1:yh(Et,Et.return);var sr=Et.stateNode;if(typeof sr.componentWillUnmount=="function"){F=Et,S=Et.return;try{h=F,sr.props=h.memoizedProps,sr.state=h.memoizedState,sr.componentWillUnmount()}catch(ar){Yn(F,S,ar)}}break;case 5:yh(Et,Et.return);break;case 22:if(Et.memoizedState!==null){rk(Ft);continue}}Zt!==null?(Zt.return=Et,nr=Zt):rk(Ft)}Nt=Nt.sibling}e:for(Nt=null,Ft=u;;){if(Ft.tag===5){if(Nt===null){Nt=Ft;try{U=Ft.stateNode,st?(Q=U.style,typeof Q.setProperty=="function"?Q.setProperty("display","none","important"):Q.display="none"):(je=Ft.stateNode,Re=Ft.memoizedProps.style,de=Re!=null&&Re.hasOwnProperty("display")?Re.display:null,je.style.display=Ht("display",de))}catch(ar){Yn(u,u.return,ar)}}}else if(Ft.tag===6){if(Nt===null)try{Ft.stateNode.nodeValue=st?"":Ft.memoizedProps}catch(ar){Yn(u,u.return,ar)}}else if((Ft.tag!==22&&Ft.tag!==23||Ft.memoizedState===null||Ft===u)&&Ft.child!==null){Ft.child.return=Ft,Ft=Ft.child;continue}if(Ft===u)break e;for(;Ft.sibling===null;){if(Ft.return===null||Ft.return===u)break e;Nt===Ft&&(Nt=null),Ft=Ft.return}Nt===Ft&&(Nt=null),Ft.sibling.return=Ft.return,Ft=Ft.sibling}}break;case 19:Ro(h,u),pl(u),F&4&&JS(u);break;case 21:break;default:Ro(h,u),pl(u)}}function pl(u){var h=u.flags;if(h&2){try{e:{for(var S=u.return;S!==null;){if(XS(S)){var F=S;break e}S=S.return}throw Error(r(160))}switch(F.tag){case 5:var U=F.stateNode;F.flags&32&&(lt(U,""),F.flags&=-33);var Q=YS(u);wv(u,Q,U);break;case 3:case 4:var de=F.stateNode.containerInfo,je=YS(u);vv(u,je,de);break;default:throw Error(r(161))}}catch(Re){Yn(u,u.return,Re)}u.flags&=-3}h&4096&&(u.flags&=-4097)}function pP(u,h,S){nr=u,ek(u)}function ek(u,h,S){for(var F=(u.mode&1)!==0;nr!==null;){var U=nr,Q=U.child;if(U.tag===22&&F){var de=U.memoizedState!==null||Dx;if(!de){var je=U.alternate,Re=je!==null&&je.memoizedState!==null||Na;je=Dx;var st=Na;if(Dx=de,(Na=Re)&&!st)for(nr=U;nr!==null;)de=nr,Re=de.child,de.tag===22&&de.memoizedState!==null?nk(U):Re!==null?(Re.return=de,nr=Re):nk(U);for(;Q!==null;)nr=Q,ek(Q),Q=Q.sibling;nr=U,Dx=je,Na=st}tk(u)}else(U.subtreeFlags&8772)!==0&&Q!==null?(Q.return=U,nr=Q):tk(u)}}function tk(u){for(;nr!==null;){var h=nr;if((h.flags&8772)!==0){var S=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Na||Ix(5,h);break;case 1:var F=h.stateNode;if(h.flags&4&&!Na)if(S===null)F.componentDidMount();else{var U=h.elementType===h.type?S.memoizedProps:Rs(h.type,S.memoizedProps);F.componentDidUpdate(U,S.memoizedState,F.__reactInternalSnapshotBeforeUpdate)}var Q=h.updateQueue;Q!==null&&On(h,Q,F);break;case 3:var de=h.updateQueue;if(de!==null){if(S=null,h.child!==null)switch(h.child.tag){case 5:S=h.child.stateNode;break;case 1:S=h.child.stateNode}On(h,de,S)}break;case 5:var je=h.stateNode;if(S===null&&h.flags&4){S=je;var Re=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":Re.autoFocus&&S.focus();break;case"img":Re.src&&(S.src=Re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var st=h.alternate;if(st!==null){var Nt=st.memoizedState;if(Nt!==null){var Ft=Nt.dehydrated;Ft!==null&&Sa(Ft)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Na||h.flags&512&&yv(h)}catch(Et){Yn(h,h.return,Et)}}if(h===u){nr=null;break}if(S=h.sibling,S!==null){S.return=h.return,nr=S;break}nr=h.return}}function rk(u){for(;nr!==null;){var h=nr;if(h===u){nr=null;break}var S=h.sibling;if(S!==null){S.return=h.return,nr=S;break}nr=h.return}}function nk(u){for(;nr!==null;){var h=nr;try{switch(h.tag){case 0:case 11:case 15:var S=h.return;try{Ix(4,h)}catch(Re){Yn(h,S,Re)}break;case 1:var F=h.stateNode;if(typeof F.componentDidMount=="function"){var U=h.return;try{F.componentDidMount()}catch(Re){Yn(h,U,Re)}}var Q=h.return;try{yv(h)}catch(Re){Yn(h,Q,Re)}break;case 5:var de=h.return;try{yv(h)}catch(Re){Yn(h,de,Re)}}}catch(Re){Yn(h,h.return,Re)}if(h===u){nr=null;break}var je=h.sibling;if(je!==null){je.return=h.return,nr=je;break}nr=h.return}}var xP=Math.ceil,Mx=N.ReactCurrentDispatcher,_v=N.ReactCurrentOwner,eo=N.ReactCurrentBatchConfig,Vr=0,qs=null,bs=null,fa=0,Di=0,vh=To(0),Ds=0,vg=null,kd=0,Ox=0,bv=0,wg=null,gi=null,Sv=0,wh=1/0,oc=null,Lx=!1,kv=null,fu=null,Bx=!1,hu=null,Ux=0,_g=0,Cv=null,$x=-1,Wx=0;function Za(){return(Vr&6)!==0?be():$x!==-1?$x:$x=be()}function gu(u){return(u.mode&1)===0?1:(Vr&2)!==0&&fa!==0?fa&-fa:og.transition!==null?(Wx===0&&(Wx=bn()),Wx):(u=Hr,u!==0||(u=window.event,u=u===void 0?16:rx(u.type)),u)}function Do(u,h,S,F){if(50<_g)throw _g=0,Cv=null,Error(r(185));Il(u,S,F),((Vr&2)===0||u!==qs)&&(u===qs&&((Vr&2)===0&&(Ox|=S),Ds===4&&mu(u,fa)),mi(u,F),S===1&&Vr===0&&(h.mode&1)===0&&(wh=be()+500,qc&&ol()))}function mi(u,h){var S=u.callbackNode;oi(u,h);var F=fn(u,u===qs?fa:0);if(F===0)S!==null&&we(S),u.callbackNode=null,u.callbackPriority=0;else if(h=F&-F,u.callbackPriority!==h){if(S!=null&&we(S),h===1)u.tag===0?Eo(ak.bind(null,u)):md(ak.bind(null,u)),xx(function(){(Vr&6)===0&&ol()}),S=null;else{switch(Zu(F)){case 1:S=vt;break;case 4:S=Fe;break;case 16:S=mt;break;case 536870912:S=Rr;break;default:S=mt}S=hk(S,sk.bind(null,u))}u.callbackPriority=h,u.callbackNode=S}}function sk(u,h){if($x=-1,Wx=0,(Vr&6)!==0)throw Error(r(327));var S=u.callbackNode;if(_h()&&u.callbackNode!==S)return null;var F=fn(u,u===qs?fa:0);if(F===0)return null;if((F&30)!==0||(F&u.expiredLanes)!==0||h)h=zx(u,F);else{h=F;var U=Vr;Vr|=2;var Q=ok();(qs!==u||fa!==h)&&(oc=null,wh=be()+500,Td(u,h));do try{wP();break}catch(je){ik(u,je)}while(!0);sh(),Mx.current=Q,Vr=U,bs!==null?h=0:(qs=null,fa=0,h=Ds)}if(h!==0){if(h===2&&(U=Us(u),U!==0&&(F=U,h=Tv(u,U))),h===1)throw S=vg,Td(u,0),mu(u,F),mi(u,be()),S;if(h===6)mu(u,F);else{if(U=u.current.alternate,(F&30)===0&&!yP(U)&&(h=zx(u,F),h===2&&(Q=Us(u),Q!==0&&(F=Q,h=Tv(u,Q))),h===1))throw S=vg,Td(u,0),mu(u,F),mi(u,be()),S;switch(u.finishedWork=U,u.finishedLanes=F,h){case 0:case 1:throw Error(r(345));case 2:Ed(u,gi,oc);break;case 3:if(mu(u,F),(F&130023424)===F&&(h=Sv+500-be(),10<h)){if(fn(u,0)!==0)break;if(U=u.suspendedLanes,(U&F)!==F){Za(),u.pingedLanes|=u.suspendedLanes&U;break}u.timeoutHandle=Va(Ed.bind(null,u,gi,oc),h);break}Ed(u,gi,oc);break;case 4:if(mu(u,F),(F&4194240)===F)break;for(h=u.eventTimes,U=-1;0<F;){var de=31-Kt(F);Q=1<<de,de=h[de],de>U&&(U=de),F&=~Q}if(F=U,F=be()-F,F=(120>F?120:480>F?480:1080>F?1080:1920>F?1920:3e3>F?3e3:4320>F?4320:1960*xP(F/1960))-F,10<F){u.timeoutHandle=Va(Ed.bind(null,u,gi,oc),F);break}Ed(u,gi,oc);break;case 5:Ed(u,gi,oc);break;default:throw Error(r(329))}}}return mi(u,be()),u.callbackNode===S?sk.bind(null,u):null}function Tv(u,h){var S=wg;return u.current.memoizedState.isDehydrated&&(Td(u,h).flags|=256),u=zx(u,h),u!==2&&(h=gi,gi=S,h!==null&&Ev(h)),u}function Ev(u){gi===null?gi=u:gi.push.apply(gi,u)}function yP(u){for(var h=u;;){if(h.flags&16384){var S=h.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var F=0;F<S.length;F++){var U=S[F],Q=U.getSnapshot;U=U.value;try{if(!Ca(Q(),U))return!1}catch{return!1}}}if(S=h.child,h.subtreeFlags&16384&&S!==null)S.return=h,h=S;else{if(h===u)break;for(;h.sibling===null;){if(h.return===null||h.return===u)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function mu(u,h){for(h&=~bv,h&=~Ox,u.suspendedLanes|=h,u.pingedLanes&=~h,u=u.expirationTimes;0<h;){var S=31-Kt(h),F=1<<S;u[S]=-1,h&=~F}}function ak(u){if((Vr&6)!==0)throw Error(r(327));_h();var h=fn(u,0);if((h&1)===0)return mi(u,be()),null;var S=zx(u,h);if(u.tag!==0&&S===2){var F=Us(u);F!==0&&(h=F,S=Tv(u,F))}if(S===1)throw S=vg,Td(u,0),mu(u,h),mi(u,be()),S;if(S===6)throw Error(r(345));return u.finishedWork=u.current.alternate,u.finishedLanes=h,Ed(u,gi,oc),mi(u,be()),null}function Nv(u,h){var S=Vr;Vr|=1;try{return u(h)}finally{Vr=S,Vr===0&&(wh=be()+500,qc&&ol())}}function Cd(u){hu!==null&&hu.tag===0&&(Vr&6)===0&&_h();var h=Vr;Vr|=1;var S=eo.transition,F=Hr;try{if(eo.transition=null,Hr=1,u)return u()}finally{Hr=F,eo.transition=S,Vr=h,(Vr&6)===0&&ol()}}function Av(){Di=vh.current,gn(vh)}function Td(u,h){u.finishedWork=null,u.finishedLanes=0;var S=u.timeoutHandle;if(S!==-1&&(u.timeoutHandle=-1,ng(S)),bs!==null)for(S=bs.return;S!==null;){var F=S;switch(_s(F),F.tag){case 1:F=F.type.childContextTypes,F!=null&&Kc();break;case 3:Tn(),gn(Ws),gn(Ps),Hs();break;case 5:Ao(F);break;case 4:Tn();break;case 13:gn(mn);break;case 19:gn(mn);break;case 10:ah(F.type._context);break;case 22:case 23:Av()}S=S.return}if(qs=u,bs=u=pu(u.current,null),fa=Di=h,Ds=0,vg=null,bv=Ox=kd=0,gi=wg=null,Xi!==null){for(h=0;h<Xi.length;h++)if(S=Xi[h],F=S.interleaved,F!==null){S.interleaved=null;var U=F.next,Q=S.pending;if(Q!==null){var de=Q.next;Q.next=U,F.next=de}S.pending=F}Xi=null}return u}function ik(u,h){do{var S=bs;try{if(sh(),ru.current=ou,Ri){for(var F=nn.memoizedState;F!==null;){var U=F.queue;U!==null&&(U.pending=null),F=F.next}Ri=!1}if(ca=0,qn=Ln=nn=null,fl=!1,hi=0,_v.current=null,S===null||S.return===null){Ds=1,vg=h,bs=null;break}e:{var Q=u,de=S.return,je=S,Re=h;if(h=fa,je.flags|=32768,Re!==null&&typeof Re=="object"&&typeof Re.then=="function"){var st=Re,Nt=je,Ft=Nt.tag;if((Nt.mode&1)===0&&(Ft===0||Ft===11||Ft===15)){var Et=Nt.alternate;Et?(Nt.updateQueue=Et.updateQueue,Nt.memoizedState=Et.memoizedState,Nt.lanes=Et.lanes):(Nt.updateQueue=null,Nt.memoizedState=null)}var Zt=j(de);if(Zt!==null){Zt.flags&=-257,L(Zt,de,je,Q,h),Zt.mode&1&&x(Q,st,h),h=Zt,Re=st;var sr=h.updateQueue;if(sr===null){var ar=new Set;ar.add(Re),h.updateQueue=ar}else sr.add(Re);break e}else{if((h&1)===0){x(Q,st,h),jv();break e}Re=Error(r(426))}}else if(en&&je.mode&1){var fs=j(de);if(fs!==null){(fs.flags&65536)===0&&(fs.flags|=256),L(fs,de,je,Q,h),xd(ic(Re,je));break e}}Q=Re=ic(Re,je),Ds!==4&&(Ds=2),wg===null?wg=[Q]:wg.push(Q),Q=de;do{switch(Q.tag){case 3:Q.flags|=65536,h&=-h,Q.lanes|=h;var Ke=Rx(Q,Re,h);_d(Q,Ke);break e;case 1:je=Re;var Me=Q.type,Qe=Q.stateNode;if((Q.flags&128)===0&&(typeof Me.getDerivedStateFromError=="function"||Qe!==null&&typeof Qe.componentDidCatch=="function"&&(fu===null||!fu.has(Qe)))){Q.flags|=65536,h&=-h,Q.lanes|=h;var Dt=m(Q,je,h);_d(Q,Dt);break e}}Q=Q.return}while(Q!==null)}ck(S)}catch(ir){h=ir,bs===S&&S!==null&&(bs=S=S.return);continue}break}while(!0)}function ok(){var u=Mx.current;return Mx.current=ou,u===null?ou:u}function jv(){(Ds===0||Ds===3||Ds===2)&&(Ds=4),qs===null||(kd&268435455)===0&&(Ox&268435455)===0||mu(qs,fa)}function zx(u,h){var S=Vr;Vr|=2;var F=ok();(qs!==u||fa!==h)&&(oc=null,Td(u,h));do try{vP();break}catch(U){ik(u,U)}while(!0);if(sh(),Vr=S,Mx.current=F,bs!==null)throw Error(r(261));return qs=null,fa=0,Ds}function vP(){for(;bs!==null;)lk(bs)}function wP(){for(;bs!==null&&!Te();)lk(bs)}function lk(u){var h=fk(u.alternate,u,Di);u.memoizedProps=u.pendingProps,h===null?ck(u):bs=h,_v.current=null}function ck(u){var h=u;do{var S=h.alternate;if(u=h.return,(h.flags&32768)===0){if(S=fP(S,h,Di),S!==null){bs=S;return}}else{if(S=hP(S,h),S!==null){S.flags&=32767,bs=S;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Ds=6,bs=null;return}}if(h=h.sibling,h!==null){bs=h;return}bs=h=u}while(h!==null);Ds===0&&(Ds=5)}function Ed(u,h,S){var F=Hr,U=eo.transition;try{eo.transition=null,Hr=1,_P(u,h,S,F)}finally{eo.transition=U,Hr=F}return null}function _P(u,h,S,F){do _h();while(hu!==null);if((Vr&6)!==0)throw Error(r(327));S=u.finishedWork;var U=u.finishedLanes;if(S===null)return null;if(u.finishedWork=null,u.finishedLanes=0,S===u.current)throw Error(r(177));u.callbackNode=null,u.callbackPriority=0;var Q=S.lanes|S.childLanes;if(ov(u,Q),u===qs&&(bs=qs=null,fa=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||Bx||(Bx=!0,hk(mt,function(){return _h(),null})),Q=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||Q){Q=eo.transition,eo.transition=null;var de=Hr;Hr=1;var je=Vr;Vr|=4,_v.current=null,mP(u,S),ZS(S,u),od(tg),Ff=!!eg,tg=eg=null,u.current=S,pP(S),Be(),Vr=je,Hr=de,eo.transition=Q}else u.current=S;if(Bx&&(Bx=!1,hu=u,Ux=U),Q=u.pendingLanes,Q===0&&(fu=null),er(S.stateNode),mi(u,be()),h!==null)for(F=u.onRecoverableError,S=0;S<h.length;S++)U=h[S],F(U.value,{componentStack:U.stack,digest:U.digest});if(Lx)throw Lx=!1,u=kv,kv=null,u;return(Ux&1)!==0&&u.tag!==0&&_h(),Q=u.pendingLanes,(Q&1)!==0?u===Cv?_g++:(_g=0,Cv=u):_g=0,ol(),null}function _h(){if(hu!==null){var u=Zu(Ux),h=eo.transition,S=Hr;try{if(eo.transition=null,Hr=16>u?16:u,hu===null)var F=!1;else{if(u=hu,hu=null,Ux=0,(Vr&6)!==0)throw Error(r(331));var U=Vr;for(Vr|=4,nr=u.current;nr!==null;){var Q=nr,de=Q.child;if((nr.flags&16)!==0){var je=Q.deletions;if(je!==null){for(var Re=0;Re<je.length;Re++){var st=je[Re];for(nr=st;nr!==null;){var Nt=nr;switch(Nt.tag){case 0:case 11:case 15:yg(8,Nt,Q)}var Ft=Nt.child;if(Ft!==null)Ft.return=Nt,nr=Ft;else for(;nr!==null;){Nt=nr;var Et=Nt.sibling,Zt=Nt.return;if(qS(Nt),Nt===st){nr=null;break}if(Et!==null){Et.return=Zt,nr=Et;break}nr=Zt}}}var sr=Q.alternate;if(sr!==null){var ar=sr.child;if(ar!==null){sr.child=null;do{var fs=ar.sibling;ar.sibling=null,ar=fs}while(ar!==null)}}nr=Q}}if((Q.subtreeFlags&2064)!==0&&de!==null)de.return=Q,nr=de;else e:for(;nr!==null;){if(Q=nr,(Q.flags&2048)!==0)switch(Q.tag){case 0:case 11:case 15:yg(9,Q,Q.return)}var Ke=Q.sibling;if(Ke!==null){Ke.return=Q.return,nr=Ke;break e}nr=Q.return}}var Me=u.current;for(nr=Me;nr!==null;){de=nr;var Qe=de.child;if((de.subtreeFlags&2064)!==0&&Qe!==null)Qe.return=de,nr=Qe;else e:for(de=Me;nr!==null;){if(je=nr,(je.flags&2048)!==0)try{switch(je.tag){case 0:case 11:case 15:Ix(9,je)}}catch(ir){Yn(je,je.return,ir)}if(je===de){nr=null;break e}var Dt=je.sibling;if(Dt!==null){Dt.return=je.return,nr=Dt;break e}nr=je.return}}if(Vr=U,ol(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(Ar,u)}catch{}F=!0}return F}finally{Hr=S,eo.transition=h}}return!1}function uk(u,h,S){h=ic(S,h),h=Rx(u,h,1),u=Ji(u,h,1),h=Za(),u!==null&&(Il(u,1,h),mi(u,h))}function Yn(u,h,S){if(u.tag===3)uk(u,u,S);else for(;h!==null;){if(h.tag===3){uk(h,u,S);break}else if(h.tag===1){var F=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof F.componentDidCatch=="function"&&(fu===null||!fu.has(F))){u=ic(S,u),u=m(h,u,1),h=Ji(h,u,1),u=Za(),h!==null&&(Il(h,1,u),mi(h,u));break}}h=h.return}}function bP(u,h,S){var F=u.pingCache;F!==null&&F.delete(h),h=Za(),u.pingedLanes|=u.suspendedLanes&S,qs===u&&(fa&S)===S&&(Ds===4||Ds===3&&(fa&130023424)===fa&&500>be()-Sv?Td(u,0):bv|=S),mi(u,h)}function dk(u,h){h===0&&((u.mode&1)===0?h=1:(h=Dr,Dr<<=1,(Dr&130023424)===0&&(Dr=4194304)));var S=Za();u=Qa(u,h),u!==null&&(Il(u,h,S),mi(u,S))}function SP(u){var h=u.memoizedState,S=0;h!==null&&(S=h.retryLane),dk(u,S)}function kP(u,h){var S=0;switch(u.tag){case 13:var F=u.stateNode,U=u.memoizedState;U!==null&&(S=U.retryLane);break;case 19:F=u.stateNode;break;default:throw Error(r(314))}F!==null&&F.delete(h),dk(u,S)}var fk;fk=function(u,h,S){if(u!==null)if(u.memoizedProps!==h.pendingProps||Ws.current)ne=!0;else{if((u.lanes&S)===0&&(h.flags&128)===0)return ne=!1,mv(u,h,S);ne=(u.flags&131072)!==0}else ne=!1,en&&(h.flags&1048576)!==0&&bx(h,cl,h.index);switch(h.lanes=0,h.tag){case 2:var F=h.type;Ur(u,h),u=h.pendingProps;var U=Ql(h,Ps.current);No(h,S),U=nu(null,h,F,u,U,S);var Q=su();return h.flags|=1,typeof U=="object"&&U!==null&&typeof U.render=="function"&&U.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,zs(F)?(Q=!0,Jl(h)):Q=!1,h.memoizedState=U.state!==null&&U.state!==void 0?U.state:null,wd(h),U.updater=cu,h.stateNode=U,U._reactInternals=h,ph(h,F,u,S),h=tn(null,h,F,!0,Q,S)):(h.tag=0,en&&Q&&Xc(h),xe(null,h,U,S),h=h.child),h;case 16:F=h.elementType;e:{switch(Ur(u,h),u=h.pendingProps,U=F._init,F=U(F._payload),h.type=F,U=h.tag=TP(F),u=Rs(F,u),U){case 0:h=Yt(null,h,F,u,S);break e;case 1:h=pn(null,h,F,u,S);break e;case 11:h=Ue(null,h,F,u,S);break e;case 14:h=it(null,h,F,Rs(F.type,u),S);break e}throw Error(r(306,F,""))}return h;case 0:return F=h.type,U=h.pendingProps,U=h.elementType===F?U:Rs(F,U),Yt(u,h,F,U,S);case 1:return F=h.type,U=h.pendingProps,U=h.elementType===F?U:Rs(F,U),pn(u,h,F,U,S);case 3:e:{if(ua(h),u===null)throw Error(r(387));F=h.pendingProps,Q=h.memoizedState,U=Q.element,oh(u,h),Zc(h,F,null,S);var de=h.memoizedState;if(F=de.element,Q.isDehydrated)if(Q={element:F,isDehydrated:!1,cache:de.cache,pendingSuspenseBoundaries:de.pendingSuspenseBoundaries,transitions:de.transitions},h.updateQueue.baseState=Q,h.memoizedState=Q,h.flags&256){U=ic(Error(r(423)),h),h=Zi(u,h,F,S,U);break e}else if(F!==U){U=ic(Error(r(424)),h),h=Zi(u,h,F,S,U);break e}else for(Gt=Gi(h.stateNode.containerInfo.firstChild),qa=h,en=!0,Xa=null,S=fi(h,null,F,S),h.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(rc(),F===U){h=Ks(u,h,S);break e}xe(u,h,F,S)}h=h.child}return h;case 5:return eu(h),u===null&&Yc(h),F=h.type,U=h.pendingProps,Q=u!==null?u.memoizedProps:null,de=U.children,rg(F,U)?de=null:Q!==null&&rg(F,Q)&&(h.flags|=32),br(u,h),xe(u,h,de,S),h.child;case 6:return u===null&&Yc(h),null;case 13:return ft(u,h,S);case 4:return dl(h,h.stateNode.containerInfo),F=h.pendingProps,u===null?h.child=nc(h,null,F,S):xe(u,h,F,S),h.child;case 11:return F=h.type,U=h.pendingProps,U=h.elementType===F?U:Rs(F,U),Ue(u,h,F,U,S);case 7:return xe(u,h,h.pendingProps,S),h.child;case 8:return xe(u,h,h.pendingProps.children,S),h.child;case 12:return xe(u,h,h.pendingProps.children,S),h.child;case 10:e:{if(F=h.type._context,U=h.pendingProps,Q=h.memoizedProps,de=U.value,sn(yd,F._currentValue),F._currentValue=de,Q!==null)if(Ca(Q.value,de)){if(Q.children===U.children&&!Ws.current){h=Ks(u,h,S);break e}}else for(Q=h.child,Q!==null&&(Q.return=h);Q!==null;){var je=Q.dependencies;if(je!==null){de=Q.child;for(var Re=je.firstContext;Re!==null;){if(Re.context===F){if(Q.tag===1){Re=Qi(-1,S&-S),Re.tag=2;var st=Q.updateQueue;if(st!==null){st=st.shared;var Nt=st.pending;Nt===null?Re.next=Re:(Re.next=Nt.next,Nt.next=Re),st.pending=Re}}Q.lanes|=S,Re=Q.alternate,Re!==null&&(Re.lanes|=S),ih(Q.return,S,h),je.lanes|=S;break}Re=Re.next}}else if(Q.tag===10)de=Q.type===h.type?null:Q.child;else if(Q.tag===18){if(de=Q.return,de===null)throw Error(r(341));de.lanes|=S,je=de.alternate,je!==null&&(je.lanes|=S),ih(de,S,h),de=Q.sibling}else de=Q.child;if(de!==null)de.return=Q;else for(de=Q;de!==null;){if(de===h){de=null;break}if(Q=de.sibling,Q!==null){Q.return=de.return,de=Q;break}de=de.return}Q=de}xe(u,h,U.children,S),h=h.child}return h;case 9:return U=h.type,F=h.pendingProps.children,No(h,S),U=la(U),F=F(U),h.flags|=1,xe(u,h,F,S),h.child;case 14:return F=h.type,U=Rs(F,h.pendingProps),U=Rs(F.type,U),it(u,h,F,U,S);case 15:return Pt(u,h,h.type,h.pendingProps,S);case 17:return F=h.type,U=h.pendingProps,U=h.elementType===F?U:Rs(F,U),Ur(u,h),h.tag=1,zs(F)?(u=!0,Jl(h)):u=!1,No(h,S),Px(h,F,U),ph(h,F,U,S),tn(null,h,F,!0,u,S);case 19:return ds(u,h,S);case 22:return rr(u,h,S)}throw Error(r(156,h.tag))};function hk(u,h){return ce(u,h)}function CP(u,h,S,F){this.tag=u,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=F,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function to(u,h,S,F){return new CP(u,h,S,F)}function Fv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function TP(u){if(typeof u=="function")return Fv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===X)return 11;if(u===q)return 14}return 2}function pu(u,h){var S=u.alternate;return S===null?(S=to(u.tag,h,u.key,u.mode),S.elementType=u.elementType,S.type=u.type,S.stateNode=u.stateNode,S.alternate=u,u.alternate=S):(S.pendingProps=h,S.type=u.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=u.flags&14680064,S.childLanes=u.childLanes,S.lanes=u.lanes,S.child=u.child,S.memoizedProps=u.memoizedProps,S.memoizedState=u.memoizedState,S.updateQueue=u.updateQueue,h=u.dependencies,S.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},S.sibling=u.sibling,S.index=u.index,S.ref=u.ref,S}function Hx(u,h,S,F,U,Q){var de=2;if(F=u,typeof u=="function")Fv(u)&&(de=1);else if(typeof u=="string")de=5;else e:switch(u){case R:return Nd(S.children,U,Q,h);case T:de=8,U|=8;break;case D:return u=to(12,S,h,U|2),u.elementType=D,u.lanes=Q,u;case Z:return u=to(13,S,h,U),u.elementType=Z,u.lanes=Q,u;case oe:return u=to(19,S,h,U),u.elementType=oe,u.lanes=Q,u;case M:return Gx(S,U,Q,h);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case I:de=10;break e;case K:de=9;break e;case X:de=11;break e;case q:de=14;break e;case re:de=16,F=null;break e}throw Error(r(130,u==null?u:typeof u,""))}return h=to(de,S,h,U),h.elementType=u,h.type=F,h.lanes=Q,h}function Nd(u,h,S,F){return u=to(7,u,F,h),u.lanes=S,u}function Gx(u,h,S,F){return u=to(22,u,F,h),u.elementType=M,u.lanes=S,u.stateNode={isHidden:!1},u}function Pv(u,h,S){return u=to(6,u,null,h),u.lanes=S,u}function Rv(u,h,S){return h=to(4,u.children!==null?u.children:[],u.key,h),h.lanes=S,h.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},h}function EP(u,h,S,F,U){this.tag=h,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$s(0),this.expirationTimes=$s(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$s(0),this.identifierPrefix=F,this.onRecoverableError=U,this.mutableSourceEagerHydrationData=null}function Dv(u,h,S,F,U,Q,de,je,Re){return u=new EP(u,h,S,je,Re),h===1?(h=1,Q===!0&&(h|=8)):h=0,Q=to(3,null,null,h),u.current=Q,Q.stateNode=u,Q.memoizedState={element:F,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},wd(Q),u}function NP(u,h,S){var F=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:P,key:F==null?null:""+F,children:u,containerInfo:h,implementation:S}}function gk(u){if(!u)return Ki;u=u._reactInternals;e:{if(Ee(u)!==u||u.tag!==1)throw Error(r(170));var h=u;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(zs(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(r(171))}if(u.tag===1){var S=u.type;if(zs(S))return Zf(u,S,h)}return h}function mk(u,h,S,F,U,Q,de,je,Re){return u=Dv(S,F,!0,u,U,Q,de,je,Re),u.context=gk(null),S=u.current,F=Za(),U=gu(S),Q=Qi(F,U),Q.callback=h??null,Ji(S,Q,U),u.current.lanes=U,Il(u,U,F),mi(u,F),u}function Vx(u,h,S,F){var U=h.current,Q=Za(),de=gu(U);return S=gk(S),h.context===null?h.context=S:h.pendingContext=S,h=Qi(Q,de),h.payload={element:u},F=F===void 0?null:F,F!==null&&(h.callback=F),u=Ji(U,h,de),u!==null&&(Do(u,U,de,Q),lh(u,U,de)),de}function Kx(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function pk(u,h){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var S=u.retryLane;u.retryLane=S!==0&&S<h?S:h}}function Iv(u,h){pk(u,h),(u=u.alternate)&&pk(u,h)}function AP(){return null}var xk=typeof reportError=="function"?reportError:function(u){console.error(u)};function Mv(u){this._internalRoot=u}qx.prototype.render=Mv.prototype.render=function(u){var h=this._internalRoot;if(h===null)throw Error(r(409));Vx(u,h,null,null)},qx.prototype.unmount=Mv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var h=u.containerInfo;Cd(function(){Vx(null,u,null,null)}),h[Vi]=null}};function qx(u){this._internalRoot=u}qx.prototype.unstable_scheduleHydration=function(u){if(u){var h=Zp();u={blockedOn:null,target:u,priority:h};for(var S=0;S<Hi.length&&h!==0&&h<Hi[S].priority;S++);Hi.splice(S,0,u),S===0&&Nf(u)}};function Ov(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function Xx(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function yk(){}function jP(u,h,S,F,U){if(U){if(typeof F=="function"){var Q=F;F=function(){var st=Kx(de);Q.call(st)}}var de=mk(h,F,u,0,null,!1,!1,"",yk);return u._reactRootContainer=de,u[Vi]=de.current,Vl(u.nodeType===8?u.parentNode:u),Cd(),de}for(;U=u.lastChild;)u.removeChild(U);if(typeof F=="function"){var je=F;F=function(){var st=Kx(Re);je.call(st)}}var Re=Dv(u,0,!1,null,null,!1,!1,"",yk);return u._reactRootContainer=Re,u[Vi]=Re.current,Vl(u.nodeType===8?u.parentNode:u),Cd(function(){Vx(h,Re,S,F)}),Re}function Yx(u,h,S,F,U){var Q=S._reactRootContainer;if(Q){var de=Q;if(typeof U=="function"){var je=U;U=function(){var Re=Kx(de);je.call(Re)}}Vx(h,de,u,U)}else de=jP(S,h,u,U,F);return Kx(de)}Pc=function(u){switch(u.tag){case 3:var h=u.stateNode;if(h.current.memoizedState.isDehydrated){var S=_r(h.pendingLanes);S!==0&&(R0(h,S|1),mi(h,be()),(Vr&6)===0&&(wh=be()+500,ol()))}break;case 13:Cd(function(){var F=Qa(u,1);if(F!==null){var U=Za();Do(F,u,1,U)}}),Iv(u,1)}},Rc=function(u){if(u.tag===13){var h=Qa(u,134217728);if(h!==null){var S=Za();Do(h,u,134217728,S)}Iv(u,134217728)}},Jp=function(u){if(u.tag===13){var h=gu(u),S=Qa(u,h);if(S!==null){var F=Za();Do(S,u,h,F)}Iv(u,h)}},Zp=function(){return Hr},Tf=function(u,h){var S=Hr;try{return Hr=u,h()}finally{Hr=S}},Ae=function(u,h,S){switch(h){case"input":if(Ve(u,S),h=S.name,S.type==="radio"&&h!=null){for(S=u;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<S.length;h++){var F=S[h];if(F!==u&&F.form===u.form){var U=ws(F);if(!U)throw Error(r(90));fe(F),Ve(F,U)}}}break;case"textarea":ht(u,S);break;case"select":h=S.value,h!=null&&De(u,!!S.multiple,h,!1)}},ct=Nv,zt=Cd;var FP={usingClientEntryPoint:!1,Events:[gd,ls,ws,$e,St,Nv]},bg={findFiberByHostInstance:al,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PP={bundleType:bg.bundleType,version:bg.version,rendererPackageName:bg.rendererPackageName,rendererConfig:bg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=le(u),u===null?null:u.stateNode},findFiberByHostInstance:bg.findFiberByHostInstance||AP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qx=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qx.isDisabled&&Qx.supportsFiber)try{Ar=Qx.inject(PP),hr=Qx}catch{}}return pi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=FP,pi.createPortal=function(u,h){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ov(h))throw Error(r(200));return NP(u,h,null,S)},pi.createRoot=function(u,h){if(!Ov(u))throw Error(r(299));var S=!1,F="",U=xk;return h!=null&&(h.unstable_strictMode===!0&&(S=!0),h.identifierPrefix!==void 0&&(F=h.identifierPrefix),h.onRecoverableError!==void 0&&(U=h.onRecoverableError)),h=Dv(u,1,!1,null,null,S,!1,F,U),u[Vi]=h.current,Vl(u.nodeType===8?u.parentNode:u),new Mv(h)},pi.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var h=u._reactInternals;if(h===void 0)throw typeof u.render=="function"?Error(r(188)):(u=Object.keys(u).join(","),Error(r(268,u)));return u=le(h),u=u===null?null:u.stateNode,u},pi.flushSync=function(u){return Cd(u)},pi.hydrate=function(u,h,S){if(!Xx(h))throw Error(r(200));return Yx(null,u,h,!0,S)},pi.hydrateRoot=function(u,h,S){if(!Ov(u))throw Error(r(405));var F=S!=null&&S.hydratedSources||null,U=!1,Q="",de=xk;if(S!=null&&(S.unstable_strictMode===!0&&(U=!0),S.identifierPrefix!==void 0&&(Q=S.identifierPrefix),S.onRecoverableError!==void 0&&(de=S.onRecoverableError)),h=mk(h,null,u,1,S??null,U,!1,Q,de),u[Vi]=h.current,Vl(u),F)for(u=0;u<F.length;u++)S=F[u],U=S._getVersion,U=U(S._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[S,U]:h.mutableSourceEagerHydrationData.push(S,U);return new qx(h)},pi.render=function(u,h,S){if(!Xx(h))throw Error(r(200));return Yx(null,u,h,!1,S)},pi.unmountComponentAtNode=function(u){if(!Xx(u))throw Error(r(40));return u._reactRootContainer?(Cd(function(){Yx(null,null,u,!1,function(){u._reactRootContainer=null,u[Vi]=null})}),!0):!1},pi.unstable_batchedUpdates=Nv,pi.unstable_renderSubtreeIntoContainer=function(u,h,S,F){if(!Xx(S))throw Error(r(200));if(u==null||u._reactInternals===void 0)throw Error(r(38));return Yx(u,h,S,!1,F)},pi.version="18.3.1-next-f1338f8080-20240426",pi}var Tk;function T3(){if(Tk)return Uv.exports;Tk=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Uv.exports=UP(),Uv.exports}var Ek;function $P(){if(Ek)return Jx;Ek=1;var e=T3();return Jx.createRoot=e.createRoot,Jx.hydrateRoot=e.hydrateRoot,Jx}var WP=$P();const zP=_p(WP);var Nk=T3();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zm(){return zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},zm.apply(this,arguments)}var Su;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Su||(Su={}));const Ak="popstate";function HP(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Zw("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:N3(s)}return VP(t,r,null,e)}function Ns(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function E3(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function GP(){return Math.random().toString(36).substr(2,8)}function jk(e,t){return{usr:e.state,key:e.key,idx:t}}function Zw(e,t,r,n){return r===void 0&&(r=null),zm({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?h0(t):t,{state:r,key:t&&t.key||n||GP()})}function N3(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function h0(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function VP(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Su.Pop,c=null,d=f();d==null&&(d=0,i.replaceState(zm({},i.state,{idx:d}),""));function f(){return(i.state||{idx:null}).idx}function p(){o=Su.Pop;let b=f(),E=b==null?null:b-d;d=b,c&&c({action:o,location:w.location,delta:E})}function g(b,E){o=Su.Push;let k=Zw(w.location,b,E);d=f()+1;let _=jk(k,d),N=w.createHref(k);try{i.pushState(_,"",N)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;s.location.assign(N)}a&&c&&c({action:o,location:w.location,delta:1})}function y(b,E){o=Su.Replace;let k=Zw(w.location,b,E);d=f();let _=jk(k,d),N=w.createHref(k);i.replaceState(_,"",N),a&&c&&c({action:o,location:w.location,delta:0})}function v(b){let E=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof b=="string"?b:N3(b);return k=k.replace(/ $/,"%20"),Ns(E,"No window.location.(origin|href) available to create URL for href: "+k),new URL(k,E)}let w={get action(){return o},get location(){return e(s,i)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Ak,p),c=b,()=>{s.removeEventListener(Ak,p),c=null}},createHref(b){return t(s,b)},createURL:v,encodeLocation(b){let E=v(b);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:y,go(b){return i.go(b)}};return w}var Fk;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Fk||(Fk={}));function KP(e,t,r){return r===void 0&&(r="/"),qP(e,t,r)}function qP(e,t,r,n){let s=typeof t=="string"?h0(t):t,a=F3(s.pathname||"/",r);if(a==null)return null;let i=A3(e);XP(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let d=oR(a);o=sR(i[c],d)}return o}function A3(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Ns(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let d=Ud([n,c.relativePath]),f=r.concat(c);a.children&&a.children.length>0&&(Ns(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),A3(a.children,t,f,d)),!(a.path==null&&!a.index)&&t.push({path:d,score:rR(d,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of j3(a.path))s(a,i,c)}),t}function j3(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=j3(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function XP(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:nR(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const YP=/^:[\w-]+$/,QP=3,JP=2,ZP=1,eR=10,tR=-2,Pk=e=>e==="*";function rR(e,t){let r=e.split("/"),n=r.length;return r.some(Pk)&&(n+=tR),t&&(n+=JP),r.filter(s=>!Pk(s)).reduce((s,a)=>s+(YP.test(a)?QP:a===""?ZP:eR),n)}function nR(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function sR(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],d=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",p=aR({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},f),g=c.route;if(!p)return null;Object.assign(s,p.params),i.push({params:s,pathname:Ud([a,p.pathname]),pathnameBase:dR(Ud([a,p.pathnameBase])),route:g}),p.pathnameBase!=="/"&&(a=Ud([a,p.pathnameBase]))}return i}function aR(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=iR(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((d,f,p)=>{let{paramName:g,isOptional:y}=f;if(g==="*"){let w=o[p]||"";i=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const v=o[p];return y&&!v?d[g]=void 0:d[g]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:i,pattern:e}}function iR(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),E3(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function oR(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return E3(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function F3(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function lR(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?h0(e):e;return{pathname:r?r.startsWith("/")?r:cR(r,t):t,search:fR(n),hash:hR(s)}}function cR(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function zv(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function uR(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function P3(e,t){let r=uR(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function R3(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=h0(e):(s=zm({},e),Ns(!s.pathname||!s.pathname.includes("?"),zv("?","pathname","search",s)),Ns(!s.pathname||!s.pathname.includes("#"),zv("#","pathname","hash",s)),Ns(!s.search||!s.search.includes("#"),zv("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let p=t.length-1;if(!n&&i.startsWith("..")){let g=i.split("/");for(;g[0]==="..";)g.shift(),p-=1;s.pathname=g.join("/")}o=p>=0?t[p]:"/"}let c=lR(s,o),d=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(d||f)&&(c.pathname+="/"),c}const Ud=e=>e.join("/").replace(/\/\/+/g,"/"),dR=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),fR=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,hR=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function gR(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const D3=["post","put","patch","delete"];new Set(D3);const mR=["get",...D3];new Set(mR);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Hm(){return Hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hm.apply(this,arguments)}const v2=C.createContext(null),pR=C.createContext(null),bp=C.createContext(null),Cy=C.createContext(null),zu=C.createContext({outlet:null,matches:[],isDataRoute:!1}),I3=C.createContext(null);function Sp(){return C.useContext(Cy)!=null}function Ty(){return Sp()||Ns(!1),C.useContext(Cy).location}function M3(e){C.useContext(bp).static||C.useLayoutEffect(e)}function Ti(){let{isDataRoute:e}=C.useContext(zu);return e?AR():xR()}function xR(){Sp()||Ns(!1);let e=C.useContext(v2),{basename:t,future:r,navigator:n}=C.useContext(bp),{matches:s}=C.useContext(zu),{pathname:a}=Ty(),i=JSON.stringify(P3(s,r.v7_relativeSplatPath)),o=C.useRef(!1);return M3(()=>{o.current=!0}),C.useCallback(function(d,f){if(f===void 0&&(f={}),!o.current)return;if(typeof d=="number"){n.go(d);return}let p=R3(d,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Ud([t,p.pathname])),(f.replace?n.replace:n.push)(p,f.state,f)},[t,n,i,a,e])}function Ey(){let{matches:e}=C.useContext(zu),t=e[e.length-1];return t?t.params:{}}function yR(e,t){return vR(e,t)}function vR(e,t,r,n){Sp()||Ns(!1);let{navigator:s}=C.useContext(bp),{matches:a}=C.useContext(zu),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let d=Ty(),f;if(t){var p;let b=typeof t=="string"?h0(t):t;c==="/"||(p=b.pathname)!=null&&p.startsWith(c)||Ns(!1),f=b}else f=d;let g=f.pathname||"/",y=g;if(c!=="/"){let b=c.replace(/^\//,"").split("/");y="/"+g.replace(/^\//,"").split("/").slice(b.length).join("/")}let v=KP(e,{pathname:y}),w=kR(v&&v.map(b=>Object.assign({},b,{params:Object.assign({},o,b.params),pathname:Ud([c,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Ud([c,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,r,n);return t&&w?C.createElement(Cy.Provider,{value:{location:Hm({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:Su.Pop}},w):w}function wR(){let e=NR(),t=gR(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},t),r?C.createElement("pre",{style:s},r):null,null)}const _R=C.createElement(wR,null);class bR extends C.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?C.createElement(zu.Provider,{value:this.props.routeContext},C.createElement(I3.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function SR(e){let{routeContext:t,match:r,children:n}=e,s=C.useContext(v2);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),C.createElement(zu.Provider,{value:t},n)}function kR(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(p=>p.route.id&&o?.[p.route.id]!==void 0);f>=0||Ns(!1),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,d=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let p=i[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=f),p.route.id){let{loaderData:g,errors:y}=r,v=p.route.loader&&g[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||v){c=!0,d>=0?i=i.slice(0,d+1):i=[i[0]];break}}}return i.reduceRight((f,p,g)=>{let y,v=!1,w=null,b=null;r&&(y=o&&p.route.id?o[p.route.id]:void 0,w=p.route.errorElement||_R,c&&(d<0&&g===0?(jR("route-fallback"),v=!0,b=null):d===g&&(v=!0,b=p.route.hydrateFallbackElement||null)));let E=t.concat(i.slice(0,g+1)),k=()=>{let _;return y?_=w:v?_=b:p.route.Component?_=C.createElement(p.route.Component,null):p.route.element?_=p.route.element:_=f,C.createElement(SR,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:r!=null},children:_})};return r&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?C.createElement(bR,{location:r.location,revalidation:r.revalidation,component:w,error:y,children:k(),routeContext:{outlet:null,matches:E,isDataRoute:!0}}):k()},null)}var O3=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(O3||{}),L3=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(L3||{});function CR(e){let t=C.useContext(v2);return t||Ns(!1),t}function TR(e){let t=C.useContext(pR);return t||Ns(!1),t}function ER(e){let t=C.useContext(zu);return t||Ns(!1),t}function B3(e){let t=ER(),r=t.matches[t.matches.length-1];return r.route.id||Ns(!1),r.route.id}function NR(){var e;let t=C.useContext(I3),r=TR(),n=B3();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function AR(){let{router:e}=CR(O3.UseNavigateStable),t=B3(L3.UseNavigateStable),r=C.useRef(!1);return M3(()=>{r.current=!0}),C.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Hm({fromRouteId:t},a)))},[e,t])}const Rk={};function jR(e,t,r){Rk[e]||(Rk[e]=!0)}function FR(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function t0(e){let{to:t,replace:r,state:n,relative:s}=e;Sp()||Ns(!1);let{future:a,static:i}=C.useContext(bp),{matches:o}=C.useContext(zu),{pathname:c}=Ty(),d=Ti(),f=R3(t,P3(o,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(f);return C.useEffect(()=>d(JSON.parse(p),{replace:r,state:n,relative:s}),[d,p,s,r,n]),null}function ts(e){Ns(!1)}function PR(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Su.Pop,navigator:a,static:i=!1,future:o}=e;Sp()&&Ns(!1);let c=t.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:c,navigator:a,static:i,future:Hm({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=h0(n));let{pathname:f="/",search:p="",hash:g="",state:y=null,key:v="default"}=n,w=C.useMemo(()=>{let b=F3(f,c);return b==null?null:{location:{pathname:b,search:p,hash:g,state:y,key:v},navigationType:s}},[c,f,p,g,y,v,s]);return w==null?null:C.createElement(bp.Provider,{value:d},C.createElement(Cy.Provider,{children:r,value:w}))}function w2(e){let{children:t,location:r}=e;return yR(e_(t),r)}new Promise(()=>{});function e_(e,t){t===void 0&&(t=[]);let r=[];return C.Children.forEach(e,(n,s)=>{if(!C.isValidElement(n))return;let a=[...t,s];if(n.type===C.Fragment){r.push.apply(r,e_(n.props.children,a));return}n.type!==ts&&Ns(!1),!n.props.index||!n.props.children||Ns(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=e_(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const RR="6";try{window.__reactRouterVersion=RR}catch{}const DR="startTransition",Dk=LP[DR];function IR(e){let{basename:t,children:r,future:n,window:s}=e,a=C.useRef();a.current==null&&(a.current=HP({window:s,v5Compat:!0}));let i=a.current,[o,c]=C.useState({action:i.action,location:i.location}),{v7_startTransition:d}=n||{},f=C.useCallback(p=>{d&&Dk?Dk(()=>c(p)):c(p)},[c,d]);return C.useLayoutEffect(()=>i.listen(f),[i,f]),C.useEffect(()=>FR(n),[n]),C.createElement(PR,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}var Ik;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ik||(Ik={}));var Mk;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Mk||(Mk={}));const Fn={student_subjects:1800*1e3,student_active_tests:600*1e3,student_results_table:600*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3},En=e=>{try{const t=localStorage.getItem(e);if(!t)return console.log(" Cache: No data found for key:",e),null;const{data:r,timestamp:n,ttl:s}=JSON.parse(t),a=Date.now()-n;return a>s?(console.log(" Cache: Data expired for key:",e,"age:",a,"ttl:",s),localStorage.removeItem(e),null):(console.log(" Cache: Data found for key:",e,"age:",a,"ttl:",s),r)}catch(t){return console.log(" Cache: Corrupted data for key:",e,t),localStorage.removeItem(e),null}},Nn=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),U3();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:r})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},U3=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:c}=JSON.parse(o);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},_2=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},g0=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;localStorage.removeItem(n),localStorage.removeItem(s),console.log(`Cleared test data for ${t}_${r}`)},b2=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:Fn,cleanupOldData:U3,clearTestData:g0,clearUserData:_2,getCachedData:En,setCachedData:Nn},Symbol.toStringTag,{value:"Module"})),$3=C.createContext(),W3=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState(null),[a,i]=C.useState(localStorage.getItem("token")),[o,c]=C.useState(!1),[d,f]=C.useState(!0),[p,g]=C.useState(null);C.useEffect(()=>{console.log("[AUTH] Initializing application session..."),b()},[]),C.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let H=!1;const O=setInterval(async()=>{if(o&&a&&!H){H=!0;try{const z=a||localStorage.getItem("auth_token");if(z&&y(z))console.log("[AUTH] Token expired, attempting refresh..."),await v()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(z)try{const J=JSON.parse(atob(z.split(".")[1])).exp*1e3,te=Date.now(),ee=J-te;ee<300*1e3&&ee>0&&(console.log(`[AUTH] Token expires in ${Math.round(ee/1e3)} seconds, refreshing...`),await v()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(Y){console.error("[AUTH] Error parsing token for expiration check:",Y)}}catch(z){console.error("[AUTH] Error in proactive refresh:",z)}finally{H=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(O)}}},[o,a]);const y=H=>{if(!H)return!0;try{const O=JSON.parse(atob(H.split(".")[1])),z=Date.now()/1e3;return O.exp<=z}catch(O){return console.error("[AUTH] Error decoding token:",O),!0}},v=async()=>{const H=localStorage.getItem("refresh_token");if(!H)return console.log("[AUTH] No refresh token found"),!1;try{const O=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:H})});if(O.ok){const z=await O.json();console.log("[AUTH] Token refresh successful"),localStorage.setItem("auth_token",z.accessToken),localStorage.setItem("refresh_token",z.refreshToken),localStorage.setItem("accessToken",z.accessToken);try{window.tokenManager&&(window.tokenManager.setToken(z.accessToken),z.refreshToken&&window.tokenManager.setRefreshToken(z.refreshToken))}catch{}return i(z.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",O.status),!1}catch(O){return console.error("[AUTH] Token refresh error:",O),!1}},w=async(H,O={})=>{const z=a||localStorage.getItem("auth_token");if(!z)throw new Error("No authentication token found");const Y={"Content-Type":"application/json",Authorization:`Bearer ${z}`,...O.headers},J=await fetch(H,{...O,headers:Y});if(J.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await v()){const ee=localStorage.getItem("auth_token");return Y.Authorization=`Bearer ${ee}`,fetch(H,{...O,headers:Y})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return J},b=async()=>{try{console.log("[AUTH] Starting session initialization..."),f(!0);const H=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),O=localStorage.getItem("user_data")||localStorage.getItem("userData"),z=O?JSON.parse(O).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!H,hasUser:!!O,role:z}),H&&z&&O)try{const Y=JSON.parse(O);if(y(H))if(console.log("[AUTH] Token expired, attempting refresh..."),await v()){console.log("[AUTH] Token refreshed successfully");const te=localStorage.getItem("auth_token");i(te)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(H);else i(H);s(z),r(Y);try{if(window.tokenManager){window.tokenManager.setToken(localStorage.getItem("auth_token"));const J=localStorage.getItem("refresh_token");J&&window.tokenManager.setRefreshToken(J)}}catch{}c(!0),await _(Y,z)}catch(Y){console.error("[AUTH] Error parsing stored user data:",Y),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(H){console.error("[AUTH] Session initialization error:",H),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),f(!1)}},E=async H=>{try{if(f(!0),g(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),g("Please wait for the logout process to complete.");return}console.log("Attempting login with:",H.username);let O,z;H.username==="admin"?(O={ok:!0,json:()=>({success:!0,token:"test-token"})},z="admin"):(O=await authService.teacherLogin(H),z="teacher");const Y=await O.json();await k(O,z,Y)}catch(O){T(O)}finally{f(!1)}},k=async(H,O,z)=>{try{if(H.ok&&z.success&&z.token){i(z.token),s(O),r(z),c(!0),localStorage.setItem("auth_token",z.accessToken||z.token),localStorage.setItem("refresh_token",z.refreshToken),localStorage.setItem("user_data",JSON.stringify(z)),localStorage.setItem("accessToken",z.accessToken||z.token);try{const Y=Date.now(),J=10080*60*1e3,te=[];for(let ee=0;ee<localStorage.length;ee++){const ie=localStorage.key(ee);if(!(!ie||!(ie.startsWith("test_progress_")||ie.startsWith("test_timer_")||ie.startsWith("test_shuffle_order_")||ie.startsWith("student_results_table_")||ie.startsWith("anti_cheating_"))))try{const Ce=localStorage.getItem(ie);if(!Ce){te.push(ie);continue}let Oe=null;if(Ce.startsWith("{")||Ce.startsWith("[")){const fe=JSON.parse(Ce),pe=fe.timestamp||fe.lastSaved||fe.lastTickAt||fe.createdAt||fe.updatedAt||fe.startedAt||fe.started_at;pe&&(Oe=new Date(pe).getTime())}if(!Oe){const fe=`${ie}__ts`,pe=localStorage.getItem(fe);pe&&(Oe=parseInt(pe)||null)}if(!Oe)continue;Y-Oe>J&&te.push(ie)}catch{}}te.forEach(ee=>{try{localStorage.removeItem(ee)}catch{}})}catch(Y){console.warn("LocalStorage cleanup skipped:",Y)}return await _(z,O),!0}else{const Y=z.message||H.statusText||"Login failed";return T(new Error(Y)),!1}}catch(Y){return T(Y),!1}},_=async(H,O)=>{try{switch(O){case"admin":console.log("Admin login successful, role:",H.role),console.log("Admin logged in:",H);break;case"teacher":console.log("Teacher login successful, role:",H.role),console.log("Teacher data:",H.teacher),await A(H),await R();break;case"student":console.log("Student login successful"),N(H);break;default:console.warn("Unknown user role:",O)}}catch(z){console.error("Post-login actions error:",z)}},N=H=>{r(H),console.log("Student info populated:",H)},A=async H=>{r(H),console.log("Teacher info populated:",H)},P=async()=>{try{console.log("Initializing teacher cabinet...")}catch(H){console.error("Error initializing teacher cabinet:",H)}},R=async()=>{try{console.log("Checking teacher subjects...")}catch(H){console.error("Error checking teacher subjects:",H)}},T=H=>{g(H.message||"Login failed"),D()},D=()=>{g(null),f(!1)},I=C.useCallback(()=>{K()},[]),K=()=>{r(null),s(null),i(null),c(!1),g(null);const H=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;H&&_2(H),localStorage.removeItem("token"),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("auth_token"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&window.tokenManager.clearAuth(),setTimeout(()=>{X()},100)},X=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},Z=()=>t?.id||null,oe=()=>n==="admin"?t:null,q=()=>n==="admin",re=()=>q()?t?.admin_id:null,M=()=>n==="teacher"?t?.username:null,W=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof E,logout:typeof I,getCurrentTeacherId:typeof Z,isAdmin:typeof q,getCurrentAdmin:typeof oe,getCurrentAdminId:typeof re,getCurrentTeacherUsername:typeof M})};C.useEffect(()=>(window.logout=I,window.getCurrentTeacherId=Z,window.getCurrentAdmin=oe,window.isAdmin=q,window.getCurrentAdminId=re,window.getCurrentTeacherUsername=M,window.checkFunctionAvailability=W,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[I]);const B=C.useCallback(H=>{console.log("Setting user data from external auth:",H),r(H),s(H.role),i(H.token),c(!0),f(!1),g(null),localStorage.setItem("auth_token",H.token),localStorage.setItem("user_data",JSON.stringify(H)),localStorage.setItem("accessToken",H.token)},[]),G={user:t,role:n,token:a,isAuthenticated:o,isLoading:d,error:p,login:E,setUserData:B,logout:I,resetLoginForm:D,forceCompleteLogout:K,initializeApplicationSession:b,makeAuthenticatedRequest:w,populateStudentInfo:N,populateTeacherInfo:A,initializeTeacherCabinet:P,checkTeacherSubjects:R,getCurrentTeacherId:Z,getCurrentAdmin:oe,isAdmin:q,getCurrentAdminId:re,getCurrentTeacherUsername:M,handleLoginResponse:k,handlePostLoginActions:_,handleLoginFailure:T,resetInterfaceAfterSessionClear:X,checkFunctionAvailability:W};return l.jsx($3.Provider,{value:G,children:e})},Mn=()=>{const e=C.useContext($3);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class MR{constructor(){this.baseURL="http://localhost:8888/.netlify/functions",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}getHeaders(){const t=localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,s={method:"GET",headers:this.getHeaders(),timeout:this.timeout,...r};let a;for(let i=0;i<this.retryCount;i++)try{const o=new AbortController,c=setTimeout(()=>o.abort(),this.timeout),d=await fetch(n,{...s,signal:o.signal});if(clearTimeout(c),!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(o){if(a=o,o.name==="AbortError")throw new Error("Request timeout");i<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${i+1}/${this.retryCount})`),await new Promise(c=>setTimeout(c,this.retryDelay*Math.pow(2,i))))}throw a}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i={method:"POST",headers:{...localStorage.getItem("token")&&{Authorization:`Bearer ${localStorage.getItem("token")}`}},body:s,...n};try{const o=await fetch(a,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(o){throw o}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,a={method:"GET",headers:this.getHeaders(),...n};try{const i=await fetch(s,a);if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);const o=await i.blob(),c=window.URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(c)}catch(i){throw i}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const Qn=new MR,S2=C.createContext({});function k2(e){const t=C.useRef(null);return t.current===null&&(t.current=e()),t.current}const C2=typeof window<"u",z3=C2?C.useLayoutEffect:C.useEffect,Ny=C.createContext(null);function T2(e,t){e.indexOf(t)===-1&&e.push(t)}function E2(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const bc=(e,t,r)=>r>t?t:r<e?e:r;let N2=()=>{};const Sc={},H3=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function G3(e){return typeof e=="object"&&e!==null}const V3=e=>/^0[^.\s]+$/u.test(e);function A2(e){let t;return()=>(t===void 0&&(t=e()),t)}const go=e=>e,OR=(e,t)=>r=>t(e(r)),kp=(...e)=>e.reduce(OR),Gm=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class j2{constructor(){this.subscriptions=[]}add(t){return T2(this.subscriptions,t),()=>E2(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Tl=e=>e*1e3,El=e=>e/1e3;function K3(e,t){return t?e*(1e3/t):0}const q3=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,LR=1e-7,BR=12;function UR(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=q3(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>LR&&++o<BR);return i}function Cp(e,t,r,n){if(e===t&&r===n)return go;const s=a=>UR(a,0,1,e,r);return a=>a===0||a===1?a:q3(s(a),t,n)}const X3=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Y3=e=>t=>1-e(1-t),Q3=Cp(.33,1.53,.69,.99),F2=Y3(Q3),J3=X3(F2),Z3=e=>(e*=2)<1?.5*F2(e):.5*(2-Math.pow(2,-10*(e-1))),P2=e=>1-Math.sin(Math.acos(e)),e5=Y3(P2),t5=X3(P2),$R=Cp(.42,0,1,1),WR=Cp(0,0,.58,1),r5=Cp(.42,0,.58,1),zR=e=>Array.isArray(e)&&typeof e[0]!="number",n5=e=>Array.isArray(e)&&typeof e[0]=="number",HR={linear:go,easeIn:$R,easeInOut:r5,easeOut:WR,circIn:P2,circInOut:t5,circOut:e5,backIn:F2,backInOut:J3,backOut:Q3,anticipate:Z3},GR=e=>typeof e=="string",Ok=e=>{if(n5(e)){N2(e.length===4);const[t,r,n,s]=e;return Cp(t,r,n,s)}else if(GR(e))return HR[e];return e},Zx=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function VR(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(f){i.has(f)&&(d.schedule(f),e()),f(o)}const d={schedule:(f,p=!1,g=!1)=>{const v=g&&s?r:n;return p&&i.add(f),v.has(f)||v.add(f),f},cancel:f=>{n.delete(f),i.delete(f)},process:f=>{if(o=f,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,d.process(f))}};return d}const KR=40;function s5(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=Zx.reduce((_,N)=>(_[N]=VR(a),_),{}),{setup:o,read:c,resolveKeyframes:d,preUpdate:f,update:p,preRender:g,render:y,postRender:v}=i,w=()=>{const _=Sc.useManualTiming?s.timestamp:performance.now();r=!1,Sc.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(_-s.timestamp,KR),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),c.process(s),d.process(s),f.process(s),p.process(s),g.process(s),y.process(s),v.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(w))},b=()=>{r=!0,n=!0,s.isProcessing||e(w)};return{schedule:Zx.reduce((_,N)=>{const A=i[N];return _[N]=(P,R=!1,T=!1)=>(r||b(),A.schedule(P,R,T)),_},{}),cancel:_=>{for(let N=0;N<Zx.length;N++)i[Zx[N]].cancel(_)},state:s,steps:i}}const{schedule:Bn,cancel:Iu,state:ga,steps:Hv}=s5(typeof requestAnimationFrame<"u"?requestAnimationFrame:go,!0);let T1;function qR(){T1=void 0}const _i={now:()=>(T1===void 0&&_i.set(ga.isProcessing||Sc.useManualTiming?ga.timestamp:performance.now()),T1),set:e=>{T1=e,queueMicrotask(qR)}},a5=e=>t=>typeof t=="string"&&t.startsWith(e),R2=a5("--"),XR=a5("var(--"),D2=e=>XR(e)?YR.test(e.split("/*")[0].trim()):!1,YR=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,m0={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Vm={...m0,transform:e=>bc(0,1,e)},e1={...m0,default:1},Cm=e=>Math.round(e*1e5)/1e5,I2=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function QR(e){return e==null}const JR=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,M2=(e,t)=>r=>!!(typeof r=="string"&&JR.test(r)&&r.startsWith(e)||t&&!QR(r)&&Object.prototype.hasOwnProperty.call(r,t)),i5=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(I2);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},ZR=e=>bc(0,255,e),Gv={...m0,transform:e=>Math.round(ZR(e))},Md={test:M2("rgb","red"),parse:i5("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+Gv.transform(e)+", "+Gv.transform(t)+", "+Gv.transform(r)+", "+Cm(Vm.transform(n))+")"};function eD(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const t_={test:M2("#"),parse:eD,transform:Md.transform},Tp=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),_u=Tp("deg"),Nl=Tp("%"),yr=Tp("px"),tD=Tp("vh"),rD=Tp("vw"),Lk={...Nl,parse:e=>Nl.parse(e)/100,transform:e=>Nl.transform(e*100)},Ih={test:M2("hsl","hue"),parse:i5("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+Nl.transform(Cm(t))+", "+Nl.transform(Cm(r))+", "+Cm(Vm.transform(n))+")"},Ts={test:e=>Md.test(e)||t_.test(e)||Ih.test(e),parse:e=>Md.test(e)?Md.parse(e):Ih.test(e)?Ih.parse(e):t_.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Md.transform(e):Ih.transform(e),getAnimatableNone:e=>{const t=Ts.parse(e);return t.alpha=0,Ts.transform(t)}},nD=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function sD(e){return isNaN(e)&&typeof e=="string"&&(e.match(I2)?.length||0)+(e.match(nD)?.length||0)>0}const o5="number",l5="color",aD="var",iD="var(",Bk="${}",oD=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Km(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(oD,c=>(Ts.test(c)?(n.color.push(a),s.push(l5),r.push(Ts.parse(c))):c.startsWith(iD)?(n.var.push(a),s.push(aD),r.push(c)):(n.number.push(a),s.push(o5),r.push(parseFloat(c))),++a,Bk)).split(Bk);return{values:r,split:o,indexes:n,types:s}}function c5(e){return Km(e).values}function u5(e){const{split:t,types:r}=Km(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===o5?a+=Cm(s[i]):o===l5?a+=Ts.transform(s[i]):a+=s[i]}return a}}const lD=e=>typeof e=="number"?0:Ts.test(e)?Ts.getAnimatableNone(e):e;function cD(e){const t=c5(e);return u5(e)(t.map(lD))}const Mu={test:sD,parse:c5,createTransformer:u5,getAnimatableNone:cD};function Vv(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function uD({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=Vv(c,o,e+1/3),a=Vv(c,o,e),i=Vv(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function L1(e,t){return r=>r>0?t:e}const zn=(e,t,r)=>e+(t-e)*r,Kv=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},dD=[t_,Md,Ih],fD=e=>dD.find(t=>t.test(e));function Uk(e){const t=fD(e);if(!t)return!1;let r=t.parse(e);return t===Ih&&(r=uD(r)),r}const $k=(e,t)=>{const r=Uk(e),n=Uk(t);if(!r||!n)return L1(e,t);const s={...r};return a=>(s.red=Kv(r.red,n.red,a),s.green=Kv(r.green,n.green,a),s.blue=Kv(r.blue,n.blue,a),s.alpha=zn(r.alpha,n.alpha,a),Md.transform(s))},r_=new Set(["none","hidden"]);function hD(e,t){return r_.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function gD(e,t){return r=>zn(e,t,r)}function O2(e){return typeof e=="number"?gD:typeof e=="string"?D2(e)?L1:Ts.test(e)?$k:xD:Array.isArray(e)?d5:typeof e=="object"?Ts.test(e)?$k:mD:L1}function d5(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>O2(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function mD(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=O2(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function pD(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const xD=(e,t)=>{const r=Mu.createTransformer(t),n=Km(e),s=Km(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?r_.has(e)&&!s.values.length||r_.has(t)&&!n.values.length?hD(e,t):kp(d5(pD(n,s),s.values),r):L1(e,t)};function f5(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?zn(e,t,r):O2(e)(e,t)}const yD=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Bn.update(t,r),stop:()=>Iu(t),now:()=>ga.isProcessing?ga.timestamp:_i.now()}},h5=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},B1=2e4;function L2(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<B1;)t+=r,n=e.next(t);return t>=B1?1/0:t}function vD(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(L2(n),B1);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:El(s)}}const wD=5;function g5(e,t,r){const n=Math.max(t-wD,0);return K3(r-e(n),t-n)}const Jn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},qv=.001;function _D({duration:e=Jn.duration,bounce:t=Jn.bounce,velocity:r=Jn.velocity,mass:n=Jn.mass}){let s,a,i=1-t;i=bc(Jn.minDamping,Jn.maxDamping,i),e=bc(Jn.minDuration,Jn.maxDuration,El(e)),i<1?(s=d=>{const f=d*i,p=f*e,g=f-r,y=n_(d,i),v=Math.exp(-p);return qv-g/y*v},a=d=>{const p=d*i*e,g=p*r+r,y=Math.pow(i,2)*Math.pow(d,2)*e,v=Math.exp(-p),w=n_(Math.pow(d,2),i);return(-s(d)+qv>0?-1:1)*((g-y)*v)/w}):(s=d=>{const f=Math.exp(-d*e),p=(d-r)*e+1;return-qv+f*p},a=d=>{const f=Math.exp(-d*e),p=(r-d)*(e*e);return f*p});const o=5/e,c=SD(s,a,o);if(e=Tl(e),isNaN(c))return{stiffness:Jn.stiffness,damping:Jn.damping,duration:e};{const d=Math.pow(c,2)*n;return{stiffness:d,damping:i*2*Math.sqrt(n*d),duration:e}}}const bD=12;function SD(e,t,r){let n=r;for(let s=1;s<bD;s++)n=n-e(n)/t(n);return n}function n_(e,t){return e*Math.sqrt(1-t*t)}const kD=["duration","bounce"],CD=["stiffness","damping","mass"];function Wk(e,t){return t.some(r=>e[r]!==void 0)}function TD(e){let t={velocity:Jn.velocity,stiffness:Jn.stiffness,damping:Jn.damping,mass:Jn.mass,isResolvedFromDuration:!1,...e};if(!Wk(e,CD)&&Wk(e,kD))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*bc(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:Jn.mass,stiffness:s,damping:a}}else{const r=_D(e);t={...t,...r,mass:Jn.mass},t.isResolvedFromDuration=!0}return t}function U1(e=Jn.visualDuration,t=Jn.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:d,mass:f,duration:p,velocity:g,isResolvedFromDuration:y}=TD({...r,velocity:-El(r.velocity||0)}),v=g||0,w=d/(2*Math.sqrt(c*f)),b=i-a,E=El(Math.sqrt(c/f)),k=Math.abs(b)<5;n||(n=k?Jn.restSpeed.granular:Jn.restSpeed.default),s||(s=k?Jn.restDelta.granular:Jn.restDelta.default);let _;if(w<1){const A=n_(E,w);_=P=>{const R=Math.exp(-w*E*P);return i-R*((v+w*E*b)/A*Math.sin(A*P)+b*Math.cos(A*P))}}else if(w===1)_=A=>i-Math.exp(-E*A)*(b+(v+E*b)*A);else{const A=E*Math.sqrt(w*w-1);_=P=>{const R=Math.exp(-w*E*P),T=Math.min(A*P,300);return i-R*((v+w*E*b)*Math.sinh(T)+A*b*Math.cosh(T))/A}}const N={calculatedDuration:y&&p||null,next:A=>{const P=_(A);if(y)o.done=A>=p;else{let R=A===0?v:0;w<1&&(R=A===0?Tl(v):g5(_,A,P));const T=Math.abs(R)<=n,D=Math.abs(i-P)<=s;o.done=T&&D}return o.value=o.done?i:P,o},toString:()=>{const A=Math.min(L2(N),B1),P=h5(R=>N.next(A*R).value,A,30);return A+"ms "+P},toTransition:()=>{}};return N}U1.applyToOptions=e=>{const t=vD(e,100,U1);return e.ease=t.ease,e.duration=Tl(t.duration),e.type="keyframes",e};function s_({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:d=.5,restSpeed:f}){const p=e[0],g={done:!1,value:p},y=T=>o!==void 0&&T<o||c!==void 0&&T>c,v=T=>o===void 0?c:c===void 0||Math.abs(o-T)<Math.abs(c-T)?o:c;let w=r*t;const b=p+w,E=i===void 0?b:i(b);E!==b&&(w=E-p);const k=T=>-w*Math.exp(-T/n),_=T=>E+k(T),N=T=>{const D=k(T),I=_(T);g.done=Math.abs(D)<=d,g.value=g.done?E:I};let A,P;const R=T=>{y(g.value)&&(A=T,P=U1({keyframes:[g.value,v(g.value)],velocity:g5(_,T,g.value),damping:s,stiffness:a,restDelta:d,restSpeed:f}))};return R(0),{calculatedDuration:null,next:T=>{let D=!1;return!P&&A===void 0&&(D=!0,N(T),R(T)),A!==void 0&&T>=A?P.next(T-A):(!D&&N(T),g)}}}function ED(e,t,r){const n=[],s=r||Sc.mix||f5,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||go:t;o=kp(c,o)}n.push(o)}return n}function ND(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(N2(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=ED(t,n,s),c=o.length,d=f=>{if(i&&f<e[0])return t[0];let p=0;if(c>1)for(;p<e.length-2&&!(f<e[p+1]);p++);const g=Gm(e[p],e[p+1],f);return o[p](g)};return r?f=>d(bc(e[0],e[a-1],f)):d}function AD(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Gm(0,t,n);e.push(zn(r,1,s))}}function jD(e){const t=[0];return AD(t,e.length-1),t}function FD(e,t){return e.map(r=>r*t)}function PD(e,t){return e.map(()=>t||r5).splice(0,e.length-1)}function Tm({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=zR(n)?n.map(Ok):Ok(n),a={done:!1,value:t[0]},i=FD(r&&r.length===t.length?r:jD(t),e),o=ND(i,t,{ease:Array.isArray(s)?s:PD(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const RD=e=>e!==null;function B2(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(RD),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const DD={decay:s_,inertia:s_,tween:Tm,keyframes:Tm,spring:U1};function m5(e){typeof e.type=="string"&&(e.type=DD[e.type])}class U2{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const ID=e=>e/100;class $2 extends U2{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==_i.now()&&this.tick(_i.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;m5(t);const{type:r=Tm,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||Tm;c!==Tm&&typeof o[0]!="number"&&(this.mixKeyframes=kp(ID,f5(o[0],o[1])),o=[0,100]);const d=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),d.calculatedDuration===null&&(d.calculatedDuration=L2(d));const{calculatedDuration:f}=d;this.calculatedDuration=f,this.resolvedDuration=f+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=d}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:d=0,keyframes:f,repeat:p,repeatType:g,repeatDelay:y,type:v,onUpdate:w,finalKeyframe:b}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const E=this.currentTime-d*(this.playbackSpeed>=0?1:-1),k=this.playbackSpeed>=0?E<0:E>s;this.currentTime=Math.max(E,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,N=n;if(p){const T=Math.min(this.currentTime,s)/o;let D=Math.floor(T),I=T%1;!I&&T>=1&&(I=1),I===1&&D--,D=Math.min(D,p+1),!!(D%2)&&(g==="reverse"?(I=1-I,y&&(I-=y/o)):g==="mirror"&&(N=i)),_=bc(0,1,I)*o}const A=k?{done:!1,value:f[0]}:N.next(_);a&&(A.value=a(A.value));let{done:P}=A;!k&&c!==null&&(P=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const R=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&P);return R&&v!==s_&&(A.value=B2(f,this.options,b,this.speed)),w&&w(A.value),R&&this.finish(),A}then(t,r){return this.finished.then(t,r)}get duration(){return El(this.calculatedDuration)}get time(){return El(this.currentTime)}set time(t){t=Tl(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(_i.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=El(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=yD,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(_i.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function MD(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const Od=e=>e*180/Math.PI,a_=e=>{const t=Od(Math.atan2(e[1],e[0]));return i_(t)},OD={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:a_,rotateZ:a_,skewX:e=>Od(Math.atan(e[1])),skewY:e=>Od(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},i_=e=>(e=e%360,e<0&&(e+=360),e),zk=a_,Hk=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Gk=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),LD={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Hk,scaleY:Gk,scale:e=>(Hk(e)+Gk(e))/2,rotateX:e=>i_(Od(Math.atan2(e[6],e[5]))),rotateY:e=>i_(Od(Math.atan2(-e[2],e[0]))),rotateZ:zk,rotate:zk,skewX:e=>Od(Math.atan(e[4])),skewY:e=>Od(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function o_(e){return e.includes("scale")?1:0}function l_(e,t){if(!e||e==="none")return o_(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=LD,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=OD,s=o}if(!s)return o_(t);const a=n[t],i=s[1].split(",").map(UD);return typeof a=="function"?a(i):i[a]}const BD=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return l_(r,t)};function UD(e){return parseFloat(e.trim())}const p0=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],x0=new Set(p0),Vk=e=>e===m0||e===yr,$D=new Set(["x","y","z"]),WD=p0.filter(e=>!$D.has(e));function zD(e){const t=[];return WD.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const $d={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>l_(t,"x"),y:(e,{transform:t})=>l_(t,"y")};$d.translateX=$d.x;$d.translateY=$d.y;const Wd=new Set;let c_=!1,u_=!1,d_=!1;function p5(){if(u_){const e=Array.from(Wd).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=zD(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}u_=!1,c_=!1,Wd.forEach(e=>e.complete(d_)),Wd.clear()}function x5(){Wd.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(u_=!0)})}function HD(){d_=!0,x5(),p5(),d_=!1}class W2{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Wd.add(this),c_||(c_=!0,Bn.read(x5),Bn.resolveKeyframes(p5))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}MD(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Wd.delete(this)}cancel(){this.state==="scheduled"&&(Wd.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const GD=e=>e.startsWith("--");function VD(e,t,r){GD(t)?e.style.setProperty(t,r):e.style[t]=r}const KD=A2(()=>window.ScrollTimeline!==void 0),qD={};function XD(e,t){const r=A2(e);return()=>qD[t]??r()}const y5=XD(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),vm=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,Kk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:vm([0,.65,.55,1]),circOut:vm([.55,0,1,.45]),backIn:vm([.31,.01,.66,-.59]),backOut:vm([.33,1.53,.69,.99])};function v5(e,t){if(e)return typeof e=="function"?y5()?h5(e,t):"ease-out":n5(e)?vm(e):Array.isArray(e)?e.map(r=>v5(r,t)||Kk.easeOut):Kk[e]}function YD(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},d=void 0){const f={[t]:r};c&&(f.offset=c);const p=v5(o,s);Array.isArray(p)&&(f.easing=p);const g={delay:n,duration:s,easing:Array.isArray(p)?"linear":p,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return d&&(g.pseudoElement=d),e.animate(f,g)}function w5(e){return typeof e=="function"&&"applyToOptions"in e}function QD({type:e,...t}){return w5(e)&&y5()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class JD extends U2{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,N2(typeof t.type!="string");const d=QD(t);this.animation=YD(r,n,s,d,a),d.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const f=B2(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(f):VD(r,n,f),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return El(Number(t))}get time(){return El(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Tl(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&KD()?(this.animation.timeline=t,go):r(this)}}const _5={anticipate:Z3,backInOut:J3,circInOut:t5};function ZD(e){return e in _5}function e7(e){typeof e.ease=="string"&&ZD(e.ease)&&(e.ease=_5[e.ease])}const qk=10;class t7 extends JD{constructor(t){e7(t),m5(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new $2({...i,autoplay:!1}),c=Tl(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-qk).value,o.sample(c).value,qk),o.stop()}}const Xk=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Mu.test(e)||e==="0")&&!e.startsWith("url("));function r7(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function n7(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=Xk(s,t),o=Xk(a,t);return!i||!o?!1:r7(e)||(r==="spring"||w5(r))&&n}function f_(e){e.duration=0,e.type}const s7=new Set(["opacity","clipPath","filter","transform"]),a7=A2(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function i7(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:d}=t.owner.getProps();return a7()&&r&&s7.has(r)&&(r!=="transform"||!d)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const o7=40;class l7 extends U2{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:d,element:f,...p}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=_i.now();const g={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:d,element:f,...p},y=f?.KeyframeResolver||W2;this.keyframeResolver=new y(o,(v,w,b)=>this.onKeyframesResolved(v,w,g,!b),c,d,f),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:d,onUpdate:f}=n;this.resolvedAt=_i.now(),n7(t,a,i,o)||((Sc.instantAnimations||!c)&&f?.(B2(t,n,r)),t[0]=t[t.length-1],f_(n),n.repeat=0);const g={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>o7?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},y=!d&&i7(g)?new t7({...g,element:g.motionValue.owner.current}):new $2(g);y.finished.then(()=>this.notifyFinished()).catch(go),this.pendingTimeline&&(this.stopTimeline=y.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=y}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),HD()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const c7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function u7(e){const t=c7.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function b5(e,t,r=1){const[n,s]=u7(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return H3(i)?parseFloat(i):i}return D2(s)?b5(s,t,r+1):s}function z2(e,t){return e?.[t]??e?.default??e}const S5=new Set(["width","height","top","left","right","bottom",...p0]),d7={test:e=>e==="auto",parse:e=>e},k5=e=>t=>t.test(e),C5=[m0,yr,Nl,_u,rD,tD,d7],Yk=e=>C5.find(k5(e));function f7(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||V3(e):!0}const h7=new Set(["brightness","contrast","saturate","opacity"]);function g7(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(I2)||[];if(!n)return e;const s=r.replace(n,"");let a=h7.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const m7=/\b([a-z-]*)\(.*?\)/gu,h_={...Mu,getAnimatableNone:e=>{const t=e.match(m7);return t?t.map(g7).join(" "):e}},Qk={...m0,transform:Math.round},p7={rotate:_u,rotateX:_u,rotateY:_u,rotateZ:_u,scale:e1,scaleX:e1,scaleY:e1,scaleZ:e1,skew:_u,skewX:_u,skewY:_u,distance:yr,translateX:yr,translateY:yr,translateZ:yr,x:yr,y:yr,z:yr,perspective:yr,transformPerspective:yr,opacity:Vm,originX:Lk,originY:Lk,originZ:yr},H2={borderWidth:yr,borderTopWidth:yr,borderRightWidth:yr,borderBottomWidth:yr,borderLeftWidth:yr,borderRadius:yr,radius:yr,borderTopLeftRadius:yr,borderTopRightRadius:yr,borderBottomRightRadius:yr,borderBottomLeftRadius:yr,width:yr,maxWidth:yr,height:yr,maxHeight:yr,top:yr,right:yr,bottom:yr,left:yr,padding:yr,paddingTop:yr,paddingRight:yr,paddingBottom:yr,paddingLeft:yr,margin:yr,marginTop:yr,marginRight:yr,marginBottom:yr,marginLeft:yr,backgroundPositionX:yr,backgroundPositionY:yr,...p7,zIndex:Qk,fillOpacity:Vm,strokeOpacity:Vm,numOctaves:Qk},x7={...H2,color:Ts,backgroundColor:Ts,outlineColor:Ts,fill:Ts,stroke:Ts,borderColor:Ts,borderTopColor:Ts,borderRightColor:Ts,borderBottomColor:Ts,borderLeftColor:Ts,filter:h_,WebkitFilter:h_},T5=e=>x7[e];function E5(e,t){let r=T5(e);return r!==h_&&(r=Mu),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const y7=new Set(["auto","none","0"]);function v7(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!y7.has(a)&&Km(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=E5(r,s)}class w7 extends W2{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let d=t[c];if(typeof d=="string"&&(d=d.trim(),D2(d))){const f=b5(d,r.current);f!==void 0&&(t[c]=f),c===t.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!S5.has(n)||t.length!==2)return;const[s,a]=t,i=Yk(s),o=Yk(a);if(i!==o)if(Vk(i)&&Vk(o))for(let c=0;c<t.length;c++){const d=t[c];typeof d=="string"&&(t[c]=parseFloat(d))}else $d[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||f7(t[s]))&&n.push(s);n.length&&v7(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=$d[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=$d[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,c])=>{t.getValue(o).set(c)}),this.resolveNoneKeyframes()}}function _7(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const N5=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function A5(e){return G3(e)&&"offsetHeight"in e}const Jk=30,b7=e=>!isNaN(parseFloat(e));class S7{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=_i.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=_i.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=b7(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new j2);const n=this.events[t].add(r);return t==="change"?()=>{n(),Bn.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=_i.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>Jk)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Jk);return K3(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function r0(e,t){return new S7(e,t)}const{schedule:G2}=s5(queueMicrotask,!1),Oo={x:!1,y:!1};function j5(){return Oo.x||Oo.y}function k7(e){return e==="x"||e==="y"?Oo[e]?null:(Oo[e]=!0,()=>{Oo[e]=!1}):Oo.x||Oo.y?null:(Oo.x=Oo.y=!0,()=>{Oo.x=Oo.y=!1})}function F5(e,t){const r=_7(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function Zk(e){return!(e.pointerType==="touch"||j5())}function C7(e,t,r={}){const[n,s,a]=F5(e,r),i=o=>{if(!Zk(o))return;const{target:c}=o,d=t(c,o);if(typeof d!="function"||!c)return;const f=p=>{Zk(p)&&(d(p),c.removeEventListener("pointerleave",f))};c.addEventListener("pointerleave",f,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const P5=(e,t)=>t?e===t?!0:P5(e,t.parentElement):!1,V2=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,T7=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function E7(e){return T7.has(e.tagName)||e.tabIndex!==-1}const E1=new WeakSet;function eC(e){return t=>{t.key==="Enter"&&e(t)}}function Xv(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const N7=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=eC(()=>{if(E1.has(r))return;Xv(r,"down");const s=eC(()=>{Xv(r,"up")}),a=()=>Xv(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function tC(e){return V2(e)&&!j5()}function A7(e,t,r={}){const[n,s,a]=F5(e,r),i=o=>{const c=o.currentTarget;if(!tC(o))return;E1.add(c);const d=t(c,o),f=(y,v)=>{window.removeEventListener("pointerup",p),window.removeEventListener("pointercancel",g),E1.has(c)&&E1.delete(c),tC(y)&&typeof d=="function"&&d(y,{success:v})},p=y=>{f(y,c===window||c===document||r.useGlobalTarget||P5(c,y.target))},g=y=>{f(y,!1)};window.addEventListener("pointerup",p,s),window.addEventListener("pointercancel",g,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),A5(o)&&(o.addEventListener("focus",d=>N7(d,s)),!E7(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function R5(e){return G3(e)&&"ownerSVGElement"in e}function j7(e){return R5(e)&&e.tagName==="svg"}const Ia=e=>!!(e&&e.getVelocity),F7=[...C5,Ts,Mu],P7=e=>F7.find(k5(e)),K2=C.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class R7 extends C.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=A5(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function D7({children:e,isPresent:t,anchorX:r,root:n}){const s=C.useId(),a=C.useRef(null),i=C.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=C.useContext(K2);return C.useInsertionEffect(()=>{const{width:c,height:d,top:f,left:p,right:g}=i.current;if(t||!a.current||!c||!d)return;const y=r==="left"?`left: ${p}`:`right: ${g}`;a.current.dataset.motionPopId=s;const v=document.createElement("style");o&&(v.nonce=o);const w=n??document.head;return w.appendChild(v),v.sheet&&v.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${d}px !important;
            ${y}px !important;
            top: ${f}px !important;
          }
        `),()=>{w.contains(v)&&w.removeChild(v)}},[t]),l.jsx(R7,{isPresent:t,childRef:a,sizeRef:i,children:C.cloneElement(e,{ref:a})})}const I7=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const d=k2(M7),f=C.useId();let p=!0,g=C.useMemo(()=>(p=!1,{id:f,initial:t,isPresent:r,custom:s,onExitComplete:y=>{d.set(y,!0);for(const v of d.values())if(!v)return;n&&n()},register:y=>(d.set(y,!1),()=>d.delete(y))}),[r,d,n]);return a&&p&&(g={...g}),C.useMemo(()=>{d.forEach((y,v)=>d.set(v,!1))},[r]),C.useEffect(()=>{!r&&!d.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(D7,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(Ny.Provider,{value:g,children:e})};function M7(){return new Map}function D5(e=!0){const t=C.useContext(Ny);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=C.useId();C.useEffect(()=>{if(e)return s(a)},[e]);const i=C.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const t1=e=>e.key||"";function rC(e){const t=[];return C.Children.forEach(e,r=>{C.isValidElement(r)&&t.push(r)}),t}const wi=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[d,f]=D5(i),p=C.useMemo(()=>rC(e),[e]),g=i&&!d?[]:p.map(t1),y=C.useRef(!0),v=C.useRef(p),w=k2(()=>new Map),[b,E]=C.useState(p),[k,_]=C.useState(p);z3(()=>{y.current=!1,v.current=p;for(let P=0;P<k.length;P++){const R=t1(k[P]);g.includes(R)?w.delete(R):w.get(R)!==!0&&w.set(R,!1)}},[k,g.length,g.join("-")]);const N=[];if(p!==b){let P=[...p];for(let R=0;R<k.length;R++){const T=k[R],D=t1(T);g.includes(D)||(P.splice(R,0,T),N.push(T))}return a==="wait"&&N.length&&(P=N),_(rC(P)),E(p),null}const{forceRender:A}=C.useContext(S2);return l.jsx(l.Fragment,{children:k.map(P=>{const R=t1(P),T=i&&!d?!1:p===k||g.includes(R),D=()=>{if(w.has(R))w.set(R,!0);else return;let I=!0;w.forEach(K=>{K||(I=!1)}),I&&(A?.(),_(v.current),i&&f?.(),n&&n())};return l.jsx(I7,{isPresent:T,initial:!y.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:T?void 0:D,anchorX:o,children:P},R)})})},I5=C.createContext({strict:!1}),nC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},n0={};for(const e in nC)n0[e]={isEnabled:t=>nC[e].some(r=>!!t[r])};function O7(e){for(const t in e)n0[t]={...n0[t],...e[t]}}const L7=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function $1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||L7.has(e)}let M5=e=>!$1(e);function B7(e){typeof e=="function"&&(M5=t=>t.startsWith("on")?!$1(t):e(t))}try{B7(require("@emotion/is-prop-valid").default)}catch{}function U7(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(M5(s)||r===!0&&$1(s)||!t&&!$1(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const Ay=C.createContext({});function jy(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function qm(e){return typeof e=="string"||Array.isArray(e)}const q2=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],X2=["initial",...q2];function Fy(e){return jy(e.animate)||X2.some(t=>qm(e[t]))}function O5(e){return!!(Fy(e)||e.variants)}function $7(e,t){if(Fy(e)){const{initial:r,animate:n}=e;return{initial:r===!1||qm(r)?r:void 0,animate:qm(n)?n:void 0}}return e.inherit!==!1?t:{}}function W7(e){const{initial:t,animate:r}=$7(e,C.useContext(Ay));return C.useMemo(()=>({initial:t,animate:r}),[sC(t),sC(r)])}function sC(e){return Array.isArray(e)?e.join(" "):e}const Xm={};function z7(e){for(const t in e)Xm[t]=e[t],R2(t)&&(Xm[t].isCSSVariable=!0)}function L5(e,{layout:t,layoutId:r}){return x0.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Xm[e]||e==="opacity")}const H7={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},G7=p0.length;function V7(e,t,r){let n="",s=!0;for(let a=0;a<G7;a++){const i=p0[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const d=N5(o,H2[i]);if(!c){s=!1;const f=H7[i]||i;n+=`${f}(${d}) `}r&&(t[i]=d)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function Y2(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const d=t[c];if(x0.has(c)){i=!0;continue}else if(R2(c)){s[c]=d;continue}else{const f=N5(d,H2[c]);c.startsWith("origin")?(o=!0,a[c]=f):n[c]=f}}if(t.transform||(i||r?n.transform=V7(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:d="50%",originZ:f=0}=a;n.transformOrigin=`${c} ${d} ${f}`}}const Q2=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function B5(e,t,r){for(const n in t)!Ia(t[n])&&!L5(n,r)&&(e[n]=t[n])}function K7({transformTemplate:e},t){return C.useMemo(()=>{const r=Q2();return Y2(r,t,e),Object.assign({},r.vars,r.style)},[t])}function q7(e,t){const r=e.style||{},n={};return B5(n,r,e),Object.assign(n,K7(e,t)),n}function X7(e,t){const r={},n=q7(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const Y7={offset:"stroke-dashoffset",array:"stroke-dasharray"},Q7={offset:"strokeDashoffset",array:"strokeDasharray"};function J7(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?Y7:Q7;e[a.offset]=yr.transform(-n);const i=yr.transform(t),o=yr.transform(r);e[a.array]=`${i} ${o}`}function U5(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},c,d,f){if(Y2(e,o,d),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:g}=e;p.transform&&(g.transform=p.transform,delete p.transform),(g.transform||p.transformOrigin)&&(g.transformOrigin=p.transformOrigin??"50% 50%",delete p.transformOrigin),g.transform&&(g.transformBox=f?.transformBox??"fill-box",delete p.transformBox),t!==void 0&&(p.x=t),r!==void 0&&(p.y=r),n!==void 0&&(p.scale=n),s!==void 0&&J7(p,s,a,i,!1)}const $5=()=>({...Q2(),attrs:{}}),W5=e=>typeof e=="string"&&e.toLowerCase()==="svg";function Z7(e,t,r,n){const s=C.useMemo(()=>{const a=$5();return U5(a,t,W5(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};B5(a,e.style,e),s.style={...a,...s.style}}return s}const e9=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function J2(e){return typeof e!="string"||e.includes("-")?!1:!!(e9.indexOf(e)>-1||/[A-Z]/u.test(e))}function t9(e,t,r,{latestValues:n},s,a=!1){const o=(J2(e)?Z7:X7)(t,n,s,e),c=U7(t,typeof e=="string",a),d=e!==C.Fragment?{...c,...o,ref:r}:{},{children:f}=t,p=C.useMemo(()=>Ia(f)?f.get():f,[f]);return C.createElement(e,{...d,children:p})}function aC(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function Z2(e,t,r,n){if(typeof t=="function"){const[s,a]=aC(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=aC(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function N1(e){return Ia(e)?e.get():e}function r9({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:n9(r,n,s,e),renderState:t()}}function n9(e,t,r,n){const s={},a=n(e,{});for(const g in a)s[g]=N1(a[g]);let{initial:i,animate:o}=e;const c=Fy(e),d=O5(e);t&&d&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let f=r?r.initial===!1:!1;f=f||i===!1;const p=f?o:i;if(p&&typeof p!="boolean"&&!jy(p)){const g=Array.isArray(p)?p:[p];for(let y=0;y<g.length;y++){const v=Z2(e,g[y]);if(v){const{transitionEnd:w,transition:b,...E}=v;for(const k in E){let _=E[k];if(Array.isArray(_)){const N=f?_.length-1:0;_=_[N]}_!==null&&(s[k]=_)}for(const k in w)s[k]=w[k]}}}return s}const z5=e=>(t,r)=>{const n=C.useContext(Ay),s=C.useContext(Ny),a=()=>r9(e,t,n,s);return r?a():k2(a)};function eb(e,t,r){const{style:n}=e,s={};for(const a in n)(Ia(n[a])||t.style&&Ia(t.style[a])||L5(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const s9=z5({scrapeMotionValuesFromProps:eb,createRenderState:Q2});function H5(e,t,r){const n=eb(e,t,r);for(const s in e)if(Ia(e[s])||Ia(t[s])){const a=p0.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const a9=z5({scrapeMotionValuesFromProps:H5,createRenderState:$5}),i9=Symbol.for("motionComponentSymbol");function Mh(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function o9(e,t,r){return C.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Mh(r)&&(r.current=n))},[t])}const tb=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),l9="framerAppearId",G5="data-"+tb(l9),V5=C.createContext({});function c9(e,t,r,n,s){const{visualElement:a}=C.useContext(Ay),i=C.useContext(I5),o=C.useContext(Ny),c=C.useContext(K2).reducedMotion,d=C.useRef(null);n=n||i.renderer,!d.current&&n&&(d.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const f=d.current,p=C.useContext(V5);f&&!f.projection&&s&&(f.type==="html"||f.type==="svg")&&u9(d.current,r,s,p);const g=C.useRef(!1);C.useInsertionEffect(()=>{f&&g.current&&f.update(r,o)});const y=r[G5],v=C.useRef(!!y&&!window.MotionHandoffIsComplete?.(y)&&window.MotionHasOptimisedAnimation?.(y));return z3(()=>{f&&(g.current=!0,window.MotionIsMounted=!0,f.updateFeatures(),f.scheduleRenderMicrotask(),v.current&&f.animationState&&f.animationState.animateChanges())}),C.useEffect(()=>{f&&(!v.current&&f.animationState&&f.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(y)}),v.current=!1),f.enteringChildren=void 0)}),f}function u9(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:d,layoutCrossfade:f}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:K5(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&Mh(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:f,layoutScroll:c,layoutRoot:d})}function K5(e){if(e)return e.options.allowProjection!==!1?e.projection:K5(e.parent)}function Yv(e,{forwardMotionProps:t=!1}={},r,n){r&&O7(r);const s=J2(e)?a9:s9;function a(o,c){let d;const f={...C.useContext(K2),...o,layoutId:d9(o)},{isStatic:p}=f,g=W7(o),y=s(o,p);if(!p&&C2){f9();const v=h9(f);d=v.MeasureLayout,g.visualElement=c9(e,y,f,n,v.ProjectionNode)}return l.jsxs(Ay.Provider,{value:g,children:[d&&g.visualElement?l.jsx(d,{visualElement:g.visualElement,...f}):null,t9(e,o,o9(y,g.visualElement,c),y,p,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=C.forwardRef(a);return i[i9]=e,i}function d9({layoutId:e}){const t=C.useContext(S2).id;return t&&e!==void 0?t+"-"+e:e}function f9(e,t){C.useContext(I5).strict}function h9(e){const{drag:t,layout:r}=n0;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function g9(e,t){if(typeof Proxy>"u")return Yv;const r=new Map,n=(a,i)=>Yv(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,Yv(i,void 0,e,t)),r.get(i))})}function q5({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function m9({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function p9(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function Qv(e){return e===void 0||e===1}function g_({scale:e,scaleX:t,scaleY:r}){return!Qv(e)||!Qv(t)||!Qv(r)}function Rd(e){return g_(e)||X5(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function X5(e){return iC(e.x)||iC(e.y)}function iC(e){return e&&e!=="0%"}function W1(e,t,r){const n=e-r,s=t*n;return r+s}function oC(e,t,r,n,s){return s!==void 0&&(e=W1(e,s,n)),W1(e,r,n)+t}function m_(e,t=0,r=1,n,s){e.min=oC(e.min,t,r,n,s),e.max=oC(e.max,t,r,n,s)}function Y5(e,{x:t,y:r}){m_(e.x,t.translate,t.scale,t.originPoint),m_(e.y,r.translate,r.scale,r.originPoint)}const lC=.999999999999,cC=1.0000000000001;function x9(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&Lh(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,Y5(e,i)),n&&Rd(a.latestValues)&&Lh(e,a.latestValues))}t.x<cC&&t.x>lC&&(t.x=1),t.y<cC&&t.y>lC&&(t.y=1)}function Oh(e,t){e.min=e.min+t,e.max=e.max+t}function uC(e,t,r,n,s=.5){const a=zn(e.min,e.max,s);m_(e,t,r,a,n)}function Lh(e,t){uC(e.x,t.x,t.scaleX,t.scale,t.originX),uC(e.y,t.y,t.scaleY,t.scale,t.originY)}function Q5(e,t){return q5(p9(e.getBoundingClientRect(),t))}function y9(e,t,r){const n=Q5(e,r),{scroll:s}=t;return s&&(Oh(n.x,s.offset.x),Oh(n.y,s.offset.y)),n}const dC=()=>({translate:0,scale:1,origin:0,originPoint:0}),Bh=()=>({x:dC(),y:dC()}),fC=()=>({min:0,max:0}),gs=()=>({x:fC(),y:fC()}),p_={current:null},J5={current:!1};function v9(){if(J5.current=!0,!!C2)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>p_.current=e.matches;e.addEventListener("change",t),t()}else p_.current=!1}const w9=new WeakMap;function _9(e,t,r){for(const n in t){const s=t[n],a=r[n];if(Ia(s))e.addValue(n,s);else if(Ia(a))e.addValue(n,r0(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,r0(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const hC=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class b9{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=W2,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=_i.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,Bn.render(this.render,!1,!0))};const{latestValues:c,renderState:d}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=d,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=Fy(r),this.isVariantNode=O5(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:f,...p}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in p){const y=p[g];c[g]!==void 0&&Ia(y)&&y.set(c[g])}}mount(t){this.current=t,w9.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),J5.current||v9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:p_.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Iu(this.notifyUpdate),Iu(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=x0.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Bn.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in n0){const r=n0[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):gs()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<hC.length;n++){const s=hC[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=_9(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=r0(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(H3(n)||V3(n))?n=parseFloat(n):!P7(n)&&Mu.test(r)&&(n=E5(t,r)),this.setBaseTarget(t,Ia(n)?n.get():n)),Ia(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=Z2(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Ia(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new j2),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){G2.render(this.render)}}class Z5 extends b9{constructor(){super(...arguments),this.KeyframeResolver=w7}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Ia(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function e6(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function S9(e){return window.getComputedStyle(e)}class k9 extends Z5{constructor(){super(...arguments),this.type="html",this.renderInstance=e6}readValueFromInstance(t,r){if(x0.has(r))return this.projection?.isProjecting?o_(r):BD(t,r);{const n=S9(t),s=(R2(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Q5(t,r)}build(t,r,n){Y2(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return eb(t,r,n)}}const t6=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function C9(e,t,r,n){e6(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(t6.has(s)?s:tb(s),t.attrs[s])}class T9 extends Z5{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=gs}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(x0.has(r)){const n=T5(r);return n&&n.default||0}return r=t6.has(r)?r:tb(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return H5(t,r,n)}build(t,r,n){U5(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){C9(t,r,n,s)}mount(t){this.isSVGTag=W5(t.tagName),super.mount(t)}}const E9=(e,t)=>J2(e)?new T9(t):new k9(t,{allowProjection:e!==C.Fragment});function Hh(e,t,r){const n=e.getProps();return Z2(n,t,r!==void 0?r:n.custom,e)}const x_=e=>Array.isArray(e);function N9(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,r0(r))}function A9(e){return x_(e)?e[e.length-1]||0:e}function j9(e,t){const r=Hh(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=A9(a[i]);N9(e,i,o)}}function F9(e){return!!(Ia(e)&&e.add)}function y_(e,t){const r=e.getValue("willChange");if(F9(r))return r.add(t);if(!r&&Sc.WillChange){const n=new Sc.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function r6(e){return e.props[G5]}const P9=e=>e!==null;function R9(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(P9),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const D9={type:"spring",stiffness:500,damping:25,restSpeed:10},I9=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),M9={type:"keyframes",duration:.8},O9={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},L9=(e,{keyframes:t})=>t.length>2?M9:x0.has(e)?e.startsWith("scale")?I9(t[1]):D9:O9;function B9({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:d,...f}){return!!Object.keys(f).length}const rb=(e,t,r,n={},s,a)=>i=>{const o=z2(n,e)||{},c=o.delay||n.delay||0;let{elapsed:d=0}=n;d=d-Tl(c);const f={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-d,onUpdate:g=>{t.set(g),o.onUpdate&&o.onUpdate(g)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};B9(o)||Object.assign(f,L9(e,f)),f.duration&&(f.duration=Tl(f.duration)),f.repeatDelay&&(f.repeatDelay=Tl(f.repeatDelay)),f.from!==void 0&&(f.keyframes[0]=f.from);let p=!1;if((f.type===!1||f.duration===0&&!f.repeatDelay)&&(f_(f),f.delay===0&&(p=!0)),(Sc.instantAnimations||Sc.skipAnimations)&&(p=!0,f_(f),f.delay=0),f.allowFlatten=!o.type&&!o.ease,p&&!a&&t.get()!==void 0){const g=R9(f.keyframes,o);if(g!==void 0){Bn.update(()=>{f.onUpdate(g),f.onComplete()});return}}return o.isSync?new $2(f):new l7(f)};function U9({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function n6(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const c=[],d=s&&e.animationState&&e.animationState.getState()[s];for(const f in o){const p=e.getValue(f,e.latestValues[f]??null),g=o[f];if(g===void 0||d&&U9(d,f))continue;const y={delay:r,...z2(a||{},f)},v=p.get();if(v!==void 0&&!p.isAnimating&&!Array.isArray(g)&&g===v&&!y.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const E=r6(e);if(E){const k=window.MotionHandoffAnimation(E,f,Bn);k!==null&&(y.startTime=k,w=!0)}}y_(e,f),p.start(rb(f,p,g,e.shouldReduceMotion&&S5.has(f)?{type:!1}:y,e,w));const b=p.animation;b&&c.push(b)}return i&&Promise.all(c).then(()=>{Bn.update(()=>{i&&j9(e,i)})}),c}function s6(e,t,r,n=0,s=1){const a=Array.from(e).sort((d,f)=>d.sortNodePosition(f)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function v_(e,t,r={}){const n=Hh(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(n6(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:d=0,staggerChildren:f,staggerDirection:p}=s;return $9(e,t,c,d,f,p,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,d]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>d())}else return Promise.all([a(),i(r.delay)])}function $9(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(v_(c,t,{...i,delay:r+(typeof n=="function"?0:n)+s6(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function W9(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>v_(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=v_(e,t,r);else{const s=typeof t=="function"?Hh(e,t,r.custom):t;n=Promise.all(n6(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function a6(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const z9=X2.length;function i6(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?i6(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<z9;r++){const n=X2[r],s=e.props[n];(qm(s)||s===!1)&&(t[n]=s)}return t}const H9=[...q2].reverse(),G9=q2.length;function V9(e){return t=>Promise.all(t.map(({animation:r,options:n})=>W9(e,r,n)))}function K9(e){let t=V9(e),r=gC(),n=!0;const s=c=>(d,f)=>{const p=Hh(e,f,c==="exit"?e.presenceContext?.custom:void 0);if(p){const{transition:g,transitionEnd:y,...v}=p;d={...d,...v,...y}}return d};function a(c){t=c(e)}function i(c){const{props:d}=e,f=i6(e.parent)||{},p=[],g=new Set;let y={},v=1/0;for(let b=0;b<G9;b++){const E=H9[b],k=r[E],_=d[E]!==void 0?d[E]:f[E],N=qm(_),A=E===c?k.isActive:null;A===!1&&(v=b);let P=_===f[E]&&_!==d[E]&&N;if(P&&n&&e.manuallyAnimateOnMount&&(P=!1),k.protectedKeys={...y},!k.isActive&&A===null||!_&&!k.prevProp||jy(_)||typeof _=="boolean")continue;const R=q9(k.prevProp,_);let T=R||E===c&&k.isActive&&!P&&N||b>v&&N,D=!1;const I=Array.isArray(_)?_:[_];let K=I.reduce(s(E),{});A===!1&&(K={});const{prevResolvedValues:X={}}=k,Z={...X,...K},oe=M=>{T=!0,g.has(M)&&(D=!0,g.delete(M)),k.needsAnimating[M]=!0;const W=e.getValue(M);W&&(W.liveStyle=!1)};for(const M in Z){const W=K[M],B=X[M];if(y.hasOwnProperty(M))continue;let G=!1;x_(W)&&x_(B)?G=!a6(W,B):G=W!==B,G?W!=null?oe(M):g.add(M):W!==void 0&&g.has(M)?oe(M):k.protectedKeys[M]=!0}k.prevProp=_,k.prevResolvedValues=K,k.isActive&&(y={...y,...K}),n&&e.blockInitialAnimation&&(T=!1);const q=P&&R;T&&(!q||D)&&p.push(...I.map(M=>{const W={type:E};if(typeof M=="string"&&n&&!q&&e.manuallyAnimateOnMount&&e.parent){const{parent:B}=e,G=Hh(B,M);if(B.enteringChildren&&G){const{delayChildren:H}=G.transition||{};W.delay=s6(B.enteringChildren,e,H)}}return{animation:M,options:W}}))}if(g.size){const b={};if(typeof d.initial!="boolean"){const E=Hh(e,Array.isArray(d.initial)?d.initial[0]:d.initial);E&&E.transition&&(b.transition=E.transition)}g.forEach(E=>{const k=e.getBaseTarget(E),_=e.getValue(E);_&&(_.liveStyle=!0),b[E]=k??null}),p.push({animation:b})}let w=!!p.length;return n&&(d.initial===!1||d.initial===d.animate)&&!e.manuallyAnimateOnMount&&(w=!1),n=!1,w?t(p):Promise.resolve()}function o(c,d){if(r[c].isActive===d)return Promise.resolve();e.variantChildren?.forEach(p=>p.animationState?.setActive(c,d)),r[c].isActive=d;const f=i(c);for(const p in r)r[p].protectedKeys={};return f}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=gC(),n=!0}}}function q9(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!a6(t,e):!1}function Ad(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function gC(){return{animate:Ad(!0),whileInView:Ad(),whileHover:Ad(),whileTap:Ad(),whileDrag:Ad(),whileFocus:Ad(),exit:Ad()}}class Hu{constructor(t){this.isMounted=!1,this.node=t}update(){}}class X9 extends Hu{constructor(t){super(t),t.animationState||(t.animationState=K9(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();jy(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let Y9=0;class Q9 extends Hu{constructor(){super(...arguments),this.id=Y9++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const J9={animation:{Feature:X9},exit:{Feature:Q9}};function Ym(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function Ep(e){return{point:{x:e.pageX,y:e.pageY}}}const Z9=e=>t=>V2(t)&&e(t,Ep(t));function Em(e,t,r,n){return Ym(e,t,Z9(r),n)}const o6=1e-4,eI=1-o6,tI=1+o6,l6=.01,rI=0-l6,nI=0+l6;function ni(e){return e.max-e.min}function sI(e,t,r){return Math.abs(e-t)<=r}function mC(e,t,r,n=.5){e.origin=n,e.originPoint=zn(t.min,t.max,e.origin),e.scale=ni(r)/ni(t),e.translate=zn(r.min,r.max,e.origin)-e.originPoint,(e.scale>=eI&&e.scale<=tI||isNaN(e.scale))&&(e.scale=1),(e.translate>=rI&&e.translate<=nI||isNaN(e.translate))&&(e.translate=0)}function Nm(e,t,r,n){mC(e.x,t.x,r.x,n?n.originX:void 0),mC(e.y,t.y,r.y,n?n.originY:void 0)}function pC(e,t,r){e.min=r.min+t.min,e.max=e.min+ni(t)}function aI(e,t,r){pC(e.x,t.x,r.x),pC(e.y,t.y,r.y)}function xC(e,t,r){e.min=t.min-r.min,e.max=e.min+ni(t)}function Am(e,t,r){xC(e.x,t.x,r.x),xC(e.y,t.y,r.y)}function lo(e){return[e("x"),e("y")]}const c6=({current:e})=>e?e.ownerDocument.defaultView:null,yC=(e,t)=>Math.abs(e-t);function iI(e,t){const r=yC(e.x,t.x),n=yC(e.y,t.y);return Math.sqrt(r**2+n**2)}class u6{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const g=Zv(this.lastMoveEventInfo,this.history),y=this.startEvent!==null,v=iI(g.offset,{x:0,y:0})>=this.distanceThreshold;if(!y&&!v)return;const{point:w}=g,{timestamp:b}=ga;this.history.push({...w,timestamp:b});const{onStart:E,onMove:k}=this.handlers;y||(E&&E(this.lastMoveEvent,g),this.startEvent=this.lastMoveEvent),k&&k(this.lastMoveEvent,g)},this.handlePointerMove=(g,y)=>{this.lastMoveEvent=g,this.lastMoveEventInfo=Jv(y,this.transformPagePoint),Bn.update(this.updatePoint,!0)},this.handlePointerUp=(g,y)=>{this.end();const{onEnd:v,onSessionEnd:w,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=Zv(g.type==="pointercancel"?this.lastMoveEventInfo:Jv(y,this.transformPagePoint),this.history);this.startEvent&&v&&v(g,E),w&&w(g,E)},!V2(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=Ep(t),c=Jv(o,this.transformPagePoint),{point:d}=c,{timestamp:f}=ga;this.history=[{...d,timestamp:f}];const{onSessionStart:p}=r;p&&p(t,Zv(c,this.history)),this.removeListeners=kp(Em(this.contextWindow,"pointermove",this.handlePointerMove),Em(this.contextWindow,"pointerup",this.handlePointerUp),Em(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Iu(this.updatePoint)}}function Jv(e,t){return t?{point:t(e.point)}:e}function vC(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Zv({point:e},t){return{point:e,delta:vC(e,d6(t)),offset:vC(e,oI(t)),velocity:lI(t,.1)}}function oI(e){return e[0]}function d6(e){return e[e.length-1]}function lI(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=d6(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>Tl(t)));)r--;if(!n)return{x:0,y:0};const a=El(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function cI(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?zn(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?zn(r,e,n.max):Math.min(e,r)),e}function wC(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function uI(e,{top:t,left:r,bottom:n,right:s}){return{x:wC(e.x,r,s),y:wC(e.y,t,n)}}function _C(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function dI(e,t){return{x:_C(e.x,t.x),y:_C(e.y,t.y)}}function fI(e,t){let r=.5;const n=ni(e),s=ni(t);return s>n?r=Gm(t.min,t.max-n,e.min):n>s&&(r=Gm(e.min,e.max-s,t.min)),bc(0,1,r)}function hI(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const w_=.35;function gI(e=w_){return e===!1?e=0:e===!0&&(e=w_),{x:bC(e,"left","right"),y:bC(e,"top","bottom")}}function bC(e,t,r){return{min:SC(e,t),max:SC(e,r)}}function SC(e,t){return typeof e=="number"?e:e[t]||0}const mI=new WeakMap;class pI{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=gs(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=p=>{const{dragSnapToOrigin:g}=this.getProps();g?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(Ep(p).point)},i=(p,g)=>{const{drag:y,dragPropagation:v,onDragStart:w}=this.getProps();if(y&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=k7(y),!this.openDragLock))return;this.latestPointerEvent=p,this.latestPanInfo=g,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),lo(E=>{let k=this.getAxisMotionValue(E).get()||0;if(Nl.test(k)){const{projection:_}=this.visualElement;if(_&&_.layout){const N=_.layout.layoutBox[E];N&&(k=ni(N)*(parseFloat(k)/100))}}this.originPoint[E]=k}),w&&Bn.postRender(()=>w(p,g)),y_(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},o=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g;const{dragPropagation:y,dragDirectionLock:v,onDirectionLock:w,onDrag:b}=this.getProps();if(!y&&!this.openDragLock)return;const{offset:E}=g;if(v&&this.currentDirection===null){this.currentDirection=xI(E),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",g.point,E),this.updateAxis("y",g.point,E),this.visualElement.render(),b&&b(p,g)},c=(p,g)=>{this.latestPointerEvent=p,this.latestPanInfo=g,this.stop(p,g),this.latestPointerEvent=null,this.latestPanInfo=null},d=()=>lo(p=>this.getAnimationState(p)==="paused"&&this.getAxisMotionValue(p).animation?.play()),{dragSnapToOrigin:f}=this.getProps();this.panSession=new u6(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:d},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:f,distanceThreshold:n,contextWindow:c6(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&Bn.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!r1(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=cI(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Mh(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=uI(n.layoutBox,t):this.constraints=!1,this.elastic=gI(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&lo(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=hI(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Mh(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=y9(n,s.root,this.visualElement.getTransformPagePoint());let i=dI(s.layout.layoutBox,a);if(r){const o=r(m9(i));this.hasMutatedConstraints=!!o,o&&(i=q5(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},d=lo(f=>{if(!r1(f,r,this.currentDirection))return;let p=c&&c[f]||{};i&&(p={min:0,max:0});const g=s?200:1e6,y=s?40:1e7,v={type:"inertia",velocity:n?t[f]:0,bounceStiffness:g,bounceDamping:y,timeConstant:750,restDelta:1,restSpeed:10,...a,...p};return this.startAxisValueAnimation(f,v)});return Promise.all(d).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return y_(this.visualElement,t),n.start(rb(t,n,0,r,this.visualElement,!1))}stopAnimation(){lo(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){lo(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){lo(r=>{const{drag:n}=this.getProps();if(!r1(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-zn(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Mh(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};lo(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=fI({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),lo(i=>{if(!r1(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:d}=this.constraints[i];o.set(zn(c,d,s[i]))})}addListeners(){if(!this.visualElement.current)return;mI.set(this.visualElement,this);const t=this.visualElement.current,r=Em(t,"pointerdown",c=>{const{drag:d,dragListener:f=!0}=this.getProps();d&&f&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Mh(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Bn.read(n);const i=Ym(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:d})=>{this.isDragging&&d&&(lo(f=>{const p=this.getAxisMotionValue(f);p&&(this.originPoint[f]+=c[f].translate,p.set(p.get()+c[f].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=w_,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function r1(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function xI(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class yI extends Hu{constructor(t){super(t),this.removeGroupControls=go,this.removeListeners=go,this.controls=new pI(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||go}unmount(){this.removeGroupControls(),this.removeListeners()}}const kC=e=>(t,r)=>{e&&Bn.postRender(()=>e(t,r))};class vI extends Hu{constructor(){super(...arguments),this.removePointerDownListener=go}onPointerDown(t){this.session=new u6(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:c6(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:kC(t),onStart:kC(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&Bn.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=Em(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const A1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function CC(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const kg={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(yr.test(e))e=parseFloat(e);else return e;const r=CC(e,t.target.x),n=CC(e,t.target.y);return`${r}% ${n}%`}},wI={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=Mu.parse(e);if(s.length>5)return n;const a=Mu.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const d=zn(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=d),typeof s[3+i]=="number"&&(s[3+i]/=d),a(s)}};let ew=!1;class _I extends C.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;z7(bI),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),ew&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),A1.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,ew=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||Bn.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),G2.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;ew=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function f6(e){const[t,r]=D5(),n=C.useContext(S2);return l.jsx(_I,{...e,layoutGroup:n,switchLayoutGroup:C.useContext(V5),isPresent:t,safeToRemove:r})}const bI={borderRadius:{...kg,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:kg,borderTopRightRadius:kg,borderBottomLeftRadius:kg,borderBottomRightRadius:kg,boxShadow:wI};function SI(e,t,r){const n=Ia(e)?e:r0(e);return n.start(rb("",n,t,r)),n.animation}const kI=(e,t)=>e.depth-t.depth;class CI{constructor(){this.children=[],this.isDirty=!1}add(t){T2(this.children,t),this.isDirty=!0}remove(t){E2(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(kI),this.isDirty=!1,this.children.forEach(t)}}function TI(e,t){const r=_i.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(Iu(n),e(a-t))};return Bn.setup(n,!0),()=>Iu(n)}const h6=["TopLeft","TopRight","BottomLeft","BottomRight"],EI=h6.length,TC=e=>typeof e=="string"?parseFloat(e):e,EC=e=>typeof e=="number"||yr.test(e);function NI(e,t,r,n,s,a){s?(e.opacity=zn(0,r.opacity??1,AI(n)),e.opacityExit=zn(t.opacity??1,0,jI(n))):a&&(e.opacity=zn(t.opacity??1,r.opacity??1,n));for(let i=0;i<EI;i++){const o=`border${h6[i]}Radius`;let c=NC(t,o),d=NC(r,o);if(c===void 0&&d===void 0)continue;c||(c=0),d||(d=0),c===0||d===0||EC(c)===EC(d)?(e[o]=Math.max(zn(TC(c),TC(d),n),0),(Nl.test(d)||Nl.test(c))&&(e[o]+="%")):e[o]=d}(t.rotate||r.rotate)&&(e.rotate=zn(t.rotate||0,r.rotate||0,n))}function NC(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const AI=g6(0,.5,e5),jI=g6(.5,.95,go);function g6(e,t,r){return n=>n<e?0:n>t?1:r(Gm(e,t,n))}function AC(e,t){e.min=t.min,e.max=t.max}function ro(e,t){AC(e.x,t.x),AC(e.y,t.y)}function jC(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function FC(e,t,r,n,s){return e-=t,e=W1(e,1/r,n),s!==void 0&&(e=W1(e,1/s,n)),e}function FI(e,t=0,r=1,n=.5,s,a=e,i=e){if(Nl.test(t)&&(t=parseFloat(t),t=zn(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=zn(a.min,a.max,n);e===a&&(o-=t),e.min=FC(e.min,t,r,o,s),e.max=FC(e.max,t,r,o,s)}function PC(e,t,[r,n,s],a,i){FI(e,t[r],t[n],t[s],t.scale,a,i)}const PI=["x","scaleX","originX"],RI=["y","scaleY","originY"];function RC(e,t,r,n){PC(e.x,t,PI,r?r.x:void 0,n?n.x:void 0),PC(e.y,t,RI,r?r.y:void 0,n?n.y:void 0)}function DC(e){return e.translate===0&&e.scale===1}function m6(e){return DC(e.x)&&DC(e.y)}function IC(e,t){return e.min===t.min&&e.max===t.max}function DI(e,t){return IC(e.x,t.x)&&IC(e.y,t.y)}function MC(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function p6(e,t){return MC(e.x,t.x)&&MC(e.y,t.y)}function OC(e){return ni(e.x)/ni(e.y)}function LC(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class II{constructor(){this.members=[]}add(t){T2(this.members,t),t.scheduleRender()}remove(t){if(E2(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function MI(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:d,rotate:f,rotateX:p,rotateY:g,skewX:y,skewY:v}=r;d&&(n=`perspective(${d}px) ${n}`),f&&(n+=`rotate(${f}deg) `),p&&(n+=`rotateX(${p}deg) `),g&&(n+=`rotateY(${g}deg) `),y&&(n+=`skewX(${y}deg) `),v&&(n+=`skewY(${v}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const tw=["","X","Y","Z"],OI=1e3;let LI=0;function rw(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function x6(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=r6(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Bn,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&x6(n)}function y6({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=LI++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach($I),this.nodes.forEach(GI),this.nodes.forEach(VI),this.nodes.forEach(WI)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new CI)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new j2),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=R5(i)&&!j7(i),this.instance=i;const{layoutId:o,layout:c,visualElement:d}=this.options;if(d&&!d.current&&d.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let f,p=0;const g=()=>this.root.updateBlockedByResize=!1;Bn.read(()=>{p=window.innerWidth}),e(i,()=>{const y=window.innerWidth;y!==p&&(p=y,this.root.updateBlockedByResize=!0,f&&f(),f=TI(g,250),A1.hasAnimatedSinceResize&&(A1.hasAnimatedSinceResize=!1,this.nodes.forEach($C)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&d&&(o||c)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:p,hasRelativeLayoutChanged:g,layout:y})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const v=this.options.transition||d.getDefaultTransition()||QI,{onLayoutAnimationStart:w,onLayoutAnimationComplete:b}=d.getProps(),E=!this.targetLayout||!p6(this.targetLayout,y),k=!p&&g;if(this.options.layoutRoot||this.resumeFrom||k||p&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...z2(v,"layout"),onPlay:w,onComplete:b};(d.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(f,k)}else p||$C(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=y})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Iu(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(KI),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&x6(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let f=0;f<this.path.length;f++){const p=this.path[f];p.shouldResetTransform=!0,p.updateScroll("snapshot"),p.options.layoutRoot&&p.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(BC);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(UC);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(HI),this.nodes.forEach(BI),this.nodes.forEach(UI)):this.nodes.forEach(UC),this.clearAllSnapshots();const o=_i.now();ga.delta=bc(0,1e3/60,o-ga.timestamp),ga.timestamp=o,ga.isProcessing=!0,Hv.update.process(ga),Hv.preRender.process(ga),Hv.render.process(ga),ga.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,G2.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(zI),this.sharedNodes.forEach(qI)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Bn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Bn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!ni(this.snapshot.measuredBox.x)&&!ni(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=gs(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!m6(this.projectionDelta),c=this.getTransformTemplate(),d=c?c(this.latestValues,""):void 0,f=d!==this.prevTransformTemplateValue;i&&this.instance&&(o||Rd(this.latestValues)||f)&&(s(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),JI(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return gs();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(ZI))){const{scroll:d}=this.root;d&&(Oh(o.x,d.offset.x),Oh(o.y,d.offset.y))}return o}removeElementScroll(i){const o=gs();if(ro(o,i),this.scroll?.wasRoot)return o;for(let c=0;c<this.path.length;c++){const d=this.path[c],{scroll:f,options:p}=d;d!==this.root&&f&&p.layoutScroll&&(f.wasRoot&&ro(o,i),Oh(o.x,f.offset.x),Oh(o.y,f.offset.y))}return o}applyTransform(i,o=!1){const c=gs();ro(c,i);for(let d=0;d<this.path.length;d++){const f=this.path[d];!o&&f.options.layoutScroll&&f.scroll&&f!==f.root&&Lh(c,{x:-f.scroll.offset.x,y:-f.scroll.offset.y}),Rd(f.latestValues)&&Lh(c,f.latestValues)}return Rd(this.latestValues)&&Lh(c,this.latestValues),c}removeTransform(i){const o=gs();ro(o,i);for(let c=0;c<this.path.length;c++){const d=this.path[c];if(!d.instance||!Rd(d.latestValues))continue;g_(d.latestValues)&&d.updateSnapshot();const f=gs(),p=d.measurePageBox();ro(f,p),RC(o,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,f)}return Rd(this.latestValues)&&RC(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ga.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:p}=this.options;if(!(!this.layout||!(f||p))){if(this.resolvedRelativeTargetAt=ga.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gs(),this.relativeTargetOrigin=gs(),Am(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),ro(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=gs(),this.targetWithTransforms=gs()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),aI(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ro(this.target,this.layout.layoutBox),Y5(this.target,this.targetDelta)):ro(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gs(),this.relativeTargetOrigin=gs(),Am(this.relativeTargetOrigin,this.target,g.target),ro(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||g_(this.parent.latestValues)||X5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===ga.timestamp&&(c=!1),c)return;const{layout:d,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||f))return;ro(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,g=this.treeScale.y;x9(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=gs());const{target:y}=i;if(!y){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(jC(this.prevProjectionDelta.x,this.projectionDelta.x),jC(this.prevProjectionDelta.y,this.projectionDelta.y)),Nm(this.projectionDelta,this.layoutCorrected,y,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==g||!LC(this.projectionDelta.x,this.prevProjectionDelta.x)||!LC(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",y))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Bh(),this.projectionDelta=Bh(),this.projectionDeltaWithTransform=Bh()}setAnimationOrigin(i,o=!1){const c=this.snapshot,d=c?c.latestValues:{},f={...this.latestValues},p=Bh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const g=gs(),y=c?c.source:void 0,v=this.layout?this.layout.source:void 0,w=y!==v,b=this.getStack(),E=!b||b.members.length<=1,k=!!(w&&!E&&this.options.crossfade===!0&&!this.path.some(YI));this.animationProgress=0;let _;this.mixTargetDelta=N=>{const A=N/1e3;WC(p.x,i.x,A),WC(p.y,i.y,A),this.setTargetDelta(p),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Am(g,this.layout.layoutBox,this.relativeParent.layout.layoutBox),XI(this.relativeTarget,this.relativeTargetOrigin,g,A),_&&DI(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=gs()),ro(_,this.relativeTarget)),w&&(this.animationValues=f,NI(f,d,this.latestValues,A,k,E)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Iu(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Bn.update(()=>{A1.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=r0(0)),this.currentAnimation=SI(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(OI),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:d,latestValues:f}=i;if(!(!o||!c||!d)){if(this!==i&&this.layout&&d&&v6(this.options.animationType,this.layout.layoutBox,d.layoutBox)){c=this.target||gs();const p=ni(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+p;const g=ni(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+g}ro(o,c),Lh(o,f),Nm(this.projectionDeltaWithTransform,this.layoutCorrected,o,f)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new II),this.sharedNodes.get(i).add(o);const d=o.options.initialPromotionConfig;o.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const d=this.getStack();d&&d.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const d={};c.z&&rw("z",i,d,this.animationValues);for(let f=0;f<tw.length;f++)rw(`rotate${tw[f]}`,i,d,this.animationValues),rw(`skew${tw[f]}`,i,d,this.animationValues);i.render();for(const f in d)i.setStaticValue(f,d[f]),this.animationValues&&(this.animationValues[f]=d[f]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=N1(o?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const d=this.getLead();if(!this.projectionDelta||!this.layout||!d.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=N1(o?.pointerEvents)||""),this.hasProjected&&!Rd(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const f=d.animationValues||d.latestValues;this.applyTransformsToTarget();let p=MI(this.projectionDeltaWithTransform,this.treeScale,f);c&&(p=c(f,p)),i.transform=p;const{x:g,y}=this.projectionDelta;i.transformOrigin=`${g.origin*100}% ${y.origin*100}% 0`,d.animationValues?i.opacity=d===this?f.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:i.opacity=d===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const v in Xm){if(f[v]===void 0)continue;const{correct:w,applyTo:b,isCSSVariable:E}=Xm[v],k=p==="none"?f[v]:w(f[v],d);if(b){const _=b.length;for(let N=0;N<_;N++)i[b[N]]=k}else E?this.options.visualElement.renderState.vars[v]=k:i[v]=k}this.options.layoutId&&(i.pointerEvents=d===this?N1(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(BC),this.root.sharedNodes.clear()}}}function BI(e){e.updateLayout()}function UI(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?lo(f=>{const p=a?t.measuredBox[f]:t.layoutBox[f],g=ni(p);p.min=r[f].min,p.max=p.min+g}):v6(s,t.layoutBox,r)&&lo(f=>{const p=a?t.measuredBox[f]:t.layoutBox[f],g=ni(r[f]);p.max=p.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[f].max=e.relativeTarget[f].min+g)});const i=Bh();Nm(i,r,t.layoutBox);const o=Bh();a?Nm(o,e.applyTransform(n,!0),t.measuredBox):Nm(o,r,t.layoutBox);const c=!m6(i);let d=!1;if(!e.resumeFrom){const f=e.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:p,layout:g}=f;if(p&&g){const y=gs();Am(y,t.layoutBox,p.layoutBox);const v=gs();Am(v,r,g.layoutBox),p6(y,v)||(d=!0),f.options.layoutRoot&&(e.relativeTarget=v,e.relativeTargetOrigin=y,e.relativeParent=f)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:d})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function $I(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function WI(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function zI(e){e.clearSnapshot()}function BC(e){e.clearMeasurements()}function UC(e){e.isLayoutDirty=!1}function HI(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function $C(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function GI(e){e.resolveTargetDelta()}function VI(e){e.calcProjection()}function KI(e){e.resetSkewAndRotation()}function qI(e){e.removeLeadSnapshot()}function WC(e,t,r){e.translate=zn(t.translate,0,r),e.scale=zn(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function zC(e,t,r,n){e.min=zn(t.min,r.min,n),e.max=zn(t.max,r.max,n)}function XI(e,t,r,n){zC(e.x,t.x,r.x,n),zC(e.y,t.y,r.y,n)}function YI(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const QI={duration:.45,ease:[.4,0,.1,1]},HC=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),GC=HC("applewebkit/")&&!HC("chrome/")?Math.round:go;function VC(e){e.min=GC(e.min),e.max=GC(e.max)}function JI(e){VC(e.x),VC(e.y)}function v6(e,t,r){return e==="position"||e==="preserve-aspect"&&!sI(OC(t),OC(r),.2)}function ZI(e){return e!==e.root&&e.scroll?.wasRoot}const eM=y6({attachResizeListener:(e,t)=>Ym(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),nw={current:void 0},w6=y6({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!nw.current){const e=new eM({});e.mount(window),e.setOptions({layoutScroll:!0}),nw.current=e}return nw.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),tM={pan:{Feature:vI},drag:{Feature:yI,ProjectionNode:w6,MeasureLayout:f6}};function KC(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&Bn.postRender(()=>a(t,Ep(t)))}class rM extends Hu{mount(){const{current:t}=this.node;t&&(this.unmount=C7(t,(r,n)=>(KC(this.node,n,"Start"),s=>KC(this.node,s,"End"))))}unmount(){}}class nM extends Hu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=kp(Ym(this.node.current,"focus",()=>this.onFocus()),Ym(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function qC(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&Bn.postRender(()=>a(t,Ep(t)))}class sM extends Hu{mount(){const{current:t}=this.node;t&&(this.unmount=A7(t,(r,n)=>(qC(this.node,n,"Start"),(s,{success:a})=>qC(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const __=new WeakMap,sw=new WeakMap,aM=e=>{const t=__.get(e.target);t&&t(e)},iM=e=>{e.forEach(aM)};function oM({root:e,...t}){const r=e||document;sw.has(r)||sw.set(r,{});const n=sw.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(iM,{root:e,...t})),n[s]}function lM(e,t,r){const n=oM(t);return __.set(e,r),n.observe(e),()=>{__.delete(e),n.unobserve(e)}}const cM={some:0,all:1};class uM extends Hu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:cM[s]},o=c=>{const{isIntersecting:d}=c;if(this.isInView===d||(this.isInView=d,a&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:f,onViewportLeave:p}=this.node.getProps(),g=d?f:p;g&&g(c)};return lM(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(dM(t,r))&&this.startObserver()}unmount(){}}function dM({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const fM={inView:{Feature:uM},tap:{Feature:sM},focus:{Feature:nM},hover:{Feature:rM}},hM={layout:{ProjectionNode:w6,MeasureLayout:f6}},gM={...J9,...fM,...tM,...hM},Xe=g9(gM,E9),Ze=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},d={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},f=s?"opacity-50 cursor-not-allowed":"";return l.jsx(Xe.button,{className:`${o} ${c[t]} ${d[r]} ${f} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Tr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return l.jsx(Xe.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},Vo=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,c]=C.useState(!0),[d,f]=C.useState(!1),p=C.useRef(null),g=C.useRef(null);C.useEffect(()=>{if(r>0)return g.current=setTimeout(()=>{y()},r),()=>{g.current&&clearTimeout(g.current)}},[r]);const y=C.useCallback(()=>{d||(f(!0),g.current&&clearTimeout(g.current),setTimeout(()=>{c(!1),s&&s()},300))},[d,s]),v=C.useCallback(E=>{E.key==="Escape"&&y()},[y]);if(!o)return null;const w=["notification",`notification-${e}`,o?"notification-visible":"",d?"notification-exiting":"",a].filter(Boolean).join(" "),b=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return l.jsx("div",{ref:p,className:w,role:"alert","aria-live":"polite",onKeyDown:v,tabIndex:-1,...i,children:l.jsxs("div",{className:"notification-content",children:[l.jsx("div",{className:"notification-icon","aria-hidden":"true",children:b()}),l.jsx("div",{className:"notification-body",children:l.jsx("div",{className:"notification-message",children:t})}),n&&l.jsx("button",{className:"notification-close",onClick:y,type:"button","aria-label":"Close notification",children:""})]})})},ba=()=>{const[e,t]=C.useState([]),r=C.useCallback((a,i="info",o={})=>{const c=Date.now()+Math.random(),d={id:c,message:a,type:i,...o};return t(f=>[...f,d]),o.duration!==0&&setTimeout(()=>{n(c)},o.duration||3e3),c},[]),n=C.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=C.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},Wi=()=>{const[e,t]=C.useState(!1),[r,n]=C.useState(null),[s,a]=C.useState(null),i=C.useRef(null);C.useRef(new Map);const o=C.useRef(0),c=3,d=1e3,f=C.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);C.useEffect(()=>f,[f]);const p=C.useCallback(async(O,z={})=>{try{t(!0),n(null),i.current=new AbortController;const Y=z.method||"POST",J={method:Y,headers:{"Content-Type":"application/json",...z.headers},signal:i.current.signal,...z};Y!=="GET"&&Y!=="HEAD"&&(J.body=JSON.stringify(z.data||{})),console.log(`[API] Making request to: ${O}`,J);const te=await fetch(O,J);if(!te.ok)throw new Error(`HTTP error! status: ${te.status}`);const ee=await te.json();if(console.log("[API] Response received:",ee),ee.success)return a(ee),o.current=0,ee;throw new Error(ee.error||ee.message||"Request failed")}catch(Y){if(Y.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",Y),n(Y.message||"Request failed"),o.current<c){o.current++;const J=d*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${J}ms (attempt ${o.current}/${c})`),await new Promise(te=>setTimeout(te,J)),p(O,z)}throw Y}finally{t(!1),i.current=null}},[]),g=C.useCallback(async(O,z={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(O,z)}catch(Y){throw console.error("[API] Authenticated request failed:",Y),Y}},[]),y=C.useCallback(async(O,z)=>{try{const Y=`/.netlify/functions/get-test-questions?test_type=${O}&test_id=${z}`;console.log(`[API] Getting test info for ${O}_${z}`);const te=await(await g(Y)).json();if(te.success)return console.log("[API] Test info retrieved successfully:",te.test_info),te.test_info;throw new Error(te.error||"Failed to get test info")}catch(Y){throw console.error("[API] Failed to get test info:",Y),Y}},[g]),v=C.useCallback(async(O,z)=>{try{const Y=`/.netlify/functions/get-test-questions?test_type=${O}&test_id=${z}`;console.log(`[API] Getting test questions for ${O}_${z}`);const te=await(await g(Y)).json();if(te.success)return console.log("[API] Test questions retrieved successfully:",te.questions),te.questions;throw new Error(te.error||"Failed to get test questions")}catch(Y){throw console.error("[API] Failed to get test questions:",Y),Y}},[g]),w=C.useCallback(async()=>{try{const O="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const Y=await(await g(O)).json();if(Y.success)return console.log("[API] Student active tests loaded successfully:",Y.tests),Y.tests;throw new Error(Y.error||"Failed to load student active tests")}catch(O){throw console.error("[API] Failed to load student active tests:",O),O}},[g]),b=C.useCallback(async(O,z,Y)=>{try{let J;switch(O){case"true_false":J="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":J="/.netlify/functions/submit-multiple-choice-test";break;case"input":J="/.netlify/functions/submit-input-test";break;case"matching_type":J="/.netlify/functions/submit-matching-type-test";break;case"speaking":J="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${O}`)}console.log(`[API] Submitting ${O} test:`,Y);const ee=await(await g(J,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).json();if(ee.success)return console.log("[API] Test submitted successfully:",ee),ee;throw new Error(ee.error||"Failed to submit test")}catch(J){throw console.error("[API] Failed to submit test:",J),J}},[g]),E=C.useCallback(async O=>{try{const z="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",O);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(J.success)return console.log("[API] Multiple choice test saved successfully:",J),J;throw new Error(J.error||"Failed to save multiple choice test")}catch(z){throw console.error("[API] Failed to save multiple choice test:",z),z}},[g]),k=C.useCallback(async O=>{try{const z="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",O);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(J.success)return console.log("[API] True/false test saved successfully:",J),J;throw new Error(J.error||"Failed to save true/false test")}catch(z){throw console.error("[API] Failed to save true/false test:",z),z}},[g]),_=C.useCallback(async O=>{try{const z="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",O);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(J.success)return console.log("[API] Input test saved successfully:",J),J;throw new Error(J.error||"Failed to save input test")}catch(z){throw console.error("[API] Failed to save input test:",z),z}},[g]),N=C.useCallback(async O=>{try{const z="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",O);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(J.success)return console.log("[API] Test assigned successfully:",J),J;throw new Error(J.error||"Failed to assign test")}catch(z){throw console.error("[API] Failed to assign test:",z),z}},[g]),A=C.useCallback(async()=>{try{const O="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const Y=await(await g(O)).json();if(Y.success)return console.log("[API] Teacher active tests loaded successfully:",Y.tests),Y.tests;throw new Error(Y.error||"Failed to load teacher active tests")}catch(O){throw console.error("[API] Failed to load teacher active tests:",O),O}},[g]),P=C.useCallback(async()=>{try{const O="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const Y=await(await g(O)).json();if(Y.success)return console.log("[API] All users loaded successfully:",Y.users),Y.users;throw new Error(Y.error||"Failed to get all users")}catch(O){throw console.error("[API] Failed to get all users:",O),O}},[g]),R=C.useCallback(async()=>{try{const O="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const Y=await(await g(O)).json();if(Y.success)return console.log("[API] All teachers loaded successfully:",Y.teachers),Y.teachers;throw new Error(Y.error||"Failed to get all teachers")}catch(O){throw console.error("[API] Failed to get all teachers:",O),O}},[g]),T=C.useCallback(async()=>{try{const O="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const Y=await(await g(O)).json();if(Y.success)return console.log("[API] All subjects loaded successfully:",Y.subjects),Y.subjects;throw new Error(Y.error||"Failed to get all subjects")}catch(O){throw console.error("[API] Failed to get all subjects:",O),O}},[g]),D=C.useCallback(()=>{n(null)},[]),I=C.useCallback(()=>{a(null)},[]),K=C.useCallback(()=>{t(!1),n(null),a(null),o.current=0,f()},[f]),X=C.useCallback(async(O,z={})=>{const J=await(await g(O,{...z,method:"GET"})).json();if(J.success)return J;throw new Error(J.error||"Request failed")},[g]),Z=C.useCallback(async(O,z,Y={})=>{const te=await(await g(O,{...Y,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(te.success)return te;throw new Error(te.error||"Request failed")},[g]),oe=C.useCallback(async(O,z,Y={})=>{const te=await(await g(O,{...Y,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)})).json();if(te.success)return te;throw new Error(te.error||"Request failed")},[g]),q=C.useCallback(async(O,z={})=>{const J=await(await g(O,{...z,method:"DELETE"})).json();if(J.success)return J;throw new Error(J.error||"Request failed")},[g]),re=C.useCallback(async O=>{try{const z="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",O);const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(J.success)return console.log("[API] Speaking test submitted successfully:",J),J;throw new Error(J.error||"Failed to submit speaking test")}catch(z){throw console.error("[API] Failed to submit speaking test:",z),z}},[g]),M=C.useCallback(async O=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${O}`;console.log("[API] Getting speaking test:",O);const J=await(await g(z,{method:"GET"})).json();if(J.success)return console.log("[API] Speaking test loaded successfully:",J),J;throw new Error(J.error||"Failed to load speaking test")}catch(z){throw console.error("[API] Failed to load speaking test:",z),z}},[g]),W=C.useCallback(async O=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${O}`;console.log("[API] Getting speaking test questions:",O);const J=await(await g(z,{method:"GET"})).json();if(J.success)return console.log("[API] Speaking test questions loaded successfully:",J),J;throw new Error(J.error||"Failed to load speaking test questions")}catch(z){throw console.error("[API] Failed to load speaking test questions:",z),z}},[g]),B=C.useCallback(async O=>{try{const z="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const J=await(await g(z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)})).json();if(J.success)return console.log("[API] Audio uploaded successfully:",J),J;throw new Error(J.error||"Failed to upload audio")}catch(z){throw console.error("[API] Failed to upload audio:",z),z}},[g]),G=C.useCallback(async O=>{try{const z=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(O)}`;console.log("[API] Getting speaking audio:",O);const J=await(await g(z,{method:"GET"})).json();if(J.success)return console.log("[API] Audio URL retrieved successfully:",J),J;throw new Error(J.error||"Failed to get audio")}catch(z){throw console.error("[API] Failed to get audio:",z),z}},[g]),H=C.useCallback(async(O,z)=>{try{const Y=`/.netlify/functions/check-test-completion?test_id=${O}&test_type=${z}`;console.log("[API] Checking test completion:",O,z);const te=await(await g(Y,{method:"GET"})).json();if(te.success)return console.log("[API] Test completion status:",te),te;throw new Error(te.error||"Failed to check test completion")}catch(Y){throw console.error("[API] Failed to check test completion:",Y),Y}},[g]);return{loading:e,error:r,data:s,sendRequest:p,makeAuthenticatedRequest:g,get:X,post:Z,put:oe,delete:q,getTestInfo:y,getTestQuestions:v,loadStudentActiveTests:w,submitTest:b,submitSpeakingTest:re,getSpeakingTest:M,getSpeakingTestQuestions:W,uploadSpeakingAudio:B,getSpeakingAudio:G,checkTestCompletion:H,saveMultipleChoiceTest:E,saveTrueFalseTest:k,saveInputTest:_,assignTestToClasses:N,loadTeacherActiveTests:A,getAllUsers:P,getAllTeachers:R,getAllSubjects:T,clearError:D,clearData:I,reset:K,cleanup:f}},mM="modulepreload",pM=function(e){return"/"+e},XC={},Au=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let d=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};var i=d;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=d(r.map(f=>{if(f=pM(f),f in XC)return;XC[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":mM,p||(y.as="script"),y.crossOrigin="",y.href=f,c&&y.setAttribute("nonce",c),document.head.appendChild(y),p)return new Promise((v,w)=>{y.addEventListener("load",v),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})};var j1={exports:{}},Cg={},aw={},iw={},YC;function Mr(){return YC||(YC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof O1<"u"?O1:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(iw)),iw}var ow={},QC;function as(){return QC||(QC=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=Mr();class r{constructor(N=[1,0,0,1,0,0]){this.dirty=!1,this.m=N&&N.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(N){N.m[0]=this.m[0],N.m[1]=this.m[1],N.m[2]=this.m[2],N.m[3]=this.m[3],N.m[4]=this.m[4],N.m[5]=this.m[5]}point(N){const A=this.m;return{x:A[0]*N.x+A[2]*N.y+A[4],y:A[1]*N.x+A[3]*N.y+A[5]}}translate(N,A){return this.m[4]+=this.m[0]*N+this.m[2]*A,this.m[5]+=this.m[1]*N+this.m[3]*A,this}scale(N,A){return this.m[0]*=N,this.m[1]*=N,this.m[2]*=A,this.m[3]*=A,this}rotate(N){const A=Math.cos(N),P=Math.sin(N),R=this.m[0]*A+this.m[2]*P,T=this.m[1]*A+this.m[3]*P,D=this.m[0]*-P+this.m[2]*A,I=this.m[1]*-P+this.m[3]*A;return this.m[0]=R,this.m[1]=T,this.m[2]=D,this.m[3]=I,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(N,A){const P=this.m[0]+this.m[2]*A,R=this.m[1]+this.m[3]*A,T=this.m[2]+this.m[0]*N,D=this.m[3]+this.m[1]*N;return this.m[0]=P,this.m[1]=R,this.m[2]=T,this.m[3]=D,this}multiply(N){const A=this.m[0]*N.m[0]+this.m[2]*N.m[1],P=this.m[1]*N.m[0]+this.m[3]*N.m[1],R=this.m[0]*N.m[2]+this.m[2]*N.m[3],T=this.m[1]*N.m[2]+this.m[3]*N.m[3],D=this.m[0]*N.m[4]+this.m[2]*N.m[5]+this.m[4],I=this.m[1]*N.m[4]+this.m[3]*N.m[5]+this.m[5];return this.m[0]=A,this.m[1]=P,this.m[2]=R,this.m[3]=T,this.m[4]=D,this.m[5]=I,this}invert(){const N=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),A=this.m[3]*N,P=-this.m[1]*N,R=-this.m[2]*N,T=this.m[0]*N,D=N*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),I=N*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=A,this.m[1]=P,this.m[2]=R,this.m[3]=T,this.m[4]=D,this.m[5]=I,this}getMatrix(){return this.m}decompose(){const N=this.m[0],A=this.m[1],P=this.m[2],R=this.m[3],T=this.m[4],D=this.m[5],I=N*R-A*P,K={x:T,y:D,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(N!=0||A!=0){const X=Math.sqrt(N*N+A*A);K.rotation=A>0?Math.acos(N/X):-Math.acos(N/X),K.scaleX=X,K.scaleY=I/X,K.skewX=(N*P+A*R)/I,K.skewY=0}else if(P!=0||R!=0){const X=Math.sqrt(P*P+R*R);K.rotation=Math.PI/2-(R>0?Math.acos(-P/X):-Math.acos(P/X)),K.scaleX=I/X,K.scaleY=X,K.skewX=0,K.skewY=(N*P+A*R)/I}return K.rotation=e.Util._getRotation(K.rotation),K}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,c=180/Math.PI,d="#",f="",p="0",g="Konva warning: ",y="Konva error: ",v="rgb(",w={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},b=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let E=[];const k=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};e.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===n},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===a},_isBoolean(_){return Object.prototype.toString.call(_)===i},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;const N=_[0];return N==="#"||N==="."||N===N.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){E.push(_),E.length===1&&k(function(){const N=E;E=[],N.forEach(function(A){A()})})},createCanvasElement(){const _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,N){const A=e.Util.createImageElement();A.onload=function(){N(A)},A.src=_},_rgbToHex(_,N,A){return((1<<24)+(_<<16)+(N<<8)+A).toString(16).slice(1)},_hexToRgb(_){_=_.replace(d,f);const N=parseInt(_,16);return{r:N>>16&255,g:N>>8&255,b:N&255}},getRandomColor(){let _=(Math.random()*16777215<<0).toString(16);for(;_.length<6;)_=p+_;return d+_},getRGB(_){let N;return _ in w?(N=w[_],{r:N[0],g:N[1],b:N[2]}):_[0]===d?this._hexToRgb(_.substring(1)):_.substr(0,4)===v?(N=b.exec(_.replace(/ /g,"")),{r:parseInt(N[1],10),g:parseInt(N[2],10),b:parseInt(N[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",e.Util._namedColorToRBA(_)||e.Util._hex3ColorToRGBA(_)||e.Util._hex4ColorToRGBA(_)||e.Util._hex6ColorToRGBA(_)||e.Util._hex8ColorToRGBA(_)||e.Util._rgbColorToRGBA(_)||e.Util._rgbaColorToRGBA(_)||e.Util._hslColorToRGBA(_)},_namedColorToRBA(_){const N=w[_.toLowerCase()];return N?{r:N[0],g:N[1],b:N[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];const N=_.split(/ *, */).map(Number);return{r:N[0],g:N[1],b:N[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];const N=_.split(/ *, */).map((A,P)=>A.slice(-1)==="%"?P===3?parseInt(A)/100:parseInt(A)/100*255:Number(A));return{r:N[0],g:N[1],b:N[2],a:N[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[N,...A]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),P=Number(A[0])/360,R=Number(A[1])/100,T=Number(A[2])/100;let D,I,K;if(R===0)return K=T*255,{r:Math.round(K),g:Math.round(K),b:Math.round(K),a:1};T<.5?D=T*(1+R):D=T+R-T*R;const X=2*T-D,Z=[0,0,0];for(let oe=0;oe<3;oe++)I=P+1/3*-(oe-1),I<0&&I++,I>1&&I--,6*I<1?K=X+(D-X)*6*I:2*I<1?K=D:3*I<2?K=X+(D-X)*(2/3-I)*6:K=X,Z[oe]=K*255;return{r:Math.round(Z[0]),g:Math.round(Z[1]),b:Math.round(Z[2]),a:1}}},haveIntersection(_,N){return!(N.x>_.x+_.width||N.x+N.width<_.x||N.y>_.y+_.height||N.y+N.height<_.y)},cloneObject(_){const N={};for(const A in _)this._isPlainObject(_[A])?N[A]=this.cloneObject(_[A]):this._isArray(_[A])?N[A]=this.cloneArray(_[A]):N[A]=_[A];return N},cloneArray(_){return _.slice(0)},degToRad(_){return _*o},radToDeg(_){return _*c},_degToRad(_){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(_)},_radToDeg(_){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(_)},_getRotation(_){return t.Konva.angleDeg?e.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(y+_)},error(_){console.error(y+_)},warn(_){t.Konva.showWarnings&&console.warn(g+_)},each(_,N){for(const A in _)N(A,_[A])},_inRange(_,N,A){return N<=_&&_<A},_getProjectionToSegment(_,N,A,P,R,T){let D,I,K;const X=(_-A)*(_-A)+(N-P)*(N-P);if(X==0)D=_,I=N,K=(R-A)*(R-A)+(T-P)*(T-P);else{const Z=((R-_)*(A-_)+(T-N)*(P-N))/X;Z<0?(D=_,I=N,K=(_-R)*(_-R)+(N-T)*(N-T)):Z>1?(D=A,I=P,K=(A-R)*(A-R)+(P-T)*(P-T)):(D=_+Z*(A-_),I=N+Z*(P-N),K=(D-R)*(D-R)+(I-T)*(I-T))}return[D,I,K]},_getProjectionToLine(_,N,A){const P=e.Util.cloneObject(_);let R=Number.MAX_VALUE;return N.forEach(function(T,D){if(!A&&D===N.length-1)return;const I=N[(D+1)%N.length],K=e.Util._getProjectionToSegment(T.x,T.y,I.x,I.y,_.x,_.y),X=K[0],Z=K[1],oe=K[2];oe<R&&(P.x=X,P.y=Z,R=oe)}),P},_prepareArrayForTween(_,N,A){const P=[],R=[];if(_.length>N.length){const D=N;N=_,_=D}for(let D=0;D<_.length;D+=2)P.push({x:_[D],y:_[D+1]});for(let D=0;D<N.length;D+=2)R.push({x:N[D],y:N[D+1]});const T=[];return R.forEach(function(D){const I=e.Util._getProjectionToLine(D,P,A);T.push(I.x),T.push(I.y)}),T},_prepareToStringify(_){let N;_.visitedByCircularReferenceRemoval=!0;for(const A in _)if(_.hasOwnProperty(A)&&_[A]&&typeof _[A]=="object"){if(N=Object.getOwnPropertyDescriptor(_,A),_[A].visitedByCircularReferenceRemoval||e.Util._isElement(_[A]))if(N.configurable)delete _[A];else return null;else if(e.Util._prepareToStringify(_[A])===null)if(N.configurable)delete _[A];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,N){for(const A in N)_[A]=N[A];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){t.Konva.releaseCanvasOnDestroy&&_.forEach(N=>{N.width=0,N.height=0})},drawRoundedRectPath(_,N,A,P){let R=0,T=0,D=0,I=0;typeof P=="number"?R=T=D=I=Math.min(P,N/2,A/2):(R=Math.min(P[0]||0,N/2,A/2),T=Math.min(P[1]||0,N/2,A/2),I=Math.min(P[2]||0,N/2,A/2),D=Math.min(P[3]||0,N/2,A/2)),_.moveTo(R,0),_.lineTo(N-T,0),_.arc(N-T,T,T,Math.PI*3/2,0,!1),_.lineTo(N,A-I),_.arc(N-I,A-I,I,0,Math.PI/2,!1),_.lineTo(D,A),_.arc(D,A-D,D,Math.PI/2,Math.PI,!1),_.lineTo(0,R),_.arc(R,R,R,Math.PI,Math.PI*3/2,!1)}}})(ow)),ow}var Tg={},lc={},cc={},JC;function _6(){if(JC)return cc;JC=1,Object.defineProperty(cc,"__esModule",{value:!0}),cc.HitContext=cc.SceneContext=cc.Context=void 0;const e=as(),t=Mr();function r(E){const k=[],_=E.length,N=e.Util;for(let A=0;A<_;A++){let P=E[A];N._isNumber(P)?P=Math.round(P*1e3)/1e3:N._isString(P)||(P=P+""),k.push(P)}return k}const n=",",s="(",a=")",i="([",o="])",c=";",d="()",f="=",p=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],g=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],y=100;let v=class{constructor(k){this.canvas=k,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(k){k.fillEnabled()&&this._fill(k)}_fill(k){}strokeShape(k){k.hasStroke()&&this._stroke(k)}_stroke(k){}fillStrokeShape(k){k.attrs.fillAfterStrokeEnabled?(this.strokeShape(k),this.fillShape(k)):(this.fillShape(k),this.strokeShape(k))}getTrace(k,_){let N=this.traceArr,A=N.length,P="",R,T,D,I;for(R=0;R<A;R++)T=N[R],D=T.method,D?(I=T.args,P+=D,k?P+=d:e.Util._isArray(I[0])?P+=i+I.join(n)+o:(_&&(I=I.map(K=>typeof K=="number"?Math.floor(K):K)),P+=s+I.join(n)+a)):(P+=T.property,k||(P+=f+T.val)),P+=c;return P}clearTrace(){this.traceArr=[]}_trace(k){let _=this.traceArr,N;_.push(k),N=_.length,N>=y&&_.shift()}reset(){const k=this.getCanvas().getPixelRatio();this.setTransform(1*k,0,0,1*k,0,0)}getCanvas(){return this.canvas}clear(k){const _=this.getCanvas();k?this.clearRect(k.x||0,k.y||0,k.width||0,k.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(k){const _=k.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(k){const _=k.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(k){const _=k.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(k,_){this._context[k]=_}arc(k,_,N,A,P,R){this._context.arc(k,_,N,A,P,R)}arcTo(k,_,N,A,P){this._context.arcTo(k,_,N,A,P)}beginPath(){this._context.beginPath()}bezierCurveTo(k,_,N,A,P,R){this._context.bezierCurveTo(k,_,N,A,P,R)}clearRect(k,_,N,A){this._context.clearRect(k,_,N,A)}clip(...k){this._context.clip.apply(this._context,k)}closePath(){this._context.closePath()}createImageData(k,_){const N=arguments;if(N.length===2)return this._context.createImageData(k,_);if(N.length===1)return this._context.createImageData(k)}createLinearGradient(k,_,N,A){return this._context.createLinearGradient(k,_,N,A)}createPattern(k,_){return this._context.createPattern(k,_)}createRadialGradient(k,_,N,A,P,R){return this._context.createRadialGradient(k,_,N,A,P,R)}drawImage(k,_,N,A,P,R,T,D,I){const K=arguments,X=this._context;K.length===3?X.drawImage(k,_,N):K.length===5?X.drawImage(k,_,N,A,P):K.length===9&&X.drawImage(k,_,N,A,P,R,T,D,I)}ellipse(k,_,N,A,P,R,T,D){this._context.ellipse(k,_,N,A,P,R,T,D)}isPointInPath(k,_,N,A){return N?this._context.isPointInPath(N,k,_,A):this._context.isPointInPath(k,_,A)}fill(...k){this._context.fill.apply(this._context,k)}fillRect(k,_,N,A){this._context.fillRect(k,_,N,A)}strokeRect(k,_,N,A){this._context.strokeRect(k,_,N,A)}fillText(k,_,N,A){A?this._context.fillText(k,_,N,A):this._context.fillText(k,_,N)}measureText(k){return this._context.measureText(k)}getImageData(k,_,N,A){return this._context.getImageData(k,_,N,A)}lineTo(k,_){this._context.lineTo(k,_)}moveTo(k,_){this._context.moveTo(k,_)}rect(k,_,N,A){this._context.rect(k,_,N,A)}roundRect(k,_,N,A,P){this._context.roundRect(k,_,N,A,P)}putImageData(k,_,N){this._context.putImageData(k,_,N)}quadraticCurveTo(k,_,N,A){this._context.quadraticCurveTo(k,_,N,A)}restore(){this._context.restore()}rotate(k){this._context.rotate(k)}save(){this._context.save()}scale(k,_){this._context.scale(k,_)}setLineDash(k){this._context.setLineDash?this._context.setLineDash(k):"mozDash"in this._context?this._context.mozDash=k:"webkitLineDash"in this._context&&(this._context.webkitLineDash=k)}getLineDash(){return this._context.getLineDash()}setTransform(k,_,N,A,P,R){this._context.setTransform(k,_,N,A,P,R)}stroke(k){k?this._context.stroke(k):this._context.stroke()}strokeText(k,_,N,A){this._context.strokeText(k,_,N,A)}transform(k,_,N,A,P,R){this._context.transform(k,_,N,A,P,R)}translate(k,_){this._context.translate(k,_)}_enableTrace(){let k=this,_=p.length,N=this.setAttr,A,P;const R=function(T){let D=k[T],I;k[T]=function(){return P=r(Array.prototype.slice.call(arguments,0)),I=D.apply(k,arguments),k._trace({method:T,args:P}),I}};for(A=0;A<_;A++)R(p[A]);k.setAttr=function(){N.apply(k,arguments);const T=arguments[0];let D=arguments[1];(T==="shadowOffsetX"||T==="shadowOffsetY"||T==="shadowBlur")&&(D=D/this.canvas.getPixelRatio()),k._trace({property:T,val:D})}}_applyGlobalCompositeOperation(k){const _=k.attrs.globalCompositeOperation;!_||_==="source-over"||this.setAttr("globalCompositeOperation",_)}};cc.Context=v,g.forEach(function(E){Object.defineProperty(v.prototype,E,{get(){return this._context[E]},set(k){this._context[E]=k}})});class w extends v{constructor(k,{willReadFrequently:_=!1}={}){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(k){const _=k.fill();this.setAttr("fillStyle",_),k._fillFunc(this)}_fillPattern(k){this.setAttr("fillStyle",k._getFillPattern()),k._fillFunc(this)}_fillLinearGradient(k){const _=k._getLinearGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fillRadialGradient(k){const _=k._getRadialGradient();_&&(this.setAttr("fillStyle",_),k._fillFunc(this))}_fill(k){const _=k.fill(),N=k.getFillPriority();if(_&&N==="color"){this._fillColor(k);return}const A=k.getFillPatternImage();if(A&&N==="pattern"){this._fillPattern(k);return}const P=k.getFillLinearGradientColorStops();if(P&&N==="linear-gradient"){this._fillLinearGradient(k);return}const R=k.getFillRadialGradientColorStops();if(R&&N==="radial-gradient"){this._fillRadialGradient(k);return}_?this._fillColor(k):A?this._fillPattern(k):P?this._fillLinearGradient(k):R&&this._fillRadialGradient(k)}_strokeLinearGradient(k){const _=k.getStrokeLinearGradientStartPoint(),N=k.getStrokeLinearGradientEndPoint(),A=k.getStrokeLinearGradientColorStops(),P=this.createLinearGradient(_.x,_.y,N.x,N.y);if(A){for(let R=0;R<A.length;R+=2)P.addColorStop(A[R],A[R+1]);this.setAttr("strokeStyle",P)}}_stroke(k){const _=k.dash(),N=k.getStrokeScaleEnabled();if(k.hasStroke()){if(!N){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k),_&&k.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",k.dashOffset())),this.setAttr("lineWidth",k.strokeWidth()),k.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),k.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(k):this.setAttr("strokeStyle",k.stroke()),k._strokeFunc(this),N||this.restore()}}_applyShadow(k){var _,N,A;const P=(_=k.getShadowRGBA())!==null&&_!==void 0?_:"black",R=(N=k.getShadowBlur())!==null&&N!==void 0?N:5,T=(A=k.getShadowOffset())!==null&&A!==void 0?A:{x:0,y:0},D=k.getAbsoluteScale(),I=this.canvas.getPixelRatio(),K=D.x*I,X=D.y*I;this.setAttr("shadowColor",P),this.setAttr("shadowBlur",R*Math.min(Math.abs(K),Math.abs(X))),this.setAttr("shadowOffsetX",T.x*K),this.setAttr("shadowOffsetY",T.y*X)}}cc.SceneContext=w;class b extends v{constructor(k){super(k),this._context=k._canvas.getContext("2d",{willReadFrequently:!0})}_fill(k){this.save(),this.setAttr("fillStyle",k.colorKey),k._fillFuncHit(this),this.restore()}strokeShape(k){k.hasHitStroke()&&this._stroke(k)}_stroke(k){if(k.hasHitStroke()){const _=k.getStrokeScaleEnabled();if(!_){this.save();const P=this.getCanvas().getPixelRatio();this.setTransform(P,0,0,P,0,0)}this._applyLineCap(k);const N=k.hitStrokeWidth(),A=N==="auto"?k.strokeWidth():N;this.setAttr("lineWidth",A),this.setAttr("strokeStyle",k.colorKey),k._strokeFuncHit(this),_||this.restore()}}}return cc.HitContext=b,cc}var ZC;function Py(){if(ZC)return lc;ZC=1,Object.defineProperty(lc,"__esModule",{value:!0}),lc.HitCanvas=lc.SceneCanvas=lc.Canvas=void 0;const e=as(),t=_6(),r=Mr();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),d=c.getContext("2d");return n=(function(){const f=r.Konva._global.devicePixelRatio||1,p=d.webkitBackingStorePixelRatio||d.mozBackingStorePixelRatio||d.msBackingStorePixelRatio||d.oBackingStorePixelRatio||d.backingStorePixelRatio||1;return f/p})(),e.Util.releaseCanvas(c),n}let a=class{constructor(d){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const p=(d||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=p,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(d){const f=this.pixelRatio;this.pixelRatio=d,this.setSize(this.getWidth()/f,this.getHeight()/f)}setWidth(d){this.width=this._canvas.width=d*this.pixelRatio,this._canvas.style.width=d+"px";const f=this.pixelRatio;this.getContext()._context.scale(f,f)}setHeight(d){this.height=this._canvas.height=d*this.pixelRatio,this._canvas.style.height=d+"px";const f=this.pixelRatio;this.getContext()._context.scale(f,f)}getWidth(){return this.width}getHeight(){return this.height}setSize(d,f){this.setWidth(d||0),this.setHeight(f||0)}toDataURL(d,f){try{return this._canvas.toDataURL(d,f)}catch{try{return this._canvas.toDataURL()}catch(g){return e.Util.error("Unable to get data URL. "+g.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};lc.Canvas=a;class i extends a{constructor(d={width:0,height:0,willReadFrequently:!1}){super(d),this.context=new t.SceneContext(this,{willReadFrequently:d.willReadFrequently}),this.setSize(d.width,d.height)}}lc.SceneCanvas=i;class o extends a{constructor(d={width:0,height:0}){super(d),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(d.width,d.height)}}return lc.HitCanvas=o,lc}var lw={},eT;function nb(){return eT||(eT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=Mr(),r=as();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,c=o.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const d=c._changedPointerPositions.find(f=>f.id===a.pointerId);if(d){if(a.dragStatus!=="dragging"){const f=o.dragDistance();if(Math.max(Math.abs(d.x-a.startPointerPos.x),Math.abs(d.y-a.startPointerPos.y))<f||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(f=>f.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const d=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;d&&s.indexOf(d)===-1&&s.push(d)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(lw)),lw}var cw={},xi={},tT;function zr(){if(tT)return xi;tT=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.RGBComponent=n,xi.alphaComponent=s,xi.getNumberValidator=a,xi.getNumberOrArrayOfNumbersValidator=i,xi.getNumberOrAutoValidator=o,xi.getStringValidator=c,xi.getStringOrGradientValidator=d,xi.getFunctionValidator=f,xi.getNumberArrayValidator=p,xi.getBooleanValidator=g,xi.getComponentValidator=y;const e=Mr(),t=as();function r(v){return t.Util._isString(v)?'"'+v+'"':Object.prototype.toString.call(v)==="[object Number]"||t.Util._isBoolean(v)?v:Object.prototype.toString.call(v)}function n(v){return v>255?255:v<0?0:Math.round(v)}function s(v){return v>1?1:v<1e-4?1e-4:v}function a(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isNumber(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number.'),v}}function i(v){if(e.Konva.isUnminified)return function(w,b){let E=t.Util._isNumber(w),k=t.Util._isArray(w)&&w.length==v;return!E&&!k&&t.Util.warn(r(w)+' is a not valid value for "'+b+'" attribute. The value should be a number or Array<number>('+v+")"),w}}function o(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isNumber(v)||v==="auto"||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a number or "auto".'),v}}function c(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isString(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a string.'),v}}function d(){if(e.Konva.isUnminified)return function(v,w){const b=t.Util._isString(v),E=Object.prototype.toString.call(v)==="[object CanvasGradient]"||v&&v.addColorStop;return b||E||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a string or a native gradient.'),v}}function f(){if(e.Konva.isUnminified)return function(v,w){return t.Util._isFunction(v)||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a function.'),v}}function p(){if(e.Konva.isUnminified)return function(v,w){const b=Int8Array?Object.getPrototypeOf(Int8Array):null;return b&&v instanceof b||(t.Util._isArray(v)?v.forEach(function(E){t.Util._isNumber(E)||t.Util.warn('"'+w+'" attribute has non numeric element '+E+". Make sure that all elements are numbers.")}):t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a array of numbers.')),v}}function g(){if(e.Konva.isUnminified)return function(v,w){return v===!0||v===!1||t.Util.warn(r(v)+' is a not valid value for "'+w+'" attribute. The value should be a boolean.'),v}}function y(v){if(e.Konva.isUnminified)return function(w,b){return w==null||t.Util.isObject(w)||t.Util.warn(r(w)+' is a not valid value for "'+b+'" attribute. The value should be an object with properties '+v),w}}return xi}var rT;function $r(){return rT||(rT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=as(),r=zr(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,c,d){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,c,d),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const d=this.attrs[i];return d===void 0?o:d}},addSetter(a,i,o,c){const d=s+t.Util._capitalize(i);a.prototype[d]||e.Factory.overWriteSetter(a,i,o,c)},overWriteSetter(a,i,o,c){const d=s+t.Util._capitalize(i);a.prototype[d]=function(f){return o&&f!==void 0&&f!==null&&(f=o.call(this,f,i)),this._setAttr(i,f),c&&c.call(this),this}},addComponentsGetterSetter(a,i,o,c,d){const f=o.length,p=t.Util._capitalize,g=n+p(i),y=s+p(i);a.prototype[g]=function(){const w={};for(let b=0;b<f;b++){const E=o[b];w[E]=this.getAttr(i+p(E))}return w};const v=(0,r.getComponentValidator)(o);a.prototype[y]=function(w){const b=this.attrs[i];c&&(w=c.call(this,w,i)),v&&v.call(this,w,i);for(const E in w)w.hasOwnProperty(E)&&this._setAttr(i+p(E),w[E]);return w||o.forEach(E=>{this._setAttr(i+p(E),void 0)}),this._fireChangeEvent(i,b,w),d&&d.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),c=s+o,d=n+o;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[d]()}},addDeprecatedGetterSetter(a,i,o,c){t.Util.error("Adding deprecated "+i);const d=n+t.Util._capitalize(i),f=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[d]=function(){t.Util.error(f);const p=this.attrs[i];return p===void 0?o:p},e.Factory.addSetter(a,i,c,function(){t.Util.error(f)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,c){const d=a.prototype[c],f=n+t.Util._capitalize(o),p=s+t.Util._capitalize(o);function g(){d.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[o]=g,a.prototype[f]=g,a.prototype[p]=g})},afterSetFilter(){this._filterUpToDate=!1}}})(cw)),cw}var nT;function ps(){if(nT)return Tg;nT=1,Object.defineProperty(Tg,"__esModule",{value:!0}),Tg.Node=void 0;const e=Py(),t=nb(),r=$r(),n=Mr(),s=as(),a=zr(),i="absoluteOpacity",o="allEventListeners",c="absoluteTransform",d="absoluteScale",f="canvas",p="Change",g="children",y="konva",v="listening",w="mouseenter",b="mouseleave",E="pointerenter",k="pointerleave",_="touchenter",N="touchleave",A="set",P="Shape",R=" ",T="stage",D="transform",I="Stage",K="visible",X=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(R);let Z=1,oe=class b_{constructor(M){this._id=Z++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(M),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(M){(M===D||M===c)&&this._cache.get(M)?this._cache.get(M).dirty=!0:M?this._cache.delete(M):this._cache.clear()}_getCache(M,W){let B=this._cache.get(M);return(B===void 0||(M===D||M===c)&&B.dirty===!0)&&(B=W.call(this),this._cache.set(M,B)),B}_calculate(M,W,B){if(!this._attachedDepsListeners.get(M)){const G=W.map(H=>H+"Change.konva").join(R);this.on(G,()=>{this._clearCache(M)}),this._attachedDepsListeners.set(M,!0)}return this._getCache(M,B)}_getCanvasCache(){return this._cache.get(f)}_clearSelfAndDescendantCache(M){this._clearCache(M),M===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(f)){const{scene:M,filter:W,hit:B,buffer:G}=this._cache.get(f);s.Util.releaseCanvas(M,W,B,G),this._cache.delete(f)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(M){const W=M||{};let B={};(W.x===void 0||W.y===void 0||W.width===void 0||W.height===void 0)&&(B=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let G=Math.ceil(W.width||B.width),H=Math.ceil(W.height||B.height),O=W.pixelRatio,z=W.x===void 0?Math.floor(B.x):W.x,Y=W.y===void 0?Math.floor(B.y):W.y,J=W.offset||0,te=W.drawBorder||!1,ee=W.hitCanvasPixelRatio||1;if(!G||!H){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const ie=Math.abs(Math.round(B.x)-z)>.5?1:0,me=Math.abs(Math.round(B.y)-Y)>.5?1:0;G+=J*2+ie,H+=J*2+me,z-=J,Y-=J;const Ce=new e.SceneCanvas({pixelRatio:O,width:G,height:H}),Oe=new e.SceneCanvas({pixelRatio:O,width:0,height:0,willReadFrequently:!0}),fe=new e.HitCanvas({pixelRatio:ee,width:G,height:H}),pe=Ce.getContext(),He=fe.getContext(),Ye=new e.SceneCanvas({width:Ce.width/Ce.pixelRatio+Math.abs(z),height:Ce.height/Ce.pixelRatio+Math.abs(Y),pixelRatio:Ce.pixelRatio}),ot=Ye.getContext();return fe.isCache=!0,Ce.isCache=!0,this._cache.delete(f),this._filterUpToDate=!1,W.imageSmoothingEnabled===!1&&(Ce.getContext()._context.imageSmoothingEnabled=!1,Oe.getContext()._context.imageSmoothingEnabled=!1),pe.save(),He.save(),ot.save(),pe.translate(-z,-Y),He.translate(-z,-Y),ot.translate(-z,-Y),Ye.x=z,Ye.y=Y,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(d),this.drawScene(Ce,this,Ye),this.drawHit(fe,this),this._isUnderCache=!1,pe.restore(),He.restore(),te&&(pe.save(),pe.beginPath(),pe.rect(0,0,G,H),pe.closePath(),pe.setAttr("strokeStyle","red"),pe.setAttr("lineWidth",5),pe.stroke(),pe.restore()),this._cache.set(f,{scene:Ce,filter:Oe,hit:fe,buffer:Ye,x:z,y:Y}),this._requestDraw(),this}isCached(){return this._cache.has(f)}getClientRect(M){throw new Error('abstract "getClientRect" method call')}_transformedRect(M,W){const B=[{x:M.x,y:M.y},{x:M.x+M.width,y:M.y},{x:M.x+M.width,y:M.y+M.height},{x:M.x,y:M.y+M.height}];let G=1/0,H=1/0,O=-1/0,z=-1/0;const Y=this.getAbsoluteTransform(W);return B.forEach(function(J){const te=Y.point(J);G===void 0&&(G=O=te.x,H=z=te.y),G=Math.min(G,te.x),H=Math.min(H,te.y),O=Math.max(O,te.x),z=Math.max(z,te.y)}),{x:G,y:H,width:O-G,height:z-H}}_drawCachedSceneCanvas(M){M.save(),M._applyOpacity(this),M._applyGlobalCompositeOperation(this);const W=this._getCanvasCache();M.translate(W.x,W.y);const B=this._getCachedSceneCanvas(),G=B.pixelRatio;M.drawImage(B._canvas,0,0,B.width/G,B.height/G),M.restore()}_drawCachedHitCanvas(M){const W=this._getCanvasCache(),B=W.hit;M.save(),M.translate(W.x,W.y),M.drawImage(B._canvas,0,0,B.width/B.pixelRatio,B.height/B.pixelRatio),M.restore()}_getCachedSceneCanvas(){let M=this.filters(),W=this._getCanvasCache(),B=W.scene,G=W.filter,H=G.getContext(),O,z,Y,J;if(M){if(!this._filterUpToDate){const te=B.pixelRatio;G.setSize(B.width/B.pixelRatio,B.height/B.pixelRatio);try{for(O=M.length,H.clear(),H.drawImage(B._canvas,0,0,B.getWidth()/te,B.getHeight()/te),z=H.getImageData(0,0,G.getWidth(),G.getHeight()),Y=0;Y<O;Y++){if(J=M[Y],typeof J!="function"){s.Util.error("Filter should be type of function, but got "+typeof J+" instead. Please check correct filters");continue}J.call(this,z),H.putImageData(z,0,0)}}catch(ee){s.Util.error("Unable to apply filter. "+ee.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return G}return B}on(M,W){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const B=M.split(R);for(let G=0;G<B.length;G++){const O=B[G].split("."),z=O[0],Y=O[1]||"";this.eventListeners[z]||(this.eventListeners[z]=[]),this.eventListeners[z].push({name:Y,handler:W})}return this}off(M,W){let B=(M||"").split(R),G=B.length,H,O,z,Y,J,te;if(this._cache&&this._cache.delete(o),!M)for(O in this.eventListeners)this._off(O);for(H=0;H<G;H++)if(z=B[H],Y=z.split("."),J=Y[0],te=Y[1],J)this.eventListeners[J]&&this._off(J,te,W);else for(O in this.eventListeners)this._off(O,te,W);return this}dispatchEvent(M){const W={target:this,type:M.type,evt:M};return this.fire(M.type,W),this}addEventListener(M,W){return this.on(M,function(B){W.call(this,B.evt)}),this}removeEventListener(M){return this.off(M),this}_delegate(M,W,B){const G=this;this.on(M,function(H){const O=H.target.findAncestors(W,!0,G);for(let z=0;z<O.length;z++)H=s.Util.cloneObject(H),H.currentTarget=O[z],B.call(O[z],H)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(d),this._clearSelfAndDescendantCache(T),this._clearSelfAndDescendantCache(K),this._clearSelfAndDescendantCache(v)}_remove(){this._clearCaches();const M=this.getParent();M&&M.children&&(M.children.splice(this.index,1),M._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(M){const W="get"+s.Util._capitalize(M);return s.Util._isFunction(this[W])?this[W]():this.attrs[M]}getAncestors(){let M=this.getParent(),W=[];for(;M;)W.push(M),M=M.getParent();return W}getAttrs(){return this.attrs||{}}setAttrs(M){return this._batchTransformChanges(()=>{let W,B;if(!M)return this;for(W in M)W!==g&&(B=A+s.Util._capitalize(W),s.Util._isFunction(this[B])?this[B](M[W]):this._setAttr(W,M[W]))}),this}isListening(){return this._getCache(v,this._isListening)}_isListening(M){if(!this.listening())return!1;const B=this.getParent();return B&&B!==M&&this!==M?B._isListening(M):!0}isVisible(){return this._getCache(K,this._isVisible)}_isVisible(M){if(!this.visible())return!1;const B=this.getParent();return B&&B!==M&&this!==M?B._isVisible(M):!0}shouldDrawHit(M,W=!1){if(M)return this._isVisible(M)&&this._isListening(M);const B=this.getLayer();let G=!1;t.DD._dragElements.forEach(O=>{O.dragStatus==="dragging"&&(O.node.nodeType==="Stage"||O.node.getLayer()===B)&&(G=!0)});const H=!W&&!n.Konva.hitOnDragEnabled&&(G||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!H}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let M=this.getDepth(),W=this,B=0,G,H,O,z;function Y(te){for(G=[],H=te.length,O=0;O<H;O++)z=te[O],B++,z.nodeType!==P&&(G=G.concat(z.getChildren().slice())),z._id===W._id&&(O=H);G.length>0&&G[0].getDepth()<=M&&Y(G)}const J=this.getStage();return W.nodeType!==I&&J&&Y(J.getChildren()),B}getDepth(){let M=0,W=this.parent;for(;W;)M++,W=W.parent;return M}_batchTransformChanges(M){this._batchingTransformChange=!0,M(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(D),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(M){return this._batchTransformChanges(()=>{this.x(M.x),this.y(M.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const M=this.getStage();if(!M)return null;const W=M.getPointerPosition();if(!W)return null;const B=this.getAbsoluteTransform().copy();return B.invert(),B.point(W)}getAbsolutePosition(M){let W=!1,B=this.parent;for(;B;){if(B.isCached()){W=!0;break}B=B.parent}W&&!M&&(M=!0);const G=this.getAbsoluteTransform(M).getMatrix(),H=new s.Transform,O=this.offset();return H.m=G.slice(),H.translate(O.x,O.y),H.getTranslation()}setAbsolutePosition(M){const{x:W,y:B,...G}=this._clearTransform();this.attrs.x=W,this.attrs.y=B,this._clearCache(D);const H=this._getAbsoluteTransform().copy();return H.invert(),H.translate(M.x,M.y),M={x:this.attrs.x+H.getTranslation().x,y:this.attrs.y+H.getTranslation().y},this._setTransform(G),this.setPosition({x:M.x,y:M.y}),this._clearCache(D),this._clearSelfAndDescendantCache(c),this}_setTransform(M){let W;for(W in M)this.attrs[W]=M[W]}_clearTransform(){const M={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,M}move(M){let W=M.x,B=M.y,G=this.x(),H=this.y();return W!==void 0&&(G+=W),B!==void 0&&(H+=B),this.setPosition({x:G,y:H}),this}_eachAncestorReverse(M,W){let B=[],G=this.getParent(),H,O;if(!(W&&W._id===this._id)){for(B.unshift(this);G&&(!W||G._id!==W._id);)B.unshift(G),G=G.parent;for(H=B.length,O=0;O<H;O++)M(B[O])}}rotate(M){return this.rotation(this.rotation()+M),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const M=this.index,W=this.parent.getChildren().length;return M<W-1?(this.parent.children.splice(M,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const M=this.index,W=this.parent.getChildren().length;return M<W-1?(this.parent.children.splice(M,1),this.parent.children.splice(M+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const M=this.index;return M>0?(this.parent.children.splice(M,1),this.parent.children.splice(M-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const M=this.index;return M>0?(this.parent.children.splice(M,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(M){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(M<0||M>=this.parent.children.length)&&s.Util.warn("Unexpected value "+M+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const W=this.index;return this.parent.children.splice(W,1),this.parent.children.splice(M,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let M=this.opacity();const W=this.getParent();return W&&!W._isUnderCache&&(M*=W.getAbsoluteOpacity()),M}moveTo(M){return this.getParent()!==M&&(this._remove(),M.add(this)),this}toObject(){let M=this.getAttrs(),W,B,G,H,O;const z={attrs:{},className:this.getClassName()};for(W in M)B=M[W],O=s.Util.isObject(B)&&!s.Util._isPlainObject(B)&&!s.Util._isArray(B),!O&&(G=typeof this[W]=="function"&&this[W],delete M[W],H=G?G.call(this):null,M[W]=B,H!==B&&(z.attrs[W]=B));return s.Util._prepareToStringify(z)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(M,W,B){const G=[];W&&this._isMatch(M)&&G.push(this);let H=this.parent;for(;H;){if(H===B)return G;H._isMatch(M)&&G.push(H),H=H.parent}return G}isAncestorOf(M){return!1}findAncestor(M,W,B){return this.findAncestors(M,W,B)[0]}_isMatch(M){if(!M)return!1;if(typeof M=="function")return M(this);let W=M.replace(/ /g,"").split(","),B=W.length,G,H;for(G=0;G<B;G++)if(H=W[G],s.Util.isValidSelector(H)||(s.Util.warn('Selector "'+H+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),H.charAt(0)==="#"){if(this.id()===H.slice(1))return!0}else if(H.charAt(0)==="."){if(this.hasName(H.slice(1)))return!0}else if(this.className===H||this.nodeType===H)return!0;return!1}getLayer(){const M=this.getParent();return M?M.getLayer():null}getStage(){return this._getCache(T,this._getStage)}_getStage(){const M=this.getParent();return M?M.getStage():null}fire(M,W={},B){return W.target=W.target||this,B?this._fireAndBubble(M,W):this._fire(M,W),this}getAbsoluteTransform(M){return M?this._getAbsoluteTransform(M):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(M){let W;if(M)return W=new s.Transform,this._eachAncestorReverse(function(B){const G=B.transformsEnabled();G==="all"?W.multiply(B.getTransform()):G==="position"&&W.translate(B.x()-B.offsetX(),B.y()-B.offsetY())},M),W;{W=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(W):W.reset();const B=this.transformsEnabled();if(B==="all")W.multiply(this.getTransform());else if(B==="position"){const G=this.attrs.x||0,H=this.attrs.y||0,O=this.attrs.offsetX||0,z=this.attrs.offsetY||0;W.translate(G-O,H-z)}return W.dirty=!1,W}}getAbsoluteScale(M){let W=this;for(;W;)W._isUnderCache&&(M=W),W=W.getParent();const G=this.getAbsoluteTransform(M).decompose();return{x:G.scaleX,y:G.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(D,this._getTransform)}_getTransform(){var M,W;const B=this._cache.get(D)||new s.Transform;B.reset();const G=this.x(),H=this.y(),O=n.Konva.getAngle(this.rotation()),z=(M=this.attrs.scaleX)!==null&&M!==void 0?M:1,Y=(W=this.attrs.scaleY)!==null&&W!==void 0?W:1,J=this.attrs.skewX||0,te=this.attrs.skewY||0,ee=this.attrs.offsetX||0,ie=this.attrs.offsetY||0;return(G!==0||H!==0)&&B.translate(G,H),O!==0&&B.rotate(O),(J!==0||te!==0)&&B.skew(J,te),(z!==1||Y!==1)&&B.scale(z,Y),(ee!==0||ie!==0)&&B.translate(-1*ee,-1*ie),B.dirty=!1,B}clone(M){let W=s.Util.cloneObject(this.attrs),B,G,H,O,z;for(B in M)W[B]=M[B];const Y=new this.constructor(W);for(B in this.eventListeners)for(G=this.eventListeners[B],H=G.length,O=0;O<H;O++)z=G[O],z.name.indexOf(y)<0&&(Y.eventListeners[B]||(Y.eventListeners[B]=[]),Y.eventListeners[B].push(z));return Y}_toKonvaCanvas(M){M=M||{};const W=this.getClientRect(),B=this.getStage(),G=M.x!==void 0?M.x:Math.floor(W.x),H=M.y!==void 0?M.y:Math.floor(W.y),O=M.pixelRatio||1,z=new e.SceneCanvas({width:M.width||Math.ceil(W.width)||(B?B.width():0),height:M.height||Math.ceil(W.height)||(B?B.height():0),pixelRatio:O}),Y=z.getContext(),J=new e.SceneCanvas({width:z.width/z.pixelRatio+Math.abs(G),height:z.height/z.pixelRatio+Math.abs(H),pixelRatio:z.pixelRatio});return M.imageSmoothingEnabled===!1&&(Y._context.imageSmoothingEnabled=!1),Y.save(),(G||H)&&Y.translate(-1*G,-1*H),this.drawScene(z,void 0,J),Y.restore(),z}toCanvas(M){return this._toKonvaCanvas(M)._canvas}toDataURL(M){M=M||{};const W=M.mimeType||null,B=M.quality||null,G=this._toKonvaCanvas(M).toDataURL(W,B);return M.callback&&M.callback(G),G}toImage(M){return new Promise((W,B)=>{try{const G=M?.callback;G&&delete M.callback,s.Util._urlToImage(this.toDataURL(M),function(H){W(H),G?.(H)})}catch(G){B(G)}})}toBlob(M){return new Promise((W,B)=>{try{const G=M?.callback;G&&delete M.callback,this.toCanvas(M).toBlob(H=>{W(H),G?.(H)},M?.mimeType,M?.quality)}catch(G){B(G)}})}setSize(M){return this.width(M.width),this.height(M.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(M,W,B){let G=this.eventListeners[M],H,O,z;for(H=0;H<G.length;H++)if(O=G[H].name,z=G[H].handler,(O!=="konva"||W==="konva")&&(!W||O===W)&&(!B||B===z)){if(G.splice(H,1),G.length===0){delete this.eventListeners[M];break}H--}}_fireChangeEvent(M,W,B){this._fire(M+p,{oldVal:W,newVal:B})}addName(M){if(!this.hasName(M)){const W=this.name(),B=W?W+" "+M:M;this.name(B)}return this}hasName(M){if(!M)return!1;const W=this.name();return W?(W||"").split(/\s/g).indexOf(M)!==-1:!1}removeName(M){const W=(this.name()||"").split(/\s/g),B=W.indexOf(M);return B!==-1&&(W.splice(B,1),this.name(W.join(" "))),this}setAttr(M,W){const B=this[A+s.Util._capitalize(M)];return s.Util._isFunction(B)?B.call(this,W):this._setAttr(M,W),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const M=this.getLayer()||this.getStage();M?.batchDraw()}}_setAttr(M,W){const B=this.attrs[M];B===W&&!s.Util.isObject(W)||(W==null?delete this.attrs[M]:this.attrs[M]=W,this._shouldFireChangeEvents&&this._fireChangeEvent(M,B,W),this._requestDraw())}_setComponentAttr(M,W,B){let G;B!==void 0&&(G=this.attrs[M],G||(this.attrs[M]=this.getAttr(M)),this.attrs[M][W]=B,this._fireChangeEvent(M,G,B))}_fireAndBubble(M,W,B){W&&this.nodeType===P&&(W.target=this);const G=[w,b,E,k,_,N];if(!(G.indexOf(M)!==-1&&(B&&(this===B||this.isAncestorOf&&this.isAncestorOf(B))||this.nodeType==="Stage"&&!B))){this._fire(M,W);const O=G.indexOf(M)!==-1&&B&&B.isAncestorOf&&B.isAncestorOf(this)&&!B.isAncestorOf(this.parent);(W&&!W.cancelBubble||!W)&&this.parent&&this.parent.isListening()&&!O&&(B&&B.parent?this._fireAndBubble.call(this.parent,M,W,B):this._fireAndBubble.call(this.parent,M,W))}}_getProtoListeners(M){var W,B,G;const H=(W=this._cache.get(o))!==null&&W!==void 0?W:{};let O=H?.[M];if(O===void 0){O=[];let z=Object.getPrototypeOf(this);for(;z;){const Y=(G=(B=z.eventListeners)===null||B===void 0?void 0:B[M])!==null&&G!==void 0?G:[];O.push(...Y),z=Object.getPrototypeOf(z)}H[M]=O,this._cache.set(o,H)}return O}_fire(M,W){W=W||{},W.currentTarget=this,W.type=M;const B=this._getProtoListeners(M);if(B)for(let H=0;H<B.length;H++)B[H].handler.call(this,W);const G=this.eventListeners[M];if(G)for(let H=0;H<G.length;H++)G[H].handler.call(this,W)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(M){const W=M?M.pointerId:void 0,B=this.getStage(),G=this.getAbsolutePosition();if(!B)return;const H=B._getPointerById(W)||B._changedPointerPositions[0]||G;t.DD._dragElements.set(this._id,{node:this,startPointerPos:H,offset:{x:H.x-G.x,y:H.y-G.y},dragStatus:"ready",pointerId:W})}startDrag(M,W=!0){t.DD._dragElements.has(this._id)||this._createDragElement(M);const B=t.DD._dragElements.get(this._id);B.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:M&&M.evt},W)}_setDragPosition(M,W){const B=this.getStage()._getPointerById(W.pointerId);if(!B)return;let G={x:B.x-W.offset.x,y:B.y-W.offset.y};const H=this.dragBoundFunc();if(H!==void 0){const O=H.call(this,G,M);O?G=O:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==G.x||this._lastPos.y!==G.y)&&(this.setAbsolutePosition(G),this._requestDraw()),this._lastPos=G}stopDrag(M){const W=t.DD._dragElements.get(this._id);W&&(W.dragStatus="stopped"),t.DD._endDragBefore(M),t.DD._endDragAfter(M)}setDraggable(M){this._setAttr("draggable",M),this._dragChange()}isDragging(){const M=t.DD._dragElements.get(this._id);return M?M.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(M){if(!(!(M.evt.button!==void 0)||n.Konva.dragButtons.indexOf(M.evt.button)>=0)||this.isDragging())return;let G=!1;t.DD._dragElements.forEach(H=>{this.isAncestorOf(H.node)&&(G=!0)}),G||this._createDragElement(M)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const W=t.DD._dragElements.get(this._id),B=W&&W.dragStatus==="dragging",G=W&&W.dragStatus==="ready";B?this.stopDrag():G&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(M={x:0,y:0}){const W=this.getStage();if(!W)return!1;const B={x:-M.x,y:-M.y,width:W.width()+2*M.x,height:W.height()+2*M.y};return s.Util.haveIntersection(B,this.getClientRect())}static create(M,W){return s.Util._isString(M)&&(M=JSON.parse(M)),this._createNode(M,W)}static _createNode(M,W){let B=b_.prototype.getClassName.call(M),G=M.children,H,O,z;W&&(M.attrs.container=W),n.Konva[B]||(s.Util.warn('Can not find a node with class name "'+B+'". Fallback to "Shape".'),B="Shape");const Y=n.Konva[B];if(H=new Y(M.attrs),G)for(O=G.length,z=0;z<O;z++)H.add(b_._createNode(G[z]));return H}};Tg.Node=oe,oe.prototype.nodeType="Node",oe.prototype._attrsAffectingSize=[],oe.prototype.eventListeners={},oe.prototype.on.call(oe.prototype,X,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(D),this._clearSelfAndDescendantCache(c)}),oe.prototype.on.call(oe.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(K)}),oe.prototype.on.call(oe.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(v)}),oe.prototype.on.call(oe.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const q=r.Factory.addGetterSetter;return q(oe,"zIndex"),q(oe,"absolutePosition"),q(oe,"position"),q(oe,"x",0,(0,a.getNumberValidator)()),q(oe,"y",0,(0,a.getNumberValidator)()),q(oe,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),q(oe,"opacity",1,(0,a.getNumberValidator)()),q(oe,"name","",(0,a.getStringValidator)()),q(oe,"id","",(0,a.getStringValidator)()),q(oe,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(oe,"scale",["x","y"]),q(oe,"scaleX",1,(0,a.getNumberValidator)()),q(oe,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(oe,"skew",["x","y"]),q(oe,"skewX",0,(0,a.getNumberValidator)()),q(oe,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(oe,"offset",["x","y"]),q(oe,"offsetX",0,(0,a.getNumberValidator)()),q(oe,"offsetY",0,(0,a.getNumberValidator)()),q(oe,"dragDistance",void 0,(0,a.getNumberValidator)()),q(oe,"width",0,(0,a.getNumberValidator)()),q(oe,"height",0,(0,a.getNumberValidator)()),q(oe,"listening",!0,(0,a.getBooleanValidator)()),q(oe,"preventDefault",!0,(0,a.getBooleanValidator)()),q(oe,"filters",void 0,function(re){return this._filterUpToDate=!1,re}),q(oe,"visible",!0,(0,a.getBooleanValidator)()),q(oe,"transformsEnabled","all",(0,a.getStringValidator)()),q(oe,"size"),q(oe,"dragBoundFunc"),q(oe,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(oe,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),Tg}var Eg={},sT;function Ry(){if(sT)return Eg;sT=1,Object.defineProperty(Eg,"__esModule",{value:!0}),Eg.Container=void 0;const e=$r(),t=ps(),r=zr();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(c=>{const d=c._isMatch(a);return d&&o.push(c),!!(d&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const c of o){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const c=this.getLayer(),d=a||c&&c.getCanvas(),f=d&&d.getContext(),p=this._getCanvasCache(),g=p&&p.scene,y=d&&d.isCache;if(!this.isVisible()&&!y)return this;if(g){f.save();const v=this.getAbsoluteTransform(i).getMatrix();f.transform(v[0],v[1],v[2],v[3],v[4],v[5]),this._drawCachedSceneCanvas(f),f.restore()}else this._drawChildren("drawScene",d,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),c=a||o&&o.hitCanvas,d=c&&c.getContext(),f=this._getCanvasCache();if(f&&f.hit){d.save();const g=this.getAbsoluteTransform(i).getMatrix();d.transform(g[0],g[1],g[2],g[3],g[4],g[5]),this._drawCachedHitCanvas(d),d.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,o,c){var d;const f=i&&i.getContext(),p=this.clipWidth(),g=this.clipHeight(),y=this.clipFunc(),v=typeof p=="number"&&typeof g=="number"||y,w=o===this;if(v){f.save();const E=this.getAbsoluteTransform(o);let k=E.getMatrix();f.transform(k[0],k[1],k[2],k[3],k[4],k[5]),f.beginPath();let _;if(y)_=y.call(this,f,this);else{const N=this.clipX(),A=this.clipY();f.rect(N||0,A||0,p,g)}f.clip.apply(f,_),k=E.copy().invert().getMatrix(),f.transform(k[0],k[1],k[2],k[3],k[4],k[5])}const b=!w&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";b&&(f.save(),f._applyGlobalCompositeOperation(this)),(d=this.children)===null||d===void 0||d.forEach(function(E){E[a](i,o,c)}),b&&f.restore(),v&&f.restore()}getClientRect(a={}){var i;const o=a.skipTransform,c=a.relativeTo;let d,f,p,g,y={x:1/0,y:1/0,width:0,height:0};const v=this;(i=this.children)===null||i===void 0||i.forEach(function(E){if(!E.visible())return;const k=E.getClientRect({relativeTo:v,skipShadow:a.skipShadow,skipStroke:a.skipStroke});k.width===0&&k.height===0||(d===void 0?(d=k.x,f=k.y,p=k.x+k.width,g=k.y+k.height):(d=Math.min(d,k.x),f=Math.min(f,k.y),p=Math.max(p,k.x+k.width),g=Math.max(g,k.y+k.height)))});const w=this.find("Shape");let b=!1;for(let E=0;E<w.length;E++)if(w[E]._isVisible(this)){b=!0;break}return b&&d!==void 0?y={x:d,y:f,width:p-d,height:g-f}:y={x:0,y:0,width:0,height:0},o?y:this._transformedRect(y,c)}};return Eg.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),Eg}var uw={},yu={},aT;function b6(){if(aT)return yu;aT=1,Object.defineProperty(yu,"__esModule",{value:!0}),yu.getCapturedShape=n,yu.createEvent=s,yu.hasPointerCapture=a,yu.setPointerCapture=i,yu.releaseCapture=o;const e=Mr(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,d){return t.get(c)===d}function i(c,d){o(c),d.getStage()&&(t.set(c,d),r&&d._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(c,d){const f=t.get(c);if(!f)return;const p=f.getStage();p&&p.content,t.delete(c),r&&f._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return yu}var iT;function xM(){return iT||(iT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=as(),r=$r(),n=Ry(),s=Mr(),a=Py(),i=nb(),o=Mr(),c=b6(),d="Stage",f="string",p="px",g="mouseout",y="mouseleave",v="mouseover",w="mouseenter",b="mousemove",E="mousedown",k="mouseup",_="pointermove",N="pointerdown",A="pointerup",P="pointercancel",R="lostpointercapture",T="pointerout",D="pointerleave",I="pointerover",K="pointerenter",X="contextmenu",Z="touchstart",oe="touchend",q="touchmove",re="touchcancel",M="wheel",W=5,B=[[w,"_pointerenter"],[E,"_pointerdown"],[b,"_pointermove"],[k,"_pointerup"],[y,"_pointerleave"],[Z,"_pointerdown"],[q,"_pointermove"],[oe,"_pointerup"],[re,"_pointercancel"],[v,"_pointerover"],[M,"_wheel"],[X,"_contextmenu"],[N,"_pointerdown"],[_,"_pointermove"],[A,"_pointerup"],[P,"_pointercancel"],[D,"_pointerleave"],[R,"_lostpointercapture"]],G={mouse:{[T]:g,[D]:y,[I]:v,[K]:w,[_]:b,[N]:E,[A]:k,[P]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[T]:"touchout",[D]:"touchleave",[I]:"touchover",[K]:"touchenter",[_]:q,[N]:Z,[A]:oe,[P]:re,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[T]:T,[D]:D,[I]:I,[K]:K,[_]:_,[N]:N,[A]:A,[P]:P,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},H=te=>te.indexOf("pointer")>=0?"pointer":te.indexOf("touch")>=0?"touch":"mouse",O=te=>{const ee=H(te);if(ee==="pointer")return s.Konva.pointerEventsEnabled&&G.pointer;if(ee==="touch")return G.touch;if(ee==="mouse")return G.mouse};function z(te={}){return(te.clipFunc||te.clipWidth||te.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),te}const Y="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class J extends n.Container{constructor(ee){super(z(ee)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{z(this.attrs)}),this._checkVisibility()}_validateAdd(ee){const ie=ee.getType()==="Layer",me=ee.getType()==="FastLayer";ie||me||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const ee=this.visible()?"":"none";this.content.style.display=ee}setContainer(ee){if(typeof ee===f){let ie;if(ee.charAt(0)==="."){const me=ee.slice(1);ee=document.getElementsByClassName(me)[0]}else ee.charAt(0)!=="#"?ie=ee:ie=ee.slice(1),ee=document.getElementById(ie);if(!ee)throw"Can not find container in document with id "+ie}return this._setAttr("container",ee),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),ee.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const ee=this.children,ie=ee.length;for(let me=0;me<ie;me++)ee[me].clear();return this}clone(ee){return ee||(ee={}),ee.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,ee)}destroy(){super.destroy();const ee=this.content;ee&&t.Util._isInDocument(ee)&&this.container().removeChild(ee);const ie=e.stages.indexOf(this);return ie>-1&&e.stages.splice(ie,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const ee=this._pointerPositions[0]||this._changedPointerPositions[0];return ee?{x:ee.x,y:ee.y}:(t.Util.warn(Y),null)}_getPointerById(ee){return this._pointerPositions.find(ie=>ie.id===ee)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(ee){ee=ee||{},ee.x=ee.x||0,ee.y=ee.y||0,ee.width=ee.width||this.width(),ee.height=ee.height||this.height();const ie=new a.SceneCanvas({width:ee.width,height:ee.height,pixelRatio:ee.pixelRatio||1}),me=ie.getContext()._context,Ce=this.children;return(ee.x||ee.y)&&me.translate(-1*ee.x,-1*ee.y),Ce.forEach(function(Oe){if(!Oe.isVisible())return;const fe=Oe._toKonvaCanvas(ee);me.drawImage(fe._canvas,ee.x,ee.y,fe.getWidth()/fe.getPixelRatio(),fe.getHeight()/fe.getPixelRatio())}),ie}getIntersection(ee){if(!ee)return null;const ie=this.children,me=ie.length,Ce=me-1;for(let Oe=Ce;Oe>=0;Oe--){const fe=ie[Oe].getIntersection(ee);if(fe)return fe}return null}_resizeDOM(){const ee=this.width(),ie=this.height();this.content&&(this.content.style.width=ee+p,this.content.style.height=ie+p),this.bufferCanvas.setSize(ee,ie),this.bufferHitCanvas.setSize(ee,ie),this.children.forEach(me=>{me.setSize({width:ee,height:ie}),me.draw()})}add(ee,...ie){if(arguments.length>1){for(let Ce=0;Ce<arguments.length;Ce++)this.add(arguments[Ce]);return this}super.add(ee);const me=this.children.length;return me>W&&t.Util.warn("The stage has "+me+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),ee.setSize({width:this.width(),height:this.height()}),ee.draw(),s.Konva.isBrowser&&this.content.appendChild(ee.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(ee){return c.hasPointerCapture(ee,this)}setPointerCapture(ee){c.setPointerCapture(ee,this)}releaseCapture(ee){c.releaseCapture(ee,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&B.forEach(([ee,ie])=>{this.content.addEventListener(ee,me=>{this[ie](me)},{passive:!1})})}_pointerenter(ee){this.setPointersPositions(ee);const ie=O(ee.type);ie&&this._fire(ie.pointerenter,{evt:ee,target:this,currentTarget:this})}_pointerover(ee){this.setPointersPositions(ee);const ie=O(ee.type);ie&&this._fire(ie.pointerover,{evt:ee,target:this,currentTarget:this})}_getTargetShape(ee){let ie=this[ee+"targetShape"];return ie&&!ie.getStage()&&(ie=null),ie}_pointerleave(ee){const ie=O(ee.type),me=H(ee.type);if(!ie)return;this.setPointersPositions(ee);const Ce=this._getTargetShape(me),Oe=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;Ce&&Oe?(Ce._fireAndBubble(ie.pointerout,{evt:ee}),Ce._fireAndBubble(ie.pointerleave,{evt:ee}),this._fire(ie.pointerleave,{evt:ee,target:this,currentTarget:this}),this[me+"targetShape"]=null):Oe&&(this._fire(ie.pointerleave,{evt:ee,target:this,currentTarget:this}),this._fire(ie.pointerout,{evt:ee,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(ee){const ie=O(ee.type),me=H(ee.type);if(!ie)return;this.setPointersPositions(ee);let Ce=!1;this._changedPointerPositions.forEach(Oe=>{const fe=this.getIntersection(Oe);if(i.DD.justDragged=!1,s.Konva["_"+me+"ListenClick"]=!0,!fe||!fe.isListening()){this[me+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&fe.setPointerCapture(Oe.id),this[me+"ClickStartShape"]=fe,fe._fireAndBubble(ie.pointerdown,{evt:ee,pointerId:Oe.id}),Ce=!0;const pe=ee.type.indexOf("touch")>=0;fe.preventDefault()&&ee.cancelable&&pe&&ee.preventDefault()}),Ce||this._fire(ie.pointerdown,{evt:ee,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(ee){const ie=O(ee.type),me=H(ee.type);if(!ie||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&ee.cancelable&&ee.preventDefault(),this.setPointersPositions(ee),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const Oe={};let fe=!1;const pe=this._getTargetShape(me);this._changedPointerPositions.forEach(He=>{const Ye=c.getCapturedShape(He.id)||this.getIntersection(He),ot=He.id,Ve={evt:ee,pointerId:ot},Rt=pe!==Ye;if(Rt&&pe&&(pe._fireAndBubble(ie.pointerout,{...Ve},Ye),pe._fireAndBubble(ie.pointerleave,{...Ve},Ye)),Ye){if(Oe[Ye._id])return;Oe[Ye._id]=!0}Ye&&Ye.isListening()?(fe=!0,Rt&&(Ye._fireAndBubble(ie.pointerover,{...Ve},pe),Ye._fireAndBubble(ie.pointerenter,{...Ve},pe),this[me+"targetShape"]=Ye),Ye._fireAndBubble(ie.pointermove,{...Ve})):pe&&(this._fire(ie.pointerover,{evt:ee,target:this,currentTarget:this,pointerId:ot}),this[me+"targetShape"]=null)}),fe||this._fire(ie.pointermove,{evt:ee,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(ee){const ie=O(ee.type),me=H(ee.type);if(!ie)return;this.setPointersPositions(ee);const Ce=this[me+"ClickStartShape"],Oe=this[me+"ClickEndShape"],fe={};let pe=!1;this._changedPointerPositions.forEach(He=>{const Ye=c.getCapturedShape(He.id)||this.getIntersection(He);if(Ye){if(Ye.releaseCapture(He.id),fe[Ye._id])return;fe[Ye._id]=!0}const ot=He.id,Ve={evt:ee,pointerId:ot};let Rt=!1;s.Konva["_"+me+"InDblClickWindow"]?(Rt=!0,clearTimeout(this[me+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+me+"InDblClickWindow"]=!0,clearTimeout(this[me+"DblTimeout"])),this[me+"DblTimeout"]=setTimeout(function(){s.Konva["_"+me+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Ye&&Ye.isListening()?(pe=!0,this[me+"ClickEndShape"]=Ye,Ye._fireAndBubble(ie.pointerup,{...Ve}),s.Konva["_"+me+"ListenClick"]&&Ce&&Ce===Ye&&(Ye._fireAndBubble(ie.pointerclick,{...Ve}),Rt&&Oe&&Oe===Ye&&Ye._fireAndBubble(ie.pointerdblclick,{...Ve}))):(this[me+"ClickEndShape"]=null,s.Konva["_"+me+"ListenClick"]&&this._fire(ie.pointerclick,{evt:ee,target:this,currentTarget:this,pointerId:ot}),Rt&&this._fire(ie.pointerdblclick,{evt:ee,target:this,currentTarget:this,pointerId:ot}))}),pe||this._fire(ie.pointerup,{evt:ee,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+me+"ListenClick"]=!1,ee.cancelable&&me!=="touch"&&me!=="pointer"&&ee.preventDefault()}_contextmenu(ee){this.setPointersPositions(ee);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(X,{evt:ee}):this._fire(X,{evt:ee,target:this,currentTarget:this})}_wheel(ee){this.setPointersPositions(ee);const ie=this.getIntersection(this.getPointerPosition());ie&&ie.isListening()?ie._fireAndBubble(M,{evt:ee}):this._fire(M,{evt:ee,target:this,currentTarget:this})}_pointercancel(ee){this.setPointersPositions(ee);const ie=c.getCapturedShape(ee.pointerId)||this.getIntersection(this.getPointerPosition());ie&&ie._fireAndBubble(A,c.createEvent(ee)),c.releaseCapture(ee.pointerId)}_lostpointercapture(ee){c.releaseCapture(ee.pointerId)}setPointersPositions(ee){const ie=this._getContentPosition();let me=null,Ce=null;ee=ee||window.event,ee.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(ee.touches,Oe=>{this._pointerPositions.push({id:Oe.identifier,x:(Oe.clientX-ie.left)/ie.scaleX,y:(Oe.clientY-ie.top)/ie.scaleY})}),Array.prototype.forEach.call(ee.changedTouches||ee.touches,Oe=>{this._changedPointerPositions.push({id:Oe.identifier,x:(Oe.clientX-ie.left)/ie.scaleX,y:(Oe.clientY-ie.top)/ie.scaleY})})):(me=(ee.clientX-ie.left)/ie.scaleX,Ce=(ee.clientY-ie.top)/ie.scaleY,this.pointerPos={x:me,y:Ce},this._pointerPositions=[{x:me,y:Ce,id:t.Util._getFirstPointerId(ee)}],this._changedPointerPositions=[{x:me,y:Ce,id:t.Util._getFirstPointerId(ee)}])}_setPointerPosition(ee){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(ee)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const ee=this.content.getBoundingClientRect();return{top:ee.top,left:ee.left,scaleX:ee.width/this.content.clientWidth||1,scaleY:ee.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const ee=this.container();if(!ee)throw"Stage has no container. A container is required.";ee.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),ee.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(ee){ee.batchDraw()}),this}}e.Stage=J,J.prototype.nodeType=d,(0,o._registerNode)(J),r.Factory.addGetterSetter(J,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(te=>{te.batchDraw()})})})(uw)),uw}var Ng={},dw={},oT;function ra(){return oT||(oT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=Mr(),r=as(),n=$r(),s=ps(),a=zr(),i=Mr(),o=b6(),c="hasShadow",d="shadowRGBA",f="patternImage",p="linearGradient",g="radialGradient";let y;function v(){return y||(y=r.Util.createCanvasElement().getContext("2d"),y)}e.shapes={};function w(D){const I=this.attrs.fillRule;I?D.fill(I):D.fill()}function b(D){D.stroke()}function E(D){const I=this.attrs.fillRule;I?D.fill(I):D.fill()}function k(D){D.stroke()}function _(){this._clearCache(c)}function N(){this._clearCache(d)}function A(){this._clearCache(f)}function P(){this._clearCache(p)}function R(){this._clearCache(g)}class T extends s.Node{constructor(I){super(I);let K;for(;K=r.Util.getRandomColor(),!(K&&!(K in e.shapes)););this.colorKey=K,e.shapes[K]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(f,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const K=v().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(K&&K.setTransform){const X=new r.Transform;X.translate(this.fillPatternX(),this.fillPatternY()),X.rotate(t.Konva.getAngle(this.fillPatternRotation())),X.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),X.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const Z=X.getMatrix(),oe=typeof DOMMatrix>"u"?{a:Z[0],b:Z[1],c:Z[2],d:Z[3],e:Z[4],f:Z[5]}:new DOMMatrix(Z);K.setTransform(oe)}return K}}_getLinearGradient(){return this._getCache(p,this.__getLinearGradient)}__getLinearGradient(){const I=this.fillLinearGradientColorStops();if(I){const K=v(),X=this.fillLinearGradientStartPoint(),Z=this.fillLinearGradientEndPoint(),oe=K.createLinearGradient(X.x,X.y,Z.x,Z.y);for(let q=0;q<I.length;q+=2)oe.addColorStop(I[q],I[q+1]);return oe}}_getRadialGradient(){return this._getCache(g,this.__getRadialGradient)}__getRadialGradient(){const I=this.fillRadialGradientColorStops();if(I){const K=v(),X=this.fillRadialGradientStartPoint(),Z=this.fillRadialGradientEndPoint(),oe=K.createRadialGradient(X.x,X.y,this.fillRadialGradientStartRadius(),Z.x,Z.y,this.fillRadialGradientEndRadius());for(let q=0;q<I.length;q+=2)oe.addColorStop(I[q],I[q+1]);return oe}}getShadowRGBA(){return this._getCache(d,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const I=r.Util.colorToRGBA(this.shadowColor());if(I)return"rgba("+I.r+","+I.g+","+I.b+","+I.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const I=this.hitStrokeWidth();return I==="auto"?this.hasStroke():this.strokeEnabled()&&!!I}intersects(I){const K=this.getStage();if(!K)return!1;const X=K.bufferHitCanvas;return X.getContext().clear(),this.drawHit(X,void 0,!0),X.context.getImageData(Math.round(I.x),Math.round(I.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(I){var K;if(!((K=this.attrs.perfectDrawEnabled)!==null&&K!==void 0?K:!0))return!1;const Z=I||this.hasFill(),oe=this.hasStroke(),q=this.getAbsoluteOpacity()!==1;if(Z&&oe&&q)return!0;const re=this.hasShadow(),M=this.shadowForStrokeEnabled();return!!(Z&&oe&&re&&M)}setStrokeHitEnabled(I){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),I?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const I=this.size();return{x:this._centroid?-I.width/2:0,y:this._centroid?-I.height/2:0,width:I.width,height:I.height}}getClientRect(I={}){let K=!1,X=this.getParent();for(;X;){if(X.isCached()){K=!0;break}X=X.getParent()}const Z=I.skipTransform,oe=I.relativeTo||K&&this.getStage()||void 0,q=this.getSelfRect(),M=!I.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,W=q.width+M,B=q.height+M,G=!I.skipShadow&&this.hasShadow(),H=G?this.shadowOffsetX():0,O=G?this.shadowOffsetY():0,z=W+Math.abs(H),Y=B+Math.abs(O),J=G&&this.shadowBlur()||0,te=z+J*2,ee=Y+J*2,ie={width:te,height:ee,x:-(M/2+J)+Math.min(H,0)+q.x,y:-(M/2+J)+Math.min(O,0)+q.y};return Z?ie:this._transformedRect(ie,oe)}drawScene(I,K,X){const Z=this.getLayer(),oe=I||Z.getCanvas(),q=oe.getContext(),re=this._getCanvasCache(),M=this.getSceneFunc(),W=this.hasShadow();let B;const G=K===this;if(!this.isVisible()&&!G)return this;if(re){q.save();const H=this.getAbsoluteTransform(K).getMatrix();return q.transform(H[0],H[1],H[2],H[3],H[4],H[5]),this._drawCachedSceneCanvas(q),q.restore(),this}if(!M)return this;if(q.save(),this._useBufferCanvas()){B=this.getStage();const H=X||B.bufferCanvas,O=H.getContext();O.clear(),O.save(),O._applyLineJoin(this);const z=this.getAbsoluteTransform(K).getMatrix();O.transform(z[0],z[1],z[2],z[3],z[4],z[5]),M.call(this,O,this),O.restore();const Y=H.pixelRatio;W&&q._applyShadow(this),q._applyOpacity(this),q._applyGlobalCompositeOperation(this),q.drawImage(H._canvas,H.x||0,H.y||0,H.width/Y,H.height/Y)}else{if(q._applyLineJoin(this),!G){const H=this.getAbsoluteTransform(K).getMatrix();q.transform(H[0],H[1],H[2],H[3],H[4],H[5]),q._applyOpacity(this),q._applyGlobalCompositeOperation(this)}W&&q._applyShadow(this),M.call(this,q,this)}return q.restore(),this}drawHit(I,K,X=!1){if(!this.shouldDrawHit(K,X))return this;const Z=this.getLayer(),oe=I||Z.hitCanvas,q=oe&&oe.getContext(),re=this.hitFunc()||this.sceneFunc(),M=this._getCanvasCache(),W=M&&M.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),W){q.save();const G=this.getAbsoluteTransform(K).getMatrix();return q.transform(G[0],G[1],G[2],G[3],G[4],G[5]),this._drawCachedHitCanvas(q),q.restore(),this}if(!re)return this;if(q.save(),q._applyLineJoin(this),!(this===K)){const G=this.getAbsoluteTransform(K).getMatrix();q.transform(G[0],G[1],G[2],G[3],G[4],G[5])}return re.call(this,q,this),q.restore(),this}drawHitFromCache(I=0){const K=this._getCanvasCache(),X=this._getCachedSceneCanvas(),Z=K.hit,oe=Z.getContext(),q=Z.getWidth(),re=Z.getHeight();oe.clear(),oe.drawImage(X._canvas,0,0,q,re);try{const M=oe.getImageData(0,0,q,re),W=M.data,B=W.length,G=r.Util._hexToRgb(this.colorKey);for(let H=0;H<B;H+=4)W[H+3]>I?(W[H]=G.r,W[H+1]=G.g,W[H+2]=G.b,W[H+3]=255):W[H+3]=0;oe.putImageData(M,0,0)}catch(M){r.Util.error("Unable to draw hit graph from cached scene canvas. "+M.message)}return this}hasPointerCapture(I){return o.hasPointerCapture(I,this)}setPointerCapture(I){o.setPointerCapture(I,this)}releaseCapture(I){o.releaseCapture(I,this)}}e.Shape=T,T.prototype._fillFunc=w,T.prototype._strokeFunc=b,T.prototype._fillFuncHit=E,T.prototype._strokeFuncHit=k,T.prototype._centroid=!1,T.prototype.nodeType="Shape",(0,i._registerNode)(T),T.prototype.eventListeners={},T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),T.prototype.on.call(T.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",N),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",A),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",P),T.prototype.on.call(T.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",R),n.Factory.addGetterSetter(T,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(T,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(T,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(T,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(T,"lineJoin"),n.Factory.addGetterSetter(T,"lineCap"),n.Factory.addGetterSetter(T,"sceneFunc"),n.Factory.addGetterSetter(T,"hitFunc"),n.Factory.addGetterSetter(T,"dash"),n.Factory.addGetterSetter(T,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(T,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(T,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternImage"),n.Factory.addGetterSetter(T,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(T,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(T,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(T,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(T,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(T,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(T,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(T,"fillEnabled",!0),n.Factory.addGetterSetter(T,"strokeEnabled",!0),n.Factory.addGetterSetter(T,"shadowEnabled",!0),n.Factory.addGetterSetter(T,"dashEnabled",!0),n.Factory.addGetterSetter(T,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(T,"fillPriority","color"),n.Factory.addComponentsGetterSetter(T,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(T,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(T,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(T,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(T,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(T,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(T,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(T,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(T,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(T,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(T,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(T,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(T,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(T,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(T,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(T,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(T,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(T,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(T,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(T,"fillPatternRotation",0),n.Factory.addGetterSetter(T,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(T,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(dw)),dw}var lT;function S6(){if(lT)return Ng;lT=1,Object.defineProperty(Ng,"__esModule",{value:!0}),Ng.Layer=void 0;const e=as(),t=Ry(),r=ps(),n=$r(),s=Py(),a=zr(),i=ra(),o=Mr(),c="#",d="beforeDraw",f="draw",p=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],g=p.length;class y extends t.Container{constructor(w){super(w),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(w){return this.getContext().clear(w),this.getHitCanvas().getContext().clear(w),this}setZIndex(w){super.setZIndex(w);const b=this.getStage();return b&&b.content&&(b.content.removeChild(this.getNativeCanvasElement()),w<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[w+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const w=this.getStage();return w&&w.content&&(w.content.removeChild(this.getNativeCanvasElement()),w.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const b=this.getStage();return!b||!b.content?!1:(b.content.removeChild(this.getNativeCanvasElement()),this.index<b.children.length-1?b.content.insertBefore(this.getNativeCanvasElement(),b.children[this.index+1].getCanvas()._canvas):b.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const w=this.getStage();if(w){const b=w.children;w.content&&(w.content.removeChild(this.getNativeCanvasElement()),w.content.insertBefore(this.getNativeCanvasElement(),b[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const w=this.getStage();if(w){const b=w.children;w.content&&(w.content.removeChild(this.getNativeCanvasElement()),w.content.insertBefore(this.getNativeCanvasElement(),b[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const w=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),w&&w.parentNode&&e.Util._isInDocument(w)&&w.parentNode.removeChild(w),this}getStage(){return this.parent}setSize({width:w,height:b}){return this.canvas.setSize(w,b),this.hitCanvas.setSize(w,b),this._setSmoothEnabled(),this}_validateAdd(w){const b=w.getType();b!=="Group"&&b!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(w){return w=w||{},w.width=w.width||this.getWidth(),w.height=w.height||this.getHeight(),w.x=w.x!==void 0?w.x:this.x(),w.y=w.y!==void 0?w.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,w)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(w){if(!this.isListening()||!this.isVisible())return null;let b=1,E=!1;for(;;){for(let k=0;k<g;k++){const _=p[k],N=this._getIntersection({x:w.x+_.x*b,y:w.y+_.y*b}),A=N.shape;if(A)return A;if(E=!!N.antialiased,!N.antialiased)break}if(E)b+=1;else return null}}_getIntersection(w){const b=this.hitCanvas.pixelRatio,E=this.hitCanvas.context.getImageData(Math.round(w.x*b),Math.round(w.y*b),1,1).data,k=E[3];if(k===255){const _=e.Util._rgbToHex(E[0],E[1],E[2]),N=i.shapes[c+_];return N?{shape:N}:{antialiased:!0}}else if(k>0)return{antialiased:!0};return{}}drawScene(w,b,E){const k=this.getLayer(),_=w||k&&k.getCanvas();return this._fire(d,{node:this}),this.clearBeforeDraw()&&_.getContext().clear(),t.Container.prototype.drawScene.call(this,_,b,E),this._fire(f,{node:this}),this}drawHit(w,b){const E=this.getLayer(),k=w||E&&E.hitCanvas;return E&&E.clearBeforeDraw()&&E.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,k,b),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(w){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(w)}getHitGraphEnabled(w){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const w=this.parent;!!this.hitCanvas._canvas.parentNode?w.content.removeChild(this.hitCanvas._canvas):w.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return Ng.Layer=y,y.prototype.nodeType="Layer",(0,o._registerNode)(y),n.Factory.addGetterSetter(y,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(y,"clearBeforeDraw",!0),n.Factory.addGetterSetter(y,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),Ng}var Ag={},cT;function yM(){if(cT)return Ag;cT=1,Object.defineProperty(Ag,"__esModule",{value:!0}),Ag.FastLayer=void 0;const e=as(),t=S6(),r=Mr();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return Ag.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),Ag}var jg={},uT;function sb(){if(uT)return jg;uT=1,Object.defineProperty(jg,"__esModule",{value:!0}),jg.Group=void 0;const e=as(),t=Ry(),r=Mr();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return jg.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),jg}var Fg={},dT;function ab(){if(dT)return Fg;dT=1,Object.defineProperty(Fg,"__esModule",{value:!0}),Fg.Animation=void 0;const e=Mr(),t=as(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Nh{constructor(a,i){this.id=Nh.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let c=0;c<o;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Nh.animations,o=i.length;for(let c=0;c<o;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Nh._addAnimation(this),this}stop(){return Nh._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,c=o.length;for(let d=0;d<c;d++)if(o[d].id===i){this.animations.splice(d,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const c=i[o],d=c.layers,f=c.func;c._updateFrameObject(r());const p=d.length;let g;if(f?g=f.call(c,c.frame)!==!1:g=!0,!!g)for(let y=0;y<p;y++){const v=d[y];v._id!==void 0&&(a[v._id]=v)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Nh;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return Fg.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,Fg}var fw={},fT;function vM(){return fT||(fT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=as(),r=ab(),n=ps(),s=Mr(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,c=3,d=["fill","stroke","shadowColor"];let f=0;class p{constructor(v,w,b,E,k,_,N){this.prop=v,this.propFunc=w,this.begin=E,this._pos=E,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=N,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=b,this._change=k-this.begin,this.pause()}fire(v){const w=this[v];w&&w()}setTime(v){v>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():v<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=v,this.update())}getTime(){return this._time}setPosition(v){this.prevPos=this._pos,this.propFunc(v),this._pos=v}getPosition(v){return v===void 0&&(v=this._time),this.func(v,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(v){this.pause(),this._time=v,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const v=this.getTimer()-this._startTime;this.state===o?this.setTime(v):this.state===c&&this.setTime(this.duration-v)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class g{constructor(v){const w=this,b=v.node,E=b._id,k=v.easing||e.Easings.Linear,_=!!v.yoyo;let N,A;typeof v.duration>"u"?N=.3:v.duration===0?N=.001:N=v.duration,this.node=b,this._id=f++;const P=b.getLayer()||(b instanceof s.Konva.Stage?b.getLayers():null);P||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){w.tween.onEnterFrame()},P),this.tween=new p(A,function(R){w._tweenFunc(R)},k,0,1,N*1e3,_),this._addListeners(),g.attrs[E]||(g.attrs[E]={}),g.attrs[E][this._id]||(g.attrs[E][this._id]={}),g.tweens[E]||(g.tweens[E]={});for(A in v)a[A]===void 0&&this._addAttr(A,v[A]);this.reset(),this.onFinish=v.onFinish,this.onReset=v.onReset,this.onUpdate=v.onUpdate}_addAttr(v,w){const b=this.node,E=b._id;let k,_,N,A,P;const R=g.tweens[E][v];R&&delete g.attrs[E][R][v];let T=b.getAttr(v);if(t.Util._isArray(w))if(k=[],_=Math.max(w.length,T.length),v==="points"&&w.length!==T.length&&(w.length>T.length?(A=T,T=t.Util._prepareArrayForTween(T,w,b.closed())):(N=w,w=t.Util._prepareArrayForTween(w,T,b.closed()))),v.indexOf("fill")===0)for(let D=0;D<_;D++)if(D%2===0)k.push(w[D]-T[D]);else{const I=t.Util.colorToRGBA(T[D]);P=t.Util.colorToRGBA(w[D]),T[D]=I,k.push({r:P.r-I.r,g:P.g-I.g,b:P.b-I.b,a:P.a-I.a})}else for(let D=0;D<_;D++)k.push(w[D]-T[D]);else d.indexOf(v)!==-1?(T=t.Util.colorToRGBA(T),P=t.Util.colorToRGBA(w),k={r:P.r-T.r,g:P.g-T.g,b:P.b-T.b,a:P.a-T.a}):k=w-T;g.attrs[E][this._id][v]={start:T,diff:k,end:w,trueEnd:N,trueStart:A},g.tweens[E][v]=this._id}_tweenFunc(v){const w=this.node,b=g.attrs[w._id][this._id];let E,k,_,N,A,P,R,T;for(E in b){if(k=b[E],_=k.start,N=k.diff,T=k.end,t.Util._isArray(_))if(A=[],R=Math.max(_.length,T.length),E.indexOf("fill")===0)for(P=0;P<R;P++)P%2===0?A.push((_[P]||0)+N[P]*v):A.push("rgba("+Math.round(_[P].r+N[P].r*v)+","+Math.round(_[P].g+N[P].g*v)+","+Math.round(_[P].b+N[P].b*v)+","+(_[P].a+N[P].a*v)+")");else for(P=0;P<R;P++)A.push((_[P]||0)+N[P]*v);else d.indexOf(E)!==-1?A="rgba("+Math.round(_.r+N.r*v)+","+Math.round(_.g+N.g*v)+","+Math.round(_.b+N.b*v)+","+(_.a+N.a*v)+")":A=_+N*v;w.setAttr(E,A)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const v=this.node,w=g.attrs[v._id][this._id];w.points&&w.points.trueEnd&&v.setAttr("points",w.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const v=this.node,w=g.attrs[v._id][this._id];w.points&&w.points.trueStart&&v.points(w.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(v){return this.tween.seek(v*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const v=this.node._id,w=this._id,b=g.tweens[v];this.pause(),this.anim&&this.anim.stop();for(const E in b)delete g.tweens[v][E];delete g.attrs[v][w],g.tweens[v]&&(Object.keys(g.tweens[v]).length===0&&delete g.tweens[v],Object.keys(g.attrs[v]).length===0&&delete g.attrs[v])}}e.Tween=g,g.attrs={},g.tweens={},n.Node.prototype.to=function(y){const v=y.onFinish;y.node=this,y.onFinish=function(){this.destroy(),v&&v()},new g(y).play()},e.Easings={BackEaseIn(y,v,w,b){return w*(y/=b)*y*((1.70158+1)*y-1.70158)+v},BackEaseOut(y,v,w,b){return w*((y=y/b-1)*y*((1.70158+1)*y+1.70158)+1)+v},BackEaseInOut(y,v,w,b){let E=1.70158;return(y/=b/2)<1?w/2*(y*y*(((E*=1.525)+1)*y-E))+v:w/2*((y-=2)*y*(((E*=1.525)+1)*y+E)+2)+v},ElasticEaseIn(y,v,w,b,E,k){let _=0;return y===0?v:(y/=b)===1?v+w:(k||(k=b*.3),!E||E<Math.abs(w)?(E=w,_=k/4):_=k/(2*Math.PI)*Math.asin(w/E),-(E*Math.pow(2,10*(y-=1))*Math.sin((y*b-_)*(2*Math.PI)/k))+v)},ElasticEaseOut(y,v,w,b,E,k){let _=0;return y===0?v:(y/=b)===1?v+w:(k||(k=b*.3),!E||E<Math.abs(w)?(E=w,_=k/4):_=k/(2*Math.PI)*Math.asin(w/E),E*Math.pow(2,-10*y)*Math.sin((y*b-_)*(2*Math.PI)/k)+w+v)},ElasticEaseInOut(y,v,w,b,E,k){let _=0;return y===0?v:(y/=b/2)===2?v+w:(k||(k=b*(.3*1.5)),!E||E<Math.abs(w)?(E=w,_=k/4):_=k/(2*Math.PI)*Math.asin(w/E),y<1?-.5*(E*Math.pow(2,10*(y-=1))*Math.sin((y*b-_)*(2*Math.PI)/k))+v:E*Math.pow(2,-10*(y-=1))*Math.sin((y*b-_)*(2*Math.PI)/k)*.5+w+v)},BounceEaseOut(y,v,w,b){return(y/=b)<1/2.75?w*(7.5625*y*y)+v:y<2/2.75?w*(7.5625*(y-=1.5/2.75)*y+.75)+v:y<2.5/2.75?w*(7.5625*(y-=2.25/2.75)*y+.9375)+v:w*(7.5625*(y-=2.625/2.75)*y+.984375)+v},BounceEaseIn(y,v,w,b){return w-e.Easings.BounceEaseOut(b-y,0,w,b)+v},BounceEaseInOut(y,v,w,b){return y<b/2?e.Easings.BounceEaseIn(y*2,0,w,b)*.5+v:e.Easings.BounceEaseOut(y*2-b,0,w,b)*.5+w*.5+v},EaseIn(y,v,w,b){return w*(y/=b)*y+v},EaseOut(y,v,w,b){return-w*(y/=b)*(y-2)+v},EaseInOut(y,v,w,b){return(y/=b/2)<1?w/2*y*y+v:-w/2*(--y*(y-2)-1)+v},StrongEaseIn(y,v,w,b){return w*(y/=b)*y*y*y*y+v},StrongEaseOut(y,v,w,b){return w*((y=y/b-1)*y*y*y*y+1)+v},StrongEaseInOut(y,v,w,b){return(y/=b/2)<1?w/2*y*y*y*y*y+v:w/2*((y-=2)*y*y*y*y+2)+v},Linear(y,v,w,b){return w*y/b+v}}})(fw)),fw}var hT;function S_(){return hT||(hT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=Mr(),r=as(),n=ps(),s=Ry(),a=xM(),i=S6(),o=yM(),c=sb(),d=nb(),f=ra(),p=ab(),g=vM(),y=_6(),v=Py();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:c.Group,DD:d.DD,Shape:f.Shape,shapes:f.shapes,Animation:p.Animation,Tween:g.Tween,Easings:g.Easings,Context:y.Context,Canvas:v.Canvas}),e.default=e.Konva})(aw)),aw}var Pg={},gT;function wM(){if(gT)return Pg;gT=1,Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.Arc=void 0;const e=$r(),t=ra(),r=Mr(),n=zr(),s=Mr();class a extends t.Shape{_sceneFunc(o){const c=r.Konva.getAngle(this.angle()),d=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,c,d),o.arc(0,0,this.innerRadius(),c,0,!d),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),c=this.outerRadius(),d=this.clockwise(),f=r.Konva.getAngle(d?360-this.angle():this.angle()),p=Math.cos(Math.min(f,Math.PI)),g=1,y=Math.sin(Math.min(Math.max(Math.PI,f),3*Math.PI/2)),v=Math.sin(Math.min(f,Math.PI/2)),w=p*(p>0?o:c),b=g*c,E=y*(y>0?o:c),k=v*(v>0?c:o);return{x:w,y:d?-1*k:E,width:b-w,height:k-E}}}return Pg.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),Pg}var Rg={},Dg={},mT;function k6(){if(mT)return Dg;mT=1,Object.defineProperty(Dg,"__esModule",{value:!0}),Dg.Line=void 0;const e=$r(),t=Mr(),r=ra(),n=zr();function s(o,c,d,f,p,g,y){const v=Math.sqrt(Math.pow(d-o,2)+Math.pow(f-c,2)),w=Math.sqrt(Math.pow(p-d,2)+Math.pow(g-f,2)),b=y*v/(v+w),E=y*w/(v+w),k=d-b*(p-o),_=f-b*(g-c),N=d+E*(p-o),A=f+E*(g-c);return[k,_,N,A]}function a(o,c){const d=o.length,f=[];for(let p=2;p<d-2;p+=2){const g=s(o[p-2],o[p-1],o[p],o[p+1],o[p+2],o[p+3],c);isNaN(g[0])||(f.push(g[0]),f.push(g[1]),f.push(o[p]),f.push(o[p+1]),f.push(g[2]),f.push(g[3]))}return f}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const d=this.points(),f=d.length,p=this.tension(),g=this.closed(),y=this.bezier();if(!f)return;let v=0;if(c.beginPath(),c.moveTo(d[0],d[1]),p!==0&&f>4){const w=this.getTensionPoints(),b=w.length;for(v=g?0:4,g||c.quadraticCurveTo(w[0],w[1],w[2],w[3]);v<b-2;)c.bezierCurveTo(w[v++],w[v++],w[v++],w[v++],w[v++],w[v++]);g||c.quadraticCurveTo(w[b-2],w[b-1],d[f-2],d[f-1])}else if(y)for(v=2;v<f;)c.bezierCurveTo(d[v++],d[v++],d[v++],d[v++],d[v++],d[v++]);else for(v=2;v<f;v+=2)c.lineTo(d[v],d[v+1]);g?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),d=c.length,f=this.tension(),p=s(c[d-2],c[d-1],c[0],c[1],c[2],c[3],f),g=s(c[d-4],c[d-3],c[d-2],c[d-1],c[0],c[1],f),y=a(c,f);return[p[2],p[3]].concat(y).concat([g[0],g[1],c[d-2],c[d-1],g[2],g[3],p[0],p[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let d=c[0],f=c[0],p=c[1],g=c[1],y,v;for(let w=0;w<c.length/2;w++)y=c[w*2],v=c[w*2+1],d=Math.min(d,y),f=Math.max(f,y),p=Math.min(p,v),g=Math.max(g,v);return{x:d,y:p,width:f-d,height:g-p}}}return Dg.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),Dg}var Ig={},hw={},pT;function _M(){return pT||(pT=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,c)=>{let d,f;const g=c/2;d=0;for(let y=0;y<20;y++)f=g*e.tValues[20][y]+g,d+=e.cValues[20][y]*n(i,o,f);return g*d};e.getCubicArcLength=t;const r=(i,o,c)=>{c===void 0&&(c=1);const d=i[0]-2*i[1]+i[2],f=o[0]-2*o[1]+o[2],p=2*i[1]-2*i[0],g=2*o[1]-2*o[0],y=4*(d*d+f*f),v=4*(d*p+f*g),w=p*p+g*g;if(y===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const b=v/(2*y),E=w/y,k=c+b,_=E-b*b,N=k*k+_>0?Math.sqrt(k*k+_):0,A=b*b+_>0?Math.sqrt(b*b+_):0,P=b+Math.sqrt(b*b+_)!==0?_*Math.log(Math.abs((k+N)/(b+A))):0;return Math.sqrt(y)/2*(k*N-b*A+P)};e.getQuadraticArcLength=r;function n(i,o,c){const d=s(1,c,i),f=s(1,c,o),p=d*d+f*f;return Math.sqrt(p)}const s=(i,o,c)=>{const d=c.length-1;let f,p;if(d===0)return 0;if(i===0){p=0;for(let g=0;g<=d;g++)p+=e.binomialCoefficients[d][g]*Math.pow(1-o,d-g)*Math.pow(o,g)*c[g];return p}else{f=new Array(d);for(let g=0;g<d;g++)f[g]=d*(c[g+1]-c[g]);return s(i-1,o,f)}},a=(i,o,c)=>{let d=1,f=i/o,p=(i-c(f))/o,g=0;for(;d>.001;){const y=c(f+p),v=Math.abs(i-y)/o;if(v<d)d=v,f+=p;else{const w=c(f-p),b=Math.abs(i-w)/o;b<d?(d=b,f-=p):p/=2}if(g++,g>500)break}return f};e.t2length=a})(hw)),hw}var xT;function ib(){if(xT)return Ig;xT=1,Object.defineProperty(Ig,"__esModule",{value:!0}),Ig.Path=void 0;const e=$r(),t=Mr(),r=ra(),n=_M();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let c=!1;for(let d=0;d<o.length;d++){const f=o[d].command,p=o[d].points;switch(f){case"L":i.lineTo(p[0],p[1]);break;case"M":i.moveTo(p[0],p[1]);break;case"C":i.bezierCurveTo(p[0],p[1],p[2],p[3],p[4],p[5]);break;case"Q":i.quadraticCurveTo(p[0],p[1],p[2],p[3]);break;case"A":const g=p[0],y=p[1],v=p[2],w=p[3],b=p[4],E=p[5],k=p[6],_=p[7],N=v>w?v:w,A=v>w?1:v/w,P=v>w?w/v:1;i.translate(g,y),i.rotate(k),i.scale(A,P),i.arc(0,0,N,b,b+E,1-_),i.scale(1/A,1/P),i.rotate(-k),i.translate(-g,-y);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(y){if(y.command==="A"){const v=y.points[4],w=y.points[5],b=y.points[4]+w;let E=Math.PI/180;if(Math.abs(v-b)<E&&(E=Math.abs(v-b)),w<0)for(let k=v-E;k>b;k-=E){const _=s.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],k,0);i.push(_.x,_.y)}else for(let k=v+E;k<b;k+=E){const _=s.getPointOnEllipticalArc(y.points[0],y.points[1],y.points[2],y.points[3],k,0);i.push(_.x,_.y)}}else if(y.command==="C")for(let v=0;v<=1;v+=.01){const w=s.getPointOnCubicBezier(v,y.start.x,y.start.y,y.points[0],y.points[1],y.points[2],y.points[3],y.points[4],y.points[5]);i.push(w.x,w.y)}else i=i.concat(y.points)});let o=i[0],c=i[0],d=i[1],f=i[1],p,g;for(let y=0;y<i.length/2;y++)p=i[y*2],g=i[y*2+1],isNaN(p)||(o=Math.min(o,p),c=Math.max(c,p)),isNaN(g)||(d=Math.min(d,g),f=Math.max(f,g));return{x:o,y:d,width:c-o,height:f-d}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,c,d){return Math.sqrt((c-i)*(c-i)+(d-o)*(d-o))}static getPathLength(i){let o=0;for(let c=0;c<i.length;++c)o+=i[c].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let c,d=0,f=o.length;if(!f)return null;for(;d<f&&i>o[d].pathLength;)i-=o[d].pathLength,++d;if(d===f)return c=o[d-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return o[d].command==="M"?(c=o[d].points.slice(0,2),{x:c[0],y:c[1]}):{x:o[d].start.x,y:o[d].start.y};const p=o[d],g=p.points;switch(p.command){case"L":return s.getPointOnLine(i,p.start.x,p.start.y,g[0],g[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getCubicArcLength)([p.start.x,g[0],g[2],g[4]],[p.start.y,g[1],g[3],g[5]],N)),p.start.x,p.start.y,g[0],g[1],g[2],g[3],g[4],g[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),N=>(0,n.getQuadraticArcLength)([p.start.x,g[0],g[2]],[p.start.y,g[1],g[3]],N)),p.start.x,p.start.y,g[0],g[1],g[2],g[3]);case"A":const y=g[0],v=g[1],w=g[2],b=g[3],E=g[5],k=g[6];let _=g[4];return _+=E*i/p.pathLength,s.getPointOnEllipticalArc(y,v,w,b,_,k)}return null}static getPointOnLine(i,o,c,d,f,p,g){p=p??o,g=g??c;const y=this.getLineLength(o,c,d,f);if(y<1e-10)return{x:o,y:c};if(d===o)return{x:p,y:g+(f>c?i:-i)};const v=(f-c)/(d-o),w=Math.sqrt(i*i/(1+v*v))*(d<o?-1:1),b=v*w;if(Math.abs(g-c-v*(p-o))<1e-10)return{x:p+w,y:g+b};const E=((p-o)*(d-o)+(g-c)*(f-c))/(y*y),k=o+E*(d-o),_=c+E*(f-c),N=this.getLineLength(p,g,k,_),A=Math.sqrt(i*i-N*N),P=Math.sqrt(A*A/(1+v*v))*(d<o?-1:1),R=v*P;return{x:k+P,y:_+R}}static getPointOnCubicBezier(i,o,c,d,f,p,g,y,v){function w(A){return A*A*A}function b(A){return 3*A*A*(1-A)}function E(A){return 3*A*(1-A)*(1-A)}function k(A){return(1-A)*(1-A)*(1-A)}const _=y*w(i)+p*b(i)+d*E(i)+o*k(i),N=v*w(i)+g*b(i)+f*E(i)+c*k(i);return{x:_,y:N}}static getPointOnQuadraticBezier(i,o,c,d,f,p,g){function y(k){return k*k}function v(k){return 2*k*(1-k)}function w(k){return(1-k)*(1-k)}const b=p*y(i)+d*v(i)+o*w(i),E=g*y(i)+f*v(i)+c*w(i);return{x:b,y:E}}static getPointOnEllipticalArc(i,o,c,d,f,p){const g=Math.cos(p),y=Math.sin(p),v={x:c*Math.cos(f),y:d*Math.sin(f)};return{x:i+(v.x*g-v.y*y),y:o+(v.x*y+v.y*g)}}static parsePathData(i){if(!i)return[];let o=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let b=0;b<c.length;b++)o=o.replace(new RegExp(c[b],"g"),"|"+c[b]);const d=o.split("|"),f=[],p=[];let g=0,y=0;const v=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let w;for(let b=1;b<d.length;b++){let E=d[b],k=E.charAt(0);for(E=E.slice(1),p.length=0;w=v.exec(E);)p.push(w[0]);const _=[];for(let N=0,A=p.length;N<A;N++){if(p[N]==="00"){_.push(0,0);continue}const P=parseFloat(p[N]);isNaN(P)?_.push(0):_.push(P)}for(;_.length>0&&!isNaN(_[0]);){let N="",A=[];const P=g,R=y;let T,D,I,K,X,Z,oe,q,re,M;switch(k){case"l":g+=_.shift(),y+=_.shift(),N="L",A.push(g,y);break;case"L":g=_.shift(),y=_.shift(),A.push(g,y);break;case"m":const W=_.shift(),B=_.shift();if(g+=W,y+=B,N="M",f.length>2&&f[f.length-1].command==="z"){for(let G=f.length-2;G>=0;G--)if(f[G].command==="M"){g=f[G].points[0]+W,y=f[G].points[1]+B;break}}A.push(g,y),k="l";break;case"M":g=_.shift(),y=_.shift(),N="M",A.push(g,y),k="L";break;case"h":g+=_.shift(),N="L",A.push(g,y);break;case"H":g=_.shift(),N="L",A.push(g,y);break;case"v":y+=_.shift(),N="L",A.push(g,y);break;case"V":y=_.shift(),N="L",A.push(g,y);break;case"C":A.push(_.shift(),_.shift(),_.shift(),_.shift()),g=_.shift(),y=_.shift(),A.push(g,y);break;case"c":A.push(g+_.shift(),y+_.shift(),g+_.shift(),y+_.shift()),g+=_.shift(),y+=_.shift(),N="C",A.push(g,y);break;case"S":D=g,I=y,T=f[f.length-1],T.command==="C"&&(D=g+(g-T.points[2]),I=y+(y-T.points[3])),A.push(D,I,_.shift(),_.shift()),g=_.shift(),y=_.shift(),N="C",A.push(g,y);break;case"s":D=g,I=y,T=f[f.length-1],T.command==="C"&&(D=g+(g-T.points[2]),I=y+(y-T.points[3])),A.push(D,I,g+_.shift(),y+_.shift()),g+=_.shift(),y+=_.shift(),N="C",A.push(g,y);break;case"Q":A.push(_.shift(),_.shift()),g=_.shift(),y=_.shift(),A.push(g,y);break;case"q":A.push(g+_.shift(),y+_.shift()),g+=_.shift(),y+=_.shift(),N="Q",A.push(g,y);break;case"T":D=g,I=y,T=f[f.length-1],T.command==="Q"&&(D=g+(g-T.points[0]),I=y+(y-T.points[1])),g=_.shift(),y=_.shift(),N="Q",A.push(D,I,g,y);break;case"t":D=g,I=y,T=f[f.length-1],T.command==="Q"&&(D=g+(g-T.points[0]),I=y+(y-T.points[1])),g+=_.shift(),y+=_.shift(),N="Q",A.push(D,I,g,y);break;case"A":K=_.shift(),X=_.shift(),Z=_.shift(),oe=_.shift(),q=_.shift(),re=g,M=y,g=_.shift(),y=_.shift(),N="A",A=this.convertEndpointToCenterParameterization(re,M,g,y,oe,q,K,X,Z);break;case"a":K=_.shift(),X=_.shift(),Z=_.shift(),oe=_.shift(),q=_.shift(),re=g,M=y,g+=_.shift(),y+=_.shift(),N="A",A=this.convertEndpointToCenterParameterization(re,M,g,y,oe,q,K,X,Z);break}f.push({command:N||k,points:A,start:{x:P,y:R},pathLength:this.calcLength(P,R,N||k,A)})}(k==="z"||k==="Z")&&f.push({command:"z",points:[],start:void 0,pathLength:0})}return f}static calcLength(i,o,c,d){let f,p,g,y;const v=s;switch(c){case"L":return v.getLineLength(i,o,d[0],d[1]);case"C":return(0,n.getCubicArcLength)([i,d[0],d[2],d[4]],[o,d[1],d[3],d[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,d[0],d[2]],[o,d[1],d[3]],1);case"A":f=0;const w=d[4],b=d[5],E=d[4]+b;let k=Math.PI/180;if(Math.abs(w-E)<k&&(k=Math.abs(w-E)),p=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],w,0),b<0)for(y=w-k;y>E;y-=k)g=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),f+=v.getLineLength(p.x,p.y,g.x,g.y),p=g;else for(y=w+k;y<E;y+=k)g=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],y,0),f+=v.getLineLength(p.x,p.y,g.x,g.y),p=g;return g=v.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],E,0),f+=v.getLineLength(p.x,p.y,g.x,g.y),f}return 0}static convertEndpointToCenterParameterization(i,o,c,d,f,p,g,y,v){const w=v*(Math.PI/180),b=Math.cos(w)*(i-c)/2+Math.sin(w)*(o-d)/2,E=-1*Math.sin(w)*(i-c)/2+Math.cos(w)*(o-d)/2,k=b*b/(g*g)+E*E/(y*y);k>1&&(g*=Math.sqrt(k),y*=Math.sqrt(k));let _=Math.sqrt((g*g*(y*y)-g*g*(E*E)-y*y*(b*b))/(g*g*(E*E)+y*y*(b*b)));f===p&&(_*=-1),isNaN(_)&&(_=0);const N=_*g*E/y,A=_*-y*b/g,P=(i+c)/2+Math.cos(w)*N-Math.sin(w)*A,R=(o+d)/2+Math.sin(w)*N+Math.cos(w)*A,T=function(q){return Math.sqrt(q[0]*q[0]+q[1]*q[1])},D=function(q,re){return(q[0]*re[0]+q[1]*re[1])/(T(q)*T(re))},I=function(q,re){return(q[0]*re[1]<q[1]*re[0]?-1:1)*Math.acos(D(q,re))},K=I([1,0],[(b-N)/g,(E-A)/y]),X=[(b-N)/g,(E-A)/y],Z=[(-1*b-N)/g,(-1*E-A)/y];let oe=I(X,Z);return D(X,Z)<=-1&&(oe=Math.PI),D(X,Z)>=1&&(oe=0),p===0&&oe>0&&(oe=oe-2*Math.PI),p===1&&oe<0&&(oe=oe+2*Math.PI),[P,R,g,y,K,oe,w,p]}}return Ig.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),Ig}var yT;function bM(){if(yT)return Rg;yT=1,Object.defineProperty(Rg,"__esModule",{value:!0}),Rg.Arrow=void 0;const e=$r(),t=k6(),r=zr(),n=Mr(),s=ib();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const c=Math.PI*2,d=this.points();let f=d;const p=this.tension()!==0&&d.length>4;p&&(f=this.getTensionPoints());const g=this.pointerLength(),y=d.length;let v,w;if(p){const k=[f[f.length-4],f[f.length-3],f[f.length-2],f[f.length-1],d[y-2],d[y-1]],_=s.Path.calcLength(f[f.length-4],f[f.length-3],"C",k),N=s.Path.getPointOnQuadraticBezier(Math.min(1,1-g/_),k[0],k[1],k[2],k[3],k[4],k[5]);v=d[y-2]-N.x,w=d[y-1]-N.y}else v=d[y-2]-d[y-4],w=d[y-1]-d[y-3];const b=(Math.atan2(w,v)+c)%c,E=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(d[y-2],d[y-1]),o.rotate(b),o.moveTo(0,0),o.lineTo(-g,E/2),o.lineTo(-g,-E/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(d[0],d[1]),p?(v=(f[0]+f[2])/2-d[0],w=(f[1]+f[3])/2-d[1]):(v=d[2]-d[0],w=d[3]-d[1]),o.rotate((Math.atan2(-w,-v)+c)%c),o.moveTo(0,0),o.lineTo(-g,E/2),o.lineTo(-g,-E/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),c=this.pointerWidth()/2;return{x:o.x,y:o.y-c,width:o.width,height:o.height+c*2}}}return Rg.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),Rg}var Mg={},vT;function SM(){if(vT)return Mg;vT=1,Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.Circle=void 0;const e=$r(),t=ra(),r=zr(),n=Mr();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return Mg.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),Mg}var Og={},wT;function kM(){if(wT)return Og;wT=1,Object.defineProperty(Og,"__esModule",{value:!0}),Og.Ellipse=void 0;const e=$r(),t=ra(),r=zr(),n=Mr();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),o!==c&&i.scale(1,c/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return Og.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),Og}var Lg={},_T;function CM(){if(_T)return Lg;_T=1,Object.defineProperty(Lg,"__esModule",{value:!0}),Lg.Image=void 0;const e=as(),t=$r(),r=ra(),n=Mr(),s=zr();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),c=this.hasShadow();return o&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const c=this.getWidth(),d=this.getHeight(),f=this.cornerRadius(),p=this.attrs.image;let g;if(p){const y=this.attrs.cropWidth,v=this.attrs.cropHeight;y&&v?g=[p,this.cropX(),this.cropY(),y,v,0,0,c,d]:g=[p,0,0,c,d]}(this.hasFill()||this.hasStroke()||f)&&(o.beginPath(),f?e.Util.drawRoundedRectPath(o,c,d,f):o.rect(0,0,c,d),o.closePath(),o.fillStrokeShape(this)),p&&(f&&o.clip(),o.drawImage.apply(o,g))}_hitFunc(o){const c=this.width(),d=this.height(),f=this.cornerRadius();o.beginPath(),f?e.Util.drawRoundedRectPath(o,c,d,f):o.rect(0,0,c,d),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,c;return(o=this.attrs.width)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var o,c;return(o=this.attrs.height)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(o,c,d=null){const f=e.Util.createImageElement();f.onload=function(){const p=new a({image:f});c(p)},f.onerror=d,f.crossOrigin="Anonymous",f.src=o}}return Lg.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),Lg}var jd={},bT;function TM(){if(bT)return jd;bT=1,Object.defineProperty(jd,"__esModule",{value:!0}),jd.Tag=jd.Label=void 0;const e=$r(),t=ra(),r=sb(),n=zr(),s=Mr(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",c="up",d="right",f="down",p="left",g=a.length;class y extends r.Group{constructor(b){super(b),this.on("add.konva",function(E){this._addListeners(E.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(b){let E=this,k;const _=function(){E._sync()};for(k=0;k<g;k++)b.on(a[k]+i,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let b=this.getText(),E=this.getTag(),k,_,N,A,P,R,T;if(b&&E){switch(k=b.width(),_=b.height(),N=E.pointerDirection(),A=E.pointerWidth(),T=E.pointerHeight(),P=0,R=0,N){case c:P=k/2,R=-1*T;break;case d:P=k+A,R=_/2;break;case f:P=k/2,R=_+T;break;case p:P=-1*A,R=_/2;break}E.setAttrs({x:-1*P,y:-1*R,width:k,height:_}),b.setAttrs({x:-1*P,y:-1*R})}}}jd.Label=y,y.prototype.className="Label",(0,s._registerNode)(y);class v extends t.Shape{_sceneFunc(b){const E=this.width(),k=this.height(),_=this.pointerDirection(),N=this.pointerWidth(),A=this.pointerHeight(),P=this.cornerRadius();let R=0,T=0,D=0,I=0;typeof P=="number"?R=T=D=I=Math.min(P,E/2,k/2):(R=Math.min(P[0]||0,E/2,k/2),T=Math.min(P[1]||0,E/2,k/2),I=Math.min(P[2]||0,E/2,k/2),D=Math.min(P[3]||0,E/2,k/2)),b.beginPath(),b.moveTo(R,0),_===c&&(b.lineTo((E-N)/2,0),b.lineTo(E/2,-1*A),b.lineTo((E+N)/2,0)),b.lineTo(E-T,0),b.arc(E-T,T,T,Math.PI*3/2,0,!1),_===d&&(b.lineTo(E,(k-A)/2),b.lineTo(E+N,k/2),b.lineTo(E,(k+A)/2)),b.lineTo(E,k-I),b.arc(E-I,k-I,I,0,Math.PI/2,!1),_===f&&(b.lineTo((E+N)/2,k),b.lineTo(E/2,k+A),b.lineTo((E-N)/2,k)),b.lineTo(D,k),b.arc(D,k-D,D,Math.PI/2,Math.PI,!1),_===p&&(b.lineTo(0,(k+A)/2),b.lineTo(-1*N,k/2),b.lineTo(0,(k-A)/2)),b.lineTo(0,R),b.arc(R,R,R,Math.PI,Math.PI*3/2,!1),b.closePath(),b.fillStrokeShape(this)}getSelfRect(){let b=0,E=0,k=this.pointerWidth(),_=this.pointerHeight(),N=this.pointerDirection(),A=this.width(),P=this.height();return N===c?(E-=_,P+=_):N===f?P+=_:N===p?(b-=k*1.5,A+=k):N===d&&(A+=k*1.5),{x:b,y:E,width:A,height:P}}}return jd.Tag=v,v.prototype.className="Tag",(0,s._registerNode)(v),e.Factory.addGetterSetter(v,"pointerDirection",o),e.Factory.addGetterSetter(v,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(v,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(v,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),jd}var Bg={},ST;function C6(){if(ST)return Bg;ST=1,Object.defineProperty(Bg,"__esModule",{value:!0}),Bg.Rect=void 0;const e=$r(),t=ra(),r=Mr(),n=as(),s=zr();class a extends t.Shape{_sceneFunc(o){const c=this.cornerRadius(),d=this.width(),f=this.height();o.beginPath(),c?n.Util.drawRoundedRectPath(o,d,f,c):o.rect(0,0,d,f),o.closePath(),o.fillStrokeShape(this)}}return Bg.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),Bg}var Ug={},kT;function EM(){if(kT)return Ug;kT=1,Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.RegularPolygon=void 0;const e=$r(),t=ra(),r=zr(),n=Mr();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let c=1;c<o.length;c++)i.lineTo(o[c].x,o[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,c=[];for(let d=0;d<i;d++)c.push({x:o*Math.sin(d*2*Math.PI/i),y:-1*o*Math.cos(d*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let o=i[0].x,c=i[0].y,d=i[0].x,f=i[0].y;return i.forEach(p=>{o=Math.min(o,p.x),c=Math.max(c,p.x),d=Math.min(d,p.y),f=Math.max(f,p.y)}),{x:o,y:d,width:c-o,height:f-d}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return Ug.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),Ug}var $g={},CT;function NM(){if(CT)return $g;CT=1,Object.defineProperty($g,"__esModule",{value:!0}),$g.Ring=void 0;const e=$r(),t=ra(),r=zr(),n=Mr(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return $g.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),$g}var Wg={},TT;function AM(){if(TT)return Wg;TT=1,Object.defineProperty(Wg,"__esModule",{value:!0}),Wg.Sprite=void 0;const e=$r(),t=ra(),r=ab(),n=zr(),s=Mr();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const c=this.animation(),d=this.frameIndex(),f=d*4,p=this.animations()[c],g=this.frameOffsets(),y=p[f+0],v=p[f+1],w=p[f+2],b=p[f+3],E=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,w,b),o.closePath(),o.fillStrokeShape(this)),E)if(g){const k=g[c],_=d*2;o.drawImage(E,y,v,w,b,k[_+0],k[_+1],w,b)}else o.drawImage(E,y,v,w,b,0,0,w,b)}_hitFunc(o){const c=this.animation(),d=this.frameIndex(),f=d*4,p=this.animations()[c],g=this.frameOffsets(),y=p[f+2],v=p[f+3];if(o.beginPath(),g){const w=g[c],b=d*2;o.rect(w[b+0],w[b+1],y,v)}else o.rect(0,0,y,v);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),c=this.animation(),d=this.animations(),f=d[c],p=f.length/4;o<p-1?this.frameIndex(o+1):this.frameIndex(0)}}return Wg.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),Wg}var zg={},ET;function jM(){if(ET)return zg;ET=1,Object.defineProperty(zg,"__esModule",{value:!0}),zg.Star=void 0;const e=$r(),t=ra(),r=zr(),n=Mr();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),c=this.outerRadius(),d=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let f=1;f<d*2;f++){const p=f%2===0?c:o,g=p*Math.sin(f*Math.PI/d),y=-1*p*Math.cos(f*Math.PI/d);i.lineTo(g,y)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return zg.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),zg}var bh={},NT;function T6(){if(NT)return bh;NT=1,Object.defineProperty(bh,"__esModule",{value:!0}),bh.Text=void 0,bh.stringToArray=i;const e=as(),t=$r(),r=ra(),n=Mr(),s=zr(),a=Mr();function i(O){return[...O].reduce((z,Y,J,te)=>{if(new RegExp("\\p{Emoji}","u").test(Y)){const ee=te[J+1];ee&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(ee)?(z.push(Y+ee),te[J+1]=""):z.push(Y)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(Y+(te[J+1]||""))?z.push(Y+te[J+1]):J>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(Y)?z[z.length-1]+=Y:Y&&z.push(Y);return z},[])}const o="auto",c="center",d="inherit",f="justify",p="Change.konva",g="2d",y="-",v="left",w="text",b="Text",E="top",k="bottom",_="middle",N="normal",A="px ",P=" ",R="right",T="rtl",D="word",I="char",K="none",X="",Z=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],oe=Z.length;function q(O){return O.split(",").map(z=>{z=z.trim();const Y=z.indexOf(" ")>=0,J=z.indexOf('"')>=0||z.indexOf("'")>=0;return Y&&!J&&(z=`"${z}"`),z}).join(", ")}let re;function M(){return re||(re=e.Util.createCanvasElement().getContext(g),re)}function W(O){O.fillText(this._partialText,this._partialTextX,this._partialTextY)}function B(O){O.setAttr("miterLimit",2),O.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function G(O){return O=O||{},!O.fillLinearGradientColorStops&&!O.fillRadialGradientColorStops&&!O.fillPatternImage&&(O.fill=O.fill||"black"),O}class H extends r.Shape{constructor(z){super(G(z)),this._partialTextX=0,this._partialTextY=0;for(let Y=0;Y<oe;Y++)this.on(Z[Y]+p,this._setTextData);this._setTextData()}_sceneFunc(z){const Y=this.textArr,J=Y.length;if(!this.text())return;let te=this.padding(),ee=this.fontSize(),ie=this.lineHeight()*ee,me=this.verticalAlign(),Ce=this.direction(),Oe=0,fe=this.align(),pe=this.getWidth(),He=this.letterSpacing(),Ye=this.fill(),ot=this.textDecoration(),Ve=ot.indexOf("underline")!==-1,Rt=ot.indexOf("line-through")!==-1,tt;Ce=Ce===d?z.direction:Ce;let Le=ie/2,De=_;if(n.Konva._fixTextRendering){const Je=this.measureSize("M");De="alphabetic",Le=(Je.fontBoundingBoxAscent-Je.fontBoundingBoxDescent)/2+ie/2}for(Ce===T&&z.setAttr("direction",Ce),z.setAttr("font",this._getContextFont()),z.setAttr("textBaseline",De),z.setAttr("textAlign",v),me===_?Oe=(this.getHeight()-J*ie-te*2)/2:me===k&&(Oe=this.getHeight()-J*ie-te*2),z.translate(te,Oe+te),tt=0;tt<J;tt++){let Je=0,_t=0;const ht=Y[tt],It=ht.text,Mt=ht.width,rt=ht.lastInParagraph;if(z.save(),fe===R?Je+=pe-Mt-te*2:fe===c&&(Je+=(pe-Mt-te*2)/2),Ve){z.save(),z.beginPath();const qe=n.Konva._fixTextRendering?Math.round(ee/4):Math.round(ee/2),pt=Je,lt=Le+_t+qe;z.moveTo(pt,lt);const wt=fe===f&&!rt?pe-te*2:Mt;z.lineTo(pt+Math.round(wt),lt),z.lineWidth=ee/15;const Lt=this._getLinearGradient();z.strokeStyle=Lt||Ye,z.stroke(),z.restore()}if(Rt){z.save(),z.beginPath();const qe=n.Konva._fixTextRendering?-Math.round(ee/4):0;z.moveTo(Je,Le+_t+qe);const pt=fe===f&&!rt?pe-te*2:Mt;z.lineTo(Je+Math.round(pt),Le+_t+qe),z.lineWidth=ee/15;const lt=this._getLinearGradient();z.strokeStyle=lt||Ye,z.stroke(),z.restore()}if(Ce!==T&&(He!==0||fe===f)){const qe=It.split(" ").length-1,pt=i(It);for(let lt=0;lt<pt.length;lt++){const wt=pt[lt];wt===" "&&!rt&&fe===f&&(Je+=(pe-te*2-Mt)/qe),this._partialTextX=Je,this._partialTextY=Le+_t,this._partialText=wt,z.fillStrokeShape(this),Je+=this.measureSize(wt).width+He}}else He!==0&&z.setAttr("letterSpacing",`${He}px`),this._partialTextX=Je,this._partialTextY=Le+_t,this._partialText=It,z.fillStrokeShape(this);z.restore(),J>1&&(Le+=ie)}}_hitFunc(z){const Y=this.getWidth(),J=this.getHeight();z.beginPath(),z.rect(0,0,Y,J),z.closePath(),z.fillStrokeShape(this)}setText(z){const Y=e.Util._isString(z)?z:z==null?"":z+"";return this._setAttr(w,Y),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(z){var Y,J,te,ee,ie,me,Ce,Oe,fe,pe,He;let Ye=M(),ot=this.fontSize(),Ve;Ye.save(),Ye.font=this._getContextFont(),Ve=Ye.measureText(z),Ye.restore();const Rt=ot/100;return{actualBoundingBoxAscent:(Y=Ve.actualBoundingBoxAscent)!==null&&Y!==void 0?Y:71.58203125*Rt,actualBoundingBoxDescent:(J=Ve.actualBoundingBoxDescent)!==null&&J!==void 0?J:0,actualBoundingBoxLeft:(te=Ve.actualBoundingBoxLeft)!==null&&te!==void 0?te:-7.421875*Rt,actualBoundingBoxRight:(ee=Ve.actualBoundingBoxRight)!==null&&ee!==void 0?ee:75.732421875*Rt,alphabeticBaseline:(ie=Ve.alphabeticBaseline)!==null&&ie!==void 0?ie:0,emHeightAscent:(me=Ve.emHeightAscent)!==null&&me!==void 0?me:100*Rt,emHeightDescent:(Ce=Ve.emHeightDescent)!==null&&Ce!==void 0?Ce:-20*Rt,fontBoundingBoxAscent:(Oe=Ve.fontBoundingBoxAscent)!==null&&Oe!==void 0?Oe:91*Rt,fontBoundingBoxDescent:(fe=Ve.fontBoundingBoxDescent)!==null&&fe!==void 0?fe:21*Rt,hangingBaseline:(pe=Ve.hangingBaseline)!==null&&pe!==void 0?pe:72.80000305175781*Rt,ideographicBaseline:(He=Ve.ideographicBaseline)!==null&&He!==void 0?He:-21*Rt,width:Ve.width,height:ot}}_getContextFont(){return this.fontStyle()+P+this.fontVariant()+P+(this.fontSize()+A)+q(this.fontFamily())}_addTextLine(z){this.align()===f&&(z=z.trim());const J=this._getTextWidth(z);return this.textArr.push({text:z,width:J,lastInParagraph:!1})}_getTextWidth(z){const Y=this.letterSpacing(),J=z.length;return M().measureText(z).width+Y*J}_setTextData(){let z=this.text().split(`
`),Y=+this.fontSize(),J=0,te=this.lineHeight()*Y,ee=this.attrs.width,ie=this.attrs.height,me=ee!==o&&ee!==void 0,Ce=ie!==o&&ie!==void 0,Oe=this.padding(),fe=ee-Oe*2,pe=ie-Oe*2,He=0,Ye=this.wrap(),ot=Ye!==K,Ve=Ye!==I&&ot,Rt=this.ellipsis();this.textArr=[],M().font=this._getContextFont();const tt=Rt?this._getTextWidth(X):0;for(let Le=0,De=z.length;Le<De;++Le){let Je=z[Le],_t=this._getTextWidth(Je);if(me&&_t>fe)for(;Je.length>0;){let ht=0,It=i(Je).length,Mt="",rt=0;for(;ht<It;){const qe=ht+It>>>1,pt=i(Je),lt=pt.slice(0,qe+1).join(""),wt=this._getTextWidth(lt);(Rt&&Ce&&He+te>pe?wt+tt:wt)<=fe?(ht=qe+1,Mt=lt,rt=wt):It=qe}if(Mt){if(Ve){const lt=i(Je),wt=i(Mt),Lt=lt[wt.length],Ht=Lt===P||Lt===y;let Ie;if(Ht&&rt<=fe)Ie=wt.length;else{const at=wt.lastIndexOf(P),gt=wt.lastIndexOf(y);Ie=Math.max(at,gt)+1}Ie>0&&(ht=Ie,Mt=lt.slice(0,ht).join(""),rt=this._getTextWidth(Mt))}if(Mt=Mt.trimRight(),this._addTextLine(Mt),J=Math.max(J,rt),He+=te,this._shouldHandleEllipsis(He)){this._tryToAddEllipsisToLastLine();break}if(Je=i(Je).slice(ht).join("").trimLeft(),Je.length>0&&(_t=this._getTextWidth(Je),_t<=fe)){this._addTextLine(Je),He+=te,J=Math.max(J,_t);break}}else break}else this._addTextLine(Je),He+=te,J=Math.max(J,_t),this._shouldHandleEllipsis(He)&&Le<De-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),Ce&&He+te>pe)break}this.textHeight=Y,this.textWidth=J}_shouldHandleEllipsis(z){const Y=+this.fontSize(),J=this.lineHeight()*Y,te=this.attrs.height,ee=te!==o&&te!==void 0,ie=this.padding(),me=te-ie*2;return!(this.wrap()!==K)||ee&&z+J>me}_tryToAddEllipsisToLastLine(){const z=this.attrs.width,Y=z!==o&&z!==void 0,J=this.padding(),te=z-J*2,ee=this.ellipsis(),ie=this.textArr[this.textArr.length-1];!ie||!ee||(Y&&(this._getTextWidth(ie.text+X)<te||(ie.text=ie.text.slice(0,ie.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(ie.text+X))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const z=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,Y=this.hasShadow();return z&&Y?!0:super._useBufferCanvas()}}return bh.Text=H,H.prototype._fillFunc=W,H.prototype._strokeFunc=B,H.prototype.className=b,H.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(H),t.Factory.overWriteSetter(H,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(H,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(H,"direction",d),t.Factory.addGetterSetter(H,"fontFamily","Arial"),t.Factory.addGetterSetter(H,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"fontStyle",N),t.Factory.addGetterSetter(H,"fontVariant",N),t.Factory.addGetterSetter(H,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"align",v),t.Factory.addGetterSetter(H,"verticalAlign",E),t.Factory.addGetterSetter(H,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"wrap",D),t.Factory.addGetterSetter(H,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(H,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(H,"textDecoration",""),bh}var Hg={},AT;function FM(){if(AT)return Hg;AT=1,Object.defineProperty(Hg,"__esModule",{value:!0}),Hg.TextPath=void 0;const e=as(),t=$r(),r=ra(),n=ib(),s=T6(),a=zr(),i=Mr(),o="",c="normal";function d(g){g.fillText(this.partialText,0,0)}function f(g){g.strokeText(this.partialText,0,0)}class p extends r.Shape{constructor(y){super(y),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(y){if(!this.attrs.data)return null;const v=this.pathLength;return y-1>v?null:n.Path.getPointAtLengthOfDataArray(y,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(y){y.setAttr("font",this._getContextFont()),y.setAttr("textBaseline",this.textBaseline()),y.setAttr("textAlign","left"),y.save();const v=this.textDecoration(),w=this.fill(),b=this.fontSize(),E=this.glyphInfo;v==="underline"&&y.beginPath();for(let k=0;k<E.length;k++){y.save();const _=E[k].p0;y.translate(_.x,_.y),y.rotate(E[k].rotation),this.partialText=E[k].text,y.fillStrokeShape(this),v==="underline"&&(k===0&&y.moveTo(0,b/2+1),y.lineTo(b,b/2+1)),y.restore()}v==="underline"&&(y.strokeStyle=w,y.lineWidth=b/20,y.stroke()),y.restore()}_hitFunc(y){y.beginPath();const v=this.glyphInfo;if(v.length>=1){const w=v[0].p0;y.moveTo(w.x,w.y)}for(let w=0;w<v.length;w++){const b=v[w].p1;y.lineTo(b.x,b.y)}y.setAttr("lineWidth",this.fontSize()),y.setAttr("strokeStyle",this.colorKey),y.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(y){return s.Text.prototype.setText.call(this,y)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(y){const w=this.dummyCanvas.getContext("2d");w.save(),w.font=this._getContextFont();const b=w.measureText(y);return w.restore(),{width:b.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:y,height:v}=this._getTextSize(this.attrs.text);if(this.textWidth=y,this.textHeight=v,this.glyphInfo=[],!this.attrs.data)return null;const w=this.letterSpacing(),b=this.align(),E=this.kerningFunc(),k=Math.max(this.textWidth+((this.attrs.text||"").length-1)*w,0);let _=0;b==="center"&&(_=Math.max(0,this.pathLength/2-k/2)),b==="right"&&(_=Math.max(0,this.pathLength-k));const N=(0,s.stringToArray)(this.text());let A=_;for(let P=0;P<N.length;P++){const R=this._getPointAtLength(A);if(!R)return;let T=this._getTextSize(N[P]).width+w;if(N[P]===" "&&b==="justify"){const oe=this.text().split(" ").length-1;T+=(this.pathLength-k)/oe}const D=this._getPointAtLength(A+T);if(!D)return;const I=n.Path.getLineLength(R.x,R.y,D.x,D.y);let K=0;if(E)try{K=E(N[P-1],N[P])*this.fontSize()}catch{K=0}R.x+=K,D.x+=K,this.textWidth+=K;const X=n.Path.getPointOnLine(K+I/2,R.x,R.y,D.x,D.y),Z=Math.atan2(D.y-R.y,D.x-R.x);this.glyphInfo.push({transposeX:X.x,transposeY:X.y,text:N[P],rotation:Z,p0:R,p1:D}),A+=T}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const y=[];this.glyphInfo.forEach(function(A){y.push(A.p0.x),y.push(A.p0.y),y.push(A.p1.x),y.push(A.p1.y)});let v=y[0]||0,w=y[0]||0,b=y[1]||0,E=y[1]||0,k,_;for(let A=0;A<y.length/2;A++)k=y[A*2],_=y[A*2+1],v=Math.min(v,k),w=Math.max(w,k),b=Math.min(b,_),E=Math.max(E,_);const N=this.fontSize();return{x:v-N/2,y:b-N/2,width:w-v+N,height:E-b+N}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return Hg.TextPath=p,p.prototype._fillFunc=d,p.prototype._strokeFunc=f,p.prototype._fillFuncHit=d,p.prototype._strokeFuncHit=f,p.prototype.className="TextPath",p.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(p),t.Factory.addGetterSetter(p,"data"),t.Factory.addGetterSetter(p,"fontFamily","Arial"),t.Factory.addGetterSetter(p,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(p,"fontStyle",c),t.Factory.addGetterSetter(p,"align","left"),t.Factory.addGetterSetter(p,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(p,"textBaseline","middle"),t.Factory.addGetterSetter(p,"fontVariant",c),t.Factory.addGetterSetter(p,"text",o),t.Factory.addGetterSetter(p,"textDecoration",""),t.Factory.addGetterSetter(p,"kerningFunc",void 0),Hg}var Gg={},jT;function PM(){if(jT)return Gg;jT=1,Object.defineProperty(Gg,"__esModule",{value:!0}),Gg.Transformer=void 0;const e=as(),t=$r(),r=ps(),n=ra(),s=C6(),a=sb(),i=Mr(),o=zr(),c=Mr(),d="tr-konva",f=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(T=>T+`.${d}`).join(" "),p="nodesRect",g=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],y={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},v="ontouchstart"in i.Konva._global;function w(T,D,I){if(T==="rotater")return I;D+=e.Util.degToRad(y[T]||0);const K=(e.Util.radToDeg(D)%360+360)%360;return e.Util._inRange(K,315+22.5,360)||e.Util._inRange(K,0,22.5)?"ns-resize":e.Util._inRange(K,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(K,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(K,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(K,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(K,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(K,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(K,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+K),"pointer")}const b=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function E(T){return{x:T.x+T.width/2*Math.cos(T.rotation)+T.height/2*Math.sin(-T.rotation),y:T.y+T.height/2*Math.cos(T.rotation)+T.width/2*Math.sin(T.rotation)}}function k(T,D,I){const K=I.x+(T.x-I.x)*Math.cos(D)-(T.y-I.y)*Math.sin(D),X=I.y+(T.x-I.x)*Math.sin(D)+(T.y-I.y)*Math.cos(D);return{...T,rotation:T.rotation+D,x:K,y:X}}function _(T,D){const I=E(T);return k(T,D,I)}function N(T,D,I){let K=D;for(let X=0;X<T.length;X++){const Z=i.Konva.getAngle(T[X]),oe=Math.abs(Z-D)%(Math.PI*2);Math.min(oe,Math.PI*2-oe)<I&&(K=Z)}return K}let A=0;class P extends a.Group{constructor(D){super(D),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(f,this.update),this.getNode()&&this.update()}attachTo(D){return this.setNode(D),this}setNode(D){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([D])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return d+this._id}setNodes(D=[]){this._nodes&&this._nodes.length&&this.detach();const I=D.filter(X=>X.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=D=I,D.length===1&&this.useSingleNodeRotation()?this.rotation(D[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(X=>{const Z=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(X._attrsAffectingSize.length){const oe=X._attrsAffectingSize.map(q=>q+"Change."+this._getEventNamespace()).join(" ");X.on(oe,Z)}X.on(g.map(oe=>oe+`.${this._getEventNamespace()}`).join(" "),Z),X.on(`absoluteTransformChange.${this._getEventNamespace()}`,Z),this._proxyDrag(X)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(D){let I;D.on(`dragstart.${this._getEventNamespace()}`,K=>{I=D.getAbsolutePosition(),!this.isDragging()&&D!==this.findOne(".back")&&this.startDrag(K,!1)}),D.on(`dragmove.${this._getEventNamespace()}`,K=>{if(!I)return;const X=D.getAbsolutePosition(),Z=X.x-I.x,oe=X.y-I.y;this.nodes().forEach(q=>{if(q===D||q.isDragging())return;const re=q.getAbsolutePosition();q.setAbsolutePosition({x:re.x+Z,y:re.y+oe}),q.startDrag(K)}),I=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(D=>{D.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(p),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(p,this.__getNodeRect)}__getNodeShape(D,I=this.rotation(),K){const X=D.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),Z=D.getAbsoluteScale(K),oe=D.getAbsolutePosition(K),q=X.x*Z.x-D.offsetX()*Z.x,re=X.y*Z.y-D.offsetY()*Z.y,M=(i.Konva.getAngle(D.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),W={x:oe.x+q*Math.cos(M)+re*Math.sin(-M),y:oe.y+re*Math.cos(M)+q*Math.sin(M),width:X.width*Z.x,height:X.height*Z.y,rotation:M};return k(W,-i.Konva.getAngle(I),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const I=[];this.nodes().map(M=>{const W=M.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),B=[{x:W.x,y:W.y},{x:W.x+W.width,y:W.y},{x:W.x+W.width,y:W.y+W.height},{x:W.x,y:W.y+W.height}],G=M.getAbsoluteTransform();B.forEach(function(H){const O=G.point(H);I.push(O)})});const K=new e.Transform;K.rotate(-i.Konva.getAngle(this.rotation()));let X=1/0,Z=1/0,oe=-1/0,q=-1/0;I.forEach(function(M){const W=K.point(M);X===void 0&&(X=oe=W.x,Z=q=W.y),X=Math.min(X,W.x),Z=Math.min(Z,W.y),oe=Math.max(oe,W.x),q=Math.max(q,W.y)}),K.invert();const re=K.point({x:X,y:Z});return{x:re.x,y:re.y,width:oe-X,height:q-Z,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),b.forEach(D=>{this._createAnchor(D)}),this._createAnchor("rotater")}_createAnchor(D){const I=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:D+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:v?10:"auto"}),K=this;I.on("mousedown touchstart",function(X){K._handleMouseDown(X)}),I.on("dragstart",X=>{I.stopDrag(),X.cancelBubble=!0}),I.on("dragend",X=>{X.cancelBubble=!0}),I.on("mouseenter",()=>{const X=i.Konva.getAngle(this.rotation()),Z=this.rotateAnchorCursor(),oe=w(D,X,Z);I.getStage().content&&(I.getStage().content.style.cursor=oe),this._cursorChange=!0}),I.on("mouseout",()=>{I.getStage().content&&(I.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(I)}_createBack(){const D=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(I,K){const X=K.getParent(),Z=X.padding();I.beginPath(),I.rect(-Z,-Z,K.width()+Z*2,K.height()+Z*2),I.moveTo(K.width()/2,-Z),X.rotateEnabled()&&X.rotateLineVisible()&&I.lineTo(K.width()/2,-X.rotateAnchorOffset()*e.Util._sign(K.height())-Z),I.fillStrokeShape(K)},hitFunc:(I,K)=>{if(!this.shouldOverdrawWholeArea())return;const X=this.padding();I.beginPath(),I.rect(-X,-X,K.width()+X*2,K.height()+X*2),I.fillStrokeShape(K)}});this.add(D),this._proxyDrag(D),D.on("dragstart",I=>{I.cancelBubble=!0}),D.on("dragmove",I=>{I.cancelBubble=!0}),D.on("dragend",I=>{I.cancelBubble=!0}),this.on("dragmove",I=>{this.update()})}_handleMouseDown(D){if(this._transforming)return;this._movingAnchorName=D.target.name().split(" ")[0];const I=this._getNodeRect(),K=I.width,X=I.height,Z=Math.sqrt(Math.pow(K,2)+Math.pow(X,2));this.sin=Math.abs(X/Z),this.cos=Math.abs(K/Z),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const oe=D.target.getAbsolutePosition(),q=D.target.getStage().getPointerPosition();this._anchorDragOffset={x:q.x-oe.x,y:q.y-oe.y},A++,this._fire("transformstart",{evt:D.evt,target:this.getNode()}),this._nodes.forEach(re=>{re._fire("transformstart",{evt:D.evt,target:re})})}_handleMouseMove(D){let I,K,X;const Z=this.findOne("."+this._movingAnchorName),oe=Z.getStage();oe.setPointersPositions(D);const q=oe.getPointerPosition();let re={x:q.x-this._anchorDragOffset.x,y:q.y-this._anchorDragOffset.y};const M=Z.getAbsolutePosition();this.anchorDragBoundFunc()&&(re=this.anchorDragBoundFunc()(M,re,D)),Z.setAbsolutePosition(re);const W=Z.getAbsolutePosition();if(M.x===W.x&&M.y===W.y)return;if(this._movingAnchorName==="rotater"){const te=this._getNodeRect();I=Z.x()-te.width/2,K=-Z.y()+te.height/2;let ee=Math.atan2(-K,I)+Math.PI/2;te.height<0&&(ee-=Math.PI);const me=i.Konva.getAngle(this.rotation())+ee,Ce=i.Konva.getAngle(this.rotationSnapTolerance()),fe=N(this.rotationSnaps(),me,Ce)-te.rotation,pe=_(te,fe);this._fitNodesInto(pe,D);return}const B=this.shiftBehavior();let G;B==="inverted"?G=this.keepRatio()&&!D.shiftKey:B==="none"?G=this.keepRatio():G=this.keepRatio()||D.shiftKey;let H=this.centeredScaling()||D.altKey;if(this._movingAnchorName==="top-left"){if(G){const te=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};X=Math.sqrt(Math.pow(te.x-Z.x(),2)+Math.pow(te.y-Z.y(),2));const ee=this.findOne(".top-left").x()>te.x?-1:1,ie=this.findOne(".top-left").y()>te.y?-1:1;I=X*this.cos*ee,K=X*this.sin*ie,this.findOne(".top-left").x(te.x-I),this.findOne(".top-left").y(te.y-K)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(Z.y());else if(this._movingAnchorName==="top-right"){if(G){const te=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};X=Math.sqrt(Math.pow(Z.x()-te.x,2)+Math.pow(te.y-Z.y(),2));const ee=this.findOne(".top-right").x()<te.x?-1:1,ie=this.findOne(".top-right").y()>te.y?-1:1;I=X*this.cos*ee,K=X*this.sin*ie,this.findOne(".top-right").x(te.x+I),this.findOne(".top-right").y(te.y-K)}var O=Z.position();this.findOne(".top-left").y(O.y),this.findOne(".bottom-right").x(O.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(Z.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(Z.x());else if(this._movingAnchorName==="bottom-left"){if(G){const te=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};X=Math.sqrt(Math.pow(te.x-Z.x(),2)+Math.pow(Z.y()-te.y,2));const ee=te.x<Z.x()?-1:1,ie=Z.y()<te.y?-1:1;I=X*this.cos*ee,K=X*this.sin*ie,Z.x(te.x-I),Z.y(te.y+K)}O=Z.position(),this.findOne(".top-left").x(O.x),this.findOne(".bottom-right").y(O.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(Z.y());else if(this._movingAnchorName==="bottom-right"){if(G){const te=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};X=Math.sqrt(Math.pow(Z.x()-te.x,2)+Math.pow(Z.y()-te.y,2));const ee=this.findOne(".bottom-right").x()<te.x?-1:1,ie=this.findOne(".bottom-right").y()<te.y?-1:1;I=X*this.cos*ee,K=X*this.sin*ie,this.findOne(".bottom-right").x(te.x+I),this.findOne(".bottom-right").y(te.y+K)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(H=this.centeredScaling()||D.altKey,H){const te=this.findOne(".top-left"),ee=this.findOne(".bottom-right"),ie=te.x(),me=te.y(),Ce=this.getWidth()-ee.x(),Oe=this.getHeight()-ee.y();ee.move({x:-ie,y:-me}),te.move({x:Ce,y:Oe})}const z=this.findOne(".top-left").getAbsolutePosition();I=z.x,K=z.y;const Y=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),J=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:I,y:K,width:Y,height:J,rotation:i.Konva.getAngle(this.rotation())},D)}_handleMouseUp(D){this._removeEvents(D)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(D){var I;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const K=this.getNode();A--,this._fire("transformend",{evt:D,target:K}),(I=this.getLayer())===null||I===void 0||I.batchDraw(),K&&this._nodes.forEach(X=>{var Z;X._fire("transformend",{evt:D,target:X}),(Z=X.getLayer())===null||Z===void 0||Z.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(D,I){const K=this._getNodeRect(),X=1;if(e.Util._inRange(D.width,-this.padding()*2-X,X)){this.update();return}if(e.Util._inRange(D.height,-this.padding()*2-X,X)){this.update();return}const Z=new e.Transform;if(Z.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("left")>=0){const G=Z.point({x:-this.padding()*2,y:0});D.x+=G.x,D.y+=G.y,D.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=G.x,this._anchorDragOffset.y-=G.y}else if(this._movingAnchorName&&D.width<0&&this._movingAnchorName.indexOf("right")>=0){const G=Z.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=G.x,this._anchorDragOffset.y-=G.y,D.width+=this.padding()*2}if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("top")>=0){const G=Z.point({x:0,y:-this.padding()*2});D.x+=G.x,D.y+=G.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=G.x,this._anchorDragOffset.y-=G.y,D.height+=this.padding()*2}else if(this._movingAnchorName&&D.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const G=Z.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=G.x,this._anchorDragOffset.y-=G.y,D.height+=this.padding()*2}if(this.boundBoxFunc()){const G=this.boundBoxFunc()(K,D);G?D=G:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const oe=1e7,q=new e.Transform;q.translate(K.x,K.y),q.rotate(K.rotation),q.scale(K.width/oe,K.height/oe);const re=new e.Transform,M=D.width/oe,W=D.height/oe;this.flipEnabled()===!1?(re.translate(D.x,D.y),re.rotate(D.rotation),re.translate(D.width<0?D.width:0,D.height<0?D.height:0),re.scale(Math.abs(M),Math.abs(W))):(re.translate(D.x,D.y),re.rotate(D.rotation),re.scale(M,W));const B=re.multiply(q.invert());this._nodes.forEach(G=>{var H;const O=G.getParent().getAbsoluteTransform(),z=G.getTransform().copy();z.translate(G.offsetX(),G.offsetY());const Y=new e.Transform;Y.multiply(O.copy().invert()).multiply(B).multiply(O).multiply(z);const J=Y.decompose();G.setAttrs(J),(H=G.getLayer())===null||H===void 0||H.batchDraw()}),this.rotation(e.Util._getRotation(D.rotation)),this._nodes.forEach(G=>{this._fire("transform",{evt:I,target:G}),G._fire("transform",{evt:I,target:G})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(D,I){this.findOne(D).setAttrs(I)}update(){var D;const I=this._getNodeRect();this.rotation(e.Util._getRotation(I.rotation));const K=I.width,X=I.height,Z=this.enabledAnchors(),oe=this.resizeEnabled(),q=this.padding(),re=this.anchorSize(),M=this.find("._anchor");M.forEach(B=>{B.setAttrs({width:re,height:re,offsetX:re/2,offsetY:re/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:re/2+q,offsetY:re/2+q,visible:oe&&Z.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:K/2,y:0,offsetY:re/2+q,visible:oe&&Z.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:K,y:0,offsetX:re/2-q,offsetY:re/2+q,visible:oe&&Z.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:X/2,offsetX:re/2+q,visible:oe&&Z.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:K,y:X/2,offsetX:re/2-q,visible:oe&&Z.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:X,offsetX:re/2+q,offsetY:re/2-q,visible:oe&&Z.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:K/2,y:X,offsetY:re/2-q,visible:oe&&Z.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:K,y:X,offsetX:re/2-q,offsetY:re/2-q,visible:oe&&Z.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:K/2,y:-this.rotateAnchorOffset()*e.Util._sign(X)-q,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:K,height:X,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const W=this.anchorStyleFunc();W&&M.forEach(B=>{W(B)}),(D=this.getLayer())===null||D===void 0||D.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const D=this.findOne("."+this._movingAnchorName);D&&D.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(D){return r.Node.prototype.clone.call(this,D)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}Gg.Transformer=P,P.isTransforming=()=>A>0;function R(T){return T instanceof Array||e.Util.warn("enabledAnchors value should be an array"),T instanceof Array&&T.forEach(function(D){b.indexOf(D)===-1&&e.Util.warn("Unknown anchor name: "+D+". Available names are: "+b.join(", "))}),T||[]}return P.prototype.className="Transformer",(0,c._registerNode)(P),t.Factory.addGetterSetter(P,"enabledAnchors",b,R),t.Factory.addGetterSetter(P,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(P,"resizeEnabled",!0),t.Factory.addGetterSetter(P,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateEnabled",!0),t.Factory.addGetterSetter(P,"rotateLineVisible",!0),t.Factory.addGetterSetter(P,"rotationSnaps",[]),t.Factory.addGetterSetter(P,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(P,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderEnabled",!0),t.Factory.addGetterSetter(P,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"anchorFill","white"),t.Factory.addGetterSetter(P,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(P,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"borderDash"),t.Factory.addGetterSetter(P,"keepRatio",!0),t.Factory.addGetterSetter(P,"shiftBehavior","default"),t.Factory.addGetterSetter(P,"centeredScaling",!1),t.Factory.addGetterSetter(P,"ignoreStroke",!1),t.Factory.addGetterSetter(P,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(P,"nodes"),t.Factory.addGetterSetter(P,"node"),t.Factory.addGetterSetter(P,"boundBoxFunc"),t.Factory.addGetterSetter(P,"anchorDragBoundFunc"),t.Factory.addGetterSetter(P,"anchorStyleFunc"),t.Factory.addGetterSetter(P,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(P,"useSingleNodeRotation",!0),t.Factory.backCompat(P,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),Gg}var Vg={},FT;function RM(){if(FT)return Vg;FT=1,Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.Wedge=void 0;const e=$r(),t=ra(),r=Mr(),n=zr(),s=Mr();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return Vg.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Vg}var Kg={},PT;function DM(){if(PT)return Kg;PT=1,Object.defineProperty(Kg,"__esModule",{value:!0}),Kg.Blur=void 0;const e=$r(),t=ps(),r=zr();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,d){const f=c.data,p=c.width,g=c.height;let y,v,w,b,E,k,_,N,A,P,R,T,D,I,K,X,Z,oe,q,re;const M=d+d+1,W=p-1,B=g-1,G=d+1,H=G*(G+1)/2,O=new n,z=s[d],Y=a[d];let J=null,te=O,ee=null,ie=null;for(let me=1;me<M;me++)te=te.next=new n,me===G&&(J=te);te.next=O,w=v=0;for(let me=0;me<g;me++){T=D=I=K=b=E=k=_=0,N=G*(X=f[v]),A=G*(Z=f[v+1]),P=G*(oe=f[v+2]),R=G*(q=f[v+3]),b+=H*X,E+=H*Z,k+=H*oe,_+=H*q,te=O;for(let Ce=0;Ce<G;Ce++)te.r=X,te.g=Z,te.b=oe,te.a=q,te=te.next;for(let Ce=1;Ce<G;Ce++)y=v+((W<Ce?W:Ce)<<2),b+=(te.r=X=f[y])*(re=G-Ce),E+=(te.g=Z=f[y+1])*re,k+=(te.b=oe=f[y+2])*re,_+=(te.a=q=f[y+3])*re,T+=X,D+=Z,I+=oe,K+=q,te=te.next;ee=O,ie=J;for(let Ce=0;Ce<p;Ce++)f[v+3]=q=_*z>>Y,q!==0?(q=255/q,f[v]=(b*z>>Y)*q,f[v+1]=(E*z>>Y)*q,f[v+2]=(k*z>>Y)*q):f[v]=f[v+1]=f[v+2]=0,b-=N,E-=A,k-=P,_-=R,N-=ee.r,A-=ee.g,P-=ee.b,R-=ee.a,y=w+((y=Ce+d+1)<W?y:W)<<2,T+=ee.r=f[y],D+=ee.g=f[y+1],I+=ee.b=f[y+2],K+=ee.a=f[y+3],b+=T,E+=D,k+=I,_+=K,ee=ee.next,N+=X=ie.r,A+=Z=ie.g,P+=oe=ie.b,R+=q=ie.a,T-=X,D-=Z,I-=oe,K-=q,ie=ie.next,v+=4;w+=p}for(let me=0;me<p;me++){D=I=K=T=E=k=_=b=0,v=me<<2,N=G*(X=f[v]),A=G*(Z=f[v+1]),P=G*(oe=f[v+2]),R=G*(q=f[v+3]),b+=H*X,E+=H*Z,k+=H*oe,_+=H*q,te=O;for(let Oe=0;Oe<G;Oe++)te.r=X,te.g=Z,te.b=oe,te.a=q,te=te.next;let Ce=p;for(let Oe=1;Oe<=d;Oe++)v=Ce+me<<2,b+=(te.r=X=f[v])*(re=G-Oe),E+=(te.g=Z=f[v+1])*re,k+=(te.b=oe=f[v+2])*re,_+=(te.a=q=f[v+3])*re,T+=X,D+=Z,I+=oe,K+=q,te=te.next,Oe<B&&(Ce+=p);v=me,ee=O,ie=J;for(let Oe=0;Oe<g;Oe++)y=v<<2,f[y+3]=q=_*z>>Y,q>0?(q=255/q,f[y]=(b*z>>Y)*q,f[y+1]=(E*z>>Y)*q,f[y+2]=(k*z>>Y)*q):f[y]=f[y+1]=f[y+2]=0,b-=N,E-=A,k-=P,_-=R,N-=ee.r,A-=ee.g,P-=ee.b,R-=ee.a,y=me+((y=Oe+G)<B?y:B)*p<<2,b+=T+=ee.r=f[y],E+=D+=ee.g=f[y+1],k+=I+=ee.b=f[y+2],_+=K+=ee.a=f[y+3],ee=ee.next,N+=X=ie.r,A+=Z=ie.g,P+=oe=ie.b,R+=q=ie.a,T-=X,D-=Z,I-=oe,K-=q,ie=ie.next,v+=p}}const o=function(d){const f=Math.round(this.blurRadius());f>0&&i(d,f)};return Kg.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Kg}var qg={},RT;function IM(){if(RT)return qg;RT=1,Object.defineProperty(qg,"__esModule",{value:!0}),qg.Brighten=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return qg.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),qg}var Xg={},DT;function MM(){if(DT)return Xg;DT=1,Object.defineProperty(Xg,"__esModule",{value:!0}),Xg.Contrast=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let c=150,d=150,f=150;for(let p=0;p<o;p+=4)c=i[p],d=i[p+1],f=i[p+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,f/=255,f-=.5,f*=a,f+=.5,f*=255,c=c<0?0:c>255?255:c,d=d<0?0:d>255?255:d,f=f<0?0:f>255?255:f,i[p]=c,i[p+1]=d,i[p+2]=f};return Xg.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Xg}var Yg={},IT;function OM(){if(IT)return Yg;IT=1,Object.defineProperty(Yg,"__esModule",{value:!0}),Yg.Emboss=void 0;const e=$r(),t=ps(),r=as(),n=zr(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,c=this.embossDirection(),d=this.embossBlend(),f=a.data,p=a.width,g=a.height,y=p*4;let v=0,w=0,b=g;switch(c){case"top-left":v=-1,w=-1;break;case"top":v=-1,w=0;break;case"top-right":v=-1,w=1;break;case"right":v=0,w=1;break;case"bottom-right":v=1,w=1;break;case"bottom":v=1,w=0;break;case"bottom-left":v=1,w=-1;break;case"left":v=0,w=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const E=(b-1)*y;let k=v;b+k<1&&(k=0),b+k>g&&(k=0);const _=(b-1+k)*p*4;let N=p;do{const A=E+(N-1)*4;let P=w;N+P<1&&(P=0),N+P>p&&(P=0);const R=_+(N-1+P)*4,T=f[A]-f[R],D=f[A+1]-f[R+1],I=f[A+2]-f[R+2];let K=T;const X=K>0?K:-K,Z=D>0?D:-D,oe=I>0?I:-I;if(Z>X&&(K=D),oe>X&&(K=I),K*=i,d){const q=f[A]+K,re=f[A+1]+K,M=f[A+2]+K;f[A]=q>255?255:q<0?0:q,f[A+1]=re>255?255:re<0?0:re,f[A+2]=M>255?255:M<0?0:M}else{let q=o-K;q<0?q=0:q>255&&(q=255),f[A]=f[A+1]=f[A+2]=q}}while(--N)}while(--b)};return Yg.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Yg}var Qg={},MT;function LM(){if(MT)return Qg;MT=1,Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.Enhance=void 0;const e=$r(),t=ps(),r=zr();function n(a,i,o,c,d){const f=o-i,p=d-c;if(f===0)return c+p/2;if(p===0)return c;let g=(a-i)/f;return g=p*g+c,g}const s=function(a){const i=a.data,o=i.length;let c=i[0],d=c,f,p=i[1],g=p,y,v=i[2],w=v,b;const E=this.enhance();if(E===0)return;for(let T=0;T<o;T+=4)f=i[T+0],f<c?c=f:f>d&&(d=f),y=i[T+1],y<p?p=y:y>g&&(g=y),b=i[T+2],b<v?v=b:b>w&&(w=b);d===c&&(d=255,c=0),g===p&&(g=255,p=0),w===v&&(w=255,v=0);let k,_,N,A,P,R;if(E>0)k=d+E*(255-d),_=c-E*(c-0),N=g+E*(255-g),A=p-E*(p-0),P=w+E*(255-w),R=v-E*(v-0);else{const T=(d+c)*.5;k=d+E*(d-T),_=c+E*(c-T);const D=(g+p)*.5;N=g+E*(g-D),A=p+E*(p-D);const I=(w+v)*.5;P=w+E*(w-I),R=v+E*(v-I)}for(let T=0;T<o;T+=4)i[T+0]=n(i[T+0],c,d,_,k),i[T+1]=n(i[T+1],p,g,A,N),i[T+2]=n(i[T+2],v,w,R,P)};return Qg.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Qg}var Jg={},OT;function BM(){if(OT)return Jg;OT=1,Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return Jg.Grayscale=e,Jg}var Zg={},LT;function UM(){if(LT)return Zg;LT=1,Object.defineProperty(Zg,"__esModule",{value:!0}),Zg.HSL=void 0;const e=$r(),t=ps(),r=zr();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,f=this.luminance()*127,p=o*c*Math.cos(d*Math.PI/180),g=o*c*Math.sin(d*Math.PI/180),y=.299*o+.701*p+.167*g,v=.587*o-.587*p+.33*g,w=.114*o-.114*p-.497*g,b=.299*o-.299*p-.328*g,E=.587*o+.413*p+.035*g,k=.114*o-.114*p+.293*g,_=.299*o-.3*p+1.25*g,N=.587*o-.586*p-1.05*g,A=.114*o+.886*p-.2*g;let P,R,T,D;for(let I=0;I<i;I+=4)P=a[I+0],R=a[I+1],T=a[I+2],D=a[I+3],a[I+0]=y*P+v*R+w*T+f,a[I+1]=b*P+E*R+k*T+f,a[I+2]=_*P+N*R+A*T+f,a[I+3]=D};return Zg.HSL=n,Zg}var em={},BT;function $M(){if(BT)return em;BT=1,Object.defineProperty(em,"__esModule",{value:!0}),em.HSV=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),d=Math.abs(this.hue()+360)%360,f=o*c*Math.cos(d*Math.PI/180),p=o*c*Math.sin(d*Math.PI/180),g=.299*o+.701*f+.167*p,y=.587*o-.587*f+.33*p,v=.114*o-.114*f-.497*p,w=.299*o-.299*f-.328*p,b=.587*o+.413*f+.035*p,E=.114*o-.114*f+.293*p,k=.299*o-.3*f+1.25*p,_=.587*o-.586*f-1.05*p,N=.114*o+.886*f-.2*p;for(let A=0;A<i;A+=4){const P=a[A+0],R=a[A+1],T=a[A+2],D=a[A+3];a[A+0]=g*P+y*R+v*T,a[A+1]=w*P+b*R+E*T,a[A+2]=k*P+_*R+N*T,a[A+3]=D}};return em.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),em}var tm={},UT;function WM(){if(UT)return tm;UT=1,Object.defineProperty(tm,"__esModule",{value:!0}),tm.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return tm.Invert=e,tm}var rm={},$T;function zM(){if($T)return rm;$T=1,Object.defineProperty(rm,"__esModule",{value:!0}),rm.Kaleidoscope=void 0;const e=$r(),t=ps(),r=as(),n=zr(),s=function(o,c,d){const f=o.data,p=c.data,g=o.width,y=o.height,v=d.polarCenterX||g/2,w=d.polarCenterY||y/2;let b=Math.sqrt(v*v+w*w),E=g-v,k=y-w;const _=Math.sqrt(E*E+k*k);b=_>b?_:b;const N=y,A=g,P=360/A*Math.PI/180;for(let R=0;R<A;R+=1){const T=Math.sin(R*P),D=Math.cos(R*P);for(let I=0;I<N;I+=1){E=Math.floor(v+b*I/N*D),k=Math.floor(w+b*I/N*T);let K=(k*g+E)*4;const X=f[K+0],Z=f[K+1],oe=f[K+2],q=f[K+3];K=(R+I*g)*4,p[K+0]=X,p[K+1]=Z,p[K+2]=oe,p[K+3]=q}}},a=function(o,c,d){const f=o.data,p=c.data,g=o.width,y=o.height,v=d.polarCenterX||g/2,w=d.polarCenterY||y/2;let b=Math.sqrt(v*v+w*w),E=g-v,k=y-w;const _=Math.sqrt(E*E+k*k);b=_>b?_:b;const N=y,A=g,P=0;let R,T;for(E=0;E<g;E+=1)for(k=0;k<y;k+=1){const D=E-v,I=k-w,K=Math.sqrt(D*D+I*I)*N/b;let X=(Math.atan2(I,D)*180/Math.PI+360+P)%360;X=X*A/360,R=Math.floor(X),T=Math.floor(K);let Z=(T*g+R)*4;const oe=f[Z+0],q=f[Z+1],re=f[Z+2],M=f[Z+3];Z=(k*g+E)*4,p[Z+0]=oe,p[Z+1]=q,p[Z+2]=re,p[Z+3]=M}},i=function(o){const c=o.width,d=o.height;let f,p,g,y,v,w,b,E,k,_,N=Math.round(this.kaleidoscopePower());const A=Math.round(this.kaleidoscopeAngle()),P=Math.floor(c*(A%360)/360);if(N<1)return;const R=r.Util.createCanvasElement();R.width=c,R.height=d;const T=R.getContext("2d").getImageData(0,0,c,d);r.Util.releaseCanvas(R),s(o,T,{polarCenterX:c/2,polarCenterY:d/2});let D=c/Math.pow(2,N);for(;D<=8;)D=D*2,N-=1;D=Math.ceil(D);let I=D,K=0,X=I,Z=1;for(P+D>c&&(K=I,X=0,Z=-1),p=0;p<d;p+=1)for(f=K;f!==X;f+=Z)g=Math.round(f+P)%c,k=(c*p+g)*4,v=T.data[k+0],w=T.data[k+1],b=T.data[k+2],E=T.data[k+3],_=(c*p+f)*4,T.data[_+0]=v,T.data[_+1]=w,T.data[_+2]=b,T.data[_+3]=E;for(p=0;p<d;p+=1)for(I=Math.floor(D),y=0;y<N;y+=1){for(f=0;f<I+1;f+=1)k=(c*p+f)*4,v=T.data[k+0],w=T.data[k+1],b=T.data[k+2],E=T.data[k+3],_=(c*p+I*2-f-1)*4,T.data[_+0]=v,T.data[_+1]=w,T.data[_+2]=b,T.data[_+3]=E;I*=2}a(T,o,{})};return rm.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),rm}var nm={},WT;function HM(){if(WT)return nm;WT=1,Object.defineProperty(nm,"__esModule",{value:!0}),nm.Mask=void 0;const e=$r(),t=ps(),r=zr();function n(g,y,v){let w=(v*g.width+y)*4;const b=[];return b.push(g.data[w++],g.data[w++],g.data[w++],g.data[w++]),b}function s(g,y){return Math.sqrt(Math.pow(g[0]-y[0],2)+Math.pow(g[1]-y[1],2)+Math.pow(g[2]-y[2],2))}function a(g){const y=[0,0,0];for(let v=0;v<g.length;v++)y[0]+=g[v][0],y[1]+=g[v][1],y[2]+=g[v][2];return y[0]/=g.length,y[1]/=g.length,y[2]/=g.length,y}function i(g,y){const v=n(g,0,0),w=n(g,g.width-1,0),b=n(g,0,g.height-1),E=n(g,g.width-1,g.height-1),k=y||10;if(s(v,w)<k&&s(w,E)<k&&s(E,b)<k&&s(b,v)<k){const _=a([w,v,E,b]),N=[];for(let A=0;A<g.width*g.height;A++){const P=s(_,[g.data[A*4],g.data[A*4+1],g.data[A*4+2]]);N[A]=P<k?0:255}return N}}function o(g,y){for(let v=0;v<g.width*g.height;v++)g.data[4*v+3]=y[v]}function c(g,y,v){const w=[1,1,1,1,0,1,1,1,1],b=Math.round(Math.sqrt(w.length)),E=Math.floor(b/2),k=[];for(let _=0;_<v;_++)for(let N=0;N<y;N++){const A=_*y+N;let P=0;for(let R=0;R<b;R++)for(let T=0;T<b;T++){const D=_+R-E,I=N+T-E;if(D>=0&&D<v&&I>=0&&I<y){const K=D*y+I,X=w[R*b+T];P+=g[K]*X}}k[A]=P===2040?255:0}return k}function d(g,y,v){const w=[1,1,1,1,1,1,1,1,1],b=Math.round(Math.sqrt(w.length)),E=Math.floor(b/2),k=[];for(let _=0;_<v;_++)for(let N=0;N<y;N++){const A=_*y+N;let P=0;for(let R=0;R<b;R++)for(let T=0;T<b;T++){const D=_+R-E,I=N+T-E;if(D>=0&&D<v&&I>=0&&I<y){const K=D*y+I,X=w[R*b+T];P+=g[K]*X}}k[A]=P>=1020?255:0}return k}function f(g,y,v){const w=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],b=Math.round(Math.sqrt(w.length)),E=Math.floor(b/2),k=[];for(let _=0;_<v;_++)for(let N=0;N<y;N++){const A=_*y+N;let P=0;for(let R=0;R<b;R++)for(let T=0;T<b;T++){const D=_+R-E,I=N+T-E;if(D>=0&&D<v&&I>=0&&I<y){const K=D*y+I,X=w[R*b+T];P+=g[K]*X}}k[A]=P}return k}const p=function(g){const y=this.threshold();let v=i(g,y);return v&&(v=c(v,g.width,g.height),v=d(v,g.width,g.height),v=f(v,g.width,g.height),o(g,v)),g};return nm.Mask=p,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),nm}var sm={},zT;function GM(){if(zT)return sm;zT=1,Object.defineProperty(sm,"__esModule",{value:!0}),sm.Noise=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,c=a/2;for(let d=0;d<o;d+=4)i[d+0]+=c-2*c*Math.random(),i[d+1]+=c-2*c*Math.random(),i[d+2]+=c-2*c*Math.random()};return sm.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),sm}var am={},HT;function VM(){if(HT)return am;HT=1,Object.defineProperty(am,"__esModule",{value:!0}),am.Pixelate=void 0;const e=$r(),t=as(),r=ps(),n=zr(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,c=a.height,d=Math.ceil(o/i),f=Math.ceil(c/i),p=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let g=0;g<d;g+=1)for(let y=0;y<f;y+=1){let v=0,w=0,b=0,E=0;const k=g*i,_=k+i,N=y*i,A=N+i;let P=0;for(let R=k;R<_;R+=1)if(!(R>=o))for(let T=N;T<A;T+=1){if(T>=c)continue;const D=(o*T+R)*4;v+=p[D+0],w+=p[D+1],b+=p[D+2],E+=p[D+3],P+=1}v=v/P,w=w/P,b=b/P,E=E/P;for(let R=k;R<_;R+=1)if(!(R>=o))for(let T=N;T<A;T+=1){if(T>=c)continue;const D=(o*T+R)*4;p[D+0]=v,p[D+1]=w,p[D+2]=b,p[D+3]=E}}};return am.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),am}var im={},GT;function KM(){if(GT)return im;GT=1,Object.defineProperty(im,"__esModule",{value:!0}),im.Posterize=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,c=255/a;for(let d=0;d<o;d+=1)i[d]=Math.floor(i[d]/c)*c};return im.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),im}var om={},VT;function qM(){if(VT)return om;VT=1,Object.defineProperty(om,"__esModule",{value:!0}),om.RGB=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),d=this.blue();for(let f=0;f<i;f+=4){const p=(.34*a[f]+.5*a[f+1]+.16*a[f+2])/255;a[f]=p*o,a[f+1]=p*c,a[f+2]=p*d,a[f+3]=a[f+3]}};return om.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),om}var lm={},KT;function XM(){if(KT)return lm;KT=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.RGBA=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),d=this.blue(),f=this.alpha();for(let p=0;p<i;p+=4){const g=1-f;a[p]=o*f+a[p]*g,a[p+1]=c*f+a[p+1]*g,a[p+2]=d*f+a[p+2]*g}};return lm.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),lm}var cm={},qT;function YM(){if(qT)return cm;qT=1,Object.defineProperty(cm,"__esModule",{value:!0}),cm.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return cm.Sepia=e,cm}var um={},XT;function QM(){if(XT)return um;XT=1,Object.defineProperty(um,"__esModule",{value:!0}),um.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let c=n;do{const d=o+(c-1)*4;let f=r[d],p=r[d+1],g=r[d+2];f>127&&(f=255-f),p>127&&(p=255-p),g>127&&(g=255-g),r[d]=f,r[d+1]=p,r[d+2]=g}while(--c)}while(--i)};return um.Solarize=e,um}var dm={},YT;function JM(){if(YT)return dm;YT=1,Object.defineProperty(dm,"__esModule",{value:!0}),dm.Threshold=void 0;const e=$r(),t=ps(),r=zr(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=1)i[c]=i[c]<a?0:255};return dm.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),dm}var QT;function ZM(){if(QT)return Cg;QT=1,Object.defineProperty(Cg,"__esModule",{value:!0}),Cg.Konva=void 0;const e=S_(),t=wM(),r=bM(),n=SM(),s=kM(),a=CM(),i=TM(),o=k6(),c=ib(),d=C6(),f=EM(),p=NM(),g=AM(),y=jM(),v=T6(),w=FM(),b=PM(),E=RM(),k=DM(),_=IM(),N=MM(),A=OM(),P=LM(),R=BM(),T=UM(),D=$M(),I=WM(),K=zM(),X=HM(),Z=GM(),oe=VM(),q=KM(),re=qM(),M=XM(),W=YM(),B=QM(),G=JM();return Cg.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:c.Path,Rect:d.Rect,RegularPolygon:f.RegularPolygon,Ring:p.Ring,Sprite:g.Sprite,Star:y.Star,Text:v.Text,TextPath:w.TextPath,Transformer:b.Transformer,Wedge:E.Wedge,Filters:{Blur:k.Blur,Brighten:_.Brighten,Contrast:N.Contrast,Emboss:A.Emboss,Enhance:P.Enhance,Grayscale:R.Grayscale,HSL:T.HSL,HSV:D.HSV,Invert:I.Invert,Kaleidoscope:K.Kaleidoscope,Mask:X.Mask,Noise:Z.Noise,Pixelate:oe.Pixelate,Posterize:q.Posterize,RGB:re.RGB,RGBA:M.RGBA,Sepia:W.Sepia,Solarize:B.Solarize,Threshold:G.Threshold}}),Cg}var eO=j1.exports,JT;function tO(){if(JT)return j1.exports;JT=1,Object.defineProperty(eO,"__esModule",{value:!0});const e=ZM();return j1.exports=e.Konva,j1.exports}var E6=tO();const rO=_p(E6),nO=C3({__proto__:null,default:rO},[E6]);var n1={exports:{}},ZT;function sO(){return ZT||(ZT=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=S_();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=S_();e.exports=n.Konva})(n1,n1.exports)),n1.exports}var aO=sO();const Qm=_p(aO);var gw={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mw,e4;function iO(){return e4||(e4=1,mw=function(t){var r={},n=ky(),s=y2(),a=Object.assign;function i(m){for(var x="https://reactjs.org/docs/error-decoder.html?invariant="+m,j=1;j<arguments.length;j++)x+="&args[]="+encodeURIComponent(arguments[j]);return"Minified React error #"+m+"; visit "+x+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),d=Symbol.for("react.portal"),f=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),g=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),v=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),E=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),N=Symbol.for("react.offscreen"),A=Symbol.iterator;function P(m){return m===null||typeof m!="object"?null:(m=A&&m[A]||m["@@iterator"],typeof m=="function"?m:null)}function R(m){if(m==null)return null;if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case f:return"Fragment";case d:return"Portal";case g:return"Profiler";case p:return"StrictMode";case b:return"Suspense";case E:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case v:return(m.displayName||"Context")+".Consumer";case y:return(m._context.displayName||"Context")+".Provider";case w:var x=m.render;return m=m.displayName,m||(m=x.displayName||x.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case k:return x=m.displayName||null,x!==null?x:R(m.type)||"Memo";case _:x=m._payload,m=m._init;try{return R(m(x))}catch{}}return null}function T(m){var x=m.type;switch(m.tag){case 24:return"Cache";case 9:return(x.displayName||"Context")+".Consumer";case 10:return(x._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return m=x.render,m=m.displayName||m.name||"",x.displayName||(m!==""?"ForwardRef("+m+")":"ForwardRef");case 7:return"Fragment";case 5:return x;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(x);case 8:return x===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof x=="function")return x.displayName||x.name||null;if(typeof x=="string")return x}return null}function D(m){var x=m,j=m;if(m.alternate)for(;x.return;)x=x.return;else{m=x;do x=m,(x.flags&4098)!==0&&(j=x.return),m=x.return;while(m)}return x.tag===3?j:null}function I(m){if(D(m)!==m)throw Error(i(188))}function K(m){var x=m.alternate;if(!x){if(x=D(m),x===null)throw Error(i(188));return x!==m?null:m}for(var j=m,L=x;;){var V=j.return;if(V===null)break;var ne=V.alternate;if(ne===null){if(L=V.return,L!==null){j=L;continue}break}if(V.child===ne.child){for(ne=V.child;ne;){if(ne===j)return I(V),m;if(ne===L)return I(V),x;ne=ne.sibling}throw Error(i(188))}if(j.return!==L.return)j=V,L=ne;else{for(var xe=!1,Ue=V.child;Ue;){if(Ue===j){xe=!0,j=V,L=ne;break}if(Ue===L){xe=!0,L=V,j=ne;break}Ue=Ue.sibling}if(!xe){for(Ue=ne.child;Ue;){if(Ue===j){xe=!0,j=ne,L=V;break}if(Ue===L){xe=!0,L=ne,j=V;break}Ue=Ue.sibling}if(!xe)throw Error(i(189))}}if(j.alternate!==L)throw Error(i(190))}if(j.tag!==3)throw Error(i(188));return j.stateNode.current===j?m:x}function X(m){return m=K(m),m!==null?Z(m):null}function Z(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){var x=Z(m);if(x!==null)return x;m=m.sibling}return null}function oe(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){if(m.tag!==4){var x=oe(m);if(x!==null)return x}m=m.sibling}return null}var q=Array.isArray,re=t.getPublicInstance,M=t.getRootHostContext,W=t.getChildHostContext,B=t.prepareForCommit,G=t.resetAfterCommit,H=t.createInstance,O=t.appendInitialChild,z=t.finalizeInitialChildren,Y=t.prepareUpdate,J=t.shouldSetTextContent,te=t.createTextInstance,ee=t.scheduleTimeout,ie=t.cancelTimeout,me=t.noTimeout,Ce=t.isPrimaryRenderer,Oe=t.supportsMutation,fe=t.supportsPersistence,pe=t.supportsHydration,He=t.getInstanceFromNode,Ye=t.preparePortalMount,ot=t.getCurrentEventPriority,Ve=t.detachDeletedInstance,Rt=t.supportsMicrotasks,tt=t.scheduleMicrotask,Le=t.supportsTestSelectors,De=t.findFiberRoot,Je=t.getBoundingRect,_t=t.getTextContent,ht=t.isHiddenSubtree,It=t.matchAccessibilityRole,Mt=t.setFocusIfFocusable,rt=t.setupIntersectionObserver,qe=t.appendChild,pt=t.appendChildToContainer,lt=t.commitTextUpdate,wt=t.commitMount,Lt=t.commitUpdate,Ht=t.insertBefore,Ie=t.insertInContainerBefore,at=t.removeChild,gt=t.removeChildFromContainer,At=t.resetTextContent,Ot=t.hideInstance,Jt=t.hideTextInstance,Ae=t.unhideInstance,ye=t.unhideTextInstance,he=t.clearContainer,_e=t.cloneInstance,$e=t.createContainerChildSet,St=t.appendChildToContainerChildSet,ct=t.finalizeContainerChildren,zt=t.replaceContainerChildren,qt=t.cloneHiddenInstance,Vt=t.cloneHiddenTextInstance,gr=t.canHydrateInstance,Fr=t.canHydrateTextInstance,fr=t.canHydrateSuspenseInstance,cr=t.isSuspenseInstancePending,Pr=t.isSuspenseInstanceFallback,Xr=t.getSuspenseInstanceFallbackErrorDetails,ue=t.registerSuspenseInstanceRetry,ke=t.getNextHydratableSibling,ge=t.getFirstHydratableChild,ve=t.getFirstHydratableChildWithinContainer,Se=t.getFirstHydratableChildWithinSuspenseInstance,Ee=t.hydrateInstance,We=t.hydrateTextInstance,ut=t.hydrateSuspenseInstance,Ge=t.getNextHydratableInstanceAfterSuspenseInstance,le=t.commitHydratedContainer,se=t.commitHydratedSuspenseInstance,ce=t.clearSuspenseBoundary,we=t.clearSuspenseBoundaryFromContainer,Te=t.shouldDeleteUnhydratedTailInstances,Be=t.didNotMatchHydratedContainerTextInstance,be=t.didNotMatchHydratedTextInstance,nt;function vt(m){if(nt===void 0)try{throw Error()}catch(j){var x=j.stack.trim().match(/\n( *(at )?)/);nt=x&&x[1]||""}return`
`+nt+m}var Fe=!1;function mt(m,x){if(!m||Fe)return"";Fe=!0;var j=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(x)if(x=function(){throw Error()},Object.defineProperty(x.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(x,[])}catch(Pt){var L=Pt}Reflect.construct(m,[],x)}else{try{x.call()}catch(Pt){L=Pt}m.call(x.prototype)}else{try{throw Error()}catch(Pt){L=Pt}m()}}catch(Pt){if(Pt&&L&&typeof Pt.stack=="string"){for(var V=Pt.stack.split(`
`),ne=L.stack.split(`
`),xe=V.length-1,Ue=ne.length-1;1<=xe&&0<=Ue&&V[xe]!==ne[Ue];)Ue--;for(;1<=xe&&0<=Ue;xe--,Ue--)if(V[xe]!==ne[Ue]){if(xe!==1||Ue!==1)do if(xe--,Ue--,0>Ue||V[xe]!==ne[Ue]){var it=`
`+V[xe].replace(" at new "," at ");return m.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",m.displayName)),it}while(1<=xe&&0<=Ue);break}}}finally{Fe=!1,Error.prepareStackTrace=j}return(m=m?m.displayName||m.name:"")?vt(m):""}var Xt=Object.prototype.hasOwnProperty,Rr=[],Ar=-1;function hr(m){return{current:m}}function er(m){0>Ar||(m.current=Rr[Ar],Rr[Ar]=null,Ar--)}function Kt(m,x){Ar++,Rr[Ar]=m.current,m.current=x}var ae={},Ne=hr(ae),dt=hr(!1),Ct=ae;function Dr(m,x){var j=m.type.contextTypes;if(!j)return ae;var L=m.stateNode;if(L&&L.__reactInternalMemoizedUnmaskedChildContext===x)return L.__reactInternalMemoizedMaskedChildContext;var V={},ne;for(ne in j)V[ne]=x[ne];return L&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=x,m.__reactInternalMemoizedMaskedChildContext=V),V}function _r(m){return m=m.childContextTypes,m!=null}function fn(){er(dt),er(Ne)}function wo(m,x,j){if(Ne.current!==ae)throw Error(i(168));Kt(Ne,x),Kt(dt,j)}function oi(m,x,j){var L=m.stateNode;if(x=x.childContextTypes,typeof L.getChildContext!="function")return j;L=L.getChildContext();for(var V in L)if(!(V in x))throw Error(i(108,T(m)||"Unknown",V));return a({},j,L)}function Us(m){return m=(m=m.stateNode)&&m.__reactInternalMemoizedMergedChildContext||ae,Ct=Ne.current,Kt(Ne,m),Kt(dt,dt.current),!0}function bn(m,x,j){var L=m.stateNode;if(!L)throw Error(i(169));j?(m=oi(m,x,Ct),L.__reactInternalMemoizedMergedChildContext=m,er(dt),er(Ne),Kt(Ne,m)):er(dt),Kt(dt,j)}var $s=Math.clz32?Math.clz32:R0,Il=Math.log,ov=Math.LN2;function R0(m){return m>>>=0,m===0?32:31-(Il(m)/ov|0)|0}var Hr=64,Zu=4194304;function Pc(m){switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return m&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return m}}function Rc(m,x){var j=m.pendingLanes;if(j===0)return 0;var L=0,V=m.suspendedLanes,ne=m.pingedLanes,xe=j&268435455;if(xe!==0){var Ue=xe&~V;Ue!==0?L=Pc(Ue):(ne&=xe,ne!==0&&(L=Pc(ne)))}else xe=j&~V,xe!==0?L=Pc(xe):ne!==0&&(L=Pc(ne));if(L===0)return 0;if(x!==0&&x!==L&&(x&V)===0&&(V=L&-L,ne=x&-x,V>=ne||V===16&&(ne&4194240)!==0))return x;if((L&4)!==0&&(L|=j&16),x=m.entangledLanes,x!==0)for(m=m.entanglements,x&=L;0<x;)j=31-$s(x),V=1<<j,L|=m[j],x&=~V;return L}function Jp(m,x){switch(m){case 1:case 2:case 4:return x+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return x+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zp(m,x){for(var j=m.suspendedLanes,L=m.pingedLanes,V=m.expirationTimes,ne=m.pendingLanes;0<ne;){var xe=31-$s(ne),Ue=1<<xe,it=V[xe];it===-1?((Ue&j)===0||(Ue&L)!==0)&&(V[xe]=Jp(Ue,x)):it<=x&&(m.expiredLanes|=Ue),ne&=~Ue}}function Tf(m){return m=m.pendingLanes&-1073741825,m!==0?m:m&1073741824?1073741824:0}function Ef(){var m=Hr;return Hr<<=1,(Hr&4194240)===0&&(Hr=64),m}function Dc(m){for(var x=[],j=0;31>j;j++)x.push(m);return x}function li(m,x,j){m.pendingLanes|=x,x!==536870912&&(m.suspendedLanes=0,m.pingedLanes=0),m=m.eventTimes,x=31-$s(x),m[x]=j}function Xo(m,x){var j=m.pendingLanes&~x;m.pendingLanes=x,m.suspendedLanes=0,m.pingedLanes=0,m.expiredLanes&=x,m.mutableReadLanes&=x,m.entangledLanes&=x,x=m.entanglements;var L=m.eventTimes;for(m=m.expirationTimes;0<j;){var V=31-$s(j),ne=1<<V;x[V]=0,L[V]=-1,m[V]=-1,j&=~ne}}function zi(m,x){var j=m.entangledLanes|=x;for(m=m.entanglements;j;){var L=31-$s(j),V=1<<L;V&x|m[L]&x&&(m[L]|=x),j&=~V}}var Or=0;function Ic(m){return m&=-m,1<m?4<m?(m&268435455)!==0?16:536870912:4:1}var Hi=s.unstable_scheduleCallback,ex=s.unstable_cancelCallback,tx=s.unstable_shouldYield,ed=s.unstable_requestPaint,ys=s.unstable_now,Nf=s.unstable_ImmediatePriority,Af=s.unstable_UserBlockingPriority,jf=s.unstable_NormalPriority,lv=s.unstable_IdlePriority,Yo=null,Sa=null;function Mc(m){if(Sa&&typeof Sa.onCommitFiberRoot=="function")try{Sa.onCommitFiberRoot(Yo,m,void 0,(m.current.flags&128)===128)}catch{}}function Ff(m,x){return m===x&&(m!==0||1/m===1/x)||m!==m&&x!==x}var Ei=typeof Object.is=="function"?Object.is:Ff,_o=null,Oc=!1,Lc=!1;function Pf(m){_o===null?_o=[m]:_o.push(m)}function rx(m){Oc=!0,Pf(m)}function As(){if(!Lc&&_o!==null){Lc=!0;var m=0,x=Or;try{var j=_o;for(Or=1;m<j.length;m++){var L=j[m];do L=L(!0);while(L!==null)}_o=null,Oc=!1}catch(V){throw _o!==null&&(_o=_o.slice(m+1)),Hi(Nf,As),V}finally{Or=x,Lc=!1}}return null}var Qo=[],bo=0,td=null,Ml=0,na=[],Wa=0,is=null,ka=1,Ni="";function Ai(m,x){Qo[bo++]=Ml,Qo[bo++]=td,td=m,Ml=x}function nx(m,x,j){na[Wa++]=ka,na[Wa++]=Ni,na[Wa++]=is,is=m;var L=ka;m=Ni;var V=32-$s(L)-1;L&=~(1<<V),j+=1;var ne=32-$s(x)+V;if(30<ne){var xe=V-V%5;ne=(L&(1<<xe)-1).toString(32),L>>=xe,V-=xe,ka=1<<32-$s(x)+V|j<<V|L,Ni=ne+m}else ka=1<<ne|j<<V|L,Ni=m}function rd(m){m.return!==null&&(Ai(m,1),nx(m,1,0))}function nd(m){for(;m===td;)td=Qo[--bo],Qo[bo]=null,Ml=Qo[--bo],Qo[bo]=null;for(;m===is;)is=na[--Wa],na[Wa]=null,Ni=na[--Wa],na[Wa]=null,ka=na[--Wa],na[Wa]=null}var js=null,sa=null,vn=!1,sd=!1,ji=null;function sx(m,x){var j=Ja(5,null,null,0);j.elementType="DELETED",j.stateNode=x,j.return=m,x=m.deletions,x===null?(m.deletions=[j],m.flags|=16):x.push(j)}function Rf(m,x){switch(m.tag){case 5:return x=gr(x,m.type,m.pendingProps),x!==null?(m.stateNode=x,js=m,sa=ge(x),!0):!1;case 6:return x=Fr(x,m.pendingProps),x!==null?(m.stateNode=x,js=m,sa=null,!0):!1;case 13:if(x=fr(x),x!==null){var j=is!==null?{id:ka,overflow:Ni}:null;return m.memoizedState={dehydrated:x,treeContext:j,retryLane:1073741824},j=Ja(18,null,null,0),j.stateNode=x,j.return=m,m.child=j,js=m,sa=null,!0}return!1;default:return!1}}function D0(m){return(m.mode&1)!==0&&(m.flags&128)===0}function I0(m){if(vn){var x=sa;if(x){var j=x;if(!Rf(m,x)){if(D0(m))throw Error(i(418));x=ke(j);var L=js;x&&Rf(m,x)?sx(L,j):(m.flags=m.flags&-4097|2,vn=!1,js=m)}}else{if(D0(m))throw Error(i(418));m.flags=m.flags&-4097|2,vn=!1,js=m}}}function ax(m){for(m=m.return;m!==null&&m.tag!==5&&m.tag!==3&&m.tag!==13;)m=m.return;js=m}function Df(m){if(!pe||m!==js)return!1;if(!vn)return ax(m),vn=!0,!1;if(m.tag!==3&&(m.tag!==5||Te(m.type)&&!J(m.type,m.memoizedProps))){var x=sa;if(x){if(D0(m))throw ix(),Error(i(418));for(;x;)sx(m,x),x=ke(x)}}if(ax(m),m.tag===13){if(!pe)throw Error(i(316));if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));sa=Ge(m)}else sa=js?ke(m.stateNode):null;return!0}function ix(){for(var m=sa;m;)m=ke(m)}function Ol(){pe&&(sa=js=null,sd=vn=!1)}function M0(m){ji===null?ji=[m]:ji.push(m)}var cv=o.ReactCurrentBatchConfig;function If(m,x){if(Ei(m,x))return!0;if(typeof m!="object"||m===null||typeof x!="object"||x===null)return!1;var j=Object.keys(m),L=Object.keys(x);if(j.length!==L.length)return!1;for(L=0;L<j.length;L++){var V=j[L];if(!Xt.call(x,V)||!Ei(m[V],x[V]))return!1}return!0}function uv(m){switch(m.tag){case 5:return vt(m.type);case 16:return vt("Lazy");case 13:return vt("Suspense");case 19:return vt("SuspenseList");case 0:case 2:case 15:return m=mt(m.type,!1),m;case 11:return m=mt(m.type.render,!1),m;case 1:return m=mt(m.type,!0),m;default:return""}}function Ll(m,x,j){if(m=j.ref,m!==null&&typeof m!="function"&&typeof m!="object"){if(j._owner){if(j=j._owner,j){if(j.tag!==1)throw Error(i(309));var L=j.stateNode}if(!L)throw Error(i(147,m));var V=L,ne=""+m;return x!==null&&x.ref!==null&&typeof x.ref=="function"&&x.ref._stringRef===ne?x.ref:(x=function(xe){var Ue=V.refs;xe===null?delete Ue[ne]:Ue[ne]=xe},x._stringRef=ne,x)}if(typeof m!="string")throw Error(i(284));if(!j._owner)throw Error(i(290,m))}return m}function Mf(m,x){throw m=Object.prototype.toString.call(x),Error(i(31,m==="[object Object]"?"object with keys {"+Object.keys(x).join(", ")+"}":m))}function ox(m){var x=m._init;return x(m._payload)}function lx(m){function x(et,ze){if(m){var ft=et.deletions;ft===null?(et.deletions=[ze],et.flags|=16):ft.push(ze)}}function j(et,ze){if(!m)return null;for(;ze!==null;)x(et,ze),ze=ze.sibling;return null}function L(et,ze){for(et=new Map;ze!==null;)ze.key!==null?et.set(ze.key,ze):et.set(ze.index,ze),ze=ze.sibling;return et}function V(et,ze){return et=ml(et,ze),et.index=0,et.sibling=null,et}function ne(et,ze,ft){return et.index=ft,m?(ft=et.alternate,ft!==null?(ft=ft.index,ft<ze?(et.flags|=2,ze):ft):(et.flags|=2,ze)):(et.flags|=1048576,ze)}function xe(et){return m&&et.alternate===null&&(et.flags|=2),et}function Ue(et,ze,ft,Qt){return ze===null||ze.tag!==6?(ze=cu(ft,et.mode,Qt),ze.return=et,ze):(ze=V(ze,ft),ze.return=et,ze)}function it(et,ze,ft,Qt){var or=ft.type;return or===f?rr(et,ze,ft.props.children,Qt,ft.key):ze!==null&&(ze.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===_&&ox(or)===ze.type)?(Qt=V(ze,ft.props),Qt.ref=Ll(et,ze,ft),Qt.return=et,Qt):(Qt=gh(ft.type,ft.key,ft.props,null,et.mode,Qt),Qt.ref=Ll(et,ze,ft),Qt.return=et,Qt)}function Pt(et,ze,ft,Qt){return ze===null||ze.tag!==4||ze.stateNode.containerInfo!==ft.containerInfo||ze.stateNode.implementation!==ft.implementation?(ze=mh(ft,et.mode,Qt),ze.return=et,ze):(ze=V(ze,ft.children||[]),ze.return=et,ze)}function rr(et,ze,ft,Qt,or){return ze===null||ze.tag!==7?(ze=Rs(ft,et.mode,Qt,or),ze.return=et,ze):(ze=V(ze,ft),ze.return=et,ze)}function br(et,ze,ft){if(typeof ze=="string"&&ze!==""||typeof ze=="number")return ze=cu(""+ze,et.mode,ft),ze.return=et,ze;if(typeof ze=="object"&&ze!==null){switch(ze.$$typeof){case c:return ft=gh(ze.type,ze.key,ze.props,null,et.mode,ft),ft.ref=Ll(et,null,ze),ft.return=et,ft;case d:return ze=mh(ze,et.mode,ft),ze.return=et,ze;case _:var Qt=ze._init;return br(et,Qt(ze._payload),ft)}if(q(ze)||P(ze))return ze=Rs(ze,et.mode,ft,null),ze.return=et,ze;Mf(et,ze)}return null}function Yt(et,ze,ft,Qt){var or=ze!==null?ze.key:null;if(typeof ft=="string"&&ft!==""||typeof ft=="number")return or!==null?null:Ue(et,ze,""+ft,Qt);if(typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case c:return ft.key===or?it(et,ze,ft,Qt):null;case d:return ft.key===or?Pt(et,ze,ft,Qt):null;case _:return or=ft._init,Yt(et,ze,or(ft._payload),Qt)}if(q(ft)||P(ft))return or!==null?null:rr(et,ze,ft,Qt,null);Mf(et,ft)}return null}function pn(et,ze,ft,Qt,or){if(typeof Qt=="string"&&Qt!==""||typeof Qt=="number")return et=et.get(ft)||null,Ue(ze,et,""+Qt,or);if(typeof Qt=="object"&&Qt!==null){switch(Qt.$$typeof){case c:return et=et.get(Qt.key===null?ft:Qt.key)||null,it(ze,et,Qt,or);case d:return et=et.get(Qt.key===null?ft:Qt.key)||null,Pt(ze,et,Qt,or);case _:var Er=Qt._init;return pn(et,ze,ft,Er(Qt._payload),or)}if(q(Qt)||P(Qt))return et=et.get(ft)||null,rr(ze,et,Qt,or,null);Mf(ze,Qt)}return null}function tn(et,ze,ft,Qt){for(var or=null,Er=null,Sr=ze,Wr=ze=0,ds=null;Sr!==null&&Wr<ft.length;Wr++){Sr.index>Wr?(ds=Sr,Sr=null):ds=Sr.sibling;var Ur=Yt(et,Sr,ft[Wr],Qt);if(Ur===null){Sr===null&&(Sr=ds);break}m&&Sr&&Ur.alternate===null&&x(et,Sr),ze=ne(Ur,ze,Wr),Er===null?or=Ur:Er.sibling=Ur,Er=Ur,Sr=ds}if(Wr===ft.length)return j(et,Sr),vn&&Ai(et,Wr),or;if(Sr===null){for(;Wr<ft.length;Wr++)Sr=br(et,ft[Wr],Qt),Sr!==null&&(ze=ne(Sr,ze,Wr),Er===null?or=Sr:Er.sibling=Sr,Er=Sr);return vn&&Ai(et,Wr),or}for(Sr=L(et,Sr);Wr<ft.length;Wr++)ds=pn(Sr,et,Wr,ft[Wr],Qt),ds!==null&&(m&&ds.alternate!==null&&Sr.delete(ds.key===null?Wr:ds.key),ze=ne(ds,ze,Wr),Er===null?or=ds:Er.sibling=ds,Er=ds);return m&&Sr.forEach(function(Ks){return x(et,Ks)}),vn&&Ai(et,Wr),or}function ua(et,ze,ft,Qt){var or=P(ft);if(typeof or!="function")throw Error(i(150));if(ft=or.call(ft),ft==null)throw Error(i(151));for(var Er=or=null,Sr=ze,Wr=ze=0,ds=null,Ur=ft.next();Sr!==null&&!Ur.done;Wr++,Ur=ft.next()){Sr.index>Wr?(ds=Sr,Sr=null):ds=Sr.sibling;var Ks=Yt(et,Sr,Ur.value,Qt);if(Ks===null){Sr===null&&(Sr=ds);break}m&&Sr&&Ks.alternate===null&&x(et,Sr),ze=ne(Ks,ze,Wr),Er===null?or=Ks:Er.sibling=Ks,Er=Ks,Sr=ds}if(Ur.done)return j(et,Sr),vn&&Ai(et,Wr),or;if(Sr===null){for(;!Ur.done;Wr++,Ur=ft.next())Ur=br(et,Ur.value,Qt),Ur!==null&&(ze=ne(Ur,ze,Wr),Er===null?or=Ur:Er.sibling=Ur,Er=Ur);return vn&&Ai(et,Wr),or}for(Sr=L(et,Sr);!Ur.done;Wr++,Ur=ft.next())Ur=pn(Sr,et,Wr,Ur.value,Qt),Ur!==null&&(m&&Ur.alternate!==null&&Sr.delete(Ur.key===null?Wr:Ur.key),ze=ne(Ur,ze,Wr),Er===null?or=Ur:Er.sibling=Ur,Er=Ur);return m&&Sr.forEach(function(mv){return x(et,mv)}),vn&&Ai(et,Wr),or}function Zi(et,ze,ft,Qt){if(typeof ft=="object"&&ft!==null&&ft.type===f&&ft.key===null&&(ft=ft.props.children),typeof ft=="object"&&ft!==null){switch(ft.$$typeof){case c:e:{for(var or=ft.key,Er=ze;Er!==null;){if(Er.key===or){if(or=ft.type,or===f){if(Er.tag===7){j(et,Er.sibling),ze=V(Er,ft.props.children),ze.return=et,et=ze;break e}}else if(Er.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===_&&ox(or)===Er.type){j(et,Er.sibling),ze=V(Er,ft.props),ze.ref=Ll(et,Er,ft),ze.return=et,et=ze;break e}j(et,Er);break}else x(et,Er);Er=Er.sibling}ft.type===f?(ze=Rs(ft.props.children,et.mode,Qt,ft.key),ze.return=et,et=ze):(Qt=gh(ft.type,ft.key,ft.props,null,et.mode,Qt),Qt.ref=Ll(et,ze,ft),Qt.return=et,et=Qt)}return xe(et);case d:e:{for(Er=ft.key;ze!==null;){if(ze.key===Er)if(ze.tag===4&&ze.stateNode.containerInfo===ft.containerInfo&&ze.stateNode.implementation===ft.implementation){j(et,ze.sibling),ze=V(ze,ft.children||[]),ze.return=et,et=ze;break e}else{j(et,ze);break}else x(et,ze);ze=ze.sibling}ze=mh(ft,et.mode,Qt),ze.return=et,et=ze}return xe(et);case _:return Er=ft._init,Zi(et,ze,Er(ft._payload),Qt)}if(q(ft))return tn(et,ze,ft,Qt);if(P(ft))return ua(et,ze,ft,Qt);Mf(et,ft)}return typeof ft=="string"&&ft!==""||typeof ft=="number"?(ft=""+ft,ze!==null&&ze.tag===6?(j(et,ze.sibling),ze=V(ze,ft),ze.return=et,et=ze):(j(et,ze),ze=cu(ft,et.mode,Qt),ze.return=et,et=ze),xe(et)):j(et,ze)}return Zi}var Bl=lx(!0),cx=lx(!1),Of=hr(null),Lf=null,Bc=null,O0=null;function L0(){O0=Bc=Lf=null}function ux(m,x,j){Ce?(Kt(Of,x._currentValue),x._currentValue=j):(Kt(Of,x._currentValue2),x._currentValue2=j)}function ad(m){var x=Of.current;er(Of),Ce?m._currentValue=x:m._currentValue2=x}function Ul(m,x,j){for(;m!==null;){var L=m.alternate;if((m.childLanes&x)!==x?(m.childLanes|=x,L!==null&&(L.childLanes|=x)):L!==null&&(L.childLanes&x)!==x&&(L.childLanes|=x),m===j)break;m=m.return}}function Uc(m,x){Lf=m,O0=Bc=null,m=m.dependencies,m!==null&&m.firstContext!==null&&((m.lanes&x)!==0&&(ls=!0),m.firstContext=null)}function za(m){var x=Ce?m._currentValue:m._currentValue2;if(O0!==m)if(m={context:m,memoizedValue:x,next:null},Bc===null){if(Lf===null)throw Error(i(308));Bc=m,Lf.dependencies={lanes:0,firstContext:m}}else Bc=Bc.next=m;return x}var Jo=null;function Bf(m){Jo===null?Jo=[m]:Jo.push(m)}function B0(m,x,j,L){var V=x.interleaved;return V===null?(j.next=j,Bf(x)):(j.next=V.next,V.next=j),x.interleaved=j,Fi(m,L)}function Fi(m,x){m.lanes|=x;var j=m.alternate;for(j!==null&&(j.lanes|=x),j=m,m=m.return;m!==null;)m.childLanes|=x,j=m.alternate,j!==null&&(j.childLanes|=x),j=m,m=m.return;return j.tag===3?j.stateNode:null}var Ha=!1;function U0(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dx(m,x){m=m.updateQueue,x.updateQueue===m&&(x.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects})}function So(m,x){return{eventTime:m,lane:x,tag:0,payload:null,callback:null,next:null}}function ko(m,x,j){var L=m.updateQueue;if(L===null)return null;if(L=L.shared,(kr&2)!==0){var V=L.pending;return V===null?x.next=x:(x.next=V.next,V.next=x),L.pending=x,Fi(m,j)}return V=L.interleaved,V===null?(x.next=x,Bf(L)):(x.next=V.next,V.next=x),L.interleaved=x,Fi(m,j)}function id(m,x,j){if(x=x.updateQueue,x!==null&&(x=x.shared,(j&4194240)!==0)){var L=x.lanes;L&=m.pendingLanes,j|=L,x.lanes=j,zi(m,j)}}function $c(m,x){var j=m.updateQueue,L=m.alternate;if(L!==null&&(L=L.updateQueue,j===L)){var V=null,ne=null;if(j=j.firstBaseUpdate,j!==null){do{var xe={eventTime:j.eventTime,lane:j.lane,tag:j.tag,payload:j.payload,callback:j.callback,next:null};ne===null?V=ne=xe:ne=ne.next=xe,j=j.next}while(j!==null);ne===null?V=ne=x:ne=ne.next=x}else V=ne=x;j={baseState:L.baseState,firstBaseUpdate:V,lastBaseUpdate:ne,shared:L.shared,effects:L.effects},m.updateQueue=j;return}m=j.lastBaseUpdate,m===null?j.firstBaseUpdate=x:m.next=x,j.lastBaseUpdate=x}function Zo(m,x,j,L){var V=m.updateQueue;Ha=!1;var ne=V.firstBaseUpdate,xe=V.lastBaseUpdate,Ue=V.shared.pending;if(Ue!==null){V.shared.pending=null;var it=Ue,Pt=it.next;it.next=null,xe===null?ne=Pt:xe.next=Pt,xe=it;var rr=m.alternate;rr!==null&&(rr=rr.updateQueue,Ue=rr.lastBaseUpdate,Ue!==xe&&(Ue===null?rr.firstBaseUpdate=Pt:Ue.next=Pt,rr.lastBaseUpdate=it))}if(ne!==null){var br=V.baseState;xe=0,rr=Pt=it=null,Ue=ne;do{var Yt=Ue.lane,pn=Ue.eventTime;if((L&Yt)===Yt){rr!==null&&(rr=rr.next={eventTime:pn,lane:0,tag:Ue.tag,payload:Ue.payload,callback:Ue.callback,next:null});e:{var tn=m,ua=Ue;switch(Yt=x,pn=j,ua.tag){case 1:if(tn=ua.payload,typeof tn=="function"){br=tn.call(pn,br,Yt);break e}br=tn;break e;case 3:tn.flags=tn.flags&-65537|128;case 0:if(tn=ua.payload,Yt=typeof tn=="function"?tn.call(pn,br,Yt):tn,Yt==null)break e;br=a({},br,Yt);break e;case 2:Ha=!0}}Ue.callback!==null&&Ue.lane!==0&&(m.flags|=64,Yt=V.effects,Yt===null?V.effects=[Ue]:Yt.push(Ue))}else pn={eventTime:pn,lane:Yt,tag:Ue.tag,payload:Ue.payload,callback:Ue.callback,next:null},rr===null?(Pt=rr=pn,it=br):rr=rr.next=pn,xe|=Yt;if(Ue=Ue.next,Ue===null){if(Ue=V.shared.pending,Ue===null)break;Yt=Ue,Ue=Yt.next,Yt.next=null,V.lastBaseUpdate=Yt,V.shared.pending=null}}while(!0);if(rr===null&&(it=br),V.baseState=it,V.firstBaseUpdate=Pt,V.lastBaseUpdate=rr,x=V.shared.interleaved,x!==null){V=x;do xe|=V.lane,V=V.next;while(V!==x)}else ne===null&&(V.shared.lanes=0);Ao|=xe,m.lanes=xe,m.memoizedState=br}}function fx(m,x,j){if(m=x.effects,x.effects=null,m!==null)for(x=0;x<m.length;x++){var L=m[x],V=L.callback;if(V!==null){if(L.callback=null,L=j,typeof V!="function")throw Error(i(191,V));V.call(L)}}}var el={},ci=hr(el),Wc=hr(el),tl=hr(el);function ui(m){if(m===el)throw Error(i(174));return m}function Uf(m,x){Kt(tl,x),Kt(Wc,m),Kt(ci,el),m=M(x),er(ci),Kt(ci,m)}function $l(){er(ci),er(Wc),er(tl)}function $0(m){var x=ui(tl.current),j=ui(ci.current);x=W(j,m.type,x),j!==x&&(Kt(Wc,m),Kt(ci,x))}function W0(m){Wc.current===m&&(er(ci),er(Wc))}var An=hr(0);function $f(m){for(var x=m;x!==null;){if(x.tag===13){var j=x.memoizedState;if(j!==null&&(j=j.dehydrated,j===null||cr(j)||Pr(j)))return x}else if(x.tag===19&&x.memoizedProps.revealOrder!==void 0){if((x.flags&128)!==0)return x}else if(x.child!==null){x.child.return=x,x=x.child;continue}if(x===m)break;for(;x.sibling===null;){if(x.return===null||x.return===m)return null;x=x.return}x.sibling.return=x.return,x=x.sibling}return null}var z0=[];function H0(){for(var m=0;m<z0.length;m++){var x=z0[m];Ce?x._workInProgressVersionPrimary=null:x._workInProgressVersionSecondary=null}z0.length=0}var Ca=o.ReactCurrentDispatcher,Wl=o.ReactCurrentBatchConfig,rl=0,Sn=null,Kn=null,os=null,zc=!1,od=!1,ld=0,Hc=0;function vs(){throw Error(i(321))}function zl(m,x){if(x===null)return!1;for(var j=0;j<x.length&&j<m.length;j++)if(!Ei(m[j],x[j]))return!1;return!0}function cd(m,x,j,L,V,ne){if(rl=ne,Sn=x,x.memoizedState=null,x.updateQueue=null,x.lanes=0,Ca.current=m===null||m.memoizedState===null?eg:tg,m=j(L,V),od){ne=0;do{if(od=!1,ld=0,25<=ne)throw Error(i(301));ne+=1,os=Kn=null,x.updateQueue=null,Ca.current=rg,m=j(L,V)}while(od)}if(Ca.current=ql,x=Kn!==null&&Kn.next!==null,rl=0,os=Kn=Sn=null,zc=!1,x)throw Error(i(300));return m}function Wf(){var m=ld!==0;return ld=0,m}function Ga(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return os===null?Sn.memoizedState=os=m:os=os.next=m,os}function Fs(){if(Kn===null){var m=Sn.alternate;m=m!==null?m.memoizedState:null}else m=Kn.next;var x=os===null?Sn.memoizedState:os.next;if(x!==null)os=x,Kn=m;else{if(m===null)throw Error(i(310));Kn=m,m={memoizedState:Kn.memoizedState,baseState:Kn.baseState,baseQueue:Kn.baseQueue,queue:Kn.queue,next:null},os===null?Sn.memoizedState=os=m:os=os.next=m}return os}function Hl(m,x){return typeof x=="function"?x(m):x}function zf(m){var x=Fs(),j=x.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=m;var L=Kn,V=L.baseQueue,ne=j.pending;if(ne!==null){if(V!==null){var xe=V.next;V.next=ne.next,ne.next=xe}L.baseQueue=V=ne,j.pending=null}if(V!==null){ne=V.next,L=L.baseState;var Ue=xe=null,it=null,Pt=ne;do{var rr=Pt.lane;if((rl&rr)===rr)it!==null&&(it=it.next={lane:0,action:Pt.action,hasEagerState:Pt.hasEagerState,eagerState:Pt.eagerState,next:null}),L=Pt.hasEagerState?Pt.eagerState:m(L,Pt.action);else{var br={lane:rr,action:Pt.action,hasEagerState:Pt.hasEagerState,eagerState:Pt.eagerState,next:null};it===null?(Ue=it=br,xe=L):it=it.next=br,Sn.lanes|=rr,Ao|=rr}Pt=Pt.next}while(Pt!==null&&Pt!==ne);it===null?xe=L:it.next=Ue,Ei(L,x.memoizedState)||(ls=!0),x.memoizedState=L,x.baseState=xe,x.baseQueue=it,j.lastRenderedState=L}if(m=j.interleaved,m!==null){V=m;do ne=V.lane,Sn.lanes|=ne,Ao|=ne,V=V.next;while(V!==m)}else V===null&&(j.lanes=0);return[x.memoizedState,j.dispatch]}function Gc(m){var x=Fs(),j=x.queue;if(j===null)throw Error(i(311));j.lastRenderedReducer=m;var L=j.dispatch,V=j.pending,ne=x.memoizedState;if(V!==null){j.pending=null;var xe=V=V.next;do ne=m(ne,xe.action),xe=xe.next;while(xe!==V);Ei(ne,x.memoizedState)||(ls=!0),x.memoizedState=ne,x.baseQueue===null&&(x.baseState=ne),j.lastRenderedState=ne}return[ne,L]}function G0(){}function V0(m,x){var j=Sn,L=Fs(),V=x(),ne=!Ei(L.memoizedState,V);if(ne&&(L.memoizedState=V,ls=!0),L=L.queue,Vf(X0.bind(null,j,L,m),[m]),L.getSnapshot!==x||ne||os!==null&&os.memoizedState.tag&1){if(j.flags|=2048,Gl(9,q0.bind(null,j,L,V,x),void 0,null),an===null)throw Error(i(349));(rl&30)!==0||K0(j,x,V)}return V}function K0(m,x,j){m.flags|=16384,m={getSnapshot:x,value:j},x=Sn.updateQueue,x===null?(x={lastEffect:null,stores:null},Sn.updateQueue=x,x.stores=[m]):(j=x.stores,j===null?x.stores=[m]:j.push(m))}function q0(m,x,j,L){x.value=j,x.getSnapshot=L,Y0(x)&&Co(m)}function X0(m,x,j){return j(function(){Y0(x)&&Co(m)})}function Y0(m){var x=m.getSnapshot;m=m.value;try{var j=x();return!Ei(m,j)}catch{return!0}}function Co(m){var x=Fi(m,1);x!==null&&Gs(x,m,1,-1)}function Hf(m){var x=Ga();return typeof m=="function"&&(m=m()),x.memoizedState=x.baseState=m,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Hl,lastRenderedState:m},x.queue=m,m=m.dispatch=dv.bind(null,Sn,m),[x.memoizedState,m]}function Gl(m,x,j,L){return m={tag:m,create:x,destroy:j,deps:L,next:null},x=Sn.updateQueue,x===null?(x={lastEffect:null,stores:null},Sn.updateQueue=x,x.lastEffect=m.next=m):(j=x.lastEffect,j===null?x.lastEffect=m.next=m:(L=j.next,j.next=m,m.next=L,x.lastEffect=m)),m}function hx(){return Fs().memoizedState}function Gf(m,x,j,L){var V=Ga();Sn.flags|=m,V.memoizedState=Gl(1|x,j,void 0,L===void 0?null:L)}function nl(m,x,j,L){var V=Fs();L=L===void 0?null:L;var ne=void 0;if(Kn!==null){var xe=Kn.memoizedState;if(ne=xe.destroy,L!==null&&zl(L,xe.deps)){V.memoizedState=Gl(x,j,ne,L);return}}Sn.flags|=m,V.memoizedState=Gl(1|x,j,ne,L)}function gx(m,x){return Gf(8390656,8,m,x)}function Vf(m,x){return nl(2048,8,m,x)}function Q0(m,x){return nl(4,2,m,x)}function hn(m,x){return nl(4,4,m,x)}function Kf(m,x){if(typeof x=="function")return m=m(),x(m),function(){x(null)};if(x!=null)return m=m(),x.current=m,function(){x.current=null}}function ud(m,x,j){return j=j!=null?j.concat([m]):null,nl(4,4,Kf.bind(null,x,m),j)}function Vl(){}function J0(m,x){var j=Fs();x=x===void 0?null:x;var L=j.memoizedState;return L!==null&&x!==null&&zl(x,L[1])?L[0]:(j.memoizedState=[m,x],m)}function qf(m,x){var j=Fs();x=x===void 0?null:x;var L=j.memoizedState;return L!==null&&x!==null&&zl(x,L[1])?L[0]:(m=m(),j.memoizedState=[m,x],m)}function Vc(m,x,j){return(rl&21)===0?(m.baseState&&(m.baseState=!1,ls=!0),m.memoizedState=j):(Ei(j,x)||(j=Ef(),Sn.lanes|=j,Ao|=j,m.baseState=!0),x)}function Xf(m,x){var j=Or;Or=j!==0&&4>j?j:4,m(!0);var L=Wl.transition;Wl.transition={};try{m(!1),x()}finally{Or=j,Wl.transition=L}}function Kl(){return Fs().memoizedState}function mx(m,x,j){var L=us(m);if(j={lane:L,action:j,hasEagerState:!1,eagerState:null,next:null},px(m))Z0(x,j);else if(j=B0(m,x,j,L),j!==null){var V=wn();Gs(j,m,L,V),dd(j,x,L)}}function dv(m,x,j){var L=us(m),V={lane:L,action:j,hasEagerState:!1,eagerState:null,next:null};if(px(m))Z0(x,V);else{var ne=m.alternate;if(m.lanes===0&&(ne===null||ne.lanes===0)&&(ne=x.lastRenderedReducer,ne!==null))try{var xe=x.lastRenderedState,Ue=ne(xe,j);if(V.hasEagerState=!0,V.eagerState=Ue,Ei(Ue,xe)){var it=x.interleaved;it===null?(V.next=V,Bf(x)):(V.next=it.next,it.next=V),x.interleaved=V;return}}catch{}finally{}j=B0(m,x,V,L),j!==null&&(V=wn(),Gs(j,m,L,V),dd(j,x,L))}}function px(m){var x=m.alternate;return m===Sn||x!==null&&x===Sn}function Z0(m,x){od=zc=!0;var j=m.pending;j===null?x.next=x:(x.next=j.next,j.next=x),m.pending=x}function dd(m,x,j){if((j&4194240)!==0){var L=x.lanes;L&=m.pendingLanes,j|=L,x.lanes=j,zi(m,j)}}var ql={readContext:za,useCallback:vs,useContext:vs,useEffect:vs,useImperativeHandle:vs,useInsertionEffect:vs,useLayoutEffect:vs,useMemo:vs,useReducer:vs,useRef:vs,useState:vs,useDebugValue:vs,useDeferredValue:vs,useTransition:vs,useMutableSource:vs,useSyncExternalStore:vs,useId:vs,unstable_isNewReconciler:!1},eg={readContext:za,useCallback:function(m,x){return Ga().memoizedState=[m,x===void 0?null:x],m},useContext:za,useEffect:gx,useImperativeHandle:function(m,x,j){return j=j!=null?j.concat([m]):null,Gf(4194308,4,Kf.bind(null,x,m),j)},useLayoutEffect:function(m,x){return Gf(4194308,4,m,x)},useInsertionEffect:function(m,x){return Gf(4,2,m,x)},useMemo:function(m,x){var j=Ga();return x=x===void 0?null:x,m=m(),j.memoizedState=[m,x],m},useReducer:function(m,x,j){var L=Ga();return x=j!==void 0?j(x):x,L.memoizedState=L.baseState=x,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:x},L.queue=m,m=m.dispatch=mx.bind(null,Sn,m),[L.memoizedState,m]},useRef:function(m){var x=Ga();return m={current:m},x.memoizedState=m},useState:Hf,useDebugValue:Vl,useDeferredValue:function(m){return Ga().memoizedState=m},useTransition:function(){var m=Hf(!1),x=m[0];return m=Xf.bind(null,m[1]),Ga().memoizedState=m,[x,m]},useMutableSource:function(){},useSyncExternalStore:function(m,x,j){var L=Sn,V=Ga();if(vn){if(j===void 0)throw Error(i(407));j=j()}else{if(j=x(),an===null)throw Error(i(349));(rl&30)!==0||K0(L,x,j)}V.memoizedState=j;var ne={value:j,getSnapshot:x};return V.queue=ne,gx(X0.bind(null,L,ne,m),[m]),L.flags|=2048,Gl(9,q0.bind(null,L,ne,j,x),void 0,null),j},useId:function(){var m=Ga(),x=an.identifierPrefix;if(vn){var j=Ni,L=ka;j=(L&~(1<<32-$s(L)-1)).toString(32)+j,x=":"+x+"R"+j,j=ld++,0<j&&(x+="H"+j.toString(32)),x+=":"}else j=Hc++,x=":"+x+"r"+j.toString(32)+":";return m.memoizedState=x},unstable_isNewReconciler:!1},tg={readContext:za,useCallback:J0,useContext:za,useEffect:Vf,useImperativeHandle:ud,useInsertionEffect:Q0,useLayoutEffect:hn,useMemo:qf,useReducer:zf,useRef:hx,useState:function(){return zf(Hl)},useDebugValue:Vl,useDeferredValue:function(m){var x=Fs();return Vc(x,Kn.memoizedState,m)},useTransition:function(){var m=zf(Hl)[0],x=Fs().memoizedState;return[m,x]},useMutableSource:G0,useSyncExternalStore:V0,useId:Kl,unstable_isNewReconciler:!1},rg={readContext:za,useCallback:J0,useContext:za,useEffect:Vf,useImperativeHandle:ud,useInsertionEffect:Q0,useLayoutEffect:hn,useMemo:qf,useReducer:Gc,useRef:hx,useState:function(){return Gc(Hl)},useDebugValue:Vl,useDeferredValue:function(m){var x=Fs();return Kn===null?x.memoizedState=m:Vc(x,Kn.memoizedState,m)},useTransition:function(){var m=Gc(Hl)[0],x=Fs().memoizedState;return[m,x]},useMutableSource:G0,useSyncExternalStore:V0,useId:Kl,unstable_isNewReconciler:!1};function Va(m,x){if(m&&m.defaultProps){x=a({},x),m=m.defaultProps;for(var j in m)x[j]===void 0&&(x[j]=m[j]);return x}return x}function ng(m,x,j,L){x=m.memoizedState,j=j(L,x),j=j==null?x:a({},x,j),m.memoizedState=j,m.lanes===0&&(m.updateQueue.baseState=j)}var fd={isMounted:function(m){return(m=m._reactInternals)?D(m)===m:!1},enqueueSetState:function(m,x,j){m=m._reactInternals;var L=wn(),V=us(m),ne=So(L,V);ne.payload=x,j!=null&&(ne.callback=j),x=ko(m,ne,V),x!==null&&(Gs(x,m,V,L),id(x,m,V))},enqueueReplaceState:function(m,x,j){m=m._reactInternals;var L=wn(),V=us(m),ne=So(L,V);ne.tag=1,ne.payload=x,j!=null&&(ne.callback=j),x=ko(m,ne,V),x!==null&&(Gs(x,m,V,L),id(x,m,V))},enqueueForceUpdate:function(m,x){m=m._reactInternals;var j=wn(),L=us(m),V=So(j,L);V.tag=2,x!=null&&(V.callback=x),x=ko(m,V,L),x!==null&&(Gs(x,m,L,j),id(x,m,L))}};function xx(m,x,j,L,V,ne,xe){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(L,ne,xe):x.prototype&&x.prototype.isPureReactComponent?!If(j,L)||!If(V,ne):!0}function yx(m,x,j){var L=!1,V=ae,ne=x.contextType;return typeof ne=="object"&&ne!==null?ne=za(ne):(V=_r(x)?Ct:Ne.current,L=x.contextTypes,ne=(L=L!=null)?Dr(m,V):ae),x=new x(j,ne),m.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=fd,m.stateNode=x,x._reactInternals=m,L&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=V,m.__reactInternalMemoizedMaskedChildContext=ne),x}function Yf(m,x,j,L){m=x.state,typeof x.componentWillReceiveProps=="function"&&x.componentWillReceiveProps(j,L),typeof x.UNSAFE_componentWillReceiveProps=="function"&&x.UNSAFE_componentWillReceiveProps(j,L),x.state!==m&&fd.enqueueReplaceState(x,x.state,null)}function Gi(m,x,j,L){var V=m.stateNode;V.props=j,V.state=m.memoizedState,V.refs={},U0(m);var ne=x.contextType;typeof ne=="object"&&ne!==null?V.context=za(ne):(ne=_r(x)?Ct:Ne.current,V.context=Dr(m,ne)),V.state=m.memoizedState,ne=x.getDerivedStateFromProps,typeof ne=="function"&&(ng(m,x,ne,j),V.state=m.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof V.getSnapshotBeforeUpdate=="function"||typeof V.UNSAFE_componentWillMount!="function"&&typeof V.componentWillMount!="function"||(x=V.state,typeof V.componentWillMount=="function"&&V.componentWillMount(),typeof V.UNSAFE_componentWillMount=="function"&&V.UNSAFE_componentWillMount(),x!==V.state&&fd.enqueueReplaceState(V,V.state,null),Zo(m,j,V,L),V.state=m.memoizedState),typeof V.componentDidMount=="function"&&(m.flags|=4194308)}function Xl(m,x){try{var j="",L=x;do j+=uv(L),L=L.return;while(L);var V=j}catch(ne){V=`
Error generating stack: `+ne.message+`
`+ne.stack}return{value:m,source:x,stack:V,digest:null}}function sl(m,x,j){return{value:m,source:null,stack:j??null,digest:x??null}}function di(m,x){try{console.error(x.value)}catch(j){setTimeout(function(){throw j})}}var hd=typeof WeakMap=="function"?WeakMap:Map;function Vi(m,x,j){j=So(-1,j),j.tag=3,j.payload={element:null};var L=x.value;return j.callback=function(){Ln||(Ln=!0,qn=L),di(m,x)},j}function Qf(m,x,j){j=So(-1,j),j.tag=3;var L=m.type.getDerivedStateFromError;if(typeof L=="function"){var V=x.value;j.payload=function(){return L(V)},j.callback=function(){di(m,x)}}var ne=m.stateNode;return ne!==null&&typeof ne.componentDidCatch=="function"&&(j.callback=function(){di(m,x),typeof L!="function"&&(Ri===null?Ri=new Set([this]):Ri.add(this));var xe=x.stack;this.componentDidCatch(x.value,{componentStack:xe!==null?xe:""})}),j}function vx(m,x,j){var L=m.pingCache;if(L===null){L=m.pingCache=new hd;var V=new Set;L.set(x,V)}else V=L.get(x),V===void 0&&(V=new Set,L.set(x,V));V.has(j)||(V.add(j),m=Ex.bind(null,m,x,j),x.then(m,m))}function wx(m){do{var x;if((x=m.tag===13)&&(x=m.memoizedState,x=x!==null?x.dehydrated!==null:!0),x)return m;m=m.return}while(m!==null);return null}function al(m,x,j,L,V){return(m.mode&1)===0?(m===x?m.flags|=65536:(m.flags|=128,j.flags|=131072,j.flags&=-52805,j.tag===1&&(j.alternate===null?j.tag=17:(x=So(-1,1),x.tag=2,ko(j,x,1))),j.lanes|=1),m):(m.flags|=65536,m.lanes=V,m)}var gd=o.ReactCurrentOwner,ls=!1;function ws(m,x,j,L){x.child=m===null?cx(x,null,j,L):Bl(x,m.child,j,L)}function Jf(m,x,j,L,V){j=j.render;var ne=x.ref;return Uc(x,V),L=cd(m,x,j,L,ne,V),j=Wf(),m!==null&&!ls?(x.updateQueue=m.updateQueue,x.flags&=-2053,m.lanes&=~V,Eo(m,x,V)):(vn&&j&&rd(x),x.flags|=1,ws(m,x,L,V),x.child)}function Yl(m,x,j,L,V){if(m===null){var ne=j.type;return typeof ne=="function"&&!ou(ne)&&ne.defaultProps===void 0&&j.compare===null&&j.defaultProps===void 0?(x.tag=15,x.type=ne,To(m,x,ne,L,V)):(m=gh(j.type,null,L,x,x.mode,V),m.ref=x.ref,m.return=x,x.child=m)}if(ne=m.child,(m.lanes&V)===0){var xe=ne.memoizedProps;if(j=j.compare,j=j!==null?j:If,j(xe,L)&&m.ref===x.ref)return Eo(m,x,V)}return x.flags|=1,m=ml(ne,L),m.ref=x.ref,m.return=x,x.child=m}function To(m,x,j,L,V){if(m!==null){var ne=m.memoizedProps;if(If(ne,L)&&m.ref===x.ref)if(ls=!1,x.pendingProps=L=ne,(m.lanes&V)!==0)(m.flags&131072)!==0&&(ls=!0);else return x.lanes=m.lanes,Eo(m,x,V)}return Ki(m,x,j,L,V)}function gn(m,x,j){var L=x.pendingProps,V=L.children,ne=m!==null?m.memoizedState:null;if(L.mode==="hidden")if((x.mode&1)===0)x.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt(dl,cs),cs|=j;else{if((j&1073741824)===0)return m=ne!==null?ne.baseLanes|j:j,x.lanes=x.childLanes=1073741824,x.memoizedState={baseLanes:m,cachePool:null,transitions:null},x.updateQueue=null,Kt(dl,cs),cs|=m,null;x.memoizedState={baseLanes:0,cachePool:null,transitions:null},L=ne!==null?ne.baseLanes:j,Kt(dl,cs),cs|=L}else ne!==null?(L=ne.baseLanes|j,x.memoizedState=null):L=j,Kt(dl,cs),cs|=L;return ws(m,x,V,j),x.child}function sn(m,x){var j=x.ref;(m===null&&j!==null||m!==null&&m.ref!==j)&&(x.flags|=512,x.flags|=2097152)}function Ki(m,x,j,L,V){var ne=_r(j)?Ct:Ne.current;return ne=Dr(x,ne),Uc(x,V),j=cd(m,x,j,L,ne,V),L=Wf(),m!==null&&!ls?(x.updateQueue=m.updateQueue,x.flags&=-2053,m.lanes&=~V,Eo(m,x,V)):(vn&&L&&rd(x),x.flags|=1,ws(m,x,j,V),x.child)}function Ps(m,x,j,L,V){if(_r(j)){var ne=!0;Us(x)}else ne=!1;if(Uc(x,V),x.stateNode===null)md(m,x),yx(x,j,L),Gi(x,j,L,V),L=!0;else if(m===null){var xe=x.stateNode,Ue=x.memoizedProps;xe.props=Ue;var it=xe.context,Pt=j.contextType;typeof Pt=="object"&&Pt!==null?Pt=za(Pt):(Pt=_r(j)?Ct:Ne.current,Pt=Dr(x,Pt));var rr=j.getDerivedStateFromProps,br=typeof rr=="function"||typeof xe.getSnapshotBeforeUpdate=="function";br||typeof xe.UNSAFE_componentWillReceiveProps!="function"&&typeof xe.componentWillReceiveProps!="function"||(Ue!==L||it!==Pt)&&Yf(x,xe,L,Pt),Ha=!1;var Yt=x.memoizedState;xe.state=Yt,Zo(x,L,xe,V),it=x.memoizedState,Ue!==L||Yt!==it||dt.current||Ha?(typeof rr=="function"&&(ng(x,j,rr,L),it=x.memoizedState),(Ue=Ha||xx(x,j,Ue,L,Yt,it,Pt))?(br||typeof xe.UNSAFE_componentWillMount!="function"&&typeof xe.componentWillMount!="function"||(typeof xe.componentWillMount=="function"&&xe.componentWillMount(),typeof xe.UNSAFE_componentWillMount=="function"&&xe.UNSAFE_componentWillMount()),typeof xe.componentDidMount=="function"&&(x.flags|=4194308)):(typeof xe.componentDidMount=="function"&&(x.flags|=4194308),x.memoizedProps=L,x.memoizedState=it),xe.props=L,xe.state=it,xe.context=Pt,L=Ue):(typeof xe.componentDidMount=="function"&&(x.flags|=4194308),L=!1)}else{xe=x.stateNode,dx(m,x),Ue=x.memoizedProps,Pt=x.type===x.elementType?Ue:Va(x.type,Ue),xe.props=Pt,br=x.pendingProps,Yt=xe.context,it=j.contextType,typeof it=="object"&&it!==null?it=za(it):(it=_r(j)?Ct:Ne.current,it=Dr(x,it));var pn=j.getDerivedStateFromProps;(rr=typeof pn=="function"||typeof xe.getSnapshotBeforeUpdate=="function")||typeof xe.UNSAFE_componentWillReceiveProps!="function"&&typeof xe.componentWillReceiveProps!="function"||(Ue!==br||Yt!==it)&&Yf(x,xe,L,it),Ha=!1,Yt=x.memoizedState,xe.state=Yt,Zo(x,L,xe,V);var tn=x.memoizedState;Ue!==br||Yt!==tn||dt.current||Ha?(typeof pn=="function"&&(ng(x,j,pn,L),tn=x.memoizedState),(Pt=Ha||xx(x,j,Pt,L,Yt,tn,it)||!1)?(rr||typeof xe.UNSAFE_componentWillUpdate!="function"&&typeof xe.componentWillUpdate!="function"||(typeof xe.componentWillUpdate=="function"&&xe.componentWillUpdate(L,tn,it),typeof xe.UNSAFE_componentWillUpdate=="function"&&xe.UNSAFE_componentWillUpdate(L,tn,it)),typeof xe.componentDidUpdate=="function"&&(x.flags|=4),typeof xe.getSnapshotBeforeUpdate=="function"&&(x.flags|=1024)):(typeof xe.componentDidUpdate!="function"||Ue===m.memoizedProps&&Yt===m.memoizedState||(x.flags|=4),typeof xe.getSnapshotBeforeUpdate!="function"||Ue===m.memoizedProps&&Yt===m.memoizedState||(x.flags|=1024),x.memoizedProps=L,x.memoizedState=tn),xe.props=L,xe.state=tn,xe.context=it,L=Pt):(typeof xe.componentDidUpdate!="function"||Ue===m.memoizedProps&&Yt===m.memoizedState||(x.flags|=4),typeof xe.getSnapshotBeforeUpdate!="function"||Ue===m.memoizedProps&&Yt===m.memoizedState||(x.flags|=1024),L=!1)}return Ws(m,x,j,L,ne,V)}function Ws(m,x,j,L,V,ne){sn(m,x);var xe=(x.flags&128)!==0;if(!L&&!xe)return V&&bn(x,j,!1),Eo(m,x,ne);L=x.stateNode,gd.current=x;var Ue=xe&&typeof j.getDerivedStateFromError!="function"?null:L.render();return x.flags|=1,m!==null&&xe?(x.child=Bl(x,m.child,null,ne),x.child=Bl(x,null,Ue,ne)):ws(m,x,Ue,ne),x.memoizedState=L.state,V&&bn(x,j,!0),x.child}function il(m){var x=m.stateNode;x.pendingContext?wo(m,x.pendingContext,x.pendingContext!==x.context):x.context&&wo(m,x.context,!1),Uf(m,x.containerInfo)}function Ql(m,x,j,L,V){return Ol(),M0(V),x.flags|=256,ws(m,x,j,L),x.child}var zs={dehydrated:null,treeContext:null,retryLane:0};function Kc(m){return{baseLanes:m,cachePool:null,transitions:null}}function sg(m,x,j){var L=x.pendingProps,V=An.current,ne=!1,xe=(x.flags&128)!==0,Ue;if((Ue=xe)||(Ue=m!==null&&m.memoizedState===null?!1:(V&2)!==0),Ue?(ne=!0,x.flags&=-129):(m===null||m.memoizedState!==null)&&(V|=1),Kt(An,V&1),m===null)return I0(x),m=x.memoizedState,m!==null&&(m=m.dehydrated,m!==null)?((x.mode&1)===0?x.lanes=1:Pr(m)?x.lanes=8:x.lanes=1073741824,null):(xe=L.children,m=L.fallback,ne?(L=x.mode,ne=x.child,xe={mode:"hidden",children:xe},(L&1)===0&&ne!==null?(ne.childLanes=0,ne.pendingProps=xe):ne=lu(xe,L,0,null),m=Rs(m,L,j,null),ne.return=x,m.return=x,ne.sibling=m,x.child=ne,x.child.memoizedState=Kc(j),x.memoizedState=zs,m):Zf(x,xe));if(V=m.memoizedState,V!==null&&(Ue=V.dehydrated,Ue!==null))return _x(m,x,xe,L,Ue,V,j);if(ne){ne=L.fallback,xe=x.mode,V=m.child,Ue=V.sibling;var it={mode:"hidden",children:L.children};return(xe&1)===0&&x.child!==V?(L=x.child,L.childLanes=0,L.pendingProps=it,x.deletions=null):(L=ml(V,it),L.subtreeFlags=V.subtreeFlags&14680064),Ue!==null?ne=ml(Ue,ne):(ne=Rs(ne,xe,j,null),ne.flags|=2),ne.return=x,L.return=x,L.sibling=ne,x.child=L,L=ne,ne=x.child,xe=m.child.memoizedState,xe=xe===null?Kc(j):{baseLanes:xe.baseLanes|j,cachePool:null,transitions:xe.transitions},ne.memoizedState=xe,ne.childLanes=m.childLanes&~j,x.memoizedState=zs,L}return ne=m.child,m=ne.sibling,L=ml(ne,{mode:"visible",children:L.children}),(x.mode&1)===0&&(L.lanes=j),L.return=x,L.sibling=null,m!==null&&(j=x.deletions,j===null?(x.deletions=[m],x.flags|=16):j.push(m)),x.child=L,x.memoizedState=null,L}function Zf(m,x){return x=lu({mode:"visible",children:x},m.mode,0,null),x.return=m,m.child=x}function Jl(m,x,j,L){return L!==null&&M0(L),Bl(x,m.child,null,j),m=Zf(x,x.pendingProps.children),m.flags|=2,x.memoizedState=null,m}function _x(m,x,j,L,V,ne,xe){if(j)return x.flags&256?(x.flags&=-257,L=sl(Error(i(422))),Jl(m,x,xe,L)):x.memoizedState!==null?(x.child=m.child,x.flags|=128,null):(ne=L.fallback,V=x.mode,L=lu({mode:"visible",children:L.children},V,0,null),ne=Rs(ne,V,xe,null),ne.flags|=2,L.return=x,ne.return=x,L.sibling=ne,x.child=L,(x.mode&1)!==0&&Bl(x,m.child,null,xe),x.child.memoizedState=Kc(xe),x.memoizedState=zs,ne);if((x.mode&1)===0)return Jl(m,x,xe,null);if(Pr(V))return L=Xr(V).digest,ne=Error(i(419)),L=sl(ne,L,void 0),Jl(m,x,xe,L);if(j=(xe&m.childLanes)!==0,ls||j){if(L=an,L!==null){switch(xe&-xe){case 4:V=2;break;case 16:V=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:V=32;break;case 536870912:V=268435456;break;default:V=0}V=(V&(L.suspendedLanes|xe))!==0?0:V,V!==0&&V!==ne.retryLane&&(ne.retryLane=V,Fi(m,V),Gs(L,m,V,-1))}return iu(),L=sl(Error(i(421))),Jl(m,x,xe,L)}return cr(V)?(x.flags|=128,x.child=m.child,x=Ax.bind(null,m),ue(V,x),null):(m=ne.treeContext,pe&&(sa=Se(V),js=x,vn=!0,ji=null,sd=!1,m!==null&&(na[Wa++]=ka,na[Wa++]=Ni,na[Wa++]=is,ka=m.id,Ni=m.overflow,is=x)),x=Zf(x,L.children),x.flags|=4096,x)}function qi(m,x,j){m.lanes|=x;var L=m.alternate;L!==null&&(L.lanes|=x),Ul(m.return,x,j)}function qc(m,x,j,L,V){var ne=m.memoizedState;ne===null?m.memoizedState={isBackwards:x,rendering:null,renderingStartTime:0,last:L,tail:j,tailMode:V}:(ne.isBackwards=x,ne.rendering=null,ne.renderingStartTime=0,ne.last=L,ne.tail=j,ne.tailMode=V)}function eh(m,x,j){var L=x.pendingProps,V=L.revealOrder,ne=L.tail;if(ws(m,x,L.children,j),L=An.current,(L&2)!==0)L=L&1|2,x.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=x.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&qi(m,j,x);else if(m.tag===19)qi(m,j,x);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===x)break e;for(;m.sibling===null;){if(m.return===null||m.return===x)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}L&=1}if(Kt(An,L),(x.mode&1)===0)x.memoizedState=null;else switch(V){case"forwards":for(j=x.child,V=null;j!==null;)m=j.alternate,m!==null&&$f(m)===null&&(V=j),j=j.sibling;j=V,j===null?(V=x.child,x.child=null):(V=j.sibling,j.sibling=null),qc(x,!1,V,j,ne);break;case"backwards":for(j=null,V=x.child,x.child=null;V!==null;){if(m=V.alternate,m!==null&&$f(m)===null){x.child=V;break}m=V.sibling,V.sibling=j,j=V,V=m}qc(x,!0,j,null,ne);break;case"together":qc(x,!1,null,null,void 0);break;default:x.memoizedState=null}return x.child}function md(m,x){(x.mode&1)===0&&m!==null&&(m.alternate=null,x.alternate=null,x.flags|=2)}function Eo(m,x,j){if(m!==null&&(x.dependencies=m.dependencies),Ao|=x.lanes,(j&x.childLanes)===0)return null;if(m!==null&&x.child!==m.child)throw Error(i(153));if(x.child!==null){for(m=x.child,j=ml(m,m.pendingProps),x.child=j,j.return=x;m.sibling!==null;)m=m.sibling,j=j.sibling=ml(m,m.pendingProps),j.return=x;j.sibling=null}return x.child}function ol(m,x,j){switch(x.tag){case 3:il(x),Ol();break;case 5:$0(x);break;case 1:_r(x.type)&&Us(x);break;case 4:Uf(x,x.stateNode.containerInfo);break;case 10:ux(x,x.type._context,x.memoizedProps.value);break;case 13:var L=x.memoizedState;if(L!==null)return L.dehydrated!==null?(Kt(An,An.current&1),x.flags|=128,null):(j&x.child.childLanes)!==0?sg(m,x,j):(Kt(An,An.current&1),m=Eo(m,x,j),m!==null?m.sibling:null);Kt(An,An.current&1);break;case 19:if(L=(j&x.childLanes)!==0,(m.flags&128)!==0){if(L)return eh(m,x,j);x.flags|=128}var V=x.memoizedState;if(V!==null&&(V.rendering=null,V.tail=null,V.lastEffect=null),Kt(An,An.current),L)break;return null;case 22:case 23:return x.lanes=0,gn(m,x,j)}return Eo(m,x,j)}function aa(m){m.flags|=4}function Zl(m,x){if(m!==null&&m.child===x.child)return!0;if((x.flags&16)!==0)return!1;for(m=x.child;m!==null;){if((m.flags&12854)!==0||(m.subtreeFlags&12854)!==0)return!1;m=m.sibling}return!0}var ll,cl,ia,oa;if(Oe)ll=function(m,x){for(var j=x.child;j!==null;){if(j.tag===5||j.tag===6)O(m,j.stateNode);else if(j.tag!==4&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===x)break;for(;j.sibling===null;){if(j.return===null||j.return===x)return;j=j.return}j.sibling.return=j.return,j=j.sibling}},cl=function(){},ia=function(m,x,j,L,V){if(m=m.memoizedProps,m!==L){var ne=x.stateNode,xe=ui(ci.current);j=Y(ne,j,m,L,V,xe),(x.updateQueue=j)&&aa(x)}},oa=function(m,x,j,L){j!==L&&aa(x)};else if(fe){ll=function(m,x,j,L){for(var V=x.child;V!==null;){if(V.tag===5){var ne=V.stateNode;j&&L&&(ne=qt(ne,V.type,V.memoizedProps,V)),O(m,ne)}else if(V.tag===6)ne=V.stateNode,j&&L&&(ne=Vt(ne,V.memoizedProps,V)),O(m,ne);else if(V.tag!==4){if(V.tag===22&&V.memoizedState!==null)ne=V.child,ne!==null&&(ne.return=V),ll(m,V,!0,!0);else if(V.child!==null){V.child.return=V,V=V.child;continue}}if(V===x)break;for(;V.sibling===null;){if(V.return===null||V.return===x)return;V=V.return}V.sibling.return=V.return,V=V.sibling}};var ul=function(m,x,j,L){for(var V=x.child;V!==null;){if(V.tag===5){var ne=V.stateNode;j&&L&&(ne=qt(ne,V.type,V.memoizedProps,V)),St(m,ne)}else if(V.tag===6)ne=V.stateNode,j&&L&&(ne=Vt(ne,V.memoizedProps,V)),St(m,ne);else if(V.tag!==4){if(V.tag===22&&V.memoizedState!==null)ne=V.child,ne!==null&&(ne.return=V),ul(m,V,!0,!0);else if(V.child!==null){V.child.return=V,V=V.child;continue}}if(V===x)break;for(;V.sibling===null;){if(V.return===null||V.return===x)return;V=V.return}V.sibling.return=V.return,V=V.sibling}};cl=function(m,x){var j=x.stateNode;if(!Zl(m,x)){m=j.containerInfo;var L=$e(m);ul(L,x,!1,!1),j.pendingChildren=L,aa(x),ct(m,L)}},ia=function(m,x,j,L,V){var ne=m.stateNode,xe=m.memoizedProps;if((m=Zl(m,x))&&xe===L)x.stateNode=ne;else{var Ue=x.stateNode,it=ui(ci.current),Pt=null;xe!==L&&(Pt=Y(Ue,j,xe,L,V,it)),m&&Pt===null?x.stateNode=ne:(ne=_e(ne,Pt,j,xe,L,x,m,Ue),z(ne,j,L,V,it)&&aa(x),x.stateNode=ne,m?aa(x):ll(ne,x,!1,!1))}},oa=function(m,x,j,L){j!==L?(m=ui(tl.current),j=ui(ci.current),x.stateNode=te(L,m,j,x),aa(x)):x.stateNode=m.stateNode}}else cl=function(){},ia=function(){},oa=function(){};function Ka(m,x){if(!vn)switch(m.tailMode){case"hidden":x=m.tail;for(var j=null;x!==null;)x.alternate!==null&&(j=x),x=x.sibling;j===null?m.tail=null:j.sibling=null;break;case"collapsed":j=m.tail;for(var L=null;j!==null;)j.alternate!==null&&(L=j),j=j.sibling;L===null?x||m.tail===null?m.tail=null:m.tail.sibling=null:L.sibling=null}}function kn(m){var x=m.alternate!==null&&m.alternate.child===m.child,j=0,L=0;if(x)for(var V=m.child;V!==null;)j|=V.lanes|V.childLanes,L|=V.subtreeFlags&14680064,L|=V.flags&14680064,V.return=m,V=V.sibling;else for(V=m.child;V!==null;)j|=V.lanes|V.childLanes,L|=V.subtreeFlags,L|=V.flags,V.return=m,V=V.sibling;return m.subtreeFlags|=L,m.childLanes=j,x}function ec(m,x,j){var L=x.pendingProps;switch(nd(x),x.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kn(x),null;case 1:return _r(x.type)&&fn(),kn(x),null;case 3:return j=x.stateNode,$l(),er(dt),er(Ne),H0(),j.pendingContext&&(j.context=j.pendingContext,j.pendingContext=null),(m===null||m.child===null)&&(Df(x)?aa(x):m===null||m.memoizedState.isDehydrated&&(x.flags&256)===0||(x.flags|=1024,ji!==null&&(fh(ji),ji=null))),cl(m,x),kn(x),null;case 5:W0(x),j=ui(tl.current);var V=x.type;if(m!==null&&x.stateNode!=null)ia(m,x,V,L,j),m.ref!==x.ref&&(x.flags|=512,x.flags|=2097152);else{if(!L){if(x.stateNode===null)throw Error(i(166));return kn(x),null}if(m=ui(ci.current),Df(x)){if(!pe)throw Error(i(175));m=Ee(x.stateNode,x.type,x.memoizedProps,j,m,x,!sd),x.updateQueue=m,m!==null&&aa(x)}else{var ne=H(V,L,j,m,x);ll(ne,x,!1,!1),x.stateNode=ne,z(ne,V,L,j,m)&&aa(x)}x.ref!==null&&(x.flags|=512,x.flags|=2097152)}return kn(x),null;case 6:if(m&&x.stateNode!=null)oa(m,x,m.memoizedProps,L);else{if(typeof L!="string"&&x.stateNode===null)throw Error(i(166));if(m=ui(tl.current),j=ui(ci.current),Df(x)){if(!pe)throw Error(i(176));if(m=x.stateNode,j=x.memoizedProps,(L=We(m,j,x,!sd))&&(V=js,V!==null))switch(V.tag){case 3:Be(V.stateNode.containerInfo,m,j,(V.mode&1)!==0);break;case 5:be(V.type,V.memoizedProps,V.stateNode,m,j,(V.mode&1)!==0)}L&&aa(x)}else x.stateNode=te(L,m,j,x)}return kn(x),null;case 13:if(er(An),L=x.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(vn&&sa!==null&&(x.mode&1)!==0&&(x.flags&128)===0)ix(),Ol(),x.flags|=98560,V=!1;else if(V=Df(x),L!==null&&L.dehydrated!==null){if(m===null){if(!V)throw Error(i(318));if(!pe)throw Error(i(344));if(V=x.memoizedState,V=V!==null?V.dehydrated:null,!V)throw Error(i(317));ut(V,x)}else Ol(),(x.flags&128)===0&&(x.memoizedState=null),x.flags|=4;kn(x),V=!1}else ji!==null&&(fh(ji),ji=null),V=!0;if(!V)return x.flags&65536?x:null}return(x.flags&128)!==0?(x.lanes=j,x):(j=L!==null,j!==(m!==null&&m.memoizedState!==null)&&j&&(x.child.flags|=8192,(x.mode&1)!==0&&(m===null||(An.current&1)!==0?Tn===0&&(Tn=3):iu())),x.updateQueue!==null&&(x.flags|=4),kn(x),null);case 4:return $l(),cl(m,x),m===null&&Ye(x.stateNode.containerInfo),kn(x),null;case 10:return ad(x.type._context),kn(x),null;case 17:return _r(x.type)&&fn(),kn(x),null;case 19:if(er(An),V=x.memoizedState,V===null)return kn(x),null;if(L=(x.flags&128)!==0,ne=V.rendering,ne===null)if(L)Ka(V,!1);else{if(Tn!==0||m!==null&&(m.flags&128)!==0)for(m=x.child;m!==null;){if(ne=$f(m),ne!==null){for(x.flags|=128,Ka(V,!1),m=ne.updateQueue,m!==null&&(x.updateQueue=m,x.flags|=4),x.subtreeFlags=0,m=j,j=x.child;j!==null;)L=j,V=m,L.flags&=14680066,ne=L.alternate,ne===null?(L.childLanes=0,L.lanes=V,L.child=null,L.subtreeFlags=0,L.memoizedProps=null,L.memoizedState=null,L.updateQueue=null,L.dependencies=null,L.stateNode=null):(L.childLanes=ne.childLanes,L.lanes=ne.lanes,L.child=ne.child,L.subtreeFlags=0,L.deletions=null,L.memoizedProps=ne.memoizedProps,L.memoizedState=ne.memoizedState,L.updateQueue=ne.updateQueue,L.type=ne.type,V=ne.dependencies,L.dependencies=V===null?null:{lanes:V.lanes,firstContext:V.firstContext}),j=j.sibling;return Kt(An,An.current&1|2),x.child}m=m.sibling}V.tail!==null&&ys()>bd&&(x.flags|=128,L=!0,Ka(V,!1),x.lanes=4194304)}else{if(!L)if(m=$f(ne),m!==null){if(x.flags|=128,L=!0,m=m.updateQueue,m!==null&&(x.updateQueue=m,x.flags|=4),Ka(V,!0),V.tail===null&&V.tailMode==="hidden"&&!ne.alternate&&!vn)return kn(x),null}else 2*ys()-V.renderingStartTime>bd&&j!==1073741824&&(x.flags|=128,L=!0,Ka(V,!1),x.lanes=4194304);V.isBackwards?(ne.sibling=x.child,x.child=ne):(m=V.last,m!==null?m.sibling=ne:x.child=ne,V.last=ne)}return V.tail!==null?(x=V.tail,V.rendering=x,V.tail=x.sibling,V.renderingStartTime=ys(),x.sibling=null,m=An.current,Kt(An,L?m&1|2:m&1),x):(kn(x),null);case 22:case 23:return hh(),j=x.memoizedState!==null,m!==null&&m.memoizedState!==null!==j&&(x.flags|=8192),j&&(x.mode&1)!==0?(cs&1073741824)!==0&&(kn(x),Oe&&x.subtreeFlags&6&&(x.flags|=8192)):kn(x),null;case 24:return null;case 25:return null}throw Error(i(156,x.tag))}function bx(m,x){switch(nd(x),x.tag){case 1:return _r(x.type)&&fn(),m=x.flags,m&65536?(x.flags=m&-65537|128,x):null;case 3:return $l(),er(dt),er(Ne),H0(),m=x.flags,(m&65536)!==0&&(m&128)===0?(x.flags=m&-65537|128,x):null;case 5:return W0(x),null;case 13:if(er(An),m=x.memoizedState,m!==null&&m.dehydrated!==null){if(x.alternate===null)throw Error(i(340));Ol()}return m=x.flags,m&65536?(x.flags=m&-65537|128,x):null;case 19:return er(An),null;case 4:return $l(),null;case 10:return ad(x.type._context),null;case 22:case 23:return hh(),null;case 24:return null;default:return null}}var Xc=!1,_s=!1,qa=typeof WeakSet=="function"?WeakSet:Set,Gt=null;function en(m,x){var j=m.ref;if(j!==null)if(typeof j=="function")try{j(null)}catch(L){_n(m,x,L)}else j.current=null}function Xa(m,x,j){try{j()}catch(L){_n(m,x,L)}}var ag=!1;function Sx(m,x){for(B(m.containerInfo),Gt=x;Gt!==null;)if(m=Gt,x=m.child,(m.subtreeFlags&1028)!==0&&x!==null)x.return=m,Gt=x;else for(;Gt!==null;){m=Gt;try{var j=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var L=j.memoizedProps,V=j.memoizedState,ne=m.stateNode,xe=ne.getSnapshotBeforeUpdate(m.elementType===m.type?L:Va(m.type,L),V);ne.__reactInternalSnapshotBeforeUpdate=xe}break;case 3:Oe&&he(m.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(Ue){_n(m,m.return,Ue)}if(x=m.sibling,x!==null){x.return=m.return,Gt=x;break}Gt=m.return}return j=ag,ag=!1,j}function tc(m,x,j){var L=x.updateQueue;if(L=L!==null?L.lastEffect:null,L!==null){var V=L=L.next;do{if((V.tag&m)===m){var ne=V.destroy;V.destroy=void 0,ne!==void 0&&Xa(x,j,ne)}V=V.next}while(V!==L)}}function Yc(m,x){if(x=x.updateQueue,x=x!==null?x.lastEffect:null,x!==null){var j=x=x.next;do{if((j.tag&m)===m){var L=j.create;j.destroy=L()}j=j.next}while(j!==x)}}function th(m){var x=m.ref;if(x!==null){var j=m.stateNode;switch(m.tag){case 5:m=re(j);break;default:m=j}typeof x=="function"?x(m):x.current=m}}function pd(m){var x=m.alternate;x!==null&&(m.alternate=null,pd(x)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(x=m.stateNode,x!==null&&Ve(x)),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function ig(m){return m.tag===5||m.tag===3||m.tag===4}function rc(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||ig(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function xd(m,x,j){var L=m.tag;if(L===5||L===6)m=m.stateNode,x?Ie(j,m,x):pt(j,m);else if(L!==4&&(m=m.child,m!==null))for(xd(m,x,j),m=m.sibling;m!==null;)xd(m,x,j),m=m.sibling}function og(m,x,j){var L=m.tag;if(L===5||L===6)m=m.stateNode,x?Ht(j,m,x):qe(j,m);else if(L!==4&&(m=m.child,m!==null))for(og(m,x,j),m=m.sibling;m!==null;)og(m,x,j),m=m.sibling}var $n=null,Ta=!1;function Pi(m,x,j){for(j=j.child;j!==null;)rh(m,x,j),j=j.sibling}function rh(m,x,j){if(Sa&&typeof Sa.onCommitFiberUnmount=="function")try{Sa.onCommitFiberUnmount(Yo,j)}catch{}switch(j.tag){case 5:_s||en(j,x);case 6:if(Oe){var L=$n,V=Ta;$n=null,Pi(m,x,j),$n=L,Ta=V,$n!==null&&(Ta?gt($n,j.stateNode):at($n,j.stateNode))}else Pi(m,x,j);break;case 18:Oe&&$n!==null&&(Ta?we($n,j.stateNode):ce($n,j.stateNode));break;case 4:Oe?(L=$n,V=Ta,$n=j.stateNode.containerInfo,Ta=!0,Pi(m,x,j),$n=L,Ta=V):(fe&&(L=j.stateNode.containerInfo,V=$e(L),zt(L,V)),Pi(m,x,j));break;case 0:case 11:case 14:case 15:if(!_s&&(L=j.updateQueue,L!==null&&(L=L.lastEffect,L!==null))){V=L=L.next;do{var ne=V,xe=ne.destroy;ne=ne.tag,xe!==void 0&&((ne&2)!==0||(ne&4)!==0)&&Xa(j,x,xe),V=V.next}while(V!==L)}Pi(m,x,j);break;case 1:if(!_s&&(en(j,x),L=j.stateNode,typeof L.componentWillUnmount=="function"))try{L.props=j.memoizedProps,L.state=j.memoizedState,L.componentWillUnmount()}catch(Ue){_n(j,x,Ue)}Pi(m,x,j);break;case 21:Pi(m,x,j);break;case 22:j.mode&1?(_s=(L=_s)||j.memoizedState!==null,Pi(m,x,j),_s=L):Pi(m,x,j);break;default:Pi(m,x,j)}}function nc(m){var x=m.updateQueue;if(x!==null){m.updateQueue=null;var j=m.stateNode;j===null&&(j=m.stateNode=new qa),x.forEach(function(L){var V=fv.bind(null,m,L);j.has(L)||(j.add(L),L.then(V,V))})}}function fi(m,x){var j=x.deletions;if(j!==null)for(var L=0;L<j.length;L++){var V=j[L];try{var ne=m,xe=x;if(Oe){var Ue=xe;e:for(;Ue!==null;){switch(Ue.tag){case 5:$n=Ue.stateNode,Ta=!1;break e;case 3:$n=Ue.stateNode.containerInfo,Ta=!0;break e;case 4:$n=Ue.stateNode.containerInfo,Ta=!0;break e}Ue=Ue.return}if($n===null)throw Error(i(160));rh(ne,xe,V),$n=null,Ta=!1}else rh(ne,xe,V);var it=V.alternate;it!==null&&(it.return=null),V.return=null}catch(Pt){_n(V,x,Pt)}}if(x.subtreeFlags&12854)for(x=x.child;x!==null;)yd(x,m),x=x.sibling}function yd(m,x){var j=m.alternate,L=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:if(fi(x,m),Ya(m),L&4){try{tc(3,m,m.return),Yc(3,m)}catch(Yt){_n(m,m.return,Yt)}try{tc(5,m,m.return)}catch(Yt){_n(m,m.return,Yt)}}break;case 1:fi(x,m),Ya(m),L&512&&j!==null&&en(j,j.return);break;case 5:if(fi(x,m),Ya(m),L&512&&j!==null&&en(j,j.return),Oe){if(m.flags&32){var V=m.stateNode;try{At(V)}catch(Yt){_n(m,m.return,Yt)}}if(L&4&&(V=m.stateNode,V!=null)){var ne=m.memoizedProps;if(j=j!==null?j.memoizedProps:ne,L=m.type,x=m.updateQueue,m.updateQueue=null,x!==null)try{Lt(V,x,L,j,ne,m)}catch(Yt){_n(m,m.return,Yt)}}}break;case 6:if(fi(x,m),Ya(m),L&4&&Oe){if(m.stateNode===null)throw Error(i(162));V=m.stateNode,ne=m.memoizedProps,j=j!==null?j.memoizedProps:ne;try{lt(V,j,ne)}catch(Yt){_n(m,m.return,Yt)}}break;case 3:if(fi(x,m),Ya(m),L&4){if(Oe&&pe&&j!==null&&j.memoizedState.isDehydrated)try{le(x.containerInfo)}catch(Yt){_n(m,m.return,Yt)}if(fe){V=x.containerInfo,ne=x.pendingChildren;try{zt(V,ne)}catch(Yt){_n(m,m.return,Yt)}}}break;case 4:if(fi(x,m),Ya(m),L&4&&fe){ne=m.stateNode,V=ne.containerInfo,ne=ne.pendingChildren;try{zt(V,ne)}catch(Yt){_n(m,m.return,Yt)}}break;case 13:fi(x,m),Ya(m),V=m.child,V.flags&8192&&(ne=V.memoizedState!==null,V.stateNode.isHidden=ne,!ne||V.alternate!==null&&V.alternate.memoizedState!==null||(ru=ys())),L&4&&nc(m);break;case 22:var xe=j!==null&&j.memoizedState!==null;if(m.mode&1?(_s=(j=_s)||xe,fi(x,m),_s=j):fi(x,m),Ya(m),L&8192){if(j=m.memoizedState!==null,(m.stateNode.isHidden=j)&&!xe&&(m.mode&1)!==0)for(Gt=m,L=m.child;L!==null;){for(x=Gt=L;Gt!==null;){xe=Gt;var Ue=xe.child;switch(xe.tag){case 0:case 11:case 14:case 15:tc(4,xe,xe.return);break;case 1:en(xe,xe.return);var it=xe.stateNode;if(typeof it.componentWillUnmount=="function"){var Pt=xe,rr=xe.return;try{var br=Pt;it.props=br.memoizedProps,it.state=br.memoizedState,it.componentWillUnmount()}catch(Yt){_n(Pt,rr,Yt)}}break;case 5:en(xe,xe.return);break;case 22:if(xe.memoizedState!==null){ah(x);continue}}Ue!==null?(Ue.return=xe,Gt=Ue):ah(x)}L=L.sibling}if(Oe){e:if(L=null,Oe)for(x=m;;){if(x.tag===5){if(L===null){L=x;try{V=x.stateNode,j?Ot(V):Ae(x.stateNode,x.memoizedProps)}catch(Yt){_n(m,m.return,Yt)}}}else if(x.tag===6){if(L===null)try{ne=x.stateNode,j?Jt(ne):ye(ne,x.memoizedProps)}catch(Yt){_n(m,m.return,Yt)}}else if((x.tag!==22&&x.tag!==23||x.memoizedState===null||x===m)&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===m)break e;for(;x.sibling===null;){if(x.return===null||x.return===m)break e;L===x&&(L=null),x=x.return}L===x&&(L=null),x.sibling.return=x.return,x=x.sibling}}}break;case 19:fi(x,m),Ya(m),L&4&&nc(m);break;case 21:break;default:fi(x,m),Ya(m)}}function Ya(m){var x=m.flags;if(x&2){try{if(Oe){e:{for(var j=m.return;j!==null;){if(ig(j)){var L=j;break e}j=j.return}throw Error(i(160))}switch(L.tag){case 5:var V=L.stateNode;L.flags&32&&(At(V),L.flags&=-33);var ne=rc(m);og(m,ne,V);break;case 3:case 4:var xe=L.stateNode.containerInfo,Ue=rc(m);xd(m,Ue,xe);break;default:throw Error(i(161))}}}catch(it){_n(m,m.return,it)}m.flags&=-3}x&4096&&(m.flags&=-4097)}function Qc(m,x,j){Gt=m,nh(m)}function nh(m,x,j){for(var L=(m.mode&1)!==0;Gt!==null;){var V=Gt,ne=V.child;if(V.tag===22&&L){var xe=V.memoizedState!==null||Xc;if(!xe){var Ue=V.alternate,it=Ue!==null&&Ue.memoizedState!==null||_s;Ue=Xc;var Pt=_s;if(Xc=xe,(_s=it)&&!Pt)for(Gt=V;Gt!==null;)xe=Gt,it=xe.child,xe.tag===22&&xe.memoizedState!==null?ih(V):it!==null?(it.return=xe,Gt=it):ih(V);for(;ne!==null;)Gt=ne,nh(ne),ne=ne.sibling;Gt=V,Xc=Ue,_s=Pt}sh(m)}else(V.subtreeFlags&8772)!==0&&ne!==null?(ne.return=V,Gt=ne):sh(m)}}function sh(m){for(;Gt!==null;){var x=Gt;if((x.flags&8772)!==0){var j=x.alternate;try{if((x.flags&8772)!==0)switch(x.tag){case 0:case 11:case 15:_s||Yc(5,x);break;case 1:var L=x.stateNode;if(x.flags&4&&!_s)if(j===null)L.componentDidMount();else{var V=x.elementType===x.type?j.memoizedProps:Va(x.type,j.memoizedProps);L.componentDidUpdate(V,j.memoizedState,L.__reactInternalSnapshotBeforeUpdate)}var ne=x.updateQueue;ne!==null&&fx(x,ne,L);break;case 3:var xe=x.updateQueue;if(xe!==null){if(j=null,x.child!==null)switch(x.child.tag){case 5:j=re(x.child.stateNode);break;case 1:j=x.child.stateNode}fx(x,xe,j)}break;case 5:var Ue=x.stateNode;j===null&&x.flags&4&&wt(Ue,x.type,x.memoizedProps,x);break;case 6:break;case 4:break;case 12:break;case 13:if(pe&&x.memoizedState===null){var it=x.alternate;if(it!==null){var Pt=it.memoizedState;if(Pt!==null){var rr=Pt.dehydrated;rr!==null&&se(rr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}_s||x.flags&512&&th(x)}catch(br){_n(x,x.return,br)}}if(x===m){Gt=null;break}if(j=x.sibling,j!==null){j.return=x.return,Gt=j;break}Gt=x.return}}function ah(m){for(;Gt!==null;){var x=Gt;if(x===m){Gt=null;break}var j=x.sibling;if(j!==null){j.return=x.return,Gt=j;break}Gt=x.return}}function ih(m){for(;Gt!==null;){var x=Gt;try{switch(x.tag){case 0:case 11:case 15:var j=x.return;try{Yc(4,x)}catch(it){_n(x,j,it)}break;case 1:var L=x.stateNode;if(typeof L.componentDidMount=="function"){var V=x.return;try{L.componentDidMount()}catch(it){_n(x,V,it)}}var ne=x.return;try{th(x)}catch(it){_n(x,ne,it)}break;case 5:var xe=x.return;try{th(x)}catch(it){_n(x,xe,it)}}}catch(it){_n(x,x.return,it)}if(x===m){Gt=null;break}var Ue=x.sibling;if(Ue!==null){Ue.return=x.return,Gt=Ue;break}Gt=x.return}}var No=0,la=1,Xi=2,Jc=3,vd=4;if(typeof Symbol=="function"&&Symbol.for){var Qa=Symbol.for;No=Qa("selector.component"),la=Qa("selector.has_pseudo_class"),Xi=Qa("selector.role"),Jc=Qa("selector.test_id"),vd=Qa("selector.text")}function Yi(m){var x=He(m);if(x!=null){if(typeof x.memoizedProps["data-testname"]!="string")throw Error(i(364));return x}if(m=De(m),m===null)throw Error(i(362));return m.stateNode.current}function wd(m,x){switch(x.$$typeof){case No:if(m.type===x.value)return!0;break;case la:e:{x=x.value,m=[m,0];for(var j=0;j<m.length;){var L=m[j++],V=m[j++],ne=x[V];if(L.tag!==5||!ht(L)){for(;ne!=null&&wd(L,ne);)V++,ne=x[V];if(V===x.length){x=!0;break e}else for(L=L.child;L!==null;)m.push(L,V),L=L.sibling}}x=!1}return x;case Xi:if(m.tag===5&&It(m.stateNode,x.value))return!0;break;case vd:if((m.tag===5||m.tag===6)&&(m=_t(m),m!==null&&0<=m.indexOf(x.value)))return!0;break;case Jc:if(m.tag===5&&(m=m.memoizedProps["data-testname"],typeof m=="string"&&m.toLowerCase()===x.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function oh(m){switch(m.$$typeof){case No:return"<"+(R(m.value)||"Unknown")+">";case la:return":has("+(oh(m)||"")+")";case Xi:return'[role="'+m.value+'"]';case vd:return'"'+m.value+'"';case Jc:return'[data-testname="'+m.value+'"]';default:throw Error(i(365))}}function Qi(m,x){var j=[];m=[m,0];for(var L=0;L<m.length;){var V=m[L++],ne=m[L++],xe=x[ne];if(V.tag!==5||!ht(V)){for(;xe!=null&&wd(V,xe);)ne++,xe=x[ne];if(ne===x.length)j.push(V);else for(V=V.child;V!==null;)m.push(V,ne),V=V.sibling}}return j}function Ji(m,x){if(!Le)throw Error(i(363));m=Yi(m),m=Qi(m,x),x=[],m=Array.from(m);for(var j=0;j<m.length;){var L=m[j++];if(L.tag===5)ht(L)||x.push(L.stateNode);else for(L=L.child;L!==null;)m.push(L),L=L.sibling}return x}var lh=Math.ceil,_d=o.ReactCurrentDispatcher,Zc=o.ReactCurrentOwner,On=o.ReactCurrentBatchConfig,kr=0,an=null,Cn=null,Wn=0,cs=0,dl=hr(0),Tn=0,eu=null,Ao=0,mn=0,tu=0,sc=null,Hs=null,ru=0,bd=1/0,ca=null;function nn(){bd=ys()+500}var Ln=!1,qn=null,Ri=null,fl=!1,hi=null,ch=0,Xn=0,Sd=null,nu=-1,su=0;function wn(){return(kr&6)!==0?ys():nu!==-1?nu:nu=ys()}function us(m){return(m.mode&1)===0?1:(kr&2)!==0&&Wn!==0?Wn&-Wn:cv.transition!==null?(su===0&&(su=Ef()),su):(m=Or,m!==0?m:ot())}function Gs(m,x,j,L){if(50<Xn)throw Xn=0,Sd=null,Error(i(185));li(m,j,L),((kr&2)===0||m!==an)&&(m===an&&((kr&2)===0&&(mn|=j),Tn===4&&jo(m,Wn)),Vs(m,L),j===1&&kr===0&&(x.mode&1)===0&&(nn(),Oc&&As()))}function Vs(m,x){var j=m.callbackNode;Zp(m,x);var L=Rc(m,m===an?Wn:0);if(L===0)j!==null&&ex(j),m.callbackNode=null,m.callbackPriority=0;else if(x=L&-L,m.callbackPriority!==x){if(j!=null&&ex(j),x===1)m.tag===0?rx(lg.bind(null,m)):Pf(lg.bind(null,m)),Rt?tt(function(){(kr&6)===0&&As()}):Hi(Nf,As),j=null;else{switch(Ic(L)){case 1:j=Nf;break;case 4:j=Af;break;case 16:j=jf;break;case 536870912:j=lv;break;default:j=jf}j=mg(j,uh.bind(null,m))}m.callbackPriority=x,m.callbackNode=j}}function uh(m,x){if(nu=-1,su=0,(kr&6)!==0)throw Error(i(327));var j=m.callbackNode;if(Fo()&&m.callbackNode!==j)return null;var L=Rc(m,m===an?Wn:0);if(L===0)return null;if((L&30)!==0||(L&m.expiredLanes)!==0||x)x=ac(m,L);else{x=L;var V=kr;kr|=2;var ne=ug();(an!==m||Wn!==x)&&(ca=null,nn(),hl(m,x));do try{dg();break}catch(Ue){au(m,Ue)}while(!0);L0(),_d.current=ne,kr=V,Cn!==null?x=0:(an=null,Wn=0,x=Tn)}if(x!==0){if(x===2&&(V=Tf(m),V!==0&&(L=V,x=dh(m,V))),x===1)throw j=eu,hl(m,0),jo(m,L),Vs(m,ys()),j;if(x===6)jo(m,L);else{if(V=m.current.alternate,(L&30)===0&&!kx(V)&&(x=ac(m,L),x===2&&(ne=Tf(m),ne!==0&&(L=ne,x=dh(m,ne))),x===1))throw j=eu,hl(m,0),jo(m,L),Vs(m,ys()),j;switch(m.finishedWork=V,m.finishedLanes=L,x){case 0:case 1:throw Error(i(345));case 2:gl(m,Hs,ca);break;case 3:if(jo(m,L),(L&130023424)===L&&(x=ru+500-ys(),10<x)){if(Rc(m,0)!==0)break;if(V=m.suspendedLanes,(V&L)!==L){wn(),m.pingedLanes|=m.suspendedLanes&V;break}m.timeoutHandle=ee(gl.bind(null,m,Hs,ca),x);break}gl(m,Hs,ca);break;case 4:if(jo(m,L),(L&4194240)===L)break;for(x=m.eventTimes,V=-1;0<L;){var xe=31-$s(L);ne=1<<xe,xe=x[xe],xe>V&&(V=xe),L&=~ne}if(L=V,L=ys()-L,L=(120>L?120:480>L?480:1080>L?1080:1920>L?1920:3e3>L?3e3:4320>L?4320:1960*lh(L/1960))-L,10<L){m.timeoutHandle=ee(gl.bind(null,m,Hs,ca),L);break}gl(m,Hs,ca);break;case 5:gl(m,Hs,ca);break;default:throw Error(i(329))}}}return Vs(m,ys()),m.callbackNode===j?uh.bind(null,m):null}function dh(m,x){var j=sc;return m.current.memoizedState.isDehydrated&&(hl(m,x).flags|=256),m=ac(m,x),m!==2&&(x=Hs,Hs=j,x!==null&&fh(x)),m}function fh(m){Hs===null?Hs=m:Hs.push.apply(Hs,m)}function kx(m){for(var x=m;;){if(x.flags&16384){var j=x.updateQueue;if(j!==null&&(j=j.stores,j!==null))for(var L=0;L<j.length;L++){var V=j[L],ne=V.getSnapshot;V=V.value;try{if(!Ei(ne(),V))return!1}catch{return!1}}}if(j=x.child,x.subtreeFlags&16384&&j!==null)j.return=x,x=j;else{if(x===m)break;for(;x.sibling===null;){if(x.return===null||x.return===m)return!0;x=x.return}x.sibling.return=x.return,x=x.sibling}}return!0}function jo(m,x){for(x&=~tu,x&=~mn,m.suspendedLanes|=x,m.pingedLanes&=~x,m=m.expirationTimes;0<x;){var j=31-$s(x),L=1<<j;m[j]=-1,x&=~L}}function lg(m){if((kr&6)!==0)throw Error(i(327));Fo();var x=Rc(m,0);if((x&1)===0)return Vs(m,ys()),null;var j=ac(m,x);if(m.tag!==0&&j===2){var L=Tf(m);L!==0&&(x=L,j=dh(m,L))}if(j===1)throw j=eu,hl(m,0),jo(m,x),Vs(m,ys()),j;if(j===6)throw Error(i(345));return m.finishedWork=m.current.alternate,m.finishedLanes=x,gl(m,Hs,ca),Vs(m,ys()),null}function cg(m){hi!==null&&hi.tag===0&&(kr&6)===0&&Fo();var x=kr;kr|=1;var j=On.transition,L=Or;try{if(On.transition=null,Or=1,m)return m()}finally{Or=L,On.transition=j,kr=x,(kr&6)===0&&As()}}function hh(){cs=dl.current,er(dl)}function hl(m,x){m.finishedWork=null,m.finishedLanes=0;var j=m.timeoutHandle;if(j!==me&&(m.timeoutHandle=me,ie(j)),Cn!==null)for(j=Cn.return;j!==null;){var L=j;switch(nd(L),L.tag){case 1:L=L.type.childContextTypes,L!=null&&fn();break;case 3:$l(),er(dt),er(Ne),H0();break;case 5:W0(L);break;case 4:$l();break;case 13:er(An);break;case 19:er(An);break;case 10:ad(L.type._context);break;case 22:case 23:hh()}j=j.return}if(an=m,Cn=m=ml(m.current,null),Wn=cs=x,Tn=0,eu=null,tu=mn=Ao=0,Hs=sc=null,Jo!==null){for(x=0;x<Jo.length;x++)if(j=Jo[x],L=j.interleaved,L!==null){j.interleaved=null;var V=L.next,ne=j.pending;if(ne!==null){var xe=ne.next;ne.next=V,L.next=xe}j.pending=L}Jo=null}return m}function au(m,x){do{var j=Cn;try{if(L0(),Ca.current=ql,zc){for(var L=Sn.memoizedState;L!==null;){var V=L.queue;V!==null&&(V.pending=null),L=L.next}zc=!1}if(rl=0,os=Kn=Sn=null,od=!1,ld=0,Zc.current=null,j===null||j.return===null){Tn=1,eu=x,Cn=null;break}e:{var ne=m,xe=j.return,Ue=j,it=x;if(x=Wn,Ue.flags|=32768,it!==null&&typeof it=="object"&&typeof it.then=="function"){var Pt=it,rr=Ue,br=rr.tag;if((rr.mode&1)===0&&(br===0||br===11||br===15)){var Yt=rr.alternate;Yt?(rr.updateQueue=Yt.updateQueue,rr.memoizedState=Yt.memoizedState,rr.lanes=Yt.lanes):(rr.updateQueue=null,rr.memoizedState=null)}var pn=wx(xe);if(pn!==null){pn.flags&=-257,al(pn,xe,Ue,ne,x),pn.mode&1&&vx(ne,Pt,x),x=pn,it=Pt;var tn=x.updateQueue;if(tn===null){var ua=new Set;ua.add(it),x.updateQueue=ua}else tn.add(it);break e}else{if((x&1)===0){vx(ne,Pt,x),iu();break e}it=Error(i(426))}}else if(vn&&Ue.mode&1){var Zi=wx(xe);if(Zi!==null){(Zi.flags&65536)===0&&(Zi.flags|=256),al(Zi,xe,Ue,ne,x),M0(Xl(it,Ue));break e}}ne=it=Xl(it,Ue),Tn!==4&&(Tn=2),sc===null?sc=[ne]:sc.push(ne),ne=xe;do{switch(ne.tag){case 3:ne.flags|=65536,x&=-x,ne.lanes|=x;var et=Vi(ne,it,x);$c(ne,et);break e;case 1:Ue=it;var ze=ne.type,ft=ne.stateNode;if((ne.flags&128)===0&&(typeof ze.getDerivedStateFromError=="function"||ft!==null&&typeof ft.componentDidCatch=="function"&&(Ri===null||!Ri.has(ft)))){ne.flags|=65536,x&=-x,ne.lanes|=x;var Qt=Qf(ne,Ue,x);$c(ne,Qt);break e}}ne=ne.return}while(ne!==null)}hg(j)}catch(or){x=or,Cn===j&&j!==null&&(Cn=j=j.return);continue}break}while(!0)}function ug(){var m=_d.current;return _d.current=ql,m===null?ql:m}function iu(){(Tn===0||Tn===3||Tn===2)&&(Tn=4),an===null||(Ao&268435455)===0&&(mn&268435455)===0||jo(an,Wn)}function ac(m,x){var j=kr;kr|=2;var L=ug();(an!==m||Wn!==x)&&(ca=null,hl(m,x));do try{Cx();break}catch(V){au(m,V)}while(!0);if(L0(),kr=j,_d.current=L,Cn!==null)throw Error(i(261));return an=null,Wn=0,Tn}function Cx(){for(;Cn!==null;)fg(Cn)}function dg(){for(;Cn!==null&&!tx();)fg(Cn)}function fg(m){var x=jx(m.alternate,m,cs);m.memoizedProps=m.pendingProps,x===null?hg(m):Cn=x,Zc.current=null}function hg(m){var x=m;do{var j=x.alternate;if(m=x.return,(x.flags&32768)===0){if(j=ec(j,x,cs),j!==null){Cn=j;return}}else{if(j=bx(j,x),j!==null){j.flags&=32767,Cn=j;return}if(m!==null)m.flags|=32768,m.subtreeFlags=0,m.deletions=null;else{Tn=6,Cn=null;return}}if(x=x.sibling,x!==null){Cn=x;return}Cn=x=m}while(x!==null);Tn===0&&(Tn=5)}function gl(m,x,j){var L=Or,V=On.transition;try{On.transition=null,Or=1,Tx(m,x,j,L)}finally{On.transition=V,Or=L}return null}function Tx(m,x,j,L){do Fo();while(hi!==null);if((kr&6)!==0)throw Error(i(327));j=m.finishedWork;var V=m.finishedLanes;if(j===null)return null;if(m.finishedWork=null,m.finishedLanes=0,j===m.current)throw Error(i(177));m.callbackNode=null,m.callbackPriority=0;var ne=j.lanes|j.childLanes;if(Xo(m,ne),m===an&&(Cn=an=null,Wn=0),(j.subtreeFlags&2064)===0&&(j.flags&2064)===0||fl||(fl=!0,mg(jf,function(){return Fo(),null})),ne=(j.flags&15990)!==0,(j.subtreeFlags&15990)!==0||ne){ne=On.transition,On.transition=null;var xe=Or;Or=1;var Ue=kr;kr|=4,Zc.current=null,Sx(m,j),yd(j,m),G(m.containerInfo),m.current=j,Qc(j),ed(),kr=Ue,Or=xe,On.transition=ne}else m.current=j;if(fl&&(fl=!1,hi=m,ch=V),ne=m.pendingLanes,ne===0&&(Ri=null),Mc(j.stateNode),Vs(m,ys()),x!==null)for(L=m.onRecoverableError,j=0;j<x.length;j++)V=x[j],L(V.value,{componentStack:V.stack,digest:V.digest});if(Ln)throw Ln=!1,m=qn,qn=null,m;return(ch&1)!==0&&m.tag!==0&&Fo(),ne=m.pendingLanes,(ne&1)!==0?m===Sd?Xn++:(Xn=0,Sd=m):Xn=0,As(),null}function Fo(){if(hi!==null){var m=Ic(ch),x=On.transition,j=Or;try{if(On.transition=null,Or=16>m?16:m,hi===null)var L=!1;else{if(m=hi,hi=null,ch=0,(kr&6)!==0)throw Error(i(331));var V=kr;for(kr|=4,Gt=m.current;Gt!==null;){var ne=Gt,xe=ne.child;if((Gt.flags&16)!==0){var Ue=ne.deletions;if(Ue!==null){for(var it=0;it<Ue.length;it++){var Pt=Ue[it];for(Gt=Pt;Gt!==null;){var rr=Gt;switch(rr.tag){case 0:case 11:case 15:tc(8,rr,ne)}var br=rr.child;if(br!==null)br.return=rr,Gt=br;else for(;Gt!==null;){rr=Gt;var Yt=rr.sibling,pn=rr.return;if(pd(rr),rr===Pt){Gt=null;break}if(Yt!==null){Yt.return=pn,Gt=Yt;break}Gt=pn}}}var tn=ne.alternate;if(tn!==null){var ua=tn.child;if(ua!==null){tn.child=null;do{var Zi=ua.sibling;ua.sibling=null,ua=Zi}while(ua!==null)}}Gt=ne}}if((ne.subtreeFlags&2064)!==0&&xe!==null)xe.return=ne,Gt=xe;else e:for(;Gt!==null;){if(ne=Gt,(ne.flags&2048)!==0)switch(ne.tag){case 0:case 11:case 15:tc(9,ne,ne.return)}var et=ne.sibling;if(et!==null){et.return=ne.return,Gt=et;break e}Gt=ne.return}}var ze=m.current;for(Gt=ze;Gt!==null;){xe=Gt;var ft=xe.child;if((xe.subtreeFlags&2064)!==0&&ft!==null)ft.return=xe,Gt=ft;else e:for(xe=ze;Gt!==null;){if(Ue=Gt,(Ue.flags&2048)!==0)try{switch(Ue.tag){case 0:case 11:case 15:Yc(9,Ue)}}catch(or){_n(Ue,Ue.return,or)}if(Ue===xe){Gt=null;break e}var Qt=Ue.sibling;if(Qt!==null){Qt.return=Ue.return,Gt=Qt;break e}Gt=Ue.return}}if(kr=V,As(),Sa&&typeof Sa.onPostCommitFiberRoot=="function")try{Sa.onPostCommitFiberRoot(Yo,m)}catch{}L=!0}return L}finally{Or=j,On.transition=x}}return!1}function gg(m,x,j){x=Xl(j,x),x=Vi(m,x,1),m=ko(m,x,1),x=wn(),m!==null&&(li(m,1,x),Vs(m,x))}function _n(m,x,j){if(m.tag===3)gg(m,m,j);else for(;x!==null;){if(x.tag===3){gg(x,m,j);break}else if(x.tag===1){var L=x.stateNode;if(typeof x.type.getDerivedStateFromError=="function"||typeof L.componentDidCatch=="function"&&(Ri===null||!Ri.has(L))){m=Xl(j,m),m=Qf(x,m,1),x=ko(x,m,1),m=wn(),x!==null&&(li(x,1,m),Vs(x,m));break}}x=x.return}}function Ex(m,x,j){var L=m.pingCache;L!==null&&L.delete(x),x=wn(),m.pingedLanes|=m.suspendedLanes&j,an===m&&(Wn&j)===j&&(Tn===4||Tn===3&&(Wn&130023424)===Wn&&500>ys()-ru?hl(m,0):tu|=j),Vs(m,x)}function Nx(m,x){x===0&&((m.mode&1)===0?x=1:(x=Zu,Zu<<=1,(Zu&130023424)===0&&(Zu=4194304)));var j=wn();m=Fi(m,x),m!==null&&(li(m,x,j),Vs(m,j))}function Ax(m){var x=m.memoizedState,j=0;x!==null&&(j=x.retryLane),Nx(m,j)}function fv(m,x){var j=0;switch(m.tag){case 13:var L=m.stateNode,V=m.memoizedState;V!==null&&(j=V.retryLane);break;case 19:L=m.stateNode;break;default:throw Error(i(314))}L!==null&&L.delete(x),Nx(m,j)}var jx;jx=function(m,x,j){if(m!==null)if(m.memoizedProps!==x.pendingProps||dt.current)ls=!0;else{if((m.lanes&j)===0&&(x.flags&128)===0)return ls=!1,ol(m,x,j);ls=(m.flags&131072)!==0}else ls=!1,vn&&(x.flags&1048576)!==0&&nx(x,Ml,x.index);switch(x.lanes=0,x.tag){case 2:var L=x.type;md(m,x),m=x.pendingProps;var V=Dr(x,Ne.current);Uc(x,j),V=cd(null,x,L,m,V,j);var ne=Wf();return x.flags|=1,typeof V=="object"&&V!==null&&typeof V.render=="function"&&V.$$typeof===void 0?(x.tag=1,x.memoizedState=null,x.updateQueue=null,_r(L)?(ne=!0,Us(x)):ne=!1,x.memoizedState=V.state!==null&&V.state!==void 0?V.state:null,U0(x),V.updater=fd,x.stateNode=V,V._reactInternals=x,Gi(x,L,m,j),x=Ws(null,x,L,!0,ne,j)):(x.tag=0,vn&&ne&&rd(x),ws(null,x,V,j),x=x.child),x;case 16:L=x.elementType;e:{switch(md(m,x),m=x.pendingProps,V=L._init,L=V(L._payload),x.type=L,V=x.tag=hv(L),m=Va(L,m),V){case 0:x=Ki(null,x,L,m,j);break e;case 1:x=Ps(null,x,L,m,j);break e;case 11:x=Jf(null,x,L,m,j);break e;case 14:x=Yl(null,x,L,Va(L.type,m),j);break e}throw Error(i(306,L,""))}return x;case 0:return L=x.type,V=x.pendingProps,V=x.elementType===L?V:Va(L,V),Ki(m,x,L,V,j);case 1:return L=x.type,V=x.pendingProps,V=x.elementType===L?V:Va(L,V),Ps(m,x,L,V,j);case 3:e:{if(il(x),m===null)throw Error(i(387));L=x.pendingProps,ne=x.memoizedState,V=ne.element,dx(m,x),Zo(x,L,null,j);var xe=x.memoizedState;if(L=xe.element,pe&&ne.isDehydrated)if(ne={element:L,isDehydrated:!1,cache:xe.cache,pendingSuspenseBoundaries:xe.pendingSuspenseBoundaries,transitions:xe.transitions},x.updateQueue.baseState=ne,x.memoizedState=ne,x.flags&256){V=Xl(Error(i(423)),x),x=Ql(m,x,L,j,V);break e}else if(L!==V){V=Xl(Error(i(424)),x),x=Ql(m,x,L,j,V);break e}else for(pe&&(sa=ve(x.stateNode.containerInfo),js=x,vn=!0,ji=null,sd=!1),j=cx(x,null,L,j),x.child=j;j;)j.flags=j.flags&-3|4096,j=j.sibling;else{if(Ol(),L===V){x=Eo(m,x,j);break e}ws(m,x,L,j)}x=x.child}return x;case 5:return $0(x),m===null&&I0(x),L=x.type,V=x.pendingProps,ne=m!==null?m.memoizedProps:null,xe=V.children,J(L,V)?xe=null:ne!==null&&J(L,ne)&&(x.flags|=32),sn(m,x),ws(m,x,xe,j),x.child;case 6:return m===null&&I0(x),null;case 13:return sg(m,x,j);case 4:return Uf(x,x.stateNode.containerInfo),L=x.pendingProps,m===null?x.child=Bl(x,null,L,j):ws(m,x,L,j),x.child;case 11:return L=x.type,V=x.pendingProps,V=x.elementType===L?V:Va(L,V),Jf(m,x,L,V,j);case 7:return ws(m,x,x.pendingProps,j),x.child;case 8:return ws(m,x,x.pendingProps.children,j),x.child;case 12:return ws(m,x,x.pendingProps.children,j),x.child;case 10:e:{if(L=x.type._context,V=x.pendingProps,ne=x.memoizedProps,xe=V.value,ux(x,L,xe),ne!==null)if(Ei(ne.value,xe)){if(ne.children===V.children&&!dt.current){x=Eo(m,x,j);break e}}else for(ne=x.child,ne!==null&&(ne.return=x);ne!==null;){var Ue=ne.dependencies;if(Ue!==null){xe=ne.child;for(var it=Ue.firstContext;it!==null;){if(it.context===L){if(ne.tag===1){it=So(-1,j&-j),it.tag=2;var Pt=ne.updateQueue;if(Pt!==null){Pt=Pt.shared;var rr=Pt.pending;rr===null?it.next=it:(it.next=rr.next,rr.next=it),Pt.pending=it}}ne.lanes|=j,it=ne.alternate,it!==null&&(it.lanes|=j),Ul(ne.return,j,x),Ue.lanes|=j;break}it=it.next}}else if(ne.tag===10)xe=ne.type===x.type?null:ne.child;else if(ne.tag===18){if(xe=ne.return,xe===null)throw Error(i(341));xe.lanes|=j,Ue=xe.alternate,Ue!==null&&(Ue.lanes|=j),Ul(xe,j,x),xe=ne.sibling}else xe=ne.child;if(xe!==null)xe.return=ne;else for(xe=ne;xe!==null;){if(xe===x){xe=null;break}if(ne=xe.sibling,ne!==null){ne.return=xe.return,xe=ne;break}xe=xe.return}ne=xe}ws(m,x,V.children,j),x=x.child}return x;case 9:return V=x.type,L=x.pendingProps.children,Uc(x,j),V=za(V),L=L(V),x.flags|=1,ws(m,x,L,j),x.child;case 14:return L=x.type,V=Va(L,x.pendingProps),V=Va(L.type,V),Yl(m,x,L,V,j);case 15:return To(m,x,x.type,x.pendingProps,j);case 17:return L=x.type,V=x.pendingProps,V=x.elementType===L?V:Va(L,V),md(m,x),x.tag=1,_r(L)?(m=!0,Us(x)):m=!1,Uc(x,j),yx(x,L,V),Gi(x,L,V,j),Ws(null,x,L,!0,m,j);case 19:return eh(m,x,j);case 22:return gn(m,x,j)}throw Error(i(156,x.tag))};function mg(m,x){return Hi(m,x)}function Fx(m,x,j,L){this.tag=m,this.key=j,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=x,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=L,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ja(m,x,j,L){return new Fx(m,x,j,L)}function ou(m){return m=m.prototype,!(!m||!m.isReactComponent)}function hv(m){if(typeof m=="function")return ou(m)?1:0;if(m!=null){if(m=m.$$typeof,m===w)return 11;if(m===k)return 14}return 2}function ml(m,x){var j=m.alternate;return j===null?(j=Ja(m.tag,x,m.key,m.mode),j.elementType=m.elementType,j.type=m.type,j.stateNode=m.stateNode,j.alternate=m,m.alternate=j):(j.pendingProps=x,j.type=m.type,j.flags=0,j.subtreeFlags=0,j.deletions=null),j.flags=m.flags&14680064,j.childLanes=m.childLanes,j.lanes=m.lanes,j.child=m.child,j.memoizedProps=m.memoizedProps,j.memoizedState=m.memoizedState,j.updateQueue=m.updateQueue,x=m.dependencies,j.dependencies=x===null?null:{lanes:x.lanes,firstContext:x.firstContext},j.sibling=m.sibling,j.index=m.index,j.ref=m.ref,j}function gh(m,x,j,L,V,ne){var xe=2;if(L=m,typeof m=="function")ou(m)&&(xe=1);else if(typeof m=="string")xe=5;else e:switch(m){case f:return Rs(j.children,V,ne,x);case p:xe=8,V|=8;break;case g:return m=Ja(12,j,x,V|2),m.elementType=g,m.lanes=ne,m;case b:return m=Ja(13,j,x,V),m.elementType=b,m.lanes=ne,m;case E:return m=Ja(19,j,x,V),m.elementType=E,m.lanes=ne,m;case N:return lu(j,V,ne,x);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case y:xe=10;break e;case v:xe=9;break e;case w:xe=11;break e;case k:xe=14;break e;case _:xe=16,L=null;break e}throw Error(i(130,m==null?m:typeof m,""))}return x=Ja(xe,j,x,V),x.elementType=m,x.type=L,x.lanes=ne,x}function Rs(m,x,j,L){return m=Ja(7,m,L,x),m.lanes=j,m}function lu(m,x,j,L){return m=Ja(22,m,L,x),m.elementType=N,m.lanes=j,m.stateNode={isHidden:!1},m}function cu(m,x,j){return m=Ja(6,m,null,x),m.lanes=j,m}function mh(m,x,j){return x=Ja(4,m.children!==null?m.children:[],m.key,x),x.lanes=j,x.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},x}function Px(m,x,j,L,V){this.tag=x,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=me,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Dc(0),this.expirationTimes=Dc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Dc(0),this.identifierPrefix=L,this.onRecoverableError=V,pe&&(this.mutableSourceEagerHydrationData=null)}function pg(m,x,j,L,V,ne,xe,Ue,it){return m=new Px(m,x,j,Ue,it),x===1?(x=1,ne===!0&&(x|=8)):x=0,ne=Ja(3,null,null,x),m.current=ne,ne.stateNode=m,ne.memoizedState={element:L,isDehydrated:j,cache:null,transitions:null,pendingSuspenseBoundaries:null},U0(ne),m}function ph(m){if(!m)return ae;m=m._reactInternals;e:{if(D(m)!==m||m.tag!==1)throw Error(i(170));var x=m;do{switch(x.tag){case 3:x=x.stateNode.context;break e;case 1:if(_r(x.type)){x=x.stateNode.__reactInternalMemoizedMergedChildContext;break e}}x=x.return}while(x!==null);throw Error(i(171))}if(m.tag===1){var j=m.type;if(_r(j))return oi(m,j,x)}return x}function ic(m){var x=m._reactInternals;if(x===void 0)throw typeof m.render=="function"?Error(i(188)):(m=Object.keys(m).join(","),Error(i(268,m)));return m=X(x),m===null?null:m.stateNode}function xh(m,x){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var j=m.retryLane;m.retryLane=j!==0&&j<x?j:x}}function uu(m,x){xh(m,x),(m=m.alternate)&&xh(m,x)}function gv(m){return m=X(m),m===null?null:m.stateNode}function Rx(){return null}return r.attemptContinuousHydration=function(m){if(m.tag===13){var x=Fi(m,134217728);if(x!==null){var j=wn();Gs(x,m,134217728,j)}uu(m,134217728)}},r.attemptDiscreteHydration=function(m){if(m.tag===13){var x=Fi(m,1);if(x!==null){var j=wn();Gs(x,m,1,j)}uu(m,1)}},r.attemptHydrationAtCurrentPriority=function(m){if(m.tag===13){var x=us(m),j=Fi(m,x);if(j!==null){var L=wn();Gs(j,m,x,L)}uu(m,x)}},r.attemptSynchronousHydration=function(m){switch(m.tag){case 3:var x=m.stateNode;if(x.current.memoizedState.isDehydrated){var j=Pc(x.pendingLanes);j!==0&&(zi(x,j|1),Vs(x,ys()),(kr&6)===0&&(nn(),As()))}break;case 13:cg(function(){var L=Fi(m,1);if(L!==null){var V=wn();Gs(L,m,1,V)}}),uu(m,1)}},r.batchedUpdates=function(m,x){var j=kr;kr|=1;try{return m(x)}finally{kr=j,kr===0&&(nn(),Oc&&As())}},r.createComponentSelector=function(m){return{$$typeof:No,value:m}},r.createContainer=function(m,x,j,L,V,ne,xe){return pg(m,x,!1,null,j,L,V,ne,xe)},r.createHasPseudoClassSelector=function(m){return{$$typeof:la,value:m}},r.createHydrationContainer=function(m,x,j,L,V,ne,xe,Ue,it){return m=pg(j,L,!0,m,V,ne,xe,Ue,it),m.context=ph(null),j=m.current,L=wn(),V=us(j),ne=So(L,V),ne.callback=x??null,ko(j,ne,V),m.current.lanes=V,li(m,V,L),Vs(m,L),m},r.createPortal=function(m,x,j){var L=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:d,key:L==null?null:""+L,children:m,containerInfo:x,implementation:j}},r.createRoleSelector=function(m){return{$$typeof:Xi,value:m}},r.createTestNameSelector=function(m){return{$$typeof:Jc,value:m}},r.createTextSelector=function(m){return{$$typeof:vd,value:m}},r.deferredUpdates=function(m){var x=Or,j=On.transition;try{return On.transition=null,Or=16,m()}finally{Or=x,On.transition=j}},r.discreteUpdates=function(m,x,j,L,V){var ne=Or,xe=On.transition;try{return On.transition=null,Or=1,m(x,j,L,V)}finally{Or=ne,On.transition=xe,kr===0&&nn()}},r.findAllNodes=Ji,r.findBoundingRects=function(m,x){if(!Le)throw Error(i(363));x=Ji(m,x),m=[];for(var j=0;j<x.length;j++)m.push(Je(x[j]));for(x=m.length-1;0<x;x--){j=m[x];for(var L=j.x,V=L+j.width,ne=j.y,xe=ne+j.height,Ue=x-1;0<=Ue;Ue--)if(x!==Ue){var it=m[Ue],Pt=it.x,rr=Pt+it.width,br=it.y,Yt=br+it.height;if(L>=Pt&&ne>=br&&V<=rr&&xe<=Yt){m.splice(x,1);break}else if(L!==Pt||j.width!==it.width||Yt<ne||br>xe){if(!(ne!==br||j.height!==it.height||rr<L||Pt>V)){Pt>L&&(it.width+=Pt-L,it.x=L),rr<V&&(it.width=V-Pt),m.splice(x,1);break}}else{br>ne&&(it.height+=br-ne,it.y=ne),Yt<xe&&(it.height=xe-br),m.splice(x,1);break}}}return m},r.findHostInstance=ic,r.findHostInstanceWithNoPortals=function(m){return m=K(m),m=m!==null?oe(m):null,m===null?null:m.stateNode},r.findHostInstanceWithWarning=function(m){return ic(m)},r.flushControlled=function(m){var x=kr;kr|=1;var j=On.transition,L=Or;try{On.transition=null,Or=1,m()}finally{Or=L,On.transition=j,kr=x,kr===0&&(nn(),As())}},r.flushPassiveEffects=Fo,r.flushSync=cg,r.focusWithin=function(m,x){if(!Le)throw Error(i(363));for(m=Yi(m),x=Qi(m,x),x=Array.from(x),m=0;m<x.length;){var j=x[m++];if(!ht(j)){if(j.tag===5&&Mt(j.stateNode))return!0;for(j=j.child;j!==null;)x.push(j),j=j.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Or},r.getFindAllNodesFailureDescription=function(m,x){if(!Le)throw Error(i(363));var j=0,L=[];m=[Yi(m),0];for(var V=0;V<m.length;){var ne=m[V++],xe=m[V++],Ue=x[xe];if((ne.tag!==5||!ht(ne))&&(wd(ne,Ue)&&(L.push(oh(Ue)),xe++,xe>j&&(j=xe)),xe<x.length))for(ne=ne.child;ne!==null;)m.push(ne,xe),ne=ne.sibling}if(j<x.length){for(m=[];j<x.length;j++)m.push(oh(x[j]));return`findAllNodes was able to match part of the selector:
  `+(L.join(" > ")+`

No matching component was found for:
  `)+m.join(" > ")}return null},r.getPublicRootInstance=function(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 5:return re(m.child.stateNode);default:return m.child.stateNode}},r.injectIntoDevTools=function(m){if(m={bundleType:m.bundleType,version:m.version,rendererPackageName:m.rendererPackageName,rendererConfig:m.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:gv,findFiberByHostInstance:m.findFiberByHostInstance||Rx,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")m=!1;else{var x=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(x.isDisabled||!x.supportsFiber)m=!0;else{try{Yo=x.inject(m),Sa=x}catch{}m=!!x.checkDCE}}return m},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(m,x,j,L){if(!Le)throw Error(i(363));m=Ji(m,x);var V=rt(m,j,L).disconnect;return{disconnect:function(){V()}}},r.registerMutableSourceForHydration=function(m,x){var j=x._getVersion;j=j(x._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[x,j]:m.mutableSourceEagerHydrationData.push(x,j)},r.runWithPriority=function(m,x){var j=Or;try{return Or=m,x()}finally{Or=j}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(m,x,j,L){var V=x.current,ne=wn(),xe=us(V);return j=ph(j),x.context===null?x.context=j:x.pendingContext=j,x=So(ne,xe),x.payload={element:m},L=L===void 0?null:L,L!==null&&(x.callback=L),m=ko(V,x,xe),m!==null&&(Gs(m,V,xe,ne),id(m,V,xe)),xe},r}),mw}var t4;function oO(){return t4||(t4=1,gw.exports=iO()),gw.exports}var lO=oO();const cO=_p(lO);var pw={exports:{}},vu={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r4;function uO(){return r4||(r4=1,vu.ConcurrentRoot=1,vu.ContinuousEventPriority=4,vu.DefaultEventPriority=16,vu.DiscreteEventPriority=1,vu.IdleEventPriority=536870912,vu.LegacyRoot=0),vu}var n4;function dO(){return n4||(n4=1,pw.exports=uO()),pw.exports}var N6=dO(),fO=Mr();const s4={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let a4=!1,i4=!1;const ob=".react-konva-event";let A6=!1;function hO(e){A6=e}const gO=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,mO=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,pO={};function Dy(e,t,r=pO){if(!a4&&"zIndex"in t&&(console.warn(mO),a4=!0),!i4&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(gO),i4=!0)}for(var a in r)if(!s4[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var d=!t.hasOwnProperty(a);d&&e.setAttr(a,void 0)}var f=A6||t._useStrictMode,p={},g=!1;const y={};for(var a in t)if(!s4[a]){var i=a.slice(0,2)==="on",v=r[a]!==t[a];if(i&&v){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(y[c]=t[a])}!i&&(t[a]!==r[a]||f&&t[a]!==e.getAttr(a))&&(g=!0,p[a]=t[a])}g&&(e.setAttrs(p),Gu(e));for(var c in y)e.on(c+ob,y[c])}function Gu(e){if(!fO.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var xw=y2();const j6={},xO={};Qm.Node.prototype._applyProps=Dy;function yO(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),Gu(e)}function vO(e,t,r){let n=Qm[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=Qm.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return Dy(c,a),c}function wO(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function _O(e,t,r){return!1}function bO(e){return e}function SO(){return null}function kO(){return null}function CO(e,t,r,n){return xO}function TO(){}function EO(e){}function NO(e,t){return!1}function AO(){return j6}function jO(){return j6}const FO=setTimeout,PO=clearTimeout,RO=-1;function DO(e,t){return!1}const IO=!1,MO=!0,OO=!0;function LO(e,t){t.parent===e?t.moveToTop():e.add(t),Gu(e)}function BO(e,t){t.parent===e?t.moveToTop():e.add(t),Gu(e)}function F6(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),Gu(e)}function UO(e,t,r){F6(e,t,r)}function $O(e,t){t.destroy(),t.off(ob),Gu(e)}function WO(e,t){t.destroy(),t.off(ob),Gu(e)}function zO(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function HO(e,t,r){}function GO(e,t,r,n,s){Dy(e,s,n)}function VO(e){e.hide(),Gu(e)}function KO(e){}function qO(e,t){(t.visible==null||t.visible)&&e.show()}function XO(e,t){}function YO(e){}function QO(){}const JO=()=>N6.DefaultEventPriority,ZO=Object.freeze(Object.defineProperty({__proto__:null,appendChild:LO,appendChildToContainer:BO,appendInitialChild:yO,cancelTimeout:PO,clearContainer:YO,commitMount:HO,commitTextUpdate:zO,commitUpdate:GO,createInstance:vO,createTextInstance:wO,detachDeletedInstance:QO,finalizeInitialChildren:_O,getChildHostContext:jO,getCurrentEventPriority:JO,getPublicInstance:bO,getRootHostContext:AO,hideInstance:VO,hideTextInstance:KO,idlePriority:xw.unstable_IdlePriority,insertBefore:F6,insertInContainerBefore:UO,isPrimaryRenderer:IO,noTimeout:RO,now:xw.unstable_now,prepareForCommit:SO,preparePortalMount:kO,prepareUpdate:CO,removeChild:$O,removeChildFromContainer:WO,resetAfterCommit:TO,resetTextContent:EO,run:xw.unstable_runWithPriority,scheduleTimeout:FO,shouldDeprioritizeSubtree:NO,shouldSetTextContent:DO,supportsMutation:OO,unhideInstance:qO,unhideTextInstance:XO,warnsIfNotActing:MO},Symbol.toStringTag,{value:"Module"}));var eL=Object.defineProperty,tL=Object.defineProperties,rL=Object.getOwnPropertyDescriptors,o4=Object.getOwnPropertySymbols,nL=Object.prototype.hasOwnProperty,sL=Object.prototype.propertyIsEnumerable,l4=(e,t,r)=>t in e?eL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c4=(e,t)=>{for(var r in t||(t={}))nL.call(t,r)&&l4(e,r,t[r]);if(o4)for(var r of o4(t))sL.call(t,r)&&l4(e,r,t[r]);return e},aL=(e,t)=>tL(e,rL(t)),u4,d4;typeof window<"u"&&((u4=window.document)!=null&&u4.createElement||((d4=window.navigator)==null?void 0:d4.product)==="ReactNative")?C.useLayoutEffect:C.useEffect;function P6(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=P6(n,t,r);if(s)return s;n=n.sibling}}function R6(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const f4=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=f4;return}return f4.apply(this,arguments)};const lb=R6(C.createContext(null));class D6 extends C.Component{render(){return C.createElement(lb.Provider,{value:this._reactInternals},this.props.children)}}function iL(){const e=C.useContext(lb);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=C.useId();return C.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=P6(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function oL(){const e=iL(),[t]=C.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==lb&&!t.has(s)&&t.set(s,C.useContext(R6(s)))}r=r.return}return t}function I6(){const e=oL();return C.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>C.createElement(t,null,C.createElement(r.Provider,aL(c4({},n),{value:e.get(r)}))),t=>C.createElement(D6,c4({},t))),[e])}function lL(e){const t=es.useRef({});return es.useLayoutEffect(()=>{t.current=e}),es.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const cL=e=>{const t=es.useRef(null),r=es.useRef(null),n=es.useRef(null),s=lL(e),a=I6(),i=o=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(o):c.current=o)};return es.useLayoutEffect(()=>(r.current=new Qm.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=Uh.createContainer(r.current,N6.LegacyRoot,!1,null),Uh.updateContainer(es.createElement(a,{},e.children),n.current),()=>{Qm.isBrowser&&(i(null),Uh.updateContainer(null,n.current,null),r.current.destroy())}),[]),es.useLayoutEffect(()=>{i(r.current),Dy(r.current,e,s),Uh.updateContainer(es.createElement(a,{},e.children),n.current,null)}),es.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},Yd="Layer",uL="FastLayer",Uo="Group",dL="Label",ea="Rect",ju="Circle",fL="Ellipse",hL="Wedge",ma="Line",gL="Sprite",M6="Image",Sl="Text",mL="TextPath",pL="Star",xL="Ring",yL="Arc",vL="Tag",wL="Path",_L="RegularPolygon",k_="Arrow",bL="Shape",O6="Transformer",SL="18.2.13",Uh=cO(ZO);Uh.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:es.version,rendererPackageName:"react-konva"});const Qd=es.forwardRef((e,t)=>es.createElement(D6,{},es.createElement(cL,{...e,forwardedRef:t}))),kL=hO,CL=Object.freeze(Object.defineProperty({__proto__:null,Arc:yL,Arrow:k_,Circle:ju,Ellipse:fL,FastLayer:uL,Group:Uo,Image:M6,KonvaRenderer:Uh,Label:dL,Layer:Yd,Line:ma,Path:wL,Rect:ea,RegularPolygon:_L,Ring:xL,Shape:bL,Sprite:gL,Stage:Qd,Star:pL,Tag:vL,Text:Sl,TextPath:mL,Transformer:O6,Wedge:hL,useContextBridge:I6,useStrictMode:kL,version:SL},Symbol.toStringTag,{value:"Module"})),bt=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return l.jsx(Xe.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},TL=({children:e,className:t=""})=>l.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),EL=({children:e,className:t=""})=>l.jsx("h3",{className:`text-xl font-semibold text-gray-800 ${t}`,children:e}),NL=({children:e,className:t=""})=>l.jsx("div",{className:`py-4 ${t}`,children:e}),AL=({children:e,className:t=""})=>l.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});bt.Header=TL;bt.Title=EL;bt.Body=NL;bt.Footer=AL;const jL=e=>{const[t,r]=C.useState({width:800,height:600}),n=C.useRef(null),s=C.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let c=a,d=c/o;d>i&&(d=i,c=d*o),r({width:c,height:d})}},[e]);return C.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},C_={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,c=(t.width-i)/2,d=(t.height-o)/2;return{x:c,y:d,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},FL=(e,t)=>{const[r,n]=C.useState(null),s=C.useCallback((a,i)=>C_.calculateImageInfo(a,i),[]);return C.useEffect(()=>{if(e&&t){const a=s(e,t);n(a)}},[e,t,s]),r},PL=e=>{const t=C.useCallback((n,s)=>C_.convertToOriginal(n,s,e),[e]),r=C.useCallback((n,s)=>C_.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},fm={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},Ah={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,c=i.y+i.height/2,d=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-c,2));d<=n&&d<a&&(a=d,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>Ah.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},yw={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},RL={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null}},DL=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},IL=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,c]=C.useReducer(DL,RL),{showNotification:d}=ba(),{makeAuthenticatedRequest:f}=Wi(),{user:p}=Mn(),g=C.useRef(null),y=C.useRef(null),v=C.useRef(null),w=C.useRef({}),b=C.useRef({}),{canvasSize:E,stageRef:k}=jL(g),_=FL(o.canvas.image,E),{convertToOriginal:N}=PL(_);C.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:E})},[E]),C.useEffect(()=>{_&&c({type:"SET_IMAGE_INFO",payload:_})},[_]),C.useEffect(()=>{const q=v.current;if(!q)return;const re=o.ui.selectedBlock?.id?w.current[o.ui.selectedBlock.id]:null;re?(q.nodes([re]),q.getLayer()?.batchDraw()):(q.nodes([]),q.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const A=C.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),P=C.useCallback(q=>{const re=q.target.files[0];if(!re||!re.type.startsWith("image/")){d("Please select a valid image file","error");return}const M=new FileReader;M.onload=W=>{const B=W.target.result,G=new Image;G.crossOrigin="anonymous",G.onload=()=>{c({type:"SET_IMAGE",payload:G}),c({type:"SET_UI_STATE",payload:{imageUrl:B}})},G.src=B},M.readAsDataURL(re)},[d]),R=C.useCallback(q=>{const re=k.current;if(!re)return;const M=re.getPointerPosition();if(M){if(o.canvas.selectedTool==="create"){const W=fm.findAtPosition(o.testData.blocks,M.x,M.y);if(W){c({type:"SET_UI_STATE",payload:{selectedBlock:W}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:M.x,y:M.y}}})}else if(o.canvas.selectedTool==="edit"){const W=fm.findAtPosition(o.testData.blocks,M.x,M.y);c(W?{type:"SET_UI_STATE",payload:{selectedBlock:W}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const W=q.target===re,B=fm.findAtPosition(o.testData.blocks,M.x,M.y);(W||!B)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:M.x,y:M.y}}})}}},[o.canvas.selectedTool,_,o.testData.blocks]),T=C.useCallback(q=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const re=k.current;if(!re)return;const M=re.getPointerPosition();if(!M)return;const W=Math.abs(M.x-o.creation.blockCreationStart.x),B=Math.abs(M.y-o.creation.blockCreationStart.y),G=10,H=Math.max(W,G),O=Math.max(B,G);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(M.x,o.creation.blockCreationStart.x),y:Math.min(M.y,o.creation.blockCreationStart.y),width:H,height:O,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const re=k.current;if(!re)return;const M=re.getPointerPosition();if(!M)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:M.x,endY:M.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),D=C.useCallback(q=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const re=k.current;if(!re)return;const M=re.getPointerPosition();if(!M)return;const W=Math.abs(M.x-o.creation.blockCreationStart.x),B=Math.abs(M.y-o.creation.blockCreationStart.y),G=10,H=Math.max(W,G),O=Math.max(B,G),z=Math.min(M.x,o.creation.blockCreationStart.x)+H/2,Y=Math.min(M.y,o.creation.blockCreationStart.y)+O/2,J=fm.generateId(),te=fm.create(z,Y,H,O,J),ee=yw.create(J,`Word ${o.testData.blocks.length+1}`,yw.generateId(J));c({type:"ADD_BLOCK",payload:te}),c({type:"ADD_WORD",payload:ee}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const re=k.current;if(!re)return;const M=re.getPointerPosition();if(!M)return;if(Ah.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,M.x,M.y,o.testData.blocks)){const W=Ah.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),B=Ah.snapToNearestBlock(M.x,M.y,o.testData.blocks),G=W?W.x:o.creation.arrowStart.x,H=W?W.y:o.creation.arrowStart.y,O=B?B.x:M.x,z=B?B.y:M.y,Y=Ah.generateId(),J=Ah.create(G,H,O,z,W?W.blockId:null,B?B.blockId:null,Y);c({type:"ADD_ARROW",payload:J}),d("Arrow created successfully!","success")}else d("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,d]),I=C.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const q=K();if(Object.keys(q).length>0){console.warn(" [MatchingTestCreator] Validation errors:",q),d("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let re=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const W=await f("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),B=await W.json();if(W.ok&&B.success&&B.url)re=B.url;else throw new Error(B.message||"Upload failed")}const M=o.testData.blocks.map((W,B)=>{let G;if(_){const z=N(W.x,W.y),Y=N(W.x+W.width,W.y+W.height);G={x:z.x,y:z.y,width:Number((Y.x-z.x).toFixed(4)),height:Number((Y.y-z.y).toFixed(4))}}else G={x:Number(W.x.toFixed(4)),y:Number(W.y.toFixed(4)),width:Number(W.width.toFixed(4)),height:Number(W.height.toFixed(4))};const H=o.testData.words.find(z=>z.blockId===W.id),O=o.testData.arrows.find(z=>z.startBlock===W.id);return{question_id:B+1,word:H?.word||`Word ${B+1}`,block_coordinates:G,has_arrow:!!O,arrow:O&&_?(()=>{const z=N(O.startX,O.startY),Y=N(O.endX,O.endY),J=z.x/_.originalWidth*100,te=z.y/_.originalHeight*100,ee=Y.x/_.originalWidth*100,ie=Y.y/_.originalHeight*100;return{start_x:Number(z.x.toFixed(4)),start_y:Number(z.y.toFixed(4)),end_x:Number(Y.x.toFixed(4)),end_y:Number(Y.y.toFixed(4)),rel_start_x:Number(J.toFixed(4)),rel_start_y:Number(te.toFixed(4)),rel_end_x:Number(ee.toFixed(4)),rel_end_y:Number(ie.toFixed(4)),image_width:_.originalWidth,image_height:_.originalHeight,style:O.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:re,processedQuestions:M}))}catch(re){console.error("Save error:",re),d(`Error saving test: ${re.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,_,N,f,r,d,e,p]),K=C.useCallback(()=>{const q={};return e.trim()||(q.testName="Test name is required"),o.testData.blocks.length===0&&(q.blocks="At least one block is required"),q},[e,o.testData.blocks.length]),X=()=>l.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[l.jsx(Ze,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),l.jsx(Ze,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),l.jsx(Ze,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),l.jsx(Ze,{onClick:A,variant:"secondary",size:"sm",children:" Reset"}),l.jsx(Ze,{onClick:()=>y.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"})]}),Z=()=>l.jsx(Qd,{width:E.width,height:E.height,ref:k,onMouseDown:R,onMouseMove:T,onMouseUp:D,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:l.jsxs(Yd,{children:[o.canvas.image&&_&&l.jsx(M6,{image:o.canvas.image,x:_.x,y:_.y,width:_.width,height:_.height}),o.testData.blocks.map(q=>l.jsxs(Uo,{ref:re=>{re&&(b.current[q.id]=re)},draggable:o.canvas.selectedTool==="edit",x:q.x,y:q.y,onMouseEnter:re=>{const M=re.target.getStage()?.container();M&&(M.style.cursor=o.ui.selectedBlock?.id===q.id?"nwse-resize":"move")},onMouseLeave:re=>{const M=re.target.getStage()?.container();M&&(M.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:q}})},onDragEnd:re=>{const{x:M,y:W}=re.target.position();c({type:"UPDATE_BLOCK",payload:{id:q.id,updates:{x:M,y:W}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:q}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:q}})},children:[l.jsx(ea,{ref:re=>{re&&(w.current[q.id]=re)},width:q.width,height:q.height,fill:q.fill,stroke:q.stroke,strokeWidth:q.strokeWidth,cornerRadius:q.cornerRadius,shadowColor:q.shadowColor,shadowBlur:q.shadowBlur,shadowOffset:q.shadowOffset,shadowOpacity:q.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:re=>{const{x:M,y:W}=re.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:q.id,updates:{x:M,y:W}}})},onMouseEnter:re=>{const M=re.target.getStage()?.container();M&&(M.style.cursor=o.ui.selectedBlock?.id===q.id?"nwse-resize":"move")},onMouseLeave:re=>{const M=re.target.getStage()?.container();M&&(M.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:re=>{const M=w.current[q.id];if(!M)return;const W=Math.max(10,M.width()*M.scaleX()),B=Math.max(10,M.height()*M.scaleY());M.scaleX(1),M.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:q.id,updates:{width:W,height:B}}})}}),l.jsx(Sl,{x:2,y:2,text:`${o.testData.blocks.indexOf(q)+1}`,fontSize:Math.min(12,Math.max(8,q.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},q.id)),l.jsx(O6,{ref:v,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(q,re)=>({...re,width:Math.max(re.width,10),height:Math.max(re.height,10)})}),o.testData.arrows.map(q=>l.jsx(k_,{points:[q.startX,q.startY,q.endX,q.endY],stroke:q.stroke,fill:q.fill,strokeWidth:q.strokeWidth,pointerLength:q.pointerLength,pointerWidth:q.pointerWidth},q.id)),o.creation.previewBlock&&l.jsx(ea,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&l.jsx(k_,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),oe=C.useMemo(()=>o.testData.blocks.length===0?null:l.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full",style:{height:"min(400px, 40vh)",overflowY:"auto"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),l.jsx("div",{className:"space-y-2",children:o.testData.words.map(q=>{const re=o.testData.blocks.find(M=>M.id===q.blockId);return l.jsxs("div",{className:"p-2 bg-white rounded border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(re)+1]}),l.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:re.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),l.jsx("input",{type:"text",value:q.word,onChange:M=>{const W=yw.update(o.testData.words,q.blockId,M.target.value);c({type:"UPDATE_WORDS",payload:W})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},q.blockId)})})]}),[o.testData.words,o.testData.blocks]);return l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[l.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{children:l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})}),l.jsx("div",{className:"flex gap-2",children:l.jsx(Ze,{onClick:I,disabled:a||o.ui.isLoading,variant:"primary",children:a||o.ui.isLoading?l.jsx(Tr,{size:"sm"}):"Save Test"})})]})}),X(),l.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[l.jsx("div",{ref:g,className:"bg-white border overflow-auto",style:{minHeight:"400px",maxHeight:"calc(100vh - 200px)",height:"auto"},children:Z()}),oe]}),l.jsx("input",{ref:y,type:"file",accept:"image/*",onChange:P,className:"hidden"})]})},y0=C.createContext(null);function ML(e,t){return{getTheme:function(){return t??null}}}function Pl(){const e=C.useContext(y0);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function jt(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const qo=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,OL=qo&&"documentMode"in document?document.documentMode:null,bl=qo&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Jd=qo&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),z1=!(!qo||!("InputEvent"in window)||OL)&&"getTargetRanges"in new window.InputEvent("input"),Jm=qo&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),s0=qo&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,LL=qo&&/Android/.test(navigator.userAgent),L6=qo&&/^(?=.*Chrome).*/i.test(navigator.userAgent),h4=qo&&LL&&L6,H1=qo&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!L6;function B6(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const BL=1,UL=3,$L=9,WL=11,Zd=0,U6=1,a0=2,zL=0,HL=1,GL=2,G1=4,V1=8,cb=128,VL=1792|(112|(3|G1|V1)|cb),ub=1,db=2,fb=3,hb=4,gb=5,mb=6,Iy=Jm||s0||H1?"":"",kc=`

`,KL=Jd?"":Iy,ef={bold:1,capitalize:1024,code:16,highlight:cb,italic:2,lowercase:256,strikethrough:G1,subscript:32,superscript:64,underline:V1,uppercase:512},qL={directionless:1,unmergeable:2},g4={center:db,end:mb,justify:hb,left:ub,right:fb,start:gb},XL={[db]:"center",[mb]:"end",[hb]:"justify",[ub]:"left",[fb]:"right",[gb]:"start"},YL={normal:0,segmented:2,token:1},QL={[zL]:"normal",[GL]:"segmented",[HL]:"token"},m4="$config";function $6(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(xt(i)&&$6(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const JL=100;let T_=!1,pb=0;function ZL(e){pb=e.timeStamp}function vw(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&Gy(e,r)!==void 0}function eB(e,t,r){const n=Ko(po(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&Mb(t,i,s,a,!1)}function tB(e,t,r){if(Tt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return Ec(t)&&r.isAttached()}function rB(e,t,r,n){for(let s=e;s&&!rU(s);s=Dp(s)){const a=Gy(s,t);if(a!==void 0){const i=Es(a,r);if(i)return Zr(i)||!Rn(s)?void 0:[s,i]}else if(s===n)return[n,OA(r)]}}function W6(e,t,r){T_=!0;const n=performance.now()-pb>JL;try{Ii(e,(()=>{const s=$t()||(function(g){return g.getEditorState().read((()=>{const y=$t();return y!==null?y.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,c=e._blockCursorElement;let d=!1,f="";for(let g=0;g<t.length;g++){const y=t[g],v=y.type,w=y.target,b=rB(w,e,o,i);if(!b)continue;const[E,k]=b;if(v==="characterData")n&&Wt(k)&&Ec(w)&&tB(s,w,k)&&eB(w,k,e);else if(v==="childList"){d=!0;const _=y.addedNodes;for(let P=0;P<_.length;P++){const R=_[P],T=IA(R),D=R.parentNode;if(D!=null&&R!==c&&T===null&&!vw(R,D,e)){if(Jd){const I=(Rn(R)?R.innerText:null)||R.nodeValue;I&&(f+=I)}D.removeChild(R)}}const N=y.removedNodes,A=N.length;if(A>0){let P=0;for(let R=0;R<A;R++){const T=N[R];(vw(T,w,e)||c===T)&&(w.appendChild(T),P++)}A!==P&&a.set(E,k)}}}if(a.size>0)for(const[g,y]of a)y.reconcileObservedMutation(g,e);const p=r.takeRecords();if(p.length>0){for(let g=0;g<p.length;g++){const y=p[g],v=y.addedNodes,w=y.target;for(let b=0;b<v.length;b++){const E=v[b],k=E.parentNode;k==null||E.nodeName!=="BR"||vw(E,w,e)||k.removeChild(E)}}r.takeRecords()}s!==null&&(d&&_a(s),Jd&&$A(e)&&s.insertRawText(f))}))}finally{T_=!1}}function z6(e){const t=e._observer;t!==null&&W6(e,t.takeRecords(),t)}function H6(e){(function(t){pb===0&&po(t).addEventListener("textInput",ZL,!0)})(e),e._observer=new MutationObserver(((t,r)=>{W6(e,t,r)}))}function nB(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=$b(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let sB=class G6{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(c,d,f){let p=f.size;if(d)for(const g in d){const y=c.get(g);y&&f.has(y)||p++}return p})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return p4(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new G6(t,r,(function(a,i,o){let c;if(o)for(const[d,f]of Object.entries(o)){const p=a.get(d);p?i.has(p)||i.set(p,p.parse(f)):(c=c||{},c[d]=f)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=p4(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function aB(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new sB(t,V6(t));return t.__state=r,r}function V6(e){return e.__state?e.__state.sharedNodeState:PA(Ip(),e.getType()).sharedNodeState}function p4(e){if(e)for(const t in e)return e}function x4(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function y4(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function v4(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function w4(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,c=e.__state,d=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||c===d||(function(f,p){if(f===p)return!0;if(f&&p&&f.size!==p.size)return!1;const g=new Set;return!(f&&x4(g,f,p)||p&&x4(g,p,f)||f&&y4(g,f,p)||p&&y4(g,p,f))})(c,d))}function _4(e,t){const r=e.mergeWithSibling(t),n=Vn()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function b4(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&Wt(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(w4(t,n)){n=_4(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&Wt(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(w4(n,r)){n=_4(n,r);break}break}r.remove()}}else n.remove()}function K1(e){return S4(e.anchor),S4(e.focus),e}function S4(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),Wt(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!xt(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let tf,Oa,Zm,My,E_,N_,rf,zo,A_,ep,Is="",wl=null,_l="",gc="",jh=!1,q1=!1;function X1(e,t){const r=rf.get(e);if(t!==null){const n=R_(e);n.parentNode===t&&t.removeChild(n)}if(zo.has(e)||Oa._keyToDOMMap.delete(e),xt(r)){const n=Q1(r,rf);j_(n,0,n.length-1,null)}r!==void 0&&Ob(ep,Zm,My,r,"destroyed")}function j_(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&X1(a,n)}}function Fd(e,t){e.setProperty("text-align",t)}const iB="40px";function K6(e,t){const r=tf.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||iB;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function q6(e,t){const r=e.style;t===0?Fd(r,""):t===ub?Fd(r,"left"):t===db?Fd(r,"center"):t===fb?Fd(r,"right"):t===hb?Fd(r,"justify"):t===gb?Fd(r,"start"):t===mb&&Fd(r,"end")}function F_(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(Ls(n))return null;const a=n.getParentOrThrow();return Ls(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function Y1(e,t){const r=zo.get(e);r===void 0&&jt(60);const n=r.createDOM(tf,Oa);if((function(s,a,i){const o=i._keyToDOMMap;(function(c,d,f){const p=`__lexicalKey_${d._key}`;c[p]=f})(a,i,s),o.set(s,a)})(e,n,Oa),Wt(r)?n.setAttribute("data-lexical-text","true"):Zr(r)&&n.setAttribute("data-lexical-decorator","true"),xt(r)){const s=r.__indent,a=r.__size;if(F_(n,r),s!==0&&K6(n,s),a!==0){const o=a-1;P_(Q1(r,zo),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&q6(n,i),r.isInline()||X6(null,r,n),Vy(r)&&(Is+=kc,gc+=kc)}else{const s=r.getTextContent();if(Zr(r)){const a=r.decorate(Oa,tf);a!==null&&Y6(e,a),n.contentEditable="false"}Is+=s,gc+=s}return t!==null&&t.insertChild(n),Ob(ep,Zm,My,r,"created"),n}function P_(e,t,r,n,s){const a=Is;Is="";let i=r;for(;i<=n;++i){Y1(e[i],s);const o=zo.get(e[i]);o!==null&&Wt(o)&&(wl===null&&(wl=o.getFormat()),_l===""&&(_l=o.getStyle()))}Vy(t)&&(Is+=kc),s.element.__lexicalTextContent=Is,Is=a+Is}function k4(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return yc(n)?"line-break":Zr(n)&&n.isInline()?"decorator":null}return"empty"}return null}function X6(e,t,r){const n=k4(e,rf),s=k4(t,zo);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function oB(e,t,r){var n;wl=null,_l="",(function(s,a,i){const o=Is,c=s.__size,d=a.__size;Is="";const f=i.element;if(c===1&&d===1){const p=s.__first,g=a.__first;if(p===g)wm(p,f);else{const v=R_(p),w=Y1(g,null);try{f.replaceChild(w,v)}catch(b){if(typeof b=="object"&&b!=null){const E=`${b.toString()} Parent: ${f.tagName}, new child: {tag: ${w.tagName} key: ${g}}, old child: {tag: ${v.tagName}, key: ${p}}.`;throw new Error(E)}throw b}X1(p,null)}const y=zo.get(g);Wt(y)&&(wl===null&&(wl=y.getFormat()),_l===""&&(_l=y.getStyle()))}else{const p=Q1(s,rf),g=Q1(a,zo);if(p.length!==c&&jt(227),g.length!==d&&jt(228),c===0)d!==0&&P_(g,a,0,d-1,i);else if(d===0){if(c!==0){const y=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;j_(p,0,c-1,y?null:f),y&&(f.textContent="")}}else(function(y,v,w,b,E,k){const _=b-1,N=E-1;let A,P,R=k.getFirstChild(),T=0,D=0;for(;T<=_&&D<=N;){const X=v[T],Z=w[D];if(X===Z)R=ww(wm(Z,k.element)),T++,D++;else{A===void 0&&(A=new Set(v)),P===void 0&&(P=new Set(w));const q=P.has(X),re=A.has(Z);if(q)if(re){const M=nf(Oa,Z);M===R?R=ww(wm(Z,k.element)):(k.withBefore(R).insertChild(M),wm(Z,k.element)),T++,D++}else Y1(Z,k.withBefore(R)),D++;else R=ww(R_(X)),X1(X,k.element),T++}const oe=zo.get(Z);oe!==null&&Wt(oe)&&(wl===null&&(wl=oe.getFormat()),_l===""&&(_l=oe.getStyle()))}const I=T>_,K=D>N;if(I&&!K){const X=w[N+1],Z=X===void 0?null:Oa.getElementByKey(X);P_(w,y,D,N,k.withBefore(Z))}else K&&!I&&j_(v,T,_,k.element)})(a,p,g,c,d,i)}Vy(a)&&(Is+=kc),f.__lexicalTextContent=Is,Is=o+Is})(e,t,t.getDOMSlot(r)),n=t,wl==null||wl===n.__textFormat||q1||n.setTextFormat(wl),(function(s){_l===""||_l===s.__textStyle||q1||s.setTextStyle(_l)})(t)}function Q1(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&jt(101),r.push(n),n=s.__next}return r}function wm(e,t){const r=rf.get(e);let n=zo.get(e);r!==void 0&&n!==void 0||jt(61);const s=jh||N_.has(e)||E_.has(e),a=nf(Oa,e);if(r===n&&!s){if(xt(r)){const i=a.__lexicalTextContent;i!==void 0&&(Is+=i,gc+=i)}else{const i=r.getTextContent();gc+=i,Is+=i}return a}if(r!==n&&s&&Ob(ep,Zm,My,n,"updated"),n.updateDOM(r,a,tf)){const i=Y1(e,null);return t===null&&jt(62),t.replaceChild(i,a),X1(e,null),i}if(xt(r)&&xt(n)){const i=n.__indent;(jh||i!==r.__indent)&&K6(a,i);const o=n.__format;if((jh||o!==r.__format)&&q6(a,o),s&&(oB(r,n,a),Ls(n)||n.isInline()||X6(r,n,a)),Vy(n)&&(Is+=kc,gc+=kc),(jh||n.__dir!==r.__dir)&&(F_(a,n),Ls(n)&&!jh))for(const c of n.getChildren())xt(c)&&F_(nf(Oa,c.getKey()),c)}else{const i=n.getTextContent();if(Zr(n)){const o=n.decorate(Oa,tf);o!==null&&Y6(e,o)}Is+=i,gc+=i}if(!q1&&Ls(n)&&n.__cachedText!==gc){const i=n.getWritable();i.__cachedText=gc,n=i}return a}function Y6(e,t){let r=Oa._pendingDecorators;const n=Oa._decorators;if(r===null){if(n[e]===t)return;r=MA(Oa)}r[e]=t}function ww(e){let t=e.nextSibling;return t!==null&&t===Oa._blockCursorElement&&(t=t.nextSibling),t}function lB(e,t,r,n,s,a){Is="",gc="",jh=n===a0,Oa=r,tf=r._config,Zm=r._nodes,My=Oa._listeners.mutation,E_=s,N_=a,rf=e._nodeMap,zo=t._nodeMap,q1=t._readOnly,A_=new Map(r._keyToDOMMap);const i=new Map;return ep=i,wm("root",null),Oa=void 0,Zm=void 0,E_=void 0,N_=void 0,rf=void 0,zo=void 0,tf=void 0,A_=void 0,ep=void 0,i}function R_(e){const t=A_.get(e);return t===void 0&&jt(75,e),t}function pr(e){return{type:e}}const Q6=pr("SELECTION_CHANGE_COMMAND"),cB=pr("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),xb=pr("CLICK_COMMAND"),zd=pr("DELETE_CHARACTER_COMMAND"),Gh=pr("INSERT_LINE_BREAK_COMMAND"),tp=pr("INSERT_PARAGRAPH_COMMAND"),Vh=pr("CONTROLLED_TEXT_INSERTION_COMMAND"),yb=pr("PASTE_COMMAND"),D_=pr("REMOVE_TEXT_COMMAND"),rp=pr("DELETE_WORD_COMMAND"),np=pr("DELETE_LINE_COMMAND"),Ma=pr("FORMAT_TEXT_COMMAND"),vb=pr("UNDO_COMMAND"),wb=pr("REDO_COMMAND"),uB=pr("KEYDOWN_COMMAND"),J6=pr("KEY_ARROW_RIGHT_COMMAND"),dB=pr("MOVE_TO_END"),Z6=pr("KEY_ARROW_LEFT_COMMAND"),fB=pr("MOVE_TO_START"),eA=pr("KEY_ARROW_UP_COMMAND"),tA=pr("KEY_ARROW_DOWN_COMMAND"),J1=pr("KEY_ENTER_COMMAND"),rA=pr("KEY_SPACE_COMMAND"),nA=pr("KEY_BACKSPACE_COMMAND"),sA=pr("KEY_ESCAPE_COMMAND"),aA=pr("KEY_DELETE_COMMAND"),iA=pr("KEY_TAB_COMMAND"),hB=pr("INSERT_TAB_COMMAND"),gB=pr("INDENT_CONTENT_COMMAND"),C4=pr("OUTDENT_CONTENT_COMMAND"),oA=pr("DROP_COMMAND"),lA=pr("FORMAT_ELEMENT_COMMAND"),cA=pr("DRAGSTART_COMMAND"),uA=pr("DRAGOVER_COMMAND"),mB=pr("DRAGEND_COMMAND"),Oy=pr("COPY_COMMAND"),_b=pr("CUT_COMMAND"),I_=pr("SELECT_ALL_COMMAND"),pB=pr("CLEAR_EDITOR_COMMAND"),xB=pr("CLEAR_HISTORY_COMMAND"),s1=pr("CAN_REDO_COMMAND"),a1=pr("CAN_UNDO_COMMAND"),yB=pr("FOCUS_COMMAND"),vB=pr("BLUR_COMMAND"),wB=pr("KEY_MODIFIER_COMMAND"),uc=Object.freeze({}),M_=30,O_=[["keydown",function(e,t){if(jm=e.timeStamp,dA=e.key,!t.isComposing()&&!tr(t,uB,e)&&e.key!=null){if(_w&&Z4(e))return Ii(t,(()=>{i1(t,bw)})),_w=!1,void(bw="");if((function(r){return on(r,"ArrowRight",{shiftKey:"any"})})(e))tr(t,J6,e);else if((function(r){return on(r,"ArrowRight",fc)})(e))tr(t,dB,e);else if((function(r){return on(r,"ArrowLeft",{shiftKey:"any"})})(e))tr(t,Z6,e);else if((function(r){return on(r,"ArrowLeft",fc)})(e))tr(t,fB,e);else if((function(r){return on(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))tr(t,eA,e);else if((function(r){return on(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))tr(t,tA,e);else if((function(r){return on(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))Fm=!0,tr(t,J1,e);else if((function(r){return r.key===" "})(e))tr(t,rA,e);else if((function(r){return bl&&on(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),Fm=!0,tr(t,Gh,!0);else if((function(r){return on(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))Fm=!1,tr(t,J1,e);else if((function(r){return on(r,"Backspace",{shiftKey:"any"})||bl&&on(r,"h",{ctrlKey:!0})})(e))Z4(e)?tr(t,nA,e):(e.preventDefault(),tr(t,zd,!0));else if((function(r){return r.key==="Escape"})(e))tr(t,sA,e);else if((function(r){return on(r,"Delete",{})||bl&&on(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?tr(t,aA,e):(e.preventDefault(),tr(t,zd,!1));else if((function(r){return on(r,"Backspace",J4)})(e))e.preventDefault(),tr(t,rp,!0);else if((function(r){return on(r,"Delete",J4)})(e))e.preventDefault(),tr(t,rp,!1);else if((function(r){return bl&&on(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),tr(t,np,!0);else if((function(r){return bl&&(on(r,"Delete",{metaKey:!0})||on(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),tr(t,np,!1);else if((function(r){return on(r,"b",fc)})(e))e.preventDefault(),tr(t,Ma,"bold");else if((function(r){return on(r,"u",fc)})(e))e.preventDefault(),tr(t,Ma,"underline");else if((function(r){return on(r,"i",fc)})(e))e.preventDefault(),tr(t,Ma,"italic");else if((function(r){return on(r,"Tab",{shiftKey:"any"})})(e))tr(t,iA,e);else if((function(r){return on(r,"z",fc)})(e))e.preventDefault(),tr(t,vb,void 0);else if((function(r){return bl?on(r,"z",{metaKey:!0,shiftKey:!0}):on(r,"y",{ctrlKey:!0})||on(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),tr(t,wb,void 0);else{const r=t._editorState._selection;r===null||Tt(r)?eE(e)&&(e.preventDefault(),tr(t,I_,e)):(function(n){return on(n,"c",fc)})(e)?(e.preventDefault(),tr(t,Oy,e)):(function(n){return on(n,"x",fc)})(e)?(e.preventDefault(),tr(t,_b,e)):eE(e)&&(e.preventDefault(),tr(t,I_,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&tr(t,wB,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;b0(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&Ii(t,(()=>{X4(r)||(B_=!0)}))}],["compositionstart",function(e,t){Ii(t,(()=>{const r=$t();if(Tt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();ya(n.key),(e.timeStamp<jm+M_||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||Wt(s)&&s.getStyle()!==r.style)&&tr(t,Vh,KL)}}))}],["compositionend",function(e,t){Jd?hm=!0:s0||!Jm&&!H1?Ii(t,(()=>{i1(t,e.data)})):(_w=!0,bw=e.data)}],["input",function(e,t){e.stopPropagation(),Ii(t,(()=>{if(Rn(e.target)&&X4(e.target))return;const r=$t(),n=e.data,s=pA(e);if(n!=null&&Tt(r)&&gA(r,s,n,e.timeStamp,!1)){hm&&(i1(t,n),hm=!1);const a=r.anchor.getNode(),i=Ko(po(t));if(i===null)return;const o=r.isBackward(),c=o?r.anchor.offset:r.focus.offset,d=o?r.focus.offset:r.anchor.offset;z1&&!r.isCollapsed()&&Wt(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+d)===UA(i.anchorNode)||tr(t,Vh,n);const f=n.length;Jd&&f>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=f),Jm||s0||H1||!t.isComposing()||(jm=0,ya(null))}else Ib(!1,t,n!==null?n:void 0),hm&&(i1(t,n||void 0),hm=!1);(function(){xa();const a=Vn();z6(a)})()}),{event:e}),Fh=null}],["click",function(e,t){Ii(t,(()=>{const r=$t(),n=Ko(po(t)),s=_0();if(n){if(Tt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!Ls(i)&&Un().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(c,d){let f=c;for(;f!==Un()&&f!=null;){if(d(f))return f;f=f.getParent()}return null})(i,(c=>xt(c)&&!c.isInline()));xt(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(Rn(a)||Ec(a))&&_a(kb(s,n,t,e))}}tr(t,xb,e)}))}],["cut",uc],["copy",uc],["dragstart",uc],["dragover",uc],["dragend",uc],["paste",uc],["focus",uc],["blur",uc],["drop",uc]];z1&&O_.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=pA(r);s==="deleteCompositionText"||Jd&&$A(n)||s!=="insertCompositionText"&&Ii(n,(()=>{const i=$t();if(s==="deleteContentBackward"){if(i===null){const y=_0();if(!Tt(y))return;_a(y.clone())}if(Tt(i)){const y=i.anchor.key===i.focus.key;if(o=r.timeStamp,dA==="MediaLast"&&o<jm+M_&&n.isComposing()&&y){if(ya(null),jm=0,setTimeout((()=>{Ii(n,(()=>{ya(null)}))}),M_),Tt(i)){const v=i.anchor.getNode();v.markDirty(),Wt(v)||jt(142),mA(i,v)}}else{ya(null),r.preventDefault();const v=i.anchor.getNode(),w=v.getTextContent(),b=v.canInsertTextAfter(),E=i.anchor.offset===0&&i.focus.offset===w.length;let k=h4&&y&&!E&&b;if(k&&i.isCollapsed()&&(k=!Zr(H_(i.anchor,!0))),!k){tr(n,zd,!0);const _=$t();h4&&Tt(_)&&_.isCollapsed()&&(Dd=_,setTimeout((()=>Dd=null)))}}return}}var o;if(!Tt(i))return;const c=r.data;Fh!==null&&Ib(!1,n,Fh),i.dirty&&Fh===null||!i.isCollapsed()||Ls(i.anchor.getNode())||a===null||i.applyDOMRange(a),Fh=null;const d=i.anchor,f=i.focus,p=d.getNode(),g=f.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":tr(n,Vh,r);break;case"insertFromComposition":ya(null),tr(n,Vh,r);break;case"insertLineBreak":ya(null),tr(n,Gh,!1);break;case"insertParagraph":ya(null),Fm&&!s0?(Fm=!1,tr(n,Gh,!1)):tr(n,tp,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":tr(n,yb,r);break;case"deleteByComposition":(function(y,v){return y!==v||xt(y)||xt(v)||!Hd(y)||!Hd(v)})(p,g)&&tr(n,D_,r);break;case"deleteByDrag":case"deleteByCut":tr(n,D_,r);break;case"deleteContent":tr(n,zd,!1);break;case"deleteWordBackward":tr(n,rp,!0);break;case"deleteWordForward":tr(n,rp,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":tr(n,np,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":tr(n,np,!1);break;case"formatStrikeThrough":tr(n,Ma,"strikethrough");break;case"formatBold":tr(n,Ma,"bold");break;case"formatItalic":tr(n,Ma,"italic");break;case"formatUnderline":tr(n,Ma,"underline");break;case"historyUndo":tr(n,vb,void 0);break;case"historyRedo":tr(n,wb,void 0)}else{if(c===`
`)r.preventDefault(),tr(n,Gh,!1);else if(c===kc)r.preventDefault(),tr(n,tp,void 0);else if(c==null&&r.dataTransfer){const y=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(y)}else c!=null&&gA(i,a,c,r.timeStamp,!0)?(r.preventDefault(),tr(n,Vh,c)):Fh=c;fA=r.timeStamp}}))})(e,t)]);let jm=0,dA=null,fA=0,Fh=null;const Z1=new WeakMap;let L_=!1,B_=!1,Fm=!1,hm=!1,_w=!1,bw="",Dd=null,hA=[0,"",0,"root",0];function gA(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),c=Vn(),d=Ko(po(c)),f=d!==null?d.anchorNode:null,p=a.key,g=c.getElementByKey(p),y=r.length;return p!==i.key||!Wt(o)||(!s&&(!z1||fA<n+50)||o.isDirty()&&y<2||LA(r))&&a.offset!==i.offset&&!o.isComposing()||hc(o)||o.isDirty()&&y>1||(s||!z1)&&g!==null&&!o.isComposing()&&f!==i0(g)||d!==null&&t!==null&&(!t.collapsed||t.startContainer!==d.anchorNode||t.startOffset!==d.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(v,w){if(w.isSegmented())return!0;if(!v.isCollapsed())return!1;const b=v.anchor.offset,E=w.getParentOrThrow(),k=Hd(w);return b===0?!w.canInsertTextBefore()||!E.canInsertTextBefore()&&!w.isComposing()||k||(function(_){const N=_.getPreviousSibling();return(Wt(N)||xt(N)&&N.isInline())&&!N.canInsertTextAfter()})(w):b===w.getTextContentSize()&&(!w.canInsertTextAfter()||!E.canInsertTextAfter()&&!w.isComposing()||k)})(e,o)}function T4(e,t){return Ec(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function E4(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;L_&&(L_=!1,T4(n,s)&&T4(a,i)&&!Dd)||Ii(t,(()=>{if(!r)return void _a(null);if(!Rp(t,n,a))return;let o=$t();if(Dd&&Tt(o)&&o.isCollapsed()){const c=o.anchor,d=Dd.anchor;(c.key===d.key&&c.offset===d.offset+1||c.offset===1&&d.getNode().is(c.getNode().getPreviousSibling()))&&(o=Dd.clone(),_a(o))}if(Dd=null,Tt(o)){const c=o.anchor,d=c.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const f=po(t).event,p=f?f.timeStamp:performance.now(),[g,y,v,w,b]=hA,E=Un(),k=t.isComposing()===!1&&E.getTextContent()==="";if(p<b+200&&c.offset===v&&c.key===w)F1(o,g,y);else if(c.type==="text")Wt(d)||jt(141),mA(o,d);else if(c.type==="element"&&!k){xt(d)||jt(259);const _=c.getNode();_.isEmpty()?(function(N,A){const P=A.getTextFormat(),R=A.getTextStyle();F1(N,P,R)})(o,_):F1(o,0,"")}}else{const f=c.key,p=o.focus.key,g=o.getNodes(),y=g.length,v=o.isBackward(),w=v?i:s,b=v?s:i,E=v?p:f,k=v?f:p;let _=VL,N=!1;for(let A=0;A<y;A++){const P=g[A],R=P.getTextContentSize();if(Wt(P)&&R!==0&&!(A===0&&P.__key===E&&w===R||A===y-1&&P.__key===k&&b===0)&&(N=!0,_&=P.getFormat(),_===0))break}o.format=N?_:0}}tr(t,Q6,void 0)}))}function F1(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function mA(e,t){F1(e,t.getFormat(),t.getStyle())}function pA(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function i1(e,t){const r=e._compositionKey;if(ya(null),r!==null&&t!=null){if(t===""){const n=Es(r),s=i0(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&Wt(n)&&Mb(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=$t();if(Tt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void tr(e,J1,null)}}}Ib(!0,e,t)}function xA(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const Kh=new Map;function yA(e){const t=ZB(e.target);if(t===null)return;const r=RA(t.anchorNode);if(r===null)return;B_&&(B_=!1,Ii(r,(()=>{const c=_0(),d=t.anchorNode;(Rn(d)||Ec(d))&&_a(kb(c,t,r,e))})));const n=Db(r),s=n[n.length-1],a=s._key,i=Kh.get(a),o=i||s;o!==r&&E4(t,o,!1),E4(t,r,!0),r!==s?Kh.set(a,r):i&&Kh.delete(a)}function N4(e){e._lexicalHandled=!0}function A4(e){return e._lexicalHandled===!0}function _B(e){const t=e.ownerDocument,r=Z1.get(t);if(r===void 0)return;const n=r-1;n>=0||jt(164),Z1.set(t,n),n===0&&t.removeEventListener("selectionchange",yA);const s=Hy(e);Rb(s)?((function(i){if(i._parentEditor!==null){const o=Db(i),c=o[o.length-1]._key;Kh.get(c)===i&&Kh.delete(c)}else Kh.delete(i._key)})(s),e.__lexicalEditor=null):s&&jt(198);const a=xA(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function U_(e,t,r){xa();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const c=$t();if(!Tt(c)||!xt(o))return c;const{anchor:d,focus:f}=c,p=d.getNode(),g=f.getNode();return G_(p,o)&&d.set(o.__key,0,"element"),G_(g,o)&&f.set(o.__key,0,"element"),c})(e);let i=!1;if(Tt(a)&&t){const o=a.anchor,c=a.focus;o.key===n&&(ty(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(ty(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else ja(a)&&t&&e.isSelected()&&e.selectPrevious();if(Tt(a)&&t&&!i){const o=e.getIndexWithinParent();Gd(e),ey(a,s,o,-1)}else Gd(e);r||si(s)||s.canBeEmpty()||!s.isEmpty()||U_(s,t),t&&a&&Ls(s)&&s.isEmpty()&&s.selectEnd()}class v0{static getType(){const{ownNodeType:t}=$b(this);return t===void 0&&jt(64,this.name),t}static clone(t){jt(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),GB(this,t)}getType(){return this.__type}isInline(){jt(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=Es(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||$t();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(Wt(this))return n;if(Tt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(Zr(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:Es(t)}getParentOrThrow(){const t=this.getParent();return t===null&&jt(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(si(r))return xt(t)||t===this&&Zr(t)||jt(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&jt(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:Es(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:Es(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=xt(this)?this:this.getParent(),n=xt(t)?t:t.getParent(),s=r&&n?R1(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=R1(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?GA(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&jt(279),!1)))}isParentOf(t){const r=R1(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=xt(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const d=a.getParentOrThrow();if(s.has(d.__key)||n.push(d),d===t)break;let f=null,p=d;do{if(p===null&&jt(68),f=r?p.getNextSibling():p.getPreviousSibling(),p=p.getParent(),p===null)break;f!==null||s.has(p.__key)||n.push(p)}while(f===null);a=f}return r||n.reverse(),n}isDirty(){const t=Vn()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=Es(this.__key);return t===null&&jt(113),t}getWritable(){xa();const t=Ku(),r=Vn(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=$t();if(o!==null&&o.setCachedNodes(null),i.has(s))return sy(a),a;const c=Bb(a);return i.add(s),sy(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){jt(70)}updateDOM(t,r,n){jt(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){jt(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of V6(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&aB(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){U_(this,!0,t)}replace(t,r){xa();let n=$t();n!==null&&(n=n.clone()),Nw(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),c=this.getParentOrThrow().getWritable(),d=c.__size;Gd(o);const f=s.getPreviousSibling(),p=s.getNextSibling(),g=s.__prev,y=s.__next,v=s.__parent;if(U_(s,!1,!0),f===null?c.__first=i:f.getWritable().__next=i,o.__prev=g,p===null?c.__last=i:p.getWritable().__prev=i,o.__next=y,o.__parent=v,c.__size=d,r&&(xt(this)&&xt(o)||jt(139),this.getChildren().forEach((w=>{o.append(w)}))),Tt(n)){_a(n);const w=n.anchor,b=n.focus;w.key===a&&R4(w,o),b.key===a&&R4(b,o)}return ku()===a&&ya(i),o}insertAfter(t,r=!0){xa(),Nw(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=$t();let o=!1,c=!1;if(a!==null){const y=t.getIndexWithinParent();if(Gd(s),Tt(i)){const v=a.__key,w=i.anchor,b=i.focus;o=w.type==="element"&&w.key===v&&w.offset===y+1,c=b.type==="element"&&b.key===v&&b.offset===y+1}}const d=this.getNextSibling(),f=this.getParentOrThrow().getWritable(),p=s.__key,g=n.__next;if(d===null?f.__last=p:d.getWritable().__prev=p,f.__size++,n.__next=p,s.__next=g,s.__prev=n.__key,s.__parent=n.__parent,r&&Tt(i)){const y=this.getIndexWithinParent();ey(i,f,y+1);const v=f.__key;o&&i.anchor.set(v,y+2,"element"),c&&i.focus.set(v,y+2,"element")}return t}insertBefore(t,r=!0){xa(),Nw(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Gd(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),c=n.__prev,d=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const f=$t();return r&&Tt(f)&&ey(f,this.getParentOrThrow(),d),t}isParentRequired(){return!1}createParentElementNode(){return Pn()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){xa();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(xt(n))return n.select();if(!Wt(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){xa();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(xt(n))return n.select(0,0);if(!Wt(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class Np extends v0{static getType(){return"linebreak"}static clone(t){return new Np(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&ay(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&o1(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&o1(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&ay(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&o1(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&o1(a))return!0}return!1})(t)?null:{conversion:bB,priority:0}}}static importJSON(t){return jl().updateFromJSON(t)}}function bB(e){return{node:jl()}}function jl(){return ii(new Np)}function yc(e){return e instanceof Np}function o1(e){return Ec(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function Sw(e,t){return 16&t?"code":t&cb?"mark":32&t?"sub":64&t?"sup":null}function kw(e,t){return 1&t?"strong":2&t?"em":"span"}function vA(e,t,r,n,s){const a=n.classList;let i=qh(s,"base");i!==void 0&&a.add(...i),i=qh(s,"underlineStrikethrough");let o=!1;const c=t&V1&&t&G1;i!==void 0&&(r&V1&&r&G1?(o=!0,c||a.add(...i)):c&&a.remove(...i));for(const d in ef){const f=ef[d];if(i=qh(s,d),i!==void 0)if(r&f){if(o&&(d==="underline"||d==="strikethrough")){t&f&&a.remove(...i);continue}t&f&&(!c||d!=="underline")&&d!=="strikethrough"||a.add(...i)}else t&f&&a.remove(...i)}}function wA(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?Iy:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||Jd){const[o,c,d]=(function(f,p){const g=f.length,y=p.length;let v=0,w=0;for(;v<g&&v<y&&f[v]===p[v];)v++;for(;w+v<g&&w+v<y&&f[g-w-1]===p[y-w-1];)w++;return[v,g-v-w,p.slice(v,y-w)]})(i,a);c!==0&&n.deleteData(o,c),n.insertData(o,d)}else n.nodeValue=a}}function j4(e,t,r,n,s,a){wA(s,e,t);const i=a.theme.text;i!==void 0&&vA(0,0,n,e,i)}function l1(e,t){const r=document.createElement(t);return r.appendChild(e),r}class Vu extends v0{static getType(){return"text"}static clone(t){return new Vu(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return QL[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===ku()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=ef[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return ny(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=Sw(0,n),a=kw(0,n),i=s===null?a:s,o=document.createElement(i);let c=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),o.appendChild(c)),j4(c,this,0,n,this.__text,t);const d=this.__style;return d!==""&&(o.style.cssText=d),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=Sw(0,a),c=Sw(0,i),d=kw(0,a),f=kw(0,i);if((o===null?d:o)!==(c===null?f:c))return!0;if(o===c&&d!==f){const w=r.firstChild;w==null&&jt(48);const b=document.createElement(f);return j4(b,this,0,i,s,n),r.replaceChild(b,w),!1}let p=r;c!==null&&o!==null&&(p=r.firstChild,p==null&&jt(49)),wA(s,p,this);const g=n.theme.text;g!==void 0&&a!==i&&vA(0,a,i,p,g);const y=t.__style,v=this.__style;return y!==v&&(r.style.cssText=v),!1}static importDOM(){return{"#text":()=>({conversion:TB,priority:0}),b:()=>({conversion:kB,priority:0}),code:()=>({conversion:dc,priority:0}),em:()=>({conversion:dc,priority:0}),i:()=>({conversion:dc,priority:0}),mark:()=>({conversion:dc,priority:0}),s:()=>({conversion:dc,priority:0}),span:()=>({conversion:SB,priority:0}),strong:()=>({conversion:dc,priority:0}),sub:()=>({conversion:dc,priority:0}),sup:()=>({conversion:dc,priority:0}),u:()=>({conversion:dc,priority:0})}}static importJSON(t){return Zn().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return Rn(r)||jt(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=l1(r,"b")),this.hasFormat("italic")&&(r=l1(r,"i")),this.hasFormat("strikethrough")&&(r=l1(r,"s")),this.hasFormat("underline")&&(r=l1(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?ef[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?qL[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=ny(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=YL[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){xa();let n=t,s=r;const a=$t(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!Tt(a))return SA(o,n,o,s,"text","text");{const c=ku();c!==a.anchor.key&&c!==a.focus.key||ya(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let c=t;c<0&&(c=o+c,c<0&&(c=0));const d=$t();if(s&&Tt(d)){const p=t+o;d.setTextNodeRange(a,p,a,p)}const f=i.slice(0,c)+n+i.slice(c+r);return a.__text=f,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){xa();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=ku(),i=n.length;t.sort(((T,D)=>T-D)),t.push(i);const o=[],c=t.length;for(let T=0,D=0;T<i&&D<=c;D++){const I=t[D];I>T&&(o.push(n.slice(T,I)),T=I)}const d=o.length;if(d===1)return[r];const f=o[0],p=r.getParent();let g;const y=r.getFormat(),v=r.getStyle(),w=r.__detail;let b=!1,E=null,k=null;const _=$t();if(Tt(_)){const[T,D]=_.isBackward()?[_.focus,_.anchor]:[_.anchor,_.focus];T.type==="text"&&T.key===s&&(E=T),D.type==="text"&&D.key===s&&(k=D)}r.isSegmented()?(g=Zn(f),g.__format=y,g.__style=v,g.__detail=w,g.__state=v4(r,g),b=!0):g=r.setTextContent(f);const N=[g];for(let T=1;T<d;T++){const D=Zn(o[T]);D.__format=y,D.__style=v,D.__detail=w,D.__state=v4(r,D);const I=D.__key;a===s&&ya(I),N.push(D)}const A=E?E.offset:null,P=k?k.offset:null;let R=0;for(const T of N){if(!E&&!k)break;const D=R+T.getTextContentSize();if(E!==null&&A!==null&&A<=D&&A>=R&&(E.set(T.getKey(),A-R,"text"),A<D&&(E=null)),k!==null&&P!==null&&P<=D&&P>=R){k.set(T.getKey(),P-R,"text");break}R=D}if(p!==null){(function(I){const K=I.getPreviousSibling(),X=I.getNextSibling();K!==null&&sy(K),X!==null&&sy(X)})(this);const T=p.getWritable(),D=this.getIndexWithinParent();b?(T.splice(D,0,N),this.remove()):T.splice(D,1,N),Tt(_)&&ey(_,p,D,d-1)}return N}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||jt(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;ku()===s&&ya(n);const o=$t();if(Tt(o)){const p=o.anchor,g=o.focus;p!==null&&p.key===s&&U4(p,r,n,t,i),g!==null&&g.key===s&&U4(g,r,n,t,i)}const c=t.__text,d=r?c+a:a+c;this.setTextContent(d);const f=this.getWritable();return t.remove(),f}isTextEntity(){return!1}}function SB(e){return{forChild:bb(e.style),node:null}}function kB(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:bb(t.style,r?void 0:"bold"),node:null}}const F4=new WeakMap;function CB(e){if(!Rn(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function TB(e){const t=e;e.parentElement===null&&jt(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=F4.get(a))===void 0&&!CB(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let c=0;c<i.length;c++)F4.set(i[c],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(jl()):o==="	"?s.push(w0()):o!==""&&s.push(Zn(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=P4(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=P4(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:Zn(r)}}function P4(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,Rn(r)){const a=r.style.display;if(a===""&&!q_(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(Ec(r))return r;if(r.nodeName==="BR")return null}}const EB={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function dc(e){const t=EB[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:bb(e.style,t),node:null}}function Zn(e=""){return ii(new Vu(e))}function Wt(e){return e instanceof Vu}function bb(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),c=e.verticalAlign;return d=>(Wt(d)&&(s&&!d.hasFormat("bold")&&d.toggleFormat("bold"),a&&!d.hasFormat("strikethrough")&&d.toggleFormat("strikethrough"),i&&!d.hasFormat("italic")&&d.toggleFormat("italic"),o&&!d.hasFormat("underline")&&d.toggleFormat("underline"),c!=="sub"||d.hasFormat("subscript")||d.toggleFormat("subscript"),c!=="super"||d.hasFormat("superscript")||d.toggleFormat("superscript"),t&&!d.hasFormat(t)&&d.toggleFormat(t)),d)}class Ap extends Vu{static getType(){return"tab"}static clone(t){return new Ap(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=qh(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return w0().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&jt(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||jt(286),this}setDetail(t){return t!==2&&jt(127),this}setMode(t){return t!=="normal"&&jt(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function w0(){return ii(new Ap)}function Ly(e){return e instanceof Ap}class NB{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:HA(ho(Cc(this,"next")),ho(Cc(t,"next")))<0}getNode(){const t=Es(this.key);return t===null&&jt(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,jp()||(ku()===i&&ya(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function Fl(e,t,r){return new NB(e,t,r)}function Cw(e,t){let r=t.__key,n=e.offset,s="element";if(Wt(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!xt(t)){const a=t.getNextSibling();if(Wt(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function R4(e,t){if(xt(t)){const r=t.getLastDescendant();xt(r)||Wt(r)?Cw(e,r):Cw(e,t)}else Cw(e,t)}class By{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!ja(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new By(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(Wt(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=Es(s);a!==null&&n.push(a)}return jp()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if(($t()||_0())===this&&t[0]){const r=wa(t[0],"next");fU(Lu(r,r))}for(const r of t)r.remove()}}function Tt(e){return e instanceof xf}class xf{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Tt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,c=new Set;for(const d of n)if(Al(d)){const{origin:f}=d;s.length===0?o.add(f):(c.add(f),s.push(f))}else{const{origin:f}=d;xt(f)&&c.has(f)||s.push(f)}if(i&&s.push(i.caret.origin),of(n.focus)&&xt(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let d=xo(n.focus.origin,"previous");Al(d)&&o.has(d.origin)&&!d.origin.isEmpty()&&d.origin.is(s[s.length-1]);d=Hb(d))o.delete(d.origin),s.pop();for(;s.length>1;){const d=s[s.length-1];if(!xt(d)||c.has(d)||d.isEmpty()||o.has(d))break;s.pop()}if(s.length===0&&n.isCollapsed()){const d=ho(n.anchor),f=ho(n.anchor.getFlipped()),p=y=>Fu(y)?y.origin:y.getNodeAtCaret(),g=p(d)||p(f)||(n.anchor.getNodeAtCaret()?d.origin:f.origin);s.push(g)}return s})(KA(iE(this),"next"));return jp()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,c]=$_(this);let d="",f=!0;for(let p=0;p<t.length;p++){const g=t[p];if(xt(g)&&!g.isInline())f||(d+=`
`),f=!g.isEmpty();else if(f=!1,Wt(g)){let y=g.getTextContent();g===r?g===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(y=o<c?y.slice(o,c):y.slice(c,o)):y=i?y.slice(o):y.slice(c):g===n&&(y=i?y.slice(0,c):y.slice(0,o)),d+=y}else!Zr(g)&&!yc(g)||g===n&&this.isCollapsed()||(d+=g.getTextContent())}return d}applyDOMRange(t){const r=Vn(),n=r.getEditorState()._selection,s=bA(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),K1(this)}clone(){const t=this.anchor,r=this.focus;return new xf(Fl(t.key,t.offset,t.type),Fl(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=ny(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=ef[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(jl()):i==="	"?n.push(w0()):n.push(Zn(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(b,E,k,_){const N=b.getNode(),A=N.getChildAtIndex(b.offset),P=Zn();if(P.setFormat(k),P.setStyle(_),Ab(A))A.splice(0,0,[P]);else{const R=Ls(N)?Pn().append(P):P;A===null?N.append(R):A.insertBefore(R)}b.is(E)&&E.set(P.__key,0,"text"),b.set(P.__key,0,"text")})(i,o,s,a),o.type==="element"&&cf(o,ho(Cc(o,"next")));const c=i.offset;let d=o.offset;const f=this.getNodes(),p=f.length;let g=f[0];Wt(g)||jt(26);const y=g.getTextContent().length,v=g.getParentOrThrow();let w=f[p-1];if(p===1&&o.type==="element"&&(d=y,o.set(i.key,d,"text")),this.isCollapsed()&&c===y&&(hc(g)||!g.canInsertTextAfter()||!v.canInsertTextAfter()&&g.getNextSibling()===null)){let b=g.getNextSibling();if(Wt(b)&&b.canInsertTextBefore()&&!hc(b)||(b=Zn(),b.setFormat(s),b.setStyle(a),v.canInsertTextAfter()?g.insertAfter(b):v.insertAfter(b)),b.select(0,0),g=b,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(hc(g)||!g.canInsertTextBefore()||!v.canInsertTextBefore()&&g.getPreviousSibling()===null)){let b=g.getPreviousSibling();if(Wt(b)&&!hc(b)||(b=Zn(),b.setFormat(s),v.canInsertTextBefore()?g.insertBefore(b):v.insertBefore(b)),b.select(),g=b,t!=="")return void this.insertText(t)}else if(g.isSegmented()&&c!==y){const b=Zn(g.getTextContent());b.setFormat(s),g.replace(b),g=b}else if(!this.isCollapsed()&&t!==""){const b=w.getParent();if(!v.canInsertTextBefore()||!v.canInsertTextAfter()||xt(b)&&(!b.canInsertTextBefore()||!b.canInsertTextAfter()))return this.insertText(""),_A(this.anchor,this.focus,null),void this.insertText(t)}if(p===1){if(Hd(g)){const _=Zn(t);return _.select(),void g.replace(_)}const b=g.getFormat(),E=g.getStyle();if(c!==d||b===s&&E===a){if(Ly(g)){const _=Zn(t);return _.setFormat(s),_.setStyle(a),_.select(),void g.replace(_)}}else{if(g.getTextContent()!==""){const _=Zn(t);if(_.setFormat(s),_.setStyle(a),_.select(),c===0)g.insertBefore(_,!1);else{const[N]=g.splitText(c);N.insertAfter(_,!1)}return void(_.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}g.setFormat(s),g.setStyle(a)}const k=d-c;g=g.spliceText(c,k,t,!0),g.getTextContent()===""?g.remove():this.anchor.type==="text"&&(g.isComposing()?this.anchor.offset-=t.length:(this.format=b,this.style=E))}else{const b=new Set([...g.getParentKeys(),...w.getParentKeys()]),E=xt(g)?g:g.getParentOrThrow();let k=xt(w)?w:w.getParentOrThrow(),_=w;if(!E.is(k)&&k.isInline())do _=k,k=k.getParentOrThrow();while(k.isInline());if(o.type==="text"&&(d!==0||w.getTextContent()==="")||o.type==="element"&&w.getIndexWithinParent()<d)if(Wt(w)&&!Hd(w)&&d!==w.getTextContentSize()){if(w.isSegmented()){const T=Zn(w.getTextContent());w.replace(T),w=T}Ls(o.getNode())||o.type!=="text"||(w=w.spliceText(0,d,"")),b.add(w.__key)}else{const T=w.getParentOrThrow();T.canBeEmpty()||T.getChildrenSize()!==1?w.remove():T.remove()}else b.add(w.__key);const N=k.getChildren(),A=new Set(f),P=E.is(k),R=E.isInline()&&g.getNextSibling()===null?E:g;for(let T=N.length-1;T>=0;T--){const D=N[T];if(D.is(g)||xt(D)&&D.isParentOf(g))break;D.isAttached()&&(!A.has(D)||D.is(_)?P||R.insertAfter(D,!1):D.remove())}if(!P){let T=k,D=null;for(;T!==null;){const I=T.getChildren(),K=I.length;(K===0||I[K-1].is(D))&&(b.delete(T.__key),D=T),T=T.getParent()}}if(Hd(g))if(c===y)g.select();else{const T=Zn(t);T.select(),g.replace(T)}else g=g.spliceText(c,y-c,t,!0),g.getTextContent()===""?g.remove():g.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let T=1;T<p;T++){const D=f[T],I=D.__key;b.has(I)||D.remove()}}}removeText(){const t=$t()===this;D1(this,hU(iE(this))),t&&$t()!==this&&_a(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void ya(null);const n=this.getNodes(),s=[];for(const N of n)Wt(N)&&s.push(N);const a=N=>{n.forEach((A=>{if(xt(A)){const P=A.getFormatFlags(t,N);A.setTextFormat(P)}}))},i=s.length;if(i===0)return this.toggleFormat(t),ya(null),void a(r);const o=this.anchor,c=this.focus,d=this.isBackward(),f=d?c:o,p=d?o:c;let g=0,y=s[0],v=f.type==="element"?0:f.offset;if(f.type==="text"&&v===y.getTextContentSize()&&(g=1,y=s[1],v=0),y==null)return;const w=y.getFormatFlags(t,r);a(w);const b=i-1;let E=s[b];const k=p.type==="text"?p.offset:E.getTextContentSize();if(y.is(E)){if(v===k)return;if(hc(y)||v===0&&k===y.getTextContentSize())y.setFormat(w);else{const N=y.splitText(v,k),A=v===0?N[0]:N[1];A.setFormat(w),f.type==="text"&&f.set(A.__key,0,"text"),p.type==="text"&&p.set(A.__key,k-v,"text")}return void(this.format=w)}v===0||hc(y)||([,y]=y.splitText(v),v=0),y.setFormat(w);const _=E.getFormatFlags(t,w);k>0&&(k===E.getTextContentSize()||hc(E)||([E]=E.splitText(k)),E.setFormat(_));for(let N=g+1;N<b;N++){const A=s[N],P=A.getFormatFlags(t,_);A.setFormat(P)}f.type==="text"&&f.set(y.__key,v,"text"),p.type==="text"&&p.set(E.__key,k,"text"),this.format=w|_}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const v=$t();return Tt(v)||jt(134),v.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=jw(r,fo),s=t[t.length-1];if(xt(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const v=Tw(this);n.splice(v,0,t),s.selectEnd()}return}if(!t.some((v=>(xt(v)||Zr(v))&&!v.isInline()))){xt(n)||jt(211,r.constructor.name,r.getType());const v=Tw(this);return n.splice(v,0,t),void s.selectEnd()}const a=(function(v){const w=Pn();let b=null;for(let E=0;E<v.length;E++){const k=v[E],_=yc(k);if(_||Zr(k)&&k.isInline()||xt(k)&&k.isInline()||Wt(k)||k.isParentRequired()){if(b===null&&(b=k.createParentElementNode(),w.append(b),_))continue;b!==null&&b.append(k)}else w.append(k),b=null}return w})(t),i=a.getLastDescendant(),o=a.getChildren(),c=!xt(n)||!n.isEmpty()?this.insertParagraph():null,d=o[o.length-1];let f=o[0];var p;xt(p=f)&&fo(p)&&!p.isEmpty()&&xt(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(xt(n)||jt(211,r.constructor.name,r.getType()),n.append(...f.getChildren()),f=o[1]),f&&(n===null&&jt(212,r.constructor.name,r.getType()),(function(v,w,b){const E=w.getParentOrThrow().getLastChild();let k=w;const _=[w];for(;k!==E;)k.getNextSibling()||jt(140),k=k.getNextSibling(),_.push(k);let N=v;for(const A of _)N=N.insertAfter(A)})(n,f));const g=jw(i,fo);c&&xt(g)&&(c.canMergeWhenEmpty()||fo(d))&&(g.append(...c.getChildren()),c.remove()),xt(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const y=xt(n)?n.getLastChild():null;yc(y)&&g!==n&&y.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=Pn();return Un().splice(this.anchor.offset,0,[i]),i.select(),i}const t=Tw(this),r=jw(this.anchor.getNode(),fo);xt(r)||jt(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=jl();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[c,d]=$_(this);if(r===0)return[];if(r===1){if(Wt(i)&&!this.isCollapsed()){const p=c>d?d:c,g=c>d?c:d,y=i.splitText(p,g),v=p===0?y[0]:y[1];return v!=null?[v]:[]}return[i]}const f=s.isBefore(a);if(Wt(i)){const p=f?c:d;p===i.getTextContentSize()?t.shift():p!==0&&([,i]=i.splitText(p),t[0]=i)}if(Wt(o)){const p=o.getTextContent().length,g=f?d:c;g===0?t.pop():g!==p&&([o]=o.splitText(g),t[n]=o)}return t}modify(t,r,n){if($4(this,t,r,n))return;const s=t==="move",a=Vn(),i=Ko(po(a));if(!i)return;const o=a._blockCursorElement,c=a._rootElement,d=this.focus.getNode();if(c===null||o===null||!xt(d)||d.isInline()||d.canBeEmpty()||V_(o,a,c),this.dirty){let f=nf(a,this.anchor.key),p=nf(a,this.focus.key);this.anchor.type==="text"&&(f=i0(f)),this.focus.type==="text"&&(p=i0(p)),f&&p&&kA(i,f,this.anchor.offset,p,this.focus.offset)}if((function(f,p,g,y){f.modify(p,g,y)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const f=i.getRangeAt(0),p=this.anchor.getNode(),g=Ls(p)?p:QB(p);if(this.applyDOMRange(f),this.dirty=!0,!s){const y=this.getNodes(),v=[];let w=!1;for(let b=0;b<y.length;b++){const E=y[b];G_(E,g)?v.push(E):w=!0}if(w&&v.length>0)if(r){const b=v[0];xt(b)?b.selectStart():b.getParentOrThrow().selectStart()}else{const b=v[v.length-1];xt(b)?b.selectEnd():b.getParentOrThrow().selectEnd()}i.anchorNode===f.startContainer&&i.anchorOffset===f.startOffset||(function(b){const E=b.focus,k=b.anchor,_=k.key,N=k.offset,A=k.type;k.set(E.key,E.offset,E.type,!0),E.set(_,N,A,!0)})(this)}}n==="lineboundary"&&$4(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&xt(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(xt(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=Vb(Cc(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(Al(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(o.type==="merge-block")break;if(xt(a.anchor.origin)&&a.anchor.origin.isEmpty()){const d=ho(c);D1(this,Lu(d,d)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:c,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(of(c)){if(xt(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else o={block:c.origin,type:"merge-next-block"};continue}if(Zr(c.origin)){if(!c.origin.isIsolated())if(o.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&xt(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const d=Sb();d.add(c.origin.getKey()),_a(d)}else c.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:c,block:d}=o;return D1(this,Lu(!c.origin.isEmpty()&&d.isEmpty()?qb(wa(d,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&I4(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const c=i.offset,d=o.getTextContentSize();if(o.is(s)||t&&c!==d||!t&&c!==0)return void M4(o,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,d=s.getTextContentSize();if(s.is(o)||t&&c!==0||!t&&c!==d)return void M4(s,t,c)}(function(c,d){const f=c.anchor,p=c.focus,g=f.getNode(),y=p.getNode();if(g===y&&f.type==="text"&&p.type==="text"){const v=f.offset,w=p.offset,b=v<w,E=b?v:w,k=b?w:v,_=k-1;E!==_&&(function(N){return!(LA(N)||AB(N))})(g.getTextContent().slice(E,k))&&(d?p.set(p.key,_,p.type):f.set(f.key,_,f.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&Ls(n.getParent())&&n.getPreviousSibling()===null&&I4(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function ja(e){return e instanceof By}function D4(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function $_(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[D4(r),D4(n)]}function I4(e,t){for(let r=t;r;r=r.getParent()){if(xt(r)){if(r.collapseAtStart(e))return!0;if(si(r))break}if(r.getPreviousSibling())break}return!1}const AB=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function M4(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let d=0;d<a;d++){const f=d===a-1;if(o=i,i+=s[d].length,t&&i===r||i>r||f){s.splice(d,1),f&&(o=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(o,o))}function O4(e,t,r,n){let s,a=t;if(Rn(e)){let i=!1;const o=e.childNodes,c=o.length,d=n._blockCursorElement;a===c&&(i=!0,a=c-1);let f=o[a],p=!1;if(f===d)f=o[a+1],p=!0;else if(d!==null){const g=d.parentNode;e===g&&t>Array.prototype.indexOf.call(g.children,d)&&a--}if(s=$h(f),Wt(s))a=Pu(s,i?"next":"previous");else{let g=$h(e);if(g===null)return null;if(xt(g)){const y=n.getElementByKey(g.getKey());y===null&&jt(214),[g,a]=g.getDOMSlot(y).resolveChildIndex(g,y,e,t),xt(g)||jt(215),i&&a>=g.getChildrenSize()&&(a=Math.max(0,g.getChildrenSize()-1));let w=g.getChildAtIndex(a);if(xt(w)&&(function(b,E,k){const _=b.getParent();return k===null||_===null||!_.canBeEmpty()||_!==k.getNode()})(w,0,r)){const b=i?w.getLastDescendant():w.getFirstDescendant();b===null?g=w:(w=b,g=xt(w)?w:w.getParentOrThrow()),a=0}Wt(w)?(s=w,g=null,a=Pu(w,i?"next":"previous")):w!==g&&i&&!p&&(xt(g)||jt(216),a=Math.min(g.getChildrenSize(),a+1))}else{const y=g.getIndexWithinParent();a=t===0&&Zr(g)&&$h(e)===g?y:y+1,g=g.getParentOrThrow()}if(xt(g))return Fl(g.__key,a,"element")}}else s=$h(e);return Wt(s)?Fl(s.__key,Pu(s,a,"clamp"),"text"):null}function L4(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&xt(i)&&i.isInline()){const o=i.getPreviousSibling();Wt(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else xt(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):Wt(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&xt(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&xt(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();Wt(o)&&e.set(o.__key,0,"text")}}}function _A(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);L4(e,n,s),L4(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=Vn();if(a.isComposing()&&a._compositionKey!==e.key&&Tt(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function bA(e,t,r,n,s,a){if(e===null||r===null||!Rp(s,e,r))return null;const i=O4(e,t,Tt(a)?a.anchor:null,s);if(i===null)return null;const o=O4(r,n,Tt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const c=$h(e),d=$h(r);if(Zr(c)&&Zr(d))return null}return _A(i,o,a),[i,o]}function W_(e){return xt(e)&&!e.isInline()}function SA(e,t,r,n,s,a){const i=Ku(),o=new xf(Fl(e,t,s),Fl(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function Uy(){const e=Fl("root",0,"element"),t=Fl("root",0,"element");return new xf(e,t,0,"")}function Sb(){return new By(new Set)}function kb(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",c=!T_&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let d,f,p,g;if(Tt(e)&&!c)return e.clone();if(t===null)return null;if(d=t.anchorNode,f=t.focusNode,p=t.anchorOffset,g=t.focusOffset,o&&Tt(e)&&!Rp(r,d,f))return e.clone();const y=bA(d,p,f,g,r,e);if(y===null)return null;const[v,w]=y;return new xf(v,w,Tt(e)?e.format:0,Tt(e)?e.style:"")}function $t(){return Ku()._selection}function _0(){return Vn()._editorState._selection}function ey(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const c=t.__key;if(e.isCollapsed()){const d=s.offset;if(r<=d&&n>0||r<d&&n<0){const f=Math.max(0,d+n);s.set(c,f,"element"),a.set(c,f,"element"),B4(e)}}else{const d=e.isBackward(),f=d?a:s,p=f.getNode(),g=d?s:a,y=g.getNode();if(t.is(p)){const v=f.offset;(r<=v&&n>0||r<v&&n<0)&&f.set(c,Math.max(0,v+n),"element")}if(t.is(y)){const v=g.offset;(r<=v&&n>0||r<v&&n<0)&&g.set(c,Math.max(0,v+n),"element")}}B4(e)}function B4(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!xt(a))return;const o=a.getChildrenSize(),c=r>=o,d=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(Wt(d)){let f=0;c&&(f=d.getTextContentSize()),t.set(d.__key,f,"text"),n.set(d.__key,f,"text")}}else{if(xt(a)){const o=a.getChildrenSize(),c=r>=o,d=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(Wt(d)){let f=0;c&&(f=d.getTextContentSize()),t.set(d.__key,f,"text")}}if(xt(i)){const o=i.getChildrenSize(),c=s>=o,d=c?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(Wt(d)){let f=0;c&&(f=d.getTextContentSize()),n.set(d.__key,f,"text")}}}}function ty(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,Wt(n)?(i=n.getTextContentSize(),o="text"):xt(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,Wt(s)?o="text":xt(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function U4(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function kA(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function jB(e,t,r,n,s,a,i){const o=n.anchorNode,c=n.focusNode,d=n.anchorOffset,f=n.focusOffset,p=document.activeElement;if(s.has(jA)&&p!==a||p!==null&&Pb(p))return;if(!Tt(t))return void(e!==null&&Rp(r,o,c)&&n.removeAllRanges());const g=t.anchor,y=t.focus,v=g.key,w=y.key,b=nf(r,v),E=nf(r,w),k=g.offset,_=y.offset,N=t.format,A=t.style,P=t.isCollapsed();let R=b,T=E,D=!1;if(g.type==="text"){R=i0(b);const q=g.getNode();D=q.getFormat()!==N||q.getStyle()!==A}else Tt(e)&&e.anchor.type==="text"&&(D=!0);var I,K,X,Z,oe;if(y.type==="text"&&(T=i0(E)),R!==null&&T!==null&&(P&&(e===null||D||Tt(e)&&(e.format!==N||e.style!==A))&&(I=N,K=A,X=k,Z=v,oe=performance.now(),hA=[I,K,X,Z,oe]),d!==k||f!==_||o!==R||c!==T||n.type==="Range"&&P||(p!==null&&a.contains(p)||a.focus({preventScroll:!0}),g.type==="element"))){if(kA(n,R,k,T,_),!s.has(OB)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const q=Tt(t)&&t.anchor.type==="element"?R.childNodes[k]||null:n.rangeCount>0?n.getRangeAt(0):null;if(q!==null){let re;if(q instanceof Text){const M=document.createRange();M.selectNode(q),re=M.getBoundingClientRect()}else re=q.getBoundingClientRect();(function(M,W,B){const G=WA(B),H=Lb(G);if(G===null||H===null)return;let{top:O,bottom:z}=W,Y=0,J=0,te=B;for(;te!==null;){const ee=te===G.body;if(ee)Y=0,J=po(M).innerHeight;else{const me=te.getBoundingClientRect();Y=me.top,J=me.bottom}let ie=0;if(O<Y?ie=-(Y-O):z>J&&(ie=z-J),ie!==0)if(ee)H.scrollBy(0,ie);else{const me=te.scrollTop;te.scrollTop+=ie;const Ce=te.scrollTop-me;O-=Ce,z-=Ce}if(ee)break;te=Dp(te)}})(r,re,a)}}L_=!0}}function FB(e){let t=$t()||_0();t===null&&(t=Un().selectEnd()),t.insertNodes(e)}function Tw(e){let t=e;e.isCollapsed()||t.removeText();const r=$t();Tt(r)&&(t=r),Tt(t)||jt(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!fo(s);){const i=s;if([s,a]=PB(s,a),i.is(s))break}return a}function PB(e,t){const r=e.getParent();if(!r){const s=Pn();return Un().append(s),s.select(),[Un(),0]}if(Wt(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!xt(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new xf(Fl(e.__key,t,"element"),Fl(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function $4(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[f,p]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return p.set(f.key,f.offset,f.type),!0}const a=Cc(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let c=a,d=s==="decorators-and-blocks";if(!VA(c)){for(const f of c){d=!1;const{origin:p}=f;if(!Zr(p)||p.isIsolated()||(c=f,!i||!p.isInline()))break}if(d)for(const f of Vb(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(Al(f))f.origin.isInline()||(c=f);else{if(xt(f.origin))continue;Zr(f.origin)&&!f.origin.isInline()&&(c=f)}break}}if(c===a)return!1;if(o&&!i&&Zr(c.origin)&&c.origin.isKeyboardSelectable()){const f=Sb();return f.add(c.origin.getKey()),_a(f),!0}return c=ho(c),o&&cf(e.anchor,c),cf(e.focus,c),d||!i}let Qs=null,Js=null,bi=!1,Ew=!1,P1=0;const W4={characterData:!0,childList:!0,subtree:!0};function jp(){return bi||Qs!==null&&Qs._readOnly}function xa(){bi&&jt(13)}function CA(){P1>99&&jt(14)}function Ku(){return Qs===null&&jt(195,TA()),Qs}function Vn(){return Js===null&&jt(196,TA()),Js}function TA(){let e=0;const t=new Set,r=zy.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=Hy(s);if(Rb(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function RB(){return Js}function z4(e,t,r){const n=t.__type,s=PA(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function H4(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function EA(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function DB(e){return Cb(e,Vn()._nodes)}function Cb(e,t){const r=e.type,n=t.get(r);n===void 0&&jt(17,r);const s=n.klass;e.type!==s.getType()&&jt(18,s.name);const a=s.importJSON(e),i=e.children;if(xt(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const c=Cb(i[o],t);a.append(c)}return a}function G4(e,t,r){const n=Qs,s=bi,a=Js;Qs=t,bi=!0,Js=e;try{return r()}finally{Qs=n,bi=s,Js=a}}function mc(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,c=e._dirtyType!==Zd,d=Qs,f=bi,p=Js,g=e._updating,y=e._observer;let v=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&y!==null){Js=e,Qs=r,bi=!1,e._updating=!0;try{const P=e._dirtyType,R=e._dirtyElements,T=e._dirtyLeaves;y.disconnect(),v=lB(a,r,e,P,R,T)}catch(P){if(P instanceof Error&&e._onError(P),Ew)throw P;return FA(e,null,n,r),H6(e),e._dirtyType=a0,Ew=!0,mc(e,a),void(Ew=!1)}finally{y.observe(n,W4),e._updating=g,Qs=d,bi=f,Js=p}}r._readOnly||(r._readOnly=!0);const w=e._dirtyLeaves,b=e._dirtyElements,E=e._normalizedNodes,k=e._updateTags,_=e._deferred;c&&(e._dirtyType=Zd,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(P,R){const T=P._decorators;let D=P._pendingDecorators||T;const I=R._nodeMap;let K;for(K in D)I.has(K)||(D===T&&(D=MA(P)),delete D[K])})(e,r);const N=s?null:Ko(po(e));if(e._editable&&N!==null&&(c||o===null||o.dirty)&&n!==null&&!k.has(LB)){Js=e,Qs=r;try{if(y!==null&&y.disconnect(),c||o===null||o.dirty){const P=e._blockCursorElement;P!==null&&V_(P,e,n),jB(i,o,e,N,k,n)}(function(P,R,T){let D=P._blockCursorElement;if(Tt(T)&&T.isCollapsed()&&T.anchor.type==="element"&&R.contains(document.activeElement)){const I=T.anchor,K=I.getNode(),X=I.offset;let Z=!1,oe=null;if(X===K.getChildrenSize())Aw(K.getChildAtIndex(X-1))&&(Z=!0);else{const q=K.getChildAtIndex(X);if(q!==null&&Aw(q)){const re=q.getPreviousSibling();(re===null||Aw(re))&&(Z=!0,oe=P.getElementByKey(q.__key))}}if(Z){const q=P.getElementByKey(K.__key);return D===null&&(P._blockCursorElement=D=(function(re){const M=re.theme,W=document.createElement("div");W.contentEditable="false",W.setAttribute("data-lexical-cursor","true");let B=M.blockCursor;if(B!==void 0){if(typeof B=="string"){const G=B6(B);B=M.blockCursor=G}B!==void 0&&W.classList.add(...B)}return W})(P._config)),R.style.caretColor="transparent",void(oe===null?q.appendChild(D):q.insertBefore(D,oe))}}D!==null&&V_(D,P,R)})(e,n,o)}finally{y!==null&&y.observe(n,W4),Js=p,Qs=d}}v!==null&&(function(P,R,T,D,I){const K=Array.from(P._listeners.mutation),X=K.length;for(let Z=0;Z<X;Z++){const[oe,q]=K[Z];for(const re of q){const M=R.get(re);M!==void 0&&oe(M,{dirtyLeaves:D,prevEditorState:I,updateTags:T})}}})(e,v,k,w,a),Tt(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(Q6,void 0);const A=e._pendingDecorators;A!==null&&(e._decorators=A,e._pendingDecorators=null,Pm("decorator",e,!0,A)),(function(P,R,T){const D=Y4(R),I=Y4(T);D!==I&&Pm("textcontent",P,!0,I)})(e,t||a,r),Pm("update",e,!0,{dirtyElements:b,dirtyLeaves:w,editorState:r,mutatedNodes:v,normalizedNodes:E,prevEditorState:t||a,tags:k}),(function(P,R){if(P._deferred=[],R.length!==0){const T=P._updating;P._updating=!0;try{for(let D=0;D<R.length;D++)R[D]()}finally{P._updating=T}}})(e,_),(function(P){const R=P._updates;if(R.length!==0){const T=R.shift();if(T){const[D,I]=T;$y(P,D,I)}}})(e)}function Pm(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function V4(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&jt(191),o._flushSync=!0),c&&e._deferred.push(c),EA(e,i.tag)),o==null?$y(e,a,i):a()}}return n}function $y(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,EA(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let c=e._pendingEditorState,d=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=NA(c||o),d=!0),c._flushSync=i;const f=Qs,p=bi,g=Js,y=e._updating;Qs=c,bi=!1,e._updating=!0,Js=e;const v=e._headless||e.getRootElement()===null;jb(null);try{d&&(v?o._selection!==null&&(c._selection=o._selection.clone()):c._selection=(function(k,_){const N=k.getEditorState()._selection,A=Ko(po(k));return Tt(N)||N==null?kb(N,A,k,_):N.clone()})(e,r&&r.event||null));const b=e._compositionKey;t(),a=V4(e,a),(function(k,_){const N=_.getEditorState()._selection,A=k._selection;if(Tt(A)){const P=A.anchor,R=A.focus;let T;if(P.type==="text"&&(T=P.getNode(),T.selectionTransform(N,A)),R.type==="text"){const D=R.getNode();T!==D&&D.selectionTransform(N,A)}}})(c,e),e._dirtyType!==Zd&&(a?(function(k,_){const N=_._dirtyLeaves,A=k._nodeMap;for(const P of N){const R=A.get(P);Wt(R)&&R.isAttached()&&R.isSimpleText()&&!R.isUnmergeable()&&b4(R)}})(c,e):(function(k,_){const N=_._dirtyLeaves,A=_._dirtyElements,P=k._nodeMap,R=ku(),T=new Map;let D=N,I=D.size,K=A,X=K.size;for(;I>0||X>0;){if(I>0){_._dirtyLeaves=new Set;for(const Z of D){const oe=P.get(Z);Wt(oe)&&oe.isAttached()&&oe.isSimpleText()&&!oe.isUnmergeable()&&b4(oe),oe!==void 0&&H4(oe,R)&&z4(_,oe,T),N.add(Z)}if(D=_._dirtyLeaves,I=D.size,I>0){P1++;continue}}_._dirtyLeaves=new Set,_._dirtyElements=new Map,K.delete("root")&&K.set("root",!0);for(const Z of K){const oe=Z[0],q=Z[1];if(A.set(oe,q),!q)continue;const re=P.get(oe);re!==void 0&&H4(re,R)&&z4(_,re,T)}D=_._dirtyLeaves,I=D.size,K=_._dirtyElements,X=K.size,P1++}_._dirtyLeaves=N,_._dirtyElements=A})(c,e),V4(e),(function(k,_,N,A){const P=k._nodeMap,R=_._nodeMap,T=[];for(const[D]of A){const I=R.get(D);I!==void 0&&(I.isAttached()||(xt(I)&&$6(I,D,P,R,T,A),P.has(D)||A.delete(D),T.push(D)))}for(const D of T)R.delete(D);for(const D of N){const I=R.get(D);I===void 0||I.isAttached()||(P.has(D)||N.delete(D),R.delete(D))}})(o,c,e._dirtyLeaves,e._dirtyElements)),b!==e._compositionKey&&(c._flushSync=!0);const E=c._selection;if(Tt(E)){const k=c._nodeMap,_=E.anchor.key,N=E.focus.key;k.get(_)!==void 0&&k.get(N)!==void 0||jt(19)}else ja(E)&&E._nodes.size===0&&(c._selection=null)}catch(b){return b instanceof Error&&e._onError(b),e._pendingEditorState=o,e._dirtyType=a0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void mc(e)}finally{Qs=f,bi=p,Js=g,e._updating=y,P1=0}e._dirtyType!==Zd||e._deferred.length>0||(function(b,E){const k=E.getEditorState()._selection,_=b._selection;if(_!==null){if(_.dirty||!_.is(k))return!0}else if(k!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,mc(e)):d&&zB((()=>{mc(e)})):(c._flushSync=!1,d&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function Ii(e,t,r){Js===e&&r===void 0?t():$y(e,t,r)}class Rm{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new Rm(this.element,t,this.after)}withAfter(t){return new Rm(this.element,this.before,t)}withElement(t){return this.element===t?this:new Rm(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&jt(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&jt(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&jt(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(s0||Jm);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=K4(r,n);a.push(s);const i=K4(r,this.element);let o=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const d=a[c],f=i[c];if(d===void 0||d<f)break;if(d>f){o+=1;break}}return[t.getParentOrThrow(),o]}}function K4(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&jt(225),r.reverse()}class Ba extends v0{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return XL[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=Vn()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(Wt(r)&&t.push(r),xt(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;xt(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;xt(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return xt(a)&&a.getLastDescendant()||a||null}const s=r[t];return xt(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:Es(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&jt(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:Es(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&jt(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),xt(a)&&s!==n-1&&!a.isInline()&&(t+=kc)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),xt(a)&&s!==n-1&&!a.isInline()&&(t+=kc.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=g4[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=ef[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return ny(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){xa();const n=$t();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(Wt(c)||xt(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(Wt(c)||xt(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return Tt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):SA(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?g4[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||jt(226,String(t),String(r),String(a));const o=i.__key,c=[],d=[],f=this.getChildAtIndex(t+r);let p=null,g=a-r+s;if(t!==0)if(t===a)p=this.getLastChild();else{const v=this.getChildAtIndex(t);v!==null&&(p=v.getPreviousSibling())}if(r>0){let v=p===null?this.getFirstChild():p.getNextSibling();for(let w=0;w<r;w++){v===null&&jt(100);const b=v.getNextSibling(),E=v.__key;Gd(v.getWritable()),d.push(E),v=b}}let y=p;for(let v=0;v<s;v++){const w=n[v];y!==null&&w.is(y)&&(p=y=y.getPreviousSibling());const b=w.getWritable();b.__parent===o&&g--,Gd(b);const E=w.__key;if(y===null)i.__first=E,b.__prev=null;else{const k=y.getWritable();k.__next=E,b.__prev=k.__key}w.__key===o&&jt(76),b.__parent=o,c.push(E),y=w}if(t+r===a)y!==null&&(y.getWritable().__next=null,i.__last=y.__key);else if(f!==null){const v=f.getWritable();if(y!==null){const w=y.getWritable();v.__prev=y.__key,w.__next=f.__key}else v.__prev=null}if(i.__size=g,d.length){const v=$t();if(Tt(v)){const w=new Set(d),b=new Set(c),{anchor:E,focus:k}=v;q4(E,w,b)&&ty(E,E.getNode(),this,p,f),q4(k,w,b)&&ty(k,k.getNode(),this,p,f),g!==0||this.canBeEmpty()||si(this)||this.remove()}}return i}getDOMSlot(t){return new Rm(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(Rn(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function xt(e){return e instanceof Ba}function q4(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class Tb extends v0{decorate(t,r){jt(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Zr(e){return e instanceof Tb}class Fp extends Ba{static getType(){return"root"}static clone(){return new Fp}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){jt(51)}getTextContent(){const t=this.__cachedText;return!jp()&&Vn()._dirtyType!==Zd||t===null?super.getTextContent():t}remove(){jt(52)}replace(t){jt(53)}insertBefore(t){jt(54)}insertAfter(t){jt(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)xt(s)||Zr(s)||jt(282);return super.splice(t,r,n)}static importJSON(t){return Un().updateFromJSON(t)}collapseAtStart(){return!0}}function Ls(e){return e instanceof Fp}function NA(e){return new Wy(new Map(e._nodeMap))}function Eb(){return new Wy(new Map([["root",new Fp]]))}function AA(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&jt(130,r.name),xt(e)){const n=t.children;Array.isArray(n)||jt(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=AA(s[a]);n.push(i)}}return t}class Wy{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return G4(r&&r.editor||null,this,t)}clone(t){const r=new Wy(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return G4(null,this,(()=>({root:AA(Un())})))}}const ry="historic",IB="history-push",Dm="history-merge",MB="paste",jA="collaboration",OB="skip-scroll-into-view",LB="skip-dom-selection";class Nb extends Ba{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class Pp extends Ba{static getType(){return"paragraph"}static clone(t){return new Pp(t.__key)}createDOM(t){const r=document.createElement("p"),n=qh(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:BB,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(Rn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return Pn().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=Pn();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||Wt(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function BB(e){const t=Pn();return e.style&&(t.setFormat(e.style.textAlign),Ub(e,t)),{node:t}}function Pn(){return ii(new Pp)}function Ab(e){return e instanceof Pp}const Gr=0,Ph=1,UB=4;function FA(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=Eb(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=Zd,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function $B(e){const t=e||{},r=RB(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=Eb(),o=t.namespace||(s!==null?s._config.namespace:BA()),c=t.editorState,d=[Fp,Vu,Np,Ap,Pp,Nb,...t.nodes||[]],{onError:f,html:p}=t,g=t.editable===void 0||t.editable;let y;if(e===void 0&&r!==null)y=r._nodes;else{y=new Map;for(let w=0;w<d.length;w++){let b=d[w],E=null,k=null;if(typeof b!="function"){const R=b;b=R.replace,E=R.with,k=R.withKlass||null}const{ownNodeConfig:_}=$b(b),N=b.getType(),A=b.transform(),P=new Set;_&&_.$transform&&P.add(_.$transform),A!==null&&P.add(A),y.set(N,{exportDOM:p&&p.export?p.export.get(b):void 0,klass:b,replace:E,replaceWithKlass:k,sharedNodeState:nB(d[w]),transforms:P})}}const v=new zy(i,s,y,{disableEvents:a,namespace:o,theme:n},f||console.error,(function(w,b){const E=new Map,k=new Set,_=N=>{Object.keys(N).forEach((A=>{let P=E.get(A);P===void 0&&(P=[],E.set(A,P)),P.push(N[A])}))};return w.forEach((N=>{const A=N.klass.importDOM;if(A==null||k.has(A))return;k.add(A);const P=A.call(N.klass);P!==null&&_(P)})),b&&_(b),E})(y,p?p.import:void 0),g,e);return c!==void 0&&(v._pendingEditorState=c,v._dirtyType=a0),v}class zy{constructor(t,r,n,s,a,i,o,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=Zd,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=BA(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&jt(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&jt(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&jt(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=nE(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const c=nE(i.getEditorState()),d=[];for(const f of o){const p=c.get(f);p&&d.push(p)}d.length!==0&&i.update((()=>{for(const f of d)for(const p of f.keys()){const g=Es(p);g&&g.markDirty()}}),i._pendingEditorState===null?{tag:Dm}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return tr(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=qh(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,FA(this,r,t,s),r!==null&&(this._config.disableEvents||_B(r),n!=null&&r.classList.remove(...n)),t!==null){const a=Lb(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=a0,H6(this),this._updateTags.add(Dm),mc(this),this._config.disableEvents||(function(o,c){const d=o.ownerDocument,f=Z1.get(d);(f===void 0||f<1)&&d.addEventListener("selectionchange",yA),Z1.set(d,(f||0)+1),o.__lexicalEditor=c;const p=xA(o);for(let g=0;g<O_.length;g++){const[y,v]=O_[g],w=typeof v=="function"?b=>{A4(b)||(N4(b),(c.isEditable()||y==="click")&&v(b,c))}:b=>{if(A4(b))return;N4(b);const E=c.isEditable();switch(y){case"cut":return E&&tr(c,_b,b);case"copy":return tr(c,Oy,b);case"paste":return E&&tr(c,yb,b);case"dragstart":return E&&tr(c,cA,b);case"dragover":return E&&tr(c,uA,b);case"dragend":return E&&tr(c,mB,b);case"focus":return E&&tr(c,yB,b);case"blur":return E&&tr(c,vB,b);case"drop":return E&&tr(c,oA,b)}};o.addEventListener(y,w),p.push((()=>{o.removeEventListener(y,w)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Dm),mc(this);Pm("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&jt(38);let n=t;n._readOnly&&(n=NA(t),n._selection=t._selection?t._selection.clone():null),z6(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),mc(this)),this._pendingEditorState=n,this._dirtyType=a0,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||mc(this)}parseEditorState(t,r){return(function(n,s,a){const i=Eb(),o=Qs,c=bi,d=Js,f=s._dirtyElements,p=s._dirtyLeaves,g=s._cloneNotNeeded,y=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,Qs=i,bi=!1,Js=s,jb(null);try{const v=s._nodes;Cb(n.root,v),a&&a(),i._readOnly=!0}catch(v){v instanceof Error&&s._onError(v)}finally{s._dirtyElements=f,s._dirtyLeaves=p,s._cloneNotNeeded=g,s._dirtyType=y,Qs=o,bi=c,Js=d}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return mc(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):$y(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Ii(this,(()=>{const s=$t(),a=Un();s!==null?s.dirty||_a(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),qB("focus"),XB((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=Ko(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,Pm("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}zy.version="0.35.0+prod.esm";let z_=null;function jb(e){z_=e}let WB=1;function PA(e,t){const r=Fb(e,t);return r===void 0&&jt(30,t),r}function Fb(e,t){return e._nodes.get(t)}const zB=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function X4(e){return Zr(Ou(e))}function Pb(e){const t=document.activeElement;if(!Rn(t))return!1;const r=t.nodeName;return Zr(Ou(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&Hy(t)==null)}function Rp(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!Pb(t)&&RA(t)===e}catch{return!1}}function Rb(e){return e instanceof zy}function RA(e){let t=e;for(;t!=null;){const r=Hy(t);if(Rb(r))return r;t=Dp(t)}return null}function Hy(e){return e?e.__lexicalEditor:null}function Hd(e){return Ly(e)||e.isToken()}function hc(e){return Hd(e)||e.isSegmented()}function Ec(e){return b0(e)&&e.nodeType===UL}function HB(e){return b0(e)&&e.nodeType===$L}function i0(e){let t=e;for(;t!=null;){if(Ec(t))return t;t=t.firstChild}return null}function ny(e,t,r){const n=ef[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function DA(e){return Wt(e)||yc(e)||Zr(e)}function GB(e,t){const r=(function(){const i=z_;return z_=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);xa(),CA();const n=Vn(),s=Ku(),a=""+WB++;s._nodeMap.set(a,e),xt(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=U6,e.__key=a}function Gd(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,c=s!==null?s.getWritable():null,d=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),c!==null&&(c.__next=i),d!==null&&(d.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function sy(e){CA();const t=e.getLatest(),r=t.__parent,n=Ku(),s=Vn(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,d,f){let p=c;for(;p!==null;){if(f.has(p))return;const g=d.get(p);if(g===void 0)break;f.set(p,!1),p=g.__parent}})(r,a,i);const o=t.__key;s._dirtyType=U6,xt(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function ya(e){xa();const t=Vn(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=Es(r);n!==null&&n.getWritable()}if(e!==null){const n=Es(e);n!==null&&n.getWritable()}}}function ku(){return jp()?null:Vn()._compositionKey}function Es(e,t){const r=(t||Ku())._nodeMap.get(e);return r===void 0?null:r}function IA(e,t){const r=Gy(e,Vn());return r!==void 0?Es(r,t):null}function Gy(e,t){return e[`__lexicalKey_${t._key}`]}function Ou(e,t){let r=e;for(;r!=null;){const n=IA(r,t);if(n!==null)return n;r=Dp(r)}return null}function MA(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function Y4(e){return e.read((()=>Un().getTextContent()))}function Un(){return OA(Ku())}function OA(e){return e._nodeMap.get("root")}function _a(e){xa();const t=Ku();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function $h(e){const t=Vn(),r=(function(n,s){let a=n;for(;a!=null;){const i=Gy(a,s);if(i!==void 0)return i;a=Dp(a)}return null})(e,t);return r===null?e===t.getRootElement()?Es("root"):null:Es(r)}function LA(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Db(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function BA(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function UA(e){return Ec(e)?e.nodeValue:null}function Ib(e,t,r){const n=Ko(po(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=UA(s);const c=Ou(s);if(o!==null&&Wt(c)){if(o===Iy&&r){const d=r.length;o=r,a=d,i=d}o!==null&&Mb(c,o,a,i,e)}}}function Mb(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===Iy&&(o=t.slice(0,-1));const c=a.getTextContent();if(s||o!==c){if(o===""){if(ya(null),Jm||s0||H1)a.remove();else{const w=Vn();setTimeout((()=>{w.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const d=a.getParent(),f=_0(),p=a.getTextContentSize(),g=ku(),y=a.getKey();if(a.isToken()||g!==null&&y===g&&!i||Tt(f)&&(d!==null&&!d.canInsertTextBefore()&&f.anchor.offset===0||f.anchor.key===e.__key&&f.anchor.offset===0&&!a.canInsertTextBefore()&&!i||f.focus.key===e.__key&&f.focus.offset===p&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const v=$t();if(!Tt(v)||r===null||n===null)return void Q4(a,o,v);if(v.setTextNodeRange(a,r,a,n),a.isSegmented()){const w=Zn(a.getTextContent());a.replace(w),a=w}Q4(a,o,v)}}}function Q4(e,t,r){if(e.setTextContent(t),Tt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=Pu(e,a.offset,"clamp"))}}}function c1(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function VB(e,t){return c1(e,t,"altKey")&&c1(e,t,"ctrlKey")&&c1(e,t,"shiftKey")&&c1(e,t,"metaKey")}function on(e,t,r){return VB(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const fc={ctrlKey:!bl,metaKey:bl},J4={altKey:bl,ctrlKey:!bl};function Z4(e){return e.key==="Backspace"}function eE(e){return on(e,"a",fc)}function KB(e){const t=Un();if(Tt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),K1(e),e}{const r=t.select(0,t.getChildrenSize());return _a(K1(r)),r}}function qh(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=B6(s);return r[t]=a,a}return s}function Ob(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&jt(33,a);const c=o.klass;let d=e.get(c);d===void 0&&(d=new Map,e.set(c,d));const f=d.get(i),p=f==="destroyed"&&s==="created";(f===void 0||p)&&d.set(i,p?"updated":s)}function tE(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function H_(e,t){const r=e.offset;if(e.type==="element")return tE(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?tE(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function $A(e){const t=po(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function tr(e,t,r){return(function(n,s,a){const i=Db(n);for(let o=4;o>=0;o--)for(let c=0;c<i.length;c++){const d=i[c],f=d._commands.get(s);if(f!==void 0){const p=f[o];if(p!==void 0){const g=Array.from(p),y=g.length;let v=!1;if(Ii(d,(()=>{for(let w=0;w<y;w++)if(g[w](a,n))return void(v=!0)})),v)return v}}}return!1})(e,t,r)}function Vy(e){return!Ls(e)&&!e.isLastChild()&&!e.isInline()}function nf(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&jt(75,t),r}function Dp(e){const t=e.assignedSlot||e.parentElement;return K_(t)?t.host:t}function WA(e){return HB(e)?e:Rn(e)?e.ownerDocument:null}function qB(e){xa(),Vn()._updateTags.add(e)}function XB(e){xa(),Vn()._deferred.push(e)}function G_(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function Lb(e){const t=WA(e);return t?t.defaultView:null}function po(e){const t=e._window;return t===null&&jt(78),t}function YB(e){return xt(e)&&e.isInline()||Zr(e)&&e.isInline()}function QB(e){let t=e.getParentOrThrow();for(;t!==null;){if(si(t))return t;t=t.getParentOrThrow()}return t}function si(e){return Ls(e)||xt(e)&&e.isShadowRoot()}function ii(e){const t=Vn(),r=e.getType(),n=Fb(t,r);n===void 0&&jt(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||jt(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||jt(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&jt(203,e.constructor.name,r,o.name,o.getType()),i}return e}function Nw(e,t){!Ls(e.getParent())||xt(t)||Zr(t)||jt(99)}function JB(e){const t=Es(e);return t===null&&jt(63,e),t}function Aw(e){return(Zr(e)||xt(e)&&!e.canBeEmpty())&&!e.isInline()}function V_(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function Ko(e){return qo?(e||window).getSelection():null}function ZB(e){const t=Lb(e);return t?t.getSelection():null}function zA(e){return Rn(e)&&e.tagName==="A"}function Rn(e){return b0(e)&&e.nodeType===BL}function b0(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function K_(e){return b0(e)&&e.nodeType===WL}function q_(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function ay(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function fo(e){if(Zr(e)&&!e.isInline())return!0;if(!xt(e)||si(e))return!1;const t=e.getFirstChild(),r=t===null||yc(t)||Wt(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function jw(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function Ip(){return Vn()}const rE=new WeakMap,eU=new Map;function nE(e){if(!e._readOnly&&e.isEmpty())return eU;e._readOnly||jt(192);let t=rE.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),rE.set(e,t)),t}function Bb(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function Ub(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function tU(e){e.__lexicalUnmanaged=!0}function rU(e){return e.__lexicalUnmanaged===!0}function gm(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==v0[t]}function $b(e){const t=m4 in e.prototype?e.prototype[m4]():void 0,r=(function(i){return i===Tb||i===Ba||i===v0})(e),n=!r&&gm(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(gm(e,"getType")||(e.getType=()=>a),gm(e,"clone")||(e.clone=i=>(jb(i),new e)),gm(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!gm(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function nU(e){const t=Ip();return xa(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const sU={next:"previous",previous:"next"};class Wb{constructor(t){this.origin=t}[Symbol.iterator](){return Kb({hasNext:of,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return wa(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return wa(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let c=a.getAdjacentCaret();c!==null&&o.size<t;c=c.getAdjacentCaret()){const d=c.origin.getWritable();o.set(d.getKey(),d)}for(const c of s){if(o.size>0){const d=a.getNodeAtCaret();if(d){if(o.delete(d.getKey()),o.delete(c.getKey()),!(d.is(c)||a.origin.is(c))){const f=c.getParent();f&&f.is(i)&&c.remove(),d.replace(c)}}else d===null&&jt(263,Array.from(o).join(" "))}else a.insert(c);a=wa(c,this.direction)}for(const c of o.values())c.remove();return this}}class sp extends Wb{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:xo(t,this.direction)}getParentCaret(t="root"){return wa(zb(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=S0(this.direction);return wa(this.getNodeAtCaret(),t)||xo(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof sp&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const aU={root:Ls,shadowRoot:si};function S0(e){return sU[e]}function zb(e,t="root"){return aU[t](e)?null:e}class sf extends Wb{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:wa(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return xt(this.origin)?xo(this.origin,this.direction):null}getParentCaret(t="root"){return wa(zb(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=S0(this.direction);return wa(this.getNodeAtCaret(),t)||xo(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof sf&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof sf||t instanceof af)&&this.direction===t.direction&&this.origin.is(t.origin)}}class af extends Wb{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:lf(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return wa(zb(this.getParentAtCaret(),t),this.direction)}getFlipped(){return lf(this.origin,S0(this.direction),this.offset)}isSamePointCaret(t){return t instanceof af&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof sf||t instanceof af)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return wa(this.origin,this.direction)}}function Fu(e){return e instanceof af}function of(e){return e instanceof sf}function Al(e){return e instanceof sp}const iU={next:class extends af{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends af{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},oU={next:class extends sf{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends sf{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},lU={next:class extends sp{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends sp{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function wa(e,t){return e?new oU[t](e):null}function lf(e,t,r){return e?new iU[t](e,Pu(e,r)):null}function Pu(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const d of i)c.append("v",d);o.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function sE(e,t){return new uU(e,t)}function xo(e,t){return xt(e)?new lU[t](e):null}function cU(e){return e&&e.getChildCaret()||e}function Hb(e){return e&&cU(e.getAdjacentCaret())}class Gb{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new Gb(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return Fu(a)?(function(i,o){const{direction:c,origin:d}=i,f=Pu(d,o==="focus"?S0(c):c);return sE(i,f-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[sE(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=Fu(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=Fu(n),a=i=>i.isSameNodeCaret(n)?null:Hb(i)||i.getParentCaret(t);return Kb({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class uU{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return lf(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function Vb(e){return Lu(e,wa(Un(),e.direction))}function dU(e){return Lu(e,e)}function Lu(e,t){return e.direction!==t.direction&&jt(265),new Gb(e,t,e.direction)}function Kb(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function HA(e,t){const r=R1(e.origin,t.origin);switch(r===null&&jt(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return GA(r)}}function GA(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function u1(e,t){return t.is(e)}function aE(e){return xt(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function R1(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=aE(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=aE(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(u1(e,n)||jt(276),{commonAncestor:n,type:"ancestor"}):s===null?(u1(t,n)||jt(277),{commonAncestor:n,type:"descendant"}):((xt(a)||u1(e,a))&&(xt(s)||u1(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||jt(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function Cc(e,t){const{type:r,key:n,offset:s}=e,a=JB(e.key);return r==="text"?(Wt(a)||jt(266,a.getType(),n),lf(a,t,s)):(xt(a)||jt(267,a.getType(),n),gU(a,e.offset,t))}function cf(e,t){const{origin:r,direction:n}=t,s=n==="next";Fu(t)?e.set(r.getKey(),t.offset,"text"):of(t)?Wt(r)?e.set(r.getKey(),Pu(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(Al(t)&&xt(r)||jt(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function fU(e){const t=$t(),r=Tt(t)?t:Uy();return D1(r,e),_a(r),r}function D1(e,t){cf(e.anchor,t.anchor),cf(e.focus,t.focus)}function iE(e){const{anchor:t,focus:r}=e,n=Cc(t,"next"),s=Cc(r,"next"),a=HA(n,s)<=0?"next":"previous";return Lu(o0(n,a),o0(s,a))}function qb(e){const{direction:t,origin:r}=e,n=wa(r,S0(t)).getNodeAtCaret();return n?wa(n,t):xo(r.getParentOrThrow(),t)}function oE(e,t="root"){const r=[e];for(let n=Al(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(qb(n));return r}function Fw(e){return!!e&&e.origin.isAttached()}function hU(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=KA(e,n),i=oE(a.anchor,r),o=oE(a.focus.getFlipped(),r),c=new Set,d=[];for(const v of a.iterNodeCarets(r))if(Al(v))c.add(v.origin.getKey());else if(of(v)){const{origin:w}=v;xt(w)&&!c.has(w.getKey())||d.push(w)}for(const v of d)v.remove();for(const v of a.getTextSlices()){if(!v)continue;const{origin:w}=v.caret,b=w.getTextContentSize(),E=qb(wa(w,n)),k=w.getMode();if(Math.abs(v.distance)===b&&s==="removeEmptySlices"||k==="token"&&v.distance!==0)E.remove();else if(v.distance!==0){s="removeEmptySlices";let _=v.removeTextSlice();const N=v.caret.origin;if(k==="segmented"){const A=_.origin,P=Zn(A.getTextContent()).setStyle(A.getStyle()).setFormat(A.getFormat());E.replaceOrInsert(P),_=lf(P,n,_.offset)}N.is(i[0].origin)&&(i[0]=_),N.is(o[0].origin)&&(o[0]=_.getFlipped())}}let f,p;for(const v of i)if(Fw(v)){f=ho(v);break}for(const v of o)if(Fw(v)){p=ho(v);break}const g=(function(v,w,b){if(!v||!w)return null;const E=v.getParentAtCaret(),k=w.getParentAtCaret();if(!E||!k)return null;const _=E.getParents().reverse();_.push(E);const N=k.getParents().reverse();N.push(k);const A=Math.min(_.length,N.length);let P;for(P=0;P<A&&_[P]===N[P];P++);const R=(I,K)=>{let X;for(let Z=P;Z<I.length;Z++){const oe=I[Z];if(si(oe))return;!X&&K(oe)&&(X=oe)}return X},T=R(_,fo),D=T&&R(N,(I=>b.has(I.getKey())&&fo(I)));return T&&D?[T,D]:null})(f,p,c);if(g){const[v,w]=g;xo(v,"previous").splice(0,w.getChildren()),w.remove()}const y=[f,p,...i,...o].find(Fw);if(y)return dU(o0(ho(y),e.direction));jt(269,JSON.stringify(i.map((v=>v.origin.__key))))}function ho(e){const t=(function(s){let a=s;for(;Al(a);){const i=Hb(a);if(!Al(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(Wt(t.origin))return Fu(t)?t:lf(t.origin,r,r);const n=t.getAdjacentCaret();return of(n)&&Wt(n.origin)?lf(n.origin,r,S0(r)):t}function VA(e){return Fu(e)&&e.offset!==Pu(e.origin,e.direction)}function o0(e,t){return e.direction===t?e:e.getFlipped()}function KA(e,t){return e.direction===t?e:Lu(o0(e.focus,t),o0(e.anchor,t))}function gU(e,t,r){let n=xo(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return o0(n,r)}const qA=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,mU=qA?C.useLayoutEffect:C.useEffect,d1={tag:Dm};function XA({initialConfig:e,children:t}){const r=C.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:c}=e,d=ML(null,n),f=$B({editable:e.editable,html:c,namespace:s,nodes:a,onError:p=>i(p,f),theme:n});return(function(p,g){if(g!==null){if(g===void 0)p.update((()=>{const y=Un();if(y.isEmpty()){const v=Pn();y.append(v);const w=qA?document.activeElement:null;($t()!==null||w!==null&&w===p.getRootElement())&&v.select()}}),d1);else if(g!==null)switch(typeof g){case"string":{const y=p.parseEditorState(g);p.setEditorState(y,d1);break}case"object":p.setEditorState(g,d1);break;case"function":p.update((()=>{Un().isEmpty()&&g(p)}),d1)}}})(f,o),[f,d]}),[]);return mU((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),l.jsx(y0.Provider,{value:r,children:t})}const pU=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function xU(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function yU(){return(function(e){const[t]=Pl(),r=C.useMemo((()=>e(t)),[t,e]),[n,s]=C.useState((()=>r.initialValueFn())),a=C.useRef(n);return pU((()=>{const{initialValueFn:i,subscribe:o}=r,c=i();return a.current!==c&&(a.current=c,s(c)),o((d=>{a.current=d,s(d)}))}),[r,e]),n})(xU)}function vU(){return Un().getTextContent()}function wU(e,t=!0){if(e)return!1;let r=vU();return t&&(r=r.trim()),r===""}function _U(e){if(!wU(e,!1))return!1;const t=Un().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(Zr(s))return!1;if(xt(s)){if(!Ab(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const c=a[n];if(!Wt(c))return!1}}}return!0}function YA(e){return()=>_U(e)}const X_=new Map;function QA(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function lE(e){let t=X_.get(e);return t===void 0&&(t=QA(e),X_.set(e,t)),t}function JA(e){const t=Ip().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function ZA(e){return JA(Ls(e)?e:e.getParentOrThrow())}function cE(e){const t=ZA(e);return t!==null&&t.direction==="rtl"}function ej(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!hc(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),c=t.is(i),d=t.is(o);if(c||d){const[f,p]=$_(e),g=i.is(o),y=t.is(a?o:i),v=t.is(a?i:o);let w,b=0;g?(b=f>p?p:f,w=f>p?f:p):y?(b=a?p:f,w=void 0):v&&(b=0,w=a?f:p),t.__text=t.__text.slice(b,w)}}return t}function bU(e){const t=e.getStyle(),r=QA(t);X_.set(t,r)}function SU(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function Xh(e,t,r=SU){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=Uy(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const c=Pw(i.getNode(),fo),d=Pw(o.getNode(),fo);xt(c)&&s.set(c.getKey(),c),xt(d)&&s.set(d.getKey(),d)}for(const i of e.getNodes())if(xt(i)&&fo(i))s.set(i.getKey(),i);else if(n===null){const o=Pw(i,fo);xt(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const c=t();r(o,c),o.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is($t())&&_a(a)}function tj(e){const t=rj(e);return t!==null&&t.writingMode==="vertical-rl"}function rj(e){const t=e.anchor.getNode();return xt(t)?JA(t):ZA(t)}function uE(e,t){let r=tj(e)?!t:t;nj(e)&&(r=!r);const n=Cc(e.focus,r?"previous":"next");if(VA(n))return!1;for(const s of Vb(n)){if(Al(s))return!s.origin.isInline();if(!xt(s.origin)){if(Zr(s.origin))return!0;break}}return!1}function kU(e,t,r,n){e.modify(t?"extend":"move",r,n)}function nj(e){const t=rj(e);return t!==null&&t.direction==="rtl"}function dE(e,t,r){const n=nj(e);let s;s=tj(e)||n?!r:r,kU(e,t,s,"character")}function Pw(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function CU(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const sj=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,TU=sj&&"documentMode"in document?document.documentMode:null;!(!sj||!("InputEvent"in window)||TU)&&"getTargetRanges"in new window.InputEvent("input");function aj(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function yf(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function Ms(e,...t){const r=aj(...t);r.length>0&&e.classList.add(...r)}function Ru(e,...t){const r=aj(...t);r.length>0&&e.classList.remove(...r)}function EU(e){return e?e.getAdjacentCaret():null}function NU(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function AU(e){const t=Ky(e,(r=>xt(r)&&!r.isInline()));return xt(t)||CU(4,e.__key),t}const Ky=(e,t)=>{let r=e;for(;r!==Un()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function Ld(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function ij(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(xt(s))for(const a of jU(s))n.push(a);return r}function jU(e){return FU(xo(e,"previous"))}function FU(e){return Kb({hasNext:of,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function PU(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const c=o.args;if(c){const[d,f,p,g,y,v]=c;e.update((()=>{const w=$t();if(Tt(w)){const b=w.anchor;let E=b.getNode(),k=0,_=0;if(Wt(E)&&d>=0&&f>=0&&(k=d,_=d+f,w.setTextNodeRange(E,k,E,_)),k===_&&p===""||(w.insertRawText(p),E=b.getNode()),Wt(E)){k=g,_=g+y;const N=E.getTextContentSize();k=k>N?N:k,_=_>N?N:_,w.setTextNodeRange(E,k,E,_)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function RU(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!lj.has(i.nodeName)){const o=cj(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof Nb&&i.insertAfter(jl());for(const i of a){const o=i.getChildren();for(const c of o)i.insertBefore(c);i.remove()}})(s),n}function DU(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=Un().getChildren();for(let s=0;s<n.length;s++)oj(e,n[s],r,t);return r.innerHTML}function oj(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=xt(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let y=Bb(t);y=Wt(y)&&n!==null?ej(n,y):y,i=y}const o=xt(i)?i.getChildren():[],c=Fb(e,i.getType());let d;d=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:f,after:p}=d;if(!f)return!1;const g=document.createDocumentFragment();for(let y=0;y<o.length;y++){const v=o[y],w=oj(e,v,g,n);!s&&xt(t)&&w&&t.extractWithChild(v,n,"html")&&(s=!0)}if(s&&!a){if((Rn(f)||K_(f))&&f.append(g),r.append(f),p){const y=p.call(i,f);y&&(K_(f)?f.replaceChildren(y):f.replaceWith(y))}}else r.append(g);return s}const lj=new Set(["STYLE","SCRIPT"]);function cj(e,t,r,n,s=new Map,a){let i=[];if(lj.has(e.nodeName))return i;let o=null;const c=(function(v,w){const{nodeName:b}=v,E=w._htmlConversions.get(b.toLowerCase());let k=null;if(E!==void 0)for(const _ of E){const N=_(v);N!==null&&(k===null||(k.priority||0)<=(N.priority||0))&&(k=N)}return k!==null?k.conversion:null})(e,t),d=c?c(e):null;let f=null;if(d!==null){f=d.after;const v=d.node;if(o=Array.isArray(v)?v[v.length-1]:v,o!==null){for(const[,w]of s)if(o=w(o,a),!o)break;o&&i.push(...Array.isArray(v)?v:[o])}d.forChild!=null&&s.set(e.nodeName,d.forChild)}const p=e.childNodes;let g=[];const y=(o==null||!si(o))&&(o!=null&&W_(o)||n);for(let v=0;v<p.length;v++)g.push(...cj(p[v],t,r,y,new Map(s),o));return f!=null&&(g=f(g)),ay(e)&&(g=IU(e,g,y?()=>{const v=new Nb;return r.push(v),v}:Pn)),o==null?g.length>0?i=i.concat(g):ay(e)&&(function(v){return v.nextSibling==null||v.previousSibling==null?!1:q_(v.nextSibling)&&q_(v.previousSibling)})(e)&&(i=i.concat(jl())):xt(o)&&o.append(...g),i}function IU(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(W_(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&W_(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function iy(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function MU(e,t=$t()){return t==null&&iy(166),Tt(t)&&t.isCollapsed()||t.getNodes().length===0?"":DU(e,t)}function OU(e,t=$t()){return t==null&&iy(166),Tt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(LU(e,t))}function fE(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return hE(r,BU(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:d=>d}).createHTML(c):c})(s),"text/html");return hE(r,RU(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Tt(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let c=0;c<o.length;c++){const d=$t();if(Tt(d)){const f=o[c];f===`
`||f===`\r
`?d.insertParagraph():f==="	"?d.insertNodes([w0()]):d.insertText(f)}}}else t.insertRawText(i)}function hE(e,t,r){e.dispatchCommand(cB,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Tt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=Cc(s,"previous");if(i)if(Fu(i))a=i.origin;else{const o=Lu(i,xo(Un(),"next").getFlipped());for(const c of o){if(Wt(c.origin)){a=c.origin;break}if(xt(c.origin)&&!c.origin.isInline())break}}if(a&&Wt(a)){const o=a.getFormat(),c=a.getStyle();n.format===o&&n.style===c||(n.format=o,n.style=c,n.dirty=!0)}}})(r))}function uj(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=xt(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let d=Bb(r);d=Wt(d)&&t!==null?ej(t,d):d,i=d}const o=xt(i)?i.getChildren():[],c=(function(d){const f=d.exportJSON(),p=d.constructor;if(f.type!==p.getType()&&iy(58,p.name),xt(d)){const g=f.children;Array.isArray(g)||iy(59,p.name)}return f})(i);if(Wt(i)){const d=i.__text;d.length>0?c.text=d:s=!1}for(let d=0;d<o.length;d++){const f=o[d],p=uj(e,t,f,c.children);!s&&xt(r)&&p&&r.extractWithChild(f,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let d=0;d<c.children.length;d++){const f=c.children[d];n.push(f)}return s}function LU(e,t){const r=[],n=Un().getChildren();for(let s=0;s<n.length;s++)uj(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function BU(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=DB(n);Wt(s)&&bU(s),t.push(s)}return t}let Sh=null;async function gE(e,t,r){if(Sh!==null)return!1;if(t!==null)return new Promise(((d,f)=>{e.update((()=>{d(mE(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=Ko(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const c=new Range;return c.setStart(o,0),c.setEnd(o,1),i.removeAllRanges(),i.addRange(c),new Promise(((d,f)=>{const p=e.registerCommand(Oy,(g=>(Ld(g,ClipboardEvent)&&(p(),Sh!==null&&(window.clearTimeout(Sh),Sh=null),d(mE(e,g,r))),!0)),UB);Sh=window.setTimeout((()=>{p(),Sh=null,d(!1)}),50),a.execCommand("copy"),o.remove()}))}function mE(e,t,r){if(r===void 0){const s=Ko(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!Rp(e,a,i))return!1;const o=$t();if(o===null)return!1;r=$U(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(WU(n,r),!0)}const UU=[["text/html",MU],["application/x-lexical-editor",OU]];function $U(e=$t()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=Ip();for(const[n,s]of UU){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function WU(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function pE(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const k0=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,zU=k0&&"documentMode"in document?document.documentMode:null,HU=!(!k0||!("InputEvent"in window)||zU)&&"getTargetRanges"in new window.InputEvent("input"),GU=k0&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),xE=k0&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,VU=k0&&/^(?=.*Chrome).*/i.test(navigator.userAgent),KU=k0&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!VU,yE=pr("DRAG_DROP_PASTE_FILE");let Mp=class dj extends Ba{static getType(){return"quote"}static clone(t){return new dj(t.__key)}createDOM(t){const r=document.createElement("blockquote");return Ms(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:qU,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(Rn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Op().updateFromJSON(t)}insertNewAfter(t,r){const n=Pn(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=Pn();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function Op(){return ii(new Mp)}function vE(e){return e instanceof Mp}let Lp=class fj extends Ba{static getType(){return"heading"}static clone(t){return new fj(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];Ms(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:kh,priority:0}),h2:t=>({conversion:kh,priority:0}),h3:t=>({conversion:kh,priority:0}),h4:t=>({conversion:kh,priority:0}),h5:t=>({conversion:kh,priority:0}),h6:t=>({conversion:kh,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&wE(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>wE(t)?{conversion:r=>({node:Cu("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(Rn(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Cu(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?Pn():Cu(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=Pn();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?Pn():Cu(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function wE(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function kh(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=Cu(t),e.style!==null&&(Ub(e,r),r.setFormat(e.style.textAlign))),{node:r}}function qU(e){const t=Op();return e.style!==null&&(t.setFormat(e.style.textAlign),Ub(e,t)),{node:t}}function Cu(e="h1"){return ii(new Lp(e))}function XU(e){return e instanceof Lp}function f1(e){let t=null;if(Ld(e,DragEvent)?t=e.dataTransfer:Ld(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function _E(e){const t=$t();if(!Tt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=Ky(a,(d=>xt(d)&&!d.isInline()));if(o===null)continue;const c=o.getKey();o.canIndent()&&!r.has(c)&&(r.add(c),e(o))}return r.size>0}function bE(e){const t=Ou(e);return Zr(t)}function Rw(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function YU(e){return yf(e.registerCommand(xb,(t=>{const r=$t();return!!ja(r)&&(r.clear(),!0)}),Gr),e.registerCommand(zd,(t=>{const r=$t();return Tt(r)?(r.deleteCharacter(t),!0):!!ja(r)&&(r.deleteNodes(),!0)}),Gr),e.registerCommand(rp,(t=>{const r=$t();return!!Tt(r)&&(r.deleteWord(t),!0)}),Gr),e.registerCommand(np,(t=>{const r=$t();return!!Tt(r)&&(r.deleteLine(t),!0)}),Gr),e.registerCommand(Vh,(t=>{const r=$t();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)fE(n,r,e);else if(Tt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),Gr),e.registerCommand(D_,(()=>{const t=$t();return!!Tt(t)&&(t.removeText(),!0)}),Gr),e.registerCommand(Ma,(t=>{const r=$t();return!!Tt(r)&&(r.formatText(t),!0)}),Gr),e.registerCommand(lA,(t=>{const r=$t();if(!Tt(r)&&!ja(r))return!1;const n=r.getNodes();for(const s of n){const a=Ky(s,(i=>xt(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),Gr),e.registerCommand(Gh,(t=>{const r=$t();return!!Tt(r)&&(r.insertLineBreak(t),!0)}),Gr),e.registerCommand(tp,(()=>{const t=$t();return!!Tt(t)&&(t.insertParagraph(),!0)}),Gr),e.registerCommand(hB,(()=>(FB([w0()]),!0)),Gr),e.registerCommand(gB,(()=>_E((t=>{const r=t.getIndent();t.setIndent(r+1)}))),Gr),e.registerCommand(C4,(()=>_E((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),Gr),e.registerCommand(eA,(t=>{const r=$t();if(ja(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Tt(r)){const n=H_(r.focus,!0);if(!t.shiftKey&&Zr(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),Gr),e.registerCommand(tA,(t=>{const r=$t();if(ja(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Tt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===Un().getChildrenSize()})(r))return t.preventDefault(),!0;const n=H_(r.focus,!1);if(!t.shiftKey&&Zr(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),Gr),e.registerCommand(Z6,(t=>{const r=$t();if(ja(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),cE(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Tt(r))return!1;if(uE(r,!0)){const n=t.shiftKey;return t.preventDefault(),dE(r,n,!0),!0}return!1}),Gr),e.registerCommand(J6,(t=>{const r=$t();if(ja(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),cE(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Tt(r))return!1;const n=t.shiftKey;return!!uE(r,!1)&&(t.preventDefault(),dE(r,n,!1),!0)}),Gr),e.registerCommand(nA,(t=>{if(bE(t.target))return!1;const r=$t();if(Tt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(Ls(a))return!1;const i=AU(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(C4,void 0);if(xE&&navigator.language==="ko-KR")return!1}else if(!ja(r))return!1;return t.preventDefault(),e.dispatchCommand(zd,!0)}),Gr),e.registerCommand(aA,(t=>{if(bE(t.target))return!1;const r=$t();return!(!Tt(r)&&!ja(r))&&(t.preventDefault(),e.dispatchCommand(zd,!1))}),Gr),e.registerCommand(J1,(t=>{const r=$t();if(!Tt(r))return!1;if(Rw(r),t!==null){if((xE||GU||KU)&&HU)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(Gh,!1)}return e.dispatchCommand(tp,void 0)}),Gr),e.registerCommand(sA,(()=>{const t=$t();return!!Tt(t)&&(e.blur(),!0)}),Gr),e.registerCommand(oA,(t=>{const[,r]=f1(t);if(r.length>0){const s=pE(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=Ou(i);if(o!==null){const c=Uy();if(Wt(o))c.anchor.set(o.getKey(),a,"text"),c.focus.set(o.getKey(),a,"text");else{const f=o.getParentOrThrow().getKey(),p=o.getIndexWithinParent()+1;c.anchor.set(f,p,"element"),c.focus.set(f,p,"element")}const d=K1(c);_a(d)}e.dispatchCommand(yE,r)}return t.preventDefault(),!0}const n=$t();return!!Tt(n)}),Gr),e.registerCommand(cA,(t=>{const[r]=f1(t),n=$t();return!(r&&!Tt(n))}),Gr),e.registerCommand(uA,(t=>{const[r]=f1(t),n=$t();if(r&&!Tt(n))return!1;const s=pE(t.clientX,t.clientY);if(s!==null){const a=Ou(s.node);Zr(a)&&t.preventDefault()}return!0}),Gr),e.registerCommand(I_,(()=>(KB(),!0)),Gr),e.registerCommand(Oy,(t=>(gE(e,Ld(t,ClipboardEvent)?t:null),!0)),Gr),e.registerCommand(_b,(t=>((async function(r,n){await gE(n,Ld(r,ClipboardEvent)?r:null),n.update((()=>{const s=$t();Tt(s)?s.removeText():ja(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),Gr),e.registerCommand(yb,(t=>{const[,r,n]=f1(t);return r.length>0&&!n?(e.dispatchCommand(yE,r),!0):b0(t.target)&&Pb(t.target)?!1:$t()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=$t(),o=Ld(s,InputEvent)||Ld(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&fE(o,i,a)}),{tag:MB})})(t,e),!0)}),Gr),e.registerCommand(rA,(t=>{const r=$t();return Tt(r)&&Rw(r),!1}),Gr),e.registerCommand(iA,(t=>{const r=$t();return Tt(r)&&Rw(r),!1}),Gr))}const Y_=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function SE(e){return e.getEditorState().read(YA(e.isComposing()))}function hj({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=Pl(),s=(function(a,i){const[o,c]=C.useState((()=>a.getDecorators()));return Y_((()=>a.registerDecoratorListener((d=>{Nk.flushSync((()=>{c(d)}))}))),[a]),C.useEffect((()=>{c(a.getDecorators())}),[a]),C.useMemo((()=>{const d=[],f=Object.keys(o);for(let p=0;p<f.length;p++){const g=f[p],y=l.jsx(i,{onError:w=>a._onError(w),children:l.jsx(C.Suspense,{fallback:null,children:o[g]})}),v=a.getElementByKey(g);v!==null&&d.push(Nk.createPortal(y,v,g))}return d}),[i,o,a])})(n,r);return(function(a){Y_((()=>yf(YU(a),PU(a))),[a])})(n),l.jsxs(l.Fragment,{children:[e,l.jsx(QU,{content:t}),s]})}function QU({content:e}){const[t]=Pl(),r=(function(s){const[a,i]=C.useState((()=>SE(s)));return Y_((()=>{function o(){const c=SE(s);i(c)}return o(),yf(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=yU();return r?typeof e=="function"?e(n):e:null}const gj=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?C.useLayoutEffect:C.useEffect;function JU({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:c,ariaLabelledBy:d,ariaMultiline:f,ariaOwns:p,ariaRequired:g,autoCapitalize:y,className:v,id:w,role:b="textbox",spellCheck:E=!0,style:k,tabIndex:_,"data-testid":N,...A},P){const[R,T]=C.useState(e.isEditable()),D=C.useCallback((K=>{K&&K.ownerDocument&&K.ownerDocument.defaultView?e.setRootElement(K):e.setRootElement(null)}),[e]),I=C.useMemo((()=>(function(...K){return X=>{K.forEach((Z=>{typeof Z=="function"?Z(X):Z!=null&&(Z.current=X)}))}})(P,D)),[D,P]);return gj((()=>(T(e.isEditable()),e.registerEditableListener((K=>{T(K)})))),[e]),l.jsx("div",{"aria-activedescendant":R?t:void 0,"aria-autocomplete":R?r:"none","aria-controls":R?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":R&&b==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":c,"aria-labelledby":d,"aria-multiline":f,"aria-owns":R?p:void 0,"aria-readonly":!R||void 0,"aria-required":g,autoCapitalize:y,className:v,contentEditable:R,"data-testid":N,id:w,ref:I,role:b,spellCheck:E,style:k,tabIndex:_,...A})}const ZU=C.forwardRef(JU);function kE(e){return e.getEditorState().read(YA(e.isComposing()))}const mj=C.forwardRef(e$);function e$(e,t){const{placeholder:r,...n}=e,[s]=Pl();return l.jsxs(l.Fragment,{children:[l.jsx(ZU,{editor:s,...n,ref:t}),r!=null&&l.jsx(t$,{editor:s,content:r})]})}function t$({content:e,editor:t}){const r=(function(i){const[o,c]=C.useState((()=>kE(i)));return gj((()=>{function d(){const f=kE(i);c(f)}return d(),yf(i.registerUpdateListener((()=>{d()})),i.registerEditableListener((()=>{d()})))}),[i]),o})(t),[n,s]=C.useState(t.isEditable());if(C.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:l.jsx("div",{"aria-hidden":!0,children:a})}const h1=0,Q_=1,J_=2,Lo=0,r$=1,CE=2,n$=3,s$=4;function a$(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return Lo;const a=t._selection,i=e._selection;if(s)return r$;if(!(Tt(a)&&Tt(i)&&i.isCollapsed()&&a.isCollapsed()))return Lo;const o=(function(E,k,_){const N=E._nodeMap,A=[];for(const P of k){const R=N.get(P);R!==void 0&&A.push(R)}for(const[P,R]of _){if(!R)continue;const T=N.get(P);T===void 0||Ls(T)||A.push(T)}return A})(t,r,n);if(o.length===0)return Lo;if(o.length>1){const E=t._nodeMap,k=E.get(a.anchor.key),_=E.get(i.anchor.key);return k&&_&&!e._nodeMap.has(k.__key)&&Wt(k)&&k.__text.length===1&&a.anchor.offset===1?CE:Lo}const c=o[0],d=e._nodeMap.get(c.__key);if(!Wt(d)||!Wt(c)||d.__mode!==c.__mode)return Lo;const f=d.__text,p=c.__text;if(f===p)return Lo;const g=a.anchor,y=i.anchor;if(g.key!==y.key||g.type!=="text")return Lo;const v=g.offset,w=y.offset,b=p.length-f.length;return b===1&&w===v-1?CE:b===-1&&w===v+1?n$:b===-1&&w===v?s$:Lo}function i$(e,t){let r=Date.now(),n=Lo;return(s,a,i,o,c,d)=>{const f=Date.now();if(d.has(ry))return n=Lo,r=f,J_;const p=a$(s,a,o,c,e.isComposing()),g=(()=>{const y=i===null||i.editor===e,v=d.has(IB);if(!v&&y&&d.has(Dm))return h1;if(s===null)return Q_;const w=a._selection;return o.size>0||c.size>0?v===!1&&p!==Lo&&p===n&&f<r+t&&y||o.size===1&&(function(b,E,k){const _=E._nodeMap.get(b),N=k._nodeMap.get(b),A=E._selection,P=k._selection;return!(Tt(A)&&Tt(P)&&A.anchor.type==="element"&&A.focus.type==="element"&&P.anchor.type==="text"&&P.focus.type==="text"||!Wt(_)||!Wt(N)||_.__parent!==N.__parent)&&JSON.stringify(E.read((()=>_.exportJSON())))===JSON.stringify(k.read((()=>N.exportJSON())))})(Array.from(o)[0],s,a)?h1:Q_:w!==null?h1:J_})();return r=f,n=p,g}}function TE(e){e.undoStack=[],e.redoStack=[],e.current=null}function o$(e,t,r){const n=i$(e,r);return yf(e.registerCommand(vb,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(c.length!==0){const d=i.current,f=c.pop();d!==null&&(o.push(d),a.dispatchCommand(s1,!0)),c.length===0&&a.dispatchCommand(a1,!1),i.current=f||null,f&&f.editor.setEditorState(f.editorState,{tag:ry})}})(e,t),!0)),Gr),e.registerCommand(wb,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(o.length!==0){const d=i.current;d!==null&&(c.push(d),a.dispatchCommand(a1,!0));const f=o.pop();o.length===0&&a.dispatchCommand(s1,!1),i.current=f||null,f&&f.editor.setEditorState(f.editorState,{tag:ry})}})(e,t),!0)),Gr),e.registerCommand(pB,(()=>(TE(t),!1)),Gr),e.registerCommand(xB,(()=>(TE(t),e.dispatchCommand(s1,!1),e.dispatchCommand(a1,!1),!0)),Gr),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:c,tags:d})=>{const f=t.current,p=t.redoStack,g=t.undoStack,y=f===null?null:f.editorState;if(f!==null&&a===y)return;const v=n(i,a,f,o,c,d);if(v===Q_)p.length!==0&&(t.redoStack=[],e.dispatchCommand(s1,!1)),f!==null&&(g.push({...f}),e.dispatchCommand(a1,!0));else if(v===J_)return;t.current={editor:e,editorState:a}})))}function l$(){return{current:null,redoStack:[],undoStack:[]}}function pj({delay:e,externalHistoryState:t}){const[r]=Pl();return(function(n,s,a=1e3){const i=C.useMemo((()=>s||l$()),[s]);C.useEffect((()=>o$(n,i,a)),[a,n,i])})(r,t,e),null}function xj({defaultSelection:e}){const[t]=Pl();return C.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function Z_(e,t){return Z_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Z_(e,t)}var EE={error:null},c$=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(a=e.call.apply(e,[this].concat(o))||this).state=EE,a.resetErrorBoundary=function(){for(var d,f=arguments.length,p=new Array(f),g=0;g<f;g++)p[g]=arguments[g];a.props.onReset==null||(d=a.props).onReset.apply(d,p),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,Z_(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(EE)},s.componentDidCatch=function(a,i){var o,c;(o=(c=this.props).onError)==null||o.call(c,a,i)},s.componentDidUpdate=function(a,i){var o,c,d,f,p=this.state.error,g=this.props.resetKeys;p!==null&&i.error!==null&&((d=a.resetKeys)===void 0&&(d=[]),(f=g)===void 0&&(f=[]),d.length!==f.length||d.some((function(y,v){return!Object.is(y,f[v])})))&&((o=(c=this.props).onResetKeysChange)==null||o.call(c,a.resetKeys,g),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,c=i.FallbackComponent,d=i.fallback;if(a!==null){var f={error:a,resetErrorBoundary:this.resetErrorBoundary};if(C.isValidElement(d))return d;if(typeof o=="function")return o(f);if(c)return C.createElement(c,f);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(C.Component);function yj({children:e,onError:t}){return l.jsx(c$,{fallback:l.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const Xb=/^(\d+(?:\.\d+)?)px$/,Yh={BOTH:3,NO_STATUS:0,ROW:1};class C0 extends Ba{static getType(){return"tablecell"}static clone(t){return new C0(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:NE,priority:0}),th:t=>({conversion:NE,priority:0})}}static importJSON(t){return vj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=Yh.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),e2(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),Ms(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(Rn(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...e2(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=Yh.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==Yh.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function e2(e){return e==="middle"||e==="bottom"}function NE(e){const t=e,r=e.nodeName.toLowerCase();let n;Xb.test(t.style.width)&&(n=parseFloat(t.style.width));const s=vj(r==="th"?Yh.ROW:Yh.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;e2(i)&&(s.__verticalAlign=i);const o=t.style,c=(o&&o.textDecoration||"").split(" "),d=o.fontWeight==="700"||o.fontWeight==="bold",f=c.includes("line-through"),p=o.fontStyle==="italic",g=c.includes("underline");return{after:y=>{const v=[];let w=null;const b=()=>{if(w){const E=w.getFirstChild();yc(E)&&w.getChildrenSize()===1&&E.remove()}};for(const E of y)YB(E)||Wt(E)||yc(E)?(Wt(E)&&(d&&E.toggleFormat("bold"),f&&E.toggleFormat("strikethrough"),p&&E.toggleFormat("italic"),g&&E.toggleFormat("underline")),w?w.append(E):(w=Pn().append(E),v.push(w))):(v.push(E),b(),w=null);return b(),v.length===0&&v.push(Pn()),v},node:s}}function vj(e=Yh.NO_STATUS,t=1,r){return ii(new C0(e,t,r))}function ap(e){return e instanceof C0}function t2(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class T0 extends Ba{static getType(){return"tablerow"}static clone(t){return new T0(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:u$,priority:0})}}static importJSON(t){return wj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),Ms(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function u$(e){const t=e;let r;return Xb.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>ij(n,ap),node:wj(r)}}function wj(e){return ii(new T0(e))}function _j(e){return e instanceof T0}const bj=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,d$=bj&&"documentMode"in document?document.documentMode:null;bj&&"InputEvent"in window&&!d$&&new window.InputEvent("input");function f$(e,t,r){const n=[];let s=null,a=null;function i(c){let d=n[c];return d===void 0&&(n[c]=d=[]),d}const o=e.getChildren();for(let c=0;c<o.length;c++){const d=o[c];_j(d)||t2(209);const f=i(c);for(let p=d.getFirstChild(),g=0;p!=null;p=p.getNextSibling()){for(ap(p)||t2(147);f[g]!==void 0;)g++;const y={cell:p,startColumn:g,startRow:c},{__rowSpan:v,__colSpan:w}=p;for(let b=0;b<v&&!(c+b>=o.length);b++){const E=i(c+b);for(let k=0;k<w;k++)E[g+k]=y}}}return[n,s,a]}function mm(e){return Rn(e)&&e.nodeName==="TABLE"}function h$(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;ap(r)&&(n=r)}return null}function g$(e,t,r){return h$(e,Ou(t,r))}function AE(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}Ru(e,...n),Ms(e,...s)}const m$=new WeakSet;function jE(e=Ip()){return m$.has(e)}class Bp extends Ba{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new Bp(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:p$,priority:1})}}static importJSON(t){return Sj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=mm(t)?t:t.querySelector("table");return mm(r)||t2(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),tU(s),Ms(n,t.theme.table),this.updateTableElement(null,n,t),jE(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?Ms(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,c){c>0?(Ms(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(Ru(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,c){c>0?(Ms(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(Ru(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(Ms(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(Ru(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const c=s.querySelector("colgroup");if(!c)return;const d=[];for(let f=0;f<i;f++){const p=document.createElement("col"),g=o&&o[f];g&&(p.style.width=`${g}px`),d.push(p)}c.replaceChildren(...d)})(r,0,this.getColumnCount(),this.getColWidths()),AE(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===jE()||(Rn(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!mm(s)&&Rn(s)&&(s=s.querySelector("table")),!mm(s))return null;AE(s,t._config,this.getFormatType());const[a]=f$(this),i=new Map;for(const f of a)for(const p of f){const g=p.cell.getKey();i.has(g)||i.set(g,{colSpan:p.cell.getColSpan(),startColumn:p.startColumn})}const o=new Set;for(const f of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const p=f.getAttribute("data-temporary-table-cell-lexical-key");if(p){const g=i.get(p);if(f.removeAttribute("data-temporary-table-cell-lexical-key"),g){i.delete(p);for(let y=0;y<g.colSpan;y++)o.add(y+g.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const f=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((p,g)=>o.has(g)));c.replaceChildren(...f)}const d=s.querySelectorAll(":scope > tr");if(d.length>0){const f=document.createElement("tbody");for(const p of d)f.appendChild(p);s.append(f)}return s},element:!mm(n)&&Rn(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const c=i[o];if(c==null)continue;const{elem:d}=c,f=g$(this,d);if(f!==null&&t.is(f))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=Ou(s.elem);return ap(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{ap(n)&&(r+=n.getColSpan())})),r}}function p$(e){const t=Sj();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!Xb.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>ij(n,_j),node:t}}function Sj(){return ii(new Bp)}function Tu(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function r2(e){let t=1,r=e.getParent();for(;r!=null;){if(rn(r)){const n=r.getParent();if(Cr(n)){t++,r=n.getParent();continue}Tu(40)}return t}return t}function n2(e){let t=e.getParent();Cr(t)||Tu(40);let r=t;for(;r!==null;)r=r.getParent(),Cr(r)&&(t=r);return t}function kj(e){let t=[];const r=e.getChildren().filter(rn);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();Cr(a)?t=t.concat(kj(a)):t.push(s)}return t}function kl(e){return rn(e)&&Cr(e.getFirstChild())}function FE(e){return Ui().append(e)}function Cj(e,t){return rn(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function PE(e){const t=$t();if(t!==null){let r=t.getNodes();if(Tt(t)){const s=t.getStartEndPoints();s===null&&Tu(143);const[a]=s,i=a.getNode(),o=i.getParent();if(si(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const d=Pn();i.append(d),r=d.select().getNodes()}}else if(Cj(i,r)){const c=Si(e);if(si(o)){i.replace(c);const d=Ui();xt(i)&&(d.setFormat(i.getFormatType()),d.setIndent(i.getIndent())),c.append(d)}else if(rn(i)){const d=i.getParentOrThrow();uf(c,d.getChildren()),d.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(xt(a)&&a.isEmpty()&&!rn(a)&&!n.has(a.getKey())){RE(a,e);continue}let i=DA(a)?a.getParent():rn(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(Cr(i)){if(!n.has(o)){const c=Si(e);uf(c,i.getChildren()),i.replace(c),n.add(o)}break}{const c=i.getParent();if(si(c)&&!n.has(o)){n.add(o),RE(i,e);break}i=c}}}}}function uf(e,t){e.splice(e.getChildrenSize(),0,t)}function RE(e,t){if(Cr(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=Ui();let a;if(uf(s,e.getChildren()),Cr(r)&&t===r.getListType())r.append(s),Cr(n)&&t===n.getListType()&&(uf(r,n.getChildren()),n.remove()),a=r;else if(Cr(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=Si(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function Yb(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&kl(r)&&kl(n)&&(Yb(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function x$(){const e=$t();if(Tt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(Cj(n,r))t.add(n2(n));else for(let s=0;s<r.length;s++){const a=r[s];if(DA(a)){const i=NU(a,Nc);i!=null&&t.add(n2(i))}}for(const s of t){let a=s;const i=kj(s);for(const o of i){const c=Pn().setTextStyle(e.style).setTextFormat(e.format);uf(c,o.getChildren()),a.insertAfter(c),a=c,o.__key===e.anchor.key&&cf(e.anchor,ho(xo(c,"next"))),o.__key===e.focus.key&&cf(e.focus,ho(xo(c,"next"))),o.remove()}s.remove()}}}function Tj(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())rn(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),Cr(n.getFirstChild())||r++)}function y$(e){const t=new Set;if(kl(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(kl(n)&&kl(s)){const a=s.getFirstChild();if(Cr(a)){a.append(e);const i=n.getFirstChild();Cr(i)&&(uf(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(kl(n)){const a=n.getFirstChild();if(Cr(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(kl(s)){const a=s.getFirstChild();Cr(a)&&a.append(e)}else if(Cr(r)){const a=Ui().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=Si(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function v$(e){if(kl(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(Cr(r?r.getParent():void 0)&&rn(r)&&Cr(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=Ui(),o=Si(a);i.append(o),e.getPreviousSiblings().forEach((f=>o.append(f)));const c=Ui(),d=Si(a);c.append(d),uf(d,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function w$(){const e=$t();if(!Tt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!rn(t)||t.getChildrenSize()!==0)return!1;const r=n2(t),n=t.getParent();Cr(n)||Tu(40);const s=n.getParent();let a;if(si(s))a=Pn(),r.insertAfter(a);else{if(!rn(s))return!1;a=Ui(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=Si(n.getListType());if(rn(a)){const c=Ui();c.append(o),a.insertAfter(c)}else a.insertAfter(o);o.append(...i)}return(function(o){let c=o;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const d=c.getParent();if(d==null||!rn(d)&&!Cr(d))break;c=d}c.remove()})(t),!0}function oy(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let Nc=class extends Ba{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();Cr(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Ba,importDOM:{li:()=>({conversion:_$,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();Cr(s)&&s.getListType()==="check"&&(function(o,c,d,f){Cr(c.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),d&&c.__checked===d.__checked||o.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,c,d){const f=[],p=[],g=c.list,y=g?g.listitem:void 0;let v;if(g&&g.nested&&(v=g.nested.listitem),y!==void 0&&f.push(...oy(y)),g){const w=d.getParent(),b=Cr(w)&&w.getListType()==="check",E=d.getChecked();b&&!E||p.push(g.listitemUnchecked),b&&E||p.push(g.listitemChecked),b&&f.push(E?g.listitemChecked:g.listitemUnchecked)}if(v!==void 0){const w=oy(v);d.getChildren().some((b=>Cr(b)))?f.push(...w):p.push(...w)}p.length>0&&Ru(o,...p),f.length>0&&Ms(o,...f)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,c,d){const f=lE(c.__textStyle);for(const p in f)o.style.setProperty(`--listitem-marker-${p}`,f[p]);if(d)for(const p in lE(d.__textStyle))p in f||o.style.removeProperty(`--listitem-marker-${p}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(xt(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(rn(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!Cr(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=Si(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(xt(t)||Tu(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(Cr(n)||Tu(39),rn(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=Si(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&kl(r)&&kl(n)&&(Yb(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=Ui().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=Pn();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=rn(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(c,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return Cr(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;rn(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&Tu(117),(t=Math.floor(t))>=0||Tu(199);let r=this.getIndent();for(;r!==t;)r<t?(y$(this),r++):(v$(this),r--);return this}canInsertAfter(t){return rn(t)}canReplaceWith(t){return rn(t)}canMergeWith(t){return rn(t)||Ab(t)}extractWithChild(t,r){if(!Tt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return Si("bullet")}canMergeWhenEmpty(){return!0}};function _$(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return b$(r)}const t=e.getAttribute("aria-checked");return{node:Ui(t==="true"||t!=="false"&&void 0)}}function b$(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:Ui(e.hasAttribute("checked"))}}function Ui(e){return ii(new Nc(void 0,e))}function rn(e){return e instanceof Nc}let qu=class extends Ba{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();Cr(n)&&r.getListType()===n.getListType()&&Yb(r,n)})(t),Tj(t)},extends:Ba,importDOM:{ol:()=>({conversion:IE,priority:0}),ul:()=>({conversion:IE,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=k$[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,DE(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(DE(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return Rn(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];rn(i)||(s===n&&(s=[...n]),s[a]=Ui().append(!xt(i)||Cr(i)||i.isInline()?i:Zn(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return rn(t)}};function DE(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=r2(r)-1,c=o%i.length,d=i[c],f=a[r.__tag];let p;const g=a.nested,y=a.checklist;if(g!==void 0&&g.list&&(p=g.list),f!==void 0&&n.push(f),y!==void 0&&r.__listType==="check"&&n.push(y),d!==void 0){n.push(...oy(d));for(let v=0;v<i.length;v++)v!==c&&s.push(r.__tag+v)}if(p!==void 0){const v=oy(p);o>1?n.push(...v):s.push(...v)}}s.length>0&&Ru(e,...s),n.length>0&&Ms(e,...n)}function S$(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(rn(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{Cr(a)&&t.push(FE(a))}))}else t.push(FE(n))}return t}function IE(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=Si("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(Rn(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?Si("check"):Si("bullet")),{after:S$,node:r}}const k$={ol:"number",ul:"bullet"};function Si(e="number",t=1){return ii(new qu(e,t))}function Cr(e){return e instanceof qu}const C$=pr("UPDATE_LIST_START_COMMAND"),Qb=pr("INSERT_UNORDERED_LIST_COMMAND"),Jb=pr("INSERT_ORDERED_LIST_COMMAND"),Zb=pr("REMOVE_LIST_COMMAND");function T$(e){return yf(e.registerCommand(Jb,(()=>(PE("number"),!0)),Ph),e.registerCommand(C$,(t=>{const{listNodeKey:r,newStart:n}=t,s=Es(r);return!!Cr(s)&&(s.getListType()==="number"&&(s.setStart(n),Tj(s)),!0)}),Ph),e.registerCommand(Qb,(()=>(PE("bullet"),!0)),Ph),e.registerCommand(Zb,(()=>(x$(),!0)),Ph),e.registerCommand(tp,(()=>w$()),Ph),e.registerNodeTransform(Nc,(t=>{const r=t.getFirstChild();if(r){if(Wt(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=$t();Tt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(Vu,(t=>{const r=t.getParent();if(rn(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function E$(e){const t=r=>{const n=r.getParent();if(Cr(r.getFirstChild())||!Cr(n))return;const s=Ky(r,(a=>rn(a)&&Cr(a.getParent())&&rn(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(rn(s)){const a=s.getPreviousSibling();if(rn(a)){const i=(function(c){let d=c,f=d.getFirstChild();for(;Cr(f);){const p=f.getLastChild();if(!rn(p))break;d=p,f=d.getFirstChild()}return d})(a),o=i.getParent();if(Cr(o)){const c=r2(o);c+1<r2(n)&&r.setIndent(c)}}}};return e.registerNodeTransform(qu,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(Cr(s)){for(const a of s.getChildren())if(rn(a)){t(a);const i=a.getFirstChild();Cr(i)&&n.push(i)}}}}))}var Dw={exports:{}},ME;function N$(){return ME||(ME=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function k(_){return _ instanceof c?new c(_.type,k(_.content),_.alias):Array.isArray(_)?_.map(k):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(k){return Object.prototype.toString.call(k).slice(8,-1)},objId:function(k){return k.__id||Object.defineProperty(k,"__id",{value:++a}),k.__id},clone:function k(_,N){N=N||{};var A,P;switch(o.util.type(_)){case"Object":if(P=o.util.objId(_),N[P])return N[P];A={},N[P]=A;for(var R in _)_.hasOwnProperty(R)&&(A[R]=k(_[R],N));return A;case"Array":return P=o.util.objId(_),N[P]?N[P]:(A=[],N[P]=A,_.forEach(function(T,D){A[D]=k(T,N)}),A);default:return _}},getLanguage:function(k){for(;k;){var _=s.exec(k.className);if(_)return _[1].toLowerCase();k=k.parentElement}return"none"},setLanguage:function(k,_){k.className=k.className.replace(RegExp(s,"gi"),""),k.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(A){var k=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(A.stack)||[])[1];if(k){var _=document.getElementsByTagName("script");for(var N in _)if(_[N].src==k)return _[N]}return null}},isActive:function(k,_,N){for(var A="no-"+_;k;){var P=k.classList;if(P.contains(_))return!0;if(P.contains(A))return!1;k=k.parentElement}return!!N}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(k,_){var N=o.util.clone(o.languages[k]);for(var A in _)N[A]=_[A];return N},insertBefore:function(k,_,N,A){A=A||o.languages;var P=A[k],R={};for(var T in P)if(P.hasOwnProperty(T)){if(T==_)for(var D in N)N.hasOwnProperty(D)&&(R[D]=N[D]);N.hasOwnProperty(T)||(R[T]=P[T])}var I=A[k];return A[k]=R,o.languages.DFS(o.languages,function(K,X){X===I&&K!=k&&(this[K]=R)}),R},DFS:function k(_,N,A,P){P=P||{};var R=o.util.objId;for(var T in _)if(_.hasOwnProperty(T)){N.call(_,T,_[T],A||T);var D=_[T],I=o.util.type(D);I==="Object"&&!P[R(D)]?(P[R(D)]=!0,k(D,N,null,P)):I==="Array"&&!P[R(D)]&&(P[R(D)]=!0,k(D,N,T,P))}}},plugins:{},highlightAll:function(k,_){o.highlightAllUnder(document,k,_)},highlightAllUnder:function(k,_,N){var A={callback:N,container:k,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",A),A.elements=Array.prototype.slice.apply(A.container.querySelectorAll(A.selector)),o.hooks.run("before-all-elements-highlight",A);for(var P=0,R;R=A.elements[P++];)o.highlightElement(R,_===!0,A.callback)},highlightElement:function(k,_,N){var A=o.util.getLanguage(k),P=o.languages[A];o.util.setLanguage(k,A);var R=k.parentElement;R&&R.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(R,A);var T=k.textContent,D={element:k,language:A,grammar:P,code:T};function I(X){D.highlightedCode=X,o.hooks.run("before-insert",D),D.element.innerHTML=D.highlightedCode,o.hooks.run("after-highlight",D),o.hooks.run("complete",D),N&&N.call(D.element)}if(o.hooks.run("before-sanity-check",D),R=D.element.parentElement,R&&R.nodeName.toLowerCase()==="pre"&&!R.hasAttribute("tabindex")&&R.setAttribute("tabindex","0"),!D.code){o.hooks.run("complete",D),N&&N.call(D.element);return}if(o.hooks.run("before-highlight",D),!D.grammar){I(o.util.encode(D.code));return}if(_&&n.Worker){var K=new Worker(o.filename);K.onmessage=function(X){I(X.data)},K.postMessage(JSON.stringify({language:D.language,code:D.code,immediateClose:!0}))}else I(o.highlight(D.code,D.grammar,D.language))},highlight:function(k,_,N){var A={code:k,grammar:_,language:N};if(o.hooks.run("before-tokenize",A),!A.grammar)throw new Error('The language "'+A.language+'" has no grammar.');return A.tokens=o.tokenize(A.code,A.grammar),o.hooks.run("after-tokenize",A),c.stringify(o.util.encode(A.tokens),A.language)},tokenize:function(k,_){var N=_.rest;if(N){for(var A in N)_[A]=N[A];delete _.rest}var P=new p;return g(P,P.head,k),f(k,P,_,P.head,0),v(P)},hooks:{all:{},add:function(k,_){var N=o.hooks.all;N[k]=N[k]||[],N[k].push(_)},run:function(k,_){var N=o.hooks.all[k];if(!(!N||!N.length))for(var A=0,P;P=N[A++];)P(_)}},Token:c};n.Prism=o;function c(k,_,N,A){this.type=k,this.content=_,this.alias=N,this.length=(A||"").length|0}c.stringify=function k(_,N){if(typeof _=="string")return _;if(Array.isArray(_)){var A="";return _.forEach(function(I){A+=k(I,N)}),A}var P={type:_.type,content:k(_.content,N),tag:"span",classes:["token",_.type],attributes:{},language:N},R=_.alias;R&&(Array.isArray(R)?Array.prototype.push.apply(P.classes,R):P.classes.push(R)),o.hooks.run("wrap",P);var T="";for(var D in P.attributes)T+=" "+D+'="'+(P.attributes[D]||"").replace(/"/g,"&quot;")+'"';return"<"+P.tag+' class="'+P.classes.join(" ")+'"'+T+">"+P.content+"</"+P.tag+">"};function d(k,_,N,A){k.lastIndex=_;var P=k.exec(N);if(P&&A&&P[1]){var R=P[1].length;P.index+=R,P[0]=P[0].slice(R)}return P}function f(k,_,N,A,P,R){for(var T in N)if(!(!N.hasOwnProperty(T)||!N[T])){var D=N[T];D=Array.isArray(D)?D:[D];for(var I=0;I<D.length;++I){if(R&&R.cause==T+","+I)return;var K=D[I],X=K.inside,Z=!!K.lookbehind,oe=!!K.greedy,q=K.alias;if(oe&&!K.pattern.global){var re=K.pattern.toString().match(/[imsuy]*$/)[0];K.pattern=RegExp(K.pattern.source,re+"g")}for(var M=K.pattern||K,W=A.next,B=P;W!==_.tail&&!(R&&B>=R.reach);B+=W.value.length,W=W.next){var G=W.value;if(_.length>k.length)return;if(!(G instanceof c)){var H=1,O;if(oe){if(O=d(M,B,k,Z),!O||O.index>=k.length)break;var te=O.index,z=O.index+O[0].length,Y=B;for(Y+=W.value.length;te>=Y;)W=W.next,Y+=W.value.length;if(Y-=W.value.length,B=Y,W.value instanceof c)continue;for(var J=W;J!==_.tail&&(Y<z||typeof J.value=="string");J=J.next)H++,Y+=J.value.length;H--,G=k.slice(B,Y),O.index-=B}else if(O=d(M,0,G,Z),!O)continue;var te=O.index,ee=O[0],ie=G.slice(0,te),me=G.slice(te+ee.length),Ce=B+G.length;R&&Ce>R.reach&&(R.reach=Ce);var Oe=W.prev;ie&&(Oe=g(_,Oe,ie),B+=ie.length),y(_,Oe,H);var fe=new c(T,X?o.tokenize(ee,X):ee,q,ee);if(W=g(_,Oe,fe),me&&g(_,W,me),H>1){var pe={cause:T+","+I,reach:Ce};f(k,_,N,W.prev,B,pe),R&&pe.reach>R.reach&&(R.reach=pe.reach)}}}}}}function p(){var k={value:null,prev:null,next:null},_={value:null,prev:k,next:null};k.next=_,this.head=k,this.tail=_,this.length=0}function g(k,_,N){var A=_.next,P={value:N,prev:_,next:A};return _.next=P,A.prev=P,k.length++,P}function y(k,_,N){for(var A=_.next,P=0;P<N&&A!==k.tail;P++)A=A.next;_.next=A,A.prev=_,k.length-=P}function v(k){for(var _=[],N=k.head.next;N!==k.tail;)_.push(N.value),N=N.next;return _}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(k){var _=JSON.parse(k.data),N=_.language,A=_.code,P=_.immediateClose;n.postMessage(o.highlight(A,o.languages[N],N)),P&&n.close()},!1)),o;var w=o.util.currentScript();w&&(o.filename=w.src,w.hasAttribute("data-manual")&&(o.manual=!0));function b(){o.manual||o.highlightAll()}if(!o.manual){var E=document.readyState;E==="loading"||E==="interactive"&&w&&w.defer?document.addEventListener("DOMContentLoaded",b):window.requestAnimationFrame?window.requestAnimationFrame(b):window.setTimeout(b,16)}return o})(t);e.exports&&(e.exports=r),typeof O1<"u"&&(O1.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(w,b){return" Error "+w+" while fetching file: "+b},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",c="loading",d="loaded",f="failed",p="pre[data-src]:not(["+o+'="'+d+'"]):not(['+o+'="'+c+'"])';function g(w,b,E){var k=new XMLHttpRequest;k.open("GET",w,!0),k.onreadystatechange=function(){k.readyState==4&&(k.status<400&&k.responseText?b(k.responseText):k.status>=400?E(s(k.status,k.statusText)):E(a))},k.send(null)}function y(w){var b=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(w||"");if(b){var E=Number(b[1]),k=b[2],_=b[3];return k?_?[E,Number(_)]:[E,void 0]:[E,E]}}r.hooks.add("before-highlightall",function(w){w.selector+=", "+p}),r.hooks.add("before-sanity-check",function(w){var b=w.element;if(b.matches(p)){w.code="",b.setAttribute(o,c);var E=b.appendChild(document.createElement("CODE"));E.textContent=n;var k=b.getAttribute("data-src"),_=w.language;if(_==="none"){var N=(/\.(\w+)$/.exec(k)||[,"none"])[1];_=i[N]||N}r.util.setLanguage(E,_),r.util.setLanguage(b,_);var A=r.plugins.autoloader;A&&A.loadLanguages(_),g(k,function(P){b.setAttribute(o,d);var R=y(b.getAttribute("data-range"));if(R){var T=P.split(/\r\n?|\n/g),D=R[0],I=R[1]==null?T.length:R[1];D<0&&(D+=T.length),D=Math.max(0,Math.min(D-1,T.length)),I<0&&(I+=T.length),I=Math.max(0,Math.min(I,T.length)),P=T.slice(D,I).join(`
`),b.hasAttribute("data-start")||b.setAttribute("data-start",String(D+1))}E.textContent=P,r.highlightElement(E)},function(P){b.setAttribute(o,f),E.textContent=P})}}),r.plugins.fileHighlight={highlight:function(b){for(var E=(b||document).querySelectorAll(p),k=0,_;_=E[k++];)r.highlightElement(_)}};var v=!1;r.fileHighlight=function(){v||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),v=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(Dw)),Dw.exports}N$();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(f){return f=f.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+f+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(f){["url","bold","italic","strike","code-snippet"].forEach(function(p){f!==p&&(e.languages.markdown[f].inside.content.inside[p]=e.languages.markdown[p])})}),e.hooks.add("after-tokenize",function(f){if(f.language!=="markdown"&&f.language!=="md")return;function p(g){if(!(!g||typeof g=="string"))for(var y=0,v=g.length;y<v;y++){var w=g[y];if(w.type!=="code"){p(w.content);continue}var b=w.content[1],E=w.content[3];if(b&&E&&b.type==="code-language"&&E.type==="code-block"&&typeof b.content=="string"){var k=b.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");k=(/[a-z][\w-]*/i.exec(k)||[""])[0].toLowerCase();var _="language-"+k;E.alias?typeof E.alias=="string"?E.alias=[E.alias,_]:E.alias.push(_):E.alias=[_]}}}p(f.tokens)}),e.hooks.add("wrap",function(f){if(f.type==="code-block"){for(var p="",g=0,y=f.classes.length;g<y;g++){var v=f.classes[g],w=/language-(.+)/.exec(v);if(w){p=w[1];break}}var b=e.languages[p];if(b)f.content=e.highlight(d(f.content),b,p);else if(p&&p!=="none"&&e.plugins.autoloader){var E="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);f.attributes.id=E,e.plugins.autoloader.loadLanguages(p,function(){var k=document.getElementById(E);k&&(k.innerHTML=e.highlight(k.textContent,e.languages[p],p))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function d(f){var p=f.replace(i,"");return p=p.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(g,y){if(y=y.toLowerCase(),y[0]==="#"){var v;return y[1]==="x"?v=parseInt(y.slice(2),16):v=Number(y.slice(1)),c(v)}else{var w=o[y];return w||g}}),p}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var OE={},LE;function A$(){return LE||(LE=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),OE}A$();var BE={},UE;function j$(){return UE||(UE=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),BE}j$();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var $E={},WE;function F$(){return WE||(WE=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),$E}F$();var zE={},HE;function P$(){return HE||(HE=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),zE}P$();var GE={},VE;function R$(){return VE||(VE=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),GE}R$();function Ej(e,t){for(const r of e.childNodes){if(Rn(r)&&r.tagName===t)return!0;Ej(r,t)}return!1}const _m="data-language",pm="data-highlight-language",g1="data-theme";class vf extends Ba{static getType(){return"code"}static clone(t){return new vf(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");Ms(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(_m,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(pm,n));const s=this.getTheme();s&&r.setAttribute(g1,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(_m,s):a&&r.removeAttribute(_m);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(pm,s):r.removeAttribute(pm):i&&s&&r.setAttribute(pm,s);const o=this.__theme,c=t.__theme;o?o!==c&&r.setAttribute(g1,o):c&&r.removeAttribute(g1);const d=this.__style,f=t.__style;return d?d!==f&&r.setAttribute("style",d):f&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");Ms(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(_m,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(pm,n));const s=this.getTheme();s&&r.setAttribute(g1,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||Ej(t,"BR"))?{conversion:KE,priority:1}:null,div:()=>({conversion:D$,priority:1}),pre:()=>({conversion:KE,priority:0}),table:t=>Iw(t)?{conversion:I$,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&Iw(n)?{conversion:qE,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&Iw(r)?{conversion:qE,priority:3}:null}}}static importJSON(t){return pc().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=Pn();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(Wt(o)){let c=O$(o);const d=[];for(;;)if(Ly(c))d.push(w0()),c=c.getNextSibling();else{if(!jj(c))break;{let b=0;const E=c.getTextContent(),k=c.getTextContentSize();for(;b<k&&E[b]===" ";)b++;if(b!==0&&d.push(Aj(" ".repeat(b))),b!==k)break;c=c.getNextSibling()}}const f=o.splitText(a.offset)[0],p=a.offset===0?0:1,g=f.getIndexWithinParent()+p,y=o.getParentOrThrow(),v=[jl(),...d];y.splice(g,0,v);const w=d[d.length-1];w?w.select():a.offset===0?f.selectPrevious():f.getNextSibling().selectNext(0,0)}if(eS(o)){const{offset:c}=t.anchor;o.splice(c,0,[jl()]),o.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=Pn();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function pc(e,t){return nU(vf).setLanguage(e).setTheme(t)}function eS(e){return e instanceof vf}function KE(e){return{node:pc(e.getAttribute(_m))}}function D$(e){const t=e,r=XE(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(XE(s))return!0;s=s.parentElement}return!1})(t)?{node:r?pc():null}:{node:null}}function I$(){return{node:pc()}}function qE(){return{node:null}}function XE(e){return e.style.fontFamily.match("monospace")!==null}function Iw(e){return e.classList.contains("js-file-line-container")}let qy=class Nj extends Vu{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new Nj(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=Mw(t.theme,this.__highlightType);return Ms(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=Mw(n.theme,t.__highlightType),i=Mw(n.theme,this.__highlightType);return a!==i&&(a&&Ru(r,a),i&&Ms(r,i)),s}static importJSON(t){return Aj().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return pc()}};function Mw(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function Aj(e="",t){return ii(new qy(e,t))}function jj(e){return e instanceof qy}function M$(e,t){let r=e;for(let n=wa(e,t);n&&(jj(n.origin)||Ly(n.origin));n=EU(n))r=n.origin;return r}function O$(e){return M$(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const L$=new Set(["http:","https:","mailto:","sms:","tel:"]);class Xu extends Ba{static getType(){return"link"}static clone(t){return new Xu(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),Ms(r,t.theme.link),r}updateLinkDOM(t,r,n){if(zA(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:B$,priority:1})}}static importJSON(t){return ly().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=QE(t);try{const r=new URL(QE(t));if(!L$.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=ly(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Tt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function B$(e){let t=null;if(zA(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=ly(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function ly(e="",t){return ii(new Xu(e,t))}function U$(e){return e instanceof Xu}class E0 extends Xu{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new E0(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return YE().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(xt(n)){const s=YE(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function YE(e="",t){return ii(new E0(e,t))}function $$(e){return e instanceof E0}const W$=/^\+?[0-9\s()-]{5,}$/;function QE(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:W$.test(e)?`tel:${e}`:`https://${e}`}function s2(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function z$(e){const t=s2(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const JE=/[!-/:-@[-`{-~\s]/;function H$(e){return Wt(e)&&!e.hasFormat("code")}function G$(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function ZE(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(Fj(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function Fj(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function V$(e,t=Xy){const r=z$(t),n=s2(r.textFormat,(({tag:i})=>i[i.length-1])),s=s2(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const c=i.dependencies;for(const d of c)e.hasNode(d)||G$(173,d.getType())}}const a=(i,o,c)=>{(function(d,f,p,g){const y=d.getParent();if(!si(y)||d.getFirstChild()!==f)return!1;const v=f.getTextContent();if(v[p-1]!==" ")return!1;for(const{regExp:w,replace:b}of g){const E=v.match(w);if(E&&E[0].length===(E[0].endsWith(" ")?p:p-1)){const k=f.getNextSiblings(),[_,N]=f.splitText(p);if(b(d,N?[N,...k]:k,E,!1)!==!1)return _.remove(),!0}}return!1})(i,o,c,r.element)||(function(d,f,p,g){const y=d.getParent();if(!si(y)||d.getFirstChild()!==f)return!1;const v=f.getTextContent();if(v[p-1]!==" ")return!1;for(const{regExpStart:w,replace:b,regExpEnd:E}of g){if(E&&!("optional"in E)||E&&"optional"in E&&!E.optional)continue;const k=v.match(w);if(k&&k[0].length===(k[0].endsWith(" ")?p:p-1)){const _=f.getNextSiblings(),[N,A]=f.splitText(p);if(b(d,A?[A,..._]:_,k,null,null,!1)!==!1)return N.remove(),!0}}return!1})(i,o,c,r.multilineElement)||(function(d,f,p){let g=d.getTextContent();const y=p[g[f-1]];if(y==null)return!1;f<g.length&&(g=g.slice(0,f));for(const v of y){if(!v.replace||!v.regExp)continue;const w=g.match(v.regExp);if(w===null)continue;const b=w.index||0,E=b+w[0].length;let k;return b===0?[k]=d.splitText(E):[,k]=d.splitText(b,E),k.selectNext(0,0),v.replace(k,w),!0}return!1})(o,c,s)||(function(d,f,p){const g=d.getTextContent(),y=f-1,v=g[y],w=p[v];if(!w)return!1;for(const b of w){const{tag:E}=b,k=E.length,_=y-k+1;if(k>1&&!Fj(g,_,E,0,k)||g[_-1]===" ")continue;const N=g[y+1];if(b.intraword===!1&&N&&!JE.test(N))continue;const A=d;let P=A,R=ZE(g,_,E),T=P;for(;R<0&&(T=T.getPreviousSibling())&&!yc(T);)if(Wt(T)){if(T.hasFormat("code"))continue;const M=T.getTextContent();P=T,R=ZE(M,M.length,E)}if(R<0||P===A&&R+k===_)continue;const D=P.getTextContent();if(R>0&&D[R-1]===v)continue;const I=D[R-1];if(b.intraword===!1&&I&&!JE.test(I))continue;const K=A.getTextContent(),X=K.slice(0,_)+K.slice(y+1);A.setTextContent(X);const Z=P===A?X:D;P.setTextContent(Z.slice(0,R)+Z.slice(R+k));const oe=$t(),q=Uy();_a(q);const re=y-k*(P===A?2:1)+1;q.anchor.set(P.__key,R,"text"),q.focus.set(A.__key,re,"text");for(const M of b.format)q.hasFormat(M)||q.formatText(M);q.anchor.set(q.focus.key,q.focus.offset,q.focus.type);for(const M of b.format)q.hasFormat(M)&&q.toggleFormat(M);return Tt(oe)&&(q.format=oe.format),!0}})(o,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:c,prevEditorState:d})=>{if(i.has(jA)||i.has(ry)||e.isComposing())return;const f=c.read($t),p=d.read($t);if(!Tt(p)||!Tt(f)||!f.isCollapsed()||f.is(p))return;const g=f.anchor.key,y=f.anchor.offset,v=c._nodeMap.get(g);!Wt(v)||!o.has(g)||y!==1&&y>p.anchor.offset+1||e.update((()=>{if(!H$(v))return;const w=v.getParent();w===null||eS(w)||a(w,v,f.anchor.offset)}))}))}const K$=/^(\s*)(\d{1,})\.\s/,q$=/^(\s*)[-*+]\s/,X$=/^(#{1,6})\s/,Y$=/^>\s/,Q$=/^[ \t]*```([\w-]+)?/,J$=/[ \t]*```$/,Pj=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},Rj=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=Ui(e==="check"?n[3]==="x":void 0);if(Cr(i)&&i.getListType()===e){const d=i.getFirstChild();d!==null?d.insertBefore(o):i.append(o),t.remove()}else if(Cr(a)&&a.getListType()===e)a.append(o),t.remove();else{const d=Si(e,e==="number"?Number(n[2]):void 0);d.append(o),t.replace(d)}o.append(...r),s||o.select(0,0);const c=(function(d){const f=d.match(/\t/g),p=d.match(/ /g);let g=0;return f&&(g+=f.length),p&&(g+=Math.floor(p.length/4)),g})(n[1]);c&&o.setIndent(c)},tS=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(rn(i)){if(i.getChildrenSize()===1){const f=i.getFirstChild();if(Cr(f)){n.push(tS(f,t,r+1));continue}}const o=" ".repeat(4*r),c=e.getListType(),d=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+d+t(i)),a++}return n.join(`
`)},Z$={dependencies:[Lp],export:(e,t)=>{if(!XU(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:X$,replace:Pj((e=>{const t="h"+e[1].length;return Cu(t)})),type:"element"},eW={dependencies:[Mp],export:(e,t)=>{if(!vE(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:Y$,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(vE(a))return a.splice(a.getChildrenSize(),0,[jl(),...t]),void e.remove()}const s=Op();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},tW={dependencies:[vf],export:e=>{if(!eS(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:J$},regExpStart:Q$,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=pc(),o=r[1]+s[0]):(i=pc(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=pc(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const c=Zn(o);i.append(c),e.append(i)}else t&&Pj((c=>pc(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},rW={dependencies:[qu,Nc],export:(e,t)=>Cr(e)?tS(e,t,0):null,regExp:q$,replace:Rj("bullet"),type:"element"},nW={dependencies:[qu,Nc],export:(e,t)=>Cr(e)?tS(e,t,0):null,regExp:K$,replace:Rj("number"),type:"element"},sW={format:["code"],tag:"`",type:"text-format"},aW={format:["highlight"],tag:"==",type:"text-format"},iW={format:["bold","italic"],tag:"***",type:"text-format"},oW={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},lW={format:["bold"],tag:"**",type:"text-format"},cW={format:["bold"],intraword:!1,tag:"__",type:"text-format"},uW={format:["strikethrough"],tag:"~~",type:"text-format"},dW={format:["italic"],tag:"*",type:"text-format"},fW={format:["italic"],intraword:!1,tag:"_",type:"text-format"},hW={dependencies:[Xu],export:(e,t,r)=>{if(!U$(e)||$$(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=ly(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let c=r,d="";if(i<o)return;if(i>o){const p=r.split("[");d="["+p[0],c=p.slice(1).join("[")}const f=Zn(c);return f.setFormat(e.getFormat()),a.append(f),e.replace(a),d&&a.insertBefore(Zn(d)),f},trigger:")",type:"text-match"},gW=[Z$,eW,rW,nW],mW=[tW],pW=[sW,iW,oW,lW,cW,aW,dW,fW,uW],xW=[hW],Xy=[...gW,...mW,...pW,...xW];function eN(e,t){return e.getEditorState().read((()=>{const r=Es(t);return r!==null&&r.isSelected()}))}function yW(e){const[t]=Pl(),[r,n]=C.useState((()=>eN(t,e)));return C.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(eN(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,C.useCallback((s=>{t.update((()=>{let a=$t();ja(a)||(a=Sb(),_a(a)),ja(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),C.useCallback((()=>{t.update((()=>{const s=$t();ja(s)&&s.clear()}))}),[t])]}function vW({nodeKey:e}){const[t]=Pl(),[r,n,s]=yW(e);return C.useEffect((()=>yf(t.registerCommand(xb,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Ph))),[s,t,r,e,n]),C.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?Ms(a,i):Ru(a,i))}),[t,r,e]),null}class Up extends Tb{static getType(){return"horizontalrule"}static clone(t){return new Up(t.__key)}static importJSON(t){return rS().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:wW,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return Ms(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return l.jsx(vW,{nodeKey:this.__key})}}function wW(){return{node:rS()}}function rS(){return ii(new Up)}function _W(e){return e instanceof Up}const bW=[{dependencies:[Up],export:e=>_W(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=rS();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...Xy];function Dj({transformers:e=bW}){const[t]=Pl();return C.useEffect((()=>V$(t,e)),[t,e]),null}function Ij({hasStrictIndent:e=!1}){const[t]=Pl();return C.useEffect((()=>{if(!t.hasNodes([qu,Nc]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),C.useEffect((()=>{if(e)return E$(t)}),[t,e]),(function(r){C.useEffect((()=>T$(r)),[r])})(t),null}const SW=({onChange:e})=>{const[t]=C.useContext(y0)||[];return C.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{Un().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},kW=()=>{const[e]=C.useContext(y0)||[],t=C.useCallback(()=>{e&&e.dispatchCommand(Ma,"bold")},[e]),r=C.useCallback(()=>{e&&e.dispatchCommand(Ma,"italic")},[e]),n=C.useCallback(()=>{e&&e.dispatchCommand(Ma,"underline")},[e]),s=C.useCallback(()=>{e&&e.dispatchCommand(Ma,"strikethrough")},[e]),a=C.useCallback(y=>{e&&e.update(()=>{const v=$t();Tt(v)&&Xh(v,()=>Cu(y))})},[e]),i=C.useCallback(()=>{e&&e.update(()=>{const y=$t();Tt(y)&&Xh(y,()=>Pn())})},[e]);C.useCallback(()=>{e&&e.update(()=>{const y=$t();Tt(y)&&Xh(y,()=>Op())})},[e]);const o=C.useCallback(()=>{e&&e.dispatchCommand(Qb)},[e]),c=C.useCallback(()=>{e&&e.dispatchCommand(Jb)},[e]),d=C.useCallback(()=>{e&&e.dispatchCommand(Zb)},[e]),f=C.useCallback(y=>{e&&e.update(()=>{const v=$t();Tt(v)&&v.getNodes().forEach(w=>{Wt(w)&&w.setStyle(`color: ${y}`)})})},[e]),p=C.useCallback(y=>{e&&e.update(()=>{const v=$t();Tt(v)&&v.getNodes().forEach(b=>{if(Wt(b)){const E=b.getStyle(),k=E?E.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",_=k?`${k}; font-size: ${y}px;`:`font-size: ${y}px;`;b.setStyle(_)}})})},[e]),g=C.useCallback(y=>{e&&e.dispatchCommand(lA,y)},[e]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),l.jsx("button",{type:"button",onClick:()=>f("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),l.jsx("button",{type:"button",onClick:()=>f("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),l.jsx("button",{type:"button",onClick:()=>f("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),l.jsx("button",{type:"button",onClick:()=>f("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),l.jsx("button",{type:"button",onClick:()=>p(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),l.jsx("button",{type:"button",onClick:()=>p(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),l.jsx("button",{type:"button",onClick:()=>p(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),l.jsx("button",{type:"button",onClick:()=>p(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),l.jsx("button",{type:"button",onClick:()=>g("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),l.jsx("button",{type:"button",onClick:()=>g("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),l.jsx("button",{type:"button",onClick:()=>g("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},CW=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Lp,qu,Nc,Mp,vf,qy,Bp,C0,T0,E0,Xu],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(XA,{initialConfig:n,children:[l.jsx(kW,{}),l.jsx(SW,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(hj,{contentEditable:l.jsx(mj,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:yj}),l.jsx(pj,{}),l.jsx(xj,{}),l.jsx(Ij,{}),l.jsx(Dj,{transformers:Xy})]})]})})},TW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Mn(),{post:o}=Wi(),{showNotification:c}=ba(),[d,f]=C.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[p,g]=C.useState({isLoading:!1,error:null,showPreview:!0});C.useEffect(()=>{f(_=>({..._,test_name:e||""}))},[e]);const y=()=>{if(d.num_questions>=3){g(A=>({...A,error:"Maximum 3 questions allowed for performance reasons"}));return}const N={id:Math.max(...d.questions.map(A=>A.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};f(A=>({...A,num_questions:A.num_questions+1,questions:[...A.questions,N]}))},v=_=>{d.questions.length<=1||f(N=>({...N,num_questions:N.num_questions-1,questions:N.questions.filter(A=>A.id!==_)}))},w=(_,N)=>{f(A=>({...A,questions:A.questions.map(P=>P.id===_?{...P,question_json:N}:P)}))},b=(_,N,A)=>{f(P=>({...P,questions:P.questions.map(R=>R.id===_?{...R,canvas_width:N,canvas_height:A}:R)}))},E=(_,N,A)=>{f(P=>({...P,questions:P.questions.map(R=>R.id===_?{...R,max_canvas_width:N,max_canvas_height:A}:R)}))},k=async()=>{if(!d.test_name.trim()){g(_=>({..._,error:"Test name is required"}));return}if(d.questions.some(_=>!_.question_json.trim())){g(_=>({..._,error:"All questions must have content"}));return}g(_=>({..._,isLoading:!0,error:null}));try{const _={test_name:d.test_name,num_questions:d.num_questions,passing_score:d.passing_score,questions:d.questions.map((N,A)=>({question_id:A+1,question_json:N.question_json,canvas_width:N.canvas_width,canvas_height:N.canvas_height,max_canvas_width:N.max_canvas_width,max_canvas_height:N.max_canvas_height}))};t&&t(_)}catch(_){console.error("Error preparing drawing test:",_),g(N=>({...N,error:"Failed to prepare drawing test. Please try again."})),c("Failed to prepare drawing test","error")}finally{g(_=>({..._,isLoading:!1}))}};return l.jsx("div",{className:"drawing-test-creator max-w-4xl mx-auto p-6",children:l.jsxs(bt,{className:"p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",d.num_questions,"/3)"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),l.jsxs(Ze,{onClick:y,disabled:d.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),l.jsx("div",{className:"space-y-4",children:d.questions.map((_,N)=>l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",N+1]}),d.questions.length>1&&l.jsx(Ze,{onClick:()=>v(_.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),l.jsx(CW,{value:_.question_json,onChange:A=>w(_.id,A),placeholder:""})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Canvas Dimensions"}),l.jsx("p",{className:"text-xs text-gray-500 mb-3",children:"Canvas is the actual drawing area, viewport is the initial display size"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Width"}),l.jsx("input",{type:"number",value:_.canvas_width,onChange:A=>b(_.id,parseInt(A.target.value),_.canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Viewport Height"}),l.jsx("input",{type:"number",value:_.canvas_height,onChange:A=>b(_.id,_.canvas_width,parseInt(A.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"2048"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Width"}),l.jsx("input",{type:"number",value:_.max_canvas_width,onChange:A=>E(_.id,parseInt(A.target.value),_.max_canvas_height),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Canvas Height"}),l.jsx("input",{type:"number",value:_.max_canvas_height,onChange:A=>E(_.id,_.max_canvas_width,parseInt(A.target.value)),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",min:"200",max:"4096"})]})]})]})]},_.id))})]}),p.error&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:p.error}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(Ze,{onClick:r,variant:"secondary",disabled:p.isLoading,children:"Cancel"}),l.jsx(Ze,{onClick:k,variant:"primary",disabled:p.isLoading||!d.test_name.trim(),className:"flex items-center gap-2",children:p.isLoading?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})})},EW=({onChange:e})=>{const[t]=C.useContext(y0)||[];return C.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{Un().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},NW=({onAddBlank:e,blankCount:t})=>{const[r]=C.useContext(y0)||[],n=C.useCallback(()=>{r&&r.dispatchCommand(Ma,"bold")},[r]),s=C.useCallback(()=>{r&&r.dispatchCommand(Ma,"italic")},[r]),a=C.useCallback(()=>{r&&r.dispatchCommand(Ma,"underline")},[r]),i=C.useCallback(()=>{r&&r.dispatchCommand(Ma,"strikethrough")},[r]),o=C.useCallback(v=>{r&&r.update(()=>{const w=$t();Tt(w)&&Xh(w,()=>Cu(v))})},[r]),c=C.useCallback(()=>{r&&r.update(()=>{const v=$t();Tt(v)&&Xh(v,()=>Pn())})},[r]),d=C.useCallback(()=>{r&&r.update(()=>{const v=$t();Tt(v)&&Xh(v,()=>Op())})},[r]),f=C.useCallback(()=>{r&&r.dispatchCommand(Qb)},[r]),p=C.useCallback(()=>{r&&r.dispatchCommand(Jb)},[r]),g=C.useCallback(()=>{r&&r.dispatchCommand(Zb)},[r]),y=C.useCallback(()=>{!r||!e||(r.update(()=>{const v=$t();if(Tt(v)){const b=`${t+1}_________`,E=Zn(b);E.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),v.insertNodes([E])}}),e())},[r,e,t]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:f,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),l.jsx("button",{type:"button",onClick:p,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),l.jsx("button",{type:"button",onClick:g,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&l.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:l.jsxs("button",{type:"button",onClick:y,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},AW=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[Lp,qu,Nc,Mp,vf,qy,Bp,C0,T0,E0,Xu],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(XA,{initialConfig:a,children:[l.jsx(NW,{onAddBlank:n,blankCount:s}),l.jsx(EW,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(hj,{contentEditable:l.jsx(mj,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:yj}),l.jsx(pj,{}),l.jsx(xj,{}),l.jsx(Ij,{}),l.jsx(Dj,{transformers:Xy})]})]})})},jW=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=Mn(),{post:c}=Wi(),{showNotification:d}=ba(),[f,p]=C.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[g,y]=C.useState({isLoading:!1,error:null,showPreview:!0});C.useEffect(()=>{p(R=>({...R,test_name:e||"",allowed_time:t}))},[e,t]);const v=R=>{p(T=>({...T,test_text:R}))},w=()=>{const T={id:f.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};p(D=>({...D,blanks:[...D.blanks,T],num_blanks:D.num_blanks+1}))},b=R=>{p(T=>({...T,blanks:T.blanks.filter(D=>D.id!==R),num_blanks:T.num_blanks-1}))},E=R=>{p(T=>({...T,blanks:T.blanks.map(D=>D.id===R?{...D,options:[...D.options,""]}:D)}))},k=(R,T)=>{p(D=>({...D,blanks:D.blanks.map(I=>I.id===R?{...I,options:I.options.filter((K,X)=>X!==T),correct_answer:I.correct_answer===String.fromCharCode(65+T)?"":I.correct_answer}:I)}))},_=(R,T,D)=>{p(I=>({...I,blanks:I.blanks.map(K=>K.id===R?{...K,options:K.options.map((X,Z)=>Z===T?D:X)}:K)}))},N=(R,T)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:R,question:T}),p(D=>({...D,blanks:D.blanks.map(I=>I.id===R?{...I,question:T}:I)})),console.log(" [DEBUG] updateBlankQuestion completed")},A=(R,T)=>{p(D=>({...D,blanks:D.blanks.map(I=>I.id===R?{...I,correct_answer:T}:I)}))},P=async()=>{if(!f.test_name.trim()){y(R=>({...R,error:"Test name is required"}));return}if(!f.test_text.trim()){y(R=>({...R,error:"Test text is required"}));return}if(f.blanks.length===0){y(R=>({...R,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",f.blanks),f.blanks.forEach((R,T)=>{console.log(` [DEBUG] Blank ${T+1}:`,{question:R.question,questionTrimmed:R.question?.trim(),correct_answer:R.correct_answer,options:R.options})}),f.separate_type===!1){if(f.blanks.some(R=>!R.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),y(R=>({...R,error:"All blanks must have correct answers"}));return}}else if(f.blanks.some(R=>!R.question.trim()||!R.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),y(R=>({...R,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),y(R=>({...R,isLoading:!0,error:null}));try{const R={test_name:f.test_name,test_text:f.test_text,num_questions:f.blanks.length,num_blanks:f.blanks.length,separate_type:f.separate_type,passing_score:f.passing_score,allowed_time:f.allowed_time,blanks:f.blanks.map((T,D)=>({question_id:D+1,question_json:T.question,question:T.question,options:T.options,correct_answer:T.correct_answer,blank_positions:{},blank_options:T.options||[],correct_answers:[T.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",R),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(R),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(R){console.error("Error preparing fill blanks test:",R),y(T=>({...T,error:"Failed to prepare fill blanks test. Please try again."})),d("Failed to prepare fill blanks test","error")}finally{y(R=>({...R,isLoading:!1}))}};return l.jsx("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto p-6",children:l.jsxs(bt,{className:"p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test with rich text content and multiple choice blanks"}),l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Blanks:"})," ",f.num_blanks," (auto-calculated)"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Timer:"})," ",f.allowed_time?`${f.allowed_time} minutes`:"No timer"]})]})}),g.error&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600 text-sm",children:g.error})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Text Content with Blanks"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Type your text and add blanks where needed"})]}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Mode:"}),l.jsxs("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[l.jsx("button",{onClick:()=>p(R=>({...R,separate_type:!0})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${f.separate_type===!0?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Separate"}),l.jsx("button",{onClick:()=>p(R=>({...R,separate_type:!1})),className:`px-3 py-1 text-sm font-medium rounded-md transition-colors ${f.separate_type===!1?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Inline"})]})]})})]}),l.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:f.separate_type===!0?"Separate Mode:":"Inline Mode:"})," ",f.separate_type===!0?"Students see numbered blanks in text and answer questions below":"Students see clickable blanks in text with dropdown options"]})}),l.jsx(AW,{value:f.test_text,onChange:v,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:w,blankCount:f.blanks.length})]}),f.separate_type===!0&&l.jsx("div",{className:"space-y-4",children:f.blanks.map((R,T)=>l.jsxs(bt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",R.id," Configuration"]}),l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>b(R.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",R.id," *"]}),l.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:R.question,onChange:D=>N(R.id,D.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),R.options.map((D,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:D||"",onChange:K=>_(R.id,I,K.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),R.options.length>2&&l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>k(R.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),R.options.length<6&&l.jsx(Ze,{variant:"secondary",size:"small",onClick:()=>E(R.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:R.correct_answer||"",onChange:D=>A(R.id,D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),R.options.filter(D=>D.trim().length>0).map((D,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",D]},I))]})]})]},R.id))}),f.separate_type===!1&&l.jsx("div",{className:"space-y-4",children:f.blanks.map((R,T)=>l.jsxs(bt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",R.id," Options"]}),l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>b(R.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),R.options.map((D,I)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+I)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+I)}`,value:D||"",onChange:K=>_(R.id,I,K.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),R.options.length>2&&l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>k(R.id,I),className:"px-2 py-1 text-sm",children:""})]},I)),R.options.length<6&&l.jsx(Ze,{variant:"secondary",size:"small",onClick:()=>E(R.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:R.correct_answer||"",onChange:D=>A(R.id,D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),R.options.filter(D=>D.trim().length>0).map((D,I)=>l.jsxs("option",{value:String.fromCharCode(65+I),children:[String.fromCharCode(65+I),") ",D]},I))]})]})]},R.id))}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[l.jsx(Ze,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),l.jsx(Ze,{onClick:P,variant:"primary",disabled:a||f.blanks.length===0,children:a?l.jsx(Tr,{size:"sm"}):"Save Test"})]})]})})},FW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=ba(),[o,c]=C.useState({min_words:50,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"medium"}]}),[d,f]=C.useState(!1),p=C.useCallback((E,k)=>{c(_=>({..._,[E]:k}))},[]),g=C.useCallback((E,k,_)=>{c(N=>({...N,questions:N.questions.map((A,P)=>P===E?{...A,[k]:_}:A)}))},[]),y=C.useCallback(()=>{c(E=>({...E,questions:[...E.questions,{question_id:E.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"medium"}]}))},[]),v=C.useCallback(E=>{o.questions.length>1&&c(k=>({...k,questions:k.questions.filter((_,N)=>N!==E)}))},[o.questions.length]),w=C.useCallback(()=>{const E={};return o.min_words<10&&(E.min_words="Minimum word count must be at least 10 words"),o.questions.forEach((k,_)=>{k.prompt.trim()||(E[`question_${_}_prompt`]="Question prompt is required")}),E},[o]),b=C.useCallback(async E=>{E.preventDefault();const k=w();if(Object.keys(k).length>0){i("Please fix the validation errors","error");return}f(!0);try{const _={test_name:e,time_limit:300,min_duration:30,max_duration:600,max_attempts:3,min_words:o.min_words,passing_score:50,allowed_time:null,questions:o.questions.map((N,A)=>({question_id:A+1,prompt:N.prompt,expected_duration:N.expected_duration,difficulty_level:N.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",_),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(_),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(_){console.error("Error preparing speaking test:",_),i("Failed to prepare speaking test","error")}finally{f(!1)}},[o,w,i,t,e]);return d||s?l.jsxs("div",{className:"flex items-center justify-center p-8",children:[l.jsx(Tr,{}),l.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):l.jsx("div",{className:"speaking-test-creator max-w-4xl mx-auto p-6",children:l.jsxs(bt,{className:"p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),l.jsxs("form",{onSubmit:b,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),l.jsx("input",{type:"number",min:"10",max:"1000",value:o.min_words,onChange:E=>p("min_words",parseInt(E.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),l.jsx(Ze,{type:"button",variant:"outline",onClick:y,children:"Add Question"})]}),o.questions.map((E,k)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"font-medium",children:["Question ",k+1]}),o.questions.length>1&&l.jsx(Ze,{type:"button",variant:"outline",size:"sm",onClick:()=>v(k),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),l.jsx("textarea",{value:E.prompt,onChange:_=>g(k,"prompt",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${k}_prompt`]&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${k}_prompt`]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),l.jsx("input",{type:"number",min:"10",max:"600",value:E.expected_duration||"",onChange:_=>g(k,"expected_duration",_.target.value?parseInt(_.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Difficulty Level"}),l.jsxs("select",{value:E.difficulty_level,onChange:_=>g(k,"difficulty_level",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"easy",children:"Easy"}),l.jsx("option",{value:"medium",children:"Medium"}),l.jsx("option",{value:"hard",children:"Hard"})]})]})]})]})]},k))]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",disabled:d||s,children:d||s?"Creating...":"Create Speaking Test"})]})]})]})})},Mj=(e,t)=>{const[r,n]=C.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=C.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=C.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},Yy=()=>{const e=C.useCallback((c,d=null)=>{try{const f=window.localStorage.getItem(c);return f?JSON.parse(f):d}catch(f){return console.error(`Error reading localStorage key "${c}":`,f),d}},[]),t=C.useCallback((c,d)=>{try{window.localStorage.setItem(c,JSON.stringify(d))}catch(f){console.error(`Error setting localStorage key "${c}":`,f)}},[]),r=C.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(d){console.error(`Error removing localStorage key "${c}":`,d)}},[]),n=C.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=C.useCallback(()=>{try{const c={};for(let g=0;g<window.localStorage.length;g++){const y=window.localStorage.key(g);y&&(c[y]=window.localStorage.getItem(y))}const d=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),f=URL.createObjectURL(d),p=document.createElement("a");p.href=f,p.download="localStorage_backup.json",p.click(),URL.revokeObjectURL(f),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=C.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=C.useCallback(()=>{try{const c={};for(let d=0;d<window.localStorage.length;d++){const f=window.localStorage.key(d);f&&(c[f]=window.localStorage.getItem(f))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),o=C.useCallback(c=>{try{Object.entries(c).forEach(([d,f])=>{window.localStorage.setItem(d,f)})}catch(d){console.error("Error importing localStorage data:",d)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},PW=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onSave:o,isEditing:c=!1,isSaving:d=!1,validationErrors:f={},showCorrectAnswers:p=!1,studentId:g=null})=>{const{getItem:y,setItem:v}=Yy();ba(),C.useRef(null);const[w,b]=C.useState(""),[E,k]=C.useState(""),[_,N]=C.useState(""),[A,P]=C.useState(!1),[R,T]=C.useState(!0),[D,I]=C.useState(""),[K,X]=C.useState(!1),[Z,oe]=C.useState(null);C.useEffect(()=>{if(e&&(N(e.question||""),k(e.correct_answer||""),n==="student"&&g)){const J=y(`test_progress_${g}_${r}_${t}_${e.question_id}`);J&&b(J)}},[e,t,r,n,y]),C.useEffect(()=>{if(n==="student"&&w&&t&&e?.question_id&&g){const J=setTimeout(()=>{X(!0),v(`test_progress_${g}_${r}_${t}_${e.question_id}`,w),oe(new Date().toLocaleTimeString()),setTimeout(()=>X(!1),1e3)},1e3);return()=>clearTimeout(J)}},[w,t,r,e?.question_id,n,g,v]),C.useEffect(()=>{if(n==="teacher"&&(_||E)){const J=setTimeout(()=>{X(!0);const te={question:_,correct_answer:E,timestamp:Date.now()};v(`teacher_form_${r}_${t}`,te),oe(new Date().toLocaleTimeString()),setTimeout(()=>X(!1),1e3)},2e3);return()=>clearTimeout(J)}},[_,E,t,r,n,v]);const q=C.useCallback(J=>{n==="student"&&(b(J),a&&a(e.question_id,J),W(J))},[n,e?.question_id,a]),re=C.useCallback(J=>{N(J),i&&i(e.question_id,J),B(J)},[e?.question_id,i]),M=C.useCallback(J=>{k(J),i&&i(e.question_id,{...e,correct_answer:J}),G(J)},[e,i]),W=C.useCallback(J=>{if(n==="student"){if(!J){T(!1),I("Please select an answer");return}T(!0),I("")}},[n]),B=C.useCallback(J=>{if(n==="teacher"){if(!J||J.trim().length<10){T(!1),I("Question must be at least 10 characters long");return}T(!0),I("")}},[n]),G=C.useCallback(J=>{if(n==="teacher"){if(!J){T(!1),I("Please select a correct answer");return}T(!0),I("")}},[n]),H=C.useCallback(()=>{if(n!=="teacher"||!o)return;const J={question_id:e.question_id,question:_,correct_answer:E,type:"true_false"};o(J)},[n,o,e?.question_id,_,E]),O=C.useCallback(J=>J?J.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]),z=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[K&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),Z&&!K&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",Z]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:O(_)}}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="true"?"border-blue-500 bg-blue-50":"border-gray-200"} ${p&&E==="true"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:w==="true",onChange:()=>q("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${w==="false"?"border-blue-500 bg-blue-50":"border-gray-200"} ${p&&E==="false"?"ring-2 ring-green-400":""}`,children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:w==="false",onChange:()=>q("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${w==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:w==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]}),!R&&D&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:D})]}),Y=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[K&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),Z&&!K&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",Z]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:_,onChange:J=>re(J.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${E==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:E==="true",onChange:()=>M("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${E==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:E==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${E==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:E==="false",onChange:()=>M("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${E==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:E==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!R&&D&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:D}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ze,{variant:"success",onClick:H,disabled:!R||d,className:"w-full sm:w-auto",children:d?l.jsx(Tr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:"true-false-question-container",children:n==="student"?z():Y()})},RW=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",onAnswerChange:s,onQuestionChange:a,onOptionAdd:i,onOptionRemove:o,onSave:c,isEditing:d=!1,isSaving:f=!1,validationErrors:p={},showCorrectAnswers:g=!1,studentId:y=null,displayNumber:v})=>{const{getItem:w,setItem:b}=Yy(),{showNotification:E}=ba();C.useRef(null);const[k,_]=C.useState(""),[N,A]=C.useState(["","","",""]),[P,R]=C.useState(""),[T,D]=C.useState(""),[I,K]=C.useState(!1),[X,Z]=C.useState(!0),[oe,q]=C.useState(""),[re,M]=C.useState(!1),[W,B]=C.useState(null);C.useEffect(()=>{if(e&&(D(e.question||""),A(e.options||["","","",""]),R(e.correct_answer||""),n==="student"&&y)){const pe=w(`test_progress_${y}_${r}_${t}_${e.question_id}`);pe&&_(pe)}},[e,t,r,n,w]),C.useEffect(()=>{if(n==="student"&&k&&t&&e?.question_id&&y){const pe=setTimeout(()=>{M(!0),b(`test_progress_${y}_${r}_${t}_${e.question_id}`,k),B(new Date().toLocaleTimeString()),setTimeout(()=>M(!1),1e3)},1e3);return()=>clearTimeout(pe)}},[k,t,r,e?.question_id,n,y,b]),C.useEffect(()=>{if(n==="teacher"&&(T||N.some(pe=>pe.trim()))){const pe=setTimeout(()=>{M(!0);const He={question:T,options:N,correct_answer:P,timestamp:Date.now()};b(`teacher_form_${r}_${t}`,He),B(new Date().toLocaleTimeString()),setTimeout(()=>M(!1),1e3)},2e3);return()=>clearTimeout(pe)}},[T,N,P,t,r,n,b]),C.useCallback(pe=>{if(n!=="student")return;const He=String(pe);_(He),s&&s(e.question_id,He),J(He)},[n,e?.question_id,s]);const G=C.useCallback(pe=>{D(pe),a&&a(e.question_id,pe),te(pe)},[e?.question_id,a]),H=C.useCallback((pe,He)=>{const Ye=[...N];Ye[pe]=He,A(Ye),a&&a(e.question_id,{...e,options:Ye}),ee(Ye)},[N,e,a]),O=C.useCallback(pe=>{R(pe),a&&a(e.question_id,{...e,correct_answer:pe}),ie(pe)},[e,a]),z=C.useCallback(()=>{if(N.length<6){const pe=[...N,""];A(pe),i&&i(e.question_id,pe)}else E("Maximum 6 options allowed","warning")},[N,e?.question_id,i,E]),Y=C.useCallback(pe=>{if(N.length>2){const He=N.filter((Ye,ot)=>ot!==pe);if(A(He),P===String.fromCharCode(65+pe))R("");else if(P&&String.fromCharCode(65+pe)<P){const Ye=String.fromCharCode(65+pe-1);R(Ye)}o&&o(e.question_id,He)}else E("Minimum 2 options required","warning")},[N,P,e?.question_id,o,E]),J=C.useCallback(pe=>{if(n==="student"){if(!pe){Z(!1),q("Please select an answer");return}Z(!0),e?.correct_answer&&pe===e.correct_answer?q(" Correct answer!"):e?.correct_answer?q(" Incorrect answer"):q("Answer selected")}},[n,e?.correct_answer]),te=C.useCallback(pe=>!pe||pe.trim().length<10?(Z(!1),q("Question must be at least 10 characters long"),!1):(Z(!0),q(""),!0),[]),ee=C.useCallback(pe=>{if(n!=="teacher")return;if(pe.filter(Ye=>Ye.trim().length>0).length<2){Z(!1),q("At least 2 options must be filled");return}if(pe.some(Ye=>Ye.trim().length>0&&Ye.trim().length<3)){Z(!1),q("Each option must be at least 3 characters long");return}Z(!0),q("")},[n]),ie=C.useCallback(pe=>{if(n==="teacher"){if(!pe){Z(!1),q("Please select a correct answer");return}Z(!0),q("")}},[n]),me=C.useCallback(()=>{if(n!=="teacher"||!c)return;const pe={question_id:e.question_id,question:T,options:N.filter(He=>He.trim().length>0),correct_answer:P,type:"multiple_choice"};c(pe)},[n,c,e?.question_id,T,N,P]),Ce=C.useCallback(pe=>pe?pe.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/\n/g,"<br>"):"",[]);return n==="teacher"?l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[re&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),W&&!re&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",W]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("textarea",{id:`question_${e?.question_id}`,value:T,onChange:pe=>G(pe.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),l.jsx(Ze,{variant:"secondary",size:"small",onClick:z,disabled:N.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),l.jsx("div",{className:"space-y-3",children:N.map((pe,He)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+He)}),l.jsx("input",{type:"text",value:pe,onChange:Ye=>H(He,Ye.target.value),placeholder:`Option ${String.fromCharCode(65+He)}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0}),N.length>2&&l.jsx(Ze,{variant:"danger",size:"small",onClick:()=>Y(He),className:"px-2 py-1 text-sm",children:""})]},He))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{id:`correct_${e?.question_id}`,value:P,onChange:pe=>O(pe.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[l.jsx("option",{value:"",children:"Select correct answer"}),N.map((pe,He)=>{if(!pe.trim())return null;const Ye=String.fromCharCode(65+He);return l.jsxs("option",{value:Ye,children:[Ye,") ",pe]},He)})]})]})]}),!X&&oe&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:oe}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ze,{variant:"success",onClick:me,disabled:!X||f,className:"w-full sm:w-auto",children:f?l.jsx(Tr,{size:"small"}):"Save Question"})})]}):l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof v=="number"?v:e?.question_id]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[re&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),W&&!re&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",W]})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:Ce(T)}}),l.jsx("div",{className:"space-y-3",children:N.map((pe,He)=>l.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${k===String.fromCharCode(65+He)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:[l.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+He),checked:k===String.fromCharCode(65+He),onChange:Ye=>{_(Ye.target.value),s&&s(e?.question_id,Ye.target.value)},className:"mr-3"}),l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600 mr-3",children:String.fromCharCode(65+He)}),l.jsx("span",{className:"flex-1",children:pe||`Option ${String.fromCharCode(65+He)}`})]},He))}),!X&&oe&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:oe})]})},DW=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,onAnswerChange:a,onQuestionChange:i,onAnswerAdd:o,onAnswerRemove:c,onSave:d,isEditing:f=!1,isSaving:p=!1,validationErrors:g={},showCorrectAnswers:y=!1,studentId:v=null})=>{const{getItem:w,setItem:b}=Yy(),{showNotification:E}=ba(),k=C.useRef(null),[_,N]=C.useState(""),[A,P]=C.useState([""]),[R,T]=C.useState(!1),[D,I]=C.useState(!0),[K,X]=C.useState(""),[Z,oe]=C.useState(!1);C.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&v){const te=`test_progress_${v}_${r}_${t}_${e.question_id}`,ee=w(te);ee&&N(ee)}},[e?.question_id,r,t,n,v,w]),C.useEffect(()=>{n==="teacher"&&e?.answers&&P(e.answers.length>0?e.answers:[""])},[e?.answers,n]),C.useEffect(()=>{if(n==="student"&&_&&e?.question_id&&t&&r&&v){const te=setTimeout(()=>{oe(!0),b(`test_progress_${v}_${r}_${t}_${e.question_id}`,_),setTimeout(()=>oe(!1),1e3)},1e3);return()=>clearTimeout(te)}},[_,e?.question_id,r,t,n,v,b]),C.useEffect(()=>{if(n==="teacher"&&A&&i){const te=setTimeout(()=>{i({...e,answers:A.filter(ee=>ee.trim())})},500);return()=>clearTimeout(te)}},[A,e,n,i]);const q=C.useCallback(te=>{N(te);const ee=te.trim().length>0;I(ee),X(ee?"":"Please enter an answer"),a&&a(e.question_id,te)},[e?.question_id,a]),re=C.useCallback((te,ee)=>{const ie=[...A];ie[te]=ee,P(ie),a&&a(e.question_id,ie)},[A,e?.question_id,a]),M=C.useCallback(()=>{if(n==="teacher"){const te=[...A,""];P(te),o&&o(e.question_id,te)}},[A,e?.question_id,n,o]),W=C.useCallback(te=>{if(n==="teacher"&&A.length>1){const ee=A.filter((ie,me)=>me!==te);P(ee),c&&c(e.question_id,ee)}},[A,e?.question_id,n,c]),B=C.useCallback(()=>{if(n==="student"){const te=_.trim().length>0;return I(te),X(te?"":"Please enter an answer"),te}else if(n==="teacher"){const te=A.some(ee=>ee.trim().length>0);return I(te),X(te?"":"Please enter at least one correct answer"),te}return!0},[_,A,n]),G=C.useCallback(te=>te?te.replace(/\n/g,"<br>").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>"):"",[]),H=C.useCallback(()=>{T(!0)},[]),O=C.useCallback(()=>{T(!1),B()},[B]),z=C.useCallback(te=>{te.key==="Enter"&&n==="student"&&_.trim()&&(b(`test_progress_${r}_${t}_${e.question_id}`,_),E("Answer saved","success"))},[_,r,t,e?.question_id,n,b,E]),Y=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",typeof s=="number"?s:e.question_id]}),Z&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsx("div",{className:"question-text mb-6 text-gray-700 leading-relaxed",dangerouslySetInnerHTML:{__html:G(e.question)}}),l.jsx("div",{className:"space-y-3",children:l.jsx("input",{ref:k,type:"text",id:`input_${e.question_id}`,placeholder:"Enter your answer here...",value:_,onChange:te=>q(te.target.value),onFocus:H,onBlur:O,onKeyPress:z,className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${D?R?"border-blue-500":"border-gray-300 hover:border-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500"}`,"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!D,"aria-describedby":D?void 0:`error-${e.question_id}`})}),y&&e.correct_answers&&l.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),l.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((te,ee)=>l.jsxs("li",{className:"text-green-700 text-sm",children:[" ",te]},ee))})]})]}),J=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),p&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:te=>i&&i({...e,question:te.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${g.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),g.question&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g.question})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),l.jsx(Ze,{type:"button",variant:"secondary",size:"small",onClick:M,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),l.jsx("div",{className:"space-y-3",children:A.map((te,ee)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:ee+1}),l.jsx("input",{type:"text",value:te,onChange:ie=>re(ee,ie.target.value),placeholder:`Correct answer ${ee+1}`,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":ee}),A.length>1&&l.jsx(Ze,{type:"button",variant:"danger",size:"small",onClick:()=>W(ee),className:"px-2 py-1 text-sm",children:" Remove"})]},ee))}),g.answers&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g.answers})]})]}),d&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(Ze,{type:"button",variant:"success",onClick:d,disabled:p,className:"w-full sm:w-auto",children:p?l.jsx(Tr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:`input-question-container ${n} ${R?"focused":""}`,children:n==="student"?Y():J()})},Bo=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...c})=>{if(!e)return null;const d=p=>{i&&p.target===p.currentTarget&&t()};es.useEffect(()=>{const p=g=>{g.key==="Escape"&&t()};return e&&(document.addEventListener("keydown",p),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",p),document.body.style.overflow="unset"}},[e,t]);const f={small:"max-w-sm",medium:"max-w-md",large:"max-w-2xl"};return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:d,role:"dialog","aria-modal":"true","aria-label":r,...c,children:l.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-6
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${f[s]} mx-auto
          ${o}
        `,onClick:p=>p.stopPropagation(),children:[(r||a)&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&l.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&l.jsx(Ze,{variant:"secondary",size:"small",onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors duration-200","aria-label":"Close modal",children:""})]}),l.jsx("div",{className:"space-y-6",children:n})]})})},$p=(e,t,r)=>{const[n,s]=C.useState(!1),[a,i]=C.useState(0),[o,c]=C.useState(!1),d=C.useRef(!1);C.useEffect(()=>{if(!e||!t||!r)return;const b=`anti_cheating_${r}_${e}_${t}`,E=En(b);E&&(i(E.tabSwitches||0),c(E.isCheating||!1))},[e,t,r]);const f=C.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",d.current),!d.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const b=Date.now();setTimeout(()=>{const E=Date.now()-b;console.log(" Timer completed - time hidden:",E,"ms"),E>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(k=>{const _=k+1,N=_>=2;console.log(" Tab switch count updated:",{newCount:_,cheating:N}),c(N);const A=`anti_cheating_${r}_${e}_${t}`;return Nn(A,{tabSwitches:_,isCheating:N},120*1e3),_})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),p=C.useCallback(()=>{d.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:d.current}),document.hidden?f():console.log(" Tab became visible"))},[f]),g=C.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),d.current=!0,document.addEventListener("visibilitychange",p),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[p]),y=C.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),d.current=!1,document.removeEventListener("visibilitychange",p),console.log(" Anti-cheating event listeners removed")},[p]),v=C.useCallback(()=>{const b={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",b),b},[o,a]),w=C.useCallback(()=>{r&&e&&t&&g0(r,e,t),i(0),c(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:g,stopTracking:y,clearData:w,getCheatingData:v,tabSwitches:a,isCheating:o,isTracking:n}},IW=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=C.useState(null),[o,c]=C.useState(null);C.useEffect(()=>{(async()=>{try{const[De,Je]=await Promise.all([Au(()=>Promise.resolve().then(()=>CL),void 0),Au(()=>Promise.resolve().then(()=>nO),void 0)]);i(De),c(Je.default)}catch(De){console.error("Failed to load Konva:",De)}})()},[]);const d=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[f,p]=C.useState({}),[g,y]=C.useState({}),[v,w]=C.useState(0),[b,E]=C.useState(!1),[k,_]=C.useState(null),[N,A]=C.useState(0),[P,R]=C.useState(0),[T,D]=C.useState(null),[I,K]=C.useState(null),[X,Z]=C.useState(!1),[oe,q]=C.useState(!1),{showNotification:re}=ba(),{makeAuthenticatedRequest:M}=Wi(),{user:W}=Mn(),{startTracking:B,stopTracking:G,getCheatingData:H,clearData:O}=$p("matching_type",e?.id,W?.student_id||W?.id),z=C.useRef(null),Y=C.useRef(null),J=C.useRef(null),te=C.useRef(0),[ee,ie]=C.useState(400);C.useRef({});const me=C.useCallback(()=>{Z(!0)},[]),Ce=C.useCallback(()=>{y({}),p({}),Z(!1)},[]),Oe=C.useCallback(()=>{q(!0)},[]),fe=C.useCallback(()=>{q(!1),r()},[r]),pe=C.useMemo(()=>{if(!e)return null;const Le=e.blocks.map(_t=>{let ht=_t.coordinates;if(typeof ht=="string")try{ht=JSON.parse(ht)}catch(It){console.error(" Failed to parse coordinates:",It),ht={x:0,y:0,width:100,height:100}}return ht={x:(typeof ht.x=="number"?ht.x:Number(ht.x))||0,y:(typeof ht.y=="number"?ht.y:Number(ht.y))||0,width:(typeof ht.width=="number"?ht.width:Number(ht.width))||30,height:(typeof ht.height=="number"?ht.height:Number(ht.height))||10},{id:_t.id,word:_t.word,coordinates:ht,hasArrow:_t.hasArrow,arrow:_t.arrow}}),De=Array.isArray(e.arrows)?e.arrows:[],Je=e.words.map(_t=>({id:_t.id,word:_t.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:Le,arrows:De,words:Je}},[e]);C.useEffect(()=>{if(!e?.image_url)return;const Le=new Image;Le.crossOrigin="anonymous",Le.onload=()=>{console.log(" Image loaded successfully"),A(Le.width),R(Le.height);const De=z.current?.clientWidth||800,Je=z.current?.clientHeight||600,_t=De/Le.width,ht=Je/Le.height,It=Math.min(_t,ht,1),Mt=Le.width*It,rt=Le.height*It,qe=(De-Mt)/2,pt=(Je-rt)/2;_({x:qe,y:pt,width:Mt,height:rt,scaleX:It,scaleY:It,scale:It,image:Le}),te.current=z.current?.clientWidth||800,console.log(" Image info calculated:",{x:qe,y:pt,width:Mt,height:rt,scaleX:It,scaleY:It})},Le.onerror=()=>{console.error(" Failed to load image"),re("Failed to load test image","error")},Le.src=e.image_url},[e?.image_url,re]),C.useEffect(()=>{if(!pe||!k)return;const Le=te.current||z.current?.clientWidth||800,De=12,Je=38;let _t=k.x,ht=k.y+k.height+De;const It=k.x+k.width,Mt={};pe.words.forEach(pt=>{if(!Object.prototype.hasOwnProperty.call(g,pt.id)){const lt=typeof pt.word=="string"?pt.word:"",wt=Math.max(60,lt.length*8+20);_t+wt>Math.min(Le-De,It)&&(_t=k.x,ht+=Je),f[pt.id]||(Mt[pt.id]={x:_t,y:ht}),_t+=wt+De}}),Object.keys(Mt).length&&p(pt=>({...pt,...Mt}));const rt=Object.values(Mt).reduce((pt,lt)=>Math.max(pt,lt.y),ht),qe=Math.max(k.y+k.height+De,rt+Je+De);ie(Math.max(400,Math.ceil(qe)))},[pe,k,g,f]);const He=C.useCallback(()=>{if(!k||!pe)return[];const Le=d();return Le?pe.blocks.map(De=>{const Je=De.coordinates;let _t,ht,It,Mt;_t=k.x+Je.x*(k.scale??k.scaleX),ht=k.y+Je.y*(k.scale??k.scaleY),It=Je.width*(k.scale??k.scaleX),Mt=Je.height*(k.scale??k.scaleY);const rt=g[De.id];return l.jsxs(Le.Group,{children:[l.jsx(Le.Rect,{x:_t,y:ht,width:It,height:Mt,fill:rt?"rgba(40, 167, 69, 0.4)":T===De.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:rt?"#28a745":T===De.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:rt?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),rt&&l.jsx(Le.KonvaText,{x:_t+5,y:ht+Mt/2-10,width:It-10,height:20,text:pe.words.find(qe=>qe.id===rt)?.word||"",fontSize:Math.min(12,It/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},De.id)}):[]},[k,pe,g,a]),Ye=C.useCallback(()=>{if(!k||!pe)return[];const Le=d();return Le?(console.log(" Processing arrows:",pe.arrows),pe.arrows.map(De=>{if(console.log(" Arrow data:",De),!De.start||!De.end)return console.warn(" Arrow missing start/end coordinates:",De),null;let Je,_t,ht,It;if(De.rel_start_x!==null&&De.rel_start_y!==null&&De.rel_end_x!==null&&De.rel_end_y!==null&&De.image_width&&De.image_height&&De.image_width>0&&De.image_height>0){const Mt=De.image_width,rt=De.image_height,qe=k.width/Mt,pt=k.height/rt;Je=k.x+Number(De.rel_start_x)/100*Mt*qe,_t=k.y+Number(De.rel_start_y)/100*rt*pt,ht=k.x+Number(De.rel_end_x)/100*Mt*qe,It=k.y+Number(De.rel_end_y)/100*rt*pt}else{const Mt=k.scale??k.scaleX??1,rt=Number(De.start.x),qe=Number(De.start.y),pt=Number(De.end.x),lt=Number(De.end.y);rt<=k.width+1&&pt<=k.width+1&&qe<=k.height+1&&lt<=k.height+1?(Je=k.x+(isNaN(rt)?0:rt),_t=k.y+(isNaN(qe)?0:qe),ht=k.x+(isNaN(pt)?0:pt),It=k.y+(isNaN(lt)?0:lt)):(Je=k.x+(isNaN(rt)?0:rt)*Mt,_t=k.y+(isNaN(qe)?0:qe)*Mt,ht=k.x+(isNaN(pt)?0:pt)*Mt,It=k.y+(isNaN(lt)?0:lt)*Mt)}return l.jsx(Le.Arrow,{points:[Je,_t,ht,It],stroke:De.style?.color||"#dc3545",fill:De.style?.color||"#dc3545",strokeWidth:De.style?.thickness||3,pointerLength:10,pointerWidth:10},De.id)}).filter(Boolean)):[]},[k,pe,a]),ot=C.useCallback(()=>{if(!pe)return[];const Le=d();return Le?pe.words.map(De=>{const Je=f[De.id]||{x:0,y:0},_t=typeof De.word=="string"?De.word:"",ht=Math.max(60,_t.length*8+20);return Object.values(g).includes(De.id)?null:l.jsxs(Le.Group,{x:Je.x,y:Je.y,draggable:!0,onDragEnd:Mt=>Ve(Mt,De.id),children:[l.jsx(Le.Rect,{width:ht,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),l.jsx(Le.KonvaText,{text:_t,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:ht,height:34,listening:!1})]},De.id)}):[]},[pe,f,g,k,a]),Ve=C.useCallback((Le,De)=>{const Je=Le.target.x(),_t=Le.target.y();if(p(wt=>({...wt,[De]:{x:Je,y:_t}})),!k||!pe)return;const ht=pe.words.find(wt=>wt.id===De);if(!ht)return;const It=typeof ht.word=="string"?ht.word:"",Mt=Math.max(60,It.length*8+20),rt={x:Je,y:_t,width:Mt,height:34},qe=k.scale??k.scaleX??1,pt=(wt,Lt)=>!(Lt.x>wt.x+wt.width||Lt.x+Lt.width<wt.x||Lt.y>wt.y+wt.height||Lt.y+Lt.height<wt.y),lt=pe.blocks.find(wt=>{const Lt=wt.coordinates,Ht={x:k.x+Lt.x*qe,y:k.y+Lt.y*qe,width:Lt.width*qe,height:Lt.height*qe};return pt(rt,Ht)});if(lt){y(gt=>({...gt,[lt.id]:De}));const wt=lt.coordinates,Lt=k.x+wt.x*qe,Ht=k.y+wt.y*qe,Ie=wt.width*qe,at=wt.height*qe;p(gt=>({...gt,[De]:{x:Lt+(Ie-Mt)/2,y:Ht+(at-34)/2}})),re(`Word "${ht.word}" placed in block`,"success")}},[k,pe,re]),Rt=C.useCallback(()=>{if(!pe)return 0;const Le=pe.words.length,De=Object.keys(g).length;return Le>0?De/Le*100:0},[pe,g]);C.useEffect(()=>{const Le=Rt();w(Le)},[Rt]),C.useEffect(()=>{if(e&&!I){const Le=new Date;K(Le),console.log(" Test timer started at:",Le.toISOString()),B(),console.log(" Anti-cheating tracking started")}},[e,I,B]);const tt=C.useCallback(async()=>{if(pe){E(!0);try{const Le=pe.words.length;let De=0;console.log(" Scoring check - placedWords:",g),console.log(" Scoring check - blocks:",pe.blocks.map(Ie=>({id:Ie.id,word:Ie.word}))),console.log(" Scoring check - words:",pe.words.map(Ie=>({id:Ie.id,word:Ie.word}))),pe.blocks.forEach(Ie=>{const at=g[Ie.id];if(console.log(` Block ${Ie.id} (expects "${Ie.word}") has placed word ID: ${at}`),at){const gt=pe.words.find(At=>At.id===at);console.log(" Placed word:",gt),gt&&gt.word===Ie.word?(De++,console.log(` Correct! Block ${Ie.id} has correct word "${gt.word}"`)):console.log(` Incorrect! Block ${Ie.id} expected "${Ie.word}" but got "${gt?.word||"nothing"}"`)}else console.log(` Block ${Ie.id} has no word placed`)});const Je=De,_t=Le;console.log(` Final Score: ${Je}/${_t} (${Math.round(Je/_t*100)}%)`);const ht=new Date,It=I?Math.round((ht-I)/1e3):0,Mt=I?I.toISOString():ht.toISOString();console.log(" Test timing:",{startedAt:Mt,endTime:ht.toISOString(),timeTaken:`${It} seconds`});const rt=H();console.log(" Anti-cheating data for submission:",rt);const qe=W.student_id,pt=`retest_assignment_id_${qe}_matching_type_${e.id}`,lt=localStorage.getItem(pt),wt={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:qe,answers:g,score:Je,maxScore:_t,time_taken:It,started_at:Mt,submitted_at:ht.toISOString(),caught_cheating:rt.caught_cheating,visibility_change_times:rt.visibility_change_times,retest_assignment_id:lt?Number(lt):null,parent_test_id:e.id};console.log(" Submitting test data:",wt);const Ht=await(await M("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(wt)})).json();if(console.log(" Submission response:",Ht),Ht.success){if(re("Test submitted successfully!","success"),G(),O(),W?.student_id&&g0(W.student_id,"matching_type",e.id),W?.student_id){const at=`test_completed_${W.student_id}_matching_type_${e.id}`;localStorage.setItem(at,"true"),console.log(" Test marked as completed in localStorage:",at)}if(W?.student_id){const{setCachedData:at,CACHE_TTL:gt}=await Au(async()=>{const{setCachedData:Ot,CACHE_TTL:Jt}=await Promise.resolve().then(()=>b2);return{setCachedData:Ot,CACHE_TTL:Jt}},void 0),At=`student_results_table_${W.student_id}`;at(At,Ht,gt.student_results_table),console.log(" Test results cached with key:",At)}const Ie=`retest1_${qe}_matching_type_${e.id}`;localStorage.removeItem(Ie),localStorage.removeItem(pt),t&&t(Je)}else throw new Error(Ht.message||"Failed to submit test")}catch(Le){console.error(" Error submitting test:",Le),re(`Error submitting test: ${Le.message}`,"error")}finally{E(!1)}}},[pe,g,e,W,I,M,re,t]);return!e||!pe?l.jsx(Tr,{}):l.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name})}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),l.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[Math.round(v),"%"]})]})]}),l.jsx("div",{className:"mt-4 w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:l.jsx("div",{className:"lg:col-span-3",children:l.jsxs(bt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4 text-center space-x-4",children:[l.jsx(Ze,{onClick:me,variant:"secondary",children:"Reset"}),l.jsx(Ze,{onClick:Oe,variant:"secondary",children:"Back to Cabinet"})]}),l.jsx("div",{ref:z,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${ee}px`},children:k&&a?(()=>{const{Stage:Le,Layer:De,KonvaImage:Je}=d();return l.jsxs(Le,{ref:Y,width:z.current?.clientWidth||800,height:ee,children:[l.jsxs(De,{children:[l.jsx(Je,{ref:J,image:k.image,x:k.x,y:k.y,width:k.width,height:k.height,listening:!1}),He(),Ye()]}),l.jsx(De,{listening:!0,children:ot()})]})})():k?l.jsxs("div",{className:"flex items-center justify-center h-full",children:[l.jsx(Tr,{size:"lg"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),l.jsx("div",{className:"mt-4 text-center",children:l.jsx(Ze,{onClick:tt,disabled:b||v<100,children:b?"Submitting...":"Submit Test"})})]})})}),l.jsx(Bo,{isOpen:X,onClose:()=>Z(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>Z(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:Ce,variant:"primary",children:"Reset"})]})]})}),l.jsx(Bo,{isOpen:oe,onClose:()=>q(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>q(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:fe,variant:"primary",children:"Go Back"})]})]})})]})})},MW=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=Mn(),{makeAuthenticatedRequest:o}=Wi(),{showNotification:c}=ba(),[d,f]=C.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[p,g]=C.useState("drag"),[y,v]=C.useState(!1),[w,b]=C.useState(null),E=C.useCallback(()=>{f(R=>[...R,{leftWord:"",rightWord:""}])},[]),k=C.useCallback(R=>{d.length>1&&f(T=>T.filter((D,I)=>I!==R))},[d.length]),_=C.useCallback((R,T)=>{f(D=>D.map((I,K)=>K===R?{...I,leftWord:T}:I))},[]),N=C.useCallback((R,T)=>{f(D=>D.map((I,K)=>K===R?{...I,rightWord:T}:I))},[]),A=C.useCallback(()=>d.every(R=>R.leftWord.trim()&&R.rightWord.trim()),[d]),P=C.useCallback(async()=>{if(!A()){c("Please fill in all word pairs","error");return}v(!0),b(null);try{const R=d.map((D,I)=>({question_id:I+1,left_word:D.leftWord.trim(),right_word:D.rightWord.trim()})),T={test_name:e,num_questions:R.length,interaction_type:p,questions:R};console.log(" Saving word matching test:",T),t({testName:e,numQuestions:R.length,interactionType:p,wordPairs:d,questions:R})}catch(R){console.error("Error saving word matching test:",R),b(R.message),c("Failed to save test: "+R.message,"error")}finally{v(!1)}},[e,d,p,A,o,c,t]);return l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-6",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-gray-600",children:"Enter word pairs - position 1 left matches position 1 right"})]}),l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${p==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("drag"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:p==="drag",onChange:()=>g("drag"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",l.jsx("br",{})," Visual feedback on placement",l.jsx("br",{})," Mobile-friendly"]})]}),l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${p==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>g("arrow"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:p==="arrow",onChange:()=>g("arrow"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",l.jsx("br",{})," Better for visual learners",l.jsx("br",{})," Requires precision"]})]})]})]})}),l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"word-pairs-section",children:[l.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),l.jsx(Ze,{onClick:E,size:"sm",children:"+ Add Pair"})]}),l.jsx("div",{className:"pairs-list space-y-3",children:d.map((R,T)=>l.jsxs("div",{className:"word-pair-row flex items-center space-x-4 p-4 bg-gray-50 rounded-lg border",children:[l.jsx("div",{className:"pair-number flex-shrink-0",children:l.jsx("span",{className:"number-badge w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-sm font-semibold",children:T+1})}),l.jsx("div",{className:"left-word flex-1",children:l.jsx("input",{type:"text",value:R.leftWord,onChange:D=>_(T,D.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-xl",children:""}),l.jsx("div",{className:"right-word flex-1",children:l.jsx("input",{type:"text",value:R.rightWord,onChange:D=>N(T,D.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-actions flex-shrink-0",children:l.jsx(Ze,{onClick:()=>k(T),variant:"outline",size:"sm",className:"remove-btn w-8 h-8 p-0 text-red-500 hover:bg-red-50",disabled:d.length<=1,children:""})})]},T))})]})}),l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"preview-section",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),l.jsx("div",{className:"preview-pairs space-y-2",children:d.map((R,T)=>l.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[l.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[T+1,"."]}),l.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:R.leftWord||"Left word"}),l.jsx("span",{className:"preview-arrow text-gray-500",children:""}),l.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:R.rightWord||"Right word"})]},T))})]})}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx(Ze,{onClick:P,disabled:!A()||y,className:"px-8",children:y?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),l.jsx(Ze,{onClick:r,variant:"secondary",children:"Cancel"})]}),w&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600",children:w})})]})},OW=(e,t)=>{const[r,n,s]=Mj(`test_progress_${e}_${t}`,{}),[a,i]=C.useState(!1),[o,c]=C.useState(0),[d,f]=C.useState(0),[p,g]=C.useState(!1),[y,v]=C.useState(null),w=C.useRef(null),b=C.useRef(null),E=C.useCallback((B,G)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(H=>({...H,[B]:G})),console.log(`Saved progress for question ${B}:`,G)},[n]),k=C.useCallback(B=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[B]||null,[r]),_=C.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const B=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${B}`);const G=Object.keys(r).length>0;s(),console.log(G?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),N=C.useCallback(()=>{w.current&&(N(w.current),w.current=null),b.current&&(N(b.current),b.current=null)},[]),A=C.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),b.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),I()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),P=C.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const B=D(),G=d>0?Math.round(B/d*100):0;return console.log(`[DEBUG] Progress: ${B}/${d} questions answered`),console.log(`[DEBUG] Progress bar updated: ${G}%`),{answeredQuestions:B,totalQuestions:d,percentage:G}},[e,t,d]),R=C.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const B=D();console.log(`[DEBUG] Submit button state check: ${B}/${d} questions answered`);const G=B===d&&d>0;return console.log(G?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),G},[d]),T=C.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const B=Object.keys(r).length;c(B),console.log(`[DEBUG] Restored ${B} answered questions`)}catch(B){console.error("[ERROR] Failed to load saved progress:",B),v(B.message)}},[e,t,r]),D=C.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const B=Object.keys(r).length;return c(B),console.log(`[DEBUG] Found ${B} answered questions`),B},[e,r]),I=C.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(B){console.error("[ERROR] Failed to save progress:",B),v(B.message)}},[e,t,r]),K=C.useCallback(()=>{try{const B=`test_completed_${e}_${t}`,G=localStorage.getItem(B)==="true";return i(G),G}catch(B){return console.error("Error checking test completion:",B),!1}},[e,t]),X=C.useCallback(()=>{try{const B=`test_completed_${e}_${t}`;localStorage.setItem(B,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(B){console.error("Error marking test completed:",B)}},[e,t]),Z=C.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),X()},[e,t,X]),oe=C.useCallback(B=>{try{const G=`test_creation_state_${e}_${t}`;localStorage.setItem(G,JSON.stringify(B)),console.log("Test creation state saved:",B)}catch(G){console.error("Error saving test creation state:",G)}},[e,t]),q=C.useCallback(()=>{try{const B=`test_creation_state_${e}_${t}`;localStorage.removeItem(B),console.log("Test creation state cleared")}catch(B){console.error("Error clearing test creation state:",B)}},[e,t]),re=C.useCallback((B,G)=>{try{const H=`test_step_${e}_${t}_${B}`;localStorage.setItem(H,JSON.stringify(G)),console.log(`Step ${B} data saved:`,G)}catch(H){console.error(`Error saving step ${B} data:`,H)}},[e,t]),M=C.useCallback(B=>{try{const G=`test_step_${e}_${t}_${B}`,H=localStorage.getItem(G);return H?JSON.parse(H):null}catch(G){return console.error(`Error restoring step ${B} data:`,G),null}},[e,t]),W=C.useCallback(()=>{try{const B=`test_creation_state_${e}_${t}`,G=localStorage.getItem(B);return G?JSON.parse(G):null}catch(B){return console.error("Error restoring test creation state:",B),null}},[e,t]);return C.useEffect(()=>()=>{N()},[e,t,A,T,N]),C.useEffect(()=>{D()},[r,D]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:d,isLoading:p,error:y,saveProgress:E,getProgress:k,clearProgress:_,clearInterval:N,setupProgressTracking:A,updateProgress:P,updateSubmitButton:R,loadProgress:T,getAnsweredCount:D,saveProgressForPage:I,checkCompleted:K,markCompleted:X,markCompletedUI:Z,saveState:oe,clearState:q,saveStepData:re,restoreStepData:M,restoreState:W,setTotalQuestions:f,setError:v}},LW=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=Mn(),{makeAuthenticatedRequest:s}=Wi(),[a,i]=C.useState({width:window.innerWidth,height:window.innerHeight});C.useEffect(()=>{const Le=()=>{i({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Le),()=>window.removeEventListener("resize",Le)},[]);const{getCheatingData:o,stopTracking:c,clearData:d}=$p(),[f,p]=C.useState(null),[g,y]=C.useState({}),[v,w]=C.useState(null),b=C.useRef(null),[E,k]=C.useState(800),_={VERY_SMALL:400,MOBILE:600,TABLET:900},N={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},A={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:100,MARGIN:50,PADDING:20},P=a.width<_.VERY_SMALL,R=a.width>=_.VERY_SMALL&&a.width<_.MOBILE,T=a.width>=_.MOBILE&&a.width<_.TABLET;a.width>=_.TABLET;const D=P?N.VERY_SMALL:R?N.MOBILE:T?N.TABLET:N.DESKTOP;C.useEffect(()=>{const Le=()=>{if(b.current){const Je=b.current.clientWidth;console.log(" Container width detected:",Je),Je>0&&k(Je)}};Le();const De=[setTimeout(Le,50),setTimeout(Le,100),setTimeout(Le,200),setTimeout(Le,500)];return window.addEventListener("resize",Le),()=>{De.forEach(Je=>clearTimeout(Je)),window.removeEventListener("resize",Le)}},[f]);const I=Math.max(A.CANVAS_HEIGHT*D,(f?.leftWords?.length||3)*A.BLOCK_SPACING*D+A.PADDING*2),K=A.BLOCK_WIDTH*D,X=A.BLOCK_HEIGHT*D,Z=A.BLOCK_SPACING*D,oe=A.MARGIN*D,q=oe;console.log(" Mobile Debug:",{screenWidth:a.width,containerWidth:b.current?.clientWidth,canvasWidth:E,scale:D,blockWidth:K,margin:oe,leftBlockX:q,displayDataLoaded:!!f});const re=q+K+20+K+oe,M=re<=E;let W,B=K,G=X;if(M)W=Math.min(Math.max(q+K+20,E-K-oe),E-K-oe);else{const Le=E-oe*2,De=Math.floor((Le-20)/2);B=Math.max(60,De),G=Math.max(30,G*(B/K)),W=q+B+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Le,maxBlockWidth:De,actualBlockWidth:B,actualBlockHeight:G})}console.log(" Right Block Position:",{rightBlockX:W,rightBlockRightEdge:W+B,canvasWidth:E,fits:W+B<=E,canFitSideBySide:M,minRequiredWidth:re});const H=oe,O={DRAGGED_WORD:Math.max(8,14*D),ORIGINAL_WORD:Math.max(10,16*D),LEFT_WORD:Math.max(10,14*D)},z=Math.max(1,3*D),[Y,J]=C.useState([]),[te,ee]=C.useState(!1),[ie,me]=C.useState(null),[Ce,Oe]=C.useState(!1),[fe,pe]=C.useState(!1);C.useEffect(()=>{if(e&&(p(e),me(new Date),n?.student_id)){const Le=`test_progress_${n.student_id}_word_matching_${e.id}`,De=En(Le);De&&(y(De.answers||{}),J(De.arrows||[]),me(new Date(De.startTime)),console.log(" Test progress restored:",De))}},[e,n?.student_id]),C.useEffect(()=>{if(f&&ie&&n?.student_id){const Le=setInterval(()=>{const De={answers:g,arrows:Y,startTime:ie.toISOString()},Je=`test_progress_${n.student_id}_word_matching_${e.id}`;Nn(Je,De,Fn.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Le)}},[f,g,Y,ie,n?.student_id,e?.id]);const He=C.useCallback((Le,De)=>{if(e.interaction_type==="arrow")if(v){if(v.side===Le&&v.index===De)w(null);else if(v.side!==Le){const Je={id:Date.now().toString(),startWord:v,endWord:{side:Le,index:De},color:"#3B82F6"};J(_t=>[..._t,Je]),y(_t=>({..._t,[v.index]:De})),w(null)}}else w({side:Le,index:De})},[v,e?.interaction_type]);C.useCallback((Le,De)=>{e.interaction_type==="drag"&&y(Je=>({...Je,[Le]:De}))},[e?.interaction_type]);const Ye=C.useCallback(()=>{Oe(!0)},[]),ot=C.useCallback(()=>{y({}),J([]),w(null),Oe(!1)},[]),Ve=C.useCallback(()=>{pe(!0)},[]),Rt=C.useCallback(()=>{pe(!1),r&&r()},[r]),tt=C.useCallback(async()=>{if(f){ee(!0);try{const Le=f.leftWords.length;let De=0,Je={};e.interaction_type==="drag"?Object.entries(g).forEach(([at,gt])=>{const At=f.correctPairs[at];gt===At&&De++,Je[at]=gt}):Y.forEach(at=>{const gt=at.startWord.side==="left"?at.startWord.index:at.endWord.index,At=at.startWord.side==="right"?at.startWord.index:at.endWord.index;f.correctPairs[gt]===At&&De++,Je[gt]=At});const _t=De,ht=Le;console.log(` Final Score: ${_t}/${ht} (${Math.round(_t/ht*100)}%)`);const It=new Date,Mt=ie?Math.round((It-ie)/1e3):0,rt=ie?ie.toISOString():It.toISOString(),qe=o(),pt=n.student_id,lt=`retest_assignment_id_${pt}_word_matching_${e.id}`,wt=localStorage.getItem(lt),Lt={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:pt,parent_test_id:e.id,retest_assignment_id:wt?Number(wt):null,interaction_type:e.interaction_type,answers:Je,score:_t,maxScore:ht,time_taken:Mt,started_at:rt,submitted_at:It.toISOString(),caught_cheating:qe.caught_cheating,visibility_change_times:qe.visibility_change_times};console.log(" Submission data being sent:",Lt),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Ht=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Lt)});console.log(" Submission response received:",Ht.status);const Ie=await Ht.json();if(Ie.success){if(c(),d(),n?.student_id){const at=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(at,"true"),console.log(" Test marked as completed in localStorage:",at);const gt=`retest1_${pt}_word_matching_${e.id}`;localStorage.removeItem(gt),localStorage.removeItem(lt),g0(n.student_id,"word_matching",e.id),console.log(" Test data cleared from cache");const At=`student_results_table_${n.student_id}`;Nn(At,Ie,Fn.student_results_table),console.log(" Test results cached with key:",At)}setTimeout(()=>{t&&t(_t)},2e3)}else throw new Error(Ie.message||"Failed to submit test")}catch(Le){console.error("Error submitting test:",Le)}finally{ee(!1)}}},[f,g,Y,e,n,ie,o,c,d,s,t]);return f?l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-4xl mx-auto p-6",children:[l.jsx(Bo,{isOpen:te,onClose:()=>{},title:"Submitting",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(Tr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:e.test_name}),l.jsx("p",{className:"text-gray-600",children:e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]})}),e.interaction_type==="drag"?l.jsx(bt,{className:"mb-6",children:l.jsx("div",{ref:b,className:"relative w-full",children:l.jsx(Qd,{width:E,height:I,className:`border-2 border-gray-200 rounded-lg ${te?"pointer-events-none opacity-50":""}`,children:l.jsxs(Yd,{children:[f.leftWords.map((Le,De)=>{const Je=g[De]!==void 0,_t=H+De*Z;return l.jsxs(Uo,{x:q,y:_t,draggable:!Je,onDragStart:ht=>{ht.target.moveToTop()},onDragEnd:ht=>{ht.target.getStage();const It=f.rightWords,Mt=B+60,rt=G+30,qe=W-30,pt=H-15;console.log(" Drop detection - Word dropped at:",ht.target.x(),ht.target.y());for(let lt=0;lt<It.length;lt++){const wt=pt+lt*Z,Lt=qe,Ht=qe+Mt,Ie=wt,at=wt+rt;if(console.log(` Checking drop zone ${lt}:`,{left:Lt,right:Ht,top:Ie,bottom:at,word:It[lt]}),ht.target.x()>=Lt&&ht.target.x()<=Ht&&ht.target.y()>=Ie&&ht.target.y()<=at){console.log(` Match found! Word "${f.leftWords[De]}" matched with "${It[lt]}"`),y(gt=>({...gt,[De]:lt}));break}}console.log(" No match found, resetting position"),ht.target.position({x:q,y:_t})},children:[l.jsx(ea,{width:B,height:G,fill:Je?"#e5e7eb":"#3b82f6",stroke:Je?"#9ca3af":"#1d4ed8",strokeWidth:2,cornerRadius:8,opacity:Je?.5:1}),l.jsx(Sl,{text:Le,x:B/2,y:G/2,fontSize:O.LEFT_WORD,fontFamily:"Arial",fill:Je?"#dc2626":"white",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:G/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${De}`)}),f.rightWords.map((Le,De)=>{const Je=H+De*Z,_t=Object.keys(g).find(ht=>g[ht]===De);return l.jsxs(Uo,{x:W,y:Je,children:[l.jsx(ea,{width:B,height:G,fill:_t?"#10b981":"#f3f4f6",stroke:_t?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8}),l.jsx(Sl,{text:Le,x:B/2,y:G/2,fontSize:O.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:G/2,wrap:"word",ellipsis:!0,listening:!1}),_t&&l.jsx(Sl,{text:f.leftWords[_t],x:K/2,y:X/4,fontSize:O.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:G/8,wrap:"word",ellipsis:!0})]},`right-${De}`)})]})})})}):l.jsx(bt,{className:"mb-6",children:l.jsx("div",{ref:b,className:"relative w-full",children:l.jsx(Qd,{width:E,height:I,className:`border-2 border-gray-200 rounded-lg ${te?"pointer-events-none opacity-50":""}`,children:l.jsxs(Yd,{children:[f.leftWords.map((Le,De)=>{const Je=H+De*Z,_t=v?.side==="left"&&v?.index===De;return l.jsxs(Uo,{x:q,y:Je,onClick:()=>He("left",De),children:[l.jsx(ea,{width:B,height:G,fill:_t?"#3b82f6":"#f3f4f6",stroke:_t?"#1d4ed8":"#d1d5db",strokeWidth:_t?3:2,cornerRadius:8}),l.jsx(Sl,{text:Le,x:K/2,y:X/2,fontSize:O.LEFT_WORD,fontFamily:"Arial",fill:_t?"white":"#374151",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:G/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${De}`)}),f.rightWords.map((Le,De)=>{const Je=H+De*Z,_t=v?.side==="right"&&v?.index===De;return l.jsxs(Uo,{x:W,y:Je,onClick:()=>He("right",De),children:[l.jsx(ea,{width:B,height:G,fill:_t?"#3b82f6":"#f3f4f6",stroke:_t?"#1d4ed8":"#d1d5db",strokeWidth:_t?3:2,cornerRadius:8}),l.jsx(Sl,{text:Le,x:K/2,y:X/2,fontSize:O.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:B,offsetX:B/2,offsetY:G/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${De}`)}),Y.map((Le,De)=>{const Je=H+Le.startWord.index*Z+X/2,_t=H+Le.endWord.index*Z+X/2;return l.jsx(ma,{points:[q+K+20,Je,W-20,_t],stroke:Le.color||"#3b82f6",strokeWidth:z,lineCap:"round",lineJoin:"round"},De)})]})})})}),l.jsx(bt,{children:l.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${te?"pointer-events-none opacity-50":""}`,children:[l.jsx(Ze,{onClick:Ye,variant:"outline",disabled:te,children:"Reset"}),l.jsx(Ze,{onClick:Ve,variant:"outline",disabled:te,children:"Back to Cabinet"}),l.jsx(Ze,{onClick:tt,disabled:te,className:"px-8",children:te?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white",className:"mr-2"}),"Submitting..."]}):"Submit Test"})]})}),l.jsx(Bo,{isOpen:Ce&&!te,onClose:()=>Oe(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>Oe(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:ot,variant:"primary",children:"Reset"})]})]})}),l.jsx(Bo,{isOpen:fe&&!te,onClose:()=>pe(!1),title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(Ze,{onClick:()=>pe(!1),variant:"secondary",children:"Cancel"}),l.jsx(Ze,{onClick:Rt,variant:"primary",children:"Leave"})]})]})})]}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Tr,{size:"lg"})})},BW=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:c,onSelect:d,onUpdate:f,onDelete:p})=>{const g=v=>{v.cancelBubble=!0,f(e,{isEditing:!0})},y=v=>{f(e,{x:v.target.x(),y:v.target.y()})};return l.jsxs(Uo,{x:t,y:r,draggable:!0,onClick:v=>{v.cancelBubble=!0,d(e)},onDblClick:g,onDragEnd:y,children:[l.jsx(ea,{width:n,height:s,fill:c?"#fef3c7":"#ffffff",stroke:c?"#f59e0b":"#d1d5db",strokeWidth:c?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),l.jsx(Sl,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word"})]})},UW=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=C.useRef(null);C.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const c=d=>{d.key==="Enter"&&!d.shiftKey?(d.preventDefault(),a(o.current.value)):d.key==="Escape"&&i()};return l.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:c,onBlur:()=>a(o.current.value)})},$W=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:c,isPanning:d,isFullscreen:f,constrainPanPosition:p,handleWheel:g,stageRef:y,setIsPanning:v,responsiveDimensions:w,canvasSize:b,question:E,textBoxes:k,setTextBoxes:_,selectedTextBox:N,setSelectedTextBox:A,handleTextBoxSelect:P,handleTextBoxUpdate:R,handleTextBoxDelete:T,isEditingText:D,editingTextBox:I,setIsEditingText:K,setEditingTextBox:X,setCurrentTool:Z})=>{const[oe,q]=C.useState(!1),[re,M]=C.useState([]),[W,B]=C.useState(null),[G,H]=C.useState(null),O=C.useRef(null),[z,Y]=C.useState(.25),[J,te]=C.useState({x:0,y:0});C.useEffect(()=>{const he=()=>{const _e=O.current;if(!_e)return;const $e=_e.clientWidth||1,St=_e.clientHeight||1,ct=Math.min($e/(b.width||1),St/(b.height||1));Y(Math.min(ct,1))};return he(),window.addEventListener("resize",he),()=>window.removeEventListener("resize",he)},[b.width,b.height,f]);const ee=he=>{const _e=y.current,$e=_e.getPointerPosition();if(s==="pan")return;if(s==="text"){const ct={x:($e.x-_e.x())/_e.scaleX(),y:($e.y-_e.y())/_e.scaleY()},zt={id:Date.now(),x:ct.x,y:ct.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};_(qt=>[...qt,zt]),A(zt.id),Z("pan");return}q(!0);const St={x:($e.x-_e.x())/_e.scaleX(),y:($e.y-_e.y())/_e.scaleY()};H(St),s==="pencil"?M([{x:St.x,y:St.y,color:a,thickness:i}]):s==="eraser"?M([{x:St.x,y:St.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&B({type:s,startX:St.x,startY:St.y,endX:St.x,endY:St.y,color:a,thickness:i})},ie=he=>{const _e=y.current,$e=_e.getPointerPosition(),St={x:($e.x-_e.x())/_e.scaleX(),y:($e.y-_e.y())/_e.scaleY()};if(te(St),s!=="pan"&&oe)if(s==="pencil"){const ct=[...re,{x:St.x,y:St.y,color:a,thickness:i}];M(ct)}else if(s==="eraser"){const ct=[...re,{x:St.x,y:St.y,color:a,thickness:i,tool:"eraser"}];M(ct)}else["line","rectangle","circle"].includes(s)&&W&&B({...W,endX:St.x,endY:St.y})},me=()=>{if(s!=="pan"&&oe){if(s==="pencil"){const he=[...r,re];n(he),M([])}else if(s==="eraser"){const he=[...r,re];n(he),M([])}else if(["line","rectangle","circle"].includes(s)&&W){const he=[...r,W];n(he),B(null)}q(!1),H(null)}},[Ce,Oe]=C.useState(null),[fe,pe]=C.useState(null),[He,Ye]=C.useState(!1),[ot,Ve]=C.useState(null),[Rt,tt]=C.useState(!1),[Le,De]=C.useState(!1),[Je,_t]=C.useState([]),[ht,It]=C.useState(null),[Mt,rt]=C.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let qe=null;const lt=(window.devicePixelRatio||1)>1.5,wt={scaleDelta:lt?.03:.04,centerDelta:lt?4:6,minTouchDistance:8,gestureHysteresis:.02},Lt=()=>{tt(!1),Ve(null),Oe(null),pe(null),q(!1),H(null),De(!1),It(null),qe&&(cancelAnimationFrame(qe),qe=null),y.current&&y.current.stop()},Ht=he=>{if(he.length<2)return 0;const _e=he[0],$e=he[1];return Math.sqrt(Math.pow($e.clientX-_e.clientX,2)+Math.pow($e.clientY-_e.clientY,2))},Ie=he=>{if(he.length<2)return null;const _e=he[0],$e=he[1];return{x:(_e.clientX+$e.clientX)/2,y:(_e.clientY+$e.clientY)/2}},at=he=>{_t(_e=>[..._e,{type:he,timestamp:Date.now()}].slice(-5))},gt=()=>{const he=Date.now(),_e=Je.filter(ct=>he-ct.timestamp<500);if(_e.length<2)return 0;const $e=_e[_e.length-1],St=_e[_e.length-2];return $e.type===St.type?wt.gestureHysteresis:0},At=(he,_e)=>{rt($e=>({totalGestures:$e.totalGestures+1,zoomGestures:he.includes("zoom")?$e.zoomGestures+1:$e.zoomGestures,panGestures:he.includes("pan")?$e.panGestures+1:$e.panGestures,combinedGestures:he==="zoom+pan"?$e.combinedGestures+1:$e.combinedGestures,averageResponseTime:($e.averageResponseTime+_e)/2}))},Ot=(he,_e,$e,St)=>{const ct=y.current,zt=ct.scaleX(),qt=ct.position();let Vt=zt,gr=qt;if(he){const cr=$e/Ce,Pr=zt*cr,Xr=E?.max_canvas_width||1536,ue=E?.max_canvas_height||2048,ke=Xr/b.width,ge=ue/b.height,ve=Math.min(ke,ge,1);Vt=Math.max(.25,Math.min(ve,Pr));const Se=St,Ee={x:(Se.x-ct.x())/zt,y:(Se.y-ct.y())/zt};gr={x:Se.x-Ee.x*Vt,y:Se.y-Ee.y*Vt}}if(_e){const cr=St.x-fe.x,Pr=St.y-fe.y;he?gr={x:gr.x+cr,y:gr.y+Pr}:gr={x:qt.x+cr,y:qt.y+Pr}}qe||(qe=requestAnimationFrame(()=>{ct.scale({x:Vt,y:Vt}),ct.position(gr),ct.batchDraw(),qe=null})),he&&_e?(Ve("zoom+pan"),De(!0)):he?(Ve("zoom"),De(!0)):_e&&Ve("pan");const fr=Date.now()-(ht||Date.now());At(he&&_e?"zoom+pan":he?"zoom":"pan",fr),console.log(" Combined gesture",{doZoom:he,doPan:_e,scale:Vt.toFixed(2),pos:gr})},Jt=he=>{const _e=he.evt.touches;_e.length===2?(he.evt.preventDefault(),tt(!0),Ve(null),Oe(Ht(_e)),pe(Ie(_e)),q(!1),It(Date.now())):_e.length===1&&(tt(!1),Ve(null),ee())},Ae=he=>{const _e=he.evt.touches;if(_e.length===2&&Rt){he.evt.preventDefault();const $e=y.current,St=Ht(_e),ct=Ie(_e);if(Ce&&fe&&$e&&St>wt.minTouchDistance){const zt=Math.abs(St/Ce-1),qt=Math.sqrt(Math.pow(ct.x-fe.x,2)+Math.pow(ct.y-fe.y,2)),Vt=gt(),gr=wt.scaleDelta-Vt,Fr=wt.centerDelta-Vt*10,fr=zt>gr,cr=qt>Fr;(fr||cr)&&(Ot(fr,cr,St,ct),fr&&cr?at("zoom+pan"):fr?at("zoom"):cr&&at("pan")),console.log(" Gesture Debug",{scaleDelta:zt.toFixed(3),centerDelta:qt.toFixed(1),doZoom:fr,doPan:cr,hysteresis:Vt.toFixed(3),adjustedScaleDelta:gr.toFixed(3),adjustedCenterDelta:Fr.toFixed(1),gestureHistory:Je.slice(-3)})}Oe(St),pe(ct)}else _e.length===1&&!Rt&&(he.evt.preventDefault(),ie())},ye=he=>{const _e=he.evt.touches;_e.length===0?(me(),Lt(),De(!1)):_e.length===1&&(tt(!1),Ve(null),Oe(null),pe(null),De(!1))};return l.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:l.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:l.jsxs("div",{className:"relative",style:{border:f&&(w.width<window.innerWidth-40||w.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[l.jsx("div",{ref:O,className:"w-full h-full",children:l.jsx(Qd,{ref:y,width:w.width,height:w.height,scaleX:f?w.zoom:o,scaleY:f?w.zoom:o,onMouseDown:ee,onMousemove:ie,onMouseup:me,onTouchStart:Jt,onTouchMove:Ae,onTouchEnd:ye,onWheel:g||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&v(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(v(!1),p)){const he=y.current,_e=O.current,$e=_e?.clientWidth||w.width,St=_e?.clientHeight||w.height,ct=b.width*he.scaleX(),zt=b.height*he.scaleY(),qt=he.x(),Vt=he.y();(qt>$e||qt<-ct||Vt>St||Vt<-zt)&&p(he)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":d?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",w.width,"x",w.height),console.log(" DrawingTestStudent - Canvas size:",b.width,"x",b.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(b.width*o),"x",Math.round(b.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(b.width*o*b.height*o))},children:l.jsxs(Yd,{children:[l.jsx(ea,{x:0,y:0,width:b.width,height:b.height,fill:"white"}),r.map((he,_e)=>{if(Array.isArray(he)){const $e=he[0]?.tool==="eraser";return l.jsx(ma,{points:he.flatMap(St=>[St.x,St.y]),stroke:$e?"black":he[0]?.color||"#000000",strokeWidth:$e?(he[0]?.thickness||2)*7:he[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:$e?"destination-out":"source-over"},_e)}else{if(he.type==="line")return l.jsx(ma,{points:[he.startX,he.startY,he.endX,he.endY],stroke:he.color,strokeWidth:he.thickness,lineCap:"round"},_e);if(he.type==="rectangle"){const $e=Math.abs(he.endX-he.startX),St=Math.abs(he.endY-he.startY),ct=Math.min(he.startX,he.endX),zt=Math.min(he.startY,he.endY);return l.jsx(ea,{x:ct,y:zt,width:$e,height:St,stroke:he.color,strokeWidth:he.thickness,fill:"transparent"},_e)}else if(he.type==="circle"){const $e=Math.sqrt(Math.pow(he.endX-he.startX,2)+Math.pow(he.endY-he.startY,2))/2,St=(he.startX+he.endX)/2,ct=(he.startY+he.endY)/2;return l.jsx(ju,{x:St,y:ct,radius:$e,stroke:he.color,strokeWidth:he.thickness,fill:"transparent"},_e)}}return null}),k.map(he=>l.jsx(BW,{...he,isSelected:N===he.id,onSelect:P,onUpdate:R,onDelete:T},he.id)),s==="pencil"&&l.jsx(ma,{points:re.flatMap(he=>[he.x,he.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&l.jsx(ma,{points:re.flatMap(he=>[he.x,he.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),W&&W.type==="line"&&l.jsx(ma,{points:[W.startX,W.startY,W.endX,W.endY],stroke:W.color,strokeWidth:W.thickness,lineCap:"round"}),W&&W.type==="rectangle"&&l.jsx(ea,{x:Math.min(W.startX,W.endX),y:Math.min(W.startY,W.endY),width:Math.abs(W.endX-W.startX),height:Math.abs(W.endY-W.startY),stroke:W.color,strokeWidth:W.thickness,fill:"transparent"}),W&&W.type==="circle"&&l.jsx(ju,{x:(W.startX+W.endX)/2,y:(W.startY+W.endY)/2,radius:Math.sqrt(Math.pow(W.endX-W.startX,2)+Math.pow(W.endY-W.startY,2))/2,stroke:W.color,strokeWidth:W.thickness,fill:"transparent"}),s==="eraser"&&l.jsx(ju,{x:J.x,y:J.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&l.jsx(ma,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&l.jsx(ma,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&l.jsx(ma,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&l.jsx(ma,{points:[J.x-10,J.y,J.x+10,J.y,J.x,J.y-10,J.x,J.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),D&&I&&l.jsx(UW,{x:I.x,y:I.y,width:I.width,height:I.height,initialText:I.text,onSave:he=>{R(I.id,{text:he}),K(!1),X(null)},onCancel:()=>{K(!1),X(null)}}),l.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[l.jsx("button",{onClick:()=>{const he=y.current,_e=he.scaleX(),$e=E?.max_canvas_width||1536,St=E?.max_canvas_height||2048,ct=$e/b.width,zt=St/b.height,qt=Math.min(ct,zt,5),Vt=Math.min(qt,he.scaleX()*1.2);he.scale({x:Vt,y:Vt}),he.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",_e.toFixed(2),"->",Vt.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(b.width*Vt),"x",Math.round(b.height*Vt)),console.log(" DrawingTestStudent - New resolution:",Math.round(b.width*Vt*b.height*Vt),"pixels"),c(Vt)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),l.jsx("button",{onClick:()=>{const he=y.current,_e=he.scaleX(),$e=Math.max(.25,he.scaleX()*.8);he.scale({x:$e,y:$e}),he.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",_e.toFixed(2),"->",$e.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(b.width*$e),"x",Math.round(b.height*$e)),console.log(" DrawingTestStudent - New resolution:",Math.round(b.width*$e*b.height*$e),"pixels"),c($e)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),l.jsx("button",{onClick:()=>{const he=y.current,_e=he.scaleX();he.scale({x:1,y:1}),he.position({x:0,y:0}),he.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",_e.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",b.width,"x",b.height),console.log(" DrawingTestStudent - Reset resolution:",b.width*b.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),l.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},WW=({content:e})=>{if(!e)return l.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return l.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},zW=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{ba();const[o,c]=C.useState([]),[d,f]=C.useState(!0),[p,g]=C.useState("pencil"),[y,v]=C.useState("#000000"),[w,b]=C.useState(2),[E,k]=C.useState([]),[_,N]=C.useState(-1),[A,P]=C.useState({width:600,height:800}),[R,T]=C.useState(1),[D,I]=C.useState(!1),[K,X]=C.useState(!1),[Z,oe]=C.useState(!1),[q,re]=C.useState([]),[M,W]=C.useState(null),[B,G]=C.useState(!1),[H,O]=C.useState(null),z=_>0,Y=_<E.length-1,[J,te]=C.useState(!1),ee=C.useRef(null),ie=C.useRef(null),[me,Ce]=C.useState({width:600,height:800}),Oe=C.useRef(!1),[fe,pe]=C.useState(.25),He=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];C.useEffect(()=>{const rt=()=>{oe(window.innerWidth>=1024)};return rt(),window.addEventListener("resize",rt),()=>window.removeEventListener("resize",rt)},[]),C.useEffect(()=>{if(e){const rt=e.max_canvas_width||1536,qe=e.max_canvas_height||2048,pt=e.canvas_width||600,lt=e.canvas_height||800;if(P({width:rt,height:qe}),Oe.current)console.log(" DrawingTestStudent - Preserving user zoom:",R.toFixed(2));else{T(1),Oe.current=!0;const Lt=(pt-rt*1)/2,Ht=(lt-qe*1)/2;if(!isNaN(Lt)&&!isNaN(Ht)&&ee.current){const Ie={x:Lt,y:Ht};ee.current.position(Ie),ee.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",rt,"x",qe),console.log(" DrawingTestStudent - Viewport size:",pt,"x",lt),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",rt*qe,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(rt/qe).toFixed(2))}if(r&&typeof r=="string")try{const wt=JSON.parse(r);wt.lines?c(wt.lines):c(wt),wt.textBoxes&&re(wt.textBoxes)}catch{console.log("No valid drawing data found")}f(!1)}},[e,r]),C.useEffect(()=>{const rt=()=>{const qe=ie.current;if(!qe)return;const pt=qe.clientWidth||1,lt=qe.clientHeight||1,wt=Math.min(pt/(A.width||1),lt/(A.height||1));pe(Math.min(wt,1))};return rt(),window.addEventListener("resize",rt),()=>window.removeEventListener("resize",rt)},[A.width,A.height,J]);const Ye=rt=>{c(rt);const qe={lines:rt,textBoxes:q};n(e.question_id,JSON.stringify(qe)),ot(rt,q)},ot=(rt,qe=q)=>{const pt=E.slice(0,_+1);pt.push({lines:[...rt],textBoxes:[...qe]}),k(pt),N(pt.length-1)},Ve=()=>{if(z){const rt=_-1,qe=E[rt];if(qe&&typeof qe=="object"&&qe.lines){c([...qe.lines]),re([...qe.textBoxes]);const pt={lines:qe.lines,textBoxes:qe.textBoxes};n(e.question_id,JSON.stringify(pt))}else{const pt=qe||[];c([...pt]),n(e.question_id,JSON.stringify(pt))}N(rt)}},Rt=()=>{if(Y){const rt=_+1,qe=E[rt];if(qe&&typeof qe=="object"&&qe.lines){c([...qe.lines]),re([...qe.textBoxes]);const pt={lines:qe.lines,textBoxes:qe.textBoxes};n(e.question_id,JSON.stringify(pt))}else{const pt=qe||[];c([...pt]),n(e.question_id,JSON.stringify(pt))}N(rt)}},tt=()=>{c([]),re([]),W(null),n(e.question_id,"")},Le=rt=>{W(rt)},De=(rt,qe)=>{const pt=q.map(wt=>wt.id===rt?{...wt,...qe}:wt);re(pt),ot(o,pt);const lt={lines:o,textBoxes:pt};if(n(e.question_id,JSON.stringify(lt)),qe.isEditing){const wt=q.find(Lt=>Lt.id===rt);O(wt),G(!0)}},Je=rt=>{const qe=q.filter(lt=>lt.id!==rt);re(qe),M===rt&&W(null),ot(o,qe);const pt={lines:o,textBoxes:qe};n(e.question_id,JSON.stringify(pt))},_t=()=>{if(J){const pt=e?.canvas_width||600,lt=e?.canvas_height||800,wt=window.innerWidth-40,Lt=window.innerHeight-40,Ht=wt/pt,Ie=Lt/lt,at=Math.min(Ht,Ie,1);return{width:pt,height:lt,zoom:at}}const rt=e?.canvas_width||600,qe=e?.canvas_height||800;return{width:rt,height:qe,zoom:1}};C.useEffect(()=>{const rt=()=>{Ce(_t())};return rt(),window.addEventListener("resize",rt),()=>window.removeEventListener("resize",rt)},[J,A]);const ht=rt=>{rt.evt.preventDefault();const qe=ee.current,pt=qe.scaleX(),lt=qe.getPointerPosition(),wt={x:(lt.x-qe.x())/pt,y:(lt.y-qe.y())/pt},Lt=rt.evt.deltaY>0?pt*.9:pt*1.1,Ht=e?.max_canvas_width||1536,Ie=e?.max_canvas_height||2048,at=Ht/A.width,gt=Ie/A.height,At=Math.min(at,gt,1),Ot=Math.max(fe,Math.min(At,Lt)),Jt={x:lt.x-wt.x*Ot,y:lt.y-wt.y*Ot};if(Ot<=fe&&ie.current){const Ae=ie.current.clientWidth||1,ye=ie.current.clientHeight||1;Jt.x=(Ae-A.width*Ot)/2,Jt.y=(ye-A.height*Ot)/2}qe.scale({x:Ot,y:Ot}),qe.position(Jt),qe.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",pt.toFixed(2),"->",Ot.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(A.width*Ot),"x",Math.round(A.height*Ot)),console.log(" DrawingTestStudent - New resolution:",Math.round(A.width*Ot*A.height*Ot),"pixels"),T(Ot),Oe.current=!0},It=rt=>{const qe=rt.scaleX(),pt=ie.current,lt=pt?.clientWidth||me.width,wt=pt?.clientHeight||me.height,Lt=A.width*qe,Ht=A.height*qe;if(qe<=fe){const he=(lt-Lt)/2,_e=(wt-Ht)/2;rt.position({x:he,y:_e}),rt.batchDraw();return}if(Lt<=lt&&Ht<=wt){const he=(lt-Lt)/2,_e=(wt-Ht)/2;rt.position({x:he,y:_e}),rt.batchDraw();return}const Ie=Math.max(0,Lt-lt),at=Math.max(0,Ht-wt),gt=-Ie,At=-at,Ot=rt.x(),Jt=rt.y(),Ae=Math.max(gt,Math.min(Ie,Ot)),ye=Math.max(At,Math.min(at,Jt));(Ae!==Ot||ye!==Jt)&&(rt.position({x:Ae,y:ye}),rt.batchDraw())},Mt=()=>{if(J)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const rt=document.querySelector(".drawing-canvas-container");rt&&(rt.requestFullscreen?rt.requestFullscreen():rt.webkitRequestFullscreen?rt.webkitRequestFullscreen():rt.msRequestFullscreen&&rt.msRequestFullscreen())}};return C.useEffect(()=>{const rt=()=>{te(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",rt),document.addEventListener("webkitfullscreenchange",rt),document.addEventListener("msfullscreenchange",rt),()=>{document.removeEventListener("fullscreenchange",rt),document.removeEventListener("webkitfullscreenchange",rt),document.removeEventListener("msfullscreenchange",rt)}},[]),C.useEffect(()=>()=>{ee.current&&ee.current.stop()},[]),d?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx(Tr,{})}):e?l.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${J?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!J&&l.jsx("div",{className:"mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!J&&e.question_json&&e.question_json.trim()&&l.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),l.jsx("div",{className:"text-gray-700",children:l.jsx(WW,{content:e.question_json})})]}),!J&&l.jsx(bt,{className:"p-1 sm:p-2 mb-2",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),l.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[l.jsx("button",{onClick:()=>g("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),l.jsx("button",{onClick:()=>g("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),l.jsx("button",{onClick:()=>g("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),l.jsx("button",{onClick:()=>g("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),l.jsx("button",{onClick:()=>g("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),l.jsx("button",{onClick:()=>g("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),l.jsx("button",{onClick:()=>g("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${p==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Ve,disabled:!z,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${z?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),l.jsx("button",{onClick:Rt,disabled:!Y,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${Y?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>I(!D),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:y}}),l.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),D&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:l.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:He.map(rt=>l.jsx("button",{onClick:()=>{v(rt),I(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${y===rt?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:rt},title:rt},rt))})})]}),l.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[l.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),l.jsx("input",{type:"range",min:"1",max:"10",value:w,onChange:rt=>b(parseInt(rt.target.value)),className:"w-16 sm:w-20"}),l.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[w,"px"]})]}),l.jsx(Ze,{onClick:tt,variant:"secondary",size:"sm",children:"Clear"})]})}),l.jsx(bt,{paddingClass:"p-0 sm:p-2",children:l.jsxs("div",{className:"w-full drawing-canvas-container relative p-0 m-0",children:[l.jsx($W,{width:A.width,height:A.height,lines:o,onDrawingChange:Ye,currentTool:p,currentColor:y,currentThickness:w,zoom:R,onZoomChange:T,isPanning:K,isFullscreen:J,constrainPanPosition:It,handleWheel:ht,stageRef:ee,setIsPanning:X,responsiveDimensions:me,canvasSize:A,question:e,textBoxes:q,setTextBoxes:re,selectedTextBox:M,setSelectedTextBox:W,handleTextBoxSelect:Le,handleTextBoxUpdate:De,handleTextBoxDelete:Je,isEditingText:B,editingTextBox:H,setIsEditingText:G,setEditingTextBox:O,setCurrentTool:g}),l.jsx("button",{onClick:Mt,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:J?"Exit Fullscreen":"Enter Fullscreen",children:J?l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},Ow={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),c=await o.json();return await this.handleLoginResponse(o,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await Qn.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await Qn.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await Qn.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await Qn.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await Qn.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},HW=()=>{const e=Ti(),{login:t,setUserData:r,isAuthenticated:n,user:s}=Mn(),[a,i]=C.useState({username:"",password:""}),[o,c]=C.useState(!1),[d,f]=C.useState(""),[p,g]=C.useState([]),[y,v]=C.useState(!1);C.useEffect(()=>{w()},[]);const w=C.useCallback(()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager&&window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const K=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());K&&K.role?console.log("User role from JWT:",K.role):console.log("No valid role found in JWT, showing login")}catch(K){console.error("Error decoding JWT token:",K)}}else console.log("No valid JWT session found, showing login")},[]),b=C.useCallback(async K=>{if(K.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),T("Please wait for the logout process to complete.","warning");return}const{username:X,password:Z}=a;if(!X||!Z){f("Please enter both username and password");return}c(!0),f("");try{let oe,q;X==="admin"?(oe=await Ow.adminLogin({username:X,password:Z}),q=ri.ADMIN):/^\d+$/.test(X)?(oe=await Ow.studentLogin({username:X,password:Z}),q=ri.STUDENT):(oe=await Ow.teacherLogin({username:X,password:Z}),q=ri.TEACHER);let re,M;if(oe.response?(re=oe,M=oe.response):(re=await oe.json(),M=oe),await E(M,q,re)){T("Login successful!","success");try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(oe){console.error("Login error:",oe),f("Invalid username or password")}finally{c(!1)}},[a]),E=C.useCallback(async(K,X,Z)=>{if(K.ok&&Z.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),P(),!1;try{Z.token&&(window.tokenManager.setTokens(Z.token,X),Z.refreshToken&&window.tokenManager.setRefreshToken(Z.refreshToken),console.log("JWT token stored successfully"));const oe={...Z.data,...Z,role:X};return r(oe),await k(oe),!0}catch(oe){return console.error("Error handling login response:",oe),P(oe),!1}}else return console.error("Login failed:",Z.error||"Unknown error"),f(Z.error||"Login failed. Please check your credentials."),!1},[t]),k=C.useCallback(async K=>{if(console.log("Handling post-login actions for role:",K.role),y){console.log(" Post-login already handled, skipping");return}v(!0);try{switch(K.role){case ri.STUDENT:await _(K),e("/student");break;case ri.TEACHER:await N(K),e("/teacher");break;case ri.ADMIN:await A(K),e("/admin");break;default:console.error("Unknown user role:",K.role),P()}}catch(X){console.error("Error in post-login actions:",X),P(X)}},[e,y]);C.useEffect(()=>{n||v(!1)},[n]);const _=C.useCallback(async K=>{console.log("Populating student info:",K)},[]),N=C.useCallback(async K=>{console.log("Populating teacher info:",K)},[]),A=C.useCallback(async K=>{console.log("Populating admin info:",K)},[]),P=C.useCallback((K=null)=>{console.error("Login failure:",K),f("Login failed. Please check your credentials and try again."),R()},[]),R=C.useCallback(()=>{i({username:"",password:""}),f(""),c(!1)},[]),T=C.useCallback((K,X)=>{const Z={id:Date.now(),message:K,type:X,timestamp:new Date};g(oe=>[...oe,Z]),setTimeout(()=>{g(oe=>oe.filter(q=>q.id!==Z.id))},vi.NOTIFICATION_DURATION)},[]),D=C.useCallback(K=>{const{name:X,value:Z}=K.target;i(oe=>({...oe,[X]:Z})),d&&f("")},[d]),I=C.useCallback(K=>{K.key==="Enter"&&!o&&b(K)},[b,o]);return l.jsxs(Xe.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsxs(Xe.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsxs(Xe.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx(Xe.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:l.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-16 w-16 object-contain"})}),l.jsx(Xe.h1,{className:"text-3xl font-bold text-gray-900 mb-2",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"Mathayom Watsing School"}),l.jsx(Xe.p,{className:"text-lg text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:"Test Management System"})]}),l.jsxs(Xe.div,{className:"bg-white rounded-xl shadow-2xl p-8",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[l.jsx(Xe.h2,{className:"text-2xl font-semibold text-gray-900 text-center mb-6",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"Login"}),l.jsxs("form",{onSubmit:b,className:"space-y-6",children:[l.jsxs(Xe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Student ID"}),l.jsx(Xe.input,{type:"text",id:"username",name:"username",value:a.username,onChange:D,onKeyDown:I,placeholder:"Enter student ID",required:!0,autoComplete:"username",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":d?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsxs(Xe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsx(Xe.input,{type:"password",id:"password",name:"password",value:a.password,onChange:D,onKeyDown:I,placeholder:"Enter your password",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors duration-200 disabled:bg-gray-100 disabled:cursor-not-allowed","aria-describedby":d?"error-message":void 0,whileFocus:{scale:1.02},transition:{duration:.2}})]}),l.jsx(wi,{children:d&&l.jsx(Xe.div,{id:"error-message",className:"bg-red-50 border border-red-200 rounded-lg p-3",role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:l.jsx("p",{className:"text-sm text-red-600",children:d})})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:l.jsx(Ze,{type:"submit",variant:"primary",size:"lg",disabled:o,className:"w-full",children:o?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",className:"mr-2"}),"Logging in..."]}):"Login"})})]})]}),vi.DEBUG_MODE]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:l.jsx(wi,{children:p.map(K=>l.jsx(Xe.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:l.jsx(Vo,{type:K.type,message:K.message,onClose:()=>g(X=>X.filter(Z=>Z.id!==K.id))})},K.id))})})]})},xn={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n,s]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAcademicYear(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],academicYear:n.status==="fulfilled"?n.value:[],users:s.status==="fulfilled"?s.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async getAcademicYear(){console.log("getAcademicYear called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-academic-year")).json();if(t.success)return console.log("Academic year loaded successfully"),t.academic_years.map(r=>({id:r.id,year:r.academic_year,semester:r.semester,term:r.term,start_date:r.start_date,end_date:r.end_date,is_current:r.is_current}));throw new Error(t.error||"Failed to load academic year")}catch(e){throw console.error("Error loading academic year:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.teacher_id||t.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const e=localStorage.getItem("accessToken");if(!e)return null;const t=JSON.parse(atob(e.split(".")[1]));return t.admin_id||t.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},Oj=C.createContext(),Lj=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState([]),[a,i]=C.useState([]),[o,c]=C.useState([]),[d,f]=C.useState([]),[p,g]=C.useState([]),[y,v]=C.useState([]),[w,b]=C.useState([]),[E,k]=C.useState(!1),[_,N]=C.useState(null),[A,P]=C.useState(!1),[R,T]=C.useState(!1),[D,I]=C.useState(!1),[K,X]=C.useState(null),[Z,oe]=C.useState(null),[q,re]=C.useState(null),M=C.useCallback(async()=>{try{k(!0),N(null);const he=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",he);const _e=En(he);if(_e){console.log(" UserContext: Cache HIT! Using cached student data"),s(_e),W(_e);return}console.log(" UserContext: Cache MISS! Fetching from API");const $e=await xn.getStudentData();if($e)s($e),W($e),console.log(" UserContext: Caching student data with key:",he),Nn(he,$e,Fn.student_subjects);else throw new Error("No subjects data received")}catch(ye){N(ye.message||"Failed to load student data"),console.error("Error loading student data:",ye)}finally{k(!1)}},[t?.student_id,t?.id]),W=ye=>{console.log("Displaying student subjects:",ye),s(ye)},B=C.useCallback(async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),N("No valid teacher session found");return}const he=`teacher_subjects_${t?.teacher_id||t?.id||""}`,_e=En(he);if(_e){s(_e),_e.length===0?at():G(_e);return}const $e=await xn.getTeacherSubjects();if($e.success)s($e.subjects),Nn(he,$e.subjects,Fn.teacher_subjects),$e.subjects.length===0?at():G($e.subjects);else throw new Error($e.message||"Failed to load teacher data")}catch(ye){N(ye.message||"Failed to load teacher data"),console.error("Error loading teacher data:",ye)}finally{k(!1)}},[t?.teacher_id,t?.id]),G=ye=>{console.log("Showing main cabinet with subjects:",ye),s(ye)},H=ye=>{console.log("Displaying grade buttons:",ye),c(ye)},O=async()=>{try{if(k(!0),N(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),N("No valid admin session found");return}await Promise.all([pe(),De(),qe(),te()])}catch(ye){N(ye.message||"Failed to load admin data"),console.error("Error loading admin data:",ye)}finally{k(!1)}},z=ye=>{console.log(" populateStudentInfoDirectly called with:",ye);try{r(ye),console.log(" Set student profile:",ye)}catch(he){console.error("Error populating student info:",he)}},Y=ye=>{console.log("=== populateStudentInfo called ==="),r(ye)},J=ye=>{console.log("=== populateTeacherInfo called ==="),r(ye)},te=C.useCallback(async()=>{try{k(!0);const ye="admin_users_",he=En(ye);if(he){f(he),ee(he);return}const _e=await xn.getAllUsers();if(_e.success)f(_e.users),ee(_e.users),Nn(ye,_e.users,Fn.admin_users);else throw new Error(_e.message||"Failed to load users")}catch(ye){N(ye.message||"Failed to load users"),console.error("Error loading users:",ye)}finally{k(!1)}},[]),ee=ye=>{console.log("Displaying all users:",ye),f(ye)},ie=(ye,he)=>{console.log("Displaying users table:",ye,he),f(ye)},me=()=>{console.log("Toggling users content")},Ce=()=>{console.log("Showing add user form"),P(!0)},Oe=()=>{console.log("Hiding add user form"),P(!1)},fe=ye=>{console.log("Editing user row:",ye);const he=d.find(_e=>_e.id===ye);X(he)},pe=C.useCallback(async()=>{try{const ye="admin_teachers_",he=En(ye);if(he){g(he),He(he);return}const _e=await xn.getAllTeachers();if(_e.success)g(_e.teachers),He(_e.teachers),Nn(ye,_e.teachers,Fn.admin_teachers);else throw new Error(_e.message||"Failed to load teachers")}catch(ye){N(ye.message||"Failed to load teachers"),console.error("Error loading teachers:",ye)}},[]),He=ye=>{console.log("Displaying all teachers:",ye),g(ye)},Ye=(ye,he)=>{console.log("Displaying teachers table:",ye,he),g(ye)},ot=()=>{console.log("Toggling teachers content")},Ve=()=>{console.log("Showing add teacher form"),T(!0)},Rt=()=>{console.log("Hiding add teacher form"),T(!1)},tt=ye=>{console.log("Editing teacher:",ye);const he=p.find(_e=>_e.id===ye);oe(he)},Le=ye=>{console.log("Editing teacher row:",ye);const he=p.find(_e=>_e.id===ye);oe(he)},De=C.useCallback(async()=>{try{const ye="admin_subjects_",he=En(ye);if(he){v(he),Je(he);return}const _e=await xn.getAllSubjects();if(_e.success)v(_e.subjects),Je(_e.subjects),Nn(ye,_e.subjects,Fn.admin_subjects);else throw new Error(_e.message||"Failed to load subjects")}catch(ye){N(ye.message||"Failed to load subjects"),console.error("Error loading subjects:",ye)}},[]),Je=ye=>{console.log("Displaying all subjects:",ye),v(ye)},_t=(ye,he)=>{console.log("Displaying subjects table:",ye,he),v(ye)},ht=()=>{console.log("Toggling subjects content")},It=()=>{console.log("Showing add subject form"),I(!0)},Mt=()=>{console.log("Hiding add subject form"),I(!1)},rt=ye=>{console.log("Editing subject row:",ye);const he=y.find(_e=>_e.id===ye);re(he)},qe=C.useCallback(async()=>{try{const ye="admin_academic_years_",he=En(ye);if(he){b(he),pt(he);return}const _e=await xn.getAcademicYear();if(_e.success)b(_e.academicYears),pt(_e.academicYears),Nn(ye,_e.academicYears,Fn.admin_academic_years);else throw new Error(_e.message||"Failed to load academic year")}catch(ye){N(ye.message||"Failed to load academic year"),console.error("Error loading academic year:",ye)}},[]),pt=ye=>{console.log("Displaying academic year:",ye),b(ye)},lt=()=>{console.log("Showing add academic year form")},wt=()=>{console.log("Hiding add academic year form")},Lt=ye=>{console.log("Handling add academic year:",ye)},Ht=()=>{console.log("Toggling academic year content")},Ie=()=>{console.log("Showing academic year editor")},at=()=>{console.log("Showing subject selection")},gt=()=>{console.log("Showing main cabinet")},At=ye=>{r(he=>({...he,...ye}))},Ot=()=>{r(null),s([]),i([]),c([]),f([]),g([]),v([]),b([]),N(null)},Jt=C.useCallback(ye=>{Ot(),ye&&_2(ye)},[]),Ae={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:d,allTeachers:p,allSubjects:y,academicYears:w,isLoading:E,error:_,showUserForm:A,showTeacherForm:R,showSubjectForm:D,editingUser:K,editingTeacher:Z,editingSubject:q,loadStudentData:M,displayStudentSubjects:W,populateStudentInfoDirectly:z,populateStudentInfo:Y,loadTeacherData:B,showMainCabinetWithSubjects:G,displayGradeButtons:H,populateTeacherInfo:J,showSubjectSelection:at,showMainCabinet:gt,loadAdminData:O,getAllUsers:te,displayAllUsers:ee,displayUsersTable:ie,toggleUsersContent:me,showAddUserForm:Ce,hideAddUserForm:Oe,editUserRow:fe,loadAllTeachers:pe,displayAllTeachers:He,displayTeachersTable:Ye,toggleTeachersContent:ot,showAddTeacherForm:Ve,hideAddTeacherForm:Rt,editTeacher:tt,editTeacherRow:Le,loadAllSubjects:De,displayAllSubjects:Je,displaySubjectsTable:_t,toggleSubjectsContent:ht,showAddSubjectForm:It,hideAddSubjectForm:Mt,editSubjectRow:rt,loadAcademicYear:qe,displayAcademicYear:pt,showAddAcademicYearForm:lt,hideAddAcademicYearForm:wt,handleAddAcademicYear:Lt,toggleAcademicYearContent:Ht,showAcademicYearEditor:Ie,updateUserProfile:At,clearUserData:Ot,clearUserDataWithCache:Jt,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:f,setAllTeachers:g,setAllSubjects:v,setAcademicYears:b,setError:N};return l.jsx(Oj.Provider,{value:Ae,children:e})},Qy=()=>{const e=C.useContext(Oj);if(!e)throw new Error("useUser must be used within a UserProvider");return e},tN={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},cn={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},ri={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const vi={API_BASE_URL:"",APP_NAME:"Mathayom Watsing Test System",VERSION:"2.0.0",DEBUG_MODE:!1,AUTO_SAVE_INTERVAL:3e4,NOTIFICATION_DURATION:3e3,MAX_TEST_QUESTIONS:50,MIN_TEST_QUESTIONS:1,ITEMS_PER_PAGE:20,CACHE_DURATION:3e5,CURRENT_ACADEMIC_YEAR:"2025-2026",CURRENT_SEMESTER:1},Du=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&l0(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},ip=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case cn.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case cn.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case cn.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case cn.MATCHING:r=e.correct_answer||e.answer;break;case cn.WORD_MATCHING:r=e.correct_answer||e.answer;break;case cn.DRAWING:r="Drawing required";break;case cn.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},l0=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case cn.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case cn.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const c=parseInt(o,10),d=c>=0?c:NaN;Number.isNaN(d)||(a=String.fromCharCode(65+d))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case cn.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const d=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===d})}else n=t.toLowerCase().trim()===e.correct_answer.toLowerCase().trim();break;case cn.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case cn.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case cn.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case cn.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))o=c.toUpperCase();else if(/^\d+$/.test(c)){const d=parseInt(c,10),f=d>=0?d:NaN;Number.isNaN(f)||(o=String.fromCharCode(65+f))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(o=String.fromCharCode(65+c))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n},Jr={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const e="/.netlify/functions/get-teacher-active-tests";console.log("[DEBUG] Fetching teacher tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Teacher tests data received:",r),r.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get teacher tests")}catch(e){throw console.error("[ERROR] Failed to get teacher tests:",e),e}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const k=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(k.success)a=k.test_info;else throw new Error("Failed to get test information")}catch(E){console.error("Error getting test info:",E);const k=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:k.length}}const i=await this.getTestQuestions(e,t);let o,c;if(e==="drawing")o=null,c=null;else{const E=n?.answers_by_id?n.answers_by_id:r;o=Du(i,E,e).score,c=a.num_questions}const d=this.transformAnswersForSubmission(r,e),f=a.teacher_id||null,p=a.subject_id||null,g=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null),y={test_id:t,test_name:a.test_name,test_type:e,teacher_id:f,subject_id:p,student_id:g,answers:d,score:o,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",y.retest_assignment_id);let v;switch(e){case"multiple_choice":v="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":v="/.netlify/functions/submit-true-false-test";break;case"input":v="/.netlify/functions/submit-input-test";break;case"matching_type":v="/.netlify/functions/submit-matching-type-test";break;case"word_matching":v="/.netlify/functions/submit-word-matching-test";break;case"drawing":v="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":v="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",v),console.log("Submission data:",y),console.log("Submission data JSON:",JSON.stringify(y,null,2)),console.log(" Final submission retest_assignment_id:",y.retest_assignment_id);const w=await window.tokenManager.makeAuthenticatedRequest(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)});if(!w.ok)throw new Error(`HTTP error! status: ${w.status}`);const b=await w.json();if(console.log("Test submission result:",b),b.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:c,result:b};throw new Error(b.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await Qn.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await Qn.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await Qn.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await Qn.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await Qn.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await Qn.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await Qn.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await Qn.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await Qn.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await Qn.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await Qn.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await Qn.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await Qn.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await Qn.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await Qn.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await Qn.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await Qn.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":return(r.correct_answers||[]).some(o=>t.toLowerCase().trim()===o.toLowerCase().trim());case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markTestCompleted(e,t){try{console.log(`[DEBUG] markTestCompleted called with testType: ${e}, testId: ${t}`);const r=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t})});if(!r.ok)throw new Error(`HTTP error! status: ${r.status}`);const n=await r.json();if(console.log("[DEBUG] Mark test completed response:",n),n.success)return console.log(`Test ${e}_${t} marked as completed successfully`),{success:!0,message:n.message};throw new Error(n.error||"Failed to mark test as completed")}catch(r){throw console.error("Error marking test completed:",r),r}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}}},Bj=C.createContext(),Uj=({children:e})=>{const[t,r]=C.useState(null),[n,s]=C.useState([]),[a,i]=C.useState({}),[o,c]=C.useState({}),[d,f]=C.useState(!1),[p,g]=C.useState(null),[y,v]=C.useState([]),[w,b]=C.useState(!1),[E,k]=C.useState(null),[_,N]=C.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[A,P]=C.useState(null),[R,T]=C.useState(0),{getItem:D,setItem:I,removeItem:K}=Mj();C.useEffect(()=>{let Ae;return d&&A&&(Ae=setInterval(()=>{const ye=Math.floor((Date.now()-A)/1e3);T(ye)},1e3)),()=>{Ae&&clearInterval(Ae)}},[d,A]);const X=async(Ae,ye)=>{try{b(!0),k(null),console.log(`[DEBUG] loadTestForPage called with testType: ${Ae}, testId: ${ye}`);const he=await Jr.getTestInfo(Ae,ye);console.log("[DEBUG] Test info retrieved:",he);const _e=await Jr.getTestQuestions(Ae,ye);console.log("[DEBUG] Test questions retrieved:",_e),r({...he,testType:Ae,testId:ye}),s(_e),f(!0),P(Date.now()),T(0),Z(Ae,ye),console.log("[DEBUG] Test loaded successfully")}catch(he){k(he.message||"Failed to load test"),console.error("Error loading test:",he)}finally{b(!1)}},Z=(Ae,ye)=>{try{const he=`test_progress_${Ae}_${ye}`,_e=D(he);_e&&(i(_e.answers||{}),c(_e.progress||{}))}catch(he){console.error("Error loading saved progress:",he)}},oe=(Ae,ye,he,_e)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const St=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${Ae}_${ye}`,ct={...a,[he]:_e},zt={...o,[he]:{answered:!0,timestamp:Date.now()}};i(ct),c(zt),I(St,{answers:ct,progress:zt,lastSaved:Date.now()}),console.log(`Saved progress for question ${he}:`,_e)}catch($e){console.error("Error saving test progress:",$e)}},q=(Ae,ye,he)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const $e=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${Ae}_${ye}`;return D($e)?.answers?.[he]||null}catch(_e){return console.error("Error getting test progress:",_e),null}},re=(Ae,ye)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${Ae}, testId: ${ye}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const he=window.tokenManager?.getDecodedToken()?.sub||"unknown",_e=`test_progress_${he}_${Ae}_${ye}`;console.log(`[DEBUG] Removing localStorage key: ${_e}`);const $e=D(_e)!==null;K(_e),i({}),c({});for(let St=0;St<localStorage.length;St++){const ct=localStorage.key(St);ct&&ct.startsWith(`test_progress_${he}_${Ae}_${ye}_`)&&(localStorage.removeItem(ct),console.log(`[DEBUG] Cleared individual question key: ${ct}`))}console.log($e?`[DEBUG] Progress cleared for test ${Ae}_${ye}`:`[DEBUG] No progress found to clear for test ${Ae}_${ye}`)}catch(he){console.error("Error clearing test progress:",he)}},M=async(Ae,ye,he="")=>{try{b(!0),k(null),console.log("Submitting test:",{testType:Ae,testId:ye});const _e=te(Ae,ye);if(Object.keys(_e).length===0){k("Please answer at least one question before submitting.");return}let $e;try{$e=await Jr.getTestInfo(Ae,ye)}catch(Fr){console.error("Error getting test info:",Fr);const fr=await Jr.getTestQuestions(Ae,ye);$e={test_name:`Test ${ye}`,num_questions:fr.length}}const St=await Jr.getTestQuestions(Ae,ye),ct=Du(St,_e,Ae),zt=$e.num_questions,qt=ie(_e,Ae),Vt={test_id:ye,test_name:$e.test_name,score:ct,maxScore:zt,answers:qt},gr=await Jr.submitTest(Ae,ye,Vt);if(gr.success){if(g(gr.result),H(Ae,ye,he),re(Ae,ye),he){const Fr=`student_results_table_${he}`;console.log(" TestContext: Caching test results after submission with key:",Fr),Nn(Fr,gr.result,Fn.student_results_table)}return he&&g0(he,Ae,ye),f(!1),gr.results}else throw new Error(gr.message||"Test submission failed")}catch(_e){throw k(_e.message||"Failed to submit test"),_e}finally{b(!1)}},W=(Ae,ye,he)=>{g({testType:Ae,testId:ye,answers:he}),f(!1)},B=()=>{r(null),s([]),i({}),c({}),f(!1),g(null),k(null),P(null),T(0)},G=(Ae,ye,he="")=>{try{const _e=`test_completed_${he}_${Ae}_${ye}`;return D(_e)===!0}catch(_e){return console.error("Error checking test completion:",_e),!1}},H=(Ae,ye,he="")=>{try{const _e=`test_completed_${he}_${Ae}_${ye}`;I(_e,!0)}catch(_e){console.error("Error marking test completed:",_e)}},O=Ae=>Object.keys(a).length,z=()=>{const Ae=O(t?.testType),ye=n.length;return{canSubmit:Ae===ye,answeredCount:Ae,totalQuestions:ye}},Y=()=>{t&&re(t.testType,t.testId),B()},J=(Ae="")=>{try{const ye=`student_results_table_${Ae}`;console.log(" TestContext: Clearing test results cache:",ye),localStorage.removeItem(ye),console.log(" TestContext: Test results cache cleared")}catch(ye){console.error("Error clearing test results cache:",ye)}},te=(Ae,ye)=>({...a}),ee=(Ae,ye,he=null)=>{try{if(!Ae)return"No answer";switch(ye){case"true_false":return Ae?"True":"False";case"multiple_choice":if(he&&typeof Ae=="string"&&!isNaN(parseInt(Ae))){const _e=parseInt(Ae),$e=`option_${String.fromCharCode(97+_e)}`,St=he[$e];if(St)return St}return String(Ae).toUpperCase();case"input":return String(Ae);case"matching_type":return typeof Ae=="object"?Object.entries(Ae).map(([_e,$e])=>`${_e}  ${$e}`).join(", "):String(Ae);case"word_matching":return typeof Ae=="object"?Object.entries(Ae).map(([_e,$e])=>`${_e}  ${$e}`).join(", "):String(Ae);case"drawing":return"Drawing submitted";default:return String(Ae)}}catch(_e){return console.error("Error formatting student answer:",_e),"Error displaying answer"}},ie=(Ae,ye)=>{try{if(!Ae||typeof Ae!="object")return{};const he={};return Object.entries(Ae).forEach(([_e,$e])=>{if($e!=null)switch(ye){case"true_false":he[_e]=!!$e;break;case"multiple_choice":he[_e]=String($e).toUpperCase();break;case"input":he[_e]=String($e).trim();break;case"matching_type":typeof $e=="object"?he[_e]=$e:he[_e]=String($e);break;case"word_matching":typeof $e=="object"?he[_e]=$e:he[_e]=String($e);break;case"drawing":he[_e]=$e;break;default:he[_e]=$e}}),he}catch(he){return console.error("Error transforming answers for submission:",he),Ae||{}}},me=C.useCallback(async(Ae="")=>{try{b(!0);const ye=`student_active_tests_${Ae}`,he=En(ye);if(he)return v(he),he;const _e=await Jr.getActiveTests();return v(_e),Nn(ye,_e,Fn.student_active_tests),_e}catch(ye){return k(ye.message||"Failed to load active tests"),v([]),[]}finally{b(!1)}},[]),Ce=async()=>{try{return b(!0),await Jr.getTeacherTests()}catch(Ae){return k(Ae.message||"Failed to load teacher tests"),[]}finally{b(!1)}},Oe=async Ae=>{try{return b(!0),await Jr.createTest(Ae)}catch(ye){throw k(ye.message||"Failed to create test"),ye}finally{b(!1)}},fe=async(Ae,ye)=>{try{return b(!0),await Jr.deleteTest(Ae,ye)}catch(he){throw k(he.message||"Failed to delete test"),he}finally{b(!1)}},pe=async(Ae,ye)=>{try{return await Jr.getTestInfo(Ae,ye)}catch(he){throw console.error("Error getting test info:",he),he}},He=async(Ae,ye)=>{try{return await Jr.getTestQuestions(Ae,ye)}catch(he){throw console.error("Error getting test questions:",he),he}},Ye=async(Ae,ye,he)=>{try{console.log("Showing test results:",{testType:Ae,testId:ye,studentAnswers:he});const _e=await pe(Ae,ye),$e=await He(Ae,ye);Rt(_e,$e,Ae,he),f(!1),console.log("Test results displayed successfully")}catch(_e){console.error("Error showing test results:",_e),k("Failed to display test results"),g({testType:Ae,testId:ye,answers:he,showResults:!0,error:"Could not load detailed results"}),f(!1)}},ot=async(Ae,ye,he)=>{try{b(!0);const _e=await pe(Ae,ye),$e=await He(Ae,ye);Rt(_e,$e,Ae,he)}catch(_e){k(_e.message||"Failed to load test results")}finally{b(!1)}},Ve=C.useCallback(async(Ae="")=>{try{b(!0);const ye=`student_results_table_${Ae}`;console.log(" TestContext: Checking cache for key:",ye);const he=En(ye);if(he)return console.log(" TestContext: Cache HIT! Using cached test results"),g(he),he;console.log(" TestContext: Cache MISS! Fetching from API");const _e=await Jr.getStudentTestResults();return console.log(" TestContext: Test results loaded:",_e),console.log(" TestContext: Results data:",_e?.results||_e),console.log(" TestContext: Results length:",_e?.results?.length||0),g(_e),console.log(" TestContext: Caching test results with key:",ye),console.log(" TestContext: Results being cached:",_e),console.log(" TestContext: Results.results being cached:",_e.results),Nn(ye,_e,Fn.student_results_table),_e}catch(ye){throw console.error("Error loading test results:",ye),k(ye.message||"Failed to load test results"),ye}finally{b(!1)}},[]),Rt=(Ae,ye,he,_e)=>{try{console.log("Displaying test results:",{testInfo:Ae,questions:ye,testType:he,studentAnswers:_e});const $e=Du(ye,_e,he),St=Ae?.num_questions||ye?.length||0,ct=St>0?Math.round($e/St*100):0,zt=ct>=60,qt=ye.map((Vt,gr)=>{const Fr=Vt.question_id||Vt.id,fr=_e[Fr],cr=l0(Vt,fr,he);return{questionNumber:gr+1,question:Vt.question||Vt.question_text,userAnswer:ee(fr,he),correctAnswer:ip(Vt,he),isCorrect:cr,questionType:he}});g({testInfo:Ae,questions:ye,testType:he,studentAnswers:_e,showResults:!0,score:$e,totalQuestions:St,percentage:ct,passed:zt,questionAnalysis:qt,timestamp:new Date().toISOString()}),c(Vt=>({...Vt,score:$e,totalQuestions:St,percentage:ct,passed:zt,lastUpdated:Date.now()})),tt(),console.log(`Test results displayed: ${$e}/${St} (${ct}%) - ${zt?"PASSED":"FAILED"}`)}catch($e){console.error("Error displaying test results:",$e),k("Failed to display test results")}},tt=C.useCallback(()=>{try{console.log("Setting up test results page event listeners");const Ae=St=>{if(St.key==="Escape"&&Y(),St.ctrlKey&&St.key==="p"&&(St.preventDefault(),window.print()),St.key==="Enter"&&p&&!p.passed){const ct=document.getElementById("retake-test-button");ct&&ct.click()}},ye=()=>{window.print()},he=()=>{if(p){const St=`Test: ${p.testInfo?.test_name||"Test"}
Score: ${p.score}/${p.totalQuestions} (${p.percentage}%)
Status: ${p.passed?"PASSED":"FAILED"}
Completed: ${new Date(p.timestamp).toLocaleString()}`;navigator.clipboard.writeText(St).then(()=>{console.log("Results copied to clipboard")}).catch(ct=>{console.error("Failed to copy results:",ct)})}};document.addEventListener("keydown",Ae);const _e=document.getElementById("print-results");_e&&_e.addEventListener("click",ye);const $e=document.getElementById("copy-results");return $e&&$e.addEventListener("click",he),()=>{document.removeEventListener("keydown",Ae),_e&&_e.removeEventListener("click",ye),$e&&$e.removeEventListener("click",he)}}catch(Ae){console.error("Error setting up test results page event listeners:",Ae)}},[Y,p]),Le=async(Ae,ye,he)=>{try{b(!0),k(null),console.log("Viewing test details:",{testType:Ae,testId:ye,testName:he}),N({isOpen:!0,testType:Ae,testId:ye,testName:he,questions:[],isLoading:!0});const _e=await Jr.getTestQuestions(Ae,ye);_e&&_e.length>0?(N({isOpen:!0,testType:Ae,testId:ye,testName:he,questions:_e,isLoading:!1}),console.log(`Test details loaded: ${_e.length} questions`)):(k("Could not load test questions. Please try again."),N({isOpen:!0,testType:Ae,testId:ye,testName:he,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(_e){console.error("Error loading test details:",_e),k("Error loading test details. Please try again."),N({isOpen:!0,testType:Ae,testId:ye,testName:he,questions:[],isLoading:!1,error:_e.message||"Failed to load test details"})}finally{b(!1)}},De=(Ae,ye,he,_e)=>{try{console.log("Showing test details modal:",{testType:Ae,testId:ye,testName:he,questions:_e}),N({isOpen:!0,testType:Ae,testId:ye,testName:he,questions:_e||[],isLoading:!1,error:null})}catch($e){console.error("Error showing test details modal:",$e),k("Failed to show test details modal")}},Je=()=>{try{console.log("Closing test details modal"),N({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(Ae){console.error("Error closing test details modal:",Ae)}},_t=(Ae,ye)=>{try{switch(ye){case"multiple_choice":return l.jsxs("div",{className:"answer-options",children:[l.jsx("p",{children:l.jsx("strong",{children:"Options:"})}),l.jsxs("p",{children:["A) ",Ae.option_a||"No text"]}),l.jsxs("p",{children:["B) ",Ae.option_b||"No text"]}),Ae.option_c&&l.jsxs("p",{children:["C) ",Ae.option_c]}),Ae.option_d&&l.jsxs("p",{children:["D) ",Ae.option_d]}),Ae.option_e&&l.jsxs("p",{children:["E) ",Ae.option_e]}),Ae.option_f&&l.jsxs("p",{children:["F) ",Ae.option_f]}),l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Ae.correct_answer||"Not specified"]})})]});case"true_false":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Ae.correct_answer?"True":"False"]})})});case"input":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Ae.correct_answer||"Not specified"]})})});case"matching_type":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Ae.correct_answer?JSON.stringify(Ae.correct_answer):"Not specified"]})})});case"word_matching":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",Ae.correct_answer?JSON.stringify(Ae.correct_answer):"Not specified"]})})});default:return l.jsx("p",{children:"Unknown question type"})}}catch(he){return console.error("Error formatting question answer display:",he),l.jsx("p",{children:"Error displaying question"})}},ht=(Ae,ye)=>{try{console.log("Navigating to test:",{testType:Ae,testId:ye}),r({testType:Ae,testId:ye}),f(!0),X(Ae,ye)}catch(he){console.error("Error navigating to test:",he),k("Failed to navigate to test")}},It=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),f(!1),g(null),k(null)}catch(Ae){console.error("Error hiding test sections:",Ae)}},Mt=(Ae,ye,he,_e)=>{try{console.log("Displaying test on page:",{testInfo:Ae,questions:ye,testType:he,testId:_e}),r({...Ae,testType:he,testId:_e}),s(ye),f(!0),Z(he,_e),Ht(he,_e),wt(he,_e)}catch($e){console.error("Error displaying test on page:",$e),k("Failed to display test on page")}},rt=(Ae,ye,he)=>{try{return console.log("Rendering questions for page:",{questions:Ae,testType:ye,testId:he}),!Ae||!Array.isArray(Ae)?(console.warn("Invalid questions array for rendering"),[]):Ae.map((_e,$e)=>{const St=ct=>{const zt={...a,[_e.question_id]:ct};i(zt),oe(ye,he,_e.question_id,ct)};return{question:_e,index:$e,testType:ye,testId:he,studentAnswer:a[_e.question_id]||"",onAnswerChange:St}})}catch(_e){return console.error("Error rendering questions for page:",_e),[]}},qe=C.useCallback((Ae,ye)=>{try{if(!Ae||!ye){console.warn("Cannot save progress: missing testType or testId");return}const he=`test_progress_${Ae}_${ye}`,_e={answers:a,progress:o,lastSaved:Date.now(),testType:Ae,testId:ye};I(he,_e),console.log(`Progress saved for test ${Ae}_${ye}:`,_e)}catch(he){console.error("Error saving progress for page:",he)}},[a,o,I]),pt=C.useCallback(Ae=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(he=>he==null?!1:typeof he=="string"?he.trim()!=="":typeof he=="object"?Object.keys(he).length>0:!0).length}catch(ye){return console.error("Error getting answered questions count for page:",ye),0}},[a]),lt=C.useCallback((Ae,ye)=>{try{console.log("Updating progress display for page:",{testType:Ae,testId:ye});const he=pt(Ae),_e=n.length,$e=_e>0?Math.round(he/_e*100):0,St=he===_e&&_e>0;c(Vt=>({...Vt,answeredCount:he,totalQuestions:_e,percentage:$e,canSubmit:St,remainingQuestions:_e-he,lastUpdated:Date.now()}));const ct=document.getElementById("progress-bar"),zt=document.getElementById("progress-text"),qt=document.getElementById("submit-test-button");return ct&&(ct.style.width=`${$e}%`,ct.className=ct.className.replace(/bg-\w+-\d+/,""),$e>=100?ct.classList.add("bg-green-500"):$e>=80?ct.classList.add("bg-blue-500"):$e>=60?ct.classList.add("bg-yellow-500"):$e>=40?ct.classList.add("bg-orange-500"):ct.classList.add("bg-red-500")),zt&&(zt.textContent=`${he}/${_e} questions answered (${$e}%)`),qt&&(qt.disabled=!St,St?(qt.textContent=" Submit Test",qt.classList.remove("bg-gray-400"),qt.classList.add("bg-green-600","hover:bg-green-700")):(qt.textContent=` Complete ${_e-he} more question${_e-he!==1?"s":""}`,qt.classList.remove("bg-green-600","hover:bg-green-700"),qt.classList.add("bg-gray-400"))),{answeredCount:he,totalQuestions:_e,percentage:$e,canSubmit:St}}catch(he){return console.error("Error updating progress display for page:",he),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,pt]),wt=C.useCallback((Ae,ye)=>{try{console.log("Setting up test page event listeners:",{testType:Ae,testId:ye});const he=setInterval(()=>{Object.keys(a).length>0&&(qe(Ae,ye),console.log("Auto-saved progress for test:",Ae,ye))},3e4),_e=setInterval(()=>{lt(Ae,ye)},2e3),$e=Vt=>{Vt.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&Y(),Vt.ctrlKey&&Vt.key==="s"&&(Vt.preventDefault(),qe(Ae,ye),console.log("Manual save triggered")),Vt.key},St=Vt=>{Object.keys(a).length>0&&(Vt.preventDefault(),Vt.returnValue="Your test progress will be saved. Are you sure you want to leave?")},ct=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),qe(Ae,ye))},zt=()=>{console.log("Window focused - updating progress"),lt(Ae,ye)},qt=()=>{console.log("Window blurred - saving progress"),qe(Ae,ye)};return document.addEventListener("keydown",$e),window.addEventListener("beforeunload",St),document.addEventListener("visibilitychange",ct),window.addEventListener("focus",zt),window.addEventListener("blur",qt),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${Ae}_${ye}`]=he,window.testIntervals[`progress_${Ae}_${ye}`]=_e,()=>{clearInterval(he),clearInterval(_e),document.removeEventListener("keydown",$e),window.removeEventListener("beforeunload",St),document.removeEventListener("visibilitychange",ct),window.removeEventListener("focus",zt),window.removeEventListener("blur",qt),window.testIntervals&&(delete window.testIntervals[`autosave_${Ae}_${ye}`],delete window.testIntervals[`progress_${Ae}_${ye}`])}}catch(he){console.error("Error setting up test page event listeners:",he)}},[a,qe,lt,Y]),Lt=C.useCallback(()=>{try{const Ae=pt(t?.testType),ye=n.length,he=Ae===ye&&ye>0,_e=document.getElementById("submit-test-button");return _e&&(_e.disabled=!he,_e.textContent=he?"Submit Test":`Complete ${ye-Ae} more questions`),{canSubmit:he,answeredCount:Ae,totalQuestions:ye}}catch(Ae){return console.error("Error updating submit button state for page:",Ae),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,pt]),Ht=C.useCallback((Ae,ye)=>{try{console.log("Setting up progress tracking for page:",{testType:Ae,testId:ye});const he=setInterval(()=>{lt(Ae,ye),Lt()},1e3),_e=setInterval(()=>{Object.keys(a).length>0&&qe(Ae,ye)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${Ae}_${ye}`]=he,window.testIntervals[`autosave_${Ae}_${ye}`]=_e,()=>{clearInterval(he),clearInterval(_e),window.testIntervals&&(delete window.testIntervals[`progress_${Ae}_${ye}`],delete window.testIntervals[`autosave_${Ae}_${ye}`])}}catch(he){console.error("Error setting up progress tracking for page:",he)}},[a,lt,Lt,qe]),Ie=C.useCallback(async(Ae,ye)=>{const he=document.getElementById("submit-test-button");try{const _e=pt(Ae),$e=n.length;if(_e<$e){k(`Please answer all ${$e} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;he&&(he.disabled=!0,he.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await M(Ae,ye)&&(re(Ae,ye),W(Ae,ye,a),console.log("Test submitted successfully!"))}catch(_e){console.error("Error submitting test from page:",_e),k("Failed to submit test. Please try again."),he&&(he.disabled=!1,he.textContent="Submit Test")}},[pt,n.length,M,re,W,a]),at=C.useCallback(()=>{try{if(!t)return null;const Ae=["true_false","multiple_choice","input","matching_type","word_matching"];return Ae.includes(t.testType)?t.testType:Ae.includes(t.test_type)?t.test_type:null}catch(Ae){return console.error("Error getting current test type:",Ae),null}},[t]),gt=C.useCallback((Ae,ye)=>{try{console.log("Clearing progress tracking interval:",{testType:Ae,testId:ye});const he=`progress_interval_${Ae}_${ye}`,_e=`autosave_interval_${Ae}_${ye}`;window.testIntervals&&(window.testIntervals[he]&&(clearInterval(window.testIntervals[he]),delete window.testIntervals[he]),window.testIntervals[_e]&&(clearInterval(window.testIntervals[_e]),delete window.testIntervals[_e])),console.log(`Cleared progress tracking intervals for test ${Ae}_${ye}`)}catch(he){console.error("Error clearing progress tracking interval:",he)}},[]),Jt={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:d,testResults:p,activeTests:y,isLoading:w,error:E,testDetailsModal:_,testStartTime:A,timeElapsed:R,loadTestForPage:X,submitTest:M,navigateToTestResults:W,navigateBackToCabinet:B,clearTestDataAndReturnToCabinet:Y,saveTestProgress:oe,getTestProgress:q,clearTestProgress:re,loadSavedProgressForPage:Z,isTestCompleted:G,markTestCompleted:H,markTestCompletedInUI:(Ae,ye)=>{console.log("Marking test completed in UI:",{testType:Ae,testId:ye}),H(Ae,ye)},getAnsweredQuestionsCount:O,updateSubmitButtonState:z,updateSubmitButtonStateForPage:Lt,loadStudentActiveTests:me,loadActiveTests:me,loadTeacherActiveTests:Ce,getTestInfo:pe,getTestQuestions:He,createTest:Oe,deleteTest:fe,showTestResults:Ye,loadTestResults:Ve,loadTestResultsForPage:ot,displayTestResultsOnPage:Rt,setupTestResultsPageEventListeners:tt,clearTestResultsCache:J,viewTestDetails:Le,showTestDetailsModal:De,closeTestDetailsModal:Je,getQuestionAnswerDisplay:_t,navigateToTest:ht,hideTestSections:It,displayTestOnPage:Mt,renderQuestionsForPage:rt,setupTestPageEventListeners:wt,setupProgressTrackingForPage:Ht,updateProgressDisplayForPage:lt,submitTestFromPage:Ie,getAnsweredQuestionsCountForPage:pt,getCurrentTestType:at,saveProgressForPage:qe,clearProgressTrackingInterval:gt,collectTestAnswers:te,calculateTestScore:Du,checkAnswerCorrectness:l0,formatStudentAnswerForDisplay:ee,getCorrectAnswer:ip,transformAnswersForSubmission:ie,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const ye=Date.now()-360*60*60*1e3,he=[];for(let _e=0;_e<localStorage.length;_e++){const $e=localStorage.key(_e);if(!(!$e||!(($e.startsWith("test_")||$e.startsWith("student_")||$e.startsWith("teacher_")||$e.startsWith("admin_")||$e.includes("progress")||$e.includes("answers"))&&!$e.includes("test_completed_"))))try{const ct=localStorage.getItem($e);if(!ct){he.push($e);continue}let zt=null;if(ct.startsWith("{")||ct.startsWith("[")){const qt=JSON.parse(ct),Vt=qt.timestamp||qt.lastSaved||qt.lastTickAt||qt.createdAt||qt.updatedAt||qt.startedAt||qt.started_at||qt.created_at;Vt&&(zt=new Date(Vt).getTime())}if(!zt){const qt=`${$e}__ts`,Vt=localStorage.getItem(qt);Vt&&(zt=parseInt(Vt)||null)}if(!zt)continue;zt<ye&&he.push($e)}catch{continue}}return he.forEach(_e=>{console.log(`Removing old localStorage key: ${_e}`),K(_e)}),console.log(`Cleared ${he.length} old test-related items from localStorage`),{success:!0,clearedCount:he.length}}catch(Ae){return console.error("Error clearing old test data:",Ae),{success:!1,error:Ae.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:f,setTestResults:g,setError:k};return l.jsx(Bj.Provider,{value:Jt,children:e})},Wp=()=>{const e=C.useContext(Bj);if(!e)throw new Error("useTest must be used within a TestProvider");return e},zp=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0})=>{if(!e||!e.showResults)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:i,testType:o,score:c,totalQuestions:d,percentage:f,passed:p,questionAnalysis:g,timestamp:y}=e,v=E=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[E]||E,w=E=>E>=80?"text-green-600 bg-green-50":E>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",b=E=>E?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):l.jsx("div",{className:"bg-gray-50 py-8 overflow-y-auto",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs(Xe.div,{className:"bg-white rounded-lg shadow-lg p-6 mb-6",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mb-6",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",e?.visibility_change_times||a||0," times during the test."]})})]})}),l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Test Results"}),l.jsx("h2",{className:"text-xl text-gray-700 mb-1",children:i?.test_name||"Test"}),l.jsxs("p",{className:"text-sm text-gray-500",children:[v(o),"  Completed on ",new Date(y).toLocaleDateString()]})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${b(p)}`,children:p?" PASSED":" FAILED"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:c}),l.jsx("div",{className:"text-sm text-gray-600",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:d}),l.jsx("div",{className:"text-sm text-gray-600",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:`text-3xl font-bold ${w(f).split(" ")[0]}`,children:[f,"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Score"})]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 mb-6",children:l.jsx(Xe.div,{className:`h-3 rounded-full ${w(f).split(" ")[1]}`,initial:{width:0},animate:{width:`${f}%`},transition:{duration:1,ease:"easeOut"}})}),l.jsx("div",{className:"flex flex-wrap gap-3",children:l.jsx(Ze,{onClick:t,variant:"primary",className:"flex items-center gap-2",children:" Back to Cabinet"})})]}),o!=="matching_type"&&o!=="word_matching"&&l.jsxs(Xe.div,{className:"bg-white rounded-lg shadow-lg p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:g.map((E,k)=>l.jsxs(Xe.div,{className:`p-4 rounded-lg border-2 ${E.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:k*.1},children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:["Question ",E.questionNumber]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${E.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.isCorrect?" Correct":" Incorrect"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Question:"}),l.jsx("p",{className:"text-gray-700 bg-gray-100 p-3 rounded",children:E.question})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Your Answer:"}),l.jsx("p",{className:`p-3 rounded ${E.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:E.userAnswer||"No answer provided"})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-800 font-medium mb-2",children:"Correct Answer:"}),l.jsx("p",{className:"bg-blue-100 text-blue-800 p-3 rounded",children:E.correctAnswer})]})]})]},k))})]}),l.jsxs(Xe.div,{className:"bg-white rounded-lg shadow-lg p-6 mt-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[l.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Summary Statistics"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g.filter(E=>E.isCorrect).length}),l.jsx("div",{className:"text-sm text-blue-600",children:"Correct"})]}),l.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-red-600",children:g.filter(E=>!E.isCorrect).length}),l.jsx("div",{className:"text-sm text-red-600",children:"Incorrect"})]}),l.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"text-2xl font-bold text-gray-600",children:[Math.round(g.filter(E=>E.isCorrect).length/d*100),"%"]}),l.jsx("div",{className:"text-sm text-gray-600",children:"Accuracy"})]}),l.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-2xl font-bold text-purple-600",children:d}),l.jsx("div",{className:"text-sm text-purple-600",children:"Total"})]})]})]})]})})},$j=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1})=>{if(!e)return null;const o=p=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[p]||p,c=p=>({multiple_choice:"",true_false:"",input:"",matching_type:""})[p]||"",d=(p,g)=>{switch(g){case"multiple_choice":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[p.option_a&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),l.jsx("span",{className:"text-gray-700",children:p.option_a})]}),p.option_b&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),l.jsx("span",{className:"text-gray-700",children:p.option_b})]}),p.option_c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),l.jsx("span",{className:"text-gray-700",children:p.option_c})]}),p.option_d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),l.jsx("span",{className:"text-gray-700",children:p.option_d})]}),p.option_e&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),l.jsx("span",{className:"text-gray-700",children:p.option_e})]}),p.option_f&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:p.option_f})]})]})]});case"true_false":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),l.jsx("span",{className:"text-gray-700",children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},f=(p,g)=>{if(!p.correct_answer)return null;let y="";switch(g){case"multiple_choice":y=p.correct_answer.toUpperCase();break;case"true_false":y=p.correct_answer?"True":"False";break;case"input":y=p.correct_answer;break;case"matching_type":y=typeof p.correct_answer=="object"?JSON.stringify(p.correct_answer):p.correct_answer;break;default:y=String(p.correct_answer)}return l.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[l.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),l.jsx("p",{className:"text-green-700 font-mono",children:y})]})};return l.jsx(wi,{children:l.jsxs(Xe.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[l.jsx(Xe.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs(Xe.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("span",{className:"text-2xl",children:c(r)}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[o(r),"  ",a.length," Questions"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ze,{onClick:()=>window.print(),variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Print"}),l.jsx(Ze,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),l.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):a.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),l.jsx("p",{className:"text-gray-500",children:"This test doesn't have any questions yet."})]}):l.jsx("div",{className:"space-y-6",children:a.map((p,g)=>l.jsxs(Xe.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1,duration:.3},children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",g+1]}),l.jsx("span",{className:"text-gray-500 text-sm",children:o(r)})]})}),l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:p.question||p.question_text})}),d(p,r),f(p,r)]},p.id||p.question_id||g))})}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[l.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&l.jsxs("span",{children:["Showing ",a.length," question",a.length!==1?"s":""]})}),l.jsx("div",{className:"flex items-center space-x-3",children:l.jsx(Ze,{onClick:t,variant:"primary",className:"flex items-center space-x-2",children:"Close"})})]})]})})]})})},Wj=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i=""})=>{const o=t>0?Math.round(e/t*100):0,c=t-e,d=g=>{const y=Math.floor(g/3600),v=Math.floor(g%3600/60),w=g%60;return y>0?`${y}:${v.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}`:`${v}:${w.toString().padStart(2,"0")}`},f=g=>g>=100?"bg-green-500":g>=80?"bg-blue-500":g>=60?"bg-yellow-500":g>=40?"bg-orange-500":"bg-red-500",p=g=>g>=100?"text-green-600":g>=80?"text-blue-600":g>=60?"text-yellow-600":g>=40?"text-orange-600":"text-red-600";return l.jsxs("div",{className:`bg-white rounded-lg shadow-lg p-6 ${i}`,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Progress"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsx("span",{className:"text-sm font-mono text-gray-600",children:d(r)})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Progress"}),l.jsxs("span",{className:`text-sm font-semibold ${p(o)}`,children:[o,"%"]})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:l.jsx(Xe.div,{className:`h-full ${f(o)} transition-colors duration-300`,initial:{width:0},animate:{width:`${o}%`},transition:{duration:.5,ease:"easeOut"}})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-blue-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:e}),l.jsx("div",{className:"text-xs text-blue-600",children:"Answered"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-gray-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:c}),l.jsx("div",{className:"text-xs text-gray-600",children:"Remaining"})]}),l.jsxs("div",{className:"text-center p-2 sm:p-3 bg-purple-50 rounded-lg",children:[l.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:t}),l.jsx("div",{className:"text-xs text-purple-600",children:"Total"})]})]}),l.jsx("div",{className:"mb-4",children:e===t?l.jsx(Xe.div,{className:"flex items-center justify-center p-3 bg-green-50 border border-green-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-green-600 font-medium",children:" All questions answered! Ready to submit."})}):c===1?l.jsx(Xe.div,{className:"flex items-center justify-center p-3 bg-yellow-50 border border-yellow-200 rounded-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:"text-yellow-600 font-medium",children:"Almost there! 1 question remaining."})}):l.jsx("div",{className:"flex items-center justify-center p-3 bg-gray-50 border border-gray-200 rounded-lg",children:l.jsxs("span",{className:"text-gray-600 font-medium",children:[c," questions remaining"]})})}),a&&l.jsx("div",{className:"flex justify-center",children:l.jsx(Xe.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold text-white transition-all duration-300 ${s?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl"}`,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Test"})]})})})]})},GW=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:c})=>{if(console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i),!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(bt,{className:"max-w-md w-full",children:l.jsxs(bt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load fill blanks test data"}),l.jsx(Ze,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[d,f]=C.useState({}),[p,g]=C.useState(!1),[y,v]=C.useState(null),[w,b]=C.useState(null),[E,k]=C.useState(!1),[_,N]=C.useState(null),{showNotification:A}=ba(),{makeAuthenticatedRequest:P}=Wi(),{user:R}=Mn(),{startTracking:T,stopTracking:D,getCheatingData:I,clearData:K}=$p("fill_blanks",n,R?.student_id||R?.id);Yy();const X=C.useCallback((re,M)=>{try{let W=re;if(typeof re=="string"&&re.startsWith("{"))try{const O=JSON.parse(re);O.root&&O.root.children&&(W=O.root.children.map(z=>z.children?z.children.map(Y=>Y.style&&Y.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":Y.text||"").join(""):"").join(" "))}catch(O){console.error("Error parsing Lexical JSON:",O)}let B=W;M.forEach((O,z)=>{const Y=`[${z+1}_________]`;B=B.replace("[BLANK_PLACEHOLDER]",Y)});const H=B.split(/(\[\d+_________\])/).map((O,z)=>O.match(/\[\d+_________\]/)?l.jsx("span",{className:"inline-block px-3 py-1 mx-1 bg-purple-100 text-purple-800 border-2 border-purple-400 rounded-lg font-mono font-bold shadow-sm",children:O},z):l.jsx("span",{children:O},z));return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:H})})}catch(W){return console.error("Error rendering text with blanks:",W),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[]),Z=C.useCallback((re,M)=>{try{let W=re;if(typeof re=="string"&&re.startsWith("{"))try{const O=JSON.parse(re);O.root&&O.root.children&&(W=O.root.children.map(z=>z.children?z.children.map(Y=>Y.style&&Y.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":Y.text||"").join(""):"").join(" "))}catch(O){console.error("Error parsing Lexical JSON:",O)}const B=[];M.forEach((O,z)=>{const Y=d[O.id],J=Y?O.options[Y.charCodeAt(0)-65]:null,te=J?l.jsx("span",{className:"inline-block px-3 py-2 bg-green-100 text-green-800 rounded-lg border-2 border-green-400 cursor-pointer hover:bg-green-200 hover:border-green-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>b(O.id),children:J},z):l.jsxs("span",{className:"inline-block px-3 py-2 bg-purple-100 text-purple-800 rounded-lg border-2 border-purple-400 cursor-pointer hover:bg-purple-200 hover:border-purple-500 transition-all duration-200 font-bold shadow-sm",onClick:()=>b(O.id),children:[z+1,"_________"]},z);B.push(te),W=W.replace("[BLANK_PLACEHOLDER]",`__BLANK_${O.id}__`)});const G=W.split(/__BLANK_\d+__/),H=[];for(let O=0;O<G.length;O++)G[O]&&H.push(l.jsx("span",{children:G[O]},`text-${O}`)),O<B.length&&H.push(B[O]);return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap",children:H})})}catch(W){return console.error("Error rendering text with inline blanks:",W),l.jsx("div",{className:"text-red-500",children:"Error loading test content"})}},[d]),oe=C.useCallback((re,M)=>{const W={...d,[re]:M};f(W),c&&c(re,M)},[d,c]),q=C.useCallback(re=>l.jsx("div",{className:"space-y-6",children:re.map((M,W)=>{const B=M.blank_options||M.options||[];M.correct_answers;const G=M.question_json||M.question||`Blank ${W+1}`;return console.log(` Blank ${W+1} question text:`,G),l.jsxs(bt,{className:"p-4",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",W+1]}),l.jsx("p",{className:"text-gray-600 mb-4",children:G})]}),l.jsx("div",{className:"space-y-3",children:B.filter(H=>H&&H.trim().length>0).map((H,O)=>l.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[l.jsx("input",{type:"radio",name:`blank_${M.question_id||M.id||W}`,value:String.fromCharCode(65+O),checked:d[M.question_id||M.id||W]===String.fromCharCode(65+O),onChange:z=>oe(M.question_id||M.id||W,z.target.value),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"}),l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"w-6 h-6 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+O)}),l.jsx("span",{className:"text-gray-700",children:H})]})]},O))})]},M.question_id||M.id||W)})}),[d,oe]);return C.useEffect(()=>{if(n&&R?.student_id){v(new Date),T(),console.log(" Anti-cheating tracking started for fill blanks test");const M=`test_progress_${R.student_id}_fill_blanks_${n}`,W=En(M);W&&(f(W.answers||{}),v(new Date(W.startTime)),console.log(" Fill blanks test progress restored:",W))}},[n,R?.student_id,t,T]),C.useEffect(()=>{if(y&&R?.student_id&&n){const re=setInterval(()=>{const M={answers:d,startTime:y.toISOString()},W=`test_progress_${R.student_id}_fill_blanks_${n}`;Nn(W,M,Fn.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(re)}},[y,d,R?.student_id,n]),C.useEffect(()=>()=>{D(),K(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[D,K]),C.useCallback(async()=>{g(!0);try{const re=t.length;let M=0;t.forEach((Ce,Oe)=>{const fe=d[Ce.id];fe&&fe===Ce.correct_answer&&M++});const W=M,B=re;console.log(` Fill Blanks Score: ${W}/${B} (${Math.round(W/B*100)}%)`);const G=new Date,H=y?Math.round((G-y)/1e3):0,O=y?y.toISOString():G.toISOString(),z=I();console.log(" Anti-cheating data for fill blanks submission:",z);const Y=R.student_id,J=`retest_assignment_id_${Y}_fill_blanks_${n}`,te=localStorage.getItem(J),ee={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:Y,parent_test_id:n,retest_assignment_id:te?Number(te):null,answers:d,score:W,maxScore:B,time_taken:H,started_at:O,submitted_at:G.toISOString(),caught_cheating:z.caught_cheating,visibility_change_times:z.visibility_change_times};console.log(" Submitting fill blanks test:",ee);const me=await(await P("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).json();if(me.success){if(A("Test submitted successfully!","success"),D(),K(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),R?.student_id&&(g0(R.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),R?.student_id){const Ce=`test_completed_${R.student_id}_fill_blanks_${n}`;localStorage.setItem(Ce,"true"),console.log(" Fill blanks test marked as completed in localStorage:",Ce);const Oe=`retest1_${Y}_fill_blanks_${n}`;localStorage.removeItem(Oe),localStorage.removeItem(J)}if(R?.student_id){const Ce=`student_results_table_${R.student_id}`;Nn(Ce,me,Fn.student_results_table),console.log(" Fill blanks test results cached with key:",Ce)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(W)},2e3)}else throw new Error(me.message||"Failed to submit test")}catch(re){console.error("Error submitting test:",re),A("Error submitting test. Please try again.","error")}finally{g(!1)}},[d,t,n,s,a,i,y,I,D,K,P,A,o,R]),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-4",children:l.jsxs(bt,{children:[p&&l.jsx(bt.Header,{children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[l.jsx(Tr,{size:"small"}),l.jsx("span",{children:"Submitting..."})]})})}),l.jsx(bt.Body,{children:r===!0?l.jsxs(l.Fragment,{children:[X(e,t),q(t)]}):l.jsx(l.Fragment,{children:Z(e,t)})}),r===!1&&w&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Select Answer"}),l.jsx("div",{className:"space-y-2",children:t.find(re=>re.id===w)?.options.filter(re=>re.trim().length>0).map((re,M)=>l.jsxs("button",{onClick:()=>{oe(w,String.fromCharCode(65+M)),b(null)},className:"w-full text-left px-4 py-2 hover:bg-gray-100 rounded-lg border border-gray-200",children:[l.jsxs("span",{className:"font-semibold text-blue-600 mr-2",children:[String.fromCharCode(65+M),")"]}),re]},M))}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx(Ze,{onClick:()=>b(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),l.jsx(bt.Footer,{children:l.jsx("div",{className:"flex gap-3"})})]})})};let VW=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const c0=new VW;window.tokenManager=c0;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{c0.init()}):c0.init());const zj=async(e,t,r,n,s)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,semester:n,academicPeriodId:s});const i=await(await c0.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&semester=${n}&academic_period_id=${s}`)).json();if(i.success)return console.log(" Teacher student results loaded:",i.results.length,"results"),console.log(" Students loaded:",i.students?.length||0,"students"),{success:!0,results:i.results,students:i.students||[],count:i.results.length,student_count:i.student_count||0};throw new Error(i.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},Hj=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await c0.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},KW=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await c0.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},qW=async(e,t,r,n,s,a={})=>{try{const i=await zj(e,t,r,n,s);if(!i.success)return i;let o=i.results;return a.subject&&(o=o.filter(c=>c.subject&&c.subject.toLowerCase().includes(a.subject.toLowerCase()))),a.testType&&(o=o.filter(c=>c.test_type===a.testType)),a.minScore!==void 0&&(o=o.filter(c=>c.score/c.max_score*100>=a.minScore)),a.maxScore!==void 0&&(o=o.filter(c=>c.score/c.max_score*100<=a.maxScore)),a.passed!==void 0&&(o=o.filter(c=>c.score>=c.passing_score===a.passed)),{success:!0,results:o,count:o.length,originalCount:i.results.length}}catch(i){return console.error("Error filtering teacher student results:",i),{success:!1,error:i.message,results:[]}}},XW=async(e,t,r={})=>{try{const n=await Hj(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},YW={getTeacherStudentResults:zj,getStudentResultsView:Hj,getClassSummary:KW,getTeacherStudentResultsFiltered:qW,getStudentResultsViewFiltered:XW};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QW=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JW=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),rN=e=>{const t=JW(e);return t.charAt(0).toUpperCase()+t.slice(1)},Gj=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),ZW=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ez={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=C.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>C.createElement("svg",{ref:c,...ez,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Gj("lucide",s),...!a&&!ZW(o)&&{"aria-hidden":"true"},...o},[...i.map(([d,f])=>C.createElement(d,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N0=(e,t)=>{const r=C.forwardRef(({className:n,...s},a)=>C.createElement(tz,{ref:a,iconNode:t,className:Gj(`lucide-${QW(rN(e))}`,`lucide-${e}`,n),...s}));return r.displayName=rN(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],nz=N0("download",rz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],az=N0("maximize-2",sz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],oz=N0("rotate-cw",iz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vj=N0("x",lz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],uz=N0("zoom-in",cz);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],fz=N0("zoom-out",dz),Io={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},Kj={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},Pd={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},nN={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},sN={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},cy={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},qj=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},hz=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?gz(t):t):e,gz=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},mz=(e,t=Date.now())=>{const r=qj(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>cy.COMPRESSION_THRESHOLD}},aN=(e,t,r)=>{const n=mz(t),s=qj(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>cy.MAX_MEMORY_KB&&(i=pz(a)),i.length>cy.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},pz=e=>e.map(t=>t.memoryUsage>cy.COMPRESSION_THRESHOLD?{...t,data:hz(t.data),compressed:!0}:t),iN=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?xz(r.data):[...r.data]:[]},xz=e=>[...e],oN=e=>e>0,lN=(e,t)=>e<t-1,yz=()=>({history:[],index:-1}),vz=()=>{const[e,t]=C.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=C.useState([]),[s,a]=C.useState([]),i=C.useCallback(A=>{t(P=>({...P,...A}))},[]),o=C.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),c=C.useCallback(A=>{const P={x:A.x,y:A.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(R=>({...R,isDrawing:!0,currentLine:[P]})):["line","rectangle","circle"].includes(e.currentTool)&&t(R=>({...R,isDrawing:!0,currentShape:{type:e.currentTool,startX:A.x,startY:A.y,endX:A.x,endY:A.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),d=C.useCallback(A=>{if(!e.isDrawing)return;const P={x:A.x,y:A.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(R=>({...R,currentLine:[...R.currentLine,P]})):e.currentShape&&t(R=>({...R,currentShape:{...R.currentShape,endX:A.x,endY:A.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),f=C.useCallback(()=>{if(!e.isDrawing)return;let A=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(A=[...r,e.currentLine],n(A)):e.currentShape&&(A=[...r,e.currentShape],n(A)),A!==r){const P=aN(e.drawingHistory,A,e.historyIndex);t(R=>({...R,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:P.history,historyIndex:P.index}))}else t(P=>({...P,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),p=C.useCallback(A=>Math.round(A*sN.ERASER_TO_THICKNESS_RATIO),[]),g=C.useCallback(A=>Math.round(A*sN.THICKNESS_TO_ERASER_RATIO),[]),y=C.useCallback(A=>{t(P=>({...P,currentThickness:A,eraserSize:p(A)}))},[p]),v=C.useCallback(A=>{t(P=>({...P,eraserSize:A,currentThickness:g(A)}))},[g]),w=C.useCallback(A=>{const P=aN(e.drawingHistory,A,e.historyIndex);t(R=>({...R,drawingHistory:P.history,historyIndex:P.index}))},[e.drawingHistory,e.historyIndex]),b=C.useCallback(()=>{if(oN(e.historyIndex)){const A=e.historyIndex-1,P=iN(e.drawingHistory,A);n([...P]),t(R=>({...R,historyIndex:A}))}},[e.historyIndex,e.drawingHistory]),E=C.useCallback(()=>{if(lN(e.historyIndex,e.drawingHistory.length)){const A=e.historyIndex+1,P=iN(e.drawingHistory,A);n([...P]),t(R=>({...R,historyIndex:A}))}},[e.historyIndex,e.drawingHistory]),k=C.useCallback(()=>{const A=yz();t(P=>({...P,drawingHistory:A.history,historyIndex:A.index}))},[]),_=oN(e.historyIndex),N=lN(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:c,continueDrawing:d,finishDrawing:f,handleThicknessChange:y,handleEraserSizeChange:v,saveToHistoryState:w,undo:b,redo:E,clearHistoryState:k,canUndoState:_,canRedoState:N}},cN={SCALE_DELTA:.05,CENTER_DELTA:20},Wh=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},bu=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},wz=(e,t)=>{if(e.length!==2||!t)return null;const r=Wh(e),n=Wh(t),s=bu(e),a=bu(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>cN.SCALE_DELTA?"zoom":o>cN.CENTER_DELTA?"pan":null},_z=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},Rh=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},no={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},uy={color:"#000000",thickness:2},uN=(e,t,r)=>({x:e.x,y:e.y,color:t||uy.color,thickness:r||uy.thickness}),bz=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||uy.color,thickness:s||uy.thickness}),Xj=(e,t,r,n,s,a)=>{const i=e-r,o=t-n,c=s-r,d=a-n,f=i*c+o*d,p=c*c+d*d;let g=-1;p!==0&&(g=f/p);let y,v;g<0?(y=r,v=n):g>1?(y=s,v=a):(y=r+g*c,v=n+g*d);const w=e-y,b=t-v;return Math.sqrt(w*w+b*b)},Sz=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},kz=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],c=n[i+1],d=Xj(e,t,o.x,o.y,c.x,c.y);d<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:d})}return s},Cz=(e,t,r,n)=>{const s=kz(t,r,n,e);return s.length===0?[e]:Sz(e,s)},Tz=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},dN=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=Cz(a,e,t,r);s.push(...i)}else a.type==="line"?Xj(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(Tz(e,t,r,a)||s.push(a));return s},Ez=(e,t,r,n,s,a,i,o,c)=>{const[d,f]=C.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),p=C.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),e.currentTool===no.PAN)return;const R=P.target.getStage(),T=Rh(P,R),D=uN(T,e.currentColor,e.currentThickness);e.currentTool===no.PENCIL?t(I=>({...I,isDrawing:!0,currentLine:[D]})):[no.LINE,no.RECTANGLE,no.CIRCLE].includes(e.currentTool)&&t(I=>({...I,isDrawing:!0,currentShape:bz(e.currentTool,T,T,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),g=C.useCallback(P=>{const R=dN(P.x,P.y,e.eraserSize,r);n(R),s(R)},[e.eraserSize,r,n,s]),y=C.useCallback(P=>{o&&(a(),w("Undo",P))},[o,a]),v=C.useCallback(P=>{c&&(i(),w("Redo",P))},[c,i]),w=C.useCallback((P,R)=>{const T=R.target.getStage(),D=Rh(R,T),I=new Konva.Circle({x:D.x,y:D.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});T.add(I),I.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{I.destroy()}})},[]),b=C.useCallback(P=>{if(P.evt.preventDefault(),P.evt.stopPropagation(),!e.isDrawing)return;const R=P.target.getStage(),T=Rh(P,R),D=uN(T,e.currentColor,e.currentThickness);e.currentTool===no.PENCIL?t(I=>({...I,currentLine:[...I.currentLine,D]})):e.currentShape&&t(I=>({...I,currentShape:{...I.currentShape,endX:T.x,endY:T.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),E=C.useCallback(P=>{P&&P.evt&&(P.evt.preventDefault(),P.evt.stopPropagation()),e.isDrawing&&(e.currentTool===no.PENCIL&&e.currentLine.length>0?n(R=>[...R,e.currentLine]):e.currentShape&&n(R=>[...R,e.currentShape]),t(R=>({...R,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),k=C.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const R=P.evt.touches;if(R.length===2)f({isActive:!0,type:"pan",lastDistance:Wh(R),lastCenter:bu(R)});else if(R.length===1)if(e.currentTool===no.ERASER){const T=P.target.getStage(),D=Rh(P,T);g(D)}else e.currentTool===no.UNDO?y(P):e.currentTool===no.REDO?v(P):p(P)},[Wh,bu,p,e.currentTool,g,y,v]),_=C.useCallback(_z(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const R=P.evt.touches;if(R.length===2&&d.isActive){const T=wz(R,d);if(T==="zoom"){const D=Wh(R),I=bu(R),K=D/d.lastDistance,X=Math.max(.25,Math.min(1,e.zoom*K));t(Z=>({...Z,zoom:X,position:{x:I.x-(I.x-Z.position.x)*(X/Z.zoom),y:I.y-(I.y-Z.position.y)*(X/Z.zoom)}}))}else if(T==="pan"){const D=bu(R),I=D.x-d.lastCenter.x,K=D.y-d.lastCenter.y;t(X=>({...X,position:{x:X.position.x+I,y:X.position.y+K}}))}f(D=>({...D,lastDistance:Wh(R),lastCenter:bu(R)}))}else if(R.length===1)if(e.currentTool===no.ERASER){const T=P.target.getStage(),D=Rh(P,T),I=dN(D.x,D.y,e.eraserSize,r);n(I)}else if(e.currentTool===no.PAN){const T=bu(R),D=T.x-d.lastCenter.x,I=T.y-d.lastCenter.y;t(K=>({...K,position:{x:K.position.x+D,y:K.position.y+I}})),f(K=>({...K,lastCenter:T}))}else b(P)}),[d,e.zoom,t,b]),N=C.useCallback(P=>{_(P)},[_]),A=C.useCallback(P=>{P.evt.preventDefault(),P.evt.stopPropagation();const R=P.evt.touches;R.length===0?(E(P),f({isActive:!1,type:null,lastDistance:null,lastCenter:null})):R.length===1&&f(T=>({...T,isActive:!1}))},[E]);return{handleTouchStart:k,handleTouchMove:N,handleTouchEnd:A,handleEraserStart:g,handleUndoTouch:y,handleRedoTouch:v,showTouchFeedback:w}},Nz=(e,t)=>{const[r,n]=C.useState(e.MIN),[s,a]=C.useState({x:0,y:0}),i=C.useCallback((g,y,v)=>{const w=Math.max(e.MIN,Math.min(e.MAX,g));if(y){const b=w/r,E={x:y.x-(y.x-s.x)*b,y:y.y-(y.y-s.y)*b};return{zoom:w,position:E}}else{const b=t.width*w,E=t.height*w,k={x:(v.width-b)/2,y:(v.height-E)/2};return{zoom:w,position:k}}},[r,s,e,t]),o=C.useCallback(()=>{const g=Math.min(r*(1+e.STEP),e.MAX);n(g)},[r,e]),c=C.useCallback(()=>{const g=Math.max(r/(1+e.STEP),e.MIN);n(g)},[r,e]),d=C.useCallback((g,y,v)=>{const w=i(g,y,v);n(w.zoom),a(w.position)},[i]),f=C.useCallback((g,y)=>{a(v=>({x:v.x+g,y:v.y+y}))},[]),p=C.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:c,handleZoomToPoint:d,handlePan:f,resetZoom:p}},Az=e=>{const[t,r]=C.useState([]),[n,s]=C.useState(0),a=C.useCallback(p=>{if(console.log("parseDrawingData - input drawing:",p),console.log("parseDrawingData - drawing.answers:",p?.answers),!p?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof p.answers=="string"){console.log("parseDrawingData - parsing string answers");const g=JSON.parse(p.answers);return console.log("parseDrawingData - parsed string result:",g),g&&typeof g=="object"&&g.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),g}if(p.answers&&typeof p.answers=="object"&&p.answers.lines)return console.log("parseDrawingData - answers is new format object"),p.answers;if(Array.isArray(p.answers)){if(console.log("parseDrawingData - answers is array"),p.answers.every(y=>typeof y=="string"))try{const y=p.answers.map(v=>{try{return JSON.parse(v)}catch{return v}});return console.log("parseDrawingData - parsed array elements"),y}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),p.answers}return p.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(g){return console.error("Error parsing drawing data:",g),[]}},[]),i=C.useCallback(p=>{if(console.log("processQuestions - input answers:",p),console.log("processQuestions - answers type:",typeof p),console.log("processQuestions - answers isArray:",Array.isArray(p)),p&&typeof p=="object"&&p.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",p.lines?.length),console.log("processQuestions - textBoxes count:",p.textBoxes?.length);const y=o(p.lines);return console.log("processQuestions - canvas groups:",y),console.log("processQuestions - number of canvas groups:",y.length),y.map((v,w)=>(console.log(`processQuestions - canvas ${w} strokes:`,v),console.log(`processQuestions - canvas ${w} stroke count:`,v.length),{questionNumber:w+1,drawingData:v,textBoxes:p.textBoxes||[]}))}if(Array.isArray(p)&&p.every(y=>y&&typeof y=="object"&&y.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),p.map((y,v)=>({questionNumber:v+1,drawingData:y.lines||[],textBoxes:y.textBoxes||[]}));if(!Array.isArray(p))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",p.length,"answers (old format)");const g=o(p);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((y,v)=>(console.log(`processQuestions - canvas ${v} strokes:`,y),console.log(`processQuestions - canvas ${v} stroke count:`,y.length),{questionNumber:v+1,drawingData:y,textBoxes:[]}))},[]),o=C.useCallback(p=>{console.log("groupStrokesByCanvas - input answers:",p);const g=c(p);return console.log("groupStrokesByCanvas - using strategy:",g),g==="by_question_boundary"?d(p):g==="by_stroke_type"?f(p):[p]},[]),c=C.useCallback(p=>{console.log("determineGroupingStrategy - analyzing answers:",p);let g=0,y=0;return p.forEach(v=>{Array.isArray(v)?g++:typeof v=="object"&&y++}),console.log("determineGroupingStrategy - arrayCount:",g,"objectCount:",y),g>0&&y>0?"by_stroke_type":p.length>3?"by_question_boundary":"single_canvas"},[]),d=C.useCallback(p=>{console.log("groupByQuestionBoundary - grouping answers:",p);const g=[];let y=[];const v=Math.ceil(p.length/2);for(let w=0;w<p.length;w++)y.push(p[w]),(w+1)%v===0&&w<p.length-1&&(g.push([...y]),y=[]);return y.length>0&&g.push(y),console.log("groupByQuestionBoundary - result:",g),g},[]),f=C.useCallback(p=>{console.log("groupByStrokeType - grouping answers:",p);const g=[],y=[];p.forEach(w=>{Array.isArray(w)?g.push(w):typeof w=="object"&&y.push(w)});const v=[];return g.length>0&&v.push(g),y.length>0&&v.push(y),console.log("groupByStrokeType - result:",v),v},[]);return C.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const p=a(e);console.log("useDataParsing - parsed answers:",p),console.log("useDataParsing - parsed answers type:",typeof p),console.log("useDataParsing - parsed answers length:",p?.length);const g=i(p);console.log("useDataParsing - processed questions:",g),console.log("useDataParsing - processed questions length:",g?.length),g.length>0&&(console.log("useDataParsing - first question drawingData:",g[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",g[0]?.drawingData?.length)),r(g),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},fN={MIN:.25,INITIAL:1},jz=(e,t)=>{const[r,n]=C.useState(!1),[s,a]=C.useState(null),i=C.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:fN.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),o=C.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:fN.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},Yj=C.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:c,mousePosition:d,isMouseOverCanvas:f,isEraserDrawing:p},g)=>{const y=C.useRef(null),[v,w]=C.useState(.25),[b,E]=C.useState(null),[k,_]=C.useState({x:0,y:0}),[N,A]=C.useState(!1),P=C.useCallback(({x:G,y:H,size:O,visible:z,isDrawing:Y})=>!z||!G||!H?null:l.jsx(ju,{x:G,y:H,radius:O/2,stroke:nN.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:Y?.8:nN.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),R=C.useCallback(G=>{if(r.currentTool===Pd.ERASER){const H=G.target.getStage(),O=Rh(G,H);_(O)}},[r.currentTool]),T=C.useCallback(()=>{r.currentTool===Pd.ERASER&&A(!0)},[r.currentTool]),D=C.useCallback(()=>{A(!1)},[]);C.useEffect(()=>{const G=g.current;if(G)return G.on("mousemove",R),G.on("mouseenter",T),G.on("mouseleave",D),()=>{G.off("mousemove",R),G.off("mouseenter",T),G.off("mouseleave",D)}},[R,T,D,g]),C.useEffect(()=>{const G=n.width??n.WIDTH,H=n.height??n.HEIGHT,O=()=>{const z=y.current;if(!z)return;const Y=z.clientWidth||1,J=z.clientHeight||1,te=Math.abs(r.rotation%180)===90,ee=te?H:G,ie=te?G:H,me=Math.min(Y/(ee||1),J/(ie||1));w(Math.min(me,1))};return O(),window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const I=C.useMemo(()=>{const G=y.current;if(!G||!b)return 0;const H=G.clientWidth||1,O=G.clientHeight||1,z=Math.min(H/Math.max(b.width,1),O/Math.max(b.height,1));return Math.min(z,Kj.MAX)},[b]),K=C.useMemo(()=>Math.max(s,v||1),[s,v]),X=C.useMemo(()=>{const G=n.width??n.WIDTH,H=n.height??n.HEIGHT;if(!y.current)return{x:0,y:0};const O=y.current.clientWidth||1,z=y.current.clientHeight||1,Y=(O-G*K)/2,J=(z-H*K)/2;return s<=v?{x:Y,y:J}:{x:a.x!==void 0?a.x:Y,y:a.y!==void 0?a.y:J}},[a,s,v,K,n.width,n.height,b,I]);C.useEffect(()=>{if(!Array.isArray(e)||e.length===0){E(null);return}let G=1/0,H=1/0,O=-1/0,z=-1/0;const Y=(ie,me)=>{Number.isFinite(ie)&&Number.isFinite(me)&&(ie<G&&(G=ie),me<H&&(H=me),ie>O&&(O=ie),me>z&&(z=me))};if(e.forEach(ie=>{if(Array.isArray(ie))ie.forEach(me=>Y(me.x,me.y));else if(ie&&typeof ie=="object"){if(ie.type==="line")Y(ie.startX,ie.startY),Y(ie.endX,ie.endY);else if(ie.type==="rectangle")Y(ie.startX,ie.startY),Y(ie.endX,ie.endY);else if(ie.type==="circle"){const me=Math.sqrt(Math.pow(ie.endX-ie.startX,2)+Math.pow(ie.endY-ie.startY,2))/2,Ce=(ie.startX+ie.endX)/2,Oe=(ie.startY+ie.endY)/2;Y(Ce-me,Oe-me),Y(Ce+me,Oe+me)}}}),!Number.isFinite(G)||!Number.isFinite(H)||!Number.isFinite(O)||!Number.isFinite(z)){E(null);return}const J=16,te=Math.max(1,O-G+J*2),ee=Math.max(1,z-H+J*2);E({minX:G-J,minY:H-J,width:te,height:ee})},[e]),C.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),C.useEffect(()=>{const G=n.width??n.WIDTH,H=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:G,height:H}),console.log("CanvasViewer - zoom:",s,"fitZoom:",v,"displayScale:",K),console.log("CanvasViewer - stagePosition:",X)},[n,s,v,K,X]);const Z=(G,H)=>{if(console.log(`CanvasViewer - rendering element ${H}:`,G),Array.isArray(G))return console.log(`CanvasViewer - rendering line with ${G.length} points`),l.jsx(ma,{points:G.flatMap(O=>[O.x,O.y]),stroke:G[0]?.color||"#000000",strokeWidth:G[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},H);if(G.type==="line")return l.jsx(ma,{points:[G.startX,G.startY,G.endX,G.endY],stroke:G.color,strokeWidth:G.thickness,lineCap:"round"},H);if(G.type==="rectangle"){const O=Math.abs(G.endX-G.startX),z=Math.abs(G.endY-G.startY),Y=Math.min(G.startX,G.endX),J=Math.min(G.startY,G.endY);return l.jsx(ea,{x:Y,y:J,width:O,height:z,stroke:G.color,strokeWidth:G.thickness,fill:"transparent"},H)}else if(G.type==="circle"){const O=Math.sqrt(Math.pow(G.endX-G.startX,2)+Math.pow(G.endY-G.startY,2))/2,z=(G.startX+G.endX)/2,Y=(G.startY+G.endY)/2;return l.jsx(ju,{x:z,y:Y,radius:O,stroke:G.color,strokeWidth:G.thickness,fill:"transparent"},H)}return null},oe=()=>{if(!r.isDrawing)return null;if(r.currentTool===Pd.PENCIL&&r.currentLine.length>0)return l.jsx(ma,{points:r.currentLine.flatMap(G=>[G.x,G.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:G,startX:H,startY:O,endX:z,endY:Y,color:J,thickness:te}=r.currentShape;if(G===Pd.LINE)return l.jsx(ma,{points:[H,O,z,Y],stroke:J,strokeWidth:te,lineCap:"round"});if(G===Pd.RECTANGLE){const ee=Math.abs(z-H),ie=Math.abs(Y-O),me=Math.min(H,z),Ce=Math.min(O,Y);return l.jsx(ea,{x:me,y:Ce,width:ee,height:ie,stroke:J,strokeWidth:te,fill:"transparent"})}else if(G===Pd.CIRCLE){const ee=Math.sqrt(Math.pow(z-H,2)+Math.pow(Y-O,2))/2,ie=(H+z)/2,me=(O+Y)/2;return l.jsx(ju,{x:ie,y:me,radius:ee,stroke:J,strokeWidth:te,fill:"transparent"})}}return null},q=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},re={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},M=C.useCallback(G=>{G.preventDefault(),G.stopPropagation()},[]),W=C.useCallback(G=>{G.preventDefault(),G.stopPropagation()},[]),B=C.useCallback(G=>{G.preventDefault(),G.stopPropagation()},[]);return l.jsx("div",{style:{...q,touchAction:"none",WebkitTouchCallout:"none"},ref:y,className:"select-none",onTouchStart:M,onTouchMove:W,onTouchEnd:B,children:l.jsx("div",{style:{...re,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:M,onTouchMove:W,onTouchEnd:B,children:l.jsx(Qd,{ref:g,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:K,scaleY:K,x:X.x,y:X.y,onTouchStart:i,onTouchMove:o,onTouchEnd:c,children:l.jsxs(Yd,{children:[l.jsx(ea,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((G,H)=>(console.log(`CanvasViewer - mapping item ${H}:`,G),Z(G,H))),t&&t.map((G,H)=>l.jsx(ea,{x:G.x,y:G.y,width:G.width,height:G.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${H}`)),t&&t.map((G,H)=>l.jsx(Sl,{x:G.x+8,y:G.y+8,width:G.width-16,height:G.height-16,text:G.text,fontSize:G.fontSize||14,fill:G.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${H}`)),oe(),r.currentTool===Pd.ERASER&&l.jsx(P,{x:k.x,y:k.y,size:r.eraserSize,visible:N,isDrawing:p})]})})})})});Yj.displayName="CanvasViewer";function Fz({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=C.useState(1),[a,i]=C.useState({x:0,y:0}),o=C.useRef({width:1,height:1}),c=C.useRef(.01),d=C.useRef(0),f=C.useRef(!1),p=C.useCallback(()=>{const N=t?.width??t?.WIDTH??0,A=t?.height??t?.HEIGHT??0,P=Math.abs(r%180)===90;return{width:P?A:N,height:P?N:A}},[t,r]),g=C.useCallback(()=>{const N=e?.current;if(!N)return{width:1,height:1};const A=N.clientWidth||1,P=N.clientHeight||1;return o.current={width:A,height:P},{width:A,height:P}},[e]),y=C.useCallback(()=>{const{width:N,height:A}=o.current,{width:P,height:R}=p(),T=N/Math.max(P,1),D=A/Math.max(R,1);return Math.min(T,D,1)*.98},[p]),v=C.useCallback(N=>{const{width:A,height:P}=o.current,{width:R,height:T}=p(),D=Math.max(c.current,Math.min(N,1.5));let I=(A-R*D)/2,K=(P-T*D)/2;const X=A-R*D,Z=P-T*D;I=Math.min(Math.max(0,I),Math.max(0,X)),K=Math.min(Math.max(0,K),Math.max(0,Z));try{console.log("[Camera] centerAtScale",{targetScale:N,clampedScale:D,container:{containerW:A,containerH:P},canvas:{canvasW:R,canvasH:T},translate:{x:I,y:K},rotation:r})}catch{}i({x:I,y:K}),s(D)},[p]),w=C.useCallback(()=>{const{width:N,height:A}=g(),{width:P,height:R}=p(),T=y();let D=(N-P*T)/2,I=(A-R*T)/2;const K=N-P*T,X=A-R*T;D=Math.min(Math.max(0,D),Math.max(0,K)),I=Math.min(Math.max(0,I),Math.max(0,X));try{console.log("[Camera] fitCanvas",{scale:T,container:{containerW:N,containerH:A},canvas:{canvasW:P,canvasH:R},translate:{x:D,y:I},rotation:r})}catch{}s(T),i({x:D,y:I}),c.current=T,f.current=!1},[p,g,y]),b=C.useCallback(()=>{const{width:N,height:A}=g(),{width:P,height:R}=p(),T=(N-P)/2,D=(A-R)/2;s(1),i({x:T,y:D})},[p,g]),E=C.useCallback((N,A)=>{const{width:P,height:R}=o.current,{width:T,height:D}=p(),I=Math.max(c.current,Math.min(N,1.5));if(A&&Number.isFinite(A.x)&&Number.isFinite(A.y)){const K={x:(A.x-a.x)/n,y:(A.y-a.y)/n},X=A.x-K.x*I,Z=A.y-K.y*I;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:I})}catch{}s(I),i({x:X,y:Z}),d.current=Date.now()+400,f.current=!0}else{let K=(P-T*I)/2,X=(R-D*I)/2;const Z=P-T*I,oe=R-D*I;K=Math.min(Math.max(0,K),Math.max(0,Z)),X=Math.min(Math.max(0,X),Math.max(0,oe));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:I})}catch{}s(I),i({x:K,y:X}),d.current=Date.now()+400,f.current=!0}},[p,n,a]),k=C.useCallback((N,A)=>{const P=n*N,{width:R,height:T}=o.current,D={x:R/2,y:T/2};E(P,A||D)},[n,E]),_=C.useCallback((N,A)=>{i(P=>({x:P.x+N,y:P.y+A})),d.current=Date.now()+200,f.current=!0},[]);return C.useEffect(()=>{const N=e?.current;if(!N)return;const A=new ResizeObserver(()=>{g();const P=y();if(c.current=P,!(Date.now()<d.current)&&!f.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}v(n)}});return A.observe(N),g(),()=>A.disconnect()},[e,g,y,v,n]),C.useEffect(()=>{f.current=!1,c.current=y(),v(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,y,v,n]),C.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:v,fitCanvas:w,oneToOne:b,zoomTo:E,zoomByFactor:k,panBy:_}),[n,a,v,w,b,E,k,_])}const xm=new Map,Qj=C.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer"},i)=>{const o=C.useRef(null),c=C.useRef(null),d=Fz({containerRef:o,canvasSize:r,rotation:n}),[f,p]=C.useState({width:1,height:1}),g=C.useRef(null),y=C.useRef(null),[v,w]=C.useState(null);C.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),C.useEffect(()=>{typeof s=="function"&&s(d.scale);try{console.log("[ViewerCanvas] scale changed",{scale:d.scale})}catch{}if(a){const q=xm.get(a)||{};xm.set(a,{...q,scale:d.scale})}},[d.scale,s]),C.useEffect(()=>{if(a){const q=xm.get(a)||{};xm.set(a,{...q,translate:{x:d.translate.x,y:d.translate.y}})}},[a,d.translate.x,d.translate.y]),C.useImperativeHandle(i,()=>({zoomIn:q=>d.zoomByFactor(1.1,q),zoomOut:q=>d.zoomByFactor(1/1.1,q),fitCanvas:()=>d.fitCanvas(),oneToOne:()=>d.oneToOne(),getScale:()=>d.scale,getStage:()=>c.current,getPointerPosition:()=>c.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const q=c.current;if(!q)return null;const re=r?.width??r?.WIDTH??1536,M=r?.height??r?.HEIGHT??2048,W={scaleX:q.scaleX(),scaleY:q.scaleY(),x:q.x(),y:q.y(),width:q.width(),height:q.height()},B=g.current,G=y.current,H=B?{x:B.x(),y:B.y(),scaleX:B.scaleX(),scaleY:B.scaleY()}:null,O=G?{x:G.x(),y:G.y(),rotation:G.rotation()}:null;try{return q.scale({x:1,y:1}),q.position({x:0,y:0}),q.size({width:re,height:M}),B&&(B.position({x:0,y:0}),B.scale({x:1,y:1})),G&&(G.position({x:0,y:0}),G.rotation(0)),q.batchDraw(),q.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:re,height:M})}finally{G&&O&&(G.position({x:O.x,y:O.y}),G.rotation(O.rotation)),B&&H&&(B.position({x:H.x,y:H.y}),B.scale({x:H.scaleX,y:H.scaleY})),q.scale({x:W.scaleX,y:W.scaleY}),q.position({x:W.x,y:W.y}),q.size({width:W.width,height:W.height}),q.batchDraw()}}}),[d]),C.useEffect(()=>{const q=o.current;if(!q)return;const re=()=>{p({width:q.clientWidth||1,height:q.clientHeight||1})};re();const M=new ResizeObserver(re);return M.observe(q),()=>M.disconnect()},[]),C.useEffect(()=>{if(!Array.isArray(e)||e.length===0){w(null);return}let q=1/0,re=1/0,M=-1/0,W=-1/0;const B=(z,Y)=>{Number.isFinite(z)&&Number.isFinite(Y)&&(z<q&&(q=z),Y<re&&(re=Y),z>M&&(M=z),Y>W&&(W=Y))};if(e.forEach(z=>{if(Array.isArray(z))z.forEach(Y=>B(Y.x,Y.y));else if(z&&typeof z=="object"){if(z.type==="line")B(z.startX,z.startY),B(z.endX,z.endY);else if(z.type==="rectangle")B(z.startX,z.startY),B(z.endX,z.endY);else if(z.type==="circle"){const Y=Math.hypot(z.endX-z.startX,z.endY-z.startY)/2,J=(z.startX+z.endX)/2,te=(z.startY+z.endY)/2;B(J-Y,te-Y),B(J+Y,te+Y)}}}),!Number.isFinite(q)||!Number.isFinite(re)||!Number.isFinite(M)||!Number.isFinite(W)){w(null);return}const G=16,H=Math.max(1,M-q+G*2),O=Math.max(1,W-re+G*2);w({minX:q-G,minY:re-G,width:H,height:O,centerX:q-G+H/2,centerY:re-G+O/2})},[e]);const b=C.useMemo(()=>{if(!v)return{scale:1,x:0,y:0};const q=r?.width??r?.WIDTH??1536,re=r?.height??r?.HEIGHT??2048,M=Math.min(q/Math.max(1,v.width),re/Math.max(1,v.height),1),W=v.width*M,B=v.height*M,G=(q-W)/2,H=(re-B)/2,O=G-v.minX*M,z=H-v.minY*M;return{scale:M,x:O,y:z}},[v,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),E=C.useRef(!1);C.useEffect(()=>{if(E.current)return;const q=a?xm.get(a):null;q&&Number.isFinite(q.scale)&&q.translate&&Number.isFinite(q.translate.x)&&Number.isFinite(q.translate.y)?(d.setScale(q.scale),d.setTranslate(q.translate)):d.fitCanvas(),E.current=!0},[a,d]),C.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:d.scale,translate:d.translate})}catch{}d.fitCanvas()},[n]),C.useEffect(()=>{d.centerAtScale(d.scale)},[n]);const k=q=>{q.evt.preventDefault();const re=c.current;if(!re)return;const M=re.getPointerPosition(),W=Math.pow(1.0015,-q.evt.deltaY);d.zoomByFactor(W,M)},_=C.useRef(!1),N=C.useRef({x:0,y:0}),A=()=>{const q=o.current;if(!q)return 1;const re=q.clientWidth||1,M=q.clientHeight||1,W=r?.width??r?.WIDTH??1,B=r?.height??r?.HEIGHT??1,G=Math.abs(n%180)===90,H=G?B:W,O=G?W:B,z=Math.min(re/H,M/O);return Math.min(z,1)},P=q=>{const re=A();d.scale<=re||(_.current=!0,N.current={x:q.evt.clientX,y:q.evt.clientY})},R=q=>{if(!_.current)return;const re=q.evt.clientX-N.current.x,M=q.evt.clientY-N.current.y;N.current={x:q.evt.clientX,y:q.evt.clientY},d.panBy(re,M)},T=()=>{_.current=!1},D=1536,I=2048,K=(q,re)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${re}:`,q),Array.isArray(q))return console.log(`[ViewerCanvas] Array item with ${q.length} points:`,q.slice(0,3)),l.jsx(ma,{points:q.flatMap(M=>[M.x,M.y]),stroke:q[0]?.color||"#000000",strokeWidth:q[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},re);if(q?.type==="line")return l.jsx(ma,{points:[q.startX,q.startY,q.endX,q.endY],stroke:q.color,strokeWidth:q.thickness,lineCap:"round"},re);if(q?.type==="rectangle"){const M=Math.abs(q.endX-q.startX),W=Math.abs(q.endY-q.startY),B=Math.min(q.startX,q.endX),G=Math.min(q.startY,q.endY);return l.jsx(ea,{x:B,y:G,width:M,height:W,stroke:q.color,strokeWidth:q.thickness,fill:"transparent"},re)}else if(q?.type==="circle"){const M=Math.sqrt(Math.pow(q.endX-q.startX,2)+Math.pow(q.endY-q.startY,2))/2,W=(q.startX+q.endX)/2,B=(q.startY+q.endY)/2;return l.jsx(ju,{x:W,y:B,radius:M,stroke:q.color,strokeWidth:q.thickness,fill:"transparent"},re)}return null},X=C.useCallback(q=>{q.preventDefault(),q.stopPropagation()},[]),Z=C.useCallback(q=>{q.preventDefault(),q.stopPropagation()},[]),oe=C.useCallback(q=>{q.preventDefault(),q.stopPropagation()},[]);return l.jsx("div",{ref:o,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:X,onTouchMove:Z,onTouchEnd:oe,children:l.jsx(Qd,{ref:c,width:f.width,height:f.height,onWheel:k,onMouseDown:P,onMouseMove:R,onMouseUp:T,onMouseLeave:T,children:l.jsx(Yd,{children:l.jsx(Uo,{ref:g,x:d.translate.x,y:d.translate.y,scaleX:d.scale,scaleY:d.scale,children:(()=>{const q=(n%360+360)%360;let re=0,M=0;q===90?re=I:q===180?(re=D,M=I):q===270&&(M=D);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:q,tx:re,ty:M,canvasW:D,canvasH:I})}catch{}return l.jsxs(Uo,{ref:y,x:re,y:M,rotation:n,children:[l.jsx(ea,{x:0,y:0,width:D,height:I,fill:"white"}),l.jsxs(Uo,{x:b.x,y:b.y,scaleX:b.scale,scaleY:b.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((W,B)=>K(W,B))):null,Array.isArray(t)&&t.map((W,B)=>l.jsxs(Uo,{x:W.x,y:W.y,listening:!1,children:[l.jsx(ea,{width:W.width,height:W.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),l.jsx(Sl,{text:W.text,x:8,y:8,width:Math.max(0,(W.width||0)-16),height:Math.max(0,(W.height||0)-16),fontSize:W.fontSize||14,fill:W.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${B}`))]})]})})()})})})})});Qj.displayName="ViewerCanvas";const Pz=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[l.jsx(Ze,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:l.jsx(uz,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:l.jsx(fz,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:l.jsx(oz,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:l.jsx(nz,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(Ze,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?l.jsx(Vj,{className:"w-4 h-4 mx-auto my-auto"}):l.jsx(az,{className:"w-4 h-4 mx-auto my-auto"})})]}),Rz=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:l.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Ze,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),l.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),l.jsx(Ze,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),Jj=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1})=>{const{drawingState:i,setDrawingState:o,drawingData:c,setDrawingData:d,textBoxes:f,setTextBoxes:p,saveToHistoryState:g,undo:y,redo:v,canUndoState:w,canRedoState:b}=vz(),{questionsData:E,currentQuestionIndex:k,setCurrentQuestionIndex:_}=Az(e),{zoom:N,position:A,handleZoomIn:P,handleZoomOut:R}=Nz(Kj,Io),{isFullscreen:T,enterFullscreen:D,exitFullscreen:I}=jz(i,o),{handleTouchStart:K,handleTouchMove:X,handleTouchEnd:Z}=Ez(i,o,c,d,g,y,v,w,b),oe=C.useRef(null),q=C.useRef(null),[re,M]=C.useState(1),[W,B]=C.useState(""),[G,H]=C.useState("");C.useEffect(()=>{if(console.log("DrawingModal - questionsData:",E),console.log("DrawingModal - currentQuestionIndex:",k),E.length>0){const ie=E[k]?.drawingData||[],me=E[k]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",ie),console.log("DrawingModal - setting textBoxes:",me),d(ie),p(me)}},[E,k,d,p]),C.useEffect(()=>{t&&e&&(B(e.score?.toString()||""),H(e.max_score?.toString()||"100"))},[t,e]);const O=()=>{k>0&&_(k-1)},z=()=>{k<E.length-1&&_(k+1)},Y=()=>{w&&y()},J=()=>{b&&v()};C.useEffect(()=>{const ie=me=>{(me.ctrlKey||me.metaKey)&&(me.key==="z"&&!me.shiftKey?(me.preventDefault(),Y()):(me.key==="y"||me.key==="z"&&me.shiftKey)&&(me.preventDefault(),J()))};return document.addEventListener("keydown",ie),()=>document.removeEventListener("keydown",ie)},[Y,J]);const te=()=>{o(ie=>({...ie,rotation:(ie.rotation+90)%360}))},ee=()=>{if(a&&q.current){const Oe=q.current.exportPNGFullCanvas();if(!Oe)return;const fe=document.createElement("a");fe.href=Oe,fe.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(fe),fe.click(),document.body.removeChild(fe);return}const ie=oe.current;if(!ie)return;const me=ie.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:Io.WIDTH,height:Io.HEIGHT}),Ce=document.createElement("a");Ce.href=me,Ce.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(Ce),Ce.click(),document.body.removeChild(Ce)};return!t||!e?null:l.jsx(wi,{children:l.jsx(Xe.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:l.jsxs(Xe.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:ie=>ie.stopPropagation(),onTouchStart:ie=>ie.preventDefault(),onTouchMove:ie=>ie.preventDefault(),onTouchEnd:ie=>ie.preventDefault(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),l.jsx(Ze,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:l.jsx(Vj,{className:"w-5 h-5"})})]}),E.length>1&&l.jsx(Rz,{currentQuestion:k,totalQuestions:E.length,onPrevious:O,onNext:z,drawingDataLength:E[k]?.drawingData?.length||0}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[l.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?l.jsx(Qj,{ref:q,drawingData:c,textBoxes:f,canvasSize:{width:Io.WIDTH,height:Io.HEIGHT,WIDTH:Io.WIDTH,HEIGHT:Io.HEIGHT},rotation:i.rotation,onScaleChange:M}):l.jsx(Yj,{ref:oe,drawingData:c,textBoxes:f,drawingState:i,canvasSize:{width:Io.WIDTH,height:Io.HEIGHT,WIDTH:Io.WIDTH,HEIGHT:Io.HEIGHT},zoom:N,position:A,onTouchStart:K,onTouchMove:X,onTouchEnd:Z,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),l.jsx(Pz,{zoom:a?re:N,onZoomIn:()=>{if(a&&q.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:q.current.getScale?.()})}catch{}q.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:q.current.getScale?.()})}catch{}},0)}else P()},onZoomOut:()=>{if(a&&q.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:q.current.getScale?.()})}catch{}q.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:q.current.getScale?.()})}catch{}},0)}else R()},onRotate:te,onDownload:ee,onFullscreen:T?I:D,isFullscreen:T}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?re:N)*100),"%"]})]}),!1]})]})})})},Zj=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const c=Ti(),{user:d,isAuthenticated:f}=Mn(),{testResults:p,loadTestResults:g}=Wp(),[y,v]=C.useState(!0),[w,b]=C.useState(""),[E,k]=C.useState([]),[_,N]=C.useState([]),[A,P]=C.useState(null),[R,T]=C.useState([]),[D,I]=C.useState(0),[K,X]=C.useState(0),[Z,oe]=C.useState(!1),[q,re]=C.useState(null);C.useEffect(()=>{M()},[e,t]),C.useEffect(()=>{!e&&!t&&(p&&p.results?(console.log(" Using cached test results from TestContext"),N(p.results),v(!1)):B())},[e,t,p]);const M=C.useCallback(async()=>{console.log(" Initializing Student Results...");try{if(v(!0),b(""),!f||!d){console.log(" User not authenticated"),b("User not authenticated");return}if(d.role!==ri.STUDENT){console.error(" Invalid user role for student results:",d.role),b("Access denied. Student role required.");return}console.log(" Loading test results..."),await g(d?.student_id||d?.id||""),e&&t&&r&&(console.log(" Loading specific test results..."),await W(e,t,r)),console.log(" Student Results initialization complete!")}catch(te){console.error(" Error initializing student results:",te),b("Failed to initialize student results")}finally{v(!1)}},[f,d,e,t,r,g]),W=C.useCallback(async(te,ee,ie)=>{console.log(" Loading specific test results:",te,ee);try{const me=await Jr.getTestInfo(te,ee);console.log(" Test info loaded:",me),P(me);const Ce=await Jr.getTestQuestions(te,ee);console.log(" Test questions loaded:",Ce),T(Ce);const Oe=Du(Ce,ie,te).score,fe=Ce.length>0?Math.round(Oe/Ce.length*100):0;I(Oe),X(fe),console.log(" Test results calculated:",{score:Oe,percentage:fe})}catch(me){throw console.error(" Error loading specific test results:",me),me}},[]),B=C.useCallback(async(te=0)=>{console.log(" Loading all student results using existing test results API...",te>0?`(retry ${te})`:"");try{if(!(d?.student_id||d?.sub))throw new Error("Student ID not found");const ie=await Jr.getStudentTestResults();if(ie.success){console.log(" All student results loaded:",ie.results.length,"results");const me=ie.results.map(Ce=>({...Ce,caught_cheating:Ce.caught_cheating||!1,visibility_change_times:Ce.visibility_change_times||0}));N(me),re(new Date),ie.results.length===0&&te===0&&(console.log(" No results found, retrying in 2 seconds..."),setTimeout(()=>{B(1)},2e3))}else throw new Error(ie.error||"Failed to load student results")}catch(ee){console.error(" Error loading all student results:",ee),b(ee.message)}},[d]),G=C.useCallback(te=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[te]||te,[]),H=C.useCallback(te=>{if(!te||te.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No results available"})});const ee=a?te:te.slice(0,o);return l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:"w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Result"}),l.jsx("th",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ee.map((ie,me)=>l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium text-gray-900",children:l.jsx("span",{className:"bg-blue-100 text-blue-800 px-0.5 sm:px-2 py-0.5 rounded text-xs",children:G(ie.subject)})}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-12 sm:max-w-none",children:ie.teacher_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500 truncate max-w-16 sm:max-w-none",children:ie.test_name}),l.jsx("td",{className:"px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-gray-500",children:l.jsx("div",{className:"flex flex-col items-center space-y-1",children:ie.test_type==="drawing"?ie.score!==null?l.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ie.score/ie.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ie.score/ie.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ie.score,"/",ie.max_score," (",Math.round(ie.score/ie.max_score*100),"%)"]}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):ie.test_type==="speaking"?ie.score!==null?l.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ie.score/ie.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ie.score/ie.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ie.score,"/",ie.max_score," (",Math.round(ie.score/ie.max_score*100),"%)"]}):l.jsx("span",{className:"px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold bg-gray-100 text-gray-800",children:"Pending Review"}):l.jsxs("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold ${Math.round(ie.score/ie.max_score*100)>=80?"bg-green-100 text-green-800":Math.round(ie.score/ie.max_score*100)>=60?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[ie.score,"/",ie.max_score," (",Math.round(ie.score/ie.max_score*100),"%)"]})})}),l.jsx("td",{className:"hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:new Date(ie.submitted_at).toLocaleDateString()})]},me))})]}),te.length>o&&i&&l.jsx("div",{className:"text-center pt-4",children:l.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${te.length-o} More`})})]})},[G,a,o,i]),O=C.useCallback((te,ee)=>{if(console.log(" formatAnswer called with:",{answer:te,testType:ee,answerType:typeof te}),!te)return"No answer";switch(ee){case"true_false":const ie=typeof te=="boolean"?te:te==="true";return console.log(" Boolean answer processed:",ie),ie?"True":"False";case"multiple_choice":return te.toUpperCase();case"input":return te;case"word_matching":return typeof te=="object"?Object.entries(te).map(([me,Ce])=>`${me}  ${Ce}`).join(", "):te;case"drawing":return"Drawing submitted";default:return te}},[]),z=C.useCallback(()=>!A||!R||!r?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:["Test Results: ",A.test_name||A.title||"Test"]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-blue-600",children:D}),l.jsx("p",{className:"text-sm text-gray-500",children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-900",children:R.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Total Questions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-3xl font-bold ${K>=80?"text-green-600":K>=60?"text-yellow-600":"text-red-600"}`,children:[K,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Score"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Questions Review"}),l.jsx("div",{className:"space-y-4",children:R.map((te,ee)=>{const ie=r[ee],me=ip(te,e),Ce=l0(te,ie,e);return l.jsxs("div",{className:`border rounded-lg p-4 ${Ce?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsxs("h4",{className:"font-medium text-gray-900",children:["Question ",ee+1]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${Ce?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:Ce?"Correct":"Incorrect"})]}),l.jsx("p",{className:"text-gray-700 mb-3",children:te.question}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Your Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:O(ie,e)})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Correct Answer:"}),l.jsx("p",{className:"text-sm text-gray-900",children:O(me,e)})]})]})]},ee)})})]})]}),[A,R,r,e,D,K,ip,l0,O]),Y=C.useCallback(()=>{if(!_||_.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available yet."})});const te={};return _.forEach(ee=>{const ie=ee.subject||"Unknown Subject";te[ie]||(te[ie]=[]),te[ie].push(ee)}),l.jsx("div",{className:"space-y-6",children:Object.entries(te).map(([ee,ie])=>l.jsxs("div",{className:"bg-white rounded-lg shadow",children:[l.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ee})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Score"}),l.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:ie.map((me,Ce)=>{const Oe=Math.round(me.score/me.max_score*100),fe=Oe>=80?"text-green-600":Oe>=60?"text-yellow-600":"text-red-600";return l.jsxs("tr",{className:"hover:bg-gray-50",children:[l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:me.test_name}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:me.teacher_name||"Unknown"}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l.jsxs("span",{className:fe,children:[me.score,"/",me.max_score," (",Oe,"%)"]})}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(me.submitted_at).toLocaleDateString()})]},Ce)})})]})})]},ee))})},[_]);C.useCallback(()=>{console.log(" Clearing test data and returning to cabinet..."),P(null),T([]),setStudentAnswers(null),I(0),X(0),oe(!1),n?n():c("/student")},[n,c]);const J=C.useCallback(()=>{console.log(" Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return C.useCallback((te,ee)=>{const ie={id:Date.now(),message:te,type:ee,timestamp:new Date};k(me=>[...me,ie]),setTimeout(()=>{k(me=>me.filter(Ce=>Ce.id!==ie.id))},vi.NOTIFICATION_DURATION)},[]),y?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Student Results..."})]})}):w?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:w}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{children:[y?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Tr,{size:"md"}),l.jsx("p",{className:"mt-2 text-gray-600",children:"Loading results..."})]}):w?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-red-500 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-red-600",children:w})]}):H(_),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(te=>l.jsx(Vo,{type:te.type,message:te.message,onClose:()=>k(ee=>ee.filter(ie=>ie.id!==te.id))},te.id))})]}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",q?q.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[A&&l.jsx(Ze,{variant:"outline",onClick:()=>oe(!Z),children:Z?"Hide Details":"Show Details"}),l.jsx(Ze,{variant:"outline",onClick:J,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Z&&A?z():Y()}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:E.map(te=>l.jsx(Vo,{type:te.type,message:te.message,onClose:()=>k(ee=>ee.filter(ie=>ie.id!==te.id))},te.id))}),selectedDrawing&&l.jsx(Jj,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},Dz=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Ti(),{user:s,isAuthenticated:a,logout:i}=Mn(),{studentData:o,loadStudentData:c}=Qy(),{activeTests:d,testResults:f,loadActiveTests:p,loadTestResults:g,viewTestDetails:y,testDetailsModal:v,closeTestDetailsModal:w}=Wp(),[b,E]=C.useState(!0),[k,_]=C.useState(""),[N,A]=C.useState([]),[P,R]=C.useState(null),[T,D]=C.useState(!1),[I,K]=C.useState(null),[X,Z]=C.useState(null),[oe,q]=C.useState(new Set),[re,M]=C.useState(!1),[W,B]=C.useState(!1),[G,H]=C.useState(!1),[O,z]=C.useState(!1);C.useEffect(()=>{Y()},[]),C.useEffect(()=>()=>{H(!1)},[]),C.useEffect(()=>{if(G){const pe=setTimeout(()=>{H(!1)},1e3);return()=>clearTimeout(pe)}},[G]);const Y=C.useCallback(async()=>{console.log(" Initializing Student Cabinet...");try{if(E(!0),_(""),!a||!s){console.log(" User not authenticated, redirecting to login"),n("/login");return}if(s.role!==ri.STUDENT){console.error(" Invalid user role for student cabinet:",s.role),_("Access denied. Student role required.");return}console.log(" Loading student data..."),await c(),console.log(" Loading active tests...");try{localStorage.removeItem("student_active_tests_")}catch{}await p(),console.log(" Loading test results..."),await g(s?.student_id||s?.id||""),console.log(" Calculating average score..."),await J(),console.log(" Student Cabinet initialization complete!")}catch(pe){console.error(" Error initializing student cabinet:",pe),_("Failed to initialize student cabinet")}finally{E(!1)}},[a,s,n]),J=C.useCallback(async()=>{console.log(" Calculating average score...");try{if(f&&f.length>0){const pe=f.reduce((Ye,ot)=>typeof ot.score=="number"&&typeof ot.max_score=="number"&&ot.max_score>0?Ye+Math.round(ot.score/ot.max_score*100):Ye,0),He=Math.round(pe/f.length);Z(He),console.log(" Average score calculated:",He)}}catch(pe){console.error(" Error calculating average score:",pe)}},[f]);C.useEffect(()=>{if(G){console.log(" Skipping completed tests initialization during navigation");return}const pe=s?.student_id||s?.id;if(!pe){console.log(" Student ID not available yet, skipping localStorage initialization");return}const He=new Set;for(let Ye=0;Ye<localStorage.length;Ye++){const ot=localStorage.key(Ye);if(ot&&ot.startsWith(`test_completed_${pe}_`)&&localStorage.getItem(ot)==="true"){const Rt=ot.replace(`test_completed_${pe}_`,"").split("_");if(Rt.length>=2){const tt=Rt[0],Le=Rt.slice(1).join("_"),De=`${tt}_${Le}`;He.add(De),console.log(" Found completed test in localStorage:",De)}}}q(He),z(!0),console.log(" Initialized completed tests from localStorage:",Array.from(He))},[s?.student_id,s?.id,G]),C.useEffect(()=>{console.log(" testResults structure:",f);const pe=f?.results||f;if(console.log(" resultsArray:",pe),pe&&pe.length>0){const He=s?.student_id||s?.id||"",Ye=new Set;pe.forEach(ot=>{const Ve=`${ot.test_type}_${ot.test_id}`;Ye.add(Ve),localStorage.setItem(`test_completed_${He}_${ot.test_type}_${ot.test_id}`,"true")}),q(ot=>{const Ve=new Set([...ot,...Ye]);return console.log(" Updated completed tests (merged):",Array.from(Ve)),Ve})}},[f,s?.student_id,s?.id]);const te=C.useCallback(async(pe,He,Ye=!1,ot=null)=>{console.log(" Checking test completion:",pe,He,"retestAvailable:",Ye);try{const Ve=s?.student_id||s?.id||"";if(Ye){console.log(" Retest available from backend, checking attempt limits.");const De=[];for(let ht=1;ht<=10;ht++){const It=`retest_attempt${ht}_${Ve}_${pe}_${He}`;localStorage.getItem(It)==="true"&&De.push(It)}const Je=De.length,_t=ot?.retest_attempts_left||ot?.max_attempts||3;return console.log(" Current attempts:",Je,"Max attempts:",_t,"Attempt keys:",De),Je>=_t?(console.log(" Maximum retest attempts reached in localStorage"),!0):(console.log(" Retest attempts available, allowing start."),!1)}const Rt=`test_completed_${Ve}_${pe}_${He}`,tt=localStorage.getItem(Rt);if(console.log(" localStorage key:",Rt),console.log(" localStorage value:",tt),pe==="word_matching"){console.log(" Debug: All localStorage keys for student",Ve);for(let De=0;De<localStorage.length;De++){const Je=localStorage.key(De);Je&&Je.includes(Ve)&&Je.includes("word_matching")&&console.log(" Found word_matching key:",Je,"=",localStorage.getItem(Je))}}if(tt==="true")return console.log(" Found completion status in local storage:",tt),!0;const Le=f?.results||f;return Le&&Le.length>0&&(console.log(" Checking database results:",Le.length,"results"),Le.some(Je=>(console.log(" Checking result:",Je.test_type,Je.test_id,"vs",pe,He),Je.test_type===pe&&Je.test_id===He)))?(console.log(" Found completion status in database results"),localStorage.setItem(Rt,"true"),!0):(console.log(" Test not completed according to local storage or database"),!1)}catch(Ve){return console.error(" Error checking test completion:",Ve),!1}},[f,s?.student_id,s?.id]),ee=C.useCallback((pe,He)=>{const Ye={id:Date.now(),message:pe,type:He,timestamp:new Date};A(ot=>[...ot,Ye]),setTimeout(()=>{A(ot=>ot.filter(Ve=>Ve.id!==Ye.id))},vi.NOTIFICATION_DURATION)},[]),ie=C.useCallback(async pe=>{console.log(" Showing test details:",pe);try{await y(pe.test_type,pe.test_id,pe.test_name)}catch(He){console.error("Error loading test details:",He),ee("Failed to load test details","error")}},[y,ee]),me=C.useCallback(pe=>{console.log(" Starting test:",pe);const He=`${pe.test_type}_${pe.test_id}`;if(oe.has(He)&&!pe?.retest_available){ee("This test has already been completed","warning");return}if(console.log(" Checking retest conditions:"),console.log(" test.retest_available:",pe?.retest_available),console.log(" testKey:",He),console.log(" completedTests.has(testKey):",oe.has(He)),console.log(" completedTests:",Array.from(oe)),pe?.retest_available){const Ye=s?.student_id||s?.id||"",ot=`retest1_${Ye}_${pe.test_type}_${pe.test_id}`;if(localStorage.setItem(ot,"true"),console.log(" Set retest key:",ot),console.log(" Test retest_assignment_id:",pe.retest_assignment_id),console.log(" Test retest_assignment_id type:",typeof pe.retest_assignment_id),pe?.retest_assignment_id){const Ve=`retest_assignment_id_${Ye}_${pe.test_type}_${pe.test_id}`;localStorage.setItem(Ve,String(pe.retest_assignment_id)),console.log(" Set retest assignment ID:",Ve,"=",pe.retest_assignment_id)}else console.log(" No retest assignment ID found in test data")}else console.log(" Retest assignment ID storage skipped - retest not available");if(H(!0),console.log(" Set isStartingTest to true for test:",pe.test_type),pe.test_type==="matching_type"){console.log(" Redirecting to matching test page for testId:",pe.test_id),n(`/student/matching-test/${pe.test_id}`);return}if(pe.test_type==="word_matching"){console.log(" Redirecting to word matching test page for testId:",pe.test_id),n(`/student/word-matching-test/${pe.test_id}`);return}if(pe.test_type==="speaking"){console.log(" Redirecting to speaking test page for testId:",pe.test_id),n(`/student/speaking-test/${pe.test_id}`);return}n(`/student/test/${pe.test_type}/${pe.test_id}`)},[n,oe,ee,s?.student_id,s?.id]),Ce=C.useCallback(()=>{M(pe=>!pe)},[]),Oe=C.useCallback(()=>{B(pe=>!pe)},[]),fe=C.useCallback(async pe=>{if(console.log(" Starting test:",pe),G){console.log(" Test already starting, ignoring click");return}try{if(await te(pe.test_type,pe.test_id,pe?.retest_available,pe)&&!pe?.retest_available){ee("This test has already been completed","warning");return}me(pe)}catch(He){console.error(" Error starting test:",He),ee("Failed to start test. Please try again.","error")}},[te,me,ee,G]);return C.useCallback(pe=>{console.log(" Viewing test details:",pe),ie(pe)},[ie]),b?l.jsx(Xe.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsxs(Xe.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx(Tr,{size:"lg"}),l.jsx(Xe.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):k?l.jsx(Xe.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsx(Xe.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:l.jsxs(Xe.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[l.jsx(Xe.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),l.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-6",children:k}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs(Xe.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Xe.div,{className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(Xe.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Xe.div,{className:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:s?.name?.charAt(0)||"S"})})}),l.jsxs("div",{children:[l.jsxs("h1",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white",children:[s?.name," ",s?.surname]}),l.jsxs("p",{className:"text-blue-100 text-sm sm:text-base md:text-lg",children:["Grade ",s?.grade," - Class ",s?.class]})]})]}),l.jsxs(Xe.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:t,className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(Xe.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(wi,{children:e&&l.jsx(Xe.div,{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(Xe.button,{onClick:r,className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(Xe.button,{onClick:()=>{t(),i()},className:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),l.jsxs(Xe.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:l.jsx("div",{className:"lg:col-span-1 space-y-6",children:X!==null&&l.jsx(Xe.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:l.jsxs(bt,{children:[l.jsx(bt.Header,{children:l.jsx(bt.Title,{children:"Average Score"})}),l.jsx(bt.Body,{children:l.jsxs(Xe.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[l.jsxs(Xe.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[X,"%"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Overall Performance"})]})})]})})})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(bt,{children:[l.jsx(bt.Header,{children:l.jsx(bt.Title,{className:"text-center",children:"Active Tests"})}),l.jsx(bt.Body,{children:d&&d.length>0?l.jsxs("div",{className:"relative",children:[console.log(" Rendering overlay, isStartingTest:",G),G&&l.jsx("div",{className:"absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 border-blue-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Starting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait..."})]})}),l.jsxs("div",{className:"space-y-4",children:[(re?d:d.slice(0,3)).map((pe,He)=>l.jsx(Xe.div,{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:re?0:.7+He*.1,duration:.3},whileHover:{scale:1.02},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[l.jsx("h3",{className:"text-sm sm:text-lg font-medium text-gray-900 w-16 sm:w-auto break-words leading-tight line-clamp-2 sm:line-clamp-none",children:pe.test_name}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:pe.subject}),l.jsx("span",{className:"text-gray-500",children:pe.teacher_name}),l.jsxs("span",{className:"text-gray-500",children:[l.jsx("span",{className:"sm:hidden",children:new Date(pe.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}),l.jsx("span",{className:"hidden sm:inline",children:new Date(pe.assigned_at).toLocaleDateString()})]})]})}),l.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const Ye=`${pe.test_type}_${pe.test_id}`,ot=oe.has(Ye);return O?ot&&pe?.retest_available?l.jsx(Ze,{variant:"primary",size:"sm",onClick:()=>fe(pe),disabled:G,children:"Start Retest"}):ot?l.jsx(Ze,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(console.log(" Button render, isStartingTest:",G,"test:",pe.test_type),l.jsx(Ze,{variant:"primary",size:"sm",onClick:()=>fe(pe),disabled:G,children:"Start Test"})):l.jsx(Ze,{variant:"secondary",size:"sm",disabled:!0,className:"bg-gray-100 text-gray-500 border-gray-200",children:"Loading..."})})()})]})},`${pe.test_type}_${pe.test_id}`)),d.length>3&&l.jsx("div",{className:"text-center pt-2",children:l.jsx("button",{onClick:Ce,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:re?"Show Less":`Show ${d.length-3} More`})})]})]}):l.jsxs(Xe.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[l.jsx(Xe.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"},children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Active Tests"}),l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class at the moment."})]})})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(bt,{children:[l.jsx(bt.Header,{children:l.jsx(bt.Title,{children:"Test Results"})}),l.jsx(bt.Body,{children:f&&f.showResults?l.jsx(zp,{testResults:f,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(pe,He)=>{p(),setTestResults(null)},isLoading:b}):l.jsx(Zj,{compact:!0,showAll:W,onToggleShowAll:Oe,maxInitial:3})})]})})]})]}),l.jsx($j,{isOpen:v.isOpen,onClose:w,testType:v.testType,testId:v.testId,testName:v.testName,questions:v.questions||[],isLoading:v.isLoading||!1}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(pe=>l.jsx(Vo,{type:pe.type,message:pe.message,onClose:()=>A(He=>He.filter(Ye=>Ye.id!==pe.id))},pe.id))})]})},Iz=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o})=>{const[c,d]=C.useState(0),[f,p]=C.useState(0),[g,y]=C.useState(!0);if(C.useEffect(()=>{const b=()=>{try{const E=Du(t,n,r).score,k=e?.num_questions||t?.length||0,_=k>0?Math.round(E/k*100):0;d(E),p(_),y(!1)}catch(E){console.error("Error calculating test results:",E),d(0),p(0),y(!1)}};t&&t.length>0?b():y(!1)},[t,n,r,e,Du]),g)return l.jsx("div",{className:"flex justify-center items-center min-h-64",children:l.jsx("div",{className:"text-lg",children:"Calculating results..."})});const v=e?.num_questions||t?.length||0,w=e?.test_name||e?.title||"Test";return l.jsxs("div",{className:"test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen",children:[l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"results-header text-center",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Test Results: ",w]}),l.jsx("p",{className:"text-gray-600",children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"results-summary",children:[l.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 text-center",children:["Your Score: ",c," / ",v," (",f,"%)"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-4 mb-4",children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${f>=80?"bg-green-500":f>=60?"bg-yellow-500":"bg-red-500"}`,style:{width:`${f}%`}})}),l.jsx("div",{className:"text-center",children:l.jsx("p",{className:`text-lg font-medium ${f>=80?"text-green-600":f>=60?"text-yellow-600":"text-red-600"}`,children:f>=80?"Excellent!":f>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&l.jsx(bt,{className:"mb-6",children:l.jsxs("div",{className:"questions-review",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Question Review"}),l.jsx("div",{className:"space-y-4",children:t.map((b,E)=>{const k=n[String(b.question_id)]||"No answer";console.log(" TestResultsDisplay - Question",E+1,":",{question:b,studentAnswer:k,testType:r});const _=a(b,k,r);return console.log(" TestResultsDisplay - isCorrect result:",_),l.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${_?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[l.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[l.jsxs("h4",{className:"text-lg font-medium text-gray-800",children:["Question ",E+1]}),l.jsx("span",{className:`text-2xl font-bold ${_?"text-green-600":"text-red-600"}`,children:_?"":""})]}),l.jsx("div",{className:"question-text mb-3",children:l.jsx("p",{className:"text-gray-700 font-medium",children:b.question})}),l.jsxs("div",{className:"answer-section space-y-2",children:[l.jsxs("p",{className:"student-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Your Answer:"})," ",l.jsx("span",{className:`font-medium ${_?"text-green-700":"text-red-700"}`,children:i(k,r,b)})]}),!_&&l.jsxs("p",{className:"correct-answer",children:[l.jsx("strong",{className:"text-gray-600",children:"Correct Answer:"})," ",l.jsx("span",{className:"text-green-700 font-medium",children:r==="multiple_choice"?String(b.correct_answer||"").toUpperCase():i(o(b,r),r,b)})]})]})]},b.question_id||E)})})]})}),l.jsx(bt,{children:l.jsx("div",{className:"results-actions text-center",children:l.jsx(Ze,{onClick:s,className:"bg-blue-600 hover:bg-blue-700 text-white px-8 py-3 text-lg font-medium",children:"Back to Cabinet"})})})]})},Mz=({onBackToCabinet:e,currentTest:t})=>{const r=Ti(),{user:n,isAuthenticated:s}=Mn(),{activeTests:a,loadActiveTests:i}=Wp(),o=C.useCallback((Ie,at,gt)=>{try{const Ot=`test_progress_${n?.student_id||n?.id||"unknown"}_${Ie}_${at}`;localStorage.setItem(Ot,JSON.stringify(gt)),console.log(`Saved test progress for ${Ie}_${at}:`,gt)}catch(At){console.error("Error saving test progress:",At)}},[n?.student_id,n?.id]),c=C.useCallback((Ie,at)=>{try{const At=`test_progress_${n?.student_id||n?.id||"unknown"}_${Ie}_${at}`,Ot=localStorage.getItem(At);return Ot?JSON.parse(Ot):null}catch(gt){return console.error("Error getting test progress:",gt),null}},[n?.student_id,n?.id]),d=C.useCallback((Ie,at)=>{try{const gt=n?.student_id||n?.id||"unknown",At=`test_progress_${gt}_${Ie}_${at}`;localStorage.removeItem(At);for(let Ot=0;Ot<localStorage.length;Ot++){const Jt=localStorage.key(Ot);Jt&&Jt.startsWith(`test_progress_${gt}_${Ie}_${at}_`)&&(localStorage.removeItem(Jt),console.log(` Cleared individual question key: ${Jt}`))}console.log(`Cleared test progress for ${Ie}_${at}`)}catch(gt){console.error("Error clearing test progress:",gt)}},[n?.student_id,n?.id]),[f,p]=C.useState(!0),[g,y]=C.useState(!1),[v,w]=C.useState(""),[b,E]=C.useState(!1),[k,_]=C.useState(""),[N,A]=C.useState([]),[P,R]=C.useState(t?"test":"list"),[T,D]=C.useState(null),[I,K]=C.useState(null),[X,Z]=C.useState(null),[oe,q]=C.useState([]),[re,M]=C.useState([]),[W,B]=C.useState(0),[G,H]=C.useState(0),[O,z]=C.useState(null),Y=es.useRef(null),J=es.useRef(null),[te,ee]=C.useState(!1),[ie,me]=C.useState(!1),[Ce,Oe]=C.useState(null),[fe,pe]=C.useState(null),{startTracking:He,stopTracking:Ye,getCheatingData:ot,clearData:Ve,isCheating:Rt,tabSwitches:tt}=$p(T?.test_type,T?.test_id,n?.student_id||n?.id);C.useEffect(()=>{(()=>{const at=[];for(let gt=0;gt<localStorage.length;gt++){const At=localStorage.key(gt);if(At&&At.startsWith("test_progress_")&&!At.includes("_51712_")&&!At.includes("_51736_")){const Ot=At.split("_");Ot.length===4&&Ot[0]==="test"&&Ot[1]==="progress"&&at.push(At)}}at.forEach(gt=>{localStorage.removeItem(gt),console.log(" Cleared old cache key:",gt)})})()},[]),C.useEffect(()=>{Le()},[]),C.useEffect(()=>{t&&(console.log(" Auto-starting test from prop:",t),E(!0),_t(t))},[t]);const Le=C.useCallback(async()=>{console.log(" Initializing Student Tests...");try{if(p(!0),_(""),!s||!n){console.log(" User not authenticated"),_("User not authenticated");return}if(n.role!==ri.STUDENT){console.error(" Invalid user role for student tests:",n.role),_("Access denied. Student role required.");return}console.log(" Loading active tests..."),await i(),console.log(" Student Tests initialization complete!")}catch(Ie){console.error(" Error initializing student tests:",Ie),_("Failed to initialize student tests")}finally{p(!1)}},[s,n,i]);C.useCallback(async()=>{console.log(" Loading student active tests...");try{const Ie=await Jr.getActiveTests();console.log(" Active tests loaded:",Ie);const at=Ie.map(gt=>({...gt,subject_id:gt.subject_id||gt.subjectId,teacher_id:gt.teacher_id||gt.teacherId,is_active:gt.is_active!==void 0?gt.is_active:!0,created_at:gt.created_at||gt.createdAt,updated_at:gt.updated_at||gt.updatedAt}));return pe(new Date),at}catch(Ie){throw console.error(" Error loading active tests:",Ie),Ie}},[]),C.useCallback(async(Ie,at)=>{console.log(" Checking test completion:",Ie,at);try{const gt=c(Ie,at);return gt&&gt.completed}catch(gt){return console.error(" Error checking test completion:",gt),!1}},[c]),C.useEffect(()=>{if(oe.length>0&&T?.test_id){const Ie=setTimeout(()=>{let at=!1;const gt=new Array(oe.length).fill("");if(oe.forEach((At,Ot)=>{const Ae=`test_progress_${n?.student_id||n?.id||"unknown"}_${I}_${T?.test_id}_${At.question_id}`,ye=localStorage.getItem(Ae);if(ye){const he=ye.replace(/^"(.*)"$/,"$1");gt[Ot]=he,at=!0}}),at){M(gt);const At=gt.filter(Jt=>Jt&&typeof Jt=="string"&&Jt.trim()!=="").length,Ot=oe.length>0?At/oe.length*100:0;B(Ot)}},100);return()=>clearTimeout(Ie)}},[oe,I,T?.test_id]);const De=C.useCallback(async(Ie,at)=>{console.log(" Marking test as completed:",Ie,at);try{const gt=c(Ie,at)||{};gt.completed=!0,gt.completedAt=new Date().toISOString(),o(Ie,at,gt);const Ot=`test_completed_${n?.student_id||n?.id||""}_${Ie}_${at}`;localStorage.setItem(Ot,"true"),console.log(" Test completion marked in localStorage:",Ot),console.log(" localStorage value after setting:",localStorage.getItem(Ot)),pt("Test marked as completed","success")}catch(gt){console.error(" Error marking test as completed:",gt),pt("Failed to mark test as completed","error")}},[c,o]),Je=C.useCallback(Ie=>{console.log(" Showing test details:",Ie),Oe(Ie),me(!0)},[]),_t=C.useCallback(async Ie=>{console.log(" Starting test:",Ie);let at=Date.now(),gt;try{w(""),y(!0),at=Date.now();const At=()=>{const fr=Date.now()-at,Pr=Math.max(0,250-fr);setTimeout(()=>{p(!1),y(!1)},Pr)};let Ot=!1;gt=setTimeout(()=>{Ot=!0,w("Loading is taking longer than expected...")},15e3);const Ae=`test_completed_${n?.student_id||n?.id||""}_${Ie.test_type}_${Ie.test_id}`,ye=localStorage.getItem(Ae)==="true";if(ye&&!Ie?.retest_available){console.log(" Test already completed, redirecting to main cabinet"),pt("This test has already been completed","info"),r("/student");return}if(ye&&Ie?.retest_available&&console.log(" Test completed but retest available, allowing retest"),Ie.test_type===cn.MATCHING){console.log(" Redirecting to matching test page for testId:",Ie.test_id),r(`/student/matching-test/${Ie.test_id}`);return}if(Ie.test_type===cn.WORD_MATCHING){console.log(" Redirecting to word matching test page for testId:",Ie.test_id),r(`/student/word-matching-test/${Ie.test_id}`);return}D(Ie),K(Ie.test_type);const[he,_e]=await Promise.all([Jr.getTestInfo(Ie.test_type,Ie.test_id),Jr.getTestQuestions(Ie.test_type,Ie.test_id)]);Z(he);let $e=_e;try{if(!!he?.is_shuffled){const cr=n?.student_id||n?.id||"unknown",Pr=`${cr}:${Ie.test_type}:${Ie.test_id}`,Xr=Array.from(Pr).reduce((ge,ve)=>(ge<<5)-ge+ve.charCodeAt(0),0)>>>0,ue=`test_shuffle_order_${cr}_${Ie.test_type}_${Ie.test_id}`,ke=localStorage.getItem(ue);if(ke){const ge=JSON.parse(ke),ve=new Map(_e.map(Se=>[Se.question_id,Se]));$e=ge.map(Se=>ve.get(Se)).filter(Boolean)}else{const ve=function(Ee){return function(){var We=Ee+=1831565813;return We=Math.imul(We^We>>>15,We|1),We^=We+Math.imul(We^We>>>7,We|61),((We^We>>>14)>>>0)/4294967296}}(Xr);$e=[..._e];for(let Ee=$e.length-1;Ee>0;Ee--){const We=Math.floor(ve()*(Ee+1));[$e[Ee],$e[We]]=[$e[We],$e[Ee]]}const Se=$e.map(Ee=>Ee.question_id);localStorage.setItem(ue,JSON.stringify(Se))}}}catch(fr){console.error("Shuffle error (ignored):",fr)}q($e),At();let ct=c(Ie.test_type,Ie.test_id)?.answers||new Array(_e.length).fill("");_e.forEach((fr,cr)=>{const Xr=`test_progress_${n?.student_id||n?.id||"unknown"}_${Ie.test_type}_${Ie.test_id}_${fr.question_id}`,ue=localStorage.getItem(Xr);console.log(` Checking individual answer for question ${fr.question_id}:`,ue),ue&&(ct[cr]=ue,console.log(` Loaded individual answer for question ${fr.question_id}:`,ue))}),console.log(" Initial answers after loading individual saves:",ct),M(ct);const zt=ct.filter(fr=>fr&&typeof fr=="string"&&fr.trim()!=="").length,qt=_e.length>0?zt/_e.length*100:0;console.log(" Calculated progress:",zt,"answered out of",_e.length,"=",qt+"%"),B(qt);const Vt=Number(he?.allowed_time||0),gr=n?.student_id||n?.id||"unknown";if(Y.current=`test_timer_${gr}_${Ie.test_type}_${Ie.test_id}`,Vt>0)try{const fr=localStorage.getItem(Y.current),cr=Date.now();if(fr){const Pr=JSON.parse(fr),Xr=Math.floor((cr-new Date(Pr.lastTickAt).getTime())/1e3),ue=Math.max(0,Number(Pr.remainingSeconds||Vt)-Math.max(0,Xr));H(ue),J.current=cr}else H(Vt),J.current=cr,localStorage.setItem(Y.current,JSON.stringify({remainingSeconds:Vt,lastTickAt:new Date(cr).toISOString(),startedAt:new Date(cr).toISOString()}))}catch(fr){console.error("Timer cache init error:",fr),H(Vt)}else H(0);const Fr=new Date;z(Fr),console.log(" Test timer started at:",Fr.toISOString()),He(),console.log(" Anti-cheating tracking started"),R("test"),console.log(" Test started successfully")}catch(At){console.error(" Error starting test:",At),pt("Failed to start test","error"),w("Failed to load test data. Please try again.")}finally{const At=Date.now()-at,Jt=Math.max(0,250-At);setTimeout(()=>{p(!1),y(!1)},Jt),E(!1);try{gt&&clearTimeout(gt)}catch{}}},[c]),ht=C.useCallback(async()=>{if(!T||!X||!oe||!re){pt("No test data to submit","error");return}console.log(" Submitting test:",T);try{ee(!0);const Ie=Du(oe,re,T.test_type),at=new Date,gt=O?Math.round((at-O)/1e3):0,At=O?O.toISOString():at.toISOString();console.log(" Test timing:",{startedAt:At,endTime:at.toISOString(),timeTaken:`${gt} seconds`});const Ot=ot();console.log(" Anti-cheating data for submission:",Ot);const Jt={};oe.forEach((ye,he)=>{Jt[ye.question_id]=re[he]??""}),T.test_type==="drawing"&&(console.log(" Drawing test answers being submitted:",re),console.log(" Drawing test answers type:",typeof re[0]),console.log(" Drawing test answers content:",re[0]));const Ae=await Jr.submitTest(T.test_type,T.test_id,re,{time_taken:(()=>{const ye=Number(X?.allowed_time||0);return ye>0?Math.min(gt,ye):gt})(),started_at:At,submitted_at:at.toISOString(),answers_by_id:Jt,question_order:oe.map(ye=>ye.question_id),caught_cheating:Ot.caught_cheating,visibility_change_times:Ot.visibility_change_times,retest_assignment_id:(()=>{const he=`retest_assignment_id_${n?.student_id||n?.id||""}_${T.test_type}_${T.test_id}`,_e=localStorage.getItem(he);return console.log(" Frontend retest key:",he),console.log(" Frontend retest assignment ID from localStorage:",_e),console.log(" Frontend retest assignment ID converted:",_e?Number(_e):null),console.log(" Frontend current test data:",T),console.log(" Frontend current test retest_assignment_id:",T.retest_assignment_id),_e?Number(_e):null})(),parent_test_id:T.test_id},n);if(console.log(" Test submission result:",Ae),Ae.success){const ye=n?.student_id||n?.id||"",he=`retest1_${ye}_${T.test_type}_${T.test_id}`;if(localStorage.getItem(he)==="true"){const ct=T?.retest_attempts_left||T?.max_attempts||3;if((Ae?.percentage_score??0)>=50){const qt=`retest_attempt${ct}_${ye}_${T.test_type}_${T.test_id}`;localStorage.setItem(qt,"true"),console.log(" Passed retest, marking last-slot key:",qt),localStorage.removeItem(he)}else{let qt=1;for(let gr=1;gr<=10;gr++){const Fr=`retest_attempt${gr}_${ye}_${T.test_type}_${T.test_id}`;if(localStorage.getItem(Fr)!=="true"){qt=gr;break}}const Vt=`retest_attempt${qt}_${ye}_${T.test_type}_${T.test_id}`;localStorage.setItem(Vt,"true"),console.log(" Marked retest attempt as completed:",Vt),qt>=ct&&localStorage.removeItem(he)}}if(console.log(" Marking test as completed..."),await De(T.test_type,T.test_id),T.test_type!=="drawing"){console.log(" Caching test results after submission...");const zt=`student_results_table_${n?.student_id||n?.id||"unknown"}`,{setCachedData:qt,CACHE_TTL:Vt}=await Au(async()=>{const{setCachedData:gr,CACHE_TTL:Fr}=await Promise.resolve().then(()=>b2);return{setCachedData:gr,CACHE_TTL:Fr}},void 0);qt(zt,Ae,Vt.student_results_table),console.log(" Test results cached with key:",zt)}else console.log(" Drawing test submitted - not caching results (will appear after teacher grades)");console.log(" Clearing test progress..."),d(T.test_type,T.test_id);try{const ct=n?.student_id||n?.id||"unknown",zt=`test_timer_${ct}_${T.test_type}_${T.test_id}`;localStorage.removeItem(zt);const qt=`test_shuffle_order_${ct}_${T.test_type}_${T.test_id}`;localStorage.removeItem(qt)}catch{}if(n?.student_id){const ct=`test_completed_${n.student_id}_${T.test_type}_${T.test_id}`;localStorage.setItem(ct,"true"),console.log(" Test marked as completed in localStorage:",ct)}try{const ct=n?.student_id||n?.id||"",zt=`retest1_${ct}_${T.test_type}_${T.test_id}`,qt=`retest_assignment_id_${ct}_${T.test_type}_${T.test_id}`;localStorage.removeItem(zt),localStorage.removeItem(qt),console.log(" Cleared retest keys:",zt,qt)}catch(ct){console.warn("Failed to clear retest keys:",ct)}console.log(" Clearing test progress and anti-cheating data...");const $e=n?.student_id||n?.id||"unknown",St=[];for(let ct=0;ct<localStorage.length;ct++){const zt=localStorage.key(ct);zt&&(zt.startsWith(`test_progress_${$e}_`)||zt.startsWith(`anti_cheating_${$e}_`))&&St.push(zt)}St.forEach(ct=>{localStorage.removeItem(ct),console.log(` Cleared: ${ct}`)}),console.log(" Clearing anti-cheating data..."),Ye(),Ve(),T.test_type!=="drawing"?R("results"):r("/student"),pt("Test submitted successfully!","success"),console.log(" Test submitted successfully")}else throw console.error(" Test submission failed:",Ae.error),new Error(Ae.error||"Failed to submit test")}catch(Ie){console.error(" Error submitting test:",Ie),pt("Failed to submit test","error")}finally{ee(!1)}},[T,X,oe,re,De,d]);C.useCallback(()=>(console.log(" Collecting test answers..."),re),[re]);const It=C.useCallback(()=>{if(!oe||!re)return;const Ie=re.filter(gt=>gt&&typeof gt=="string"&&gt.trim()!=="").length,at=oe.length>0?Ie/oe.length*100:0;if(B(at),console.log(` Progress updated: ${Ie}/${oe.length} questions answered (${Math.round(at)}%)`),T){const gt={answers:re,progress:at,lastSaved:new Date().toISOString()};o(T.test_type,T.test_id,gt)}},[oe,re,T,o]);C.useEffect(()=>{It()},[It]);const Mt=C.useCallback(()=>{if(!re)return 0;const Ie=re.filter(at=>at&&typeof at=="string"&&at.trim()!=="").length;return console.log(" getAnsweredCount:",{studentAnswers:re,answeredCount:Ie,totalQuestions:oe?.length}),Ie},[re,oe]),rt=C.useCallback(()=>{console.log(" Navigating back to cabinet..."),e?e():r("/student")},[e,r]);C.useCallback(()=>{console.log(" Showing test results..."),R("results")},[]);const qe=C.useCallback((Ie,at,gt=null)=>{switch(console.log(" Formatting student answer for display:",Ie,"testType:",at,"question:",gt),at){case cn.MULTIPLE_CHOICE:if(Ie.toString().startsWith("Option "))return Ie;if(gt&&typeof Ie=="string"&&!isNaN(parseInt(Ie))){const At=parseInt(Ie),Ot=`option_${String.fromCharCode(97+At)}`,Jt=gt[Ot];if(Jt)return console.log(" Converted",Ie,"to option text:",Jt),Jt;{const Ae=String.fromCharCode(65+At);return console.log(" Converted",Ie,"to",Ae),Ae}}else{if(typeof Ie=="string"&&isNaN(parseInt(Ie)))return console.log(" Already formatted text:",Ie),Ie;{const At=String.fromCharCode(65+parseInt(Ie));return console.log(" Converted",Ie,"to",At),At}}case cn.TRUE_FALSE:return Ie==="true"?"True":"False";case cn.INPUT:return Ie;case cn.MATCHING:return typeof Ie=="object"?JSON.stringify(Ie):Ie;case cn.WORD_MATCHING:return typeof Ie=="object"?JSON.stringify(Ie):Ie;case cn.DRAWING:return Ie&&Ie.trim()!==""?"Drawing submitted":"No drawing";case cn.FILL_BLANKS:return Ie;default:return console.warn(" Unknown test type for answer formatting:",at),Ie}},[]),pt=C.useCallback((Ie,at)=>{const gt={id:Date.now(),message:Ie,type:at,timestamp:new Date};A(At=>[...At,gt]),setTimeout(()=>{A(At=>At.filter(Ot=>Ot.id!==gt.id))},vi.NOTIFICATION_DURATION)},[]);C.useEffect(()=>{It()},[It]),C.useEffect(()=>{if(P!=="test")return;const Ie=Number(X?.allowed_time||0);if(!Ie)return;const at=setInterval(()=>{H(gt=>{const At=Math.max(0,gt-1);try{const Ot=Date.now();J.current||(J.current=Ot),Y.current&&localStorage.setItem(Y.current,JSON.stringify({remainingSeconds:At,lastTickAt:new Date(Ot).toISOString(),startedAt:O?O.toISOString():new Date(Ot-(Ie-At)*1e3).toISOString()}))}catch{}return At===0&&ht(),At})},1e3);return()=>clearInterval(at)},[P,X?.allowed_time,ht,O]);const lt=C.useCallback((Ie,at)=>{if(!Ie)return null;const gt=(At,Ot)=>{const Jt=[...re];Jt[at]=Ot,M(Jt),console.log(` Answer changed: question ${At} = ${Ot}`),console.log(" Updated studentAnswers:",Jt)};switch(T.test_type){case cn.TRUE_FALSE:return l.jsx(PW,{question:Ie,questionIndex:at,studentAnswer:re[at]||"",onAnswerChange:gt,mode:"student",testId:T?.test_id,testType:I,displayNumber:at+1});case cn.MULTIPLE_CHOICE:return l.jsx(RW,{question:Ie,questionIndex:at,studentAnswer:re[at]||"",onAnswerChange:gt,mode:"student",testId:T?.test_id,testType:I,displayNumber:at+1});case cn.INPUT:return l.jsx(DW,{question:Ie,questionIndex:at,studentAnswer:re[at]||"",onAnswerChange:gt,mode:"student",testId:T?.test_id,testType:I,displayNumber:at+1});case cn.MATCHING:return console.error("Matching test reached renderQuestion - this should not happen"),l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),l.jsx(Ze,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case cn.DRAWING:return l.jsx(zW,{question:Ie,questionIndex:at,studentAnswer:re[at]||"",onAnswerChange:gt,mode:"student",testId:T?.test_id,testType:I});case cn.FILL_BLANKS:return at===0?l.jsx(GW,{testText:X?.test_text,blanks:(oe||[]).map((At,Ot)=>({id:At.question_id||Ot+1,options:At.blank_options||[],correct_answer:At.correct_answers?.[0]||At.correct_answer,question:At.question_json||""})),separateType:X?.separate_type,testId:T?.test_id,testName:X?.test_name||T?.test_name,teacherId:X?.teacher_id||T?.teacher_id,subjectId:X?.subject_id||T?.subject_id,onTestComplete:ht,onAnswerChange:(At,Ot)=>{const Jt=oe.findIndex(Ae=>Ae.question_id===At);if(Jt!==-1){const Ae=[...re];Ae[Jt]=Ot,M(Ae),console.log(` Fill Blanks answer changed: question ${At} = ${Ot}`)}}},`fill-blanks-${T?.test_id}-${X?.test_name}`):null;default:return l.jsx("div",{children:"Unsupported question type"})}},[T,re,I]);function wt(){return!T||!X||!oe?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:X.test_name||X.title||"Test"})}),l.jsx("div",{className:"mb-4",children:l.jsx(Wj,{answeredCount:Mt(),totalQuestions:oe.length,percentage:Math.round(W),timeElapsed:Number(X?.allowed_time||0)>0?G:0,showDetails:!0})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Answer all questions below:"}),l.jsx("div",{className:"space-y-8",children:oe.map((Ie,at)=>l.jsx("div",{className:"question-container",children:lt(Ie,at)},Ie.question_id||at))})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(Ze,{variant:"primary",size:"lg",onClick:ht,disabled:te||Mt()<oe.length,loading:te,children:te?"Submitting...":`Submit Test (${Mt()}/${oe.length})`})})]})}if(f)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(k)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:k}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs("div",{className:"min-h-screen bg-gray-50 overflow-y-auto",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Student Test"})}),l.jsx(Ze,{variant:"outline",onClick:rt,children:"Back to Cabinet"})]})})}),Rt&&P==="results"&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",tt," times during the test."]})})]})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&P==="list"&&Lt(),P==="test"&&wt(),P==="results"&&Ht()]}),P==="test"&&g&&l.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),v&&l.jsx("div",{className:"mt-3 text-sm text-gray-500",children:v})]}),l.jsx($j,{isOpen:ie,onClose:()=>me(!1),testType:Ce?.test_type,testId:Ce?.test_id,testName:Ce?.test_name,questions:Ce?.questions,isLoading:f}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:N.map(Ie=>l.jsx(Vo,{type:Ie.type,message:Ie.message,onClose:()=>A(at=>at.filter(gt=>gt.id!==Ie.id))},Ie.id))})]});function Lt(){return!a||a.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No active tests available for your class."})}):l.jsx("div",{className:"space-y-6",children:a.map((Ie,at)=>l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Ie.test_name}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm text-gray-600",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Subject:"})," ",Ie.subject]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Teacher:"})," ",Ie.teacher_name]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",Ie.test_type]})]}),l.jsxs("div",{className:"mt-2 text-sm text-gray-500",children:["Assigned: ",new Date(Ie.assigned_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Je(Ie),disabled:b||f,children:"View Details"}),l.jsx(Ze,{variant:"primary",onClick:()=>_t(Ie),disabled:b||f,children:b?"Starting...":"Start Test"})]})]})},at))})}function Ht(){if(!T||!X||!oe||!re)return null;const Ie={};return re.forEach((at,gt)=>{if(oe[gt]){const At=oe[gt].question_id||oe[gt].id||gt;Ie[String(At)]=at,console.log(" Converting answer:",{index:gt,questionId:At,answer:at,question:oe[gt]})}}),console.log(" Final answersObject:",Ie),console.log(" Questions structure:",oe.map(at=>({id:at.question_id,correct_answer:at.correct_answer}))),l.jsx(Iz,{testInfo:X,questions:oe,testType:T.test_type,studentAnswers:Ie,onBackToCabinet:rt,checkAnswerCorrectness:l0,formatStudentAnswerForDisplay:qe,getCorrectAnswer:ip})}},Oz=()=>{const{testId:e}=Ey(),t=Ti(),{user:r}=Mn(),{makeAuthenticatedRequest:n}=Wi(),{showNotification:s}=ba(),[a,i]=C.useState(null),[o,c]=C.useState(!0),[d,f]=C.useState(null),[p,g]=C.useState(null),[y,v]=C.useState(!1);$p("matching_type",a?.id);const w=C.useCallback(()=>{if(!r?.student_id||!e)return!1;const N=`test_completed_${r.student_id}_matching_type_${e}`,A=localStorage.getItem(N)==="true",P=`retest1_${r.student_id}_matching_type_${e}`,R=localStorage.getItem(P)==="true";return A&&!R?(console.log(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),b=C.useCallback(async()=>{if(!e){f("Test ID is required"),c(!1);return}if(!w())try{c(!0),f(null);const N=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!N.ok)throw new Error("Failed to load test data");const A=await N.json();if(!A.success)throw new Error(A.message||"Failed to load test");const P=A.data;console.log(" Test data from get-matching-type-test:",P);const R=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!R.ok)throw new Error("Failed to load test questions");const T=await R.json();if(!T.success)throw new Error(T.message||"Failed to load test questions");console.log(" Questions data from get-test-questions:",T);const D={id:P.test_id,test_name:P.test_name,teacher_id:P.teacher_id,subject_id:P.subject_id,image_url:P.image_url,image:null,blocks:(()=>{if(Array.isArray(T.questions)&&T.questions.length>0){const I=T.questions[0];return Array.isArray(I.blocks)?I.blocks.map((K,X)=>{let Z=K.block_coordinates||K.coordinates||(typeof K.x=="number"?{x:K.x,y:K.y,width:K.width,height:K.height}:null);if(typeof Z=="string")try{Z=JSON.parse(Z)}catch{Z=null}return(!Z||typeof Z!="object")&&(Z={x:0,y:0,width:30,height:10}),Z={x:(typeof Z.x=="number"?Z.x:Number(Z.x))||0,y:(typeof Z.y=="number"?Z.y:Number(Z.y))||0,width:(typeof Z.width=="number"?Z.width:Number(Z.width))||30,height:(typeof Z.height=="number"?Z.height:Number(Z.height))||10},{id:K.block_id||K.question_id||K.id||X+1,word:K.word||`Word ${X+1}`,coordinates:Z,hasArrow:!!K.has_arrow,arrow:K.arrow||null}}):T.questions.map(K=>{console.log(" Processing question:",K);let X;try{X=typeof K.block_coordinates=="string"?JSON.parse(K.block_coordinates):K.block_coordinates}catch{X={x:0,y:0,width:100,height:100}}return(!X||typeof X!="object")&&(X={x:0,y:0,width:100,height:100}),X={x:(typeof X.x=="number"?X.x:Number(X.x))||0,y:(typeof X.y=="number"?X.y:Number(X.y))||0,width:(typeof X.width=="number"?X.width:Number(X.width))||100,height:(typeof X.height=="number"?X.height:Number(X.height))||100},{id:K.question_id,word:K.word,coordinates:X,hasArrow:K.has_arrow,arrow:K.arrow}})}return[]})(),words:(()=>{if(Array.isArray(T.questions)&&T.questions.length>0){const I=T.questions[0];if(Array.isArray(I.words)){const K=I.words,X=Array.isArray(I.blocks)?I.blocks:[];return typeof K[0]=="string"?K.map((oe,q)=>({id:`w_${X[q]?.question_id||X[q]?.block_id||T.questions[q]?.question_id||q+1}_${q}`,word:String(oe),blockId:null,isPlaced:!1,isCorrect:!1})):K.map((oe,q)=>({id:`w_${oe.question_id||oe.id||q+1}_${q}`,word:oe.word||String(oe.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return T.questions.map(K=>({id:`w_${K.question_id}`,word:K.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:P.arrows?P.arrows.map(I=>(console.log(" Processing arrow:",I),{id:I.id,questionId:I.question_id,blockId:I.block_id||I.question_id,start:{x:Number(I.start_x)||0,y:Number(I.start_y)||0},end:{x:Number(I.end_x)||0,y:Number(I.end_y)||0},rel_start_x:I.rel_start_x!==null?Number(I.rel_start_x):null,rel_start_y:I.rel_start_y!==null?Number(I.rel_start_y):null,rel_end_x:I.rel_end_x!==null?Number(I.rel_end_x):null,rel_end_y:I.rel_end_y!==null?Number(I.rel_end_y):null,image_width:I.image_width?Number(I.image_width):null,image_height:I.image_height?Number(I.image_height):null,style:(typeof I.style=="string"?JSON.parse(I.style):I.style)||{color:"#dc3545",thickness:3}})):[]};if(P.image_url){const I=new Image;I.crossOrigin="anonymous",I.onload=()=>{D.image=I,i(D),c(!1)},I.onerror=()=>{console.warn("Failed to load test image"),i(D),c(!1)},I.src=P.image_url}else i(D),c(!1)}catch(N){console.error("Error loading test data:",N),f(N.message||"Failed to load test"),c(!1)}},[e,n]);C.useEffect(()=>{r?.student_id&&b()},[b,r?.student_id]);const E=C.useCallback(async N=>{console.log("Test completed:",N),s("Test completed successfully!","success");const A=parseInt(N)||0,P=a?.blocks?.length||a?.words?.length||0,R=P>0?Math.round(A/P*100):0,T={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"matching_type",score:A,totalQuestions:P,percentage:R,passed:R>=60,questionAnalysis:a?.questions?.map((D,I)=>({questionNumber:I+1,isCorrect:I<A,userAnswer:I<A?`Matched: ${D.word}`:"Not answered",correctAnswer:`Match: ${D.word}`}))||Array.from({length:P},(D,I)=>({questionNumber:I+1,isCorrect:I<A,userAnswer:I<A?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",T),g(T),v(!0)},[a,s]),k=C.useCallback(()=>{t("/student")},[t]),_=C.useCallback(()=>{v(!1),g(null),b()},[b]);return o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(bt,{className:"max-w-md w-full",children:l.jsxs(bt.Body,{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):d?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(bt,{className:"max-w-md w-full",children:l.jsxs(bt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:d}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):a?y&&p?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(zp,{testResults:p,onBackToCabinet:k,onRetakeTest:_,isLoading:!1})}):l.jsx(IW,{testData:a,onTestComplete:E,onBackToCabinet:k}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx(bt,{className:"max-w-md w-full",children:l.jsxs(bt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),l.jsx("button",{onClick:k,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},Lz=()=>{const{testId:e}=Ey(),t=Ti(),{user:r}=Mn(),{makeAuthenticatedRequest:n}=Wi(),{showNotification:s}=ba(),[a,i]=C.useState(null),[o,c]=C.useState(!0),[d,f]=C.useState(null),[p,g]=C.useState(null),[y,v]=C.useState(!1),w=C.useCallback(()=>{if(!r?.student_id||!e)return!1;const _=`test_completed_${r.student_id}_word_matching_${e}`,N=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(N)==="true"?!1:localStorage.getItem(_)==="true"},[r?.student_id,e]),b=C.useCallback(async()=>{if(!e){f("Test ID is required"),c(!1);return}if(w()){s("This test has already been completed","warning"),t("/student");return}c(!0),f(null);try{const _=`word_matching_test_${e}`,N=En(_);if(N){if(console.log(" Word matching test loaded from cache:",N),N.id){let R=N;if(Array.isArray(R.rightWords)&&Array.isArray(R.correctPairs)){const T=R.rightWords.map((X,Z)=>Z);for(let X=T.length-1;X>0;X--){const Z=Math.floor(Math.random()*(X+1));[T[X],T[Z]]=[T[Z],T[X]]}const D=T.map(X=>R.rightWords[X]),I=new Map(T.map((X,Z)=>[X,Z])),K=R.correctPairs.map(X=>I.get(X));R={...R,rightWords:D,correctPairs:K}}i(R)}else{let T={id:N.test_id,test_id:N.test_id,test_name:N.test_name,teacher_id:N.teacher_id,subject_id:N.subject_id,num_questions:N.num_questions,interaction_type:N.interaction_type,passing_score:N.passing_score,created_at:N.created_at,updated_at:N.updated_at,leftWords:N.leftWords,rightWords:N.rightWords,correctPairs:N.correctPairs,originalPairs:N.originalPairs};if(Array.isArray(T.rightWords)&&Array.isArray(T.correctPairs)){const D=T.rightWords.map((Z,oe)=>oe);for(let Z=D.length-1;Z>0;Z--){const oe=Math.floor(Math.random()*(Z+1));[D[Z],D[oe]]=[D[oe],D[Z]]}const I=D.map(Z=>T.rightWords[Z]),K=new Map(D.map((Z,oe)=>[Z,oe])),X=T.correctPairs.map(Z=>K.get(Z));T={...T,rightWords:I,correctPairs:X}}i(T)}c(!1);return}const P=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(P.success){const R={id:P.data.test_id,test_id:P.data.test_id,test_name:P.data.test_name,teacher_id:P.data.teacher_id,subject_id:P.data.subject_id,num_questions:P.data.num_questions,interaction_type:P.data.interaction_type,passing_score:P.data.passing_score,created_at:P.data.created_at,updated_at:P.data.updated_at,leftWords:P.data.leftWords,rightWords:P.data.rightWords,correctPairs:P.data.correctPairs,originalPairs:P.data.originalPairs};let T=R;if(Array.isArray(T.rightWords)&&Array.isArray(T.correctPairs)){const D=T.rightWords.map((Z,oe)=>oe);for(let Z=D.length-1;Z>0;Z--){const oe=Math.floor(Math.random()*(Z+1));[D[Z],D[oe]]=[D[oe],D[Z]]}const I=D.map(Z=>T.rightWords[Z]),K=new Map(D.map((Z,oe)=>[Z,oe])),X=T.correctPairs.map(Z=>K.get(Z));T={...T,rightWords:I,correctPairs:X}}i(T),Nn(_,T,Fn.word_matching_test),console.log(" Word matching test loaded from API and cached:",R)}else throw new Error(P.message||"Failed to load test")}catch(_){console.error("Error loading word matching test:",_),f(_.message),s("Failed to load test: "+_.message,"error")}finally{c(!1)}},[e,w,n,s,t]),E=C.useCallback(async _=>{console.log("Test completed:",_),s("Test completed successfully!","success");const N=parseInt(_)||0,A=a?.num_questions||0,P=A>0?Math.round(N/A*100):0,R={showResults:!0,testInfo:{test_name:a?.test_name||"Test",id:a?.id,test_id:a?.id},testType:"word_matching",score:N,totalQuestions:A,percentage:P,passed:P>=60,questionAnalysis:Array.isArray(a?.correctPairs)?a.correctPairs.map((T,D)=>({questionNumber:D+1,isCorrect:D<N,userAnswer:D<N?`${T.left}  ${T.right}`:"Not answered",correctAnswer:`${T.left}  ${T.right}`})):Array.from({length:A},(T,D)=>({questionNumber:D+1,isCorrect:D<N,userAnswer:D<N?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};console.log(" Using test results data:",R),g(R),v(!0)},[a,s]),k=C.useCallback(()=>{t("/student")},[t]);return C.useEffect(()=>{b()},[b]),o?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsxs(bt,{className:"p-8 text-center",children:[l.jsx(Tr,{size:"lg",className:"mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):d?l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(bt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-red-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:d}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):a?y&&p?l.jsx("div",{className:"bg-gray-50 overflow-y-auto min-h-screen",children:l.jsx(zp,{testResults:p,onBackToCabinet:()=>{g(null),v(!1),t("/student")},onRetakeTest:(_,N)=>{g(null),v(!1),b()},isLoading:!1})}):l.jsx(Xe.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"min-h-screen bg-gray-50 py-8",children:l.jsx(LW,{testData:a,onTestComplete:E,onBackToCabinet:k})}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(bt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-gray-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},Bz=C.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,maxAttempts:n=3,currentAttempt:s=1},a)=>{const[i,o]=C.useState(!1),[c,d]=C.useState(!1),[f,p]=C.useState(0),[g,y]=C.useState(null),[v,w]=C.useState(null),[b,E]=C.useState("good"),k=C.useRef(null),_=C.useRef([]),N=C.useRef(null),A=C.useRef(null),P=C.useRef(null),R=C.useRef(null),T=C.useRef(null);C.useImperativeHandle(a,()=>({startRecording:()=>D(),stopRecording:()=>I(),pauseRecording:()=>K(),resumeRecording:()=>X()}));const D=C.useCallback(async()=>{try{if(w(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser");console.log(" Requesting microphone permission...");const M=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0,sampleRate:44100}});console.log(" Microphone permission granted"),N.current=M;const W=new(window.AudioContext||window.webkitAudioContext),B=W.createAnalyser();W.createMediaStreamSource(M).connect(B),B.fftSize=256,P.current=W,R.current=B,Z();const H=new MediaRecorder(M,{mimeType:"audio/webm;codecs=opus"});k.current=H,_.current=[],H.ondataavailable=O=>{O.data.size>0&&_.current.push(O.data)},H.onstop=()=>{const O=new Blob(_.current,{type:"audio/webm"});y(O),e(O,f),N.current&&N.current.getTracks().forEach(z=>z.stop()),P.current&&P.current.close(),T.current&&cancelAnimationFrame(T.current)},H.start(1e3),o(!0),p(0),A.current=setInterval(()=>{p(O=>{const z=O+1;return z>=r&&I(),z})},1e3)}catch(M){console.error("Error starting recording:",M),M.name==="NotAllowedError"?w("Microphone access denied. Please allow microphone access in your browser settings and try again."):M.name==="NotFoundError"?w("No microphone found. Please connect a microphone and try again."):M.name==="NotSupportedError"?w("Microphone access is not supported in this browser. Please use a modern browser."):w(`Failed to access microphone: ${M.message}`)}},[r]),I=C.useCallback(()=>{if(k.current&&i&&(k.current.stop(),o(!1),d(!1),A.current&&clearInterval(A.current),f<t)){w(`Recording must be at least ${t} seconds long.`);return}},[i,f,t,g,e]),K=C.useCallback(()=>{k.current&&i&&!c&&(k.current.pause(),d(!0),A.current&&clearInterval(A.current))},[i,c]),X=C.useCallback(()=>{k.current&&i&&c&&(k.current.resume(),d(!1),A.current=setInterval(()=>{p(M=>{const W=M+1;return W>=r&&I(),W})},1e3))},[i,c,r,I]),Z=C.useCallback(()=>{if(!R.current)return;const M=R.current,W=new Uint8Array(M.frequencyBinCount),B=()=>{M.getByteFrequencyData(W);const G=W.reduce((H,O)=>H+O,0)/W.length;G<10?E("poor"):G<30?E("fair"):E("good"),i&&(T.current=requestAnimationFrame(B))};B()},[i]),oe=M=>{const W=Math.floor(M/60),B=M%60;return`${W}:${B.toString().padStart(2,"0")}`},q=()=>{switch(b){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},re=()=>{switch(b){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return l.jsxs("div",{className:"audio-recorder bg-white rounded-lg shadow-lg p-6",children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Record Your Response"}),l.jsx("p",{className:"text-gray-600",children:"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:oe(f)}),l.jsx("div",{className:`text-sm ${q()}`,children:re()}),c&&l.jsx("div",{className:"text-yellow-600 font-semibold mt-2",children:" Recording Paused"})]}),i&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(M,W)=>l.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},W))})}),l.jsx("div",{className:"flex justify-center space-x-4 mb-6",children:i?l.jsxs(l.Fragment,{children:[c?l.jsxs("button",{onClick:X,className:"bg-green-600 text-white px-6 py-3 rounded-full hover:bg-green-700 flex items-center space-x-2",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Resume"})]}):l.jsxs("button",{onClick:K,className:"bg-yellow-600 text-white px-6 py-3 rounded-full hover:bg-yellow-700 flex items-center space-x-2",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Pause"})]}),l.jsxs("button",{onClick:I,className:"bg-gray-600 text-white px-6 py-3 rounded-full hover:bg-gray-700 flex items-center space-x-2",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Stop & Submit"})]})]}):l.jsxs("button",{onClick:D,className:"bg-red-600 text-white px-6 py-3 rounded-full hover:bg-red-700 flex items-center space-x-2",children:[l.jsx("span",{className:"text-xl",children:""}),l.jsx("span",{children:"Start Recording"})]})}),l.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[l.jsx("h4",{className:"font-semibold mb-2",children:"Recording Requirements:"}),l.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[l.jsxs("li",{children:[" Minimum duration: ",t," seconds"]}),l.jsxs("li",{children:[" Maximum duration: ",r," seconds"]}),l.jsx("li",{children:" Speak clearly and at normal pace"}),l.jsx("li",{children:" Ensure good audio quality (green indicator)"})]})]}),v&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:v})}),l.jsxs("div",{className:"mt-4 text-center text-sm text-gray-600",children:["Attempt ",s," of ",n,s<n&&l.jsx("span",{className:"ml-2 text-blue-600",children:"(You can re-record if needed)"})]})]})}),e8=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const[s,a]=C.useState(!1),[i,o]=C.useState(0),[c,d]=C.useState(0),[f,p]=C.useState(1),[g,y]=C.useState(1),[v,w]=C.useState(!0),[b,E]=C.useState(""),[k,_]=C.useState(!1),[N,A]=C.useState(null),[P,R]=C.useState(!1),T=C.useRef(null),D=C.useRef(null),I=C.useRef(!1);C.useEffect(()=>()=>{I.current=!0},[]),C.useEffect(()=>{let B=!1;if(t)console.log("AudioPlayer: Using provided URL:",t),B||E(t);else if(e){if(!e||e.size===0){console.log("Invalid audio blob provided to AudioPlayer"),B||w(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),B||w(!1);return}console.log("AudioPlayer: Creating URL for blob:",{size:e.size,type:e.type,isBlob:e instanceof Blob});const G=URL.createObjectURL(e);return B||E(G),()=>{B=!0,console.log("AudioPlayer: Revoking URL"),URL.revokeObjectURL(G)}}return()=>{B=!0}},[e,t]),C.useEffect(()=>{let B=!1;async function G(H){if(!H||P||/\/object\/sign\//.test(H))return H;try{if((await fetch(H,{method:"HEAD"})).ok)return H;if(!P){const Y=new URL(H).pathname.replace(/^\/storage\/v1\/object\/public\//,""),J=Y.split("/")[0],te=Y.substring(J.length+1),ee=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(J)}&file_path=${encodeURIComponent(te)}`);if(ee.ok){const{url:ie}=await ee.json();return!B&&!I.current&&(R(!0),E(ie)),ie}}}catch{}return H}return(async()=>{if(t){const H=await G(t);!B&&!I.current&&!P&&E(H)}})(),()=>{B=!0}},[t,P]),C.useEffect(()=>{let B=!1;return b&&(B||(_(!1),A(null),w(!0))),()=>{B=!0}},[b]),C.useEffect(()=>{if(T.current&&b){const B=T.current;let G=!1;console.log("AudioPlayer: Setting up audio with URL:",b);try{B.src=b}catch{}B.load();const H=()=>{if(G||I.current)return;let fe=B.duration;if(console.log("Audio duration:",fe),console.log("Recording time prop:",r),fe===1/0)try{B.currentTime=1e101,B.ontimeupdate=()=>{if(G||I.current)return;B.ontimeupdate=null;const pe=B.duration;console.log("Fixed duration via seek trick:",pe),G||(d(isFinite(pe)&&pe>0?pe:0),B.currentTime=0,w(!1))};return}catch(pe){console.warn("Seek trick failed:",pe)}if(isNaN(fe)||!isFinite(fe)||fe<=0){const pe=B.seekable&&B.seekable.length>0&&isFinite(B.seekable.end(0)),He=!pe&&B.buffered&&B.buffered.length>0&&isFinite(B.buffered.end(B.buffered.length-1));pe?(fe=B.seekable.end(0),console.log("Using seekable end as duration fallback:",fe)):He&&(fe=B.buffered.end(B.buffered.length-1),console.log("Using buffered end as duration fallback:",fe))}isNaN(fe)||!isFinite(fe)||fe<=0?(console.warn("Invalid audio duration after fallbacks:",fe),r&&r>0?(console.log("Using recording time as fallback:",r),G||d(r)):G||d(0)):G||d(fe),G||w(!1)},O=()=>{G||I.current||H()},z=()=>{G||I.current||H()},Y=()=>{G||I.current||H()},J=()=>{G||I.current||H()},te=()=>{G||I.current||o(B.currentTime)},ee=()=>{G||I.current||(a(!1),o(0))},ie=()=>{G||I.current||a(!0)},me=()=>{G||I.current||a(!1)},Ce=fe=>{if(G||I.current)return;console.error("Audio loading error:",fe),console.error("Audio error details:",{error:B.error,networkState:B.networkState,readyState:B.readyState,src:B.src,currentSrc:B.currentSrc});const pe=B.error?.code;console.log("Audio error code:",pe,"MEDIA_ERR_SRC_NOT_SUPPORTED is 4"),pe===4?(console.log("Marking format as unsupported due to error code 4"),_(!0)):console.log("Not marking as unsupported, error code:",pe),A(B.error||{code:pe}),w(!1)},Oe=setTimeout(()=>{G||I.current||B.readyState===0&&(console.warn("AudioPlayer: Fallback timeout reached; stopping loader but not marking unsupported"),w(!1))},6e3);return B.addEventListener("loadedmetadata",O),B.addEventListener("durationchange",z),B.addEventListener("canplay",Y),B.addEventListener("canplaythrough",J),B.addEventListener("timeupdate",te),B.addEventListener("ended",ee),B.addEventListener("play",ie),B.addEventListener("pause",me),B.addEventListener("error",Ce),()=>{G=!0,clearTimeout(Oe),B.removeEventListener("loadedmetadata",O),B.removeEventListener("durationchange",z),B.removeEventListener("canplay",Y),B.removeEventListener("canplaythrough",J),B.removeEventListener("timeupdate",te),B.removeEventListener("ended",ee),B.removeEventListener("play",ie),B.removeEventListener("pause",me),B.removeEventListener("error",Ce),B.pause(),B.src="",B.load()}}},[b,r]),C.useEffect(()=>{let B=!1;return r&&r>0&&(isNaN(c)||!isFinite(c)||c<=0)&&(console.log("Updating duration from recordingTime prop:",r),B||d(r)),()=>{B=!0}},[r,c]);const K=()=>{console.log("Play button clicked, audioRef.current:",T.current),console.log("Audio src:",T.current?.src),console.log("Audio readyState:",T.current?.readyState),console.log("Audio networkState:",T.current?.networkState),T.current&&(s?(console.log("Pausing audio"),T.current.pause()):(console.log("Playing audio"),T.current.play().catch(B=>{console.error("Play failed:",B)})))},X=B=>{if(T.current&&D.current&&c>0){const G=D.current.getBoundingClientRect(),H=B.clientX-G.left,O=G.width,z=Math.max(0,Math.min(c,H/O*c));isFinite(z)&&z>=0&&(T.current.currentTime=z,o(z))}},Z=B=>{const G=parseFloat(B.target.value);p(G),T.current&&(T.current.volume=G)},oe=B=>{const G=parseFloat(B.target.value);y(G),T.current&&(T.current.playbackRate=G)},q=B=>{if(isNaN(B))return"0:00";const G=Math.floor(B/60),H=Math.floor(B%60);return`${G}:${H.toString().padStart(2,"0")}`};if(!e&&!t)return l.jsx("div",{className:`audio-player ${n}`,children:l.jsx("div",{className:"text-center text-gray-500 py-8",children:"No audio available"})});const M=(B=>{try{const H=(B||"").toLowerCase().split("?")[0].split("#")[0];return H.endsWith(".webm")?"audio/webm":H.endsWith(".mp3")?"audio/mpeg":H.endsWith(".m4a")?"audio/mp4":H.endsWith(".aac")?"audio/aac":H.endsWith(".wav")?"audio/wav":void 0}catch{return}})(b||t),W=es.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return console.log("AudioPlayer: URL analysis",{audioObjectUrl:b,audioUrl:t,guessedType:M,unsupportedFormat:k,loadError:N,webmSupported:W,canPlayWebM:typeof window<"u"?document.createElement("audio").canPlayType("audio/webm"):"unknown"}),l.jsxs("div",{className:`audio-player bg-gray-50 rounded-lg p-4 ${n}`,children:[l.jsx("audio",{ref:T,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:l.jsx("source",{src:b,type:M})}),v?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Loading audio..."})]}):k?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"This audio format isn't supported by your browser."}),b?l.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,M?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",M]}):null,l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Browser WebM support: ",W?"Yes":"No",!W&&" - Try using Chrome, Firefox, or Edge"]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Preferred format: WebM"})]}):N?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:"text-sm text-red-600",children:"Playback failed. Please try opening the audio directly."}),b?l.jsx("a",{href:b,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline text-sm",children:"Open in new tab"}):null,M?l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Detected type: ",M]}):null]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{ref:D,className:"w-full bg-gray-200 rounded-full h-2 cursor-pointer hover:h-3 transition-all",onClick:X,children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${i/c*100}%`}})}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-600 mt-1",children:[l.jsx("span",{children:q(i)}),l.jsx("span",{children:q(c)})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:K,className:"bg-blue-600 text-white p-2 rounded-full hover:bg-blue-700 transition-colors",children:s?l.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):l.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:f,onChange:Z,className:"w-16"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Speed:"}),l.jsxs("select",{value:g,onChange:oe,className:"text-sm border border-gray-300 rounded px-2 py-1",children:[l.jsx("option",{value:"0.5",children:"0.5x"}),l.jsx("option",{value:"0.75",children:"0.75x"}),l.jsx("option",{value:"1",children:"1x"}),l.jsx("option",{value:"1.25",children:"1.25x"}),l.jsx("option",{value:"1.5",children:"1.5x"}),l.jsx("option",{value:"2",children:"2x"})]})]})]}),l.jsxs("div",{className:"mt-3 text-xs text-gray-500 text-center",children:["Audio format: WebM  Duration: ",q(c)]})]})]})},Uz=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:o,maxAttempts:c,isSubmitting:d=!1})=>{const[f,p]=C.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const g=(b,E)=>{const k=b/E*100;return k>=80?"text-green-600":k>=60?"text-yellow-600":"text-red-600"},y=(b,E)=>{const k=b/E*100;return k>=90?"A+":k>=80?"A":k>=70?"B":k>=60?"C":k>=50?"D":"F"},v=()=>y(t?.overall_score||0,100),w=()=>g(t?.overall_score||0,100);return l.jsxs("div",{className:"feedback-display bg-white rounded-lg shadow-lg p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Speaking Test Results"}),l.jsx("p",{className:"text-gray-600",children:"Review your performance and decide whether to submit or re-record."})]}),l.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-6 rounded-lg mb-6",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-4xl font-bold ${w()}`,children:[t?.overall_score||0,"/100"]}),l.jsxs("div",{className:`text-2xl font-semibold ${w()} mt-2`,children:["Grade: ",v()]}),l.jsx("div",{className:"text-gray-600 mt-2",children:t?.overall_score>=80?"Excellent work!":t?.overall_score>=60?"Good job!":t?.overall_score>=50?"Not bad, but could be better.":"Keep practicing!"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Word Count"}),l.jsxs("span",{className:`font-bold ${g(t?.word_score||0,30)}`,children:[t?.word_score||0,"/30"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.word_count||0," words spoken"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${Math.min((t?.word_score||0)/30*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Grammar"}),l.jsxs("span",{className:`font-bold ${g(t?.grammar_score||0,40)}`,children:[t?.grammar_score||0,"/40"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.grammar_mistakes||0," mistakes found"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${Math.min((t?.grammar_score||0)/40*100,100)}%`}})})]}),l.jsxs("div",{className:"bg-white border rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Vocabulary"}),l.jsxs("span",{className:`font-bold ${g(t?.vocab_score||0,30)}`,children:[t?.vocab_score||0,"/30"]})]}),l.jsxs("div",{className:"text-sm text-gray-600",children:[t?.vocabulary_mistakes||0," vocabulary issues"]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:l.jsx("div",{className:"bg-purple-600 h-2 rounded-full",style:{width:`${Math.min((t?.vocab_score||0)/30*100,100)}%`}})})]})]}),r&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Your Recording"}),l.jsx(e8,{audioBlob:r,recordingTime:n})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Transcript"}),l.jsx("button",{onClick:()=>p(!f),className:"text-blue-600 hover:text-blue-800 text-sm",children:f?"Hide Details":"Show Details"})]}),l.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:l.jsx("p",{className:"text-gray-800 leading-relaxed",children:e})})]}),f&&l.jsxs("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg",children:[l.jsx("h4",{className:"font-semibold mb-3",children:"Detailed Analysis"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Word Count Analysis:"}),l.jsxs("span",{className:"ml-2 text-gray-700",children:["You spoke ",t?.word_count||0," words.",t?.word_count>=50?" Great job meeting the minimum requirement!":" Consider speaking more to meet the minimum word requirement."]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Grammar Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.grammar_mistakes===0?"Perfect grammar!":`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&l.jsxs("div",{className:"mt-2 ml-4",children:[l.jsxs("button",{onClick:()=>p(!f),className:"text-blue-600 hover:text-blue-800 text-sm underline",children:[f?"Hide":"Show"," detailed corrections"]}),f&&l.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((b,E)=>l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:"text-red-600 font-mono text-sm",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-600",children:b.original}),l.jsx("span",{className:"mx-2",children:""}),l.jsx("span",{className:"font-medium text-green-600",children:b.suggested})]}),l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("strong",{children:"Context:"}),' "...',b.context.before,l.jsx("span",{className:"bg-red-100",children:b.context.problem}),b.context.after,'..."']}),l.jsxs("div",{className:"text-xs text-blue-600 mt-1",children:[l.jsx("strong",{children:"Explanation:"})," ",b.explanation]})]})]})},E))})]})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Vocabulary Analysis:"}),l.jsx("span",{className:"ml-2 text-gray-700",children:t?.vocabulary_mistakes===0?"Excellent vocabulary usage!":`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`})]})]})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"text-sm text-gray-600",children:["Attempt ",o," of ",c]}),l.jsxs("div",{className:"flex space-x-4",children:[i&&l.jsxs("button",{onClick:s,className:"bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700 flex items-center space-x-2",children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Re-record"})]}),l.jsx("button",{onClick:a,disabled:d,className:`px-6 py-2 rounded-lg flex items-center space-x-2 ${d?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700"} text-white`,children:d?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),l.jsx("span",{children:"Submitting..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Submit Final"})]})})]})]}),!i&&l.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:l.jsxs("p",{className:"text-yellow-800 text-sm",children:[l.jsx("strong",{children:"Maximum attempts reached."}),' This is your final attempt. Click "Submit Final" to complete the test.']})})]})},$z=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=C.useState("recording"),[i,o]=C.useState(null),[c,d]=C.useState(""),[f,p]=C.useState(null),[g,y]=C.useState(!1),[v,w]=C.useState(null),[b,E]=C.useState(1),[k]=C.useState(e.max_attempts||3),[_,N]=C.useState(!1),[A,P]=C.useState(0),[R,T]=C.useState(0),[D,I]=C.useState(null),K=Wi(),{user:X}=Mn(),{makeAuthenticatedRequest:Z}=K,oe=C.useRef(null);C.useEffect(()=>{if(e&&!D){const H=new Date;I(H),console.log(" Speaking test timer started at:",H.toISOString())}},[e,D]),C.useEffect(()=>{let H=0;s==="recording"?H=25:s==="processing"?H=50:s==="feedback"?H=75:s==="completed"&&(H=100),T(H)},[s]),C.useEffect(()=>{(async()=>{try{console.log(" Automatically requesting microphone permission...");const O=await navigator.mediaDevices.getUserMedia({audio:!0});console.log(" Microphone permission granted!"),N(!0),O.getTracks().forEach(z=>z.stop())}catch(O){console.error(" Microphone permission denied:",O),w("Microphone access denied. Please allow microphone access and refresh the page.")}})()},[]),C.useEffect(()=>{const H=setInterval(()=>{i&&s==="recording"&&q()},3e4);return()=>clearInterval(H)},[i,s]);const q=C.useCallback(async()=>{try{const H={test_id:e.test_id,audio_blob:i?await re(i):null,attempt_number:b,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(H))}catch(H){console.error("Failed to save progress:",H)}},[e.test_id,i,b,s]),re=H=>new Promise((O,z)=>{const Y=new FileReader;Y.onloadend=()=>{const te=Y.result.split(",")[1];O(te)},Y.onerror=z,Y.readAsDataURL(H)}),M=C.useCallback(async(H,O)=>{console.log(" Recording completed, duration:",O),o(H),P(O),a("processing"),w(null);try{const z=await re(H),Y=new Date,J=e.start_time?Math.round((Y-e.start_time)/1e3):0,te=e.start_time?new Date(e.start_time).toISOString():Y.toISOString(),ee=X.student_id,ie=`retest_assignment_id_${ee}_speaking_${e.test_id}`,me=localStorage.getItem(ie),Ce={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:ee,question_id:e.question_id||1,audio_blob:z,audio_duration:H.duration||0,time_taken:J,started_at:te,submitted_at:Y.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:me?Number(me):null,parent_test_id:e.test_id};console.log(" Submitting speaking test:",Ce),console.log(" Processing audio with AI...");const fe=await(await Z("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e.test_id,audio_blob:z})})).json();if(fe.success)d(fe.transcript),p(fe.score_breakdown),a("feedback");else throw new Error(fe.message||"Failed to process audio with AI");localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(z){console.error("Speaking test submission error:",z),w(z.message),a("recording")}},[e,X,Z]),W=C.useCallback(()=>{b<k?(o(null),d(""),p(null),w(null),E(H=>H+1),a("recording")):w("Maximum attempts reached")},[b,k]),B=C.useCallback(async()=>{if(!(!c||!f)){y(!0);try{const H=new Date,O=e.start_time?Math.round((H-e.start_time)/1e3):0,z=e.start_time?new Date(e.start_time).toISOString():H.toISOString(),Y=X.student_id,J=`retest_assignment_id_${Y}_speaking_${e.test_id}`,te=localStorage.getItem(J),ee={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Y,question_id:e.question_id||1,audio_blob:i?await re(i):null,audio_duration:i?.duration||0,time_taken:O,started_at:z,submitted_at:H.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:te?Number(te):null,parent_test_id:e.test_id,transcript:c,scores:f,final_submission:!0};console.log(" Final submission:",ee),console.log(" Making final submission request...");const ie=await Z("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)});console.log(" Final submission response status:",ie.status);const me=await ie.json();if(console.log(" Final submission result:",me),me.success){if(X?.student_id){const ot=`test_completed_${X.student_id}_speaking_${e.test_id}`;localStorage.setItem(ot,"true"),console.log(" Speaking test marked as completed in localStorage:",ot)}console.log(" Caching speaking test results after submission...");const Oe=`student_results_table_${X?.student_id||X?.id||"unknown"}`,{setCachedData:fe,CACHE_TTL:pe,clearTestData:He}=await Au(async()=>{const{setCachedData:ot,CACHE_TTL:Ve,clearTestData:Rt}=await Promise.resolve().then(()=>b2);return{setCachedData:ot,CACHE_TTL:Ve,clearTestData:Rt}},void 0),Ye={success:!0,results:[{id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(f.overall_score/10),max_score:10,percentage:f.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),academic_period_id:3,subject:"Listening and Speaking",teacher_name:"Unknown"}]};fe(Oe,Ye,pe.student_results_table),console.log(" Speaking test results cached with key:",Oe),X?.student_id&&He(X.student_id,"speaking",e.test_id),a("completed"),t({test_id:e.test_id,transcript:c,scores:f,attempt_number:b}),n&&n(f.overall_score)}else throw new Error(me.message||"Failed to submit speaking test")}catch(H){console.error("Speaking test submission error:",H),w(H.message)}finally{y(!1)}}},[e,X,Z,c,f,i,b,t]);C.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:c,scores:f,attempt_number:b})},[e.test_id,c,f,b,t]);const G=()=>{switch(s){case"recording":return l.jsxs("div",{className:"speaking-test-recording",children:[l.jsxs("h2",{className:"text-2xl font-bold mb-4",children:["Speaking Test: ",e.test_name]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Instructions:"}),l.jsx("p",{className:"text-gray-700 mb-4",children:e.prompt}),l.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:l.jsxs("p",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),l.jsx(Bz,{ref:oe,onRecordingComplete:M,minDuration:0,maxDuration:e.max_duration||600,maxAttempts:k,currentAttempt:b}),v&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:v})})]});case"processing":return l.jsxs("div",{className:"transcription-status bg-white rounded-lg shadow-lg p-8 text-center",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-2xl font-semibold mb-2",children:"Processing Your Speech"}),l.jsx("p",{className:"text-lg text-blue-600",children:"Please wait while we process your audio..."})]}),l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce"}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),l.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),l.jsx(Uz,{transcript:c,scores:f,audioBlob:i,recordingTime:A,onReRecord:W,onFinalSubmit:B,canReRecord:b<k,attemptNumber:b,maxAttempts:k,isSubmitting:g});case"completed":const H={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:f?.overall_score||0,totalQuestions:1,percentage:f?.overall_score||0,passed:(f?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:c,correctAnswer:"Speaking test completed",isCorrect:!0,score:f?.overall_score||0,maxScore:100,feedback:`Word Count: ${f?.word_count||0}, Grammar: ${f?.grammar_score||0}/40, Vocabulary: ${f?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return l.jsx("div",{className:"speaking-test-completed",children:l.jsx(zp,{testResults:H,onBackToCabinet:r,onRetakeTest:()=>{a("recording"),d(""),p(null),o(null),E(1)},isLoading:!1})});default:return null}};return l.jsx("div",{className:"min-h-screen bg-gray-50 p-4",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:e.test_name}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Speaking Test"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-sm text-gray-500",children:["Attempt ",b," of ",k]}),s==="completed"&&l.jsx("div",{className:"text-green-600 font-semibold",children:" Completed"})]})]}),l.jsx("div",{className:"mt-4",children:l.jsx(Wj,{answeredCount:s==="completed"?1:0,totalQuestions:1,percentage:R,timeElapsed:D?Math.floor((Date.now()-D.getTime())/1e3):0,showDetails:!0})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[v&&l.jsx("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-800",children:v})}),G()]})]})})},Wz=()=>{const{testId:e}=Ey(),t=Ti(),{user:r}=Mn(),n=Wi(),[s,a]=C.useState(null),[i,o]=C.useState([]),[c,d]=C.useState(!0),[f,p]=C.useState(null),[g,y]=C.useState(!1),[v,w]=C.useState(null);C.useEffect(()=>{b(),E()},[e]);const b=async()=>{try{d(!0);const A=await n.getSpeakingTest(e);if(A.success)a(A.test);else throw new Error(A.message||"Failed to load test");const P=await n.getSpeakingTestQuestions(e);P.success&&o(P.questions)}catch(A){console.error("Error loading test data:",A),p(A.message)}finally{d(!1)}},E=()=>{const P=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(P)==="true"){y(!0);const T=localStorage.getItem(`speaking_test_result_${e}`);T&&w(JSON.parse(T))}},k=async A=>{try{y(!0),w(A),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(A)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(P){console.error("Error handling test completion:",P)}},_=()=>{t("/student")};if(c)return l.jsx("div",{className:"speaking-test-page min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),l.jsx("p",{className:"text-gray-600 mt-4",children:"Loading speaking test..."})]})});if(f)return l.jsx("div",{className:"speaking-test-page min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-red-600 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-6",children:f}),l.jsx("button",{onClick:_,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Return to Dashboard"})]})});if(g&&v)return l.jsx("div",{className:"speaking-test-page min-h-screen bg-gray-50",children:l.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-800 mb-4",children:" Back to Dashboard"}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Speaking Test Results"})]}),l.jsx(zp,{testType:"speaking",testData:s,result:v,onRetake:()=>{y(!1),w(null);const A=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${A}_speaking_${e}`)}})]})});if(!s||i.length===0)return l.jsx("div",{className:"speaking-test-page min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to load test information"}),l.jsx("button",{onClick:_,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"Return to Dashboard"})]})});const N=i[0];return l.jsx("div",{className:"speaking-test-page min-h-screen bg-gray-50",children:l.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[l.jsx("div",{className:"mb-6",children:l.jsx("button",{onClick:_,className:"text-blue-600 hover:text-blue-800 mb-4",children:" Back to Dashboard"})}),l.jsx($z,{testData:{...s,test_id:parseInt(e),question_id:N?.id,prompt:N?.prompt,start_time:Date.now()},onComplete:k,onExit:_,onTestComplete:k})]})})},zz=()=>{const{testType:e,testId:t}=Ey(),r=Ti(),{activeTests:n}=Wp(),s=()=>{r("/student")},a=n.find(i=>i.test_type===e&&i.test_id===parseInt(t));return l.jsx(Mz,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}})},Hz=()=>{const e=Ti(),{user:t,isAuthenticated:r,isLoading:n}=Mn(),[s,a]=C.useState(!1),[i,o]=C.useState(!0),[c,d]=C.useState(""),[f,p]=C.useState([]),[g,y]=C.useState(!1),[v,w]=C.useState(!1),[b,E]=C.useState({currentPassword:"",newPassword:"",confirmPassword:""}),k=C.useCallback(async()=>{console.log(" Initializing Student Application...");try{if(o(!0),d(""),!r||!t){console.log(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==ri.STUDENT){console.error(" Invalid user role for student app:",t.role),d("Access denied. Student role required.");return}console.log(" Initializing event listeners..."),_(),console.log(" Setting up back to cabinet button listeners..."),N(),console.log(" Setting up password change form listener..."),A(),console.log(" Loading student data..."),await P(),console.log(" Exposing student functions globally..."),R(),console.log(" Populating student info from user data..."),Z(t),a(!0),console.log(" Student Application initialization complete!")}catch(re){console.error(" Error initializing student app:",re),d("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);C.useEffect(()=>{n||k()},[n,r,t,k]);const _=C.useCallback(()=>{console.log(" Setting up student event listeners...");const re=W=>{g&&!W.target.closest(".student-menu")&&y(!1)},M=W=>{W.key==="Escape"&&g&&y(!1)};return document.addEventListener("click",re),document.addEventListener("keydown",M),()=>{document.removeEventListener("click",re),document.removeEventListener("keydown",M)}},[g]),N=C.useCallback(()=>{console.log(" Setting up back to cabinet listeners...")},[]),A=C.useCallback(()=>{console.log(" Setting up password change form...")},[]),P=C.useCallback(async()=>{console.log(" Loading student data...");try{console.log(" Student data loaded successfully")}catch(re){throw console.error(" Error loading student data:",re),re}},[]),R=C.useCallback(()=>{console.log(" Exposing student functions globally..."),window.toggleStudentMenu=T,window.showChangePasswordTab=D,window.hideChangePasswordTab=I,window.navigateBackToCabinet=X,window.handlePasswordChange=K,window.populateStudentInfoDirectly=Z,console.log(" All student functions exposed globally")},[]),T=C.useCallback(()=>{console.log(" toggleStudentMenu called"),y(re=>{const M=!re;return console.log(" Menu state changed from",re,"to",M),M}),console.log(" Toggled dropdown menu")},[]),D=C.useCallback(()=>{console.log(" showChangePasswordTab called"),w(!0),y(!1)},[]),I=C.useCallback(()=>{console.log(" hideChangePasswordTab called"),w(!1),E({currentPassword:"",newPassword:"",confirmPassword:""})},[]),K=C.useCallback(async re=>{re.preventDefault(),console.log(" handlePasswordChange called");const{currentPassword:M,newPassword:W,confirmPassword:B}=b;if(!M||!W||!B){oe("Please fill in all fields","error");return}if(W!==B){oe("New passwords do not match","error");return}if(W.length<6){oe("New password must be at least 6 characters long","error");return}const G=/[a-zA-Z]/.test(W),H=/[0-9]/.test(W);if(!G||!H){oe("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){oe("Session expired. Please login again.","error");return}const O=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const z=await xn.changePassword({studentId:O,currentPassword:M,newPassword:W});z.success?(oe("Password changed successfully!","success"),I()):oe(z.message||"Failed to change password","error")}catch(z){console.error("Password change error:",z),oe("Failed to change password. Please try again.","error")}finally{o(!1)}},[b,t]),X=C.useCallback(()=>{if(console.log("[DEBUG] navigateBackToCabinet called"),!r||!t){console.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===ri.STUDENT?(console.log("[DEBUG] Navigating to student cabinet"),e("/student")):(console.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),Z=C.useCallback(re=>{console.log(" populateStudentInfoDirectly called with:",re);try{console.log(" Student info populated successfully")}catch(M){console.error(" Error populating student info:",M)}},[]),oe=C.useCallback((re,M)=>{const W={id:Date.now(),message:re,type:M,timestamp:new Date};p(B=>[...B,W]),setTimeout(()=>{p(B=>B.filter(G=>G.id!==W.id))},vi.NOTIFICATION_DURATION)},[]),q=C.useCallback(re=>{const{name:M,value:W}=re.target;E(B=>({...B,[M]:W}))},[]);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:c}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{className:"bg-gray-50",children:[l.jsxs(w2,{children:[l.jsx(ts,{path:"/",element:l.jsxs("div",{className:"student-app",children:[l.jsx(Dz,{isMenuOpen:g,onToggleMenu:T,onShowPasswordChange:D}),v&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),l.jsxs("form",{onSubmit:K,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:b.currentPassword,onChange:q,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:b.newPassword,onChange:q,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:b.confirmPassword,onChange:q,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:I,className:"flex-1",children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),l.jsx(ts,{path:"/test/:testType/:testId",element:l.jsx(zz,{})}),l.jsx(ts,{path:"matching-test/:testId",element:l.jsx(Oz,{})}),l.jsx(ts,{path:"word-matching-test/:testId",element:l.jsx(Lz,{})}),l.jsx(ts,{path:"speaking-test/:testId",element:l.jsx(Wz,{})}),l.jsx(ts,{path:"/results",element:l.jsx(Zj,{})})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:f.map(re=>l.jsx(Vo,{type:re.type,message:re.message,onClose:()=>p(M=>M.filter(W=>W.id!==re.id))},re.id))})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},Gz=()=>l.jsx(W3,{children:l.jsx(Uj,{children:l.jsx(Lj,{children:l.jsx(Hz,{})})})}),Vz=({result:e,isOpen:t,onClose:r,initialTab:n="overview"})=>{const[s,a]=C.useState(n),i=C.useRef(!1);if(C.useEffect(()=>()=>{i.current=!0},[]),C.useEffect(()=>{t&&a(n)},[t,n]),!t||!e)return null;const o={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let c=e?.__audioUrl||void 0;const d=c?void 0:e?.answers;typeof d=="string"?c=d:d&&typeof d=="object"&&(c=d.audio_url),C.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof d=="object"&&d?.transcript?d.transcript:void 0,hasAnswers:!!d,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[f,p]=C.useState("");C.useEffect(()=>{const y=new AbortController;let v=!1;const w=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof d=="object"&&d?.transcript)&&e?.test_id&&w&&(async()=>{try{const b=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(w)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:b});const E=localStorage.getItem("auth_token")||localStorage.getItem("accessToken")||localStorage.getItem("token"),k=await fetch(b,{headers:{Authorization:E?`Bearer ${E}`:""},signal:y.signal});console.log("[SpeakingReview] Transcript API response:",{ok:k.ok,status:k.status});const _=await k.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",_),!v&&!i.current&&(k.ok?p(_.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",_?.error||"unknown error"))}catch(b){b.name!=="AbortError"&&!i.current&&console.error("[SpeakingReview] Transcript fetch error:",b)}})(),()=>{v=!0;try{y.abort()}catch{}}},[e]);const g={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:c,transcript:e.transcript||f||(typeof d=="object"&&d?.transcript?d.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[l.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",o.test_name]}),l.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"overview",label:"Overview"},{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"scoring",label:"Scoring"}].map(y=>l.jsx("button",{onClick:()=>a(y.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${s===y.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:y.label},y.id))})}),l.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[s==="overview"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:o.test_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[g.score," / ",g.max_score," (",g.percentage,"%)"]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:g.time_taken?`${Math.floor(g.time_taken/60)}:${(g.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:g.submitted_at?new Date(g.submitted_at).toLocaleString():"N/A"})]})]})}),s==="audio"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),g.audio_url?l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx(e8,{audioUrl:g.audio_url,className:"w-full"})})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No audio recording available"})})]}),s==="transcript"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),g.transcript?l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:g.transcript})}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No transcript available"})})]}),s==="scoring"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Score Details"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Current Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[g.score," / ",g.max_score]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Percentage"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[g.percentage,"%"]})]})]}),l.jsx("div",{className:"mt-4",children:l.jsx("p",{className:"text-sm text-gray-600",children:"Score editing functionality can be implemented here to allow teachers to manually adjust scores."})})]})]}),l.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})};class hN extends es.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[l.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var dy={};dy.version="0.18.5";var t8=1252,Kz=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],nS={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},sS=function(e){Kz.indexOf(e)!=-1&&(t8=nS[0]=e)};function qz(){sS(1252)}var $o=function(e){sS(e)};function aS(){$o(1200),qz()}function gN(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Xz(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function r8(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var bm=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Xz(e.slice(2)):t==254&&r==255?r8(e.slice(2)):t==65279?e.slice(1):e},m1=function(t){return String.fromCharCode(t)},mN=function(t){return String.fromCharCode(t)},op,Eu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lp(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,d=0;d<e.length;)r=e.charCodeAt(d++),a=r>>2,n=e.charCodeAt(d++),i=(r&3)<<4|n>>4,s=e.charCodeAt(d++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=Eu.charAt(a)+Eu.charAt(i)+Eu.charAt(o)+Eu.charAt(c);return t}function $i(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)a=Eu.indexOf(e.charAt(d++)),i=Eu.indexOf(e.charAt(d++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Eu.indexOf(e.charAt(d++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Eu.indexOf(e.charAt(d++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ir=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ac=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function Bu(e){return Ir?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function pN(e){return Ir?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Li=function(t){return Ir?Ac(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Jy(e){if(typeof ArrayBuffer>"u")return Li(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Yu(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Yz(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function iS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return iS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Zs=Ir?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Ac(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function Qz(e){for(var t=[],r=0,n=e.length+250,s=Bu(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Bu(65535),n=65530)}return t.push(s.slice(0,r)),Zs(t)}var ai=/\u0000/g,Sm=/[\u0001-\u0006]/g;function Qh(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Wo(e,t){var r=""+e;return r.length>=t?r:rs("0",t-r.length)+r}function oS(e,t){var r=""+e;return r.length>=t?r:rs(" ",t-r.length)+r}function fy(e,t){var r=""+e;return r.length>=t?r:r+rs(" ",t-r.length)}function Jz(e,t){var r=""+Math.round(e);return r.length>=t?r:rs("0",t-r.length)+r}function Zz(e,t){var r=""+e;return r.length>=t?r:rs("0",t-r.length)+r}var xN=Math.pow(2,32);function Ch(e,t){if(e>xN||e<-xN)return Jz(e,t);var r=Math.round(e);return Zz(r,t)}function hy(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var yN=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Lw=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function eH(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var mr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},vN={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},tH={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function gy(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,d=0,f=0,p=Math.floor(s);d<t&&(p=Math.floor(s),o=p*i+a,f=p*d+c,!(s-p<5e-8));)s=1/(s-p),a=i,i=o,c=d,d=f;if(f>t&&(d>t?(f=c,o=a):(f=d,o=i)),!r)return[0,n*o,f];var g=Math.floor(n*o/f);return[g,n*o-g*f,f]}function Bd(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=oH(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var n8=new Date(1899,11,31,0,0,0),rH=n8.getTime(),nH=new Date(1900,2,1,0,0,0);function s8(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=nH&&(r+=1440*60*1e3),(r-(rH+(e.getTimezoneOffset()-n8.getTimezoneOffset())*6e4))/(1440*60*1e3)}function lS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function sH(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function aH(e){var t=e<0?12:11,r=lS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function iH(e){var t=lS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function cp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=aH(e):t===10?r=e.toFixed(10).substr(0,12):r=iH(e),lS(sH(r.toUpperCase()))}function df(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):cp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return yo(14,s8(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function oH(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function lH(e,t,r,n){var s="",a=0,i=0,o=r.y,c,d=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,d=2;break;default:c=o%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,d=t.length;break;case 3:return Lw[r.m-1][1];case 5:return Lw[r.m-1][0];default:return Lw[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,d=t.length;break;case 3:return yN[r.q][0];default:return yN[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Wo(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Wo(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:c=o,d=1;break}var f=d>0?Wo(c,d):"";return f}function Nu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var a8=/%/g;function cH(e,t,r){var n=t.replace(a8,""),s=t.length-n.length;return vc(e,n,r*Math.pow(10,2*s))+rs("%",s)}function uH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vc(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function i8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+i8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,f){return c+d+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var o8=/# (\?+)( ?)\/( ?)(\d+)/;function dH(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?rs(" ",e[1].length+1+e[4].length):oS(i,e[1].length)+e[2]+"/"+e[3]+Wo(o,e[4].length))}function fH(e,t,r){return r+(t===0?"":""+t)+rs(" ",e[1].length+2+e[4].length)}var l8=/^#*0*\.([0#]+)/,c8=/\).*[0#]/,u8=/\(###\) ###\\?-####/;function ei(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function wN(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function _N(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function hH(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function gH(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ao(e,t,r){if(e.charCodeAt(0)===40&&!t.match(c8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ao("n",n,r):"("+ao("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uH(e,t,r);if(t.indexOf("%")!==-1)return cH(e,t,r);if(t.indexOf("E")!==-1)return i8(t,r);if(t.charCodeAt(0)===36)return"$"+ao(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Ch(c,t.length);if(t.match(/^[#?]+$/))return s=Ch(r,0),s==="0"&&(s=""),s.length>t.length?s:ei(t.substr(0,t.length-s.length))+s;if(a=t.match(o8))return dH(a,c,d);if(t.match(/^#+0+$/))return d+Ch(c,t.length-t.indexOf("0"));if(a=t.match(l8))return s=wN(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ei(a[1])).replace(/\.$/,"."+ei(a[1])).replace(/\.(\d*)$/,function(v,w){return"."+w+rs("0",ei(a[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+wN(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Nu(Ch(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ao(e,t,-r):Nu(""+(Math.floor(r)+hH(r,a[1].length)))+"."+Wo(_N(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ao(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qh(ao(e,t.replace(/[\\-]/g,""),r)),i=0,Qh(Qh(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(u8))return s=ao(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=gy(c,Math.pow(10,i)-1,!1),s=""+d,f=vc("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=fy(o[2],i),f.length<a[4].length&&(f=ei(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=gy(c,Math.pow(10,i)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?oS(o[1],i)+a[2]+"/"+a[3]+fy(o[2],i):rs(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=Ch(r,0),t.length<=s.length?s:ei(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,g=t.length-s.length-p;return ei(t.substr(0,p)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=_N(r,a[1].length),r<0?"-"+ao(e,t,-r):Nu(gH(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Wo(0,3-v.length):"")+v})+"."+Wo(i,a[1].length);switch(t){case"###,##0.00":return ao(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Nu(Ch(c,0));return y!=="0"?d+y:"";case"###,###.00":return ao(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ao(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function mH(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return vc(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function pH(e,t,r){var n=t.replace(a8,""),s=t.length-n.length;return vc(e,n,r*Math.pow(10,2*s))+rs("%",s)}function d8(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+d8(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,d,f){return c+d+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function yl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(c8)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?yl("n",n,r):"("+yl("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return mH(e,t,r);if(t.indexOf("%")!==-1)return pH(e,t,r);if(t.indexOf("E")!==-1)return d8(t,r);if(t.charCodeAt(0)===36)return"$"+yl(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+Wo(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:ei(t.substr(0,t.length-s.length))+s;if(a=t.match(o8))return fH(a,c,d);if(t.match(/^#+0+$/))return d+Wo(c,t.length-t.indexOf("0"));if(a=t.match(l8))return s=(""+r).replace(/^([^\.]+)$/,"$1."+ei(a[1])).replace(/\.$/,"."+ei(a[1])),s=s.replace(/\.(\d*)$/,function(v,w){return"."+w+rs("0",ei(a[1]).length-w.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return d+Nu(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+yl(e,t,-r):Nu(""+r)+"."+rs("0",a[1].length);if(a=t.match(/^#,#*,#0/))return yl(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Qh(yl(e,t.replace(/[\\-]/g,""),r)),i=0,Qh(Qh(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<s.length?s.charAt(i++):v==="0"?"0":""}));if(t.match(u8))return s=yl(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=gy(c,Math.pow(10,i)-1,!1),s=""+d,f=vc("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=fy(o[2],i),f.length<a[4].length&&(f=ei(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=gy(c,Math.pow(10,i)-1,!0),d+(o[0]||(o[1]?"":"0"))+" "+(o[1]?oS(o[1],i)+a[2]+"/"+a[3]+fy(o[2],i):rs(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:ei(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var p=t.indexOf(".")-i,g=t.length-s.length-p;return ei(t.substr(0,p)+s+t.substr(t.length-g))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+yl(e,t,-r):Nu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Wo(0,3-v.length):"")+v})+"."+Wo(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var y=Nu(""+c);return y!=="0"?d+y:"";default:if(t.match(/\.[0#?]*$/))return yl(e,t.slice(0,t.lastIndexOf(".")),r)+ei(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function vc(e,t,r){return(r|0)===r?yl(e,t,r):ao(e,t,r)}function xH(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var f8=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function A0(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":hy(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(f8))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function yH(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",d,f,p,g="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!hy(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(p=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(p);s[s.length]={t:"t",v:a},++i;break;case"\\":var y=e.charAt(++i),v=y==="("||y===")"?y:"t";s[s.length]={t:v,v:y},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(d==null&&(d=Bd(t,r,e.charAt(i+1)==="2"),d==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=Bd(t,r),d==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=g),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var w={t:o,v:o};if(d==null&&(d=Bd(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(d!=null&&(w.v=d.H>=12?"P":"A"),w.t="T",g="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(d!=null&&(w.v=d.H>=12?"PM":"AM"),w.t="T",i+=5,g="h"):e.substr(i,5).toUpperCase()==="/"?(d!=null&&(w.v=d.H>=12?"":""),w.t="T",i+=5,g="h"):(w.t="t",++i),d==null&&w.t==="T")return"";s[s.length]=w,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(f8)){if(d==null&&(d=Bd(t,r),d==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",A0(e)||(s[s.length]={t:"t",v:a}));break;case".":if(d!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var b=0,E=0,k;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=g,c="h",b<1&&(b=1);break;case"s":(k=s[i].v.match(/\.0+$/))&&(E=Math.max(E,k[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&s[i].v.match(/[Hh]/)&&(b=1),b<2&&s[i].v.match(/[Mm]/)&&(b=2),b<3&&s[i].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var _="",N;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=lH(s[i].t.charCodeAt(0),s[i].v,d,E),s[i].t="t";break;case"n":case"?":for(N=i+1;s[N]!=null&&((o=s[N].t)==="?"||o==="D"||(o===" "||o==="t")&&s[N+1]!=null&&(s[N+1].t==="?"||s[N+1].t==="t"&&s[N+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[N].v==="/"||s[N].v===" "&&s[N+1]!=null&&s[N+1].t=="?"));)s[i].v+=s[N].v,s[N]={v:"",t:";"},++N;_+=s[i].v,i=N-1;break;case"G":s[i].t="t",s[i].v=df(t,r);break}var A="",P,R;if(_.length>0){_.charCodeAt(0)==40?(P=t<0&&_.charCodeAt(0)===45?-t:t,R=vc("n",_,P)):(P=t<0&&n>1?-t:t,R=vc("n",_,P),P<0&&s[0]&&s[0].t=="t"&&(R=R.substr(1),s[0].v="-"+s[0].v)),N=R.length-1;var T=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){T=i;break}var D=s.length;if(T===s.length&&R.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(N>=s[i].v.length-1?(N-=s[i].v.length,s[i].v=R.substr(N+1,s[i].v.length)):N<0?s[i].v="":(s[i].v=R.substr(0,N+1),N=-1),s[i].t="t",D=i);N>=0&&D<s.length&&(s[D].v=R.substr(0,N+1)+s[D].v)}else if(T!==s.length&&R.indexOf("E")===-1){for(N=R.indexOf(".")-1,i=T;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")-1:s[i].v.length-1,A=s[i].v.substr(f+1);f>=0;--f)N>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(A=R.charAt(N--)+A);s[i].v=A,s[i].t="t",D=i}for(N>=0&&D<s.length&&(s[D].v=R.substr(0,N+1)+s[D].v),N=R.indexOf(".")+1,i=T;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==T)){for(f=s[i].v.indexOf(".")>-1&&i===T?s[i].v.indexOf(".")+1:0,A=s[i].v.substr(0,f);f<s[i].v.length;++f)N<R.length&&(A+=R.charAt(N++));s[i].v=A,s[i].t="t",D=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(P=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=vc(s[i].t,s[i].v,P),s[i].t="t");var I="";for(i=0;i!==s.length;++i)s[i]!=null&&(I+=s[i].v);return I}var bN=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function SN(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function vH(e,t){var r=xH(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(bN),o=r[1].match(bN);return SN(t,i)?[n,r[0]]:SN(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function yo(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:mr)[e],n==null&&(n=r.table&&r.table[vN[e]]||mr[vN[e]]),n==null&&(n=tH[e]||"General");break}if(hy(n,0))return df(t,r);t instanceof Date&&(t=s8(t,r.date1904));var s=vH(n,t);if(hy(s[1]))return df(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return yH(s[1],t,r,s[0])}function wc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(mr[r]==null){t<0&&(t=r);continue}if(mr[r]==e){t=r;break}}t<0&&(t=391)}return mr[t]=e,t}function Zy(e){for(var t=0;t!=392;++t)e[t]!==void 0&&wc(e[t],t)}function j0(){mr=eH()}var wH={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},h8=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function _H(e){var t=typeof e=="number"?mr[e]:e;return t=t.replace(h8,"(\\d+)"),new RegExp("^"+t+"$")}function bH(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(h8)||[]).forEach(function(p,g){var y=parseInt(r[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=y;break;case"d":a=y;break;case"h":i=y;break;case"s":c=y;break;case"m":i>=0?o=y:s=y;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?d:n==-1&&s==-1&&a==-1?f:d+"T"+f}var SH=(function(){var e={};e.version="1.2.0";function t(){for(var R=0,T=new Array(256),D=0;D!=256;++D)R=D,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,R=R&1?-306674912^R>>>1:R>>>1,T[D]=R;return typeof Int32Array<"u"?new Int32Array(T):T}var r=t();function n(R){var T=0,D=0,I=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(I=0;I!=256;++I)K[I]=R[I];for(I=0;I!=256;++I)for(D=R[I],T=256+I;T<4096;T+=256)D=K[T]=D>>>8^R[D&255];var X=[];for(I=1;I!=16;++I)X[I-1]=typeof Int32Array<"u"?K.subarray(I*256,I*256+256):K.slice(I*256,I*256+256);return X}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],d=s[4],f=s[5],p=s[6],g=s[7],y=s[8],v=s[9],w=s[10],b=s[11],E=s[12],k=s[13],_=s[14];function N(R,T){for(var D=T^-1,I=0,K=R.length;I<K;)D=D>>>8^r[(D^R.charCodeAt(I++))&255];return~D}function A(R,T){for(var D=T^-1,I=R.length-15,K=0;K<I;)D=_[R[K++]^D&255]^k[R[K++]^D>>8&255]^E[R[K++]^D>>16&255]^b[R[K++]^D>>>24]^w[R[K++]]^v[R[K++]]^y[R[K++]]^g[R[K++]]^p[R[K++]]^f[R[K++]]^d[R[K++]]^c[R[K++]]^o[R[K++]]^i[R[K++]]^a[R[K++]]^r[R[K++]];for(I+=15;K<I;)D=D>>>8^r[(D^R[K++])&255];return~D}function P(R,T){for(var D=T^-1,I=0,K=R.length,X=0,Z=0;I<K;)X=R.charCodeAt(I++),X<128?D=D>>>8^r[(D^X)&255]:X<2048?(D=D>>>8^r[(D^(192|X>>6&31))&255],D=D>>>8^r[(D^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,Z=R.charCodeAt(I++)&1023,D=D>>>8^r[(D^(240|X>>8&7))&255],D=D>>>8^r[(D^(128|X>>2&63))&255],D=D>>>8^r[(D^(128|Z>>6&15|(X&3)<<4))&255],D=D>>>8^r[(D^(128|Z&63))&255]):(D=D>>>8^r[(D^(224|X>>12&15))&255],D=D>>>8^r[(D^(128|X>>6&63))&255],D=D>>>8^r[(D^(128|X&63))&255]);return~D}return e.table=r,e.bstr=N,e.buf=A,e.str=P,e})(),lr=(function(){var t={};t.version="1.2.1";function r(ue,ke){for(var ge=ue.split("/"),ve=ke.split("/"),Se=0,Ee=0,We=Math.min(ge.length,ve.length);Se<We;++Se){if(Ee=ge[Se].length-ve[Se].length)return Ee;if(ge[Se]!=ve[Se])return ge[Se]<ve[Se]?-1:1}return ge.length-ve.length}function n(ue){if(ue.charAt(ue.length-1)=="/")return ue.slice(0,-1).indexOf("/")===-1?ue:n(ue.slice(0,-1));var ke=ue.lastIndexOf("/");return ke===-1?ue:ue.slice(0,ke+1)}function s(ue){if(ue.charAt(ue.length-1)=="/")return s(ue.slice(0,-1));var ke=ue.lastIndexOf("/");return ke===-1?ue:ue.slice(ke+1)}function a(ue,ke){typeof ke=="string"&&(ke=new Date(ke));var ge=ke.getHours();ge=ge<<6|ke.getMinutes(),ge=ge<<5|ke.getSeconds()>>>1,ue.write_shift(2,ge);var ve=ke.getFullYear()-1980;ve=ve<<4|ke.getMonth()+1,ve=ve<<5|ke.getDate(),ue.write_shift(2,ve)}function i(ue){var ke=ue.read_shift(2)&65535,ge=ue.read_shift(2)&65535,ve=new Date,Se=ge&31;ge>>>=5;var Ee=ge&15;ge>>>=4,ve.setMilliseconds(0),ve.setFullYear(ge+1980),ve.setMonth(Ee-1),ve.setDate(Se);var We=ke&31;ke>>>=5;var ut=ke&63;return ke>>>=6,ve.setHours(ke),ve.setMinutes(ut),ve.setSeconds(We<<1),ve}function o(ue){pa(ue,0);for(var ke={},ge=0;ue.l<=ue.length-4;){var ve=ue.read_shift(2),Se=ue.read_shift(2),Ee=ue.l+Se,We={};switch(ve){case 21589:ge=ue.read_shift(1),ge&1&&(We.mtime=ue.read_shift(4)),Se>5&&(ge&2&&(We.atime=ue.read_shift(4)),ge&4&&(We.ctime=ue.read_shift(4))),We.mtime&&(We.mt=new Date(We.mtime*1e3));break}ue.l=Ee,ke[ve]=We}return ke}var c;function d(){return c||(c={})}function f(ue,ke){if(ue[0]==80&&ue[1]==75)return Ae(ue,ke);if((ue[0]|32)==109&&(ue[1]|32)==105)return Vt(ue,ke);if(ue.length<512)throw new Error("CFB file size "+ue.length+" < 512");var ge=3,ve=512,Se=0,Ee=0,We=0,ut=0,Ge=0,le=[],se=ue.slice(0,512);pa(se,0);var ce=p(se);switch(ge=ce[0],ge){case 3:ve=512;break;case 4:ve=4096;break;case 0:if(ce[1]==0)return Ae(ue,ke);default:throw new Error("Major Version: Expected 3 or 4 saw "+ge)}ve!==512&&(se=ue.slice(0,ve),pa(se,28));var we=ue.slice(0,ve);g(se,ge);var Te=se.read_shift(4,"i");if(ge===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);se.l+=4,We=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),ut=se.read_shift(4,"i"),Se=se.read_shift(4,"i"),Ge=se.read_shift(4,"i"),Ee=se.read_shift(4,"i");for(var Be=-1,be=0;be<109&&(Be=se.read_shift(4,"i"),!(Be<0));++be)le[be]=Be;var nt=y(ue,ve);b(Ge,Ee,nt,ve,le);var vt=k(nt,We,le,ve);vt[We].name="!Directory",Se>0&&ut!==Z&&(vt[ut].name="!MiniFAT"),vt[le[0]].name="!FAT",vt.fat_addrs=le,vt.ssz=ve;var Fe={},mt=[],Xt=[],Rr=[];_(We,vt,nt,mt,Se,Fe,Xt,ut),v(Xt,Rr,mt),mt.shift();var Ar={FileIndex:Xt,FullPaths:Rr};return ke&&ke.raw&&(Ar.raw={header:we,sectors:nt}),Ar}function p(ue){if(ue[ue.l]==80&&ue[ue.l+1]==75)return[0,0];ue.chk(oe,"Header Signature: "),ue.l+=16;var ke=ue.read_shift(2,"u");return[ue.read_shift(2,"u"),ke]}function g(ue,ke){var ge=9;switch(ue.l+=2,ge=ue.read_shift(2)){case 9:if(ke!=3)throw new Error("Sector Shift: Expected 9 saw "+ge);break;case 12:if(ke!=4)throw new Error("Sector Shift: Expected 12 saw "+ge);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+ge)}ue.chk("0600","Mini Sector Shift: "),ue.chk("000000000000","Reserved: ")}function y(ue,ke){for(var ge=Math.ceil(ue.length/ke)-1,ve=[],Se=1;Se<ge;++Se)ve[Se-1]=ue.slice(Se*ke,(Se+1)*ke);return ve[ge-1]=ue.slice(ge*ke),ve}function v(ue,ke,ge){for(var ve=0,Se=0,Ee=0,We=0,ut=0,Ge=ge.length,le=[],se=[];ve<Ge;++ve)le[ve]=se[ve]=ve,ke[ve]=ge[ve];for(;ut<se.length;++ut)ve=se[ut],Se=ue[ve].L,Ee=ue[ve].R,We=ue[ve].C,le[ve]===ve&&(Se!==-1&&le[Se]!==Se&&(le[ve]=le[Se]),Ee!==-1&&le[Ee]!==Ee&&(le[ve]=le[Ee])),We!==-1&&(le[We]=ve),Se!==-1&&ve!=le[ve]&&(le[Se]=le[ve],se.lastIndexOf(Se)<ut&&se.push(Se)),Ee!==-1&&ve!=le[ve]&&(le[Ee]=le[ve],se.lastIndexOf(Ee)<ut&&se.push(Ee));for(ve=1;ve<Ge;++ve)le[ve]===ve&&(Ee!==-1&&le[Ee]!==Ee?le[ve]=le[Ee]:Se!==-1&&le[Se]!==Se&&(le[ve]=le[Se]));for(ve=1;ve<Ge;++ve)if(ue[ve].type!==0){if(ut=ve,ut!=le[ut])do ut=le[ut],ke[ve]=ke[ut]+"/"+ke[ve];while(ut!==0&&le[ut]!==-1&&ut!=le[ut]);le[ve]=-1}for(ke[0]+="/",ve=1;ve<Ge;++ve)ue[ve].type!==2&&(ke[ve]+="/")}function w(ue,ke,ge){for(var ve=ue.start,Se=ue.size,Ee=[],We=ve;ge&&Se>0&&We>=0;)Ee.push(ke.slice(We*X,We*X+X)),Se-=X,We=Id(ge,We*4);return Ee.length===0?yt(0):Zs(Ee).slice(0,ue.size)}function b(ue,ke,ge,ve,Se){var Ee=Z;if(ue===Z){if(ke!==0)throw new Error("DIFAT chain shorter than expected")}else if(ue!==-1){var We=ge[ue],ut=(ve>>>2)-1;if(!We)return;for(var Ge=0;Ge<ut&&(Ee=Id(We,Ge*4))!==Z;++Ge)Se.push(Ee);b(Id(We,ve-4),ke-1,ge,ve,Se)}}function E(ue,ke,ge,ve,Se){var Ee=[],We=[];Se||(Se=[]);var ut=ve-1,Ge=0,le=0;for(Ge=ke;Ge>=0;){Se[Ge]=!0,Ee[Ee.length]=Ge,We.push(ue[Ge]);var se=ge[Math.floor(Ge*4/ve)];if(le=Ge*4&ut,ve<4+le)throw new Error("FAT boundary crossed: "+Ge+" 4 "+ve);if(!ue[se])break;Ge=Id(ue[se],le)}return{nodes:Ee,data:IN([We])}}function k(ue,ke,ge,ve){var Se=ue.length,Ee=[],We=[],ut=[],Ge=[],le=ve-1,se=0,ce=0,we=0,Te=0;for(se=0;se<Se;++se)if(ut=[],we=se+ke,we>=Se&&(we-=Se),!We[we]){Ge=[];var Be=[];for(ce=we;ce>=0;){Be[ce]=!0,We[ce]=!0,ut[ut.length]=ce,Ge.push(ue[ce]);var be=ge[Math.floor(ce*4/ve)];if(Te=ce*4&le,ve<4+Te)throw new Error("FAT boundary crossed: "+ce+" 4 "+ve);if(!ue[be]||(ce=Id(ue[be],Te),Be[ce]))break}Ee[we]={nodes:ut,data:IN([Ge])}}return Ee}function _(ue,ke,ge,ve,Se,Ee,We,ut){for(var Ge=0,le=ve.length?2:0,se=ke[ue].data,ce=0,we=0,Te;ce<se.length;ce+=128){var Be=se.slice(ce,ce+128);pa(Be,64),we=Be.read_shift(2),Te=mS(Be,0,we-le),ve.push(Te);var be={name:Te,type:Be.read_shift(1),color:Be.read_shift(1),L:Be.read_shift(4,"i"),R:Be.read_shift(4,"i"),C:Be.read_shift(4,"i"),clsid:Be.read_shift(16),state:Be.read_shift(4,"i"),start:0,size:0},nt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);nt!==0&&(be.ct=N(Be,Be.l-8));var vt=Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2)+Be.read_shift(2);vt!==0&&(be.mt=N(Be,Be.l-8)),be.start=Be.read_shift(4,"i"),be.size=Be.read_shift(4,"i"),be.size<0&&be.start<0&&(be.size=be.type=0,be.start=Z,be.name=""),be.type===5?(Ge=be.start,Se>0&&Ge!==Z&&(ke[Ge].name="!StreamData")):be.size>=4096?(be.storage="fat",ke[be.start]===void 0&&(ke[be.start]=E(ge,be.start,ke.fat_addrs,ke.ssz)),ke[be.start].name=be.name,be.content=ke[be.start].data.slice(0,be.size)):(be.storage="minifat",be.size<0?be.size=0:Ge!==Z&&be.start!==Z&&ke[Ge]&&(be.content=w(be,ke[Ge].data,(ke[ut]||{}).data))),be.content&&pa(be.content,0),Ee[Te]=be,We.push(be)}}function N(ue,ke){return new Date((Oi(ue,ke+4)/1e7*Math.pow(2,32)+Oi(ue,ke)/1e7-11644473600)*1e3)}function A(ue,ke){return d(),f(c.readFileSync(ue),ke)}function P(ue,ke){var ge=ke&&ke.type;switch(ge||Ir&&Buffer.isBuffer(ue)&&(ge="buffer"),ge||"base64"){case"file":return A(ue,ke);case"base64":return f(Li($i(ue)),ke);case"binary":return f(Li(ue),ke)}return f(ue,ke)}function R(ue,ke){var ge=ke||{},ve=ge.root||"Root Entry";if(ue.FullPaths||(ue.FullPaths=[]),ue.FileIndex||(ue.FileIndex=[]),ue.FullPaths.length!==ue.FileIndex.length)throw new Error("inconsistent CFB structure");ue.FullPaths.length===0&&(ue.FullPaths[0]=ve+"/",ue.FileIndex[0]={name:ve,type:5}),ge.CLSID&&(ue.FileIndex[0].clsid=ge.CLSID),T(ue)}function T(ue){var ke="Sh33tJ5";if(!lr.find(ue,"/"+ke)){var ge=yt(4);ge[0]=55,ge[1]=ge[3]=50,ge[2]=54,ue.FileIndex.push({name:ke,type:2,content:ge,size:4,L:69,R:69,C:69}),ue.FullPaths.push(ue.FullPaths[0]+ke),D(ue)}}function D(ue,ke){R(ue);for(var ge=!1,ve=!1,Se=ue.FullPaths.length-1;Se>=0;--Se){var Ee=ue.FileIndex[Se];switch(Ee.type){case 0:ve?ge=!0:(ue.FileIndex.pop(),ue.FullPaths.pop());break;case 1:case 2:case 5:ve=!0,isNaN(Ee.R*Ee.L*Ee.C)&&(ge=!0),Ee.R>-1&&Ee.L>-1&&Ee.R==Ee.L&&(ge=!0);break;default:ge=!0;break}}if(!(!ge&&!ke)){var We=new Date(1987,1,19),ut=0,Ge=Object.create?Object.create(null):{},le=[];for(Se=0;Se<ue.FullPaths.length;++Se)Ge[ue.FullPaths[Se]]=!0,ue.FileIndex[Se].type!==0&&le.push([ue.FullPaths[Se],ue.FileIndex[Se]]);for(Se=0;Se<le.length;++Se){var se=n(le[Se][0]);ve=Ge[se],ve||(le.push([se,{name:s(se).replace("/",""),type:1,clsid:re,ct:We,mt:We,content:null}]),Ge[se]=!0)}for(le.sort(function(Te,Be){return r(Te[0],Be[0])}),ue.FullPaths=[],ue.FileIndex=[],Se=0;Se<le.length;++Se)ue.FullPaths[Se]=le[Se][0],ue.FileIndex[Se]=le[Se][1];for(Se=0;Se<le.length;++Se){var ce=ue.FileIndex[Se],we=ue.FullPaths[Se];if(ce.name=s(we).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||re,Se===0)ce.C=le.length>1?1:-1,ce.size=0,ce.type=5;else if(we.slice(-1)=="/"){for(ut=Se+1;ut<le.length&&n(ue.FullPaths[ut])!=we;++ut);for(ce.C=ut>=le.length?-1:ut,ut=Se+1;ut<le.length&&n(ue.FullPaths[ut])!=n(we);++ut);ce.R=ut>=le.length?-1:ut,ce.type=1}else n(ue.FullPaths[Se+1]||"")==n(we)&&(ce.R=Se+1),ce.type=2}}}function I(ue,ke){var ge=ke||{};if(ge.fileType=="mad")return gr(ue,ge);switch(D(ue),ge.fileType){case"zip":return he(ue,ge)}var ve=(function(Te){for(var Be=0,be=0,nt=0;nt<Te.FileIndex.length;++nt){var vt=Te.FileIndex[nt];if(vt.content){var Fe=vt.content.length;Fe>0&&(Fe<4096?Be+=Fe+63>>6:be+=Fe+511>>9)}}for(var mt=Te.FullPaths.length+3>>2,Xt=Be+7>>3,Rr=Be+127>>7,Ar=Xt+be+mt+Rr,hr=Ar+127>>7,er=hr<=109?0:Math.ceil((hr-109)/127);Ar+hr+er+127>>7>hr;)er=++hr<=109?0:Math.ceil((hr-109)/127);var Kt=[1,er,hr,Rr,mt,be,Be,0];return Te.FileIndex[0].size=Be<<6,Kt[7]=(Te.FileIndex[0].start=Kt[0]+Kt[1]+Kt[2]+Kt[3]+Kt[4]+Kt[5])+(Kt[6]+7>>3),Kt})(ue),Se=yt(ve[7]<<9),Ee=0,We=0;{for(Ee=0;Ee<8;++Ee)Se.write_shift(1,q[Ee]);for(Ee=0;Ee<8;++Ee)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),Ee=0;Ee<3;++Ee)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,ve[2]),Se.write_shift(4,ve[0]+ve[1]+ve[2]+ve[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,ve[3]?ve[0]+ve[1]+ve[2]-1:Z),Se.write_shift(4,ve[3]),Se.write_shift(-4,ve[1]?ve[0]-1:Z),Se.write_shift(4,ve[1]),Ee=0;Ee<109;++Ee)Se.write_shift(-4,Ee<ve[2]?ve[1]+Ee:-1)}if(ve[1])for(We=0;We<ve[1];++We){for(;Ee<236+We*127;++Ee)Se.write_shift(-4,Ee<ve[2]?ve[1]+Ee:-1);Se.write_shift(-4,We===ve[1]-1?Z:We+1)}var ut=function(Te){for(We+=Te;Ee<We-1;++Ee)Se.write_shift(-4,Ee+1);Te&&(++Ee,Se.write_shift(-4,Z))};for(We=Ee=0,We+=ve[1];Ee<We;++Ee)Se.write_shift(-4,M.DIFSECT);for(We+=ve[2];Ee<We;++Ee)Se.write_shift(-4,M.FATSECT);ut(ve[3]),ut(ve[4]);for(var Ge=0,le=0,se=ue.FileIndex[0];Ge<ue.FileIndex.length;++Ge)se=ue.FileIndex[Ge],se.content&&(le=se.content.length,!(le<4096)&&(se.start=We,ut(le+511>>9)));for(ut(ve[6]+7>>3);Se.l&511;)Se.write_shift(-4,M.ENDOFCHAIN);for(We=Ee=0,Ge=0;Ge<ue.FileIndex.length;++Ge)se=ue.FileIndex[Ge],se.content&&(le=se.content.length,!(!le||le>=4096)&&(se.start=We,ut(le+63>>6)));for(;Se.l&511;)Se.write_shift(-4,M.ENDOFCHAIN);for(Ee=0;Ee<ve[4]<<2;++Ee){var ce=ue.FullPaths[Ee];if(!ce||ce.length===0){for(Ge=0;Ge<17;++Ge)Se.write_shift(4,0);for(Ge=0;Ge<3;++Ge)Se.write_shift(4,-1);for(Ge=0;Ge<12;++Ge)Se.write_shift(4,0);continue}se=ue.FileIndex[Ee],Ee===0&&(se.start=se.size?se.start-1:Z);var we=Ee===0&&ge.root||se.name;if(le=2*(we.length+1),Se.write_shift(64,we,"utf16le"),Se.write_shift(2,le),Se.write_shift(1,se.type),Se.write_shift(1,se.color),Se.write_shift(-4,se.L),Se.write_shift(-4,se.R),Se.write_shift(-4,se.C),se.clsid)Se.write_shift(16,se.clsid,"hex");else for(Ge=0;Ge<4;++Ge)Se.write_shift(4,0);Se.write_shift(4,se.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,se.start),Se.write_shift(4,se.size),Se.write_shift(4,0)}for(Ee=1;Ee<ue.FileIndex.length;++Ee)if(se=ue.FileIndex[Ee],se.size>=4096)if(Se.l=se.start+1<<9,Ir&&Buffer.isBuffer(se.content))se.content.copy(Se,Se.l,0,se.size),Se.l+=se.size+511&-512;else{for(Ge=0;Ge<se.size;++Ge)Se.write_shift(1,se.content[Ge]);for(;Ge&511;++Ge)Se.write_shift(1,0)}for(Ee=1;Ee<ue.FileIndex.length;++Ee)if(se=ue.FileIndex[Ee],se.size>0&&se.size<4096)if(Ir&&Buffer.isBuffer(se.content))se.content.copy(Se,Se.l,0,se.size),Se.l+=se.size+63&-64;else{for(Ge=0;Ge<se.size;++Ge)Se.write_shift(1,se.content[Ge]);for(;Ge&63;++Ge)Se.write_shift(1,0)}if(Ir)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function K(ue,ke){var ge=ue.FullPaths.map(function(Ge){return Ge.toUpperCase()}),ve=ge.map(function(Ge){var le=Ge.split("/");return le[le.length-(Ge.slice(-1)=="/"?2:1)]}),Se=!1;ke.charCodeAt(0)===47?(Se=!0,ke=ge[0].slice(0,-1)+ke):Se=ke.indexOf("/")!==-1;var Ee=ke.toUpperCase(),We=Se===!0?ge.indexOf(Ee):ve.indexOf(Ee);if(We!==-1)return ue.FileIndex[We];var ut=!Ee.match(Sm);for(Ee=Ee.replace(ai,""),ut&&(Ee=Ee.replace(Sm,"!")),We=0;We<ge.length;++We)if((ut?ge[We].replace(Sm,"!"):ge[We]).replace(ai,"")==Ee||(ut?ve[We].replace(Sm,"!"):ve[We]).replace(ai,"")==Ee)return ue.FileIndex[We];return null}var X=64,Z=-2,oe="d0cf11e0a1b11ae1",q=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",M={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Z,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function W(ue,ke,ge){d();var ve=I(ue,ge);c.writeFileSync(ke,ve)}function B(ue){for(var ke=new Array(ue.length),ge=0;ge<ue.length;++ge)ke[ge]=String.fromCharCode(ue[ge]);return ke.join("")}function G(ue,ke){var ge=I(ue,ke);switch(ke&&ke.type||"buffer"){case"file":return d(),c.writeFileSync(ke.filename,ge),ge;case"binary":return typeof ge=="string"?ge:B(ge);case"base64":return lp(typeof ge=="string"?ge:B(ge));case"buffer":if(Ir)return Buffer.isBuffer(ge)?ge:Ac(ge);case"array":return typeof ge=="string"?Li(ge):ge}return ge}var H;function O(ue){try{var ke=ue.InflateRaw,ge=new ke;if(ge._processChunk(new Uint8Array([3,0]),ge._finishFlushFlag),ge.bytesRead)H=ue;else throw new Error("zlib does not expose bytesRead")}catch(ve){console.error("cannot use native zlib: "+(ve.message||ve))}}function z(ue,ke){if(!H)return Ot(ue,ke);var ge=H.InflateRaw,ve=new ge,Se=ve._processChunk(ue.slice(ue.l),ve._finishFlushFlag);return ue.l+=ve.bytesRead,Se}function Y(ue){return H?H.deflateRawSync(ue):lt(ue)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ie(ue){var ke=(ue<<1|ue<<11)&139536|(ue<<5|ue<<15)&558144;return(ke>>16|ke>>8|ke)&255}for(var me=typeof Uint8Array<"u",Ce=me?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)Ce[Oe]=ie(Oe);function fe(ue,ke){var ge=Ce[ue&255];return ke<=8?ge>>>8-ke:(ge=ge<<8|Ce[ue>>8&255],ke<=16?ge>>>16-ke:(ge=ge<<8|Ce[ue>>16&255],ge>>>24-ke))}function pe(ue,ke){var ge=ke&7,ve=ke>>>3;return(ue[ve]|(ge<=6?0:ue[ve+1]<<8))>>>ge&3}function He(ue,ke){var ge=ke&7,ve=ke>>>3;return(ue[ve]|(ge<=5?0:ue[ve+1]<<8))>>>ge&7}function Ye(ue,ke){var ge=ke&7,ve=ke>>>3;return(ue[ve]|(ge<=4?0:ue[ve+1]<<8))>>>ge&15}function ot(ue,ke){var ge=ke&7,ve=ke>>>3;return(ue[ve]|(ge<=3?0:ue[ve+1]<<8))>>>ge&31}function Ve(ue,ke){var ge=ke&7,ve=ke>>>3;return(ue[ve]|(ge<=1?0:ue[ve+1]<<8))>>>ge&127}function Rt(ue,ke,ge){var ve=ke&7,Se=ke>>>3,Ee=(1<<ge)-1,We=ue[Se]>>>ve;return ge<8-ve||(We|=ue[Se+1]<<8-ve,ge<16-ve)||(We|=ue[Se+2]<<16-ve,ge<24-ve)||(We|=ue[Se+3]<<24-ve),We&Ee}function tt(ue,ke,ge){var ve=ke&7,Se=ke>>>3;return ve<=5?ue[Se]|=(ge&7)<<ve:(ue[Se]|=ge<<ve&255,ue[Se+1]=(ge&7)>>8-ve),ke+3}function Le(ue,ke,ge){var ve=ke&7,Se=ke>>>3;return ge=(ge&1)<<ve,ue[Se]|=ge,ke+1}function De(ue,ke,ge){var ve=ke&7,Se=ke>>>3;return ge<<=ve,ue[Se]|=ge&255,ge>>>=8,ue[Se+1]=ge,ke+8}function Je(ue,ke,ge){var ve=ke&7,Se=ke>>>3;return ge<<=ve,ue[Se]|=ge&255,ge>>>=8,ue[Se+1]=ge&255,ue[Se+2]=ge>>>8,ke+16}function _t(ue,ke){var ge=ue.length,ve=2*ge>ke?2*ge:ke+5,Se=0;if(ge>=ke)return ue;if(Ir){var Ee=pN(ve);if(ue.copy)ue.copy(Ee);else for(;Se<ue.length;++Se)Ee[Se]=ue[Se];return Ee}else if(me){var We=new Uint8Array(ve);if(We.set)We.set(ue);else for(;Se<ge;++Se)We[Se]=ue[Se];return We}return ue.length=ve,ue}function ht(ue){for(var ke=new Array(ue),ge=0;ge<ue;++ge)ke[ge]=0;return ke}function It(ue,ke,ge){var ve=1,Se=0,Ee=0,We=0,ut=0,Ge=ue.length,le=me?new Uint16Array(32):ht(32);for(Ee=0;Ee<32;++Ee)le[Ee]=0;for(Ee=Ge;Ee<ge;++Ee)ue[Ee]=0;Ge=ue.length;var se=me?new Uint16Array(Ge):ht(Ge);for(Ee=0;Ee<Ge;++Ee)le[Se=ue[Ee]]++,ve<Se&&(ve=Se),se[Ee]=0;for(le[0]=0,Ee=1;Ee<=ve;++Ee)le[Ee+16]=ut=ut+le[Ee-1]<<1;for(Ee=0;Ee<Ge;++Ee)ut=ue[Ee],ut!=0&&(se[Ee]=le[ut+16]++);var ce=0;for(Ee=0;Ee<Ge;++Ee)if(ce=ue[Ee],ce!=0)for(ut=fe(se[Ee],ve)>>ve-ce,We=(1<<ve+4-ce)-1;We>=0;--We)ke[ut|We<<ce]=ce&15|Ee<<4;return ve}var Mt=me?new Uint16Array(512):ht(512),rt=me?new Uint16Array(32):ht(32);if(!me){for(var qe=0;qe<512;++qe)Mt[qe]=0;for(qe=0;qe<32;++qe)rt[qe]=0}(function(){for(var ue=[],ke=0;ke<32;ke++)ue.push(5);It(ue,rt,32);var ge=[];for(ke=0;ke<=143;ke++)ge.push(8);for(;ke<=255;ke++)ge.push(9);for(;ke<=279;ke++)ge.push(7);for(;ke<=287;ke++)ge.push(8);It(ge,Mt,288)})();var pt=(function(){for(var ke=me?new Uint8Array(32768):[],ge=0,ve=0;ge<ee.length-1;++ge)for(;ve<ee[ge+1];++ve)ke[ve]=ge;for(;ve<32768;++ve)ke[ve]=29;var Se=me?new Uint8Array(259):[];for(ge=0,ve=0;ge<te.length-1;++ge)for(;ve<te[ge+1];++ve)Se[ve]=ge;function Ee(ut,Ge){for(var le=0;le<ut.length;){var se=Math.min(65535,ut.length-le),ce=le+se==ut.length;for(Ge.write_shift(1,+ce),Ge.write_shift(2,se),Ge.write_shift(2,~se&65535);se-- >0;)Ge[Ge.l++]=ut[le++]}return Ge.l}function We(ut,Ge){for(var le=0,se=0,ce=me?new Uint16Array(32768):[];se<ut.length;){var we=Math.min(65535,ut.length-se);if(we<10){for(le=tt(Ge,le,+(se+we==ut.length)),le&7&&(le+=8-(le&7)),Ge.l=le/8|0,Ge.write_shift(2,we),Ge.write_shift(2,~we&65535);we-- >0;)Ge[Ge.l++]=ut[se++];le=Ge.l*8;continue}le=tt(Ge,le,+(se+we==ut.length)+2);for(var Te=0;we-- >0;){var Be=ut[se];Te=(Te<<5^Be)&32767;var be=-1,nt=0;if((be=ce[Te])&&(be|=se&-32768,be>se&&(be-=32768),be<se))for(;ut[be+nt]==ut[se+nt]&&nt<250;)++nt;if(nt>2){Be=Se[nt],Be<=22?le=De(Ge,le,Ce[Be+1]>>1)-1:(De(Ge,le,3),le+=5,De(Ge,le,Ce[Be-23]>>5),le+=3);var vt=Be<8?0:Be-4>>2;vt>0&&(Je(Ge,le,nt-te[Be]),le+=vt),Be=ke[se-be],le=De(Ge,le,Ce[Be]>>3),le-=3;var Fe=Be<4?0:Be-2>>1;Fe>0&&(Je(Ge,le,se-be-ee[Be]),le+=Fe);for(var mt=0;mt<nt;++mt)ce[Te]=se&32767,Te=(Te<<5^ut[se])&32767,++se;we-=nt-1}else Be<=143?Be=Be+48:le=Le(Ge,le,1),le=De(Ge,le,Ce[Be]),ce[Te]=se&32767,++se}le=De(Ge,le,0)-1}return Ge.l=(le+7)/8|0,Ge.l}return function(Ge,le){return Ge.length<8?Ee(Ge,le):We(Ge,le)}})();function lt(ue){var ke=yt(50+Math.floor(ue.length*1.1)),ge=pt(ue,ke);return ke.slice(0,ge)}var wt=me?new Uint16Array(32768):ht(32768),Lt=me?new Uint16Array(32768):ht(32768),Ht=me?new Uint16Array(128):ht(128),Ie=1,at=1;function gt(ue,ke){var ge=ot(ue,ke)+257;ke+=5;var ve=ot(ue,ke)+1;ke+=5;var Se=Ye(ue,ke)+4;ke+=4;for(var Ee=0,We=me?new Uint8Array(19):ht(19),ut=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ge=1,le=me?new Uint8Array(8):ht(8),se=me?new Uint8Array(8):ht(8),ce=We.length,we=0;we<Se;++we)We[J[we]]=Ee=He(ue,ke),Ge<Ee&&(Ge=Ee),le[Ee]++,ke+=3;var Te=0;for(le[0]=0,we=1;we<=Ge;++we)se[we]=Te=Te+le[we-1]<<1;for(we=0;we<ce;++we)(Te=We[we])!=0&&(ut[we]=se[Te]++);var Be=0;for(we=0;we<ce;++we)if(Be=We[we],Be!=0){Te=Ce[ut[we]]>>8-Be;for(var be=(1<<7-Be)-1;be>=0;--be)Ht[Te|be<<Be]=Be&7|we<<3}var nt=[];for(Ge=1;nt.length<ge+ve;)switch(Te=Ht[Ve(ue,ke)],ke+=Te&7,Te>>>=3){case 16:for(Ee=3+pe(ue,ke),ke+=2,Te=nt[nt.length-1];Ee-- >0;)nt.push(Te);break;case 17:for(Ee=3+He(ue,ke),ke+=3;Ee-- >0;)nt.push(0);break;case 18:for(Ee=11+Ve(ue,ke),ke+=7;Ee-- >0;)nt.push(0);break;default:nt.push(Te),Ge<Te&&(Ge=Te);break}var vt=nt.slice(0,ge),Fe=nt.slice(ge);for(we=ge;we<286;++we)vt[we]=0;for(we=ve;we<30;++we)Fe[we]=0;return Ie=It(vt,wt,286),at=It(Fe,Lt,30),ke}function At(ue,ke){if(ue[0]==3&&!(ue[1]&3))return[Bu(ke),2];for(var ge=0,ve=0,Se=pN(ke||1<<18),Ee=0,We=Se.length>>>0,ut=0,Ge=0;(ve&1)==0;){if(ve=He(ue,ge),ge+=3,ve>>>1)ve>>1==1?(ut=9,Ge=5):(ge=gt(ue,ge),ut=Ie,Ge=at);else{ge&7&&(ge+=8-(ge&7));var le=ue[ge>>>3]|ue[(ge>>>3)+1]<<8;if(ge+=32,le>0)for(!ke&&We<Ee+le&&(Se=_t(Se,Ee+le),We=Se.length);le-- >0;)Se[Ee++]=ue[ge>>>3],ge+=8;continue}for(;;){!ke&&We<Ee+32767&&(Se=_t(Se,Ee+32767),We=Se.length);var se=Rt(ue,ge,ut),ce=ve>>>1==1?Mt[se]:wt[se];if(ge+=ce&15,ce>>>=4,(ce>>>8&255)===0)Se[Ee++]=ce;else{if(ce==256)break;ce-=257;var we=ce<8?0:ce-4>>2;we>5&&(we=0);var Te=Ee+te[ce];we>0&&(Te+=Rt(ue,ge,we),ge+=we),se=Rt(ue,ge,Ge),ce=ve>>>1==1?rt[se]:Lt[se],ge+=ce&15,ce>>>=4;var Be=ce<4?0:ce-2>>1,be=ee[ce];for(Be>0&&(be+=Rt(ue,ge,Be),ge+=Be),!ke&&We<Te&&(Se=_t(Se,Te+100),We=Se.length);Ee<Te;)Se[Ee]=Se[Ee-be],++Ee}}}return ke?[Se,ge+7>>>3]:[Se.slice(0,Ee),ge+7>>>3]}function Ot(ue,ke){var ge=ue.slice(ue.l||0),ve=At(ge,ke);return ue.l+=ve[1],ve[0]}function Jt(ue,ke){if(ue)typeof console<"u"&&console.error(ke);else throw new Error(ke)}function Ae(ue,ke){var ge=ue;pa(ge,0);var ve=[],Se=[],Ee={FileIndex:ve,FullPaths:Se};R(Ee,{root:ke.root});for(var We=ge.length-4;(ge[We]!=80||ge[We+1]!=75||ge[We+2]!=5||ge[We+3]!=6)&&We>=0;)--We;ge.l=We+4,ge.l+=4;var ut=ge.read_shift(2);ge.l+=6;var Ge=ge.read_shift(4);for(ge.l=Ge,We=0;We<ut;++We){ge.l+=20;var le=ge.read_shift(4),se=ge.read_shift(4),ce=ge.read_shift(2),we=ge.read_shift(2),Te=ge.read_shift(2);ge.l+=8;var Be=ge.read_shift(4),be=o(ge.slice(ge.l+ce,ge.l+ce+we));ge.l+=ce+we+Te;var nt=ge.l;ge.l=Be+4,ye(ge,le,se,Ee,be),ge.l=nt}return Ee}function ye(ue,ke,ge,ve,Se){ue.l+=2;var Ee=ue.read_shift(2),We=ue.read_shift(2),ut=i(ue);if(Ee&8257)throw new Error("Unsupported ZIP encryption");for(var Ge=ue.read_shift(4),le=ue.read_shift(4),se=ue.read_shift(4),ce=ue.read_shift(2),we=ue.read_shift(2),Te="",Be=0;Be<ce;++Be)Te+=String.fromCharCode(ue[ue.l++]);if(we){var be=o(ue.slice(ue.l,ue.l+we));(be[21589]||{}).mt&&(ut=be[21589].mt),((Se||{})[21589]||{}).mt&&(ut=Se[21589].mt)}ue.l+=we;var nt=ue.slice(ue.l,ue.l+le);switch(We){case 8:nt=z(ue,se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+We)}var vt=!1;Ee&8&&(Ge=ue.read_shift(4),Ge==134695760&&(Ge=ue.read_shift(4),vt=!0),le=ue.read_shift(4),se=ue.read_shift(4)),le!=ke&&Jt(vt,"Bad compressed size: "+ke+" != "+le),se!=ge&&Jt(vt,"Bad uncompressed size: "+ge+" != "+se),fr(ve,Te,nt,{unsafe:!0,mt:ut})}function he(ue,ke){var ge=ke||{},ve=[],Se=[],Ee=yt(1),We=ge.compression?8:0,ut=0,Ge=0,le=0,se=0,ce=0,we=ue.FullPaths[0],Te=we,Be=ue.FileIndex[0],be=[],nt=0;for(Ge=1;Ge<ue.FullPaths.length;++Ge)if(Te=ue.FullPaths[Ge].slice(we.length),Be=ue.FileIndex[Ge],!(!Be.size||!Be.content||Te=="Sh33tJ5")){var vt=se,Fe=yt(Te.length);for(le=0;le<Te.length;++le)Fe.write_shift(1,Te.charCodeAt(le)&127);Fe=Fe.slice(0,Fe.l),be[ce]=SH.buf(Be.content,0);var mt=Be.content;We==8&&(mt=Y(mt)),Ee=yt(30),Ee.write_shift(4,67324752),Ee.write_shift(2,20),Ee.write_shift(2,ut),Ee.write_shift(2,We),Be.mt?a(Ee,Be.mt):Ee.write_shift(4,0),Ee.write_shift(-4,be[ce]),Ee.write_shift(4,mt.length),Ee.write_shift(4,Be.content.length),Ee.write_shift(2,Fe.length),Ee.write_shift(2,0),se+=Ee.length,ve.push(Ee),se+=Fe.length,ve.push(Fe),se+=mt.length,ve.push(mt),Ee=yt(46),Ee.write_shift(4,33639248),Ee.write_shift(2,0),Ee.write_shift(2,20),Ee.write_shift(2,ut),Ee.write_shift(2,We),Ee.write_shift(4,0),Ee.write_shift(-4,be[ce]),Ee.write_shift(4,mt.length),Ee.write_shift(4,Be.content.length),Ee.write_shift(2,Fe.length),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(4,0),Ee.write_shift(4,vt),nt+=Ee.l,Se.push(Ee),nt+=Fe.length,Se.push(Fe),++ce}return Ee=yt(22),Ee.write_shift(4,101010256),Ee.write_shift(2,0),Ee.write_shift(2,0),Ee.write_shift(2,ce),Ee.write_shift(2,ce),Ee.write_shift(4,nt),Ee.write_shift(4,se),Ee.write_shift(2,0),Zs([Zs(ve),Zs(Se),Ee])}var _e={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $e(ue,ke){if(ue.ctype)return ue.ctype;var ge=ue.name||"",ve=ge.match(/\.([^\.]+)$/);return ve&&_e[ve[1]]||ke&&(ve=(ge=ke).match(/[\.\\]([^\.\\])+$/),ve&&_e[ve[1]])?_e[ve[1]]:"application/octet-stream"}function St(ue){for(var ke=lp(ue),ge=[],ve=0;ve<ke.length;ve+=76)ge.push(ke.slice(ve,ve+76));return ge.join(`\r
`)+`\r
`}function ct(ue){var ke=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var se=le.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});ke=ke.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ke.charAt(0)==`
`&&(ke="=0D"+ke.slice(1)),ke=ke.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var ge=[],ve=ke.split(`\r
`),Se=0;Se<ve.length;++Se){var Ee=ve[Se];if(Ee.length==0){ge.push("");continue}for(var We=0;We<Ee.length;){var ut=76,Ge=Ee.slice(We,We+ut);Ge.charAt(ut-1)=="="?ut--:Ge.charAt(ut-2)=="="?ut-=2:Ge.charAt(ut-3)=="="&&(ut-=3),Ge=Ee.slice(We,We+ut),We+=ut,We<Ee.length&&(Ge+="="),ge.push(Ge)}}return ge.join(`\r
`)}function zt(ue){for(var ke=[],ge=0;ge<ue.length;++ge){for(var ve=ue[ge];ge<=ue.length&&ve.charAt(ve.length-1)=="=";)ve=ve.slice(0,ve.length-1)+ue[++ge];ke.push(ve)}for(var Se=0;Se<ke.length;++Se)ke[Se]=ke[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(Ee){return String.fromCharCode(parseInt(Ee.slice(1),16))});return Li(ke.join(`\r
`))}function qt(ue,ke,ge){for(var ve="",Se="",Ee="",We,ut=0;ut<10;++ut){var Ge=ke[ut];if(!Ge||Ge.match(/^\s*$/))break;var le=Ge.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":ve=le[2].trim();break;case"content-type":Ee=le[2].trim();break;case"content-transfer-encoding":Se=le[2].trim();break}}switch(++ut,Se.toLowerCase()){case"base64":We=Li($i(ke.slice(ut).join("")));break;case"quoted-printable":We=zt(ke.slice(ut));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var se=fr(ue,ve.slice(ge.length),We,{unsafe:!0});Ee&&(se.ctype=Ee)}function Vt(ue,ke){if(B(ue.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var ge=ke&&ke.root||"",ve=(Ir&&Buffer.isBuffer(ue)?ue.toString("binary"):B(ue)).split(`\r
`),Se=0,Ee="";for(Se=0;Se<ve.length;++Se)if(Ee=ve[Se],!!/^Content-Location:/i.test(Ee)&&(Ee=Ee.slice(Ee.indexOf("file")),ge||(ge=Ee.slice(0,Ee.lastIndexOf("/")+1)),Ee.slice(0,ge.length)!=ge))for(;ge.length>0&&(ge=ge.slice(0,ge.length-1),ge=ge.slice(0,ge.lastIndexOf("/")+1),Ee.slice(0,ge.length)!=ge););var We=(ve[1]||"").match(/boundary="(.*?)"/);if(!We)throw new Error("MAD cannot find boundary");var ut="--"+(We[1]||""),Ge=[],le=[],se={FileIndex:Ge,FullPaths:le};R(se);var ce,we=0;for(Se=0;Se<ve.length;++Se){var Te=ve[Se];Te!==ut&&Te!==ut+"--"||(we++&&qt(se,ve.slice(ce,Se),ge),ce=Se)}return se}function gr(ue,ke){var ge=ke||{},ve=ge.boundary||"SheetJS";ve="------="+ve;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ve.slice(2)+'"',"","",""],Ee=ue.FullPaths[0],We=Ee,ut=ue.FileIndex[0],Ge=1;Ge<ue.FullPaths.length;++Ge)if(We=ue.FullPaths[Ge].slice(Ee.length),ut=ue.FileIndex[Ge],!(!ut.size||!ut.content||We=="Sh33tJ5")){We=We.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(nt){return"_x"+nt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(nt){return"_u"+nt.charCodeAt(0).toString(16)+"_"});for(var le=ut.content,se=Ir&&Buffer.isBuffer(le)?le.toString("binary"):B(le),ce=0,we=Math.min(1024,se.length),Te=0,Be=0;Be<=we;++Be)(Te=se.charCodeAt(Be))>=32&&Te<128&&++ce;var be=ce>=we*4/5;Se.push(ve),Se.push("Content-Location: "+(ge.root||"file:///C:/SheetJS/")+We),Se.push("Content-Transfer-Encoding: "+(be?"quoted-printable":"base64")),Se.push("Content-Type: "+$e(ut,We)),Se.push(""),Se.push(be?ct(se):St(se))}return Se.push(ve+`--\r
`),Se.join(`\r
`)}function Fr(ue){var ke={};return R(ke,ue),ke}function fr(ue,ke,ge,ve){var Se=ve&&ve.unsafe;Se||R(ue);var Ee=!Se&&lr.find(ue,ke);if(!Ee){var We=ue.FullPaths[0];ke.slice(0,We.length)==We?We=ke:(We.slice(-1)!="/"&&(We+="/"),We=(We+ke).replace("//","/")),Ee={name:s(ke),type:2},ue.FileIndex.push(Ee),ue.FullPaths.push(We),Se||lr.utils.cfb_gc(ue)}return Ee.content=ge,Ee.size=ge?ge.length:0,ve&&(ve.CLSID&&(Ee.clsid=ve.CLSID),ve.mt&&(Ee.mt=ve.mt),ve.ct&&(Ee.ct=ve.ct)),Ee}function cr(ue,ke){R(ue);var ge=lr.find(ue,ke);if(ge){for(var ve=0;ve<ue.FileIndex.length;++ve)if(ue.FileIndex[ve]==ge)return ue.FileIndex.splice(ve,1),ue.FullPaths.splice(ve,1),!0}return!1}function Pr(ue,ke,ge){R(ue);var ve=lr.find(ue,ke);if(ve){for(var Se=0;Se<ue.FileIndex.length;++Se)if(ue.FileIndex[Se]==ve)return ue.FileIndex[Se].name=s(ge),ue.FullPaths[Se]=ge,!0}return!1}function Xr(ue){D(ue,!0)}return t.find=K,t.read=P,t.parse=f,t.write=G,t.writeFile=W,t.utils={cfb_new:Fr,cfb_add:fr,cfb_del:cr,cfb_mov:Pr,cfb_gc:Xr,ReadShift:Im,CheckField:I8,prep_blob:pa,bconcat:Zs,use_zlib:O,_deflateRaw:lt,_inflateRaw:Ot,consts:M},t})();function kH(e){return typeof e=="string"?Jy(e):Array.isArray(e)?Yz(e):e}function Hp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Jy(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Cl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([kH(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Yu(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function CH(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ss(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function kN(e,t){for(var r=[],n=ss(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function ev(e){for(var t=[],r=ss(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function tv(e){for(var t=[],r=ss(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function TH(e){for(var t=[],r=ss(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var my=new Date(1899,11,30,0,0,0);function Bs(e,t){var r=e.getTime(),n=my.getTime()+(e.getTimezoneOffset()-my.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var g8=new Date,EH=my.getTime()+(g8.getTimezoneOffset()-my.getTimezoneOffset())*6e4,CN=g8.getTimezoneOffset();function rv(e){var t=new Date;return t.setTime(e*24*60*60*1e3+EH),t.getTimezoneOffset()!==CN&&t.setTime(t.getTime()+(t.getTimezoneOffset()-CN)*6e4),t}function NH(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var TN=new Date("2017-02-19T19:06:09.000Z"),m8=isNaN(TN.getFullYear())?new Date("2/19/17"):TN,AH=m8.getFullYear()==2017;function Dn(e,t){var r=new Date(e);if(AH)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(m8.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function ff(e,t){if(Ir&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Cl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Cl(r8(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Cl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Cl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function In(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=In(e[r]));return t}function rs(e,t){for(var r="";r.length<t;)r+=e;return r}function Ho(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var jH=["january","february","march","april","may","june","july","august","september","october","november","december"];function u0(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&jH.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var FH=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function p8(e){return e?e.content&&e.type?ff(e.content,!0):e.data?bm(e.data):e.asNodeBuffer&&Ir?bm(e.asNodeBuffer().toString("binary")):e.asBinary?bm(e.asBinary()):e._data&&e._data.getContent?bm(ff(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function x8(e){if(!e)return null;if(e.data)return gN(e.data);if(e.asNodeBuffer&&Ir)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?gN(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function PH(e){return e&&e.name.slice(-4)===".bin"?x8(e):p8(e)}function co(e,t){for(var r=e.FullPaths||ss(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function cS(e,t){var r=co(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function ks(e,t,r){if(!r)return PH(cS(e,t));if(!t)return null;try{return ks(e,t)}catch{return null}}function Bi(e,t,r){if(!r)return p8(cS(e,t));if(!t)return null;try{return Bi(e,t)}catch{return null}}function RH(e,t,r){return x8(cS(e,t))}function EN(e){for(var t=e.FullPaths||ss(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function jr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ir?n=Ac(r):n=Qz(r),lr.utils.cfb_add(e,t,n)}lr.utils.cfb_add(e,t,r)}else e.file(t,r)}function uS(){return lr.utils.cfb_new()}function y8(e,t){switch(t.type){case"base64":return lr.read(e,{type:"base64"});case"binary":return lr.read(e,{type:"binary"});case"buffer":case"array":return lr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function km(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var xs=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,DH=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,NN=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,IH=/<[^>]*>/g,$a=xs.match(NN)?NN:IH,MH=/<\w*:/,OH=/<(\/?)\w+:/;function vr(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(DH),o=0,c="",d=0,f="",p="",g=1;if(i)for(d=0;d!=i.length;++d){for(p=i[d],a=0;a!=p.length&&p.charCodeAt(a)!==61;++a);for(f=p.slice(0,a).trim();p.charCodeAt(a+1)==32;)++a;for(g=(s=p.charCodeAt(a+1))==34||s==39?1:0,c=p.slice(a+1+g,p.length-g),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var y=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[y]&&f.slice(o-3,o)=="ext")continue;n[y]=c,n[y.toLowerCase()]=c}}return n}function Rl(e){return e.replace(OH,"<$1")}var v8={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},dS=ev(v8),Kr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return v8[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),fS=/[&<>'"]/g,LH=/[\u0000-\u0008\u000b-\u001f]/g;function dn(e){var t=e+"";return t.replace(fS,function(r){return dS[r]}).replace(LH,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function AN(e){return dn(e).replace(/ /g,"_x0020_")}var w8=/[\u0000-\u001f]/g;function hS(e){var t=e+"";return t.replace(fS,function(r){return dS[r]}).replace(/\n/g,"<br/>").replace(w8,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function BH(e){var t=e+"";return t.replace(fS,function(r){return dS[r]}).replace(w8,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var jN=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function UH(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function jn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Bw(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function FN(e){var t=Bu(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function PN(e){return Ac(e,"binary").toString("utf8")}var p1="foo bar baz",yn=Ir&&(PN(p1)==Bw(p1)&&PN||FN(p1)==Bw(p1)&&FN)||Bw,Cl=Ir?function(e){return Ac(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},up=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),_8=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),$H=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),WH=/<\/?(?:vt:)?variant>/g,zH=/<(?:vt:)([^>]*)>([\s\S]*)</;function RN(e,t){var r=vr(e),n=e.match($H(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(WH,"").match(zH);i&&s.push({v:yn(i[2]),t:i[1]})}),s}var b8=/(^\s|\s$|\n)/;function va(e,t){return"<"+e+(t.match(b8)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function dp(e){return ss(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Bt(e,t,r){return"<"+e+(r!=null?dp(r):"")+(t!=null?(t.match(b8)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function a2(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function HH(e,t){switch(typeof e){case"string":var r=Bt("vt:lpwstr",dn(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Bt((e|0)==e?"vt:i4":"vt:r8",dn(String(e)));case"boolean":return Bt("vt:bool",e?"true":"false")}if(e instanceof Date)return Bt("vt:filetime",a2(e));throw new Error("Unable to serialize "+e)}function gS(e){if(Ir&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return yn(Yu(iS(e)));throw new Error("Bad input format: expected Buffer or string")}var fp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Os={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},wf=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Mi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function GH(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function VH(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var DN=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},IN=Ir?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Ac(t)})):DN(e)}:DN,MN=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(xc(e,s)));return n.join("").replace(ai,"")},mS=Ir?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(ai,""):MN(e,t,r)}:MN,ON=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},S8=Ir?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ON(e,t,r)}:ON,LN=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Dh(e,s)));return n.join("")},Gp=Ir?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):LN(t,r,n)}:LN,k8=function(e,t){var r=Oi(e,t);return r>0?Gp(e,t+4,t+4+r-1):""},C8=k8,T8=function(e,t){var r=Oi(e,t);return r>0?Gp(e,t+4,t+4+r-1):""},E8=T8,N8=function(e,t){var r=2*Oi(e,t);return r>0?Gp(e,t+4,t+4+r-1):""},A8=N8,j8=function(t,r){var n=Oi(t,r);return n>0?mS(t,r+4,r+4+n):""},F8=j8,P8=function(e,t){var r=Oi(e,t);return r>0?Gp(e,t+4,t+4+r):""},R8=P8,D8=function(e,t){return GH(e,t)},py=D8,pS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ir&&(C8=function(t,r){if(!Buffer.isBuffer(t))return k8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},E8=function(t,r){if(!Buffer.isBuffer(t))return T8(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},A8=function(t,r){if(!Buffer.isBuffer(t))return N8(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},F8=function(t,r){if(!Buffer.isBuffer(t))return j8(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},R8=function(t,r){if(!Buffer.isBuffer(t))return P8(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},py=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):D8(t,r)},pS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Dh=function(e,t){return e[t]},xc=function(e,t){return e[t+1]*256+e[t]},KH=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Oi=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Id=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},qH=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Im(e,t){var r="",n,s,a=[],i,o,c,d;switch(t){case"dbcs":if(d=this.l,Ir&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(xc(this,d)),d+=2;e*=2;break;case"utf8":r=Gp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=mS(this,this.l,this.l+e);break;case"wstr":return Im.call(this,e,"dbcs");case"lpstr-ansi":r=C8(this,this.l),e=4+Oi(this,this.l);break;case"lpstr-cp":r=E8(this,this.l),e=4+Oi(this,this.l);break;case"lpwstr":r=A8(this,this.l),e=4+2*Oi(this,this.l);break;case"lpp4":e=4+Oi(this,this.l),r=F8(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Oi(this,this.l),r=R8(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Dh(this,this.l+e++))!==0;)a.push(m1(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=xc(this,this.l+e))!==0;)a.push(m1(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=Dh(this,d),this.l=d+1,o=Im.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(m1(xc(this,d))),d+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return i=Dh(this,d),this.l=d+1,o=Im.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(m1(Dh(this,d))),d+=1}r=a.join("");break;default:switch(e){case 1:return n=Dh(this,this.l),this.l++,n;case 2:return n=(t==="i"?KH:xc)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Id:qH)(this,this.l),this.l+=4,n):(s=Oi(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=py(this,this.l):s=py([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=S8(this,this.l,e);break}}return this.l+=e,r}var XH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},YH=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},QH=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function JH(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)QH(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,XH(this,t,this.l);break;case 8:if(n=8,r==="f"){VH(this,t,this.l);break}case 16:break;case-4:n=4,YH(this,t,this.l);break}return this.l+=n,this}function I8(e,t){var r=S8(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function pa(e,t){e.l=t,e.read_shift=Im,e.chk=I8,e.write_shift=JH}function Ua(e,t){e.l+=t}function yt(e){var t=Bu(e);return pa(t,0),t}function jc(e,t,r){if(e){var n,s,a;pa(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var d=yp[o]||yp[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var f=d.f&&d.f(e,a,r);if(e.l=c,t(f,d,o))return}}}function ki(){var e=[],t=Ir?256:2048,r=function(d){var f=yt(d);return pa(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(d){return n&&d<n.length-n.l?n:(s(),n=r(Math.max(d+1,t)))},i=function(){return s(),Zs(e)},o=function(d){s(),n=d,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function kt(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=yp[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&pS(r)&&e.push(r)}}function Mm(e,t,r){var n=In(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function BN(e,t,r){var n=In(e);return n.s=Mm(n.s,t.s,r),n.e=Mm(n.e,t.s,r),n}function Om(e,t){if(e.cRel&&e.c<0)for(e=In(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=In(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=xr(e);return!e.cRel&&e.cRel!=null&&(r=tG(r)),!e.rRel&&e.rRel!=null&&(r=ZH(r)),r}function Uw(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Hn(e.s.c)+":"+(e.e.cRel?"":"$")+Hn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ms(e.s.r)+":"+(e.e.rRel?"":"$")+ms(e.e.r):Om(e.s,t.biff)+":"+Om(e.e,t.biff)}function xS(e){return parseInt(eG(e),10)-1}function ms(e){return""+(e+1)}function ZH(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function eG(e){return e.replace(/\$(\d+)$/,"$1")}function yS(e){for(var t=rG(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Hn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function tG(e){return e.replace(/^([A-Z])/,"$$$1")}function rG(e){return e.replace(/^\$([A-Z])/,"$1")}function nG(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Gn(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function xr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ci(e){var t=e.indexOf(":");return t==-1?{s:Gn(e),e:Gn(e)}:{s:Gn(e.slice(0,t)),e:Gn(e.slice(t+1))}}function Nr(e,t){return typeof t>"u"||typeof t=="number"?Nr(e.s,e.e):(typeof e!="string"&&(e=xr(e)),typeof t!="string"&&(t=xr(t)),e==t?e:e+":"+t)}function qr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function UN(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=yo(e.z,r?Bs(t):t)}catch{}try{return e.w=yo((e.XF||{}).numFmtId||(r?14:0),r?Bs(t):t)}catch{return""+t}}function Tc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Fc[e.v]||e.v:t==null?UN(e,e.v):UN(e,t))}function Qu(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function M8(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Gn(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=qr(a["!ref"]);d.s.c=f.s.c,d.s.r=f.s.r,d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(d.e.r=i=f.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=t[p].length;++g)if(!(typeof t[p][g]>"u")){var y={v:t[p][g]},v=i+p,w=o+g;if(d.s.r>v&&(d.s.r=v),d.s.c>w&&(d.s.c=w),d.e.r<v&&(d.e.r=v),d.e.c<w&&(d.e.c=w),t[p][g]&&typeof t[p][g]=="object"&&!Array.isArray(t[p][g])&&!(t[p][g]instanceof Date))y=t[p][g];else if(Array.isArray(y.v)&&(y.f=t[p][g][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||mr[14],n.cellDates?(y.t="d",y.w=yo(y.z,Bs(y.v))):(y.t="n",y.v=Bs(y.v),y.w=yo(y.z,y.v))):y.t="s";if(s)a[v]||(a[v]=[]),a[v][w]&&a[v][w].z&&(y.z=a[v][w].z),a[v][w]=y;else{var b=xr({c:w,r:v});a[b]&&a[b].z&&(y.z=a[b].z),a[b]=y}}}return d.s.c<1e7&&(a["!ref"]=Nr(d)),a}function F0(e,t){return M8(null,e,t)}function sG(e){return e.read_shift(4,"i")}function Go(e,t){return t||(t=yt(4)),t.write_shift(4,e),t}function La(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ta(e,t){var r=!1;return t==null&&(r=!0,t=yt(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function aG(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function iG(e,t){return t||(t=yt(4)),t.write_shift(2,0),t.write_shift(2,0),t}function vS(e,t){var r=e.l,n=e.read_shift(1),s=La(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(aG(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function oG(e,t){var r=!1;return t==null&&(r=!0,t=yt(15+4*e.t.length)),t.write_shift(1,0),ta(e.t,t),r?t.slice(0,t.l):t}var lG=vS;function cG(e,t){var r=!1;return t==null&&(r=!0,t=yt(23+4*e.t.length)),t.write_shift(1,1),ta(e.t,t),t.write_shift(4,1),iG({},t),r?t.slice(0,t.l):t}function vo(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function _f(e,t){return t==null&&(t=yt(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function bf(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Sf(e,t){return t==null&&(t=yt(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var uG=La,O8=ta;function wS(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function xy(e,t){var r=!1;return t==null&&(r=!0,t=yt(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var dG=La,i2=wS,_S=xy;function bS(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?py([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Id(t,0)>>2;return r?s/100:s}function L8(e,t){t==null&&(t=yt(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function B8(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function fG(e,t){return t||(t=yt(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var kf=B8,P0=fG;function Da(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function hf(e,t){return(t||yt(8)).write_shift(8,e,"f")}function hG(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var d=Vd[s];d&&(t.rgb=gp(d));break;case 2:t.rgb=gp([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function yy(e,t){if(t||(t=yt(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function gG(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function mG(e,t){t||(t=yt(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function U8(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function pG(e){return U8(e,1)}function xG(e){return U8(e,2)}var SS=2,yi=3,x1=11,$N=12,vy=19,y1=64,yG=65,vG=71,wG=4108,_G=4126,Ys=80,$8=81,bG=[Ys,$8],o2={1:{n:"CodePage",t:SS},2:{n:"Category",t:Ys},3:{n:"PresentationFormat",t:Ys},4:{n:"ByteCount",t:yi},5:{n:"LineCount",t:yi},6:{n:"ParagraphCount",t:yi},7:{n:"SlideCount",t:yi},8:{n:"NoteCount",t:yi},9:{n:"HiddenCount",t:yi},10:{n:"MultimediaClipCount",t:yi},11:{n:"ScaleCrop",t:x1},12:{n:"HeadingPairs",t:wG},13:{n:"TitlesOfParts",t:_G},14:{n:"Manager",t:Ys},15:{n:"Company",t:Ys},16:{n:"LinksUpToDate",t:x1},17:{n:"CharacterCount",t:yi},19:{n:"SharedDoc",t:x1},22:{n:"HyperlinksChanged",t:x1},23:{n:"AppVersion",t:yi,p:"version"},24:{n:"DigSig",t:yG},26:{n:"ContentType",t:Ys},27:{n:"ContentStatus",t:Ys},28:{n:"Language",t:Ys},29:{n:"Version",t:Ys},255:{},2147483648:{n:"Locale",t:vy},2147483651:{n:"Behavior",t:vy},1919054434:{}},l2={1:{n:"CodePage",t:SS},2:{n:"Title",t:Ys},3:{n:"Subject",t:Ys},4:{n:"Author",t:Ys},5:{n:"Keywords",t:Ys},6:{n:"Comments",t:Ys},7:{n:"Template",t:Ys},8:{n:"LastAuthor",t:Ys},9:{n:"RevNumber",t:Ys},10:{n:"EditTime",t:y1},11:{n:"LastPrinted",t:y1},12:{n:"CreatedDate",t:y1},13:{n:"ModifiedDate",t:y1},14:{n:"PageCount",t:yi},15:{n:"WordCount",t:yi},16:{n:"CharCount",t:yi},17:{n:"Thumbnail",t:vG},18:{n:"Application",t:Ys},19:{n:"DocSecurity",t:yi},255:{},2147483648:{n:"Locale",t:vy},2147483651:{n:"Behavior",t:vy},1919054434:{}},WN={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},SG=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function kG(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var CG=kG([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Vd=In(CG),Fc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},W8={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},c2={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},v1={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function kS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function TG(e){var t=kS();if(!e||!e.match)return t;var r={};if((e.match($a)||[]).forEach(function(n){var s=vr(n);switch(s[0].replace(MH,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[c2[s.ContentType]]!==void 0&&t[c2[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Os.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function z8(e,t){var r=TH(c2),n=[],s;n[n.length]=xs,n[n.length]=Bt("Types",null,{xmlns:Os.CT,"xmlns:xsd":Os.xsd,"xmlns:xsi":Os.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Bt("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=Bt("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:v1[c][t.bookType]||v1[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Bt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:v1[c][t.bookType]||v1[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(d){n[n.length]=Bt("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Br={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hp(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Lm(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match($a)||[]).forEach(function(s){var a=vr(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:km(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function Jh(e){var t=[xs,Bt("Relationships",null,{xmlns:Os.RELS})];return ss(e["!id"]).forEach(function(r){t[t.length]=Bt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function un(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[Br.HLINK,Br.XPATH,Br.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var EG="application/vnd.oasis.opendocument.spreadsheet";function NG(e,t){for(var r=gS(e),n,s;n=fp.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=vr(n[0],!1),s.path=="/"&&s.type!==EG)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function AG(e){var t=[xs];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function zN(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function jG(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function FG(e){var t=[xs];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(zN(e[r][0],e[r][1])),t.push(jG("",e[r][0]));return t.push(zN("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function H8(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+dy.version+"</meta:generator></office:meta></office:document-meta>"}var mo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],PG=(function(){for(var e=new Array(mo.length),t=0;t<mo.length;++t){var r=mo[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function G8(e){var t={};e=yn(e);for(var r=0;r<mo.length;++r){var n=mo[r],s=e.match(PG[r]);s!=null&&s.length>0&&(t[n[1]]=Kr(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Dn(t[n[1]]))}return t}function $w(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=dn(t),n[n.length]=r?Bt(e,t,r):va(e,t))}function V8(e,t){var r=t||{},n=[xs,Bt("cp:coreProperties",null,{"xmlns:cp":Os.CORE_PROPS,"xmlns:dc":Os.dc,"xmlns:dcterms":Os.dcterms,"xmlns:dcmitype":Os.dcmitype,"xmlns:xsi":Os.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&$w("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:a2(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&$w("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:a2(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=mo.length;++a){var i=mo[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&$w(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Kd=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],K8=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function q8(e,t,r,n){var s=[];if(typeof e=="string")s=RN(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?RN(t,n).map(function(f){return f.v}):t,o=0,c=0;if(i.length>0)for(var d=0;d!==s.length;d+=2){switch(c=+s[d+1].v,s[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function RG(e,t,r){var n={};return t||(t={}),e=yn(e),Kd.forEach(function(s){var a=(e.match(up(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Kr(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&q8(n.HeadingPairs,n.TitlesOfParts,t,r),t}function X8(e){var t=[],r=Bt;return e||(e={}),e.Application="SheetJS",t[t.length]=xs,t[t.length]=Bt("Properties",null,{xmlns:Os.EXT_PROPS,"xmlns:vt":Os.vt}),Kd.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=dn(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+dn(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var DG=/<[^>]+>[^<]*/g;function IG(e,t){var r={},n="",s=e.match(DG);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=vr(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Kr(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),d=c[0].slice(4),f=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Kr(f);break;case"bool":r[n]=jn(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=Dn(f);break;case"cy":case"error":r[n]=Kr(f);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,d,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Y8(e){var t=[xs,Bt("Properties",null,{xmlns:Os.CUST_PROPS,"xmlns:vt":Os.vt})];if(!e)return t.join("");var r=1;return ss(e).forEach(function(s){++r,t[t.length]=Bt("property",HH(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dn(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var u2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Ww;function MG(e,t,r){Ww||(Ww=ev(u2)),t=Ww[t]||t,e[t]=r}function OG(e,t){var r=[];return ss(u2).map(function(n){for(var s=0;s<mo.length;++s)if(mo[s][1]==n)return mo[s];for(s=0;s<Kd.length;++s)if(Kd[s][1]==n)return Kd[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(va(u2[n[1]]||n[1],s))}}),Bt("DocumentProperties",r.join(""),{xmlns:Mi.o})}function LG(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&ss(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<mo.length;++i)if(a==mo[i][1])return;for(i=0;i<Kd.length;++i)if(a==Kd[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(Bt(AN(a),o,{"dt:dt":c}))}}),t&&ss(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(Bt(AN(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Mi.o+'">'+s.join("")+"</"+n+">"}function CS(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function BG(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=yt(8);return i.write_shift(4,n),i.write_shift(4,s),i}function Q8(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function J8(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Z8(e,t,r){return t===31?J8(e):Q8(e,t,r)}function d2(e,t,r){return Z8(e,t,r===!1?0:4)}function UG(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Z8(e,t,0)}function $G(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(ai,""),e.l-s&2&&(e.l+=2)}return r}function WG(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(ai,"");return r}function zG(e){var t=e.l,r=wy(e,$8);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=wy(e,yi);return[r,n]}function HG(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(zG(e));return r}function HN(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(ai,"").replace(Sm,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function eF(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function GG(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function wy(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==$N&&n!==t&&bG.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===$N?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Q8(e,n,4).replace(ai,"");case 31:return J8(e);case 64:return CS(e);case 65:return eF(e);case 71:return GG(e);case 80:return d2(e,n,!a.raw).replace(ai,"");case 81:return UG(e,n).replace(ai,"");case 4108:return HG(e);case 4126:case 4127:return n==4127?$G(e):WG(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function GN(e,t){var r=yt(4),n=yt(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=yt(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=BG(t);break;case 31:case 80:for(n=yt(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Zs([r,n])}function VN(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,d={};for(i=0;i!=s;++i){var f=e.read_shift(4),p=e.read_shift(4);a[i]=[f,p+r]}a.sort(function(k,_){return k[1]-_[1]});var g={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var y=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,y=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],y=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],y=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(y=!1,e.l=a[i][1]),y)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[a[i][0]];if(g[v.n]=wy(e,v.t,{raw:!0}),v.p==="version"&&(g[v.n]=String(g[v.n]>>16)+"."+("0000"+String(g[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(g[v.n]){case 0:g[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:$o(o=g[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[v.n])}}else if(a[i][0]===1){if(o=g.CodePage=wy(e,SS),$o(o),c!==-1){var w=e.l;e.l=a[c][1],d=HN(e,o),e.l=w}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}d=HN(e,o)}else{var b=d[a[i][0]],E;switch(e[e.l]){case 65:e.l+=4,E=eF(e);break;case 30:e.l+=4,E=d2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=d2(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=hs(e,4);break;case 64:e.l+=4,E=Dn(CS(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[b]=E}}return e.l=r+n,g}var tF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function VG(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function KN(e,t,r){var n=yt(8),s=[],a=[],i=8,o=0,c=yt(8),d=yt(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),a.push(c),s.push(d),i+=8+c.length,!t){d=yt(8),d.write_shift(4,0),s.unshift(d);var f=[yt(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var p=e[o][0];for(c=yt(8+2*(p.length+1)+(p.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,p.length+1),c.write_shift(0,p,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=Zs(f),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(tF.indexOf(e[o][0])>-1||K8.indexOf(e[o][0])>-1)&&e[o][1]!=null){var g=e[o][1],y=0;if(t){y=+t[e[o][0]];var v=r[y];if(v.p=="version"&&typeof g=="string"){var w=g.split(".");g=(+w[0]<<16)+(+w[1]||0)}c=GN(v.t,g)}else{var b=VG(g);b==-1&&(b=31,g=String(g)),c=GN(b,g)}a.push(c),d=yt(8),d.write_shift(4,t?y:2+o),s.push(d),i+=8+c.length}var E=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,E),E+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Zs([n].concat(s).concat(a))}function qN(e,t,r){var n=e.content;if(!n)return{};pa(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),f=n.read_shift(16);if(f!==lr.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var p=VN(n,t),g={SystemIdentifier:d};for(var y in p)g[y]=p[y];if(g.FMTID=a,s===1)return g;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=VN(n,null)}catch{}for(y in v)g[y]=v[y];return g.FMTID=[a,i],g}function XN(e,t,r,n,s,a){var i=yt(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,lr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=KN(e,r,n);if(o.push(c),s){var d=KN(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(d)}return Zs(o)}function wu(e,t){return e.read_shift(t),null}function KG(e,t){t||(t=yt(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function qG(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function hs(e,t){return e.read_shift(t)===1}function ti(e,t){return t||(t=yt(2)),t.write_shift(2,+!!e),t}function Cs(e){return e.read_shift(2,"u")}function uo(e,t){return t||(t=yt(2)),t.write_shift(2,e),t}function rF(e,t){return qG(e,t,Cs)}function XG(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function nF(e,t,r){return r||(r=yt(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Vp(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function YG(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var d=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,d);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function QG(e){var t=e.t||"",r=yt(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=yt(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Zs(s)}function gf(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Kp(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):gf(e,n,r)}function Cf(e,t,r){if(r.biff>5)return Kp(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function sF(e,t,r){return r||(r=yt(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function JG(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ZG(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(ai,"");return n&&(e.l+=24),s}function eV(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(ai,"");return r+i}function tV(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ZG(e);case"0303000000000000c000000000000046":return eV(e);default:throw new Error("Unsupported Moniker "+r)}}function w1(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(ai,""):"";return r}function YN(e,t){t||(t=yt(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function rV(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,d="",f,p;s&16&&(a=w1(e,r-e.l)),s&128&&(i=w1(e,r-e.l)),(s&257)===257&&(o=w1(e,r-e.l)),(s&257)===1&&(c=tV(e,r-e.l)),s&8&&(d=w1(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(p=CS(e)),e.l=r;var g=i||o||c||"";g&&d&&(g+="#"+d),g||(g="#"+d),s&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var y={Target:g};return f&&(y.guid=f),p&&(y.time=p),a&&(y.Tooltip=a),y}function nV(e){var t=yt(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),YN(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&YN(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function aF(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function iF(e,t){var r=aF(e);return r[3]=0,r}function Dl(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function mf(e,t,r,n){return n||(n=yt(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function sV(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function aV(e,t,r){return t===0?"":Cf(e,t,r)}function iV(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function oF(e){var t=e.read_shift(2),r=bS(e);return[t,r]}function oV(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=Vp(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function nv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function lF(e,t){return t||(t=yt(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function cF(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var lV=cF;function uF(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function cV(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function uV(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Aa(e){e.l+=2,e.l+=e.read_shift(2)}var dV={0:Aa,4:Aa,5:Aa,6:Aa,7:uV,8:Aa,9:Aa,10:Aa,11:Aa,12:Aa,13:cV,14:Aa,15:Aa,16:Aa,17:Aa,18:Aa,19:Aa,20:Aa,21:uF};function fV(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(dV[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function _1(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function TS(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=yt(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function hV(e,t){return t===0||e.read_shift(2),1200}function gV(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Cf(e,0,r);return e.read_shift(t+n-e.l),s}function mV(e,t){var r=!t||t.biff==8,n=yt(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function pV(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function xV(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=Vp(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function yV(e,t){var r=!t||t.biff>=8?2:1,n=yt(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function vV(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(YG(e));return a.Count=n,a.Unique=s,a}function wV(e,t){var r=yt(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=QG(e[s]);var a=Zs([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function _V(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function bV(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function SV(e){var t=sV(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function kV(e){return e.read_shift(2),e.read_shift(4)}function QN(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function CV(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:d}}function TV(){var e=yt(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function EV(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function NV(e){var t=yt(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function AV(){}function jV(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Vp(e,0,r),n}function FV(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=yt(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function PV(e){var t=Dl(e);return t.isst=e.read_shift(4),t}function RV(e,t,r,n){var s=yt(10);return mf(e,t,n,s),s.write_shift(4,r),s}function DV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Dl(e);r.biff==2&&e.l++;var a=Kp(e,n-e.l,r);return s.val=a,s}function IV(e,t,r,n,s){var a=!s||s.biff==8,i=yt(8+ +a+(1+a)*r.length);return mf(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function MV(e,t,r){var n=e.read_shift(2),s=Cf(e,0,r);return[n,s]}function OV(e,t,r,n){var s=r&&r.biff==5;n||(n=yt(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var LV=Cf;function JN(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function BV(e,t){var r=t.biff==8||!t.biff?4:2,n=yt(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function UV(e){var t=e.read_shift(2),r=e.read_shift(2),n=oF(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function $V(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(oF(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function WV(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function zV(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=SG[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function HV(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=zV(e,t,n.fStyle,r),n}function ZN(e,t,r,n){var s=r&&r.biff==5;n||(n=yt(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function GV(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function VV(e){var t=yt(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function e3(e,t,r){var n=Dl(e);(r.biff==2||t==9)&&++e.l;var s=XG(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function KV(e,t,r,n,s,a){var i=yt(8);return mf(e,t,n,i),nF(r,a,i),i}function qV(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Dl(e),s=Da(e);return n.val=s,n}function XV(e,t,r,n){var s=yt(14);return mf(e,t,n,s),hf(r,s),s}var t3=aV;function YV(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=gf(e,a),o=[];n>e.l;)o.push(Kp(e));return[a,s,i,o]}function r3(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=oV(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var QV=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function n3(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=gf(e,i,r);s&32&&(d=QV[d.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var p=n==e.l||o===0||!(f>0)?[]:fQ(e,f,r,o);return{chKey:a,Name:d,itab:c,rgce:p}}function dF(e,t,r){if(r.biff<8)return JV(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(iV(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function JV(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Vp(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function ZV(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=gf(e,n,r),i=gf(e,s,r);return[a,i]}function eK(e,t,r){var n=cF(e);e.l++;var s=e.read_shift(1);return t-=8,[hQ(e,t,r),s,n]}function s3(e,t,r){var n=lV(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,uQ(e,t,r)]}function tK(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function rK(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=Cf(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function nK(e,t,r){return rK(e,t,r)}function sK(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(nv(e));return r}function aK(e){var t=yt(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)lF(e[r],t);return t}function iK(e,t,r){if(r&&r.biff<8)return lK(e,t,r);var n=uF(e),s=fV(e,t-22,n[1]);return{cmo:n,ft:s}}var oK={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function lK(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((oK[n]||Ua)(e,t,r)),{cmo:[s,n,a],ft:i}}function cK(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=JG(e,6,r);var o=e.read_shift(2);e.read_shift(2),Cs(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var f=e[e.l],p=gf(e,e.lens[d+1]-e.lens[d]-1);if(s+=p,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function uK(e,t){var r=nv(e);e.l+=16;var n=rV(e,t-24);return[r,n]}function dK(e){var t=yt(24),r=Gn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Zs([t,nV(e[1])])}function fK(e,t){e.read_shift(2);var r=nv(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(ai,""),[r,n]}function hK(e){var t=e[1].Tooltip,r=yt(10+2*(t.length+1));r.write_shift(2,2048);var n=Gn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function gK(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=WN[r]||r,r=e.read_shift(2),t[1]=WN[r]||r,t}function mK(e){return e||(e=yt(4)),e.write_shift(2,1),e.write_shift(2,1),e}function pK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iF(e));return r}function xK(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(iF(e));return r}function yK(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function fF(e,t,r){if(!r.cellStyles)return Ua(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var d={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(d.level=c>>8&7),d}function vK(e,t){var r=yt(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function wK(e,t){var r={};return t<32||(e.l+=16,r.header=Da(e),r.footer=Da(e),e.l+=2),r}function _K(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function bK(e){for(var t=yt(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var SK=Dl,kK=rF,CK=Kp;function TK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function EK(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Dl(e);++e.l;var s=Cf(e,t-7,r);return n.t="str",n.val=s,n}function NK(e){var t=Dl(e);++e.l;var r=Da(e);return t.t="n",t.val=r,t}function AK(e,t,r){var n=yt(15);return Qp(n,e,t),n.write_shift(8,r,"f"),n}function jK(e){var t=Dl(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function FK(e,t,r){var n=yt(9);return Qp(n,e,t),n.write_shift(2,r),n}function PK(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function RK(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function DK(e,t,r){var n=e.l+t,s=Dl(e),a=e.read_shift(2),i=gf(e,a,r);return e.l=n,s.t="str",s.val=i,s}var IK=[2,3,48,49,131,139,140,245],f2=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ev({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var d=[],f=Bu(1);switch(c.type){case"base64":f=Li($i(o));break;case"binary":f=Li(o);break;case"buffer":case"array":f=o;break}pa(f,0);var p=f.read_shift(1),g=!!(p&136),y=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:y=!0,g=!0;break;case 49:y=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var w=0,b=521;p==2&&(w=f.read_shift(2)),f.l+=3,p!=2&&(w=f.read_shift(4)),w>1048576&&(w=1e6),p!=2&&(b=f.read_shift(2));var E=f.read_shift(2),k=c.codepage||1252;p!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(k=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var _=[],N={},A=Math.min(f.length,p==2?521:b-10-(y?264:0)),P=v?32:11;f.l<A&&f[f.l]!=13;)switch(N={},N.name=op.utils.decode(k,f.slice(f.l,f.l+P)).replace(/[\u0000\r\n].*$/g,""),f.l+=P,N.type=String.fromCharCode(f.read_shift(1)),p!=2&&!v&&(N.offset=f.read_shift(4)),N.len=f.read_shift(1),p==2&&(N.offset=f.read_shift(2)),N.dec=f.read_shift(1),N.name.length&&_.push(N),p!=2&&(f.l+=v?13:14),N.type){case"B":(!y||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(f[f.l]!==13&&(f.l=b-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=b;var R=0,T=0;for(d[0]=[],T=0;T!=_.length;++T)d[0][T]=_[T].name;for(;w-- >0;){if(f[f.l]===42){f.l+=E;continue}for(++f.l,d[++R]=[],T=0,T=0;T!=_.length;++T){var D=f.slice(f.l,f.l+_[T].len);f.l+=_[T].len,pa(D,0);var I=op.utils.decode(k,D);switch(_[T].type){case"C":I.trim().length&&(d[R][T]=I.replace(/\s+$/,""));break;case"D":I.length===8?d[R][T]=new Date(+I.slice(0,4),+I.slice(4,6)-1,+I.slice(6,8)):d[R][T]=I;break;case"F":d[R][T]=parseFloat(I.trim());break;case"+":case"I":d[R][T]=v?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(I.trim().toUpperCase()){case"Y":case"T":d[R][T]=!0;break;case"N":case"F":d[R][T]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+I+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[R][T]="##MEMO##"+(v?parseInt(I.trim(),10):D.read_shift(4));break;case"N":I=I.replace(/\u0000/g,"").trim(),I&&I!="."&&(d[R][T]=+I||0);break;case"@":d[R][T]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":d[R][T]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":d[R][T]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[R][T]=-D.read_shift(-8,"f");break;case"B":if(y&&_[T].len==8){d[R][T]=D.read_shift(8,"f");break}case"G":case"P":D.l+=_[T].len;break;case"0":if(_[T].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[T].type)}}}if(p!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=_,d}function n(o,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var f=F0(r(o,d),d);return f["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,f}function s(o,c){try{return Qu(n(o,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var d=c||{};if(+d.codepage>=0&&$o(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var f=ki(),p=Sy(o,{header:1,raw:!0,cellDates:!0}),g=p[0],y=p.slice(1),v=o["!cols"]||[],w=0,b=0,E=0,k=1;for(w=0;w<g.length;++w){if(((v[w]||{}).DBF||{}).name){g[w]=v[w].DBF.name,++E;continue}if(g[w]!=null){if(++E,typeof g[w]=="number"&&(g[w]=g[w].toString(10)),typeof g[w]!="string")throw new Error("DBF Invalid column name "+g[w]+" |"+typeof g[w]+"|");if(g.indexOf(g[w])!==w){for(b=0;b<1024;++b)if(g.indexOf(g[w]+"_"+b)==-1){g[w]+="_"+b;break}}}}var _=qr(o["!ref"]),N=[],A=[],P=[];for(w=0;w<=_.e.c-_.s.c;++w){var R="",T="",D=0,I=[];for(b=0;b<y.length;++b)y[b][w]!=null&&I.push(y[b][w]);if(I.length==0||g[w]==null){N[w]="?";continue}for(b=0;b<I.length;++b){switch(typeof I[b]){case"number":T="B";break;case"string":T="C";break;case"boolean":T="L";break;case"object":T=I[b]instanceof Date?"D":"C";break;default:T="C"}D=Math.max(D,String(I[b]).length),R=R&&R!=T?"C":T}D>250&&(D=250),T=((v[w]||{}).DBF||{}).type,T=="C"&&v[w].DBF.len>D&&(D=v[w].DBF.len),R=="B"&&T=="N"&&(R="N",P[w]=v[w].DBF.dec,D=v[w].DBF.len),A[w]=R=="C"||T=="N"?D:a[R]||0,k+=A[w],N[w]=R}var K=f.next(32);for(K.write_shift(4,318902576),K.write_shift(4,y.length),K.write_shift(2,296+32*E),K.write_shift(2,k),w=0;w<4;++w)K.write_shift(4,0);for(K.write_shift(4,0|(+t[t8]||3)<<8),w=0,b=0;w<g.length;++w)if(g[w]!=null){var X=f.next(32),Z=(g[w].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,Z,"sbcs"),X.write_shift(1,N[w]=="?"?"C":N[w],"sbcs"),X.write_shift(4,b),X.write_shift(1,A[w]||a[N[w]]||0),X.write_shift(1,P[w]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),b+=A[w]||a[N[w]]||0}var oe=f.next(264);for(oe.write_shift(4,13),w=0;w<65;++w)oe.write_shift(4,0);for(w=0;w<y.length;++w){var q=f.next(k);for(q.write_shift(1,0),b=0;b<g.length;++b)if(g[b]!=null)switch(N[b]){case"L":q.write_shift(1,y[w][b]==null?63:y[w][b]?84:70);break;case"B":q.write_shift(8,y[w][b]||0,"f");break;case"N":var re="0";for(typeof y[w][b]=="number"&&(re=y[w][b].toFixed(P[b]||0)),E=0;E<A[b]-re.length;++E)q.write_shift(1,32);q.write_shift(1,re,"sbcs");break;case"D":y[w][b]?(q.write_shift(4,("0000"+y[w][b].getFullYear()).slice(-4),"sbcs"),q.write_shift(2,("00"+(y[w][b].getMonth()+1)).slice(-2),"sbcs"),q.write_shift(2,("00"+y[w][b].getDate()).slice(-2),"sbcs")):q.write_shift(8,"00000000","sbcs");break;case"C":var M=String(y[w][b]!=null?y[w][b]:"").slice(0,A[b]);for(q.write_shift(1,M,"sbcs"),E=0;E<A[b]-M.length;++E)q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),hF=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ss(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(g,y){var v=e[y];return typeof v=="number"?mN(v):v},n=function(g,y,v){var w=y.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return w==59?g:mN(w)};e["|"]=254;function s(g,y){switch(y.type){case"base64":return a($i(g),y);case"binary":return a(g,y);case"buffer":return a(Ir&&Buffer.isBuffer(g)?g.toString("binary"):Yu(g),y);case"array":return a(ff(g),y)}throw new Error("Unrecognized type "+y.type)}function a(g,y){var v=g.split(/[\n\r]+/),w=-1,b=-1,E=0,k=0,_=[],N=[],A=null,P={},R=[],T=[],D=[],I=0,K;for(+y.codepage>=0&&$o(+y.codepage);E!==v.length;++E){I=0;var X=v[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Z=X.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),oe=Z[0],q;if(X.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Z[1].charAt(0)=="P"&&N.push(X.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,M=!1,W=!1,B=!1,G=-1,H=-1;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"A":break;case"X":b=parseInt(Z[k].slice(1))-1,M=!0;break;case"Y":for(w=parseInt(Z[k].slice(1))-1,M||(b=0),K=_.length;K<=w;++K)_[K]=[];break;case"K":q=Z[k].slice(1),q.charAt(0)==='"'?q=q.slice(1,q.length-1):q==="TRUE"?q=!0:q==="FALSE"?q=!1:isNaN(Ho(q))?isNaN(u0(q).getDate())||(q=Dn(q)):(q=Ho(q),A!==null&&A0(A)&&(q=rv(q))),re=!0;break;case"E":B=!0;var O=Zh(Z[k].slice(1),{r:w,c:b});_[w][b]=[_[w][b],O];break;case"S":W=!0,_[w][b]=[_[w][b],"S5S"];break;case"G":break;case"R":G=parseInt(Z[k].slice(1))-1;break;case"C":H=parseInt(Z[k].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}if(re&&(_[w][b]&&_[w][b].length==2?_[w][b][0]=q:_[w][b]=q,A=null),W){if(B)throw new Error("SYLK shared formula cannot have own formula");var z=G>-1&&_[G][H];if(!z||!z[1])throw new Error("SYLK shared formula cannot find base");_[w][b][1]=FF(z[1],{r:w-G,c:b-H})}break;case"F":var Y=0;for(k=1;k<Z.length;++k)switch(Z[k].charAt(0)){case"X":b=parseInt(Z[k].slice(1))-1,++Y;break;case"Y":for(w=parseInt(Z[k].slice(1))-1,K=_.length;K<=w;++K)_[K]=[];break;case"M":I=parseInt(Z[k].slice(1))/20;break;case"F":break;case"G":break;case"P":A=N[parseInt(Z[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=Z[k].slice(1).split(" "),K=parseInt(D[0],10);K<=parseInt(D[1],10);++K)I=parseInt(D[2],10),T[K-1]=I===0?{hidden:!0}:{wch:I},Uu(T[K-1]);break;case"C":b=parseInt(Z[k].slice(1))-1,T[b]||(T[b]={});break;case"R":w=parseInt(Z[k].slice(1))-1,R[w]||(R[w]={}),I>0?(R[w].hpt=I,R[w].hpx=f0(I)):I===0&&(R[w].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}Y<1&&(A=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+X)}}return R.length>0&&(P["!rows"]=R),T.length>0&&(P["!cols"]=T),y&&y.sheetRows&&(_=_.slice(0,y.sheetRows)),[_,P]}function i(g,y){var v=s(g,y),w=v[0],b=v[1],E=F0(w,y);return ss(b).forEach(function(k){E[k]=b[k]}),E}function o(g,y){return Qu(i(g,y),y)}function c(g,y,v,w){var b="C;Y"+(v+1)+";X"+(w+1)+";K";switch(g.t){case"n":b+=g.v||0,g.f&&!g.F&&(b+=";E"+PS(g.f,{r:v,c:w}));break;case"b":b+=g.v?"TRUE":"FALSE";break;case"e":b+=g.w||g.v;break;case"d":b+='"'+(g.w||g.v)+'"';break;case"s":b+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function d(g,y){y.forEach(function(v,w){var b="F;W"+(w+1)+" "+(w+1)+" ";v.hidden?b+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=mp(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=pp(v.wpx)),typeof v.wch=="number"&&(b+=Math.round(v.wch))),b.charAt(b.length-1)!=" "&&g.push(b)})}function f(g,y){y.forEach(function(v,w){var b="F;";v.hidden?b+="M0;":v.hpt?b+="M"+20*v.hpt+";":v.hpx&&(b+="M"+20*xp(v.hpx)+";"),b.length>2&&g.push(b+"R"+(w+1))})}function p(g,y){var v=["ID;PWXL;N;E"],w=[],b=qr(g["!ref"]),E,k=Array.isArray(g),_=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&d(v,g["!cols"]),g["!rows"]&&f(v,g["!rows"]),v.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var N=b.s.r;N<=b.e.r;++N)for(var A=b.s.c;A<=b.e.c;++A){var P=xr({r:N,c:A});E=k?(g[N]||[])[A]:g[P],!(!E||E.v==null&&(!E.f||E.F))&&w.push(c(E,g,N,A))}return v.join(_)+_+w.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:p}})(),gF=(function(){function e(a,i){switch(i.type){case"base64":return t($i(a),i);case"binary":return t(a,i);case"buffer":return t(Ir&&Buffer.isBuffer(a)?a.toString("binary"):Yu(a),i);case"array":return t(ff(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,d=-1,f=0,p=[];f!==o.length;++f){if(o[f].trim()==="BOT"){p[++c]=[],d=0;continue}if(!(c<0)){var g=o[f].trim().split(","),y=g[0],v=g[1];++f;for(var w=o[f]||"";(w.match(/["]/g)||[]).length&1&&f<o.length-1;)w+=`
`+o[++f];switch(w=w.trim(),+y){case-1:if(w==="BOT"){p[++c]=[],d=0;continue}else if(w!=="EOD")throw new Error("Unrecognized DIF special command "+w);break;case 0:w==="TRUE"?p[c][d]=!0:w==="FALSE"?p[c][d]=!1:isNaN(Ho(v))?isNaN(u0(v).getDate())?p[c][d]=v:p[c][d]=Dn(v):p[c][d]=Ho(v),++d;break;case 1:w=w.slice(1,w.length-1),w=w.replace(/""/g,'"'),w&&w.match(/^=".*"$/)&&(w=w.slice(2,-1)),p[c][d++]=w!==""?w:null;break}if(w==="EOD")break}}return i&&i.sheetRows&&(p=p.slice(0,i.sheetRows)),p}function r(a,i){return F0(e(a,i),i)}function n(a,i){return Qu(r(a,i),i)}var s=(function(){var a=function(c,d,f,p,g){c.push(d),c.push(f+","+p),c.push('"'+g.replace(/"/g,'""')+'"')},i=function(c,d,f,p){c.push(d+","+f),c.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var d=[],f=qr(c["!ref"]),p,g=Array.isArray(c);a(d,"TABLE",0,1,"sheetjs"),a(d,"VECTORS",0,f.e.r-f.s.r+1,""),a(d,"TUPLES",0,f.e.c-f.s.c+1,""),a(d,"DATA",0,0,"");for(var y=f.s.r;y<=f.e.r;++y){i(d,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var w=xr({r:y,c:v});if(p=g?(c[y]||[])[v]:c[w],!p){i(d,1,0,"");continue}switch(p.t){case"n":var b=p.w;!b&&p.v!=null&&(b=p.v),b==null?p.f&&!p.F?i(d,1,0,"="+p.f):i(d,1,0,""):i(d,0,b,"V");break;case"b":i(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":i(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=yo(p.z||mr[14],Bs(Dn(p.v)))),i(d,0,p.w,"V");break;default:i(d,1,0,"")}}}i(d,-1,0,"EOD");var E=`\r
`,k=d.join(E);return k}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),mF=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,g){for(var y=p.split(`
`),v=-1,w=-1,b=0,E=[];b!==y.length;++b){var k=y[b].trim().split(":");if(k[0]==="cell"){var _=Gn(k[1]);if(E.length<=_.r)for(v=E.length;v<=_.r;++v)E[v]||(E[v]=[]);switch(v=_.r,w=_.c,k[2]){case"t":E[v][w]=e(k[3]);break;case"v":E[v][w]=+k[3];break;case"vtf":var N=k[k.length-1];case"vtc":switch(k[3]){case"nl":E[v][w]=!!+k[4];break;default:E[v][w]=+k[4];break}k[2]=="vtf"&&(E[v][w]=[E[v][w],N])}}}return g&&g.sheetRows&&(E=E.slice(0,g.sheetRows)),E}function n(p,g){return F0(r(p,g),g)}function s(p,g){return Qu(n(p,g),g)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var g=[],y=[],v,w="",b=Ci(p["!ref"]),E=Array.isArray(p),k=b.s.r;k<=b.e.r;++k)for(var _=b.s.c;_<=b.e.c;++_)if(w=xr({r:k,c:_}),v=E?(p[k]||[])[_]:p[w],!(!v||v.v==null||v.t==="z")){switch(y=["cell",w,"t"],v.t){case"s":case"str":y.push(t(v.v));break;case"n":v.f?(y[2]="vtf",y[3]="n",y[4]=v.v,y[5]=t(v.f)):(y[2]="v",y[3]=v.v);break;case"b":y[2]="vt"+(v.f?"f":"c"),y[3]="nl",y[4]=v.v?"1":"0",y[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=Bs(Dn(v.v));y[2]="vtc",y[3]="nd",y[4]=""+N,y[5]=v.w||yo(v.z||mr[14],N);break;case"e":continue}g.push(y.join(":"))}return g.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function f(p){return[a,i,o,i,d(p),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}})(),d0=(function(){function e(f,p,g,y,v){v.raw?p[g][y]=f:f===""||(f==="TRUE"?p[g][y]=!0:f==="FALSE"?p[g][y]=!1:isNaN(Ho(f))?isNaN(u0(f).getDate())?p[g][y]=f:p[g][y]=Dn(f):p[g][y]=Ho(f))}function t(f,p){var g=p||{},y=[];if(!f||f.length===0)return y;for(var v=f.split(/[\r\n]/),w=v.length-1;w>=0&&v[w].length===0;)--w;for(var b=10,E=0,k=0;k<=w;++k)E=v[k].indexOf(" "),E==-1?E=v[k].length:E++,b=Math.max(b,E);for(k=0;k<=w;++k){y[k]=[];var _=0;for(e(v[k].slice(0,b).trim(),y,k,_,g),_=1;_<=(v[k].length-b)/10+1;++_)e(v[k].slice(b+(_-1)*10,b+_*10).trim(),y,k,_,g)}return g.sheetRows&&(y=y.slice(0,g.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var p={},g=!1,y=0,v=0;y<f.length;++y)(v=f.charCodeAt(y))==34?g=!g:!g&&v in r&&(p[v]=(p[v]||0)+1);v=[];for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&v.push([p[y],y]);if(!v.length){p=n;for(y in p)Object.prototype.hasOwnProperty.call(p,y)&&v.push([p[y],y])}return v.sort(function(w,b){return w[0]-b[0]||n[w[1]]-n[b[1]]}),r[v.pop()[1]]||44}function a(f,p){var g=p||{},y="",v=g.dense?[]:{},w={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(y=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(y=f.charAt(4),f=f.slice(6)):y=s(f.slice(0,1024)):g&&g.FS?y=g.FS:y=s(f.slice(0,1024));var b=0,E=0,k=0,_=0,N=0,A=y.charCodeAt(0),P=!1,R=0,T=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var D=g.dateNF!=null?_H(g.dateNF):null;function I(){var K=f.slice(_,N),X={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)X.t="z";else if(g.raw)X.t="s",X.v=K;else if(K.trim().length===0)X.t="s",X.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(X.t="s",X.v=K.slice(2,-1).replace(/""/g,'"')):YX(K)?(X.t="n",X.f=K.slice(1)):(X.t="s",X.v=K);else if(K=="TRUE")X.t="b",X.v=!0;else if(K=="FALSE")X.t="b",X.v=!1;else if(!isNaN(k=Ho(K)))X.t="n",g.cellText!==!1&&(X.w=K),X.v=k;else if(!isNaN(u0(K).getDate())||D&&K.match(D)){X.z=g.dateNF||mr[14];var Z=0;D&&K.match(D)&&(K=bH(K,g.dateNF,K.match(D)||[]),Z=1),g.cellDates?(X.t="d",X.v=Dn(K,Z)):(X.t="n",X.v=Bs(Dn(K,Z))),g.cellText!==!1&&(X.w=yo(X.z,X.v instanceof Date?Bs(X.v):X.v)),g.cellNF||delete X.z}else X.t="s",X.v=K;if(X.t=="z"||(g.dense?(v[b]||(v[b]=[]),v[b][E]=X):v[xr({c:E,r:b})]=X),_=N+1,T=f.charCodeAt(_),w.e.c<E&&(w.e.c=E),w.e.r<b&&(w.e.r=b),R==A)++E;else if(E=0,++b,g.sheetRows&&g.sheetRows<=b)return!0}e:for(;N<f.length;++N)switch(R=f.charCodeAt(N)){case 34:T===34&&(P=!P);break;case A:case 10:case 13:if(!P&&I())break e;break}return N-_>0&&I(),v["!ref"]=Nr(w),v}function i(f,p){return!(p&&p.PRN)||p.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,p):F0(t(f,p),p)}function o(f,p){var g="",y=p.type=="string"?[0,0,0,0]:US(f,p);switch(p.type){case"base64":g=$i(f);break;case"binary":g=f;break;case"buffer":p.codepage==65001?g=f.toString("utf8"):p.codepage&&typeof op<"u"||(g=Ir&&Buffer.isBuffer(f)?f.toString("binary"):Yu(f));break;case"array":g=ff(f);break;case"string":g=f;break;default:throw new Error("Unrecognized type "+p.type)}return y[0]==239&&y[1]==187&&y[2]==191?g=yn(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=yn(g):p.type=="binary"&&typeof op<"u",g.slice(0,19)=="socialcalc:version:"?mF.to_sheet(p.type=="string"?g:yn(g),p):i(g,p)}function c(f,p){return Qu(o(f,p),p)}function d(f){for(var p=[],g=qr(f["!ref"]),y,v=Array.isArray(f),w=g.s.r;w<=g.e.r;++w){for(var b=[],E=g.s.c;E<=g.e.c;++E){var k=xr({r:w,c:E});if(y=v?(f[w]||[])[E]:f[k],!y||y.v==null){b.push("          ");continue}for(var _=(y.w||(Tc(y),y.w)||"").slice(0,10);_.length<10;)_+=" ";b.push(_+(E===0?" ":""))}p.push(b.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:d}})();function MK(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=hF.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return d0.to_workbook(e,t)}}var qd=(function(){function e(O,z,Y){if(O){pa(O,O.l||0);for(var J=Y.Enum||G;O.l<O.length;){var te=O.read_shift(2),ee=J[te]||J[65535],ie=O.read_shift(2),me=O.l+ie,Ce=ee.f&&ee.f(O,ie,Y);if(O.l=me,z(Ce,ee,te))return}}}function t(O,z){switch(z.type){case"base64":return r(Li($i(O)),z);case"binary":return r(Li(O),z);case"buffer":case"array":return r(O,z)}throw"Unsupported type "+z.type}function r(O,z){if(!O)return O;var Y=z||{},J=Y.dense?[]:{},te="Sheet1",ee="",ie=0,me={},Ce=[],Oe=[],fe={s:{r:0,c:0},e:{r:0,c:0}},pe=Y.sheetRows||0;if(O[2]==0&&(O[3]==8||O[3]==9)&&O.length>=16&&O[14]==5&&O[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(O[2]==2)Y.Enum=G,e(O,function(Ve,Rt,tt){switch(tt){case 0:Y.vers=Ve,Ve>=4096&&(Y.qpro=!0);break;case 6:fe=Ve;break;case 204:Ve&&(ee=Ve);break;case 222:ee=Ve;break;case 15:case 51:Y.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:tt==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=Y.dateNF||mr[14],Y.cellDates&&(Ve[1].t="d",Ve[1].v=rv(Ve[1].v))),Y.qpro&&Ve[3]>ie&&(J["!ref"]=Nr(fe),me[te]=J,Ce.push(te),J=Y.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},ie=Ve[3],te=ee||"Sheet"+(ie+1),ee="");var Le=Y.dense?(J[Ve[0].r]||[])[Ve[0].c]:J[xr(Ve[0])];if(Le){Le.t=Ve[1].t,Le.v=Ve[1].v,Ve[1].z!=null&&(Le.z=Ve[1].z),Ve[1].f!=null&&(Le.f=Ve[1].f);break}Y.dense?(J[Ve[0].r]||(J[Ve[0].r]=[]),J[Ve[0].r][Ve[0].c]=Ve[1]):J[xr(Ve[0])]=Ve[1];break}},Y);else if(O[2]==26||O[2]==14)Y.Enum=H,O[2]==14&&(Y.qpro=!0,O.l=0),e(O,function(Ve,Rt,tt){switch(tt){case 204:te=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>ie&&(J["!ref"]=Nr(fe),me[te]=J,Ce.push(te),J=Y.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},ie=Ve[3],te="Sheet"+(ie+1)),pe>0&&Ve[0].r>=pe)break;Y.dense?(J[Ve[0].r]||(J[Ve[0].r]=[]),J[Ve[0].r][Ve[0].c]=Ve[1]):J[xr(Ve[0])]=Ve[1],fe.e.c<Ve[0].c&&(fe.e.c=Ve[0].c),fe.e.r<Ve[0].r&&(fe.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(Oe[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:Oe[Ve[0]]=Ve[1],Ve[0]==ie&&(te=Ve[1]);break}},Y);else throw new Error("Unrecognized LOTUS BOF "+O[2]);if(J["!ref"]=Nr(fe),me[ee||te]=J,Ce.push(ee||te),!Oe.length)return{SheetNames:Ce,Sheets:me};for(var He={},Ye=[],ot=0;ot<Oe.length;++ot)me[Ce[ot]]?(Ye.push(Oe[ot]||Ce[ot]),He[Oe[ot]]=me[Oe[ot]]||me[Ce[ot]]):(Ye.push(Oe[ot]),He[Oe[ot]]={"!ref":"A1"});return{SheetNames:Ye,Sheets:He}}function n(O,z){var Y=z||{};if(+Y.codepage>=0&&$o(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK1 to JS string");var J=ki(),te=qr(O["!ref"]),ee=Array.isArray(O),ie=[];Ut(J,0,a(1030)),Ut(J,6,c(te));for(var me=Math.min(te.e.r,8191),Ce=te.s.r;Ce<=me;++Ce)for(var Oe=ms(Ce),fe=te.s.c;fe<=te.e.c;++fe){Ce===te.s.r&&(ie[fe]=Hn(fe));var pe=ie[fe]+Oe,He=ee?(O[Ce]||[])[fe]:O[pe];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?Ut(J,13,y(Ce,fe,He.v)):Ut(J,14,w(Ce,fe,He.v));else{var Ye=Tc(He);Ut(J,15,p(Ce,fe,Ye.slice(0,239)))}}return Ut(J,1),J.end()}function s(O,z){var Y=z||{};if(+Y.codepage>=0&&$o(+Y.codepage),Y.type=="string")throw new Error("Cannot write WK3 to JS string");var J=ki();Ut(J,0,i(O));for(var te=0,ee=0;te<O.SheetNames.length;++te)(O.Sheets[O.SheetNames[te]]||{})["!ref"]&&Ut(J,27,B(O.SheetNames[te],ee++));var ie=0;for(te=0;te<O.SheetNames.length;++te){var me=O.Sheets[O.SheetNames[te]];if(!(!me||!me["!ref"])){for(var Ce=qr(me["!ref"]),Oe=Array.isArray(me),fe=[],pe=Math.min(Ce.e.r,8191),He=Ce.s.r;He<=pe;++He)for(var Ye=ms(He),ot=Ce.s.c;ot<=Ce.e.c;++ot){He===Ce.s.r&&(fe[ot]=Hn(ot));var Ve=fe[ot]+Ye,Rt=Oe?(me[He]||[])[ot]:me[Ve];if(!(!Rt||Rt.t=="z"))if(Rt.t=="n")Ut(J,23,I(He,ot,ie,Rt.v));else{var tt=Tc(Rt);Ut(J,22,R(He,ot,ie,tt.slice(0,239)))}}++ie}}return Ut(J,1),J.end()}function a(O){var z=yt(2);return z.write_shift(2,O),z}function i(O){var z=yt(26);z.write_shift(2,4096),z.write_shift(2,4),z.write_shift(4,0);for(var Y=0,J=0,te=0,ee=0;ee<O.SheetNames.length;++ee){var ie=O.SheetNames[ee],me=O.Sheets[ie];if(!(!me||!me["!ref"])){++te;var Ce=Ci(me["!ref"]);Y<Ce.e.r&&(Y=Ce.e.r),J<Ce.e.c&&(J=Ce.e.c)}}return Y>8191&&(Y=8191),z.write_shift(2,Y),z.write_shift(1,te),z.write_shift(1,J),z.write_shift(2,0),z.write_shift(2,0),z.write_shift(1,1),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(4,0),z}function o(O,z,Y){var J={s:{c:0,r:0},e:{c:0,r:0}};return z==8&&Y.qpro?(J.s.c=O.read_shift(1),O.l++,J.s.r=O.read_shift(2),J.e.c=O.read_shift(1),O.l++,J.e.r=O.read_shift(2),J):(J.s.c=O.read_shift(2),J.s.r=O.read_shift(2),z==12&&Y.qpro&&(O.l+=2),J.e.c=O.read_shift(2),J.e.r=O.read_shift(2),z==12&&Y.qpro&&(O.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function c(O){var z=yt(8);return z.write_shift(2,O.s.c),z.write_shift(2,O.s.r),z.write_shift(2,O.e.c),z.write_shift(2,O.e.r),z}function d(O,z,Y){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Y.qpro&&Y.vers!=20768?(J[0].c=O.read_shift(1),J[3]=O.read_shift(1),J[0].r=O.read_shift(2),O.l+=2):(J[2]=O.read_shift(1),J[0].c=O.read_shift(2),J[0].r=O.read_shift(2)),J}function f(O,z,Y){var J=O.l+z,te=d(O,z,Y);if(te[1].t="s",Y.vers==20768){O.l++;var ee=O.read_shift(1);return te[1].v=O.read_shift(ee,"utf8"),te}return Y.qpro&&O.l++,te[1].v=O.read_shift(J-O.l,"cstr"),te}function p(O,z,Y){var J=yt(7+Y.length);J.write_shift(1,255),J.write_shift(2,z),J.write_shift(2,O),J.write_shift(1,39);for(var te=0;te<J.length;++te){var ee=Y.charCodeAt(te);J.write_shift(1,ee>=128?95:ee)}return J.write_shift(1,0),J}function g(O,z,Y){var J=d(O,z,Y);return J[1].v=O.read_shift(2,"i"),J}function y(O,z,Y){var J=yt(7);return J.write_shift(1,255),J.write_shift(2,z),J.write_shift(2,O),J.write_shift(2,Y,"i"),J}function v(O,z,Y){var J=d(O,z,Y);return J[1].v=O.read_shift(8,"f"),J}function w(O,z,Y){var J=yt(13);return J.write_shift(1,255),J.write_shift(2,z),J.write_shift(2,O),J.write_shift(8,Y,"f"),J}function b(O,z,Y){var J=O.l+z,te=d(O,z,Y);if(te[1].v=O.read_shift(8,"f"),Y.qpro)O.l=J;else{var ee=O.read_shift(2);N(O.slice(O.l,O.l+ee),te),O.l+=ee}return te}function E(O,z,Y){var J=z&32768;return z&=-32769,z=(J?O:0)+(z>=8192?z-16384:z),(J?"":"$")+(Y?Hn(z):ms(z))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(O,z){pa(O,0);for(var Y=[],J=0,te="",ee="",ie="",me="";O.l<O.length;){var Ce=O[O.l++];switch(Ce){case 0:Y.push(O.read_shift(8,"f"));break;case 1:ee=E(z[0].c,O.read_shift(2),!0),te=E(z[0].r,O.read_shift(2),!1),Y.push(ee+te);break;case 2:{var Oe=E(z[0].c,O.read_shift(2),!0),fe=E(z[0].r,O.read_shift(2),!1);ee=E(z[0].c,O.read_shift(2),!0),te=E(z[0].r,O.read_shift(2),!1),Y.push(Oe+fe+":"+ee+te)}break;case 3:if(O.l<O.length){console.error("WK1 premature formula end");return}break;case 4:Y.push("("+Y.pop()+")");break;case 5:Y.push(O.read_shift(2));break;case 6:{for(var pe="";Ce=O[O.l++];)pe+=String.fromCharCode(Ce);Y.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:Y.push("-"+Y.pop());break;case 23:Y.push("+"+Y.pop());break;case 22:Y.push("NOT("+Y.pop()+")");break;case 20:case 21:me=Y.pop(),ie=Y.pop(),Y.push(["AND","OR"][Ce-20]+"("+ie+","+me+")");break;default:if(Ce<32&&_[Ce])me=Y.pop(),ie=Y.pop(),Y.push(ie+_[Ce]+me);else if(k[Ce]){if(J=k[Ce][1],J==69&&(J=O[O.l++]),J>Y.length){console.error("WK1 bad formula parse 0x"+Ce.toString(16)+":|"+Y.join("|")+"|");return}var He=Y.slice(-J);Y.length-=J,Y.push(k[Ce][0]+"("+He.join(",")+")")}else return Ce<=7?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=24?console.error("WK1 unsupported op "+Ce.toString(16)):Ce<=30?console.error("WK1 invalid opcode "+Ce.toString(16)):Ce<=115?console.error("WK1 unsupported function opcode "+Ce.toString(16)):console.error("WK1 unrecognized opcode "+Ce.toString(16))}}Y.length==1?z[1].f=""+Y[0]:console.error("WK1 bad formula parse |"+Y.join("|")+"|")}function A(O){var z=[{c:0,r:0},{t:"n",v:0},0];return z[0].r=O.read_shift(2),z[3]=O[O.l++],z[0].c=O[O.l++],z}function P(O,z){var Y=A(O);return Y[1].t="s",Y[1].v=O.read_shift(z-4,"cstr"),Y}function R(O,z,Y,J){var te=yt(6+J.length);te.write_shift(2,O),te.write_shift(1,Y),te.write_shift(1,z),te.write_shift(1,39);for(var ee=0;ee<J.length;++ee){var ie=J.charCodeAt(ee);te.write_shift(1,ie>=128?95:ie)}return te.write_shift(1,0),te}function T(O,z){var Y=A(O);Y[1].v=O.read_shift(2);var J=Y[1].v>>1;if(Y[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return Y[1].v=J,Y}function D(O,z){var Y=A(O),J=O.read_shift(4),te=O.read_shift(4),ee=O.read_shift(2);if(ee==65535)return J===0&&te===3221225472?(Y[1].t="e",Y[1].v=15):J===0&&te===3489660928?(Y[1].t="e",Y[1].v=42):Y[1].v=0,Y;var ie=ee&32768;return ee=(ee&32767)-16446,Y[1].v=(1-ie*2)*(te*Math.pow(2,ee+32)+J*Math.pow(2,ee)),Y}function I(O,z,Y,J){var te=yt(14);if(te.write_shift(2,O),te.write_shift(1,Y),te.write_shift(1,z),J==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var ee=0,ie=0,me=0,Ce=0;return J<0&&(ee=1,J=-J),ie=Math.log2(J)|0,J/=Math.pow(2,ie-31),Ce=J>>>0,(Ce&2147483648)==0&&(J/=2,++ie,Ce=J>>>0),J-=Ce,Ce|=2147483648,Ce>>>=0,J*=Math.pow(2,32),me=J>>>0,te.write_shift(4,me),te.write_shift(4,Ce),ie+=16383+(ee?32768:0),te.write_shift(2,ie),te}function K(O,z){var Y=D(O);return O.l+=z-14,Y}function X(O,z){var Y=A(O),J=O.read_shift(4);return Y[1].v=J>>6,Y}function Z(O,z){var Y=A(O),J=O.read_shift(8,"f");return Y[1].v=J,Y}function oe(O,z){var Y=Z(O);return O.l+=z-10,Y}function q(O,z){return O[O.l+z-1]==0?O.read_shift(z,"cstr"):""}function re(O,z){var Y=O[O.l++];Y>z-1&&(Y=z-1);for(var J="";J.length<Y;)J+=String.fromCharCode(O[O.l++]);return J}function M(O,z,Y){if(!(!Y.qpro||z<21)){var J=O.read_shift(1);O.l+=17,O.l+=1,O.l+=2;var te=O.read_shift(z-21,"cstr");return[J,te]}}function W(O,z){for(var Y={},J=O.l+z;O.l<J;){var te=O.read_shift(2);if(te==14e3){for(Y[te]=[0,""],Y[te][0]=O.read_shift(2);O[O.l];)Y[te][1]+=String.fromCharCode(O[O.l]),O.l++;O.l++}}return Y}function B(O,z){var Y=yt(5+O.length);Y.write_shift(2,14e3),Y.write_shift(2,z);for(var J=0;J<O.length;++J){var te=O.charCodeAt(J);Y[Y.l++]=te>127?95:te}return Y[Y.l++]=0,Y}var G={0:{n:"BOF",f:Cs},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:q},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:P},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:T},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:W},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:Z},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:M},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function OK(e){var t={},r=e.match($a),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=vr(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=nS[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var LK=(function(){var e=up("t"),t=up("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Kr(i[1])},c=a.match(t);return c&&(o.s=OK(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),BK=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),UK=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,$K=/<(?:\w+:)?r>/,WK=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ES(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Kr(yn(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=yn(e),r&&(n.h=hS(n.t))):e.match($K)&&(n.r=yn(e),n.t=Kr(yn((e.replace(WK,"").match(UK)||[]).join("").replace($a,""))),r&&(n.h=BK(LK(n.r)))),n):{t:""}}var zK=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,HK=/<(?:\w+:)?(?:si|sstItem)>/g,GK=/<\/(?:\w+:)?(?:si|sstItem)>/;function VK(e,t){var r=[],n="";if(!e)return r;var s=e.match(zK);if(s){n=s[2].replace(HK,"").split(GK);for(var a=0;a!=n.length;++a){var i=ES(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=vr(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var KK=/^\s|\s$|[\t\n\r]/;function pF(e,t){if(!t.bookSST)return"";var r=[xs];r[r.length]=Bt("sst",null,{xmlns:wf[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(KK)&&(a+=' xml:space="preserve"'),a+=">"+dn(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function qK(e){return[e.read_shift(4),e.read_shift(4)]}function XK(e,t){var r=[],n=!1;return jc(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function YK(e,t){return t||(t=yt(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var QK=oG;function JK(e){var t=ki();kt(t,159,YK(e));for(var r=0;r<e.length;++r)kt(t,19,QK(e[r]));return kt(t,160),t.end()}function xF(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function _c(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function ZK(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=_c(e,4),t.U=_c(e,4),t.W=_c(e,4),t}function eq(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function tq(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(eq(e));return t}function rq(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function nq(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=_c(e,4),t.U=_c(e,4),t.W=_c(e,4),t}function sq(e){var t=nq(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function yF(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function vF(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function aq(e){var t=_c(e);switch(t.Minor){case 2:return[t.Minor,iq(e)];case 3:return[t.Minor,oq()];case 4:return[t.Minor,lq(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function iq(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=yF(e,r),s=vF(e,e.length-e.l);return{t:"Std",h:n,v:s}}function oq(){throw new Error("File is password-protected: ECMA-376 Extensible")}function lq(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace($a,function(a){var i=vr(a);switch(Rl(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function cq(e,t){var r={},n=r.EncryptionVersionInfo=_c(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=yF(e,s),t-=s,r.EncryptionVerifier=vF(e,t),r}function uq(e){var t={},r=t.EncryptionVersionInfo=_c(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function NS(e){var t=0,r,n=xF(e),s=n.length+1,a,i,o,c,d;for(r=Bu(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,d=o|c,t=d^i;return t^52811}var wF=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,d=i.length-1;d>=0;--d)for(var f=i[d],p=0;p!=7;++p)f&64&&(o^=r[c]),f*=2,--c;return o};return function(i){for(var o=xF(i),c=a(o),d=o.length,f=Bu(16),p=0;p!=16;++p)f[p]=0;var g,y,v;for((d&1)===1&&(g=c>>8,f[d]=s(e[0],g),--d,g=c&255,y=o[o.length-1],f[d]=s(y,g));d>0;)--d,g=c>>8,f[d]=s(o[d],g),--d,g=c&255,f[d]=s(o[d],g);for(d=15,v=15-o.length;v>0;)g=c>>8,f[d]=s(e[v],g),--d,--v,g=c&255,f[d]=s(o[d],g),--d,--v;return f}})(),dq=function(e,t,r,n,s){s||(s=t),n||(n=wF(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},fq=function(e){var t=0,r=wF(e);return function(n){var s=dq("",n,t,r);return t=s[1],s[0]}};function hq(e,t,r,n){var s={key:Cs(e),verificationBytes:Cs(e)};return r.password&&(s.verifier=NS(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=fq(r.password)),s}function gq(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=uq(e):n.Data=cq(e,t),n}function mq(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?gq(e,t-2,n):hq(e,r.biff>=8?t:t-2,r,n),n}var _F=(function(){function e(s,a){switch(a.type){case"base64":return t($i(s),a);case"binary":return t(s,a);case"buffer":return t(Ir&&Buffer.isBuffer(s)?s.toString("binary"):Yu(s),a);case"array":return t(ff(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,p){Array.isArray(o)&&(o[p]=[]);for(var g=/\\\w+\b/g,y=0,v,w=-1;v=g.exec(f);){switch(v[0]){case"\\cell":var b=f.slice(y,g.lastIndex-v[0].length);if(b[0]==" "&&(b=b.slice(1)),++w,b.length){var E={v:b,t:"s"};Array.isArray(o)?o[p][w]=E:o[xr({r:p,c:w})]=E}break}y=g.lastIndex}w>d.e.c&&(d.e.c=w)}),o["!ref"]=Nr(d),o}function r(s,a){return Qu(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=qr(s["!ref"]),o,c=Array.isArray(s),d=i.s.r;d<=i.e.r;++d){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var p=xr({r:d,c:f});o=c?(s[d]||[])[f]:s[p],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Tc(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function pq(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function gp(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function xq(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,d=s+a;switch(c=i/(d>1?2-d:d),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,d/2]}function yq(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var d=0;d!=3;++d)i[d]=Math.round(i[d]*255);return i}function _y(e,t){if(t===0)return e;var r=xq(pq(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),gp(yq(r))}var bF=6,vq=15,wq=1,Ra=bF;function mp(e){return Math.floor((e+Math.round(128/Ra)/256)*Ra)}function pp(e){return Math.floor((e-5)/Ra*100+.5)/100}function by(e){return Math.round((e*Ra+5)/Ra*256)/256}function zw(e){return by(pp(mp(e)))}function AS(e){var t=Math.abs(e-zw(e)),r=Ra;if(t>.005)for(Ra=wq;Ra<vq;++Ra)Math.abs(e-zw(e))<=t&&(t=Math.abs(e-zw(e)),r=Ra);Ra=r}function Uu(e){e.width?(e.wpx=mp(e.width),e.wch=pp(e.wpx),e.MDW=Ra):e.wpx?(e.wch=pp(e.wpx),e.width=by(e.wch),e.MDW=Ra):typeof e.wch=="number"&&(e.width=by(e.wch),e.wpx=mp(e.width),e.MDW=Ra),e.customWidth&&delete e.customWidth}var _q=96,SF=_q;function xp(e){return e*96/SF}function f0(e){return e*SF/96}var bq={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Sq(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match($a)||[]).forEach(function(i){var o=vr(i);switch(Rl(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=jn(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=jn(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function kq(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match($a)||[]).forEach(function(i){var o=vr(i);switch(Rl(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function Cq(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match($a)||[]).forEach(function(i){var o=vr(i);switch(Rl(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=yn(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?jn(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?jn(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?jn(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?jn(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?jn(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?jn(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?jn(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=nS[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=jn(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Vd[s.color.index];s.color.index==81&&(c=Vd[1]),c||(c=Vd[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=_y(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function Tq(e,t,r){t.NumberFmt=[];for(var n=ss(mr),s=0;s<n.length;++s)t.NumberFmt[n[s]]=mr[n[s]];var a=e[0].match($a);if(a)for(s=0;s<a.length;++s){var i=vr(a[s]);switch(Rl(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Kr(yn(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}wc(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function Eq(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Bt("numFmt",null,{numFmtId:n,formatCode:dn(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Bt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var b1=["numFmtId","fillId","fontId","borderId","xfId"],S1=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Nq(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match($a)||[]).forEach(function(a){var i=vr(a),o=0;switch(Rl(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<b1.length;++o)n[b1[o]]&&(n[b1[o]]=parseInt(n[b1[o]],10));for(o=0;o<S1.length;++o)n[S1[o]]&&(n[S1[o]]=jn(n[S1[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=jn(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function Aq(e){var t=[];return t[t.length]=Bt("cellXfs",null),e.forEach(function(r){t[t.length]=Bt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Bt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var jq=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,d){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=o.match(t))&&Tq(p,f,d),(p=o.match(s))&&Cq(p,f,c,d),(p=o.match(n))&&kq(p,f,c,d),(p=o.match(a))&&Sq(p,f,c,d),(p=o.match(r))&&Nq(p,f,d),f}})();function kF(e,t){var r=[xs,Bt("styleSheet",null,{xmlns:wf[0],"xmlns:vt":Os.vt})],n;return e.SSF&&(n=Eq(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Aq(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Fq(e,t){var r=e.read_shift(2),n=La(e);return[r,n]}function Pq(e,t,r){r||(r=yt(6+4*t.length)),r.write_shift(2,e),ta(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Rq(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=gG(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=hG(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=La(e),n}function Dq(e,t){t||(t=yt(153)),t.write_shift(2,e.sz*20),mG(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),yy(e.color,t);var n=0;return n=2,t.write_shift(1,n),ta(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Iq=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hw,Mq=Ua;function a3(e,t){t||(t=yt(84)),Hw||(Hw=ev(Iq));var r=Hw[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(yy({auto:1},t),yy({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Oq(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function CF(e,t,r){r||(r=yt(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ym(e,t){return t||(t=yt(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Lq=Ua;function Bq(e,t){return t||(t=yt(51)),t.write_shift(1,0),ym(null,t),ym(null,t),ym(null,t),ym(null,t),ym(null,t),t.length>t.l?t.slice(0,t.l):t}function Uq(e,t){return t||(t=yt(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),xy(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function $q(e,t,r){var n=yt(2052);return n.write_shift(4,e),xy(t,n),xy(r,n),n.length>n.l?n.slice(0,n.l):n}function Wq(e,t,r){var n={};n.NumberFmt=[];for(var s in mr)n.NumberFmt[s]=mr[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return jc(e,function(c,d,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],wc(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=_y(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(d.T>0)a.push(f);else if(d.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function zq(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(kt(e,615,Go(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&kt(e,44,Pq(s,t[s]))}),kt(e,616))}}function Hq(e){var t=1;kt(e,611,Go(t)),kt(e,43,Dq({sz:12,color:{theme:1},name:"Calibri",family:2})),kt(e,612)}function Gq(e){var t=2;kt(e,603,Go(t)),kt(e,45,a3({patternType:"none"})),kt(e,45,a3({patternType:"gray125"})),kt(e,604)}function Vq(e){var t=1;kt(e,613,Go(t)),kt(e,46,Bq()),kt(e,614)}function Kq(e){var t=1;kt(e,626,Go(t)),kt(e,47,CF({numFmtId:0},65535)),kt(e,627)}function qq(e,t){kt(e,617,Go(t.length)),t.forEach(function(r){kt(e,47,CF(r,0))}),kt(e,618)}function Xq(e){var t=1;kt(e,619,Go(t)),kt(e,48,Uq({xfId:0,name:"Normal"})),kt(e,620)}function Yq(e){var t=0;kt(e,505,Go(t)),kt(e,506)}function Qq(e){var t=0;kt(e,508,$q(t,"TableStyleMedium9","PivotStyleMedium4")),kt(e,509)}function Jq(e,t){var r=ki();return kt(r,278),zq(r,e.SSF),Hq(r),Gq(r),Vq(r),Kq(r),qq(r,t.cellXfs),Xq(r),Yq(r),Qq(r),kt(r,279),r.end()}var Zq=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function eX(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match($a)||[]).forEach(function(s){var a=vr(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[Zq.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function tX(){}function rX(){}var nX=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,sX=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,aX=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function iX(e,t,r){t.themeElements={};var n;[["clrScheme",nX,eX],["fontScheme",sX,tX],["fmtScheme",aX,rX]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var oX=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function TF(e,t){(!e||e.length===0)&&(e=jS());var r,n={};if(!(r=e.match(oX)))throw new Error("themeElements not found in theme");return iX(r[0],n,t),n.raw=e,n}function jS(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[xs];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function lX(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=y8(a,{type:"array"})}catch{return}var o=Bi(i,"theme/theme/theme1.xml",!0);if(o)return TF(o,r)}}function cX(e){return e.read_shift(4)}function uX(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=dX(e,4);break;case 2:t.xclrValue=aF(e);break;case 3:t.xclrValue=cX(e);break;case 4:e.l+=4;break}return e.l+=8,t}function dX(e,t){return Ua(e,t)}function fX(e,t){return Ua(e,t)}function hX(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=uX(e);break;case 6:n[1]=fX(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function gX(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(hX(e,r-e.l));return{ixfe:n,ext:a}}function mX(e,t){t.forEach(function(r){r[0]})}function pX(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:La(e)}}function xX(e){var t=yt(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ta(e.name,t),t.slice(0,t.l)}function yX(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function vX(e){var t=yt(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function wX(e,t){var r=yt(8+2*t.length);return r.write_shift(4,e),ta(t,r),r.slice(0,r.l)}function _X(e){return e.l+=4,e.read_shift(4)!=0}function bX(e,t){var r=yt(8);return r.write_shift(4,e),r.write_shift(4,1),r}function SX(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return jc(e,function(c,d,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(p){o==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):o==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!d.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function kX(){var e=ki();return kt(e,332),kt(e,334,Go(1)),kt(e,335,xX({name:"XLDAPR",version:12e4,flags:3496657072})),kt(e,336),kt(e,339,wX(1,"XLDAPR")),kt(e,52),kt(e,35,Go(514)),kt(e,4096,Go(0)),kt(e,4097,uo(1)),kt(e,36),kt(e,53),kt(e,340),kt(e,337,bX(1)),kt(e,51,vX([[1,0]])),kt(e,338),kt(e,333),e.end()}function CX(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace($a,function(o){var c=vr(o);switch(Rl(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==c.name&&(i=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function EF(){var e=[xs];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function TX(e){var t=[];if(!e)return t;var r=1;return(e.match($a)||[]).forEach(function(n){var s=vr(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function EX(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=xr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function NX(e,t,r){var n=[];return jc(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function AX(e,t,r,n){if(!e)return e;var s=n||{},a=!1;jc(e,function(o,c,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},s)}function jX(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var zh=1024;function NF(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[Bt("xml",null,{"xmlns:v":Mi.v,"xmlns:o":Mi.o,"xmlns:x":Mi.x,"xmlns:mv":Mi.mv}).replace(/\/>/,">"),Bt("o:shapelayout",Bt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Bt("v:shapetype",[Bt("v:stroke",null,{joinstyle:"miter"}),Bt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];zh<e*1e3;)zh+=1e3;return t.forEach(function(a){var i=Gn(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Bt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Bt("v:fill",c,o),f={on:"t",obscured:"t"};++zh,s=s.concat(["<v:shape"+dp({id:"_x0000_s"+zh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Bt("v:shadow",null,f),Bt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",va("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),va("x:AutoFill","False"),va("x:Row",String(i.r)),va("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function i3(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=Gn(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=qr(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var d=Nr(c);d!==e["!ref"]&&(e["!ref"]=d)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var p=a.c.length-1;p>=0;--p){if(!r&&a.c[p].T)return;r&&!a.c[p].T&&a.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(f.a==n[p].id){f.a=n[p].name||f.a;break}}a.c.push(f)})}function FX(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=vr(o[0]),d={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=Gn(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var p=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&ES(p[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=g.h),n.push(d)}}}}),n}function AF(e){var t=[xs,Bt("comments",null,{xmlns:wf[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=dn(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(dn(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(va("t",dn(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(va("t",dn(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function PX(e,t){var r=[],n=!1,s={},a=0;return e.replace($a,function(o,c){var d=vr(o);switch(Rl(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return o}),r}function RX(e,t,r){var n=[xs,Bt("ThreadedComments",null,{xmlns:Os.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(Bt("threadedComment",va("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function DX(e,t){var r=[],n=!1;return e.replace($a,function(a){var i=vr(a);switch(Rl(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function IX(e){var t=[xs,Bt("personList",null,{xmlns:Os.TCMNT,"xmlns:x":wf[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Bt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function MX(e){var t={};t.iauthor=e.read_shift(4);var r=kf(e);return t.rfx=r.s,t.ref=xr(r.s),e.l+=16,t}function OX(e,t){return t==null&&(t=yt(36)),t.write_shift(4,e[1].iauthor),P0(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var LX=La;function BX(e){return ta(e.slice(0,54))}function UX(e,t){var r=[],n=[],s={},a=!1;return jc(e,function(o,c,d){switch(d){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function $X(e){var t=ki(),r=[];return kt(t,628),kt(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),kt(t,632,BX(s.a)))})}),kt(t,631),kt(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:Gn(n[0]),e:Gn(n[0])};kt(t,635,OX([a,s])),s.t&&s.t.length>0&&kt(t,637,cG(s)),kt(t,636),delete s.iauthor})}),kt(t,634),kt(t,629),t.end()}var WX="application/vnd.ms-office.vbaProject";function zX(e){var t=lr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");lr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),lr.write(t)}function HX(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&lr.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var jF=["xlsb","xlsm","xlam","biff8","xla"];function GX(){return{"!type":"dialog"}}function VX(){return{"!type":"dialog"}}function KX(){return{"!type":"macro"}}function qX(){return{"!type":"macro"}}var Zh=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var d=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,c?d+=t.r:--d,s+(o?"":"$")+Hn(f)+(c?"":"$")+ms(d)}return function(s,a){return t=a,s.replace(e,r)}})(),FS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,PS=(function(){return function(t,r){return t.replace(FS,function(n,s,a,i,o,c){var d=yS(i)-(a?0:r.c),f=xS(c)-(o?0:r.r),p=f==0?"":o?f+1:"["+f+"]",g=d==0?"":a?d+1:"["+d+"]";return s+"R"+p+"C"+g})}})();function FF(e,t){return e.replace(FS,function(r,n,s,a,i,o){return n+(s=="$"?s+a:Hn(yS(a)+t.c))+(i=="$"?i+o:ms(xS(o)+t.r))})}function XX(e,t,r){var n=Ci(t),s=n.s,a=Gn(r),i={r:a.r-s.r,c:a.c-s.c};return FF(e,i)}function YX(e){return e.length!=1}function o3(e){return e.replace(/_xlfn\./g,"")}function Ss(e){e.l+=1}function $u(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function PF(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return RF(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=$u(e),o=$u(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function RF(e){var t=$u(e),r=$u(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function QX(e,t,r){if(r.biff<8)return RF(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=$u(e),i=$u(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function DF(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return JX(e);var n=e.read_shift(r&&r.biff==12?4:2),s=$u(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function JX(e){var t=$u(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function ZX(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function eY(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return tY(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function tY(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function rY(e,t,r){var n=(e[e.l++]&96)>>5,s=PF(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function nY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=PF(e,a,r);return[n,s,i]}function sY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function aY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function iY(e,t,r){var n=(e[e.l++]&96)>>5,s=QX(e,t-1,r);return[n,s]}function oY(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function l3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function lY(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function cY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function uY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function dY(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function fY(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function IF(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function hY(e){return e.read_shift(2),IF(e)}function gY(e){return e.read_shift(2),IF(e)}function mY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=DF(e,0,r);return[n,s]}function pY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=eY(e,0,r);return[n,s]}function xY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=DF(e,0,r);return[n,s,a]}function yY(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[_Q[s],LF[s],n]}function vY(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:wY(e);return[s,(a[0]===0?LF:wQ)[a[1]]]}function wY(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function _Y(e,t,r){e.l+=r&&r.biff==2?3:4}function bY(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function SY(e){return e.l++,Fc[e.read_shift(1)]}function kY(e){return e.l++,e.read_shift(2)}function CY(e){return e.l++,e.read_shift(1)!==0}function TY(e){return e.l++,Da(e)}function EY(e,t,r){return e.l++,Vp(e,t-1,r)}function NY(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=hs(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Fc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Da(e);break;case 2:r[1]=Cf(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function AY(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?kf:nv)(e));return s}function jY(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=NY(e,r.biff);return i}function FY(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function PY(e,t,r){if(r.biff==5)return RY(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function RY(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function DY(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function IY(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function MY(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function OY(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var LY=Ua,BY=Ua,UY=Ua;function qp(e,t,r){return e.l+=2,[ZX(e)]}function RS(e){return e.l+=6,[]}var $Y=qp,WY=RS,zY=RS,HY=qp;function MF(e){return e.l+=2,[Cs(e),e.read_shift(2)&1]}var GY=qp,VY=MF,KY=RS,qY=qp,XY=qp,YY=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function QY(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=YY[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function JY(e){return e.l+=2,[e.read_shift(4)]}function ZY(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function eQ(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function tQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function rQ(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function nQ(e){return e.l+=4,[0,0]}var c3={1:{n:"PtgExp",f:bY},2:{n:"PtgTbl",f:UY},3:{n:"PtgAdd",f:Ss},4:{n:"PtgSub",f:Ss},5:{n:"PtgMul",f:Ss},6:{n:"PtgDiv",f:Ss},7:{n:"PtgPower",f:Ss},8:{n:"PtgConcat",f:Ss},9:{n:"PtgLt",f:Ss},10:{n:"PtgLe",f:Ss},11:{n:"PtgEq",f:Ss},12:{n:"PtgGe",f:Ss},13:{n:"PtgGt",f:Ss},14:{n:"PtgNe",f:Ss},15:{n:"PtgIsect",f:Ss},16:{n:"PtgUnion",f:Ss},17:{n:"PtgRange",f:Ss},18:{n:"PtgUplus",f:Ss},19:{n:"PtgUminus",f:Ss},20:{n:"PtgPercent",f:Ss},21:{n:"PtgParen",f:Ss},22:{n:"PtgMissArg",f:Ss},23:{n:"PtgStr",f:EY},26:{n:"PtgSheet",f:ZY},27:{n:"PtgEndSheet",f:eQ},28:{n:"PtgErr",f:SY},29:{n:"PtgBool",f:CY},30:{n:"PtgInt",f:kY},31:{n:"PtgNum",f:TY},32:{n:"PtgArray",f:oY},33:{n:"PtgFunc",f:yY},34:{n:"PtgFuncVar",f:vY},35:{n:"PtgName",f:FY},36:{n:"PtgRef",f:mY},37:{n:"PtgArea",f:rY},38:{n:"PtgMemArea",f:DY},39:{n:"PtgMemErr",f:LY},40:{n:"PtgMemNoMem",f:BY},41:{n:"PtgMemFunc",f:IY},42:{n:"PtgRefErr",f:MY},43:{n:"PtgAreaErr",f:sY},44:{n:"PtgRefN",f:pY},45:{n:"PtgAreaN",f:iY},46:{n:"PtgMemAreaN",f:tQ},47:{n:"PtgMemNoMemN",f:rQ},57:{n:"PtgNameX",f:PY},58:{n:"PtgRef3d",f:xY},59:{n:"PtgArea3d",f:nY},60:{n:"PtgRefErr3d",f:OY},61:{n:"PtgAreaErr3d",f:aY},255:{}},sQ={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},aQ={1:{n:"PtgElfLel",f:MF},2:{n:"PtgElfRw",f:qY},3:{n:"PtgElfCol",f:$Y},6:{n:"PtgElfRwV",f:XY},7:{n:"PtgElfColV",f:HY},10:{n:"PtgElfRadical",f:GY},11:{n:"PtgElfRadicalS",f:KY},13:{n:"PtgElfColS",f:WY},15:{n:"PtgElfColSV",f:zY},16:{n:"PtgElfRadicalLel",f:VY},25:{n:"PtgList",f:QY},29:{n:"PtgSxName",f:JY},255:{}},iQ={0:{n:"PtgAttrNoop",f:nQ},1:{n:"PtgAttrSemi",f:fY},2:{n:"PtgAttrIf",f:uY},4:{n:"PtgAttrChoose",f:lY},8:{n:"PtgAttrGoto",f:cY},16:{n:"PtgAttrSum",f:_Y},32:{n:"PtgAttrBaxcel",f:l3},33:{n:"PtgAttrBaxcel",f:l3},64:{n:"PtgAttrSpace",f:hY},65:{n:"PtgAttrSpaceSemi",f:gY},128:{n:"PtgAttrIfError",f:dY},255:{}};function Xp(e,t,r,n){if(n.biff<8)return Ua(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=jY(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=AY(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Ua(e,t)),a}function Yp(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=c3[a]||c3[sQ[a]],(a===24||a===25)&&(s=(a===24?aQ:iQ)[e[e.l+1]]),!s||!s.f?Ua(e,t):i.push([s.n,s.f(e,t,r)]);return i}function oQ(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var lQ={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cQ(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function OF(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function u3(e,t,r){var n=OF(e,t,r);return n=="#REF"?n:cQ(n,r)}function Pa(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,d,f,p=0,g=0,y,v="";if(!e[0]||!e[0][0])return"";for(var w=-1,b="",E=0,k=e[0].length;E<k;++E){var _=e[0][E];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),d=o.pop(),w>=0){switch(e[0][w][1][0]){case 0:b=rs(" ",e[0][w][1][1]);break;case 1:b=rs("\r",e[0][w][1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}d=d+b,w=-1}o.push(d+lQ[_[0]]+c);break;case"PtgIsect":c=o.pop(),d=o.pop(),o.push(d+" "+c);break;case"PtgUnion":c=o.pop(),d=o.pop(),o.push(d+","+c);break;case"PtgRange":c=o.pop(),d=o.pop(),o.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Mm(_[1][1],i,s),o.push(Om(f,a));break;case"PtgRefN":f=r?Mm(_[1][1],r,s):_[1][1],o.push(Om(f,a));break;case"PtgRef3d":p=_[1][1],f=Mm(_[1][2],i,s),v=u3(n,p,s),o.push(v+"!"+Om(f,a));break;case"PtgFunc":case"PtgFuncVar":var N=_[1][0],A=_[1][1];N||(N=0),N&=127;var P=N==0?[]:o.slice(-N);o.length-=N,A==="User"&&(A=P.shift()),o.push(A+"("+P.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":y=BN(_[1][1],r?{s:r}:i,s),o.push(Uw(y,s));break;case"PtgArea":y=BN(_[1][1],i,s),o.push(Uw(y,s));break;case"PtgArea3d":p=_[1][1],y=_[1][2],v=u3(n,p,s),o.push(v+"!"+Uw(y,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=_[1][2];var R=(n.names||[])[g-1]||(n[0]||[])[g],T=R?R.Name:"SH33TJSNAME"+String(g);T&&T.slice(0,6)=="_xlfn."&&!s.xlfn&&(T=T.slice(6)),o.push(T);break;case"PtgNameX":var D=_[1][1];g=_[1][2];var I;if(s.biff<=5)D<0&&(D=-D),n[D]&&(I=n[D][g]);else{var K="";if(((n[D]||[])[0]||[])[0]==14849||(((n[D]||[])[0]||[])[0]==1025?n[D][g]&&n[D][g].itab>0&&(K=n.SheetNames[n[D][g].itab-1]+"!"):K=n.SheetNames[g-1]+"!"),n[D]&&n[D][g])K+=n[D][g].Name;else if(n[0]&&n[0][g])K+=n[0][g].Name;else{var X=(OF(n,D,s)||"").split(";;");X[g-1]?K=X[g-1]:K+="SH33TJSERRX"}o.push(K);break}I||(I={Name:"SH33TJSERRY"}),o.push(I.Name);break;case"PtgParen":var Z="(",oe=")";if(w>=0){switch(b="",e[0][w][1][0]){case 2:Z=rs(" ",e[0][w][1][1])+Z;break;case 3:Z=rs("\r",e[0][w][1][1])+Z;break;case 4:oe=rs(" ",e[0][w][1][1])+oe;break;case 5:oe=rs("\r",e[0][w][1][1])+oe;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][w][1][0])}w=-1}o.push(Z+o.pop()+oe);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:_[1][1],r:_[1][0]};var q={c:r.c,r:r.r};if(n.sharedf[xr(f)]){var re=n.sharedf[xr(f)];o.push(Pa(re,i,q,n,s))}else{var M=!1;for(c=0;c!=n.arrayf.length;++c)if(d=n.arrayf[c],!(f.c<d[0].s.c||f.c>d[0].e.c)&&!(f.r<d[0].s.r||f.r>d[0].e.r)){o.push(Pa(d[1],i,q,n,s)),M=!0;break}M||o.push(_[1])}break;case"PtgArray":o.push("{"+oQ(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":w=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var W=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&w>=0&&W.indexOf(e[0][E][0])==-1){_=e[0][w];var B=!0;switch(_[1][0]){case 4:B=!1;case 0:b=rs(" ",_[1][1]);break;case 5:B=!1;case 1:b=rs("\r",_[1][1]);break;default:if(b="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((B?b:"")+o.pop()+(B?"":b)),w=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function uQ(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ua(e,t-2)];var o=Yp(e,i,r);return t!==i+s&&(a=Xp(e,t-i-s,o,r)),e.l=n,[o,a]}function dQ(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Ua(e,t-2)];var o=Yp(e,i,r);return t!==i+s&&(a=Xp(e,t-i-s,o,r)),e.l=n,[o,a]}function fQ(e,t,r,n){var s=e.l+t,a=Yp(e,n,r),i;return s!==e.l&&(i=Xp(e,s-e.l,a,r)),[a,i]}function hQ(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Yp(e,a,r);return a==65535?[[],Ua(e,t-2)]:(t!==a+2&&(s=Xp(e,n-a-2,i,r)),[i,s])}function gQ(e){var t;if(xc(e,e.l+6)!==65535)return[Da(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function mQ(e){if(e==null){var t=yt(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return hf(e);return hf(0)}function Gw(e,t,r){var n=e.l+t,s=Dl(e);r.biff==2&&++e.l;var a=gQ(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=dQ(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function pQ(e,t,r,n,s){var a=mf(t,r,s),i=mQ(e.v),o=yt(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var d=yt(e.bf.length),f=0;f<e.bf.length;++f)d[f]=e.bf[f];var p=Zs([a,i,o,d]);return p}function sv(e,t,r){var n=e.read_shift(4),s=Yp(e,n,r),a=e.read_shift(4),i=a>0?Xp(e,a,s,r):null;return[s,i]}var xQ=sv,av=sv,yQ=sv,vQ=sv,wQ={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},LF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},_Q={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function d3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function bQ(e){var t="of:="+e.replace(FS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Vw(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function SQ(e){return e.replace(/\./,"!")}var Bm={},e0={},Um=typeof Map<"u";function DS(e,t,r){var n=0,s=e.length;if(r){if(Um?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Um?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Um?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function iv(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ra=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=pp(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=by(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Xd(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ju(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){wc(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function BF(e,t,r,n,s,a){try{n.cellNF&&(e.z=mr[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Dn(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(mr[t]==null&&wc(wH[t]||"General",t),e.t==="e")e.w=e.w||Fc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cp(e.v);else if(e.t==="d"){var i=Bs(e.v);(i|0)===i?e.w=i.toString(10):e.w=cp(i)}else{if(e.v===void 0)return"";e.w=df(e.v,e0)}else e.t==="d"?e.w=yo(t,Bs(e.v),e0):e.w=yo(t,e.v,e0)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=_y(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=_y(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function kQ(e,t,r){if(e&&e["!ref"]){var n=qr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function CQ(e,t){var r=qr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Nr(r))}var TQ=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,EQ=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,NQ=/<(?:\w:)?hyperlink [^>]*>/mg,AQ=/"(\w*:\w*)"/,jQ=/<(?:\w:)?col\b[^>]*[\/]?>/g,FQ=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,PQ=/<(?:\w:)?pageMargins[^>]*\/>/g,UF=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,RQ=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,DQ=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function IQ(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",f="",p=e.match(EQ);p?(d=e.slice(0,p.index),f=e.slice(p.index+p[0].length)):d=f=e;var g=d.match(UF);g?IS(g[0],o,s,r):(g=d.match(RQ))&&OQ(g[0],g[1]||"",o,s,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var v=d.slice(y,y+50).match(AQ);v&&CQ(o,v[1])}var w=d.match(DQ);w&&w[1]&&YQ(w[1],s);var b=[];if(t.cellStyles){var E=d.match(jQ);E&&GQ(b,E)}p&&ZQ(p[1],o,t,c,a,i);var k=f.match(FQ);k&&(o["!autofilter"]=KQ(k[0]));var _=[],N=f.match(TQ);if(N)for(y=0;y!=N.length;++y)_[y]=qr(N[y].slice(N[y].indexOf('"')+1));var A=f.match(NQ);A&&WQ(o,A,n);var P=f.match(PQ);if(P&&(o["!margins"]=zQ(vr(P[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Nr(c)),t.sheetRows>0&&o["!ref"]){var R=qr(o["!ref"]);t.sheetRows<=+R.e.r&&(R.e.r=t.sheetRows-1,R.e.r>c.e.r&&(R.e.r=c.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>c.e.c&&(R.e.c=c.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Nr(R))}return b.length>0&&(o["!cols"]=b),_.length>0&&(o["!merges"]=_),o}function MQ(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Nr(e[r])+'"/>';return t+"</mergeCells>"}function IS(e,t,r,n){var s=vr(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Kr(yn(s.codeName)))}function OQ(e,t,r,n,s){IS(e.slice(0,e.indexOf(">")),r,n,s)}function LQ(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=Cl(dn(c))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),o=(o||"")+Bt("outlinePr",null,d)}!a&&!o||(s[s.length]=Bt("sheetPr",o,i))}var BQ=["objects","scenarios","selectLockedCells","selectUnlockedCells"],UQ=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function $Q(e){var t={sheet:1};return BQ.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),UQ.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=NS(e.password).toString(16).toUpperCase()),Bt("sheetProtection",null,t)}function WQ(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=vr(yn(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Kr(a.location))):(a.Target="#"+Kr(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=qr(a.ref),c=o.s.r;c<=o.e.r;++c)for(var d=o.s.c;d<=o.e.c;++d){var f=xr({c:d,r:c});n?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function zQ(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function HQ(e){return Xd(e),Bt("pageMargins",null,e)}function GQ(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=vr(t[n],!0);s.hidden&&(s.hidden=jn(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,AS(s.width)),Uu(s);a<=i;)e[a++]=In(s)}}function VQ(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=Bt("col",null,iv(s,n)));return r[r.length]="</cols>",r.join("")}function KQ(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function qQ(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Nr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Ci(s);i.s.r==i.e.r&&(i.e.r=Ci(t["!ref"]).e.r,s=Nr(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),Bt("autoFilter",null,{ref:s})}var XQ=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function YQ(e,t){t.Views||(t.Views=[{}]),(e.match(XQ)||[]).forEach(function(r,n){var s=vr(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),jn(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function QQ(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Bt("sheetViews",Bt("sheetView",null,s),{})}function JQ(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=Fc[e.v];break;case"d":n&&n.cellDates?s=Dn(e.v,-1).toISOString():(e=In(e),e.t="n",s=""+(e.v=Bs(Dn(e.v)))),typeof e.z>"u"&&(e.z=mr[14]);break;default:s=e.v;break}var o=va("v",dn(s)),c={r:t},d=Ju(n.cellXfs,e,n);switch(d!==0&&(c.s=d),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=va("v",""+DS(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Bt("f",dn(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Bt("c",o,c)}var ZQ=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=up("v"),i=up("f");return function(c,d,f,p,g,y){for(var v=0,w="",b=[],E=[],k=0,_=0,N=0,A="",P,R,T=0,D=0,I,K,X=0,Z=0,oe=Array.isArray(y.CellXf),q,re=[],M=[],W=Array.isArray(d),B=[],G={},H=!1,O=!!f.sheetStubs,z=c.split(t),Y=0,J=z.length;Y!=J;++Y){w=z[Y].trim();var te=w.length;if(te!==0){var ee=0;e:for(v=0;v<te;++v)switch(w[v]){case">":if(w[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(R=vr(w.slice(ee,v),!0),T=R.r!=null?parseInt(R.r,10):T+1,D=-1,f.sheetRows&&f.sheetRows<T)continue;G={},H=!1,R.ht&&(H=!0,G.hpt=parseFloat(R.ht),G.hpx=f0(G.hpt)),R.hidden=="1"&&(H=!0,G.hidden=!0),R.outlineLevel!=null&&(H=!0,G.level=+R.outlineLevel),H&&(B[T-1]=G)}break;case"<":ee=v;break}if(ee>=v)break;if(R=vr(w.slice(ee,v),!0),T=R.r!=null?parseInt(R.r,10):T+1,D=-1,!(f.sheetRows&&f.sheetRows<T)){p.s.r>T-1&&(p.s.r=T-1),p.e.r<T-1&&(p.e.r=T-1),f&&f.cellStyles&&(G={},H=!1,R.ht&&(H=!0,G.hpt=parseFloat(R.ht),G.hpx=f0(G.hpt)),R.hidden=="1"&&(H=!0,G.hidden=!0),R.outlineLevel!=null&&(H=!0,G.level=+R.outlineLevel),H&&(B[T-1]=G)),b=w.slice(v).split(e);for(var ie=0;ie!=b.length&&b[ie].trim().charAt(0)=="<";++ie);for(b=b.slice(ie),v=0;v!=b.length;++v)if(w=b[v].trim(),w.length!==0){if(E=w.match(r),k=v,_=0,N=0,w="<c "+(w.slice(0,1)=="<"?">":"")+w,E!=null&&E.length===2){for(k=0,A=E[1],_=0;_!=A.length&&!((N=A.charCodeAt(_)-64)<1||N>26);++_)k=26*k+N;--k,D=k}else++D;for(_=0;_!=w.length&&w.charCodeAt(_)!==62;++_);if(++_,R=vr(w.slice(0,_),!0),R.r||(R.r=xr({r:T-1,c:D})),A=w.slice(_),P={t:""},(E=A.match(a))!=null&&E[1]!==""&&(P.v=Kr(E[1])),f.cellFormula){if((E=A.match(i))!=null&&E[1]!==""){if(P.f=Kr(yn(E[1])).replace(/\r\n/g,`
`),f.xlfn||(P.f=o3(P.f)),E[0].indexOf('t="array"')>-1)P.F=(A.match(s)||[])[1],P.F.indexOf(":")>-1&&re.push([qr(P.F),P.F]);else if(E[0].indexOf('t="shared"')>-1){K=vr(E[0]);var me=Kr(yn(E[1]));f.xlfn||(me=o3(me)),M[parseInt(K.si,10)]=[K,me,R.r]}}else(E=A.match(/<f[^>]*\/>/))&&(K=vr(E[0]),M[K.si]&&(P.f=XX(M[K.si][1],M[K.si][2],R.r)));var Ce=Gn(R.r);for(_=0;_<re.length;++_)Ce.r>=re[_][0].s.r&&Ce.r<=re[_][0].e.r&&Ce.c>=re[_][0].s.c&&Ce.c<=re[_][0].e.c&&(P.F=re[_][1])}if(R.t==null&&P.v===void 0)if(P.f||P.F)P.v=0,P.t="n";else if(O)P.t="z";else continue;else P.t=R.t||"n";switch(p.s.c>D&&(p.s.c=D),p.e.c<D&&(p.e.c=D),P.t){case"n":if(P.v==""||P.v==null){if(!O)continue;P.t="z"}else P.v=parseFloat(P.v);break;case"s":if(typeof P.v>"u"){if(!O)continue;P.t="z"}else I=Bm[parseInt(P.v,10)],P.v=I.t,P.r=I.r,f.cellHTML&&(P.h=I.h);break;case"str":P.t="s",P.v=P.v!=null?yn(P.v):"",f.cellHTML&&(P.h=hS(P.v));break;case"inlineStr":E=A.match(n),P.t="s",E!=null&&(I=ES(E[1]))?(P.v=I.t,f.cellHTML&&(P.h=I.h)):P.v="";break;case"b":P.v=jn(P.v);break;case"d":f.cellDates?P.v=Dn(P.v,1):(P.v=Bs(Dn(P.v,1)),P.t="n");break;case"e":(!f||f.cellText!==!1)&&(P.w=P.v),P.v=W8[P.v];break}if(X=Z=0,q=null,oe&&R.s!==void 0&&(q=y.CellXf[R.s],q!=null&&(q.numFmtId!=null&&(X=q.numFmtId),f.cellStyles&&q.fillId!=null&&(Z=q.fillId))),BF(P,X,Z,f,g,y),f.cellDates&&oe&&P.t=="n"&&A0(mr[X])&&(P.t="d",P.v=rv(P.v)),R.cm&&f.xlmeta){var Oe=(f.xlmeta.Cell||[])[+R.cm-1];Oe&&Oe.type=="XLDAPR"&&(P.D=!0)}if(W){var fe=Gn(R.r);d[fe.r]||(d[fe.r]=[]),d[fe.r][fe.c]=P}else d[R.r]=P}}}}B.length>0&&(d["!rows"]=B)}})();function eJ(e,t,r,n){var s=[],a=[],i=qr(e["!ref"]),o="",c,d="",f=[],p=0,g=0,y=e["!rows"],v=Array.isArray(e),w={r:d},b,E=-1;for(g=i.s.c;g<=i.e.c;++g)f[g]=Hn(g);for(p=i.s.r;p<=i.e.r;++p){for(a=[],d=ms(p),g=i.s.c;g<=i.e.c;++g){c=f[g]+d;var k=v?(e[p]||[])[g]:e[c];k!==void 0&&(o=JQ(k,c,e,t))!=null&&a.push(o)}(a.length>0||y&&y[p])&&(w={r:d},y&&y[p]&&(b=y[p],b.hidden&&(w.hidden=1),E=-1,b.hpx?E=xp(b.hpx):b.hpt&&(E=b.hpt),E>-1&&(w.ht=E,w.customHeight=1),b.level&&(w.outlineLevel=b.level)),s[s.length]=Bt("row",a.join(""),w))}if(y)for(;p<y.length;++p)y&&y[p]&&(w={r:p+1},b=y[p],b.hidden&&(w.hidden=1),E=-1,b.hpx?E=xp(b.hpx):b.hpt&&(E=b.hpt),E>-1&&(w.ht=E,w.customHeight=1),b.level&&(w.outlineLevel=b.level),s[s.length]=Bt("row","",w));return s.join("")}function $F(e,t,r,n){var s=[xs,Bt("worksheet",null,{xmlns:wf[0],"xmlns:r":Os.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var d=c["!ref"]||"A1",f=qr(d);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),d=Nr(f)}n||(n={}),c["!comments"]=[];var p=[];LQ(c,r,e,t,s),s[s.length]=Bt("dimension",null,{ref:d}),s[s.length]=QQ(c,t,e,r),t.sheetFormat&&(s[s.length]=Bt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=VQ(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=eJ(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=$Q(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=qQ(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=MQ(c["!merges"]));var g=-1,y,v=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(w){w[1].Target&&(y={ref:w[0]},w[1].Target.charAt(0)!="#"&&(v=un(n,-1,dn(w[1].Target).replace(/#.*$/,""),Br.HLINK),y["r:id"]="rId"+v),(g=w[1].Target.indexOf("#"))>-1&&(y.location=dn(w[1].Target.slice(g+1))),w[1].Tooltip&&(y.tooltip=dn(w[1].Tooltip)),s[s.length]=Bt("hyperlink",null,y))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=HQ(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=va("ignoredErrors",Bt("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(v=un(n,-1,"../drawings/drawing"+(e+1)+".xml",Br.DRAW),s[s.length]=Bt("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=p),c["!comments"].length>0&&(v=un(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Br.VML),s[s.length]=Bt("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function tJ(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function rJ(e,t,r){var n=yt(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=xp(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var d={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var p=-1,g=-1,y=f<<10;y<f+1<<10;++y){d.c=y;var v=Array.isArray(r)?(r[d.r]||[])[d.c]:r[xr(d)];v&&(p<0&&(p=y),g=y)}p<0||(++o,n.write_shift(4,p),n.write_shift(4,g))}var w=n.l;return n.l=c,n.write_shift(4,o),n.l=w,n.length>n.l?n.slice(0,n.l):n}function nJ(e,t,r,n){var s=rJ(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&kt(e,0,s)}var sJ=kf,aJ=P0;function iJ(){}function oJ(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=uG(e),r}function lJ(e,t,r){r==null&&(r=yt(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return yy({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),O8(e,r),r.slice(0,r.l)}function cJ(e){var t=vo(e);return[t]}function uJ(e,t,r){return r==null&&(r=yt(8)),_f(t,r)}function dJ(e){var t=bf(e);return[t]}function fJ(e,t,r){return r==null&&(r=yt(4)),Sf(t,r)}function hJ(e){var t=vo(e),r=e.read_shift(1);return[t,r,"b"]}function gJ(e,t,r){return r==null&&(r=yt(9)),_f(t,r),r.write_shift(1,e.v?1:0),r}function mJ(e){var t=bf(e),r=e.read_shift(1);return[t,r,"b"]}function pJ(e,t,r){return r==null&&(r=yt(5)),Sf(t,r),r.write_shift(1,e.v?1:0),r}function xJ(e){var t=vo(e),r=e.read_shift(1);return[t,r,"e"]}function yJ(e,t,r){return r==null&&(r=yt(9)),_f(t,r),r.write_shift(1,e.v),r}function vJ(e){var t=bf(e),r=e.read_shift(1);return[t,r,"e"]}function wJ(e,t,r){return r==null&&(r=yt(8)),Sf(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function _J(e){var t=vo(e),r=e.read_shift(4);return[t,r,"s"]}function bJ(e,t,r){return r==null&&(r=yt(12)),_f(t,r),r.write_shift(4,t.v),r}function SJ(e){var t=bf(e),r=e.read_shift(4);return[t,r,"s"]}function kJ(e,t,r){return r==null&&(r=yt(8)),Sf(t,r),r.write_shift(4,t.v),r}function CJ(e){var t=vo(e),r=Da(e);return[t,r,"n"]}function TJ(e,t,r){return r==null&&(r=yt(16)),_f(t,r),hf(e.v,r),r}function WF(e){var t=bf(e),r=Da(e);return[t,r,"n"]}function EJ(e,t,r){return r==null&&(r=yt(12)),Sf(t,r),hf(e.v,r),r}function NJ(e){var t=vo(e),r=bS(e);return[t,r,"n"]}function AJ(e,t,r){return r==null&&(r=yt(12)),_f(t,r),L8(e.v,r),r}function jJ(e){var t=bf(e),r=bS(e);return[t,r,"n"]}function FJ(e,t,r){return r==null&&(r=yt(8)),Sf(t,r),L8(e.v,r),r}function PJ(e){var t=vo(e),r=vS(e);return[t,r,"is"]}function RJ(e){var t=vo(e),r=La(e);return[t,r,"str"]}function DJ(e,t,r){return r==null&&(r=yt(12+4*e.v.length)),_f(t,r),ta(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IJ(e){var t=bf(e),r=La(e);return[t,r,"str"]}function MJ(e,t,r){return r==null&&(r=yt(8+4*e.v.length)),Sf(t,r),ta(e.v,r),r.length>r.l?r.slice(0,r.l):r}function OJ(e,t,r){var n=e.l+t,s=vo(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=av(e,n-e.l,r);i[3]=Pa(o,null,s,r.supbooks,r)}else e.l=n;return i}function LJ(e,t,r){var n=e.l+t,s=vo(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=av(e,n-e.l,r);i[3]=Pa(o,null,s,r.supbooks,r)}else e.l=n;return i}function BJ(e,t,r){var n=e.l+t,s=vo(e);s.r=r["!row"];var a=Da(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=av(e,n-e.l,r);i[3]=Pa(o,null,s,r.supbooks,r)}else e.l=n;return i}function UJ(e,t,r){var n=e.l+t,s=vo(e);s.r=r["!row"];var a=La(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=av(e,n-e.l,r);i[3]=Pa(o,null,s,r.supbooks,r)}else e.l=n;return i}var $J=kf,WJ=P0;function zJ(e,t){return t==null&&(t=yt(4)),t.write_shift(4,e),t}function HJ(e,t){var r=e.l+t,n=kf(e),s=wS(e),a=La(e),i=La(e),o=La(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function GJ(e,t){var r=yt(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));P0({s:Gn(e[0]),e:Gn(e[0])},r),_S("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return ta(s||"",r),ta(e[1].Tooltip||"",r),ta("",r),r.slice(0,r.l)}function VJ(){}function KJ(e,t,r){var n=e.l+t,s=B8(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=xQ(e,n-e.l,r);i[1]=o}else e.l=n;return i}function qJ(e,t,r){var n=e.l+t,s=kf(e),a=[s];if(r.cellFormula){var i=vQ(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function XJ(e,t,r){r==null&&(r=yt(18));var n=iv(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var zF=["left","right","top","bottom","header","footer"];function YJ(e){var t={};return zF.forEach(function(r){t[r]=Da(e)}),t}function QJ(e,t){return t==null&&(t=yt(48)),Xd(e),zF.forEach(function(r){hf(e[r],t)}),t}function JJ(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function ZJ(e,t,r){r==null&&(r=yt(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function eZ(e){var t=yt(24);return t.write_shift(4,4),t.write_shift(4,1),P0(e,t),t}function tZ(e,t){return t==null&&(t=yt(66)),t.write_shift(2,e.password?NS(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function rZ(){}function nZ(){}function sZ(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},d,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,g=!1,y,v,w,b,E,k,_,N,A,P=[];o.biff=12,o["!row"]=0;var R=0,T=!1,D=[],I={},K=o.supbooks||s.supbooks||[[]];if(K.sharedf=I,K.arrayf=D,K.SheetNames=s.SheetNames||s.Sheets.map(function(W){return W.name}),!o.supbooks&&(o.supbooks=K,s.Names))for(var X=0;X<s.Names.length;++X)K[0][X+1]=s.Names[X];var Z=[],oe=[],q=!1;yp[16]={n:"BrtShortReal",f:WF};var re;if(jc(e,function(B,G,H){if(!g)switch(H){case 148:d=B;break;case 0:y=B,o.sheetRows&&o.sheetRows<=y.r&&(g=!0),N=ms(b=y.r),o["!row"]=y.r,(B.hidden||B.hpt||B.level!=null)&&(B.hpt&&(B.hpx=f0(B.hpt)),oe[B.r]=B);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:B[2]},B[2]){case"n":v.v=B[1];break;case"s":_=Bm[B[1]],v.v=_.t,v.r=_.r;break;case"b":v.v=!!B[1];break;case"e":v.v=B[1],o.cellText!==!1&&(v.w=Fc[v.v]);break;case"str":v.t="s",v.v=B[1];break;case"is":v.t="s",v.v=B[1].t;break}if((w=i.CellXf[B[0].iStyleRef])&&BF(v,w.numFmtId,null,o,a,i),E=B[0].c==-1?E+1:B[0].c,o.dense?(c[b]||(c[b]=[]),c[b][E]=v):c[Hn(E)+N]=v,o.cellFormula){for(T=!1,R=0;R<D.length;++R){var O=D[R];y.r>=O[0].s.r&&y.r<=O[0].e.r&&E>=O[0].s.c&&E<=O[0].e.c&&(v.F=Nr(O[0]),T=!0)}!T&&B.length>3&&(v.f=B[3])}if(f.s.r>y.r&&(f.s.r=y.r),f.s.c>E&&(f.s.c=E),f.e.r<y.r&&(f.e.r=y.r),f.e.c<E&&(f.e.c=E),o.cellDates&&w&&v.t=="n"&&A0(mr[w.numFmtId])){var z=Bd(v.v);z&&(v.t="d",v.v=new Date(z.y,z.m-1,z.d,z.H,z.M,z.S,z.u))}re&&(re.type=="XLDAPR"&&(v.D=!0),re=void 0);break;case 1:case 12:if(!o.sheetStubs||p)break;v={t:"z",v:void 0},E=B[0].c==-1?E+1:B[0].c,o.dense?(c[b]||(c[b]=[]),c[b][E]=v):c[Hn(E)+N]=v,f.s.r>y.r&&(f.s.r=y.r),f.s.c>E&&(f.s.c=E),f.e.r<y.r&&(f.e.r=y.r),f.e.c<E&&(f.e.c=E),re&&(re.type=="XLDAPR"&&(v.D=!0),re=void 0);break;case 176:P.push(B);break;case 49:re=((o.xlmeta||{}).Cell||[])[B-1];break;case 494:var Y=n["!id"][B.relId];for(Y?(B.Target=Y.Target,B.loc&&(B.Target+="#"+B.loc),B.Rel=Y):B.relId==""&&(B.Target="#"+B.loc),b=B.rfx.s.r;b<=B.rfx.e.r;++b)for(E=B.rfx.s.c;E<=B.rfx.e.c;++E)o.dense?(c[b]||(c[b]=[]),c[b][E]||(c[b][E]={t:"z",v:void 0}),c[b][E].l=B):(k=xr({c:E,r:b}),c[k]||(c[k]={t:"z",v:void 0}),c[k].l=B);break;case 426:if(!o.cellFormula)break;D.push(B),A=o.dense?c[b][E]:c[Hn(E)+N],A.f=Pa(B[1],f,{r:y.r,c:E},K,o),A.F=Nr(B[0]);break;case 427:if(!o.cellFormula)break;I[xr(B[0].s)]=B[1],A=o.dense?c[b][E]:c[Hn(E)+N],A.f=Pa(B[1],f,{r:y.r,c:E},K,o);break;case 60:if(!o.cellStyles)break;for(;B.e>=B.s;)Z[B.e--]={width:B.w/256,hidden:!!(B.flags&1),level:B.level},q||(q=!0,AS(B.w/256)),Uu(Z[B.e+1]);break;case 161:c["!autofilter"]={ref:Nr(B)};break;case 476:c["!margins"]=B;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),B.name&&(s.Sheets[r].CodeName=B.name),(B.above||B.left)&&(c["!outline"]={above:B.above,left:B.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),B.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!G.T){if(!p||o.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=Nr(d||f)),o.sheetRows&&c["!ref"]){var M=qr(c["!ref"]);o.sheetRows<=+M.e.r&&(M.e.r=o.sheetRows-1,M.e.r>f.e.r&&(M.e.r=f.e.r),M.e.r<M.s.r&&(M.s.r=M.e.r),M.e.c>f.e.c&&(M.e.c=f.e.c),M.e.c<M.s.c&&(M.s.c=M.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Nr(M))}return P.length>0&&(c["!merges"]=P),Z.length>0&&(c["!cols"]=Z),oe.length>0&&(c["!rows"]=oe),c}function aZ(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=In(t),t.z=t.z||mr[14],t.v=Bs(Dn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Ju(s.cellXfs,t,s),t.l&&a["!links"].push([xr(c),t.l]),t.c&&a["!comments"].push([xr(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=DS(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?kt(e,18,kJ(t,c)):kt(e,7,bJ(t,c))):(c.t="str",i?kt(e,17,MJ(t,c)):kt(e,6,DJ(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?kt(e,13,FJ(t,c)):kt(e,2,AJ(t,c)):i?kt(e,16,EJ(t,c)):kt(e,5,TJ(t,c)),!0;case"b":return c.t="b",i?kt(e,15,pJ(t,c)):kt(e,4,gJ(t,c)),!0;case"e":return c.t="e",i?kt(e,14,wJ(t,c)):kt(e,3,yJ(t,c)),!0}return i?kt(e,12,fJ(t,c)):kt(e,1,uJ(t,c)),!0}function iZ(e,t,r,n){var s=qr(t["!ref"]||"A1"),a,i="",o=[];kt(e,145);var c=Array.isArray(t),d=s.e.r;t["!rows"]&&(d=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=d;++f){i=ms(f),nJ(e,t,s,f);var p=!1;if(f<=s.e.r)for(var g=s.s.c;g<=s.e.c;++g){f===s.s.r&&(o[g]=Hn(g)),a=o[g]+i;var y=c?(t[f]||[])[g]:t[a];if(!y){p=!1;continue}p=aZ(e,y,f,g,n,t,p)}}kt(e,146)}function oZ(e,t){!t||!t["!merges"]||(kt(e,177,zJ(t["!merges"].length)),t["!merges"].forEach(function(r){kt(e,176,WJ(r))}),kt(e,178))}function lZ(e,t){!t||!t["!cols"]||(kt(e,390),t["!cols"].forEach(function(r,n){r&&kt(e,60,XJ(n,r))}),kt(e,391))}function cZ(e,t){!t||!t["!ref"]||(kt(e,648),kt(e,649,eZ(qr(t["!ref"]))),kt(e,650))}function uZ(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=un(r,-1,n[1].Target.replace(/#.*$/,""),Br.HLINK);kt(e,494,GJ(n,s))}}),delete t["!links"]}function dZ(e,t,r,n){if(t["!comments"].length>0){var s=un(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Br.VML);kt(e,551,_S("rId"+s)),t["!legacy"]=s}}function fZ(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Nr(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Ci(a);o.s.r==o.e.r&&(o.e.r=Ci(t["!ref"]).e.r,a=Nr(o));for(var c=0;c<i.length;++c){var d=i[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),kt(e,161,P0(qr(a))),kt(e,162)}}function hZ(e,t,r){kt(e,133),kt(e,137,ZJ(t,r)),kt(e,138),kt(e,134)}function gZ(e,t){t["!protect"]&&kt(e,535,tZ(t["!protect"]))}function mZ(e,t,r,n){var s=ki(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=qr(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],kt(s,129),(r.vbaraw||i["!outline"])&&kt(s,147,lJ(o,i["!outline"])),kt(s,148,aJ(c)),hZ(s,i,r.Workbook),lZ(s,i),iZ(s,i,e,t),gZ(s,i),fZ(s,i,r,e),oZ(s,i),uZ(s,i,n),i["!margins"]&&kt(s,476,QJ(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&cZ(s,i),dZ(s,i,e,n),kt(s,130),s.end()}function pZ(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Kr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function xZ(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,d="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=pZ(p);f.s.r=f.s.c=0,f.e.c=o,d=Hn(o),g[0].forEach(function(y,v){i[d+ms(v)]={t:"n",v:y,z:g[1]},c=v}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=Nr(f)),i}function yZ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(UF);return o&&IS(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function vZ(e,t){e.l+=10;var r=La(e);return{name:r}}function wZ(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return jc(e,function(c,d,f){switch(f){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var MS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],_Z=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],bZ=[],SZ=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function f3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=jn(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function h3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=jn(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function HF(e){h3(e.WBProps,MS),h3(e.CalcPr,SZ),f3(e.WBView,_Z),f3(e.Sheets,bZ),e0.date1904=jn(e.WBProps.date1904)}function kZ(e){return!e.Workbook||!e.Workbook.WBProps?"false":jn(e.Workbook.WBProps.date1904)?"true":"false"}var CZ="][*?/\\".split("");function GF(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return CZ.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function TZ(e,t,r){e.forEach(function(n,s){GF(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function EZ(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];TZ(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)kQ(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var NZ=/<\w+:workbook/;function AZ(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace($a,function(c,d){var f=vr(c);switch(Rl(f[0])){case"<?xml":break;case"<workbook":c.match(NZ)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":MS.forEach(function(p){if(f[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=jn(f[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(f[p[0]],10);break;default:r.WBProps[p[0]]=f[p[0]]}}),f.codeName&&(r.WBProps.CodeName=yn(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Kr(yn(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=yn(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),jn(f.hidden||"0")&&(a.Hidden=!0),i=d+c.length;break;case"</definedName>":a.Ref=Kr(yn(e.slice(i,d))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),wf.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return HF(r),r}function VF(e){var t=[xs];t[t.length]=Bt("workbook",null,{xmlns:wf[0],"xmlns:r":Os.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(MS.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Bt("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:dn(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=Bt("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Bt("definedName",dn(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function jZ(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=i2(e),r.name=La(e),r}function FZ(e,t){return t||(t=yt(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),_S(e.strRelID,t),ta(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function PZ(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?La(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function RZ(e,t){t||(t=yt(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),O8(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function DZ(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function IZ(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=dG(e),i=yQ(e,0,r),o=wS(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function MZ(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],yp[16]={n:"BrtFRTArchID$",f:DZ},jc(e,function(c,d,f){switch(f){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=Pa(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!d.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),HF(r),r.Names=a,r.supbooks=i,r}function OZ(e,t){kt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};kt(e,156,FZ(s))}kt(e,144)}function LZ(e,t){t||(t=yt(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ta("SheetJS",t),ta(dy.version,t),ta(dy.version,t),ta("7262",t),t.length>t.l?t.slice(0,t.l):t}function BZ(e,t){t||(t=yt(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function UZ(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(kt(e,135),kt(e,158,BZ(s)),kt(e,136))}}function $Z(e,t){var r=ki();return kt(r,131),kt(r,128,LZ()),kt(r,153,RZ(e.Workbook&&e.Workbook.WBProps||null)),UZ(r,e),OZ(r,e),kt(r,132),r.end()}function WZ(e,t,r){return t.slice(-4)===".bin"?MZ(e,r):AZ(e,r)}function zZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?sZ(e,n,r,s,a,i,o):IQ(e,n,r,s,a,i,o)}function HZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?wZ(e,n,r,s,a):yZ(e,n,r,s,a)}function GZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?KX():qX()}function VZ(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?GX():VX()}function KZ(e,t,r,n){return t.slice(-4)===".bin"?Wq(e,r,n):jq(e,r,n)}function qZ(e,t,r){return TF(e,r)}function XZ(e,t,r){return t.slice(-4)===".bin"?XK(e,r):VK(e,r)}function YZ(e,t,r){return t.slice(-4)===".bin"?UX(e,r):FX(e,r)}function QZ(e,t,r){return t.slice(-4)===".bin"?NX(e):TX(e)}function JZ(e,t,r,n){return r.slice(-4)===".bin"?AX(e,t,r,n):void 0}function ZZ(e,t,r){return t.slice(-4)===".bin"?SX(e,t,r):CX(e,t,r)}function eee(e,t,r){return(t.slice(-4)===".bin"?$Z:VF)(e)}function tee(e,t,r,n,s){return(t.slice(-4)===".bin"?mZ:$F)(e,r,n,s)}function ree(e,t,r){return(t.slice(-4)===".bin"?Jq:kF)(e,r)}function nee(e,t,r){return(t.slice(-4)===".bin"?JK:pF)(e,r)}function see(e,t,r){return(t.slice(-4)===".bin"?$X:AF)(e)}function aee(e){return(e.slice(-4)===".bin"?kX:EF)()}var KF=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,qF=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mo(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(KF),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(qF),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function iee(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(KF),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(qF),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var $m;function oee(e,t){var r=$m[e]||Kr(e);return r==="General"?df(t):yo(r,t)}function lee(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=jn(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Dn(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Kr(t)]=s}function cee(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Fc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cp(e.v):e.w=df(e.v):e.w=oee(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=$m[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&A0(n)){var s=Bd(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function uee(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=bq[n.Pattern]||n.Pattern)}e[t.ID]=t}function dee(e,t,r,n,s,a,i,o,c,d){var f="General",p=n.StyleID,g={};d=d||{};var y=[],v=0;for(p===void 0&&o&&(p=o.StyleID),p===void 0&&i&&(p=i.StyleID);a[p]!==void 0&&(a[p].nf&&(f=a[p].nf),a[p].Interior&&y.push(a[p].Interior),!!a[p].Parent);)p=a[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=jn(e);break;case"String":n.t="s",n.r=jN(Kr(e)),n.v=e.indexOf("<")>-1?Kr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Dn(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Kr(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=W8[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=jN(t||e));break}if(cee(n,f,d),d.cellFormula!==!1)if(n.Formula){var w=Kr(n.Formula);w.charCodeAt(0)==61&&(w=w.slice(1)),n.f=Zh(w,s),delete n.Formula,n.ArrayRange=="RC"?n.F=Zh("RC:RC",s):n.ArrayRange&&(n.F=Zh(n.ArrayRange,s),c.push([qr(n.F),n.F]))}else for(v=0;v<c.length;++v)s.r>=c[v][0].s.r&&s.r<=c[v][0].e.r&&s.c>=c[v][0].s.c&&s.c<=c[v][0].e.c&&(n.F=c[v][1]);d.cellStyles&&(y.forEach(function(b){!g.patternType&&b.patternType&&(g.patternType=b.patternType)}),n.s=g),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function fee(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Kw(e,t){var r=t||{};j0();var n=bm(gS(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=yn(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=In(r);return i.type="string",d0.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Rt){s.indexOf("<"+Rt)>=0&&(a=!0)}),a)return Qee(n,r);$m={"General Number":"General","General Date":mr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":mr[15],"Short Date":mr[14],"Long Time":mr[19],"Medium Time":mr[18],"Short Time":mr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:mr[2],Standard:mr[4],Percent:mr[10],Scientific:mr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],d,f={},p=[],g=r.dense?[]:{},y="",v={},w={},b=Mo('<Data ss:Type="String">'),E=0,k=0,_=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},A={},P={},R="",T=0,D=[],I={},K={},X=0,Z=[],oe=[],q={},re=[],M,W=!1,B=[],G=[],H={},O=0,z=0,Y={Sheets:[],WBProps:{date1904:!1}},J={};fp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=fp.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?dee(n.slice(E,o.index),R,b,c[c.length-1][0]=="comment"?q:v,{c:k,r:_},A,re[k],w,B,r):(R="",b=Mo(o[0]),E=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(v.c=oe),(!r.sheetRows||r.sheetRows>_)&&v.v!==void 0&&(r.dense?(g[_]||(g[_]=[]),g[_][k]=v):g[Hn(k)+ms(_)]=v),v.HRef&&(v.l={Target:Kr(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(O=k+(parseInt(v.MergeAcross,10)|0),z=_+(parseInt(v.MergeDown,10)|0),D.push({s:{c:k,r:_},e:{c:O,r:z}})),!r.sheetStubs)v.MergeAcross?k=O+1:++k;else if(v.MergeAcross||v.MergeDown){for(var ee=k;ee<=O;++ee)for(var ie=_;ie<=z;++ie)(ee>k||ie>_)&&(r.dense?(g[ie]||(g[ie]=[]),g[ie][ee]={t:"z"}):g[Hn(ee)+ms(ie)]={t:"z"});k=O+1}else++k;else v=iee(o[0]),v.Index&&(k=+v.Index-1),k<N.s.c&&(N.s.c=k),k>N.e.c&&(N.e.c=k),o[0].slice(-2)==="/>"&&++k,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<N.s.r&&(N.s.r=_),_>N.e.r&&(N.e.r=_),o[0].slice(-2)==="/>"&&(w=Mo(o[0]),w.Index&&(_=+w.Index-1)),k=0,++_):(w=Mo(o[0]),w.Index&&(_=+w.Index-1),H={},(w.AutoFitHeight=="0"||w.Height)&&(H.hpx=parseInt(w.Height,10),H.hpt=xp(H.hpx),G[_]=H),w.Hidden=="1"&&(H.hidden=!0,G[_]=H));break;case"worksheet":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));p.push(y),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(g["!ref"]=Nr(N),r.sheetRows&&r.sheetRows<=N.e.r&&(g["!fullref"]=g["!ref"],N.e.r=r.sheetRows-1,g["!ref"]=Nr(N))),D.length&&(g["!merges"]=D),re.length>0&&(g["!cols"]=re),G.length>0&&(g["!rows"]=G),f[y]=g}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=k=0,c.push([o[3],!1]),d=Mo(o[0]),y=Kr(d.Name),g=r.dense?[]:{},D=[],B=[],G=[],J={name:y,Hidden:0},Y.Sheets.push(J);break;case"table":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),re=[],W=!1}break;case"style":o[1]==="/"?uee(A,P,r):P=Mo(o[0]);break;case"numberformat":P.nf=Kr(Mo(o[0]).Format||"General"),$m[P.nf]&&(P.nf=$m[P.nf]);for(var me=0;me!=392&&mr[me]!=P.nf;++me);if(me==392){for(me=57;me!=392;++me)if(mr[me]==null){wc(P.nf,me);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(M=Mo(o[0]),M.Hidden&&(M.hidden=!0,delete M.Hidden),M.Width&&(M.wpx=parseInt(M.Width,10)),!W&&M.wpx>10){W=!0,Ra=bF;for(var Ce=0;Ce<re.length;++Ce)re[Ce]&&Uu(re[Ce])}W&&Uu(M),re[M.Index-1||re.length]=M;for(var Oe=0;Oe<+M.Span;++Oe)re[re.length]=In(M);break;case"namedrange":if(o[1]==="/")break;Y.Names||(Y.Names=[]);var fe=vr(o[0]),pe={Name:fe.Name,Ref:Zh(fe.RefersTo.slice(1),{r:0,c:0})};Y.Sheets.length>0&&(pe.Sheet=Y.Sheets.length-1),Y.Names.push(pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?R+=n.slice(T,o.index):T=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;P.Interior=Mo(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?MG(I,te,n.slice(X,o.index)):X=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"));fee(q),oe.push(q)}else c.push([o[3],!1]),d=Mo(o[0]),q={a:d.Author};break;case"autofilter":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=Mo(o[0]);g["!autofilter"]={ref:Zh(He.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((d=c.pop())[0]!==o[3])throw new Error("Bad state: "+d.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return y3(n,r);var Ye=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ye=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ye=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Y.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ye=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ye=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(X,o.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else X=o.index+o[0].length;break;case"header":g["!margins"]||Xd(g["!margins"]={},"xlml"),isNaN(+vr(o[0]).Margin)||(g["!margins"].header=+vr(o[0]).Margin);break;case"footer":g["!margins"]||Xd(g["!margins"]={},"xlml"),isNaN(+vr(o[0]).Margin)||(g["!margins"].footer=+vr(o[0]).Margin);break;case"pagemargins":var ot=vr(o[0]);g["!margins"]||Xd(g["!margins"]={},"xlml"),isNaN(+ot.Top)||(g["!margins"].top=+ot.Top),isNaN(+ot.Left)||(g["!margins"].left=+ot.Left),isNaN(+ot.Right)||(g["!margins"].right=+ot.Right),isNaN(+ot.Bottom)||(g["!margins"].bottom=+ot.Bottom);break;case"displayrighttoleft":Y.Views||(Y.Views=[]),Y.Views[0]||(Y.Views[0]={}),Y.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ye=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ye=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ye=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ye=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ye=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ye=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ye=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ye=!1}break;case"smarttags":break;default:Ye=!1;break}if(Ye||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?lee(K,te,Z,n.slice(X,o.index)):(Z=o,X=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ve={};return!r.bookSheets&&!r.bookProps&&(Ve.Sheets=f),Ve.SheetNames=p,Ve.Workbook=Y,Ve.SSF=In(mr),Ve.Props=I,Ve.Custprops=K,Ve}function h2(e,t){switch(LS(t=t||{}),t.type||"base64"){case"base64":return Kw($i(e),t);case"binary":case"buffer":case"file":return Kw(e,t);case"array":return Kw(Yu(e),t)}}function hee(e,t){var r=[];return e.Props&&r.push(OG(e.Props,t)),e.Custprops&&r.push(LG(e.Props,e.Custprops)),r.join("")}function gee(){return""}function mee(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(Bt("NumberFormat",null,{"ss:Format":dn(mr[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(Bt("Style",a.join(""),i))}),Bt("Styles",r.join(""))}function XF(e){return Bt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+PS(e.Ref,{r:0,c:0})})}function pee(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(XF(s)))}return Bt("Names",r.join(""))}function xee(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(XF(o)))}return a.join("")}function yee(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(Bt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(Bt("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(Bt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(Bt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(va("ProtectContents","True")),e["!protect"].objects&&s.push(va("ProtectObjects","True")),e["!protect"].scenarios&&s.push(va("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(va("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(va("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":Bt("WorksheetOptions",s.join(""),{xmlns:Mi.x})}function vee(e){return e.map(function(t){var r=UH(t.t||""),n=Bt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Bt("Comment",n,{"ss:Author":t.a})}).join("")}function wee(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+dn(PS(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=Gn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=dn(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=dn(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],f=0;f!=d.length;++f)d[f].s.c!=i.c||d[f].s.r!=i.r||(d[f].e.c>d[f].s.c&&(o["ss:MergeAcross"]=d[f].e.c-d[f].s.c),d[f].e.r>d[f].s.r&&(o["ss:MergeDown"]=d[f].e.r-d[f].s.r));var p="",g="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",g=String(e.v);break;case"b":p="Boolean",g=e.v?"1":"0";break;case"e":p="Error",g=Fc[e.v];break;case"d":p="DateTime",g=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||mr[14]);break;case"s":p="String",g=BH(e.v||"");break}var y=Ju(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+y),o["ss:Index"]=i.c+1;var v=e.v!=null?g:"",w=e.t=="z"?"":'<Data ss:Type="'+p+'">'+v+"</Data>";return(e.c||[]).length>0&&(w+=vee(e.c)),Bt("Cell",w,o)}function _ee(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=f0(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function bee(e,t,r,n){if(!e["!ref"])return"";var s=qr(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(b,E){Uu(b);var k=!!b.width,_=iv(E,b),N={"ss:Index":E+1};k&&(N["ss:Width"]=mp(_.width)),b.hidden&&(N["ss:Hidden"]="1"),o.push(Bt("Column",null,N))});for(var c=Array.isArray(e),d=s.s.r;d<=s.e.r;++d){for(var f=[_ee(d,(e["!rows"]||[])[d])],p=s.s.c;p<=s.e.c;++p){var g=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>p)&&!(a[i].s.r>d)&&!(a[i].e.c<p)&&!(a[i].e.r<d)){(a[i].s.c!=p||a[i].s.r!=d)&&(g=!0);break}if(!g){var y={r:d,c:p},v=xr(y),w=c?(e[d]||[])[p]:e[v];f.push(wee(w,v,e,t,r,n,y))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function See(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?xee(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?bee(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(yee(a,t,e,r)),n.join("")}function kee(e,t){t||(t={}),e.SSF||(e.SSF=In(mr)),e.SSF&&(j0(),Zy(e.SSF),t.revssf=tv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ju(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(hee(e,t)),r.push(gee()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Bt("Worksheet",See(n,t,e),{"ss:Name":dn(e.SheetNames[n])}));return r[2]=mee(e,t),r[3]=pee(e),xs+Bt("Workbook",r.join(""),{xmlns:Mi.ss,"xmlns:o":Mi.o,"xmlns:x":Mi.x,"xmlns:ss":Mi.ss,"xmlns:dt":Mi.dt,"xmlns:html":Mi.html})}function Cee(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=pG(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=xG(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var Tee=[60,1084,2066,2165,2175];function Eee(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=xc(r,r.l),d=g2[c],f=0;d!=null&&Tee.indexOf(c)>-1;)a=xc(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,d=g2[c=xc(r,r.l)];var p=Zs(i);pa(p,0);var g=0;p.lens=[];for(var y=0;y<i.length;++y)p.lens.push(g),g+=i[y].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,s)}function xl(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=mr[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Fc[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=cp(e.v):e.w=df(e.v):e.w=yo(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&A0(mr[n]||String(n))){var s=Bd(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function k1(e,t,r){return{v:e,ixfe:t,t:r}}function Nee(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],d="",f={},p,g="",y,v,w,b,E={},k=[],_,N,A=[],P=[],R={Sheets:[],WBProps:{date1904:!1},Views:[{}]},T={},D=function(lt){return lt<8?Vd[lt]:lt<64&&P[lt-8]||Vd[lt]},I=function(lt,wt,Lt){var Ht=wt.XF.data;if(!(!Ht||!Ht.patternType||!Lt||!Lt.cellStyles)){wt.s={},wt.s.patternType=Ht.patternType;var Ie;(Ie=gp(D(Ht.icvFore)))&&(wt.s.fgColor={rgb:Ie}),(Ie=gp(D(Ht.icvBack)))&&(wt.s.bgColor={rgb:Ie})}},K=function(lt,wt,Lt){if(!(H>1)&&!(Lt.sheetRows&&lt.r>=Lt.sheetRows)){if(Lt.cellStyles&&wt.XF&&wt.XF.data&&I(lt,wt,Lt),delete wt.ixfe,delete wt.XF,p=lt,g=xr(lt),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),lt.r<i.s.r&&(i.s.r=lt.r),lt.c<i.s.c&&(i.s.c=lt.c),lt.r+1>i.e.r&&(i.e.r=lt.r+1),lt.c+1>i.e.c&&(i.e.c=lt.c+1),Lt.cellFormula&&wt.f){for(var Ht=0;Ht<k.length;++Ht)if(!(k[Ht][0].s.c>lt.c||k[Ht][0].s.r>lt.r)&&!(k[Ht][0].e.c<lt.c||k[Ht][0].e.r<lt.r)){wt.F=Nr(k[Ht][0]),(k[Ht][0].s.c!=lt.c||k[Ht][0].s.r!=lt.r)&&delete wt.f,wt.f&&(wt.f=""+Pa(k[Ht][1],i,lt,B,X));break}}Lt.dense?(s[lt.r]||(s[lt.r]=[]),s[lt.r][lt.c]=wt):s[g]=wt}},X={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:k,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(X.password=t.password);var Z,oe=[],q=[],re=[],M=[],W=!1,B=[];B.SheetNames=X.snames,B.sharedf=X.sharedf,B.arrayf=X.arrayf,B.names=[],B.XTI=[];var G=0,H=0,O=0,z=[],Y=[],J;X.codepage=1200,$o(1200);for(var te=!1;e.l<e.length-1;){var ee=e.l,ie=e.read_shift(2);if(ie===0&&G===10)break;var me=e.l===e.length?0:e.read_shift(2),Ce=g2[ie];if(Ce&&Ce.f){if(t.bookSheets&&G===133&&ie!==133)break;if(G=ie,Ce.r===2||Ce.r==12){var Oe=e.read_shift(2);if(me-=2,!X.enc&&Oe!==ie&&((Oe&255)<<8|Oe>>8)!==ie)throw new Error("rt mismatch: "+Oe+"!="+ie);Ce.r==12&&(e.l+=10,me-=10)}var fe={};if(ie===10?fe=Ce.f(e,me,X):fe=Eee(ie,Ce,e,me,X),H==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(ie){case 34:r.opts.Date1904=R.WBProps.date1904=fe;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(X.enc||(e.l=0),X.enc=fe,!t.password)throw new Error("File is password-protected");if(fe.valid==null)throw new Error("Encryption scheme unsupported");if(!fe.valid)throw new Error("Password is incorrect");break;case 92:X.lastuser=fe;break;case 66:var pe=Number(fe);switch(pe){case 21010:pe=1200;break;case 32768:pe=1e4;break;case 32769:pe=1252;break}$o(X.codepage=pe),te=!0;break;case 317:X.rrtabid=fe;break;case 25:X.winlocked=fe;break;case 439:r.opts.RefreshAll=fe;break;case 12:r.opts.CalcCount=fe;break;case 16:r.opts.CalcDelta=fe;break;case 17:r.opts.CalcIter=fe;break;case 13:r.opts.CalcMode=fe;break;case 14:r.opts.CalcPrecision=fe;break;case 95:r.opts.CalcSaveRecalc=fe;break;case 15:X.CalcRefMode=fe;break;case 2211:r.opts.FullCalc=fe;break;case 129:fe.fDialog&&(s["!type"]="dialog"),fe.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),fe.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:A.push(fe);break;case 430:B.push([fe]),B[B.length-1].XTI=[];break;case 35:case 547:B[B.length-1].push(fe);break;case 24:case 536:J={Name:fe.Name,Ref:Pa(fe.rgce,i,null,B,X)},fe.itab>0&&(J.Sheet=fe.itab-1),B.names.push(J),B[0]||(B[0]=[],B[0].XTI=[]),B[B.length-1].push(fe),fe.Name=="_xlnm._FilterDatabase"&&fe.itab>0&&fe.rgce&&fe.rgce[0]&&fe.rgce[0][0]&&fe.rgce[0][0][0]=="PtgArea3d"&&(Y[fe.itab-1]={ref:Nr(fe.rgce[0][0][1][2])});break;case 22:X.ExternCount=fe;break;case 23:B.length==0&&(B[0]=[],B[0].XTI=[]),B[B.length-1].XTI=B[B.length-1].XTI.concat(fe),B.XTI=B.XTI.concat(fe);break;case 2196:if(X.biff<8)break;J!=null&&(J.Comment=fe[1]);break;case 18:s["!protect"]=fe;break;case 19:fe!==0&&X.WTF&&console.error("Password verifier: "+fe);break;case 133:a[fe.pos]=fe,X.snames.push(fe.name);break;case 10:{if(--H)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Nr(i),t.sheetRows&&t.sheetRows<=i.e.r){var He=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Nr(i),i.e.r=He}i.e.r++,i.e.c++}oe.length>0&&(s["!merges"]=oe),q.length>0&&(s["!objects"]=q),re.length>0&&(s["!cols"]=re),M.length>0&&(s["!rows"]=M),R.Sheets.push(T)}d===""?f=s:n[d]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(X.biff===8&&(X.biff={9:2,521:3,1033:4}[ie]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[fe.BIFFVer]||8),X.biffguess=fe.BIFFVer==0,fe.BIFFVer==0&&fe.dt==4096&&(X.biff=5,te=!0,$o(X.codepage=28591)),X.biff==8&&fe.BIFFVer==0&&fe.dt==16&&(X.biff=2),H++)break;if(s=t.dense?[]:{},X.biff<8&&!te&&(te=!0,$o(X.codepage=t.codepage||1252)),X.biff<5||fe.BIFFVer==0&&fe.dt==4096){d===""&&(d="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ye={pos:e.l-me,name:d};a[Ye.pos]=Ye,X.snames.push(d)}else d=(a[ee]||{name:""}).name;fe.dt==32&&(s["!type"]="chart"),fe.dt==64&&(s["!type"]="macro"),oe=[],q=[],X.arrayf=k=[],re=[],M=[],W=!1,T={Hidden:(a[ee]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[fe.r]||[])[fe.c]:s[xr({c:fe.c,r:fe.r})])&&++fe.c,_={ixfe:fe.ixfe,XF:A[fe.ixfe]||{},v:fe.val,t:"n"},O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:fe.c,r:fe.r},_,t);break;case 5:case 517:_={ixfe:fe.ixfe,XF:A[fe.ixfe],v:fe.val,t:fe.t},O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:fe.c,r:fe.r},_,t);break;case 638:_={ixfe:fe.ixfe,XF:A[fe.ixfe],v:fe.rknum,t:"n"},O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:fe.c,r:fe.r},_,t);break;case 189:for(var ot=fe.c;ot<=fe.C;++ot){var Ve=fe.rkrec[ot-fe.c][0];_={ixfe:Ve,XF:A[Ve],v:fe.rkrec[ot-fe.c][1],t:"n"},O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:ot,r:fe.r},_,t)}break;case 6:case 518:case 1030:{if(fe.val=="String"){o=fe;break}if(_=k1(fe.val,fe.cell.ixfe,fe.tt),_.XF=A[_.ixfe],t.cellFormula){var Rt=fe.formula;if(Rt&&Rt[0]&&Rt[0][0]&&Rt[0][0][0]=="PtgExp"){var tt=Rt[0][0][1][0],Le=Rt[0][0][1][1],De=xr({r:tt,c:Le});E[De]?_.f=""+Pa(fe.formula,i,fe.cell,B,X):_.F=((t.dense?(s[tt]||[])[Le]:s[De])||{}).F}else _.f=""+Pa(fe.formula,i,fe.cell,B,X)}O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K(fe.cell,_,t),o=fe}break;case 7:case 519:if(o)o.val=fe,_=k1(fe,o.cell.ixfe,"s"),_.XF=A[_.ixfe],t.cellFormula&&(_.f=""+Pa(o.formula,i,o.cell,B,X)),O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{k.push(fe);var Je=xr(fe[0].s);if(y=t.dense?(s[fe[0].s.r]||[])[fe[0].s.c]:s[Je],t.cellFormula&&y){if(!o||!Je||!y)break;y.f=""+Pa(fe[1],i,fe[0],B,X),y.F=Nr(fe[0])}}break;case 1212:{if(!t.cellFormula)break;if(g){if(!o)break;E[xr(o.cell)]=fe[0],y=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[xr(o.cell)],(y||{}).f=""+Pa(fe[0],i,p,B,X)}}break;case 253:_=k1(c[fe.isst].t,fe.ixfe,"s"),c[fe.isst].h&&(_.h=c[fe.isst].h),_.XF=A[_.ixfe],O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:fe.c,r:fe.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:fe.ixfe,XF:A[fe.ixfe],t:"z"},O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:fe.c,r:fe.r},_,t));break;case 190:if(t.sheetStubs)for(var _t=fe.c;_t<=fe.C;++_t){var ht=fe.ixfe[_t-fe.c];_={ixfe:ht,XF:A[ht],t:"z"},O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:_t,r:fe.r},_,t)}break;case 214:case 516:case 4:_=k1(fe.val,fe.ixfe,"s"),_.XF=A[_.ixfe],O>0&&(_.z=z[_.ixfe>>8&63]),xl(_,t,r.opts.Date1904),K({c:fe.c,r:fe.r},_,t);break;case 0:case 512:H===1&&(i=fe);break;case 252:c=fe;break;case 1054:if(X.biff==4){z[O++]=fe[1];for(var It=0;It<O+163&&mr[It]!=fe[1];++It);It>=163&&wc(fe[1],O+163)}else wc(fe[1],fe[0]);break;case 30:{z[O++]=fe;for(var Mt=0;Mt<O+163&&mr[Mt]!=fe;++Mt);Mt>=163&&wc(fe,O+163)}break;case 229:oe=oe.concat(fe);break;case 93:q[fe.cmo[0]]=X.lastobj=fe;break;case 438:X.lastobj.TxO=fe;break;case 127:X.lastobj.ImData=fe;break;case 440:for(b=fe[0].s.r;b<=fe[0].e.r;++b)for(w=fe[0].s.c;w<=fe[0].e.c;++w)y=t.dense?(s[b]||[])[w]:s[xr({c:w,r:b})],y&&(y.l=fe[1]);break;case 2048:for(b=fe[0].s.r;b<=fe[0].e.r;++b)for(w=fe[0].s.c;w<=fe[0].e.c;++w)y=t.dense?(s[b]||[])[w]:s[xr({c:w,r:b})],y&&y.l&&(y.l.Tooltip=fe[1]);break;case 28:{if(X.biff<=5&&X.biff>=2)break;y=t.dense?(s[fe[0].r]||[])[fe[0].c]:s[xr(fe[0])];var rt=q[fe[2]];y||(t.dense?(s[fe[0].r]||(s[fe[0].r]=[]),y=s[fe[0].r][fe[0].c]={t:"z"}):y=s[xr(fe[0])]={t:"z"},i.e.r=Math.max(i.e.r,fe[0].r),i.s.r=Math.min(i.s.r,fe[0].r),i.e.c=Math.max(i.e.c,fe[0].c),i.s.c=Math.min(i.s.c,fe[0].c)),y.c||(y.c=[]),v={a:fe[1],t:rt.TxO.t},y.c.push(v)}break;case 2173:mX(A[fe.ixfe],fe.ext);break;case 125:{if(!X.cellStyles)break;for(;fe.e>=fe.s;)re[fe.e--]={width:fe.w/256,level:fe.level||0,hidden:!!(fe.flags&1)},W||(W=!0,AS(fe.w/256)),Uu(re[fe.e+1])}break;case 520:{var qe={};fe.level!=null&&(M[fe.r]=qe,qe.level=fe.level),fe.hidden&&(M[fe.r]=qe,qe.hidden=!0),fe.hpt&&(M[fe.r]=qe,qe.hpt=fe.hpt,qe.hpx=f0(fe.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Xd(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ie]]=fe;break;case 161:s["!margins"]||Xd(s["!margins"]={}),s["!margins"].header=fe.header,s["!margins"].footer=fe.footer;break;case 574:fe.RTL&&(R.Views[0].RTL=!0);break;case 146:P=fe;break;case 2198:Z=fe;break;case 140:N=fe;break;case 442:d?T.CodeName=fe||T.name:R.WBProps.CodeName=fe||"ThisWorkbook";break}}else Ce||console.error("Missing Info for XLS Record 0x"+ie.toString(16)),e.l+=me}return r.SheetNames=ss(a).sort(function(pt,lt){return Number(pt)-Number(lt)}).map(function(pt){return a[pt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&Y.forEach(function(pt,lt){r.Sheets[r.SheetNames[lt]]["!autofilter"]=pt}),r.Strings=c,r.SSF=In(mr),X.enc&&(r.Encryption=X.enc),Z&&(r.Themes=Z),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),B.names.length>0&&(R.Names=B.names),r.Workbook=R,r}var Wm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Aee(e,t,r){var n=lr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=qN(n,o2,Wm.DSI);for(var a in s)t[a]=s[a]}catch(d){if(r.WTF)throw d}var i=lr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=qN(i,l2,Wm.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(q8(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function jee(e,t){var r=[],n=[],s=[],a=0,i,o=kN(o2,"n"),c=kN(l2,"n");if(e.Props)for(i=ss(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=ss(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var d=[];for(a=0;a<s.length;++a)tF.indexOf(s[a][0])>-1||K8.indexOf(s[a][0])>-1||s[a][1]!=null&&d.push(s[a]);n.length&&lr.utils.cfb_add(t,"/SummaryInformation",XN(n,Wm.SI,c,l2)),(r.length||d.length)&&lr.utils.cfb_add(t,"/DocumentSummaryInformation",XN(r,Wm.DSI,o,o2,d.length?d:null,Wm.UDI))}function YF(e,t){t||(t={}),LS(t),aS(),t.codepage&&sS(t.codepage);var r,n;if(e.FullPaths){if(lr.find(e,"/encryption"))throw new Error("File is password-protected");r=lr.find(e,"!CompObj"),n=lr.find(e,"/Workbook")||lr.find(e,"/Book")}else{switch(t.type){case"base64":e=Li($i(e));break;case"binary":e=Li(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}pa(e,0),n={content:e}}var s,a;if(r&&Cee(r),t.bookProps&&!t.bookSheets)s={};else{var i=Ir?"buffer":"array";if(n&&n.content)s=Nee(n.content,t);else if((a=lr.find(e,"PerfectOffice_MAIN"))&&a.content)s=qd.to_workbook(a.content,(t.type=i,t));else if((a=lr.find(e,"NativeContent_MAIN"))&&a.content)s=qd.to_workbook(a.content,(t.type=i,t));else throw(a=lr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&lr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=zX(e))}var o={};return e.FullPaths&&Aee(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function Fee(e,t){var r=t||{},n=lr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return lr.utils.cfb_add(n,s,QF(e,r)),r.biff==8&&(e.Props||e.Custprops)&&jee(e,n),r.biff==8&&e.vbaraw&&HX(n,lr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var yp={0:{f:tJ},1:{f:cJ},2:{f:NJ},3:{f:xJ},4:{f:hJ},5:{f:CJ},6:{f:RJ},7:{f:_J},8:{f:UJ},9:{f:BJ},10:{f:OJ},11:{f:LJ},12:{f:dJ},13:{f:jJ},14:{f:vJ},15:{f:mJ},16:{f:WF},17:{f:IJ},18:{f:SJ},19:{f:vS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:IZ},40:{},42:{},43:{f:Rq},44:{f:Fq},45:{f:Mq},46:{f:Lq},47:{f:Oq},48:{},49:{f:sG},50:{},51:{f:yX},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:fF},62:{f:PJ},63:{f:EX},64:{f:rZ},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ua,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JJ},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:oJ},148:{f:sJ,p:16},151:{f:VJ},152:{},153:{f:PZ},154:{},155:{},156:{f:jZ},157:{},158:{},159:{T:1,f:qK},160:{T:-1},161:{T:1,f:kf},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:$J},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:pX},336:{T:-1},337:{f:_X,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:i2},357:{},358:{},359:{},360:{T:1},361:{},362:{f:dF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KJ},427:{f:qJ},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:YJ},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:iJ},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HJ},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:i2},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:LX},633:{T:1},634:{T:-1},635:{T:1,f:MX},636:{T:-1},637:{f:lG},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:vZ},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:nZ},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},g2={6:{f:Gw},10:{f:wu},12:{f:Cs},13:{f:Cs},14:{f:hs},15:{f:hs},16:{f:Da},17:{f:hs},18:{f:hs},19:{f:Cs},20:{f:t3},21:{f:t3},23:{f:dF},24:{f:n3},25:{f:hs},26:{},27:{},28:{f:nK},29:{},34:{f:hs},35:{f:r3},38:{f:Da},39:{f:Da},40:{f:Da},41:{f:Da},42:{f:hs},43:{f:hs},47:{f:mq},49:{f:jV},51:{f:Cs},60:{},61:{f:CV},64:{f:hs},65:{f:AV},66:{f:Cs},77:{},80:{},81:{},82:{},85:{f:Cs},89:{},90:{},91:{},92:{f:gV},93:{f:iK},94:{},95:{f:hs},96:{},97:{},99:{f:hs},125:{f:fF},128:{f:GV},129:{f:pV},130:{f:Cs},131:{f:hs},132:{f:hs},133:{f:xV},134:{},140:{f:gK},141:{f:Cs},144:{},146:{f:xK},151:{},152:{},153:{},154:{},155:{},156:{f:Cs},157:{},158:{},160:{f:kK},161:{f:wK},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:$V},190:{f:WV},193:{f:wu},197:{},198:{},199:{},200:{},201:{},202:{f:hs},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Cs},220:{},221:{f:hs},222:{},224:{f:HV},225:{f:hV},226:{f:wu},227:{},229:{f:sK},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:vV},253:{f:PV},255:{f:_V},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:rF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:hs},353:{f:wu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:YV},431:{f:hs},432:{},433:{},434:{},437:{},438:{f:cK},439:{f:hs},440:{f:uK},441:{},442:{f:Kp},443:{},444:{f:Cs},445:{},446:{},448:{f:wu},449:{f:kV,r:2},450:{f:wu},512:{f:JN},513:{f:SK},515:{f:qV},516:{f:DV},517:{f:e3},519:{f:CK},520:{f:bV},523:{},545:{f:s3},549:{f:QN},566:{},574:{f:EV},638:{f:UV},659:{},1048:{},1054:{f:MV},1084:{},1212:{f:eK},2048:{f:fK},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:_1},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:wu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:yK,r:12},2173:{f:gX,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:hs,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ZV,r:12},2197:{},2198:{f:lX,r:12},2199:{},2200:{},2201:{},2202:{f:tK,r:12},2203:{f:wu},2204:{},2205:{},2206:{},2207:{},2211:{f:SV},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Cs},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:_K},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:pK},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:JN},1:{},2:{f:jK},3:{f:NK},4:{f:EK},5:{f:e3},7:{f:PK},8:{},9:{f:_1},11:{},22:{f:Cs},30:{f:LV},31:{},32:{},33:{f:s3},36:{},37:{f:QN},50:{f:RK},62:{},52:{},67:{},68:{f:Cs},69:{},86:{},126:{},127:{f:TK},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:DK},223:{},234:{},354:{},421:{},518:{f:Gw},521:{f:_1},536:{f:n3},547:{f:r3},561:{},579:{},1030:{f:Gw},1033:{f:_1},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ut(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&pS(r)&&e.push(r)}}function Pee(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return Ut(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,d=0;d+(i[o]||8224)<=8224;)d+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d;c<s;){for(f=e.next(4),f.write_shift(2,60),d=0;d+(i[o]||8224)<=8224;)d+=i[o]||8224,o++;f.write_shift(2,d),e.push(r.slice(c,c+d)),c+=d}}}function Qp(e,t,r){return e||(e=yt(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Ree(e,t,r,n){var s=yt(9);return Qp(s,e,t),nF(r,n||"b",s),s}function Dee(e,t,r){var n=yt(8+2*r.length);return Qp(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function Iee(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Bs(Dn(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?Ut(e,2,FK(r,n,s)):Ut(e,3,AK(r,n,s));return;case"b":case"e":Ut(e,5,Ree(r,n,t.v,t.t));return;case"s":case"str":Ut(e,4,Dee(r,n,(t.v||"").slice(0,255)));return}Ut(e,1,Qp(null,r,n))}function Mee(e,t,r,n){var s=Array.isArray(t),a=qr(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Nr(a)}for(var d=a.s.r;d<=a.e.r;++d){o=ms(d);for(var f=a.s.c;f<=a.e.c;++f){d===a.s.r&&(c[f]=Hn(f)),i=c[f]+o;var p=s?(t[d]||[])[f]:t[i];p&&Iee(e,p,d,f)}}}function Oee(e,t){for(var r=t||{},n=ki(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ut(n,r.biff==4?1033:r.biff==3?521:9,TS(e,16,r)),Mee(n,e.Sheets[e.SheetNames[s]],s,r),Ut(n,10),n.end()}function Lee(e,t,r){Ut(e,49,FV({sz:12,name:"Arial"},r))}function Bee(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Ut(e,1054,OV(s,t[s],r))})}function Uee(e,t){var r=yt(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ut(e,2151,r),r=yt(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),lF(qr(t["!ref"]||"A1"),r),r.write_shift(4,4),Ut(e,2152,r)}function $ee(e,t){for(var r=0;r<16;++r)Ut(e,224,ZN({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ut(e,224,ZN(n,0,t))})}function Wee(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ut(e,440,dK(n)),n[1].Tooltip&&Ut(e,2048,hK(n))}delete t["!links"]}function zee(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&Ut(e,125,vK(iv(s,n),s))})}}function Hee(e,t,r,n,s){var a=16+Ju(s.cellXfs,t,s);if(t.v==null&&!t.bf){Ut(e,513,mf(r,n,a));return}if(t.bf)Ut(e,6,pQ(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Bs(Dn(t.v)):t.v;Ut(e,515,XV(r,n,i,a));break;case"b":case"e":Ut(e,517,KV(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=DS(s.Strings,t.v,s.revStrings);Ut(e,253,RV(r,n,o,a))}else Ut(e,516,IV(r,n,(t.v||"").slice(0,255),a,s));break;default:Ut(e,513,mf(r,n,a))}}function Gee(e,t,r){var n=ki(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),d=t.biff==8,f,p="",g=[],y=qr(a["!ref"]||"A1"),v=d?65536:16384;if(y.e.c>255||y.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,v-1)}Ut(n,2057,TS(r,16,t)),Ut(n,13,uo(1)),Ut(n,12,uo(100)),Ut(n,15,ti(!0)),Ut(n,17,ti(!1)),Ut(n,16,hf(.001)),Ut(n,95,ti(!0)),Ut(n,42,ti(!1)),Ut(n,43,ti(!1)),Ut(n,130,uo(1)),Ut(n,128,VV()),Ut(n,131,ti(!1)),Ut(n,132,ti(!1)),d&&zee(n,a["!cols"]),Ut(n,512,BV(y,t)),d&&(a["!links"]=[]);for(var w=y.s.r;w<=y.e.r;++w){p=ms(w);for(var b=y.s.c;b<=y.e.c;++b){w===y.s.r&&(g[b]=Hn(b)),f=g[b]+p;var E=c?(a[w]||[])[b]:a[f];E&&(Hee(n,E,w,b,t),d&&E.l&&a["!links"].push([f,E.l]))}}var k=o.CodeName||o.name||s;return d&&Ut(n,574,NV((i.Views||[])[0])),d&&(a["!merges"]||[]).length&&Ut(n,229,aK(a["!merges"])),d&&Wee(n,a),Ut(n,442,sF(k)),d&&Uee(n,a),Ut(n,10),n.end()}function Vee(e,t,r){var n=ki(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(Ut(n,2057,TS(e,5,r)),r.bookType=="xla"&&Ut(n,135),Ut(n,225,o?uo(1200):null),Ut(n,193,KG(2)),c&&Ut(n,191),c&&Ut(n,192),Ut(n,226),Ut(n,92,mV("SheetJS",r)),Ut(n,66,uo(o?1200:1252)),o&&Ut(n,353,uo(0)),o&&Ut(n,448),Ut(n,317,bK(e.SheetNames.length)),o&&e.vbaraw&&Ut(n,211),o&&e.vbaraw){var d=i.CodeName||"ThisWorkbook";Ut(n,442,sF(d))}Ut(n,156,uo(17)),Ut(n,25,ti(!1)),Ut(n,18,ti(!1)),Ut(n,19,uo(0)),o&&Ut(n,431,ti(!1)),o&&Ut(n,444,uo(0)),Ut(n,61,TV()),Ut(n,64,ti(!1)),Ut(n,141,uo(0)),Ut(n,34,ti(kZ(e)=="true")),Ut(n,14,ti(!0)),o&&Ut(n,439,ti(!1)),Ut(n,218,uo(0)),Lee(n,e,r),Bee(n,e.SSF,r),$ee(n,r),o&&Ut(n,352,ti(!1));var f=n.end(),p=ki();o&&Ut(p,140,mK()),o&&r.Strings&&Pee(p,252,wV(r.Strings)),Ut(p,10);var g=p.end(),y=ki(),v=0,w=0;for(w=0;w<e.SheetNames.length;++w)v+=(o?12:11)+(o?2:1)*e.SheetNames[w].length;var b=f.length+v+g.length;for(w=0;w<e.SheetNames.length;++w){var E=a[w]||{};Ut(y,133,yV({pos:b,hs:E.Hidden||0,dt:0,name:e.SheetNames[w]},r)),b+=t[w].length}var k=y.end();if(v!=k.length)throw new Error("BS8 "+v+" != "+k.length);var _=[];return f.length&&_.push(f),k.length&&_.push(k),g.length&&_.push(g),Zs(_)}function Kee(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=In(mr)),e&&e.SSF&&(j0(),Zy(e.SSF),r.revssf=tv(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,BS(r),r.cellXfs=[],Ju(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=Gee(s,r,e);return n.unshift(Vee(e,n,r)),Zs(n)}function QF(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Ci(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return Kee(e,t);case 4:case 3:case 2:return Oee(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function g3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=FH(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,f=0,p=0,g=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<c.length;++i){var w=c[i].trim(),b=w.slice(0,3).toLowerCase();if(b=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}f=0;continue}if(!(b!="<td"&&b!="<th")){var E=w.split(/<\/t[dh]>/i);for(o=0;o<E.length;++o){var k=E[o].trim();if(k.match(/<t[dh]/i)){for(var _=k,N=0;_.charAt(0)=="<"&&(N=_.indexOf(">"))>-1;)_=_.slice(N+1);for(var A=0;A<v.length;++A){var P=v[A];P.s.c==f&&P.s.r<d&&d<=P.e.r&&(f=P.e.c+1,A=-1)}var R=vr(k.slice(0,k.indexOf(">")));g=R.colspan?+R.colspan:1,((p=+R.rowspan)>1||g>1)&&v.push({s:{r:d,c:f},e:{r:d+(p||1)-1,c:f+g-1}});var T=R.t||R["data-t"]||"";if(!_.length){f+=g;continue}if(_=_8(_),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>f&&(y.s.c=f),y.e.c<f&&(y.e.c=f),!_.length){f+=g;continue}var D={t:"s",v:_};r.raw||!_.trim().length||T=="s"||(_==="TRUE"?D={t:"b",v:!0}:_==="FALSE"?D={t:"b",v:!1}:isNaN(Ho(_))?isNaN(u0(_).getDate())||(D={t:"d",v:Dn(_)},r.cellDates||(D={t:"n",v:Bs(D.v)}),D.z=r.dateNF||mr[14]):D={t:"n",v:Ho(_)}),r.dense?(n[d]||(n[d]=[]),n[d][f]=D):n[xr({r:d,c:f})]=D,f+=g}}}}return n["!ref"]=Nr(y),v.length&&(n["!merges"]=v),n}function qee(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,d=0;d<s.length;++d)if(!(s[d].s.r>r||s[d].s.c>i)&&!(s[d].e.r<r||s[d].e.c<i)){if(s[d].s.r<r||s[d].s.c<i){o=-1;break}o=s[d].e.r-s[d].s.r+1,c=s[d].e.c-s[d].s.c+1;break}if(!(o<0)){var f=xr({r,c:i}),p=n.dense?(e[r]||[])[i]:e[f],g=p&&p.v!=null&&(p.h||hS(p.w||(Tc(p),p.w)||""))||"",y={};o>1&&(y.rowspan=o),c>1&&(y.colspan=c),n.editable?g='<span contenteditable="true">'+g+"</span>":p&&(y["data-t"]=p&&p.t||"z",p.v!=null&&(y["data-v"]=p.v),p.z!=null&&(y["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),y.id=(n.id||"sjs")+"-"+f,a.push(Bt("td",g,y))}}var v="<tr>";return v+a.join("")+"</tr>"}var Xee='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Yee="</body></html>";function Qee(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Qu(g3(r[0],t),t);var n=WS();return r.forEach(function(s,a){zS(n,g3(s,t),"Sheet"+(a+1))}),n}function Jee(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function JF(e,t){var r=t||{},n=r.header!=null?r.header:Xee,s=r.footer!=null?r.footer:Yee,a=[n],i=Ci(e["!ref"]);r.dense=Array.isArray(e),a.push(Jee(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(qee(e,i,o,r));return a.push("</table>"+s),a.join("")}function ZF(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?Gn(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),d={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=Ci(e["!ref"]);d.s.r=Math.min(d.s.r,f.s.r),d.s.c=Math.min(d.s.c,f.s.c),d.e.r=Math.max(d.e.r,f.e.r),d.e.c=Math.max(d.e.c,f.e.c),s==-1&&(d.e.r=s=f.e.r+1)}var p=[],g=0,y=e["!rows"]||(e["!rows"]=[]),v=0,w=0,b=0,E=0,k=0,_=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&w<c;++v){var N=o[v];if(m3(N)){if(n.display)continue;y[w]={hidden:!0}}var A=N.children;for(b=E=0;b<A.length;++b){var P=A[b];if(!(n.display&&m3(P))){var R=P.hasAttribute("data-v")?P.getAttribute("data-v"):P.hasAttribute("v")?P.getAttribute("v"):_8(P.innerHTML),T=P.getAttribute("data-z")||P.getAttribute("z");for(g=0;g<p.length;++g){var D=p[g];D.s.c==E+a&&D.s.r<w+s&&w+s<=D.e.r&&(E=D.e.c+1-a,g=-1)}_=+P.getAttribute("colspan")||1,((k=+P.getAttribute("rowspan")||1)>1||_>1)&&p.push({s:{r:w+s,c:E+a},e:{r:w+s+(k||1)-1,c:E+a+(_||1)-1}});var I={t:"s",v:R},K=P.getAttribute("data-t")||P.getAttribute("t")||"";R!=null&&(R.length==0?I.t=K||"z":n.raw||R.trim().length==0||K=="s"||(R==="TRUE"?I={t:"b",v:!0}:R==="FALSE"?I={t:"b",v:!1}:isNaN(Ho(R))?isNaN(u0(R).getDate())||(I={t:"d",v:Dn(R)},n.cellDates||(I={t:"n",v:Bs(I.v)}),I.z=n.dateNF||mr[14]):I={t:"n",v:Ho(R)})),I.z===void 0&&T!=null&&(I.z=T);var X="",Z=P.getElementsByTagName("A");if(Z&&Z.length)for(var oe=0;oe<Z.length&&!(Z[oe].hasAttribute("href")&&(X=Z[oe].getAttribute("href"),X.charAt(0)!="#"));++oe);X&&X.charAt(0)!="#"&&(I.l={Target:X}),n.dense?(e[w+s]||(e[w+s]=[]),e[w+s][E+a]=I):e[xr({c:E+a,r:w+s})]=I,d.e.c<E+a&&(d.e.c=E+a),E+=_}}++w}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,w-1+s),e["!ref"]=Nr(d),w>=c&&(e["!fullref"]=Nr((d.e.r=o.length-v+w-1+s,d))),e}function eP(e,t){var r=t||{},n=r.dense?[]:{};return ZF(n,e,t)}function Zee(e,t){return Qu(eP(e,t),t)}function m3(e){var t="",r=ete(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function ete(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function tte(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Kr(t.replace(/<[^>]*>/g,""));return[r]}var p3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function tP(e,t){var r=t||{},n=gS(e),s=[],a,i,o={name:""},c="",d=0,f,p,g={},y=[],v=r.dense?[]:{},w,b,E={value:""},k="",_=0,N=[],A=-1,P=-1,R={s:{r:1e6,c:1e7},e:{r:0,c:0}},T=0,D={},I=[],K={},X=0,Z=0,oe=[],q=1,re=1,M=[],W={Names:[]},B={},G=["",""],H=[],O={},z="",Y=0,J=!1,te=!1,ee=0;for(fp.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");w=fp.exec(n);)switch(w[3]=w[3].replace(/_.*$/,"")){case"table":case"":w[1]==="/"?(R.e.c>=R.s.c&&R.e.r>=R.s.r?v["!ref"]=Nr(R):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=R.e.r&&(v["!fullref"]=v["!ref"],R.e.r=r.sheetRows-1,v["!ref"]=Nr(R)),I.length&&(v["!merges"]=I),oe.length&&(v["!rows"]=oe),f.name=f.||f.name,typeof JSON<"u"&&JSON.stringify(f),y.push(f.name),g[f.name]=v,te=!1):w[0].charAt(w[0].length-2)!=="/"&&(f=vr(w[0],!1),A=P=-1,R.s.r=R.s.c=1e7,R.e.r=R.e.c=0,v=r.dense?[]:{},I=[],oe=[],te=!0);break;case"table-row-group":w[1]==="/"?--T:++T;break;case"table-row":case"":if(w[1]==="/"){A+=q,q=1;break}if(p=vr(w[0],!1),p.?A=p.-1:A==-1&&(A=0),q=+p["number-rows-repeated"]||1,q<10)for(ee=0;ee<q;++ee)T>0&&(oe[A+ee]={level:T});P=-1;break;case"covered-table-cell":w[1]!=="/"&&++P,r.sheetStubs&&(r.dense?(v[A]||(v[A]=[]),v[A][P]={t:"z"}):v[xr({r:A,c:P})]={t:"z"}),k="",N=[];break;case"table-cell":case"":if(w[0].charAt(w[0].length-2)==="/")++P,E=vr(w[0],!1),re=parseInt(E["number-columns-repeated"]||"1",10),b={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(b.f=d3(Kr(E.formula))),(E.||E["value-type"])=="string"&&(b.t="s",b.v=Kr(E["string-value"]||""),r.dense?(v[A]||(v[A]=[]),v[A][P]=b):v[xr({r:A,c:P})]=b),P+=re-1;else if(w[1]!=="/"){++P,k="",_=0,N=[],re=1;var ie=q?A+q-1:A;if(P>R.e.c&&(R.e.c=P),P<R.s.c&&(R.s.c=P),A<R.s.r&&(R.s.r=A),ie>R.e.r&&(R.e.r=ie),E=vr(w[0],!1),H=[],O={},b={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=Kr(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(X=parseInt(E["number-matrix-rows-spanned"],10)||0,Z=parseInt(E["number-matrix-columns-spanned"],10)||0,K={s:{r:A,c:P},e:{r:A+X-1,c:P+Z-1}},b.F=Nr(K),M.push([K,b.F])),E.formula)b.f=d3(E.formula);else for(ee=0;ee<M.length;++ee)A>=M[ee][0].s.r&&A<=M[ee][0].e.r&&P>=M[ee][0].s.c&&P<=M[ee][0].e.c&&(b.F=M[ee][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(X=parseInt(E["number-rows-spanned"],10)||0,Z=parseInt(E["number-columns-spanned"],10)||0,K={s:{r:A,c:P},e:{r:A+X-1,c:P+Z-1}},I.push(K)),E["number-columns-repeated"]&&(re=parseInt(E["number-columns-repeated"],10)),b.t){case"boolean":b.t="b",b.v=jn(E["boolean-value"]);break;case"float":b.t="n",b.v=parseFloat(E.value);break;case"percentage":b.t="n",b.v=parseFloat(E.value);break;case"currency":b.t="n",b.v=parseFloat(E.value);break;case"date":b.t="d",b.v=Dn(E["date-value"]),r.cellDates||(b.t="n",b.v=Bs(b.v)),b.z="m/d/yy";break;case"time":b.t="n",b.v=NH(E["time-value"])/86400,r.cellDates&&(b.t="d",b.v=rv(b.v)),b.z="HH:MM:SS";break;case"number":b.t="n",b.v=parseFloat(E.);break;default:if(b.t==="string"||b.t==="text"||!b.t)b.t="s",E["string-value"]!=null&&(k=Kr(E["string-value"]),N=[]);else throw new Error("Unsupported value type "+b.t)}}else{if(J=!1,b.t==="s"&&(b.v=k||"",N.length&&(b.R=N),J=_==0),B.Target&&(b.l=B),H.length>0&&(b.c=H,H=[]),k&&r.cellText!==!1&&(b.w=k),J&&(b.t="z",delete b.v),(!J||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=A))for(var me=0;me<q;++me){if(re=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(v[A+me]||(v[A+me]=[]),v[A+me][P]=me==0?b:In(b);--re>0;)v[A+me][P+re]=In(b);else for(v[xr({r:A+me,c:P})]=b;--re>0;)v[xr({r:A+me,c:P+re})]=In(b);R.e.c<=P&&(R.e.c=P)}re=parseInt(E["number-columns-repeated"]||"1",10),P+=re-1,re=0,b={},k="",N=[]}B={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(w[1]==="/"){if((a=s.pop())[0]!==w[3])throw"Bad state: "+a}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!0]);break;case"annotation":if(w[1]==="/"){if((a=s.pop())[0]!==w[3])throw"Bad state: "+a;O.t=k,N.length&&(O.R=N),O.a=z,H.push(O)}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);z="",Y=0,k="",_=0,N=[];break;case"creator":w[1]==="/"?z=n.slice(Y,w.index):Y=w.index+w[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(w[1]==="/"){if((a=s.pop())[0]!==w[3])throw"Bad state: "+a}else w[0].charAt(w[0].length-2)!=="/"&&s.push([w[3],!1]);k="",_=0,N=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(w[1]==="/"){if(D[o.name]=c,(a=s.pop())[0]!==w[3])throw"Bad state: "+a}else w[0].charAt(w[0].length-2)!=="/"&&(c="",o=vr(w[0],!1),s.push([w[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=vr(w[0],!1),c+=p3[w[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=vr(w[0],!1),c+=p3[w[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(w[0].slice(-2)==="/>")break;if(w[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(d,w.index);break}else d=w.index+w[0].length;break;case"named-range":i=vr(w[0],!1),G=Vw(i["cell-range-address"]);var Ce={Name:i.name,Ref:G[0]+"!"+G[1]};te&&(Ce.Sheet=y.length),W.Names.push(Ce);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(w[1]==="/"&&(!E||!E["string-value"])){var Oe=tte(n.slice(_,w.index));k=(k.length>0?k+`
`:"")+Oe[0]}else vr(w[0],!1),_=w.index+w[0].length;break;case"s":break;case"database-range":if(w[1]==="/")break;try{G=Vw(vr(w[0])["target-range-address"]),g[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(w[1]!=="/"){if(B=vr(w[0],!1),!B.href)break;B.Target=Kr(B.href),delete B.href,B.Target.charAt(0)=="#"&&B.Target.indexOf(".")>-1?(G=Vw(B.Target.slice(1)),B.Target="#"+G[0]+"!"+G[1]):B.Target.match(/^\.\.[\\\/]/)&&(B.Target=B.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(w[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(w)}}var fe={Sheets:g,SheetNames:y,Workbook:W};return r.bookSheets&&delete fe.Sheets,fe}function x3(e,t){t=t||{},co(e,"META-INF/manifest.xml")&&NG(ks(e,"META-INF/manifest.xml"),t);var r=Bi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=tP(yn(r),t);return co(e,"meta.xml")&&(n.Props=G8(ks(e,"meta.xml"))),n}function y3(e,t){return tP(e,t)}var rte=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+dp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return xs+t}})(),v3=(function(){var e=function(a){return dn(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+dn(i.SheetNames[o])+`" table:style-name="ta1">
`);var d=0,f=0,p=Ci(a["!ref"]||"A1"),g=a["!merges"]||[],y=0,v=Array.isArray(a);if(a["!cols"])for(f=0;f<=p.e.c;++f)c.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var w="",b=a["!rows"]||[];for(d=0;d<p.s.r;++d)w=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+w+`></table:table-row>
`);for(;d<=p.e.r;++d){for(w=b[d]?' table:style-name="ro'+b[d].ods+'"':"",c.push("        <table:table-row"+w+`>
`),f=0;f<p.s.c;++f)c.push(t);for(;f<=p.e.c;++f){var E=!1,k={},_="";for(y=0;y!=g.length;++y)if(!(g[y].s.c>f)&&!(g[y].s.r>d)&&!(g[y].e.c<f)&&!(g[y].e.r<d)){(g[y].s.c!=f||g[y].s.r!=d)&&(E=!0),k["table:number-columns-spanned"]=g[y].e.c-g[y].s.c+1,k["table:number-rows-spanned"]=g[y].e.r-g[y].s.r+1;break}if(E){c.push(r);continue}var N=xr({r:d,c:f}),A=v?(a[d]||[])[f]:a[N];if(A&&A.f&&(k["table:formula"]=dn(bQ(A.f)),A.F&&A.F.slice(0,N.length)==N)){var P=Ci(A.F);k["table:number-matrix-columns-spanned"]=P.e.c-P.s.c+1,k["table:number-matrix-rows-spanned"]=P.e.r-P.s.r+1}if(!A){c.push(t);continue}switch(A.t){case"b":_=A.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=A.v?"true":"false";break;case"n":_=A.w||String(A.v||0),k["office:value-type"]="float",k["office:value"]=A.v||0;break;case"s":case"str":_=A.v==null?"":A.v,k["office:value-type"]="string";break;case"d":_=A.w||Dn(A.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Dn(A.v).toISOString(),k["table:style-name"]="ce1";break;default:c.push(t);continue}var R=e(_);if(A.l&&A.l.Target){var T=A.l.Target;T=T.charAt(0)=="#"?"#"+SQ(T.slice(1)):T,T.charAt(0)!="#"&&!T.match(/^\w+:/)&&(T="../"+T),R=Bt("text:a",R,{"xlink:href":T.replace(/&/g,"&amp;")})}c.push("          "+Bt("table:table-cell",Bt("text:p",R,{}),k)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var f=0;f<d["!cols"].length;++f)if(d["!cols"][f]){var p=d["!cols"][f];if(p.width==null&&p.wpx==null&&p.wch==null)continue;Uu(p),p.ods=o;var g=d["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+g+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(d){return i.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var f=0;f<d["!rows"].length;++f)if(d["!rows"][f]){d["!rows"][f].ods=c;var p=d["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[xs],d=dp({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=dp({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+d+f+`>
`),c.push(H8().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var p=0;p!=i.SheetNames.length;++p)c.push(n(i.Sheets[i.SheetNames[p]],i,p));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function rP(e,t){if(t.bookType=="fods")return v3(e,t);var r=uS(),n="",s=[],a=[];return n="mimetype",jr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",jr(r,n,v3(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",jr(r,n,rte(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",jr(r,n,xs+H8()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",jr(r,n,FG(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",jr(r,n,AG(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function pf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function m2(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):yn(Yu(e))}function nte(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Li(Cl(e))}function ste(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Wu(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function w3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function ate(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function ite(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function vp(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function ln(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function ns(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Qr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=vp(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=vp(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var d={data:o,type:a};t[s]==null?t[s]=[d]:t[s].push(d)}return t}function ha(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(ln(n*8+s.type)),s.type==2&&t.push(ln(s.data.length)),t.push(s.data))})}),Wu(t)}function OS(e,t){return e?.map(function(r){return t(r.data)})||[]}function io(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=vp(e,n),a=Qr(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:ns(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Qr(o.data),d=ns(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=a[3])!=null&&t[0]&&(i.merge=ns(a[3][0].data)>>>0>0),r.push(i)}return r}function Th(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:ln(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ln(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:ln(i.data.length)}],n[2].push({data:ha(i.meta),type:2})});var a=ha(n);t.push(ln(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Wu(t)}function ote(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=vp(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,d=0;if(a==1?(d=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Wu(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(s.push(s[0].slice(-c)),d-=c;d>=s[s.length-1].length;)s.push(s[s.length-1]),d-=s[s.length-1].length;s.push(s[0].slice(-c,-c+d))}}var f=Wu(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function oo(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(ote(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Wu(t)}function Eh(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=ln(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Wu(t)}function lte(e,t,r,n){var s=pf(e),a=s.getUint32(4,!0),i=(n>1?12:8)+w3(a&(n>1?3470:398))*4,o=-1,c=-1,d=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=w3(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(d=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(o>-1)p={t:"s",v:r[o]};else if(c>-1)p={t:"s",v:t[c]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function cte(e,t,r){var n=pf(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,d=NaN,f=new Date(2001,0,1);s&1&&(c=ate(e,a),a+=16),s&2&&(d=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:t[o]};break;case 5:p={t:"d",v:f};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(i>-1)p={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return p}function qw(e,t){var r=new Uint8Array(32),n=pf(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,ite(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Xw(e,t){var r=new Uint8Array(32),n=pf(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function ute(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return lte(e,t,r,e[0]);case 5:return cte(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Fa(e){var t=Qr(e);return vp(t[1][0].data)}function _3(e,t){var r=Qr(t.data),n=ns(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Qr(i.data),c=ns(o[1][0].data)>>>0;switch(n){case 1:a[c]=m2(o[3][0].data);break;case 8:{var d=e[Fa(o[9][0].data)][0],f=Qr(d.data),p=e[Fa(f[1][0].data)][0],g=ns(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var y=Qr(p.data);a[c]=y[3].map(function(v){return m2(v.data)}).join("")}break}}),a}function dte(e,t){var r,n,s,a,i,o,c,d,f,p,g,y,v,w,b=Qr(e),E=ns(b[1][0].data)>>>0,k=ns(b[2][0].data)>>>0,_=((n=(r=b[8])==null?void 0:r[0])==null?void 0:n.data)&&ns(b[8][0].data)>0||!1,N,A;if((a=(s=b[7])==null?void 0:s[0])!=null&&a.data&&t!=0)N=(o=(i=b[7])==null?void 0:i[0])==null?void 0:o.data,A=(d=(c=b[6])==null?void 0:c[0])==null?void 0:d.data;else if((p=(f=b[4])==null?void 0:f[0])!=null&&p.data&&t!=1)N=(y=(g=b[4])==null?void 0:g[0])==null?void 0:y.data,A=(w=(v=b[3])==null?void 0:v[0])==null?void 0:w.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var P=_?4:1,R=pf(N),T=[],D=0;D<N.length/2;++D){var I=R.getUint16(D*2,!0);I<65535&&T.push([D,I])}if(T.length!=k)throw"Expected ".concat(k," cells, found ").concat(T.length);var K=[];for(D=0;D<T.length-1;++D)K[T[D][0]]=A.subarray(T[D][1]*P,T[D+1][1]*P);return T.length>=1&&(K[T[T.length-1][0]]=A.subarray(T[T.length-1][1]*P)),{R:E,cells:K}}function fte(e,t){var r,n=Qr(t.data),s=(r=n?.[7])!=null&&r[0]?ns(n[7][0].data)>>>0>0?1:0:-1,a=OS(n[5],function(i){return dte(i,s)});return{nrows:ns(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,d){if(i[o.R][d])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(d));i[o.R][d]=c}),i},[])}}function hte(e,t,r){var n,s=Qr(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(ns(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(ns(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Nr(a);var i=Qr(s[4][0].data),o=_3(e,e[Fa(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?_3(e,e[Fa(i[17][0].data)][0]):[],d=Qr(i[3][0].data),f=0;d[1].forEach(function(p){var g=Qr(p.data),y=e[Fa(g[2][0].data)][0],v=ns(y.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var w=fte(e,y);w.data.forEach(function(b,E){b.forEach(function(k,_){var N=xr({r:f+E,c:_}),A=ute(k,o,c);A&&(r[N]=A)})}),f+=w.nrows})}function gte(e,t){var r=Qr(t.data),n={"!ref":"A1"},s=e[Fa(r[2][0].data)],a=ns(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return hte(e,s[0],n),n}function mte(e,t){var r,n=Qr(t.data),s={name:(r=n[1])!=null&&r[0]?m2(n[1][0].data):"",sheets:[]},a=OS(n[2],Fa);return a.forEach(function(i){e[i].forEach(function(o){var c=ns(o.meta[1][0].data);c==6e3&&s.sheets.push(gte(e,o))})}),s}function pte(e,t){var r=WS(),n=Qr(t.data),s=OS(n[1],Fa);if(s.forEach(function(a){e[a].forEach(function(i){var o=ns(i.meta[1][0].data);if(o==2){var c=mte(e,i);c.sheets.forEach(function(d,f){zS(r,d,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Yw(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=oo(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var f;try{f=io(d)}catch(p){return console.log("## "+(p.message||p))}f.forEach(function(p){a[p.id]=p.messages,i.push(p.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&ns(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(d){var f=ns(d.meta[1][0].data)>>>0;if(f==1)if(!o)o=d;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return pte(a,o)}function xte(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&ns(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,d=pf(e[7][0].data),f=0,p=[],g=pf(e[4][0].data),y=0,v=[],w=0;w<t.length;++w){if(t[w]==null){d.setUint16(w*2,65535,!0),g.setUint16(w*2,65535);continue}d.setUint16(w*2,f,!0),g.setUint16(w*2,y,!0);var b,E;switch(typeof t[w]){case"string":b=qw({t:"s",v:t[w]},r),E=Xw({t:"s",v:t[w]},r);break;case"number":b=qw({t:"n",v:t[w]},r),E=Xw({t:"n",v:t[w]},r);break;case"boolean":b=qw({t:"b",v:t[w]},r),E=Xw({t:"b",v:t[w]},r);break;default:throw new Error("Unsupported value "+t[w])}p.push(b),f+=b.length,v.push(E),y+=E.length,++c}for(e[2][0].data=ln(c);w<e[7][0].data.length/2;++w)d.setUint16(w*2,65535,!0),g.setUint16(w*2,65535,!0);return e[6][0].data=Wu(p),e[3][0].data=Wu(v),c}function yte(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ci(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Nr(n)));var a=Sy(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(z){return z.forEach(function(Y){typeof Y=="string"&&i.push(Y)})});var o={},c=[],d=lr.read(t.numbers,{type:"base64"});d.FileIndex.map(function(z,Y){return[z,d.FullPaths[Y]]}).forEach(function(z){var Y=z[0],J=z[1];if(Y.type==2&&Y.name.match(/\.iwa/)){var te=Y.content,ee=oo(te),ie=io(ee);ie.forEach(function(me){c.push(me.id),o[me.id]={deps:[],location:J,type:ns(me.messages[0].meta[1][0].data)}})}}),c.sort(function(z,Y){return z-Y});var f=c.filter(function(z){return z>1}).map(function(z){return[z,ln(z)]});d.FileIndex.map(function(z,Y){return[z,d.FullPaths[Y]]}).forEach(function(z){var Y=z[0];if(z[1],!!Y.name.match(/\.iwa/)){var J=io(oo(Y.content));J.forEach(function(te){te.messages.forEach(function(ee){f.forEach(function(ie){te.messages.some(function(me){return ns(me.meta[1][0].data)!=11006&&ste(me.data,ie[1])})&&o[ie[0]].deps.push(te.id)})})})}});for(var p=lr.find(d,o[1].location),g=io(oo(p.content)),y,v=0;v<g.length;++v){var w=g[v];w.id==1&&(y=w)}var b=Fa(Qr(y.messages[0].data)[1][0].data);for(p=lr.find(d,o[b].location),g=io(oo(p.content)),v=0;v<g.length;++v)w=g[v],w.id==b&&(y=w);for(b=Fa(Qr(y.messages[0].data)[2][0].data),p=lr.find(d,o[b].location),g=io(oo(p.content)),v=0;v<g.length;++v)w=g[v],w.id==b&&(y=w);for(b=Fa(Qr(y.messages[0].data)[2][0].data),p=lr.find(d,o[b].location),g=io(oo(p.content)),v=0;v<g.length;++v)w=g[v],w.id==b&&(y=w);var E=Qr(y.messages[0].data);{E[6][0].data=ln(n.e.r+1),E[7][0].data=ln(n.e.c+1);var k=Fa(E[46][0].data),_=lr.find(d,o[k].location),N=io(oo(_.content));{for(var A=0;A<N.length&&N[A].id!=k;++A);if(N[A].id!=k)throw"Bad ColumnRowUIDMapArchive";var P=Qr(N[A].messages[0].data);P[1]=[],P[2]=[],P[3]=[];for(var R=0;R<=n.e.c;++R){var T=[];T[1]=T[2]=[{type:0,data:ln(R+420690)}],P[1].push({type:2,data:ha(T)}),P[2].push({type:0,data:ln(R)}),P[3].push({type:0,data:ln(R)})}P[4]=[],P[5]=[],P[6]=[];for(var D=0;D<=n.e.r;++D)T=[],T[1]=T[2]=[{type:0,data:ln(D+726270)}],P[4].push({type:2,data:ha(T)}),P[5].push({type:0,data:ln(D)}),P[6].push({type:0,data:ln(D)});N[A].messages[0].data=ha(P)}_.content=Eh(Th(N)),_.size=_.content.length,delete E[46];var I=Qr(E[4][0].data);{I[7][0].data=ln(n.e.r+1);var K=Qr(I[1][0].data),X=Fa(K[2][0].data);_=lr.find(d,o[X].location),N=io(oo(_.content));{if(N[0].id!=X)throw"Bad HeaderStorageBucket";var Z=Qr(N[0].messages[0].data);for(D=0;D<a.length;++D){var oe=Qr(Z[2][0].data);oe[1][0].data=ln(D),oe[4][0].data=ln(a[D].length),Z[2][D]={type:Z[2][0].type,data:ha(oe)}}N[0].messages[0].data=ha(Z)}_.content=Eh(Th(N)),_.size=_.content.length;var q=Fa(I[2][0].data);_=lr.find(d,o[q].location),N=io(oo(_.content));{if(N[0].id!=q)throw"Bad HeaderStorageBucket";for(Z=Qr(N[0].messages[0].data),R=0;R<=n.e.c;++R)oe=Qr(Z[2][0].data),oe[1][0].data=ln(R),oe[4][0].data=ln(n.e.r+1),Z[2][R]={type:Z[2][0].type,data:ha(oe)};N[0].messages[0].data=ha(Z)}_.content=Eh(Th(N)),_.size=_.content.length;var re=Fa(I[4][0].data);(function(){for(var z=lr.find(d,o[re].location),Y=io(oo(z.content)),J,te=0;te<Y.length;++te){var ee=Y[te];ee.id==re&&(J=ee)}var ie=Qr(J.messages[0].data);{ie[3]=[];var me=[];i.forEach(function(fe,pe){me[1]=[{type:0,data:ln(pe)}],me[2]=[{type:0,data:ln(1)}],me[3]=[{type:2,data:nte(fe)}],ie[3].push({type:2,data:ha(me)})})}J.messages[0].data=ha(ie);var Ce=Th(Y),Oe=Eh(Ce);z.content=Oe,z.size=z.content.length})();var M=Qr(I[3][0].data);{var W=M[1][0];delete M[2];var B=Qr(W.data);{var G=Fa(B[2][0].data);(function(){for(var z=lr.find(d,o[G].location),Y=io(oo(z.content)),J,te=0;te<Y.length;++te){var ee=Y[te];ee.id==G&&(J=ee)}var ie=Qr(J.messages[0].data);{delete ie[6],delete M[7];var me=new Uint8Array(ie[5][0].data);ie[5]=[];for(var Ce=0,Oe=0;Oe<=n.e.r;++Oe){var fe=Qr(me);Ce+=xte(fe,a[Oe],i),fe[1][0].data=ln(Oe),ie[5].push({data:ha(fe),type:2})}ie[1]=[{type:0,data:ln(n.e.c+1)}],ie[2]=[{type:0,data:ln(n.e.r+1)}],ie[3]=[{type:0,data:ln(Ce)}],ie[4]=[{type:0,data:ln(n.e.r+1)}]}J.messages[0].data=ha(ie);var pe=Th(Y),He=Eh(pe);z.content=He,z.size=z.content.length})()}W.data=ha(B)}I[3][0].data=ha(M)}E[4][0].data=ha(I)}y.messages[0].data=ha(E);var H=Th(g),O=Eh(H);return p.content=O,p.size=p.content.length,d}function nP(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function LS(e){nP([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function BS(e){nP([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function vte(e){return Br.WS.indexOf(e)>-1?"sheet":e==Br.CS?"chart":e==Br.DS?"dialog":e==Br.MS?"macro":e&&e.length?e:"sheet"}function wte(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,vte(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function _te(e,t,r,n,s,a,i,o,c,d,f,p){try{a[n]=Lm(Bi(e,r,!0),t);var g=ks(e,t),y;switch(o){case"sheet":y=zZ(g,t,s,c,a[n],d,f,p);break;case"chart":if(y=HZ(g,t,s,c,a[n],d,f,p),!y||!y["!drawel"])break;var v=km(y["!drawel"].Target,t),w=hp(v),b=jX(Bi(e,v,!0),Lm(Bi(e,w,!0),v)),E=km(b,v),k=hp(E);y=xZ(Bi(e,E,!0),E,c,Lm(Bi(e,k,!0),E),d,y);break;case"macro":y=GZ(g,t,s,c,a[n],d,f,p);break;case"dialog":y=VZ(g,t,s,c,a[n],d,f,p);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=y;var _=[];a&&a[n]&&ss(a[n]).forEach(function(N){var A="";if(a[n][N].Type==Br.CMNT){A=km(a[n][N].Target,t);var P=YZ(ks(e,A,!0),A,c);if(!P||!P.length)return;i3(y,P,!1)}a[n][N].Type==Br.TCMNT&&(A=km(a[n][N].Target,t),_=_.concat(PX(ks(e,A,!0),c)))}),_&&_.length&&i3(y,_,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function so(e){return e.charAt(0)=="/"?e.slice(1):e}function bte(e,t){if(j0(),t=t||{},LS(t),co(e,"META-INF/manifest.xml")||co(e,"objectdata.xml"))return x3(e,t);if(co(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Yw<"u"){if(e.FileIndex)return Yw(e);var r=lr.utils.cfb_new();return EN(e).forEach(function(oe){jr(r,oe,RH(e,oe))}),Yw(r)}throw new Error("Unsupported NUMBERS file")}if(!co(e,"[Content_Types].xml"))throw co(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):co(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=EN(e),s=TG(Bi(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",ks(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!ks(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},d={};if(!t.bookSheets&&!t.bookProps){if(Bm=[],s.sst)try{Bm=XZ(ks(e,so(s.sst)),s.sst,t)}catch(oe){if(t.WTF)throw oe}t.cellStyles&&s.themes.length&&(c=qZ(Bi(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(d=KZ(ks(e,so(s.style)),s.style,c,t))}s.links.map(function(oe){try{var q=Lm(Bi(e,hp(so(oe))),oe);return JZ(ks(e,so(oe)),q,oe,t)}catch{}});var f=WZ(ks(e,so(s.workbooks[0])),s.workbooks[0],t),p={},g="";s.coreprops.length&&(g=ks(e,so(s.coreprops[0]),!0),g&&(p=G8(g)),s.extprops.length!==0&&(g=ks(e,so(s.extprops[0]),!0),g&&RG(g,p,t)));var y={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(g=Bi(e,so(s.custprops[0]),!0),g&&(y=IG(g,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(q){return q.name}):p.Worksheets&&p.SheetNames.length>0&&(i=p.SheetNames),t.bookProps&&(v.Props=p,v.Custprops=y),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var w={};t.bookDeps&&s.calcchain&&(w=QZ(ks(e,so(s.calcchain)),s.calcchain));var b=0,E={},k,_;{var N=f.Sheets;p.Worksheets=N.length,p.SheetNames=[];for(var A=0;A!=N.length;++A)p.SheetNames[A]=N[A].name}var P=a?"bin":"xml",R=s.workbooks[0].lastIndexOf("/"),T=(s.workbooks[0].slice(0,R+1)+"_rels/"+s.workbooks[0].slice(R+1)+".rels").replace(/^\//,"");co(e,T)||(T="xl/_rels/workbook."+P+".rels");var D=Lm(Bi(e,T,!0),T.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=ZZ(ks(e,so(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=DX(ks(e,so(s.people[0])),t)),D&&(D=wte(D,f.Sheets));var I=ks(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(b=0;b!=p.Worksheets;++b){var K="sheet";if(D&&D[b]?(k="xl/"+D[b][1].replace(/[\/]?xl\//,""),co(e,k)||(k=D[b][1]),co(e,k)||(k=T.replace(/_rels\/.*$/,"")+D[b][1]),K=D[b][2]):(k="xl/worksheets/sheet"+(b+1-I)+"."+P,k=k.replace(/sheet0\./,"sheet.")),_=k.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(b!=t.sheets)continue e;break;case"string":if(p.SheetNames[b].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var X=!1,Z=0;Z!=t.sheets.length;++Z)typeof t.sheets[Z]=="number"&&t.sheets[Z]==b&&(X=1),typeof t.sheets[Z]=="string"&&t.sheets[Z].toLowerCase()==p.SheetNames[b].toLowerCase()&&(X=1);if(!X)continue e}}_te(e,k,_,p.SheetNames[b],b,E,i,K,t,f,c,d)}return v={Directory:s,Workbook:f,Props:p,Custprops:y,Deps:w,Sheets:i,SheetNames:p.SheetNames,Strings:Bm,Styles:d,Themes:c,SSF:In(mr)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(oe,q){oe=oe.replace(/^Root Entry[\/]/,""),v.keys.push(oe),v.files[oe]=e.FileIndex[q]}))),t&&t.bookVBA&&(s.vba.length>0?v.vbaraw=ks(e,so(s.vba[0]),!0):s.defaults&&s.defaults.bin===WX&&(v.vbaraw=ks(e,"xl/vbaProject.bin",!0))),v}function Ste(e,t){var r=t||{},n="Workbook",s=lr.find(e,n);try{if(n="/!DataSpaces/Version",s=lr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(ZK(s.content),n="/!DataSpaces/DataSpaceMap",s=lr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=tq(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=lr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=rq(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=lr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);sq(s.content)}catch{}if(n="/EncryptionInfo",s=lr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=aq(s.content);if(n="/EncryptedPackage",s=lr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function kte(e,t){return t.bookType=="ods"?rP(e,t):t.bookType=="numbers"?yte(e,t):t.bookType=="xlsb"?Cte(e,t):Tte(e,t)}function Cte(e,t){zh=1024,e&&!e.SSF&&(e.SSF=In(mr)),e&&e.SSF&&(j0(),Zy(e.SSF),t.revssf=tv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Um?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=jF.indexOf(t.bookType)>-1,s=kS();BS(t=t||{});var a=uS(),i="",o=0;if(t.cellXfs=[],Ju(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",jr(a,i,V8(e.Props,t)),s.coreprops.push(i),un(t.rels,2,i,Br.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,jr(a,i,X8(e.Props)),s.extprops.push(i),un(t.rels,3,i,Br.EXT_PROPS),e.Custprops!==e.Props&&ss(e.Custprops||{}).length>0&&(i="docProps/custom.xml",jr(a,i,Y8(e.Custprops)),s.custprops.push(i),un(t.rels,4,i,Br.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],g=(p||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,jr(a,i,tee(o-1,i,t,e,f)),s.sheets.push(i),un(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Br.WS[0])}if(p){var y=p["!comments"],v=!1,w="";y&&y.length>0&&(w="xl/comments"+o+"."+r,jr(a,w,see(y,w)),s.comments.push(w),un(f,-1,"../comments"+o+"."+r,Br.CMNT),v=!0),p["!legacy"]&&v&&jr(a,"xl/drawings/vmlDrawing"+o+".vml",NF(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}f["!id"].rId1&&jr(a,hp(i),Jh(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,jr(a,i,nee(t.Strings,i,t)),s.strs.push(i),un(t.wbrels,-1,"sharedStrings."+r,Br.SST)),i="xl/workbook."+r,jr(a,i,eee(e,i)),s.workbooks.push(i),un(t.rels,1,i,Br.WB),i="xl/theme/theme1.xml",jr(a,i,jS(e.Themes,t)),s.themes.push(i),un(t.wbrels,-1,"theme/theme1.xml",Br.THEME),i="xl/styles."+r,jr(a,i,ree(e,i,t)),s.styles.push(i),un(t.wbrels,-1,"styles."+r,Br.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",jr(a,i,e.vbaraw),s.vba.push(i),un(t.wbrels,-1,"vbaProject.bin",Br.VBA)),i="xl/metadata."+r,jr(a,i,aee(i)),s.metadata.push(i),un(t.wbrels,-1,"metadata."+r,Br.XLMETA),jr(a,"[Content_Types].xml",z8(s,t)),jr(a,"_rels/.rels",Jh(t.rels)),jr(a,"xl/_rels/workbook."+r+".rels",Jh(t.wbrels)),delete t.revssf,delete t.ssf,a}function Tte(e,t){zh=1024,e&&!e.SSF&&(e.SSF=In(mr)),e&&e.SSF&&(j0(),Zy(e.SSF),t.revssf=tv(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Um?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=jF.indexOf(t.bookType)>-1,s=kS();BS(t=t||{});var a=uS(),i="",o=0;if(t.cellXfs=[],Ju(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",jr(a,i,V8(e.Props,t)),s.coreprops.push(i),un(t.rels,2,i,Br.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(e.SheetNames[d]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,jr(a,i,X8(e.Props)),s.extprops.push(i),un(t.rels,3,i,Br.EXT_PROPS),e.Custprops!==e.Props&&ss(e.Custprops||{}).length>0&&(i="docProps/custom.xml",jr(a,i,Y8(e.Custprops)),s.custprops.push(i),un(t.rels,4,i,Br.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var p={"!id":{}},g=e.Sheets[e.SheetNames[o-1]],y=(g||{})["!type"]||"sheet";switch(y){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,jr(a,i,$F(o-1,t,e,p)),s.sheets.push(i),un(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Br.WS[0])}if(g){var v=g["!comments"],w=!1,b="";if(v&&v.length>0){var E=!1;v.forEach(function(k){k[1].forEach(function(_){_.T==!0&&(E=!0)})}),E&&(b="xl/threadedComments/threadedComment"+o+"."+r,jr(a,b,RX(v,f,t)),s.threadedcomments.push(b),un(p,-1,"../threadedComments/threadedComment"+o+"."+r,Br.TCMNT)),b="xl/comments"+o+"."+r,jr(a,b,AF(v)),s.comments.push(b),un(p,-1,"../comments"+o+"."+r,Br.CMNT),w=!0}g["!legacy"]&&w&&jr(a,"xl/drawings/vmlDrawing"+o+".vml",NF(o,g["!comments"])),delete g["!comments"],delete g["!legacy"]}p["!id"].rId1&&jr(a,hp(i),Jh(p))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,jr(a,i,pF(t.Strings,t)),s.strs.push(i),un(t.wbrels,-1,"sharedStrings."+r,Br.SST)),i="xl/workbook."+r,jr(a,i,VF(e)),s.workbooks.push(i),un(t.rels,1,i,Br.WB),i="xl/theme/theme1.xml",jr(a,i,jS(e.Themes,t)),s.themes.push(i),un(t.wbrels,-1,"theme/theme1.xml",Br.THEME),i="xl/styles."+r,jr(a,i,kF(e,t)),s.styles.push(i),un(t.wbrels,-1,"styles."+r,Br.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",jr(a,i,e.vbaraw),s.vba.push(i),un(t.wbrels,-1,"vbaProject.bin",Br.VBA)),i="xl/metadata."+r,jr(a,i,EF()),s.metadata.push(i),un(t.wbrels,-1,"metadata."+r,Br.XLMETA),f.length>1&&(i="xl/persons/person.xml",jr(a,i,IX(f)),s.people.push(i),un(t.wbrels,-1,"persons/person.xml",Br.PEOPLE)),jr(a,"[Content_Types].xml",z8(s,t)),jr(a,"_rels/.rels",Jh(t.rels)),jr(a,"xl/_rels/workbook."+r+".rels",Jh(t.wbrels)),delete t.revssf,delete t.ssf,a}function US(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$i(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Ete(e,t){return lr.find(e,"EncryptedPackage")?Ste(e,t):YF(e,t)}function Nte(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ir&&Buffer.isBuffer(e)?"buffer":"base64"),r=y8(n,s),bte(r,s)}function sP(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return h2(e.slice(r),t);default:break e}return d0.to_workbook(e,t)}function Ate(e,t){var r="",n=US(e,t);switch(t.type){case"base64":r=$i(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=ff(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=yn(r)),t.type="binary",sP(r,t)}function jte(e,t){var r=e;return t.type=="base64"&&(r=$i(r)),r=op.utils.decode(1200,r.slice(2),"str"),t.type="binary",sP(r,t)}function Fte(e){return e.match(/[^\x00-\x7F]/)?Cl(e):e}function Qw(e,t,r,n){return n?(r.type="string",d0.to_workbook(e,r)):d0.to_workbook(t,r)}function p2(e,t){aS();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return p2(new Uint8Array(e),(r=In(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),e0={},r.dateNF&&(e0.dateNF=r.dateNF),r.type||(r.type=Ir&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ir?"buffer":"binary",n=CH(e),typeof Uint8Array<"u"&&!Ir&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=Fte(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=In(r),r.type="array",p2(iS(n),r)}switch((s=US(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return Ete(lr.read(n,r),r);break;case 9:if(s[1]<=8)return YF(n,r);break;case 60:return h2(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return MK(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return gF.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?Nte(n,r):Qw(e,n,r,a);case 239:return s[3]===60?h2(n,r):Qw(e,n,r,a);case 255:if(s[1]===254)return jte(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return qd.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return qd.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return f2.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return _F.to_workbook(n,r);break;case 10:case 13:case 32:return Ate(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return IK.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?f2.to_workbook(n,r):Qw(e,n,r,a)}function aP(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Hp(t.file,lr.write(e,{type:Ir?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return lr.write(e,t)}function Pte(e,t){var r=In(t||{}),n=kte(e,r);return Rte(n,r)}function Rte(e,t){var r={},n=Ir?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?lr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(Jy(s))}return t.password&&typeof encrypt_agile<"u"?aP(encrypt_agile(s,t.password),t):t.type==="file"?Hp(t.file,s):t.type=="string"?yn(s):s}function Dte(e,t){var r=t||{},n=Fee(e,r);return aP(n,r)}function vl(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return lp(Cl(n));case"binary":return Cl(n);case"string":return e;case"file":return Hp(t.file,n,"utf8");case"buffer":return Ir?Ac(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):vl(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Ite(e,t){switch(t.type){case"base64":return lp(e);case"binary":return e;case"string":return e;case"file":return Hp(t.file,e,"binary");case"buffer":return Ir?Ac(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function C1(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?lp(r):t.type=="string"?yn(r):r;case"file":return Hp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function iP(e,t){aS(),EZ(e);var r=In(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=iP(e,r);return r.type="array",Jy(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return vl(kee(e,r),r);case"slk":case"sylk":return vl(hF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return vl(JF(e.Sheets[e.SheetNames[s]],r),r);case"txt":return Ite(oP(e.Sheets[e.SheetNames[s]],r),r);case"csv":return vl($S(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return vl(gF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return C1(f2.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return vl(d0.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return vl(_F.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return vl(mF.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return vl(rP(e,r),r);case"wk1":return C1(qd.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return C1(qd.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),C1(QF(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Dte(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Pte(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Mte(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function Ote(e,t,r){var n={};return n.type="file",n.file=t,Mte(n),iP(e,n)}function Lte(e,t,r,n,s,a,i,o){var c=ms(r),d=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),p=!0,g=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:r,enumerable:!1})}catch{g.__rowNum__=r}else g.__rowNum__=r;if(!i||e[r])for(var y=t.s.c;y<=t.e.c;++y){var v=i?e[r][y]:e[n[y]+c];if(v===void 0||v.t===void 0){if(d===void 0)continue;a[y]!=null&&(g[a[y]]=d);continue}var w=v.v;switch(v.t){case"z":if(w==null)break;continue;case"e":w=w==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[y]!=null){if(w==null)if(v.t=="e"&&w===null)g[a[y]]=null;else if(d!==void 0)g[a[y]]=d;else if(f&&w===null)g[a[y]]=null;else continue;else g[a[y]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?w:Tc(v,w,o);w!=null&&(p=!1)}}return{row:g,isempty:p}}function Sy(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},f=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof f){case"string":c=qr(f);break;case"number":c=qr(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var p=ms(c.s.r),g=[],y=[],v=0,w=0,b=Array.isArray(e),E=c.s.r,k=0,_={};b&&!e[E]&&(e[E]=[]);var N=d.skipHidden&&e["!cols"]||[],A=d.skipHidden&&e["!rows"]||[];for(k=c.s.c;k<=c.e.c;++k)if(!(N[k]||{}).hidden)switch(g[k]=Hn(k),r=b?e[E][k]:e[g[k]+p],n){case 1:a[k]=k-c.s.c;break;case 2:a[k]=g[k];break;case 3:a[k]=d.header[k-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Tc(r,null,d),w=_[i]||0,!w)_[i]=1;else{do o=i+"_"+w++;while(_[o]);_[i]=w,_[o]=1}a[k]=o}for(E=c.s.r+s;E<=c.e.r;++E)if(!(A[E]||{}).hidden){var P=Lte(e,c,E,g,n,a,b,d);(P.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[v++]=P.row)}return y.length=v,y}var b3=/"/g;function Bte(e,t,r,n,s,a,i,o){for(var c=!0,d=[],f="",p=ms(r),g=t.s.c;g<=t.e.c;++g)if(n[g]){var y=o.dense?(e[r]||[])[g]:e[n[g]+p];if(y==null)f="";else if(y.v!=null){c=!1,f=""+(o.rawNumbers&&y.t=="n"?y.v:Tc(y,null,o));for(var v=0,w=0;v!==f.length;++v)if((w=f.charCodeAt(v))===s||w===a||w===34||o.forceQuotes){f='"'+f.replace(b3,'""')+'"';break}f=="ID"&&(f='"ID"')}else y.f!=null&&!y.F?(c=!1,f="="+y.f,f.indexOf(",")>=0&&(f='"'+f.replace(b3,'""')+'"')):f="";d.push(f)}return o.blankrows===!1&&c?null:d.join(i)}function $S(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=qr(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),d=new RegExp((a=="|"?"\\|":a)+"+$"),f="",p=[];n.dense=Array.isArray(e);for(var g=n.skipHidden&&e["!cols"]||[],y=n.skipHidden&&e["!rows"]||[],v=s.s.c;v<=s.e.c;++v)(g[v]||{}).hidden||(p[v]=Hn(v));for(var w=0,b=s.s.r;b<=s.e.r;++b)(y[b]||{}).hidden||(f=Bte(e,s,b,p,i,c,a,n),f!=null&&(n.strip&&(f=f.replace(d,"")),(f||n.blankrows!==!1)&&r.push((w++?o:"")+f)));return delete n.dense,r.join("")}function oP(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=$S(e,t);return r}function Ute(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=qr(e["!ref"]),a="",i=[],o,c=[],d=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=Hn(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=ms(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=d?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function lP(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?Gn(n.origin):n.origin;i=c.r,o=c.c}var d,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var p=qr(a["!ref"]);f.e.c=Math.max(f.e.c,p.e.c),f.e.r=Math.max(f.e.r,p.e.r),i==-1&&(i=p.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var g=n.header||[],y=0;t.forEach(function(w,b){ss(w).forEach(function(E){(y=g.indexOf(E))==-1&&(g[y=g.length]=E);var k=w[E],_="z",N="",A=xr({c:o+y,r:i+b+s});d=wp(a,A),k&&typeof k=="object"&&!(k instanceof Date)?a[A]=k:(typeof k=="number"?_="n":typeof k=="boolean"?_="b":typeof k=="string"?_="s":k instanceof Date?(_="d",n.cellDates||(_="n",k=Bs(k)),N=n.dateNF||mr[14]):k===null&&n.nullError&&(_="e",k=0),d?(d.t=_,d.v=k,delete d.w,delete d.R,N&&(d.z=N)):a[A]=d={t:_,v:k},N&&(d.z=N))})}),f.e.c=Math.max(f.e.c,o+g.length-1);var v=ms(i);if(s)for(y=0;y<g.length;++y)a[Hn(y+o)+v]={t:"s",v:g[y]};return a["!ref"]=Nr(f),a}function $te(e,t){return lP(null,e,t)}function wp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Gn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?wp(e,xr(t)):wp(e,xr({r:t,c:r||0}))}function Wte(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function WS(){return{SheetNames:[],Sheets:{}}}function zS(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(GF(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function zte(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Wte(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Hte(e,t){return e.z=t,e}function cP(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Gte(e,t,r){return cP(e,"#"+t,r)}function Vte(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Kte(e,t,r,n){for(var s=typeof t!="string"?t:qr(t),a=typeof t=="string"?t:Nr(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=wp(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var I1={encode_col:Hn,encode_row:ms,encode_cell:xr,encode_range:Nr,decode_col:yS,decode_row:xS,split_cell:nG,decode_cell:Gn,decode_range:Ci,format_cell:Tc,sheet_add_aoa:M8,sheet_add_json:lP,sheet_add_dom:ZF,aoa_to_sheet:F0,json_to_sheet:$te,table_to_sheet:eP,table_to_book:Zee,sheet_to_csv:$S,sheet_to_txt:oP,sheet_to_json:Sy,sheet_to_html:JF,sheet_to_formulae:Ute,sheet_to_row_object_array:Sy,sheet_get_cell:wp,book_new:WS,book_append_sheet:zS,book_set_sheet_visibility:zte,cell_set_number_format:Hte,cell_set_hyperlink:cP,cell_set_internal_link:Gte,cell_add_comment:Vte,sheet_set_array_formula:Kte,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const uP=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n})=>{Ti(),Ty();const{user:s,isAuthenticated:a}=Mn(),{showNotification:i}=ba(),o=C.useCallback(se=>{let ce=null;if(typeof se?.percentage=="number"&&!Number.isNaN(se.percentage))return ce=Math.round(se.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:se.percentage,rounded:ce,result:se}),ce;const we=se?.retest_best_score??se?.score,Te=se?.retest_best_max_score??se?.max_score,Be=Number(we??0),be=Number(Te??0);return be>0&&(ce=Math.round(Be/be*100)),console.debug("[TeacherResults] Computed percentage",{score:se?.score,max_score:se?.max_score,retest_best_score:se?.retest_best_score,retest_best_max_score:se?.retest_best_max_score,derived:ce,result:se}),ce},[]);C.useCallback(se=>{const ce=o(se);return ce===null?"bg-gray-100 text-gray-800":ce<50?"bg-red-100 text-red-700":ce<70?"bg-yellow-100 text-yellow-700":"bg-green-100 text-green-700"},[o]),C.useCallback(se=>{const ce=o(se);return ce!==null&&ce<50},[o]);const[c,d]=C.useState(null),[f,p]=C.useState(!0),[g,y]=C.useState(""),[v,w]=C.useState([]),[b,E]=C.useState(null),[k,_]=C.useState(!1),[N,A]=C.useState([]),[P,R]=C.useState([]),[T,D]=C.useState([1,2]),[I,K]=C.useState(null),[X,Z]=C.useState(null),[oe,q]=C.useState(null),[re,M]=C.useState("main"),[W,B]=C.useState(null),[G,H]=C.useState(null),O=W||t,z=G||r,[Y,J]=C.useState(null),[te,ee]=C.useState({}),[ie,me]=C.useState(!1),[Ce,Oe]=C.useState(new Set),[fe,pe]=C.useState(!1),[He,Ye]=C.useState(!1),ot=C.useRef(null),[Ve,Rt]=C.useState(null),[tt,Le]=C.useState(!1),[De,Je]=C.useState(null),[_t,ht]=C.useState(!1),[It,Mt]=C.useState(null),[rt,qe]=C.useState(""),[pt,lt]=C.useState(""),[wt,Lt]=C.useState(!1),[Ht,Ie]=C.useState(!1),[at,gt]=C.useState(new Set),[At,Ot]=C.useState({}),[Jt,Ae]=C.useState(!1),ye=C.useRef(new Set),he=C.useRef({}),_e=C.useRef(null);C.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(at)),ye.current=at},[at]),C.useEffect(()=>{console.log(" columnScores state changed:",At),he.current=At},[At]);const $e=C.useCallback(se=>{console.log(" Toggling test collapse for:",se),Oe(ce=>{const we=new Set(ce);return we.has(se)?(we.delete(se),console.log(" Expanding test:",se)):(we.add(se),console.log(" Collapsing test:",se)),console.log(" New collapsed tests:",Array.from(we)),we})},[]),St=C.useCallback(()=>{if(ot.current){const{scrollLeft:se,scrollWidth:ce,clientWidth:we}=ot.current;pe(se>0),Ye(se<ce-we-1)}},[]);C.useEffect(()=>{qt()},[]),C.useEffect(()=>{if(I&&ot.current){const se=setTimeout(St,100);return()=>clearTimeout(se)}},[I,St]),C.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(Ce))},[Ce]);const ct=C.useCallback(async(se,ce,we)=>{console.log(" Loading class results for:",se,ce,we),me(!0);try{const Te=`${se}/${ce}`;console.log(" Formatted class name:",Te);let Be=c;Be||(console.log(" Teacher data not loaded, loading now..."),Be=await xn.getTeacherData(),d(Be));const be=s?.teacher_id;let nt=null,vt=X;if(vt||(console.log(" Academic year data not loaded, loading now..."),vt=await Fr()),vt&&Array.isArray(vt)&&vt.length>0){const mt=parseInt(we);console.log(" Looking for semester",mt,"in current academic year");const Xt=new Date,Rr=vt.find(ae=>{const Ne=new Date(ae.start_date),dt=new Date(ae.end_date);return Xt>=Ne&&Xt<=dt}),Ar=Rr?Rr.academic_year:vt[0].academic_year;console.log(" Current academic year:",Ar);const hr=vt.filter(ae=>ae.academic_year===Ar);console.log(" Current year periods:",hr);const er=hr.filter(ae=>parseInt(ae.semester)===1),Kt=hr.filter(ae=>parseInt(ae.semester)===2);if(console.log(" Semester 1 periods:",er),console.log(" Semester 2 periods:",Kt),mt===1?(nt=er[0]?.id,console.log(" Using semester 1 period:",er[0])):mt===2&&(nt=Kt[0]?.id,console.log(" Using semester 2 period:",Kt[0])),!nt)throw new Error(`No ${mt===1?"Semester 1":"Semester 2"} data available for academic year ${Ar}`)}if(!be||!nt)throw console.error(" Missing data:",{teacherId:be,academicPeriodId:nt,academicYear:X}),new Error("Missing teacher ID or academic period ID");const Fe=await YW.getTeacherStudentResults(be,se,Te,we,nt);if(console.log(" Class results response:",Fe),Fe.success){console.log(" API Response details:",{results:Fe.results,students:Fe.students,count:Fe.count,student_count:Fe.student_count});const mt=[],Xt=new Set,Rr=new Set;Fe.results&&Fe.results.length>0&&Fe.results.forEach(er=>{er.test_name&&!Xt.has(er.test_name)&&(Xt.add(er.test_name),mt.push({test_name:er.test_name,test_type:er.test_type,subject:er.subject})),er.subject&&Rr.add(er.subject)}),console.log(" RAW RESULTS DATA:",Fe.results),console.log(" RAW STUDENTS DATA:",Fe.students);const Ar=(Fe.students||[]).map(er=>{const Kt={};return(Fe.results||[]).filter(Ne=>(console.log(` Checking result ${Ne.id} for student ${er.student_id}:`,{result_student_id:Ne.student_id,student_id:er.student_id,match:Ne.student_id===er.student_id,test_type:Ne.test_type}),Ne.student_id===er.student_id)).forEach(Ne=>{console.log(` Mapping result ${Ne.id} (${Ne.test_type}) to student ${er.student_id}:`,{test_name:Ne.test_name,test_type:Ne.test_type,score:Ne.score,answers:Ne.answers}),Ne.test_name&&(Kt[Ne.test_name]={id:Ne.id,test_type:Ne.test_type,test_id:Ne.test_id,subject_id:Ne.subject_id,score:Ne.score,max_score:Ne.max_score,retest_offered:Ne.retest_offered,caught_cheating:Ne.caught_cheating,visibility_change_times:Ne.visibility_change_times,answers:Ne.answers,name:Ne.name,surname:Ne.surname,test_name:Ne.test_name},console.log(` MAPPED: ${Ne.test_name} -> student ${er.student_id}:`,Kt[Ne.test_name]))}),{...er,...Kt}}),hr={results:Fe.results||[],students:Ar,class:Ar,unique_tests:mt,subjects:Array.from(Rr),count:Fe.count||0,student_count:Fe.student_count||0};console.log(" Processed results data:",{uniqueTests:mt.length,subjects:Array.from(Rr),resultsCount:Fe.results?.length||0,studentsWithScores:Ar.length,sampleStudent:Ar[0]}),K(hr),ee(hr),q(new Date),Fe.students&&Fe.students.length>0?(console.log(" Student list loaded:",Fe.students.length,"students"),console.log(" Sample student:",Fe.students[0])):console.log(" No students found for this class")}else console.log(" API call failed for this class"),K(null),ee(null)}catch(Te){console.error(" Error loading class results:",Te),i("Error loading class results","error"),K(null),ee(null)}finally{me(!1)}},[c,s,X,i]),zt=C.useCallback(async(se,ce)=>{console.log(" Determining current semester for:",se,ce);try{if(X&&X.length>0){const we=new Date;let Te=1,Be=null;for(const be of X){const nt=new Date(be.start_date),vt=new Date(be.end_date);if(console.log(" Checking period:",{period:be,semester:be.semester,semesterType:typeof be.semester,startDate:nt,endDate:vt,currentDate:we,isInRange:we>=nt&&we<=vt}),we>=nt&&we<=vt){Be=be,Te=be.semester,console.log(" Found matching period:",{period:be,semester:be.semester,semesterType:typeof be.semester});break}}if(Be){console.log(" Current academic period found:",Be),console.log(" Current semester:",Te);const be=Te&&!isNaN(Te)?Te:1;console.log(" Using semester:",be),E(be),await ct(se,ce,be)}else console.log(" No current academic period found, using default semester 1"),E(1),await ct(se,ce,1)}else console.log(" No academic year data, using default semester 1"),E(1),await ct(se,ce,1)}catch(we){console.error(" Error determining current semester:",we),E(1),await ct(se,ce,1)}},[X,ct]);C.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),zt(t,r))},[t,r,zt]);const qt=C.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(p(!0),y(""),!a||!s){console.log(" User not authenticated"),y("User not authenticated");return}if(s.role!==ri.TEACHER){console.error(" Invalid user role for teacher results:",s.role),y("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await Vt(),console.log(" Loading academic year data..."),await gr(),console.log(" Teacher results initialization complete!")}catch(se){console.error(" Error initializing teacher results:",se),y("Failed to initialize teacher results")}finally{p(!1)}},[a,s]),Vt=C.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const se=`teacher_data_${s?.teacher_id||s?.id||""}`;let ce=En(se);ce?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),ce=await xn.getTeacherData(),console.log(" Teacher data loaded:",ce),Nn(se,ce,Fn.teacher_subjects)),d(ce);const we=[];ce&&ce.subjects&&ce.subjects.forEach(vt=>{vt.classes&&vt.classes.forEach(Fe=>{Fe.grade&&Fe.class&&we.push({grade:Fe.grade,class:Fe.class,subject:vt.name})})}),R(we),console.log(" Available classes from teacher data:",we);const Te=`teacher_tests_${s?.teacher_id||s?.id||""}`,Be=En(Te);Be&&Be.some(vt=>vt.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(Te));let be=En(Te);be?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),be=await Jr.getTeacherTests(),console.log(" Teacher tests loaded:",be),Nn(Te,be,Fn.teacher_tests));const nt=be.flatMap(vt=>vt.assignments||[]);w(nt),console.log(" Raw assignments data:",nt),console.log(" Teacher assignments loaded:",nt.length)}catch(se){console.error(" Error loading teacher assignments:",se),i("Failed to load teacher assignments","error")}},[i]),gr=C.useCallback(async()=>{console.log(" Loading academic year data...");try{const se="admin_academic_years_";let ce=En(se);ce?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),ce=await xn.getAcademicYear(),console.log(" Academic year response:",ce),Nn(se,ce,Fn.admin_academic_years)),console.log(" First academic year record:",ce?.[0]||ce?.academic_years?.[0]),ce&&Array.isArray(ce)?(Z(ce),console.log(" Academic year data loaded:",ce.length),console.log(" Sample record fields:",Object.keys(ce[0]||{}))):ce&&ce.academic_years?(Z(ce.academic_years),console.log(" Academic year data loaded:",ce.academic_years.length),console.log(" Sample record fields:",Object.keys(ce.academic_years[0]||{}))):console.warn(" Failed to load academic year data:",ce?.error||"No data received")}catch(se){console.error(" Error loading academic year data:",se)}},[]),Fr=C.useCallback(async()=>{console.log(" Loading academic year data (direct return)...");try{const se="admin_academic_years_";let ce=En(se);return ce?console.log(" Cache HIT! Using cached academic year data"):(console.log(" Cache MISS! Fetching academic year from API"),ce=await xn.getAcademicYear(),console.log(" Academic year response:",ce),Nn(se,ce,Fn.admin_academic_years)),ce&&Array.isArray(ce)?(console.log(" Returning academic year data:",ce.length),ce):ce&&ce.academic_years?(console.log(" Returning academic year data:",ce.academic_years.length),ce.academic_years):(console.warn(" Failed to load academic year data:",ce?.error||"No data received"),null)}catch(se){return console.error(" Error loading academic year data:",se),null}},[]),fr=C.useCallback(async(se,ce)=>{console.log(" Showing classes for grade:",se,"class:",ce),B(se),H(ce),E(null),K(null),se&&ce&&await zt(se,ce)},[zt]);C.useCallback((se,ce)=>{console.log(" Showing semesters for class:",se,ce),E(null),K(null),zt(se,ce)},[]),C.useCallback((se,ce)=>{console.log(" Class clicked:",se,ce),_(!0),zt(se,ce)},[]);const cr=C.useCallback(async se=>{!O||!z||(console.log(" Loading results for semester:",se),E(se),await ct(O,z,se))},[O,z,ct]);C.useCallback(()=>{let se=1;if(X&&X.length>0){const ce=new Date;for(const we of X){const Te=new Date(we.start_date),Be=new Date(we.end_date);if(ce>=Te&&ce<=Be){se=we.semester;break}}}return l.jsx("div",{className:"flex space-x-4 mb-6",children:[1,2].map(ce=>l.jsxs(Xe.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${b===ce?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>cr(ce),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",ce,ce===se&&l.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},ce))})},[b,cr,X]),C.useCallback(se=>se.reduce((ce,we)=>(ce[we.student_id]||(ce[we.student_id]=[]),ce[we.student_id].push(we),ce),{}),[]),C.useCallback(se=>{if(se.length===0)return 0;const ce=se.reduce((we,Te)=>we+(Te.percentage||0),0);return Math.round(ce/se.length)},[]),C.useCallback(se=>{se.score<se.passing_score&&window.confirm("Give another try?")&&Pr(se.student_id,se.test_id)},[]);const Pr=C.useCallback(async(se,ce)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:se,testId:ce})})).ok&&(z&&cr(b),i("Test made accessible to student","success"))}catch(we){console.error("Error resetting test attempt:",we),i("Failed to reset test attempt","error")}},[z,b,cr,i]),Xr=C.useCallback((se,ce)=>{if(se===null||ce===null)return"";const we=Math.round(se/ce*100);return we>=80?"text-green-600 bg-green-50":we>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),ue=C.useCallback(se=>{Rt(se),Le(!0)},[]),ke=C.useCallback((se,ce="overview",we)=>{const Te={...se,__initialTab:ce};we&&(Te.__audioUrl=we),Je(Te),ht(!0)},[]);C.useCallback((se,ce,we)=>{Mt({resultId:se,score:ce,maxScore:we}),qe(ce?.toString()||""),lt(we?.toString()||""),Ie(!0)},[]),C.useCallback(se=>{qe(se)},[]),C.useCallback(se=>{lt(se)},[]),C.useCallback(async()=>{if(It){Lt(!0);try{const se={resultId:It.resultId,score:parseInt(rt)||0,maxScore:parseInt(pt)||1};(await fetch(tN.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(se)})).ok?(i("Score updated successfully","success"),z&&cr(b),Mt(null),qe(""),lt(""),Ie(!1)):i("Failed to update score","error")}catch(se){console.error("Error updating score:",se),i("Failed to update score","error")}finally{Lt(!1)}}},[It,rt,pt,z,b,cr,i]),C.useCallback(()=>{Mt(null),qe(""),lt(""),Ie(!1)},[]);const ge=(se,ce)=>{if(console.log(" Starting column editing for drawing test:",se),console.log(" Current editingColumns before update:",Array.from(at)),console.log(" Results data passed to function:",ce),gt(we=>{const Te=new Set(we).add(se);return console.log(" Updated editingColumns:",Array.from(Te)),Te}),console.log(" Initializing column scores for test:",se),console.log(" Results data:",ce),console.log(" Results.class:",ce?ce.class:"null"),ce&&ce.class){const we={};console.log(" Processing",ce.class.length,"students"),ce.class.forEach((Te,Be)=>{console.log(` Student ${Be}:`,Te.student_id,"Keys:",Object.keys(Te));const be=Te[se];console.log(` Student ${Te.student_id} test result for ${se}:`,be),console.log(" Test result keys:",be?Object.keys(be):"null"),console.log(" Test result id:",be?be.id:"null"),be&&(be.test_type==="drawing"||be.test_type==="speaking")&&(console.log(" SPEAKING TEST RESULT:",be),console.log(" SPEAKING TEST TYPE:",be.test_type),console.log(" SPEAKING TEST ANSWERS:",be.answers),we[Te.student_id]={score:(be.score||0).toString(),maxScore:(be.max_score||100).toString(),resultId:be.id})}),console.log(" Initial scores for column:",we),Ot(Te=>({...Te,[se]:we}))}else console.log(" No results or class data available")},ve=C.useCallback(se=>{gt(ce=>{const we=new Set(ce);return we.delete(se),we}),Ot(ce=>{const we={...ce};return delete we[se],we})},[]),Se=C.useCallback((se,ce,we,Te)=>{const Be=Te.toString();he.current[se]||(he.current[se]={}),he.current[se][ce]||(he.current[se][ce]={}),he.current[se][ce][we]=Be;const be=parseInt(Te)||0;Ot(nt=>({...nt,[se]:{...nt[se],[ce]:{...nt[se]?.[ce],[we]:be}}}))},[]),Ee=C.useCallback(async se=>{if(he.current[se]){Ae(!0);try{const ce=Object.entries(he.current[se]).map(([be,nt])=>({resultId:nt.resultId,score:parseInt(nt.score)||0,maxScore:parseInt(nt.maxScore)||100}));console.log(" Saving column scores for",se,":",ce);const we=ce.map(be=>(console.log(" Sending update:",be),fetch(tN.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(be)})));(await Promise.all(we)).every(be=>be.ok)?(i(`Scores updated successfully for ${se}`,"success"),z&&cr(b),ve(se)):i("Failed to update some scores","error")}catch(ce){console.error("Error updating column scores:",ce),i("Failed to update scores","error")}finally{Ae(!1)}}},[At,z,b,cr,i,ve]),We=C.useCallback((se,ce,we)=>!ce||ce.length===0?l.jsx(Xe.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsxs(Xe.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[fe&&l.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),He&&l.jsx("div",{className:"absolute right-0 top-1/2 transform -translate-y-1/2 z-10 bg-blue-500 text-white rounded-full p-2 shadow-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),l.jsxs(Xe.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[l.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Te=>{ot.current&&(ot.current.scrollLeft=Te.target.scrollLeft)},children:l.jsx("div",{className:"min-w-full h-1",children:l.jsx("div",{className:"h-1",style:{width:`${(we.length+5)*120}px`}})})}),l.jsx("div",{ref:ot,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:Te=>{St(Te);const Be=Te.target.previousElementSibling;Be&&(Be.scrollLeft=Te.target.scrollLeft)},children:l.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[l.jsx("thead",{children:l.jsxs(Xe.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Name"}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[120px]",children:"Surname"}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),we.map((Te,Be)=>{const be=Ce.has(Te.test_name),nt=Te.test_type==="drawing",vt=ye.current.has(Te.test_name);return console.log(` Rendering test ${Te.test_name}:`,{isDrawingTest:nt,isEditingColumn:vt,editingColumns:Array.from(ye.current),test_type:Te.test_type}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${be?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:Fe=>{Fe.preventDefault(),Fe.stopPropagation(),console.log(" Clicked on test header:",Te.test_name),$e(Te.test_name)},children:be?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex flex-col space-y-2",children:[nt&&l.jsx("div",{className:"flex justify-center",children:vt?l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Fe=>{Fe.preventDefault(),Fe.stopPropagation(),Ee(Te.test_name)},disabled:Jt,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-1",children:Jt?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-3 h-3 border border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save"}),l.jsx("button",{onClick:Fe=>{Fe.preventDefault(),Fe.stopPropagation(),ve(Te.test_name)},disabled:Jt,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):l.jsx("button",{onClick:Fe=>{Fe.preventDefault(),Fe.stopPropagation(),console.log(" Edit Column button clicked for drawing test:",Te.test_name),console.log(" Results state at button click:",I),console.log(" Current results ref:",_e.current),ge(Te.test_name,_e.current)},className:"px-2 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit Column"})}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:Te.test_name,children:Te.test_name.length>8?Te.test_name.substring(0,8)+"...":Te.test_name}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})]})},Be)})]})}),l.jsx("tbody",{children:l.jsx(wi,{children:ce.map((Te,Be)=>l.jsxs(Xe.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Be%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Be*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[l.jsx(Xe.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:Te.student_id}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Te.name}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Te.surname}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:Te.number??Be+1}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:Te.nickname||"-"}),we.map((be,nt)=>{const vt=Ce.has(be.test_name),Fe=Te[be.test_name];return vt?(console.log(" Rendering collapsed column for test:",be.test_name),l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:mt=>{mt.preventDefault(),mt.stopPropagation(),console.log(" Clicked on collapsed arrow for:",be.test_name),$e(be.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},nt)):l.jsx(Xe.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:mt=>{if(console.debug("[TeacherResults] Main table TD clicked",{testResult:Fe,student:Te.student_id}),Fe?.retest_offered){i("Retest is already offered","info");return}const Xt=o(Fe);Xt!==null&&Xt<50&&(console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:Te.student_id,test:be}),n({failedStudentIds:[Te.student_id],test_type:be.test_type,original_test_id:Fe?.test_id||be.test_id,subject_id:Fe?.subject_id||be.subject_id,grade:t,class:r}))},children:Fe&&Fe.test_type==="drawing"?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("button",{onClick:()=>ue(Fe),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const mt=ye.current.has(be.test_name);return console.log(` Score cell for ${be.test_name}:`,{isEditing:mt,editingColumns:Array.from(ye.current),test_name:be.test_name}),mt})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Fe.max_score||100,value:he.current[be.test_name]?.[Te.student_id]?.score||Fe.score||"",onChange:mt=>Se(be.test_name,Te.student_id,"score",mt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:he.current[be.test_name]?.[Te.student_id]?.maxScore||Fe.max_score||100,onChange:mt=>Se(be.test_name,Te.student_id,"maxScore",mt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log(" Double-clicked on drawing test score:",be.test_name),console.log(" Results state at double-click:",I),console.log(" Current results ref:",_e.current),ge(be.test_name,_e.current)},title:"Double-click to edit column",children:[Fe.score||0,"/",Fe.max_score||100]}),Fe.caught_cheating&&Fe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Fe.visibility_change_times,")"]})]}):Fe&&(Fe.test_type==="speaking"||be.test_type==="speaking")?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const mt=Fe?.answers;let Xt;if(typeof mt=="string")if(/^https?:\/\//i.test(mt))Xt=mt;else try{Xt=JSON.parse(mt)?.audio_url}catch{}else mt&&typeof mt=="object"&&(Xt=mt.audio_url);return!Xt&&Fe?.audio_url&&(Xt=Fe.audio_url),console.log(" Final computed audioUrl (main table):",{studentId:Te.student_id,testName:be.test_name,audioUrl:Xt}),l.jsx(l.Fragment,{children:l.jsx("button",{onClick:()=>ke({...Fe,__studentId:Te.student_id},"audio",Xt),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Audio"})})})(),(()=>{const mt=ye.current.has(be.test_name);return console.log(` Score cell for ${be.test_name}:`,{isEditing:mt,editingColumns:Array.from(ye.current),test_name:be.test_name}),mt})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Fe.max_score||100,value:he.current[be.test_name]?.[Te.student_id]?.score||Fe.score||"",onChange:mt=>Se(be.test_name,Te.student_id,"score",mt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:he.current[be.test_name]?.[Te.student_id]?.maxScore||Fe.max_score||100,onChange:mt=>Se(be.test_name,Te.student_id,"maxScore",mt.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",be.test_name),console.log(" Results state at double-click:",I),console.log(" Test result:",Fe),console.log(" Student:",Te),console.log(" Test:",be),Fe&&Fe.id?(console.log(" Starting column editing for speaking test:",be.test_name),ge(be.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const mt=o(Fe),Xt=mt!==null&&mt<50,Rr=mt!==null&&mt>=50&&mt<70,Ar=Fe.retest_offered,hr=mt===null?"text-gray-600":Xt?"text-red-600 font-semibold":Rr?"text-yellow-600":"text-green-600";return l.jsxs(Xe.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${hr} ${Xt?"cursor-pointer hover:opacity-90":""} ${Ar?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Xt?{color:"#b91c1c"}:void 0,whileHover:{scale:Xt?1.1:1.05},transition:{duration:.2},onClick:()=>{Xt&&!Ar&&(console.log(" Offering retest for speaking test:",be.test_name),n({failedStudentIds:[Te.student_id],test_type:be.test_type,original_test_id:Fe?.test_id||be.test_id,subject_id:Fe?.subject_id||be.subject_id,grade:t,class:r}))},title:Ar?"Retest offered":Xt?"Offer retest":"",children:[(()=>{const er=Fe.retest_best_score??Fe.score,Kt=Fe.retest_best_max_score??Fe.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Xt?"text-red-700":"",children:er}),"/",l.jsx("span",{children:Kt})]})})(),Fe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Fe.caught_cheating&&Fe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Fe.visibility_change_times,")"]})]})]}):Fe&&Fe.score!==null&&Fe.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const mt=o(Fe),Xt=mt!==null&&mt<50,Rr=mt!==null&&mt>=50&&mt<70,Ar=mt!==null&&mt>=70;console.debug("[TeacherResults] Main table pill",{studentId:Te.student_id,pct:mt,isRed:Xt,isYellow:Rr,isGreen:Ar,testResult:Fe});const hr=mt===null?"text-gray-600":Xt?"text-red-600 font-semibold":Rr?"text-yellow-600":"text-green-600",er=Fe?.retest_offered===!0;return l.jsxs(Xe.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${hr} ${Xt?"cursor-pointer hover:opacity-90":""} ${er?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:Xt?{color:"#b91c1c"}:void 0,whileHover:{scale:Xt?1.1:1.05},transition:{duration:.2},onClick:Kt=>{if(Kt.preventDefault(),Kt.stopPropagation(),Fe?.retest_offered){i("Retest is already offered","info");return}Xt&&(console.debug("[TeacherResults] Main table pill clicked -> opening retest modal",{studentId:Te.student_id,test:be}),n({failedStudentIds:[Te.student_id],test_type:be.test_type,original_test_id:Fe?.test_id||be.test_id,subject_id:Fe?.subject_id||be.subject_id,grade:t,class:r}))},title:er?"Retest offered":Xt?"Offer retest":"",children:[(()=>{const Kt=Fe.retest_best_score??Fe.score,ae=Fe.retest_best_max_score??Fe.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:Xt?"text-red-700":"",children:Kt}),"/",l.jsx("span",{children:ae})]})})(),Fe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Fe.caught_cheating&&Fe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Fe.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},nt)})]},Be))})})]})})]})]}),[Xr,Ce,$e]),ut=C.useCallback((se,ce,we)=>!ce||ce.length===0?l.jsx(Xe.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(Xe.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:l.jsx(Xe.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:l.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[l.jsx("thead",{children:l.jsxs(Xe.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Name"}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",children:"Surname"}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),we.map((Te,Be)=>{const be=Te.test_type==="drawing",nt=ye.current.has(Te.test_name);return l.jsx(Xe.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Be*.05},children:l.jsxs("div",{className:"flex flex-col space-y-1",children:[be&&l.jsx("div",{className:"flex justify-center",children:nt?l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:vt=>{vt.preventDefault(),vt.stopPropagation(),Ee(Te.test_name)},disabled:Jt,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:Jt?"Saving...":"Save"}),l.jsx("button",{onClick:vt=>{vt.preventDefault(),vt.stopPropagation(),ve(Te.test_name)},disabled:Jt,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):l.jsx("button",{onClick:vt=>{vt.preventDefault(),vt.stopPropagation(),ge(Te.test_name)},className:"px-1 py-0.5 bg-blue-600 text-white text-xs rounded hover:bg-blue-700",children:"Edit"})}),l.jsx("span",{className:"text-xs",children:Te.test_name.length>10?Te.test_name.substring(0,10)+"...":Te.test_name})]})},Be)})]})}),l.jsx("tbody",{children:l.jsx(wi,{children:ce.map((Te,Be)=>l.jsxs(Xe.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Be%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Be*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[l.jsx(Xe.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:Te.student_id}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Te.name}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Te.surname}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:Te.number??Be+1}),l.jsx(Xe.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:Te.nickname||"-"}),we.map((be,nt)=>{const vt=Ce.has(be.test_name),Fe=Te[be.test_name];return vt?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:mt=>{mt.preventDefault(),mt.stopPropagation(),$e(be.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},nt):l.jsx(Xe.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:mt=>{console.debug("[TeacherResults] TD clicked",{testResult:Fe,student:Te.student_id});const Xt=o(Fe);if(Xt!==null&&Xt<50){if(Fe?.retest_offered){i("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:Te.student_id}),n({failedStudentIds:[Te.student_id],grade:t,class:r})}},children:Fe&&Fe.score!==null&&Fe.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[Fe.test_type==="drawing"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>ue(Fe),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),ye.current.has(be.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Fe.max_score||100,value:he.current[be.test_name]?.[Te.student_id]?.score||Fe.score||"",onChange:mt=>Se(be.test_name,Te.student_id,"score",mt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:he.current[be.test_name]?.[Te.student_id]?.maxScore||Fe.max_score||100,onChange:mt=>Se(be.test_name,Te.student_id,"maxScore",mt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs(Xe.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${Fe.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>ge(be.test_name),title:"Double-click to edit column",children:[Fe.score,"/",Fe.max_score,Fe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})]}):Fe.test_type==="speaking"||be.test_type==="speaking"?l.jsxs(l.Fragment,{children:[console.log(" Rendering speaking link (compact table):",{studentId:Te.student_id,testName:be.test_name,testType:Fe?.test_type,answers:Fe?.answers}),l.jsx("button",{onClick:()=>ke({...Fe,__studentId:Te.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),ye.current.has(be.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Fe.max_score||100,value:he.current[be.test_name]?.[Te.student_id]?.score||Fe.score||"",onChange:mt=>Se(be.test_name,Te.student_id,"score",mt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:he.current[be.test_name]?.[Te.student_id]?.maxScore||Fe.max_score||100,onChange:mt=>Se(be.test_name,Te.student_id,"maxScore",mt.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs(Xe.div,{className:`px-1 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800 cursor-pointer hover:bg-gray-200 transition-colors ${Fe.caught_cheating?"bg-red-100 text-red-800 border border-red-300":"bg-gray-100 text-gray-800"}`,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>ge(be.test_name),title:"Double-click to edit scores",children:[Fe.score||0,"/",Fe.max_score||100,Fe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})]}):(()=>{const mt=o(Fe),Xt=mt!==null&&mt<50,Rr=mt!==null&&mt>=50&&mt<70,Ar=mt!==null&&mt>=70;console.debug("[TeacherResults] Render pill",{studentId:Te.student_id,pct:mt,isRed:Xt,isYellow:Rr,isGreen:Ar,score:Fe.score,max:Fe.max_score,percentageField:Fe.percentage});const er=`px-1 py-0.5 rounded text-xs font-medium ${mt===null?"text-gray-600":Xt?"text-red-600 font-semibold":Rr?"text-yellow-600":"text-green-600"} ${Xt?"cursor-pointer hover:opacity-90 pointer-events-auto":""}`;return console.debug("[TeacherResults] Pill classes",{classNameStr:er,pct:mt,isRed:Xt,isYellow:Rr,isGreen:Ar}),l.jsxs(Xe.div,{className:er,style:Xt?{color:"#b91c1c"}:void 0,whileHover:{scale:Xt?1.05:1},transition:{duration:.15},onClick:Xt?Kt=>{Kt.preventDefault(),Kt.stopPropagation();const ae=window.getComputedStyle(Kt.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:Te.student_id,className:er,computedColor:ae}),n({failedStudentIds:[Te.student_id],grade:t,class:r})}:void 0,title:Xt?"Offer retest":"",children:[l.jsx("span",{className:Xt?"text-red-700":"",children:Fe.score}),"/",l.jsx("span",{children:Fe.max_score}),Fe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Fe.caught_cheating&&Fe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Fe.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},nt)})]},Be))})})]})})})}),[Xr,Ce,$e]),Ge=C.useCallback(()=>{if(!I)return null;console.log(" renderResults - results:",I),console.log(" renderResults - results.class:",I.class),console.log(" renderResults - results.unique_tests:",I.unique_tests);const se=I.class&&Array.isArray(I.class)&&I.class.length>0;if(console.log(" renderResults - hasStudentData:",se),!se)return console.log(" renderResults - No student data, showing no students message"),l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const ce=I.unique_tests||[];return console.log(" renderResults - uniqueTests:",ce),_e.current=I,l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Xe.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[l.jsxs(Xe.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",O,", Class ",O,"/",z,", Semester ",b]}),l.jsxs(Xe.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",I.subjects?.length||0," subject(s)"]}),l.jsxs(Xe.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[l.jsx("button",{onClick:()=>{const we=I.unique_tests?.map(Te=>Te.test_name)||[];Oe(new Set(we))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),l.jsx("button",{onClick:()=>Oe(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),l.jsxs(Xe.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[l.jsx(Xe.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),l.jsx("div",{className:"hidden md:block",children:We("All Subjects",I.class,ce)}),l.jsx("div",{className:"md:hidden",children:ut("All Subjects",I.class,ce)})]})]})},[I,We,O,z,b]),le=C.useCallback(()=>{if(!I||!I.class||!I.unique_tests)return;const se=["Student ID","Name","Surname","No.","Nickname",...I.unique_tests.map(nt=>nt.test_name)],ce=I.class.map((nt,vt)=>{const Fe=[];return Fe.push(nt.student_id),Fe.push(nt.name),Fe.push(nt.surname),Fe.push(nt.number??vt+1),Fe.push(nt.nickname||"-"),I.unique_tests.forEach(mt=>{const Xt=nt[mt.test_name];Xt&&Xt.score!==null&&Xt.score!==void 0?Fe.push(`${Xt.score}/${Xt.max_score}`):Fe.push("-")}),Fe}),we=I1.aoa_to_sheet([se,...ce]),Te=I1.book_new(),Be=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...I.unique_tests.map(()=>({wch:15}))];we["!cols"]=Be,I1.book_append_sheet(Te,we,"Class Results");const be=`class-results-${O}-${z}-semester-${b}.xlsx`;Ote(Te,be),i("Excel file exported successfully!","success")},[I,O,z,b,i]);return f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):g?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:g}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex justify-between items-center py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",oe?oe.toLocaleString():"Never"]})]})})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),P.length>0?l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:P.map((se,ce)=>l.jsxs(Ze,{variant:O===se.grade&&z===se.class?"primary":"outline",onClick:()=>fr(se.grade,se.class),className:"w-full",children:[se.grade,"/",se.class]},`${se.grade}-${se.class}-${ce}`))}):l.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),z&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Select Semester for ",O,"/",z]}),l.jsx("div",{className:"flex space-x-4",children:[1,2].map(se=>{let ce=1;if(X&&X.length>0){const we=new Date;for(const Te of X){const Be=new Date(Te.start_date),be=new Date(Te.end_date);if(we>=Be&&we<=be){ce=Te.semester;break}}}return l.jsxs(Xe.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${b===se?"bg-blue-600 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>cr(se),whileHover:{scale:1.05},whileTap:{scale:.95},children:["Semester ",se,se===ce&&l.jsx("span",{className:"ml-2 text-xs",children:"(Current)"})]},se)})})]}),z&&I&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[O," ",z," - Test Results (Semester ",b,")"]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:le,children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),l.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),Ge()]}),z&&!I&&l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No test results available for this class and semester."})})})]})}),Ve&&tt&&l.jsx(hN,{children:l.jsx(Jj,{drawing:Ve,isOpen:tt,onClose:()=>Le(!1),isTeacherView:!0})}),De&&_t&&l.jsx(hN,{children:l.jsx(Vz,{result:De,isOpen:_t,onClose:()=>ht(!1),initialTab:De.__initialTab||"overview"})})]})},S3=({onBackToLogin:e})=>{const t=Ti(),{user:r,isAuthenticated:n,logout:s,getCurrentTeacherUsername:a}=Mn(),{teacherData:i,loadTeacherData:o}=Qy(),{activeTests:c,loadActiveTests:d}=Wp(),{showNotification:f,notifications:p}=ba(),[g,y]=C.useState(!0),[v,w]=C.useState(""),[b,E]=C.useState("main"),[k,_]=C.useState([]),[N,A]=C.useState([]),[P,R]=C.useState(null),[T,D]=C.useState(null),[I,K]=C.useState(null),[X,Z]=C.useState(!1),[oe,q]=C.useState(!1),[re,M]=C.useState(null),[W,B]=C.useState(!1),[G,H]=C.useState(null),[O,z]=C.useState(!1),[Y,J]=C.useState(null),[te,ee]=C.useState(null),[ie,me]=C.useState([]),[Ce,Oe]=C.useState(!1),[fe,pe]=C.useState(null),[He,Ye]=C.useState({}),[ot,Ve]=C.useState(!1),[Rt,tt]=C.useState(!1),[Le,De]=C.useState(0),[Je,_t]=C.useState(!1),[ht,It]=C.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[Mt,rt]=C.useState([]),[qe,pt]=C.useState([]),[lt,wt]=C.useState(!1),[Lt,Ht]=C.useState(null),[Ie,at]=C.useState([]),[gt,At]=C.useState(!1),[Ot,Jt]=C.useState("subject");C.useEffect(()=>{zt()},[]),C.useEffect(()=>{const ae=Ne=>{ot&&!Ne.target.closest(".relative")&&Ve(!1),Rt&&!Ne.target.closest(".relative")&&tt(!1)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[ot,Rt]);const Ae=C.useCallback(()=>{console.log(" showChangePasswordTab called"),_t(!0),Ve(!1),tt(!1)},[]),ye=C.useCallback(()=>{console.log(" hideChangePasswordTab called"),_t(!1),It({currentPassword:"",newPassword:"",confirmPassword:""})},[]),he=C.useCallback(async()=>{if(!r)return;const{currentPassword:ae,newPassword:Ne,confirmPassword:dt}=ht;if(!ae||!Ne||!dt){f("Please fill in all fields","error");return}if(Ne!==dt){f("New passwords do not match","error");return}if(Ne.length<6){f("New password must be at least 6 characters long","error");return}const Ct=/[a-zA-Z]/.test(Ne),Dr=/[0-9]/.test(Ne);if(!Ct||!Dr){f("New password must contain both letters and numbers","error");return}try{const _r=await xn.changePassword({username:r.username,currentPassword:ae,newPassword:Ne});_r.success?(f("Password changed successfully!","success"),ye()):f(_r.message||"Failed to change password","error")}catch(_r){console.error("Password change error:",_r),f("Failed to change password. Please try again.","error")}},[r,ht,f]),_e=C.useCallback(ae=>{const{name:Ne,value:dt}=ae.target;It(Ct=>({...Ct,[Ne]:dt}))},[]),$e=C.useCallback(async()=>{console.log(" Loading teacher data...");try{const ae=await xn.getTeacherData();return console.log(" Teacher data loaded:",ae),ee(new Date),ae}catch(ae){throw console.error(" Error loading teacher data:",ae),ae}},[]),St=C.useCallback(async()=>{console.log(" Loading teacher subjects...");try{const ae=`teacher_subjects_${r?.teacher_id||r?.id||""}`,Ne=En(ae);if(Ne)return console.log(" Using cached teacher subjects"),_(Ne),Ne;const dt=await xn.getTeacherData();console.log(" Raw teacher data:",dt);const Ct=xn.getTeacherSubjects(dt.subjects);return console.log(" Teacher subjects loaded:",Ct),_(Ct),Nn(ae,Ct,Fn.teacher_subjects),console.log(" Available classes for performance chart:",Ct[0]?.classes||[]),console.log(" Performance chart will load when user clicks on a class"),Ct}catch(ae){throw console.error(" Error loading teacher subjects:",ae),ae}},[r?.teacher_id,r?.id]),ct=C.useCallback(async()=>{console.log(" Loading teacher active tests...");try{const ae=`teacher_tests_${r?.teacher_id||r?.id||""}`,Ne=En(ae);Ne&&Ne.some(Dr=>Dr.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(ae));const dt=En(ae);if(dt)return console.log(" Using cached teacher tests"),A(dt),dt;const Ct=await Jr.getTeacherTests();return console.log(" Teacher tests loaded:",Ct),A(Ct),Nn(ae,Ct,Fn.teacher_tests),Ct}catch(ae){throw console.error(" Error loading teacher tests:",ae),ae}},[r?.teacher_id,r?.id]),zt=C.useCallback(async()=>{console.log(" Initializing Teacher Cabinet...");try{if(y(!0),w(""),!n||!r){console.log(" User not authenticated"),w("User not authenticated");return}if(r.role!==ri.TEACHER){console.error(" Invalid user role for teacher cabinet:",r.role),w("Access denied. Teacher role required.");return}console.log(" Loading teacher data..."),await $e(),console.log(" Loading teacher subjects..."),await St(),console.log(" Loading active tests..."),await ct(),console.log(" Teacher Cabinet initialization complete!")}catch(ae){console.error(" Error initializing teacher cabinet:",ae),w("Failed to initialize teacher cabinet")}finally{y(!1)}},[n,r,$e,St,ct]),qt=C.useCallback(()=>{console.log(" Showing subject selection prompt..."),Z(!0),Vt(),Jt("subject")},[]),Vt=C.useCallback(async()=>{console.log(" Loading available subjects..."),wt(!0);try{const ae=await xn.getSubjectsForSelection();rt(ae),console.log(" Available subjects loaded:",ae)}catch(ae){console.error(" Error loading available subjects:",ae),f("Failed to load subjects","error")}finally{wt(!1)}},[]),gr=C.useCallback(ae=>{if(!ae){Ht(null);return}const Ne=Mt.find(dt=>dt.subject_id==ae);Ne&&(Ht(Ne),at([]),Jt("classes"))},[Mt]),Fr=C.useCallback((ae,Ne)=>{at(dt=>dt.some(Ct=>Ct.grade===ae&&Ct.class===Ne)?dt.filter(Ct=>!(Ct.grade===ae&&Ct.class===Ne)):[...dt,{grade:ae,class:Ne}])},[]),fr=C.useCallback(()=>{if(!Lt||Ie.length===0){f("Please select at least one class","warning");return}const ae={subject_id:parseInt(Lt.subject_id),subject_name:Lt.subject,classes:Ie};pt(Ne=>[...Ne,ae]),Ht(null),at([]),Jt("subject"),f(`Added ${Lt.subject} with ${Ie.length} classes`,"success")},[Lt,Ie]),cr=C.useCallback(ae=>{pt(Ne=>Ne.filter((dt,Ct)=>Ct!==ae))},[]),Pr=C.useCallback(async(ae,Ne,dt)=>{console.log(" Deleting teacher subject:",{subjectId:ae,grade:Ne,classNumber:dt});try{const Ct={subjectId:ae,grade:Ne,class:dt};console.log(" Sending delete request with data:",Ct);const Dr=await xn.deleteTeacherSubject(Ct);if(Dr.success)f("Subject assignment deleted successfully!","success"),await St();else throw new Error(Dr.error||"Failed to delete subject assignment")}catch(Ct){console.error(" Error deleting subject assignment:",Ct),f("Error deleting subject assignment. Please try again.","error")}},[St,f]),Xr=C.useCallback((ae,Ne,dt,Ct)=>{J({subjectId:ae,subjectName:Ne,grade:dt,classNumber:Ct}),z(!0)},[]),ue=C.useCallback(async()=>{Y&&(await Pr(Y.subjectId,Y.grade,Y.classNumber),z(!1),J(null))},[Y,Pr]),ke=C.useCallback(()=>{z(!1),J(null)},[]),ge=C.useCallback(async()=>{if(qe.length===0){f("Please select at least one subject","warning");return}try{const ae=await xn.saveTeacherSubjects(qe);if(ae.success)f("Subjects saved successfully!","success"),Z(!1),pt([]),Jt("subject"),await St();else throw new Error(ae.error||"Failed to save subjects")}catch(ae){console.error(" Error saving teacher subjects:",ae),f("Failed to save subjects","error")}},[qe,St]);C.useCallback(async ae=>{console.log(" Saving teacher subjects:",ae);try{const Ne=await xn.saveTeacherSubjects(ae);if(Ne.success)f("Subjects saved successfully!","success"),await St(),Z(!1);else throw new Error(Ne.error||"Failed to save subjects")}catch(Ne){console.error(" Error saving teacher subjects:",Ne),f("Failed to save subjects","error")}},[St]);const ve=C.useCallback(()=>{console.log(" Showing active tests..."),E("tests")},[]),Se=C.useCallback(ae=>{console.log(" Showing test details:",ae),M(ae),q(!0)},[]);C.useCallback(async(ae,Ne,dt)=>{console.log(" Removing class assignment:",ae,Ne,dt);try{const Ct=await Jr.removeClassAssignment(ae,Ne,dt);if(Ct.success)f("Assignment removed successfully!","success"),await ct();else throw new Error(Ct.error||"Failed to remove assignment")}catch(Ct){console.error(" Error removing class assignment:",Ct),f("Failed to remove assignment","error")}},[ct]);const Ee=C.useCallback(async(ae,Ne)=>{console.log(" Marking test as completed:",ae,Ne);try{const dt=await Jr.markTestCompleted(ae,Ne);if(dt.success){f("Test marked as completed!","success");const Ct=`teacher_tests_${r?.teacher_id||r?.id||""}`;localStorage.removeItem(Ct),console.log(" Cleared teacher tests cache"),await ct()}else throw new Error(dt.error||"Failed to mark test as completed")}catch(dt){console.error(" Error marking test as completed:",dt),f("Failed to mark test as completed","error")}},[ct,f,r?.teacher_id,r?.id]),We=C.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await ct(),f("Tests refreshed successfully!","success")}catch(ae){console.error(" Error refreshing tests:",ae),f("Failed to refresh tests","error")}},[ct]),[ut,Ge]=C.useState(!1),le=C.useCallback(async ae=>{console.log(" Loading performance data for class:",ae),console.log(" Current selectedClassForChart:",fe);try{Ge(!0);const[Ne,dt]=ae.split("/"),Ct=Ne.startsWith("M")?Ne:`M${Ne}`,Dr=`class_summary_${r.teacher_id}_${Ct}_${dt}_${vi.CURRENT_ACADEMIC_YEAR}_${vi.CURRENT_SEMESTER}`,_r=En(Dr);if((_r?Date.now()-_r.timestamp:1/0)>36e5)try{await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/refresh-class-summary-semester")}catch(bn){console.warn("Materialized view refresh failed (continuing):",bn.message)}const oi=await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary-semester?teacher_id=${r.teacher_id}&grade=${Ct}&class=${dt}&semester=${vi.CURRENT_SEMESTER}&academic_year=${vi.CURRENT_ACADEMIC_YEAR}`);console.log(" API response status:",oi.status);const Us=await oi.json();if(console.log(" Performance API response:",Us),console.log(" API success:",Us.success),console.log(" API summary:",Us.summary),Us.success&&Us.summary){console.log(" Processing semester performance data:",Us.summary);const bn=Us.summary;console.log(" Semester summary:",{total_students:bn.total_students,total_tests:bn.total_tests,completed_tests:bn.completed_tests,average_class_score:bn.average_class_score,pass_rate:bn.pass_rate,cheating_incidents:bn.cheating_incidents});const $s={summary:bn,semester:vi.CURRENT_SEMESTER,academicYear:vi.CURRENT_ACADEMIC_YEAR,overallAverage:bn.average_class_score||0,totalTests:bn.total_tests||0,completedTests:bn.completed_tests||0,passRate:bn.pass_rate||0,cheatingIncidents:bn.cheating_incidents||0,lastTestDate:bn.last_test_date,semesterProgress:se(bn)};console.log(" Semester performance data:",$s),Ye(Il=>({...Il,[ae]:$s}))}else console.log(" No performance data available for class:",ae),Ye(bn=>({...bn,[ae]:{tests:[],overallAverage:0}}))}catch(Ne){console.error(" Error loading performance data:",Ne),console.error(" Error details:",Ne.message),Ye(dt=>({...dt,[ae]:{tests:[],overallAverage:0}}))}finally{Ge(!1)}},[r]),se=C.useCallback(ae=>{if(!ae.last_test_date)return 0;const Ne=new Date("2025-05-01"),dt=new Date("2025-09-30"),Ct=new Date,Dr=dt-Ne,_r=Math.min(Ct-Ne,Dr);return Math.round(_r/Dr*100)},[]);C.useCallback((ae,Ne)=>{console.log(" Showing class results:",ae,Ne),console.log(" Class click - grade:",ae,"className:",Ne),D(ae),K(Ne),E("results");const dt=`${ae}/${Ne}`;console.log(" Loading performance data for clicked class:",dt),pe(dt),le(dt)},[le]);const[ce,we]=C.useState([]),[Te,Be]=C.useState([]),be=C.useCallback(async()=>{try{const Ne=await(await Au(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(r.teacher_id);we(Ne)}catch(ae){console.warn("Failed to load retests",ae)}},[r]);C.useCallback(async ae=>{try{const dt=await(await Au(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(ae);Be(dt)}catch(Ne){console.warn("Failed to load retest targets",Ne)}},[]);const[nt,vt]=C.useState(!1);C.useEffect(()=>{console.debug("[TeacherCabinet] showRetestModal state changed:",nt)},[nt]);const[Fe,mt]=C.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),Xt=C.useCallback(async ae=>{console.debug("[TeacherCabinet] openRetestModal called with:",ae);const{test_type:Ne,original_test_id:dt,subject_id:Ct,failedStudentIds:Dr=[],grade:_r,class:fn}=ae||{};mt({test_type:Ne||"multiple_choice",original_test_id:dt||"",subject_id:Ct||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:Dr}),_r!==void 0&&D(_r),fn!==void 0&&K(fn),console.debug("[TeacherCabinet] Setting showRetestModal to true"),vt(!0)},[]),Rr=C.useCallback(async()=>{try{const ae=await Au(()=>import("./retestService-C6b0YDiD.js"),[]),Ne=new Date,dt=new Date(Ne.getTime()+Fe.window_days*24*60*60*1e3),Ct={...Fe,grade:T,class:I,window_start:Ne.toISOString(),window_end:dt.toISOString()};await ae.retestService.createRetestAssignment(Ct),f("Retest created","success"),vt(!1),be(),De(Dr=>Dr+1)}catch(ae){console.error("Create retest error",ae),f(ae.message||"Failed to create retest","error")}},[Fe,T,I,be]),Ar=C.useCallback(ae=>{if(!ae)return l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-gray-500",children:"Click on a class to view performance data"})]});const dt=(He[ae]||{}).summary;return dt?l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[dt.average_class_score?.toFixed(1)||0,"%"]}),l.jsx("div",{className:"text-sm text-blue-600",children:"Class Average"})]}),l.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-3xl font-bold text-green-600",children:dt.total_tests||0}),l.jsx("div",{className:"text-sm text-green-600",children:"Total Tests"})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[l.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[dt.pass_rate?.toFixed(1)||0,"%"]}),l.jsx("div",{className:"text-sm text-purple-600",children:"Pass Rate"})]}),l.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-3xl font-bold text-red-600",children:dt.cheating_incidents||0}),l.jsx("div",{className:"text-sm text-red-600",children:"Cheating Incidents"})]})]}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:dt.completed_tests||0}),l.jsx("div",{className:"text-sm text-yellow-600",children:"Completed Tests"})]}),l.jsxs("div",{className:"bg-indigo-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:dt.highest_score||0}),l.jsx("div",{className:"text-sm text-indigo-600",children:"Highest Score"})]}),l.jsxs("div",{className:"bg-pink-50 rounded-lg p-4",children:[l.jsx("div",{className:"text-2xl font-bold text-pink-600",children:dt.total_students||0}),l.jsx("div",{className:"text-sm text-pink-600",children:"Total Students"})]})]}),ut&&l.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-4 w-full max-w-xs text-center",children:[l.jsx("div",{className:"animate-spin h-6 w-6 border-2 border-gray-300 border-t-transparent rounded-full mx-auto mb-2"}),l.jsx("div",{className:"text-sm text-gray-700",children:"Loading latest class summary..."})]})})]}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-gray-500",children:"No performance data available for this class"})]})},[He]);if(g)return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2"})]});if(v)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:v}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs(Xe.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Xe.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(Xe.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),l.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",a()||""]})]}),l.jsxs(Xe.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx("div",{className:"hidden md:block",children:l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>Ve(!ot),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[l.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:ot?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),ot&&l.jsxs(Xe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("button",{onClick:()=>{Ve(!1),Ae()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{Ve(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("button",{onClick:()=>tt(!Rt),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Rt&&l.jsxs(Xe.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:a()||"Teacher"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),l.jsxs("button",{onClick:()=>{tt(!1),Ae()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{tt(!1),e?e():s()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})]})]})})}),l.jsx(Xe.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:l.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((ae,Ne)=>l.jsxs(Xe.button,{onClick:()=>ae.key==="tests"?ve():E(ae.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 ${b===ae.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+Ne*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[l.jsx("span",{className:"sm:hidden",children:ae.shortLabel}),l.jsx("span",{className:"hidden sm:inline",children:ae.label})]},ae.key))})})}),l.jsx(Xe.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:l.jsxs(wi,{mode:"wait",children:[b==="main"&&l.jsx(Xe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:hr()},"main"),b==="subjects"&&l.jsx(Xe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:er()},"subjects"),b==="tests"&&l.jsx(Xe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Kt()},"tests"),b==="results"&&l.jsx(Xe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(uP,{selectedGrade:T,selectedClass:I,onBackToCabinet:()=>E("main"),openRetestModal:Xt},Le)},"results")]})}),X&&l.jsx(Bo,{isOpen:X,onClose:()=>{Z(!1),Jt("subject"),pt([]),Ht(null),at([])},title:"Select Subjects and Classes",size:"large",children:l.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[Ot==="subject"&&l.jsxs(Xe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),lt?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):l.jsxs("select",{value:Lt?.subject_id||"",onChange:ae=>gr(ae.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Select a subject"}),Mt.map(ae=>l.jsx("option",{value:ae.subject_id,children:ae.subject},ae.subject_id))]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:()=>Jt("classes"),disabled:!Lt,children:"Next: Select Classes"})]})]}),Ot==="classes"&&Lt&&l.jsxs(Xe.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",Lt.subject]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),l.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6].map(ae=>l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",ae]}),l.jsx("div",{className:"space-y-1",children:[15,16].map(Ne=>l.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[l.jsx("input",{type:"checkbox",checked:Ie.some(dt=>dt.grade===ae.toString()&&dt.class===Ne.toString()),onChange:()=>Fr(ae.toString(),Ne.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Ne]})]},Ne))})]},ae))})})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Jt("subject"),children:"Back to Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:fr,disabled:Ie.length===0,children:"Add Subject"})]})]})]}),qe.length>0&&l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:qe.map((ae,Ne)=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:ae.subject_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",ae.classes.map(dt=>`Grade ${dt.grade} Class ${dt.class}`).join(", ")]})]}),l.jsx("button",{onClick:()=>cr(Ne),className:"text-red-600 hover:text-red-800 p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Ne))})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Jt("subject"),children:"Add More Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:()=>Z(!1),children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:ge,children:"Save All Subjects"})]})]})]})]})}),nt&&l.jsxs(Bo,{isOpen:nt,onClose:()=>vt(!1),title:"Create Retest",size:"medium",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Fe.window_days,onChange:ae=>mt(Ne=>({...Ne,window_days:Number(ae.target.value)})),children:[l.jsx("option",{value:1,children:"1 day"}),l.jsx("option",{value:2,children:"2 days"}),l.jsx("option",{value:3,children:"3 days"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Fe.max_attempts,onChange:ae=>mt(Ne=>({...Ne,max_attempts:Number(ae.target.value)})),children:[l.jsx("option",{value:1,children:"1 attempt"}),l.jsx("option",{value:2,children:"2 attempts"}),l.jsx("option",{value:3,children:"3 attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>vt(!1),className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50",children:"Cancel"}),l.jsx("button",{onClick:Rr,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700",children:"Create Retest"})]})]}),oe&&re&&l.jsxs(Bo,{isOpen:oe,onClose:()=>q(!1),title:"Test Details",size:"large",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:re.test_name})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),l.jsx("p",{className:"text-sm text-gray-900",children:re.subject})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Test Type:"}),l.jsx("p",{className:"text-sm text-gray-900",children:re.test_type})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),l.jsx("p",{className:"text-sm text-gray-900",children:new Date(re.created_at).toLocaleDateString()})]})]}),l.jsx("div",{className:"flex justify-end space-x-3 mt-6",children:l.jsx(Ze,{variant:"outline",onClick:()=>q(!1),children:"Close"})})]}),O&&Y&&l.jsx(Bo,{isOpen:O,onClose:ke,title:"Delete Subject Assignment",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",l.jsx("span",{className:"font-semibold text-gray-900",children:Y.subjectName})," ","in Grade ",Y.grade,", Class ",Y.classNumber,"?"]}),l.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(Ze,{variant:"outline",onClick:ke,children:"Cancel"}),l.jsx(Ze,{variant:"danger",onClick:ue,children:"Delete Assignment"})]})]})}),l.jsx(Xe.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:p.map(ae=>l.jsx(Xe.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:l.jsx("div",{className:`p-4 rounded-lg shadow-lg ${ae.type==="success"?"bg-green-600 text-white":ae.type==="error"?"bg-red-600 text-white":ae.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:ae.message}),l.jsx("button",{onClick:()=>setNotifications(Ne=>Ne.filter(dt=>dt.id!==ae.id)),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},ae.id))}),Je&&l.jsx(Bo,{isOpen:Je,onClose:ye,title:"Change Password",size:"sm",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",name:"currentPassword",value:ht.currentPassword,onChange:_e,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",name:"newPassword",value:ht.newPassword,onChange:_e,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",name:"confirmPassword",value:ht.confirmPassword,onChange:_e,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:ye,className:"flex-1",children:"Cancel"}),l.jsx(Ze,{type:"button",onClick:he,className:"flex-1",children:"Change Password"})]})]})})]});function hr(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsxs(bt,{children:[l.jsx(bt.Header,{children:l.jsx(bt.Title,{children:"My Subjects & Classes"})}),l.jsx(bt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),l.jsx(Ze,{variant:"outline",onClick:()=>E("subjects"),children:"Manage Subjects"})]}):l.jsx("div",{className:"space-y-6",children:k.map((ae,Ne)=>l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+Ne*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ae.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[ae.classes?.length||0," classes"]})]}),ae.classes&&ae.classes.length>0?l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:ae.classes.map((dt,Ct)=>l.jsx(Xe.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+Ne*.1+Ct*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(Ze,{variant:"outline",size:"sm",onClick:()=>{D(dt.grade),K(dt.class),E("results")},className:"font-medium",children:[dt.grade,"/",dt.class]})},Ct))}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},ae.id))})})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:l.jsxs(bt,{children:[l.jsxs(bt.Header,{children:[l.jsx(bt.Title,{children:"Test Performance Overview"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Average scores across all tests by class"})]}),l.jsx(bt.Body,{children:k.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:""}),l.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const ae=[];return k.forEach(Ne=>{Ne.classes&&Ne.classes.forEach(dt=>{const Ct=`${dt.grade}/${dt.class}`;ae.find(Dr=>Dr.key===Ct)||ae.push({key:Ct,grade:dt.grade,class:dt.class,subject:Ne.name})})}),ae})().map((ae,Ne)=>l.jsxs("button",{onClick:()=>{console.log(" Class button clicked:",ae.key),pe(ae.key),le(ae.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${fe===ae.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[ae.grade,"/",ae.class]},ae.key))}),l.jsx("div",{className:"mt-4",children:Ar(fe)})]})})]})})]})}function er(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(bt,{children:l.jsx(bt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(bt.Title,{children:"Subject Management"}),l.jsx(Ze,{variant:"primary",onClick:qt,children:"Add Subject"})]})})})}),k.length===0?l.jsx(Xe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(bt,{children:l.jsx(bt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(Xe.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),l.jsx(Ze,{variant:"primary",onClick:qt,size:"lg",children:"Add Your First Subject"})]})})})}):l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:l.jsxs(bt,{children:[l.jsx(bt.Header,{children:l.jsx(bt.Title,{children:"Your Subjects"})}),l.jsx(bt.Body,{children:l.jsx("div",{className:"space-y-4",children:k.map((ae,Ne)=>l.jsx(Xe.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+Ne*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:l.jsx("div",{className:"flex justify-between items-start",children:l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:ae.name}),l.jsx("div",{className:"flex flex-wrap gap-2",children:ae.classes?.map((dt,Ct)=>l.jsxs(Xe.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+Ne*.1+Ct*.05,duration:.2},whileHover:{scale:1.1},children:[l.jsxs("span",{children:[dt.grade," - ",dt.className]}),l.jsx("button",{onClick:()=>Xr(ae.id,ae.name,dt.grade,dt.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Ct))||l.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},Ne))})})]})})]})}function Kt(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(bt,{children:l.jsx(bt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(bt.Title,{children:"Active Tests"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(Ze,{variant:"outline",onClick:We,children:"Refresh"}),l.jsx(Ze,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),N.length===0?l.jsx(Xe.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(bt,{children:l.jsx(bt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(Xe.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),l.jsx(Ze,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:N.map((ae,Ne)=>l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+Ne*.1,duration:.3},whileHover:{scale:1.01},children:l.jsx(bt,{children:l.jsx(bt.Body,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex-1 flex items-center space-x-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0",children:ae.test_name}),l.jsx("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:ae.test_type}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Assignments:"}),l.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:ae.assignments?.length||0})]}),ae.assignments&&ae.assignments.length>0&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600 flex-shrink-0",children:[l.jsx("span",{className:"font-medium",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1",children:ae.assignments.map((dt,Ct)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[dt.grade,"/",dt.class]},Ct))})]}),l.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(ae.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"flex gap-2 ml-4 flex-shrink-0",children:[l.jsx("div",{className:"sm:hidden",children:l.jsx(Ze,{variant:"outline",onClick:()=>Se(ae),size:"sm",className:"text-xs",title:`Assignments: ${ae.assignments?.length||0} | Classes: ${ae.assignments?.map(dt=>`${dt.grade}/${dt.class}`).join(", ")||"None"} | ${new Date(ae.created_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})}`,children:"Details"})}),l.jsx("div",{className:"hidden sm:block",children:l.jsx(Ze,{variant:"outline",onClick:()=>Se(ae),size:"sm",children:"Details"})}),l.jsx(Ze,{variant:"success",onClick:()=>Ee(ae.test_type,ae.test_id),size:"sm",children:"Complete"})]})]})})})},Ne))})]})}},qte={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},k3=()=>{const{user:e}=Mn();OW();const{notifications:t,showNotification:r,removeNotification:n}=ba(),[s,a]=C.useState(!1),[i,o]=C.useState(!1),[c,d]=C.useState("typeSelection"),[f,p]=C.useState(!1),[g,y]=C.useState(null),[v,w]=C.useState([]),[b,E]=C.useState(!1),[k,_]=C.useState(!1),[N,A]=C.useState(!1),[P,R]=C.useState(!1),[T,D]=C.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[I,K]=C.useState([]),[X,Z]=C.useState(null);C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null),C.useRef(null);const oe=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),H(),console.log(" Test creation initialization complete")},[e,r]),q=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),re(),d("typeSelection"),W("testTypeSelection")},[e,r]),re=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),p(!0)},[e]),M=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),p(!1)},[e]),W=C.useCallback(async le=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",le),console.log("  Call stack:",new Error().stack);const se={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},ce={isInTestCreation:!0,currentStep:le,timestamp:Date.now(),excelState:se};localStorage.setItem("test_creation_state",JSON.stringify(ce)),console.log(" Saved test creation state:",ce);const we={};switch(le){case"testTypeSelection":break;case"multipleChoiceForm":we.testName=T.testName||"",we.numQuestions=T.numQuestions||"",we.numOptions=T.numOptions||"",we.questions=T.questions||{};break;case"trueFalseForm":we.testName=T.testName||"",we.numQuestions=T.numQuestions||"",we.questions=T.questions||{};break;case"inputForm":we.testName=T.testName||"",we.numQuestions=T.numQuestions||"",we.questions=T.questions||{};break;case"formCreation":we.testName=T.testName||"",we.numQuestions=T.numQuestions||"",we.numOptions=T.numOptions||"",we.questions=T.questions||{},we.enableTimer=!!T.enableTimer,we.timerMinutes=T.timerMinutes||"",we.isShuffled=!!T.isShuffled;break;case"assignment":case"testAssignment":we.testName=T.testName||"",we.numQuestions=T.numQuestions||"",we.numOptions=T.numOptions||"",we.questions=T.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",le);break}Object.keys(we).length>0&&(localStorage.setItem(`form_data_${le}`,JSON.stringify(we)),console.log(" Saved form data for step:",le,we))},[e,T]),B=C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const le=[];for(let se=0;se<localStorage.length;se++){const ce=localStorage.key(se);ce&&(ce.includes("test")||ce.includes("form")||ce.includes("question"))&&le.push(ce)}le.forEach(se=>{localStorage.removeItem(se),console.log(" Removed localStorage key:",se)}),console.log(" Cleared test creation state from localStorage")},[e]);C.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),D({testName:"",numQuestions:0,numOptions:0,questions:{}}),y(null),K([]),Z(null),console.log(" Cleared all test form fields")},[e]);const G=C.useCallback(()=>{console.log(" Resetting Excel upload state..."),wt({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(se=>{const ce=document.querySelector(`.excel-upload-btn[data-test-type="${se}"]`);ce&&(ce.style.display="none",console.log(" Excel button hidden for:",se));const we=document.querySelector(`.excel-hint[data-test-type="${se}"]`);we&&(we.style.display="none",console.log(" Excel hint hidden for:",se));const Te=document.querySelector(`.excel-file-input[data-test-type="${se}"]`);Te&&(Te.value="",console.log(" File input cleared for:",se))}),console.log(" Excel upload state reset complete")},[]),H=C.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(se=>{const ce=document.getElementById(se);ce&&ce.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${se}`)})}),console.log(" Form auto-save setup complete")},[]);C.useCallback(async le=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",le),console.log("  Call stack:",new Error().stack);const se={};switch(le){case"testTypeSelection":break;case"multipleChoiceForm":se.testName=T.testName||"",se.numQuestions=T.numQuestions||"",se.numOptions=T.numOptions||"",se.questions=T.questions||{};break;case"trueFalseForm":se.testName=T.testName||"",se.numQuestions=T.numQuestions||"",se.questions=T.questions||{};break;case"inputForm":se.testName=T.testName||"",se.numQuestions=T.numQuestions||"",se.questions=T.questions||{};break;case"formCreation":se.testName=T.testName||"",se.numQuestions=T.numQuestions||"",se.numOptions=T.numOptions||"",se.questions=T.questions||{};break;default:console.log(" Unknown step for form data save:",le);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:le,data:se,timestamp:Date.now()})),console.log(" Saved form data for step:",le,se)},[e,T]);const O=C.useCallback(async le=>{console.log(" Restoring form data for step:",le);try{const se=localStorage.getItem(`form_data_${le}`);if(se){const ce=JSON.parse(se);console.log(" Restored form data:",ce),D(we=>{const Te={...we,...ce};return console.log(" Updated formData with restored data:",Te),console.log(" Matching test data in restored data:",Te.matchingTestData),Te}),Object.keys(ce).forEach(we=>{const Te=document.getElementById(we);Te&&ce[we]!==void 0&&(Te.value=ce[we])}),console.log(" Form data restored for step:",le)}else console.log(" No saved data found for step:",le)}catch(se){console.error(" Error restoring form data:",se)}},[e]),z=C.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(ce=>{const we=document.getElementById(ce);we&&we.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${ce}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(ce=>{ce.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),Y=C.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(se=>{se.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),J=C.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(se=>{se.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),te=C.useCallback(le=>{console.log(" showExcelUploadButton called with testType:",le);const se=le==="multiple-choice"?"multipleChoice":le==="true-false"?"trueFalse":le==="input"?"input":le;wt(ce=>({...ce,[se]:{...ce[se],buttonVisible:!0}}))},[]),ee=C.useCallback(le=>{console.log(" showExcelHint called with testType:",le);const se=le==="multiple-choice"?"multipleChoice":le==="true-false"?"trueFalse":le==="input"?"input":le;wt(ce=>({...ce,[se]:{...ce[se],hintVisible:!0}}))},[]),ie=C.useCallback(async(le,se,ce)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:le,testType:se,testId:ce}),w(le),console.log(" Test assignment options displayed for:",{testType:se,testId:ce,classesCount:le.length})},[e]),me=C.useCallback(async(le,se)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const we=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",we),we.success&&we.subjects&&we.subjects.length>0?(console.log("Teacher subjects loaded:",we.subjects),w(we.subjects),ie(we.subjects,le,se)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(ce){console.error("Error loading teacher grades and classes:",ce),r("Error loading teacher grades and classes","error")}},[e,r,ie]),Ce=C.useCallback(async()=>{console.log(" Loading available classes...");try{const le=await xn.getGradesAndClasses();if(console.log(" Raw grades/classes data:",le),!le||le.length===0){w([]);return}const se=new Map;le.forEach(we=>{const Te=we.subject_id,Be=we.subject||`Subject ${Te}`;se.has(Te)||se.set(Te,{subject_id:Te,subject:Be,classes:[]}),se.get(Te).classes.push({grade:we.grade,class:we.class})});const ce=Array.from(se.values());w(ce),console.log(" Transformed available classes:",ce)}catch(le){console.error(" Error loading available classes:",le),r("Failed to load available classes","error")}},[r]);C.useCallback(async(le,se)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}re(),W("testAssignment"),Z(se),y(le),d("testAssignment"),me(le,se),Ce(),console.log(" Test assignment interface shown for:",{testType:le,testId:se})},[i,e,re,W,me,Ce]);const Oe=C.useCallback(async le=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",le),le.length===0){Ve([]);return}Ve(le),console.log(" Active tests displayed:",le.length,"tests")},[e]);C.useCallback(async(le,se)=>{try{console.log(" Loading test questions for:",{testType:le,testId:se});const ce=await Jr.getTestQuestions(se,le);return console.log(" Test questions loaded:",ce),ce}catch(ce){throw console.error("Error loading test questions:",ce),ce}},[]),C.useCallback((le,se,ce,we)=>{console.log(" Showing teacher test details modal:",{testType:le,testId:se,testName:ce,questionsCount:we.length}),console.log("Test Details:",{testType:le,testId:se,testName:ce,questions:we.map(Te=>({id:Te.question_id,question:Te.question,correctAnswer:Te.correct_answer}))}),r(`Test details for "${ce}" loaded successfully.`,"success")},[r]);const fe=C.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const le=await Jr.getTeacherTests();console.log(" DEBUG: Tests loaded:",le),le&&le.length>0?(console.log(" DEBUG: Success! Displaying",le.length,"tests"),Oe(le)):(console.log(" DEBUG: No tests found"),Ve([]))}catch(le){console.error(" DEBUG: Error loading active tests:",le),r("Error loading active tests.","error")}},[r,Oe]),pe=C.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}}),K([]),o(!1),a(!1),B()},[r,B]),He=C.useCallback(async(le,se)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",le),console.log(" Test ID:",se),console.log(" Current formData:",T),console.log(" Selected Classes:",I),console.log(" User:",e),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}if(console.log(" Teacher ID:",e.teacher_id),I.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning");return}try{console.log(" Preparing test + assignment request...");const ce=I.map(be=>{const nt={grade:parseInt(be.grade),class:parseInt(be.class),subject_id:parseInt(be.subject_id),academic_period_id:8,due_date:null};return console.log(" Created assignment:",nt),nt});if(console.log(" Final assignments array:",ce),le==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(mt=>setTimeout(mt,100));const be=T.matchingTestData;if(console.log(" Matching test data from formData:",be),!be){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let nt;be.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),nt=be.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",be.blocks),console.log(" Words:",be.words),console.log(" Arrows:",be.arrows),nt=be.blocks.map((mt,Xt)=>{const Rr=be.words.find(Kt=>Kt.blockId===mt.id)?.word||`Word ${Xt+1}`,Ar=be.arrows.some(Kt=>Kt.startBlock===mt.id),hr=be.arrows.find(Kt=>Kt.startBlock===mt.id)||null,er={question_id:Xt+1,word:Rr,block_coordinates:{x:mt.x,y:mt.y,width:mt.width,height:mt.height},has_arrow:Ar,arrow:hr?{startX:hr.startX,startY:hr.startY,endX:hr.endX,endY:hr.endY,style:hr.style||{}}:null};return console.log(` Question ${Xt+1}:`,er),er})),console.log(" Final questions array:",nt);const vt={teacher_id:e.teacher_id,test_name:T.testName,image_url:be.imageUrl,num_blocks:be.blocks.length,questions:nt,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,assignments:ce};console.log(" Final matching test data payload:",vt),console.log(" Calling testService.saveMatchingTest...");const Fe=await Jr.saveMatchingTest(vt);console.log(" API Response:",Fe),Fe.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Ye()):(console.error(" Failed to create matching test:",Fe.message),r("Error creating and assigning matching test: "+Fe.message,"error")),R(!1);return}if(le==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(mt=>setTimeout(mt,100));const be=T.wordMatchingData;if(console.log(" Word matching test data from formData:",be),!be){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const nt=be.wordPairs.map((mt,Xt)=>({question_id:Xt+1,left_word:mt.leftWord,right_word:mt.rightWord}));console.log(" Final word matching questions array:",nt);const vt={teacher_id:e.teacher_id,test_type:"word_matching",test_name:T.testName,num_questions:be.wordPairs.length,interaction_type:be.interactionType||"drag",questions:nt,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,assignments:ce};console.log(" Final word matching test data payload:",vt),console.log(" Calling testService.assignTestToClasses for word matching...");const Fe=await Jr.assignTestToClasses(vt);console.log(" API Response:",Fe),Fe.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Ye()):(console.error(" Failed to create word matching test:",Fe.message),r("Error creating and assigning word matching test: "+Fe.message,"error")),R(!1);return}if(le==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(mt=>setTimeout(mt,100));const be=T.drawingData;if(console.log(" Drawing test data from formData:",be),!be){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const nt=be.questions||[];console.log(" Drawing questions array:",nt);const vt={teacher_id:e.teacher_id,test_type:"drawing",test_name:T.testName,num_questions:be.num_questions,passing_score:be.passing_score,questions:nt,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,assignments:ce};console.log(" Final drawing test data payload:",vt),console.log(" Calling testService.assignTestToClasses...");const Fe=await Jr.assignTestToClasses(vt);console.log(" API Response:",Fe),Fe.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Ye()):(console.error(" Failed to create drawing test:",Fe.message),r("Error creating and assigning drawing test: "+Fe.message,"error")),R(!1);return}if(le==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(mt=>setTimeout(mt,100));const be=T.fillBlanksData;if(console.log(" Fill blanks test data from formData:",be),!be){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const nt=be.blanks||[];console.log(" Fill blanks questions array:",nt);const vt={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:T.testName,test_text:be.test_text,num_questions:be.num_questions,num_blanks:be.num_blanks,separate_type:be.separate_type,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,questions:nt,assignments:ce};console.log(" Final fill blanks test data payload:",vt),console.log(" Calling testService.assignTestToClasses...");const Fe=await Jr.assignTestToClasses(vt);console.log(" API Response:",Fe),Fe.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),Ye()):(console.error(" Failed to create fill blanks test:",Fe.message),r("Error creating and assigning fill blanks test: "+Fe.message,"error")),R(!1);return}if(le==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(mt=>setTimeout(mt,100));const be=T.speakingData;if(console.log(" Speaking test data from formData:",be),!be){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const nt={teacher_id:e.teacher_id,test_type:"speaking",test_name:T.testName,time_limit:be.time_limit,min_duration:be.min_duration,max_duration:be.max_duration,max_attempts:be.max_attempts,min_words:be.min_words,passing_score:be.passing_score,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,questions:be.questions,assignments:ce};console.log(" Final speaking test data payload:",nt),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const Fe=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(nt)})).json();console.log(" API Response:",Fe),Fe.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),o(!0),Ye()):(console.error(" Failed to create speaking test:",Fe.message),r("Error creating and assigning speaking test: "+Fe.message,"error")),R(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",T.questions);const we=Object.keys(T.questions).map(be=>{const nt=T.questions[be];console.log(` Processing question ${be}:`,nt);let vt;le==="input"?vt={correct_answers:nt.correct_answers||[nt.correctAnswer||""]}:vt={correct_answer:nt.correctAnswer||nt.correct_answers?.[0]||""};const Fe={question_id:parseInt(be),question:nt.question,...vt,options:nt.options||[]};return console.log(` Question ${be} correct_answers:`,nt.correct_answers),console.log(` Question ${be} correctAnswer:`,nt.correctAnswer),console.log(` Converted question ${be}:`,Fe),Fe});console.log(" Final questions array:",we);const Te={teacher_id:e.teacher_id,test_type:qte[le],test_name:T.testName,num_questions:T.numQuestions,num_options:T.numOptions,questions:we,allowed_time:T.enableTimer?Math.max(0,Math.floor(Number(T.timerMinutes||0)*60)):null,is_shuffled:!!T.isShuffled,assignments:ce};console.log(" Final test data payload:",Te),console.log(" Setting isAssigningTest to true..."),R(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(be=>setTimeout(be,100)),console.log(" Calling testService.assignTestToClasses...");const Be=await Jr.assignTestToClasses(Te);console.log(" API Response:",Be),Be.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Ye()):(console.error(" Failed to create and assign test:",Be.message),r("Error creating and assigning test: "+Be.message,"error"))}catch(ce){console.error(" Exception in assignTestToClasses:",ce),console.error("Error creating and assigning test:",ce),r("Error creating and assigning test. Please try again.","error")}finally{R(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,I,T,r,pe]),Ye=C.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),d("typeSelection"),y(null),Z(null),K([]),M(),B(),pe(),console.log(" Returned to main cabinet")}catch(le){console.error("Error returning to main cabinet:",le)}},[M,B,pe]),[ot,Ve]=C.useState([]),[Rt,tt]=C.useState(!1);C.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await fe(),r("Active tests data refreshed.","success")}catch(le){console.error("Error refreshing active tests data:",le),r("Error refreshing data.","error")}},[fe,r]);const[Le,De]=C.useState([]),[Je,_t]=C.useState([]),[ht,It]=C.useState(!1),[Mt,rt]=C.useState(!1),qe=C.useCallback(async le=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",le),De(le),console.log(" Existing subjects displayed in selection:",le.length,"subjects")},[e]);C.useCallback(async()=>{try{console.log("Loading existing subjects...");const le=await xn.getTeacherSubjects();console.log("Existing subjects loaded:",le),le&&le.length>0?qe(le):(console.log("No existing subjects found"),De([]))}catch(le){console.error("Error loading existing subjects:",le),r("Error loading subjects.","error")}},[r,qe]);const pt=C.useCallback(le=>{console.log("Checking for outside click...");const se=document.getElementById("dropdownMenu"),ce=document.querySelector("[data-menu-button]");se&&!se.contains(le.target)&&!ce?.contains(le.target)&&(console.log("Outside click detected, closing menu"),se.classList.remove("show"),document.removeEventListener("click",pt))},[]),[lt,wt]=C.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Lt=C.useCallback((le,se)=>{const ce=le.target.files[0];if(!ce)return;if(!ce.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),le.target.value="";return}if(ce.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),le.target.value="";return}A(!0);const we=new FileReader;we.onload=function(Te){try{console.log(" File loaded, processing data...");const Be=new Uint8Array(Te.target.result),be=p2(Be,{type:"array"}),nt=be.SheetNames[0],vt=be.Sheets[nt],Fe=I1.sheet_to_json(vt,{header:1});console.log(" Parsed Excel data:",Fe),Ie(Fe,se),A(!1)}catch(Be){console.error("Error processing Excel file:",Be),r("Error reading Excel file: "+Be.message,"error"),le.target.value="",A(!1)}},we.onerror=function(){r("Failed to read file","error"),le.target.value="",A(!1)},we.readAsArrayBuffer(ce)},[r]),Ht=C.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const le=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${le.length} Excel upload buttons`),le.forEach((se,ce)=>{const we=se.dataset.testType,Te=document.querySelector(`.excel-file-input[data-test-type="${we}"]`);console.log(` Processing button ${ce+1}: testType=${we}, fileInput=${Te?"found":"not found"}`),Te?(se._excelClickHandler&&se.removeEventListener("click",se._excelClickHandler),Te._excelChangeHandler&&Te.removeEventListener("change",Te._excelChangeHandler),se._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${we}`),Te.click()},Te._excelChangeHandler=Be=>{console.log(` File input changed for test type: ${we}`),Lt(Be,we)},se.addEventListener("click",se._excelClickHandler),Te.addEventListener("change",Te._excelChangeHandler),console.log(` Excel upload initialized for test type: ${we}`)):console.warn(` File input not found for test type: ${we}`)}),console.log(" Excel upload initialization complete")},[Lt]),Ie=C.useCallback((le,se)=>{const ce=le.filter(vt=>Array.isArray(vt)&&vt.length>0&&vt.some(Fe=>Fe&&Fe.toString().trim()!==""));console.log(" Original Excel data rows:",le.length),console.log(" Filtered Excel data rows:",ce.length);const Te=at(ce,se).dataRows;if(Te.length===0){const vt="No data rows found after header processing. Please check your Excel file.";r(vt,"error"),alert(vt),he(se);return}console.log(` Processing Excel data for test type: ${se}`),console.log(" Data rows after header processing:",Te);const Be=Ot(Te,se);if(console.log(" Recognition result:",Be),!Be.recognized){console.log(` Excel data recognition failed for test type: ${se}`);const vt="Excel data recognition failed. Please check your file format.";r(vt,"error"),alert(vt),he(se);return}console.log(` Excel data recognition successful for test type: ${se}`);const be=Te.length,nt=ye(se);if(nt===0)console.log(` No question count specified, using CSV count: ${be}`),D(vt=>({...vt,numQuestions:be}));else if(be!==nt){const vt=`Your CSV file has ${be} data rows, but you specified ${nt} questions.

Please either:
1. Change your question count to ${be}, or
2. Fix your CSV file to have exactly ${nt} data rows

Then try uploading again.`;r(vt,"error"),he(se);return}_e(Te,se)},[r]),at=C.useCallback((le,se)=>{if(le.length===0)return{hasHeaders:!1,headerRow:null,dataRows:le};const ce=le[0],we=gt(se);if(At(ce,we).isLikelyHeader){const Be=`The first row of your Excel file looks like it contains headers:

"${ce.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(Be))return{hasHeaders:!0,headerRow:ce,dataRows:le.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:le}},[]),gt=C.useCallback(le=>{switch(le){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),At=C.useCallback((le,se)=>{if(!le||le.length===0)return{isLikelyHeader:!1};if(le.length<se.expectedColumns)return{isLikelyHeader:!1};const ce=le.join(" ").toLowerCase(),we=se.keywords.filter(Be=>ce.includes(Be.toLowerCase()));return{isLikelyHeader:we.length>se.keywords.length/2,keywordMatches:we}},[]),Ot=C.useCallback((le,se)=>{if(le.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${se}`),console.log(" Excel data to validate:",le);const ce=Jt(le,se);if(console.log(" Recognition result:",ce),!ce.matches){const we=`Your Excel file doesn't match the expected format.

Required format:
${Ae(se)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",we),console.log(" Calling showNotification with message:",we),r(we,"error"),console.log(" showNotification called"),alert(we),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${se}`),{recognized:!0,data:le}},[r]),Jt=C.useCallback((le,se)=>{if(se==="multipleChoice")for(let ce=0;ce<le.length;ce++){const we=le[ce];if(we.length<4)return{matches:!1,issue:`Row ${ce+1} has ${we.length} columns but needs at least 4`};if(!we[0]||we[0].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no question in column 1`};if(!we[1]||we[1].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no correct answer in column 2`}}else if(se==="trueFalse")for(let ce=0;ce<le.length;ce++){const we=le[ce];if(we.length<2)return{matches:!1,issue:`Row ${ce+1} has ${we.length} columns but needs at least 2`};if(!we[0]||we[0].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no question in column 1`};const Te=we[1]?.toString().trim().toLowerCase();if(!Te||!["true","false","t","f"].includes(Te))return{matches:!1,issue:`Row ${ce+1} has invalid correct answer in column 2 (must be True/False)`}}else if(se==="input")for(let ce=0;ce<le.length;ce++){const we=le[ce];if(we.length<2)return{matches:!1,issue:`Row ${ce+1} has ${we.length} columns but needs at least 2`};if(!we[0]||we[0].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no question in column 1`};if(!we[1]||we[1].toString().trim()==="")return{matches:!1,issue:`Row ${ce+1} has no correct answer in column 2`}}return{matches:!0}},[]),Ae=C.useCallback(le=>{switch(le){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),ye=C.useCallback(le=>T.numQuestions||0,[T.numQuestions]),he=C.useCallback(le=>{console.log(` Clearing file input for test type: ${le}`)},[]),_e=C.useCallback((le,se)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${se}`),se){case"multipleChoice":case"multiple-choice":$e(le);break;case"trueFalse":case"true-false":St(le);break;case"input":ct(le);break;default:console.log(` Unknown test type: ${se}`)}},[]),$e=C.useCallback(le=>{console.log(" populateMultipleChoiceFromExcel called with:",le);const se=Math.max(...le.map(Te=>Te.length-2)),ce=Math.min(se,6);console.log(` Excel data has ${se} option columns, using ${ce} options`),D(Te=>({...Te,numOptions:ce}));const we={};le.forEach((Te,Be)=>{const be=Be+1;console.log(` Row ${Be+1} data:`,Te);const nt={question:(Te[0]||"").toString().trim(),options:[],correctAnswer:(Te[1]||"").toString().trim().toUpperCase()};console.log(` Question ${be} correctAnswer:`,nt.correctAnswer),["A","B","C","D","E","F"].slice(0,ce).forEach((mt,Xt)=>{const Rr=(Te[Xt+2]||"").toString().trim();console.log(` Option ${Xt} (${mt}):`,Rr),nt.options.push(Rr)}),we[be]=nt}),D(Te=>{const Be={...Te,questions:we};return console.log(" Updating form data with:",Be),Be}),console.log(" Populated multiple choice questions from Excel:",we),r(`Successfully loaded ${le.length} questions from CSV file!`,"success"),z(),zt("multiple-choice")},[T.numOptions,z,r]),St=C.useCallback(le=>{console.log(" populateTrueFalseFromExcel called with:",le);const se={};le.forEach((ce,we)=>{const Te=we+1,Be={question:(ce[0]||"").toString().trim(),correctAnswer:ce[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};se[Te]=Be}),D(ce=>({...ce,questions:se})),console.log(" Populated true/false questions from Excel:",se),r(`Successfully loaded ${le.length} questions from CSV file!`,"success"),Y(),zt("true-false")},[Y,r]),ct=C.useCallback(le=>{console.log(" populateInputFromExcel called with:",le);const se={};le.forEach((ce,we)=>{const Te=we+1,Be=[];for(let nt=1;nt<ce.length;nt++){const vt=(ce[nt]||"").toString().trim();vt&&Be.push(vt)}const be={question:(ce[0]||"").toString().trim(),correctAnswer:Be[0]||"",correct_answers:Be};console.log(` Excel question ${Te} data:`,be),se[Te]=be}),D(ce=>({...ce,questions:se})),console.log(" Populated input questions from Excel:",se),r(`Successfully loaded ${le.length} questions from Excel file!`,"success"),J(),zt("input")},[J,r]),zt=C.useCallback(le=>{switch(console.log(` Reattaching form event listeners for test type: ${le}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(ce=>{ce.removeEventListener("input",()=>{}),ce.removeAttribute("data-listener-attached")}),le){case"multiple-choice":z();break;case"true-false":Y();break;case"input":J();break;default:console.warn("Unknown test type for event listener reattachment:",le)}console.log(` Form event listeners reattached for test type: ${le}`)},[z,Y,J]),qt=C.useCallback(()=>{const le=localStorage.getItem("test_creation_state");if(!le)return console.log(" No test creation state found in localStorage"),!1;try{const se=JSON.parse(le);console.log(" Found test creation state:",se);const ce=Date.now()-se.timestamp,we=1800*1e3;if(ce>we)return console.log(" Test creation state is too old, clearing it"),B(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),re(),se.excelState&&G(),se.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),d("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),y("multipleChoice"),d("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),y("trueFalse"),d("formCreation");break;case"inputForm":console.log(" Restoring input form step"),y("input"),d("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),d("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),d("typeSelection")}return O(se.currentStep),!0}catch(se){return console.error(" Error restoring test creation state:",se),B(),!1}},[B,re,G,O]);C.useEffect(()=>{console.log(" Initializing Teacher Tests..."),oe(),qt(),Ce(),Ht()},[oe,qt,Ce,Ht]),C.useEffect(()=>{T.numQuestions>0&&g&&g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{Ht()},100))},[T.numQuestions,g,Ht]);const Vt=le=>{console.log(" Test type selected:",le),console.log(" Setting testType to:",le),y(le),d("formCreation"),D({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),W("formCreation"),setTimeout(()=>{Ht()},100)},gr=(le,se)=>{D(ce=>({...ce,[le]:se}))},Fr=(le,se,ce)=>{D(we=>({...we,questions:{...we.questions,[le]:{...we.questions[le],[se]:ce}}}))},fr=(le,se,ce,we=0)=>{const Te={};for(let Be=1;Be<=ce;Be++)le==="multipleChoice"?Te[Be]={question:"",options:Array.from({length:we},()=>""),correctAnswer:""}:le==="trueFalse"?Te[Be]={question:"",correctAnswer:""}:le==="input"&&(Te[Be]={question:"",correct_answers:[""]});D(Be=>({...Be,questions:Te})),le==="multipleChoice"?(te("multiple-choice"),ee("multiple-choice")):le==="trueFalse"?(te("true-false"),ee("true-false")):le==="input"&&(te("input"),ee("input"))},cr=async()=>{if(!g||!T.testName||!T.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),W("testAssignment",T),d("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},Pr=(le,se,ce,we,Te)=>{K(ce?Be=>[...Be,{grade:le,class:se,subject_id:we,subject:Te}]:Be=>Be.filter(be=>!(be.grade===le&&be.class===se&&be.subject_id===we)))},Xr=C.useCallback(async le=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",le),console.log(" [DEBUG] Current formData:",T),console.log(" [DEBUG] Current testType:",g),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",c),_(!0);try{const se=le.blocks.map((Te,Be)=>{const be=le.words.find(Fe=>Fe.blockId===Te.id)?.word||`Word ${Be+1}`,nt=le.arrows.some(Fe=>Fe.startBlock===Te.id),vt=le.arrows.find(Fe=>Fe.startBlock===Te.id)||null;return{question_id:Be+1,word:be,block_coordinates:{x:Te.x,y:Te.y,width:Te.width,height:Te.height},has_arrow:nt,arrow:vt?{startX:vt.startX,startY:vt.startY,endX:vt.endX,endY:vt.endY,style:vt.style||{}}:null}}),ce={teacher_id:e.teacher_id,test_name:T.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:le.imageUrl,num_blocks:le.blocks.length,questions:se,assignments:[]};console.log(" Sending matching test payload:",ce);const we={...T,testName:ce.test_name,numQuestions:ce.num_blocks,numOptions:0,questions:se.reduce((Te,Be,be)=>(Te[be+1]={question:Be.word,correctAnswer:Be.word,options:[]},Te),{}),matchingTestData:le};console.log(" Assignment form data:",we),D(we),W("testAssignment",we),console.log(" Setting current step to testAssignment"),d("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(se){console.error(" Error saving matching test:",se),r("Failed to save matching test: "+se.message,"error")}finally{_(!1)}},[e,T,g,r,W]),ue=C.useCallback(()=>{console.log(" Cancelling matching test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ke=C.useCallback(async le=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",le),_(!0);try{D(se=>({...se,wordMatchingData:le,numQuestions:le.numQuestions||le.wordPairs?.length||0})),d("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(se){console.error("Error saving word matching test:",se),r("Failed to save word matching test: "+se.message,"error")}finally{_(!1)}},[r]),ge=C.useCallback(()=>{console.log(" Cancelling word matching test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ve=C.useCallback(async le=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",le),_(!0);try{D(se=>({...se,drawingData:le,numQuestions:le.num_questions||le.questions?.length||0})),d("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(se){console.error(" Error saving drawing test:",se),r("Error saving drawing test","error")}finally{_(!1)}},[r]),Se=C.useCallback(()=>{console.log(" Cancelling drawing test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ee=C.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),We=C.useCallback(async le=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",le),_(!0);try{D(se=>({...se,fillBlanksData:le,numQuestions:le.num_questions||le.blanks?.length||0})),d("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(se){console.error(" Error saving fill blanks test:",se),r("Error saving fill blanks test","error")}finally{_(!1)}},[r]),ut=C.useCallback(()=>{console.log(" Cancelling speaking test creation"),d("typeSelection"),D({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ge=C.useCallback(async le=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",le),_(!0);try{D(se=>({...se,speakingData:le,numQuestions:le.questions?.length||0})),d("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(se){console.error(" Error saving speaking test:",se),r("Error saving speaking test","error")}finally{_(!1)}},[r]);return l.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs(wi,{mode:"wait",children:[c==="typeSelection"&&l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs(Ze,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),l.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:le,title:se,description:ce,icon:we})=>l.jsx(Xe.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>Vt(le),children:l.jsxs(bt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"mb-3 flex justify-center",children:l.jsx("img",{src:we,alt:se,className:"w-12 h-12 object-contain"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:se}),l.jsx("p",{className:"text-sm text-gray-600",children:ce})]})},le))})]}),c==="formCreation"&&l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"flex space-x-2",children:l.jsx(Ze,{variant:"outline",onClick:q,children:" Back to Test Types"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",g==="multipleChoice"?"Multiple Choice":g==="trueFalse"?"True/False":g==="input"?"Input":g==="drawing"?"Drawing":g==="fillBlanks"?"Fill Blanks":g==="wordMatching"?"Word Matching":g==="speaking"?"Speaking":"Picture Matching"," Test"]}),l.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),l.jsx("input",{type:"text",value:T.testName,onChange:le=>gr("testName",le.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),g!=="matching"&&g!=="wordMatching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"50",value:T.numQuestions,onChange:le=>{const se=parseInt(le.target.value)||0;gr("numQuestions",se),se>0&&fr(g,T.testName,se,T.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),l.jsx("input",{type:"number",min:"2",max:"6",value:T.numOptions,onChange:le=>{const se=parseInt(le.target.value)||0;gr("numOptions",se),se>0&&se<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),T.numQuestions>0&&fr(g,T.testName,T.numQuestions,se)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!T.enableTimer,onChange:le=>gr("enableTimer",le.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),T.enableTimer&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),l.jsx("input",{type:"number",min:"1",max:"1440",value:T.timerMinutes,onChange:le=>gr("timerMinutes",le.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]}),g!=="drawing"&&g!=="matching"&&g!=="fillBlanks"&&l.jsxs("label",{className:"inline-flex items-center space-x-2 ml-6",children:[l.jsx("input",{type:"checkbox",checked:!!T.isShuffled,onChange:le=>gr("isShuffled",le.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})]})]})}),g==="matching"&&l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),l.jsx(IL,{testName:T.testName,onTestSaved:Xr,onCancel:ue,onBackToCabinet:Ye,isSaving:k,validationErrors:{}})]})}),g==="wordMatching"&&l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),l.jsx(MW,{testName:T.testName,onTestSaved:ke,onCancel:ge,onBackToCabinet:Ye,isSaving:k,validationErrors:{}})]})}),g==="drawing"&&l.jsxs("div",{className:"drawing-test-section",children:[console.log(" Rendering DrawingTestCreator, testType:",g),l.jsx(TW,{testName:T.testName,onTestSaved:ve,onCancel:Se,onBackToCabinet:Ye,isSaving:k,validationErrors:{}})]}),g==="fillBlanks"&&l.jsxs("div",{className:"fill-blanks-test-section",children:[console.log(" Rendering FillBlanksTestCreator, testType:",g),l.jsx(jW,{testName:T.testName,allowedTime:T.enableTimer&&parseInt(T.timerMinutes)||null,onTestSaved:We,onCancel:Ee,onBackToCabinet:Ye,isSaving:k,validationErrors:{}})]}),g==="speaking"&&l.jsxs("div",{className:"speaking-test-section",children:[console.log(" Rendering SpeakingTestCreator, testType:",g),l.jsx(FW,{testName:T.testName,onTestSaved:Ge,onCancel:ut,onBackToCabinet:Ye,isSaving:k,validationErrors:{}})]}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&g!=="speaking"&&T.numQuestions>0&&l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),l.jsxs("div",{className:"space-y-6",children:[g==="multipleChoice"&&lt.multipleChoice?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Multiple Choice Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),l.jsx("div",{children:"Column 3: Option A text"}),l.jsx("div",{children:"Column 4: Option B text"}),l.jsx("div",{children:"Column 5: Option C text"}),l.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),g==="trueFalse"&&lt.trueFalse?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-xs text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),g==="input"&&lt.input?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:N,children:N?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Input Test Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Answer 1"}),l.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),g!=="matching"&&g!=="drawing"&&g!=="fillBlanks"&&T.numQuestions>0&&l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),T.numQuestions>0&&l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),l.jsx("div",{className:"space-y-6",children:Object.keys(T.questions).map(le=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",le]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),l.jsx("textarea",{value:T.questions[le]?.question||"",onChange:se=>Fr(le,"question",se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text"})]}),g==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),l.jsx("div",{className:"space-y-2",children:T.questions[le]?.options?.map((se,ce)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+ce),":"]}),l.jsx("input",{type:"text",value:se,onChange:we=>{const Te=[...T.questions[le].options];Te[ce]=we.target.value,Fr(le,"options",Te)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+ce)}`})]},ce))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),g==="multipleChoice"?l.jsx("div",{children:l.jsxs("select",{value:T.questions[le]?.correctAnswer||"",onChange:se=>Fr(le,"correctAnswer",se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),T.questions[le]?.options?.map((se,ce)=>l.jsx("option",{value:String.fromCharCode(65+ce),children:String.fromCharCode(65+ce)},ce))]})}):g==="trueFalse"?l.jsxs("select",{value:T.questions[le]?.correctAnswer||"",onChange:se=>Fr(le,"correctAnswer",se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"true",children:"True"}),l.jsx("option",{value:"false",children:"False"})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),l.jsxs("div",{className:"space-y-2",children:[l.jsx("input",{type:"text",value:T.questions[le]?.correct_answers?.[0]||"",onChange:se=>{const we=[...T.questions[le]?.correct_answers||[""]];we[0]=se.target.value,Fr(le,"correct_answers",we)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer"}),T.questions[le]?.correct_answers?.slice(1).map((se,ce)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"text",value:se,onChange:we=>{const Te=[...T.questions[le]?.correct_answers||[]];Te[ce+1]=we.target.value,Fr(le,"correct_answers",Te)},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${ce+2}`}),l.jsx("button",{type:"button",onClick:()=>{const we=[...T.questions[le]?.correct_answers||[]];we.splice(ce+1,1),Fr(le,"correct_answers",we)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},ce))||[],l.jsx("button",{type:"button",onClick:()=>{const ce=[...T.questions[le]?.correct_answers||[""],""];Fr(le,"correct_answers",ce)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},le))})]})}),T.testName&&T.numQuestions>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(Ze,{onClick:cr,disabled:k,className:"px-8",children:k?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&l.jsxs(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs(Ze,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),l.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),l.jsx(Ze,{variant:"outline",onClick:()=>d("formCreation"),children:" Back to Test Form"})]}),l.jsx(bt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),v.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),l.jsx("div",{className:"mt-4",children:l.jsx(Ze,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):l.jsx("div",{className:"space-y-6",children:v.map(le=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:le.subject}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:le.classes.map(se=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:I.some(ce=>ce.grade===se.grade&&ce.class===se.class&&ce.subject_id===le.subject_id),onChange:ce=>Pr(se.grade,se.class,ce.target.checked,le.subject_id,le.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[se.grade,"/",se.class]})]},`${se.grade}-${se.class}-${le.subject_id}`))})]},le.subject_id))})]})}),I.length>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(Ze,{onClick:()=>He(g,null),disabled:b,className:"px-8",children:b?l.jsxs(l.Fragment,{children:[l.jsx(Tr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${I.length} Class${I.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",P),P&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),k&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(le=>l.jsx(Vo,{type:le.type,message:le.message,duration:le.duration,onClose:()=>n(le.id)},le.id))})]})},Xte=({onDataLoaded:e,onError:t})=>{const r=Ti(),{user:n,isAuthenticated:s}=Mn(),{teacherData:a,loadTeacherData:i}=Qy(),[o,c]=C.useState(!0),[d,f]=C.useState(""),[p,g]=C.useState([]),[y,v]=C.useState(null),[w,b]=C.useState([]),[E,k]=C.useState([]),[_,N]=C.useState([]),[A,P]=C.useState(null),[R,T]=C.useState(0);C.useEffect(()=>{oe()},[]),C.useCallback(async re=>{console.log(" Teacher login attempt...");try{const M=await xn.teacherLogin(re);if(M.success)return Z("Login successful!","success"),await D(),M;throw new Error(M.error||"Login failed")}catch(M){throw console.error(" Teacher login error:",M),Z("Login failed. Please check your credentials.","error"),M}},[]);const D=C.useCallback(async()=>{console.log(" Loading teacher data...");try{if(c(!0),f(""),!s||!n){console.log(" User not authenticated"),f("User not authenticated");return}if(n.role!==ri.TEACHER){console.error(" Invalid user role for teacher data:",n.role),f("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const re=await xn.getTeacherData();if(re&&re.success)console.log(" Teacher data loaded successfully:",re),v(re.teacher||n),re.subjects&&(b(re.subjects),console.log(" Teacher subjects loaded:",re.subjects.length)),re.grades&&k(re.grades),re.classes&&N(re.classes),P(new Date),T(M=>M+1),e&&e(re),Z("Teacher data loaded successfully!","success");else throw new Error(re?.error||"Failed to load teacher data")}catch(re){console.error(" Error loading teacher data:",re);const M=re.message||"Failed to load teacher data";f(M),t&&t(re),Z(M,"error")}finally{c(!1)}},[s,n,e,t]),I=C.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);C.useCallback(re=>{console.log(" Showing main cabinet with subjects:",re),re&&b(re),r("/teacher/cabinet")},[r]);const K=C.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(M=>({id:M,name:`Grade ${M}`,classes:X(M)}))),[]),X=C.useCallback(re=>Array.from({length:10},(W,B)=>B+1).map(W=>({id:`${re}-${W}`,name:`Class ${W}`,grade:re,classNumber:W})),[]),Z=C.useCallback((re,M)=>{const W={id:Date.now(),message:re,type:M,timestamp:new Date};g(B=>[...B,W]),setTimeout(()=>{g(B=>B.filter(G=>G.id!==W.id))},vi.NOTIFICATION_DURATION)},[]),oe=C.useCallback(async()=>{console.log(" Initializing teacher data..."),await D()},[D]),q=C.useCallback(async()=>{console.log(" Refreshing teacher data..."),await D()},[D]);return C.useCallback(async re=>{console.log(" Updating teacher profile:",re);try{const M=await xn.updateUserProfile(re);if(M.success)return v(W=>({...W,...re})),Z("Profile updated successfully!","success"),M;throw new Error(M.error||"Failed to update profile")}catch(M){throw console.error(" Error updating teacher profile:",M),Z("Failed to update profile","error"),M}},[]),C.useCallback(async re=>{console.log(" Changing teacher password...");try{const M=await xn.changePassword(re);if(M.success)return Z("Password changed successfully!","success"),M;throw new Error(M.error||"Failed to change password")}catch(M){throw console.error(" Error changing teacher password:",M),Z("Failed to change password","error"),M}},[]),o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):d?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:d}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx(Ze,{variant:"primary",onClick:q,children:"Retry"}),l.jsx(Ze,{variant:"outline",onClick:I,children:"Go Back"})]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",A?A.toLocaleString():"Never"," | Version: ",R]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:q,children:"Refresh Data"}),l.jsx(Ze,{variant:"outline",onClick:I,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),y?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.name||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.username||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.email||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),l.jsx("p",{className:"text-sm text-gray-900",children:y.role||"N/A"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",w.length,")"]}),w.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:w.map((re,M)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:re.name}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:re.description||"No description"}),re.classes&&re.classes.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:re.classes.map((W,B)=>l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[W.grade," - ",W.className]},B))})]})]},M))}):l.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:K().map(re=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:re.name}),l.jsx("div",{className:"grid grid-cols-5 gap-1",children:re.classes.map(M=>l.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",M),children:M.classNumber},M.id))})]},re.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:w.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-green-600",children:E.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:_.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:R}),l.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:p.map(re=>l.jsx(Vo,{type:re.type,message:re.message,onClose:()=>g(M=>M.filter(W=>W.id!==re.id))},re.id))})]})},Yte=({onBackToCabinet:e})=>{const t=Ti(),{user:r,isAuthenticated:n}=Mn(),{teacherData:s}=Qy(),[a,i]=C.useState(!0),[o,c]=C.useState(""),[d,f]=C.useState([]),[p,g]=C.useState([]),[y,v]=C.useState([]),[w,b]=C.useState([]),[E,k]=C.useState(null),[_,N]=C.useState([]),[A,P]=C.useState(!1),[R,T]=C.useState(!1),[D,I]=C.useState(!1),[K,X]=C.useState(!1),[Z,oe]=C.useState(null),[q,re]=C.useState(!0),[M,W]=C.useState(null);C.useEffect(()=>{Ve()},[]),C.useCallback(tt=>{console.log(" Rendering existing subjects:",tt),g(tt)},[]);const B=C.useCallback(()=>{console.log(" Showing subject selection prompt..."),P(!0),re(!1),G()},[]),G=C.useCallback(async()=>{console.log(" Loading existing subjects...");try{const tt=await xn.getTeacherSubjects();tt.success&&tt.subjects&&tt.subjects.length>0?(console.log(" Existing subjects found:",tt.subjects),H(tt.subjects)):(console.log(" No existing subjects found"),b([]))}catch(tt){console.error(" Error loading existing subjects:",tt),ot("Failed to load existing subjects","error")}},[]),H=C.useCallback(tt=>{console.log(" Rendering subject selection:",tt);const Le=[];tt.forEach(De=>{De.classes&&Array.isArray(De.classes)&&De.classes.forEach(Je=>{Le.push({id:`${De.subject_id}-${Je.grade}-${Je.class}`,subjectId:De.subject_id,subjectName:De.subject,grade:Je.grade,class:Je.class,displayText:`${De.subject} - ${Je.grade}/${Je.class}`})})}),b(Le),console.log(" Processed subjects for selection:",Le)},[]),O=C.useCallback(async tt=>{if(console.log(" Saving teacher subjects:",tt),!tt||tt.length===0){ot("Please select at least one subject and class combination.","warning");return}try{const Le=tt.reduce((Je,_t)=>{const ht=Je.find(It=>It.subject_id===_t.subjectId);return ht?ht.classes.push({grade:_t.grade,class:_t.class}):Je.push({subject_id:_t.subjectId,classes:[{grade:_t.grade,class:_t.class}]}),Je},[]);console.log(" Transformed data for backend:",Le);const De=await xn.saveTeacherSubjects(Le);if(De.success)ot("Subjects saved successfully!","success"),P(!1),re(!0),W(new Date),await G();else throw new Error(De.error||"Failed to save subjects")}catch(Le){console.error(" Error saving subjects:",Le),ot("Error saving subjects. Please try again.","error")}},[]),z=C.useCallback(()=>{console.log(" Toggling subject dropdown..."),T(tt=>!tt),I(!1)},[]),Y=C.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const tt=await xn.getAllSubjects();if(tt.success)v(tt.subjects||[]),console.log(" Available subjects loaded:",tt.subjects?.length||0);else throw new Error(tt.error||"Failed to load subjects")}catch(tt){console.error(" Error loading subjects for dropdown:",tt),ot("Failed to load subjects","error")}},[]),J=C.useCallback(tt=>{console.log(" Subject selected:",tt);const Le=y.find(De=>De.subject_id===parseInt(tt));Le&&(k(Le),I(!0),T(!1),te())},[y]),te=C.useCallback(()=>{console.log(" Loading grades and classes...")},[]),ee=C.useCallback((tt,Le)=>{console.log(" Saving classes for subject:",tt,Le);const De={id:`${tt.subject_id}-${Date.now()}`,subjectId:tt.subject_id,subjectName:tt.subject,grade:Le.grade,class:Le.class,displayText:`${tt.subject} - ${Le.grade}/${Le.class}`};b(Je=>[...Je,De]),k(null),N([]),I(!1),me(`Added ${tt.subject} for ${Le.grade}/${Le.class}`)},[]),ie=C.useCallback(()=>{console.log(" Resetting subject selection..."),k(null),N([]),T(!1),I(!1)},[]),me=C.useCallback(tt=>{console.log(" Showing message:",tt),ot(tt,"success")},[]),Ce=C.useCallback(tt=>{console.log(" Showing confirmation modal:",tt),oe(tt),X(!0)},[]),Oe=C.useCallback(()=>{console.log(" Hiding confirmation modal..."),X(!1),oe(null)},[]),fe=C.useCallback(()=>{console.log(" Confirming save subjects..."),Oe(),O(w)},[w,O,Oe]),pe=C.useCallback(()=>{console.log(" Cancelling save subjects..."),Oe()},[Oe]),He=C.useCallback(tt=>{console.log(" Removing subject:",tt),b(Le=>Le.filter(De=>De.id!==tt)),ot("Subject removed","info")},[]);C.useCallback(()=>{console.log(" Showing edit subjects button..."),re(!0)},[]),C.useCallback(()=>{console.log(" Hiding edit subjects button..."),re(!1)},[]);const Ye=C.useCallback(tt=>{console.log(" Generating class buttons for grade:",tt);let Le;return tt===1||tt===2?Le=["15","16"]:tt===3?Le=["15","16"]:tt===4?Le=["13","14"]:tt===5||tt===6?Le=["13","14"]:Le=[],Le.map(De=>({id:`${tt}-${De}`,grade:tt,class:De,displayText:`${tt}/${De}`}))},[]);C.useCallback((tt,Le)=>{console.log(" Showing class results:",tt,Le),t("/teacher/results")},[t]);const ot=C.useCallback((tt,Le)=>{const De={id:Date.now(),message:tt,type:Le,timestamp:new Date};f(Je=>[...Je,De]),setTimeout(()=>{f(Je=>Je.filter(_t=>_t.id!==De.id))},vi.NOTIFICATION_DURATION)},[]),Ve=C.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log(" User not authenticated"),c("User not authenticated");return}if(r.role!==ri.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await G(),await Y(),console.log(" Teacher subjects initialization complete!")}catch(tt){console.error(" Error initializing teacher subjects:",tt),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,G,Y]),Rt=C.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Tr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:o}),l.jsx(Ze,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",M?M.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[q&&l.jsx(Ze,{variant:"primary",onClick:B,children:"Edit Subjects"}),l.jsx(Ze,{variant:"outline",onClick:Rt,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[!A&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs(Ze,{variant:"primary",onClick:B,className:"px-6 py-2",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),p.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:p.map((tt,Le)=>l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:tt.subject}),tt.classes&&tt.classes.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:tt.classes.map((De,Je)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",De.grade," - Class ",De.class]},Je))})]})]}),l.jsx("div",{className:"ml-4",children:l.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>He(tt.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},Le))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),l.jsxs(Ze,{variant:"primary",onClick:B,className:"px-6 py-3",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),A&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs(Ze,{variant:"outline",onClick:z,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:E?E.subject:"Select a subject"}),l.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),R&&l.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:y.map(tt=>l.jsx("button",{onClick:()=>J(tt.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:l.jsx("span",{className:"text-gray-900 font-medium",children:tt.subject})},tt.subject_id))})]})]}),D&&E&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",E.subject]}),l.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(tt=>l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:l.jsx("span",{className:"text-white font-bold text-xs",children:tt})}),l.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",tt]})]}),l.jsx("div",{className:"space-y-3",children:Ye(tt).map(Le=>l.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>ee(E,Le),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:Le.displayText},Le.id))})]},tt))})]}),w.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:w.map(tt=>l.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex-1",children:l.jsx("span",{className:"text-sm font-semibold text-purple-900",children:tt.displayText})}),l.jsx(Ze,{variant:"outline",size:"sm",onClick:()=>He(tt.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},tt.id))})]}),l.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[l.jsx("div",{className:"text-sm text-gray-500",children:w.length>0?`${w.length} subject${w.length>1?"s":""} selected`:"No subjects selected"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs(Ze,{variant:"outline",onClick:()=>{P(!1),re(!0),ie()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),l.jsxs(Ze,{variant:"primary",onClick:()=>Ce({type:"save",data:w}),disabled:w.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),D?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),K&&l.jsx(Bo,{isOpen:K,onClose:Oe,title:"Confirm Save",variant:"confirmation",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",Z?.data?.length||0," subject assignments?"]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(Ze,{variant:"outline",onClick:pe,children:"Cancel"}),l.jsx(Ze,{variant:"primary",onClick:fe,children:"Save"})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(tt=>l.jsx(Vo,{type:tt.type,message:tt.message,onClose:()=>f(Le=>Le.filter(De=>De.id!==tt.id))},tt.id))})]})},Qte=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=Mn(),[s,a]=C.useState("cabinet");return!r||t!=="teacher"?l.jsx(t0,{to:"/login",replace:!0}):n?l.jsxs("div",{className:"teacher-app-loading",children:[l.jsx(Tr,{}),l.jsx("p",{children:"Loading teacher interface..."})]}):l.jsx("div",{className:"teacher-app",children:l.jsxs(w2,{children:[l.jsx(ts,{path:"/",element:l.jsx(S3,{})}),l.jsx(ts,{path:"/cabinet",element:l.jsx(S3,{})}),l.jsx(ts,{path:"/tests",element:l.jsx(k3,{})}),l.jsx(ts,{path:"/tests/create",element:l.jsx(k3,{})}),l.jsx(ts,{path:"/data",element:l.jsx(Xte,{})}),l.jsx(ts,{path:"/subjects",element:l.jsx(Yte,{})}),l.jsx(ts,{path:"/results",element:l.jsx(uP,{})}),l.jsx(ts,{path:"*",element:l.jsx(t0,{to:"/teacher",replace:!0})})]})})},Pe={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},Jte=()=>{const{user:e,isAdmin:t,logout:r}=Mn(),{get:n,post:s,delete:a}=Wi(),i=C.useCallback(async()=>{try{y({type:"info",message:"Refreshing class summary view..."});const ae=await s("/.netlify/functions/refresh-class-summary-semester",{});ae&&(ae.success||ae.message)?y({type:"success",message:"Class summary view refreshed."}):y({type:"error",message:ae?.error||"Failed to refresh view"})}catch(ae){y({type:"error",message:"Failed to refresh view"}),console.error("Refresh class summary error:",ae)}},[s]),o=C.useCallback(async()=>{try{y({type:"info",message:"Checking for overdue assignments..."});const ae=await s("/.netlify/functions/check-overdue-assignments",{});if(ae&&ae.success){const Ne=ae.overdue_count||0;Ne>0?y({type:"success",message:`Found and marked ${Ne} overdue assignments as inactive.`}):y({type:"info",message:"No overdue assignments found."})}else y({type:"error",message:ae?.error||"Failed to check assignments"})}catch(ae){y({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",ae)}},[s]),[c,d]=C.useState(!1),[f,p]=C.useState(null),[g,y]=C.useState(null),[v,w]=C.useState(!1),[b,E]=C.useState(!1),[k,_]=C.useState(!1),[N,A]=C.useState(!1),[P,R]=C.useState(""),[T,D]=C.useState(null),[I,K]=C.useState({}),[X,Z]=C.useState(null),[oe,q]=C.useState({}),[re,M]=C.useState(null),[W,B]=C.useState({}),[G,H]=C.useState([]),[O,z]=C.useState(""),[Y,J]=C.useState(""),[te,ee]=C.useState(""),[ie,me]=C.useState(!0),[Ce,Oe]=C.useState(!1),[fe,pe]=C.useState([]),[He,Ye]=C.useState(""),[ot,Ve]=C.useState(""),[Rt,tt]=C.useState(""),[Le,De]=C.useState(!1),[Je,_t]=C.useState(!1),[ht,It]=C.useState([]),[Mt,rt]=C.useState([]),[qe,pt]=C.useState([]),[lt,wt]=C.useState([]),[Lt,Ht]=C.useState(!1),[Ie,at]=C.useState(!1),[gt,At]=C.useState(!1),[Ot,Jt]=C.useState(!1),[Ae,ye]=C.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[he,_e]=C.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[$e,St]=C.useState({subject_id:"",subject:"",description:"",is_active:!0}),[ct,zt]=C.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});C.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),qt()},[]),C.useEffect(()=>{const ae=Ne=>{Le&&!Ne.target.closest(".admin-menu")&&De(!1)};return document.addEventListener("mousedown",ae),()=>{document.removeEventListener("mousedown",ae)}},[Le]);const qt=C.useCallback(async()=>{try{d(!0),await fr(),console.log("Admin app initialized")}catch(ae){p("Failed to initialize admin app"),console.error("Admin app initialization error:",ae)}finally{d(!1)}},[]),Vt=C.useCallback(()=>{De(ae=>!ae)},[]),gr=C.useCallback(()=>{_t(!0),De(!1)},[]),Fr=C.useCallback(()=>{_t(!1)},[]),fr=C.useCallback(async()=>{try{await Promise.all([cr(),Pr(),Xr(),ue()])}catch(ae){console.error("Error loading admin data:",ae),p("Failed to load admin data")}},[]),cr=C.useCallback(async()=>{try{const ae="admin_users_",Ne=En(ae);if(Ne){console.log(" Using cached users data"),It(Ne);return}const dt=await n("/.netlify/functions/get-all-users");console.log(" Users response:",dt);const Ct=dt.users||[];It(Ct),Nn(ae,Ct,Fn.admin_users),console.log(" Users set to state:",Ct)}catch(ae){console.error("Error loading users:",ae)}},[n]),Pr=C.useCallback(async()=>{try{const ae="admin_teachers_",Ne=En(ae);if(Ne){console.log(" Using cached teachers data"),rt(Ne);return}const dt=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",dt);const Ct=dt.teachers||[];rt(Ct),Nn(ae,Ct,Fn.admin_teachers),console.log(" Teachers set to state:",Ct)}catch(ae){console.error("Error loading teachers:",ae)}},[n]),Xr=C.useCallback(async()=>{try{const ae="admin_subjects_",Ne=En(ae);if(Ne){console.log(" Using cached subjects data"),pt(Ne);return}const dt=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",dt);const Ct=dt.subjects||[];pt(Ct),Nn(ae,Ct,Fn.admin_subjects),console.log(" Subjects set to state:",Ct)}catch(ae){console.error("Error loading subjects:",ae)}},[n]),ue=C.useCallback(async()=>{try{const ae="admin_academic_years_",Ne=En(ae);if(Ne){console.log(" Using cached academic years data"),wt(Ne);return}const Ct=(await n("/.netlify/functions/get-academic-year")).academic_years||[];wt(Ct),Nn(ae,Ct,Fn.admin_academic_years)}catch(ae){console.error("Error loading academic year:",ae)}},[n]),ke=C.useCallback(async()=>{try{if(A(!N),!N){const[ae,Ne]=await Promise.all([n("/.netlify/functions/get-all-tests"),n("/.netlify/functions/get-test-assignments")]);console.log(" Active tests response:",ae),console.log(" Assignments response:",Ne);const dt=ae.tests||[],Dr=(Ne.assignments||[]).reduce((fn,wo)=>{const oi=`${wo.test_type}-${wo.test_id}`;return fn[oi]||(fn[oi]=[]),fn[oi].push(wo),fn},{}),_r=dt.map(fn=>{const wo=`${fn.test_type}-${fn.test_id}`,oi=Dr[wo]||[],Us=oi.some(bn=>bn.is_active);return{...fn,is_active:Us,assignments:oi}});H(_r),console.log(" All tests with status set to state:",_r)}}catch(ae){console.error("Error loading tests:",ae),y({type:"error",message:"Failed to load tests"})}},[n,N]),ge=C.useCallback((ae,Ne)=>{ye(dt=>({...dt,[ae]:Ne}))},[]),ve=C.useCallback((ae,Ne)=>{_e(dt=>({...dt,[ae]:Ne}))},[]),Se=C.useCallback((ae,Ne)=>{St(dt=>({...dt,[ae]:Ne}))},[]);C.useCallback(()=>{console.log(" Testing local storage...");try{const ae={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(ae));const Ne=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",Ne),y({type:"success",message:"Local storage test successful"})}catch(ae){console.error(" Local storage test failed:",ae),y({type:"error",message:"Local storage test failed"})}},[]),C.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),y({type:"success",message:"Local storage cleared"})}catch(ae){console.error(" Error clearing local storage:",ae),y({type:"error",message:"Error clearing local storage"})}},[]),C.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const Ne=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",Ne),y({type:"success",message:`Found ${Ne.length} teachers`})}catch(ae){console.error(" Error checking teacher subjects:",ae),y({type:"error",message:"Error checking teacher subjects"})}},[n]);const Ee=C.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting user:",Ae);const Ne=await s("/.netlify/functions/add-user",Ae);Ne.success?(y({type:"success",message:"User added successfully"}),Ht(!1),ye({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),cr()):y({type:"error",message:Ne.message||"Failed to add user"})}catch(Ne){console.error(" Error adding user:",Ne),y({type:"error",message:"Error adding user"})}},[Ae,s,cr]),We=C.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting teacher:",he);const Ne=await s("/.netlify/functions/add-teacher",he);Ne.success?(y({type:"success",message:"Teacher added successfully"}),at(!1),_e({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),Pr()):y({type:"error",message:Ne.message||"Failed to add teacher"})}catch(Ne){console.error(" Error adding teacher:",Ne),y({type:"error",message:"Error adding teacher"})}},[he,s,Pr]),ut=C.useCallback(async ae=>{ae.preventDefault();try{console.log(" Submitting subject:",$e);const Ne=await s("/.netlify/functions/add-subject",$e);Ne.success?(y({type:"success",message:"Subject added successfully"}),At(!1),St({subject_id:"",subject:"",description:"",is_active:!0}),Xr()):y({type:"error",message:Ne.message||"Failed to add subject"})}catch(Ne){console.error(" Error adding subject:",Ne),y({type:"error",message:"Error adding subject"})}},[$e,s,Xr]),Ge=C.useCallback(ae=>{D(ae),K({name:ae.name||"",surname:ae.surname||"",grade:ae.grade||"",class:ae.class||"",student_id:ae.student_id||"",nickname:ae.nickname||"",password:ae.password||"",is_active:ae.is_active!==void 0?ae.is_active:!0})},[]),le=C.useCallback(async()=>{try{const ae=[];Object.keys(I).forEach(Ne=>{Ne!=="student_id"&&I[Ne]!==T[Ne]&&ae.push({fieldName:Ne,newValue:I[Ne]})});for(const Ne of ae)await s("/.netlify/functions/update-user",{userId:T.student_id,fieldName:Ne.fieldName,newValue:Ne.newValue});y({type:"success",message:"User updated successfully!"}),D(null),K({}),cr()}catch{y({type:"error",message:"Failed to update user"})}},[I,T,s,cr]),se=C.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:ae})).success&&(y({type:"success",message:"User deleted successfully!"}),cr())}catch{y({type:"error",message:"Failed to delete user"})}},[s,cr]),ce=C.useCallback(ae=>{Z(ae),q({teacher_id:ae.teacher_id||"",username:ae.username||"",password:ae.password||"",first_name:ae.first_name||"",last_name:ae.last_name||"",is_active:ae.is_active!==void 0?ae.is_active:!0})},[]),we=C.useCallback(async()=>{try{const ae=[];Object.keys(oe).forEach(Ne=>{Ne!=="teacher_id"&&oe[Ne]!==X[Ne]&&ae.push({fieldName:Ne,newValue:oe[Ne]})});for(const Ne of ae)await s("/.netlify/functions/update-teacher",{teacherId:X.teacher_id,fieldName:Ne.fieldName,newValue:Ne.newValue});y({type:"success",message:"Teacher updated successfully!"}),Z(null),q({}),Pr()}catch{y({type:"error",message:"Failed to update teacher"})}},[oe,X,s,Pr]),Te=C.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:ae})).success&&(y({type:"success",message:"Teacher deleted successfully!"}),Pr())}catch{y({type:"error",message:"Failed to delete teacher"})}},[s,Pr]),Be=C.useCallback(ae=>{M(ae),B({subject_id:ae.subject_id||"",subject:ae.subject||""})},[]),be=C.useCallback(async()=>{try{const ae=[];Object.keys(W).forEach(Ne=>{Ne!=="subject_id"&&W[Ne]!==re[Ne]&&ae.push({fieldName:Ne,newValue:W[Ne]})});for(const Ne of ae)await s("/.netlify/functions/update-subject",{subjectId:re.subject_id,fieldName:Ne.fieldName,newValue:Ne.newValue});y({type:"success",message:"Subject updated successfully!"}),M(null),B({}),Xr()}catch{y({type:"error",message:"Failed to update subject"})}},[W,re,s,Xr]),nt=C.useCallback(async ae=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const Ne=await s("/.netlify/functions/delete-subject",{subjectId:ae});Ne.success?(y({type:"success",message:"Subject deleted successfully!"}),Xr()):y({type:"error",message:Ne.message||"Failed to delete subject"})}catch{y({type:"error",message:"Failed to delete subject"})}},[s,Xr]),vt=C.useCallback((ae,Ne)=>{zt(dt=>({...dt,[ae]:Ne}))},[]),Fe=C.useCallback(async ae=>{if(ae.preventDefault(),!ct.startDate||!ct.endDate||!ct.teacherId){y({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const Ne=await s("/.netlify/functions/delete-test-data",ct);Ne.success?(y({type:"success",message:`Successfully deleted ${Ne.deletedCount} test records!`}),Jt(!1),zt({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):y({type:"error",message:Ne.message||"Failed to delete test data"})}catch{y({type:"error",message:"Failed to delete test data"})}},[ct,s]),mt=C.useCallback(async(ae,Ne,dt)=>{try{const Ct=await n("/.netlify/functions/get-test-assignments");if(Ct.success&&Ct.assignments){const Dr=Ct.assignments.filter(_r=>_r.test_id===parseInt(ae)&&_r.test_type===Ne);if(Dr.length===0){y({type:"error",message:"No assignments found for this test"});return}for(const _r of Dr){const fn=await s("/.netlify/functions/remove-assignment",{teacher_id:dt,assignment_id:_r.assignment_id,test_type:Ne,test_id:ae});if(!fn.success){y({type:"error",message:`Failed to complete test: ${fn.message}`});return}}y({type:"success",message:"Test marked as complete successfully!"}),await ke()}else y({type:"error",message:"Failed to get test assignments"})}catch(Ct){console.error("Error completing test:",Ct),y({type:"error",message:"Failed to complete test"})}},[s,n,ke]),Xt=C.useCallback(async(ae,Ne,dt)=>{try{const Ct=await n("/.netlify/functions/get-test-assignments");if(Ct.success&&Ct.assignments){const Dr=Ct.assignments.filter(_r=>_r.test_id===parseInt(ae)&&_r.test_type===Ne);if(Dr.length===0){y({type:"error",message:"No assignments found for this test"});return}for(const _r of Dr){const fn=await s("/.netlify/functions/remove-assignment",{teacher_id:dt,assignment_id:_r.assignment_id,test_type:Ne,test_id:ae,mark_active:!0});if(!fn.success){y({type:"error",message:`Failed to reactivate test: ${fn.message}`});return}}y({type:"success",message:"Test marked as active successfully!"}),await ke()}else y({type:"error",message:"Failed to get test assignments"})}catch(Ct){console.error("Error reactivating test:",Ct),y({type:"error",message:"Failed to reactivate test"})}},[s,n,ke]),Rr=C.useCallback(async()=>{try{if(Oe(!Ce),!Ce){const ae=await n("/.netlify/functions/get-all-tests");console.log(" Actual tests response:",ae),pe(ae.tests||[]),console.log(" Actual tests set to state:",ae.tests||[])}}catch(ae){console.error("Error loading actual tests:",ae),y({type:"error",message:"Failed to load tests"})}},[n,Ce]),Ar=C.useCallback(async(ae,Ne,dt)=>{try{const Ct=await s("/.netlify/functions/delete-test",{test_id:ae,test_type:Ne,teacher_id:dt});Ct.success?(y({type:"success",message:"Test deleted successfully!"}),await Rr()):y({type:"error",message:`Failed to delete test: ${Ct.message}`})}catch(Ct){console.error("Error deleting test:",Ct),y({type:"error",message:"Failed to delete test"})}},[s,Rr]),hr=P?ht.filter(ae=>ae.grade.toString()===P):ht,er=G.filter(ae=>{const Ne=!O||ae.teacher_id===O,dt=!Y||new Date(ae.created_at)>=new Date(Y),Ct=!te||new Date(ae.created_at)<=new Date(te+"T23:59:59"),Dr=ie?ae.is_active:!ae.is_active;return Ne&&dt&&Ct&&Dr}),Kt=fe.filter(ae=>{const Ne=!He||ae.teacher_id===He,dt=!ot||new Date(ae.created_at)>=new Date(ot),Ct=!Rt||new Date(ae.created_at)<=new Date(Rt+"T23:59:59");return Ne&&dt&&Ct});return l.jsxs(Xe.div,{id:"admin-cabinet-main",className:Pe.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Xe.div,{className:Pe.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:Pe.headerContent,children:l.jsxs("div",{className:Pe.headerFlex,children:[l.jsxs(Xe.div,{className:Pe.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Xe.div,{className:Pe.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:Pe.adminText,children:e?.username||"Administrator"}),l.jsx("p",{className:Pe.adminSubtext,children:"Administrator Dashboard"})]})]}),l.jsxs(Xe.div,{className:Pe.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:Vt,className:Pe.menuButton,style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(Xe.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Le?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(wi,{children:Le&&l.jsx(Xe.div,{className:Pe.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(Xe.button,{onClick:gr,className:Pe.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(Xe.button,{onClick:()=>{Vt(),r()},className:Pe.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),c&&l.jsx(Tr,{text:"Loading..."}),f&&l.jsx(Vo,{type:"error",message:f,onClose:()=>p(null)}),g&&l.jsx(Vo,{type:g.type,message:g.message,onClose:()=>y(null)}),Je&&l.jsx("div",{className:Pe.modalOverlay,children:l.jsxs("div",{className:Pe.modalContent,children:[l.jsx("h2",{className:Pe.modalTitle,children:"Change Password"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{htmlFor:"currentPassword",className:Pe.formLabel,children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",className:Pe.formInput})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{htmlFor:"newPassword",className:Pe.formLabel,children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",className:Pe.formInput})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{htmlFor:"confirmPassword",className:Pe.formLabel,children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",className:Pe.formInput})]}),l.jsxs("div",{className:Pe.modalActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:Fr,className:"flex-1",children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),l.jsx(Xe.div,{className:Pe.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:l.jsxs("div",{className:"space-y-6",children:[l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsx(bt.Header,{className:Pe.cardHeader,children:l.jsx(bt.Title,{className:Pe.cardTitle,children:"User Management"})}),l.jsxs(bt.Body,{className:Pe.cardBody,children:[l.jsxs("div",{className:Pe.buttonGroup,children:[l.jsx(Ze,{variant:"primary",onClick:()=>Ht(!0),className:Pe.buttonPrimary,children:"Add User"}),l.jsx(Ze,{variant:"secondary",onClick:()=>{cr(),w(!v)},className:Pe.buttonSecondary,children:v?"Hide Users Table":"Get All Users "})]}),l.jsx(wi,{children:Lt&&l.jsxs(Xe.div,{className:Pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),l.jsxs("form",{onSubmit:Ee,className:"space-y-4",children:[l.jsxs("div",{className:Pe.formGrid,children:[l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Grade"}),l.jsx("input",{type:"text",value:Ae.grade,onChange:ae=>ge("grade",ae.target.value),className:Pe.formInput,placeholder:"Enter grade"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Class"}),l.jsx("input",{type:"text",value:Ae.class,onChange:ae=>ge("class",ae.target.value),className:Pe.formInput,placeholder:"Enter class"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Number"}),l.jsx("input",{type:"text",value:Ae.number,onChange:ae=>ge("number",ae.target.value),className:Pe.formInput,placeholder:"Enter number"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Student ID"}),l.jsx("input",{type:"text",value:Ae.student_id,onChange:ae=>ge("student_id",ae.target.value),className:Pe.formInput,placeholder:"Enter student ID"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Name"}),l.jsx("input",{type:"text",value:Ae.name,onChange:ae=>ge("name",ae.target.value),className:Pe.formInput,placeholder:"Enter name"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Surname"}),l.jsx("input",{type:"text",value:Ae.surname,onChange:ae=>ge("surname",ae.target.value),className:Pe.formInput,placeholder:"Enter surname"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Nickname"}),l.jsx("input",{type:"text",value:Ae.nickname,onChange:ae=>ge("nickname",ae.target.value),className:Pe.formInput,placeholder:"Enter nickname"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Ae.password,onChange:ae=>ge("password",ae.target.value),className:Pe.formInput,placeholder:"Enter password"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"userActive",checked:Ae.is_active,onChange:ae=>ge("is_active",ae.target.checked),className:Pe.formCheckbox}),l.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Pe.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>Ht(!1),className:Pe.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:Pe.buttonPrimary,children:"Add User"})]})]})]})}),v&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",hr.length," of ",ht.length,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),l.jsxs("select",{value:P,onChange:ae=>R(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Grades"}),[...new Set(ht.map(ae=>ae.grade))].sort().map(ae=>l.jsxs("option",{value:ae,children:["Grade ",ae]},ae))]})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:l.jsxs("table",{className:Pe.table,children:[l.jsx("thead",{className:Pe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Pe.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Grade"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Class"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Student ID"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Number"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Nickname"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Pe.tableBody,children:hr.map((ae,Ne)=>l.jsxs("tr",{className:Pe.tableRow,children:[l.jsxs("td",{className:Pe.tableCell,children:[ae.name," ",ae.surname]}),l.jsx("td",{className:Pe.tableCell,children:ae.grade}),l.jsx("td",{className:Pe.tableCell,children:ae.class}),l.jsx("td",{className:Pe.tableCell,children:ae.student_id}),l.jsx("td",{className:Pe.tableCell,children:ae.number}),l.jsx("td",{className:Pe.tableCell,children:ae.nickname}),l.jsx("td",{className:Pe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Ge(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>se(ae.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.id||Ne))})]})})})]})]})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsxs(bt.Header,{className:Pe.cardHeader,children:[l.jsx(bt.Title,{className:Pe.cardTitle,children:"Teacher Management"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors text-xs whitespace-nowrap",title:"Refresh materialized class summary view",children:"Refresh Class Summary View"}),l.jsx("button",{onClick:o,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),l.jsx(Ze,{variant:"primary",onClick:()=>at(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),l.jsx(Ze,{variant:"secondary",onClick:()=>{Pr(),E(!b)},className:"text-xs whitespace-nowrap",children:b?"Hide Teachers Table":"Get All Teachers "})]})]}),l.jsxs(bt.Body,{className:Pe.cardBody,children:[l.jsx(wi,{children:Ie&&l.jsxs(Xe.div,{className:Pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),l.jsxs("form",{onSubmit:We,className:"space-y-4",children:[l.jsxs("div",{className:Pe.formGrid,children:[l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Teacher ID"}),l.jsx("input",{type:"text",value:he.teacher_id,onChange:ae=>ve("teacher_id",ae.target.value),className:Pe.formInput,placeholder:"Enter teacher ID"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Username"}),l.jsx("input",{type:"text",value:he.username,onChange:ae=>ve("username",ae.target.value),className:Pe.formInput,placeholder:"Enter username"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:he.password,onChange:ae=>ve("password",ae.target.value),className:Pe.formInput,placeholder:"Enter password"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"First Name"}),l.jsx("input",{type:"text",value:he.first_name,onChange:ae=>ve("first_name",ae.target.value),className:Pe.formInput,placeholder:"Enter first name"})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Last Name"}),l.jsx("input",{type:"text",value:he.last_name,onChange:ae=>ve("last_name",ae.target.value),className:Pe.formInput,placeholder:"Enter last name"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacherActive",checked:he.is_active,onChange:ae=>ve("is_active",ae.target.checked),className:Pe.formCheckbox}),l.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:Pe.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>at(!1),className:Pe.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:Pe.buttonPrimary,children:"Add Teacher"})]})]})]})}),T&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:I.name,onChange:ae=>K({...I,name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),l.jsx("input",{type:"text",value:I.surname,onChange:ae=>K({...I,surname:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),l.jsx("input",{type:"number",value:I.grade,onChange:ae=>K({...I,grade:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("input",{type:"number",value:I.class,onChange:ae=>K({...I,class:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",value:I.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),l.jsx("input",{type:"text",value:I.nickname,onChange:ae=>K({...I,nickname:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:I.password,onChange:ae=>K({...I,password:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:I.is_active,onChange:ae=>K({...I,is_active:ae.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{D(null),K({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:le,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),b&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",Mt.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Pe.table,children:[l.jsx("thead",{className:Pe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Pe.tableHeaderCell,children:"Teacher ID"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Name"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Username"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Password"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Status"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Pe.tableBody,children:Mt.map((ae,Ne)=>l.jsxs("tr",{className:Pe.tableRow,children:[l.jsx("td",{className:Pe.tableCell,children:ae.teacher_id}),l.jsxs("td",{className:Pe.tableCell,children:[ae.first_name," ",ae.last_name]}),l.jsx("td",{className:Pe.tableCell,children:ae.username}),l.jsx("td",{className:Pe.tableCell,children:ae.password}),l.jsx("td",{className:Pe.tableCell,children:l.jsx("span",{className:ae.is_active?Pe.statusActive:Pe.statusInactive,children:ae.is_active?"Active":"Inactive"})}),l.jsx("td",{className:Pe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),l.jsx("td",{className:Pe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>ce(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>Te(ae.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.teacher_id||Ne))})]})})})]})]})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsx(bt.Header,{className:Pe.cardHeader,children:l.jsx(bt.Title,{className:Pe.cardTitle,children:"Subject Management"})}),l.jsxs(bt.Body,{className:Pe.cardBody,children:[l.jsxs("div",{className:Pe.buttonGroup,children:[l.jsx(Ze,{variant:"primary",onClick:()=>At(!0),className:Pe.buttonPrimary,children:"Add Subject"}),l.jsx(Ze,{variant:"secondary",onClick:()=>{Xr(),_(!k)},className:Pe.buttonSecondary,children:k?"Hide Subjects Table":"Get All Subjects "})]}),l.jsx(wi,{children:gt&&l.jsxs(Xe.div,{className:Pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),l.jsxs("form",{onSubmit:ut,className:"space-y-4",children:[l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Subject Name"}),l.jsx("input",{type:"text",value:$e.subject,onChange:ae=>Se("subject",ae.target.value),className:Pe.formInput,placeholder:"Enter subject name",required:!0}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),l.jsxs("div",{className:Pe.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>At(!1),className:Pe.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"primary",className:Pe.buttonPrimary,children:"Add Subject"})]})]})]})}),X&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),l.jsx("input",{type:"text",value:oe.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",value:oe.username,onChange:ae=>q({...oe,username:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:oe.password,onChange:ae=>q({...oe,password:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),l.jsx("input",{type:"text",value:oe.first_name,onChange:ae=>q({...oe,first_name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),l.jsx("input",{type:"text",value:oe.last_name,onChange:ae=>q({...oe,last_name:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:oe.is_active,onChange:ae=>q({...oe,is_active:ae.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{Z(null),q({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:we,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),re&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),l.jsx("input",{type:"text",value:W.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{type:"text",value:W.subject,onChange:ae=>B({...W,subject:ae.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>M(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:be,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),k&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",qe.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Pe.table,children:[l.jsx("thead",{className:Pe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Pe.tableHeaderCell,children:"Subject ID"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Subject Name"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Pe.tableBody,children:qe.map((ae,Ne)=>l.jsxs("tr",{className:Pe.tableRow,children:[l.jsx("td",{className:Pe.tableCell,children:ae.subject_id}),l.jsx("td",{className:Pe.tableCell,children:ae.subject}),l.jsx("td",{className:Pe.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Be(ae),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>nt(ae.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},ae.subject_id||Ne))})]})})})]})]})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsx(bt.Header,{className:Pe.cardHeader,children:l.jsx(bt.Title,{className:Pe.cardTitle,children:"Test Data Deletion"})}),l.jsxs(bt.Body,{className:Pe.cardBody,children:[l.jsx("div",{className:Pe.buttonGroup,children:l.jsx(Ze,{variant:"danger",onClick:()=>Jt(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),l.jsx(wi,{children:Ot&&l.jsxs(Xe.div,{className:Pe.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),l.jsxs("form",{onSubmit:Fe,className:"space-y-4",children:[l.jsxs("div",{className:Pe.formGrid,children:[l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Start Date *"}),l.jsx("input",{type:"date",value:ct.startDate,onChange:ae=>vt("startDate",ae.target.value),className:Pe.formInput,required:!0})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"End Date *"}),l.jsx("input",{type:"date",value:ct.endDate,onChange:ae=>vt("endDate",ae.target.value),className:Pe.formInput,required:!0})]})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Teacher ID *"}),l.jsxs("select",{value:ct.teacherId,onChange:ae=>vt("teacherId",ae.target.value),className:Pe.formInput,required:!0,children:[l.jsx("option",{value:"",children:"Select a teacher"}),Mt.map(ae=>l.jsxs("option",{value:ae.teacher_id,children:[ae.teacher_id," - ",ae.first_name," ",ae.last_name]},ae.teacher_id))]})]}),l.jsxs("div",{className:Pe.formGroup,children:[l.jsx("label",{className:Pe.formLabel,children:"Subject (Optional)"}),l.jsxs("select",{value:ct.subjectId,onChange:ae=>vt("subjectId",ae.target.value),className:Pe.formInput,children:[l.jsx("option",{value:"",children:"All subjects"}),qe.map(ae=>l.jsx("option",{value:ae.subject_id,children:ae.subject},ae.subject_id))]})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),l.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[l.jsx("p",{children:"This will permanently delete:"}),l.jsxs("ul",{className:"list-disc list-inside mt-1",children:[l.jsx("li",{children:"All test records within the date range"}),l.jsx("li",{children:"All test questions and answers"}),l.jsx("li",{children:"All test results and submissions"}),l.jsx("li",{children:"All test assignments"}),l.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),l.jsxs("div",{className:Pe.formActions,children:[l.jsx(Ze,{type:"button",variant:"secondary",onClick:()=>Jt(!1),className:Pe.buttonSecondary,children:"Cancel"}),l.jsx(Ze,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsx(bt.Header,{className:Pe.cardHeader,children:l.jsx(bt.Title,{className:Pe.cardTitle,children:"Assignments Management"})}),l.jsxs(bt.Body,{className:Pe.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(Ze,{variant:"primary",onClick:ke,className:Pe.buttonPrimary,children:N?"Hide Assignments Table":"Get All Assignments "})}),N&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"border-b border-gray-200",children:l.jsxs("nav",{className:"-mb-px flex space-x-8",children:[l.jsx("button",{onClick:()=>me(!0),className:`py-2 px-1 border-b-2 font-medium text-sm ${ie?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Active Assignments"}),l.jsx("button",{onClick:()=>me(!1),className:`py-2 px-1 border-b-2 font-medium text-sm ${ie?"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300":"border-purple-500 text-purple-600"}`,children:"Inactive Assignments"})]})})}),N&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:[ie?"Active":"Inactive"," Assignments (",er.length," of ",G.filter(ae=>ie?ae.is_active:!ae.is_active).length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:O,onChange:ae=>z(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Mt.map(ae=>l.jsxs("option",{value:ae.teacher_id,children:[ae.first_name," ",ae.last_name]},ae.teacher_id))]}),l.jsx("input",{type:"date",value:Y,onChange:ae=>J(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:te,onChange:ae=>ee(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Pe.table,children:[l.jsx("thead",{className:Pe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Pe.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Pe.tableBody,children:er.map((ae,Ne)=>l.jsxs("tr",{className:Pe.tableRow,children:[l.jsx("td",{className:Pe.tableCell,children:ae.test_name}),l.jsx("td",{className:Pe.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ae.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Pe.tableCell,children:ae.teacher_name}),l.jsx("td",{className:Pe.tableCell,children:ae.num_questions}),l.jsx("td",{className:Pe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),l.jsx("td",{className:Pe.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:ie?l.jsx("button",{onClick:()=>mt(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):l.jsx("button",{onClick:()=>Xt(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-green-100 text-green-700 hover:bg-green-200",children:"Mark Active"})})})]},`${ae.test_type}-${ae.test_id}-${Ne}`))})]})})})]})]})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsx(bt.Header,{className:Pe.cardHeader,children:l.jsx(bt.Title,{className:Pe.cardTitle,children:"Test Management"})}),l.jsxs(bt.Body,{className:Pe.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(Ze,{variant:"primary",onClick:Rr,className:Pe.buttonPrimary,children:Ce?"Hide Tests Table":"Get All Tests "})}),Ce&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Kt.length," of ",fe.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:He,onChange:ae=>Ye(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),Mt.map(ae=>l.jsxs("option",{value:ae.teacher_id,children:[ae.first_name," ",ae.last_name]},ae.teacher_id))]}),l.jsx("input",{type:"date",value:ot,onChange:ae=>Ve(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Rt,onChange:ae=>tt(ae.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:Pe.table,children:[l.jsx("thead",{className:Pe.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:Pe.tableHeaderCell,children:"Test Name"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Type"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Teacher"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Questions"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Created"}),l.jsx("th",{className:Pe.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:Pe.tableBody,children:Kt.map((ae,Ne)=>l.jsxs("tr",{className:Pe.tableRow,children:[l.jsx("td",{className:Pe.tableCell,children:ae.test_name}),l.jsx("td",{className:Pe.tableCell,children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:ae.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:Pe.tableCell,children:ae.teacher_name}),l.jsx("td",{className:Pe.tableCell,children:ae.num_questions}),l.jsx("td",{className:Pe.tableCell,children:new Date(ae.created_at).toLocaleDateString()}),l.jsx("td",{className:Pe.tableCell,children:l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>Ar(ae.test_id,ae.test_type,ae.teacher_id),className:"text-sm font-medium px-3 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete Test"})})})]},`${ae.test_type}-${ae.test_id}-${Ne}`))})]})})})]})]})]})}),l.jsx(Xe.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(bt,{className:Pe.cardContainer,children:[l.jsx(bt.Header,{className:Pe.cardHeader,children:l.jsx(bt.Title,{className:Pe.cardTitle,children:"Debug & Testing"})}),l.jsx(bt.Body,{className:Pe.cardBody})]})})]})})]})},Zte=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=Mn(),{get:n}=Wi(),{showNotification:s}=ba();C.useEffect(()=>{a()},[]);const a=C.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),c(),d(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(f){console.error(" Error initializing admin app:",f),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=C.useCallback(()=>{console.log(" Initializing global event listeners...");const f=p=>{p.ctrlKey&&p.key==="k"&&(p.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[]),o=C.useCallback(async()=>{try{console.log(" Loading admin data...");const[f,p,g,y]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),n("/.netlify/functions/get-academic-year")]);f.status==="fulfilled"&&f.value?.success&&console.log(" Users loaded:",f.value.users?.length||0),p.status==="fulfilled"&&p.value?.success&&console.log(" Teachers loaded:",p.value.teachers?.length||0),g.status==="fulfilled"&&g.value?.success&&console.log(" Subjects loaded:",g.value.subjects?.length||0),y.status==="fulfilled"&&y.value?.success&&console.log(" Academic years loaded:",y.value.academic_years?.length||0),console.log(" Admin data loading completed")}catch(f){throw console.error(" Error loading admin data:",f),f}},[n]),c=C.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),d=C.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const p=document.getElementById("allSubjectsContainer"),g=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!p){console.error(" allSubjectsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const p=document.getElementById("addSubjectForm");p&&(p.style.display="block")},window.hideAddSubjectForm=()=>{const p=document.getElementById("addSubjectForm"),g=document.getElementById("newSubjectForm");p&&(p.style.display="none"),g&&g.reset()},window.showAddAcademicYearForm=()=>{const p=document.getElementById("addAcademicYearForm");p&&(p.style.display="block")},window.hideAddAcademicYearForm=()=>{const p=document.getElementById("addAcademicYearForm"),g=document.getElementById("newAcademicYearForm");p&&(p.style.display="none"),g&&g.reset()},window.toggleUsersContent=()=>{const p=document.getElementById("allUsersContainer"),g=document.querySelector('button[onclick="toggleUsersContent()"]');if(!p){console.error(" allUsersContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const p=document.getElementById("addUserForm");p&&(p.style.display="block")},window.hideAddUserForm=()=>{const p=document.getElementById("addUserForm"),g=document.getElementById("newUserForm");p&&(p.style.display="none"),g&&g.reset()},window.showAddTeacherForm=()=>{const p=document.getElementById("addTeacherForm");p&&(p.style.display="block")},window.hideAddTeacherForm=()=>{const p=document.getElementById("addTeacherForm"),g=document.getElementById("newTeacherForm");p&&(p.style.display="none"),g&&g.reset()},window.toggleTeachersContent=()=>{const p=document.getElementById("allTeachersContainer"),g=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!p){console.error(" allTeachersContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const p=document.getElementById("allTestsContainer"),g=document.querySelector('button[onclick="toggleTestsContent()"]');if(!p){console.error(" allTestsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const p=document.getElementById("allAssignmentsContainer"),g=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!p){console.error(" allAssignmentsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const p=document.getElementById("allResultsContainer"),g=document.querySelector('button[onclick="toggleResultsContent()"]');if(!p){console.error(" allResultsContainer not found");return}if(!g){console.error(" Button not found");return}const y=p.style.display!=="none";p.style.display=y?"none":"block",g.textContent=y?"Show Results":"Hide Results"};const f={};window.toggleSection=p=>{console.log(` toggleSection called with sectionId: ${p}`);const g=Date.now();if(f[p]&&g-f[p]<300){console.log(` Ignoring rapid successive call for ${p}`);return}f[p]=g;const y=document.getElementById(p);if(!y){console.error(` Section with id '${p}' not found!`);return}const v=y.style.display!=="none";y.style.display=v?"none":"block";const w=document.querySelector(`button[onclick="toggleSection('${p}')"]`);w&&(w.textContent=v?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const p=document.querySelectorAll(".section-header");console.log(` Found ${p.length} section headers`),p.forEach((g,y)=>{const v=g.textContent.trim();if(console.log(` Processing header ${y+1}:`,v),g.dataset.listenerAdded==="true"){console.log(` Skipping header ${v} - listener already added`);return}g.addEventListener("click",()=>{const w=g.dataset.sectionId;w&&window.toggleSection(w)}),g.dataset.listenerAdded="true",console.log(` Added click listener to header: ${v}`)})},window.makeFieldEditable=p=>{const g=p.textContent;p.dataset.field;const y=document.createElement("input");y.type="text",y.value=g,y.className="editable-input";const v=document.createElement("button");v.textContent="Save",v.className="btn-save",v.onclick=()=>window.saveField(p,y,v,w);const w=document.createElement("button");w.textContent="Cancel",w.className="btn-cancel",w.onclick=()=>{p.textContent=g,p.style.display="block",y.remove(),v.remove(),w.remove()},p.style.display="none",p.parentNode.insertBefore(y,p),p.parentNode.insertBefore(v,p),p.parentNode.insertBefore(w,p)},window.saveField=(p,g,y,v)=>{const w=g.value.trim(),b=p.dataset.field,E=p.dataset.recordId;if(!w){alert("Field cannot be empty");return}console.log(`Saving field ${b} for record ${E} with value: ${w}`),p.textContent=w,p.style.display="block",g.remove(),y.remove(),v.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const p=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(p){return console.error(" localStorage error:",p),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const p={};for(let w=0;w<localStorage.length;w++){const b=localStorage.key(w);p[b]=localStorage.getItem(b)}const g=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),y=URL.createObjectURL(g),v=document.createElement("a");v.href=y,v.download="localStorage-backup.json",v.click(),URL.revokeObjectURL(y)},console.log(" Admin functions exposed globally")},[]);return e()?l.jsx(Jte,{}):l.jsxs("div",{className:"admin-error",children:[l.jsx("h2",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access the admin dashboard."}),l.jsx("button",{onClick:r,children:"Return to Login"})]})},Jw=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=Mn();return s?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?l.jsx(t0,{to:"/unauthorized",replace:!0}):e:l.jsx(t0,{to:"/login",replace:!0})},ere=()=>l.jsxs("div",{className:"unauthorized-page",children:[l.jsx("h1",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access this page."})]}),tre=()=>l.jsx(W3,{children:l.jsx(Uj,{children:l.jsx(Lj,{children:l.jsx(IR,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsx("div",{className:"app",children:l.jsxs(w2,{children:[l.jsx(ts,{path:"/login",element:l.jsx(HW,{})}),l.jsx(ts,{path:"/unauthorized",element:l.jsx(ere,{})}),l.jsx(ts,{path:"/student/*",element:l.jsx(Jw,{allowedRoles:["student"],children:l.jsx(Gz,{})})}),l.jsx(ts,{path:"/teacher/*",element:l.jsx(Jw,{allowedRoles:["teacher"],children:l.jsx(Qte,{})})}),l.jsx(ts,{path:"/admin/*",element:l.jsx(Jw,{allowedRoles:["admin"],children:l.jsx(Zte,{})})}),l.jsx(ts,{path:"/",element:l.jsx(t0,{to:"/login",replace:!0})}),l.jsx(ts,{path:"*",element:l.jsx(t0,{to:"/login",replace:!0})})]})})})})})});class rre{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.token),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){return this.isAuthenticated()?(this.setupTokenRefresh(),!0):(window.location.pathname!=="/login"&&(window.location.href="/login"),!1)}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const x2=new rre;window.tokenManager=x2;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{x2.init()}):x2.init());class dP{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new dP;typeof M1<"u"&&M1.exports&&(M1.exports=dP);const nre=()=>{console.log("[DEBUG] Initializing application with new structure");const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e)),console.log("[DEBUG] Application initialized with enhanced features")},sre=()=>{console.log("[DEBUG] Starting main application"),nre(),zP.createRoot(document.getElementById("root")).render(l.jsx(es.StrictMode,{children:l.jsx(tre,{})}))};sre()});export default are();
