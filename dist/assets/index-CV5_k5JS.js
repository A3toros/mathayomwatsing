var Eee=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var iDe=Eee((nIe,z4)=>{function kU(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var W4=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ec(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var x5={exports:{}},Zx={},y5={exports:{}},Dn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h9;function Aee(){if(h9)return Dn;h9=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),i=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function h(H){return H===null||typeof H!="object"?null:(H=f&&H[f]||H["@@iterator"],typeof H=="function"?H:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,x={};function v(H,R,L){this.props=H,this.context=R,this.refs=x,this.updater=L||g}v.prototype.isReactComponent={},v.prototype.setState=function(H,R){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,R,"setState")},v.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function C(){}C.prototype=v.prototype;function b(H,R,L){this.props=H,this.context=R,this.refs=x,this.updater=L||g}var _=b.prototype=new C;_.constructor=b,p(_,v.prototype),_.isPureReactComponent=!0;var T=Array.isArray,N=Object.prototype.hasOwnProperty,E={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function j(H,R,L){var G,W={},Q=null,X=null;if(R!=null)for(G in R.ref!==void 0&&(X=R.ref),R.key!==void 0&&(Q=""+R.key),R)N.call(R,G)&&!F.hasOwnProperty(G)&&(W[G]=R[G]);var se=arguments.length-2;if(se===1)W.children=L;else if(1<se){for(var le=Array(se),he=0;he<se;he++)le[he]=arguments[he+2];W.children=le}if(H&&H.defaultProps)for(G in se=H.defaultProps,se)W[G]===void 0&&(W[G]=se[G]);return{$$typeof:e,type:H,key:Q,ref:X,props:W,_owner:E.current}}function P(H,R){return{$$typeof:e,type:H.type,key:R,ref:H.ref,props:H.props,_owner:H._owner}}function M(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function I(H){var R={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(L){return R[L]})}var U=/\/+/g;function K(H,R){return typeof H=="object"&&H!==null&&H.key!=null?I(""+H.key):R.toString(36)}function te(H,R,L,G,W){var Q=typeof H;(Q==="undefined"||Q==="boolean")&&(H=null);var X=!1;if(H===null)X=!0;else switch(Q){case"string":case"number":X=!0;break;case"object":switch(H.$$typeof){case e:case t:X=!0}}if(X)return X=H,W=W(X),H=G===""?"."+K(X,0):G,T(W)?(L="",H!=null&&(L=H.replace(U,"$&/")+"/"),te(W,R,L,"",function(he){return he})):W!=null&&(M(W)&&(W=P(W,L+(!W.key||X&&X.key===W.key?"":(""+W.key).replace(U,"$&/")+"/")+H)),R.push(W)),1;if(X=0,G=G===""?".":G+":",T(H))for(var se=0;se<H.length;se++){Q=H[se];var le=G+K(Q,se);X+=te(Q,R,L,le,W)}else if(le=h(H),typeof le=="function")for(H=le.call(H),se=0;!(Q=H.next()).done;)Q=Q.value,le=G+K(Q,se++),X+=te(Q,R,L,le,W);else if(Q==="object")throw R=String(H),Error("Objects are not valid as a React child (found: "+(R==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":R)+"). If you meant to render a collection of children, use an array instead.");return X}function re(H,R,L){if(H==null)return H;var G=[],W=0;return te(H,G,"","",function(Q){return R.call(L,Q,W++)}),G}function Z(H){if(H._status===-1){var R=H._result;R=R(),R.then(function(L){(H._status===0||H._status===-1)&&(H._status=1,H._result=L)},function(L){(H._status===0||H._status===-1)&&(H._status=2,H._result=L)}),H._status===-1&&(H._status=0,H._result=R)}if(H._status===1)return H._result.default;throw H._result}var B={current:null},J={transition:null},z={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:J,ReactCurrentOwner:E};function q(){throw Error("act(...) is not supported in production builds of React.")}return Dn.Children={map:re,forEach:function(H,R,L){re(H,function(){R.apply(this,arguments)},L)},count:function(H){var R=0;return re(H,function(){R++}),R},toArray:function(H){return re(H,function(R){return R})||[]},only:function(H){if(!M(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Dn.Component=v,Dn.Fragment=r,Dn.Profiler=s,Dn.PureComponent=b,Dn.StrictMode=n,Dn.Suspense=c,Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,Dn.act=q,Dn.cloneElement=function(H,R,L){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var G=p({},H.props),W=H.key,Q=H.ref,X=H._owner;if(R!=null){if(R.ref!==void 0&&(Q=R.ref,X=E.current),R.key!==void 0&&(W=""+R.key),H.type&&H.type.defaultProps)var se=H.type.defaultProps;for(le in R)N.call(R,le)&&!F.hasOwnProperty(le)&&(G[le]=R[le]===void 0&&se!==void 0?se[le]:R[le])}var le=arguments.length-2;if(le===1)G.children=L;else if(1<le){se=Array(le);for(var he=0;he<le;he++)se[he]=arguments[he+2];G.children=se}return{$$typeof:e,type:H.type,key:W,ref:Q,props:G,_owner:X}},Dn.createContext=function(H){return H={$$typeof:i,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:a,_context:H},H.Consumer=H},Dn.createElement=j,Dn.createFactory=function(H){var R=j.bind(null,H);return R.type=H,R},Dn.createRef=function(){return{current:null}},Dn.forwardRef=function(H){return{$$typeof:o,render:H}},Dn.isValidElement=M,Dn.lazy=function(H){return{$$typeof:d,_payload:{_status:-1,_result:H},_init:Z}},Dn.memo=function(H,R){return{$$typeof:u,type:H,compare:R===void 0?null:R}},Dn.startTransition=function(H){var R=J.transition;J.transition={};try{H()}finally{J.transition=R}},Dn.unstable_act=q,Dn.useCallback=function(H,R){return B.current.useCallback(H,R)},Dn.useContext=function(H){return B.current.useContext(H)},Dn.useDebugValue=function(){},Dn.useDeferredValue=function(H){return B.current.useDeferredValue(H)},Dn.useEffect=function(H,R){return B.current.useEffect(H,R)},Dn.useId=function(){return B.current.useId()},Dn.useImperativeHandle=function(H,R,L){return B.current.useImperativeHandle(H,R,L)},Dn.useInsertionEffect=function(H,R){return B.current.useInsertionEffect(H,R)},Dn.useLayoutEffect=function(H,R){return B.current.useLayoutEffect(H,R)},Dn.useMemo=function(H,R){return B.current.useMemo(H,R)},Dn.useReducer=function(H,R,L){return B.current.useReducer(H,R,L)},Dn.useRef=function(H){return B.current.useRef(H)},Dn.useState=function(H){return B.current.useState(H)},Dn.useSyncExternalStore=function(H,R,L){return B.current.useSyncExternalStore(H,R,L)},Dn.useTransition=function(){return B.current.useTransition()},Dn.version="18.3.1",Dn}var m9;function dg(){return m9||(m9=1,y5.exports=Aee()),y5.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var g9;function jee(){if(g9)return Zx;g9=1;var e=dg(),t=Symbol.for("react.element"),r=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function i(o,c,u){var d,f={},h=null,g=null;u!==void 0&&(h=""+u),c.key!==void 0&&(h=""+c.key),c.ref!==void 0&&(g=c.ref);for(d in c)n.call(c,d)&&!a.hasOwnProperty(d)&&(f[d]=c[d]);if(o&&o.defaultProps)for(d in c=o.defaultProps,c)f[d]===void 0&&(f[d]=c[d]);return{$$typeof:t,type:o,key:h,ref:g,props:f,_owner:s.current}}return Zx.Fragment=r,Zx.jsx=i,Zx.jsxs=i,Zx}var p9;function Pee(){return p9||(p9=1,x5.exports=jee()),x5.exports}var l=Pee(),w=dg();const Rs=ec(w),CU=kU({__proto__:null,default:Rs},[w]);var bw={},v5={exports:{}},fl={},b5={exports:{}},w5={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x9;function Fee(){return x9||(x9=1,(function(e){function t(J,z){var q=J.length;J.push(z);e:for(;0<q;){var H=q-1>>>1,R=J[H];if(0<s(R,z))J[H]=z,J[q]=R,q=H;else break e}}function r(J){return J.length===0?null:J[0]}function n(J){if(J.length===0)return null;var z=J[0],q=J.pop();if(q!==z){J[0]=q;e:for(var H=0,R=J.length,L=R>>>1;H<L;){var G=2*(H+1)-1,W=J[G],Q=G+1,X=J[Q];if(0>s(W,q))Q<R&&0>s(X,W)?(J[H]=X,J[Q]=q,H=Q):(J[H]=W,J[G]=q,H=G);else if(Q<R&&0>s(X,q))J[H]=X,J[Q]=q,H=Q;else break e}}return z}function s(J,z){var q=J.sortIndex-z.sortIndex;return q!==0?q:J.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],d=1,f=null,h=3,g=!1,p=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(J){for(var z=r(u);z!==null;){if(z.callback===null)n(u);else if(z.startTime<=J)n(u),z.sortIndex=z.expirationTime,t(c,z);else break;z=r(u)}}function T(J){if(x=!1,_(J),!p)if(r(c)!==null)p=!0,Z(N);else{var z=r(u);z!==null&&B(T,z.startTime-J)}}function N(J,z){p=!1,x&&(x=!1,C(j),j=-1),g=!0;var q=h;try{for(_(z),f=r(c);f!==null&&(!(f.expirationTime>z)||J&&!I());){var H=f.callback;if(typeof H=="function"){f.callback=null,h=f.priorityLevel;var R=H(f.expirationTime<=z);z=e.unstable_now(),typeof R=="function"?f.callback=R:f===r(c)&&n(c),_(z)}else n(c);f=r(c)}if(f!==null)var L=!0;else{var G=r(u);G!==null&&B(T,G.startTime-z),L=!1}return L}finally{f=null,h=q,g=!1}}var E=!1,F=null,j=-1,P=5,M=-1;function I(){return!(e.unstable_now()-M<P)}function U(){if(F!==null){var J=e.unstable_now();M=J;var z=!0;try{z=F(!0,J)}finally{z?K():(E=!1,F=null)}}else E=!1}var K;if(typeof b=="function")K=function(){b(U)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,re=te.port2;te.port1.onmessage=U,K=function(){re.postMessage(null)}}else K=function(){v(U,0)};function Z(J){F=J,E||(E=!0,K())}function B(J,z){j=v(function(){J(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){p||g||(p=!0,Z(N))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(J){switch(h){case 1:case 2:case 3:var z=3;break;default:z=h}var q=h;h=z;try{return J()}finally{h=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,z){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var q=h;h=J;try{return z()}finally{h=q}},e.unstable_scheduleCallback=function(J,z,q){var H=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?H+q:H):q=H,J){case 1:var R=-1;break;case 2:R=250;break;case 5:R=1073741823;break;case 4:R=1e4;break;default:R=5e3}return R=q+R,J={id:d++,callback:z,priorityLevel:J,startTime:q,expirationTime:R,sortIndex:-1},q>H?(J.sortIndex=q,t(u,J),r(c)===null&&J===r(u)&&(x?(C(j),j=-1):x=!0,B(T,q-H))):(J.sortIndex=R,t(c,J),p||g||(p=!0,Z(N))),J},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(J){var z=h;return function(){var q=h;h=z;try{return J.apply(this,arguments)}finally{h=q}}}})(w5)),w5}var y9;function m7(){return y9||(y9=1,b5.exports=Fee()),b5.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v9;function Mee(){if(v9)return fl;v9=1;var e=dg(),t=m7();function r(m){for(var y="https://reactjs.org/docs/error-decoder.html?invariant="+m,A=1;A<arguments.length;A++)y+="&args[]="+encodeURIComponent(arguments[A]);return"Minified React error #"+m+"; visit "+y+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function a(m,y){i(m,y),i(m+"Capture",y)}function i(m,y){for(s[m]=y,m=0;m<y.length;m++)n.add(y[m])}var o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function h(m){return c.call(f,m)?!0:c.call(d,m)?!1:u.test(m)?f[m]=!0:(d[m]=!0,!1)}function g(m,y,A,D){if(A!==null&&A.type===0)return!1;switch(typeof y){case"function":case"symbol":return!0;case"boolean":return D?!1:A!==null?!A.acceptsBooleans:(m=m.toLowerCase().slice(0,5),m!=="data-"&&m!=="aria-");default:return!1}}function p(m,y,A,D){if(y===null||typeof y>"u"||g(m,y,A,D))return!0;if(D)return!1;if(A!==null)switch(A.type){case 3:return!y;case 4:return y===!1;case 5:return isNaN(y);case 6:return isNaN(y)||1>y}return!1}function x(m,y,A,D,Y,ae,xe){this.acceptsBooleans=y===2||y===3||y===4,this.attributeName=D,this.attributeNamespace=Y,this.mustUseProperty=A,this.propertyName=m,this.type=y,this.sanitizeURL=ae,this.removeEmptyString=xe}var v={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(m){v[m]=new x(m,0,!1,m,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(m){var y=m[0];v[y]=new x(y,1,!1,m[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(m){v[m]=new x(m,2,!1,m.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(m){v[m]=new x(m,2,!1,m,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(m){v[m]=new x(m,3,!1,m.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(m){v[m]=new x(m,3,!0,m,null,!1,!1)}),["capture","download"].forEach(function(m){v[m]=new x(m,4,!1,m,null,!1,!1)}),["cols","rows","size","span"].forEach(function(m){v[m]=new x(m,6,!1,m,null,!1,!1)}),["rowSpan","start"].forEach(function(m){v[m]=new x(m,5,!1,m.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function b(m){return m[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(m){var y=m.replace(C,b);v[y]=new x(y,1,!1,m,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(m){var y=m.replace(C,b);v[y]=new x(y,1,!1,m,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(m){var y=m.replace(C,b);v[y]=new x(y,1,!1,m,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(m){v[m]=new x(m,1,!1,m.toLowerCase(),null,!1,!1)}),v.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(m){v[m]=new x(m,1,!1,m.toLowerCase(),null,!0,!0)});function _(m,y,A,D){var Y=v.hasOwnProperty(y)?v[y]:null;(Y!==null?Y.type!==0:D||!(2<y.length)||y[0]!=="o"&&y[0]!=="O"||y[1]!=="n"&&y[1]!=="N")&&(p(y,A,Y,D)&&(A=null),D||Y===null?h(y)&&(A===null?m.removeAttribute(y):m.setAttribute(y,""+A)):Y.mustUseProperty?m[Y.propertyName]=A===null?Y.type===3?!1:"":A:(y=Y.attributeName,D=Y.attributeNamespace,A===null?m.removeAttribute(y):(Y=Y.type,A=Y===3||Y===4&&A===!0?"":""+A,D?m.setAttributeNS(D,y,A):m.setAttribute(y,A))))}var T=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,N=Symbol.for("react.element"),E=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),M=Symbol.for("react.provider"),I=Symbol.for("react.context"),U=Symbol.for("react.forward_ref"),K=Symbol.for("react.suspense"),te=Symbol.for("react.suspense_list"),re=Symbol.for("react.memo"),Z=Symbol.for("react.lazy"),B=Symbol.for("react.offscreen"),J=Symbol.iterator;function z(m){return m===null||typeof m!="object"?null:(m=J&&m[J]||m["@@iterator"],typeof m=="function"?m:null)}var q=Object.assign,H;function R(m){if(H===void 0)try{throw Error()}catch(A){var y=A.stack.trim().match(/\n( *(at )?)/);H=y&&y[1]||""}return`
`+H+m}var L=!1;function G(m,y){if(!m||L)return"";L=!0;var A=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(y)if(y=function(){throw Error()},Object.defineProperty(y.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(y,[])}catch(Ft){var D=Ft}Reflect.construct(m,[],y)}else{try{y.call()}catch(Ft){D=Ft}m.call(y.prototype)}else{try{throw Error()}catch(Ft){D=Ft}m()}}catch(Ft){if(Ft&&D&&typeof Ft.stack=="string"){for(var Y=Ft.stack.split(`
`),ae=D.stack.split(`
`),xe=Y.length-1,ze=ae.length-1;1<=xe&&0<=ze&&Y[xe]!==ae[ze];)ze--;for(;1<=xe&&0<=ze;xe--,ze--)if(Y[xe]!==ae[ze]){if(xe!==1||ze!==1)do if(xe--,ze--,0>ze||Y[xe]!==ae[ze]){var it=`
`+Y[xe].replace(" at new "," at ");return m.displayName&&it.includes("<anonymous>")&&(it=it.replace("<anonymous>",m.displayName)),it}while(1<=xe&&0<=ze);break}}}finally{L=!1,Error.prepareStackTrace=A}return(m=m?m.displayName||m.name:"")?R(m):""}function W(m){switch(m.tag){case 5:return R(m.type);case 16:return R("Lazy");case 13:return R("Suspense");case 19:return R("SuspenseList");case 0:case 2:case 15:return m=G(m.type,!1),m;case 11:return m=G(m.type.render,!1),m;case 1:return m=G(m.type,!0),m;default:return""}}function Q(m){if(m==null)return null;if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m;switch(m){case F:return"Fragment";case E:return"Portal";case P:return"Profiler";case j:return"StrictMode";case K:return"Suspense";case te:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case I:return(m.displayName||"Context")+".Consumer";case M:return(m._context.displayName||"Context")+".Provider";case U:var y=m.render;return m=m.displayName,m||(m=y.displayName||y.name||"",m=m!==""?"ForwardRef("+m+")":"ForwardRef"),m;case re:return y=m.displayName||null,y!==null?y:Q(m.type)||"Memo";case Z:y=m._payload,m=m._init;try{return Q(m(y))}catch{}}return null}function X(m){var y=m.type;switch(m.tag){case 24:return"Cache";case 9:return(y.displayName||"Context")+".Consumer";case 10:return(y._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return m=y.render,m=m.displayName||m.name||"",y.displayName||(m!==""?"ForwardRef("+m+")":"ForwardRef");case 7:return"Fragment";case 5:return y;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(y);case 8:return y===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof y=="function")return y.displayName||y.name||null;if(typeof y=="string")return y}return null}function se(m){switch(typeof m){case"boolean":case"number":case"string":case"undefined":return m;case"object":return m;default:return""}}function le(m){var y=m.type;return(m=m.nodeName)&&m.toLowerCase()==="input"&&(y==="checkbox"||y==="radio")}function he(m){var y=le(m)?"checked":"value",A=Object.getOwnPropertyDescriptor(m.constructor.prototype,y),D=""+m[y];if(!m.hasOwnProperty(y)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var Y=A.get,ae=A.set;return Object.defineProperty(m,y,{configurable:!0,get:function(){return Y.call(this)},set:function(xe){D=""+xe,ae.call(this,xe)}}),Object.defineProperty(m,y,{enumerable:A.enumerable}),{getValue:function(){return D},setValue:function(xe){D=""+xe},stopTracking:function(){m._valueTracker=null,delete m[y]}}}}function we(m){m._valueTracker||(m._valueTracker=he(m))}function ie(m){if(!m)return!1;var y=m._valueTracker;if(!y)return!0;var A=y.getValue(),D="";return m&&(D=le(m)?m.checked?"true":"false":m.value),m=D,m!==A?(y.setValue(m),!0):!1}function Ee(m){if(m=m||(typeof document<"u"?document:void 0),typeof m>"u")return null;try{return m.activeElement||m.body}catch{return m.body}}function ye(m,y){var A=y.checked;return q({},y,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:A??m._wrapperState.initialChecked})}function Ie(m,y){var A=y.defaultValue==null?"":y.defaultValue,D=y.checked!=null?y.checked:y.defaultChecked;A=se(y.value!=null?y.value:A),m._wrapperState={initialChecked:D,initialValue:A,controlled:y.type==="checkbox"||y.type==="radio"?y.checked!=null:y.value!=null}}function ut(m,y){y=y.checked,y!=null&&_(m,"checked",y,!1)}function Qe(m,y){ut(m,y);var A=se(y.value),D=y.type;if(A!=null)D==="number"?(A===0&&m.value===""||m.value!=A)&&(m.value=""+A):m.value!==""+A&&(m.value=""+A);else if(D==="submit"||D==="reset"){m.removeAttribute("value");return}y.hasOwnProperty("value")?Ge(m,y.type,A):y.hasOwnProperty("defaultValue")&&Ge(m,y.type,se(y.defaultValue)),y.checked==null&&y.defaultChecked!=null&&(m.defaultChecked=!!y.defaultChecked)}function $t(m,y,A){if(y.hasOwnProperty("value")||y.hasOwnProperty("defaultValue")){var D=y.type;if(!(D!=="submit"&&D!=="reset"||y.value!==void 0&&y.value!==null))return;y=""+m._wrapperState.initialValue,A||y===m.value||(m.value=y),m.defaultValue=y}A=m.name,A!==""&&(m.name=""),m.defaultChecked=!!m._wrapperState.initialChecked,A!==""&&(m.name=A)}function Ge(m,y,A){(y!=="number"||Ee(m.ownerDocument)!==m)&&(A==null?m.defaultValue=""+m._wrapperState.initialValue:m.defaultValue!==""+A&&(m.defaultValue=""+A))}var et=Array.isArray;function vt(m,y,A,D){if(m=m.options,y){y={};for(var Y=0;Y<A.length;Y++)y["$"+A[Y]]=!0;for(A=0;A<m.length;A++)Y=y.hasOwnProperty("$"+m[A].value),m[A].selected!==Y&&(m[A].selected=Y),Y&&D&&(m[A].defaultSelected=!0)}else{for(A=""+se(A),y=null,Y=0;Y<m.length;Y++){if(m[Y].value===A){m[Y].selected=!0,D&&(m[Y].defaultSelected=!0);return}y!==null||m[Y].disabled||(y=m[Y])}y!==null&&(y.selected=!0)}}function Te(m,y){if(y.dangerouslySetInnerHTML!=null)throw Error(r(91));return q({},y,{value:void 0,defaultValue:void 0,children:""+m._wrapperState.initialValue})}function Ve(m,y){var A=y.value;if(A==null){if(A=y.children,y=y.defaultValue,A!=null){if(y!=null)throw Error(r(92));if(et(A)){if(1<A.length)throw Error(r(93));A=A[0]}y=A}y==null&&(y=""),A=y}m._wrapperState={initialValue:se(A)}}function pt(m,y){var A=se(y.value),D=se(y.defaultValue);A!=null&&(A=""+A,A!==m.value&&(m.value=A),y.defaultValue==null&&m.defaultValue!==A&&(m.defaultValue=A)),D!=null&&(m.defaultValue=""+D)}function wt(m){var y=m.textContent;y===m._wrapperState.initialValue&&y!==""&&y!==null&&(m.value=y)}function Ut(m){switch(m){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ct(m,y){return m==null||m==="http://www.w3.org/1999/xhtml"?Ut(y):m==="http://www.w3.org/2000/svg"&&y==="foreignObject"?"http://www.w3.org/1999/xhtml":m}var yt,rt=(function(m){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(y,A,D,Y){MSApp.execUnsafeLocalFunction(function(){return m(y,A,D,Y)})}:m})(function(m,y){if(m.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in m)m.innerHTML=y;else{for(yt=yt||document.createElement("div"),yt.innerHTML="<svg>"+y.valueOf().toString()+"</svg>",y=yt.firstChild;m.firstChild;)m.removeChild(m.firstChild);for(;y.firstChild;)m.appendChild(y.firstChild)}});function Oe(m,y){if(y){var A=m.firstChild;if(A&&A===m.lastChild&&A.nodeType===3){A.nodeValue=y;return}}m.textContent=y}var $e={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mt=["Webkit","ms","Moz","O"];Object.keys($e).forEach(function(m){Mt.forEach(function(y){y=y+m.charAt(0).toUpperCase()+m.substring(1),$e[y]=$e[m]})});function It(m,y,A){return y==null||typeof y=="boolean"||y===""?"":A||typeof y!="number"||y===0||$e.hasOwnProperty(m)&&$e[m]?(""+y).trim():y+"px"}function At(m,y){m=m.style;for(var A in y)if(y.hasOwnProperty(A)){var D=A.indexOf("--")===0,Y=It(A,y[A],D);A==="float"&&(A="cssFloat"),D?m.setProperty(A,Y):m[A]=Y}}var tr=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ar(m,y){if(y){if(tr[m]&&(y.children!=null||y.dangerouslySetInnerHTML!=null))throw Error(r(137,m));if(y.dangerouslySetInnerHTML!=null){if(y.children!=null)throw Error(r(60));if(typeof y.dangerouslySetInnerHTML!="object"||!("__html"in y.dangerouslySetInnerHTML))throw Error(r(61))}if(y.style!=null&&typeof y.style!="object")throw Error(r(62))}}function dr(m,y){if(m.indexOf("-")===-1)return typeof y.is=="string";switch(m){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var or=null;function mr(m){return m=m.target||m.srcElement||window,m.correspondingUseElement&&(m=m.correspondingUseElement),m.nodeType===3?m.parentNode:m}var ve=null,Fe=null,Be=null;function Pe(m){if(m=Hh(m)){if(typeof ve!="function")throw Error(r(280));var y=m.stateNode;y&&(y=Wa(y),ve(m.stateNode,m.type,y))}}function lt(m){Fe?Be?Be.push(m):Be=[m]:Fe=m}function Ct(){if(Fe){var m=Fe,y=Be;if(Be=Fe=null,Pe(m),y)for(m=0;m<y.length;m++)Pe(y[m])}}function Lt(m,y){return m(y)}function Ue(){}var st=!1;function dt(m,y,A){if(st)return m(y,A);st=!0;try{return Lt(m,y,A)}finally{st=!1,(Fe!==null||Be!==null)&&(Ue(),Ct())}}function Bt(m,y){var A=m.stateNode;if(A===null)return null;var D=Wa(A);if(D===null)return null;A=D[y];e:switch(y){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(D=!D.disabled)||(m=m.type,D=!(m==="button"||m==="input"||m==="select"||m==="textarea")),m=!D;break e;default:m=!1}if(m)return null;if(A&&typeof A!="function")throw Error(r(231,y,typeof A));return A}var Yt=!1;if(o)try{var xr={};Object.defineProperty(xr,"passive",{get:function(){Yt=!0}}),window.addEventListener("test",xr,xr),window.removeEventListener("test",xr,xr)}catch{Yt=!1}function Rr(m,y,A,D,Y,ae,xe,ze,it){var Ft=Array.prototype.slice.call(arguments,3);try{y.apply(A,Ft)}catch(er){this.onError(er)}}var yr=!1,Br=null,me=!1,Ne=null,be={onError:function(m){yr=!0,Br=m}};function Ae(m,y,A,D,Y,ae,xe,ze,it){yr=!1,Br=null,Rr.apply(be,arguments)}function ue(m,y,A,D,Y,ae,xe,ze,it){if(Ae.apply(this,arguments),yr){if(yr){var Ft=Br;yr=!1,Br=null}else throw Error(r(198));me||(me=!0,Ne=Ft)}}function ge(m){var y=m,A=m;if(m.alternate)for(;y.return;)y=y.return;else{m=y;do y=m,(y.flags&4098)!==0&&(A=y.return),m=y.return;while(m)}return y.tag===3?A:null}function Me(m){if(m.tag===13){var y=m.memoizedState;if(y===null&&(m=m.alternate,m!==null&&(y=m.memoizedState)),y!==null)return y.dehydrated}return null}function ot(m){if(ge(m)!==m)throw Error(r(188))}function Je(m){var y=m.alternate;if(!y){if(y=ge(m),y===null)throw Error(r(188));return y!==m?null:m}for(var A=m,D=y;;){var Y=A.return;if(Y===null)break;var ae=Y.alternate;if(ae===null){if(D=Y.return,D!==null){A=D;continue}break}if(Y.child===ae.child){for(ae=Y.child;ae;){if(ae===A)return ot(Y),m;if(ae===D)return ot(Y),y;ae=ae.sibling}throw Error(r(188))}if(A.return!==D.return)A=Y,D=ae;else{for(var xe=!1,ze=Y.child;ze;){if(ze===A){xe=!0,A=Y,D=ae;break}if(ze===D){xe=!0,D=Y,A=ae;break}ze=ze.sibling}if(!xe){for(ze=ae.child;ze;){if(ze===A){xe=!0,A=ae,D=Y;break}if(ze===D){xe=!0,D=ae,A=Y;break}ze=ze.sibling}if(!xe)throw Error(r(189))}}if(A.alternate!==D)throw Error(r(190))}if(A.tag!==3)throw Error(r(188));return A.stateNode.current===A?m:y}function nt(m){return m=Je(m),m!==null?mt(m):null}function mt(m){if(m.tag===5||m.tag===6)return m;for(m=m.child;m!==null;){var y=mt(m);if(y!==null)return y;m=m.sibling}return null}var de=t.unstable_scheduleCallback,Se=t.unstable_cancelCallback,De=t.unstable_shouldYield,Le=t.unstable_requestPaint,tt=t.unstable_now,qt=t.unstable_getCurrentPriorityLevel,kr=t.unstable_ImmediatePriority,jr=t.unstable_UserBlockingPriority,_t=t.unstable_NormalPriority,ur=t.unstable_LowPriority,Gr=t.unstable_IdlePriority,Mr=null,Tr=null;function qr(m){if(Tr&&typeof Tr.onCommitFiberRoot=="function")try{Tr.onCommitFiberRoot(Mr,m,void 0,(m.current.flags&128)===128)}catch{}}var $r=Math.clz32?Math.clz32:pn,qn=Math.log,gr=Math.LN2;function pn(m){return m>>>=0,m===0?32:31-(qn(m)/gr|0)|0}var Zr=64,Zn=4194304;function Fn(m){switch(m&-m){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return m&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return m}}function Ce(m,y){var A=m.pendingLanes;if(A===0)return 0;var D=0,Y=m.suspendedLanes,ae=m.pingedLanes,xe=A&268435455;if(xe!==0){var ze=xe&~Y;ze!==0?D=Fn(ze):(ae&=xe,ae!==0&&(D=Fn(ae)))}else xe=A&~Y,xe!==0?D=Fn(xe):ae!==0&&(D=Fn(ae));if(D===0)return 0;if(y!==0&&y!==D&&(y&Y)===0&&(Y=D&-D,ae=y&-y,Y>=ae||Y===16&&(ae&4194240)!==0))return y;if((D&4)!==0&&(D|=A&16),y=m.entangledLanes,y!==0)for(m=m.entanglements,y&=D;0<y;)A=31-$r(y),Y=1<<A,D|=m[A],y&=~Y;return D}function Dt(m,y){switch(m){case 1:case 2:case 4:return y+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return y+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fr(m,y){for(var A=m.suspendedLanes,D=m.pingedLanes,Y=m.expirationTimes,ae=m.pendingLanes;0<ae;){var xe=31-$r(ae),ze=1<<xe,it=Y[xe];it===-1?((ze&A)===0||(ze&D)!==0)&&(Y[xe]=Dt(ze,y)):it<=y&&(m.expiredLanes|=ze),ae&=~ze}}function Kr(m){return m=m.pendingLanes&-1073741825,m!==0?m:m&1073741824?1073741824:0}function On(){var m=Zr;return Zr<<=1,(Zr&4194240)===0&&(Zr=64),m}function Qr(m){for(var y=[],A=0;31>A;A++)y.push(m);return y}function ns(m,y,A){m.pendingLanes|=y,y!==536870912&&(m.suspendedLanes=0,m.pingedLanes=0),m=m.eventTimes,y=31-$r(y),m[y]=A}function ta(m,y){var A=m.pendingLanes&~y;m.pendingLanes=y,m.suspendedLanes=0,m.pingedLanes=0,m.expiredLanes&=y,m.mutableReadLanes&=y,m.entangledLanes&=y,y=m.entanglements;var D=m.eventTimes;for(m=m.expirationTimes;0<A;){var Y=31-$r(A),ae=1<<Y;y[Y]=0,D[Y]=-1,m[Y]=-1,A&=~ae}}function yi(m,y){var A=m.entangledLanes|=y;for(m=m.entanglements;A;){var D=31-$r(A),Y=1<<D;Y&y|m[D]&y&&(m[D]|=y),A&=~Y}}var xn=0;function Al(m){return m&=-m,1<m?4<m?(m&268435455)!==0?16:536870912:4:1}var sl,qe,Re,Ye,Tt,St=!1,Cr=[],jt=null,en=null,Nn=null,Xe=new Map,br=new Map,lr=[],_s="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _n(m,y){switch(m){case"focusin":case"focusout":jt=null;break;case"dragenter":case"dragleave":en=null;break;case"mouseover":case"mouseout":Nn=null;break;case"pointerover":case"pointerout":Xe.delete(y.pointerId);break;case"gotpointercapture":case"lostpointercapture":br.delete(y.pointerId)}}function hn(m,y,A,D,Y,ae){return m===null||m.nativeEvent!==ae?(m={blockedOn:y,domEventName:A,eventSystemFlags:D,nativeEvent:ae,targetContainers:[Y]},y!==null&&(y=Hh(y),y!==null&&qe(y)),m):(m.eventSystemFlags|=D,y=m.targetContainers,Y!==null&&y.indexOf(Y)===-1&&y.push(Y),m)}function Sn(m,y,A,D,Y){switch(y){case"focusin":return jt=hn(jt,m,y,A,D,Y),!0;case"dragenter":return en=hn(en,m,y,A,D,Y),!0;case"mouseover":return Nn=hn(Nn,m,y,A,D,Y),!0;case"pointerover":var ae=Y.pointerId;return Xe.set(ae,hn(Xe.get(ae)||null,m,y,A,D,Y)),!0;case"gotpointercapture":return ae=Y.pointerId,br.set(ae,hn(br.get(ae)||null,m,y,A,D,Y)),!0}return!1}function jn(m){var y=Du(m.target);if(y!==null){var A=ge(y);if(A!==null){if(y=A.tag,y===13){if(y=Me(A),y!==null){m.blockedOn=y,Tt(m.priority,function(){Re(A)});return}}else if(y===3&&A.stateNode.current.memoizedState.isDehydrated){m.blockedOn=A.tag===3?A.stateNode.containerInfo:null;return}}}m.blockedOn=null}function sc(m){if(m.blockedOn!==null)return!1;for(var y=m.targetContainers;0<y.length;){var A=jg(m.domEventName,m.eventSystemFlags,y[0],m.nativeEvent);if(A===null){A=m.nativeEvent;var D=new A.constructor(A.type,A);or=D,A.target.dispatchEvent(D),or=null}else return y=Hh(A),y!==null&&qe(y),m.blockedOn=A,!1;y.shift()}return!0}function Li(m,y,A){sc(m)&&A.delete(y)}function jh(){St=!1,jt!==null&&sc(jt)&&(jt=null),en!==null&&sc(en)&&(en=null),Nn!==null&&sc(Nn)&&(Nn=null),Xe.forEach(Li),br.forEach(Li)}function Nu(m,y){m.blockedOn===y&&(m.blockedOn=null,St||(St=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,jh)))}function co(m){function y(Y){return Nu(Y,m)}if(0<Cr.length){Nu(Cr[0],m);for(var A=1;A<Cr.length;A++){var D=Cr[A];D.blockedOn===m&&(D.blockedOn=null)}}for(jt!==null&&Nu(jt,m),en!==null&&Nu(en,m),Nn!==null&&Nu(Nn,m),Xe.forEach(y),br.forEach(y),A=0;A<lr.length;A++)D=lr[A],D.blockedOn===m&&(D.blockedOn=null);for(;0<lr.length&&(A=lr[0],A.blockedOn===null);)jn(A),A.blockedOn===null&&lr.shift()}var V0=T.ReactCurrentBatchConfig,Ag=!0;function jl(m,y,A,D){var Y=xn,ae=V0.transition;V0.transition=null;try{xn=1,q0(m,y,A,D)}finally{xn=Y,V0.transition=ae}}function qc(m,y,A,D){var Y=xn,ae=V0.transition;V0.transition=null;try{xn=4,q0(m,y,A,D)}finally{xn=Y,V0.transition=ae}}function q0(m,y,A,D){if(Ag){var Y=jg(m,y,A,D);if(Y===null)Vg(m,y,D,K0,A),_n(m,D);else if(Sn(Y,m,y,A,D))D.stopPropagation();else if(_n(m,D),y&4&&-1<_s.indexOf(m)){for(;Y!==null;){var ae=Hh(Y);if(ae!==null&&sl(ae),ae=jg(m,y,A,D),ae===null&&Vg(m,y,D,K0,A),ae===Y)break;Y=ae}Y!==null&&D.stopPropagation()}else Vg(m,y,D,null,A)}}var K0=null;function jg(m,y,A,D){if(K0=null,m=mr(D),m=Du(m),m!==null)if(y=ge(m),y===null)m=null;else if(A=y.tag,A===13){if(m=Me(y),m!==null)return m;m=null}else if(A===3){if(y.stateNode.current.memoizedState.isDehydrated)return y.tag===3?y.stateNode.containerInfo:null;m=null}else y!==m&&(m=null);return K0=m,null}function kb(m){switch(m){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qt()){case kr:return 1;case jr:return 4;case _t:case ur:return 16;case Gr:return 536870912;default:return 16}default:return 16}}var ri=null,Eu=null,Kc=null;function Ph(){if(Kc)return Kc;var m,y=Eu,A=y.length,D,Y="value"in ri?ri.value:ri.textContent,ae=Y.length;for(m=0;m<A&&y[m]===Y[m];m++);var xe=A-m;for(D=1;D<=xe&&y[A-D]===Y[ae-D];D++);return Kc=Y.slice(m,1<D?1-D:void 0)}function Sd(m){var y=m.keyCode;return"charCode"in m?(m=m.charCode,m===0&&y===13&&(m=13)):m=y,m===10&&(m=13),32<=m||m===13?m:0}function Bi(){return!0}function Fo(){return!1}function Ta(m){function y(A,D,Y,ae,xe){this._reactName=A,this._targetInst=Y,this.type=D,this.nativeEvent=ae,this.target=xe,this.currentTarget=null;for(var ze in m)m.hasOwnProperty(ze)&&(A=m[ze],this[ze]=A?A(ae):ae[ze]);return this.isDefaultPrevented=(ae.defaultPrevented!=null?ae.defaultPrevented:ae.returnValue===!1)?Bi:Fo,this.isPropagationStopped=Fo,this}return q(y.prototype,{preventDefault:function(){this.defaultPrevented=!0;var A=this.nativeEvent;A&&(A.preventDefault?A.preventDefault():typeof A.returnValue!="unknown"&&(A.returnValue=!1),this.isDefaultPrevented=Bi)},stopPropagation:function(){var A=this.nativeEvent;A&&(A.stopPropagation?A.stopPropagation():typeof A.cancelBubble!="unknown"&&(A.cancelBubble=!0),this.isPropagationStopped=Bi)},persist:function(){},isPersistent:Bi}),y}var uo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(m){return m.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Pl=Ta(uo),Fl=q({},uo,{view:0,detail:0}),Cb=Ta(Fl),Fh,Mh,ni,$i=q({},Fl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cd,button:0,buttons:0,relatedTarget:function(m){return m.relatedTarget===void 0?m.fromElement===m.srcElement?m.toElement:m.fromElement:m.relatedTarget},movementX:function(m){return"movementX"in m?m.movementX:(m!==ni&&(ni&&m.type==="mousemove"?(Fh=m.screenX-ni.screenX,Mh=m.screenY-ni.screenY):Mh=Fh=0,ni=m),Fh)},movementY:function(m){return"movementY"in m?m.movementY:Mh}}),Ss=Ta($i),Rh=q({},$i,{dataTransfer:0}),Ml=Ta(Rh),Tb=q({},Fl,{relatedTarget:0}),Pg=Ta(Tb),ux=q({},uo,{animationName:0,elapsedTime:0,pseudoElement:0}),dx=Ta(ux),Nb=q({},uo,{clipboardData:function(m){return"clipboardData"in m?m.clipboardData:window.clipboardData}}),Fg=Ta(Nb),Eb=q({},uo,{data:0}),kd=Ta(Eb),fx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z3={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function W3(m){var y=this.nativeEvent;return y.getModifierState?y.getModifierState(m):(m=Mg[m])?!!y[m]:!1}function Cd(){return W3}var Rg=q({},Fl,{key:function(m){if(m.key){var y=fx[m.key]||m.key;if(y!=="Unidentified")return y}return m.type==="keypress"?(m=Sd(m),m===13?"Enter":String.fromCharCode(m)):m.type==="keydown"||m.type==="keyup"?z3[m.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cd,charCode:function(m){return m.type==="keypress"?Sd(m):0},keyCode:function(m){return m.type==="keydown"||m.type==="keyup"?m.keyCode:0},which:function(m){return m.type==="keypress"?Sd(m):m.type==="keydown"||m.type==="keyup"?m.keyCode:0}}),Ab=Ta(Rg),jb=q({},$i,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td=Ta(jb),Pb=q({},Fl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cd}),Og=Ta(Pb),Dg=q({},uo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y0=Ta(Dg),hx=q({},$i,{deltaX:function(m){return"deltaX"in m?m.deltaX:"wheelDeltaX"in m?-m.wheelDeltaX:0},deltaY:function(m){return"deltaY"in m?m.deltaY:"wheelDeltaY"in m?-m.wheelDeltaY:"wheelDelta"in m?-m.wheelDelta:0},deltaZ:0,deltaMode:0}),mx=Ta(hx),Fb=[9,13,27,32],Oh=o&&"CompositionEvent"in window,Nd=null;o&&"documentMode"in document&&(Nd=document.documentMode);var X0=o&&"TextEvent"in window&&!Nd,Mo=o&&(!Oh||Nd&&8<Nd&&11>=Nd),Au=" ",Ig=!1;function gx(m,y){switch(m){case"keyup":return Fb.indexOf(y.keyCode)!==-1;case"keydown":return y.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Rl(m){return m=m.detail,typeof m=="object"&&"data"in m?m.data:null}var Ro=!1;function px(m,y){switch(m){case"compositionend":return Rl(y);case"keypress":return y.which!==32?null:(Ig=!0,Au);case"textInput":return m=y.data,m===Au&&Ig?null:m;default:return null}}function Mb(m,y){if(Ro)return m==="compositionend"||!Oh&&gx(m,y)?(m=Ph(),Kc=Eu=ri=null,Ro=!1,m):null;switch(m){case"paste":return null;case"keypress":if(!(y.ctrlKey||y.altKey||y.metaKey)||y.ctrlKey&&y.altKey){if(y.char&&1<y.char.length)return y.char;if(y.which)return String.fromCharCode(y.which)}return null;case"compositionend":return Mo&&y.locale!=="ko"?null:y.data;default:return null}}var Yc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Xc(m){var y=m&&m.nodeName&&m.nodeName.toLowerCase();return y==="input"?!!Yc[m.type]:y==="textarea"}function Dh(m,y,A,D){lt(D),y=qg(y,"onChange"),0<y.length&&(A=new Pl("onChange","change",null,A,D),m.push({event:A,listeners:y}))}var J0=null,ju=null;function Rb(m){Nx(m,0)}function Pu(m){var y=Ea(m);if(ie(y))return m}function al(m,y){if(m==="change")return y}var Q0=!1;if(o){var Fu;if(o){var il="oninput"in document;if(!il){var Lg=document.createElement("div");Lg.setAttribute("oninput","return;"),il=typeof Lg.oninput=="function"}Fu=il}else Fu=!1;Q0=Fu&&(!document.documentMode||9<document.documentMode)}function Ed(){J0&&(J0.detachEvent("onpropertychange",xx),ju=J0=null)}function xx(m){if(m.propertyName==="value"&&Pu(ju)){var y=[];Dh(y,ju,m,mr(m)),dt(Rb,y)}}function yx(m,y,A){m==="focusin"?(Ed(),J0=y,ju=A,J0.attachEvent("onpropertychange",xx)):m==="focusout"&&Ed()}function Bs(m){if(m==="selectionchange"||m==="keyup"||m==="keydown")return Pu(ju)}function Bg(m,y){if(m==="click")return Pu(y)}function vx(m,y){if(m==="input"||m==="change")return Pu(y)}function bx(m,y){return m===y&&(m!==0||1/m===1/y)||m!==m&&y!==y}var fo=typeof Object.is=="function"?Object.is:bx;function Ad(m,y){if(fo(m,y))return!0;if(typeof m!="object"||m===null||typeof y!="object"||y===null)return!1;var A=Object.keys(m),D=Object.keys(y);if(A.length!==D.length)return!1;for(D=0;D<A.length;D++){var Y=A[D];if(!c.call(y,Y)||!fo(m[Y],y[Y]))return!1}return!0}function Mu(m){for(;m&&m.firstChild;)m=m.firstChild;return m}function As(m,y){var A=Mu(m);m=0;for(var D;A;){if(A.nodeType===3){if(D=m+A.textContent.length,m<=y&&D>=y)return{node:A,offset:y-m};m=D}e:{for(;A;){if(A.nextSibling){A=A.nextSibling;break e}A=A.parentNode}A=void 0}A=Mu(A)}}function fa(m,y){return m&&y?m===y?!0:m&&m.nodeType===3?!1:y&&y.nodeType===3?fa(m,y.parentNode):"contains"in m?m.contains(y):m.compareDocumentPosition?!!(m.compareDocumentPosition(y)&16):!1:!1}function Na(){for(var m=window,y=Ee();y instanceof m.HTMLIFrameElement;){try{var A=typeof y.contentWindow.location.href=="string"}catch{A=!1}if(A)m=y.contentWindow;else break;y=Ee(m.document)}return y}function Z0(m){var y=m&&m.nodeName&&m.nodeName.toLowerCase();return y&&(y==="input"&&(m.type==="text"||m.type==="search"||m.type==="tel"||m.type==="url"||m.type==="password")||y==="textarea"||m.contentEditable==="true")}function Ih(m){var y=Na(),A=m.focusedElem,D=m.selectionRange;if(y!==A&&A&&A.ownerDocument&&fa(A.ownerDocument.documentElement,A)){if(D!==null&&Z0(A)){if(y=D.start,m=D.end,m===void 0&&(m=y),"selectionStart"in A)A.selectionStart=y,A.selectionEnd=Math.min(m,A.value.length);else if(m=(y=A.ownerDocument||document)&&y.defaultView||window,m.getSelection){m=m.getSelection();var Y=A.textContent.length,ae=Math.min(D.start,Y);D=D.end===void 0?ae:Math.min(D.end,Y),!m.extend&&ae>D&&(Y=D,D=ae,ae=Y),Y=As(A,ae);var xe=As(A,D);Y&&xe&&(m.rangeCount!==1||m.anchorNode!==Y.node||m.anchorOffset!==Y.offset||m.focusNode!==xe.node||m.focusOffset!==xe.offset)&&(y=y.createRange(),y.setStart(Y.node,Y.offset),m.removeAllRanges(),ae>D?(m.addRange(y),m.extend(xe.node,xe.offset)):(y.setEnd(xe.node,xe.offset),m.addRange(y)))}}for(y=[],m=A;m=m.parentNode;)m.nodeType===1&&y.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof A.focus=="function"&&A.focus(),A=0;A<y.length;A++)m=y[A],m.element.scrollLeft=m.left,m.element.scrollTop=m.top}}var Lh=o&&"documentMode"in document&&11>=document.documentMode,ef=null,za=null,jd=null,Bh=!1;function $g(m,y,A){var D=A.window===A?A.document:A.nodeType===9?A:A.ownerDocument;Bh||ef==null||ef!==Ee(D)||(D=ef,"selectionStart"in D&&Z0(D)?D={start:D.selectionStart,end:D.selectionEnd}:(D=(D.ownerDocument&&D.ownerDocument.defaultView||window).getSelection(),D={anchorNode:D.anchorNode,anchorOffset:D.anchorOffset,focusNode:D.focusNode,focusOffset:D.focusOffset}),jd&&Ad(jd,D)||(jd=D,D=qg(za,"onSelect"),0<D.length&&(y=new Pl("onSelect","select",null,y,A),m.push({event:y,listeners:D}),y.target=ef)))}function Oo(m,y){var A={};return A[m.toLowerCase()]=y.toLowerCase(),A["Webkit"+m]="webkit"+y,A["Moz"+m]="moz"+y,A}var si={animationend:Oo("Animation","AnimationEnd"),animationiteration:Oo("Animation","AnimationIteration"),animationstart:Oo("Animation","AnimationStart"),transitionend:Oo("Transition","TransitionEnd")},Pd={},Ug={};o&&(Ug=document.createElement("div").style,"AnimationEvent"in window||(delete si.animationend.animation,delete si.animationiteration.animation,delete si.animationstart.animation),"TransitionEvent"in window||delete si.transitionend.transition);function tf(m){if(Pd[m])return Pd[m];if(!si[m])return m;var y=si[m],A;for(A in y)if(y.hasOwnProperty(A)&&A in Ug)return Pd[m]=y[A];return m}var wx=tf("animationend"),_x=tf("animationiteration"),Sx=tf("animationstart"),kx=tf("transitionend"),Cx=new Map,Tx="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Jc(m,y){Cx.set(m,y),a(y,[m])}for(var zg=0;zg<Tx.length;zg++){var Fd=Tx[zg],Ob=Fd.toLowerCase(),Wg=Fd[0].toUpperCase()+Fd.slice(1);Jc(Ob,"on"+Wg)}Jc(wx,"onAnimationEnd"),Jc(_x,"onAnimationIteration"),Jc(Sx,"onAnimationStart"),Jc("dblclick","onDoubleClick"),Jc("focusin","onFocus"),Jc("focusout","onBlur"),Jc(kx,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ru="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Db=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ru));function Hg(m,y,A){var D=m.type||"unknown-event";m.currentTarget=A,ue(D,y,void 0,m),m.currentTarget=null}function Nx(m,y){y=(y&4)!==0;for(var A=0;A<m.length;A++){var D=m[A],Y=D.event;D=D.listeners;e:{var ae=void 0;if(y)for(var xe=D.length-1;0<=xe;xe--){var ze=D[xe],it=ze.instance,Ft=ze.currentTarget;if(ze=ze.listener,it!==ae&&Y.isPropagationStopped())break e;Hg(Y,ze,Ft),ae=it}else for(xe=0;xe<D.length;xe++){if(ze=D[xe],it=ze.instance,Ft=ze.currentTarget,ze=ze.listener,it!==ae&&Y.isPropagationStopped())break e;Hg(Y,ze,Ft),ae=it}}}if(me)throw m=Ne,me=!1,Ne=null,m}function gs(m,y){var A=y[Yg];A===void 0&&(A=y[Yg]=new Set);var D=m+"__bubble";A.has(D)||(Ex(y,m,2,!1),A.add(D))}function Gg(m,y,A){var D=0;y&&(D|=4),Ex(A,m,D,y)}var $h="_reactListening"+Math.random().toString(36).slice(2);function Md(m){if(!m[$h]){m[$h]=!0,n.forEach(function(A){A!=="selectionchange"&&(Db.has(A)||Gg(A,!1,m),Gg(A,!0,m))});var y=m.nodeType===9?m:m.ownerDocument;y===null||y[$h]||(y[$h]=!0,Gg("selectionchange",!1,y))}}function Ex(m,y,A,D){switch(kb(y)){case 1:var Y=jl;break;case 4:Y=qc;break;default:Y=q0}A=Y.bind(null,y,A,m),Y=void 0,!Yt||y!=="touchstart"&&y!=="touchmove"&&y!=="wheel"||(Y=!0),D?Y!==void 0?m.addEventListener(y,A,{capture:!0,passive:Y}):m.addEventListener(y,A,!0):Y!==void 0?m.addEventListener(y,A,{passive:Y}):m.addEventListener(y,A,!1)}function Vg(m,y,A,D,Y){var ae=D;if((y&1)===0&&(y&2)===0&&D!==null)e:for(;;){if(D===null)return;var xe=D.tag;if(xe===3||xe===4){var ze=D.stateNode.containerInfo;if(ze===Y||ze.nodeType===8&&ze.parentNode===Y)break;if(xe===4)for(xe=D.return;xe!==null;){var it=xe.tag;if((it===3||it===4)&&(it=xe.stateNode.containerInfo,it===Y||it.nodeType===8&&it.parentNode===Y))return;xe=xe.return}for(;ze!==null;){if(xe=Du(ze),xe===null)return;if(it=xe.tag,it===5||it===6){D=ae=xe;continue e}ze=ze.parentNode}}D=D.return}dt(function(){var Ft=ae,er=mr(A),nr=[];e:{var Qt=Cx.get(m);if(Qt!==void 0){var Or=Pl,Wr=m;switch(m){case"keypress":if(Sd(A)===0)break e;case"keydown":case"keyup":Or=Ab;break;case"focusin":Wr="focus",Or=Pg;break;case"focusout":Wr="blur",Or=Pg;break;case"beforeblur":case"afterblur":Or=Pg;break;case"click":if(A.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Or=Ss;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Or=Ml;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Or=Og;break;case wx:case _x:case Sx:Or=dx;break;case kx:Or=Y0;break;case"scroll":Or=Cb;break;case"wheel":Or=mx;break;case"copy":case"cut":case"paste":Or=Fg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Or=Td}var Hr=(y&4)!==0,Fa=!Hr&&m==="scroll",kt=Hr?Qt!==null?Qt+"Capture":null:Qt;Hr=[];for(var gt=Ft,Et;gt!==null;){Et=gt;var fr=Et.stateNode;if(Et.tag===5&&fr!==null&&(Et=fr,kt!==null&&(fr=Bt(gt,kt),fr!=null&&Hr.push(rf(gt,fr,Et)))),Fa)break;gt=gt.return}0<Hr.length&&(Qt=new Or(Qt,Wr,null,A,er),nr.push({event:Qt,listeners:Hr}))}}if((y&7)===0){e:{if(Qt=m==="mouseover"||m==="pointerover",Or=m==="mouseout"||m==="pointerout",Qt&&A!==or&&(Wr=A.relatedTarget||A.fromElement)&&(Du(Wr)||Wr[ic]))break e;if((Or||Qt)&&(Qt=er.window===er?er:(Qt=er.ownerDocument)?Qt.defaultView||Qt.parentWindow:window,Or?(Wr=A.relatedTarget||A.toElement,Or=Ft,Wr=Wr?Du(Wr):null,Wr!==null&&(Fa=ge(Wr),Wr!==Fa||Wr.tag!==5&&Wr.tag!==6)&&(Wr=null)):(Or=null,Wr=Ft),Or!==Wr)){if(Hr=Ss,fr="onMouseLeave",kt="onMouseEnter",gt="mouse",(m==="pointerout"||m==="pointerover")&&(Hr=Td,fr="onPointerLeave",kt="onPointerEnter",gt="pointer"),Fa=Or==null?Qt:Ea(Or),Et=Wr==null?Qt:Ea(Wr),Qt=new Hr(fr,gt+"leave",Or,A,er),Qt.target=Fa,Qt.relatedTarget=Et,fr=null,Du(er)===Ft&&(Hr=new Hr(kt,gt+"enter",Wr,A,er),Hr.target=Et,Hr.relatedTarget=Fa,fr=Hr),Fa=fr,Or&&Wr)t:{for(Hr=Or,kt=Wr,gt=0,Et=Hr;Et;Et=Rd(Et))gt++;for(Et=0,fr=kt;fr;fr=Rd(fr))Et++;for(;0<gt-Et;)Hr=Rd(Hr),gt--;for(;0<Et-gt;)kt=Rd(kt),Et--;for(;gt--;){if(Hr===kt||kt!==null&&Hr===kt.alternate)break t;Hr=Rd(Hr),kt=Rd(kt)}Hr=null}else Hr=null;Or!==null&&Ib(nr,Qt,Or,Hr,!1),Wr!==null&&Fa!==null&&Ib(nr,Fa,Wr,Hr,!0)}}e:{if(Qt=Ft?Ea(Ft):window,Or=Qt.nodeName&&Qt.nodeName.toLowerCase(),Or==="select"||Or==="input"&&Qt.type==="file")var Vr=al;else if(Xc(Qt))if(Q0)Vr=vx;else{Vr=Bs;var tn=yx}else(Or=Qt.nodeName)&&Or.toLowerCase()==="input"&&(Qt.type==="checkbox"||Qt.type==="radio")&&(Vr=Bg);if(Vr&&(Vr=Vr(m,Ft))){Dh(nr,Vr,A,er);break e}tn&&tn(m,Qt,Ft),m==="focusout"&&(tn=Qt._wrapperState)&&tn.controlled&&Qt.type==="number"&&Ge(Qt,"number",Qt.value)}switch(tn=Ft?Ea(Ft):window,m){case"focusin":(Xc(tn)||tn.contentEditable==="true")&&(ef=tn,za=Ft,jd=null);break;case"focusout":jd=za=ef=null;break;case"mousedown":Bh=!0;break;case"contextmenu":case"mouseup":case"dragend":Bh=!1,$g(nr,A,er);break;case"selectionchange":if(Lh)break;case"keydown":case"keyup":$g(nr,A,er)}var rn;if(Oh)e:{switch(m){case"compositionstart":var mn="onCompositionStart";break e;case"compositionend":mn="onCompositionEnd";break e;case"compositionupdate":mn="onCompositionUpdate";break e}mn=void 0}else Ro?gx(m,A)&&(mn="onCompositionEnd"):m==="keydown"&&A.keyCode===229&&(mn="onCompositionStart");mn&&(Mo&&A.locale!=="ko"&&(Ro||mn!=="onCompositionStart"?mn==="onCompositionEnd"&&Ro&&(rn=Ph()):(ri=er,Eu="value"in ri?ri.value:ri.textContent,Ro=!0)),tn=qg(Ft,mn),0<tn.length&&(mn=new kd(mn,m,null,A,er),nr.push({event:mn,listeners:tn}),rn?mn.data=rn:(rn=Rl(A),rn!==null&&(mn.data=rn)))),(rn=X0?px(m,A):Mb(m,A))&&(Ft=qg(Ft,"onBeforeInput"),0<Ft.length&&(er=new kd("onBeforeInput","beforeinput",null,A,er),nr.push({event:er,listeners:Ft}),er.data=rn))}Nx(nr,y)})}function rf(m,y,A){return{instance:m,listener:y,currentTarget:A}}function qg(m,y){for(var A=y+"Capture",D=[];m!==null;){var Y=m,ae=Y.stateNode;Y.tag===5&&ae!==null&&(Y=ae,ae=Bt(m,A),ae!=null&&D.unshift(rf(m,ae,Y)),ae=Bt(m,y),ae!=null&&D.push(rf(m,ae,Y))),m=m.return}return D}function Rd(m){if(m===null)return null;do m=m.return;while(m&&m.tag!==5);return m||null}function Ib(m,y,A,D,Y){for(var ae=y._reactName,xe=[];A!==null&&A!==D;){var ze=A,it=ze.alternate,Ft=ze.stateNode;if(it!==null&&it===D)break;ze.tag===5&&Ft!==null&&(ze=Ft,Y?(it=Bt(A,ae),it!=null&&xe.unshift(rf(A,it,ze))):Y||(it=Bt(A,ae),it!=null&&xe.push(rf(A,it,ze)))),A=A.return}xe.length!==0&&m.push({event:y,listeners:xe})}var H3=/\r\n?/g,Lb=/\u0000|\uFFFD/g;function Ax(m){return(typeof m=="string"?m:""+m).replace(H3,`
`).replace(Lb,"")}function Uh(m,y,A){if(y=Ax(y),Ax(m)!==y&&A)throw Error(r(425))}function Od(){}var jx=null,Px=null;function Fx(m,y){return m==="textarea"||m==="noscript"||typeof y.children=="string"||typeof y.children=="number"||typeof y.dangerouslySetInnerHTML=="object"&&y.dangerouslySetInnerHTML!==null&&y.dangerouslySetInnerHTML.__html!=null}var Do=typeof setTimeout=="function"?setTimeout:void 0,Mx=typeof clearTimeout=="function"?clearTimeout:void 0,zh=typeof Promise=="function"?Promise:void 0,Bb=typeof queueMicrotask=="function"?queueMicrotask:typeof zh<"u"?function(m){return zh.resolve(null).then(m).catch($b)}:Do;function $b(m){setTimeout(function(){throw m})}function Kg(m,y){var A=y,D=0;do{var Y=A.nextSibling;if(m.removeChild(A),Y&&Y.nodeType===8)if(A=Y.data,A==="/$"){if(D===0){m.removeChild(Y),co(y);return}D--}else A!=="$"&&A!=="$?"&&A!=="$!"||D++;A=Y}while(A);co(y)}function ac(m){for(;m!=null;m=m.nextSibling){var y=m.nodeType;if(y===1||y===3)break;if(y===8){if(y=m.data,y==="$"||y==="$!"||y==="$?")break;if(y==="/$")return null}}return m}function Dd(m){m=m.previousSibling;for(var y=0;m;){if(m.nodeType===8){var A=m.data;if(A==="$"||A==="$!"||A==="$?"){if(y===0)return m;y--}else A==="/$"&&y++}m=m.previousSibling}return null}var Ou=Math.random().toString(36).slice(2),ol="__reactFiber$"+Ou,Wh="__reactProps$"+Ou,ic="__reactContainer$"+Ou,Yg="__reactEvents$"+Ou,Ub="__reactListeners$"+Ou,zb="__reactHandles$"+Ou;function Du(m){var y=m[ol];if(y)return y;for(var A=m.parentNode;A;){if(y=A[ic]||A[ol]){if(A=y.alternate,y.child!==null||A!==null&&A.child!==null)for(m=Dd(m);m!==null;){if(A=m[ol])return A;m=Dd(m)}return y}m=A,A=m.parentNode}return null}function Hh(m){return m=m[ol]||m[ic],!m||m.tag!==5&&m.tag!==6&&m.tag!==13&&m.tag!==3?null:m}function Ea(m){if(m.tag===5||m.tag===6)return m.stateNode;throw Error(r(33))}function Wa(m){return m[Wh]||null}var Xg=[],Id=-1;function Qc(m){return{current:m}}function ps(m){0>Id||(m.current=Xg[Id],Xg[Id]=null,Id--)}function is(m,y){Id++,Xg[Id]=m.current,m.current=y}var oc={},ai=Qc(oc),vi=Qc(!1),Iu=oc;function Ld(m,y){var A=m.type.contextTypes;if(!A)return oc;var D=m.stateNode;if(D&&D.__reactInternalMemoizedUnmaskedChildContext===y)return D.__reactInternalMemoizedMaskedChildContext;var Y={},ae;for(ae in A)Y[ae]=y[ae];return D&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=y,m.__reactInternalMemoizedMaskedChildContext=Y),Y}function bi(m){return m=m.childContextTypes,m!=null}function nf(){ps(vi),ps(ai)}function Rx(m,y,A){if(ai.current!==oc)throw Error(r(168));is(ai,y),is(vi,A)}function Jg(m,y,A){var D=m.stateNode;if(y=y.childContextTypes,typeof D.getChildContext!="function")return A;D=D.getChildContext();for(var Y in D)if(!(Y in y))throw Error(r(108,X(m)||"Unknown",Y));return q({},A,D)}function Bd(m){return m=(m=m.stateNode)&&m.__reactInternalMemoizedMergedChildContext||oc,Iu=ai.current,is(ai,m),is(vi,vi.current),!0}function Wb(m,y,A){var D=m.stateNode;if(!D)throw Error(r(169));A?(m=Jg(m,y,Iu),D.__reactInternalMemoizedMergedChildContext=m,ps(vi),ps(ai),is(ai,m)):ps(vi),is(vi,A)}var lc=null,sf=!1,Qg=!1;function Gh(m){lc===null?lc=[m]:lc.push(m)}function Zc(m){sf=!0,Gh(m)}function Lu(){if(!Qg&&lc!==null){Qg=!0;var m=0,y=xn;try{var A=lc;for(xn=1;m<A.length;m++){var D=A[m];do D=D(!0);while(D!==null)}lc=null,sf=!1}catch(Y){throw lc!==null&&(lc=lc.slice(m+1)),de(kr,Lu),Y}finally{xn=y,Qg=!1}}return null}var Ui=[],$d=0,Bu=null,$u=0,zi=[],Wi=0,Uu=null,Io=1,js="";function Ud(m,y){Ui[$d++]=$u,Ui[$d++]=Bu,Bu=m,$u=y}function Hb(m,y,A){zi[Wi++]=Io,zi[Wi++]=js,zi[Wi++]=Uu,Uu=m;var D=Io;m=js;var Y=32-$r(D)-1;D&=~(1<<Y),A+=1;var ae=32-$r(y)+Y;if(30<ae){var xe=Y-Y%5;ae=(D&(1<<xe)-1).toString(32),D>>=xe,Y-=xe,Io=1<<32-$r(y)+Y|A<<Y|D,js=ae+m}else Io=1<<ae|A<<Y|D,js=m}function af(m){m.return!==null&&(Ud(m,1),Hb(m,1,0))}function Ha(m){for(;m===Bu;)Bu=Ui[--$d],Ui[$d]=null,$u=Ui[--$d],Ui[$d]=null;for(;m===Uu;)Uu=zi[--Wi],zi[Wi]=null,js=zi[--Wi],zi[Wi]=null,Io=zi[--Wi],zi[Wi]=null}var Lo=null,Nr=null,es=!1,Bo=null;function Ox(m,y){var A=gc(5,null,null,0);A.elementType="DELETED",A.stateNode=y,A.return=m,y=m.deletions,y===null?(m.deletions=[A],m.flags|=16):y.push(A)}function Gb(m,y){switch(m.tag){case 5:var A=m.type;return y=y.nodeType!==1||A.toLowerCase()!==y.nodeName.toLowerCase()?null:y,y!==null?(m.stateNode=y,Lo=m,Nr=ac(y.firstChild),!0):!1;case 6:return y=m.pendingProps===""||y.nodeType!==3?null:y,y!==null?(m.stateNode=y,Lo=m,Nr=null,!0):!1;case 13:return y=y.nodeType!==8?null:y,y!==null?(A=Uu!==null?{id:Io,overflow:js}:null,m.memoizedState={dehydrated:y,treeContext:A,retryLane:1073741824},A=gc(18,null,null,0),A.stateNode=y,A.return=m,m.child=A,Lo=m,Nr=null,!0):!1;default:return!1}}function zd(m){return(m.mode&1)!==0&&(m.flags&128)===0}function of(m){if(es){var y=Nr;if(y){var A=y;if(!Gb(m,y)){if(zd(m))throw Error(r(418));y=ac(A.nextSibling);var D=Lo;y&&Gb(m,y)?Ox(D,A):(m.flags=m.flags&-4097|2,es=!1,Lo=m)}}else{if(zd(m))throw Error(r(418));m.flags=m.flags&-4097|2,es=!1,Lo=m}}}function Zg(m){for(m=m.return;m!==null&&m.tag!==5&&m.tag!==3&&m.tag!==13;)m=m.return;Lo=m}function Vh(m){if(m!==Lo)return!1;if(!es)return Zg(m),es=!0,!1;var y;if((y=m.tag!==3)&&!(y=m.tag!==5)&&(y=m.type,y=y!=="head"&&y!=="body"&&!Fx(m.type,m.memoizedProps)),y&&(y=Nr)){if(zd(m))throw Dx(),Error(r(418));for(;y;)Ox(m,y),y=ac(y.nextSibling)}if(Zg(m),m.tag===13){if(m=m.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(r(317));e:{for(m=m.nextSibling,y=0;m;){if(m.nodeType===8){var A=m.data;if(A==="/$"){if(y===0){Nr=ac(m.nextSibling);break e}y--}else A!=="$"&&A!=="$!"&&A!=="$?"||y++}m=m.nextSibling}Nr=null}}else Nr=Lo?ac(m.stateNode.nextSibling):null;return!0}function Dx(){for(var m=Nr;m;)m=ac(m.nextSibling)}function Wd(){Nr=Lo=null,es=!1}function qh(m){Bo===null?Bo=[m]:Bo.push(m)}var Ix=T.ReactCurrentBatchConfig;function ra(m,y,A){if(m=A.ref,m!==null&&typeof m!="function"&&typeof m!="object"){if(A._owner){if(A=A._owner,A){if(A.tag!==1)throw Error(r(309));var D=A.stateNode}if(!D)throw Error(r(147,m));var Y=D,ae=""+m;return y!==null&&y.ref!==null&&typeof y.ref=="function"&&y.ref._stringRef===ae?y.ref:(y=function(xe){var ze=Y.refs;xe===null?delete ze[ae]:ze[ae]=xe},y._stringRef=ae,y)}if(typeof m!="string")throw Error(r(284));if(!A._owner)throw Error(r(290,m))}return m}function ho(m,y){throw m=Object.prototype.toString.call(y),Error(r(31,m==="[object Object]"?"object with keys {"+Object.keys(y).join(", ")+"}":m))}function Ol(m){var y=m._init;return y(m._payload)}function ep(m){function y(kt,gt){if(m){var Et=kt.deletions;Et===null?(kt.deletions=[gt],kt.flags|=16):Et.push(gt)}}function A(kt,gt){if(!m)return null;for(;gt!==null;)y(kt,gt),gt=gt.sibling;return null}function D(kt,gt){for(kt=new Map;gt!==null;)gt.key!==null?kt.set(gt.key,gt):kt.set(gt.index,gt),gt=gt.sibling;return kt}function Y(kt,gt){return kt=Nf(kt,gt),kt.index=0,kt.sibling=null,kt}function ae(kt,gt,Et){return kt.index=Et,m?(Et=kt.alternate,Et!==null?(Et=Et.index,Et<gt?(kt.flags|=2,gt):Et):(kt.flags|=2,gt)):(kt.flags|=1048576,gt)}function xe(kt){return m&&kt.alternate===null&&(kt.flags|=2),kt}function ze(kt,gt,Et,fr){return gt===null||gt.tag!==6?(gt=d5(Et,kt.mode,fr),gt.return=kt,gt):(gt=Y(gt,Et),gt.return=kt,gt)}function it(kt,gt,Et,fr){var Vr=Et.type;return Vr===F?er(kt,gt,Et.props.children,fr,Et.key):gt!==null&&(gt.elementType===Vr||typeof Vr=="object"&&Vr!==null&&Vr.$$typeof===Z&&Ol(Vr)===gt.type)?(fr=Y(gt,Et.props),fr.ref=ra(kt,gt,Et),fr.return=kt,fr):(fr=fw(Et.type,Et.key,Et.props,null,kt.mode,fr),fr.ref=ra(kt,gt,Et),fr.return=kt,fr)}function Ft(kt,gt,Et,fr){return gt===null||gt.tag!==4||gt.stateNode.containerInfo!==Et.containerInfo||gt.stateNode.implementation!==Et.implementation?(gt=f5(Et,kt.mode,fr),gt.return=kt,gt):(gt=Y(gt,Et.children||[]),gt.return=kt,gt)}function er(kt,gt,Et,fr,Vr){return gt===null||gt.tag!==7?(gt=sm(Et,kt.mode,fr,Vr),gt.return=kt,gt):(gt=Y(gt,Et),gt.return=kt,gt)}function nr(kt,gt,Et){if(typeof gt=="string"&&gt!==""||typeof gt=="number")return gt=d5(""+gt,kt.mode,Et),gt.return=kt,gt;if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case N:return Et=fw(gt.type,gt.key,gt.props,null,kt.mode,Et),Et.ref=ra(kt,null,gt),Et.return=kt,Et;case E:return gt=f5(gt,kt.mode,Et),gt.return=kt,gt;case Z:var fr=gt._init;return nr(kt,fr(gt._payload),Et)}if(et(gt)||z(gt))return gt=sm(gt,kt.mode,Et,null),gt.return=kt,gt;ho(kt,gt)}return null}function Qt(kt,gt,Et,fr){var Vr=gt!==null?gt.key:null;if(typeof Et=="string"&&Et!==""||typeof Et=="number")return Vr!==null?null:ze(kt,gt,""+Et,fr);if(typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case N:return Et.key===Vr?it(kt,gt,Et,fr):null;case E:return Et.key===Vr?Ft(kt,gt,Et,fr):null;case Z:return Vr=Et._init,Qt(kt,gt,Vr(Et._payload),fr)}if(et(Et)||z(Et))return Vr!==null?null:er(kt,gt,Et,fr,null);ho(kt,Et)}return null}function Or(kt,gt,Et,fr,Vr){if(typeof fr=="string"&&fr!==""||typeof fr=="number")return kt=kt.get(Et)||null,ze(gt,kt,""+fr,Vr);if(typeof fr=="object"&&fr!==null){switch(fr.$$typeof){case N:return kt=kt.get(fr.key===null?Et:fr.key)||null,it(gt,kt,fr,Vr);case E:return kt=kt.get(fr.key===null?Et:fr.key)||null,Ft(gt,kt,fr,Vr);case Z:var tn=fr._init;return Or(kt,gt,Et,tn(fr._payload),Vr)}if(et(fr)||z(fr))return kt=kt.get(Et)||null,er(gt,kt,fr,Vr,null);ho(gt,fr)}return null}function Wr(kt,gt,Et,fr){for(var Vr=null,tn=null,rn=gt,mn=gt=0,Ti=null;rn!==null&&mn<Et.length;mn++){rn.index>mn?(Ti=rn,rn=null):Ti=rn.sibling;var Kn=Qt(kt,rn,Et[mn],fr);if(Kn===null){rn===null&&(rn=Ti);break}m&&rn&&Kn.alternate===null&&y(kt,rn),gt=ae(Kn,gt,mn),tn===null?Vr=Kn:tn.sibling=Kn,tn=Kn,rn=Ti}if(mn===Et.length)return A(kt,rn),es&&Ud(kt,mn),Vr;if(rn===null){for(;mn<Et.length;mn++)rn=nr(kt,Et[mn],fr),rn!==null&&(gt=ae(rn,gt,mn),tn===null?Vr=rn:tn.sibling=rn,tn=rn);return es&&Ud(kt,mn),Vr}for(rn=D(kt,rn);mn<Et.length;mn++)Ti=Or(rn,kt,mn,Et[mn],fr),Ti!==null&&(m&&Ti.alternate!==null&&rn.delete(Ti.key===null?mn:Ti.key),gt=ae(Ti,gt,mn),tn===null?Vr=Ti:tn.sibling=Ti,tn=Ti);return m&&rn.forEach(function(Ef){return y(kt,Ef)}),es&&Ud(kt,mn),Vr}function Hr(kt,gt,Et,fr){var Vr=z(Et);if(typeof Vr!="function")throw Error(r(150));if(Et=Vr.call(Et),Et==null)throw Error(r(151));for(var tn=Vr=null,rn=gt,mn=gt=0,Ti=null,Kn=Et.next();rn!==null&&!Kn.done;mn++,Kn=Et.next()){rn.index>mn?(Ti=rn,rn=null):Ti=rn.sibling;var Ef=Qt(kt,rn,Kn.value,fr);if(Ef===null){rn===null&&(rn=Ti);break}m&&rn&&Ef.alternate===null&&y(kt,rn),gt=ae(Ef,gt,mn),tn===null?Vr=Ef:tn.sibling=Ef,tn=Ef,rn=Ti}if(Kn.done)return A(kt,rn),es&&Ud(kt,mn),Vr;if(rn===null){for(;!Kn.done;mn++,Kn=Et.next())Kn=nr(kt,Kn.value,fr),Kn!==null&&(gt=ae(Kn,gt,mn),tn===null?Vr=Kn:tn.sibling=Kn,tn=Kn);return es&&Ud(kt,mn),Vr}for(rn=D(kt,rn);!Kn.done;mn++,Kn=Et.next())Kn=Or(rn,kt,mn,Kn.value,fr),Kn!==null&&(m&&Kn.alternate!==null&&rn.delete(Kn.key===null?mn:Kn.key),gt=ae(Kn,gt,mn),tn===null?Vr=Kn:tn.sibling=Kn,tn=Kn);return m&&rn.forEach(function(Nee){return y(kt,Nee)}),es&&Ud(kt,mn),Vr}function Fa(kt,gt,Et,fr){if(typeof Et=="object"&&Et!==null&&Et.type===F&&Et.key===null&&(Et=Et.props.children),typeof Et=="object"&&Et!==null){switch(Et.$$typeof){case N:e:{for(var Vr=Et.key,tn=gt;tn!==null;){if(tn.key===Vr){if(Vr=Et.type,Vr===F){if(tn.tag===7){A(kt,tn.sibling),gt=Y(tn,Et.props.children),gt.return=kt,kt=gt;break e}}else if(tn.elementType===Vr||typeof Vr=="object"&&Vr!==null&&Vr.$$typeof===Z&&Ol(Vr)===tn.type){A(kt,tn.sibling),gt=Y(tn,Et.props),gt.ref=ra(kt,tn,Et),gt.return=kt,kt=gt;break e}A(kt,tn);break}else y(kt,tn);tn=tn.sibling}Et.type===F?(gt=sm(Et.props.children,kt.mode,fr,Et.key),gt.return=kt,kt=gt):(fr=fw(Et.type,Et.key,Et.props,null,kt.mode,fr),fr.ref=ra(kt,gt,Et),fr.return=kt,kt=fr)}return xe(kt);case E:e:{for(tn=Et.key;gt!==null;){if(gt.key===tn)if(gt.tag===4&&gt.stateNode.containerInfo===Et.containerInfo&&gt.stateNode.implementation===Et.implementation){A(kt,gt.sibling),gt=Y(gt,Et.children||[]),gt.return=kt,kt=gt;break e}else{A(kt,gt);break}else y(kt,gt);gt=gt.sibling}gt=f5(Et,kt.mode,fr),gt.return=kt,kt=gt}return xe(kt);case Z:return tn=Et._init,Fa(kt,gt,tn(Et._payload),fr)}if(et(Et))return Wr(kt,gt,Et,fr);if(z(Et))return Hr(kt,gt,Et,fr);ho(kt,Et)}return typeof Et=="string"&&Et!==""||typeof Et=="number"?(Et=""+Et,gt!==null&&gt.tag===6?(A(kt,gt.sibling),gt=Y(gt,Et),gt.return=kt,kt=gt):(A(kt,gt),gt=d5(Et,kt.mode,fr),gt.return=kt,kt=gt),xe(kt)):A(kt,gt)}return Fa}var Hd=ep(!0),ll=ep(!1),Kh=Qc(null),$o=null,lf=null,tp=null;function rp(){tp=lf=$o=null}function np(m){var y=Kh.current;ps(Kh),m._currentValue=y}function sp(m,y,A){for(;m!==null;){var D=m.alternate;if((m.childLanes&y)!==y?(m.childLanes|=y,D!==null&&(D.childLanes|=y)):D!==null&&(D.childLanes&y)!==y&&(D.childLanes|=y),m===A)break;m=m.return}}function eu(m,y){$o=m,tp=lf=null,m=m.dependencies,m!==null&&m.firstContext!==null&&((m.lanes&y)!==0&&(ce=!0),m.firstContext=null)}function Hi(m){var y=m._currentValue;if(tp!==m)if(m={context:m,memoizedValue:y,next:null},lf===null){if($o===null)throw Error(r(308));lf=m,$o.dependencies={lanes:0,firstContext:m}}else lf=lf.next=m;return y}var cc=null;function cf(m){cc===null?cc=[m]:cc.push(m)}function Yh(m,y,A,D){var Y=y.interleaved;return Y===null?(A.next=A,cf(y)):(A.next=Y.next,Y.next=A),y.interleaved=A,Uo(m,D)}function Uo(m,y){m.lanes|=y;var A=m.alternate;for(A!==null&&(A.lanes|=y),A=m,m=m.return;m!==null;)m.childLanes|=y,A=m.alternate,A!==null&&(A.childLanes|=y),A=m,m=m.return;return A.tag===3?A.stateNode:null}var uc=!1;function Xh(m){m.updateQueue={baseState:m.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ap(m,y){m=m.updateQueue,y.updateQueue===m&&(y.updateQueue={baseState:m.baseState,firstBaseUpdate:m.firstBaseUpdate,lastBaseUpdate:m.lastBaseUpdate,shared:m.shared,effects:m.effects})}function dc(m,y){return{eventTime:m,lane:y,tag:0,payload:null,callback:null,next:null}}function fc(m,y,A){var D=m.updateQueue;if(D===null)return null;if(D=D.shared,(Wn&2)!==0){var Y=D.pending;return Y===null?y.next=y:(y.next=Y.next,Y.next=y),D.pending=y,Uo(m,A)}return Y=D.interleaved,Y===null?(y.next=y,cf(D)):(y.next=Y.next,Y.next=y),D.interleaved=y,Uo(m,A)}function ip(m,y,A){if(y=y.updateQueue,y!==null&&(y=y.shared,(A&4194240)!==0)){var D=y.lanes;D&=m.pendingLanes,A|=D,y.lanes=A,yi(m,A)}}function Jh(m,y){var A=m.updateQueue,D=m.alternate;if(D!==null&&(D=D.updateQueue,A===D)){var Y=null,ae=null;if(A=A.firstBaseUpdate,A!==null){do{var xe={eventTime:A.eventTime,lane:A.lane,tag:A.tag,payload:A.payload,callback:A.callback,next:null};ae===null?Y=ae=xe:ae=ae.next=xe,A=A.next}while(A!==null);ae===null?Y=ae=y:ae=ae.next=y}else Y=ae=y;A={baseState:D.baseState,firstBaseUpdate:Y,lastBaseUpdate:ae,shared:D.shared,effects:D.effects},m.updateQueue=A;return}m=A.lastBaseUpdate,m===null?A.firstBaseUpdate=y:m.next=y,A.lastBaseUpdate=y}function uf(m,y,A,D){var Y=m.updateQueue;uc=!1;var ae=Y.firstBaseUpdate,xe=Y.lastBaseUpdate,ze=Y.shared.pending;if(ze!==null){Y.shared.pending=null;var it=ze,Ft=it.next;it.next=null,xe===null?ae=Ft:xe.next=Ft,xe=it;var er=m.alternate;er!==null&&(er=er.updateQueue,ze=er.lastBaseUpdate,ze!==xe&&(ze===null?er.firstBaseUpdate=Ft:ze.next=Ft,er.lastBaseUpdate=it))}if(ae!==null){var nr=Y.baseState;xe=0,er=Ft=it=null,ze=ae;do{var Qt=ze.lane,Or=ze.eventTime;if((D&Qt)===Qt){er!==null&&(er=er.next={eventTime:Or,lane:0,tag:ze.tag,payload:ze.payload,callback:ze.callback,next:null});e:{var Wr=m,Hr=ze;switch(Qt=y,Or=A,Hr.tag){case 1:if(Wr=Hr.payload,typeof Wr=="function"){nr=Wr.call(Or,nr,Qt);break e}nr=Wr;break e;case 3:Wr.flags=Wr.flags&-65537|128;case 0:if(Wr=Hr.payload,Qt=typeof Wr=="function"?Wr.call(Or,nr,Qt):Wr,Qt==null)break e;nr=q({},nr,Qt);break e;case 2:uc=!0}}ze.callback!==null&&ze.lane!==0&&(m.flags|=64,Qt=Y.effects,Qt===null?Y.effects=[ze]:Qt.push(ze))}else Or={eventTime:Or,lane:Qt,tag:ze.tag,payload:ze.payload,callback:ze.callback,next:null},er===null?(Ft=er=Or,it=nr):er=er.next=Or,xe|=Qt;if(ze=ze.next,ze===null){if(ze=Y.shared.pending,ze===null)break;Qt=ze,ze=Qt.next,Qt.next=null,Y.lastBaseUpdate=Qt,Y.shared.pending=null}}while(!0);if(er===null&&(it=nr),Y.baseState=it,Y.firstBaseUpdate=Ft,Y.lastBaseUpdate=er,y=Y.shared.interleaved,y!==null){Y=y;do xe|=Y.lane,Y=Y.next;while(Y!==y)}else ae===null&&(Y.shared.lanes=0);em|=xe,m.lanes=xe,m.memoizedState=nr}}function Ks(m,y,A){if(m=y.effects,y.effects=null,m!==null)for(y=0;y<m.length;y++){var D=m[y],Y=D.callback;if(Y!==null){if(D.callback=null,D=A,typeof Y!="function")throw Error(r(191,Y));Y.call(D)}}}var bn={},os=Qc(bn),Ps=Qc(bn),na=Qc(bn);function Aa(m){if(m===bn)throw Error(r(174));return m}function zu(m,y){switch(is(na,y),is(Ps,m),is(os,bn),m=y.nodeType,m){case 9:case 11:y=(y=y.documentElement)?y.namespaceURI:ct(null,"");break;default:m=m===8?y.parentNode:y,y=m.namespaceURI||null,m=m.tagName,y=ct(y,m)}ps(os),is(os,y)}function Fs(){ps(os),ps(Ps),ps(na)}function df(m){Aa(na.current);var y=Aa(os.current),A=ct(y,m.type);y!==A&&(is(Ps,m),is(os,A))}function tu(m){Ps.current===m&&(ps(os),ps(Ps))}var xs=Qc(0);function ff(m){for(var y=m;y!==null;){if(y.tag===13){var A=y.memoizedState;if(A!==null&&(A=A.dehydrated,A===null||A.data==="$?"||A.data==="$!"))return y}else if(y.tag===19&&y.memoizedProps.revealOrder!==void 0){if((y.flags&128)!==0)return y}else if(y.child!==null){y.child.return=y,y=y.child;continue}if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return null;y=y.return}y.sibling.return=y.return,y=y.sibling}return null}var Gd=[];function wi(){for(var m=0;m<Gd.length;m++)Gd[m]._workInProgressVersionPrimary=null;Gd.length=0}var hf=T.ReactCurrentDispatcher,Qh=T.ReactCurrentBatchConfig,Gi=0,ss=null,Ys=null,ha=null,Dl=!1,Wu=!1,cl=0,op=0;function ma(){throw Error(r(321))}function Zh(m,y){if(y===null)return!1;for(var A=0;A<y.length&&A<m.length;A++)if(!fo(m[A],y[A]))return!1;return!0}function mf(m,y,A,D,Y,ae){if(Gi=ae,ss=y,y.memoizedState=null,y.updateQueue=null,y.lanes=0,hf.current=m===null||m.memoizedState===null?V3:Vu,m=A(D,Y),Wu){ae=0;do{if(Wu=!1,cl=0,25<=ae)throw Error(r(301));ae+=1,ha=Ys=null,y.updateQueue=null,hf.current=fp,m=A(D,Y)}while(Wu)}if(hf.current=yf,y=Ys!==null&&Ys.next!==null,Gi=0,ha=Ys=ss=null,Dl=!1,y)throw Error(r(300));return m}function gf(){var m=cl!==0;return cl=0,m}function ks(){var m={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ha===null?ss.memoizedState=ha=m:ha=ha.next=m,ha}function ja(){if(Ys===null){var m=ss.alternate;m=m!==null?m.memoizedState:null}else m=Ys.next;var y=ha===null?ss.memoizedState:ha.next;if(y!==null)ha=y,Ys=m;else{if(m===null)throw Error(r(310));Ys=m,m={memoizedState:Ys.memoizedState,baseState:Ys.baseState,baseQueue:Ys.baseQueue,queue:Ys.queue,next:null},ha===null?ss.memoizedState=ha=m:ha=ha.next=m}return ha}function _i(m,y){return typeof y=="function"?y(m):y}function Si(m){var y=ja(),A=y.queue;if(A===null)throw Error(r(311));A.lastRenderedReducer=m;var D=Ys,Y=D.baseQueue,ae=A.pending;if(ae!==null){if(Y!==null){var xe=Y.next;Y.next=ae.next,ae.next=xe}D.baseQueue=Y=ae,A.pending=null}if(Y!==null){ae=Y.next,D=D.baseState;var ze=xe=null,it=null,Ft=ae;do{var er=Ft.lane;if((Gi&er)===er)it!==null&&(it=it.next={lane:0,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null}),D=Ft.hasEagerState?Ft.eagerState:m(D,Ft.action);else{var nr={lane:er,action:Ft.action,hasEagerState:Ft.hasEagerState,eagerState:Ft.eagerState,next:null};it===null?(ze=it=nr,xe=D):it=it.next=nr,ss.lanes|=er,em|=er}Ft=Ft.next}while(Ft!==null&&Ft!==ae);it===null?xe=D:it.next=ze,fo(D,y.memoizedState)||(ce=!0),y.memoizedState=D,y.baseState=xe,y.baseQueue=it,A.lastRenderedState=D}if(m=A.interleaved,m!==null){Y=m;do ae=Y.lane,ss.lanes|=ae,em|=ae,Y=Y.next;while(Y!==m)}else Y===null&&(A.lanes=0);return[y.memoizedState,A.dispatch]}function lp(m){var y=ja(),A=y.queue;if(A===null)throw Error(r(311));A.lastRenderedReducer=m;var D=A.dispatch,Y=A.pending,ae=y.memoizedState;if(Y!==null){A.pending=null;var xe=Y=Y.next;do ae=m(ae,xe.action),xe=xe.next;while(xe!==Y);fo(ae,y.memoizedState)||(ce=!0),y.memoizedState=ae,y.baseQueue===null&&(y.baseState=ae),A.lastRenderedState=ae}return[ae,D]}function cp(){}function up(m,y){var A=ss,D=ja(),Y=y(),ae=!fo(D.memoizedState,Y);if(ae&&(D.memoizedState=Y,ce=!0),D=D.queue,Ux(Lx.bind(null,A,D,m),[m]),D.getSnapshot!==y||ae||ha!==null&&ha.memoizedState.tag&1){if(A.flags|=2048,pf(9,ru.bind(null,A,D,Y,y),void 0,null),Ci===null)throw Error(r(349));(Gi&30)!==0||Vb(A,y,Y)}return Y}function Vb(m,y,A){m.flags|=16384,m={getSnapshot:y,value:A},y=ss.updateQueue,y===null?(y={lastEffect:null,stores:null},ss.updateQueue=y,y.stores=[m]):(A=y.stores,A===null?y.stores=[m]:A.push(m))}function ru(m,y,A,D){y.value=A,y.getSnapshot=D,Bx(y)&&dp(m)}function Lx(m,y,A){return A(function(){Bx(y)&&dp(m)})}function Bx(m){var y=m.getSnapshot;m=m.value;try{var A=y();return!fo(m,A)}catch{return!0}}function dp(m){var y=Uo(m,1);y!==null&&iu(y,m,1,-1)}function Hu(m){var y=ks();return typeof m=="function"&&(m=m()),y.memoizedState=y.baseState=m,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_i,lastRenderedState:m},y.queue=m,m=m.dispatch=Qb.bind(null,ss,m),[y.memoizedState,m]}function pf(m,y,A,D){return m={tag:m,create:y,destroy:A,deps:D,next:null},y=ss.updateQueue,y===null?(y={lastEffect:null,stores:null},ss.updateQueue=y,y.lastEffect=m.next=m):(A=y.lastEffect,A===null?y.lastEffect=m.next=m:(D=A.next,A.next=m,m.next=D,y.lastEffect=m)),m}function $x(){return ja().memoizedState}function xf(m,y,A,D){var Y=ks();ss.flags|=m,Y.memoizedState=pf(1|y,A,void 0,D===void 0?null:D)}function Vd(m,y,A,D){var Y=ja();D=D===void 0?null:D;var ae=void 0;if(Ys!==null){var xe=Ys.memoizedState;if(ae=xe.destroy,D!==null&&Zh(D,xe.deps)){Y.memoizedState=pf(y,A,ae,D);return}}ss.flags|=m,Y.memoizedState=pf(1|y,A,ae,D)}function qb(m,y){return xf(8390656,8,m,y)}function Ux(m,y){return Vd(2048,8,m,y)}function zx(m,y){return Vd(4,2,m,y)}function Wx(m,y){return Vd(4,4,m,y)}function Gu(m,y){if(typeof y=="function")return m=m(),y(m),function(){y(null)};if(y!=null)return m=m(),y.current=m,function(){y.current=null}}function Kb(m,y,A){return A=A!=null?A.concat([m]):null,Vd(4,4,Gu.bind(null,y,m),A)}function nu(){}function Hx(m,y){var A=ja();y=y===void 0?null:y;var D=A.memoizedState;return D!==null&&y!==null&&Zh(y,D[1])?D[0]:(A.memoizedState=[m,y],m)}function Cs(m,y){var A=ja();y=y===void 0?null:y;var D=A.memoizedState;return D!==null&&y!==null&&Zh(y,D[1])?D[0]:(m=m(),A.memoizedState=[m,y],m)}function Yb(m,y,A){return(Gi&21)===0?(m.baseState&&(m.baseState=!1,ce=!0),m.memoizedState=A):(fo(A,y)||(A=On(),ss.lanes|=A,em|=A,m.baseState=!0),y)}function Xb(m,y){var A=xn;xn=A!==0&&4>A?A:4,m(!0);var D=Qh.transition;Qh.transition={};try{m(!1),y()}finally{xn=A,Qh.transition=D}}function Jb(){return ja().memoizedState}function G3(m,y,A){var D=Cf(m);if(A={lane:D,action:A,hasEagerState:!1,eagerState:null,next:null},Gx(m))Zb(y,A);else if(A=Yh(m,y,A,D),A!==null){var Y=Wo();iu(A,m,D,Y),zo(A,y,D)}}function Qb(m,y,A){var D=Cf(m),Y={lane:D,action:A,hasEagerState:!1,eagerState:null,next:null};if(Gx(m))Zb(y,Y);else{var ae=m.alternate;if(m.lanes===0&&(ae===null||ae.lanes===0)&&(ae=y.lastRenderedReducer,ae!==null))try{var xe=y.lastRenderedState,ze=ae(xe,A);if(Y.hasEagerState=!0,Y.eagerState=ze,fo(ze,xe)){var it=y.interleaved;it===null?(Y.next=Y,cf(y)):(Y.next=it.next,it.next=Y),y.interleaved=Y;return}}catch{}finally{}A=Yh(m,y,Y,D),A!==null&&(Y=Wo(),iu(A,m,D,Y),zo(A,y,D))}}function Gx(m){var y=m.alternate;return m===ss||y!==null&&y===ss}function Zb(m,y){Wu=Dl=!0;var A=m.pending;A===null?y.next=y:(y.next=A.next,A.next=y),m.pending=y}function zo(m,y,A){if((A&4194240)!==0){var D=y.lanes;D&=m.pendingLanes,A|=D,y.lanes=A,yi(m,A)}}var yf={readContext:Hi,useCallback:ma,useContext:ma,useEffect:ma,useImperativeHandle:ma,useInsertionEffect:ma,useLayoutEffect:ma,useMemo:ma,useReducer:ma,useRef:ma,useState:ma,useDebugValue:ma,useDeferredValue:ma,useTransition:ma,useMutableSource:ma,useSyncExternalStore:ma,useId:ma,unstable_isNewReconciler:!1},V3={readContext:Hi,useCallback:function(m,y){return ks().memoizedState=[m,y===void 0?null:y],m},useContext:Hi,useEffect:qb,useImperativeHandle:function(m,y,A){return A=A!=null?A.concat([m]):null,xf(4194308,4,Gu.bind(null,y,m),A)},useLayoutEffect:function(m,y){return xf(4194308,4,m,y)},useInsertionEffect:function(m,y){return xf(4,2,m,y)},useMemo:function(m,y){var A=ks();return y=y===void 0?null:y,m=m(),A.memoizedState=[m,y],m},useReducer:function(m,y,A){var D=ks();return y=A!==void 0?A(y):y,D.memoizedState=D.baseState=y,m={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:m,lastRenderedState:y},D.queue=m,m=m.dispatch=G3.bind(null,ss,m),[D.memoizedState,m]},useRef:function(m){var y=ks();return m={current:m},y.memoizedState=m},useState:Hu,useDebugValue:nu,useDeferredValue:function(m){return ks().memoizedState=m},useTransition:function(){var m=Hu(!1),y=m[0];return m=Xb.bind(null,m[1]),ks().memoizedState=m,[y,m]},useMutableSource:function(){},useSyncExternalStore:function(m,y,A){var D=ss,Y=ks();if(es){if(A===void 0)throw Error(r(407));A=A()}else{if(A=y(),Ci===null)throw Error(r(349));(Gi&30)!==0||Vb(D,y,A)}Y.memoizedState=A;var ae={value:A,getSnapshot:y};return Y.queue=ae,qb(Lx.bind(null,D,ae,m),[m]),D.flags|=2048,pf(9,ru.bind(null,D,ae,A,y),void 0,null),A},useId:function(){var m=ks(),y=Ci.identifierPrefix;if(es){var A=js,D=Io;A=(D&~(1<<32-$r(D)-1)).toString(32)+A,y=":"+y+"R"+A,A=cl++,0<A&&(y+="H"+A.toString(32)),y+=":"}else A=op++,y=":"+y+"r"+A.toString(32)+":";return m.memoizedState=y},unstable_isNewReconciler:!1},Vu={readContext:Hi,useCallback:Hx,useContext:Hi,useEffect:Ux,useImperativeHandle:Kb,useInsertionEffect:zx,useLayoutEffect:Wx,useMemo:Cs,useReducer:Si,useRef:$x,useState:function(){return Si(_i)},useDebugValue:nu,useDeferredValue:function(m){var y=ja();return Yb(y,Ys.memoizedState,m)},useTransition:function(){var m=Si(_i)[0],y=ja().memoizedState;return[m,y]},useMutableSource:cp,useSyncExternalStore:up,useId:Jb,unstable_isNewReconciler:!1},fp={readContext:Hi,useCallback:Hx,useContext:Hi,useEffect:Ux,useImperativeHandle:Kb,useInsertionEffect:zx,useLayoutEffect:Wx,useMemo:Cs,useReducer:lp,useRef:$x,useState:function(){return lp(_i)},useDebugValue:nu,useDeferredValue:function(m){var y=ja();return Ys===null?y.memoizedState=m:Yb(y,Ys.memoizedState,m)},useTransition:function(){var m=lp(_i)[0],y=ja().memoizedState;return[m,y]},useMutableSource:cp,useSyncExternalStore:up,useId:Jb,unstable_isNewReconciler:!1};function ii(m,y){if(m&&m.defaultProps){y=q({},y),m=m.defaultProps;for(var A in m)y[A]===void 0&&(y[A]=m[A]);return y}return y}function vf(m,y,A,D){y=m.memoizedState,A=A(D,y),A=A==null?y:q({},y,A),m.memoizedState=A,m.lanes===0&&(m.updateQueue.baseState=A)}var bf={isMounted:function(m){return(m=m._reactInternals)?ge(m)===m:!1},enqueueSetState:function(m,y,A){m=m._reactInternals;var D=Wo(),Y=Cf(m),ae=dc(D,Y);ae.payload=y,A!=null&&(ae.callback=A),y=fc(m,ae,Y),y!==null&&(iu(y,m,Y,D),ip(y,m,Y))},enqueueReplaceState:function(m,y,A){m=m._reactInternals;var D=Wo(),Y=Cf(m),ae=dc(D,Y);ae.tag=1,ae.payload=y,A!=null&&(ae.callback=A),y=fc(m,ae,Y),y!==null&&(iu(y,m,Y,D),ip(y,m,Y))},enqueueForceUpdate:function(m,y){m=m._reactInternals;var A=Wo(),D=Cf(m),Y=dc(A,D);Y.tag=2,y!=null&&(Y.callback=y),y=fc(m,Y,D),y!==null&&(iu(y,m,D,A),ip(y,m,D))}};function hp(m,y,A,D,Y,ae,xe){return m=m.stateNode,typeof m.shouldComponentUpdate=="function"?m.shouldComponentUpdate(D,ae,xe):y.prototype&&y.prototype.isPureReactComponent?!Ad(A,D)||!Ad(Y,ae):!0}function ew(m,y,A){var D=!1,Y=oc,ae=y.contextType;return typeof ae=="object"&&ae!==null?ae=Hi(ae):(Y=bi(y)?Iu:ai.current,D=y.contextTypes,ae=(D=D!=null)?Ld(m,Y):oc),y=new y(A,ae),m.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=bf,m.stateNode=y,y._reactInternals=m,D&&(m=m.stateNode,m.__reactInternalMemoizedUnmaskedChildContext=Y,m.__reactInternalMemoizedMaskedChildContext=ae),y}function Vx(m,y,A,D){m=y.state,typeof y.componentWillReceiveProps=="function"&&y.componentWillReceiveProps(A,D),typeof y.UNSAFE_componentWillReceiveProps=="function"&&y.UNSAFE_componentWillReceiveProps(A,D),y.state!==m&&bf.enqueueReplaceState(y,y.state,null)}function mp(m,y,A,D){var Y=m.stateNode;Y.props=A,Y.state=m.memoizedState,Y.refs={},Xh(m);var ae=y.contextType;typeof ae=="object"&&ae!==null?Y.context=Hi(ae):(ae=bi(y)?Iu:ai.current,Y.context=Ld(m,ae)),Y.state=m.memoizedState,ae=y.getDerivedStateFromProps,typeof ae=="function"&&(vf(m,y,ae,A),Y.state=m.memoizedState),typeof y.getDerivedStateFromProps=="function"||typeof Y.getSnapshotBeforeUpdate=="function"||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(y=Y.state,typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount(),y!==Y.state&&bf.enqueueReplaceState(Y,Y.state,null),uf(m,A,Y,D),Y.state=m.memoizedState),typeof Y.componentDidMount=="function"&&(m.flags|=4194308)}function qd(m,y){try{var A="",D=y;do A+=W(D),D=D.return;while(D);var Y=A}catch(ae){Y=`
Error generating stack: `+ae.message+`
`+ae.stack}return{value:m,source:y,stack:Y,digest:null}}function gp(m,y,A){return{value:m,source:null,stack:A??null,digest:y??null}}function wf(m,y){try{console.error(y.value)}catch(A){setTimeout(function(){throw A})}}var q3=typeof WeakMap=="function"?WeakMap:Map;function tw(m,y,A){A=dc(-1,A),A.tag=3,A.payload={element:null};var D=y.value;return A.callback=function(){iw||(iw=!0,n5=D),wf(m,y)},A}function S(m,y,A){A=dc(-1,A),A.tag=3;var D=m.type.getDerivedStateFromError;if(typeof D=="function"){var Y=y.value;A.payload=function(){return D(Y)},A.callback=function(){wf(m,y)}}var ae=m.stateNode;return ae!==null&&typeof ae.componentDidCatch=="function"&&(A.callback=function(){wf(m,y),typeof D!="function"&&(Sf===null?Sf=new Set([this]):Sf.add(this));var xe=y.stack;this.componentDidCatch(y.value,{componentStack:xe!==null?xe:""})}),A}function k(m,y,A){var D=m.pingCache;if(D===null){D=m.pingCache=new q3;var Y=new Set;D.set(y,Y)}else Y=D.get(y),Y===void 0&&(Y=new Set,D.set(y,Y));Y.has(A)||(Y.add(A),m=pee.bind(null,m,y,A),y.then(m,m))}function O(m){do{var y;if((y=m.tag===13)&&(y=m.memoizedState,y=y!==null?y.dehydrated!==null:!0),y)return m;m=m.return}while(m!==null);return null}function V(m,y,A,D,Y){return(m.mode&1)===0?(m===y?m.flags|=65536:(m.flags|=128,A.flags|=131072,A.flags&=-52805,A.tag===1&&(A.alternate===null?A.tag=17:(y=dc(-1,1),y.tag=2,fc(A,y,1))),A.lanes|=1),m):(m.flags|=65536,m.lanes=Y,m)}var ee=T.ReactCurrentOwner,ce=!1;function je(m,y,A,D){y.child=m===null?ll(y,null,A,D):Hd(y,m.child,A,D)}function xt(m,y,A,D,Y){A=A.render;var ae=y.ref;return eu(y,Y),D=mf(m,y,A,D,ae,Y),A=gf(),m!==null&&!ce?(y.updateQueue=m.updateQueue,y.flags&=-2053,m.lanes&=~Y,ki(m,y,Y)):(es&&A&&af(y),y.flags|=1,je(m,y,D,Y),y.child)}function Rt(m,y,A,D,Y){if(m===null){var ae=A.type;return typeof ae=="function"&&!u5(ae)&&ae.defaultProps===void 0&&A.compare===null&&A.defaultProps===void 0?(y.tag=15,y.type=ae,cr(m,y,ae,D,Y)):(m=fw(A.type,null,D,y,y.mode,Y),m.ref=y.ref,m.return=y,y.child=m)}if(ae=m.child,(m.lanes&Y)===0){var xe=ae.memoizedProps;if(A=A.compare,A=A!==null?A:Ad,A(xe,D)&&m.ref===y.ref)return ki(m,y,Y)}return y.flags|=1,m=Nf(ae,D),m.ref=y.ref,m.return=y,y.child=m}function cr(m,y,A,D,Y){if(m!==null){var ae=m.memoizedProps;if(Ad(ae,D)&&m.ref===y.ref)if(ce=!1,y.pendingProps=D=ae,(m.lanes&Y)!==0)(m.flags&131072)!==0&&(ce=!0);else return y.lanes=m.lanes,ki(m,y,Y)}return Er(m,y,A,D,Y)}function Lr(m,y,A){var D=y.pendingProps,Y=D.children,ae=m!==null?m.memoizedState:null;if(D.mode==="hidden")if((y.mode&1)===0)y.memoizedState={baseLanes:0,cachePool:null,transitions:null},is(xp,Il),Il|=A;else{if((A&1073741824)===0)return m=ae!==null?ae.baseLanes|A:A,y.lanes=y.childLanes=1073741824,y.memoizedState={baseLanes:m,cachePool:null,transitions:null},y.updateQueue=null,is(xp,Il),Il|=m,null;y.memoizedState={baseLanes:0,cachePool:null,transitions:null},D=ae!==null?ae.baseLanes:A,is(xp,Il),Il|=D}else ae!==null?(D=ae.baseLanes|A,y.memoizedState=null):D=A,is(xp,Il),Il|=D;return je(m,y,Y,A),y.child}function yn(m,y){var A=y.ref;(m===null&&A!==null||m!==null&&m.ref!==A)&&(y.flags|=512,y.flags|=2097152)}function Er(m,y,A,D,Y){var ae=bi(A)?Iu:ai.current;return ae=Ld(y,ae),eu(y,Y),A=mf(m,y,A,D,ae,Y),D=gf(),m!==null&&!ce?(y.updateQueue=m.updateQueue,y.flags&=-2053,m.lanes&=~Y,ki(m,y,Y)):(es&&D&&af(y),y.flags|=1,je(m,y,A,Y),y.child)}function ys(m,y,A,D,Y){if(bi(A)){var ae=!0;Bd(y)}else ae=!1;if(eu(y,Y),y.stateNode===null)Ln(m,y),ew(y,A,D),mp(y,A,D,Y),D=!0;else if(m===null){var xe=y.stateNode,ze=y.memoizedProps;xe.props=ze;var it=xe.context,Ft=A.contextType;typeof Ft=="object"&&Ft!==null?Ft=Hi(Ft):(Ft=bi(A)?Iu:ai.current,Ft=Ld(y,Ft));var er=A.getDerivedStateFromProps,nr=typeof er=="function"||typeof xe.getSnapshotBeforeUpdate=="function";nr||typeof xe.UNSAFE_componentWillReceiveProps!="function"&&typeof xe.componentWillReceiveProps!="function"||(ze!==D||it!==Ft)&&Vx(y,xe,D,Ft),uc=!1;var Qt=y.memoizedState;xe.state=Qt,uf(y,D,xe,Y),it=y.memoizedState,ze!==D||Qt!==it||vi.current||uc?(typeof er=="function"&&(vf(y,A,er,D),it=y.memoizedState),(ze=uc||hp(y,A,ze,D,Qt,it,Ft))?(nr||typeof xe.UNSAFE_componentWillMount!="function"&&typeof xe.componentWillMount!="function"||(typeof xe.componentWillMount=="function"&&xe.componentWillMount(),typeof xe.UNSAFE_componentWillMount=="function"&&xe.UNSAFE_componentWillMount()),typeof xe.componentDidMount=="function"&&(y.flags|=4194308)):(typeof xe.componentDidMount=="function"&&(y.flags|=4194308),y.memoizedProps=D,y.memoizedState=it),xe.props=D,xe.state=it,xe.context=Ft,D=ze):(typeof xe.componentDidMount=="function"&&(y.flags|=4194308),D=!1)}else{xe=y.stateNode,ap(m,y),ze=y.memoizedProps,Ft=y.type===y.elementType?ze:ii(y.type,ze),xe.props=Ft,nr=y.pendingProps,Qt=xe.context,it=A.contextType,typeof it=="object"&&it!==null?it=Hi(it):(it=bi(A)?Iu:ai.current,it=Ld(y,it));var Or=A.getDerivedStateFromProps;(er=typeof Or=="function"||typeof xe.getSnapshotBeforeUpdate=="function")||typeof xe.UNSAFE_componentWillReceiveProps!="function"&&typeof xe.componentWillReceiveProps!="function"||(ze!==nr||Qt!==it)&&Vx(y,xe,D,it),uc=!1,Qt=y.memoizedState,xe.state=Qt,uf(y,D,xe,Y);var Wr=y.memoizedState;ze!==nr||Qt!==Wr||vi.current||uc?(typeof Or=="function"&&(vf(y,A,Or,D),Wr=y.memoizedState),(Ft=uc||hp(y,A,Ft,D,Qt,Wr,it)||!1)?(er||typeof xe.UNSAFE_componentWillUpdate!="function"&&typeof xe.componentWillUpdate!="function"||(typeof xe.componentWillUpdate=="function"&&xe.componentWillUpdate(D,Wr,it),typeof xe.UNSAFE_componentWillUpdate=="function"&&xe.UNSAFE_componentWillUpdate(D,Wr,it)),typeof xe.componentDidUpdate=="function"&&(y.flags|=4),typeof xe.getSnapshotBeforeUpdate=="function"&&(y.flags|=1024)):(typeof xe.componentDidUpdate!="function"||ze===m.memoizedProps&&Qt===m.memoizedState||(y.flags|=4),typeof xe.getSnapshotBeforeUpdate!="function"||ze===m.memoizedProps&&Qt===m.memoizedState||(y.flags|=1024),y.memoizedProps=D,y.memoizedState=Wr),xe.props=D,xe.state=Wr,xe.context=it,D=Ft):(typeof xe.componentDidUpdate!="function"||ze===m.memoizedProps&&Qt===m.memoizedState||(y.flags|=4),typeof xe.getSnapshotBeforeUpdate!="function"||ze===m.memoizedProps&&Qt===m.memoizedState||(y.flags|=1024),D=!1)}return ts(m,y,A,D,ae,Y)}function ts(m,y,A,D,Y,ae){yn(m,y);var xe=(y.flags&128)!==0;if(!D&&!xe)return Y&&Wb(y,A,!1),ki(m,y,ae);D=y.stateNode,ee.current=y;var ze=xe&&typeof A.getDerivedStateFromError!="function"?null:D.render();return y.flags|=1,m!==null&&xe?(y.child=Hd(y,m.child,null,ae),y.child=Hd(y,null,ze,ae)):je(m,y,ze,ae),y.memoizedState=D.state,Y&&Wb(y,A,!0),y.child}function Vi(m){var y=m.stateNode;y.pendingContext?Rx(m,y.pendingContext,y.pendingContext!==y.context):y.context&&Rx(m,y.context,!1),zu(m,y.containerInfo)}function hc(m,y,A,D,Y){return Wd(),qh(Y),y.flags|=256,je(m,y,A,D),y.child}var Pt={dehydrated:null,treeContext:null,retryLane:0};function bt(m){return{baseLanes:m,cachePool:null,transitions:null}}function zt(m,y,A){var D=y.pendingProps,Y=xs.current,ae=!1,xe=(y.flags&128)!==0,ze;if((ze=xe)||(ze=m!==null&&m.memoizedState===null?!1:(Y&2)!==0),ze?(ae=!0,y.flags&=-129):(m===null||m.memoizedState!==null)&&(Y|=1),is(xs,Y&1),m===null)return of(y),m=y.memoizedState,m!==null&&(m=m.dehydrated,m!==null)?((y.mode&1)===0?y.lanes=1:m.data==="$!"?y.lanes=8:y.lanes=1073741824,null):(xe=D.children,m=D.fallback,ae?(D=y.mode,ae=y.child,xe={mode:"hidden",children:xe},(D&1)===0&&ae!==null?(ae.childLanes=0,ae.pendingProps=xe):ae=hw(xe,D,0,null),m=sm(m,D,A,null),ae.return=y,m.return=y,ae.sibling=m,y.child=ae,y.child.memoizedState=bt(A),y.memoizedState=Pt,m):Ar(y,xe));if(Y=m.memoizedState,Y!==null&&(ze=Y.dehydrated,ze!==null))return kn(m,y,xe,D,ze,Y,A);if(ae){ae=D.fallback,xe=y.mode,Y=m.child,ze=Y.sibling;var it={mode:"hidden",children:D.children};return(xe&1)===0&&y.child!==Y?(D=y.child,D.childLanes=0,D.pendingProps=it,y.deletions=null):(D=Nf(Y,it),D.subtreeFlags=Y.subtreeFlags&14680064),ze!==null?ae=Nf(ze,ae):(ae=sm(ae,xe,A,null),ae.flags|=2),ae.return=y,D.return=y,D.sibling=ae,y.child=D,D=ae,ae=y.child,xe=m.child.memoizedState,xe=xe===null?bt(A):{baseLanes:xe.baseLanes|A,cachePool:null,transitions:xe.transitions},ae.memoizedState=xe,ae.childLanes=m.childLanes&~A,y.memoizedState=Pt,D}return ae=m.child,m=ae.sibling,D=Nf(ae,{mode:"visible",children:D.children}),(y.mode&1)===0&&(D.lanes=A),D.return=y,D.sibling=null,m!==null&&(A=y.deletions,A===null?(y.deletions=[m],y.flags|=16):A.push(m)),y.child=D,y.memoizedState=null,D}function Ar(m,y){return y=hw({mode:"visible",children:y},m.mode,0,null),y.return=m,m.child=y}function Yr(m,y,A,D){return D!==null&&qh(D),Hd(y,m.child,null,A),m=Ar(y,y.pendingProps.children),m.flags|=2,y.memoizedState=null,m}function kn(m,y,A,D,Y,ae,xe){if(A)return y.flags&256?(y.flags&=-257,D=gp(Error(r(422))),Yr(m,y,xe,D)):y.memoizedState!==null?(y.child=m.child,y.flags|=128,null):(ae=D.fallback,Y=y.mode,D=hw({mode:"visible",children:D.children},Y,0,null),ae=sm(ae,Y,xe,null),ae.flags|=2,D.return=y,ae.return=y,D.sibling=ae,y.child=D,(y.mode&1)!==0&&Hd(y,m.child,null,xe),y.child.memoizedState=bt(xe),y.memoizedState=Pt,ae);if((y.mode&1)===0)return Yr(m,y,xe,null);if(Y.data==="$!"){if(D=Y.nextSibling&&Y.nextSibling.dataset,D)var ze=D.dgst;return D=ze,ae=Error(r(419)),D=gp(ae,D,void 0),Yr(m,y,xe,D)}if(ze=(xe&m.childLanes)!==0,ce||ze){if(D=Ci,D!==null){switch(xe&-xe){case 4:Y=2;break;case 16:Y=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:Y=32;break;case 536870912:Y=268435456;break;default:Y=0}Y=(Y&(D.suspendedLanes|xe))!==0?0:Y,Y!==0&&Y!==ae.retryLane&&(ae.retryLane=Y,Uo(m,Y),iu(D,m,Y,-1))}return c5(),D=gp(Error(r(421))),Yr(m,y,xe,D)}return Y.data==="$?"?(y.flags|=128,y.child=m.child,y=xee.bind(null,m),Y._reactRetry=y,null):(m=ae.treeContext,Nr=ac(Y.nextSibling),Lo=y,es=!0,Bo=null,m!==null&&(zi[Wi++]=Io,zi[Wi++]=js,zi[Wi++]=Uu,Io=m.id,js=m.overflow,Uu=y),y=Ar(y,D.children),y.flags|=4096,y)}function vn(m,y,A){m.lanes|=y;var D=m.alternate;D!==null&&(D.lanes|=y),sp(m.return,y,A)}function $n(m,y,A,D,Y){var ae=m.memoizedState;ae===null?m.memoizedState={isBackwards:y,rendering:null,renderingStartTime:0,last:D,tail:A,tailMode:Y}:(ae.isBackwards=y,ae.rendering=null,ae.renderingStartTime=0,ae.last=D,ae.tail=A,ae.tailMode=Y)}function Pa(m,y,A){var D=y.pendingProps,Y=D.revealOrder,ae=D.tail;if(je(m,y,D.children,A),D=xs.current,(D&2)!==0)D=D&1|2,y.flags|=128;else{if(m!==null&&(m.flags&128)!==0)e:for(m=y.child;m!==null;){if(m.tag===13)m.memoizedState!==null&&vn(m,A,y);else if(m.tag===19)vn(m,A,y);else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===y)break e;for(;m.sibling===null;){if(m.return===null||m.return===y)break e;m=m.return}m.sibling.return=m.return,m=m.sibling}D&=1}if(is(xs,D),(y.mode&1)===0)y.memoizedState=null;else switch(Y){case"forwards":for(A=y.child,Y=null;A!==null;)m=A.alternate,m!==null&&ff(m)===null&&(Y=A),A=A.sibling;A=Y,A===null?(Y=y.child,y.child=null):(Y=A.sibling,A.sibling=null),$n(y,!1,Y,A,ae);break;case"backwards":for(A=null,Y=y.child,y.child=null;Y!==null;){if(m=Y.alternate,m!==null&&ff(m)===null){y.child=Y;break}m=Y.sibling,Y.sibling=A,A=Y,Y=m}$n(y,!0,A,null,ae);break;case"together":$n(y,!1,null,null,void 0);break;default:y.memoizedState=null}return y.child}function Ln(m,y){(y.mode&1)===0&&m!==null&&(m.alternate=null,y.alternate=null,y.flags|=2)}function ki(m,y,A){if(m!==null&&(y.dependencies=m.dependencies),em|=y.lanes,(A&y.childLanes)===0)return null;if(m!==null&&y.child!==m.child)throw Error(r(153));if(y.child!==null){for(m=y.child,A=Nf(m,m.pendingProps),y.child=A,A.return=y;m.sibling!==null;)m=m.sibling,A=A.sibling=Nf(m,m.pendingProps),A.return=y;A.sibling=null}return y.child}function K3(m,y,A){switch(y.tag){case 3:Vi(y),Wd();break;case 5:df(y);break;case 1:bi(y.type)&&Bd(y);break;case 4:zu(y,y.stateNode.containerInfo);break;case 10:var D=y.type._context,Y=y.memoizedProps.value;is(Kh,D._currentValue),D._currentValue=Y;break;case 13:if(D=y.memoizedState,D!==null)return D.dehydrated!==null?(is(xs,xs.current&1),y.flags|=128,null):(A&y.child.childLanes)!==0?zt(m,y,A):(is(xs,xs.current&1),m=ki(m,y,A),m!==null?m.sibling:null);is(xs,xs.current&1);break;case 19:if(D=(A&y.childLanes)!==0,(m.flags&128)!==0){if(D)return Pa(m,y,A);y.flags|=128}if(Y=y.memoizedState,Y!==null&&(Y.rendering=null,Y.tail=null,Y.lastEffect=null),is(xs,xs.current),D)break;return null;case 22:case 23:return y.lanes=0,Lr(m,y,A)}return ki(m,y,A)}var Lj,Y3,Bj,$j;Lj=function(m,y){for(var A=y.child;A!==null;){if(A.tag===5||A.tag===6)m.appendChild(A.stateNode);else if(A.tag!==4&&A.child!==null){A.child.return=A,A=A.child;continue}if(A===y)break;for(;A.sibling===null;){if(A.return===null||A.return===y)return;A=A.return}A.sibling.return=A.return,A=A.sibling}},Y3=function(){},Bj=function(m,y,A,D){var Y=m.memoizedProps;if(Y!==D){m=y.stateNode,Aa(os.current);var ae=null;switch(A){case"input":Y=ye(m,Y),D=ye(m,D),ae=[];break;case"select":Y=q({},Y,{value:void 0}),D=q({},D,{value:void 0}),ae=[];break;case"textarea":Y=Te(m,Y),D=Te(m,D),ae=[];break;default:typeof Y.onClick!="function"&&typeof D.onClick=="function"&&(m.onclick=Od)}ar(A,D);var xe;A=null;for(Ft in Y)if(!D.hasOwnProperty(Ft)&&Y.hasOwnProperty(Ft)&&Y[Ft]!=null)if(Ft==="style"){var ze=Y[Ft];for(xe in ze)ze.hasOwnProperty(xe)&&(A||(A={}),A[xe]="")}else Ft!=="dangerouslySetInnerHTML"&&Ft!=="children"&&Ft!=="suppressContentEditableWarning"&&Ft!=="suppressHydrationWarning"&&Ft!=="autoFocus"&&(s.hasOwnProperty(Ft)?ae||(ae=[]):(ae=ae||[]).push(Ft,null));for(Ft in D){var it=D[Ft];if(ze=Y?.[Ft],D.hasOwnProperty(Ft)&&it!==ze&&(it!=null||ze!=null))if(Ft==="style")if(ze){for(xe in ze)!ze.hasOwnProperty(xe)||it&&it.hasOwnProperty(xe)||(A||(A={}),A[xe]="");for(xe in it)it.hasOwnProperty(xe)&&ze[xe]!==it[xe]&&(A||(A={}),A[xe]=it[xe])}else A||(ae||(ae=[]),ae.push(Ft,A)),A=it;else Ft==="dangerouslySetInnerHTML"?(it=it?it.__html:void 0,ze=ze?ze.__html:void 0,it!=null&&ze!==it&&(ae=ae||[]).push(Ft,it)):Ft==="children"?typeof it!="string"&&typeof it!="number"||(ae=ae||[]).push(Ft,""+it):Ft!=="suppressContentEditableWarning"&&Ft!=="suppressHydrationWarning"&&(s.hasOwnProperty(Ft)?(it!=null&&Ft==="onScroll"&&gs("scroll",m),ae||ze===it||(ae=[])):(ae=ae||[]).push(Ft,it))}A&&(ae=ae||[]).push("style",A);var Ft=ae;(y.updateQueue=Ft)&&(y.flags|=4)}},$j=function(m,y,A,D){A!==D&&(y.flags|=4)};function qx(m,y){if(!es)switch(m.tailMode){case"hidden":y=m.tail;for(var A=null;y!==null;)y.alternate!==null&&(A=y),y=y.sibling;A===null?m.tail=null:A.sibling=null;break;case"collapsed":A=m.tail;for(var D=null;A!==null;)A.alternate!==null&&(D=A),A=A.sibling;D===null?y||m.tail===null?m.tail=null:m.tail.sibling=null:D.sibling=null}}function mo(m){var y=m.alternate!==null&&m.alternate.child===m.child,A=0,D=0;if(y)for(var Y=m.child;Y!==null;)A|=Y.lanes|Y.childLanes,D|=Y.subtreeFlags&14680064,D|=Y.flags&14680064,Y.return=m,Y=Y.sibling;else for(Y=m.child;Y!==null;)A|=Y.lanes|Y.childLanes,D|=Y.subtreeFlags,D|=Y.flags,Y.return=m,Y=Y.sibling;return m.subtreeFlags|=D,m.childLanes=A,y}function iee(m,y,A){var D=y.pendingProps;switch(Ha(y),y.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mo(y),null;case 1:return bi(y.type)&&nf(),mo(y),null;case 3:return D=y.stateNode,Fs(),ps(vi),ps(ai),wi(),D.pendingContext&&(D.context=D.pendingContext,D.pendingContext=null),(m===null||m.child===null)&&(Vh(y)?y.flags|=4:m===null||m.memoizedState.isDehydrated&&(y.flags&256)===0||(y.flags|=1024,Bo!==null&&(i5(Bo),Bo=null))),Y3(m,y),mo(y),null;case 5:tu(y);var Y=Aa(na.current);if(A=y.type,m!==null&&y.stateNode!=null)Bj(m,y,A,D,Y),m.ref!==y.ref&&(y.flags|=512,y.flags|=2097152);else{if(!D){if(y.stateNode===null)throw Error(r(166));return mo(y),null}if(m=Aa(os.current),Vh(y)){D=y.stateNode,A=y.type;var ae=y.memoizedProps;switch(D[ol]=y,D[Wh]=ae,m=(y.mode&1)!==0,A){case"dialog":gs("cancel",D),gs("close",D);break;case"iframe":case"object":case"embed":gs("load",D);break;case"video":case"audio":for(Y=0;Y<Ru.length;Y++)gs(Ru[Y],D);break;case"source":gs("error",D);break;case"img":case"image":case"link":gs("error",D),gs("load",D);break;case"details":gs("toggle",D);break;case"input":Ie(D,ae),gs("invalid",D);break;case"select":D._wrapperState={wasMultiple:!!ae.multiple},gs("invalid",D);break;case"textarea":Ve(D,ae),gs("invalid",D)}ar(A,ae),Y=null;for(var xe in ae)if(ae.hasOwnProperty(xe)){var ze=ae[xe];xe==="children"?typeof ze=="string"?D.textContent!==ze&&(ae.suppressHydrationWarning!==!0&&Uh(D.textContent,ze,m),Y=["children",ze]):typeof ze=="number"&&D.textContent!==""+ze&&(ae.suppressHydrationWarning!==!0&&Uh(D.textContent,ze,m),Y=["children",""+ze]):s.hasOwnProperty(xe)&&ze!=null&&xe==="onScroll"&&gs("scroll",D)}switch(A){case"input":we(D),$t(D,ae,!0);break;case"textarea":we(D),wt(D);break;case"select":case"option":break;default:typeof ae.onClick=="function"&&(D.onclick=Od)}D=Y,y.updateQueue=D,D!==null&&(y.flags|=4)}else{xe=Y.nodeType===9?Y:Y.ownerDocument,m==="http://www.w3.org/1999/xhtml"&&(m=Ut(A)),m==="http://www.w3.org/1999/xhtml"?A==="script"?(m=xe.createElement("div"),m.innerHTML="<script><\/script>",m=m.removeChild(m.firstChild)):typeof D.is=="string"?m=xe.createElement(A,{is:D.is}):(m=xe.createElement(A),A==="select"&&(xe=m,D.multiple?xe.multiple=!0:D.size&&(xe.size=D.size))):m=xe.createElementNS(m,A),m[ol]=y,m[Wh]=D,Lj(m,y,!1,!1),y.stateNode=m;e:{switch(xe=dr(A,D),A){case"dialog":gs("cancel",m),gs("close",m),Y=D;break;case"iframe":case"object":case"embed":gs("load",m),Y=D;break;case"video":case"audio":for(Y=0;Y<Ru.length;Y++)gs(Ru[Y],m);Y=D;break;case"source":gs("error",m),Y=D;break;case"img":case"image":case"link":gs("error",m),gs("load",m),Y=D;break;case"details":gs("toggle",m),Y=D;break;case"input":Ie(m,D),Y=ye(m,D),gs("invalid",m);break;case"option":Y=D;break;case"select":m._wrapperState={wasMultiple:!!D.multiple},Y=q({},D,{value:void 0}),gs("invalid",m);break;case"textarea":Ve(m,D),Y=Te(m,D),gs("invalid",m);break;default:Y=D}ar(A,Y),ze=Y;for(ae in ze)if(ze.hasOwnProperty(ae)){var it=ze[ae];ae==="style"?At(m,it):ae==="dangerouslySetInnerHTML"?(it=it?it.__html:void 0,it!=null&&rt(m,it)):ae==="children"?typeof it=="string"?(A!=="textarea"||it!=="")&&Oe(m,it):typeof it=="number"&&Oe(m,""+it):ae!=="suppressContentEditableWarning"&&ae!=="suppressHydrationWarning"&&ae!=="autoFocus"&&(s.hasOwnProperty(ae)?it!=null&&ae==="onScroll"&&gs("scroll",m):it!=null&&_(m,ae,it,xe))}switch(A){case"input":we(m),$t(m,D,!1);break;case"textarea":we(m),wt(m);break;case"option":D.value!=null&&m.setAttribute("value",""+se(D.value));break;case"select":m.multiple=!!D.multiple,ae=D.value,ae!=null?vt(m,!!D.multiple,ae,!1):D.defaultValue!=null&&vt(m,!!D.multiple,D.defaultValue,!0);break;default:typeof Y.onClick=="function"&&(m.onclick=Od)}switch(A){case"button":case"input":case"select":case"textarea":D=!!D.autoFocus;break e;case"img":D=!0;break e;default:D=!1}}D&&(y.flags|=4)}y.ref!==null&&(y.flags|=512,y.flags|=2097152)}return mo(y),null;case 6:if(m&&y.stateNode!=null)$j(m,y,m.memoizedProps,D);else{if(typeof D!="string"&&y.stateNode===null)throw Error(r(166));if(A=Aa(na.current),Aa(os.current),Vh(y)){if(D=y.stateNode,A=y.memoizedProps,D[ol]=y,(ae=D.nodeValue!==A)&&(m=Lo,m!==null))switch(m.tag){case 3:Uh(D.nodeValue,A,(m.mode&1)!==0);break;case 5:m.memoizedProps.suppressHydrationWarning!==!0&&Uh(D.nodeValue,A,(m.mode&1)!==0)}ae&&(y.flags|=4)}else D=(A.nodeType===9?A:A.ownerDocument).createTextNode(D),D[ol]=y,y.stateNode=D}return mo(y),null;case 13:if(ps(xs),D=y.memoizedState,m===null||m.memoizedState!==null&&m.memoizedState.dehydrated!==null){if(es&&Nr!==null&&(y.mode&1)!==0&&(y.flags&128)===0)Dx(),Wd(),y.flags|=98560,ae=!1;else if(ae=Vh(y),D!==null&&D.dehydrated!==null){if(m===null){if(!ae)throw Error(r(318));if(ae=y.memoizedState,ae=ae!==null?ae.dehydrated:null,!ae)throw Error(r(317));ae[ol]=y}else Wd(),(y.flags&128)===0&&(y.memoizedState=null),y.flags|=4;mo(y),ae=!1}else Bo!==null&&(i5(Bo),Bo=null),ae=!0;if(!ae)return y.flags&65536?y:null}return(y.flags&128)!==0?(y.lanes=A,y):(D=D!==null,D!==(m!==null&&m.memoizedState!==null)&&D&&(y.child.flags|=8192,(y.mode&1)!==0&&(m===null||(xs.current&1)!==0?oi===0&&(oi=3):c5())),y.updateQueue!==null&&(y.flags|=4),mo(y),null);case 4:return Fs(),Y3(m,y),m===null&&Md(y.stateNode.containerInfo),mo(y),null;case 10:return np(y.type._context),mo(y),null;case 17:return bi(y.type)&&nf(),mo(y),null;case 19:if(ps(xs),ae=y.memoizedState,ae===null)return mo(y),null;if(D=(y.flags&128)!==0,xe=ae.rendering,xe===null)if(D)qx(ae,!1);else{if(oi!==0||m!==null&&(m.flags&128)!==0)for(m=y.child;m!==null;){if(xe=ff(m),xe!==null){for(y.flags|=128,qx(ae,!1),D=xe.updateQueue,D!==null&&(y.updateQueue=D,y.flags|=4),y.subtreeFlags=0,D=A,A=y.child;A!==null;)ae=A,m=D,ae.flags&=14680066,xe=ae.alternate,xe===null?(ae.childLanes=0,ae.lanes=m,ae.child=null,ae.subtreeFlags=0,ae.memoizedProps=null,ae.memoizedState=null,ae.updateQueue=null,ae.dependencies=null,ae.stateNode=null):(ae.childLanes=xe.childLanes,ae.lanes=xe.lanes,ae.child=xe.child,ae.subtreeFlags=0,ae.deletions=null,ae.memoizedProps=xe.memoizedProps,ae.memoizedState=xe.memoizedState,ae.updateQueue=xe.updateQueue,ae.type=xe.type,m=xe.dependencies,ae.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),A=A.sibling;return is(xs,xs.current&1|2),y.child}m=m.sibling}ae.tail!==null&&tt()>yp&&(y.flags|=128,D=!0,qx(ae,!1),y.lanes=4194304)}else{if(!D)if(m=ff(xe),m!==null){if(y.flags|=128,D=!0,A=m.updateQueue,A!==null&&(y.updateQueue=A,y.flags|=4),qx(ae,!0),ae.tail===null&&ae.tailMode==="hidden"&&!xe.alternate&&!es)return mo(y),null}else 2*tt()-ae.renderingStartTime>yp&&A!==1073741824&&(y.flags|=128,D=!0,qx(ae,!1),y.lanes=4194304);ae.isBackwards?(xe.sibling=y.child,y.child=xe):(A=ae.last,A!==null?A.sibling=xe:y.child=xe,ae.last=xe)}return ae.tail!==null?(y=ae.tail,ae.rendering=y,ae.tail=y.sibling,ae.renderingStartTime=tt(),y.sibling=null,A=xs.current,is(xs,D?A&1|2:A&1),y):(mo(y),null);case 22:case 23:return l5(),D=y.memoizedState!==null,m!==null&&m.memoizedState!==null!==D&&(y.flags|=8192),D&&(y.mode&1)!==0?(Il&1073741824)!==0&&(mo(y),y.subtreeFlags&6&&(y.flags|=8192)):mo(y),null;case 24:return null;case 25:return null}throw Error(r(156,y.tag))}function oee(m,y){switch(Ha(y),y.tag){case 1:return bi(y.type)&&nf(),m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 3:return Fs(),ps(vi),ps(ai),wi(),m=y.flags,(m&65536)!==0&&(m&128)===0?(y.flags=m&-65537|128,y):null;case 5:return tu(y),null;case 13:if(ps(xs),m=y.memoizedState,m!==null&&m.dehydrated!==null){if(y.alternate===null)throw Error(r(340));Wd()}return m=y.flags,m&65536?(y.flags=m&-65537|128,y):null;case 19:return ps(xs),null;case 4:return Fs(),null;case 10:return np(y.type._context),null;case 22:case 23:return l5(),null;case 24:return null;default:return null}}var rw=!1,go=!1,lee=typeof WeakSet=="function"?WeakSet:Set,Ur=null;function pp(m,y){var A=m.ref;if(A!==null)if(typeof A=="function")try{A(null)}catch(D){ga(m,y,D)}else A.current=null}function X3(m,y,A){try{A()}catch(D){ga(m,y,D)}}var Uj=!1;function cee(m,y){if(jx=Ag,m=Na(),Z0(m)){if("selectionStart"in m)var A={start:m.selectionStart,end:m.selectionEnd};else e:{A=(A=m.ownerDocument)&&A.defaultView||window;var D=A.getSelection&&A.getSelection();if(D&&D.rangeCount!==0){A=D.anchorNode;var Y=D.anchorOffset,ae=D.focusNode;D=D.focusOffset;try{A.nodeType,ae.nodeType}catch{A=null;break e}var xe=0,ze=-1,it=-1,Ft=0,er=0,nr=m,Qt=null;t:for(;;){for(var Or;nr!==A||Y!==0&&nr.nodeType!==3||(ze=xe+Y),nr!==ae||D!==0&&nr.nodeType!==3||(it=xe+D),nr.nodeType===3&&(xe+=nr.nodeValue.length),(Or=nr.firstChild)!==null;)Qt=nr,nr=Or;for(;;){if(nr===m)break t;if(Qt===A&&++Ft===Y&&(ze=xe),Qt===ae&&++er===D&&(it=xe),(Or=nr.nextSibling)!==null)break;nr=Qt,Qt=nr.parentNode}nr=Or}A=ze===-1||it===-1?null:{start:ze,end:it}}else A=null}A=A||{start:0,end:0}}else A=null;for(Px={focusedElem:m,selectionRange:A},Ag=!1,Ur=y;Ur!==null;)if(y=Ur,m=y.child,(y.subtreeFlags&1028)!==0&&m!==null)m.return=y,Ur=m;else for(;Ur!==null;){y=Ur;try{var Wr=y.alternate;if((y.flags&1024)!==0)switch(y.tag){case 0:case 11:case 15:break;case 1:if(Wr!==null){var Hr=Wr.memoizedProps,Fa=Wr.memoizedState,kt=y.stateNode,gt=kt.getSnapshotBeforeUpdate(y.elementType===y.type?Hr:ii(y.type,Hr),Fa);kt.__reactInternalSnapshotBeforeUpdate=gt}break;case 3:var Et=y.stateNode.containerInfo;Et.nodeType===1?Et.textContent="":Et.nodeType===9&&Et.documentElement&&Et.removeChild(Et.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(fr){ga(y,y.return,fr)}if(m=y.sibling,m!==null){m.return=y.return,Ur=m;break}Ur=y.return}return Wr=Uj,Uj=!1,Wr}function Kx(m,y,A){var D=y.updateQueue;if(D=D!==null?D.lastEffect:null,D!==null){var Y=D=D.next;do{if((Y.tag&m)===m){var ae=Y.destroy;Y.destroy=void 0,ae!==void 0&&X3(y,A,ae)}Y=Y.next}while(Y!==D)}}function nw(m,y){if(y=y.updateQueue,y=y!==null?y.lastEffect:null,y!==null){var A=y=y.next;do{if((A.tag&m)===m){var D=A.create;A.destroy=D()}A=A.next}while(A!==y)}}function J3(m){var y=m.ref;if(y!==null){var A=m.stateNode;switch(m.tag){case 5:m=A;break;default:m=A}typeof y=="function"?y(m):y.current=m}}function zj(m){var y=m.alternate;y!==null&&(m.alternate=null,zj(y)),m.child=null,m.deletions=null,m.sibling=null,m.tag===5&&(y=m.stateNode,y!==null&&(delete y[ol],delete y[Wh],delete y[Yg],delete y[Ub],delete y[zb])),m.stateNode=null,m.return=null,m.dependencies=null,m.memoizedProps=null,m.memoizedState=null,m.pendingProps=null,m.stateNode=null,m.updateQueue=null}function Wj(m){return m.tag===5||m.tag===3||m.tag===4}function Hj(m){e:for(;;){for(;m.sibling===null;){if(m.return===null||Wj(m.return))return null;m=m.return}for(m.sibling.return=m.return,m=m.sibling;m.tag!==5&&m.tag!==6&&m.tag!==18;){if(m.flags&2||m.child===null||m.tag===4)continue e;m.child.return=m,m=m.child}if(!(m.flags&2))return m.stateNode}}function Q3(m,y,A){var D=m.tag;if(D===5||D===6)m=m.stateNode,y?A.nodeType===8?A.parentNode.insertBefore(m,y):A.insertBefore(m,y):(A.nodeType===8?(y=A.parentNode,y.insertBefore(m,A)):(y=A,y.appendChild(m)),A=A._reactRootContainer,A!=null||y.onclick!==null||(y.onclick=Od));else if(D!==4&&(m=m.child,m!==null))for(Q3(m,y,A),m=m.sibling;m!==null;)Q3(m,y,A),m=m.sibling}function Z3(m,y,A){var D=m.tag;if(D===5||D===6)m=m.stateNode,y?A.insertBefore(m,y):A.appendChild(m);else if(D!==4&&(m=m.child,m!==null))for(Z3(m,y,A),m=m.sibling;m!==null;)Z3(m,y,A),m=m.sibling}var qi=null,su=!1;function _f(m,y,A){for(A=A.child;A!==null;)Gj(m,y,A),A=A.sibling}function Gj(m,y,A){if(Tr&&typeof Tr.onCommitFiberUnmount=="function")try{Tr.onCommitFiberUnmount(Mr,A)}catch{}switch(A.tag){case 5:go||pp(A,y);case 6:var D=qi,Y=su;qi=null,_f(m,y,A),qi=D,su=Y,qi!==null&&(su?(m=qi,A=A.stateNode,m.nodeType===8?m.parentNode.removeChild(A):m.removeChild(A)):qi.removeChild(A.stateNode));break;case 18:qi!==null&&(su?(m=qi,A=A.stateNode,m.nodeType===8?Kg(m.parentNode,A):m.nodeType===1&&Kg(m,A),co(m)):Kg(qi,A.stateNode));break;case 4:D=qi,Y=su,qi=A.stateNode.containerInfo,su=!0,_f(m,y,A),qi=D,su=Y;break;case 0:case 11:case 14:case 15:if(!go&&(D=A.updateQueue,D!==null&&(D=D.lastEffect,D!==null))){Y=D=D.next;do{var ae=Y,xe=ae.destroy;ae=ae.tag,xe!==void 0&&((ae&2)!==0||(ae&4)!==0)&&X3(A,y,xe),Y=Y.next}while(Y!==D)}_f(m,y,A);break;case 1:if(!go&&(pp(A,y),D=A.stateNode,typeof D.componentWillUnmount=="function"))try{D.props=A.memoizedProps,D.state=A.memoizedState,D.componentWillUnmount()}catch(ze){ga(A,y,ze)}_f(m,y,A);break;case 21:_f(m,y,A);break;case 22:A.mode&1?(go=(D=go)||A.memoizedState!==null,_f(m,y,A),go=D):_f(m,y,A);break;default:_f(m,y,A)}}function Vj(m){var y=m.updateQueue;if(y!==null){m.updateQueue=null;var A=m.stateNode;A===null&&(A=m.stateNode=new lee),y.forEach(function(D){var Y=yee.bind(null,m,D);A.has(D)||(A.add(D),D.then(Y,Y))})}}function au(m,y){var A=y.deletions;if(A!==null)for(var D=0;D<A.length;D++){var Y=A[D];try{var ae=m,xe=y,ze=xe;e:for(;ze!==null;){switch(ze.tag){case 5:qi=ze.stateNode,su=!1;break e;case 3:qi=ze.stateNode.containerInfo,su=!0;break e;case 4:qi=ze.stateNode.containerInfo,su=!0;break e}ze=ze.return}if(qi===null)throw Error(r(160));Gj(ae,xe,Y),qi=null,su=!1;var it=Y.alternate;it!==null&&(it.return=null),Y.return=null}catch(Ft){ga(Y,y,Ft)}}if(y.subtreeFlags&12854)for(y=y.child;y!==null;)qj(y,m),y=y.sibling}function qj(m,y){var A=m.alternate,D=m.flags;switch(m.tag){case 0:case 11:case 14:case 15:if(au(y,m),qu(m),D&4){try{Kx(3,m,m.return),nw(3,m)}catch(Hr){ga(m,m.return,Hr)}try{Kx(5,m,m.return)}catch(Hr){ga(m,m.return,Hr)}}break;case 1:au(y,m),qu(m),D&512&&A!==null&&pp(A,A.return);break;case 5:if(au(y,m),qu(m),D&512&&A!==null&&pp(A,A.return),m.flags&32){var Y=m.stateNode;try{Oe(Y,"")}catch(Hr){ga(m,m.return,Hr)}}if(D&4&&(Y=m.stateNode,Y!=null)){var ae=m.memoizedProps,xe=A!==null?A.memoizedProps:ae,ze=m.type,it=m.updateQueue;if(m.updateQueue=null,it!==null)try{ze==="input"&&ae.type==="radio"&&ae.name!=null&&ut(Y,ae),dr(ze,xe);var Ft=dr(ze,ae);for(xe=0;xe<it.length;xe+=2){var er=it[xe],nr=it[xe+1];er==="style"?At(Y,nr):er==="dangerouslySetInnerHTML"?rt(Y,nr):er==="children"?Oe(Y,nr):_(Y,er,nr,Ft)}switch(ze){case"input":Qe(Y,ae);break;case"textarea":pt(Y,ae);break;case"select":var Qt=Y._wrapperState.wasMultiple;Y._wrapperState.wasMultiple=!!ae.multiple;var Or=ae.value;Or!=null?vt(Y,!!ae.multiple,Or,!1):Qt!==!!ae.multiple&&(ae.defaultValue!=null?vt(Y,!!ae.multiple,ae.defaultValue,!0):vt(Y,!!ae.multiple,ae.multiple?[]:"",!1))}Y[Wh]=ae}catch(Hr){ga(m,m.return,Hr)}}break;case 6:if(au(y,m),qu(m),D&4){if(m.stateNode===null)throw Error(r(162));Y=m.stateNode,ae=m.memoizedProps;try{Y.nodeValue=ae}catch(Hr){ga(m,m.return,Hr)}}break;case 3:if(au(y,m),qu(m),D&4&&A!==null&&A.memoizedState.isDehydrated)try{co(y.containerInfo)}catch(Hr){ga(m,m.return,Hr)}break;case 4:au(y,m),qu(m);break;case 13:au(y,m),qu(m),Y=m.child,Y.flags&8192&&(ae=Y.memoizedState!==null,Y.stateNode.isHidden=ae,!ae||Y.alternate!==null&&Y.alternate.memoizedState!==null||(r5=tt())),D&4&&Vj(m);break;case 22:if(er=A!==null&&A.memoizedState!==null,m.mode&1?(go=(Ft=go)||er,au(y,m),go=Ft):au(y,m),qu(m),D&8192){if(Ft=m.memoizedState!==null,(m.stateNode.isHidden=Ft)&&!er&&(m.mode&1)!==0)for(Ur=m,er=m.child;er!==null;){for(nr=Ur=er;Ur!==null;){switch(Qt=Ur,Or=Qt.child,Qt.tag){case 0:case 11:case 14:case 15:Kx(4,Qt,Qt.return);break;case 1:pp(Qt,Qt.return);var Wr=Qt.stateNode;if(typeof Wr.componentWillUnmount=="function"){D=Qt,A=Qt.return;try{y=D,Wr.props=y.memoizedProps,Wr.state=y.memoizedState,Wr.componentWillUnmount()}catch(Hr){ga(D,A,Hr)}}break;case 5:pp(Qt,Qt.return);break;case 22:if(Qt.memoizedState!==null){Xj(nr);continue}}Or!==null?(Or.return=Qt,Ur=Or):Xj(nr)}er=er.sibling}e:for(er=null,nr=m;;){if(nr.tag===5){if(er===null){er=nr;try{Y=nr.stateNode,Ft?(ae=Y.style,typeof ae.setProperty=="function"?ae.setProperty("display","none","important"):ae.display="none"):(ze=nr.stateNode,it=nr.memoizedProps.style,xe=it!=null&&it.hasOwnProperty("display")?it.display:null,ze.style.display=It("display",xe))}catch(Hr){ga(m,m.return,Hr)}}}else if(nr.tag===6){if(er===null)try{nr.stateNode.nodeValue=Ft?"":nr.memoizedProps}catch(Hr){ga(m,m.return,Hr)}}else if((nr.tag!==22&&nr.tag!==23||nr.memoizedState===null||nr===m)&&nr.child!==null){nr.child.return=nr,nr=nr.child;continue}if(nr===m)break e;for(;nr.sibling===null;){if(nr.return===null||nr.return===m)break e;er===nr&&(er=null),nr=nr.return}er===nr&&(er=null),nr.sibling.return=nr.return,nr=nr.sibling}}break;case 19:au(y,m),qu(m),D&4&&Vj(m);break;case 21:break;default:au(y,m),qu(m)}}function qu(m){var y=m.flags;if(y&2){try{e:{for(var A=m.return;A!==null;){if(Wj(A)){var D=A;break e}A=A.return}throw Error(r(160))}switch(D.tag){case 5:var Y=D.stateNode;D.flags&32&&(Oe(Y,""),D.flags&=-33);var ae=Hj(m);Z3(m,ae,Y);break;case 3:case 4:var xe=D.stateNode.containerInfo,ze=Hj(m);Q3(m,ze,xe);break;default:throw Error(r(161))}}catch(it){ga(m,m.return,it)}m.flags&=-3}y&4096&&(m.flags&=-4097)}function uee(m,y,A){Ur=m,Kj(m)}function Kj(m,y,A){for(var D=(m.mode&1)!==0;Ur!==null;){var Y=Ur,ae=Y.child;if(Y.tag===22&&D){var xe=Y.memoizedState!==null||rw;if(!xe){var ze=Y.alternate,it=ze!==null&&ze.memoizedState!==null||go;ze=rw;var Ft=go;if(rw=xe,(go=it)&&!Ft)for(Ur=Y;Ur!==null;)xe=Ur,it=xe.child,xe.tag===22&&xe.memoizedState!==null?Jj(Y):it!==null?(it.return=xe,Ur=it):Jj(Y);for(;ae!==null;)Ur=ae,Kj(ae),ae=ae.sibling;Ur=Y,rw=ze,go=Ft}Yj(m)}else(Y.subtreeFlags&8772)!==0&&ae!==null?(ae.return=Y,Ur=ae):Yj(m)}}function Yj(m){for(;Ur!==null;){var y=Ur;if((y.flags&8772)!==0){var A=y.alternate;try{if((y.flags&8772)!==0)switch(y.tag){case 0:case 11:case 15:go||nw(5,y);break;case 1:var D=y.stateNode;if(y.flags&4&&!go)if(A===null)D.componentDidMount();else{var Y=y.elementType===y.type?A.memoizedProps:ii(y.type,A.memoizedProps);D.componentDidUpdate(Y,A.memoizedState,D.__reactInternalSnapshotBeforeUpdate)}var ae=y.updateQueue;ae!==null&&Ks(y,ae,D);break;case 3:var xe=y.updateQueue;if(xe!==null){if(A=null,y.child!==null)switch(y.child.tag){case 5:A=y.child.stateNode;break;case 1:A=y.child.stateNode}Ks(y,xe,A)}break;case 5:var ze=y.stateNode;if(A===null&&y.flags&4){A=ze;var it=y.memoizedProps;switch(y.type){case"button":case"input":case"select":case"textarea":it.autoFocus&&A.focus();break;case"img":it.src&&(A.src=it.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(y.memoizedState===null){var Ft=y.alternate;if(Ft!==null){var er=Ft.memoizedState;if(er!==null){var nr=er.dehydrated;nr!==null&&co(nr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}go||y.flags&512&&J3(y)}catch(Qt){ga(y,y.return,Qt)}}if(y===m){Ur=null;break}if(A=y.sibling,A!==null){A.return=y.return,Ur=A;break}Ur=y.return}}function Xj(m){for(;Ur!==null;){var y=Ur;if(y===m){Ur=null;break}var A=y.sibling;if(A!==null){A.return=y.return,Ur=A;break}Ur=y.return}}function Jj(m){for(;Ur!==null;){var y=Ur;try{switch(y.tag){case 0:case 11:case 15:var A=y.return;try{nw(4,y)}catch(it){ga(y,A,it)}break;case 1:var D=y.stateNode;if(typeof D.componentDidMount=="function"){var Y=y.return;try{D.componentDidMount()}catch(it){ga(y,Y,it)}}var ae=y.return;try{J3(y)}catch(it){ga(y,ae,it)}break;case 5:var xe=y.return;try{J3(y)}catch(it){ga(y,xe,it)}}}catch(it){ga(y,y.return,it)}if(y===m){Ur=null;break}var ze=y.sibling;if(ze!==null){ze.return=y.return,Ur=ze;break}Ur=y.return}}var dee=Math.ceil,sw=T.ReactCurrentDispatcher,e5=T.ReactCurrentOwner,mc=T.ReactCurrentBatchConfig,Wn=0,Ci=null,Ga=null,Ki=0,Il=0,xp=Qc(0),oi=0,Yx=null,em=0,aw=0,t5=0,Xx=null,ul=null,r5=0,yp=1/0,Kd=null,iw=!1,n5=null,Sf=null,ow=!1,kf=null,lw=0,Jx=0,s5=null,cw=-1,uw=0;function Wo(){return(Wn&6)!==0?tt():cw!==-1?cw:cw=tt()}function Cf(m){return(m.mode&1)===0?1:(Wn&2)!==0&&Ki!==0?Ki&-Ki:Ix.transition!==null?(uw===0&&(uw=On()),uw):(m=xn,m!==0||(m=window.event,m=m===void 0?16:kb(m.type)),m)}function iu(m,y,A,D){if(50<Jx)throw Jx=0,s5=null,Error(r(185));ns(m,A,D),((Wn&2)===0||m!==Ci)&&(m===Ci&&((Wn&2)===0&&(aw|=A),oi===4&&Tf(m,Ki)),dl(m,D),A===1&&Wn===0&&(y.mode&1)===0&&(yp=tt()+500,sf&&Lu()))}function dl(m,y){var A=m.callbackNode;Fr(m,y);var D=Ce(m,m===Ci?Ki:0);if(D===0)A!==null&&Se(A),m.callbackNode=null,m.callbackPriority=0;else if(y=D&-D,m.callbackPriority!==y){if(A!=null&&Se(A),y===1)m.tag===0?Zc(Zj.bind(null,m)):Gh(Zj.bind(null,m)),Bb(function(){(Wn&6)===0&&Lu()}),A=null;else{switch(Al(D)){case 1:A=kr;break;case 4:A=jr;break;case 16:A=_t;break;case 536870912:A=Gr;break;default:A=_t}A=o9(A,Qj.bind(null,m))}m.callbackPriority=y,m.callbackNode=A}}function Qj(m,y){if(cw=-1,uw=0,(Wn&6)!==0)throw Error(r(327));var A=m.callbackNode;if(vp()&&m.callbackNode!==A)return null;var D=Ce(m,m===Ci?Ki:0);if(D===0)return null;if((D&30)!==0||(D&m.expiredLanes)!==0||y)y=dw(m,D);else{y=D;var Y=Wn;Wn|=2;var ae=t9();(Ci!==m||Ki!==y)&&(Kd=null,yp=tt()+500,rm(m,y));do try{mee();break}catch(ze){e9(m,ze)}while(!0);rp(),sw.current=ae,Wn=Y,Ga!==null?y=0:(Ci=null,Ki=0,y=oi)}if(y!==0){if(y===2&&(Y=Kr(m),Y!==0&&(D=Y,y=a5(m,Y))),y===1)throw A=Yx,rm(m,0),Tf(m,D),dl(m,tt()),A;if(y===6)Tf(m,D);else{if(Y=m.current.alternate,(D&30)===0&&!fee(Y)&&(y=dw(m,D),y===2&&(ae=Kr(m),ae!==0&&(D=ae,y=a5(m,ae))),y===1))throw A=Yx,rm(m,0),Tf(m,D),dl(m,tt()),A;switch(m.finishedWork=Y,m.finishedLanes=D,y){case 0:case 1:throw Error(r(345));case 2:nm(m,ul,Kd);break;case 3:if(Tf(m,D),(D&130023424)===D&&(y=r5+500-tt(),10<y)){if(Ce(m,0)!==0)break;if(Y=m.suspendedLanes,(Y&D)!==D){Wo(),m.pingedLanes|=m.suspendedLanes&Y;break}m.timeoutHandle=Do(nm.bind(null,m,ul,Kd),y);break}nm(m,ul,Kd);break;case 4:if(Tf(m,D),(D&4194240)===D)break;for(y=m.eventTimes,Y=-1;0<D;){var xe=31-$r(D);ae=1<<xe,xe=y[xe],xe>Y&&(Y=xe),D&=~ae}if(D=Y,D=tt()-D,D=(120>D?120:480>D?480:1080>D?1080:1920>D?1920:3e3>D?3e3:4320>D?4320:1960*dee(D/1960))-D,10<D){m.timeoutHandle=Do(nm.bind(null,m,ul,Kd),D);break}nm(m,ul,Kd);break;case 5:nm(m,ul,Kd);break;default:throw Error(r(329))}}}return dl(m,tt()),m.callbackNode===A?Qj.bind(null,m):null}function a5(m,y){var A=Xx;return m.current.memoizedState.isDehydrated&&(rm(m,y).flags|=256),m=dw(m,y),m!==2&&(y=ul,ul=A,y!==null&&i5(y)),m}function i5(m){ul===null?ul=m:ul.push.apply(ul,m)}function fee(m){for(var y=m;;){if(y.flags&16384){var A=y.updateQueue;if(A!==null&&(A=A.stores,A!==null))for(var D=0;D<A.length;D++){var Y=A[D],ae=Y.getSnapshot;Y=Y.value;try{if(!fo(ae(),Y))return!1}catch{return!1}}}if(A=y.child,y.subtreeFlags&16384&&A!==null)A.return=y,y=A;else{if(y===m)break;for(;y.sibling===null;){if(y.return===null||y.return===m)return!0;y=y.return}y.sibling.return=y.return,y=y.sibling}}return!0}function Tf(m,y){for(y&=~t5,y&=~aw,m.suspendedLanes|=y,m.pingedLanes&=~y,m=m.expirationTimes;0<y;){var A=31-$r(y),D=1<<A;m[A]=-1,y&=~D}}function Zj(m){if((Wn&6)!==0)throw Error(r(327));vp();var y=Ce(m,0);if((y&1)===0)return dl(m,tt()),null;var A=dw(m,y);if(m.tag!==0&&A===2){var D=Kr(m);D!==0&&(y=D,A=a5(m,D))}if(A===1)throw A=Yx,rm(m,0),Tf(m,y),dl(m,tt()),A;if(A===6)throw Error(r(345));return m.finishedWork=m.current.alternate,m.finishedLanes=y,nm(m,ul,Kd),dl(m,tt()),null}function o5(m,y){var A=Wn;Wn|=1;try{return m(y)}finally{Wn=A,Wn===0&&(yp=tt()+500,sf&&Lu())}}function tm(m){kf!==null&&kf.tag===0&&(Wn&6)===0&&vp();var y=Wn;Wn|=1;var A=mc.transition,D=xn;try{if(mc.transition=null,xn=1,m)return m()}finally{xn=D,mc.transition=A,Wn=y,(Wn&6)===0&&Lu()}}function l5(){Il=xp.current,ps(xp)}function rm(m,y){m.finishedWork=null,m.finishedLanes=0;var A=m.timeoutHandle;if(A!==-1&&(m.timeoutHandle=-1,Mx(A)),Ga!==null)for(A=Ga.return;A!==null;){var D=A;switch(Ha(D),D.tag){case 1:D=D.type.childContextTypes,D!=null&&nf();break;case 3:Fs(),ps(vi),ps(ai),wi();break;case 5:tu(D);break;case 4:Fs();break;case 13:ps(xs);break;case 19:ps(xs);break;case 10:np(D.type._context);break;case 22:case 23:l5()}A=A.return}if(Ci=m,Ga=m=Nf(m.current,null),Ki=Il=y,oi=0,Yx=null,t5=aw=em=0,ul=Xx=null,cc!==null){for(y=0;y<cc.length;y++)if(A=cc[y],D=A.interleaved,D!==null){A.interleaved=null;var Y=D.next,ae=A.pending;if(ae!==null){var xe=ae.next;ae.next=Y,D.next=xe}A.pending=D}cc=null}return m}function e9(m,y){do{var A=Ga;try{if(rp(),hf.current=yf,Dl){for(var D=ss.memoizedState;D!==null;){var Y=D.queue;Y!==null&&(Y.pending=null),D=D.next}Dl=!1}if(Gi=0,ha=Ys=ss=null,Wu=!1,cl=0,e5.current=null,A===null||A.return===null){oi=1,Yx=y,Ga=null;break}e:{var ae=m,xe=A.return,ze=A,it=y;if(y=Ki,ze.flags|=32768,it!==null&&typeof it=="object"&&typeof it.then=="function"){var Ft=it,er=ze,nr=er.tag;if((er.mode&1)===0&&(nr===0||nr===11||nr===15)){var Qt=er.alternate;Qt?(er.updateQueue=Qt.updateQueue,er.memoizedState=Qt.memoizedState,er.lanes=Qt.lanes):(er.updateQueue=null,er.memoizedState=null)}var Or=O(xe);if(Or!==null){Or.flags&=-257,V(Or,xe,ze,ae,y),Or.mode&1&&k(ae,Ft,y),y=Or,it=Ft;var Wr=y.updateQueue;if(Wr===null){var Hr=new Set;Hr.add(it),y.updateQueue=Hr}else Wr.add(it);break e}else{if((y&1)===0){k(ae,Ft,y),c5();break e}it=Error(r(426))}}else if(es&&ze.mode&1){var Fa=O(xe);if(Fa!==null){(Fa.flags&65536)===0&&(Fa.flags|=256),V(Fa,xe,ze,ae,y),qh(qd(it,ze));break e}}ae=it=qd(it,ze),oi!==4&&(oi=2),Xx===null?Xx=[ae]:Xx.push(ae),ae=xe;do{switch(ae.tag){case 3:ae.flags|=65536,y&=-y,ae.lanes|=y;var kt=tw(ae,it,y);Jh(ae,kt);break e;case 1:ze=it;var gt=ae.type,Et=ae.stateNode;if((ae.flags&128)===0&&(typeof gt.getDerivedStateFromError=="function"||Et!==null&&typeof Et.componentDidCatch=="function"&&(Sf===null||!Sf.has(Et)))){ae.flags|=65536,y&=-y,ae.lanes|=y;var fr=S(ae,ze,y);Jh(ae,fr);break e}}ae=ae.return}while(ae!==null)}n9(A)}catch(Vr){y=Vr,Ga===A&&A!==null&&(Ga=A=A.return);continue}break}while(!0)}function t9(){var m=sw.current;return sw.current=yf,m===null?yf:m}function c5(){(oi===0||oi===3||oi===2)&&(oi=4),Ci===null||(em&268435455)===0&&(aw&268435455)===0||Tf(Ci,Ki)}function dw(m,y){var A=Wn;Wn|=2;var D=t9();(Ci!==m||Ki!==y)&&(Kd=null,rm(m,y));do try{hee();break}catch(Y){e9(m,Y)}while(!0);if(rp(),Wn=A,sw.current=D,Ga!==null)throw Error(r(261));return Ci=null,Ki=0,oi}function hee(){for(;Ga!==null;)r9(Ga)}function mee(){for(;Ga!==null&&!De();)r9(Ga)}function r9(m){var y=i9(m.alternate,m,Il);m.memoizedProps=m.pendingProps,y===null?n9(m):Ga=y,e5.current=null}function n9(m){var y=m;do{var A=y.alternate;if(m=y.return,(y.flags&32768)===0){if(A=iee(A,y,Il),A!==null){Ga=A;return}}else{if(A=oee(A,y),A!==null){A.flags&=32767,Ga=A;return}if(m!==null)m.flags|=32768,m.subtreeFlags=0,m.deletions=null;else{oi=6,Ga=null;return}}if(y=y.sibling,y!==null){Ga=y;return}Ga=y=m}while(y!==null);oi===0&&(oi=5)}function nm(m,y,A){var D=xn,Y=mc.transition;try{mc.transition=null,xn=1,gee(m,y,A,D)}finally{mc.transition=Y,xn=D}return null}function gee(m,y,A,D){do vp();while(kf!==null);if((Wn&6)!==0)throw Error(r(327));A=m.finishedWork;var Y=m.finishedLanes;if(A===null)return null;if(m.finishedWork=null,m.finishedLanes=0,A===m.current)throw Error(r(177));m.callbackNode=null,m.callbackPriority=0;var ae=A.lanes|A.childLanes;if(ta(m,ae),m===Ci&&(Ga=Ci=null,Ki=0),(A.subtreeFlags&2064)===0&&(A.flags&2064)===0||ow||(ow=!0,o9(_t,function(){return vp(),null})),ae=(A.flags&15990)!==0,(A.subtreeFlags&15990)!==0||ae){ae=mc.transition,mc.transition=null;var xe=xn;xn=1;var ze=Wn;Wn|=4,e5.current=null,cee(m,A),qj(A,m),Ih(Px),Ag=!!jx,Px=jx=null,m.current=A,uee(A),Le(),Wn=ze,xn=xe,mc.transition=ae}else m.current=A;if(ow&&(ow=!1,kf=m,lw=Y),ae=m.pendingLanes,ae===0&&(Sf=null),qr(A.stateNode),dl(m,tt()),y!==null)for(D=m.onRecoverableError,A=0;A<y.length;A++)Y=y[A],D(Y.value,{componentStack:Y.stack,digest:Y.digest});if(iw)throw iw=!1,m=n5,n5=null,m;return(lw&1)!==0&&m.tag!==0&&vp(),ae=m.pendingLanes,(ae&1)!==0?m===s5?Jx++:(Jx=0,s5=m):Jx=0,Lu(),null}function vp(){if(kf!==null){var m=Al(lw),y=mc.transition,A=xn;try{if(mc.transition=null,xn=16>m?16:m,kf===null)var D=!1;else{if(m=kf,kf=null,lw=0,(Wn&6)!==0)throw Error(r(331));var Y=Wn;for(Wn|=4,Ur=m.current;Ur!==null;){var ae=Ur,xe=ae.child;if((Ur.flags&16)!==0){var ze=ae.deletions;if(ze!==null){for(var it=0;it<ze.length;it++){var Ft=ze[it];for(Ur=Ft;Ur!==null;){var er=Ur;switch(er.tag){case 0:case 11:case 15:Kx(8,er,ae)}var nr=er.child;if(nr!==null)nr.return=er,Ur=nr;else for(;Ur!==null;){er=Ur;var Qt=er.sibling,Or=er.return;if(zj(er),er===Ft){Ur=null;break}if(Qt!==null){Qt.return=Or,Ur=Qt;break}Ur=Or}}}var Wr=ae.alternate;if(Wr!==null){var Hr=Wr.child;if(Hr!==null){Wr.child=null;do{var Fa=Hr.sibling;Hr.sibling=null,Hr=Fa}while(Hr!==null)}}Ur=ae}}if((ae.subtreeFlags&2064)!==0&&xe!==null)xe.return=ae,Ur=xe;else e:for(;Ur!==null;){if(ae=Ur,(ae.flags&2048)!==0)switch(ae.tag){case 0:case 11:case 15:Kx(9,ae,ae.return)}var kt=ae.sibling;if(kt!==null){kt.return=ae.return,Ur=kt;break e}Ur=ae.return}}var gt=m.current;for(Ur=gt;Ur!==null;){xe=Ur;var Et=xe.child;if((xe.subtreeFlags&2064)!==0&&Et!==null)Et.return=xe,Ur=Et;else e:for(xe=gt;Ur!==null;){if(ze=Ur,(ze.flags&2048)!==0)try{switch(ze.tag){case 0:case 11:case 15:nw(9,ze)}}catch(Vr){ga(ze,ze.return,Vr)}if(ze===xe){Ur=null;break e}var fr=ze.sibling;if(fr!==null){fr.return=ze.return,Ur=fr;break e}Ur=ze.return}}if(Wn=Y,Lu(),Tr&&typeof Tr.onPostCommitFiberRoot=="function")try{Tr.onPostCommitFiberRoot(Mr,m)}catch{}D=!0}return D}finally{xn=A,mc.transition=y}}return!1}function s9(m,y,A){y=qd(A,y),y=tw(m,y,1),m=fc(m,y,1),y=Wo(),m!==null&&(ns(m,1,y),dl(m,y))}function ga(m,y,A){if(m.tag===3)s9(m,m,A);else for(;y!==null;){if(y.tag===3){s9(y,m,A);break}else if(y.tag===1){var D=y.stateNode;if(typeof y.type.getDerivedStateFromError=="function"||typeof D.componentDidCatch=="function"&&(Sf===null||!Sf.has(D))){m=qd(A,m),m=S(y,m,1),y=fc(y,m,1),m=Wo(),y!==null&&(ns(y,1,m),dl(y,m));break}}y=y.return}}function pee(m,y,A){var D=m.pingCache;D!==null&&D.delete(y),y=Wo(),m.pingedLanes|=m.suspendedLanes&A,Ci===m&&(Ki&A)===A&&(oi===4||oi===3&&(Ki&130023424)===Ki&&500>tt()-r5?rm(m,0):t5|=A),dl(m,y)}function a9(m,y){y===0&&((m.mode&1)===0?y=1:(y=Zn,Zn<<=1,(Zn&130023424)===0&&(Zn=4194304)));var A=Wo();m=Uo(m,y),m!==null&&(ns(m,y,A),dl(m,A))}function xee(m){var y=m.memoizedState,A=0;y!==null&&(A=y.retryLane),a9(m,A)}function yee(m,y){var A=0;switch(m.tag){case 13:var D=m.stateNode,Y=m.memoizedState;Y!==null&&(A=Y.retryLane);break;case 19:D=m.stateNode;break;default:throw Error(r(314))}D!==null&&D.delete(y),a9(m,A)}var i9;i9=function(m,y,A){if(m!==null)if(m.memoizedProps!==y.pendingProps||vi.current)ce=!0;else{if((m.lanes&A)===0&&(y.flags&128)===0)return ce=!1,K3(m,y,A);ce=(m.flags&131072)!==0}else ce=!1,es&&(y.flags&1048576)!==0&&Hb(y,$u,y.index);switch(y.lanes=0,y.tag){case 2:var D=y.type;Ln(m,y),m=y.pendingProps;var Y=Ld(y,ai.current);eu(y,A),Y=mf(null,y,D,m,Y,A);var ae=gf();return y.flags|=1,typeof Y=="object"&&Y!==null&&typeof Y.render=="function"&&Y.$$typeof===void 0?(y.tag=1,y.memoizedState=null,y.updateQueue=null,bi(D)?(ae=!0,Bd(y)):ae=!1,y.memoizedState=Y.state!==null&&Y.state!==void 0?Y.state:null,Xh(y),Y.updater=bf,y.stateNode=Y,Y._reactInternals=y,mp(y,D,m,A),y=ts(null,y,D,!0,ae,A)):(y.tag=0,es&&ae&&af(y),je(null,y,Y,A),y=y.child),y;case 16:D=y.elementType;e:{switch(Ln(m,y),m=y.pendingProps,Y=D._init,D=Y(D._payload),y.type=D,Y=y.tag=bee(D),m=ii(D,m),Y){case 0:y=Er(null,y,D,m,A);break e;case 1:y=ys(null,y,D,m,A);break e;case 11:y=xt(null,y,D,m,A);break e;case 14:y=Rt(null,y,D,ii(D.type,m),A);break e}throw Error(r(306,D,""))}return y;case 0:return D=y.type,Y=y.pendingProps,Y=y.elementType===D?Y:ii(D,Y),Er(m,y,D,Y,A);case 1:return D=y.type,Y=y.pendingProps,Y=y.elementType===D?Y:ii(D,Y),ys(m,y,D,Y,A);case 3:e:{if(Vi(y),m===null)throw Error(r(387));D=y.pendingProps,ae=y.memoizedState,Y=ae.element,ap(m,y),uf(y,D,null,A);var xe=y.memoizedState;if(D=xe.element,ae.isDehydrated)if(ae={element:D,isDehydrated:!1,cache:xe.cache,pendingSuspenseBoundaries:xe.pendingSuspenseBoundaries,transitions:xe.transitions},y.updateQueue.baseState=ae,y.memoizedState=ae,y.flags&256){Y=qd(Error(r(423)),y),y=hc(m,y,D,A,Y);break e}else if(D!==Y){Y=qd(Error(r(424)),y),y=hc(m,y,D,A,Y);break e}else for(Nr=ac(y.stateNode.containerInfo.firstChild),Lo=y,es=!0,Bo=null,A=ll(y,null,D,A),y.child=A;A;)A.flags=A.flags&-3|4096,A=A.sibling;else{if(Wd(),D===Y){y=ki(m,y,A);break e}je(m,y,D,A)}y=y.child}return y;case 5:return df(y),m===null&&of(y),D=y.type,Y=y.pendingProps,ae=m!==null?m.memoizedProps:null,xe=Y.children,Fx(D,Y)?xe=null:ae!==null&&Fx(D,ae)&&(y.flags|=32),yn(m,y),je(m,y,xe,A),y.child;case 6:return m===null&&of(y),null;case 13:return zt(m,y,A);case 4:return zu(y,y.stateNode.containerInfo),D=y.pendingProps,m===null?y.child=Hd(y,null,D,A):je(m,y,D,A),y.child;case 11:return D=y.type,Y=y.pendingProps,Y=y.elementType===D?Y:ii(D,Y),xt(m,y,D,Y,A);case 7:return je(m,y,y.pendingProps,A),y.child;case 8:return je(m,y,y.pendingProps.children,A),y.child;case 12:return je(m,y,y.pendingProps.children,A),y.child;case 10:e:{if(D=y.type._context,Y=y.pendingProps,ae=y.memoizedProps,xe=Y.value,is(Kh,D._currentValue),D._currentValue=xe,ae!==null)if(fo(ae.value,xe)){if(ae.children===Y.children&&!vi.current){y=ki(m,y,A);break e}}else for(ae=y.child,ae!==null&&(ae.return=y);ae!==null;){var ze=ae.dependencies;if(ze!==null){xe=ae.child;for(var it=ze.firstContext;it!==null;){if(it.context===D){if(ae.tag===1){it=dc(-1,A&-A),it.tag=2;var Ft=ae.updateQueue;if(Ft!==null){Ft=Ft.shared;var er=Ft.pending;er===null?it.next=it:(it.next=er.next,er.next=it),Ft.pending=it}}ae.lanes|=A,it=ae.alternate,it!==null&&(it.lanes|=A),sp(ae.return,A,y),ze.lanes|=A;break}it=it.next}}else if(ae.tag===10)xe=ae.type===y.type?null:ae.child;else if(ae.tag===18){if(xe=ae.return,xe===null)throw Error(r(341));xe.lanes|=A,ze=xe.alternate,ze!==null&&(ze.lanes|=A),sp(xe,A,y),xe=ae.sibling}else xe=ae.child;if(xe!==null)xe.return=ae;else for(xe=ae;xe!==null;){if(xe===y){xe=null;break}if(ae=xe.sibling,ae!==null){ae.return=xe.return,xe=ae;break}xe=xe.return}ae=xe}je(m,y,Y.children,A),y=y.child}return y;case 9:return Y=y.type,D=y.pendingProps.children,eu(y,A),Y=Hi(Y),D=D(Y),y.flags|=1,je(m,y,D,A),y.child;case 14:return D=y.type,Y=ii(D,y.pendingProps),Y=ii(D.type,Y),Rt(m,y,D,Y,A);case 15:return cr(m,y,y.type,y.pendingProps,A);case 17:return D=y.type,Y=y.pendingProps,Y=y.elementType===D?Y:ii(D,Y),Ln(m,y),y.tag=1,bi(D)?(m=!0,Bd(y)):m=!1,eu(y,A),ew(y,D,Y),mp(y,D,Y,A),ts(null,y,D,!0,m,A);case 19:return Pa(m,y,A);case 22:return Lr(m,y,A)}throw Error(r(156,y.tag))};function o9(m,y){return de(m,y)}function vee(m,y,A,D){this.tag=m,this.key=A,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=y,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=D,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gc(m,y,A,D){return new vee(m,y,A,D)}function u5(m){return m=m.prototype,!(!m||!m.isReactComponent)}function bee(m){if(typeof m=="function")return u5(m)?1:0;if(m!=null){if(m=m.$$typeof,m===U)return 11;if(m===re)return 14}return 2}function Nf(m,y){var A=m.alternate;return A===null?(A=gc(m.tag,y,m.key,m.mode),A.elementType=m.elementType,A.type=m.type,A.stateNode=m.stateNode,A.alternate=m,m.alternate=A):(A.pendingProps=y,A.type=m.type,A.flags=0,A.subtreeFlags=0,A.deletions=null),A.flags=m.flags&14680064,A.childLanes=m.childLanes,A.lanes=m.lanes,A.child=m.child,A.memoizedProps=m.memoizedProps,A.memoizedState=m.memoizedState,A.updateQueue=m.updateQueue,y=m.dependencies,A.dependencies=y===null?null:{lanes:y.lanes,firstContext:y.firstContext},A.sibling=m.sibling,A.index=m.index,A.ref=m.ref,A}function fw(m,y,A,D,Y,ae){var xe=2;if(D=m,typeof m=="function")u5(m)&&(xe=1);else if(typeof m=="string")xe=5;else e:switch(m){case F:return sm(A.children,Y,ae,y);case j:xe=8,Y|=8;break;case P:return m=gc(12,A,y,Y|2),m.elementType=P,m.lanes=ae,m;case K:return m=gc(13,A,y,Y),m.elementType=K,m.lanes=ae,m;case te:return m=gc(19,A,y,Y),m.elementType=te,m.lanes=ae,m;case B:return hw(A,Y,ae,y);default:if(typeof m=="object"&&m!==null)switch(m.$$typeof){case M:xe=10;break e;case I:xe=9;break e;case U:xe=11;break e;case re:xe=14;break e;case Z:xe=16,D=null;break e}throw Error(r(130,m==null?m:typeof m,""))}return y=gc(xe,A,y,Y),y.elementType=m,y.type=D,y.lanes=ae,y}function sm(m,y,A,D){return m=gc(7,m,D,y),m.lanes=A,m}function hw(m,y,A,D){return m=gc(22,m,D,y),m.elementType=B,m.lanes=A,m.stateNode={isHidden:!1},m}function d5(m,y,A){return m=gc(6,m,null,y),m.lanes=A,m}function f5(m,y,A){return y=gc(4,m.children!==null?m.children:[],m.key,y),y.lanes=A,y.stateNode={containerInfo:m.containerInfo,pendingChildren:null,implementation:m.implementation},y}function wee(m,y,A,D,Y){this.tag=y,this.containerInfo=m,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Qr(0),this.expirationTimes=Qr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Qr(0),this.identifierPrefix=D,this.onRecoverableError=Y,this.mutableSourceEagerHydrationData=null}function h5(m,y,A,D,Y,ae,xe,ze,it){return m=new wee(m,y,A,ze,it),y===1?(y=1,ae===!0&&(y|=8)):y=0,ae=gc(3,null,null,y),m.current=ae,ae.stateNode=m,ae.memoizedState={element:D,isDehydrated:A,cache:null,transitions:null,pendingSuspenseBoundaries:null},Xh(ae),m}function _ee(m,y,A){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:E,key:D==null?null:""+D,children:m,containerInfo:y,implementation:A}}function l9(m){if(!m)return oc;m=m._reactInternals;e:{if(ge(m)!==m||m.tag!==1)throw Error(r(170));var y=m;do{switch(y.tag){case 3:y=y.stateNode.context;break e;case 1:if(bi(y.type)){y=y.stateNode.__reactInternalMemoizedMergedChildContext;break e}}y=y.return}while(y!==null);throw Error(r(171))}if(m.tag===1){var A=m.type;if(bi(A))return Jg(m,A,y)}return y}function c9(m,y,A,D,Y,ae,xe,ze,it){return m=h5(A,D,!0,m,Y,ae,xe,ze,it),m.context=l9(null),A=m.current,D=Wo(),Y=Cf(A),ae=dc(D,Y),ae.callback=y??null,fc(A,ae,Y),m.current.lanes=Y,ns(m,Y,D),dl(m,D),m}function mw(m,y,A,D){var Y=y.current,ae=Wo(),xe=Cf(Y);return A=l9(A),y.context===null?y.context=A:y.pendingContext=A,y=dc(ae,xe),y.payload={element:m},D=D===void 0?null:D,D!==null&&(y.callback=D),m=fc(Y,y,xe),m!==null&&(iu(m,Y,xe,ae),ip(m,Y,xe)),xe}function gw(m){if(m=m.current,!m.child)return null;switch(m.child.tag){case 5:return m.child.stateNode;default:return m.child.stateNode}}function u9(m,y){if(m=m.memoizedState,m!==null&&m.dehydrated!==null){var A=m.retryLane;m.retryLane=A!==0&&A<y?A:y}}function m5(m,y){u9(m,y),(m=m.alternate)&&u9(m,y)}function See(){return null}var d9=typeof reportError=="function"?reportError:function(m){console.error(m)};function g5(m){this._internalRoot=m}pw.prototype.render=g5.prototype.render=function(m){var y=this._internalRoot;if(y===null)throw Error(r(409));mw(m,y,null,null)},pw.prototype.unmount=g5.prototype.unmount=function(){var m=this._internalRoot;if(m!==null){this._internalRoot=null;var y=m.containerInfo;tm(function(){mw(null,m,null,null)}),y[ic]=null}};function pw(m){this._internalRoot=m}pw.prototype.unstable_scheduleHydration=function(m){if(m){var y=Ye();m={blockedOn:null,target:m,priority:y};for(var A=0;A<lr.length&&y!==0&&y<lr[A].priority;A++);lr.splice(A,0,m),A===0&&jn(m)}};function p5(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)}function xw(m){return!(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11&&(m.nodeType!==8||m.nodeValue!==" react-mount-point-unstable "))}function f9(){}function kee(m,y,A,D,Y){if(Y){if(typeof D=="function"){var ae=D;D=function(){var Ft=gw(xe);ae.call(Ft)}}var xe=c9(y,D,m,0,null,!1,!1,"",f9);return m._reactRootContainer=xe,m[ic]=xe.current,Md(m.nodeType===8?m.parentNode:m),tm(),xe}for(;Y=m.lastChild;)m.removeChild(Y);if(typeof D=="function"){var ze=D;D=function(){var Ft=gw(it);ze.call(Ft)}}var it=h5(m,0,!1,null,null,!1,!1,"",f9);return m._reactRootContainer=it,m[ic]=it.current,Md(m.nodeType===8?m.parentNode:m),tm(function(){mw(y,it,A,D)}),it}function yw(m,y,A,D,Y){var ae=A._reactRootContainer;if(ae){var xe=ae;if(typeof Y=="function"){var ze=Y;Y=function(){var it=gw(xe);ze.call(it)}}mw(y,xe,m,Y)}else xe=kee(A,y,m,Y,D);return gw(xe)}sl=function(m){switch(m.tag){case 3:var y=m.stateNode;if(y.current.memoizedState.isDehydrated){var A=Fn(y.pendingLanes);A!==0&&(yi(y,A|1),dl(y,tt()),(Wn&6)===0&&(yp=tt()+500,Lu()))}break;case 13:tm(function(){var D=Uo(m,1);if(D!==null){var Y=Wo();iu(D,m,1,Y)}}),m5(m,1)}},qe=function(m){if(m.tag===13){var y=Uo(m,134217728);if(y!==null){var A=Wo();iu(y,m,134217728,A)}m5(m,134217728)}},Re=function(m){if(m.tag===13){var y=Cf(m),A=Uo(m,y);if(A!==null){var D=Wo();iu(A,m,y,D)}m5(m,y)}},Ye=function(){return xn},Tt=function(m,y){var A=xn;try{return xn=m,y()}finally{xn=A}},ve=function(m,y,A){switch(y){case"input":if(Qe(m,A),y=A.name,A.type==="radio"&&y!=null){for(A=m;A.parentNode;)A=A.parentNode;for(A=A.querySelectorAll("input[name="+JSON.stringify(""+y)+'][type="radio"]'),y=0;y<A.length;y++){var D=A[y];if(D!==m&&D.form===m.form){var Y=Wa(D);if(!Y)throw Error(r(90));ie(D),Qe(D,Y)}}}break;case"textarea":pt(m,A);break;case"select":y=A.value,y!=null&&vt(m,!!A.multiple,y,!1)}},Lt=o5,Ue=tm;var Cee={usingClientEntryPoint:!1,Events:[Hh,Ea,Wa,lt,Ct,o5]},Qx={findFiberByHostInstance:Du,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Tee={bundleType:Qx.bundleType,version:Qx.version,rendererPackageName:Qx.rendererPackageName,rendererConfig:Qx.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(m){return m=nt(m),m===null?null:m.stateNode},findFiberByHostInstance:Qx.findFiberByHostInstance||See,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vw=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vw.isDisabled&&vw.supportsFiber)try{Mr=vw.inject(Tee),Tr=vw}catch{}}return fl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cee,fl.createPortal=function(m,y){var A=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!p5(y))throw Error(r(200));return _ee(m,y,null,A)},fl.createRoot=function(m,y){if(!p5(m))throw Error(r(299));var A=!1,D="",Y=d9;return y!=null&&(y.unstable_strictMode===!0&&(A=!0),y.identifierPrefix!==void 0&&(D=y.identifierPrefix),y.onRecoverableError!==void 0&&(Y=y.onRecoverableError)),y=h5(m,1,!1,null,null,A,!1,D,Y),m[ic]=y.current,Md(m.nodeType===8?m.parentNode:m),new g5(y)},fl.findDOMNode=function(m){if(m==null)return null;if(m.nodeType===1)return m;var y=m._reactInternals;if(y===void 0)throw typeof m.render=="function"?Error(r(188)):(m=Object.keys(m).join(","),Error(r(268,m)));return m=nt(y),m=m===null?null:m.stateNode,m},fl.flushSync=function(m){return tm(m)},fl.hydrate=function(m,y,A){if(!xw(y))throw Error(r(200));return yw(null,m,y,!0,A)},fl.hydrateRoot=function(m,y,A){if(!p5(m))throw Error(r(405));var D=A!=null&&A.hydratedSources||null,Y=!1,ae="",xe=d9;if(A!=null&&(A.unstable_strictMode===!0&&(Y=!0),A.identifierPrefix!==void 0&&(ae=A.identifierPrefix),A.onRecoverableError!==void 0&&(xe=A.onRecoverableError)),y=c9(y,null,m,1,A??null,Y,!1,ae,xe),m[ic]=y.current,Md(m),D)for(m=0;m<D.length;m++)A=D[m],Y=A._getVersion,Y=Y(A._source),y.mutableSourceEagerHydrationData==null?y.mutableSourceEagerHydrationData=[A,Y]:y.mutableSourceEagerHydrationData.push(A,Y);return new pw(y)},fl.render=function(m,y,A){if(!xw(y))throw Error(r(200));return yw(null,m,y,!1,A)},fl.unmountComponentAtNode=function(m){if(!xw(m))throw Error(r(40));return m._reactRootContainer?(tm(function(){yw(null,null,m,!1,function(){m._reactRootContainer=null,m[ic]=null})}),!0):!1},fl.unstable_batchedUpdates=o5,fl.unstable_renderSubtreeIntoContainer=function(m,y,A,D){if(!xw(A))throw Error(r(200));if(m==null||m._reactInternals===void 0)throw Error(r(38));return yw(m,y,A,!1,D)},fl.version="18.3.1-next-f1338f8080-20240426",fl}var b9;function TU(){if(b9)return v5.exports;b9=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),v5.exports=Mee(),v5.exports}var w9;function Ree(){if(w9)return bw;w9=1;var e=TU();return bw.createRoot=e.createRoot,bw.hydrateRoot=e.hydrateRoot,bw}var Oee=Ree();const Dee=ec(Oee);var GC=TU();/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dv(){return Dv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dv.apply(this,arguments)}var Uf;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Uf||(Uf={}));const _9="popstate";function Iee(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return VC("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:H4(s)}return Bee(t,r,null,e)}function Ia(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function NU(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Lee(){return Math.random().toString(36).substr(2,8)}function S9(e,t){return{usr:e.state,key:e.key,idx:t}}function VC(e,t,r,n){return r===void 0&&(r=null),Dv({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?E1(t):t,{state:r,key:t&&t.key||n||Lee()})}function H4(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function E1(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function Bee(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=Uf.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(Dv({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function f(){o=Uf.Pop;let v=d(),C=v==null?null:v-u;u=v,c&&c({action:o,location:x.location,delta:C})}function h(v,C){o=Uf.Push;let b=VC(x.location,v,C);u=d()+1;let _=S9(b,u),T=x.createHref(b);try{i.pushState(_,"",T)}catch(N){if(N instanceof DOMException&&N.name==="DataCloneError")throw N;s.location.assign(T)}a&&c&&c({action:o,location:x.location,delta:1})}function g(v,C){o=Uf.Replace;let b=VC(x.location,v,C);u=d();let _=S9(b,u),T=x.createHref(b);i.replaceState(_,"",T),a&&c&&c({action:o,location:x.location,delta:0})}function p(v){let C=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof v=="string"?v:H4(v);return b=b.replace(/ $/,"%20"),Ia(C,"No window.location.(origin|href) available to create URL for href: "+b),new URL(b,C)}let x={get action(){return o},get location(){return e(s,i)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(_9,f),c=v,()=>{s.removeEventListener(_9,f),c=null}},createHref(v){return t(s,v)},createURL:p,encodeLocation(v){let C=p(v);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:h,replace:g,go(v){return i.go(v)}};return x}var k9;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(k9||(k9={}));function $ee(e,t,r){return r===void 0&&(r="/"),Uee(e,t,r)}function Uee(e,t,r,n){let s=typeof t=="string"?E1(t):t,a=g7(s.pathname||"/",r);if(a==null)return null;let i=EU(e);zee(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=ete(a);o=Jee(i[c],u)}return o}function EU(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Ia(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Kf([n,c.relativePath]),d=r.concat(c);a.children&&a.children.length>0&&(Ia(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),EU(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:Yee(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of AU(a.path))s(a,i,c)}),t}function AU(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=AU(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function zee(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Xee(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Wee=/^:[\w-]+$/,Hee=3,Gee=2,Vee=1,qee=10,Kee=-2,C9=e=>e==="*";function Yee(e,t){let r=e.split("/"),n=r.length;return r.some(C9)&&(n+=Kee),t&&(n+=Gee),r.filter(s=>!C9(s)).reduce((s,a)=>s+(Wee.test(a)?Hee:a===""?Vee:qee),n)}function Xee(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Jee(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,d=a==="/"?t:t.slice(a.length)||"/",f=Qee({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),h=c.route;if(!f)return null;Object.assign(s,f.params),i.push({params:s,pathname:Kf([a,f.pathname]),pathnameBase:ste(Kf([a,f.pathnameBase])),route:h}),f.pathnameBase!=="/"&&(a=Kf([a,f.pathnameBase]))}return i}function Qee(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Zee(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,d,f)=>{let{paramName:h,isOptional:g}=d;if(h==="*"){let x=o[f]||"";i=a.slice(0,a.length-x.length).replace(/(.)\/+$/,"$1")}const p=o[f];return g&&!p?u[h]=void 0:u[h]=(p||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function Zee(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),NU(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function ete(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return NU(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function g7(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function tte(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?E1(e):e;return{pathname:r?r.startsWith("/")?r:rte(r,t):t,search:ate(n),hash:ite(s)}}function rte(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function _5(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function nte(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function p7(e,t){let r=nte(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function x7(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=E1(e):(s=Dv({},e),Ia(!s.pathname||!s.pathname.includes("?"),_5("?","pathname","search",s)),Ia(!s.pathname||!s.pathname.includes("#"),_5("#","pathname","hash",s)),Ia(!s.search||!s.search.includes("#"),_5("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let f=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),f-=1;s.pathname=h.join("/")}o=f>=0?t[f]:"/"}let c=tte(s,o),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Kf=e=>e.join("/").replace(/\/\/+/g,"/"),ste=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),ate=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ite=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ote(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const jU=["post","put","patch","delete"];new Set(jU);const lte=["get",...jU];new Set(lte);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Iv(){return Iv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Iv.apply(this,arguments)}const y7=w.createContext(null),cte=w.createContext(null),gh=w.createContext(null),vS=w.createContext(null),M0=w.createContext({outlet:null,matches:[],isDataRoute:!1}),PU=w.createContext(null);function ute(e,t){let{relative:r}=t===void 0?{}:t;A1()||Ia(!1);let{basename:n,navigator:s}=w.useContext(gh),{hash:a,pathname:i,search:o}=MU(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:Kf([n,i])),s.createHref({pathname:c,search:o,hash:a})}function A1(){return w.useContext(vS)!=null}function ku(){return A1()||Ia(!1),w.useContext(vS).location}function FU(e){w.useContext(gh).static||w.useLayoutEffect(e)}function Za(){let{isDataRoute:e}=w.useContext(M0);return e?Ste():dte()}function dte(){A1()||Ia(!1);let e=w.useContext(y7),{basename:t,future:r,navigator:n}=w.useContext(gh),{matches:s}=w.useContext(M0),{pathname:a}=ku(),i=JSON.stringify(p7(s,r.v7_relativeSplatPath)),o=w.useRef(!1);return FU(()=>{o.current=!0}),w.useCallback(function(u,d){if(d===void 0&&(d={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let f=x7(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(f.pathname=f.pathname==="/"?t:Kf([t,f.pathname])),(d.replace?n.replace:n.push)(f,d.state,d)},[t,n,i,a,e])}function E2(){let{matches:e}=w.useContext(M0),t=e[e.length-1];return t?t.params:{}}function MU(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=w.useContext(gh),{matches:s}=w.useContext(M0),{pathname:a}=ku(),i=JSON.stringify(p7(s,n.v7_relativeSplatPath));return w.useMemo(()=>x7(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function fte(e,t){return hte(e,t)}function hte(e,t,r,n){A1()||Ia(!1);let{navigator:s}=w.useContext(gh),{matches:a}=w.useContext(M0),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=ku(),d;if(t){var f;let v=typeof t=="string"?E1(t):t;c==="/"||(f=v.pathname)!=null&&f.startsWith(c)||Ia(!1),d=v}else d=u;let h=d.pathname||"/",g=h;if(c!=="/"){let v=c.replace(/^\//,"").split("/");g="/"+h.replace(/^\//,"").split("/").slice(v.length).join("/")}let p=$ee(e,{pathname:g}),x=yte(p&&p.map(v=>Object.assign({},v,{params:Object.assign({},o,v.params),pathname:Kf([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:Kf([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),a,r,n);return t&&x?w.createElement(vS.Provider,{value:{location:Iv({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Uf.Pop}},x):x}function mte(){let e=_te(),t=ote(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},t),r?w.createElement("pre",{style:s},r):null,null)}const gte=w.createElement(mte,null);class pte extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?w.createElement(M0.Provider,{value:this.props.routeContext},w.createElement(PU.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function xte(e){let{routeContext:t,match:r,children:n}=e,s=w.useContext(y7);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),w.createElement(M0.Provider,{value:t},n)}function yte(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let d=i.findIndex(f=>f.route.id&&o?.[f.route.id]!==void 0);d>=0||Ia(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let d=0;d<i.length;d++){let f=i[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:h,errors:g}=r,p=f.route.loader&&h[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||p){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,f,h)=>{let g,p=!1,x=null,v=null;r&&(g=o&&f.route.id?o[f.route.id]:void 0,x=f.route.errorElement||gte,c&&(u<0&&h===0?(kte("route-fallback"),p=!0,v=null):u===h&&(p=!0,v=f.route.hydrateFallbackElement||null)));let C=t.concat(i.slice(0,h+1)),b=()=>{let _;return g?_=x:p?_=v:f.route.Component?_=w.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=d,w.createElement(xte,{match:f,routeContext:{outlet:d,matches:C,isDataRoute:r!=null},children:_})};return r&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?w.createElement(pte,{location:r.location,revalidation:r.revalidation,component:x,error:g,children:b(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):b()},null)}var RU=(function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e})(RU||{}),OU=(function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e})(OU||{});function vte(e){let t=w.useContext(y7);return t||Ia(!1),t}function bte(e){let t=w.useContext(cte);return t||Ia(!1),t}function wte(e){let t=w.useContext(M0);return t||Ia(!1),t}function DU(e){let t=wte(),r=t.matches[t.matches.length-1];return r.route.id||Ia(!1),r.route.id}function _te(){var e;let t=w.useContext(PU),r=bte(),n=DU();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function Ste(){let{router:e}=vte(RU.UseNavigateStable),t=DU(OU.UseNavigateStable),r=w.useRef(!1);return FU(()=>{r.current=!0}),w.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Iv({fromRouteId:t},a)))},[e,t])}const T9={};function kte(e,t,r){T9[e]||(T9[e]=!0)}function Cte(e,t){e?.v7_startTransition,e?.v7_relativeSplatPath}function o1(e){let{to:t,replace:r,state:n,relative:s}=e;A1()||Ia(!1);let{future:a,static:i}=w.useContext(gh),{matches:o}=w.useContext(M0),{pathname:c}=ku(),u=Za(),d=x7(t,p7(o,a.v7_relativeSplatPath),c,s==="path"),f=JSON.stringify(d);return w.useEffect(()=>u(JSON.parse(f),{replace:r,state:n,relative:s}),[u,f,s,r,n]),null}function Ts(e){Ia(!1)}function Tte(e){let{basename:t="/",children:r=null,location:n,navigationType:s=Uf.Pop,navigator:a,static:i=!1,future:o}=e;A1()&&Ia(!1);let c=t.replace(/^\/*/,"/"),u=w.useMemo(()=>({basename:c,navigator:a,static:i,future:Iv({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=E1(n));let{pathname:d="/",search:f="",hash:h="",state:g=null,key:p="default"}=n,x=w.useMemo(()=>{let v=g7(d,c);return v==null?null:{location:{pathname:v,search:f,hash:h,state:g,key:p},navigationType:s}},[c,d,f,h,g,p,s]);return x==null?null:w.createElement(gh.Provider,{value:u},w.createElement(vS.Provider,{children:r,value:x}))}function v7(e){let{children:t,location:r}=e;return fte(qC(t),r)}new Promise(()=>{});function qC(e,t){t===void 0&&(t=[]);let r=[];return w.Children.forEach(e,(n,s)=>{if(!w.isValidElement(n))return;let a=[...t,s];if(n.type===w.Fragment){r.push.apply(r,qC(n.props.children,a));return}n.type!==Ts&&Ia(!1),!n.props.index||!n.props.children||Ia(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=qC(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function KC(){return KC=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},KC.apply(this,arguments)}function Nte(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function Ete(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Ate(e,t){return e.button===0&&(!t||t==="_self")&&!Ete(e)}const jte=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],Pte="6";try{window.__reactRouterVersion=Pte}catch{}const Fte="startTransition",N9=CU[Fte];function Mte(e){let{basename:t,children:r,future:n,window:s}=e,a=w.useRef();a.current==null&&(a.current=Iee({window:s,v5Compat:!0}));let i=a.current,[o,c]=w.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},d=w.useCallback(f=>{u&&N9?N9(()=>c(f)):c(f)},[c,u]);return w.useLayoutEffect(()=>i.listen(d),[i,d]),w.useEffect(()=>Cte(n),[n]),w.createElement(Tte,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const Rte=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Ote=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,IU=w.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:c,to:u,preventScrollReset:d,viewTransition:f}=t,h=Nte(t,jte),{basename:g}=w.useContext(gh),p,x=!1;if(typeof u=="string"&&Ote.test(u)&&(p=u,Rte))try{let _=new URL(window.location.href),T=u.startsWith("//")?new URL(_.protocol+u):new URL(u),N=g7(T.pathname,g);T.origin===_.origin&&N!=null?u=N+T.search+T.hash:x=!0}catch{}let v=ute(u,{relative:s}),C=Dte(u,{replace:i,state:o,target:c,preventScrollReset:d,relative:s,viewTransition:f});function b(_){n&&n(_),_.defaultPrevented||C(_)}return w.createElement("a",KC({},h,{href:p||v,onClick:x||a?n:b,ref:r,target:c}))});var E9;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(E9||(E9={}));var A9;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(A9||(A9={}));function Dte(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,c=Za(),u=ku(),d=MU(e,{relative:i});return w.useCallback(f=>{if(Ate(f,r)){f.preventDefault();let h=n!==void 0?n:H4(u)===H4(d);c(e,{replace:h,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,c,d,n,s,r,e,a,i,o])}const hs={student_subjects:1800*1e3,student_active_tests:180*1e3,student_results_table:300*1e3,teacher_subjects:900*1e3,teacher_classes:900*1e3,teacher_tests:600*1e3,teacher_results_table:600*1e3,admin_users:1200*1e3,admin_teachers:1200*1e3,admin_subjects:1800*1e3,admin_academic_years:3600*1e3,admin_tests:900*1e3,admin_results_table:null,admin_teacher_id:3600*1e3,all_tests:1200*1e3,subjects_dropdown:1800*1e3,grades_classes:3600*1e3,test_progress:120*1e3,anti_cheating:120*1e3,word_matching_test:600*1e3,speaking_test_data:3600*1e3},b7=(e,t={})=>{const{includeExpired:r=!1}=t;try{const n=localStorage.getItem(e);if(!n)return console.log(" Cache: No data found for key:",e),null;const s=JSON.parse(n),{data:a,timestamp:i,ttl:o}=s,c=Date.now()-i,d=typeof o=="number"&&Number.isFinite(o)?c>o:!1;return d&&!r?(console.log(" Cache: Data expired for key:",e,"age:",c,"ttl:",o),localStorage.removeItem(e),null):(console.log(" Cache: Entry found for key:",e,"age:",c,"ttl:",o,"expired:",d),{data:a,timestamp:i,ttl:o,age:c,isExpired:d})}catch(n){return console.log(" Cache: Corrupted data for key:",e,n),localStorage.removeItem(e),null}},Os=e=>{const t=b7(e);return t?t.data:null},vs=(e,t,r)=>{try{console.log(" Cache: Setting data for key:",e,"ttl:",r),localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:typeof r=="number"&&Number.isFinite(r)?r:r===null?null:void 0})),console.log(" Cache: Data cached successfully for key:",e)}catch{console.log(" Cache: Storage full, cleaning old data for key:",e),LU();try{localStorage.setItem(e,JSON.stringify({data:t,timestamp:Date.now(),ttl:typeof r=="number"&&Number.isFinite(r)?r:r===null?null:void 0})),console.log(" Cache: Data cached after cleanup for key:",e)}catch{console.warn("Storage full, cannot cache data")}}},LU=()=>{const e=Date.now(),t=Object.keys(localStorage);t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i,ttl:o}=JSON.parse(a);e-i>o&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const r=e-10080*60*1e3;t.forEach(s=>{try{const a=localStorage.getItem(s);if(a){const{timestamp:i}=JSON.parse(a);i<r&&localStorage.removeItem(s)}}catch{localStorage.removeItem(s)}});const n=Object.keys(localStorage);if(n.length>0){const s=n.map(i=>{try{const o=localStorage.getItem(i);if(o){const{timestamp:c}=JSON.parse(o);return{key:i,timestamp:c}}}catch{return{key:i,timestamp:0}}return{key:i,timestamp:0}}),a=Math.ceil(s.length*.25);s.sort((i,o)=>i.timestamp-o.timestamp).slice(0,a).forEach(({key:i})=>localStorage.removeItem(i))}},w7=e=>{Object.keys(localStorage).forEach(r=>{r.includes(e)&&localStorage.removeItem(r)})},j1=(e,t,r)=>{const n=`test_progress_${e}_${t}_${r}`,s=`anti_cheating_${e}_${t}_${r}`;if(localStorage.removeItem(n),localStorage.removeItem(s),t==="speaking_test_data"){const a=`speaking_test_data_${e}_${r}`;localStorage.removeItem(a),console.log(`Cleared speaking test data cache for ${r}`)}console.log(`Cleared test data for ${t}_${r}`)},Dp=Object.freeze(Object.defineProperty({__proto__:null,CACHE_TTL:hs,cleanupOldData:LU,clearTestData:j1,clearUserData:w7,getCachedData:Os,getCachedEntry:b7,setCachedData:vs},Symbol.toStringTag,{value:"Module"}));let ou=null,ey=null;function S4(){if(ey!==null)return ey;try{const e="_test";localStorage.setItem(e,"test");const t=localStorage.getItem(e);localStorage.removeItem(e),ey=t==="test"}catch(e){console.warn("localStorage unavailable, falling back to sessionStorage",e),ey=!1}return ey}function Lv(){return S4()?localStorage:sessionStorage}async function _7(e){try{const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(n)).map(i=>i.toString(16).padStart(2,"0")).join("")}catch(t){return console.warn("Hash computation failed",t),btoa(e).replace(/[^a-zA-Z0-9]/g,"").substring(0,64)}}async function Ite(e,t){try{const r=Lv();return r.setItem(e,t),r.getItem(e)===t}catch(r){return console.warn("Storage write failed",r),!1}}async function Lte(e,t){try{const r=Lv(),n=await _7(t);return r.setItem(`${e}_hash`,n),await Ite(e,t)}catch(r){return console.warn("Failed to store with hash",r),!1}}async function Bte(e){try{const t=Lv(),r=t.getItem(e),n=t.getItem(`${e}_hash`);return!r||!n?!1:await _7(r)===n}catch(t){return console.warn("Hash verification failed",t),!1}}async function $te(e,t=3,r=200){for(let n=0;n<t;n++){if(await e())return!0;await new Promise(a=>setTimeout(a,r))}return!1}const va={async set(e){const t=S4(),r=Lv();if(!t){console.warn(" localStorage unavailable - using sessionStorage (less persistent)");try{r.setItem("auth_token",e);const a=r.getItem("auth_token")===e;return a&&(ou=e),a}catch(s){return console.error("sessionStorage fallback failed",s),!1}}const n=await $te(()=>Lte("auth_token",e));return n&&(ou=e),n},async get(){if(ou)return ou;const e=Lv();if(!S4())try{const t=e.getItem("auth_token");return ou=t,t}catch(t){return console.error("sessionStorage fallback read failed",t),null}try{const t=e.getItem("auth_token");if(!t)return ou=null,null;if(e.getItem("auth_token_hash")){if(!await Bte("auth_token"))return ou=null,null}else{console.log("Migrating legacy token to secure storage format...");try{const n=await _7(t);if(e.setItem("auth_token_hash",n),e.getItem("auth_token_hash")!==n)return console.warn("Failed to store hash during migration"),t}catch(n){console.warn("Failed to migrate token hash:",n)}}return ou=t,t}catch(t){return console.warn("Failed to get token",t),ou=null,null}},async clear(){try{S4()&&(localStorage.removeItem("auth_token"),localStorage.removeItem("auth_token_hash"))}catch{}try{sessionStorage.removeItem("auth_token"),sessionStorage.removeItem("auth_token_hash")}catch{}ou=null},clearCache(){ou=null}},G4=Object.freeze(Object.defineProperty({__proto__:null,SecureToken:va},Symbol.toStringTag,{value:"Module"})),BU=w.createContext(),$U=({children:e})=>{const[t,r]=w.useState(null),[n,s]=w.useState(null),[a,i]=w.useState(null),[o,c]=w.useState(!1),[u,d]=w.useState(!0),[f,h]=w.useState(null);w.useEffect(()=>{console.log("[AUTH] Initializing application session..."),v()},[]),w.useEffect(()=>{if(o&&a){console.log("[AUTH] Setting up proactive token refresh...");let H=!1;const R=setInterval(async()=>{if(o&&a&&!H){H=!0;try{const L=a||await(window.tokenManager?.getToken()||va.get());if(L&&g(L))console.log("[AUTH] Token expired, attempting refresh..."),await p()||console.log("[AUTH] Proactive refresh failed, but user remains logged in");else if(L)try{const W=JSON.parse(atob(L.split(".")[1])).exp*1e3,Q=Date.now(),X=W-Q;X<300*1e3&&X>0&&(console.log(`[AUTH] Token expires in ${Math.round(X/1e3)} seconds, refreshing...`),await p()||console.log("[AUTH] Proactive refresh failed, but user remains logged in"))}catch(G){console.error("[AUTH] Error parsing token for expiration check:",G)}}catch(L){console.error("[AUTH] Error in proactive refresh:",L)}finally{H=!1}}},300*1e3);return()=>{console.log("[AUTH] Clearing proactive token refresh interval"),clearInterval(R)}}},[o,a]);const g=H=>{if(!H)return!0;try{if(typeof H!="string"||!H.includes("."))return console.warn("[AUTH] Invalid token format - not a JWT"),!0;const R=H.split(".");if(R.length!==3)return console.warn("[AUTH] Invalid token format - not 3 parts"),!0;const L=JSON.parse(atob(R[1])),G=Date.now()/1e3;return L.exp<=G}catch(R){if(console.error("[AUTH] Error decoding token:",R),console.warn("[AUTH] Token appears to be corrupted - clearing authentication"),va.clear().catch(()=>{}),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("userData"),window.tokenManager)try{window.tokenManager.clearAuth()}catch(L){console.warn("[AUTH] Error clearing token manager:",L)}return!0}},p=async()=>{const H=localStorage.getItem("refresh_token");if(!H)return console.log("[AUTH] No refresh token found"),!1;try{const R=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:H})});if(R.ok){const L=await R.json();console.log("[AUTH] Token refresh successful"),await va.set(L.accessToken),localStorage.setItem("refresh_token",L.refreshToken),localStorage.setItem("accessToken",L.accessToken);try{window.tokenManager&&(await window.tokenManager.setToken(L.accessToken),L.refreshToken&&window.tokenManager.setRefreshToken(L.refreshToken))}catch{}return i(L.accessToken),!0}else return console.error("[AUTH] Token refresh failed:",R.status),!1}catch(R){return console.error("[AUTH] Token refresh error:",R),!1}},x=async(H,R={})=>{const L=a||await(window.tokenManager?.getToken()||va.get());if(!L)throw new Error("No authentication token found");const G={"Content-Type":"application/json",Authorization:`Bearer ${L}`,...R.headers},W=await fetch(H,{...R,headers:G});if(W.status===401)if(console.log("[AUTH] 401 error, attempting token refresh..."),await p()){const X=await(window.tokenManager?.getToken()||va.get());return G.Authorization=`Bearer ${X}`,fetch(H,{...R,headers:G})}else throw console.log("[AUTH] Token refresh failed, returning 401 response"),new Error("Authentication failed - please login again");return W},v=async()=>{try{console.log("[AUTH] Starting session initialization..."),d(!0);const H=await(window.tokenManager?.getToken()||va.get())||localStorage.getItem("accessToken")||localStorage.getItem("token"),R=localStorage.getItem("user_data")||localStorage.getItem("userData"),L=R?JSON.parse(R).role:null;if(console.log("[AUTH] Found stored data:",{hasToken:!!H,hasUser:!!R,role:L}),H&&L&&R)try{const G=JSON.parse(R);if(g(H))if(console.log("[AUTH] Token expired, attempting refresh..."),await p()){console.log("[AUTH] Token refreshed successfully");const Q=await(window.tokenManager?.getToken()||va.get());i(Q)}else console.log("[AUTH] Token refresh failed, but continuing with existing token..."),i(H);else i(H);s(L),r(G);try{if(window.tokenManager&&H){await window.tokenManager.setToken(H);const W=localStorage.getItem("refresh_token");W&&window.tokenManager.setRefreshToken(W)}}catch{}c(!0),await _(G,L)}catch(G){console.error("[AUTH] Error parsing stored user data:",G),console.log("[AUTH] Invalid user data, but not forcing logout - continuing with empty state"),c(!1)}}catch(H){console.error("[AUTH] Session initialization error:",H),console.log("[AUTH] Initialization error, but not forcing logout - continuing with empty state"),c(!1)}finally{console.log("[AUTH] Session initialization complete"),d(!1)}},C=async H=>{try{if(d(!0),h(null),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),h("Please wait for the logout process to complete.");return}console.log("Attempting login with:",H.username);let R,L;H.username==="admin"?(R={ok:!0,json:()=>({success:!0,token:"test-token"})},L="admin"):(R=await authService.teacherLogin(H),L="teacher");const G=await R.json();await b(R,L,G)}catch(R){j(R)}finally{d(!1)}},b=async(H,R,L)=>{try{if(H.ok&&L.success&&L.token){i(L.token),s(R),r(L),c(!0);const G=L.accessToken||L.token;await va.set(G),localStorage.setItem("refresh_token",L.refreshToken),localStorage.setItem("user_data",JSON.stringify(L)),localStorage.setItem("accessToken",G);try{window.tokenManager&&(await window.tokenManager.setToken(G),L.refreshToken&&window.tokenManager.setRefreshToken(L.refreshToken))}catch{}try{const W=Date.now(),Q=10080*60*1e3,X=[];for(let se=0;se<localStorage.length;se++){const le=localStorage.key(se);if(!(!le||!(le.startsWith("test_progress_")||le.startsWith("test_timer_")||le.startsWith("test_shuffle_order_")||le.startsWith("student_results_table_")||le.startsWith("anti_cheating_"))))try{const we=localStorage.getItem(le);if(!we){X.push(le);continue}let ie=null;if(we.startsWith("{")||we.startsWith("[")){const Ee=JSON.parse(we),ye=Ee.timestamp||Ee.lastSaved||Ee.lastTickAt||Ee.createdAt||Ee.updatedAt||Ee.startedAt||Ee.started_at;ye&&(ie=new Date(ye).getTime())}if(!ie){const Ee=`${le}__ts`,ye=localStorage.getItem(Ee);ye&&(ie=parseInt(ye)||null)}if(!ie)continue;W-ie>Q&&X.push(le)}catch{}}X.forEach(se=>{try{localStorage.removeItem(se)}catch{}})}catch(W){console.warn("LocalStorage cleanup skipped:",W)}return await _(L,R),!0}else{const G=L.message||H.statusText||"Login failed";return j(new Error(G)),!1}}catch(G){return j(G),!1}},_=async(H,R)=>{try{switch(R){case"admin":console.log("Admin login successful, role:",H.role),console.log("Admin logged in:",H);break;case"teacher":console.log("Teacher login successful, role:",H.role),console.log("Teacher data:",H.teacher),await N(H),await F();break;case"student":console.log("Student login successful"),T(H);break;default:console.warn("Unknown user role:",R)}}catch(L){console.error("Post-login actions error:",L)}},T=H=>{r(H),console.log("Student info populated:",H)},N=async H=>{r(H),console.log("Teacher info populated:",H)},E=async()=>{try{console.log("Initializing teacher cabinet...")}catch(H){console.error("Error initializing teacher cabinet:",H)}},F=async()=>{try{console.log("Checking teacher subjects...")}catch(H){console.error("Error checking teacher subjects:",H)}},j=H=>{h(H.message||"Login failed"),P()},P=()=>{h(null),d(!1)},M=w.useCallback(()=>{I()},[]),I=async()=>{r(null),s(null),i(null),c(!1),h(null);const H=t?.student_id||t?.teacher_id||t?.admin_id||t?.id;H&&w7(H),await va.clear(),localStorage.removeItem("userRole"),localStorage.removeItem("userData"),localStorage.removeItem("user_data"),localStorage.removeItem("user_role"),localStorage.removeItem("accessToken"),localStorage.removeItem("refresh_token"),localStorage.removeItem("testProgress"),localStorage.removeItem("formData"),window.tokenManager&&await window.tokenManager.clearAuth(),setTimeout(()=>{U()},100)},U=()=>{console.log("Interface reset after session clear - redirecting to login"),window.location.replace("/login")},K=()=>t?.id||null,te=()=>n==="admin"?t:null,re=()=>n==="admin",Z=()=>re()?t?.admin_id:null,B=()=>n==="teacher"?t?.username:null,J=()=>{console.log("Auth functions available:",{handleUnifiedLogin:typeof C,logout:typeof M,getCurrentTeacherId:typeof K,isAdmin:typeof re,getCurrentAdmin:typeof te,getCurrentAdminId:typeof Z,getCurrentTeacherUsername:typeof B})};w.useEffect(()=>(window.logout=M,window.getCurrentTeacherId=K,window.getCurrentAdmin=te,window.isAdmin=re,window.getCurrentAdminId=Z,window.getCurrentTeacherUsername=B,window.checkFunctionAvailability=J,()=>{delete window.logout,delete window.getCurrentTeacherId,delete window.getCurrentAdmin,delete window.isAdmin,delete window.getCurrentAdminId,delete window.getCurrentTeacherUsername,delete window.checkFunctionAvailability}),[M]);const z=w.useCallback(H=>{console.log("Setting user data from external auth:",H),r(H),s(H.role),i(H.token),c(!0),d(!1),h(null),va.set(H.token).catch(R=>{console.error("[AUTH] Failed to store token securely:",R)}),localStorage.setItem("user_data",JSON.stringify(H)),localStorage.setItem("accessToken",H.token),window.tokenManager&&window.tokenManager.setToken(H.token).catch(()=>{})},[]),q={user:t,role:n,token:a,isAuthenticated:o,isLoading:u,error:f,login:C,setUserData:z,logout:M,resetLoginForm:P,forceCompleteLogout:I,initializeApplicationSession:v,makeAuthenticatedRequest:x,populateStudentInfo:T,populateTeacherInfo:N,initializeTeacherCabinet:E,checkTeacherSubjects:F,getCurrentTeacherId:K,getCurrentAdmin:te,isAdmin:re,getCurrentAdminId:Z,getCurrentTeacherUsername:B,handleLoginResponse:b,handlePostLoginActions:_,handleLoginFailure:j,resetInterfaceAfterSessionClear:U,checkFunctionAvailability:J};return l.jsx(BU.Provider,{value:q,children:e})},ws=()=>{const e=w.useContext(BU);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e};class Ute{constructor(){this.baseURL="https://mathayomwatsing.netlify.app/.netlify/functions.",this.timeout=1e4,this.retryCount=3,this.retryDelay=1e3}async getHeaders(){const t=await(window.tokenManager?.getToken()||va.get())||localStorage.getItem("token");return{"Content-Type":"application/json",...t&&{Authorization:`Bearer ${t}`}}}async sendRequest(t,r){try{return await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})}catch(n){throw console.error(" Network error:",n),n}}async request(t,r={}){const n=`${this.baseURL}${t}`,a={method:"GET",headers:await this.getHeaders(),timeout:this.timeout,...r};let i;for(let o=0;o<this.retryCount;o++)try{const c=new AbortController,u=setTimeout(()=>c.abort(),this.timeout),d=await fetch(n,{...a,signal:c.signal});if(clearTimeout(u),!d.ok)throw new Error(`HTTP error! status: ${d.status}`);return await d.json()}catch(c){if(i=c,c.name==="AbortError")throw new Error("Request timeout");o<this.retryCount-1&&(console.warn(`Request failed, retrying in ${this.retryDelay}ms... (attempt ${o+1}/${this.retryCount})`),await new Promise(u=>setTimeout(u,this.retryDelay*Math.pow(2,o))))}throw i}async get(t,r={}){return this.request(t,{...r,method:"GET"})}async post(t,r,n={}){return this.request(t,{...n,method:"POST",body:JSON.stringify(r)})}async put(t,r,n={}){return this.request(t,{...n,method:"PUT",body:JSON.stringify(r)})}async delete(t,r={}){return this.request(t,{...r,method:"DELETE"})}async patch(t,r,n={}){return this.request(t,{...n,method:"PATCH",body:JSON.stringify(r)})}async uploadFile(t,r,n={}){const s=new FormData;s.append("file",r);const a=`${this.baseURL}${t}`,i=await(window.tokenManager?.getToken()||va.get())||localStorage.getItem("token"),o={method:"POST",headers:{...i&&{Authorization:`Bearer ${i}`}},body:s,...n};try{const c=await fetch(a,o);if(!c.ok)throw new Error(`HTTP error! status: ${c.status}`);return await c.json()}catch(c){throw c}}async downloadFile(t,r,n={}){const s=`${this.baseURL}${t}`,i={method:"GET",headers:await this.getHeaders(),...n};try{const o=await fetch(s,i);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);const c=await o.blob(),u=window.URL.createObjectURL(c),d=document.createElement("a");d.href=u,d.download=r,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(u)}catch(o){throw o}}ensureDebugOutput(){let t=document.getElementById("debug-output");return t||(t=document.createElement("div"),t.id="debug-output",t.className="fixed top-4 right-4 w-96 max-h-96 bg-white border border-gray-300 rounded-lg shadow-lg p-4 z-50 overflow-auto",t.innerHTML='<div class="text-sm font-mono text-gray-800">Debug Output</div>',document.body.appendChild(t)),t}async testDbConnection(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/test-db-connection")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Database Connection Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,message:"Database connection successful",data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Database Connection Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,message:"Database connection failed",error:t.message}}}async testStudentLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:"51706",password:"1"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Student Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Student Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testTeacherLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"Aleksandr_Petrov",password:"465"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Teacher Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Teacher Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testAdminLogin(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:"admin",password:"admin123"})})).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Admin Login Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Admin Login Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetTeacherSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-teacher-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Teacher Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Teacher Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetClassResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-class-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Class Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Class Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentSubjects(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-subjects")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Subjects Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Subjects Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testGetStudentTestResults(){try{const t=this.ensureDebugOutput(),n=await(await fetch("/.netlify/functions/get-student-test-results")).json();return t&&(t.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Get Student Test Results Test</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),{success:!0,data:n}}catch(t){const r=this.ensureDebugOutput();return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Get Student Test Results Error</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${t.message}</pre>
        `),{success:!1,error:t.message}}}async testEndpoints(){const t=["/debug/test-student-login","/debug/test-teacher-login","/debug/test-admin-login","/debug/test-get-subjects","/debug/test-get-teacher-subjects","/debug/test-get-class-results","/debug/test-get-student-subjects","/debug/test-get-student-test-results"],r={};for(const n of t)try{const s=await this.get(n);r[n]={success:!0,data:s}}catch(s){r[n]={success:!1,error:s.message}}return r}async debugFunction(t){const r=this.ensureDebugOutput();try{let n;switch(t){case"testDbConnection":n=await this.testDbConnection();break;case"testStudentLogin":n=await this.testStudentLogin();break;case"testTeacherLogin":n=await this.testTeacherLogin();break;case"testAdminLogin":n=await this.testAdminLogin();break;case"testGetSubjects":n=await this.testGetSubjects();break;case"testGetTeacherSubjects":n=await this.testGetTeacherSubjects();break;case"testGetClassResults":n=await this.testGetClassResults();break;case"testGetStudentSubjects":n=await this.testGetStudentSubjects();break;case"testGetStudentTestResults":n=await this.testGetStudentTestResults();break;default:throw new Error(`Unknown debug function: ${t}`)}return r&&(r.innerHTML=`
          <div class="text-sm font-mono text-gray-800 mb-2">Debug Function: ${t}</div>
          <pre class="text-xs bg-gray-100 p-2 rounded overflow-auto">${JSON.stringify(n,null,2)}</pre>
        `),n}catch(n){throw r&&(r.innerHTML=`
          <div class="text-sm font-mono text-red-600 mb-2">Debug Function Error: ${t}</div>
          <pre class="text-xs bg-red-100 p-2 rounded overflow-auto">Error: ${n.message}</pre>
        `),n}}showDebugFunctions(){const t=this.ensureDebugOutput(),r=`
      <div class="text-sm font-mono text-gray-800 mb-4">Debug Functions</div>
      <div class="grid grid-cols-2 gap-2 mb-4">
        <button onclick="apiClient.testDbConnection()" class="px-3 py-2 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors">
          Test DB Connection
        </button>
        <button onclick="apiClient.testStudentLogin()" class="px-3 py-2 bg-green-500 text-white text-xs rounded hover:bg-green-600 transition-colors">
          Test Student Login
        </button>
        <button onclick="apiClient.testTeacherLogin()" class="px-3 py-2 bg-yellow-500 text-white text-xs rounded hover:bg-yellow-600 transition-colors">
          Test Teacher Login
        </button>
        <button onclick="apiClient.testAdminLogin()" class="px-3 py-2 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors">
          Test Admin Login
        </button>
        <button onclick="apiClient.testGetSubjects()" class="px-3 py-2 bg-purple-500 text-white text-xs rounded hover:bg-purple-600 transition-colors">
          Test Get Subjects
        </button>
        <button onclick="apiClient.testGetTeacherSubjects()" class="px-3 py-2 bg-indigo-500 text-white text-xs rounded hover:bg-indigo-600 transition-colors">
          Test Get Teacher Subjects
        </button>
        <button onclick="apiClient.testGetClassResults()" class="px-3 py-2 bg-pink-500 text-white text-xs rounded hover:bg-pink-600 transition-colors">
          Test Get Class Results
        </button>
        <button onclick="apiClient.testGetStudentSubjects()" class="px-3 py-2 bg-teal-500 text-white text-xs rounded hover:bg-teal-600 transition-colors">
          Test Get Student Subjects
        </button>
        <button onclick="apiClient.testGetStudentTestResults()" class="px-3 py-2 bg-orange-500 text-white text-xs rounded hover:bg-orange-600 transition-colors">
          Test Get Student Test Results
        </button>
        <button onclick="apiClient.testEndpoints()" class="px-3 py-2 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 transition-colors">
          Test All Endpoints
        </button>
      </div>
    `;t.innerHTML=r}}const xa=new Ute,S7=w.createContext({});function k7(e){const t=w.useRef(null);return t.current===null&&(t.current=e()),t.current}const C7=typeof window<"u",UU=C7?w.useLayoutEffect:w.useEffect,bS=w.createContext(null);function T7(e,t){e.indexOf(t)===-1&&e.push(t)}function N7(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const w0=(e,t,r)=>r>t?t:r<e?e:r;let E7=()=>{};const _0={},zU=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function WU(e){return typeof e=="object"&&e!==null}const HU=e=>/^0[^.\s]+$/u.test(e);function A7(e){let t;return()=>(t===void 0&&(t=e()),t)}const Mc=e=>e,zte=(e,t)=>r=>t(e(r)),A2=(...e)=>e.reduce(zte),Bv=(e,t,r)=>{const n=t-e;return n===0?1:(r-e)/n};class j7{constructor(){this.subscriptions=[]}add(t){return T7(this.subscriptions,t),()=>N7(this.subscriptions,t)}notify(t,r,n){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,r,n);else for(let a=0;a<s;a++){const i=this.subscriptions[a];i&&i(t,r,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ld=e=>e*1e3,cd=e=>e/1e3;function GU(e,t){return t?e*(1e3/t):0}const VU=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,Wte=1e-7,Hte=12;function Gte(e,t,r,n,s){let a,i,o=0;do i=t+(r-t)/2,a=VU(i,n,s)-e,a>0?r=i:t=i;while(Math.abs(a)>Wte&&++o<Hte);return i}function j2(e,t,r,n){if(e===t&&r===n)return Mc;const s=a=>Gte(a,0,1,e,r);return a=>a===0||a===1?a:VU(s(a),t,n)}const qU=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,KU=e=>t=>1-e(1-t),YU=j2(.33,1.53,.69,.99),P7=KU(YU),XU=qU(P7),JU=e=>(e*=2)<1?.5*P7(e):.5*(2-Math.pow(2,-10*(e-1))),F7=e=>1-Math.sin(Math.acos(e)),QU=KU(F7),ZU=qU(F7),Vte=j2(.42,0,1,1),qte=j2(0,0,.58,1),ez=j2(.42,0,.58,1),Kte=e=>Array.isArray(e)&&typeof e[0]!="number",tz=e=>Array.isArray(e)&&typeof e[0]=="number",Yte={linear:Mc,easeIn:Vte,easeInOut:ez,easeOut:qte,circIn:F7,circInOut:ZU,circOut:QU,backIn:P7,backInOut:XU,backOut:YU,anticipate:JU},Xte=e=>typeof e=="string",j9=e=>{if(tz(e)){E7(e.length===4);const[t,r,n,s]=e;return j2(t,r,n,s)}else if(Xte(e))return Yte[e];return e},ww=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function Jte(e,t){let r=new Set,n=new Set,s=!1,a=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1};function c(d){i.has(d)&&(u.schedule(d),e()),d(o)}const u={schedule:(d,f=!1,h=!1)=>{const p=h&&s?r:n;return f&&i.add(d),p.has(d)||p.add(d),d},cancel:d=>{n.delete(d),i.delete(d)},process:d=>{if(o=d,s){a=!0;return}s=!0,[r,n]=[n,r],r.forEach(c),r.clear(),s=!1,a&&(a=!1,u.process(d))}};return u}const Qte=40;function rz(e,t){let r=!1,n=!0;const s={delta:0,timestamp:0,isProcessing:!1},a=()=>r=!0,i=ww.reduce((_,T)=>(_[T]=Jte(a),_),{}),{setup:o,read:c,resolveKeyframes:u,preUpdate:d,update:f,preRender:h,render:g,postRender:p}=i,x=()=>{const _=_0.useManualTiming?s.timestamp:performance.now();r=!1,_0.useManualTiming||(s.delta=n?1e3/60:Math.max(Math.min(_-s.timestamp,Qte),1)),s.timestamp=_,s.isProcessing=!0,o.process(s),c.process(s),u.process(s),d.process(s),f.process(s),h.process(s),g.process(s),p.process(s),s.isProcessing=!1,r&&t&&(n=!1,e(x))},v=()=>{r=!0,n=!0,s.isProcessing||e(x)};return{schedule:ww.reduce((_,T)=>{const N=i[T];return _[T]=(E,F=!1,j=!1)=>(r||v(),N.schedule(E,F,j)),_},{}),cancel:_=>{for(let T=0;T<ww.length;T++)i[ww[T]].cancel(_)},state:s,steps:i}}const{schedule:Js,cancel:th,state:Ji,steps:S5}=rz(typeof requestAnimationFrame<"u"?requestAnimationFrame:Mc,!0);let k4;function Zte(){k4=void 0}const yl={now:()=>(k4===void 0&&yl.set(Ji.isProcessing||_0.useManualTiming?Ji.timestamp:performance.now()),k4),set:e=>{k4=e,queueMicrotask(Zte)}},nz=e=>t=>typeof t=="string"&&t.startsWith(e),M7=nz("--"),ere=nz("var(--"),R7=e=>ere(e)?tre.test(e.split("/*")[0].trim()):!1,tre=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,P1={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},$v={...P1,transform:e=>w0(0,1,e)},_w={...P1,default:1},gv=e=>Math.round(e*1e5)/1e5,O7=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function rre(e){return e==null}const nre=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,D7=(e,t)=>r=>!!(typeof r=="string"&&nre.test(r)&&r.startsWith(e)||t&&!rre(r)&&Object.prototype.hasOwnProperty.call(r,t)),sz=(e,t,r)=>n=>{if(typeof n!="string")return n;const[s,a,i,o]=n.match(O7);return{[e]:parseFloat(s),[t]:parseFloat(a),[r]:parseFloat(i),alpha:o!==void 0?parseFloat(o):1}},sre=e=>w0(0,255,e),k5={...P1,transform:e=>Math.round(sre(e))},ym={test:D7("rgb","red"),parse:sz("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+k5.transform(e)+", "+k5.transform(t)+", "+k5.transform(r)+", "+gv($v.transform(n))+")"};function are(e){let t="",r="",n="",s="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),s=e.substring(4,5),t+=t,r+=r,n+=n,s+=s),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:s?parseInt(s,16)/255:1}}const YC={test:D7("#"),parse:are,transform:ym.transform},P2=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Df=P2("deg"),ud=P2("%"),dn=P2("px"),ire=P2("vh"),ore=P2("vw"),P9={...ud,parse:e=>ud.parse(e)/100,transform:e=>ud.transform(e*100)},Ip={test:D7("hsl","hue"),parse:sz("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+ud.transform(gv(t))+", "+ud.transform(gv(r))+", "+gv($v.transform(n))+")"},Ya={test:e=>ym.test(e)||YC.test(e)||Ip.test(e),parse:e=>ym.test(e)?ym.parse(e):Ip.test(e)?Ip.parse(e):YC.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?ym.transform(e):Ip.transform(e),getAnimatableNone:e=>{const t=Ya.parse(e);return t.alpha=0,Ya.transform(t)}},lre=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function cre(e){return isNaN(e)&&typeof e=="string"&&(e.match(O7)?.length||0)+(e.match(lre)?.length||0)>0}const az="number",iz="color",ure="var",dre="var(",F9="${}",fre=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Uv(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},s=[];let a=0;const o=t.replace(fre,c=>(Ya.test(c)?(n.color.push(a),s.push(iz),r.push(Ya.parse(c))):c.startsWith(dre)?(n.var.push(a),s.push(ure),r.push(c)):(n.number.push(a),s.push(az),r.push(parseFloat(c))),++a,F9)).split(F9);return{values:r,split:o,indexes:n,types:s}}function oz(e){return Uv(e).values}function lz(e){const{split:t,types:r}=Uv(e),n=t.length;return s=>{let a="";for(let i=0;i<n;i++)if(a+=t[i],s[i]!==void 0){const o=r[i];o===az?a+=gv(s[i]):o===iz?a+=Ya.transform(s[i]):a+=s[i]}return a}}const hre=e=>typeof e=="number"?0:Ya.test(e)?Ya.getAnimatableNone(e):e;function mre(e){const t=oz(e);return lz(e)(t.map(hre))}const rh={test:cre,parse:oz,createTransformer:lz,getAnimatableNone:mre};function C5(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function gre({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,t/=100,r/=100;let s=0,a=0,i=0;if(!t)s=a=i=r;else{const o=r<.5?r*(1+t):r+t-r*t,c=2*r-o;s=C5(c,o,e+1/3),a=C5(c,o,e),i=C5(c,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(a*255),blue:Math.round(i*255),alpha:n}}function V4(e,t){return r=>r>0?t:e}const ia=(e,t,r)=>e+(t-e)*r,T5=(e,t,r)=>{const n=e*e,s=r*(t*t-n)+n;return s<0?0:Math.sqrt(s)},pre=[YC,ym,Ip],xre=e=>pre.find(t=>t.test(e));function M9(e){const t=xre(e);if(!t)return!1;let r=t.parse(e);return t===Ip&&(r=gre(r)),r}const R9=(e,t)=>{const r=M9(e),n=M9(t);if(!r||!n)return V4(e,t);const s={...r};return a=>(s.red=T5(r.red,n.red,a),s.green=T5(r.green,n.green,a),s.blue=T5(r.blue,n.blue,a),s.alpha=ia(r.alpha,n.alpha,a),ym.transform(s))},XC=new Set(["none","hidden"]);function yre(e,t){return XC.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function vre(e,t){return r=>ia(e,t,r)}function I7(e){return typeof e=="number"?vre:typeof e=="string"?R7(e)?V4:Ya.test(e)?R9:_re:Array.isArray(e)?cz:typeof e=="object"?Ya.test(e)?R9:bre:V4}function cz(e,t){const r=[...e],n=r.length,s=e.map((a,i)=>I7(a)(a,t[i]));return a=>{for(let i=0;i<n;i++)r[i]=s[i](a);return r}}function bre(e,t){const r={...e,...t},n={};for(const s in r)e[s]!==void 0&&t[s]!==void 0&&(n[s]=I7(e[s])(e[s],t[s]));return s=>{for(const a in n)r[a]=n[a](s);return r}}function wre(e,t){const r=[],n={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],i=e.indexes[a][n[a]],o=e.values[i]??0;r[s]=o,n[a]++}return r}const _re=(e,t)=>{const r=rh.createTransformer(t),n=Uv(e),s=Uv(t);return n.indexes.var.length===s.indexes.var.length&&n.indexes.color.length===s.indexes.color.length&&n.indexes.number.length>=s.indexes.number.length?XC.has(e)&&!s.values.length||XC.has(t)&&!n.values.length?yre(e,t):A2(cz(wre(n,s),s.values),r):V4(e,t)};function uz(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?ia(e,t,r):I7(e)(e,t)}const Sre=e=>{const t=({timestamp:r})=>e(r);return{start:(r=!0)=>Js.update(t,r),stop:()=>th(t),now:()=>Ji.isProcessing?Ji.timestamp:yl.now()}},dz=(e,t,r=10)=>{let n="";const s=Math.max(Math.round(t/r),2);for(let a=0;a<s;a++)n+=Math.round(e(a/(s-1))*1e4)/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},q4=2e4;function L7(e){let t=0;const r=50;let n=e.next(t);for(;!n.done&&t<q4;)t+=r,n=e.next(t);return t>=q4?1/0:t}function kre(e,t=100,r){const n=r({...e,keyframes:[0,t]}),s=Math.min(L7(n),q4);return{type:"keyframes",ease:a=>n.next(s*a).value/t,duration:cd(s)}}const Cre=5;function fz(e,t,r){const n=Math.max(t-Cre,0);return GU(r-e(n),t-n)}const ba={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},N5=.001;function Tre({duration:e=ba.duration,bounce:t=ba.bounce,velocity:r=ba.velocity,mass:n=ba.mass}){let s,a,i=1-t;i=w0(ba.minDamping,ba.maxDamping,i),e=w0(ba.minDuration,ba.maxDuration,cd(e)),i<1?(s=u=>{const d=u*i,f=d*e,h=d-r,g=JC(u,i),p=Math.exp(-f);return N5-h/g*p},a=u=>{const f=u*i*e,h=f*r+r,g=Math.pow(i,2)*Math.pow(u,2)*e,p=Math.exp(-f),x=JC(Math.pow(u,2),i);return(-s(u)+N5>0?-1:1)*((h-g)*p)/x}):(s=u=>{const d=Math.exp(-u*e),f=(u-r)*e+1;return-N5+d*f},a=u=>{const d=Math.exp(-u*e),f=(r-u)*(e*e);return d*f});const o=5/e,c=Ere(s,a,o);if(e=ld(e),isNaN(c))return{stiffness:ba.stiffness,damping:ba.damping,duration:e};{const u=Math.pow(c,2)*n;return{stiffness:u,damping:i*2*Math.sqrt(n*u),duration:e}}}const Nre=12;function Ere(e,t,r){let n=r;for(let s=1;s<Nre;s++)n=n-e(n)/t(n);return n}function JC(e,t){return e*Math.sqrt(1-t*t)}const Are=["duration","bounce"],jre=["stiffness","damping","mass"];function O9(e,t){return t.some(r=>e[r]!==void 0)}function Pre(e){let t={velocity:ba.velocity,stiffness:ba.stiffness,damping:ba.damping,mass:ba.mass,isResolvedFromDuration:!1,...e};if(!O9(e,jre)&&O9(e,Are))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(r*1.2),s=n*n,a=2*w0(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:ba.mass,stiffness:s,damping:a}}else{const r=Tre(e);t={...t,...r,mass:ba.mass},t.isResolvedFromDuration=!0}return t}function K4(e=ba.visualDuration,t=ba.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:s}=r;const a=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:a},{stiffness:c,damping:u,mass:d,duration:f,velocity:h,isResolvedFromDuration:g}=Pre({...r,velocity:-cd(r.velocity||0)}),p=h||0,x=u/(2*Math.sqrt(c*d)),v=i-a,C=cd(Math.sqrt(c/d)),b=Math.abs(v)<5;n||(n=b?ba.restSpeed.granular:ba.restSpeed.default),s||(s=b?ba.restDelta.granular:ba.restDelta.default);let _;if(x<1){const N=JC(C,x);_=E=>{const F=Math.exp(-x*C*E);return i-F*((p+x*C*v)/N*Math.sin(N*E)+v*Math.cos(N*E))}}else if(x===1)_=N=>i-Math.exp(-C*N)*(v+(p+C*v)*N);else{const N=C*Math.sqrt(x*x-1);_=E=>{const F=Math.exp(-x*C*E),j=Math.min(N*E,300);return i-F*((p+x*C*v)*Math.sinh(j)+N*v*Math.cosh(j))/N}}const T={calculatedDuration:g&&f||null,next:N=>{const E=_(N);if(g)o.done=N>=f;else{let F=N===0?p:0;x<1&&(F=N===0?ld(p):fz(_,N,E));const j=Math.abs(F)<=n,P=Math.abs(i-E)<=s;o.done=j&&P}return o.value=o.done?i:E,o},toString:()=>{const N=Math.min(L7(T),q4),E=dz(F=>T.next(N*F).value,N,30);return N+"ms "+E},toTransition:()=>{}};return T}K4.applyToOptions=e=>{const t=kre(e,100,K4);return e.ease=t.ease,e.duration=ld(t.duration),e.type="keyframes",e};function QC({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:a=500,modifyTarget:i,min:o,max:c,restDelta:u=.5,restSpeed:d}){const f=e[0],h={done:!1,value:f},g=j=>o!==void 0&&j<o||c!==void 0&&j>c,p=j=>o===void 0?c:c===void 0||Math.abs(o-j)<Math.abs(c-j)?o:c;let x=r*t;const v=f+x,C=i===void 0?v:i(v);C!==v&&(x=C-f);const b=j=>-x*Math.exp(-j/n),_=j=>C+b(j),T=j=>{const P=b(j),M=_(j);h.done=Math.abs(P)<=u,h.value=h.done?C:M};let N,E;const F=j=>{g(h.value)&&(N=j,E=K4({keyframes:[h.value,p(h.value)],velocity:fz(_,j,h.value),damping:s,stiffness:a,restDelta:u,restSpeed:d}))};return F(0),{calculatedDuration:null,next:j=>{let P=!1;return!E&&N===void 0&&(P=!0,T(j),F(j)),N!==void 0&&j>=N?E.next(j-N):(!P&&T(j),h)}}}function Fre(e,t,r){const n=[],s=r||_0.mix||uz,a=e.length-1;for(let i=0;i<a;i++){let o=s(e[i],e[i+1]);if(t){const c=Array.isArray(t)?t[i]||Mc:t;o=A2(c,o)}n.push(o)}return n}function Mre(e,t,{clamp:r=!0,ease:n,mixer:s}={}){const a=e.length;if(E7(a===t.length),a===1)return()=>t[0];if(a===2&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[a-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=Fre(t,n,s),c=o.length,u=d=>{if(i&&d<e[0])return t[0];let f=0;if(c>1)for(;f<e.length-2&&!(d<e[f+1]);f++);const h=Bv(e[f],e[f+1],d);return o[f](h)};return r?d=>u(w0(e[0],e[a-1],d)):u}function Rre(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const s=Bv(0,t,n);e.push(ia(r,1,s))}}function Ore(e){const t=[0];return Rre(t,e.length-1),t}function Dre(e,t){return e.map(r=>r*t)}function Ire(e,t){return e.map(()=>t||ez).splice(0,e.length-1)}function pv({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const s=Kte(n)?n.map(j9):j9(n),a={done:!1,value:t[0]},i=Dre(r&&r.length===t.length?r:Ore(t),e),o=Mre(i,t,{ease:Array.isArray(s)?s:Ire(t,s)});return{calculatedDuration:e,next:c=>(a.value=o(c),a.done=c>=e,a)}}const Lre=e=>e!==null;function B7(e,{repeat:t,repeatType:r="loop"},n,s=1){const a=e.filter(Lre),o=s<0||t&&r!=="loop"&&t%2===1?0:a.length-1;return!o||n===void 0?a[o]:n}const Bre={decay:QC,inertia:QC,tween:pv,keyframes:pv,spring:K4};function hz(e){typeof e.type=="string"&&(e.type=Bre[e.type])}class $7{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,r){return this.finished.then(t,r)}}const $re=e=>e/100;class U7 extends $7{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==yl.now()&&this.tick(yl.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;hz(t);const{type:r=pv,repeat:n=0,repeatDelay:s=0,repeatType:a,velocity:i=0}=t;let{keyframes:o}=t;const c=r||pv;c!==pv&&typeof o[0]!="number"&&(this.mixKeyframes=A2($re,uz(o[0],o[1])),o=[0,100]);const u=c({...t,keyframes:o});a==="mirror"&&(this.mirroredGenerator=c({...t,keyframes:[...o].reverse(),velocity:-i})),u.calculatedDuration===null&&(u.calculatedDuration=L7(u));const{calculatedDuration:d}=u;this.calculatedDuration=d,this.resolvedDuration=d+s,this.totalDuration=this.resolvedDuration*(n+1)-s,this.generator=u}updateTime(t){const r=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(t,r=!1){const{generator:n,totalDuration:s,mixKeyframes:a,mirroredGenerator:i,resolvedDuration:o,calculatedDuration:c}=this;if(this.startTime===null)return n.next(0);const{delay:u=0,keyframes:d,repeat:f,repeatType:h,repeatDelay:g,type:p,onUpdate:x,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),r?this.currentTime=t:this.updateTime(t);const C=this.currentTime-u*(this.playbackSpeed>=0?1:-1),b=this.playbackSpeed>=0?C<0:C>s;this.currentTime=Math.max(C,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let _=this.currentTime,T=n;if(f){const j=Math.min(this.currentTime,s)/o;let P=Math.floor(j),M=j%1;!M&&j>=1&&(M=1),M===1&&P--,P=Math.min(P,f+1),!!(P%2)&&(h==="reverse"?(M=1-M,g&&(M-=g/o)):h==="mirror"&&(T=i)),_=w0(0,1,M)*o}const N=b?{done:!1,value:d[0]}:T.next(_);a&&(N.value=a(N.value));let{done:E}=N;!b&&c!==null&&(E=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const F=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&E);return F&&p!==QC&&(N.value=B7(d,this.options,v,this.speed)),x&&x(N.value),F&&this.finish(),N}then(t,r){return this.finished.then(t,r)}get duration(){return cd(this.calculatedDuration)}get time(){return cd(this.currentTime)}set time(t){t=ld(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(yl.now());const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=cd(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=Sre,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),this.options.onPlay?.();const n=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=n):this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime||(this.startTime=r??n),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(yl.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),t.observe(this)}}function Ure(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const vm=e=>e*180/Math.PI,ZC=e=>{const t=vm(Math.atan2(e[1],e[0]));return eT(t)},zre={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:ZC,rotateZ:ZC,skewX:e=>vm(Math.atan(e[1])),skewY:e=>vm(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},eT=e=>(e=e%360,e<0&&(e+=360),e),D9=ZC,I9=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),L9=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Wre={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:I9,scaleY:L9,scale:e=>(I9(e)+L9(e))/2,rotateX:e=>eT(vm(Math.atan2(e[6],e[5]))),rotateY:e=>eT(vm(Math.atan2(-e[2],e[0]))),rotateZ:D9,rotate:D9,skewX:e=>vm(Math.atan(e[4])),skewY:e=>vm(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function tT(e){return e.includes("scale")?1:0}function rT(e,t){if(!e||e==="none")return tT(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,s;if(r)n=Wre,s=r;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=zre,s=o}if(!s)return tT(t);const a=n[t],i=s[1].split(",").map(Gre);return typeof a=="function"?a(i):i[a]}const Hre=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return rT(r,t)};function Gre(e){return parseFloat(e.trim())}const F1=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],M1=new Set(F1),B9=e=>e===P1||e===dn,Vre=new Set(["x","y","z"]),qre=F1.filter(e=>!Vre.has(e));function Kre(e){const t=[];return qre.forEach(r=>{const n=e.getValue(r);n!==void 0&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}const Nm={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>rT(t,"x"),y:(e,{transform:t})=>rT(t,"y")};Nm.translateX=Nm.x;Nm.translateY=Nm.y;const Em=new Set;let nT=!1,sT=!1,aT=!1;function mz(){if(sT){const e=Array.from(Em).filter(n=>n.needsMeasurement),t=new Set(e.map(n=>n.element)),r=new Map;t.forEach(n=>{const s=Kre(n);s.length&&(r.set(n,s),n.render())}),e.forEach(n=>n.measureInitialState()),t.forEach(n=>{n.render();const s=r.get(n);s&&s.forEach(([a,i])=>{n.getValue(a)?.set(i)})}),e.forEach(n=>n.measureEndState()),e.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}sT=!1,nT=!1,Em.forEach(e=>e.complete(aT)),Em.clear()}function gz(){Em.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(sT=!0)})}function Yre(){aT=!0,gz(),mz(),aT=!1}class z7{constructor(t,r,n,s,a,i=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=n,this.motionValue=s,this.element=a,this.isAsync=i}scheduleResolve(){this.state="scheduled",this.isAsync?(Em.add(this),nT||(nT=!0,Js.read(gz),Js.resolveKeyframes(mz))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:n,motionValue:s}=this;if(t[0]===null){const a=s?.get(),i=t[t.length-1];if(a!==void 0)t[0]=a;else if(n&&r){const o=n.readValue(r,i);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=i),s&&a===void 0&&s.set(t[0])}Ure(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),Em.delete(this)}cancel(){this.state==="scheduled"&&(Em.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const Xre=e=>e.startsWith("--");function Jre(e,t,r){Xre(t)?e.style.setProperty(t,r):e.style[t]=r}const Qre=A7(()=>window.ScrollTimeline!==void 0),Zre={};function ene(e,t){const r=A7(e);return()=>Zre[t]??r()}const pz=ene(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),av=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,$9={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:av([0,.65,.55,1]),circOut:av([.55,0,1,.45]),backIn:av([.31,.01,.66,-.59]),backOut:av([.33,1.53,.69,.99])};function xz(e,t){if(e)return typeof e=="function"?pz()?dz(e,t):"ease-out":tz(e)?av(e):Array.isArray(e)?e.map(r=>xz(r,t)||$9.easeOut):$9[e]}function tne(e,t,r,{delay:n=0,duration:s=300,repeat:a=0,repeatType:i="loop",ease:o="easeOut",times:c}={},u=void 0){const d={[t]:r};c&&(d.offset=c);const f=xz(o,s);Array.isArray(f)&&(d.easing=f);const h={delay:n,duration:s,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:i==="reverse"?"alternate":"normal"};return u&&(h.pseudoElement=u),e.animate(d,h)}function yz(e){return typeof e=="function"&&"applyToOptions"in e}function rne({type:e,...t}){return yz(e)&&pz()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class nne extends $7{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:r,name:n,keyframes:s,pseudoElement:a,allowFlatten:i=!1,finalKeyframe:o,onComplete:c}=t;this.isPseudoElement=!!a,this.allowFlatten=i,this.options=t,E7(typeof t.type!="string");const u=rne(t);this.animation=tne(r,n,s,u,a),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const d=B7(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(d):Jre(r,n,d),this.animation.cancel()}c?.(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const t=this.animation.effect?.getComputedTiming?.().duration||0;return cd(Number(t))}get time(){return cd(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=ld(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,t&&Qre()?(this.animation.timeline=t,Mc):r(this)}}const vz={anticipate:JU,backInOut:XU,circInOut:ZU};function sne(e){return e in vz}function ane(e){typeof e.ease=="string"&&sne(e.ease)&&(e.ease=vz[e.ease])}const U9=10;class ine extends nne{constructor(t){ane(t),hz(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:r,onUpdate:n,onComplete:s,element:a,...i}=this.options;if(!r)return;if(t!==void 0){r.set(t);return}const o=new U7({...i,autoplay:!1}),c=ld(this.finishedTime??this.time);r.setWithVelocity(o.sample(c-U9).value,o.sample(c).value,U9),o.stop()}}const z9=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(rh.test(e)||e==="0")&&!e.startsWith("url("));function one(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function lne(e,t,r,n){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const a=e[e.length-1],i=z9(s,t),o=z9(a,t);return!i||!o?!1:one(e)||(r==="spring"||yz(r))&&n}function iT(e){e.duration=0,e.type}const cne=new Set(["opacity","clipPath","filter","transform"]),une=A7(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function dne(e){const{motionValue:t,name:r,repeatDelay:n,repeatType:s,damping:a,type:i}=e;if(!(t?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=t.owner.getProps();return une()&&r&&cne.has(r)&&(r!=="transform"||!u)&&!c&&!n&&s!=="mirror"&&a!==0&&i!=="inertia"}const fne=40;class hne extends $7{constructor({autoplay:t=!0,delay:r=0,type:n="keyframes",repeat:s=0,repeatDelay:a=0,repeatType:i="loop",keyframes:o,name:c,motionValue:u,element:d,...f}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=yl.now();const h={autoplay:t,delay:r,type:n,repeat:s,repeatDelay:a,repeatType:i,name:c,motionValue:u,element:d,...f},g=d?.KeyframeResolver||z7;this.keyframeResolver=new g(o,(p,x,v)=>this.onKeyframesResolved(p,x,h,!v),c,u,d),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(t,r,n,s){this.keyframeResolver=void 0;const{name:a,type:i,velocity:o,delay:c,isHandoff:u,onUpdate:d}=n;this.resolvedAt=yl.now(),lne(t,a,i,o)||((_0.instantAnimations||!c)&&d?.(B7(t,n,r)),t[0]=t[t.length-1],iT(n),n.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>fne?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...n,keyframes:t},g=!u&&dne(h)?new ine({...h,element:h.motionValue.owner.current}):new U7(h);g.finished.then(()=>this.notifyFinished()).catch(Mc),this.pendingTimeline&&(this.stopTimeline=g.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=g}get finished(){return this._animation?this.animation.finished:this._finished}then(t,r){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),Yre()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}const mne=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function gne(e){const t=mne.exec(e);if(!t)return[,];const[,r,n,s]=t;return[`--${r??n}`,s]}function bz(e,t,r=1){const[n,s]=gne(e);if(!n)return;const a=window.getComputedStyle(t).getPropertyValue(n);if(a){const i=a.trim();return zU(i)?parseFloat(i):i}return R7(s)?bz(s,t,r+1):s}function W7(e,t){return e?.[t]??e?.default??e}const wz=new Set(["width","height","top","left","right","bottom",...F1]),pne={test:e=>e==="auto",parse:e=>e},_z=e=>t=>t.test(e),Sz=[P1,dn,ud,Df,ore,ire,pne],W9=e=>Sz.find(_z(e));function xne(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||HU(e):!0}const yne=new Set(["brightness","contrast","saturate","opacity"]);function vne(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[n]=r.match(O7)||[];if(!n)return e;const s=r.replace(n,"");let a=yne.has(t)?1:0;return n!==r&&(a*=100),t+"("+a+s+")"}const bne=/\b([a-z-]*)\(.*?\)/gu,oT={...rh,getAnimatableNone:e=>{const t=e.match(bne);return t?t.map(vne).join(" "):e}},H9={...P1,transform:Math.round},wne={rotate:Df,rotateX:Df,rotateY:Df,rotateZ:Df,scale:_w,scaleX:_w,scaleY:_w,scaleZ:_w,skew:Df,skewX:Df,skewY:Df,distance:dn,translateX:dn,translateY:dn,translateZ:dn,x:dn,y:dn,z:dn,perspective:dn,transformPerspective:dn,opacity:$v,originX:P9,originY:P9,originZ:dn},H7={borderWidth:dn,borderTopWidth:dn,borderRightWidth:dn,borderBottomWidth:dn,borderLeftWidth:dn,borderRadius:dn,radius:dn,borderTopLeftRadius:dn,borderTopRightRadius:dn,borderBottomRightRadius:dn,borderBottomLeftRadius:dn,width:dn,maxWidth:dn,height:dn,maxHeight:dn,top:dn,right:dn,bottom:dn,left:dn,padding:dn,paddingTop:dn,paddingRight:dn,paddingBottom:dn,paddingLeft:dn,margin:dn,marginTop:dn,marginRight:dn,marginBottom:dn,marginLeft:dn,backgroundPositionX:dn,backgroundPositionY:dn,...wne,zIndex:H9,fillOpacity:$v,strokeOpacity:$v,numOctaves:H9},_ne={...H7,color:Ya,backgroundColor:Ya,outlineColor:Ya,fill:Ya,stroke:Ya,borderColor:Ya,borderTopColor:Ya,borderRightColor:Ya,borderBottomColor:Ya,borderLeftColor:Ya,filter:oT,WebkitFilter:oT},kz=e=>_ne[e];function Cz(e,t){let r=kz(e);return r!==oT&&(r=rh),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const Sne=new Set(["auto","none","0"]);function kne(e,t,r){let n=0,s;for(;n<e.length&&!s;){const a=e[n];typeof a=="string"&&!Sne.has(a)&&Uv(a).values.length&&(s=e[n]),n++}if(s&&r)for(const a of t)e[a]=Cz(r,s)}class Cne extends z7{constructor(t,r,n,s,a){super(t,r,n,s,a,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:n}=this;if(!r||!r.current)return;super.readKeyframes();for(let c=0;c<t.length;c++){let u=t[c];if(typeof u=="string"&&(u=u.trim(),R7(u))){const d=bz(u,r.current);d!==void 0&&(t[c]=d),c===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!wz.has(n)||t.length!==2)return;const[s,a]=t,i=W9(s),o=W9(a);if(i!==o)if(B9(i)&&B9(o))for(let c=0;c<t.length;c++){const u=t[c];typeof u=="string"&&(t[c]=parseFloat(u))}else Nm[n]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,n=[];for(let s=0;s<t.length;s++)(t[s]===null||xne(t[s]))&&n.push(s);n.length&&kne(t,n,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:n}=this;if(!t||!t.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Nm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const s=r[r.length-1];s!==void 0&&t.getValue(n,s).jump(s,!1)}measureEndState(){const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const s=t.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=n.length-1,i=n[a];n[a]=Nm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),i!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=i),this.removedTransforms?.length&&this.removedTransforms.forEach(([o,c])=>{t.getValue(o).set(c)}),this.resolveNoneKeyframes()}}function Tne(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let n=document;const s=r?.[e]??n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}const Tz=(e,t)=>t&&typeof e=="number"?t.transform(e):e;function Nz(e){return WU(e)&&"offsetHeight"in e}const G9=30,Nne=e=>!isNaN(parseFloat(e));class Ene{constructor(t,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=n=>{const s=yl.now();if(this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=yl.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=Nne(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new j7);const n=this.events[t].add(r);return t==="change"?()=>{n(),Js.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t){this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t)}setWithVelocity(t,r,n){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-n}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(t){this.dependents||(this.dependents=new Set),this.dependents.add(t)}removeDependent(t){this.dependents&&this.dependents.delete(t)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=yl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>G9)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,G9);return GU(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function l1(e,t){return new Ene(e,t)}const{schedule:G7}=rz(queueMicrotask,!1),uu={x:!1,y:!1};function Ez(){return uu.x||uu.y}function Ane(e){return e==="x"||e==="y"?uu[e]?null:(uu[e]=!0,()=>{uu[e]=!1}):uu.x||uu.y?null:(uu.x=uu.y=!0,()=>{uu.x=uu.y=!1})}function Az(e,t){const r=Tne(e),n=new AbortController,s={passive:!0,...t,signal:n.signal};return[r,s,()=>n.abort()]}function V9(e){return!(e.pointerType==="touch"||Ez())}function jne(e,t,r={}){const[n,s,a]=Az(e,r),i=o=>{if(!V9(o))return;const{target:c}=o,u=t(c,o);if(typeof u!="function"||!c)return;const d=f=>{V9(f)&&(u(f),c.removeEventListener("pointerleave",d))};c.addEventListener("pointerleave",d,s)};return n.forEach(o=>{o.addEventListener("pointerenter",i,s)}),a}const jz=(e,t)=>t?e===t?!0:jz(e,t.parentElement):!1,V7=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,Pne=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Fne(e){return Pne.has(e.tagName)||e.tabIndex!==-1}const C4=new WeakSet;function q9(e){return t=>{t.key==="Enter"&&e(t)}}function E5(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const Mne=(e,t)=>{const r=e.currentTarget;if(!r)return;const n=q9(()=>{if(C4.has(r))return;E5(r,"down");const s=q9(()=>{E5(r,"up")}),a=()=>E5(r,"cancel");r.addEventListener("keyup",s,t),r.addEventListener("blur",a,t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)};function K9(e){return V7(e)&&!Ez()}function Rne(e,t,r={}){const[n,s,a]=Az(e,r),i=o=>{const c=o.currentTarget;if(!K9(o))return;C4.add(c);const u=t(c,o),d=(g,p)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",h),C4.has(c)&&C4.delete(c),K9(g)&&typeof u=="function"&&u(g,{success:p})},f=g=>{d(g,c===window||c===document||r.useGlobalTarget||jz(c,g.target))},h=g=>{d(g,!1)};window.addEventListener("pointerup",f,s),window.addEventListener("pointercancel",h,s)};return n.forEach(o=>{(r.useGlobalTarget?window:o).addEventListener("pointerdown",i,s),Nz(o)&&(o.addEventListener("focus",u=>Mne(u,s)),!Fne(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),a}function Pz(e){return WU(e)&&"ownerSVGElement"in e}function One(e){return Pz(e)&&e.tagName==="svg"}const Co=e=>!!(e&&e.getVelocity),Dne=[...Sz,Ya,rh],Ine=e=>Dne.find(_z(e)),q7=w.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class Lne extends w.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const n=r.offsetParent,s=Nz(n)&&n.offsetWidth||0,a=this.props.sizeRef.current;a.height=r.offsetHeight||0,a.width=r.offsetWidth||0,a.top=r.offsetTop,a.left=r.offsetLeft,a.right=s-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Bne({children:e,isPresent:t,anchorX:r,root:n}){const s=w.useId(),a=w.useRef(null),i=w.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=w.useContext(q7);return w.useInsertionEffect(()=>{const{width:c,height:u,top:d,left:f,right:h}=i.current;if(t||!a.current||!c||!u)return;const g=r==="left"?`left: ${f}`:`right: ${h}`;a.current.dataset.motionPopId=s;const p=document.createElement("style");o&&(p.nonce=o);const x=n??document.head;return x.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${s}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${g}px !important;
            top: ${d}px !important;
          }
        `),()=>{x.contains(p)&&x.removeChild(p)}},[t]),l.jsx(Lne,{isPresent:t,childRef:a,sizeRef:i,children:w.cloneElement(e,{ref:a})})}const $ne=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:s,presenceAffectsLayout:a,mode:i,anchorX:o,root:c})=>{const u=k7(Une),d=w.useId();let f=!0,h=w.useMemo(()=>(f=!1,{id:d,initial:t,isPresent:r,custom:s,onExitComplete:g=>{u.set(g,!0);for(const p of u.values())if(!p)return;n&&n()},register:g=>(u.set(g,!1),()=>u.delete(g))}),[r,u,n]);return a&&f&&(h={...h}),w.useMemo(()=>{u.forEach((g,p)=>u.set(p,!1))},[r]),w.useEffect(()=>{!r&&!u.size&&n&&n()},[r]),i==="popLayout"&&(e=l.jsx(Bne,{isPresent:r,anchorX:o,root:c,children:e})),l.jsx(bS.Provider,{value:h,children:e})};function Une(){return new Map}function Fz(e=!0){const t=w.useContext(bS);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:n,register:s}=t,a=w.useId();w.useEffect(()=>{if(e)return s(a)},[e]);const i=w.useCallback(()=>e&&n&&n(a),[a,n,e]);return!r&&n?[!1,i]:[!0]}const Sw=e=>e.key||"";function Y9(e){const t=[];return w.Children.forEach(e,r=>{w.isValidElement(r)&&t.push(r)}),t}const Ai=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:s=!0,mode:a="sync",propagate:i=!1,anchorX:o="left",root:c})=>{const[u,d]=Fz(i),f=w.useMemo(()=>Y9(e),[e]),h=i&&!u?[]:f.map(Sw),g=w.useRef(!0),p=w.useRef(f),x=k7(()=>new Map),[v,C]=w.useState(f),[b,_]=w.useState(f);UU(()=>{g.current=!1,p.current=f;for(let E=0;E<b.length;E++){const F=Sw(b[E]);h.includes(F)?x.delete(F):x.get(F)!==!0&&x.set(F,!1)}},[b,h.length,h.join("-")]);const T=[];if(f!==v){let E=[...f];for(let F=0;F<b.length;F++){const j=b[F],P=Sw(j);h.includes(P)||(E.splice(F,0,j),T.push(j))}return a==="wait"&&T.length&&(E=T),_(Y9(E)),C(f),null}const{forceRender:N}=w.useContext(S7);return l.jsx(l.Fragment,{children:b.map(E=>{const F=Sw(E),j=i&&!u?!1:f===b||h.includes(F),P=()=>{if(x.has(F))x.set(F,!0);else return;let M=!0;x.forEach(I=>{I||(M=!1)}),M&&(N?.(),_(p.current),i&&d?.(),n&&n())};return l.jsx($ne,{isPresent:j,initial:!g.current||r?void 0:!1,custom:t,presenceAffectsLayout:s,mode:a,root:c,onExitComplete:j?void 0:P,anchorX:o,children:E},F)})})},Mz=w.createContext({strict:!1}),X9={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},c1={};for(const e in X9)c1[e]={isEnabled:t=>X9[e].some(r=>!!t[r])};function zne(e){for(const t in e)c1[t]={...c1[t],...e[t]}}const Wne=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Y4(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Wne.has(e)}let Rz=e=>!Y4(e);function Hne(e){typeof e=="function"&&(Rz=t=>t.startsWith("on")?!Y4(t):e(t))}try{Hne(require("@emotion/is-prop-valid").default)}catch{}function Gne(e,t,r){const n={};for(const s in e)s==="values"&&typeof e.values=="object"||(Rz(s)||r===!0&&Y4(s)||!t&&!Y4(s)||e.draggable&&s.startsWith("onDrag"))&&(n[s]=e[s]);return n}const wS=w.createContext({});function _S(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function zv(e){return typeof e=="string"||Array.isArray(e)}const K7=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Y7=["initial",...K7];function SS(e){return _S(e.animate)||Y7.some(t=>zv(e[t]))}function Oz(e){return!!(SS(e)||e.variants)}function Vne(e,t){if(SS(e)){const{initial:r,animate:n}=e;return{initial:r===!1||zv(r)?r:void 0,animate:zv(n)?n:void 0}}return e.inherit!==!1?t:{}}function qne(e){const{initial:t,animate:r}=Vne(e,w.useContext(wS));return w.useMemo(()=>({initial:t,animate:r}),[J9(t),J9(r)])}function J9(e){return Array.isArray(e)?e.join(" "):e}const Wv={};function Kne(e){for(const t in e)Wv[t]=e[t],M7(t)&&(Wv[t].isCSSVariable=!0)}function Dz(e,{layout:t,layoutId:r}){return M1.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Wv[e]||e==="opacity")}const Yne={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Xne=F1.length;function Jne(e,t,r){let n="",s=!0;for(let a=0;a<Xne;a++){const i=F1[a],o=e[i];if(o===void 0)continue;let c=!0;if(typeof o=="number"?c=o===(i.startsWith("scale")?1:0):c=parseFloat(o)===0,!c||r){const u=Tz(o,H7[i]);if(!c){s=!1;const d=Yne[i]||i;n+=`${d}(${u}) `}r&&(t[i]=u)}}return n=n.trim(),r?n=r(t,s?"":n):s&&(n="none"),n}function X7(e,t,r){const{style:n,vars:s,transformOrigin:a}=e;let i=!1,o=!1;for(const c in t){const u=t[c];if(M1.has(c)){i=!0;continue}else if(M7(c)){s[c]=u;continue}else{const d=Tz(u,H7[c]);c.startsWith("origin")?(o=!0,a[c]=d):n[c]=d}}if(t.transform||(i||r?n.transform=Jne(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:c="50%",originY:u="50%",originZ:d=0}=a;n.transformOrigin=`${c} ${u} ${d}`}}const J7=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Iz(e,t,r){for(const n in t)!Co(t[n])&&!Dz(n,r)&&(e[n]=t[n])}function Qne({transformTemplate:e},t){return w.useMemo(()=>{const r=J7();return X7(r,t,e),Object.assign({},r.vars,r.style)},[t])}function Zne(e,t){const r=e.style||{},n={};return Iz(n,r,e),Object.assign(n,Qne(e,t)),n}function ese(e,t){const r={},n=Zne(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const tse={offset:"stroke-dashoffset",array:"stroke-dasharray"},rse={offset:"strokeDashoffset",array:"strokeDasharray"};function nse(e,t,r=1,n=0,s=!0){e.pathLength=1;const a=s?tse:rse;e[a.offset]=dn.transform(-n);const i=dn.transform(t),o=dn.transform(r);e[a.array]=`${i} ${o}`}function Lz(e,{attrX:t,attrY:r,attrScale:n,pathLength:s,pathSpacing:a=1,pathOffset:i=0,...o},c,u,d){if(X7(e,o,u),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:f,style:h}=e;f.transform&&(h.transform=f.transform,delete f.transform),(h.transform||f.transformOrigin)&&(h.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),h.transform&&(h.transformBox=d?.transformBox??"fill-box",delete f.transformBox),t!==void 0&&(f.x=t),r!==void 0&&(f.y=r),n!==void 0&&(f.scale=n),s!==void 0&&nse(f,s,a,i,!1)}const Bz=()=>({...J7(),attrs:{}}),$z=e=>typeof e=="string"&&e.toLowerCase()==="svg";function sse(e,t,r,n){const s=w.useMemo(()=>{const a=Bz();return Lz(a,t,$z(n),e.transformTemplate,e.style),{...a.attrs,style:{...a.style}}},[t]);if(e.style){const a={};Iz(a,e.style,e),s.style={...a,...s.style}}return s}const ase=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Q7(e){return typeof e!="string"||e.includes("-")?!1:!!(ase.indexOf(e)>-1||/[A-Z]/u.test(e))}function ise(e,t,r,{latestValues:n},s,a=!1){const o=(Q7(e)?sse:ese)(t,n,s,e),c=Gne(t,typeof e=="string",a),u=e!==w.Fragment?{...c,...o,ref:r}:{},{children:d}=t,f=w.useMemo(()=>Co(d)?d.get():d,[d]);return w.createElement(e,{...u,children:f})}function Q9(e){const t=[{},{}];return e?.values.forEach((r,n)=>{t[0][n]=r.get(),t[1][n]=r.getVelocity()}),t}function Z7(e,t,r,n){if(typeof t=="function"){const[s,a]=Q9(n);t=t(r!==void 0?r:e.custom,s,a)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,a]=Q9(n);t=t(r!==void 0?r:e.custom,s,a)}return t}function T4(e){return Co(e)?e.get():e}function ose({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,s){return{latestValues:lse(r,n,s,e),renderState:t()}}function lse(e,t,r,n){const s={},a=n(e,{});for(const h in a)s[h]=T4(a[h]);let{initial:i,animate:o}=e;const c=SS(e),u=Oz(e);t&&u&&!c&&e.inherit!==!1&&(i===void 0&&(i=t.initial),o===void 0&&(o=t.animate));let d=r?r.initial===!1:!1;d=d||i===!1;const f=d?o:i;if(f&&typeof f!="boolean"&&!_S(f)){const h=Array.isArray(f)?f:[f];for(let g=0;g<h.length;g++){const p=Z7(e,h[g]);if(p){const{transitionEnd:x,transition:v,...C}=p;for(const b in C){let _=C[b];if(Array.isArray(_)){const T=d?_.length-1:0;_=_[T]}_!==null&&(s[b]=_)}for(const b in x)s[b]=x[b]}}}return s}const Uz=e=>(t,r)=>{const n=w.useContext(wS),s=w.useContext(bS),a=()=>ose(e,t,n,s);return r?a():k7(a)};function eN(e,t,r){const{style:n}=e,s={};for(const a in n)(Co(n[a])||t.style&&Co(t.style[a])||Dz(a,e)||r?.getValue(a)?.liveStyle!==void 0)&&(s[a]=n[a]);return s}const cse=Uz({scrapeMotionValuesFromProps:eN,createRenderState:J7});function zz(e,t,r){const n=eN(e,t,r);for(const s in e)if(Co(e[s])||Co(t[s])){const a=F1.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;n[a]=e[s]}return n}const use=Uz({scrapeMotionValuesFromProps:zz,createRenderState:Bz}),dse=Symbol.for("motionComponentSymbol");function Lp(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function fse(e,t,r){return w.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&(typeof r=="function"?r(n):Lp(r)&&(r.current=n))},[t])}const tN=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),hse="framerAppearId",Wz="data-"+tN(hse),Hz=w.createContext({});function mse(e,t,r,n,s){const{visualElement:a}=w.useContext(wS),i=w.useContext(Mz),o=w.useContext(bS),c=w.useContext(q7).reducedMotion,u=w.useRef(null);n=n||i.renderer,!u.current&&n&&(u.current=n(e,{visualState:t,parent:a,props:r,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:c}));const d=u.current,f=w.useContext(Hz);d&&!d.projection&&s&&(d.type==="html"||d.type==="svg")&&gse(u.current,r,s,f);const h=w.useRef(!1);w.useInsertionEffect(()=>{d&&h.current&&d.update(r,o)});const g=r[Wz],p=w.useRef(!!g&&!window.MotionHandoffIsComplete?.(g)&&window.MotionHasOptimisedAnimation?.(g));return UU(()=>{d&&(h.current=!0,window.MotionIsMounted=!0,d.updateFeatures(),d.scheduleRenderMicrotask(),p.current&&d.animationState&&d.animationState.animateChanges())}),w.useEffect(()=>{d&&(!p.current&&d.animationState&&d.animationState.animateChanges(),p.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(g)}),p.current=!1),d.enteringChildren=void 0)}),d}function gse(e,t,r,n){const{layoutId:s,layout:a,drag:i,dragConstraints:o,layoutScroll:c,layoutRoot:u,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:Gz(e.parent)),e.projection.setOptions({layoutId:s,layout:a,alwaysMeasureLayout:!!i||o&&Lp(o),visualElement:e,animationType:typeof a=="string"?a:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:c,layoutRoot:u})}function Gz(e){if(e)return e.options.allowProjection!==!1?e.projection:Gz(e.parent)}function A5(e,{forwardMotionProps:t=!1}={},r,n){r&&zne(r);const s=Q7(e)?use:cse;function a(o,c){let u;const d={...w.useContext(q7),...o,layoutId:pse(o)},{isStatic:f}=d,h=qne(o),g=s(o,f);if(!f&&C7){xse();const p=yse(d);u=p.MeasureLayout,h.visualElement=mse(e,g,d,n,p.ProjectionNode)}return l.jsxs(wS.Provider,{value:h,children:[u&&h.visualElement?l.jsx(u,{visualElement:h.visualElement,...d}):null,ise(e,o,fse(g,h.visualElement,c),g,f,t)]})}a.displayName=`motion.${typeof e=="string"?e:`create(${e.displayName??e.name??""})`}`;const i=w.forwardRef(a);return i[dse]=e,i}function pse({layoutId:e}){const t=w.useContext(S7).id;return t&&e!==void 0?t+"-"+e:e}function xse(e,t){w.useContext(Mz).strict}function yse(e){const{drag:t,layout:r}=c1;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:t?.isEnabled(e)||r?.isEnabled(e)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}function vse(e,t){if(typeof Proxy>"u")return A5;const r=new Map,n=(a,i)=>A5(a,i,e,t),s=(a,i)=>n(a,i);return new Proxy(s,{get:(a,i)=>i==="create"?n:(r.has(i)||r.set(i,A5(i,void 0,e,t)),r.get(i))})}function Vz({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function bse({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function wse(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}function j5(e){return e===void 0||e===1}function lT({scale:e,scaleX:t,scaleY:r}){return!j5(e)||!j5(t)||!j5(r)}function fm(e){return lT(e)||qz(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function qz(e){return Z9(e.x)||Z9(e.y)}function Z9(e){return e&&e!=="0%"}function X4(e,t,r){const n=e-r,s=t*n;return r+s}function eP(e,t,r,n,s){return s!==void 0&&(e=X4(e,s,n)),X4(e,r,n)+t}function cT(e,t=0,r=1,n,s){e.min=eP(e.min,t,r,n,s),e.max=eP(e.max,t,r,n,s)}function Kz(e,{x:t,y:r}){cT(e.x,t.translate,t.scale,t.originPoint),cT(e.y,r.translate,r.scale,r.originPoint)}const tP=.999999999999,rP=1.0000000000001;function _se(e,t,r,n=!1){const s=r.length;if(!s)return;t.x=t.y=1;let a,i;for(let o=0;o<s;o++){a=r[o],i=a.projectionDelta;const{visualElement:c}=a.options;c&&c.props.style&&c.props.style.display==="contents"||(n&&a.options.layoutScroll&&a.scroll&&a!==a.root&&$p(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,Kz(e,i)),n&&fm(a.latestValues)&&$p(e,a.latestValues))}t.x<rP&&t.x>tP&&(t.x=1),t.y<rP&&t.y>tP&&(t.y=1)}function Bp(e,t){e.min=e.min+t,e.max=e.max+t}function nP(e,t,r,n,s=.5){const a=ia(e.min,e.max,s);cT(e,t,r,a,n)}function $p(e,t){nP(e.x,t.x,t.scaleX,t.scale,t.originX),nP(e.y,t.y,t.scaleY,t.scale,t.originY)}function Yz(e,t){return Vz(wse(e.getBoundingClientRect(),t))}function Sse(e,t,r){const n=Yz(e,r),{scroll:s}=t;return s&&(Bp(n.x,s.offset.x),Bp(n.y,s.offset.y)),n}const sP=()=>({translate:0,scale:1,origin:0,originPoint:0}),Up=()=>({x:sP(),y:sP()}),aP=()=>({min:0,max:0}),Oa=()=>({x:aP(),y:aP()}),uT={current:null},Xz={current:!1};function kse(){if(Xz.current=!0,!!C7)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>uT.current=e.matches;e.addEventListener("change",t),t()}else uT.current=!1}const Cse=new WeakMap;function Tse(e,t,r){for(const n in t){const s=t[n],a=r[n];if(Co(s))e.addValue(n,s);else if(Co(a))e.addValue(n,l1(s,{owner:e}));else if(a!==s)if(e.hasValue(n)){const i=e.getValue(n);i.liveStyle===!0?i.jump(s):i.hasAnimated||i.set(s)}else{const i=e.getStaticValue(n);e.addValue(n,l1(i!==void 0?i:s,{owner:e}))}}for(const n in r)t[n]===void 0&&e.removeValue(n);return t}const iP=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Nse{scrapeMotionValuesFromProps(t,r,n){return{}}constructor({parent:t,props:r,presenceContext:n,reducedMotionConfig:s,blockInitialAnimation:a,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=z7,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=yl.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,Js.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=i;this.latestValues=c,this.baseTarget={...c},this.initialValues=r.initial?{...c}:{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=n,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!a,this.isControllingVariants=SS(r),this.isVariantNode=Oz(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:d,...f}=this.scrapeMotionValuesFromProps(r,{},this);for(const h in f){const g=f[h];c[h]!==void 0&&Co(g)&&g.set(c[h])}}mount(t){this.current=t,Cse.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,n)=>this.bindToMotionValue(n,r)),Xz.current||kse(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:uT.current,this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),th(this.notifyUpdate),th(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(t){this.children.add(t),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(t)}removeChild(t){this.children.delete(t),this.enteringChildren&&this.enteringChildren.delete(t)}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const n=M1.has(t);n&&this.onBindTransform&&this.onBindTransform();const s=r.on("change",i=>{this.latestValues[t]=i,this.props.onUpdate&&Js.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{s(),a&&a(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in c1){const r=c1[t];if(!r)continue;const{isEnabled:n,Feature:s}=r;if(!this.features[t]&&s&&n(this.props)&&(this.features[t]=new s(this)),this.features[t]){const a=this.features[t];a.isMounted?a.update():(a.mount(),a.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Oa()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let n=0;n<iP.length;n++){const s=iP[n];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const a="on"+s,i=t[a];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Tse(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const n=this.values.get(t);r!==n&&(n&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let n=this.values.get(t);return n===void 0&&r!==void 0&&(n=l1(r===null?void 0:r,{owner:this}),this.addValue(t,n)),n}readValue(t,r){let n=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return n!=null&&(typeof n=="string"&&(zU(n)||HU(n))?n=parseFloat(n):!Ine(n)&&rh.test(r)&&(n=Cz(t,r)),this.setBaseTarget(t,Co(n)?n.get():n)),Co(n)?n.get():n}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){const{initial:r}=this.props;let n;if(typeof r=="string"||typeof r=="object"){const a=Z7(this.props,r,this.presenceContext?.custom);a&&(n=a[t])}if(r&&n!==void 0)return n;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!Co(s)?s:this.initialValues[t]!==void 0&&n===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new j7),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}scheduleRenderMicrotask(){G7.render(this.render)}}class Jz extends Nse{constructor(){super(...arguments),this.KeyframeResolver=Cne}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:n}){delete r[t],delete n[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Co(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function Qz(e,{style:t,vars:r},n,s){const a=e.style;let i;for(i in t)a[i]=t[i];s?.applyProjectionStyles(a,n);for(i in r)a.setProperty(i,r[i])}function Ese(e){return window.getComputedStyle(e)}class Ase extends Jz{constructor(){super(...arguments),this.type="html",this.renderInstance=Qz}readValueFromInstance(t,r){if(M1.has(r))return this.projection?.isProjecting?tT(r):Hre(t,r);{const n=Ese(t),s=(M7(r)?n.getPropertyValue(r):n[r])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:r}){return Yz(t,r)}build(t,r,n){X7(t,r,n.transformTemplate)}scrapeMotionValuesFromProps(t,r,n){return eN(t,r,n)}}const Zz=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function jse(e,t,r,n){Qz(e,t,void 0,n);for(const s in t.attrs)e.setAttribute(Zz.has(s)?s:tN(s),t.attrs[s])}class Pse extends Jz{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Oa}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(M1.has(r)){const n=kz(r);return n&&n.default||0}return r=Zz.has(r)?r:tN(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,n){return zz(t,r,n)}build(t,r,n){Lz(t,r,this.isSVGTag,n.transformTemplate,n.style)}renderInstance(t,r,n,s){jse(t,r,n,s)}mount(t){this.isSVGTag=$z(t.tagName),super.mount(t)}}const Fse=(e,t)=>Q7(e)?new Pse(t):new Ase(t,{allowProjection:e!==w.Fragment});function qp(e,t,r){const n=e.getProps();return Z7(n,t,r!==void 0?r:n.custom,e)}const dT=e=>Array.isArray(e);function Mse(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,l1(r))}function Rse(e){return dT(e)?e[e.length-1]||0:e}function Ose(e,t){const r=qp(e,t);let{transitionEnd:n={},transition:s={},...a}=r||{};a={...a,...n};for(const i in a){const o=Rse(a[i]);Mse(e,i,o)}}function Dse(e){return!!(Co(e)&&e.add)}function fT(e,t){const r=e.getValue("willChange");if(Dse(r))return r.add(t);if(!r&&_0.WillChange){const n=new _0.WillChange("auto");e.addValue("willChange",n),n.add(t)}}function eW(e){return e.props[Wz]}const Ise=e=>e!==null;function Lse(e,{repeat:t,repeatType:r="loop"},n){const s=e.filter(Ise),a=t&&r!=="loop"&&t%2===1?0:s.length-1;return s[a]}const Bse={type:"spring",stiffness:500,damping:25,restSpeed:10},$se=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),Use={type:"keyframes",duration:.8},zse={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Wse=(e,{keyframes:t})=>t.length>2?Use:M1.has(e)?e.startsWith("scale")?$se(t[1]):Bse:zse;function Hse({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:s,repeat:a,repeatType:i,repeatDelay:o,from:c,elapsed:u,...d}){return!!Object.keys(d).length}const rN=(e,t,r,n={},s,a)=>i=>{const o=W7(n,e)||{},c=o.delay||n.delay||0;let{elapsed:u=0}=n;u=u-ld(c);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:a?void 0:s};Hse(o)||Object.assign(d,Wse(e,d)),d.duration&&(d.duration=ld(d.duration)),d.repeatDelay&&(d.repeatDelay=ld(d.repeatDelay)),d.from!==void 0&&(d.keyframes[0]=d.from);let f=!1;if((d.type===!1||d.duration===0&&!d.repeatDelay)&&(iT(d),d.delay===0&&(f=!0)),(_0.instantAnimations||_0.skipAnimations)&&(f=!0,iT(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,f&&!a&&t.get()!==void 0){const h=Lse(d.keyframes,o);if(h!==void 0){Js.update(()=>{d.onUpdate(h),d.onComplete()});return}}return o.isSync?new U7(d):new hne(d)};function Gse({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,n}function tW(e,t,{delay:r=0,transitionOverride:n,type:s}={}){let{transition:a=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(a=n);const c=[],u=s&&e.animationState&&e.animationState.getState()[s];for(const d in o){const f=e.getValue(d,e.latestValues[d]??null),h=o[d];if(h===void 0||u&&Gse(u,d))continue;const g={delay:r,...W7(a||{},d)},p=f.get();if(p!==void 0&&!f.isAnimating&&!Array.isArray(h)&&h===p&&!g.velocity)continue;let x=!1;if(window.MotionHandoffAnimation){const C=eW(e);if(C){const b=window.MotionHandoffAnimation(C,d,Js);b!==null&&(g.startTime=b,x=!0)}}fT(e,d),f.start(rN(d,f,h,e.shouldReduceMotion&&wz.has(d)?{type:!1}:g,e,x));const v=f.animation;v&&c.push(v)}return i&&Promise.all(c).then(()=>{Js.update(()=>{i&&Ose(e,i)})}),c}function rW(e,t,r,n=0,s=1){const a=Array.from(e).sort((u,d)=>u.sortNodePosition(d)).indexOf(t),i=e.size,o=(i-1)*n;return typeof r=="function"?r(a,i):s===1?a*n:o-a*n}function hT(e,t,r={}){const n=qp(e,t,r.type==="exit"?e.presenceContext?.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=n||{};r.transitionOverride&&(s=r.transitionOverride);const a=n?()=>Promise.all(tW(e,n,r)):()=>Promise.resolve(),i=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:f}=s;return Vse(e,t,c,u,d,f,r)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[a,i]:[i,a];return c().then(()=>u())}else return Promise.all([a(),i(r.delay)])}function Vse(e,t,r=0,n=0,s=0,a=1,i){const o=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),o.push(hT(c,t,{...i,delay:r+(typeof n=="function"?0:n)+rW(e.variantChildren,c,n,s,a)}).then(()=>c.notify("AnimationComplete",t)));return Promise.all(o)}function qse(e,t,r={}){e.notify("AnimationStart",t);let n;if(Array.isArray(t)){const s=t.map(a=>hT(e,a,r));n=Promise.all(s)}else if(typeof t=="string")n=hT(e,t,r);else{const s=typeof t=="function"?qp(e,t,r.custom):t;n=Promise.all(tW(e,s,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}function nW(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const Kse=Y7.length;function sW(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?sW(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<Kse;r++){const n=Y7[r],s=e.props[n];(zv(s)||s===!1)&&(t[n]=s)}return t}const Yse=[...K7].reverse(),Xse=K7.length;function Jse(e){return t=>Promise.all(t.map(({animation:r,options:n})=>qse(e,r,n)))}function Qse(e){let t=Jse(e),r=oP(),n=!0;const s=c=>(u,d)=>{const f=qp(e,d,c==="exit"?e.presenceContext?.custom:void 0);if(f){const{transition:h,transitionEnd:g,...p}=f;u={...u,...p,...g}}return u};function a(c){t=c(e)}function i(c){const{props:u}=e,d=sW(e.parent)||{},f=[],h=new Set;let g={},p=1/0;for(let v=0;v<Xse;v++){const C=Yse[v],b=r[C],_=u[C]!==void 0?u[C]:d[C],T=zv(_),N=C===c?b.isActive:null;N===!1&&(p=v);let E=_===d[C]&&_!==u[C]&&T;if(E&&n&&e.manuallyAnimateOnMount&&(E=!1),b.protectedKeys={...g},!b.isActive&&N===null||!_&&!b.prevProp||_S(_)||typeof _=="boolean")continue;const F=Zse(b.prevProp,_);let j=F||C===c&&b.isActive&&!E&&T||v>p&&T,P=!1;const M=Array.isArray(_)?_:[_];let I=M.reduce(s(C),{});N===!1&&(I={});const{prevResolvedValues:U={}}=b,K={...U,...I},te=B=>{j=!0,h.has(B)&&(P=!0,h.delete(B)),b.needsAnimating[B]=!0;const J=e.getValue(B);J&&(J.liveStyle=!1)};for(const B in K){const J=I[B],z=U[B];if(g.hasOwnProperty(B))continue;let q=!1;dT(J)&&dT(z)?q=!nW(J,z):q=J!==z,q?J!=null?te(B):h.add(B):J!==void 0&&h.has(B)?te(B):b.protectedKeys[B]=!0}b.prevProp=_,b.prevResolvedValues=I,b.isActive&&(g={...g,...I}),n&&e.blockInitialAnimation&&(j=!1);const re=E&&F;j&&(!re||P)&&f.push(...M.map(B=>{const J={type:C};if(typeof B=="string"&&n&&!re&&e.manuallyAnimateOnMount&&e.parent){const{parent:z}=e,q=qp(z,B);if(z.enteringChildren&&q){const{delayChildren:H}=q.transition||{};J.delay=rW(z.enteringChildren,e,H)}}return{animation:B,options:J}}))}if(h.size){const v={};if(typeof u.initial!="boolean"){const C=qp(e,Array.isArray(u.initial)?u.initial[0]:u.initial);C&&C.transition&&(v.transition=C.transition)}h.forEach(C=>{const b=e.getBaseTarget(C),_=e.getValue(C);_&&(_.liveStyle=!0),v[C]=b??null}),f.push({animation:v})}let x=!!f.length;return n&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(x=!1),n=!1,x?t(f):Promise.resolve()}function o(c,u){if(r[c].isActive===u)return Promise.resolve();e.variantChildren?.forEach(f=>f.animationState?.setActive(c,u)),r[c].isActive=u;const d=i(c);for(const f in r)r[f].protectedKeys={};return d}return{animateChanges:i,setActive:o,setAnimateFunction:a,getState:()=>r,reset:()=>{r=oP(),n=!0}}}function Zse(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!nW(t,e):!1}function am(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function oP(){return{animate:am(!0),whileInView:am(),whileHover:am(),whileTap:am(),whileDrag:am(),whileFocus:am(),exit:am()}}class ph{constructor(t){this.isMounted=!1,this.node=t}update(){}}class eae extends ph{constructor(t){super(t),t.animationState||(t.animationState=Qse(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();_S(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let tae=0;class rae extends ph{constructor(){super(...arguments),this.id=tae++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===n)return;const s=this.node.animationState.setActive("exit",!t);r&&!t&&s.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const nae={animation:{Feature:eae},exit:{Feature:rae}};function Hv(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function F2(e){return{point:{x:e.pageX,y:e.pageY}}}const sae=e=>t=>V7(t)&&e(t,F2(t));function xv(e,t,r,n){return Hv(e,t,sae(r),n)}const aW=1e-4,aae=1-aW,iae=1+aW,iW=.01,oae=0-iW,lae=0+iW;function Yo(e){return e.max-e.min}function cae(e,t,r){return Math.abs(e-t)<=r}function lP(e,t,r,n=.5){e.origin=n,e.originPoint=ia(t.min,t.max,e.origin),e.scale=Yo(r)/Yo(t),e.translate=ia(r.min,r.max,e.origin)-e.originPoint,(e.scale>=aae&&e.scale<=iae||isNaN(e.scale))&&(e.scale=1),(e.translate>=oae&&e.translate<=lae||isNaN(e.translate))&&(e.translate=0)}function yv(e,t,r,n){lP(e.x,t.x,r.x,n?n.originX:void 0),lP(e.y,t.y,r.y,n?n.originY:void 0)}function cP(e,t,r){e.min=r.min+t.min,e.max=e.min+Yo(t)}function uae(e,t,r){cP(e.x,t.x,r.x),cP(e.y,t.y,r.y)}function uP(e,t,r){e.min=t.min-r.min,e.max=e.min+Yo(t)}function vv(e,t,r){uP(e.x,t.x,r.x),uP(e.y,t.y,r.y)}function Sc(e){return[e("x"),e("y")]}const oW=({current:e})=>e?e.ownerDocument.defaultView:null,dP=(e,t)=>Math.abs(e-t);function dae(e,t){const r=dP(e.x,t.x),n=dP(e.y,t.y);return Math.sqrt(r**2+n**2)}class lW{constructor(t,r,{transformPagePoint:n,contextWindow:s=window,dragSnapToOrigin:a=!1,distanceThreshold:i=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=F5(this.lastMoveEventInfo,this.history),g=this.startEvent!==null,p=dae(h.offset,{x:0,y:0})>=this.distanceThreshold;if(!g&&!p)return;const{point:x}=h,{timestamp:v}=Ji;this.history.push({...x,timestamp:v});const{onStart:C,onMove:b}=this.handlers;g||(C&&C(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,h)},this.handlePointerMove=(h,g)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=P5(g,this.transformPagePoint),Js.update(this.updatePoint,!0)},this.handlePointerUp=(h,g)=>{this.end();const{onEnd:p,onSessionEnd:x,resumeAnimation:v}=this.handlers;if(this.dragSnapToOrigin&&v&&v(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const C=F5(h.type==="pointercancel"?this.lastMoveEventInfo:P5(g,this.transformPagePoint),this.history);this.startEvent&&p&&p(h,C),x&&x(h,C)},!V7(t))return;this.dragSnapToOrigin=a,this.handlers=r,this.transformPagePoint=n,this.distanceThreshold=i,this.contextWindow=s||window;const o=F2(t),c=P5(o,this.transformPagePoint),{point:u}=c,{timestamp:d}=Ji;this.history=[{...u,timestamp:d}];const{onSessionStart:f}=r;f&&f(t,F5(c,this.history)),this.removeListeners=A2(xv(this.contextWindow,"pointermove",this.handlePointerMove),xv(this.contextWindow,"pointerup",this.handlePointerUp),xv(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),th(this.updatePoint)}}function P5(e,t){return t?{point:t(e.point)}:e}function fP(e,t){return{x:e.x-t.x,y:e.y-t.y}}function F5({point:e},t){return{point:e,delta:fP(e,cW(t)),offset:fP(e,fae(t)),velocity:hae(t,.1)}}function fae(e){return e[0]}function cW(e){return e[e.length-1]}function hae(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const s=cW(e);for(;r>=0&&(n=e[r],!(s.timestamp-n.timestamp>ld(t)));)r--;if(!n)return{x:0,y:0};const a=cd(s.timestamp-n.timestamp);if(a===0)return{x:0,y:0};const i={x:(s.x-n.x)/a,y:(s.y-n.y)/a};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function mae(e,{min:t,max:r},n){return t!==void 0&&e<t?e=n?ia(t,e,n.min):Math.max(e,t):r!==void 0&&e>r&&(e=n?ia(r,e,n.max):Math.min(e,r)),e}function hP(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function gae(e,{top:t,left:r,bottom:n,right:s}){return{x:hP(e.x,r,s),y:hP(e.y,t,n)}}function mP(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}function pae(e,t){return{x:mP(e.x,t.x),y:mP(e.y,t.y)}}function xae(e,t){let r=.5;const n=Yo(e),s=Yo(t);return s>n?r=Bv(t.min,t.max-n,e.min):n>s&&(r=Bv(e.min,e.max-s,t.min)),w0(0,1,r)}function yae(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const mT=.35;function vae(e=mT){return e===!1?e=0:e===!0&&(e=mT),{x:gP(e,"left","right"),y:gP(e,"top","bottom")}}function gP(e,t,r){return{min:pP(e,t),max:pP(e,r)}}function pP(e,t){return typeof e=="number"?e:e[t]||0}const bae=new WeakMap;class wae{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Oa(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=t}start(t,{snapToCursor:r=!1,distanceThreshold:n}={}){const{presenceContext:s}=this.visualElement;if(s&&s.isPresent===!1)return;const a=f=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(F2(f).point)},i=(f,h)=>{const{drag:g,dragPropagation:p,onDragStart:x}=this.getProps();if(g&&!p&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Ane(g),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=h,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Sc(C=>{let b=this.getAxisMotionValue(C).get()||0;if(ud.test(b)){const{projection:_}=this.visualElement;if(_&&_.layout){const T=_.layout.layoutBox[C];T&&(b=Yo(T)*(parseFloat(b)/100))}}this.originPoint[C]=b}),x&&Js.postRender(()=>x(f,h)),fT(this.visualElement,"transform");const{animationState:v}=this.visualElement;v&&v.setActive("whileDrag",!0)},o=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h;const{dragPropagation:g,dragDirectionLock:p,onDirectionLock:x,onDrag:v}=this.getProps();if(!g&&!this.openDragLock)return;const{offset:C}=h;if(p&&this.currentDirection===null){this.currentDirection=_ae(C),this.currentDirection!==null&&x&&x(this.currentDirection);return}this.updateAxis("x",h.point,C),this.updateAxis("y",h.point,C),this.visualElement.render(),v&&v(f,h)},c=(f,h)=>{this.latestPointerEvent=f,this.latestPanInfo=h,this.stop(f,h),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Sc(f=>this.getAnimationState(f)==="paused"&&this.getAxisMotionValue(f).animation?.play()),{dragSnapToOrigin:d}=this.getProps();this.panSession=new lW(t,{onSessionStart:a,onStart:i,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,distanceThreshold:n,contextWindow:oW(this.visualElement)})}stop(t,r){const n=t||this.latestPointerEvent,s=r||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!s||!n)return;const{velocity:i}=s;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&Js.postRender(()=>o(n,s))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,n){const{drag:s}=this.getProps();if(!n||!kw(t,s,this.currentDirection))return;const a=this.getAxisMotionValue(t);let i=this.originPoint[t]+n[t];this.constraints&&this.constraints[t]&&(i=mae(i,this.constraints[t],this.elastic[t])),a.set(i)}resolveConstraints(){const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,s=this.constraints;t&&Lp(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&n?this.constraints=gae(n.layoutBox,t):this.constraints=!1,this.elastic=vae(r),s!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&Sc(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=yae(n.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!Lp(t))return!1;const n=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const a=Sse(n,s.root,this.visualElement.getTransformPagePoint());let i=pae(s.layout.layoutBox,a);if(r){const o=r(bse(i));this.hasMutatedConstraints=!!o,o&&(i=Vz(o))}return i}startAnimation(t){const{drag:r,dragMomentum:n,dragElastic:s,dragTransition:a,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),c=this.constraints||{},u=Sc(d=>{if(!kw(d,r,this.currentDirection))return;let f=c&&c[d]||{};i&&(f={min:0,max:0});const h=s?200:1e6,g=s?40:1e7,p={type:"inertia",velocity:n?t[d]:0,bounceStiffness:h,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...a,...f};return this.startAxisValueAnimation(d,p)});return Promise.all(u).then(o)}startAxisValueAnimation(t,r){const n=this.getAxisMotionValue(t);return fT(this.visualElement,t),n.start(rN(t,n,0,r,this.visualElement,!1))}stopAnimation(){Sc(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Sc(t=>this.getAxisMotionValue(t).animation?.pause())}getAnimationState(t){return this.getAxisMotionValue(t).animation?.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,n=this.visualElement.getProps(),s=n[r];return s||this.visualElement.getValue(t,(n.initial?n.initial[t]:void 0)||0)}snapToCursor(t){Sc(r=>{const{drag:n}=this.getProps();if(!kw(r,n,this.currentDirection))return;const{projection:s}=this.visualElement,a=this.getAxisMotionValue(r);if(s&&s.layout){const{min:i,max:o}=s.layout.layoutBox[r];a.set(t[r]-ia(i,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:n}=this.visualElement;if(!Lp(r)||!n||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Sc(i=>{const o=this.getAxisMotionValue(i);if(o&&this.constraints!==!1){const c=o.get();s[i]=xae({min:c,max:c},this.constraints[i])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),Sc(i=>{if(!kw(i,t,null))return;const o=this.getAxisMotionValue(i),{min:c,max:u}=this.constraints[i];o.set(ia(c,u,s[i]))})}addListeners(){if(!this.visualElement.current)return;bae.set(this.visualElement,this);const t=this.visualElement.current,r=xv(t,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),n=()=>{const{dragConstraints:c}=this.getProps();Lp(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,a=s.addEventListener("measure",n);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),Js.read(n);const i=Hv(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",(({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Sc(d=>{const f=this.getAxisMotionValue(d);f&&(this.originPoint[d]+=c[d].translate,f.set(f.get()+c[d].translate))}),this.visualElement.render())}));return()=>{i(),r(),a(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:n=!1,dragPropagation:s=!1,dragConstraints:a=!1,dragElastic:i=mT,dragMomentum:o=!0}=t;return{...t,drag:r,dragDirectionLock:n,dragPropagation:s,dragConstraints:a,dragElastic:i,dragMomentum:o}}}function kw(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function _ae(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class Sae extends ph{constructor(t){super(t),this.removeGroupControls=Mc,this.removeListeners=Mc,this.controls=new wae(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Mc}unmount(){this.removeGroupControls(),this.removeListeners()}}const xP=e=>(t,r)=>{e&&Js.postRender(()=>e(t,r))};class kae extends ph{constructor(){super(...arguments),this.removePointerDownListener=Mc}onPointerDown(t){this.session=new lW(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:oW(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:n,onPanEnd:s}=this.node.getProps();return{onSessionStart:xP(t),onStart:xP(r),onMove:n,onEnd:(a,i)=>{delete this.session,s&&Js.postRender(()=>s(a,i))}}}mount(){this.removePointerDownListener=xv(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const N4={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function yP(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ty={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(dn.test(e))e=parseFloat(e);else return e;const r=yP(e,t.target.x),n=yP(e,t.target.y);return`${r}% ${n}%`}},Cae={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,s=rh.parse(e);if(s.length>5)return n;const a=rh.createTransformer(e),i=typeof s[0]!="number"?1:0,o=r.x.scale*t.x,c=r.y.scale*t.y;s[0+i]/=o,s[1+i]/=c;const u=ia(o,c,.5);return typeof s[2+i]=="number"&&(s[2+i]/=u),typeof s[3+i]=="number"&&(s[3+i]/=u),a(s)}};let M5=!1;class Tae extends w.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n,layoutId:s}=this.props,{projection:a}=t;Kne(Nae),a&&(r.group&&r.group.add(a),n&&n.register&&s&&n.register(a),M5&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),N4.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:n,drag:s,isPresent:a}=this.props,{projection:i}=n;return i&&(i.isPresent=a,M5=!0,s||t.layoutDependency!==r||r===void 0||t.isPresent!==a?i.willUpdate():this.safeToRemove(),t.isPresent!==a&&(a?i.promote():i.relegate()||Js.postRender(()=>{const o=i.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),G7.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:n}=this.props,{projection:s}=t;M5=!0,s&&(s.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(s),n&&n.deregister&&n.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function uW(e){const[t,r]=Fz(),n=w.useContext(S7);return l.jsx(Tae,{...e,layoutGroup:n,switchLayoutGroup:w.useContext(Hz),isPresent:t,safeToRemove:r})}const Nae={borderRadius:{...ty,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ty,borderTopRightRadius:ty,borderBottomLeftRadius:ty,borderBottomRightRadius:ty,boxShadow:Cae};function Eae(e,t,r){const n=Co(e)?e:l1(e);return n.start(rN("",n,t,r)),n.animation}const Aae=(e,t)=>e.depth-t.depth;class jae{constructor(){this.children=[],this.isDirty=!1}add(t){T7(this.children,t),this.isDirty=!0}remove(t){N7(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(Aae),this.isDirty=!1,this.children.forEach(t)}}function Pae(e,t){const r=yl.now(),n=({timestamp:s})=>{const a=s-r;a>=t&&(th(n),e(a-t))};return Js.setup(n,!0),()=>th(n)}const dW=["TopLeft","TopRight","BottomLeft","BottomRight"],Fae=dW.length,vP=e=>typeof e=="string"?parseFloat(e):e,bP=e=>typeof e=="number"||dn.test(e);function Mae(e,t,r,n,s,a){s?(e.opacity=ia(0,r.opacity??1,Rae(n)),e.opacityExit=ia(t.opacity??1,0,Oae(n))):a&&(e.opacity=ia(t.opacity??1,r.opacity??1,n));for(let i=0;i<Fae;i++){const o=`border${dW[i]}Radius`;let c=wP(t,o),u=wP(r,o);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||bP(c)===bP(u)?(e[o]=Math.max(ia(vP(c),vP(u),n),0),(ud.test(u)||ud.test(c))&&(e[o]+="%")):e[o]=u}(t.rotate||r.rotate)&&(e.rotate=ia(t.rotate||0,r.rotate||0,n))}function wP(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const Rae=fW(0,.5,QU),Oae=fW(.5,.95,Mc);function fW(e,t,r){return n=>n<e?0:n>t?1:r(Bv(e,t,n))}function _P(e,t){e.min=t.min,e.max=t.max}function pc(e,t){_P(e.x,t.x),_P(e.y,t.y)}function SP(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function kP(e,t,r,n,s){return e-=t,e=X4(e,1/r,n),s!==void 0&&(e=X4(e,1/s,n)),e}function Dae(e,t=0,r=1,n=.5,s,a=e,i=e){if(ud.test(t)&&(t=parseFloat(t),t=ia(i.min,i.max,t/100)-i.min),typeof t!="number")return;let o=ia(a.min,a.max,n);e===a&&(o-=t),e.min=kP(e.min,t,r,o,s),e.max=kP(e.max,t,r,o,s)}function CP(e,t,[r,n,s],a,i){Dae(e,t[r],t[n],t[s],t.scale,a,i)}const Iae=["x","scaleX","originX"],Lae=["y","scaleY","originY"];function TP(e,t,r,n){CP(e.x,t,Iae,r?r.x:void 0,n?n.x:void 0),CP(e.y,t,Lae,r?r.y:void 0,n?n.y:void 0)}function NP(e){return e.translate===0&&e.scale===1}function hW(e){return NP(e.x)&&NP(e.y)}function EP(e,t){return e.min===t.min&&e.max===t.max}function Bae(e,t){return EP(e.x,t.x)&&EP(e.y,t.y)}function AP(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function mW(e,t){return AP(e.x,t.x)&&AP(e.y,t.y)}function jP(e){return Yo(e.x)/Yo(e.y)}function PP(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class $ae{constructor(){this.members=[]}add(t){T7(this.members,t),t.scheduleRender()}remove(t){if(N7(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(s=>t===s);if(r===0)return!1;let n;for(let s=r;s>=0;s--){const a=this.members[s];if(a.isPresent!==!1){n=a;break}}return n?(this.promote(n),!0):!1}promote(t,r){const n=this.lead;if(t!==n&&(this.prevLead=n,this.lead=t,t.show(),n)){n.instance&&n.scheduleRender(),t.scheduleRender(),t.resumeFrom=n,r&&(t.resumeFrom.preserveOpacity=!0),n.snapshot&&(t.snapshot=n.snapshot,t.snapshot.latestValues=n.animationValues||n.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:n}=t;r.onExitComplete&&r.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function Uae(e,t,r){let n="";const s=e.x.translate/t.x,a=e.y.translate/t.y,i=r?.z||0;if((s||a||i)&&(n=`translate3d(${s}px, ${a}px, ${i}px) `),(t.x!==1||t.y!==1)&&(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:u,rotate:d,rotateX:f,rotateY:h,skewX:g,skewY:p}=r;u&&(n=`perspective(${u}px) ${n}`),d&&(n+=`rotate(${d}deg) `),f&&(n+=`rotateX(${f}deg) `),h&&(n+=`rotateY(${h}deg) `),g&&(n+=`skewX(${g}deg) `),p&&(n+=`skewY(${p}deg) `)}const o=e.x.scale*t.x,c=e.y.scale*t.y;return(o!==1||c!==1)&&(n+=`scale(${o}, ${c})`),n||"none"}const R5=["","X","Y","Z"],zae=1e3;let Wae=0;function O5(e,t,r,n){const{latestValues:s}=t;s[e]&&(r[e]=s[e],t.setStaticValue(e,0),n&&(n[e]=0))}function gW(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=eW(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:s,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Js,!(s||a))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&gW(n)}function pW({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:s}){return class{constructor(i={},o=t?.()){this.id=Wae++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(Vae),this.nodes.forEach(Xae),this.nodes.forEach(Jae),this.nodes.forEach(qae)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=i,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new jae)}addEventListener(i,o){return this.eventHandlers.has(i)||this.eventHandlers.set(i,new j7),this.eventHandlers.get(i).add(o)}notifyListeners(i,...o){const c=this.eventHandlers.get(i);c&&c.notify(...o)}hasListeners(i){return this.eventHandlers.has(i)}mount(i){if(this.instance)return;this.isSVG=Pz(i)&&!One(i),this.instance=i;const{layoutId:o,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(i),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||o)&&(this.isLayoutDirty=!0),e){let d,f=0;const h=()=>this.root.updateBlockedByResize=!1;Js.read(()=>{f=window.innerWidth}),e(i,()=>{const g=window.innerWidth;g!==f&&(f=g,this.root.updateBlockedByResize=!0,d&&d(),d=Pae(h,250),N4.hasAnimatedSinceResize&&(N4.hasAnimatedSinceResize=!1,this.nodes.forEach(RP)))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&u&&(o||c)&&this.addEventListener("didUpdate",({delta:d,hasLayoutChanged:f,hasRelativeLayoutChanged:h,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const p=this.options.transition||u.getDefaultTransition()||rie,{onLayoutAnimationStart:x,onLayoutAnimationComplete:v}=u.getProps(),C=!this.targetLayout||!mW(this.targetLayout,g),b=!f&&h;if(this.options.layoutRoot||this.resumeFrom||b||f&&(C||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const _={...W7(p,"layout"),onPlay:x,onComplete:v};(u.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_),this.setAnimationOrigin(d,b)}else f||RP(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const i=this.getStack();i&&i.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),th(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Qae),this.animationId++)}getTransformTemplate(){const{visualElement:i}=this.options;return i&&i.getProps().transformTemplate}willUpdate(i=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&gW(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const f=this.path[d];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:o,layout:c}=this.options;if(o===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),i&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(FP);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(MP);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Yae),this.nodes.forEach(Hae),this.nodes.forEach(Gae)):this.nodes.forEach(MP),this.clearAllSnapshots();const o=yl.now();Ji.delta=w0(0,1e3/60,o-Ji.timestamp),Ji.timestamp=o,Ji.isProcessing=!0,S5.update.process(Ji),S5.preRender.process(Ji),S5.render.process(Ji),Ji.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,G7.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Kae),this.sharedNodes.forEach(Zae)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Js.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Js.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Yo(this.snapshot.measuredBox.x)&&!Yo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const i=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Oa(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,i?i.layoutBox:void 0)}updateScroll(i="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===i&&(o=!1),o&&this.instance){const c=n(this.instance);this.scroll={animationId:this.root.animationId,phase:i,isRoot:c,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!s)return;const i=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!hW(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;i&&this.instance&&(o||fm(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(i=!0){const o=this.measurePageBox();let c=this.removeElementScroll(o);return i&&(c=this.removeTransform(c)),nie(c),{animationId:this.root.animationId,measuredBox:o,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:i}=this.options;if(!i)return Oa();const o=i.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(sie))){const{scroll:u}=this.root;u&&(Bp(o.x,u.offset.x),Bp(o.y,u.offset.y))}return o}removeElementScroll(i){const o=Oa();if(pc(o,i),this.scroll?.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:f}=u;u!==this.root&&d&&f.layoutScroll&&(d.wasRoot&&pc(o,i),Bp(o.x,d.offset.x),Bp(o.y,d.offset.y))}return o}applyTransform(i,o=!1){const c=Oa();pc(c,i);for(let u=0;u<this.path.length;u++){const d=this.path[u];!o&&d.options.layoutScroll&&d.scroll&&d!==d.root&&$p(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),fm(d.latestValues)&&$p(c,d.latestValues)}return fm(this.latestValues)&&$p(c,this.latestValues),c}removeTransform(i){const o=Oa();pc(o,i);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!fm(u.latestValues))continue;lT(u.latestValues)&&u.updateSnapshot();const d=Oa(),f=u.measurePageBox();pc(d,f),TP(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return fm(this.latestValues)&&TP(o,this.latestValues),o}setTargetDelta(i){this.targetDelta=i,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(i){this.options={...this.options,...i,crossfade:i.crossfade!==void 0?i.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ji.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(i=!1){const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==o;if(!(i||c&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:d,layoutId:f}=this.options;if(!(!this.layout||!(d||f))){if(this.resolvedRelativeTargetAt=Ji.timestamp,!this.targetDelta&&!this.relativeTarget){const h=this.getClosestProjectingParent();h&&h.layout&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Oa(),this.relativeTargetOrigin=Oa(),vv(this.relativeTargetOrigin,this.layout.layoutBox,h.layout.layoutBox),pc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Oa(),this.targetWithTransforms=Oa()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),uae(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):pc(this.target,this.layout.layoutBox),Kz(this.target,this.targetDelta)):pc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const h=this.getClosestProjectingParent();h&&!!h.resumingFrom==!!this.resumingFrom&&!h.options.layoutScroll&&h.target&&this.animationProgress!==1?(this.relativeParent=h,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Oa(),this.relativeTargetOrigin=Oa(),vv(this.relativeTargetOrigin,this.target,h.target),pc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||lT(this.parent.latestValues)||qz(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){const i=this.getLead(),o=!!this.resumingFrom||this!==i;let c=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(c=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===Ji.timestamp&&(c=!1),c)return;const{layout:u,layoutId:d}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||d))return;pc(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,h=this.treeScale.y;_se(this.layoutCorrected,this.treeScale,this.path,o),i.layout&&!i.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(i.target=i.layout.layoutBox,i.targetWithTransforms=Oa());const{target:g}=i;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(SP(this.prevProjectionDelta.x,this.projectionDelta.x),SP(this.prevProjectionDelta.y,this.projectionDelta.y)),yv(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==h||!PP(this.projectionDelta.x,this.prevProjectionDelta.x)||!PP(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(i=!0){if(this.options.visualElement?.scheduleRender(),i){const o=this.getStack();o&&o.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Up(),this.projectionDelta=Up(),this.projectionDeltaWithTransform=Up()}setAnimationOrigin(i,o=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},f=Up();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=Oa(),g=c?c.source:void 0,p=this.layout?this.layout.source:void 0,x=g!==p,v=this.getStack(),C=!v||v.members.length<=1,b=!!(x&&!C&&this.options.crossfade===!0&&!this.path.some(tie));this.animationProgress=0;let _;this.mixTargetDelta=T=>{const N=T/1e3;OP(f.x,i.x,N),OP(f.y,i.y,N),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(vv(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),eie(this.relativeTarget,this.relativeTargetOrigin,h,N),_&&Bae(this.relativeTarget,_)&&(this.isProjectionDirty=!1),_||(_=Oa()),pc(_,this.relativeTarget)),x&&(this.animationValues=d,Mae(d,u,this.latestValues,N,b,C)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=N},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(i){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(th(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Js.update(()=>{N4.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=l1(0)),this.currentAnimation=Eae(this.motionValue,[0,1e3],{...i,velocity:0,isSync:!0,onUpdate:o=>{this.mixTargetDelta(o),i.onUpdate&&i.onUpdate(o)},onStop:()=>{},onComplete:()=>{i.onComplete&&i.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const i=this.getStack();i&&i.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(zae),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const i=this.getLead();let{targetWithTransforms:o,target:c,layout:u,latestValues:d}=i;if(!(!o||!c||!u)){if(this!==i&&this.layout&&u&&xW(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Oa();const f=Yo(this.layout.layoutBox.x);c.x.min=i.target.x.min,c.x.max=c.x.min+f;const h=Yo(this.layout.layoutBox.y);c.y.min=i.target.y.min,c.y.max=c.y.min+h}pc(o,c),$p(o,d),yv(this.projectionDeltaWithTransform,this.layoutCorrected,o,d)}}registerSharedNode(i,o){this.sharedNodes.has(i)||this.sharedNodes.set(i,new $ae),this.sharedNodes.get(i).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const i=this.getStack();return i?i.lead===this:!0}getLead(){const{layoutId:i}=this.options;return i?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:i}=this.options;return i?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:i}=this.options;if(i)return this.root.sharedNodes.get(i)}promote({needsReset:i,transition:o,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),i&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const i=this.getStack();return i?i.relegate(this):!1}resetSkewAndRotation(){const{visualElement:i}=this.options;if(!i)return;let o=!1;const{latestValues:c}=i;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(o=!0),!o)return;const u={};c.z&&O5("z",i,u,this.animationValues);for(let d=0;d<R5.length;d++)O5(`rotate${R5[d]}`,i,u,this.animationValues),O5(`skew${R5[d]}`,i,u,this.animationValues);i.render();for(const d in u)i.setStaticValue(d,u[d]),this.animationValues&&(this.animationValues[d]=u[d]);i.scheduleRender()}applyProjectionStyles(i,o){if(!this.instance||this.isSVG)return;if(!this.isVisible){i.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,i.visibility="",i.opacity="",i.pointerEvents=T4(o?.pointerEvents)||"",i.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(i.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,i.pointerEvents=T4(o?.pointerEvents)||""),this.hasProjected&&!fm(this.latestValues)&&(i.transform=c?c({},""):"none",this.hasProjected=!1);return}i.visibility="";const d=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=Uae(this.projectionDeltaWithTransform,this.treeScale,d);c&&(f=c(d,f)),i.transform=f;const{x:h,y:g}=this.projectionDelta;i.transformOrigin=`${h.origin*100}% ${g.origin*100}% 0`,u.animationValues?i.opacity=u===this?d.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:d.opacityExit:i.opacity=u===this?d.opacity!==void 0?d.opacity:"":d.opacityExit!==void 0?d.opacityExit:0;for(const p in Wv){if(d[p]===void 0)continue;const{correct:x,applyTo:v,isCSSVariable:C}=Wv[p],b=f==="none"?d[p]:x(d[p],u);if(v){const _=v.length;for(let T=0;T<_;T++)i[v[T]]=b}else C?this.options.visualElement.renderState.vars[p]=b:i[p]=b}this.options.layoutId&&(i.pointerEvents=u===this?T4(o?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(i=>i.currentAnimation?.stop()),this.root.nodes.forEach(FP),this.root.sharedNodes.clear()}}}function Hae(e){e.updateLayout()}function Gae(e){const t=e.resumeFrom?.snapshot||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:n}=e.layout,{animationType:s}=e.options,a=t.source!==e.layout.source;s==="size"?Sc(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],h=Yo(f);f.min=r[d].min,f.max=f.min+h}):xW(s,t.layoutBox,r)&&Sc(d=>{const f=a?t.measuredBox[d]:t.layoutBox[d],h=Yo(r[d]);f.max=f.min+h,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+h)});const i=Up();yv(i,r,t.layoutBox);const o=Up();a?yv(o,e.applyTransform(n,!0),t.measuredBox):yv(o,r,t.layoutBox);const c=!hW(i);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:f,layout:h}=d;if(f&&h){const g=Oa();vv(g,t.layoutBox,f.layoutBox);const p=Oa();vv(p,r,h.layoutBox),mW(g,p)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=p,e.relativeTargetOrigin=g,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:o,layoutDelta:i,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function Vae(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function qae(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Kae(e){e.clearSnapshot()}function FP(e){e.clearMeasurements()}function MP(e){e.isLayoutDirty=!1}function Yae(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function RP(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Xae(e){e.resolveTargetDelta()}function Jae(e){e.calcProjection()}function Qae(e){e.resetSkewAndRotation()}function Zae(e){e.removeLeadSnapshot()}function OP(e,t,r){e.translate=ia(t.translate,0,r),e.scale=ia(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function DP(e,t,r,n){e.min=ia(t.min,r.min,n),e.max=ia(t.max,r.max,n)}function eie(e,t,r,n){DP(e.x,t.x,r.x,n),DP(e.y,t.y,r.y,n)}function tie(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const rie={duration:.45,ease:[.4,0,.1,1]},IP=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),LP=IP("applewebkit/")&&!IP("chrome/")?Math.round:Mc;function BP(e){e.min=LP(e.min),e.max=LP(e.max)}function nie(e){BP(e.x),BP(e.y)}function xW(e,t,r){return e==="position"||e==="preserve-aspect"&&!cae(jP(t),jP(r),.2)}function sie(e){return e!==e.root&&e.scroll?.wasRoot}const aie=pW({attachResizeListener:(e,t)=>Hv(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),D5={current:void 0},yW=pW({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!D5.current){const e=new aie({});e.mount(window),e.setOptions({layoutScroll:!0}),D5.current=e}return D5.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),iie={pan:{Feature:kae},drag:{Feature:Sae,ProjectionNode:yW,MeasureLayout:uW}};function $P(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover",r==="Start");const s="onHover"+r,a=n[s];a&&Js.postRender(()=>a(t,F2(t)))}class oie extends ph{mount(){const{current:t}=this.node;t&&(this.unmount=jne(t,(r,n)=>($P(this.node,n,"Start"),s=>$P(this.node,s,"End"))))}unmount(){}}class lie extends ph{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=A2(Hv(this.node.current,"focus",()=>this.onFocus()),Hv(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function UP(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap",r==="Start");const s="onTap"+(r==="End"?"":r),a=n[s];a&&Js.postRender(()=>a(t,F2(t)))}class cie extends ph{mount(){const{current:t}=this.node;t&&(this.unmount=Rne(t,(r,n)=>(UP(this.node,n,"Start"),(s,{success:a})=>UP(this.node,s,a?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const gT=new WeakMap,I5=new WeakMap,uie=e=>{const t=gT.get(e.target);t&&t(e)},die=e=>{e.forEach(uie)};function fie({root:e,...t}){const r=e||document;I5.has(r)||I5.set(r,{});const n=I5.get(r),s=JSON.stringify(t);return n[s]||(n[s]=new IntersectionObserver(die,{root:e,...t})),n[s]}function hie(e,t,r){const n=fie(t);return gT.set(e,r),n.observe(e),()=>{gT.delete(e),n.unobserve(e)}}const mie={some:0,all:1};class gie extends ph{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:n,amount:s="some",once:a}=t,i={root:r?r.current:void 0,rootMargin:n,threshold:typeof s=="number"?s:mie[s]},o=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,a&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:f}=this.node.getProps(),h=u?d:f;h&&h(c)};return hie(this.node.current,i,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(pie(t,r))&&this.startObserver()}unmount(){}}function pie({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const xie={inView:{Feature:gie},tap:{Feature:cie},focus:{Feature:lie},hover:{Feature:oie}},yie={layout:{ProjectionNode:yW,MeasureLayout:uW}},vie={...nae,...xie,...iie,...yie},Ze=vse(vie,Fse),at=({children:e,variant:t="primary",size:r="md",onClick:n,disabled:s=!1,className:a="",...i})=>{const o="font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer",c={primary:"bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500",success:"bg-green-600 hover:bg-green-700 text-white focus:ring-green-500",danger:"bg-red-600 hover:bg-red-700 text-white focus:ring-red-500",warning:"bg-yellow-600 hover:bg-yellow-700 text-white focus:ring-yellow-500",outline:"bg-transparent text-blue-600 border-2 border-blue-600 hover:bg-blue-600 hover:text-white focus:ring-blue-500",secondary:"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-500"},u={xs:"px-2 py-1 text-xs",sm:"px-2 py-1 text-xs sm:px-3 sm:py-1.5 sm:text-sm",md:"px-3 py-1.5 text-sm sm:px-4 sm:py-2 sm:text-base",lg:"px-4 py-2 text-base sm:px-6 sm:py-3 sm:text-lg",icon:"p-0 flex items-center justify-center"},d=s?"opacity-50 cursor-not-allowed":"";return l.jsx(Ze.button,{className:`${o} ${c[t]} ${u[r]} ${d} ${a}`,onClick:n,disabled:s,whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},transition:{type:"spring",stiffness:400,damping:17},...i,children:e})},Xr=({size:e="md",color:t="blue",className:r=""})=>{const n={sm:"w-4 h-4",small:"w-4 h-4",md:"w-6 h-6",medium:"w-6 h-6",lg:"w-8 h-8",large:"w-8 h-8",xl:"w-12 h-12"},s={blue:"border-blue-600",green:"border-green-600",red:"border-red-600",yellow:"border-yellow-600",gray:"border-gray-600"};return l.jsx(Ze.div,{className:`
        inline-block border-2 border-gray-300 border-t-current rounded-full animate-spin
        ${n[e]} ${s[t]} ${r}
      `,animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"}})},bu=({type:e="info",message:t="",duration:r=3e3,closable:n=!0,onClose:s,className:a="",...i})=>{const[o,c]=w.useState(!0),[u,d]=w.useState(!1),f=w.useRef(null),h=w.useRef(null);w.useEffect(()=>{if(r>0)return h.current=setTimeout(()=>{g()},r),()=>{h.current&&clearTimeout(h.current)}},[r]);const g=w.useCallback(()=>{u||(d(!0),h.current&&clearTimeout(h.current),setTimeout(()=>{c(!1),s&&s()},300))},[u,s]),p=w.useCallback(C=>{C.key==="Escape"&&g()},[g]);if(!o)return null;const x=["notification",`notification-${e}`,o?"notification-visible":"",u?"notification-exiting":"",a].filter(Boolean).join(" "),v=()=>{switch(e){case"success":return"";case"error":return"";case"warning":return"";case"info":default:return""}};return l.jsx("div",{ref:f,className:x,role:"alert","aria-live":"polite",onKeyDown:p,tabIndex:-1,...i,children:l.jsxs("div",{className:"notification-content",children:[l.jsx("div",{className:"notification-icon","aria-hidden":"true",children:v()}),l.jsx("div",{className:"notification-body",children:l.jsx("div",{className:"notification-message",children:t})}),n&&l.jsx("button",{className:"notification-close",onClick:g,type:"button","aria-label":"Close notification",children:""})]})})},Ls=()=>{const[e,t]=w.useState([]),r=w.useCallback((a,i="info",o={})=>{const c=Date.now()+Math.random(),u={id:c,message:a,type:i,...o};return t(d=>[...d,u]),o.duration!==0&&setTimeout(()=>{n(c)},o.duration||3e3),c},[]),n=w.useCallback(a=>{t(i=>i.filter(o=>o.id!==a))},[]),s=w.useCallback(()=>{t([])},[]);return{notifications:e,showNotification:r,removeNotification:n,clearAllNotifications:s}},tc=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState(null),[s,a]=w.useState(null),i=w.useRef(null);w.useRef(new Map);const o=w.useRef(0),c=3,u=1e3,d=w.useCallback(()=>{i.current&&(i.current.abort(),i.current=null)},[]);w.useEffect(()=>d,[d]);const f=w.useCallback(async(R,L={})=>{try{t(!0),n(null),i.current=new AbortController;const G=L.method||"POST",W={method:G,headers:{"Content-Type":"application/json",...L.headers},signal:i.current.signal,...L};G!=="GET"&&G!=="HEAD"&&(W.body=JSON.stringify(L.data||{})),console.log(`[API] Making request to: ${R}`,W);const Q=await fetch(R,W);if(!Q.ok)throw new Error(`HTTP error! status: ${Q.status}`);const X=await Q.json();if(console.log("[API] Response received:",X),X.success)return a(X),o.current=0,X;throw new Error(X.error||X.message||"Request failed")}catch(G){if(G.name==="AbortError")return console.log("[API] Request was aborted"),null;if(console.error("[API] Request failed:",G),n(G.message||"Request failed"),o.current<c){o.current++;const W=u*Math.pow(2,o.current-1);return console.log(`[API] Retrying in ${W}ms (attempt ${o.current}/${c})`),await new Promise(Q=>setTimeout(Q,W)),f(R,L)}throw G}finally{t(!1),i.current=null}},[]),h=w.useCallback(async(R,L={})=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");return await window.tokenManager.makeAuthenticatedRequest(R,L)}catch(G){throw console.error("[API] Authenticated request failed:",G),G}},[]),g=w.useCallback(async(R,L)=>{try{const G=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${L}`;console.log(`[API] Getting test info for ${R}_${L}`);const Q=await(await h(G)).json();if(Q.success)return console.log("[API] Test info retrieved successfully:",Q.test_info),Q.test_info;throw new Error(Q.error||"Failed to get test info")}catch(G){throw console.error("[API] Failed to get test info:",G),G}},[h]),p=w.useCallback(async(R,L)=>{try{const G=`/.netlify/functions/get-test-questions?test_type=${R}&test_id=${L}`;console.log(`[API] Getting test questions for ${R}_${L}`);const Q=await(await h(G)).json();if(Q.success)return console.log("[API] Test questions retrieved successfully:",Q.questions),Q.questions;throw new Error(Q.error||"Failed to get test questions")}catch(G){throw console.error("[API] Failed to get test questions:",G),G}},[h]),x=w.useCallback(async()=>{try{const R="/.netlify/functions/get-student-active-tests";console.log("[API] Loading student active tests");const G=await(await h(R)).json();if(G.success)return console.log("[API] Student active tests loaded successfully:",G.tests),G.tests;throw new Error(G.error||"Failed to load student active tests")}catch(R){throw console.error("[API] Failed to load student active tests:",R),R}},[h]),v=w.useCallback(async(R,L,G)=>{try{let W;switch(R){case"true_false":W="/.netlify/functions/submit-true-false-test";break;case"multiple_choice":W="/.netlify/functions/submit-multiple-choice-test";break;case"input":W="/.netlify/functions/submit-input-test";break;case"matching_type":W="/.netlify/functions/submit-matching-type-test";break;case"speaking":W="/.netlify/functions/submit-speaking-test";break;default:throw new Error(`Unknown test type: ${R}`)}console.log(`[API] Submitting ${R} test:`,G);const X=await(await h(W,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)})).json();if(X.success)return console.log("[API] Test submitted successfully:",X),X;throw new Error(X.error||"Failed to submit test")}catch(W){throw console.error("[API] Failed to submit test:",W),W}},[h]),C=w.useCallback(async R=>{try{const L="/.netlify/functions/save-multiple-choice-test";console.log("[API] Saving multiple choice test:",R);const W=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(W.success)return console.log("[API] Multiple choice test saved successfully:",W),W;throw new Error(W.error||"Failed to save multiple choice test")}catch(L){throw console.error("[API] Failed to save multiple choice test:",L),L}},[h]),b=w.useCallback(async R=>{try{const L="/.netlify/functions/save-true-false-test";console.log("[API] Saving true/false test:",R);const W=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(W.success)return console.log("[API] True/false test saved successfully:",W),W;throw new Error(W.error||"Failed to save true/false test")}catch(L){throw console.error("[API] Failed to save true/false test:",L),L}},[h]),_=w.useCallback(async R=>{try{const L="/.netlify/functions/save-input-test";console.log("[API] Saving input test:",R);const W=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(W.success)return console.log("[API] Input test saved successfully:",W),W;throw new Error(W.error||"Failed to save input test")}catch(L){throw console.error("[API] Failed to save input test:",L),L}},[h]),T=w.useCallback(async R=>{try{const L="/.netlify/functions/assign-test";console.log("[API] Assigning test to classes:",R);const W=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(W.success)return console.log("[API] Test assigned successfully:",W),W;throw new Error(W.error||"Failed to assign test")}catch(L){throw console.error("[API] Failed to assign test:",L),L}},[h]),N=w.useCallback(async()=>{try{const R="/.netlify/functions/get-teacher-active-tests";console.log("[API] Loading teacher active tests");const G=await(await h(R)).json();if(G.success)return console.log("[API] Teacher active tests loaded successfully:",G.tests),G.tests;throw new Error(G.error||"Failed to load teacher active tests")}catch(R){throw console.error("[API] Failed to load teacher active tests:",R),R}},[h]),E=w.useCallback(async()=>{try{const R="/.netlify/functions/get-all-users";console.log("[API] Getting all users");const G=await(await h(R)).json();if(G.success)return console.log("[API] All users loaded successfully:",G.users),G.users;throw new Error(G.error||"Failed to get all users")}catch(R){throw console.error("[API] Failed to get all users:",R),R}},[h]),F=w.useCallback(async()=>{try{const R="/.netlify/functions/get-all-teachers";console.log("[API] Getting all teachers");const G=await(await h(R)).json();if(G.success)return console.log("[API] All teachers loaded successfully:",G.teachers),G.teachers;throw new Error(G.error||"Failed to get all teachers")}catch(R){throw console.error("[API] Failed to get all teachers:",R),R}},[h]),j=w.useCallback(async()=>{try{const R="/.netlify/functions/get-all-subjects";console.log("[API] Getting all subjects");const G=await(await h(R)).json();if(G.success)return console.log("[API] All subjects loaded successfully:",G.subjects),G.subjects;throw new Error(G.error||"Failed to get all subjects")}catch(R){throw console.error("[API] Failed to get all subjects:",R),R}},[h]),P=w.useCallback(()=>{n(null)},[]),M=w.useCallback(()=>{a(null)},[]),I=w.useCallback(()=>{t(!1),n(null),a(null),o.current=0,d()},[d]),U=w.useCallback(async(R,L={})=>{const W=await(await h(R,{...L,method:"GET"})).json();if(W.success)return W;throw new Error(W.error||"Request failed")},[h]),K=w.useCallback(async(R,L,G={})=>{const Q=await(await h(R,{...G,method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(Q.success)return Q;throw new Error(Q.error||"Request failed")},[h]),te=w.useCallback(async(R,L,G={})=>{const Q=await(await h(R,{...G,method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)})).json();if(Q.success)return Q;throw new Error(Q.error||"Request failed")},[h]),re=w.useCallback(async(R,L={})=>{const W=await(await h(R,{...L,method:"DELETE"})).json();if(W.success)return W;throw new Error(W.error||"Request failed")},[h]),Z=w.useCallback(async R=>{try{const L="/.netlify/functions/submit-speaking-test";console.log("[API] Submitting speaking test:",R);const W=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(W.success)return console.log("[API] Speaking test submitted successfully:",W),W;throw new Error(W.error||"Failed to submit speaking test")}catch(L){throw console.error("[API] Failed to submit speaking test:",L),L}},[h]),B=w.useCallback(async R=>{try{const L=`/.netlify/functions/get-speaking-test-new?action=test&test_id=${R}`;console.log("[API] Getting speaking test:",R);const W=await(await h(L,{method:"GET"})).json();if(W.success)return console.log("[API] Speaking test loaded successfully:",W),W;throw new Error(W.error||"Failed to load speaking test")}catch(L){throw console.error("[API] Failed to load speaking test:",L),L}},[h]),J=w.useCallback(async R=>{try{const L=`/.netlify/functions/get-speaking-test-new?action=questions&test_id=${R}`;console.log("[API] Getting speaking test questions:",R);const W=await(await h(L,{method:"GET"})).json();if(W.success)return console.log("[API] Speaking test questions loaded successfully:",W),W;throw new Error(W.error||"Failed to load speaking test questions")}catch(L){throw console.error("[API] Failed to load speaking test questions:",L),L}},[h]),z=w.useCallback(async R=>{try{const L="/.netlify/functions/upload-speaking-audio";console.log("[API] Uploading speaking audio");const W=await(await h(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).json();if(W.success)return console.log("[API] Audio uploaded successfully:",W),W;throw new Error(W.error||"Failed to upload audio")}catch(L){throw console.error("[API] Failed to upload audio:",L),L}},[h]),q=w.useCallback(async R=>{try{const L=`/.netlify/functions/get-speaking-test-new?action=audio&file_path=${encodeURIComponent(R)}`;console.log("[API] Getting speaking audio:",R);const W=await(await h(L,{method:"GET"})).json();if(W.success)return console.log("[API] Audio URL retrieved successfully:",W),W;throw new Error(W.error||"Failed to get audio")}catch(L){throw console.error("[API] Failed to get audio:",L),L}},[h]),H=w.useCallback(async(R,L)=>{try{const G=`/.netlify/functions/check-test-completion?test_id=${R}&test_type=${L}`;console.log("[API] Checking test completion:",R,L);const Q=await(await h(G,{method:"GET"})).json();if(Q.success)return console.log("[API] Test completion status:",Q),Q;throw new Error(Q.error||"Failed to check test completion")}catch(G){throw console.error("[API] Failed to check test completion:",G),G}},[h]);return{loading:e,error:r,data:s,sendRequest:f,makeAuthenticatedRequest:h,get:U,post:K,put:te,delete:re,getTestInfo:g,getTestQuestions:p,loadStudentActiveTests:x,submitTest:v,submitSpeakingTest:Z,getSpeakingTest:B,getSpeakingTestQuestions:J,uploadSpeakingAudio:z,getSpeakingAudio:q,checkTestCompletion:H,saveMultipleChoiceTest:C,saveTrueFalseTest:b,saveInputTest:_,assignTestToClasses:T,loadTeacherActiveTests:N,getAllUsers:E,getAllTeachers:F,getAllSubjects:j,clearError:P,clearData:M,reset:I,cleanup:d}},vW=(e,t)=>{const[r,n]=w.useState(()=>{try{const i=window.localStorage.getItem(e);return i?JSON.parse(i):t}catch(i){return console.error(`Error reading localStorage key "${e}":`,i),t}}),s=w.useCallback(i=>{try{const o=i instanceof Function?i(r):i;n(o),window.localStorage.setItem(e,JSON.stringify(o))}catch(o){console.error(`Error setting localStorage key "${e}":`,o)}},[e,r]),a=w.useCallback(()=>{try{window.localStorage.removeItem(e),n(t)}catch(i){console.error(`Error removing localStorage key "${e}":`,i)}},[e,t]);return[r,s,a]},kS=()=>{const e=w.useCallback((c,u=null)=>{try{const d=window.localStorage.getItem(c);return d?JSON.parse(d):u}catch(d){return console.error(`Error reading localStorage key "${c}":`,d),u}},[]),t=w.useCallback((c,u)=>{try{window.localStorage.setItem(c,JSON.stringify(u))}catch(d){console.error(`Error setting localStorage key "${c}":`,d)}},[]),r=w.useCallback(c=>{try{window.localStorage.removeItem(c)}catch(u){console.error(`Error removing localStorage key "${c}":`,u)}},[]),n=w.useCallback(()=>{if(confirm("Are you sure you want to clear all local storage? This cannot be undone."))try{window.localStorage.clear(),window.showNotification?window.showNotification("All local storage cleared!","success"):console.log("All local storage cleared!")}catch(c){console.error("Error clearing localStorage:",c)}},[]),s=w.useCallback(()=>{try{const c={};for(let h=0;h<window.localStorage.length;h++){const g=window.localStorage.key(h);g&&(c[g]=window.localStorage.getItem(g))}const u=new Blob([JSON.stringify(c,null,2)],{type:"application/json"}),d=URL.createObjectURL(u),f=document.createElement("a");f.href=d,f.download="localStorage_backup.json",f.click(),URL.revokeObjectURL(d),window.showNotification?window.showNotification("Local storage exported!","success"):console.log("Local storage exported!")}catch(c){console.error("Error exporting localStorage data:",c)}},[]),a=w.useCallback(()=>{try{window.localStorage.clear()}catch(c){console.error("Error clearing localStorage:",c)}},[]),i=w.useCallback(()=>{try{const c={};for(let u=0;u<window.localStorage.length;u++){const d=window.localStorage.key(u);d&&(c[d]=window.localStorage.getItem(d))}return c}catch(c){return console.error("Error exporting localStorage data:",c),{}}},[]),o=w.useCallback(c=>{try{Object.entries(c).forEach(([u,d])=>{window.localStorage.setItem(u,d)})}catch(u){console.error("Error importing localStorage data:",u)}},[]);return{getItem:e,setItem:t,removeItem:r,clearAll:a,clearAllLocalStorage:n,exportLocalStorage:s,exportData:i,importData:o}},fe={yellow:"#f8ef02",cyan:"#00ffd2",red:"#ff003c",blue:"#136377",green:"#446d44",purple:"purple",black:"#000",white:"#fff",dark:"#333"},He={primary:"#ec4899",primaryDark:"#db2777",primaryLight:"#f472b6",secondary:"#a855f7",background:"#000000",backgroundSecondary:"#1a0014",backgroundTertiary:"#2d1b3d",text:"#ffffff",textSecondary:"#fce7f3",textAccent:"#ec4899",border:"#ec4899",borderSecondary:"#a855f7",accent:"#f472b6",glow:"#ec4899",glowPurple:"#a855f7",success:"#10b981",error:"#ef4444",white:"#ffffff",black:"#000000"},bie=(e,t=1)=>{if(e.startsWith("#")){const r=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),s=parseInt(e.slice(5,7),16);return`rgba(${r}, ${n}, ${s}, ${t})`}return e},bW=(e,t=1)=>e==="purple"?`rgba(128, 0, 128, ${t})`:bie(e,t),Vt=(e=null)=>{const t=[{bg:fe.red,border:fe.red},{bg:fe.yellow,border:fe.yellow},{bg:fe.purple,border:fe.purple},{bg:fe.cyan,border:fe.cyan},{bg:fe.red,border:fe.red},{bg:fe.yellow,border:fe.yellow},{bg:fe.purple,border:fe.purple}],r=e!==null?t[e%t.length]:t[Math.floor(Math.random()*t.length)];return{className:"border-2",style:{backgroundColor:fe.black,borderColor:r.border,borderWidth:"2px"}}},hr=(e=null)=>{const t=[{background:"#1a0014",border:He.primary,shadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 30px rgba(236, 72, 153, 0.2)"},{background:"#2d1b3d",border:He.secondary,shadow:"0 0 30px rgba(168, 85, 247, 0.8), 0 0 60px rgba(168, 85, 247, 0.6), 0 0 90px rgba(168, 85, 247, 0.4), inset 0 0 30px rgba(168, 85, 247, 0.2)"},{background:"#1f0a1f",border:He.primaryDark,shadow:"0 0 30px rgba(219, 39, 119, 0.8), 0 0 60px rgba(219, 39, 119, 0.6), 0 0 90px rgba(219, 39, 119, 0.4), inset 0 0 30px rgba(219, 39, 119, 0.2)"},{background:"#2a1b3d",border:He.primaryLight,shadow:"0 0 30px rgba(244, 114, 182, 0.8), 0 0 60px rgba(244, 114, 182, 0.6), 0 0 90px rgba(244, 114, 182, 0.4), inset 0 0 30px rgba(244, 114, 182, 0.2)"},{background:"#1a0a1a",border:He.primary,shadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 30px rgba(236, 72, 153, 0.2)"},{background:"#2d1b3d",border:He.secondary,shadow:"0 0 30px rgba(168, 85, 247, 0.8), 0 0 60px rgba(168, 85, 247, 0.6), 0 0 90px rgba(168, 85, 247, 0.4), inset 0 0 30px rgba(168, 85, 247, 0.2)"}],r=e!==null?t[e%t.length]:t[Math.floor(Math.random()*t.length)];return{className:"border-2",style:{backgroundColor:r.background,borderColor:r.border,borderWidth:"2px",boxShadow:r.shadow}}},wie=e=>{const t={light:{background:"bg-white",backgroundSecondary:"bg-gray-50",text:"text-gray-900",textSecondary:"text-gray-600",border:"border-gray-300",headerBg:"bg-blue-600",headerText:"text-white",headerBorder:"border-blue-700",buttonPrimary:"bg-blue-500 text-white hover:bg-blue-600",buttonSecondary:"bg-gray-200 text-gray-700 hover:bg-gray-300",buttonOutline:"border-gray-300 text-gray-700 hover:bg-gray-50",cardBg:"bg-white",cardBorder:"border-gray-200",inputBg:"bg-white",inputBorder:"border-gray-300",inputText:"text-gray-900",progressBg:"bg-gray-200",progressFill:"bg-blue-500"},cyberpunk:{background:"bg-black",backgroundSecondary:"bg-gray-900",text:"",textSecondary:"",border:"",headerBg:"bg-black",headerText:"",headerBorder:"",buttonPrimary:"",buttonSecondary:"bg-gray-800",buttonOutline:"",cardBg:"",cardBorder:"",inputBg:"bg-black",inputBorder:"",inputText:"",progressBg:"bg-gray-800",progressFill:"",buttonRed:"",buttonYellow:"",buttonPurple:""},kpop:{background:"bg-black",backgroundSecondary:"bg-black",text:"",textSecondary:"",border:"",headerBg:"bg-black",headerText:"",headerBorder:"",buttonPrimary:"",buttonSecondary:"",buttonOutline:"",cardBg:"",cardBorder:"",inputBg:"bg-black",inputBorder:"",inputText:"",progressBg:"bg-black",progressFill:"",buttonPink:"",buttonPurple:""}};return t[e]||t.cyberpunk},ua=e=>e==="cyberpunk"?{background:{backgroundColor:fe.black},glow:{boxShadow:`0 0 8px ${fe.cyan}, 0 0 12px ${fe.cyan}`},glowRed:{boxShadow:`0 0 8px ${fe.red}, 0 0 12px ${fe.red}`},glowYellow:{boxShadow:`0 0 6px ${fe.yellow}, 0 0 10px ${fe.yellow}`},glowPurple:{boxShadow:`0 0 8px ${fe.purple}, 0 0 12px ${fe.purple}`},glowGreen:{boxShadow:`0 0 8px ${fe.green}, 0 0 12px ${fe.green}`},textShadow:{textShadow:`0 0 10px ${fe.cyan}, 0 0 20px ${fe.cyan}, 0 0 30px ${fe.cyan}`},textShadowYellow:{textShadow:`0 0 8px ${fe.yellow}, 0 0 16px ${fe.yellow}`},textShadowRed:{textShadow:`0 0 8px ${fe.red}, 0 0 16px ${fe.red}`},textShadowPurple:{textShadow:`0 0 8px ${fe.purple}, 0 0 16px ${fe.purple}`},textShadowGreen:{textShadow:`0 0 8px ${fe.green}, 0 0 16px ${fe.green}`},textCyan:{color:fe.cyan,textShadow:`0 0 10px ${fe.cyan}, 0 0 20px ${fe.cyan}, 0 0 30px ${fe.cyan}`},textYellow:{color:fe.yellow,textShadow:`0 0 8px ${fe.yellow}, 0 0 16px ${fe.yellow}`},textRed:{color:fe.red,textShadow:`0 0 8px ${fe.red}, 0 0 16px ${fe.red}`},textPurple:{color:fe.purple,textShadow:`0 0 8px ${fe.purple}, 0 0 16px ${fe.purple}`},textGreen:{color:fe.green,textShadow:`0 0 8px ${fe.green}, 0 0 16px ${fe.green}`}}:e==="kpop"?{background:{backgroundColor:He.background,backgroundImage:"radial-gradient(circle at 20% 50%, rgba(236, 72, 153, 0.15) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(168, 85, 247, 0.15) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(236, 72, 153, 0.1) 0%, transparent 50%)"},backgroundSecondary:{backgroundColor:He.backgroundSecondary},glow:{boxShadow:`0 0 30px ${He.glow}, 0 0 60px ${He.glow}, 0 0 90px ${He.glow}, 0 0 120px rgba(236, 72, 153, 0.3)`},glowPurple:{boxShadow:`0 0 30px ${He.glowPurple}, 0 0 60px ${He.glowPurple}, 0 0 90px ${He.glowPurple}, 0 0 120px rgba(168, 85, 247, 0.3)`},glowRed:{boxShadow:`0 0 30px ${He.primary}, 0 0 60px ${He.primary}, 0 0 90px ${He.primary}, 0 0 120px rgba(236, 72, 153, 0.3)`},shadow:{boxShadow:`0 0 20px ${He.glow}, 0 0 40px ${He.glow}, 0 0 60px rgba(236, 72, 153, 0.4)`},shadowMd:{boxShadow:`0 0 30px ${He.glow}, 0 0 60px ${He.glow}, 0 0 90px rgba(236, 72, 153, 0.4)`},shadowLg:{boxShadow:`0 0 40px ${He.glow}, 0 0 80px ${He.glow}, 0 0 120px rgba(236, 72, 153, 0.5)`},textShadow:{textShadow:`0 0 15px ${He.glow}, 0 0 30px ${He.glow}, 0 0 45px ${He.glow}, 0 0 60px rgba(236, 72, 153, 0.4)`},textShadowMd:{textShadow:`0 0 12px ${He.glow}, 0 0 24px ${He.glow}, 0 0 36px rgba(236, 72, 153, 0.5)`},textShadowRed:{textShadow:`0 0 15px ${He.primary}, 0 0 30px ${He.primary}, 0 0 45px rgba(236, 72, 153, 0.6)`},textPink:{color:He.primary,textShadow:`0 0 15px ${He.primary}, 0 0 30px ${He.primary}, 0 0 45px ${He.primary}, 0 0 60px rgba(236, 72, 153, 0.5)`},textPurple:{color:He.secondary,textShadow:`0 0 15px ${He.secondary}, 0 0 30px ${He.secondary}, 0 0 45px ${He.secondary}, 0 0 60px rgba(168, 85, 247, 0.5)`},textWhite:{color:He.text,textShadow:`0 0 10px ${He.glow}, 0 0 20px ${He.glow}, 0 0 30px rgba(236, 72, 153, 0.4)`},textAccent:{color:He.textAccent,textShadow:`0 0 12px ${He.textAccent}, 0 0 24px ${He.textAccent}, 0 0 36px rgba(236, 72, 153, 0.5)`},textViolet:{color:He.primary,textShadow:`0 0 15px ${He.primary}, 0 0 30px ${He.primary}, 0 0 45px rgba(236, 72, 153, 0.5)`},textVioletDark:{color:He.text,textShadow:`0 0 8px ${He.glow}, 0 0 16px rgba(236, 72, 153, 0.3)`},textVioletLight:{color:He.primaryLight,textShadow:`0 0 12px ${He.primaryLight}, 0 0 24px ${He.primaryLight}, 0 0 36px rgba(244, 114, 182, 0.5)`},buttonHover:{transition:"all 0.2s ease-in-out"},headerGradient:{background:"linear-gradient(135deg, #000000 0%, #1a0014 20%, #ec4899 60%, #f472b6 100%)",boxShadow:`0 0 30px ${He.primary}, 0 0 60px ${He.primary}, 0 0 90px rgba(236, 72, 153, 0.5), inset 0 0 30px rgba(236, 72, 153, 0.2)`},headerText:{color:He.primary,textShadow:`-1px -1px 0 #ffffff, 1px -1px 0 #ffffff, -1px 1px 0 #ffffff, 1px 1px 0 #ffffff, 0 -1px 0 #ffffff, 0 1px 0 #ffffff, -1px 0 0 #ffffff, 1px 0 0 #ffffff, 0 0 15px ${He.primary}, 0 0 30px ${He.primary}, 0 0 45px ${He.primary}, 0 0 60px rgba(236, 72, 153, 0.5)`}}:{},zP=e=>{typeof document>"u"||(e==="cyberpunk"?document.documentElement.setAttribute("data-theme","cyberpunk"):e==="kpop"?document.documentElement.setAttribute("data-theme","kpop"):document.documentElement.setAttribute("data-theme","light"))},wW=w.createContext({theme:"cyberpunk",setTheme:e=>{},isCyberpunk:!0,isLight:!1,isKpop:!1,themeClasses:{}}),_ie=({children:e})=>{const[t,r]=w.useState(()=>{if(typeof window<"u"){const a=localStorage.getItem("student_theme_preference");return a==="light"||a==="cyberpunk"||a==="kpop"?a:"cyberpunk"}return"cyberpunk"});w.useEffect(()=>{zP(t)},[t]);const s={theme:t,setTheme:a=>{a!=="light"&&a!=="cyberpunk"&&a!=="kpop"&&(console.warn(`Invalid theme: ${a}. Defaulting to cyberpunk.`),a="cyberpunk"),r(a),typeof window<"u"&&localStorage.setItem("student_theme_preference",a),zP(a)},isCyberpunk:t==="cyberpunk",isLight:t==="light",isKpop:t==="kpop",themeClasses:wie(t)};return l.jsx(wW.Provider,{value:s,children:e})},da=()=>{const e=w.useContext(wW);return e||{theme:"light",setTheme:()=>{},isCyberpunk:!1,isLight:!0,isKpop:!1,themeClasses:{}}};class xl{constructor(t,r,n){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=t,this.start=r,this.end=n}static range(t,r){return r?!t||!t.loc||!r.loc||t.loc.lexer!==r.loc.lexer?null:new xl(t.loc.lexer,t.loc.start,r.loc.end):t&&t.loc}}class Yl{constructor(t,r){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=t,this.loc=r}range(t,r){return new Yl(r,xl.range(this,t))}}class ir{constructor(t,r){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var n="KaTeX parse error: "+t,s,a,i=r&&r.loc;if(i&&i.start<=i.end){var o=i.lexer.input;s=i.start,a=i.end,s===o.length?n+=" at end of input: ":n+=" at position "+(s+1)+": ";var c=o.slice(s,a).replace(/[^]/g,"$&"),u;s>15?u=""+o.slice(s-15,s):u=o.slice(0,s);var d;a+15<o.length?d=o.slice(a,a+15)+"":d=o.slice(a),n+=u+c+d}var f=new Error(n);return f.name="ParseError",f.__proto__=ir.prototype,f.position=s,s!=null&&a!=null&&(f.length=a-s),f.rawMessage=t,f}}ir.prototype.__proto__=Error.prototype;var Sie=function(t,r){return t===void 0?r:t},kie=/([A-Z])/g,Cie=function(t){return t.replace(kie,"-$1").toLowerCase()},Tie={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},Nie=/[&><"']/g;function Eie(e){return String(e).replace(Nie,t=>Tie[t])}var _W=function e(t){return t.type==="ordgroup"||t.type==="color"?t.body.length===1?e(t.body[0]):t:t.type==="font"?e(t.body):t},Aie=function(t){var r=_W(t);return r.type==="mathord"||r.type==="textord"||r.type==="atom"},jie=function(t){if(!t)throw new Error("Expected non-null, but got "+String(t));return t},Pie=function(t){var r=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(t);return r?r[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(r[1])?null:r[1].toLowerCase():"_relative"},Xn={deflt:Sie,escape:Eie,hyphenate:Cie,getBaseElem:_W,isCharacterBox:Aie,protocolFromUrl:Pie},E4={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:e=>"#"+e},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(e,t)=>(t.push(e),t)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:e=>Math.max(0,e),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:e=>Math.max(0,e),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:e=>Math.max(0,e),cli:"-e, --max-expand <n>",cliProcessor:e=>e==="Infinity"?1/0:parseInt(e)},globalGroup:{type:"boolean",cli:!1}};function Fie(e){if(e.default)return e.default;var t=e.type,r=Array.isArray(t)?t[0]:t;if(typeof r!="string")return r.enum[0];switch(r){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class nN{constructor(t){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,t=t||{};for(var r in E4)if(E4.hasOwnProperty(r)){var n=E4[r];this[r]=t[r]!==void 0?n.processor?n.processor(t[r]):t[r]:Fie(n)}}reportNonstrict(t,r,n){var s=this.strict;if(typeof s=="function"&&(s=s(t,r,n)),!(!s||s==="ignore")){if(s===!0||s==="error")throw new ir("LaTeX-incompatible input and strict mode is set to 'error': "+(r+" ["+t+"]"),n);s==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(r+" ["+t+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+s+"': "+r+" ["+t+"]"))}}useStrictBehavior(t,r,n){var s=this.strict;if(typeof s=="function")try{s=s(t,r,n)}catch{s="error"}return!s||s==="ignore"?!1:s===!0||s==="error"?!0:s==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(r+" ["+t+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+s+"': "+r+" ["+t+"]")),!1)}isTrusted(t){if(t.url&&!t.protocol){var r=Xn.protocolFromUrl(t.url);if(r==null)return!1;t.protocol=r}var n=typeof this.trust=="function"?this.trust(t):this.trust;return!!n}}class Af{constructor(t,r,n){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=t,this.size=r,this.cramped=n}sup(){return td[Mie[this.id]]}sub(){return td[Rie[this.id]]}fracNum(){return td[Oie[this.id]]}fracDen(){return td[Die[this.id]]}cramp(){return td[Iie[this.id]]}text(){return td[Lie[this.id]]}isTight(){return this.size>=2}}var sN=0,J4=1,Kp=2,h0=3,Gv=4,Ac=5,u1=6,Xo=7,td=[new Af(sN,0,!1),new Af(J4,0,!0),new Af(Kp,1,!1),new Af(h0,1,!0),new Af(Gv,2,!1),new Af(Ac,2,!0),new Af(u1,3,!1),new Af(Xo,3,!0)],Mie=[Gv,Ac,Gv,Ac,u1,Xo,u1,Xo],Rie=[Ac,Ac,Ac,Ac,Xo,Xo,Xo,Xo],Oie=[Kp,h0,Gv,Ac,u1,Xo,u1,Xo],Die=[h0,h0,Ac,Ac,Xo,Xo,Xo,Xo],Iie=[J4,J4,h0,h0,Ac,Ac,Xo,Xo],Lie=[sN,J4,Kp,h0,Kp,h0,Kp,h0],sn={DISPLAY:td[sN],TEXT:td[Kp],SCRIPT:td[Gv],SCRIPTSCRIPT:td[u1]},pT=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function Bie(e){for(var t=0;t<pT.length;t++)for(var r=pT[t],n=0;n<r.blocks.length;n++){var s=r.blocks[n];if(e>=s[0]&&e<=s[1])return r.name}return null}var A4=[];pT.forEach(e=>e.blocks.forEach(t=>A4.push(...t)));function SW(e){for(var t=0;t<A4.length;t+=2)if(e>=A4[t]&&e<=A4[t+1])return!0;return!1}var bp=80,$ie=function(t,r){return"M95,"+(622+t+r)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+t/2.075+" -"+t+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+t)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+t)+" "+r+"h400000v"+(40+t)+"h-400000z"},Uie=function(t,r){return"M263,"+(601+t+r)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+t/2.084+" -"+t+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+t)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+t)+" "+r+"h400000v"+(40+t)+"h-400000z"},zie=function(t,r){return"M983 "+(10+t+r)+`
l`+t/3.13+" -"+t+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+t)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+t)+" "+r+"h400000v"+(40+t)+"h-400000z"},Wie=function(t,r){return"M424,"+(2398+t+r)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+t/4.223+" -"+t+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+t)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+t)+" "+r+`
h400000v`+(40+t)+"h-400000z"},Hie=function(t,r){return"M473,"+(2713+t+r)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+t/5.298+" -"+t+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+t)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+t)+" "+r+"h400000v"+(40+t)+"H1017.7z"},Gie=function(t){var r=t/2;return"M400000 "+t+" H0 L"+r+" 0 l65 45 L145 "+(t-80)+" H400000z"},Vie=function(t,r,n){var s=n-54-r-t;return"M702 "+(t+r)+"H400000"+(40+t)+`
H742v`+s+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+r+"H400000v"+(40+t)+"H742z"},qie=function(t,r,n){r=1e3*r;var s="";switch(t){case"sqrtMain":s=$ie(r,bp);break;case"sqrtSize1":s=Uie(r,bp);break;case"sqrtSize2":s=zie(r,bp);break;case"sqrtSize3":s=Wie(r,bp);break;case"sqrtSize4":s=Hie(r,bp);break;case"sqrtTall":s=Vie(r,bp,n)}return s},Kie=function(t,r){switch(t){case"":return"M291 0 H417 V"+r+" H291z M291 0 H417 V"+r+" H291z";case"":return"M145 0 H188 V"+r+" H145z M145 0 H188 V"+r+" H145z";case"":return"M145 0 H188 V"+r+" H145z M145 0 H188 V"+r+" H145z"+("M367 0 H410 V"+r+" H367z M367 0 H410 V"+r+" H367z");case"":return"M457 0 H583 V"+r+" H457z M457 0 H583 V"+r+" H457z";case"":return"M319 0 H403 V"+r+" H319z M319 0 H403 V"+r+" H319z";case"":return"M263 0 H347 V"+r+" H263z M263 0 H347 V"+r+" H263z";case"":return"M384 0 H504 V"+r+" H384z M384 0 H504 V"+r+" H384z";case"":return"M312 0 H355 V"+r+" H312z M312 0 H355 V"+r+" H312z";case"":return"M257 0 H300 V"+r+" H257z M257 0 H300 V"+r+" H257z"+("M478 0 H521 V"+r+" H478z M478 0 H521 V"+r+" H478z");default:return""}},WP={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},Yie=function(t,r){switch(t){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+r+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+r+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+r+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+r+" v1759 h84z";case"vert":return"M145 15 v585 v"+r+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-r+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+r+" v585 h43z";case"doublevert":return"M145 15 v585 v"+r+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-r+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+r+` v585 h43z
M367 15 v585 v`+r+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-r+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+r+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+r+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+r+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+r+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+r+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+r+` v602 h84z
M403 1759 V0 H319 V1759 v`+r+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+r+` v602 h84z
M347 1759 V0 h-84 V1759 v`+r+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(r+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(r+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(r+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(r+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class M2{constructor(t){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=t,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(t){return this.classes.includes(t)}toNode(){for(var t=document.createDocumentFragment(),r=0;r<this.children.length;r++)t.appendChild(this.children[r].toNode());return t}toMarkup(){for(var t="",r=0;r<this.children.length;r++)t+=this.children[r].toMarkup();return t}toText(){var t=r=>r.toText();return this.children.map(t).join("")}}var sd={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},Cw={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},HP={:"A",:"D",:"o",:"a",:"d",:"o",:"A",:"B",:"B",:"F",:"A",:"E",:"K",:"3",:"N",:"N",:"K",:"N",:"M",:"H",:"O",:"N",:"P",:"C",:"T",:"y",:"O",:"X",:"U",:"h",:"W",:"W",:"B",:"X",:"B",:"3",:"X",:"R",:"a",:"b",:"a",:"r",:"y",:"e",:"m",:"e",:"n",:"n",:"n",:"n",:"m",:"n",:"o",:"n",:"p",:"c",:"o",:"y",:"b",:"x",:"n",:"n",:"w",:"w",:"a",:"m",:"a",:"e",:"m",:"r"};function Xie(e,t){sd[e]=t}function aN(e,t,r){if(!sd[t])throw new Error("Font metrics not found for font: "+t+".");var n=e.charCodeAt(0),s=sd[t][n];if(!s&&e[0]in HP&&(n=HP[e[0]].charCodeAt(0),s=sd[t][n]),!s&&r==="text"&&SW(n)&&(s=sd[t][77]),s)return{depth:s[0],height:s[1],italic:s[2],skew:s[3],width:s[4]}}var L5={};function Jie(e){var t;if(e>=5?t=0:e>=3?t=1:t=2,!L5[t]){var r=L5[t]={cssEmPerMu:Cw.quad[t]/18};for(var n in Cw)Cw.hasOwnProperty(n)&&(r[n]=Cw[n][t])}return L5[t]}var Qie=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],GP=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],VP=function(t,r){return r.size<2?t:Qie[t-1][r.size-1]};class r0{constructor(t){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=t.style,this.color=t.color,this.size=t.size||r0.BASESIZE,this.textSize=t.textSize||this.size,this.phantom=!!t.phantom,this.font=t.font||"",this.fontFamily=t.fontFamily||"",this.fontWeight=t.fontWeight||"",this.fontShape=t.fontShape||"",this.sizeMultiplier=GP[this.size-1],this.maxSize=t.maxSize,this.minRuleThickness=t.minRuleThickness,this._fontMetrics=void 0}extend(t){var r={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return new r0(r)}havingStyle(t){return this.style===t?this:this.extend({style:t,size:VP(this.textSize,t)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(t){return this.size===t&&this.textSize===t?this:this.extend({style:this.style.text(),size:t,textSize:t,sizeMultiplier:GP[t-1]})}havingBaseStyle(t){t=t||this.style.text();var r=VP(r0.BASESIZE,t);return this.size===r&&this.textSize===r0.BASESIZE&&this.style===t?this:this.extend({style:t,size:r})}havingBaseSizing(){var t;switch(this.style.id){case 4:case 5:t=3;break;case 6:case 7:t=1;break;default:t=6}return this.extend({style:this.style.text(),size:t})}withColor(t){return this.extend({color:t})}withPhantom(){return this.extend({phantom:!0})}withFont(t){return this.extend({font:t})}withTextFontFamily(t){return this.extend({fontFamily:t,font:""})}withTextFontWeight(t){return this.extend({fontWeight:t,font:""})}withTextFontShape(t){return this.extend({fontShape:t,font:""})}sizingClasses(t){return t.size!==this.size?["sizing","reset-size"+t.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==r0.BASESIZE?["sizing","reset-size"+this.size,"size"+r0.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=Jie(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}r0.BASESIZE=6;var xT={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},Zie={ex:!0,em:!0,mu:!0},kW=function(t){return typeof t!="string"&&(t=t.unit),t in xT||t in Zie||t==="ex"},aa=function(t,r){var n;if(t.unit in xT)n=xT[t.unit]/r.fontMetrics().ptPerEm/r.sizeMultiplier;else if(t.unit==="mu")n=r.fontMetrics().cssEmPerMu;else{var s;if(r.style.isTight()?s=r.havingStyle(r.style.text()):s=r,t.unit==="ex")n=s.fontMetrics().xHeight;else if(t.unit==="em")n=s.fontMetrics().quad;else throw new ir("Invalid unit: '"+t.unit+"'");s!==r&&(n*=s.sizeMultiplier/r.sizeMultiplier)}return Math.min(t.number*n,r.maxSize)},Sr=function(t){return+t.toFixed(4)+"em"},nh=function(t){return t.filter(r=>r).join(" ")},CW=function(t,r,n){if(this.classes=t||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=n||{},r){r.style.isTight()&&this.classes.push("mtight");var s=r.getColor();s&&(this.style.color=s)}},TW=function(t){var r=document.createElement(t);r.className=nh(this.classes);for(var n in this.style)this.style.hasOwnProperty(n)&&(r.style[n]=this.style[n]);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&r.setAttribute(s,this.attributes[s]);for(var a=0;a<this.children.length;a++)r.appendChild(this.children[a].toNode());return r},eoe=/[\s"'>/=\x00-\x1f]/,NW=function(t){var r="<"+t;this.classes.length&&(r+=' class="'+Xn.escape(nh(this.classes))+'"');var n="";for(var s in this.style)this.style.hasOwnProperty(s)&&(n+=Xn.hyphenate(s)+":"+this.style[s]+";");n&&(r+=' style="'+Xn.escape(n)+'"');for(var a in this.attributes)if(this.attributes.hasOwnProperty(a)){if(eoe.test(a))throw new ir("Invalid attribute name '"+a+"'");r+=" "+a+'="'+Xn.escape(this.attributes[a])+'"'}r+=">";for(var i=0;i<this.children.length;i++)r+=this.children[i].toMarkup();return r+="</"+t+">",r};class R2{constructor(t,r,n,s){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,CW.call(this,t,n,s),this.children=r||[]}setAttribute(t,r){this.attributes[t]=r}hasClass(t){return this.classes.includes(t)}toNode(){return TW.call(this,"span")}toMarkup(){return NW.call(this,"span")}}class iN{constructor(t,r,n,s){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,CW.call(this,r,s),this.children=n||[],this.setAttribute("href",t)}setAttribute(t,r){this.attributes[t]=r}hasClass(t){return this.classes.includes(t)}toNode(){return TW.call(this,"a")}toMarkup(){return NW.call(this,"a")}}class toe{constructor(t,r,n){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=r,this.src=t,this.classes=["mord"],this.style=n}hasClass(t){return this.classes.includes(t)}toNode(){var t=document.createElement("img");t.src=this.src,t.alt=this.alt,t.className="mord";for(var r in this.style)this.style.hasOwnProperty(r)&&(t.style[r]=this.style[r]);return t}toMarkup(){var t='<img src="'+Xn.escape(this.src)+'"'+(' alt="'+Xn.escape(this.alt)+'"'),r="";for(var n in this.style)this.style.hasOwnProperty(n)&&(r+=Xn.hyphenate(n)+":"+this.style[n]+";");return r&&(t+=' style="'+Xn.escape(r)+'"'),t+="'/>",t}}var roe={:"",:"",:"",:""};class Oc{constructor(t,r,n,s,a,i,o,c){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=t,this.height=r||0,this.depth=n||0,this.italic=s||0,this.skew=a||0,this.width=i||0,this.classes=o||[],this.style=c||{},this.maxFontSize=0;var u=Bie(this.text.charCodeAt(0));u&&this.classes.push(u+"_fallback"),/[]/.test(this.text)&&(this.text=roe[this.text])}hasClass(t){return this.classes.includes(t)}toNode(){var t=document.createTextNode(this.text),r=null;this.italic>0&&(r=document.createElement("span"),r.style.marginRight=Sr(this.italic)),this.classes.length>0&&(r=r||document.createElement("span"),r.className=nh(this.classes));for(var n in this.style)this.style.hasOwnProperty(n)&&(r=r||document.createElement("span"),r.style[n]=this.style[n]);return r?(r.appendChild(t),r):t}toMarkup(){var t=!1,r="<span";this.classes.length&&(t=!0,r+=' class="',r+=Xn.escape(nh(this.classes)),r+='"');var n="";this.italic>0&&(n+="margin-right:"+this.italic+"em;");for(var s in this.style)this.style.hasOwnProperty(s)&&(n+=Xn.hyphenate(s)+":"+this.style[s]+";");n&&(t=!0,r+=' style="'+Xn.escape(n)+'"');var a=Xn.escape(this.text);return t?(r+=">",r+=a,r+="</span>",r):a}}class S0{constructor(t,r){this.children=void 0,this.attributes=void 0,this.children=t||[],this.attributes=r||{}}toNode(){var t="http://www.w3.org/2000/svg",r=document.createElementNS(t,"svg");for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&r.setAttribute(n,this.attributes[n]);for(var s=0;s<this.children.length;s++)r.appendChild(this.children[s].toNode());return r}toMarkup(){var t='<svg xmlns="http://www.w3.org/2000/svg"';for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&(t+=" "+r+'="'+Xn.escape(this.attributes[r])+'"');t+=">";for(var n=0;n<this.children.length;n++)t+=this.children[n].toMarkup();return t+="</svg>",t}}class sh{constructor(t,r){this.pathName=void 0,this.alternate=void 0,this.pathName=t,this.alternate=r}toNode(){var t="http://www.w3.org/2000/svg",r=document.createElementNS(t,"path");return this.alternate?r.setAttribute("d",this.alternate):r.setAttribute("d",WP[this.pathName]),r}toMarkup(){return this.alternate?'<path d="'+Xn.escape(this.alternate)+'"/>':'<path d="'+Xn.escape(WP[this.pathName])+'"/>'}}class yT{constructor(t){this.attributes=void 0,this.attributes=t||{}}toNode(){var t="http://www.w3.org/2000/svg",r=document.createElementNS(t,"line");for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&r.setAttribute(n,this.attributes[n]);return r}toMarkup(){var t="<line";for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&(t+=" "+r+'="'+Xn.escape(this.attributes[r])+'"');return t+="/>",t}}function qP(e){if(e instanceof Oc)return e;throw new Error("Expected symbolNode but got "+String(e)+".")}function noe(e){if(e instanceof R2)return e;throw new Error("Expected span<HtmlDomNode> but got "+String(e)+".")}var soe={bin:1,close:1,inner:1,open:1,punct:1,rel:1},aoe={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},Is={math:{},text:{}};function ne(e,t,r,n,s,a){Is[e][s]={font:t,group:r,replace:n},a&&n&&(Is[e][n]=Is[e][s])}var oe="math",Zt="text",pe="main",We="ams",ea="accent-token",Ir="bin",tl="close",R1="inner",nn="mathord",ei="op-token",rc="open",CS="punct",Ke="rel",R0="spacing",ft="textord";ne(oe,pe,Ke,"","\\equiv",!0);ne(oe,pe,Ke,"","\\prec",!0);ne(oe,pe,Ke,"","\\succ",!0);ne(oe,pe,Ke,"","\\sim",!0);ne(oe,pe,Ke,"","\\perp");ne(oe,pe,Ke,"","\\preceq",!0);ne(oe,pe,Ke,"","\\succeq",!0);ne(oe,pe,Ke,"","\\simeq",!0);ne(oe,pe,Ke,"","\\mid",!0);ne(oe,pe,Ke,"","\\ll",!0);ne(oe,pe,Ke,"","\\gg",!0);ne(oe,pe,Ke,"","\\asymp",!0);ne(oe,pe,Ke,"","\\parallel");ne(oe,pe,Ke,"","\\bowtie",!0);ne(oe,pe,Ke,"","\\smile",!0);ne(oe,pe,Ke,"","\\sqsubseteq",!0);ne(oe,pe,Ke,"","\\sqsupseteq",!0);ne(oe,pe,Ke,"","\\doteq",!0);ne(oe,pe,Ke,"","\\frown",!0);ne(oe,pe,Ke,"","\\ni",!0);ne(oe,pe,Ke,"","\\propto",!0);ne(oe,pe,Ke,"","\\vdash",!0);ne(oe,pe,Ke,"","\\dashv",!0);ne(oe,pe,Ke,"","\\owns");ne(oe,pe,CS,".","\\ldotp");ne(oe,pe,CS,"","\\cdotp");ne(oe,pe,ft,"#","\\#");ne(Zt,pe,ft,"#","\\#");ne(oe,pe,ft,"&","\\&");ne(Zt,pe,ft,"&","\\&");ne(oe,pe,ft,"","\\aleph",!0);ne(oe,pe,ft,"","\\forall",!0);ne(oe,pe,ft,"","\\hbar",!0);ne(oe,pe,ft,"","\\exists",!0);ne(oe,pe,ft,"","\\nabla",!0);ne(oe,pe,ft,"","\\flat",!0);ne(oe,pe,ft,"","\\ell",!0);ne(oe,pe,ft,"","\\natural",!0);ne(oe,pe,ft,"","\\clubsuit",!0);ne(oe,pe,ft,"","\\wp",!0);ne(oe,pe,ft,"","\\sharp",!0);ne(oe,pe,ft,"","\\diamondsuit",!0);ne(oe,pe,ft,"","\\Re",!0);ne(oe,pe,ft,"","\\heartsuit",!0);ne(oe,pe,ft,"","\\Im",!0);ne(oe,pe,ft,"","\\spadesuit",!0);ne(oe,pe,ft,"","\\S",!0);ne(Zt,pe,ft,"","\\S");ne(oe,pe,ft,"","\\P",!0);ne(Zt,pe,ft,"","\\P");ne(oe,pe,ft,"","\\dag");ne(Zt,pe,ft,"","\\dag");ne(Zt,pe,ft,"","\\textdagger");ne(oe,pe,ft,"","\\ddag");ne(Zt,pe,ft,"","\\ddag");ne(Zt,pe,ft,"","\\textdaggerdbl");ne(oe,pe,tl,"","\\rmoustache",!0);ne(oe,pe,rc,"","\\lmoustache",!0);ne(oe,pe,tl,"","\\rgroup",!0);ne(oe,pe,rc,"","\\lgroup",!0);ne(oe,pe,Ir,"","\\mp",!0);ne(oe,pe,Ir,"","\\ominus",!0);ne(oe,pe,Ir,"","\\uplus",!0);ne(oe,pe,Ir,"","\\sqcap",!0);ne(oe,pe,Ir,"","\\ast");ne(oe,pe,Ir,"","\\sqcup",!0);ne(oe,pe,Ir,"","\\bigcirc",!0);ne(oe,pe,Ir,"","\\bullet",!0);ne(oe,pe,Ir,"","\\ddagger");ne(oe,pe,Ir,"","\\wr",!0);ne(oe,pe,Ir,"","\\amalg");ne(oe,pe,Ir,"&","\\And");ne(oe,pe,Ke,"","\\longleftarrow",!0);ne(oe,pe,Ke,"","\\Leftarrow",!0);ne(oe,pe,Ke,"","\\Longleftarrow",!0);ne(oe,pe,Ke,"","\\longrightarrow",!0);ne(oe,pe,Ke,"","\\Rightarrow",!0);ne(oe,pe,Ke,"","\\Longrightarrow",!0);ne(oe,pe,Ke,"","\\leftrightarrow",!0);ne(oe,pe,Ke,"","\\longleftrightarrow",!0);ne(oe,pe,Ke,"","\\Leftrightarrow",!0);ne(oe,pe,Ke,"","\\Longleftrightarrow",!0);ne(oe,pe,Ke,"","\\mapsto",!0);ne(oe,pe,Ke,"","\\longmapsto",!0);ne(oe,pe,Ke,"","\\nearrow",!0);ne(oe,pe,Ke,"","\\hookleftarrow",!0);ne(oe,pe,Ke,"","\\hookrightarrow",!0);ne(oe,pe,Ke,"","\\searrow",!0);ne(oe,pe,Ke,"","\\leftharpoonup",!0);ne(oe,pe,Ke,"","\\rightharpoonup",!0);ne(oe,pe,Ke,"","\\swarrow",!0);ne(oe,pe,Ke,"","\\leftharpoondown",!0);ne(oe,pe,Ke,"","\\rightharpoondown",!0);ne(oe,pe,Ke,"","\\nwarrow",!0);ne(oe,pe,Ke,"","\\rightleftharpoons",!0);ne(oe,We,Ke,"","\\nless",!0);ne(oe,We,Ke,"","\\@nleqslant");ne(oe,We,Ke,"","\\@nleqq");ne(oe,We,Ke,"","\\lneq",!0);ne(oe,We,Ke,"","\\lneqq",!0);ne(oe,We,Ke,"","\\@lvertneqq");ne(oe,We,Ke,"","\\lnsim",!0);ne(oe,We,Ke,"","\\lnapprox",!0);ne(oe,We,Ke,"","\\nprec",!0);ne(oe,We,Ke,"","\\npreceq",!0);ne(oe,We,Ke,"","\\precnsim",!0);ne(oe,We,Ke,"","\\precnapprox",!0);ne(oe,We,Ke,"","\\nsim",!0);ne(oe,We,Ke,"","\\@nshortmid");ne(oe,We,Ke,"","\\nmid",!0);ne(oe,We,Ke,"","\\nvdash",!0);ne(oe,We,Ke,"","\\nvDash",!0);ne(oe,We,Ke,"","\\ntriangleleft");ne(oe,We,Ke,"","\\ntrianglelefteq",!0);ne(oe,We,Ke,"","\\subsetneq",!0);ne(oe,We,Ke,"","\\@varsubsetneq");ne(oe,We,Ke,"","\\subsetneqq",!0);ne(oe,We,Ke,"","\\@varsubsetneqq");ne(oe,We,Ke,"","\\ngtr",!0);ne(oe,We,Ke,"","\\@ngeqslant");ne(oe,We,Ke,"","\\@ngeqq");ne(oe,We,Ke,"","\\gneq",!0);ne(oe,We,Ke,"","\\gneqq",!0);ne(oe,We,Ke,"","\\@gvertneqq");ne(oe,We,Ke,"","\\gnsim",!0);ne(oe,We,Ke,"","\\gnapprox",!0);ne(oe,We,Ke,"","\\nsucc",!0);ne(oe,We,Ke,"","\\nsucceq",!0);ne(oe,We,Ke,"","\\succnsim",!0);ne(oe,We,Ke,"","\\succnapprox",!0);ne(oe,We,Ke,"","\\ncong",!0);ne(oe,We,Ke,"","\\@nshortparallel");ne(oe,We,Ke,"","\\nparallel",!0);ne(oe,We,Ke,"","\\nVDash",!0);ne(oe,We,Ke,"","\\ntriangleright");ne(oe,We,Ke,"","\\ntrianglerighteq",!0);ne(oe,We,Ke,"","\\@nsupseteqq");ne(oe,We,Ke,"","\\supsetneq",!0);ne(oe,We,Ke,"","\\@varsupsetneq");ne(oe,We,Ke,"","\\supsetneqq",!0);ne(oe,We,Ke,"","\\@varsupsetneqq");ne(oe,We,Ke,"","\\nVdash",!0);ne(oe,We,Ke,"","\\precneqq",!0);ne(oe,We,Ke,"","\\succneqq",!0);ne(oe,We,Ke,"","\\@nsubseteqq");ne(oe,We,Ir,"","\\unlhd");ne(oe,We,Ir,"","\\unrhd");ne(oe,We,Ke,"","\\nleftarrow",!0);ne(oe,We,Ke,"","\\nrightarrow",!0);ne(oe,We,Ke,"","\\nLeftarrow",!0);ne(oe,We,Ke,"","\\nRightarrow",!0);ne(oe,We,Ke,"","\\nleftrightarrow",!0);ne(oe,We,Ke,"","\\nLeftrightarrow",!0);ne(oe,We,Ke,"","\\vartriangle");ne(oe,We,ft,"","\\hslash");ne(oe,We,ft,"","\\triangledown");ne(oe,We,ft,"","\\lozenge");ne(oe,We,ft,"","\\circledS");ne(oe,We,ft,"","\\circledR");ne(Zt,We,ft,"","\\circledR");ne(oe,We,ft,"","\\measuredangle",!0);ne(oe,We,ft,"","\\nexists");ne(oe,We,ft,"","\\mho");ne(oe,We,ft,"","\\Finv",!0);ne(oe,We,ft,"","\\Game",!0);ne(oe,We,ft,"","\\backprime");ne(oe,We,ft,"","\\blacktriangle");ne(oe,We,ft,"","\\blacktriangledown");ne(oe,We,ft,"","\\blacksquare");ne(oe,We,ft,"","\\blacklozenge");ne(oe,We,ft,"","\\bigstar");ne(oe,We,ft,"","\\sphericalangle",!0);ne(oe,We,ft,"","\\complement",!0);ne(oe,We,ft,"","\\eth",!0);ne(Zt,pe,ft,"","");ne(oe,We,ft,"","\\diagup");ne(oe,We,ft,"","\\diagdown");ne(oe,We,ft,"","\\square");ne(oe,We,ft,"","\\Box");ne(oe,We,ft,"","\\Diamond");ne(oe,We,ft,"","\\yen",!0);ne(Zt,We,ft,"","\\yen",!0);ne(oe,We,ft,"","\\checkmark",!0);ne(Zt,We,ft,"","\\checkmark");ne(oe,We,ft,"","\\beth",!0);ne(oe,We,ft,"","\\daleth",!0);ne(oe,We,ft,"","\\gimel",!0);ne(oe,We,ft,"","\\digamma",!0);ne(oe,We,ft,"","\\varkappa");ne(oe,We,rc,"","\\@ulcorner",!0);ne(oe,We,tl,"","\\@urcorner",!0);ne(oe,We,rc,"","\\@llcorner",!0);ne(oe,We,tl,"","\\@lrcorner",!0);ne(oe,We,Ke,"","\\leqq",!0);ne(oe,We,Ke,"","\\leqslant",!0);ne(oe,We,Ke,"","\\eqslantless",!0);ne(oe,We,Ke,"","\\lesssim",!0);ne(oe,We,Ke,"","\\lessapprox",!0);ne(oe,We,Ke,"","\\approxeq",!0);ne(oe,We,Ir,"","\\lessdot");ne(oe,We,Ke,"","\\lll",!0);ne(oe,We,Ke,"","\\lessgtr",!0);ne(oe,We,Ke,"","\\lesseqgtr",!0);ne(oe,We,Ke,"","\\lesseqqgtr",!0);ne(oe,We,Ke,"","\\doteqdot");ne(oe,We,Ke,"","\\risingdotseq",!0);ne(oe,We,Ke,"","\\fallingdotseq",!0);ne(oe,We,Ke,"","\\backsim",!0);ne(oe,We,Ke,"","\\backsimeq",!0);ne(oe,We,Ke,"","\\subseteqq",!0);ne(oe,We,Ke,"","\\Subset",!0);ne(oe,We,Ke,"","\\sqsubset",!0);ne(oe,We,Ke,"","\\preccurlyeq",!0);ne(oe,We,Ke,"","\\curlyeqprec",!0);ne(oe,We,Ke,"","\\precsim",!0);ne(oe,We,Ke,"","\\precapprox",!0);ne(oe,We,Ke,"","\\vartriangleleft");ne(oe,We,Ke,"","\\trianglelefteq");ne(oe,We,Ke,"","\\vDash",!0);ne(oe,We,Ke,"","\\Vvdash",!0);ne(oe,We,Ke,"","\\smallsmile");ne(oe,We,Ke,"","\\smallfrown");ne(oe,We,Ke,"","\\bumpeq",!0);ne(oe,We,Ke,"","\\Bumpeq",!0);ne(oe,We,Ke,"","\\geqq",!0);ne(oe,We,Ke,"","\\geqslant",!0);ne(oe,We,Ke,"","\\eqslantgtr",!0);ne(oe,We,Ke,"","\\gtrsim",!0);ne(oe,We,Ke,"","\\gtrapprox",!0);ne(oe,We,Ir,"","\\gtrdot");ne(oe,We,Ke,"","\\ggg",!0);ne(oe,We,Ke,"","\\gtrless",!0);ne(oe,We,Ke,"","\\gtreqless",!0);ne(oe,We,Ke,"","\\gtreqqless",!0);ne(oe,We,Ke,"","\\eqcirc",!0);ne(oe,We,Ke,"","\\circeq",!0);ne(oe,We,Ke,"","\\triangleq",!0);ne(oe,We,Ke,"","\\thicksim");ne(oe,We,Ke,"","\\thickapprox");ne(oe,We,Ke,"","\\supseteqq",!0);ne(oe,We,Ke,"","\\Supset",!0);ne(oe,We,Ke,"","\\sqsupset",!0);ne(oe,We,Ke,"","\\succcurlyeq",!0);ne(oe,We,Ke,"","\\curlyeqsucc",!0);ne(oe,We,Ke,"","\\succsim",!0);ne(oe,We,Ke,"","\\succapprox",!0);ne(oe,We,Ke,"","\\vartriangleright");ne(oe,We,Ke,"","\\trianglerighteq");ne(oe,We,Ke,"","\\Vdash",!0);ne(oe,We,Ke,"","\\shortmid");ne(oe,We,Ke,"","\\shortparallel");ne(oe,We,Ke,"","\\between",!0);ne(oe,We,Ke,"","\\pitchfork",!0);ne(oe,We,Ke,"","\\varpropto");ne(oe,We,Ke,"","\\blacktriangleleft");ne(oe,We,Ke,"","\\therefore",!0);ne(oe,We,Ke,"","\\backepsilon");ne(oe,We,Ke,"","\\blacktriangleright");ne(oe,We,Ke,"","\\because",!0);ne(oe,We,Ke,"","\\llless");ne(oe,We,Ke,"","\\gggtr");ne(oe,We,Ir,"","\\lhd");ne(oe,We,Ir,"","\\rhd");ne(oe,We,Ke,"","\\eqsim",!0);ne(oe,pe,Ke,"","\\Join");ne(oe,We,Ke,"","\\Doteq",!0);ne(oe,We,Ir,"","\\dotplus",!0);ne(oe,We,Ir,"","\\smallsetminus");ne(oe,We,Ir,"","\\Cap",!0);ne(oe,We,Ir,"","\\Cup",!0);ne(oe,We,Ir,"","\\doublebarwedge",!0);ne(oe,We,Ir,"","\\boxminus",!0);ne(oe,We,Ir,"","\\boxplus",!0);ne(oe,We,Ir,"","\\divideontimes",!0);ne(oe,We,Ir,"","\\ltimes",!0);ne(oe,We,Ir,"","\\rtimes",!0);ne(oe,We,Ir,"","\\leftthreetimes",!0);ne(oe,We,Ir,"","\\rightthreetimes",!0);ne(oe,We,Ir,"","\\curlywedge",!0);ne(oe,We,Ir,"","\\curlyvee",!0);ne(oe,We,Ir,"","\\circleddash",!0);ne(oe,We,Ir,"","\\circledast",!0);ne(oe,We,Ir,"","\\centerdot");ne(oe,We,Ir,"","\\intercal",!0);ne(oe,We,Ir,"","\\doublecap");ne(oe,We,Ir,"","\\doublecup");ne(oe,We,Ir,"","\\boxtimes",!0);ne(oe,We,Ke,"","\\dashrightarrow",!0);ne(oe,We,Ke,"","\\dashleftarrow",!0);ne(oe,We,Ke,"","\\leftleftarrows",!0);ne(oe,We,Ke,"","\\leftrightarrows",!0);ne(oe,We,Ke,"","\\Lleftarrow",!0);ne(oe,We,Ke,"","\\twoheadleftarrow",!0);ne(oe,We,Ke,"","\\leftarrowtail",!0);ne(oe,We,Ke,"","\\looparrowleft",!0);ne(oe,We,Ke,"","\\leftrightharpoons",!0);ne(oe,We,Ke,"","\\curvearrowleft",!0);ne(oe,We,Ke,"","\\circlearrowleft",!0);ne(oe,We,Ke,"","\\Lsh",!0);ne(oe,We,Ke,"","\\upuparrows",!0);ne(oe,We,Ke,"","\\upharpoonleft",!0);ne(oe,We,Ke,"","\\downharpoonleft",!0);ne(oe,pe,Ke,"","\\origof",!0);ne(oe,pe,Ke,"","\\imageof",!0);ne(oe,We,Ke,"","\\multimap",!0);ne(oe,We,Ke,"","\\leftrightsquigarrow",!0);ne(oe,We,Ke,"","\\rightrightarrows",!0);ne(oe,We,Ke,"","\\rightleftarrows",!0);ne(oe,We,Ke,"","\\twoheadrightarrow",!0);ne(oe,We,Ke,"","\\rightarrowtail",!0);ne(oe,We,Ke,"","\\looparrowright",!0);ne(oe,We,Ke,"","\\curvearrowright",!0);ne(oe,We,Ke,"","\\circlearrowright",!0);ne(oe,We,Ke,"","\\Rsh",!0);ne(oe,We,Ke,"","\\downdownarrows",!0);ne(oe,We,Ke,"","\\upharpoonright",!0);ne(oe,We,Ke,"","\\downharpoonright",!0);ne(oe,We,Ke,"","\\rightsquigarrow",!0);ne(oe,We,Ke,"","\\leadsto");ne(oe,We,Ke,"","\\Rrightarrow",!0);ne(oe,We,Ke,"","\\restriction");ne(oe,pe,ft,"","`");ne(oe,pe,ft,"$","\\$");ne(Zt,pe,ft,"$","\\$");ne(Zt,pe,ft,"$","\\textdollar");ne(oe,pe,ft,"%","\\%");ne(Zt,pe,ft,"%","\\%");ne(oe,pe,ft,"_","\\_");ne(Zt,pe,ft,"_","\\_");ne(Zt,pe,ft,"_","\\textunderscore");ne(oe,pe,ft,"","\\angle",!0);ne(oe,pe,ft,"","\\infty",!0);ne(oe,pe,ft,"","\\prime");ne(oe,pe,ft,"","\\triangle");ne(oe,pe,ft,"","\\Gamma",!0);ne(oe,pe,ft,"","\\Delta",!0);ne(oe,pe,ft,"","\\Theta",!0);ne(oe,pe,ft,"","\\Lambda",!0);ne(oe,pe,ft,"","\\Xi",!0);ne(oe,pe,ft,"","\\Pi",!0);ne(oe,pe,ft,"","\\Sigma",!0);ne(oe,pe,ft,"","\\Upsilon",!0);ne(oe,pe,ft,"","\\Phi",!0);ne(oe,pe,ft,"","\\Psi",!0);ne(oe,pe,ft,"","\\Omega",!0);ne(oe,pe,ft,"A","");ne(oe,pe,ft,"B","");ne(oe,pe,ft,"E","");ne(oe,pe,ft,"Z","");ne(oe,pe,ft,"H","");ne(oe,pe,ft,"I","");ne(oe,pe,ft,"K","");ne(oe,pe,ft,"M","");ne(oe,pe,ft,"N","");ne(oe,pe,ft,"O","");ne(oe,pe,ft,"P","");ne(oe,pe,ft,"T","");ne(oe,pe,ft,"X","");ne(oe,pe,ft,"","\\neg",!0);ne(oe,pe,ft,"","\\lnot");ne(oe,pe,ft,"","\\top");ne(oe,pe,ft,"","\\bot");ne(oe,pe,ft,"","\\emptyset");ne(oe,We,ft,"","\\varnothing");ne(oe,pe,nn,"","\\alpha",!0);ne(oe,pe,nn,"","\\beta",!0);ne(oe,pe,nn,"","\\gamma",!0);ne(oe,pe,nn,"","\\delta",!0);ne(oe,pe,nn,"","\\epsilon",!0);ne(oe,pe,nn,"","\\zeta",!0);ne(oe,pe,nn,"","\\eta",!0);ne(oe,pe,nn,"","\\theta",!0);ne(oe,pe,nn,"","\\iota",!0);ne(oe,pe,nn,"","\\kappa",!0);ne(oe,pe,nn,"","\\lambda",!0);ne(oe,pe,nn,"","\\mu",!0);ne(oe,pe,nn,"","\\nu",!0);ne(oe,pe,nn,"","\\xi",!0);ne(oe,pe,nn,"","\\omicron",!0);ne(oe,pe,nn,"","\\pi",!0);ne(oe,pe,nn,"","\\rho",!0);ne(oe,pe,nn,"","\\sigma",!0);ne(oe,pe,nn,"","\\tau",!0);ne(oe,pe,nn,"","\\upsilon",!0);ne(oe,pe,nn,"","\\phi",!0);ne(oe,pe,nn,"","\\chi",!0);ne(oe,pe,nn,"","\\psi",!0);ne(oe,pe,nn,"","\\omega",!0);ne(oe,pe,nn,"","\\varepsilon",!0);ne(oe,pe,nn,"","\\vartheta",!0);ne(oe,pe,nn,"","\\varpi",!0);ne(oe,pe,nn,"","\\varrho",!0);ne(oe,pe,nn,"","\\varsigma",!0);ne(oe,pe,nn,"","\\varphi",!0);ne(oe,pe,Ir,"","*",!0);ne(oe,pe,Ir,"+","+");ne(oe,pe,Ir,"","-",!0);ne(oe,pe,Ir,"","\\cdot",!0);ne(oe,pe,Ir,"","\\circ",!0);ne(oe,pe,Ir,"","\\div",!0);ne(oe,pe,Ir,"","\\pm",!0);ne(oe,pe,Ir,"","\\times",!0);ne(oe,pe,Ir,"","\\cap",!0);ne(oe,pe,Ir,"","\\cup",!0);ne(oe,pe,Ir,"","\\setminus",!0);ne(oe,pe,Ir,"","\\land");ne(oe,pe,Ir,"","\\lor");ne(oe,pe,Ir,"","\\wedge",!0);ne(oe,pe,Ir,"","\\vee",!0);ne(oe,pe,ft,"","\\surd");ne(oe,pe,rc,"","\\langle",!0);ne(oe,pe,rc,"","\\lvert");ne(oe,pe,rc,"","\\lVert");ne(oe,pe,tl,"?","?");ne(oe,pe,tl,"!","!");ne(oe,pe,tl,"","\\rangle",!0);ne(oe,pe,tl,"","\\rvert");ne(oe,pe,tl,"","\\rVert");ne(oe,pe,Ke,"=","=");ne(oe,pe,Ke,":",":");ne(oe,pe,Ke,"","\\approx",!0);ne(oe,pe,Ke,"","\\cong",!0);ne(oe,pe,Ke,"","\\ge");ne(oe,pe,Ke,"","\\geq",!0);ne(oe,pe,Ke,"","\\gets");ne(oe,pe,Ke,">","\\gt",!0);ne(oe,pe,Ke,"","\\in",!0);ne(oe,pe,Ke,"","\\@not");ne(oe,pe,Ke,"","\\subset",!0);ne(oe,pe,Ke,"","\\supset",!0);ne(oe,pe,Ke,"","\\subseteq",!0);ne(oe,pe,Ke,"","\\supseteq",!0);ne(oe,We,Ke,"","\\nsubseteq",!0);ne(oe,We,Ke,"","\\nsupseteq",!0);ne(oe,pe,Ke,"","\\models");ne(oe,pe,Ke,"","\\leftarrow",!0);ne(oe,pe,Ke,"","\\le");ne(oe,pe,Ke,"","\\leq",!0);ne(oe,pe,Ke,"<","\\lt",!0);ne(oe,pe,Ke,"","\\rightarrow",!0);ne(oe,pe,Ke,"","\\to");ne(oe,We,Ke,"","\\ngeq",!0);ne(oe,We,Ke,"","\\nleq",!0);ne(oe,pe,R0,"","\\ ");ne(oe,pe,R0,"","\\space");ne(oe,pe,R0,"","\\nobreakspace");ne(Zt,pe,R0,"","\\ ");ne(Zt,pe,R0,""," ");ne(Zt,pe,R0,"","\\space");ne(Zt,pe,R0,"","\\nobreakspace");ne(oe,pe,R0,null,"\\nobreak");ne(oe,pe,R0,null,"\\allowbreak");ne(oe,pe,CS,",",",");ne(oe,pe,CS,";",";");ne(oe,We,Ir,"","\\barwedge",!0);ne(oe,We,Ir,"","\\veebar",!0);ne(oe,pe,Ir,"","\\odot",!0);ne(oe,pe,Ir,"","\\oplus",!0);ne(oe,pe,Ir,"","\\otimes",!0);ne(oe,pe,ft,"","\\partial",!0);ne(oe,pe,Ir,"","\\oslash",!0);ne(oe,We,Ir,"","\\circledcirc",!0);ne(oe,We,Ir,"","\\boxdot",!0);ne(oe,pe,Ir,"","\\bigtriangleup");ne(oe,pe,Ir,"","\\bigtriangledown");ne(oe,pe,Ir,"","\\dagger");ne(oe,pe,Ir,"","\\diamond");ne(oe,pe,Ir,"","\\star");ne(oe,pe,Ir,"","\\triangleleft");ne(oe,pe,Ir,"","\\triangleright");ne(oe,pe,rc,"{","\\{");ne(Zt,pe,ft,"{","\\{");ne(Zt,pe,ft,"{","\\textbraceleft");ne(oe,pe,tl,"}","\\}");ne(Zt,pe,ft,"}","\\}");ne(Zt,pe,ft,"}","\\textbraceright");ne(oe,pe,rc,"{","\\lbrace");ne(oe,pe,tl,"}","\\rbrace");ne(oe,pe,rc,"[","\\lbrack",!0);ne(Zt,pe,ft,"[","\\lbrack",!0);ne(oe,pe,tl,"]","\\rbrack",!0);ne(Zt,pe,ft,"]","\\rbrack",!0);ne(oe,pe,rc,"(","\\lparen",!0);ne(oe,pe,tl,")","\\rparen",!0);ne(Zt,pe,ft,"<","\\textless",!0);ne(Zt,pe,ft,">","\\textgreater",!0);ne(oe,pe,rc,"","\\lfloor",!0);ne(oe,pe,tl,"","\\rfloor",!0);ne(oe,pe,rc,"","\\lceil",!0);ne(oe,pe,tl,"","\\rceil",!0);ne(oe,pe,ft,"\\","\\backslash");ne(oe,pe,ft,"","|");ne(oe,pe,ft,"","\\vert");ne(Zt,pe,ft,"|","\\textbar",!0);ne(oe,pe,ft,"","\\|");ne(oe,pe,ft,"","\\Vert");ne(Zt,pe,ft,"","\\textbardbl");ne(Zt,pe,ft,"~","\\textasciitilde");ne(Zt,pe,ft,"\\","\\textbackslash");ne(Zt,pe,ft,"^","\\textasciicircum");ne(oe,pe,Ke,"","\\uparrow",!0);ne(oe,pe,Ke,"","\\Uparrow",!0);ne(oe,pe,Ke,"","\\downarrow",!0);ne(oe,pe,Ke,"","\\Downarrow",!0);ne(oe,pe,Ke,"","\\updownarrow",!0);ne(oe,pe,Ke,"","\\Updownarrow",!0);ne(oe,pe,ei,"","\\coprod");ne(oe,pe,ei,"","\\bigvee");ne(oe,pe,ei,"","\\bigwedge");ne(oe,pe,ei,"","\\biguplus");ne(oe,pe,ei,"","\\bigcap");ne(oe,pe,ei,"","\\bigcup");ne(oe,pe,ei,"","\\int");ne(oe,pe,ei,"","\\intop");ne(oe,pe,ei,"","\\iint");ne(oe,pe,ei,"","\\iiint");ne(oe,pe,ei,"","\\prod");ne(oe,pe,ei,"","\\sum");ne(oe,pe,ei,"","\\bigotimes");ne(oe,pe,ei,"","\\bigoplus");ne(oe,pe,ei,"","\\bigodot");ne(oe,pe,ei,"","\\oint");ne(oe,pe,ei,"","\\oiint");ne(oe,pe,ei,"","\\oiiint");ne(oe,pe,ei,"","\\bigsqcup");ne(oe,pe,ei,"","\\smallint");ne(Zt,pe,R1,"","\\textellipsis");ne(oe,pe,R1,"","\\mathellipsis");ne(Zt,pe,R1,"","\\ldots",!0);ne(oe,pe,R1,"","\\ldots",!0);ne(oe,pe,R1,"","\\@cdots",!0);ne(oe,pe,R1,"","\\ddots",!0);ne(oe,pe,ft,"","\\varvdots");ne(Zt,pe,ft,"","\\varvdots");ne(oe,pe,ea,"","\\acute");ne(oe,pe,ea,"","\\grave");ne(oe,pe,ea,"","\\ddot");ne(oe,pe,ea,"~","\\tilde");ne(oe,pe,ea,"","\\bar");ne(oe,pe,ea,"","\\breve");ne(oe,pe,ea,"","\\check");ne(oe,pe,ea,"^","\\hat");ne(oe,pe,ea,"","\\vec");ne(oe,pe,ea,"","\\dot");ne(oe,pe,ea,"","\\mathring");ne(oe,pe,nn,"","\\@imath");ne(oe,pe,nn,"","\\@jmath");ne(oe,pe,ft,"","");ne(oe,pe,ft,"","");ne(Zt,pe,ft,"","\\i",!0);ne(Zt,pe,ft,"","\\j",!0);ne(Zt,pe,ft,"","\\ss",!0);ne(Zt,pe,ft,"","\\ae",!0);ne(Zt,pe,ft,"","\\oe",!0);ne(Zt,pe,ft,"","\\o",!0);ne(Zt,pe,ft,"","\\AE",!0);ne(Zt,pe,ft,"","\\OE",!0);ne(Zt,pe,ft,"","\\O",!0);ne(Zt,pe,ea,"","\\'");ne(Zt,pe,ea,"","\\`");ne(Zt,pe,ea,"","\\^");ne(Zt,pe,ea,"","\\~");ne(Zt,pe,ea,"","\\=");ne(Zt,pe,ea,"","\\u");ne(Zt,pe,ea,"","\\.");ne(Zt,pe,ea,"","\\c");ne(Zt,pe,ea,"","\\r");ne(Zt,pe,ea,"","\\v");ne(Zt,pe,ea,"",'\\"');ne(Zt,pe,ea,"","\\H");ne(Zt,pe,ea,"","\\textcircled");var EW={"--":!0,"---":!0,"``":!0,"''":!0};ne(Zt,pe,ft,"","--",!0);ne(Zt,pe,ft,"","\\textendash");ne(Zt,pe,ft,"","---",!0);ne(Zt,pe,ft,"","\\textemdash");ne(Zt,pe,ft,"","`",!0);ne(Zt,pe,ft,"","\\textquoteleft");ne(Zt,pe,ft,"","'",!0);ne(Zt,pe,ft,"","\\textquoteright");ne(Zt,pe,ft,"","``",!0);ne(Zt,pe,ft,"","\\textquotedblleft");ne(Zt,pe,ft,"","''",!0);ne(Zt,pe,ft,"","\\textquotedblright");ne(oe,pe,ft,"","\\degree",!0);ne(Zt,pe,ft,"","\\degree");ne(Zt,pe,ft,"","\\textdegree",!0);ne(oe,pe,ft,"","\\pounds");ne(oe,pe,ft,"","\\mathsterling",!0);ne(Zt,pe,ft,"","\\pounds");ne(Zt,pe,ft,"","\\textsterling",!0);ne(oe,We,ft,"","\\maltese");ne(Zt,We,ft,"","\\maltese");var KP='0123456789/@."';for(var B5=0;B5<KP.length;B5++){var YP=KP.charAt(B5);ne(oe,pe,ft,YP,YP)}var XP='0123456789!@*()-=+";:?/.,';for(var $5=0;$5<XP.length;$5++){var JP=XP.charAt($5);ne(Zt,pe,ft,JP,JP)}var Q4="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var U5=0;U5<Q4.length;U5++){var Tw=Q4.charAt(U5);ne(oe,pe,nn,Tw,Tw),ne(Zt,pe,ft,Tw,Tw)}ne(oe,We,ft,"C","");ne(Zt,We,ft,"C","");ne(oe,We,ft,"H","");ne(Zt,We,ft,"H","");ne(oe,We,ft,"N","");ne(Zt,We,ft,"N","");ne(oe,We,ft,"P","");ne(Zt,We,ft,"P","");ne(oe,We,ft,"Q","");ne(Zt,We,ft,"Q","");ne(oe,We,ft,"R","");ne(Zt,We,ft,"R","");ne(oe,We,ft,"Z","");ne(Zt,We,ft,"Z","");ne(oe,pe,nn,"h","");ne(Zt,pe,nn,"h","");var un="";for(var Ho=0;Ho<Q4.length;Ho++){var pa=Q4.charAt(Ho);un=String.fromCharCode(55349,56320+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56372+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56424+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56580+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56684+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56736+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56788+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56840+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56944+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),Ho<26&&(un=String.fromCharCode(55349,56632+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un),un=String.fromCharCode(55349,56476+Ho),ne(oe,pe,nn,pa,un),ne(Zt,pe,ft,pa,un))}un="";ne(oe,pe,nn,"k",un);ne(Zt,pe,ft,"k",un);for(var im=0;im<10;im++){var jf=im.toString();un=String.fromCharCode(55349,57294+im),ne(oe,pe,nn,jf,un),ne(Zt,pe,ft,jf,un),un=String.fromCharCode(55349,57314+im),ne(oe,pe,nn,jf,un),ne(Zt,pe,ft,jf,un),un=String.fromCharCode(55349,57324+im),ne(oe,pe,nn,jf,un),ne(Zt,pe,ft,jf,un),un=String.fromCharCode(55349,57334+im),ne(oe,pe,nn,jf,un),ne(Zt,pe,ft,jf,un)}var vT="";for(var z5=0;z5<vT.length;z5++){var Nw=vT.charAt(z5);ne(oe,pe,nn,Nw,Nw),ne(Zt,pe,ft,Nw,Nw)}var Ew=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],QP=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],ioe=function(t,r){var n=t.charCodeAt(0),s=t.charCodeAt(1),a=(n-55296)*1024+(s-56320)+65536,i=r==="math"?0:1;if(119808<=a&&a<120484){var o=Math.floor((a-119808)/26);return[Ew[o][2],Ew[o][i]]}else if(120782<=a&&a<=120831){var c=Math.floor((a-120782)/10);return[QP[c][2],QP[c][i]]}else{if(a===120485||a===120486)return[Ew[0][2],Ew[0][i]];if(120486<a&&a<120782)return["",""];throw new ir("Unsupported character: "+t)}},TS=function(t,r,n){return Is[n][t]&&Is[n][t].replace&&(t=Is[n][t].replace),{value:t,metrics:aN(t,r,n)}},fu=function(t,r,n,s,a){var i=TS(t,r,n),o=i.metrics;t=i.value;var c;if(o){var u=o.italic;(n==="text"||s&&s.font==="mathit")&&(u=0),c=new Oc(t,o.height,o.depth,u,o.skew,o.width,a)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+t+"' in style '"+r+"' and mode '"+n+"'")),c=new Oc(t,0,0,0,0,0,a);if(s){c.maxFontSize=s.sizeMultiplier,s.style.isTight()&&c.classes.push("mtight");var d=s.getColor();d&&(c.style.color=d)}return c},ooe=function(t,r,n,s){return s===void 0&&(s=[]),n.font==="boldsymbol"&&TS(t,"Main-Bold",r).metrics?fu(t,"Main-Bold",r,n,s.concat(["mathbf"])):t==="\\"||Is[r][t].font==="main"?fu(t,"Main-Regular",r,n,s):fu(t,"AMS-Regular",r,n,s.concat(["amsrm"]))},loe=function(t,r,n,s,a){return a!=="textord"&&TS(t,"Math-BoldItalic",r).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},coe=function(t,r,n){var s=t.mode,a=t.text,i=["mord"],o=s==="math"||s==="text"&&r.font,c=o?r.font:r.fontFamily,u="",d="";if(a.charCodeAt(0)===55349&&([u,d]=ioe(a,s)),u.length>0)return fu(a,u,s,r,i.concat(d));if(c){var f,h;if(c==="boldsymbol"){var g=loe(a,s,r,i,n);f=g.fontName,h=[g.fontClass]}else o?(f=PW[c].fontName,h=[c]):(f=Aw(c,r.fontWeight,r.fontShape),h=[c,r.fontWeight,r.fontShape]);if(TS(a,f,s).metrics)return fu(a,f,s,r,i.concat(h));if(EW.hasOwnProperty(a)&&f.slice(0,10)==="Typewriter"){for(var p=[],x=0;x<a.length;x++)p.push(fu(a[x],f,s,r,i.concat(h)));return jW(p)}}if(n==="mathord")return fu(a,"Math-Italic",s,r,i.concat(["mathnormal"]));if(n==="textord"){var v=Is[s][a]&&Is[s][a].font;if(v==="ams"){var C=Aw("amsrm",r.fontWeight,r.fontShape);return fu(a,C,s,r,i.concat("amsrm",r.fontWeight,r.fontShape))}else if(v==="main"||!v){var b=Aw("textrm",r.fontWeight,r.fontShape);return fu(a,b,s,r,i.concat(r.fontWeight,r.fontShape))}else{var _=Aw(v,r.fontWeight,r.fontShape);return fu(a,_,s,r,i.concat(_,r.fontWeight,r.fontShape))}}else throw new Error("unexpected type: "+n+" in makeOrd")},uoe=(e,t)=>{if(nh(e.classes)!==nh(t.classes)||e.skew!==t.skew||e.maxFontSize!==t.maxFontSize)return!1;if(e.classes.length===1){var r=e.classes[0];if(r==="mbin"||r==="mord")return!1}for(var n in e.style)if(e.style.hasOwnProperty(n)&&e.style[n]!==t.style[n])return!1;for(var s in t.style)if(t.style.hasOwnProperty(s)&&e.style[s]!==t.style[s])return!1;return!0},doe=e=>{for(var t=0;t<e.length-1;t++){var r=e[t],n=e[t+1];r instanceof Oc&&n instanceof Oc&&uoe(r,n)&&(r.text+=n.text,r.height=Math.max(r.height,n.height),r.depth=Math.max(r.depth,n.depth),r.italic=n.italic,e.splice(t+1,1),t--)}return e},oN=function(t){for(var r=0,n=0,s=0,a=0;a<t.children.length;a++){var i=t.children[a];i.height>r&&(r=i.height),i.depth>n&&(n=i.depth),i.maxFontSize>s&&(s=i.maxFontSize)}t.height=r,t.depth=n,t.maxFontSize=s},ml=function(t,r,n,s){var a=new R2(t,r,n,s);return oN(a),a},AW=(e,t,r,n)=>new R2(e,t,r,n),foe=function(t,r,n){var s=ml([t],[],r);return s.height=Math.max(n||r.fontMetrics().defaultRuleThickness,r.minRuleThickness),s.style.borderBottomWidth=Sr(s.height),s.maxFontSize=1,s},hoe=function(t,r,n,s){var a=new iN(t,r,n,s);return oN(a),a},jW=function(t){var r=new M2(t);return oN(r),r},moe=function(t,r){return t instanceof M2?ml([],[t],r):t},goe=function(t){if(t.positionType==="individualShift"){for(var r=t.children,n=[r[0]],s=-r[0].shift-r[0].elem.depth,a=s,i=1;i<r.length;i++){var o=-r[i].shift-a-r[i].elem.depth,c=o-(r[i-1].elem.height+r[i-1].elem.depth);a=a+o,n.push({type:"kern",size:c}),n.push(r[i])}return{children:n,depth:s}}var u;if(t.positionType==="top"){for(var d=t.positionData,f=0;f<t.children.length;f++){var h=t.children[f];d-=h.type==="kern"?h.size:h.elem.height+h.elem.depth}u=d}else if(t.positionType==="bottom")u=-t.positionData;else{var g=t.children[0];if(g.type!=="elem")throw new Error('First child must have type "elem".');if(t.positionType==="shift")u=-g.elem.depth-t.positionData;else if(t.positionType==="firstBaseline")u=-g.elem.depth;else throw new Error("Invalid positionType "+t.positionType+".")}return{children:t.children,depth:u}},poe=function(t,r){for(var{children:n,depth:s}=goe(t),a=0,i=0;i<n.length;i++){var o=n[i];if(o.type==="elem"){var c=o.elem;a=Math.max(a,c.maxFontSize,c.height)}}a+=2;var u=ml(["pstrut"],[]);u.style.height=Sr(a);for(var d=[],f=s,h=s,g=s,p=0;p<n.length;p++){var x=n[p];if(x.type==="kern")g+=x.size;else{var v=x.elem,C=x.wrapperClasses||[],b=x.wrapperStyle||{},_=ml(C,[u,v],void 0,b);_.style.top=Sr(-a-g-v.depth),x.marginLeft&&(_.style.marginLeft=x.marginLeft),x.marginRight&&(_.style.marginRight=x.marginRight),d.push(_),g+=v.height+v.depth}f=Math.min(f,g),h=Math.max(h,g)}var T=ml(["vlist"],d);T.style.height=Sr(h);var N;if(f<0){var E=ml([],[]),F=ml(["vlist"],[E]);F.style.height=Sr(-f);var j=ml(["vlist-s"],[new Oc("")]);N=[ml(["vlist-r"],[T,j]),ml(["vlist-r"],[F])]}else N=[ml(["vlist-r"],[T])];var P=ml(["vlist-t"],N);return N.length===2&&P.classes.push("vlist-t2"),P.height=h,P.depth=-f,P},xoe=(e,t)=>{var r=ml(["mspace"],[],t),n=aa(e,t);return r.style.marginRight=Sr(n),r},Aw=function(t,r,n){var s="";switch(t){case"amsrm":s="AMS";break;case"textrm":s="Main";break;case"textsf":s="SansSerif";break;case"texttt":s="Typewriter";break;default:s=t}var a;return r==="textbf"&&n==="textit"?a="BoldItalic":r==="textbf"?a="Bold":r==="textit"?a="Italic":a="Regular",s+"-"+a},PW={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},FW={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},yoe=function(t,r){var[n,s,a]=FW[t],i=new sh(n),o=new S0([i],{width:Sr(s),height:Sr(a),style:"width:"+Sr(s),viewBox:"0 0 "+1e3*s+" "+1e3*a,preserveAspectRatio:"xMinYMin"}),c=AW(["overlay"],[o],r);return c.height=a,c.style.height=Sr(a),c.style.width=Sr(s),c},Nt={fontMap:PW,makeSymbol:fu,mathsym:ooe,makeSpan:ml,makeSvgSpan:AW,makeLineSpan:foe,makeAnchor:hoe,makeFragment:jW,wrapFragment:moe,makeVList:poe,makeOrd:coe,makeGlue:xoe,staticSvg:yoe,svgData:FW,tryCombineChars:doe},sa={number:3,unit:"mu"},om={number:4,unit:"mu"},Yd={number:5,unit:"mu"},voe={mord:{mop:sa,mbin:om,mrel:Yd,minner:sa},mop:{mord:sa,mop:sa,mrel:Yd,minner:sa},mbin:{mord:om,mop:om,mopen:om,minner:om},mrel:{mord:Yd,mop:Yd,mopen:Yd,minner:Yd},mopen:{},mclose:{mop:sa,mbin:om,mrel:Yd,minner:sa},mpunct:{mord:sa,mop:sa,mrel:Yd,mopen:sa,mclose:sa,mpunct:sa,minner:sa},minner:{mord:sa,mop:sa,mbin:om,mrel:Yd,mopen:sa,mpunct:sa,minner:sa}},boe={mord:{mop:sa},mop:{mord:sa,mop:sa},mbin:{},mrel:{},mopen:{},mclose:{mop:sa},mpunct:{},minner:{mop:sa}},MW={},Z4={},e_={};function Pr(e){for(var{type:t,names:r,props:n,handler:s,htmlBuilder:a,mathmlBuilder:i}=e,o={type:t,numArgs:n.numArgs,argTypes:n.argTypes,allowedInArgument:!!n.allowedInArgument,allowedInText:!!n.allowedInText,allowedInMath:n.allowedInMath===void 0?!0:n.allowedInMath,numOptionalArgs:n.numOptionalArgs||0,infix:!!n.infix,primitive:!!n.primitive,handler:s},c=0;c<r.length;++c)MW[r[c]]=o;t&&(a&&(Z4[t]=a),i&&(e_[t]=i))}function fg(e){var{type:t,htmlBuilder:r,mathmlBuilder:n}=e;Pr({type:t,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:r,mathmlBuilder:n})}var t_=function(t){return t.type==="ordgroup"&&t.body.length===1?t.body[0]:t},Da=function(t){return t.type==="ordgroup"?t.body:[t]},k0=Nt.makeSpan,woe=["leftmost","mbin","mopen","mrel","mop","mpunct"],_oe=["rightmost","mrel","mclose","mpunct"],Soe={display:sn.DISPLAY,text:sn.TEXT,script:sn.SCRIPT,scriptscript:sn.SCRIPTSCRIPT},koe={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},mi=function(t,r,n,s){s===void 0&&(s=[null,null]);for(var a=[],i=0;i<t.length;i++){var o=Gn(t[i],r);if(o instanceof M2){var c=o.children;a.push(...c)}else a.push(o)}if(Nt.tryCombineChars(a),!n)return a;var u=r;if(t.length===1){var d=t[0];d.type==="sizing"?u=r.havingSize(d.size):d.type==="styling"&&(u=r.havingStyle(Soe[d.style]))}var f=k0([s[0]||"leftmost"],[],r),h=k0([s[1]||"rightmost"],[],r),g=n==="root";return ZP(a,(p,x)=>{var v=x.classes[0],C=p.classes[0];v==="mbin"&&_oe.includes(C)?x.classes[0]="mord":C==="mbin"&&woe.includes(v)&&(p.classes[0]="mord")},{node:f},h,g),ZP(a,(p,x)=>{var v=bT(x),C=bT(p),b=v&&C?p.hasClass("mtight")?boe[v][C]:voe[v][C]:null;if(b)return Nt.makeGlue(b,u)},{node:f},h,g),a},ZP=function e(t,r,n,s,a){s&&t.push(s);for(var i=0;i<t.length;i++){var o=t[i],c=RW(o);if(c){e(c.children,r,n,null,a);continue}var u=!o.hasClass("mspace");if(u){var d=r(o,n.node);d&&(n.insertAfter?n.insertAfter(d):(t.unshift(d),i++))}u?n.node=o:a&&o.hasClass("newline")&&(n.node=k0(["leftmost"])),n.insertAfter=(f=>h=>{t.splice(f+1,0,h),i++})(i)}s&&t.pop()},RW=function(t){return t instanceof M2||t instanceof iN||t instanceof R2&&t.hasClass("enclosing")?t:null},Coe=function e(t,r){var n=RW(t);if(n){var s=n.children;if(s.length){if(r==="right")return e(s[s.length-1],"right");if(r==="left")return e(s[0],"left")}}return t},bT=function(t,r){return t?(r&&(t=Coe(t,r)),koe[t.classes[0]]||null):null},Vv=function(t,r){var n=["nulldelimiter"].concat(t.baseSizingClasses());return k0(r.concat(n))},Gn=function(t,r,n){if(!t)return k0();if(Z4[t.type]){var s=Z4[t.type](t,r);if(n&&r.size!==n.size){s=k0(r.sizingClasses(n),[s],r);var a=r.sizeMultiplier/n.sizeMultiplier;s.height*=a,s.depth*=a}return s}else throw new ir("Got group of unknown type: '"+t.type+"'")};function jw(e,t){var r=k0(["base"],e,t),n=k0(["strut"]);return n.style.height=Sr(r.height+r.depth),r.depth&&(n.style.verticalAlign=Sr(-r.depth)),r.children.unshift(n),r}function wT(e,t){var r=null;e.length===1&&e[0].type==="tag"&&(r=e[0].tag,e=e[0].body);var n=mi(e,t,"root"),s;n.length===2&&n[1].hasClass("tag")&&(s=n.pop());for(var a=[],i=[],o=0;o<n.length;o++)if(i.push(n[o]),n[o].hasClass("mbin")||n[o].hasClass("mrel")||n[o].hasClass("allowbreak")){for(var c=!1;o<n.length-1&&n[o+1].hasClass("mspace")&&!n[o+1].hasClass("newline");)o++,i.push(n[o]),n[o].hasClass("nobreak")&&(c=!0);c||(a.push(jw(i,t)),i=[])}else n[o].hasClass("newline")&&(i.pop(),i.length>0&&(a.push(jw(i,t)),i=[]),a.push(n[o]));i.length>0&&a.push(jw(i,t));var u;r?(u=jw(mi(r,t,!0)),u.classes=["tag"],a.push(u)):s&&a.push(s);var d=k0(["katex-html"],a);if(d.setAttribute("aria-hidden","true"),u){var f=u.children[0];f.style.height=Sr(d.height+d.depth),d.depth&&(f.style.verticalAlign=Sr(-d.depth))}return d}function OW(e){return new M2(e)}class Gl{constructor(t,r,n){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=t,this.attributes={},this.children=r||[],this.classes=n||[]}setAttribute(t,r){this.attributes[t]=r}getAttribute(t){return this.attributes[t]}toNode(){var t=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&t.setAttribute(r,this.attributes[r]);this.classes.length>0&&(t.className=nh(this.classes));for(var n=0;n<this.children.length;n++)if(this.children[n]instanceof ad&&this.children[n+1]instanceof ad){for(var s=this.children[n].toText()+this.children[++n].toText();this.children[n+1]instanceof ad;)s+=this.children[++n].toText();t.appendChild(new ad(s).toNode())}else t.appendChild(this.children[n].toNode());return t}toMarkup(){var t="<"+this.type;for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&(t+=" "+r+'="',t+=Xn.escape(this.attributes[r]),t+='"');this.classes.length>0&&(t+=' class ="'+Xn.escape(nh(this.classes))+'"'),t+=">";for(var n=0;n<this.children.length;n++)t+=this.children[n].toMarkup();return t+="</"+this.type+">",t}toText(){return this.children.map(t=>t.toText()).join("")}}class ad{constructor(t){this.text=void 0,this.text=t}toNode(){return document.createTextNode(this.text)}toMarkup(){return Xn.escape(this.toText())}toText(){return this.text}}class Toe{constructor(t){this.width=void 0,this.character=void 0,this.width=t,t>=.05555&&t<=.05556?this.character="":t>=.1666&&t<=.1667?this.character="":t>=.2222&&t<=.2223?this.character="":t>=.2777&&t<=.2778?this.character="":t>=-.05556&&t<=-.05555?this.character="":t>=-.1667&&t<=-.1666?this.character="":t>=-.2223&&t<=-.2222?this.character="":t>=-.2778&&t<=-.2777?this.character="":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var t=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return t.setAttribute("width",Sr(this.width)),t}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+Sr(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var sr={MathNode:Gl,TextNode:ad,SpaceNode:Toe,newDocumentFragment:OW},Dc=function(t,r,n){return Is[r][t]&&Is[r][t].replace&&t.charCodeAt(0)!==55349&&!(EW.hasOwnProperty(t)&&n&&(n.fontFamily&&n.fontFamily.slice(4,6)==="tt"||n.font&&n.font.slice(4,6)==="tt"))&&(t=Is[r][t].replace),new sr.TextNode(t)},lN=function(t){return t.length===1?t[0]:new sr.MathNode("mrow",t)},cN=function(t,r){if(r.fontFamily==="texttt")return"monospace";if(r.fontFamily==="textsf")return r.fontShape==="textit"&&r.fontWeight==="textbf"?"sans-serif-bold-italic":r.fontShape==="textit"?"sans-serif-italic":r.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(r.fontShape==="textit"&&r.fontWeight==="textbf")return"bold-italic";if(r.fontShape==="textit")return"italic";if(r.fontWeight==="textbf")return"bold";var n=r.font;if(!n||n==="mathnormal")return null;var s=t.mode;if(n==="mathit")return"italic";if(n==="boldsymbol")return t.type==="textord"?"bold":"bold-italic";if(n==="mathbf")return"bold";if(n==="mathbb")return"double-struck";if(n==="mathsfit")return"sans-serif-italic";if(n==="mathfrak")return"fraktur";if(n==="mathscr"||n==="mathcal")return"script";if(n==="mathsf")return"sans-serif";if(n==="mathtt")return"monospace";var a=t.text;if(["\\imath","\\jmath"].includes(a))return null;Is[s][a]&&Is[s][a].replace&&(a=Is[s][a].replace);var i=Nt.fontMap[n].fontName;return aN(a,i,s)?Nt.fontMap[n].variant:null};function W5(e){if(!e)return!1;if(e.type==="mi"&&e.children.length===1){var t=e.children[0];return t instanceof ad&&t.text==="."}else if(e.type==="mo"&&e.children.length===1&&e.getAttribute("separator")==="true"&&e.getAttribute("lspace")==="0em"&&e.getAttribute("rspace")==="0em"){var r=e.children[0];return r instanceof ad&&r.text===","}else return!1}var Nl=function(t,r,n){if(t.length===1){var s=Es(t[0],r);return n&&s instanceof Gl&&s.type==="mo"&&(s.setAttribute("lspace","0em"),s.setAttribute("rspace","0em")),[s]}for(var a=[],i,o=0;o<t.length;o++){var c=Es(t[o],r);if(c instanceof Gl&&i instanceof Gl){if(c.type==="mtext"&&i.type==="mtext"&&c.getAttribute("mathvariant")===i.getAttribute("mathvariant")){i.children.push(...c.children);continue}else if(c.type==="mn"&&i.type==="mn"){i.children.push(...c.children);continue}else if(W5(c)&&i.type==="mn"){i.children.push(...c.children);continue}else if(c.type==="mn"&&W5(i))c.children=[...i.children,...c.children],a.pop();else if((c.type==="msup"||c.type==="msub")&&c.children.length>=1&&(i.type==="mn"||W5(i))){var u=c.children[0];u instanceof Gl&&u.type==="mn"&&(u.children=[...i.children,...u.children],a.pop())}else if(i.type==="mi"&&i.children.length===1){var d=i.children[0];if(d instanceof ad&&d.text===""&&(c.type==="mo"||c.type==="mi"||c.type==="mn")){var f=c.children[0];f instanceof ad&&f.text.length>0&&(f.text=f.text.slice(0,1)+""+f.text.slice(1),a.pop())}}}a.push(c),i=c}return a},ah=function(t,r,n){return lN(Nl(t,r,n))},Es=function(t,r){if(!t)return new sr.MathNode("mrow");if(e_[t.type]){var n=e_[t.type](t,r);return n}else throw new ir("Got group of unknown type: '"+t.type+"'")};function eF(e,t,r,n,s){var a=Nl(e,r),i;a.length===1&&a[0]instanceof Gl&&["mrow","mtable"].includes(a[0].type)?i=a[0]:i=new sr.MathNode("mrow",a);var o=new sr.MathNode("annotation",[new sr.TextNode(t)]);o.setAttribute("encoding","application/x-tex");var c=new sr.MathNode("semantics",[i,o]),u=new sr.MathNode("math",[c]);u.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),n&&u.setAttribute("display","block");var d=s?"katex":"katex-mathml";return Nt.makeSpan([d],[u])}var DW=function(t){return new r0({style:t.displayMode?sn.DISPLAY:sn.TEXT,maxSize:t.maxSize,minRuleThickness:t.minRuleThickness})},IW=function(t,r){if(r.displayMode){var n=["katex-display"];r.leqno&&n.push("leqno"),r.fleqn&&n.push("fleqn"),t=Nt.makeSpan(n,[t])}return t},Noe=function(t,r,n){var s=DW(n),a;if(n.output==="mathml")return eF(t,r,s,n.displayMode,!0);if(n.output==="html"){var i=wT(t,s);a=Nt.makeSpan(["katex"],[i])}else{var o=eF(t,r,s,n.displayMode,!1),c=wT(t,s);a=Nt.makeSpan(["katex"],[o,c])}return IW(a,n)},Eoe=function(t,r,n){var s=DW(n),a=wT(t,s),i=Nt.makeSpan(["katex"],[a]);return IW(i,n)},Aoe={widehat:"^",widecheck:"",widetilde:"~",utilde:"~",overleftarrow:"",underleftarrow:"",xleftarrow:"",overrightarrow:"",underrightarrow:"",xrightarrow:"",underbrace:"",overbrace:"",overgroup:"",undergroup:"",overleftrightarrow:"",underleftrightarrow:"",xleftrightarrow:"",Overrightarrow:"",xRightarrow:"",overleftharpoon:"",xleftharpoonup:"",overrightharpoon:"",xrightharpoonup:"",xLeftarrow:"",xLeftrightarrow:"",xhookleftarrow:"",xhookrightarrow:"",xmapsto:"",xrightharpoondown:"",xleftharpoondown:"",xrightleftharpoons:"",xleftrightharpoons:"",xtwoheadleftarrow:"",xtwoheadrightarrow:"",xlongequal:"=",xtofrom:"",xrightleftarrows:"",xrightequilibrium:"",xleftequilibrium:"","\\cdrightarrow":"","\\cdleftarrow":"","\\cdlongequal":"="},joe=function(t){var r=new sr.MathNode("mo",[new sr.TextNode(Aoe[t.replace(/^\\/,"")])]);return r.setAttribute("stretchy","true"),r},Poe={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},Foe=function(t){return t.type==="ordgroup"?t.body.length:1},Moe=function(t,r){function n(){var o=4e5,c=t.label.slice(1);if(["widehat","widecheck","widetilde","utilde"].includes(c)){var u=t,d=Foe(u.base),f,h,g;if(d>5)c==="widehat"||c==="widecheck"?(f=420,o=2364,g=.42,h=c+"4"):(f=312,o=2340,g=.34,h="tilde4");else{var p=[1,1,2,2,3,3][d];c==="widehat"||c==="widecheck"?(o=[0,1062,2364,2364,2364][p],f=[0,239,300,360,420][p],g=[0,.24,.3,.3,.36,.42][p],h=c+p):(o=[0,600,1033,2339,2340][p],f=[0,260,286,306,312][p],g=[0,.26,.286,.3,.306,.34][p],h="tilde"+p)}var x=new sh(h),v=new S0([x],{width:"100%",height:Sr(g),viewBox:"0 0 "+o+" "+f,preserveAspectRatio:"none"});return{span:Nt.makeSvgSpan([],[v],r),minWidth:0,height:g}}else{var C=[],b=Poe[c],[_,T,N]=b,E=N/1e3,F=_.length,j,P;if(F===1){var M=b[3];j=["hide-tail"],P=[M]}else if(F===2)j=["halfarrow-left","halfarrow-right"],P=["xMinYMin","xMaxYMin"];else if(F===3)j=["brace-left","brace-center","brace-right"],P=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+F+" children.");for(var I=0;I<F;I++){var U=new sh(_[I]),K=new S0([U],{width:"400em",height:Sr(E),viewBox:"0 0 "+o+" "+N,preserveAspectRatio:P[I]+" slice"}),te=Nt.makeSvgSpan([j[I]],[K],r);if(F===1)return{span:te,minWidth:T,height:E};te.style.height=Sr(E),C.push(te)}return{span:Nt.makeSpan(["stretchy"],C,r),minWidth:T,height:E}}}var{span:s,minWidth:a,height:i}=n();return s.height=i,s.style.height=Sr(i),a>0&&(s.style.minWidth=Sr(a)),s},Roe=function(t,r,n,s,a){var i,o=t.height+t.depth+n+s;if(/fbox|color|angl/.test(r)){if(i=Nt.makeSpan(["stretchy",r],[],a),r==="fbox"){var c=a.color&&a.getColor();c&&(i.style.borderColor=c)}}else{var u=[];/^[bx]cancel$/.test(r)&&u.push(new yT({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(r)&&u.push(new yT({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var d=new S0(u,{width:"100%",height:Sr(o)});i=Nt.makeSvgSpan([],[d],a)}return i.height=o,i.style.height=Sr(o),i},C0={encloseSpan:Roe,mathMLnode:joe,svgSpan:Moe};function An(e,t){if(!e||e.type!==t)throw new Error("Expected node of type "+t+", but got "+(e?"node of type "+e.type:String(e)));return e}function uN(e){var t=NS(e);if(!t)throw new Error("Expected node of symbol group type, but got "+(e?"node of type "+e.type:String(e)));return t}function NS(e){return e&&(e.type==="atom"||aoe.hasOwnProperty(e.type))?e:null}var dN=(e,t)=>{var r,n,s;e&&e.type==="supsub"?(n=An(e.base,"accent"),r=n.base,e.base=r,s=noe(Gn(e,t)),e.base=n):(n=An(e,"accent"),r=n.base);var a=Gn(r,t.havingCrampedStyle()),i=n.isShifty&&Xn.isCharacterBox(r),o=0;if(i){var c=Xn.getBaseElem(r),u=Gn(c,t.havingCrampedStyle());o=qP(u).skew}var d=n.label==="\\c",f=d?a.height+a.depth:Math.min(a.height,t.fontMetrics().xHeight),h;if(n.isStretchy)h=C0.svgSpan(n,t),h=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"elem",elem:h,wrapperClasses:["svg-align"],wrapperStyle:o>0?{width:"calc(100% - "+Sr(2*o)+")",marginLeft:Sr(2*o)}:void 0}]},t);else{var g,p;n.label==="\\vec"?(g=Nt.staticSvg("vec",t),p=Nt.svgData.vec[1]):(g=Nt.makeOrd({mode:n.mode,text:n.label},t,"textord"),g=qP(g),g.italic=0,p=g.width,d&&(f+=g.depth)),h=Nt.makeSpan(["accent-body"],[g]);var x=n.label==="\\textcircled";x&&(h.classes.push("accent-full"),f=a.height);var v=o;x||(v-=p/2),h.style.left=Sr(v),n.label==="\\textcircled"&&(h.style.top=".2em"),h=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"kern",size:-f},{type:"elem",elem:h}]},t)}var C=Nt.makeSpan(["mord","accent"],[h],t);return s?(s.children[0]=C,s.height=Math.max(C.height,s.height),s.classes[0]="mord",s):C},LW=(e,t)=>{var r=e.isStretchy?C0.mathMLnode(e.label):new sr.MathNode("mo",[Dc(e.label,e.mode)]),n=new sr.MathNode("mover",[Es(e.base,t),r]);return n.setAttribute("accent","true"),n},Ooe=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(e=>"\\"+e).join("|"));Pr({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(e,t)=>{var r=t_(t[0]),n=!Ooe.test(e.funcName),s=!n||e.funcName==="\\widehat"||e.funcName==="\\widetilde"||e.funcName==="\\widecheck";return{type:"accent",mode:e.parser.mode,label:e.funcName,isStretchy:n,isShifty:s,base:r}},htmlBuilder:dN,mathmlBuilder:LW});Pr({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(e,t)=>{var r=t[0],n=e.parser.mode;return n==="math"&&(e.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+e.funcName+" works only in text mode"),n="text"),{type:"accent",mode:n,label:e.funcName,isStretchy:!1,isShifty:!0,base:r}},htmlBuilder:dN,mathmlBuilder:LW});Pr({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t[0];return{type:"accentUnder",mode:r.mode,label:n,base:s}},htmlBuilder:(e,t)=>{var r=Gn(e.base,t),n=C0.svgSpan(e,t),s=e.label==="\\utilde"?.12:0,a=Nt.makeVList({positionType:"top",positionData:r.height,children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:s},{type:"elem",elem:r}]},t);return Nt.makeSpan(["mord","accentunder"],[a],t)},mathmlBuilder:(e,t)=>{var r=C0.mathMLnode(e.label),n=new sr.MathNode("munder",[Es(e.base,t),r]);return n.setAttribute("accentunder","true"),n}});var Pw=e=>{var t=new sr.MathNode("mpadded",e?[e]:[]);return t.setAttribute("width","+0.6em"),t.setAttribute("lspace","0.3em"),t};Pr({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,r){var{parser:n,funcName:s}=e;return{type:"xArrow",mode:n.mode,label:s,body:t[0],below:r[0]}},htmlBuilder(e,t){var r=t.style,n=t.havingStyle(r.sup()),s=Nt.wrapFragment(Gn(e.body,n,t),t),a=e.label.slice(0,2)==="\\x"?"x":"cd";s.classes.push(a+"-arrow-pad");var i;e.below&&(n=t.havingStyle(r.sub()),i=Nt.wrapFragment(Gn(e.below,n,t),t),i.classes.push(a+"-arrow-pad"));var o=C0.svgSpan(e,t),c=-t.fontMetrics().axisHeight+.5*o.height,u=-t.fontMetrics().axisHeight-.5*o.height-.111;(s.depth>.25||e.label==="\\xleftequilibrium")&&(u-=s.depth);var d;if(i){var f=-t.fontMetrics().axisHeight+i.height+.5*o.height+.111;d=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:u},{type:"elem",elem:o,shift:c},{type:"elem",elem:i,shift:f}]},t)}else d=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:u},{type:"elem",elem:o,shift:c}]},t);return d.children[0].children[0].children[1].classes.push("svg-align"),Nt.makeSpan(["mrel","x-arrow"],[d],t)},mathmlBuilder(e,t){var r=C0.mathMLnode(e.label);r.setAttribute("minsize",e.label.charAt(0)==="x"?"1.75em":"3.0em");var n;if(e.body){var s=Pw(Es(e.body,t));if(e.below){var a=Pw(Es(e.below,t));n=new sr.MathNode("munderover",[r,a,s])}else n=new sr.MathNode("mover",[r,s])}else if(e.below){var i=Pw(Es(e.below,t));n=new sr.MathNode("munder",[r,i])}else n=Pw(),n=new sr.MathNode("mover",[r,n]);return n}});var Doe=Nt.makeSpan;function BW(e,t){var r=mi(e.body,t,!0);return Doe([e.mclass],r,t)}function $W(e,t){var r,n=Nl(e.body,t);return e.mclass==="minner"?r=new sr.MathNode("mpadded",n):e.mclass==="mord"?e.isCharacterBox?(r=n[0],r.type="mi"):r=new sr.MathNode("mi",n):(e.isCharacterBox?(r=n[0],r.type="mo"):r=new sr.MathNode("mo",n),e.mclass==="mbin"?(r.attributes.lspace="0.22em",r.attributes.rspace="0.22em"):e.mclass==="mpunct"?(r.attributes.lspace="0em",r.attributes.rspace="0.17em"):e.mclass==="mopen"||e.mclass==="mclose"?(r.attributes.lspace="0em",r.attributes.rspace="0em"):e.mclass==="minner"&&(r.attributes.lspace="0.0556em",r.attributes.width="+0.1111em")),r}Pr({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(e,t){var{parser:r,funcName:n}=e,s=t[0];return{type:"mclass",mode:r.mode,mclass:"m"+n.slice(5),body:Da(s),isCharacterBox:Xn.isCharacterBox(s)}},htmlBuilder:BW,mathmlBuilder:$W});var ES=e=>{var t=e.type==="ordgroup"&&e.body.length?e.body[0]:e;return t.type==="atom"&&(t.family==="bin"||t.family==="rel")?"m"+t.family:"mord"};Pr({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(e,t){var{parser:r}=e;return{type:"mclass",mode:r.mode,mclass:ES(t[0]),body:Da(t[1]),isCharacterBox:Xn.isCharacterBox(t[1])}}});Pr({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(e,t){var{parser:r,funcName:n}=e,s=t[1],a=t[0],i;n!=="\\stackrel"?i=ES(s):i="mrel";var o={type:"op",mode:s.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:n!=="\\stackrel",body:Da(s)},c={type:"supsub",mode:a.mode,base:o,sup:n==="\\underset"?null:a,sub:n==="\\underset"?a:null};return{type:"mclass",mode:r.mode,mclass:i,body:[c],isCharacterBox:Xn.isCharacterBox(c)}},htmlBuilder:BW,mathmlBuilder:$W});Pr({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:r}=e;return{type:"pmb",mode:r.mode,mclass:ES(t[0]),body:Da(t[0])}},htmlBuilder(e,t){var r=mi(e.body,t,!0),n=Nt.makeSpan([e.mclass],r,t);return n.style.textShadow="0.02em 0.01em 0.04px",n},mathmlBuilder(e,t){var r=Nl(e.body,t),n=new sr.MathNode("mstyle",r);return n.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),n}});var Ioe={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},tF=()=>({type:"styling",body:[],mode:"math",style:"display"}),rF=e=>e.type==="textord"&&e.text==="@",Loe=(e,t)=>(e.type==="mathord"||e.type==="atom")&&e.text===t;function Boe(e,t,r){var n=Ioe[e];switch(n){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return r.callFunction(n,[t[0]],[t[1]]);case"\\uparrow":case"\\downarrow":{var s=r.callFunction("\\\\cdleft",[t[0]],[]),a={type:"atom",text:n,mode:"math",family:"rel"},i=r.callFunction("\\Big",[a],[]),o=r.callFunction("\\\\cdright",[t[1]],[]),c={type:"ordgroup",mode:"math",body:[s,i,o]};return r.callFunction("\\\\cdparent",[c],[])}case"\\\\cdlongequal":return r.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var u={type:"textord",text:"\\Vert",mode:"math"};return r.callFunction("\\Big",[u],[])}default:return{type:"textord",text:" ",mode:"math"}}}function $oe(e){var t=[];for(e.gullet.beginGroup(),e.gullet.macros.set("\\cr","\\\\\\relax"),e.gullet.beginGroup();;){t.push(e.parseExpression(!1,"\\\\")),e.gullet.endGroup(),e.gullet.beginGroup();var r=e.fetch().text;if(r==="&"||r==="\\\\")e.consume();else if(r==="\\end"){t[t.length-1].length===0&&t.pop();break}else throw new ir("Expected \\\\ or \\cr or \\end",e.nextToken)}for(var n=[],s=[n],a=0;a<t.length;a++){for(var i=t[a],o=tF(),c=0;c<i.length;c++)if(!rF(i[c]))o.body.push(i[c]);else{n.push(o),c+=1;var u=uN(i[c]).text,d=new Array(2);if(d[0]={type:"ordgroup",mode:"math",body:[]},d[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(u)>-1))if("<>AV".indexOf(u)>-1)for(var f=0;f<2;f++){for(var h=!0,g=c+1;g<i.length;g++){if(Loe(i[g],u)){h=!1,c=g;break}if(rF(i[g]))throw new ir("Missing a "+u+" character to complete a CD arrow.",i[g]);d[f].body.push(i[g])}if(h)throw new ir("Missing a "+u+" character to complete a CD arrow.",i[c])}else throw new ir('Expected one of "<>AV=|." after @',i[c]);var p=Boe(u,d,e),x={type:"styling",body:[p],mode:"math",style:"display"};n.push(x),o=tF()}a%2===0?n.push(o):n.shift(),n=[],s.push(n)}e.gullet.endGroup(),e.gullet.endGroup();var v=new Array(s[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:s,arraystretch:1,addJot:!0,rowGaps:[null],cols:v,colSeparationType:"CD",hLinesBeforeRow:new Array(s.length+1).fill([])}}Pr({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(e,t){var{parser:r,funcName:n}=e;return{type:"cdlabel",mode:r.mode,side:n.slice(4),label:t[0]}},htmlBuilder(e,t){var r=t.havingStyle(t.style.sup()),n=Nt.wrapFragment(Gn(e.label,r,t),t);return n.classes.push("cd-label-"+e.side),n.style.bottom=Sr(.8-n.depth),n.height=0,n.depth=0,n},mathmlBuilder(e,t){var r=new sr.MathNode("mrow",[Es(e.label,t)]);return r=new sr.MathNode("mpadded",[r]),r.setAttribute("width","0"),e.side==="left"&&r.setAttribute("lspace","-1width"),r.setAttribute("voffset","0.7em"),r=new sr.MathNode("mstyle",[r]),r.setAttribute("displaystyle","false"),r.setAttribute("scriptlevel","1"),r}});Pr({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(e,t){var{parser:r}=e;return{type:"cdlabelparent",mode:r.mode,fragment:t[0]}},htmlBuilder(e,t){var r=Nt.wrapFragment(Gn(e.fragment,t),t);return r.classes.push("cd-vert-arrow"),r},mathmlBuilder(e,t){return new sr.MathNode("mrow",[Es(e.fragment,t)])}});Pr({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(e,t){for(var{parser:r}=e,n=An(t[0],"ordgroup"),s=n.body,a="",i=0;i<s.length;i++){var o=An(s[i],"textord");a+=o.text}var c=parseInt(a),u;if(isNaN(c))throw new ir("\\@char has non-numeric argument "+a);if(c<0||c>=1114111)throw new ir("\\@char with invalid code point "+a);return c<=65535?u=String.fromCharCode(c):(c-=65536,u=String.fromCharCode((c>>10)+55296,(c&1023)+56320)),{type:"textord",mode:r.mode,text:u}}});var UW=(e,t)=>{var r=mi(e.body,t.withColor(e.color),!1);return Nt.makeFragment(r)},zW=(e,t)=>{var r=Nl(e.body,t.withColor(e.color)),n=new sr.MathNode("mstyle",r);return n.setAttribute("mathcolor",e.color),n};Pr({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(e,t){var{parser:r}=e,n=An(t[0],"color-token").color,s=t[1];return{type:"color",mode:r.mode,color:n,body:Da(s)}},htmlBuilder:UW,mathmlBuilder:zW});Pr({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(e,t){var{parser:r,breakOnTokenText:n}=e,s=An(t[0],"color-token").color;r.gullet.macros.set("\\current@color",s);var a=r.parseExpression(!0,n);return{type:"color",mode:r.mode,color:s,body:a}},htmlBuilder:UW,mathmlBuilder:zW});Pr({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(e,t,r){var{parser:n}=e,s=n.gullet.future().text==="["?n.parseSizeGroup(!0):null,a=!n.settings.displayMode||!n.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:n.mode,newLine:a,size:s&&An(s,"size").value}},htmlBuilder(e,t){var r=Nt.makeSpan(["mspace"],[],t);return e.newLine&&(r.classes.push("newline"),e.size&&(r.style.marginTop=Sr(aa(e.size,t)))),r},mathmlBuilder(e,t){var r=new sr.MathNode("mspace");return e.newLine&&(r.setAttribute("linebreak","newline"),e.size&&r.setAttribute("height",Sr(aa(e.size,t)))),r}});var _T={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},WW=e=>{var t=e.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(t))throw new ir("Expected a control sequence",e);return t},Uoe=e=>{var t=e.gullet.popToken();return t.text==="="&&(t=e.gullet.popToken(),t.text===" "&&(t=e.gullet.popToken())),t},HW=(e,t,r,n)=>{var s=e.gullet.macros.get(r.text);s==null&&(r.noexpand=!0,s={tokens:[r],numArgs:0,unexpandable:!e.gullet.isExpandable(r.text)}),e.gullet.macros.set(t,s,n)};Pr({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(e){var{parser:t,funcName:r}=e;t.consumeSpaces();var n=t.fetch();if(_T[n.text])return(r==="\\global"||r==="\\\\globallong")&&(n.text=_T[n.text]),An(t.parseFunction(),"internal");throw new ir("Invalid token after macro prefix",n)}});Pr({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:r}=e,n=t.gullet.popToken(),s=n.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(s))throw new ir("Expected a control sequence",n);for(var a=0,i,o=[[]];t.gullet.future().text!=="{";)if(n=t.gullet.popToken(),n.text==="#"){if(t.gullet.future().text==="{"){i=t.gullet.future(),o[a].push("{");break}if(n=t.gullet.popToken(),!/^[1-9]$/.test(n.text))throw new ir('Invalid argument number "'+n.text+'"');if(parseInt(n.text)!==a+1)throw new ir('Argument number "'+n.text+'" out of order');a++,o.push([])}else{if(n.text==="EOF")throw new ir("Expected a macro definition");o[a].push(n.text)}var{tokens:c}=t.gullet.consumeArg();return i&&c.unshift(i),(r==="\\edef"||r==="\\xdef")&&(c=t.gullet.expandTokens(c),c.reverse()),t.gullet.macros.set(s,{tokens:c,numArgs:a,delimiters:o},r===_T[r]),{type:"internal",mode:t.mode}}});Pr({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:r}=e,n=WW(t.gullet.popToken());t.gullet.consumeSpaces();var s=Uoe(t);return HW(t,n,s,r==="\\\\globallet"),{type:"internal",mode:t.mode}}});Pr({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e){var{parser:t,funcName:r}=e,n=WW(t.gullet.popToken()),s=t.gullet.popToken(),a=t.gullet.popToken();return HW(t,n,a,r==="\\\\globalfuture"),t.gullet.pushToken(a),t.gullet.pushToken(s),{type:"internal",mode:t.mode}}});var iv=function(t,r,n){var s=Is.math[t]&&Is.math[t].replace,a=aN(s||t,r,n);if(!a)throw new Error("Unsupported symbol "+t+" and font size "+r+".");return a},fN=function(t,r,n,s){var a=n.havingBaseStyle(r),i=Nt.makeSpan(s.concat(a.sizingClasses(n)),[t],n),o=a.sizeMultiplier/n.sizeMultiplier;return i.height*=o,i.depth*=o,i.maxFontSize=a.sizeMultiplier,i},GW=function(t,r,n){var s=r.havingBaseStyle(n),a=(1-r.sizeMultiplier/s.sizeMultiplier)*r.fontMetrics().axisHeight;t.classes.push("delimcenter"),t.style.top=Sr(a),t.height-=a,t.depth+=a},zoe=function(t,r,n,s,a,i){var o=Nt.makeSymbol(t,"Main-Regular",a,s),c=fN(o,r,s,i);return n&&GW(c,s,r),c},Woe=function(t,r,n,s){return Nt.makeSymbol(t,"Size"+r+"-Regular",n,s)},VW=function(t,r,n,s,a,i){var o=Woe(t,r,a,s),c=fN(Nt.makeSpan(["delimsizing","size"+r],[o],s),sn.TEXT,s,i);return n&&GW(c,s,sn.TEXT),c},H5=function(t,r,n){var s;r==="Size1-Regular"?s="delim-size1":s="delim-size4";var a=Nt.makeSpan(["delimsizinginner",s],[Nt.makeSpan([],[Nt.makeSymbol(t,r,n)])]);return{type:"elem",elem:a}},G5=function(t,r,n){var s=sd["Size4-Regular"][t.charCodeAt(0)]?sd["Size4-Regular"][t.charCodeAt(0)][4]:sd["Size1-Regular"][t.charCodeAt(0)][4],a=new sh("inner",Kie(t,Math.round(1e3*r))),i=new S0([a],{width:Sr(s),height:Sr(r),style:"width:"+Sr(s),viewBox:"0 0 "+1e3*s+" "+Math.round(1e3*r),preserveAspectRatio:"xMinYMin"}),o=Nt.makeSvgSpan([],[i],n);return o.height=r,o.style.height=Sr(r),o.style.width=Sr(s),{type:"elem",elem:o}},ST=.008,Fw={type:"kern",size:-1*ST},Hoe=["|","\\lvert","\\rvert","\\vert"],Goe=["\\|","\\lVert","\\rVert","\\Vert"],qW=function(t,r,n,s,a,i){var o,c,u,d,f="",h=0;o=u=d=t,c=null;var g="Size1-Regular";t==="\\uparrow"?u=d="":t==="\\Uparrow"?u=d="":t==="\\downarrow"?o=u="":t==="\\Downarrow"?o=u="":t==="\\updownarrow"?(o="\\uparrow",u="",d="\\downarrow"):t==="\\Updownarrow"?(o="\\Uparrow",u="",d="\\Downarrow"):Hoe.includes(t)?(u="",f="vert",h=333):Goe.includes(t)?(u="",f="doublevert",h=556):t==="["||t==="\\lbrack"?(o="",u="",d="",g="Size4-Regular",f="lbrack",h=667):t==="]"||t==="\\rbrack"?(o="",u="",d="",g="Size4-Regular",f="rbrack",h=667):t==="\\lfloor"||t===""?(u=o="",d="",g="Size4-Regular",f="lfloor",h=667):t==="\\lceil"||t===""?(o="",u=d="",g="Size4-Regular",f="lceil",h=667):t==="\\rfloor"||t===""?(u=o="",d="",g="Size4-Regular",f="rfloor",h=667):t==="\\rceil"||t===""?(o="",u=d="",g="Size4-Regular",f="rceil",h=667):t==="("||t==="\\lparen"?(o="",u="",d="",g="Size4-Regular",f="lparen",h=875):t===")"||t==="\\rparen"?(o="",u="",d="",g="Size4-Regular",f="rparen",h=875):t==="\\{"||t==="\\lbrace"?(o="",c="",d="",u="",g="Size4-Regular"):t==="\\}"||t==="\\rbrace"?(o="",c="",d="",u="",g="Size4-Regular"):t==="\\lgroup"||t===""?(o="",d="",u="",g="Size4-Regular"):t==="\\rgroup"||t===""?(o="",d="",u="",g="Size4-Regular"):t==="\\lmoustache"||t===""?(o="",d="",u="",g="Size4-Regular"):(t==="\\rmoustache"||t==="")&&(o="",d="",u="",g="Size4-Regular");var p=iv(o,g,a),x=p.height+p.depth,v=iv(u,g,a),C=v.height+v.depth,b=iv(d,g,a),_=b.height+b.depth,T=0,N=1;if(c!==null){var E=iv(c,g,a);T=E.height+E.depth,N=2}var F=x+_+T,j=Math.max(0,Math.ceil((r-F)/(N*C))),P=F+j*N*C,M=s.fontMetrics().axisHeight;n&&(M*=s.sizeMultiplier);var I=P/2-M,U=[];if(f.length>0){var K=P-x-_,te=Math.round(P*1e3),re=Yie(f,Math.round(K*1e3)),Z=new sh(f,re),B=(h/1e3).toFixed(3)+"em",J=(te/1e3).toFixed(3)+"em",z=new S0([Z],{width:B,height:J,viewBox:"0 0 "+h+" "+te}),q=Nt.makeSvgSpan([],[z],s);q.height=te/1e3,q.style.width=B,q.style.height=J,U.push({type:"elem",elem:q})}else{if(U.push(H5(d,g,a)),U.push(Fw),c===null){var H=P-x-_+2*ST;U.push(G5(u,H,s))}else{var R=(P-x-_-T)/2+2*ST;U.push(G5(u,R,s)),U.push(Fw),U.push(H5(c,g,a)),U.push(Fw),U.push(G5(u,R,s))}U.push(Fw),U.push(H5(o,g,a))}var L=s.havingBaseStyle(sn.TEXT),G=Nt.makeVList({positionType:"bottom",positionData:I,children:U},L);return fN(Nt.makeSpan(["delimsizing","mult"],[G],L),sn.TEXT,s,i)},V5=80,q5=.08,K5=function(t,r,n,s,a){var i=qie(t,s,n),o=new sh(t,i),c=new S0([o],{width:"400em",height:Sr(r),viewBox:"0 0 400000 "+n,preserveAspectRatio:"xMinYMin slice"});return Nt.makeSvgSpan(["hide-tail"],[c],a)},Voe=function(t,r){var n=r.havingBaseSizing(),s=JW("\\surd",t*n.sizeMultiplier,XW,n),a=n.sizeMultiplier,i=Math.max(0,r.minRuleThickness-r.fontMetrics().sqrtRuleThickness),o,c=0,u=0,d=0,f;return s.type==="small"?(d=1e3+1e3*i+V5,t<1?a=1:t<1.4&&(a=.7),c=(1+i+q5)/a,u=(1+i)/a,o=K5("sqrtMain",c,d,i,r),o.style.minWidth="0.853em",f=.833/a):s.type==="large"?(d=(1e3+V5)*bv[s.size],u=(bv[s.size]+i)/a,c=(bv[s.size]+i+q5)/a,o=K5("sqrtSize"+s.size,c,d,i,r),o.style.minWidth="1.02em",f=1/a):(c=t+i+q5,u=t+i,d=Math.floor(1e3*t+i)+V5,o=K5("sqrtTall",c,d,i,r),o.style.minWidth="0.742em",f=1.056),o.height=u,o.style.height=Sr(c),{span:o,advanceWidth:f,ruleWidth:(r.fontMetrics().sqrtRuleThickness+i)*a}},KW=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","\\surd"],qoe=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","",""],YW=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],bv=[0,1.2,1.8,2.4,3],Koe=function(t,r,n,s,a){if(t==="<"||t==="\\lt"||t===""?t="\\langle":(t===">"||t==="\\gt"||t==="")&&(t="\\rangle"),KW.includes(t)||YW.includes(t))return VW(t,r,!1,n,s,a);if(qoe.includes(t))return qW(t,bv[r],!1,n,s,a);throw new ir("Illegal delimiter: '"+t+"'")},Yoe=[{type:"small",style:sn.SCRIPTSCRIPT},{type:"small",style:sn.SCRIPT},{type:"small",style:sn.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],Xoe=[{type:"small",style:sn.SCRIPTSCRIPT},{type:"small",style:sn.SCRIPT},{type:"small",style:sn.TEXT},{type:"stack"}],XW=[{type:"small",style:sn.SCRIPTSCRIPT},{type:"small",style:sn.SCRIPT},{type:"small",style:sn.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],Joe=function(t){if(t.type==="small")return"Main-Regular";if(t.type==="large")return"Size"+t.size+"-Regular";if(t.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+t.type+"' here.")},JW=function(t,r,n,s){for(var a=Math.min(2,3-s.style.size),i=a;i<n.length&&n[i].type!=="stack";i++){var o=iv(t,Joe(n[i]),"math"),c=o.height+o.depth;if(n[i].type==="small"){var u=s.havingBaseStyle(n[i].style);c*=u.sizeMultiplier}if(c>r)return n[i]}return n[n.length-1]},QW=function(t,r,n,s,a,i){t==="<"||t==="\\lt"||t===""?t="\\langle":(t===">"||t==="\\gt"||t==="")&&(t="\\rangle");var o;YW.includes(t)?o=Yoe:KW.includes(t)?o=XW:o=Xoe;var c=JW(t,r,o,s);return c.type==="small"?zoe(t,c.style,n,s,a,i):c.type==="large"?VW(t,c.size,n,s,a,i):qW(t,r,n,s,a,i)},Qoe=function(t,r,n,s,a,i){var o=s.fontMetrics().axisHeight*s.sizeMultiplier,c=901,u=5/s.fontMetrics().ptPerEm,d=Math.max(r-o,n+o),f=Math.max(d/500*c,2*d-u);return QW(t,f,!0,s,a,i)},m0={sqrtImage:Voe,sizedDelim:Koe,sizeToMaxHeight:bv,customSizedDelim:QW,leftRightDelim:Qoe},nF={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},Zoe=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","","","\\lceil","\\rceil","","","<",">","\\langle","","\\rangle","","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","","","\\lmoustache","\\rmoustache","","","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function AS(e,t){var r=NS(e);if(r&&Zoe.includes(r.text))return r;throw r?new ir("Invalid delimiter '"+r.text+"' after '"+t.funcName+"'",e):new ir("Invalid delimiter type '"+e.type+"'",e)}Pr({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(e,t)=>{var r=AS(t[0],e);return{type:"delimsizing",mode:e.parser.mode,size:nF[e.funcName].size,mclass:nF[e.funcName].mclass,delim:r.text}},htmlBuilder:(e,t)=>e.delim==="."?Nt.makeSpan([e.mclass]):m0.sizedDelim(e.delim,e.size,t,e.mode,[e.mclass]),mathmlBuilder:e=>{var t=[];e.delim!=="."&&t.push(Dc(e.delim,e.mode));var r=new sr.MathNode("mo",t);e.mclass==="mopen"||e.mclass==="mclose"?r.setAttribute("fence","true"):r.setAttribute("fence","false"),r.setAttribute("stretchy","true");var n=Sr(m0.sizeToMaxHeight[e.size]);return r.setAttribute("minsize",n),r.setAttribute("maxsize",n),r}});function sF(e){if(!e.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}Pr({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var r=e.parser.gullet.macros.get("\\current@color");if(r&&typeof r!="string")throw new ir("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:e.parser.mode,delim:AS(t[0],e).text,color:r}}});Pr({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var r=AS(t[0],e),n=e.parser;++n.leftrightDepth;var s=n.parseExpression(!1);--n.leftrightDepth,n.expect("\\right",!1);var a=An(n.parseFunction(),"leftright-right");return{type:"leftright",mode:n.mode,body:s,left:r.text,right:a.delim,rightColor:a.color}},htmlBuilder:(e,t)=>{sF(e);for(var r=mi(e.body,t,!0,["mopen","mclose"]),n=0,s=0,a=!1,i=0;i<r.length;i++)r[i].isMiddle?a=!0:(n=Math.max(r[i].height,n),s=Math.max(r[i].depth,s));n*=t.sizeMultiplier,s*=t.sizeMultiplier;var o;if(e.left==="."?o=Vv(t,["mopen"]):o=m0.leftRightDelim(e.left,n,s,t,e.mode,["mopen"]),r.unshift(o),a)for(var c=1;c<r.length;c++){var u=r[c],d=u.isMiddle;d&&(r[c]=m0.leftRightDelim(d.delim,n,s,d.options,e.mode,[]))}var f;if(e.right===".")f=Vv(t,["mclose"]);else{var h=e.rightColor?t.withColor(e.rightColor):t;f=m0.leftRightDelim(e.right,n,s,h,e.mode,["mclose"])}return r.push(f),Nt.makeSpan(["minner"],r,t)},mathmlBuilder:(e,t)=>{sF(e);var r=Nl(e.body,t);if(e.left!=="."){var n=new sr.MathNode("mo",[Dc(e.left,e.mode)]);n.setAttribute("fence","true"),r.unshift(n)}if(e.right!=="."){var s=new sr.MathNode("mo",[Dc(e.right,e.mode)]);s.setAttribute("fence","true"),e.rightColor&&s.setAttribute("mathcolor",e.rightColor),r.push(s)}return lN(r)}});Pr({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var r=AS(t[0],e);if(!e.parser.leftrightDepth)throw new ir("\\middle without preceding \\left",r);return{type:"middle",mode:e.parser.mode,delim:r.text}},htmlBuilder:(e,t)=>{var r;if(e.delim===".")r=Vv(t,[]);else{r=m0.sizedDelim(e.delim,1,t,e.mode,[]);var n={delim:e.delim,options:t};r.isMiddle=n}return r},mathmlBuilder:(e,t)=>{var r=e.delim==="\\vert"||e.delim==="|"?Dc("|","text"):Dc(e.delim,e.mode),n=new sr.MathNode("mo",[r]);return n.setAttribute("fence","true"),n.setAttribute("lspace","0.05em"),n.setAttribute("rspace","0.05em"),n}});var hN=(e,t)=>{var r=Nt.wrapFragment(Gn(e.body,t),t),n=e.label.slice(1),s=t.sizeMultiplier,a,i=0,o=Xn.isCharacterBox(e.body);if(n==="sout")a=Nt.makeSpan(["stretchy","sout"]),a.height=t.fontMetrics().defaultRuleThickness/s,i=-.5*t.fontMetrics().xHeight;else if(n==="phase"){var c=aa({number:.6,unit:"pt"},t),u=aa({number:.35,unit:"ex"},t),d=t.havingBaseSizing();s=s/d.sizeMultiplier;var f=r.height+r.depth+c+u;r.style.paddingLeft=Sr(f/2+c);var h=Math.floor(1e3*f*s),g=Gie(h),p=new S0([new sh("phase",g)],{width:"400em",height:Sr(h/1e3),viewBox:"0 0 400000 "+h,preserveAspectRatio:"xMinYMin slice"});a=Nt.makeSvgSpan(["hide-tail"],[p],t),a.style.height=Sr(f),i=r.depth+c+u}else{/cancel/.test(n)?o||r.classes.push("cancel-pad"):n==="angl"?r.classes.push("anglpad"):r.classes.push("boxpad");var x=0,v=0,C=0;/box/.test(n)?(C=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness),x=t.fontMetrics().fboxsep+(n==="colorbox"?0:C),v=x):n==="angl"?(C=Math.max(t.fontMetrics().defaultRuleThickness,t.minRuleThickness),x=4*C,v=Math.max(0,.25-r.depth)):(x=o?.2:0,v=x),a=C0.encloseSpan(r,n,x,v,t),/fbox|boxed|fcolorbox/.test(n)?(a.style.borderStyle="solid",a.style.borderWidth=Sr(C)):n==="angl"&&C!==.049&&(a.style.borderTopWidth=Sr(C),a.style.borderRightWidth=Sr(C)),i=r.depth+v,e.backgroundColor&&(a.style.backgroundColor=e.backgroundColor,e.borderColor&&(a.style.borderColor=e.borderColor))}var b;if(e.backgroundColor)b=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:a,shift:i},{type:"elem",elem:r,shift:0}]},t);else{var _=/cancel|phase/.test(n)?["svg-align"]:[];b=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:r,shift:0},{type:"elem",elem:a,shift:i,wrapperClasses:_}]},t)}return/cancel/.test(n)&&(b.height=r.height,b.depth=r.depth),/cancel/.test(n)&&!o?Nt.makeSpan(["mord","cancel-lap"],[b],t):Nt.makeSpan(["mord"],[b],t)},mN=(e,t)=>{var r=0,n=new sr.MathNode(e.label.indexOf("colorbox")>-1?"mpadded":"menclose",[Es(e.body,t)]);switch(e.label){case"\\cancel":n.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":n.setAttribute("notation","downdiagonalstrike");break;case"\\phase":n.setAttribute("notation","phasorangle");break;case"\\sout":n.setAttribute("notation","horizontalstrike");break;case"\\fbox":n.setAttribute("notation","box");break;case"\\angl":n.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(r=t.fontMetrics().fboxsep*t.fontMetrics().ptPerEm,n.setAttribute("width","+"+2*r+"pt"),n.setAttribute("height","+"+2*r+"pt"),n.setAttribute("lspace",r+"pt"),n.setAttribute("voffset",r+"pt"),e.label==="\\fcolorbox"){var s=Math.max(t.fontMetrics().fboxrule,t.minRuleThickness);n.setAttribute("style","border: "+s+"em solid "+String(e.borderColor))}break;case"\\xcancel":n.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return e.backgroundColor&&n.setAttribute("mathbackground",e.backgroundColor),n};Pr({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(e,t,r){var{parser:n,funcName:s}=e,a=An(t[0],"color-token").color,i=t[1];return{type:"enclose",mode:n.mode,label:s,backgroundColor:a,body:i}},htmlBuilder:hN,mathmlBuilder:mN});Pr({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(e,t,r){var{parser:n,funcName:s}=e,a=An(t[0],"color-token").color,i=An(t[1],"color-token").color,o=t[2];return{type:"enclose",mode:n.mode,label:s,backgroundColor:i,borderColor:a,body:o}},htmlBuilder:hN,mathmlBuilder:mN});Pr({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(e,t){var{parser:r}=e;return{type:"enclose",mode:r.mode,label:"\\fbox",body:t[0]}}});Pr({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(e,t){var{parser:r,funcName:n}=e,s=t[0];return{type:"enclose",mode:r.mode,label:n,body:s}},htmlBuilder:hN,mathmlBuilder:mN});Pr({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(e,t){var{parser:r}=e;return{type:"enclose",mode:r.mode,label:"\\angl",body:t[0]}}});var ZW={};function xd(e){for(var{type:t,names:r,props:n,handler:s,htmlBuilder:a,mathmlBuilder:i}=e,o={type:t,numArgs:n.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:s},c=0;c<r.length;++c)ZW[r[c]]=o;a&&(Z4[t]=a),i&&(e_[t]=i)}var eH={};function ke(e,t){eH[e]=t}function aF(e){var t=[];e.consumeSpaces();var r=e.fetch().text;for(r==="\\relax"&&(e.consume(),e.consumeSpaces(),r=e.fetch().text);r==="\\hline"||r==="\\hdashline";)e.consume(),t.push(r==="\\hdashline"),e.consumeSpaces(),r=e.fetch().text;return t}var jS=e=>{var t=e.parser.settings;if(!t.displayMode)throw new ir("{"+e.envName+"} can be used only in display mode.")};function gN(e){if(e.indexOf("ed")===-1)return e.indexOf("*")===-1}function xh(e,t,r){var{hskipBeforeAndAfter:n,addJot:s,cols:a,arraystretch:i,colSeparationType:o,autoTag:c,singleRow:u,emptySingleRow:d,maxNumCols:f,leqno:h}=t;if(e.gullet.beginGroup(),u||e.gullet.macros.set("\\cr","\\\\\\relax"),!i){var g=e.gullet.expandMacroAsText("\\arraystretch");if(g==null)i=1;else if(i=parseFloat(g),!i||i<0)throw new ir("Invalid \\arraystretch: "+g)}e.gullet.beginGroup();var p=[],x=[p],v=[],C=[],b=c!=null?[]:void 0;function _(){c&&e.gullet.macros.set("\\@eqnsw","1",!0)}function T(){b&&(e.gullet.macros.get("\\df@tag")?(b.push(e.subparse([new Yl("\\df@tag")])),e.gullet.macros.set("\\df@tag",void 0,!0)):b.push(!!c&&e.gullet.macros.get("\\@eqnsw")==="1"))}for(_(),C.push(aF(e));;){var N=e.parseExpression(!1,u?"\\end":"\\\\");e.gullet.endGroup(),e.gullet.beginGroup(),N={type:"ordgroup",mode:e.mode,body:N},r&&(N={type:"styling",mode:e.mode,style:r,body:[N]}),p.push(N);var E=e.fetch().text;if(E==="&"){if(f&&p.length===f){if(u||o)throw new ir("Too many tab characters: &",e.nextToken);e.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}e.consume()}else if(E==="\\end"){T(),p.length===1&&N.type==="styling"&&N.body[0].body.length===0&&(x.length>1||!d)&&x.pop(),C.length<x.length+1&&C.push([]);break}else if(E==="\\\\"){e.consume();var F=void 0;e.gullet.future().text!==" "&&(F=e.parseSizeGroup(!0)),v.push(F?F.value:null),T(),C.push(aF(e)),p=[],x.push(p),_()}else throw new ir("Expected & or \\\\ or \\cr or \\end",e.nextToken)}return e.gullet.endGroup(),e.gullet.endGroup(),{type:"array",mode:e.mode,addJot:s,arraystretch:i,body:x,cols:a,rowGaps:v,hskipBeforeAndAfter:n,hLinesBeforeRow:C,colSeparationType:o,tags:b,leqno:h}}function pN(e){return e.slice(0,1)==="d"?"display":"text"}var yd=function(t,r){var n,s,a=t.body.length,i=t.hLinesBeforeRow,o=0,c=new Array(a),u=[],d=Math.max(r.fontMetrics().arrayRuleWidth,r.minRuleThickness),f=1/r.fontMetrics().ptPerEm,h=5*f;if(t.colSeparationType&&t.colSeparationType==="small"){var g=r.havingStyle(sn.SCRIPT).sizeMultiplier;h=.2778*(g/r.sizeMultiplier)}var p=t.colSeparationType==="CD"?aa({number:3,unit:"ex"},r):12*f,x=3*f,v=t.arraystretch*p,C=.7*v,b=.3*v,_=0;function T($t){for(var Ge=0;Ge<$t.length;++Ge)Ge>0&&(_+=.25),u.push({pos:_,isDashed:$t[Ge]})}for(T(i[0]),n=0;n<t.body.length;++n){var N=t.body[n],E=C,F=b;o<N.length&&(o=N.length);var j=new Array(N.length);for(s=0;s<N.length;++s){var P=Gn(N[s],r);F<P.depth&&(F=P.depth),E<P.height&&(E=P.height),j[s]=P}var M=t.rowGaps[n],I=0;M&&(I=aa(M,r),I>0&&(I+=b,F<I&&(F=I),I=0)),t.addJot&&(F+=x),j.height=E,j.depth=F,_+=E,j.pos=_,_+=F+I,c[n]=j,T(i[n+1])}var U=_/2+r.fontMetrics().axisHeight,K=t.cols||[],te=[],re,Z,B=[];if(t.tags&&t.tags.some($t=>$t))for(n=0;n<a;++n){var J=c[n],z=J.pos-U,q=t.tags[n],H=void 0;q===!0?H=Nt.makeSpan(["eqn-num"],[],r):q===!1?H=Nt.makeSpan([],[],r):H=Nt.makeSpan([],mi(q,r,!0),r),H.depth=J.depth,H.height=J.height,B.push({type:"elem",elem:H,shift:z})}for(s=0,Z=0;s<o||Z<K.length;++s,++Z){for(var R=K[Z]||{},L=!0;R.type==="separator";){if(L||(re=Nt.makeSpan(["arraycolsep"],[]),re.style.width=Sr(r.fontMetrics().doubleRuleSep),te.push(re)),R.separator==="|"||R.separator===":"){var G=R.separator==="|"?"solid":"dashed",W=Nt.makeSpan(["vertical-separator"],[],r);W.style.height=Sr(_),W.style.borderRightWidth=Sr(d),W.style.borderRightStyle=G,W.style.margin="0 "+Sr(-d/2);var Q=_-U;Q&&(W.style.verticalAlign=Sr(-Q)),te.push(W)}else throw new ir("Invalid separator type: "+R.separator);Z++,R=K[Z]||{},L=!1}if(!(s>=o)){var X=void 0;(s>0||t.hskipBeforeAndAfter)&&(X=Xn.deflt(R.pregap,h),X!==0&&(re=Nt.makeSpan(["arraycolsep"],[]),re.style.width=Sr(X),te.push(re)));var se=[];for(n=0;n<a;++n){var le=c[n],he=le[s];if(he){var we=le.pos-U;he.depth=le.depth,he.height=le.height,se.push({type:"elem",elem:he,shift:we})}}se=Nt.makeVList({positionType:"individualShift",children:se},r),se=Nt.makeSpan(["col-align-"+(R.align||"c")],[se]),te.push(se),(s<o-1||t.hskipBeforeAndAfter)&&(X=Xn.deflt(R.postgap,h),X!==0&&(re=Nt.makeSpan(["arraycolsep"],[]),re.style.width=Sr(X),te.push(re)))}}if(c=Nt.makeSpan(["mtable"],te),u.length>0){for(var ie=Nt.makeLineSpan("hline",r,d),Ee=Nt.makeLineSpan("hdashline",r,d),ye=[{type:"elem",elem:c,shift:0}];u.length>0;){var Ie=u.pop(),ut=Ie.pos-U;Ie.isDashed?ye.push({type:"elem",elem:Ee,shift:ut}):ye.push({type:"elem",elem:ie,shift:ut})}c=Nt.makeVList({positionType:"individualShift",children:ye},r)}if(B.length===0)return Nt.makeSpan(["mord"],[c],r);var Qe=Nt.makeVList({positionType:"individualShift",children:B},r);return Qe=Nt.makeSpan(["tag"],[Qe],r),Nt.makeFragment([c,Qe])},ele={c:"center ",l:"left ",r:"right "},vd=function(t,r){for(var n=[],s=new sr.MathNode("mtd",[],["mtr-glue"]),a=new sr.MathNode("mtd",[],["mml-eqn-num"]),i=0;i<t.body.length;i++){for(var o=t.body[i],c=[],u=0;u<o.length;u++)c.push(new sr.MathNode("mtd",[Es(o[u],r)]));t.tags&&t.tags[i]&&(c.unshift(s),c.push(s),t.leqno?c.unshift(a):c.push(a)),n.push(new sr.MathNode("mtr",c))}var d=new sr.MathNode("mtable",n),f=t.arraystretch===.5?.1:.16+t.arraystretch-1+(t.addJot?.09:0);d.setAttribute("rowspacing",Sr(f));var h="",g="";if(t.cols&&t.cols.length>0){var p=t.cols,x="",v=!1,C=0,b=p.length;p[0].type==="separator"&&(h+="top ",C=1),p[p.length-1].type==="separator"&&(h+="bottom ",b-=1);for(var _=C;_<b;_++)p[_].type==="align"?(g+=ele[p[_].align],v&&(x+="none "),v=!0):p[_].type==="separator"&&v&&(x+=p[_].separator==="|"?"solid ":"dashed ",v=!1);d.setAttribute("columnalign",g.trim()),/[sd]/.test(x)&&d.setAttribute("columnlines",x.trim())}if(t.colSeparationType==="align"){for(var T=t.cols||[],N="",E=1;E<T.length;E++)N+=E%2?"0em ":"1em ";d.setAttribute("columnspacing",N.trim())}else t.colSeparationType==="alignat"||t.colSeparationType==="gather"?d.setAttribute("columnspacing","0em"):t.colSeparationType==="small"?d.setAttribute("columnspacing","0.2778em"):t.colSeparationType==="CD"?d.setAttribute("columnspacing","0.5em"):d.setAttribute("columnspacing","1em");var F="",j=t.hLinesBeforeRow;h+=j[0].length>0?"left ":"",h+=j[j.length-1].length>0?"right ":"";for(var P=1;P<j.length-1;P++)F+=j[P].length===0?"none ":j[P][0]?"dashed ":"solid ";return/[sd]/.test(F)&&d.setAttribute("rowlines",F.trim()),h!==""&&(d=new sr.MathNode("menclose",[d]),d.setAttribute("notation",h.trim())),t.arraystretch&&t.arraystretch<1&&(d=new sr.MathNode("mstyle",[d]),d.setAttribute("scriptlevel","1")),d},tH=function(t,r){t.envName.indexOf("ed")===-1&&jS(t);var n=[],s=t.envName.indexOf("at")>-1?"alignat":"align",a=t.envName==="split",i=xh(t.parser,{cols:n,addJot:!0,autoTag:a?void 0:gN(t.envName),emptySingleRow:!0,colSeparationType:s,maxNumCols:a?2:void 0,leqno:t.parser.settings.leqno},"display"),o,c=0,u={type:"ordgroup",mode:t.mode,body:[]};if(r[0]&&r[0].type==="ordgroup"){for(var d="",f=0;f<r[0].body.length;f++){var h=An(r[0].body[f],"textord");d+=h.text}o=Number(d),c=o*2}var g=!c;i.body.forEach(function(C){for(var b=1;b<C.length;b+=2){var _=An(C[b],"styling"),T=An(_.body[0],"ordgroup");T.body.unshift(u)}if(g)c<C.length&&(c=C.length);else{var N=C.length/2;if(o<N)throw new ir("Too many math in a row: "+("expected "+o+", but got "+N),C[0])}});for(var p=0;p<c;++p){var x="r",v=0;p%2===1?x="l":p>0&&g&&(v=1),n[p]={type:"align",align:x,pregap:v,postgap:0}}return i.colSeparationType=g?"align":"alignat",i};xd({type:"array",names:["array","darray"],props:{numArgs:1},handler(e,t){var r=NS(t[0]),n=r?[t[0]]:An(t[0],"ordgroup").body,s=n.map(function(i){var o=uN(i),c=o.text;if("lcr".indexOf(c)!==-1)return{type:"align",align:c};if(c==="|")return{type:"separator",separator:"|"};if(c===":")return{type:"separator",separator:":"};throw new ir("Unknown column alignment: "+c,i)}),a={cols:s,hskipBeforeAndAfter:!0,maxNumCols:s.length};return xh(e.parser,a,pN(e.envName))},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(e){var t={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[e.envName.replace("*","")],r="c",n={hskipBeforeAndAfter:!1,cols:[{type:"align",align:r}]};if(e.envName.charAt(e.envName.length-1)==="*"){var s=e.parser;if(s.consumeSpaces(),s.fetch().text==="["){if(s.consume(),s.consumeSpaces(),r=s.fetch().text,"lcr".indexOf(r)===-1)throw new ir("Expected l or c or r",s.nextToken);s.consume(),s.consumeSpaces(),s.expect("]"),s.consume(),n.cols=[{type:"align",align:r}]}}var a=xh(e.parser,n,pN(e.envName)),i=Math.max(0,...a.body.map(o=>o.length));return a.cols=new Array(i).fill({type:"align",align:r}),t?{type:"leftright",mode:e.mode,body:[a],left:t[0],right:t[1],rightColor:void 0}:a},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(e){var t={arraystretch:.5},r=xh(e.parser,t,"script");return r.colSeparationType="small",r},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["subarray"],props:{numArgs:1},handler(e,t){var r=NS(t[0]),n=r?[t[0]]:An(t[0],"ordgroup").body,s=n.map(function(i){var o=uN(i),c=o.text;if("lc".indexOf(c)!==-1)return{type:"align",align:c};throw new ir("Unknown column alignment: "+c,i)});if(s.length>1)throw new ir("{subarray} can contain only one column");var a={cols:s,hskipBeforeAndAfter:!1,arraystretch:.5};if(a=xh(e.parser,a,"script"),a.body.length>0&&a.body[0].length>1)throw new ir("{subarray} can contain only one column");return a},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(e){var t={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},r=xh(e.parser,t,pN(e.envName));return{type:"leftright",mode:e.mode,body:[r],left:e.envName.indexOf("r")>-1?".":"\\{",right:e.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:tH,htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(e){["gather","gather*"].includes(e.envName)&&jS(e);var t={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:gN(e.envName),emptySingleRow:!0,leqno:e.parser.settings.leqno};return xh(e.parser,t,"display")},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:tH,htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(e){jS(e);var t={autoTag:gN(e.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:e.parser.settings.leqno};return xh(e.parser,t,"display")},htmlBuilder:yd,mathmlBuilder:vd});xd({type:"array",names:["CD"],props:{numArgs:0},handler(e){return jS(e),$oe(e.parser)},htmlBuilder:yd,mathmlBuilder:vd});ke("\\nonumber","\\gdef\\@eqnsw{0}");ke("\\notag","\\nonumber");Pr({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(e,t){throw new ir(e.funcName+" valid only within array environment")}});var iF=ZW;Pr({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(e,t){var{parser:r,funcName:n}=e,s=t[0];if(s.type!=="ordgroup")throw new ir("Invalid environment name",s);for(var a="",i=0;i<s.body.length;++i)a+=An(s.body[i],"textord").text;if(n==="\\begin"){if(!iF.hasOwnProperty(a))throw new ir("No such environment: "+a,s);var o=iF[a],{args:c,optArgs:u}=r.parseArguments("\\begin{"+a+"}",o),d={mode:r.mode,envName:a,parser:r},f=o.handler(d,c,u);r.expect("\\end",!1);var h=r.nextToken,g=An(r.parseFunction(),"environment");if(g.name!==a)throw new ir("Mismatch: \\begin{"+a+"} matched by \\end{"+g.name+"}",h);return f}return{type:"environment",mode:r.mode,name:a,nameGroup:s}}});var rH=(e,t)=>{var r=e.font,n=t.withFont(r);return Gn(e.body,n)},nH=(e,t)=>{var r=e.font,n=t.withFont(r);return Es(e.body,n)},oF={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};Pr({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t_(t[0]),a=n;return a in oF&&(a=oF[a]),{type:"font",mode:r.mode,font:a.slice(1),body:s}},htmlBuilder:rH,mathmlBuilder:nH});Pr({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(e,t)=>{var{parser:r}=e,n=t[0],s=Xn.isCharacterBox(n);return{type:"mclass",mode:r.mode,mclass:ES(n),body:[{type:"font",mode:r.mode,font:"boldsymbol",body:n}],isCharacterBox:s}}});Pr({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{parser:r,funcName:n,breakOnTokenText:s}=e,{mode:a}=r,i=r.parseExpression(!0,s),o="math"+n.slice(1);return{type:"font",mode:a,font:o,body:{type:"ordgroup",mode:r.mode,body:i}}},htmlBuilder:rH,mathmlBuilder:nH});var sH=(e,t)=>{var r=t;return e==="display"?r=r.id>=sn.SCRIPT.id?r.text():sn.DISPLAY:e==="text"&&r.size===sn.DISPLAY.size?r=sn.TEXT:e==="script"?r=sn.SCRIPT:e==="scriptscript"&&(r=sn.SCRIPTSCRIPT),r},xN=(e,t)=>{var r=sH(e.size,t.style),n=r.fracNum(),s=r.fracDen(),a;a=t.havingStyle(n);var i=Gn(e.numer,a,t);if(e.continued){var o=8.5/t.fontMetrics().ptPerEm,c=3.5/t.fontMetrics().ptPerEm;i.height=i.height<o?o:i.height,i.depth=i.depth<c?c:i.depth}a=t.havingStyle(s);var u=Gn(e.denom,a,t),d,f,h;e.hasBarLine?(e.barSize?(f=aa(e.barSize,t),d=Nt.makeLineSpan("frac-line",t,f)):d=Nt.makeLineSpan("frac-line",t),f=d.height,h=d.height):(d=null,f=0,h=t.fontMetrics().defaultRuleThickness);var g,p,x;r.size===sn.DISPLAY.size||e.size==="display"?(g=t.fontMetrics().num1,f>0?p=3*h:p=7*h,x=t.fontMetrics().denom1):(f>0?(g=t.fontMetrics().num2,p=h):(g=t.fontMetrics().num3,p=3*h),x=t.fontMetrics().denom2);var v;if(d){var b=t.fontMetrics().axisHeight;g-i.depth-(b+.5*f)<p&&(g+=p-(g-i.depth-(b+.5*f))),b-.5*f-(u.height-x)<p&&(x+=p-(b-.5*f-(u.height-x)));var _=-(b-.5*f);v=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:u,shift:x},{type:"elem",elem:d,shift:_},{type:"elem",elem:i,shift:-g}]},t)}else{var C=g-i.depth-(u.height-x);C<p&&(g+=.5*(p-C),x+=.5*(p-C)),v=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:u,shift:x},{type:"elem",elem:i,shift:-g}]},t)}a=t.havingStyle(r),v.height*=a.sizeMultiplier/t.sizeMultiplier,v.depth*=a.sizeMultiplier/t.sizeMultiplier;var T;r.size===sn.DISPLAY.size?T=t.fontMetrics().delim1:r.size===sn.SCRIPTSCRIPT.size?T=t.havingStyle(sn.SCRIPT).fontMetrics().delim2:T=t.fontMetrics().delim2;var N,E;return e.leftDelim==null?N=Vv(t,["mopen"]):N=m0.customSizedDelim(e.leftDelim,T,!0,t.havingStyle(r),e.mode,["mopen"]),e.continued?E=Nt.makeSpan([]):e.rightDelim==null?E=Vv(t,["mclose"]):E=m0.customSizedDelim(e.rightDelim,T,!0,t.havingStyle(r),e.mode,["mclose"]),Nt.makeSpan(["mord"].concat(a.sizingClasses(t)),[N,Nt.makeSpan(["mfrac"],[v]),E],t)},yN=(e,t)=>{var r=new sr.MathNode("mfrac",[Es(e.numer,t),Es(e.denom,t)]);if(!e.hasBarLine)r.setAttribute("linethickness","0px");else if(e.barSize){var n=aa(e.barSize,t);r.setAttribute("linethickness",Sr(n))}var s=sH(e.size,t.style);if(s.size!==t.style.size){r=new sr.MathNode("mstyle",[r]);var a=s.size===sn.DISPLAY.size?"true":"false";r.setAttribute("displaystyle",a),r.setAttribute("scriptlevel","0")}if(e.leftDelim!=null||e.rightDelim!=null){var i=[];if(e.leftDelim!=null){var o=new sr.MathNode("mo",[new sr.TextNode(e.leftDelim.replace("\\",""))]);o.setAttribute("fence","true"),i.push(o)}if(i.push(r),e.rightDelim!=null){var c=new sr.MathNode("mo",[new sr.TextNode(e.rightDelim.replace("\\",""))]);c.setAttribute("fence","true"),i.push(c)}return lN(i)}return r};Pr({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t[0],a=t[1],i,o=null,c=null,u="auto";switch(n){case"\\dfrac":case"\\frac":case"\\tfrac":i=!0;break;case"\\\\atopfrac":i=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":i=!1,o="(",c=")";break;case"\\\\bracefrac":i=!1,o="\\{",c="\\}";break;case"\\\\brackfrac":i=!1,o="[",c="]";break;default:throw new Error("Unrecognized genfrac command")}switch(n){case"\\dfrac":case"\\dbinom":u="display";break;case"\\tfrac":case"\\tbinom":u="text";break}return{type:"genfrac",mode:r.mode,continued:!1,numer:s,denom:a,hasBarLine:i,leftDelim:o,rightDelim:c,size:u,barSize:null}},htmlBuilder:xN,mathmlBuilder:yN});Pr({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t[0],a=t[1];return{type:"genfrac",mode:r.mode,continued:!0,numer:s,denom:a,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});Pr({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(e){var{parser:t,funcName:r,token:n}=e,s;switch(r){case"\\over":s="\\frac";break;case"\\choose":s="\\binom";break;case"\\atop":s="\\\\atopfrac";break;case"\\brace":s="\\\\bracefrac";break;case"\\brack":s="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:t.mode,replaceWith:s,token:n}}});var lF=["display","text","script","scriptscript"],cF=function(t){var r=null;return t.length>0&&(r=t,r=r==="."?null:r),r};Pr({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(e,t){var{parser:r}=e,n=t[4],s=t[5],a=t_(t[0]),i=a.type==="atom"&&a.family==="open"?cF(a.text):null,o=t_(t[1]),c=o.type==="atom"&&o.family==="close"?cF(o.text):null,u=An(t[2],"size"),d,f=null;u.isBlank?d=!0:(f=u.value,d=f.number>0);var h="auto",g=t[3];if(g.type==="ordgroup"){if(g.body.length>0){var p=An(g.body[0],"textord");h=lF[Number(p.text)]}}else g=An(g,"textord"),h=lF[Number(g.text)];return{type:"genfrac",mode:r.mode,numer:n,denom:s,continued:!1,hasBarLine:d,barSize:f,leftDelim:i,rightDelim:c,size:h}},htmlBuilder:xN,mathmlBuilder:yN});Pr({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(e,t){var{parser:r,funcName:n,token:s}=e;return{type:"infix",mode:r.mode,replaceWith:"\\\\abovefrac",size:An(t[0],"size").value,token:s}}});Pr({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t[0],a=jie(An(t[1],"infix").size),i=t[2],o=a.number>0;return{type:"genfrac",mode:r.mode,numer:s,denom:i,continued:!1,hasBarLine:o,barSize:a,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:xN,mathmlBuilder:yN});var aH=(e,t)=>{var r=t.style,n,s;e.type==="supsub"?(n=e.sup?Gn(e.sup,t.havingStyle(r.sup()),t):Gn(e.sub,t.havingStyle(r.sub()),t),s=An(e.base,"horizBrace")):s=An(e,"horizBrace");var a=Gn(s.base,t.havingBaseStyle(sn.DISPLAY)),i=C0.svgSpan(s,t),o;if(s.isOver?(o=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:a},{type:"kern",size:.1},{type:"elem",elem:i}]},t),o.children[0].children[0].children[1].classes.push("svg-align")):(o=Nt.makeVList({positionType:"bottom",positionData:a.depth+.1+i.height,children:[{type:"elem",elem:i},{type:"kern",size:.1},{type:"elem",elem:a}]},t),o.children[0].children[0].children[0].classes.push("svg-align")),n){var c=Nt.makeSpan(["mord",s.isOver?"mover":"munder"],[o],t);s.isOver?o=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:c},{type:"kern",size:.2},{type:"elem",elem:n}]},t):o=Nt.makeVList({positionType:"bottom",positionData:c.depth+.2+n.height+n.depth,children:[{type:"elem",elem:n},{type:"kern",size:.2},{type:"elem",elem:c}]},t)}return Nt.makeSpan(["mord",s.isOver?"mover":"munder"],[o],t)},tle=(e,t)=>{var r=C0.mathMLnode(e.label);return new sr.MathNode(e.isOver?"mover":"munder",[Es(e.base,t),r])};Pr({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(e,t){var{parser:r,funcName:n}=e;return{type:"horizBrace",mode:r.mode,label:n,isOver:/^\\over/.test(n),base:t[0]}},htmlBuilder:aH,mathmlBuilder:tle});Pr({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[1],s=An(t[0],"url").url;return r.settings.isTrusted({command:"\\href",url:s})?{type:"href",mode:r.mode,href:s,body:Da(n)}:r.formatUnsupportedCmd("\\href")},htmlBuilder:(e,t)=>{var r=mi(e.body,t,!1);return Nt.makeAnchor(e.href,[],r,t)},mathmlBuilder:(e,t)=>{var r=ah(e.body,t);return r instanceof Gl||(r=new Gl("mrow",[r])),r.setAttribute("href",e.href),r}});Pr({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=An(t[0],"url").url;if(!r.settings.isTrusted({command:"\\url",url:n}))return r.formatUnsupportedCmd("\\url");for(var s=[],a=0;a<n.length;a++){var i=n[a];i==="~"&&(i="\\textasciitilde"),s.push({type:"textord",mode:"text",text:i})}var o={type:"text",mode:r.mode,font:"\\texttt",body:s};return{type:"href",mode:r.mode,href:n,body:Da(o)}}});Pr({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(e,t){var{parser:r}=e;return{type:"hbox",mode:r.mode,body:Da(t[0])}},htmlBuilder(e,t){var r=mi(e.body,t,!1);return Nt.makeFragment(r)},mathmlBuilder(e,t){return new sr.MathNode("mrow",Nl(e.body,t))}});Pr({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(e,t)=>{var{parser:r,funcName:n,token:s}=e,a=An(t[0],"raw").string,i=t[1];r.settings.strict&&r.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var o,c={};switch(n){case"\\htmlClass":c.class=a,o={command:"\\htmlClass",class:a};break;case"\\htmlId":c.id=a,o={command:"\\htmlId",id:a};break;case"\\htmlStyle":c.style=a,o={command:"\\htmlStyle",style:a};break;case"\\htmlData":{for(var u=a.split(","),d=0;d<u.length;d++){var f=u[d].split("=");if(f.length!==2)throw new ir("Error parsing key-value for \\htmlData");c["data-"+f[0].trim()]=f[1].trim()}o={command:"\\htmlData",attributes:c};break}default:throw new Error("Unrecognized html command")}return r.settings.isTrusted(o)?{type:"html",mode:r.mode,attributes:c,body:Da(i)}:r.formatUnsupportedCmd(n)},htmlBuilder:(e,t)=>{var r=mi(e.body,t,!1),n=["enclosing"];e.attributes.class&&n.push(...e.attributes.class.trim().split(/\s+/));var s=Nt.makeSpan(n,r,t);for(var a in e.attributes)a!=="class"&&e.attributes.hasOwnProperty(a)&&s.setAttribute(a,e.attributes[a]);return s},mathmlBuilder:(e,t)=>ah(e.body,t)});Pr({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e;return{type:"htmlmathml",mode:r.mode,html:Da(t[0]),mathml:Da(t[1])}},htmlBuilder:(e,t)=>{var r=mi(e.html,t,!1);return Nt.makeFragment(r)},mathmlBuilder:(e,t)=>ah(e.mathml,t)});var Y5=function(t){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(t))return{number:+t,unit:"bp"};var r=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(t);if(!r)throw new ir("Invalid size: '"+t+"' in \\includegraphics");var n={number:+(r[1]+r[2]),unit:r[3]};if(!kW(n))throw new ir("Invalid unit: '"+n.unit+"' in \\includegraphics.");return n};Pr({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(e,t,r)=>{var{parser:n}=e,s={number:0,unit:"em"},a={number:.9,unit:"em"},i={number:0,unit:"em"},o="";if(r[0])for(var c=An(r[0],"raw").string,u=c.split(","),d=0;d<u.length;d++){var f=u[d].split("=");if(f.length===2){var h=f[1].trim();switch(f[0].trim()){case"alt":o=h;break;case"width":s=Y5(h);break;case"height":a=Y5(h);break;case"totalheight":i=Y5(h);break;default:throw new ir("Invalid key: '"+f[0]+"' in \\includegraphics.")}}}var g=An(t[0],"url").url;return o===""&&(o=g,o=o.replace(/^.*[\\/]/,""),o=o.substring(0,o.lastIndexOf("."))),n.settings.isTrusted({command:"\\includegraphics",url:g})?{type:"includegraphics",mode:n.mode,alt:o,width:s,height:a,totalheight:i,src:g}:n.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(e,t)=>{var r=aa(e.height,t),n=0;e.totalheight.number>0&&(n=aa(e.totalheight,t)-r);var s=0;e.width.number>0&&(s=aa(e.width,t));var a={height:Sr(r+n)};s>0&&(a.width=Sr(s)),n>0&&(a.verticalAlign=Sr(-n));var i=new toe(e.src,e.alt,a);return i.height=r,i.depth=n,i},mathmlBuilder:(e,t)=>{var r=new sr.MathNode("mglyph",[]);r.setAttribute("alt",e.alt);var n=aa(e.height,t),s=0;if(e.totalheight.number>0&&(s=aa(e.totalheight,t)-n,r.setAttribute("valign",Sr(-s))),r.setAttribute("height",Sr(n+s)),e.width.number>0){var a=aa(e.width,t);r.setAttribute("width",Sr(a))}return r.setAttribute("src",e.src),r}});Pr({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(e,t){var{parser:r,funcName:n}=e,s=An(t[0],"size");if(r.settings.strict){var a=n[1]==="m",i=s.value.unit==="mu";a?(i||r.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" supports only mu units, "+("not "+s.value.unit+" units")),r.mode!=="math"&&r.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" works only in math mode")):i&&r.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+n+" doesn't support mu units")}return{type:"kern",mode:r.mode,dimension:s.value}},htmlBuilder(e,t){return Nt.makeGlue(e.dimension,t)},mathmlBuilder(e,t){var r=aa(e.dimension,t);return new sr.SpaceNode(r)}});Pr({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t[0];return{type:"lap",mode:r.mode,alignment:n.slice(5),body:s}},htmlBuilder:(e,t)=>{var r;e.alignment==="clap"?(r=Nt.makeSpan([],[Gn(e.body,t)]),r=Nt.makeSpan(["inner"],[r],t)):r=Nt.makeSpan(["inner"],[Gn(e.body,t)]);var n=Nt.makeSpan(["fix"],[]),s=Nt.makeSpan([e.alignment],[r,n],t),a=Nt.makeSpan(["strut"]);return a.style.height=Sr(s.height+s.depth),s.depth&&(a.style.verticalAlign=Sr(-s.depth)),s.children.unshift(a),s=Nt.makeSpan(["thinbox"],[s],t),Nt.makeSpan(["mord","vbox"],[s],t)},mathmlBuilder:(e,t)=>{var r=new sr.MathNode("mpadded",[Es(e.body,t)]);if(e.alignment!=="rlap"){var n=e.alignment==="llap"?"-1":"-0.5";r.setAttribute("lspace",n+"width")}return r.setAttribute("width","0px"),r}});Pr({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){var{funcName:r,parser:n}=e,s=n.mode;n.switchMode("math");var a=r==="\\("?"\\)":"$",i=n.parseExpression(!1,a);return n.expect(a),n.switchMode(s),{type:"styling",mode:n.mode,style:"text",body:i}}});Pr({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(e,t){throw new ir("Mismatched "+e.funcName)}});var uF=(e,t)=>{switch(t.style.size){case sn.DISPLAY.size:return e.display;case sn.TEXT.size:return e.text;case sn.SCRIPT.size:return e.script;case sn.SCRIPTSCRIPT.size:return e.scriptscript;default:return e.text}};Pr({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(e,t)=>{var{parser:r}=e;return{type:"mathchoice",mode:r.mode,display:Da(t[0]),text:Da(t[1]),script:Da(t[2]),scriptscript:Da(t[3])}},htmlBuilder:(e,t)=>{var r=uF(e,t),n=mi(r,t,!1);return Nt.makeFragment(n)},mathmlBuilder:(e,t)=>{var r=uF(e,t);return ah(r,t)}});var iH=(e,t,r,n,s,a,i)=>{e=Nt.makeSpan([],[e]);var o=r&&Xn.isCharacterBox(r),c,u;if(t){var d=Gn(t,n.havingStyle(s.sup()),n);u={elem:d,kern:Math.max(n.fontMetrics().bigOpSpacing1,n.fontMetrics().bigOpSpacing3-d.depth)}}if(r){var f=Gn(r,n.havingStyle(s.sub()),n);c={elem:f,kern:Math.max(n.fontMetrics().bigOpSpacing2,n.fontMetrics().bigOpSpacing4-f.height)}}var h;if(u&&c){var g=n.fontMetrics().bigOpSpacing5+c.elem.height+c.elem.depth+c.kern+e.depth+i;h=Nt.makeVList({positionType:"bottom",positionData:g,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:c.elem,marginLeft:Sr(-a)},{type:"kern",size:c.kern},{type:"elem",elem:e},{type:"kern",size:u.kern},{type:"elem",elem:u.elem,marginLeft:Sr(a)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else if(c){var p=e.height-i;h=Nt.makeVList({positionType:"top",positionData:p,children:[{type:"kern",size:n.fontMetrics().bigOpSpacing5},{type:"elem",elem:c.elem,marginLeft:Sr(-a)},{type:"kern",size:c.kern},{type:"elem",elem:e}]},n)}else if(u){var x=e.depth+i;h=Nt.makeVList({positionType:"bottom",positionData:x,children:[{type:"elem",elem:e},{type:"kern",size:u.kern},{type:"elem",elem:u.elem,marginLeft:Sr(a)},{type:"kern",size:n.fontMetrics().bigOpSpacing5}]},n)}else return e;var v=[h];if(c&&a!==0&&!o){var C=Nt.makeSpan(["mspace"],[],n);C.style.marginRight=Sr(a),v.unshift(C)}return Nt.makeSpan(["mop","op-limits"],v,n)},oH=["\\smallint"],O1=(e,t)=>{var r,n,s=!1,a;e.type==="supsub"?(r=e.sup,n=e.sub,a=An(e.base,"op"),s=!0):a=An(e,"op");var i=t.style,o=!1;i.size===sn.DISPLAY.size&&a.symbol&&!oH.includes(a.name)&&(o=!0);var c;if(a.symbol){var u=o?"Size2-Regular":"Size1-Regular",d="";if((a.name==="\\oiint"||a.name==="\\oiiint")&&(d=a.name.slice(1),a.name=d==="oiint"?"\\iint":"\\iiint"),c=Nt.makeSymbol(a.name,u,"math",t,["mop","op-symbol",o?"large-op":"small-op"]),d.length>0){var f=c.italic,h=Nt.staticSvg(d+"Size"+(o?"2":"1"),t);c=Nt.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:0},{type:"elem",elem:h,shift:o?.08:0}]},t),a.name="\\"+d,c.classes.unshift("mop"),c.italic=f}}else if(a.body){var g=mi(a.body,t,!0);g.length===1&&g[0]instanceof Oc?(c=g[0],c.classes[0]="mop"):c=Nt.makeSpan(["mop"],g,t)}else{for(var p=[],x=1;x<a.name.length;x++)p.push(Nt.mathsym(a.name[x],a.mode,t));c=Nt.makeSpan(["mop"],p,t)}var v=0,C=0;return(c instanceof Oc||a.name==="\\oiint"||a.name==="\\oiiint")&&!a.suppressBaseShift&&(v=(c.height-c.depth)/2-t.fontMetrics().axisHeight,C=c.italic),s?iH(c,r,n,t,i,C,v):(v&&(c.style.position="relative",c.style.top=Sr(v)),c)},O2=(e,t)=>{var r;if(e.symbol)r=new Gl("mo",[Dc(e.name,e.mode)]),oH.includes(e.name)&&r.setAttribute("largeop","false");else if(e.body)r=new Gl("mo",Nl(e.body,t));else{r=new Gl("mi",[new ad(e.name.slice(1))]);var n=new Gl("mo",[Dc("","text")]);e.parentIsSupSub?r=new Gl("mrow",[r,n]):r=OW([r,n])}return r},rle={"":"\\prod","":"\\coprod","":"\\sum","":"\\bigwedge","":"\\bigvee","":"\\bigcap","":"\\bigcup","":"\\bigodot","":"\\bigoplus","":"\\bigotimes","":"\\biguplus","":"\\bigsqcup"};Pr({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","","","","","","","","","","","",""],props:{numArgs:0},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=n;return s.length===1&&(s=rle[s]),{type:"op",mode:r.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:s}},htmlBuilder:O1,mathmlBuilder:O2});Pr({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"op",mode:r.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:Da(n)}},htmlBuilder:O1,mathmlBuilder:O2});var nle={"":"\\int","":"\\iint","":"\\iiint","":"\\oint","":"\\oiint","":"\\oiiint"};Pr({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(e){var{parser:t,funcName:r}=e;return{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:r}},htmlBuilder:O1,mathmlBuilder:O2});Pr({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(e){var{parser:t,funcName:r}=e;return{type:"op",mode:t.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:r}},htmlBuilder:O1,mathmlBuilder:O2});Pr({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","","","","","",""],props:{numArgs:0},handler(e){var{parser:t,funcName:r}=e,n=r;return n.length===1&&(n=nle[n]),{type:"op",mode:t.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:n}},htmlBuilder:O1,mathmlBuilder:O2});var lH=(e,t)=>{var r,n,s=!1,a;e.type==="supsub"?(r=e.sup,n=e.sub,a=An(e.base,"operatorname"),s=!0):a=An(e,"operatorname");var i;if(a.body.length>0){for(var o=a.body.map(f=>{var h=f.text;return typeof h=="string"?{type:"textord",mode:f.mode,text:h}:f}),c=mi(o,t.withFont("mathrm"),!0),u=0;u<c.length;u++){var d=c[u];d instanceof Oc&&(d.text=d.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}i=Nt.makeSpan(["mop"],c,t)}else i=Nt.makeSpan(["mop"],[],t);return s?iH(i,r,n,t,t.style,0,0):i},sle=(e,t)=>{for(var r=Nl(e.body,t.withFont("mathrm")),n=!0,s=0;s<r.length;s++){var a=r[s];if(!(a instanceof sr.SpaceNode))if(a instanceof sr.MathNode)switch(a.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var i=a.children[0];a.children.length===1&&i instanceof sr.TextNode?i.text=i.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):n=!1;break}default:n=!1}else n=!1}if(n){var o=r.map(d=>d.toText()).join("");r=[new sr.TextNode(o)]}var c=new sr.MathNode("mi",r);c.setAttribute("mathvariant","normal");var u=new sr.MathNode("mo",[Dc("","text")]);return e.parentIsSupSub?new sr.MathNode("mrow",[c,u]):sr.newDocumentFragment([c,u])};Pr({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(e,t)=>{var{parser:r,funcName:n}=e,s=t[0];return{type:"operatorname",mode:r.mode,body:Da(s),alwaysHandleSupSub:n==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:lH,mathmlBuilder:sle});ke("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");fg({type:"ordgroup",htmlBuilder(e,t){return e.semisimple?Nt.makeFragment(mi(e.body,t,!1)):Nt.makeSpan(["mord"],mi(e.body,t,!0),t)},mathmlBuilder(e,t){return ah(e.body,t,!0)}});Pr({type:"overline",names:["\\overline"],props:{numArgs:1},handler(e,t){var{parser:r}=e,n=t[0];return{type:"overline",mode:r.mode,body:n}},htmlBuilder(e,t){var r=Gn(e.body,t.havingCrampedStyle()),n=Nt.makeLineSpan("overline-line",t),s=t.fontMetrics().defaultRuleThickness,a=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r},{type:"kern",size:3*s},{type:"elem",elem:n},{type:"kern",size:s}]},t);return Nt.makeSpan(["mord","overline"],[a],t)},mathmlBuilder(e,t){var r=new sr.MathNode("mo",[new sr.TextNode("")]);r.setAttribute("stretchy","true");var n=new sr.MathNode("mover",[Es(e.body,t),r]);return n.setAttribute("accent","true"),n}});Pr({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"phantom",mode:r.mode,body:Da(n)}},htmlBuilder:(e,t)=>{var r=mi(e.body,t.withPhantom(),!1);return Nt.makeFragment(r)},mathmlBuilder:(e,t)=>{var r=Nl(e.body,t);return new sr.MathNode("mphantom",r)}});Pr({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"hphantom",mode:r.mode,body:n}},htmlBuilder:(e,t)=>{var r=Nt.makeSpan([],[Gn(e.body,t.withPhantom())]);if(r.height=0,r.depth=0,r.children)for(var n=0;n<r.children.length;n++)r.children[n].height=0,r.children[n].depth=0;return r=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r}]},t),Nt.makeSpan(["mord"],[r],t)},mathmlBuilder:(e,t)=>{var r=Nl(Da(e.body),t),n=new sr.MathNode("mphantom",r),s=new sr.MathNode("mpadded",[n]);return s.setAttribute("height","0px"),s.setAttribute("depth","0px"),s}});Pr({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(e,t)=>{var{parser:r}=e,n=t[0];return{type:"vphantom",mode:r.mode,body:n}},htmlBuilder:(e,t)=>{var r=Nt.makeSpan(["inner"],[Gn(e.body,t.withPhantom())]),n=Nt.makeSpan(["fix"],[]);return Nt.makeSpan(["mord","rlap"],[r,n],t)},mathmlBuilder:(e,t)=>{var r=Nl(Da(e.body),t),n=new sr.MathNode("mphantom",r),s=new sr.MathNode("mpadded",[n]);return s.setAttribute("width","0px"),s}});Pr({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(e,t){var{parser:r}=e,n=An(t[0],"size").value,s=t[1];return{type:"raisebox",mode:r.mode,dy:n,body:s}},htmlBuilder(e,t){var r=Gn(e.body,t),n=aa(e.dy,t);return Nt.makeVList({positionType:"shift",positionData:-n,children:[{type:"elem",elem:r}]},t)},mathmlBuilder(e,t){var r=new sr.MathNode("mpadded",[Es(e.body,t)]),n=e.dy.number+e.dy.unit;return r.setAttribute("voffset",n),r}});Pr({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0,allowedInArgument:!0},handler(e){var{parser:t}=e;return{type:"internal",mode:t.mode}}});Pr({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(e,t,r){var{parser:n}=e,s=r[0],a=An(t[0],"size"),i=An(t[1],"size");return{type:"rule",mode:n.mode,shift:s&&An(s,"size").value,width:a.value,height:i.value}},htmlBuilder(e,t){var r=Nt.makeSpan(["mord","rule"],[],t),n=aa(e.width,t),s=aa(e.height,t),a=e.shift?aa(e.shift,t):0;return r.style.borderRightWidth=Sr(n),r.style.borderTopWidth=Sr(s),r.style.bottom=Sr(a),r.width=n,r.height=s+a,r.depth=-a,r.maxFontSize=s*1.125*t.sizeMultiplier,r},mathmlBuilder(e,t){var r=aa(e.width,t),n=aa(e.height,t),s=e.shift?aa(e.shift,t):0,a=t.color&&t.getColor()||"black",i=new sr.MathNode("mspace");i.setAttribute("mathbackground",a),i.setAttribute("width",Sr(r)),i.setAttribute("height",Sr(n));var o=new sr.MathNode("mpadded",[i]);return s>=0?o.setAttribute("height",Sr(s)):(o.setAttribute("height",Sr(s)),o.setAttribute("depth",Sr(-s))),o.setAttribute("voffset",Sr(s)),o}});function cH(e,t,r){for(var n=mi(e,t,!1),s=t.sizeMultiplier/r.sizeMultiplier,a=0;a<n.length;a++){var i=n[a].classes.indexOf("sizing");i<0?Array.prototype.push.apply(n[a].classes,t.sizingClasses(r)):n[a].classes[i+1]==="reset-size"+t.size&&(n[a].classes[i+1]="reset-size"+r.size),n[a].height*=s,n[a].depth*=s}return Nt.makeFragment(n)}var dF=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],ale=(e,t)=>{var r=t.havingSize(e.size);return cH(e.body,r,t)};Pr({type:"sizing",names:dF,props:{numArgs:0,allowedInText:!0},handler:(e,t)=>{var{breakOnTokenText:r,funcName:n,parser:s}=e,a=s.parseExpression(!1,r);return{type:"sizing",mode:s.mode,size:dF.indexOf(n)+1,body:a}},htmlBuilder:ale,mathmlBuilder:(e,t)=>{var r=t.havingSize(e.size),n=Nl(e.body,r),s=new sr.MathNode("mstyle",n);return s.setAttribute("mathsize",Sr(r.sizeMultiplier)),s}});Pr({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(e,t,r)=>{var{parser:n}=e,s=!1,a=!1,i=r[0]&&An(r[0],"ordgroup");if(i)for(var o="",c=0;c<i.body.length;++c){var u=i.body[c];if(o=u.text,o==="t")s=!0;else if(o==="b")a=!0;else{s=!1,a=!1;break}}else s=!0,a=!0;var d=t[0];return{type:"smash",mode:n.mode,body:d,smashHeight:s,smashDepth:a}},htmlBuilder:(e,t)=>{var r=Nt.makeSpan([],[Gn(e.body,t)]);if(!e.smashHeight&&!e.smashDepth)return r;if(e.smashHeight&&(r.height=0,r.children))for(var n=0;n<r.children.length;n++)r.children[n].height=0;if(e.smashDepth&&(r.depth=0,r.children))for(var s=0;s<r.children.length;s++)r.children[s].depth=0;var a=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r}]},t);return Nt.makeSpan(["mord"],[a],t)},mathmlBuilder:(e,t)=>{var r=new sr.MathNode("mpadded",[Es(e.body,t)]);return e.smashHeight&&r.setAttribute("height","0px"),e.smashDepth&&r.setAttribute("depth","0px"),r}});Pr({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(e,t,r){var{parser:n}=e,s=r[0],a=t[0];return{type:"sqrt",mode:n.mode,body:a,index:s}},htmlBuilder(e,t){var r=Gn(e.body,t.havingCrampedStyle());r.height===0&&(r.height=t.fontMetrics().xHeight),r=Nt.wrapFragment(r,t);var n=t.fontMetrics(),s=n.defaultRuleThickness,a=s;t.style.id<sn.TEXT.id&&(a=t.fontMetrics().xHeight);var i=s+a/4,o=r.height+r.depth+i+s,{span:c,ruleWidth:u,advanceWidth:d}=m0.sqrtImage(o,t),f=c.height-u;f>r.height+r.depth+i&&(i=(i+f-r.height-r.depth)/2);var h=c.height-r.height-i-u;r.style.paddingLeft=Sr(d);var g=Nt.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:r,wrapperClasses:["svg-align"]},{type:"kern",size:-(r.height+h)},{type:"elem",elem:c},{type:"kern",size:u}]},t);if(e.index){var p=t.havingStyle(sn.SCRIPTSCRIPT),x=Gn(e.index,p,t),v=.6*(g.height-g.depth),C=Nt.makeVList({positionType:"shift",positionData:-v,children:[{type:"elem",elem:x}]},t),b=Nt.makeSpan(["root"],[C]);return Nt.makeSpan(["mord","sqrt"],[b,g],t)}else return Nt.makeSpan(["mord","sqrt"],[g],t)},mathmlBuilder(e,t){var{body:r,index:n}=e;return n?new sr.MathNode("mroot",[Es(r,t),Es(n,t)]):new sr.MathNode("msqrt",[Es(r,t)])}});var fF={display:sn.DISPLAY,text:sn.TEXT,script:sn.SCRIPT,scriptscript:sn.SCRIPTSCRIPT};Pr({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(e,t){var{breakOnTokenText:r,funcName:n,parser:s}=e,a=s.parseExpression(!0,r),i=n.slice(1,n.length-5);return{type:"styling",mode:s.mode,style:i,body:a}},htmlBuilder(e,t){var r=fF[e.style],n=t.havingStyle(r).withFont("");return cH(e.body,n,t)},mathmlBuilder(e,t){var r=fF[e.style],n=t.havingStyle(r),s=Nl(e.body,n),a=new sr.MathNode("mstyle",s),i={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},o=i[e.style];return a.setAttribute("scriptlevel",o[0]),a.setAttribute("displaystyle",o[1]),a}});var ile=function(t,r){var n=t.base;if(n)if(n.type==="op"){var s=n.limits&&(r.style.size===sn.DISPLAY.size||n.alwaysHandleSupSub);return s?O1:null}else if(n.type==="operatorname"){var a=n.alwaysHandleSupSub&&(r.style.size===sn.DISPLAY.size||n.limits);return a?lH:null}else{if(n.type==="accent")return Xn.isCharacterBox(n.base)?dN:null;if(n.type==="horizBrace"){var i=!t.sub;return i===n.isOver?aH:null}else return null}else return null};fg({type:"supsub",htmlBuilder(e,t){var r=ile(e,t);if(r)return r(e,t);var{base:n,sup:s,sub:a}=e,i=Gn(n,t),o,c,u=t.fontMetrics(),d=0,f=0,h=n&&Xn.isCharacterBox(n);if(s){var g=t.havingStyle(t.style.sup());o=Gn(s,g,t),h||(d=i.height-g.fontMetrics().supDrop*g.sizeMultiplier/t.sizeMultiplier)}if(a){var p=t.havingStyle(t.style.sub());c=Gn(a,p,t),h||(f=i.depth+p.fontMetrics().subDrop*p.sizeMultiplier/t.sizeMultiplier)}var x;t.style===sn.DISPLAY?x=u.sup1:t.style.cramped?x=u.sup3:x=u.sup2;var v=t.sizeMultiplier,C=Sr(.5/u.ptPerEm/v),b=null;if(c){var _=e.base&&e.base.type==="op"&&e.base.name&&(e.base.name==="\\oiint"||e.base.name==="\\oiiint");(i instanceof Oc||_)&&(b=Sr(-i.italic))}var T;if(o&&c){d=Math.max(d,x,o.depth+.25*u.xHeight),f=Math.max(f,u.sub2);var N=u.defaultRuleThickness,E=4*N;if(d-o.depth-(c.height-f)<E){f=E-(d-o.depth)+c.height;var F=.8*u.xHeight-(d-o.depth);F>0&&(d+=F,f-=F)}var j=[{type:"elem",elem:c,shift:f,marginRight:C,marginLeft:b},{type:"elem",elem:o,shift:-d,marginRight:C}];T=Nt.makeVList({positionType:"individualShift",children:j},t)}else if(c){f=Math.max(f,u.sub1,c.height-.8*u.xHeight);var P=[{type:"elem",elem:c,marginLeft:b,marginRight:C}];T=Nt.makeVList({positionType:"shift",positionData:f,children:P},t)}else if(o)d=Math.max(d,x,o.depth+.25*u.xHeight),T=Nt.makeVList({positionType:"shift",positionData:-d,children:[{type:"elem",elem:o,marginRight:C}]},t);else throw new Error("supsub must have either sup or sub.");var M=bT(i,"right")||"mord";return Nt.makeSpan([M],[i,Nt.makeSpan(["msupsub"],[T])],t)},mathmlBuilder(e,t){var r=!1,n,s;e.base&&e.base.type==="horizBrace"&&(s=!!e.sup,s===e.base.isOver&&(r=!0,n=e.base.isOver)),e.base&&(e.base.type==="op"||e.base.type==="operatorname")&&(e.base.parentIsSupSub=!0);var a=[Es(e.base,t)];e.sub&&a.push(Es(e.sub,t)),e.sup&&a.push(Es(e.sup,t));var i;if(r)i=n?"mover":"munder";else if(e.sub)if(e.sup){var u=e.base;u&&u.type==="op"&&u.limits&&t.style===sn.DISPLAY||u&&u.type==="operatorname"&&u.alwaysHandleSupSub&&(t.style===sn.DISPLAY||u.limits)?i="munderover":i="msubsup"}else{var c=e.base;c&&c.type==="op"&&c.limits&&(t.style===sn.DISPLAY||c.alwaysHandleSupSub)||c&&c.type==="operatorname"&&c.alwaysHandleSupSub&&(c.limits||t.style===sn.DISPLAY)?i="munder":i="msub"}else{var o=e.base;o&&o.type==="op"&&o.limits&&(t.style===sn.DISPLAY||o.alwaysHandleSupSub)||o&&o.type==="operatorname"&&o.alwaysHandleSupSub&&(o.limits||t.style===sn.DISPLAY)?i="mover":i="msup"}return new sr.MathNode(i,a)}});fg({type:"atom",htmlBuilder(e,t){return Nt.mathsym(e.text,e.mode,t,["m"+e.family])},mathmlBuilder(e,t){var r=new sr.MathNode("mo",[Dc(e.text,e.mode)]);if(e.family==="bin"){var n=cN(e,t);n==="bold-italic"&&r.setAttribute("mathvariant",n)}else e.family==="punct"?r.setAttribute("separator","true"):(e.family==="open"||e.family==="close")&&r.setAttribute("stretchy","false");return r}});var uH={mi:"italic",mn:"normal",mtext:"normal"};fg({type:"mathord",htmlBuilder(e,t){return Nt.makeOrd(e,t,"mathord")},mathmlBuilder(e,t){var r=new sr.MathNode("mi",[Dc(e.text,e.mode,t)]),n=cN(e,t)||"italic";return n!==uH[r.type]&&r.setAttribute("mathvariant",n),r}});fg({type:"textord",htmlBuilder(e,t){return Nt.makeOrd(e,t,"textord")},mathmlBuilder(e,t){var r=Dc(e.text,e.mode,t),n=cN(e,t)||"normal",s;return e.mode==="text"?s=new sr.MathNode("mtext",[r]):/[0-9]/.test(e.text)?s=new sr.MathNode("mn",[r]):e.text==="\\prime"?s=new sr.MathNode("mo",[r]):s=new sr.MathNode("mi",[r]),n!==uH[s.type]&&s.setAttribute("mathvariant",n),s}});var X5={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},J5={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};fg({type:"spacing",htmlBuilder(e,t){if(J5.hasOwnProperty(e.text)){var r=J5[e.text].className||"";if(e.mode==="text"){var n=Nt.makeOrd(e,t,"textord");return n.classes.push(r),n}else return Nt.makeSpan(["mspace",r],[Nt.mathsym(e.text,e.mode,t)],t)}else{if(X5.hasOwnProperty(e.text))return Nt.makeSpan(["mspace",X5[e.text]],[],t);throw new ir('Unknown type of space "'+e.text+'"')}},mathmlBuilder(e,t){var r;if(J5.hasOwnProperty(e.text))r=new sr.MathNode("mtext",[new sr.TextNode("")]);else{if(X5.hasOwnProperty(e.text))return new sr.MathNode("mspace");throw new ir('Unknown type of space "'+e.text+'"')}return r}});var hF=()=>{var e=new sr.MathNode("mtd",[]);return e.setAttribute("width","50%"),e};fg({type:"tag",mathmlBuilder(e,t){var r=new sr.MathNode("mtable",[new sr.MathNode("mtr",[hF(),new sr.MathNode("mtd",[ah(e.body,t)]),hF(),new sr.MathNode("mtd",[ah(e.tag,t)])])]);return r.setAttribute("width","100%"),r}});var mF={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},gF={"\\textbf":"textbf","\\textmd":"textmd"},ole={"\\textit":"textit","\\textup":"textup"},pF=(e,t)=>{var r=e.font;if(r){if(mF[r])return t.withTextFontFamily(mF[r]);if(gF[r])return t.withTextFontWeight(gF[r]);if(r==="\\emph")return t.fontShape==="textit"?t.withTextFontShape("textup"):t.withTextFontShape("textit")}else return t;return t.withTextFontShape(ole[r])};Pr({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(e,t){var{parser:r,funcName:n}=e,s=t[0];return{type:"text",mode:r.mode,body:Da(s),font:n}},htmlBuilder(e,t){var r=pF(e,t),n=mi(e.body,r,!0);return Nt.makeSpan(["mord","text"],n,r)},mathmlBuilder(e,t){var r=pF(e,t);return ah(e.body,r)}});Pr({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(e,t){var{parser:r}=e;return{type:"underline",mode:r.mode,body:t[0]}},htmlBuilder(e,t){var r=Gn(e.body,t),n=Nt.makeLineSpan("underline-line",t),s=t.fontMetrics().defaultRuleThickness,a=Nt.makeVList({positionType:"top",positionData:r.height,children:[{type:"kern",size:s},{type:"elem",elem:n},{type:"kern",size:3*s},{type:"elem",elem:r}]},t);return Nt.makeSpan(["mord","underline"],[a],t)},mathmlBuilder(e,t){var r=new sr.MathNode("mo",[new sr.TextNode("")]);r.setAttribute("stretchy","true");var n=new sr.MathNode("munder",[Es(e.body,t),r]);return n.setAttribute("accentunder","true"),n}});Pr({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(e,t){var{parser:r}=e;return{type:"vcenter",mode:r.mode,body:t[0]}},htmlBuilder(e,t){var r=Gn(e.body,t),n=t.fontMetrics().axisHeight,s=.5*(r.height-n-(r.depth+n));return Nt.makeVList({positionType:"shift",positionData:s,children:[{type:"elem",elem:r}]},t)},mathmlBuilder(e,t){return new sr.MathNode("mpadded",[Es(e.body,t)],["vcenter"])}});Pr({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(e,t,r){throw new ir("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(e,t){for(var r=xF(e),n=[],s=t.havingStyle(t.style.text()),a=0;a<r.length;a++){var i=r[a];i==="~"&&(i="\\textasciitilde"),n.push(Nt.makeSymbol(i,"Typewriter-Regular",e.mode,s,["mord","texttt"]))}return Nt.makeSpan(["mord","text"].concat(s.sizingClasses(t)),Nt.tryCombineChars(n),s)},mathmlBuilder(e,t){var r=new sr.TextNode(xF(e)),n=new sr.MathNode("mtext",[r]);return n.setAttribute("mathvariant","monospace"),n}});var xF=e=>e.body.replace(/ /g,e.star?"":""),zf=MW,dH=`[ \r
	]`,lle="\\\\[a-zA-Z@]+",cle="\\\\[^\uD800-\uDFFF]",ule="("+lle+")"+dH+"*",dle=`\\\\(
|[ \r	]+
?)[ \r	]*`,kT="[-]",fle=new RegExp(kT+"+$"),hle="("+dH+"+)|"+(dle+"|")+"([!-\\[\\]---]"+(kT+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(kT+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+ule)+("|"+cle+")");class yF{constructor(t,r){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=t,this.settings=r,this.tokenRegex=new RegExp(hle,"g"),this.catcodes={"%":14,"~":13}}setCatcode(t,r){this.catcodes[t]=r}lex(){var t=this.input,r=this.tokenRegex.lastIndex;if(r===t.length)return new Yl("EOF",new xl(this,r,r));var n=this.tokenRegex.exec(t);if(n===null||n.index!==r)throw new ir("Unexpected character: '"+t[r]+"'",new Yl(t[r],new xl(this,r,r+1)));var s=n[6]||n[3]||(n[2]?"\\ ":" ");if(this.catcodes[s]===14){var a=t.indexOf(`
`,this.tokenRegex.lastIndex);return a===-1?(this.tokenRegex.lastIndex=t.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=a+1,this.lex()}return new Yl(s,new xl(this,r,this.tokenRegex.lastIndex))}}class mle{constructor(t,r){t===void 0&&(t={}),r===void 0&&(r={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=r,this.builtins=t,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new ir("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var t=this.undefStack.pop();for(var r in t)t.hasOwnProperty(r)&&(t[r]==null?delete this.current[r]:this.current[r]=t[r])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(t){return this.current.hasOwnProperty(t)||this.builtins.hasOwnProperty(t)}get(t){return this.current.hasOwnProperty(t)?this.current[t]:this.builtins[t]}set(t,r,n){if(n===void 0&&(n=!1),n){for(var s=0;s<this.undefStack.length;s++)delete this.undefStack[s][t];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][t]=r)}else{var a=this.undefStack[this.undefStack.length-1];a&&!a.hasOwnProperty(t)&&(a[t]=this.current[t])}r==null?delete this.current[t]:this.current[t]=r}}var gle=eH;ke("\\noexpand",function(e){var t=e.popToken();return e.isExpandable(t.text)&&(t.noexpand=!0,t.treatAsRelax=!0),{tokens:[t],numArgs:0}});ke("\\expandafter",function(e){var t=e.popToken();return e.expandOnce(!0),{tokens:[t],numArgs:0}});ke("\\@firstoftwo",function(e){var t=e.consumeArgs(2);return{tokens:t[0],numArgs:0}});ke("\\@secondoftwo",function(e){var t=e.consumeArgs(2);return{tokens:t[1],numArgs:0}});ke("\\@ifnextchar",function(e){var t=e.consumeArgs(3);e.consumeSpaces();var r=e.future();return t[0].length===1&&t[0][0].text===r.text?{tokens:t[1],numArgs:0}:{tokens:t[2],numArgs:0}});ke("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");ke("\\TextOrMath",function(e){var t=e.consumeArgs(2);return e.mode==="text"?{tokens:t[0],numArgs:0}:{tokens:t[1],numArgs:0}});var vF={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};ke("\\char",function(e){var t=e.popToken(),r,n="";if(t.text==="'")r=8,t=e.popToken();else if(t.text==='"')r=16,t=e.popToken();else if(t.text==="`")if(t=e.popToken(),t.text[0]==="\\")n=t.text.charCodeAt(1);else{if(t.text==="EOF")throw new ir("\\char` missing argument");n=t.text.charCodeAt(0)}else r=10;if(r){if(n=vF[t.text],n==null||n>=r)throw new ir("Invalid base-"+r+" digit "+t.text);for(var s;(s=vF[e.future().text])!=null&&s<r;)n*=r,n+=s,e.popToken()}return"\\@char{"+n+"}"});var vN=(e,t,r,n)=>{var s=e.consumeArg().tokens;if(s.length!==1)throw new ir("\\newcommand's first argument must be a macro name");var a=s[0].text,i=e.isDefined(a);if(i&&!t)throw new ir("\\newcommand{"+a+"} attempting to redefine "+(a+"; use \\renewcommand"));if(!i&&!r)throw new ir("\\renewcommand{"+a+"} when command "+a+" does not yet exist; use \\newcommand");var o=0;if(s=e.consumeArg().tokens,s.length===1&&s[0].text==="["){for(var c="",u=e.expandNextToken();u.text!=="]"&&u.text!=="EOF";)c+=u.text,u=e.expandNextToken();if(!c.match(/^\s*[0-9]+\s*$/))throw new ir("Invalid number of arguments: "+c);o=parseInt(c),s=e.consumeArg().tokens}return i&&n||e.macros.set(a,{tokens:s,numArgs:o}),""};ke("\\newcommand",e=>vN(e,!1,!0,!1));ke("\\renewcommand",e=>vN(e,!0,!1,!1));ke("\\providecommand",e=>vN(e,!0,!0,!0));ke("\\message",e=>{var t=e.consumeArgs(1)[0];return console.log(t.reverse().map(r=>r.text).join("")),""});ke("\\errmessage",e=>{var t=e.consumeArgs(1)[0];return console.error(t.reverse().map(r=>r.text).join("")),""});ke("\\show",e=>{var t=e.popToken(),r=t.text;return console.log(t,e.macros.get(r),zf[r],Is.math[r],Is.text[r]),""});ke("\\bgroup","{");ke("\\egroup","}");ke("~","\\nobreakspace");ke("\\lq","`");ke("\\rq","'");ke("\\aa","\\r a");ke("\\AA","\\r A");ke("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`}");ke("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");ke("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`}");ke("","\\mathscr{B}");ke("","\\mathscr{E}");ke("","\\mathscr{F}");ke("","\\mathscr{H}");ke("","\\mathscr{I}");ke("","\\mathscr{L}");ke("","\\mathscr{M}");ke("","\\mathscr{R}");ke("","\\mathfrak{C}");ke("","\\mathfrak{H}");ke("","\\mathfrak{Z}");ke("\\Bbbk","\\Bbb{k}");ke("","\\cdotp");ke("\\llap","\\mathllap{\\textrm{#1}}");ke("\\rlap","\\mathrlap{\\textrm{#1}}");ke("\\clap","\\mathclap{\\textrm{#1}}");ke("\\mathstrut","\\vphantom{(}");ke("\\underbar","\\underline{\\text{#1}}");ke("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');ke("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`}}");ke("\\ne","\\neq");ke("","\\neq");ke("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`}}");ke("","\\notin");ke("","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`}}");ke("","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`}}");ke("","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`}}");ke("","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`}}");ke("","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`}}");ke("","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`}}");ke("","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`}}");ke("","\\perp");ke("","\\mathclose{!\\mkern-0.8mu!}");ke("","\\notni");ke("","\\ulcorner");ke("","\\urcorner");ke("","\\llcorner");ke("","\\lrcorner");ke("","\\copyright");ke("","\\textregistered");ke("","\\textregistered");ke("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');ke("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');ke("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');ke("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');ke("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");ke("","\\vdots");ke("\\varGamma","\\mathit{\\Gamma}");ke("\\varDelta","\\mathit{\\Delta}");ke("\\varTheta","\\mathit{\\Theta}");ke("\\varLambda","\\mathit{\\Lambda}");ke("\\varXi","\\mathit{\\Xi}");ke("\\varPi","\\mathit{\\Pi}");ke("\\varSigma","\\mathit{\\Sigma}");ke("\\varUpsilon","\\mathit{\\Upsilon}");ke("\\varPhi","\\mathit{\\Phi}");ke("\\varPsi","\\mathit{\\Psi}");ke("\\varOmega","\\mathit{\\Omega}");ke("\\substack","\\begin{subarray}{c}#1\\end{subarray}");ke("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");ke("\\boxed","\\fbox{$\\displaystyle{#1}$}");ke("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");ke("\\implies","\\DOTSB\\;\\Longrightarrow\\;");ke("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");ke("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}");ke("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var bF={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};ke("\\dots",function(e){var t="\\dotso",r=e.expandAfterFuture().text;return r in bF?t=bF[r]:(r.slice(0,4)==="\\not"||r in Is.math&&["bin","rel"].includes(Is.math[r].group))&&(t="\\dotsb"),t});var bN={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};ke("\\dotso",function(e){var t=e.future().text;return t in bN?"\\ldots\\,":"\\ldots"});ke("\\dotsc",function(e){var t=e.future().text;return t in bN&&t!==","?"\\ldots\\,":"\\ldots"});ke("\\cdots",function(e){var t=e.future().text;return t in bN?"\\@cdots\\,":"\\@cdots"});ke("\\dotsb","\\cdots");ke("\\dotsm","\\cdots");ke("\\dotsi","\\!\\cdots");ke("\\dotsx","\\ldots\\,");ke("\\DOTSI","\\relax");ke("\\DOTSB","\\relax");ke("\\DOTSX","\\relax");ke("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");ke("\\,","\\tmspace+{3mu}{.1667em}");ke("\\thinspace","\\,");ke("\\>","\\mskip{4mu}");ke("\\:","\\tmspace+{4mu}{.2222em}");ke("\\medspace","\\:");ke("\\;","\\tmspace+{5mu}{.2777em}");ke("\\thickspace","\\;");ke("\\!","\\tmspace-{3mu}{.1667em}");ke("\\negthinspace","\\!");ke("\\negmedspace","\\tmspace-{4mu}{.2222em}");ke("\\negthickspace","\\tmspace-{5mu}{.277em}");ke("\\enspace","\\kern.5em ");ke("\\enskip","\\hskip.5em\\relax");ke("\\quad","\\hskip1em\\relax");ke("\\qquad","\\hskip2em\\relax");ke("\\tag","\\@ifstar\\tag@literal\\tag@paren");ke("\\tag@paren","\\tag@literal{({#1})}");ke("\\tag@literal",e=>{if(e.macros.get("\\df@tag"))throw new ir("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});ke("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");ke("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");ke("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");ke("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");ke("\\newline","\\\\\\relax");ke("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var fH=Sr(sd["Main-Regular"][84][1]-.7*sd["Main-Regular"][65][1]);ke("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+fH+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");ke("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+fH+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");ke("\\hspace","\\@ifstar\\@hspacer\\@hspace");ke("\\@hspace","\\hskip #1\\relax");ke("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");ke("\\ordinarycolon",":");ke("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");ke("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');ke("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');ke("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');ke("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');ke("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');ke("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');ke("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');ke("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');ke("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');ke("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');ke("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');ke("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');ke("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');ke("","\\dblcolon");ke("","\\eqcolon");ke("","\\coloneqq");ke("","\\eqqcolon");ke("","\\Coloneqq");ke("\\ratio","\\vcentcolon");ke("\\coloncolon","\\dblcolon");ke("\\colonequals","\\coloneqq");ke("\\coloncolonequals","\\Coloneqq");ke("\\equalscolon","\\eqqcolon");ke("\\equalscoloncolon","\\Eqqcolon");ke("\\colonminus","\\coloneq");ke("\\coloncolonminus","\\Coloneq");ke("\\minuscolon","\\eqcolon");ke("\\minuscoloncolon","\\Eqcolon");ke("\\coloncolonapprox","\\Colonapprox");ke("\\coloncolonsim","\\Colonsim");ke("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");ke("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");ke("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");ke("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");ke("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`}}");ke("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");ke("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");ke("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");ke("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");ke("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");ke("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");ke("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");ke("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");ke("\\gvertneqq","\\html@mathml{\\@gvertneqq}{}");ke("\\lvertneqq","\\html@mathml{\\@lvertneqq}{}");ke("\\ngeqq","\\html@mathml{\\@ngeqq}{}");ke("\\ngeqslant","\\html@mathml{\\@ngeqslant}{}");ke("\\nleqq","\\html@mathml{\\@nleqq}{}");ke("\\nleqslant","\\html@mathml{\\@nleqslant}{}");ke("\\nshortmid","\\html@mathml{\\@nshortmid}{}");ke("\\nshortparallel","\\html@mathml{\\@nshortparallel}{}");ke("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{}");ke("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{}");ke("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{}");ke("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{}");ke("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{}");ke("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{}");ke("\\imath","\\html@mathml{\\@imath}{}");ke("\\jmath","\\html@mathml{\\@jmath}{}");ke("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`}}");ke("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`}}");ke("","\\llbracket");ke("","\\rrbracket");ke("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`}}");ke("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`}}");ke("","\\lBrace");ke("","\\rBrace");ke("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`}}");ke("","\\minuso");ke("\\darr","\\downarrow");ke("\\dArr","\\Downarrow");ke("\\Darr","\\Downarrow");ke("\\lang","\\langle");ke("\\rang","\\rangle");ke("\\uarr","\\uparrow");ke("\\uArr","\\Uparrow");ke("\\Uarr","\\Uparrow");ke("\\N","\\mathbb{N}");ke("\\R","\\mathbb{R}");ke("\\Z","\\mathbb{Z}");ke("\\alef","\\aleph");ke("\\alefsym","\\aleph");ke("\\Alpha","\\mathrm{A}");ke("\\Beta","\\mathrm{B}");ke("\\bull","\\bullet");ke("\\Chi","\\mathrm{X}");ke("\\clubs","\\clubsuit");ke("\\cnums","\\mathbb{C}");ke("\\Complex","\\mathbb{C}");ke("\\Dagger","\\ddagger");ke("\\diamonds","\\diamondsuit");ke("\\empty","\\emptyset");ke("\\Epsilon","\\mathrm{E}");ke("\\Eta","\\mathrm{H}");ke("\\exist","\\exists");ke("\\harr","\\leftrightarrow");ke("\\hArr","\\Leftrightarrow");ke("\\Harr","\\Leftrightarrow");ke("\\hearts","\\heartsuit");ke("\\image","\\Im");ke("\\infin","\\infty");ke("\\Iota","\\mathrm{I}");ke("\\isin","\\in");ke("\\Kappa","\\mathrm{K}");ke("\\larr","\\leftarrow");ke("\\lArr","\\Leftarrow");ke("\\Larr","\\Leftarrow");ke("\\lrarr","\\leftrightarrow");ke("\\lrArr","\\Leftrightarrow");ke("\\Lrarr","\\Leftrightarrow");ke("\\Mu","\\mathrm{M}");ke("\\natnums","\\mathbb{N}");ke("\\Nu","\\mathrm{N}");ke("\\Omicron","\\mathrm{O}");ke("\\plusmn","\\pm");ke("\\rarr","\\rightarrow");ke("\\rArr","\\Rightarrow");ke("\\Rarr","\\Rightarrow");ke("\\real","\\Re");ke("\\reals","\\mathbb{R}");ke("\\Reals","\\mathbb{R}");ke("\\Rho","\\mathrm{P}");ke("\\sdot","\\cdot");ke("\\sect","\\S");ke("\\spades","\\spadesuit");ke("\\sub","\\subset");ke("\\sube","\\subseteq");ke("\\supe","\\supseteq");ke("\\Tau","\\mathrm{T}");ke("\\thetasym","\\vartheta");ke("\\weierp","\\wp");ke("\\Zeta","\\mathrm{Z}");ke("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");ke("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");ke("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");ke("\\bra","\\mathinner{\\langle{#1}|}");ke("\\ket","\\mathinner{|{#1}\\rangle}");ke("\\braket","\\mathinner{\\langle{#1}\\rangle}");ke("\\Bra","\\left\\langle#1\\right|");ke("\\Ket","\\left|#1\\right\\rangle");var hH=e=>t=>{var r=t.consumeArg().tokens,n=t.consumeArg().tokens,s=t.consumeArg().tokens,a=t.consumeArg().tokens,i=t.macros.get("|"),o=t.macros.get("\\|");t.macros.beginGroup();var c=f=>h=>{e&&(h.macros.set("|",i),s.length&&h.macros.set("\\|",o));var g=f;if(!f&&s.length){var p=h.future();p.text==="|"&&(h.popToken(),g=!0)}return{tokens:g?s:n,numArgs:0}};t.macros.set("|",c(!1)),s.length&&t.macros.set("\\|",c(!0));var u=t.consumeArg().tokens,d=t.expandTokens([...a,...u,...r]);return t.macros.endGroup(),{tokens:d.reverse(),numArgs:0}};ke("\\bra@ket",hH(!1));ke("\\bra@set",hH(!0));ke("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");ke("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");ke("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");ke("\\angln","{\\angl n}");ke("\\blue","\\textcolor{##6495ed}{#1}");ke("\\orange","\\textcolor{##ffa500}{#1}");ke("\\pink","\\textcolor{##ff00af}{#1}");ke("\\red","\\textcolor{##df0030}{#1}");ke("\\green","\\textcolor{##28ae7b}{#1}");ke("\\gray","\\textcolor{gray}{#1}");ke("\\purple","\\textcolor{##9d38bd}{#1}");ke("\\blueA","\\textcolor{##ccfaff}{#1}");ke("\\blueB","\\textcolor{##80f6ff}{#1}");ke("\\blueC","\\textcolor{##63d9ea}{#1}");ke("\\blueD","\\textcolor{##11accd}{#1}");ke("\\blueE","\\textcolor{##0c7f99}{#1}");ke("\\tealA","\\textcolor{##94fff5}{#1}");ke("\\tealB","\\textcolor{##26edd5}{#1}");ke("\\tealC","\\textcolor{##01d1c1}{#1}");ke("\\tealD","\\textcolor{##01a995}{#1}");ke("\\tealE","\\textcolor{##208170}{#1}");ke("\\greenA","\\textcolor{##b6ffb0}{#1}");ke("\\greenB","\\textcolor{##8af281}{#1}");ke("\\greenC","\\textcolor{##74cf70}{#1}");ke("\\greenD","\\textcolor{##1fab54}{#1}");ke("\\greenE","\\textcolor{##0d923f}{#1}");ke("\\goldA","\\textcolor{##ffd0a9}{#1}");ke("\\goldB","\\textcolor{##ffbb71}{#1}");ke("\\goldC","\\textcolor{##ff9c39}{#1}");ke("\\goldD","\\textcolor{##e07d10}{#1}");ke("\\goldE","\\textcolor{##a75a05}{#1}");ke("\\redA","\\textcolor{##fca9a9}{#1}");ke("\\redB","\\textcolor{##ff8482}{#1}");ke("\\redC","\\textcolor{##f9685d}{#1}");ke("\\redD","\\textcolor{##e84d39}{#1}");ke("\\redE","\\textcolor{##bc2612}{#1}");ke("\\maroonA","\\textcolor{##ffbde0}{#1}");ke("\\maroonB","\\textcolor{##ff92c6}{#1}");ke("\\maroonC","\\textcolor{##ed5fa6}{#1}");ke("\\maroonD","\\textcolor{##ca337c}{#1}");ke("\\maroonE","\\textcolor{##9e034e}{#1}");ke("\\purpleA","\\textcolor{##ddd7ff}{#1}");ke("\\purpleB","\\textcolor{##c6b9fc}{#1}");ke("\\purpleC","\\textcolor{##aa87ff}{#1}");ke("\\purpleD","\\textcolor{##7854ab}{#1}");ke("\\purpleE","\\textcolor{##543b78}{#1}");ke("\\mintA","\\textcolor{##f5f9e8}{#1}");ke("\\mintB","\\textcolor{##edf2df}{#1}");ke("\\mintC","\\textcolor{##e0e5cc}{#1}");ke("\\grayA","\\textcolor{##f6f7f7}{#1}");ke("\\grayB","\\textcolor{##f0f1f2}{#1}");ke("\\grayC","\\textcolor{##e3e5e6}{#1}");ke("\\grayD","\\textcolor{##d6d8da}{#1}");ke("\\grayE","\\textcolor{##babec2}{#1}");ke("\\grayF","\\textcolor{##888d93}{#1}");ke("\\grayG","\\textcolor{##626569}{#1}");ke("\\grayH","\\textcolor{##3b3e40}{#1}");ke("\\grayI","\\textcolor{##21242c}{#1}");ke("\\kaBlue","\\textcolor{##314453}{#1}");ke("\\kaGreen","\\textcolor{##71B307}{#1}");var mH={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class ple{constructor(t,r,n){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=r,this.expansionCount=0,this.feed(t),this.macros=new mle(gle,r.macros),this.mode=n,this.stack=[]}feed(t){this.lexer=new yF(t,this.settings)}switchMode(t){this.mode=t}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(t){this.stack.push(t)}pushTokens(t){this.stack.push(...t)}scanArgument(t){var r,n,s;if(t){if(this.consumeSpaces(),this.future().text!=="[")return null;r=this.popToken(),{tokens:s,end:n}=this.consumeArg(["]"])}else({tokens:s,start:r,end:n}=this.consumeArg());return this.pushToken(new Yl("EOF",n.loc)),this.pushTokens(s),new Yl("",xl.range(r,n))}consumeSpaces(){for(;;){var t=this.future();if(t.text===" ")this.stack.pop();else break}}consumeArg(t){var r=[],n=t&&t.length>0;n||this.consumeSpaces();var s=this.future(),a,i=0,o=0;do{if(a=this.popToken(),r.push(a),a.text==="{")++i;else if(a.text==="}"){if(--i,i===-1)throw new ir("Extra }",a)}else if(a.text==="EOF")throw new ir("Unexpected end of input in a macro argument, expected '"+(t&&n?t[o]:"}")+"'",a);if(t&&n)if((i===0||i===1&&t[o]==="{")&&a.text===t[o]){if(++o,o===t.length){r.splice(-o,o);break}}else o=0}while(i!==0||n);return s.text==="{"&&r[r.length-1].text==="}"&&(r.pop(),r.shift()),r.reverse(),{tokens:r,start:s,end:a}}consumeArgs(t,r){if(r){if(r.length!==t+1)throw new ir("The length of delimiters doesn't match the number of args!");for(var n=r[0],s=0;s<n.length;s++){var a=this.popToken();if(n[s]!==a.text)throw new ir("Use of the macro doesn't match its definition",a)}}for(var i=[],o=0;o<t;o++)i.push(this.consumeArg(r&&r[o+1]).tokens);return i}countExpansion(t){if(this.expansionCount+=t,this.expansionCount>this.settings.maxExpand)throw new ir("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(t){var r=this.popToken(),n=r.text,s=r.noexpand?null:this._getExpansion(n);if(s==null||t&&s.unexpandable){if(t&&s==null&&n[0]==="\\"&&!this.isDefined(n))throw new ir("Undefined control sequence: "+n);return this.pushToken(r),!1}this.countExpansion(1);var a=s.tokens,i=this.consumeArgs(s.numArgs,s.delimiters);if(s.numArgs){a=a.slice();for(var o=a.length-1;o>=0;--o){var c=a[o];if(c.text==="#"){if(o===0)throw new ir("Incomplete placeholder at end of macro body",c);if(c=a[--o],c.text==="#")a.splice(o+1,1);else if(/^[1-9]$/.test(c.text))a.splice(o,2,...i[+c.text-1]);else throw new ir("Not a valid argument number",c)}}}return this.pushTokens(a),a.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){var t=this.stack.pop();return t.treatAsRelax&&(t.text="\\relax"),t}throw new Error}expandMacro(t){return this.macros.has(t)?this.expandTokens([new Yl(t)]):void 0}expandTokens(t){var r=[],n=this.stack.length;for(this.pushTokens(t);this.stack.length>n;)if(this.expandOnce(!0)===!1){var s=this.stack.pop();s.treatAsRelax&&(s.noexpand=!1,s.treatAsRelax=!1),r.push(s)}return this.countExpansion(r.length),r}expandMacroAsText(t){var r=this.expandMacro(t);return r&&r.map(n=>n.text).join("")}_getExpansion(t){var r=this.macros.get(t);if(r==null)return r;if(t.length===1){var n=this.lexer.catcodes[t];if(n!=null&&n!==13)return}var s=typeof r=="function"?r(this):r;if(typeof s=="string"){var a=0;if(s.indexOf("#")!==-1)for(var i=s.replace(/##/g,"");i.indexOf("#"+(a+1))!==-1;)++a;for(var o=new yF(s,this.settings),c=[],u=o.lex();u.text!=="EOF";)c.push(u),u=o.lex();c.reverse();var d={tokens:c,numArgs:a};return d}return s}isDefined(t){return this.macros.has(t)||zf.hasOwnProperty(t)||Is.math.hasOwnProperty(t)||Is.text.hasOwnProperty(t)||mH.hasOwnProperty(t)}isExpandable(t){var r=this.macros.get(t);return r!=null?typeof r=="string"||typeof r=="function"||!r.unexpandable:zf.hasOwnProperty(t)&&!zf[t].primitive}}var wF=/^[]/,Mw=Object.freeze({"":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"a","":"e","":"h","":"i","":"j","":"k","":"l","":"m","":"n","":"o","":"p","":"r","":"s","":"t","":"u","":"v","":"x","":"","":"","":"","":"","":"","":"+","":"-","":"=","":"(","":")","":"0","":"1","":"2","":"3","":"4","":"5","":"6","":"7","":"8","":"9","":"A","":"B","":"D","":"E","":"G","":"H","":"I","":"J","":"K","":"L","":"M","":"N","":"O","":"P","":"R","":"T","":"U","":"V","":"W","":"a","":"b","":"c","":"d","":"e","":"f","":"g",:"h","":"i",:"j","":"k",:"l","":"m",:"n","":"o","":"p",:"r",:"s","":"t","":"u","":"v",:"w",:"x",:"y","":"z","":"","":"","":"","":"","":"","":""}),Q5={"":{text:"\\'",math:"\\acute"},"":{text:"\\`",math:"\\grave"},"":{text:'\\"',math:"\\ddot"},"":{text:"\\~",math:"\\tilde"},"":{text:"\\=",math:"\\bar"},"":{text:"\\u",math:"\\breve"},"":{text:"\\v",math:"\\check"},"":{text:"\\^",math:"\\hat"},"":{text:"\\.",math:"\\dot"},"":{text:"\\r",math:"\\mathring"},"":{text:"\\H"},"":{text:"\\c"}},_F={:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"a",:"b",:"c",:"c",:"c",:"c",:"c",:"c",:"d",:"d",:"d",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"e",:"f",:"g",:"g",:"g",:"g",:"g",:"g",:"g",:"h",:"h",:"h",:"h",:"h",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"i",:"j",:"j",:"k",:"k",:"k",:"l",:"l",:"l",:"m",:"m",:"n",:"n",:"n",:"n",:"n",:"n",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"o",:"p",:"p",:"r",:"r",:"r",:"r",:"s",:"s",:"s",:"s",:"s",:"s",:"s",:"t",:"t",:"t",:"t",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"u",:"v",:"w",:"w",:"w",:"w",:"w",:"w",:"x",:"x",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"y",:"z",:"z",:"z",:"z",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"A",:"B",:"C",:"C",:"C",:"C",:"C",:"C",:"D",:"D",:"D",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"E",:"F",:"G",:"G",:"G",:"G",:"G",:"G",:"G",:"H",:"H",:"H",:"H",:"H",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"I",:"J",:"K",:"K",:"K",:"L",:"L",:"L",:"M",:"M",:"N",:"N",:"N",:"N",:"N",:"N",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"O",:"P",:"P",:"R",:"R",:"R",:"R",:"S",:"S",:"S",:"S",:"S",:"S",:"S",:"T",:"T",:"T",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"U",:"V",:"W",:"W",:"W",:"W",:"W",:"X",:"X",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Y",:"Z",:"Z",:"Z",:"Z",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:""};class PS{constructor(t,r){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new ple(t,r,this.mode),this.settings=r,this.leftrightDepth=0}expect(t,r){if(r===void 0&&(r=!0),this.fetch().text!==t)throw new ir("Expected '"+t+"', got '"+this.fetch().text+"'",this.fetch());r&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(t){this.mode=t,this.gullet.switchMode(t)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var t=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),t}finally{this.gullet.endGroups()}}subparse(t){var r=this.nextToken;this.consume(),this.gullet.pushToken(new Yl("}")),this.gullet.pushTokens(t);var n=this.parseExpression(!1);return this.expect("}"),this.nextToken=r,n}parseExpression(t,r){for(var n=[];;){this.mode==="math"&&this.consumeSpaces();var s=this.fetch();if(PS.endOfExpression.indexOf(s.text)!==-1||r&&s.text===r||t&&zf[s.text]&&zf[s.text].infix)break;var a=this.parseAtom(r);if(a){if(a.type==="internal")continue}else break;n.push(a)}return this.mode==="text"&&this.formLigatures(n),this.handleInfixNodes(n)}handleInfixNodes(t){for(var r=-1,n,s=0;s<t.length;s++)if(t[s].type==="infix"){if(r!==-1)throw new ir("only one infix operator per group",t[s].token);r=s,n=t[s].replaceWith}if(r!==-1&&n){var a,i,o=t.slice(0,r),c=t.slice(r+1);o.length===1&&o[0].type==="ordgroup"?a=o[0]:a={type:"ordgroup",mode:this.mode,body:o},c.length===1&&c[0].type==="ordgroup"?i=c[0]:i={type:"ordgroup",mode:this.mode,body:c};var u;return n==="\\\\abovefrac"?u=this.callFunction(n,[a,t[r],i],[]):u=this.callFunction(n,[a,i],[]),[u]}else return t}handleSupSubscript(t){var r=this.fetch(),n=r.text;this.consume(),this.consumeSpaces();var s;do{var a;s=this.parseGroup(t)}while(((a=s)==null?void 0:a.type)==="internal");if(!s)throw new ir("Expected group after '"+n+"'",r);return s}formatUnsupportedCmd(t){for(var r=[],n=0;n<t.length;n++)r.push({type:"textord",mode:"text",text:t[n]});var s={type:"text",mode:this.mode,body:r},a={type:"color",mode:this.mode,color:this.settings.errorColor,body:[s]};return a}parseAtom(t){var r=this.parseGroup("atom",t);if(r?.type==="internal"||this.mode==="text")return r;for(var n,s;;){this.consumeSpaces();var a=this.fetch();if(a.text==="\\limits"||a.text==="\\nolimits"){if(r&&r.type==="op"){var i=a.text==="\\limits";r.limits=i,r.alwaysHandleSupSub=!0}else if(r&&r.type==="operatorname")r.alwaysHandleSupSub&&(r.limits=a.text==="\\limits");else throw new ir("Limit controls must follow a math operator",a);this.consume()}else if(a.text==="^"){if(n)throw new ir("Double superscript",a);n=this.handleSupSubscript("superscript")}else if(a.text==="_"){if(s)throw new ir("Double subscript",a);s=this.handleSupSubscript("subscript")}else if(a.text==="'"){if(n)throw new ir("Double superscript",a);var o={type:"textord",mode:this.mode,text:"\\prime"},c=[o];for(this.consume();this.fetch().text==="'";)c.push(o),this.consume();this.fetch().text==="^"&&c.push(this.handleSupSubscript("superscript")),n={type:"ordgroup",mode:this.mode,body:c}}else if(Mw[a.text]){var u=wF.test(a.text),d=[];for(d.push(new Yl(Mw[a.text])),this.consume();;){var f=this.fetch().text;if(!Mw[f]||wF.test(f)!==u)break;d.unshift(new Yl(Mw[f])),this.consume()}var h=this.subparse(d);u?s={type:"ordgroup",mode:"math",body:h}:n={type:"ordgroup",mode:"math",body:h}}else break}return n||s?{type:"supsub",mode:this.mode,base:r,sup:n,sub:s}:r}parseFunction(t,r){var n=this.fetch(),s=n.text,a=zf[s];if(!a)return null;if(this.consume(),r&&r!=="atom"&&!a.allowedInArgument)throw new ir("Got function '"+s+"' with no arguments"+(r?" as "+r:""),n);if(this.mode==="text"&&!a.allowedInText)throw new ir("Can't use function '"+s+"' in text mode",n);if(this.mode==="math"&&a.allowedInMath===!1)throw new ir("Can't use function '"+s+"' in math mode",n);var{args:i,optArgs:o}=this.parseArguments(s,a);return this.callFunction(s,i,o,n,t)}callFunction(t,r,n,s,a){var i={funcName:t,parser:this,token:s,breakOnTokenText:a},o=zf[t];if(o&&o.handler)return o.handler(i,r,n);throw new ir("No function handler for "+t)}parseArguments(t,r){var n=r.numArgs+r.numOptionalArgs;if(n===0)return{args:[],optArgs:[]};for(var s=[],a=[],i=0;i<n;i++){var o=r.argTypes&&r.argTypes[i],c=i<r.numOptionalArgs;(r.primitive&&o==null||r.type==="sqrt"&&i===1&&a[0]==null)&&(o="primitive");var u=this.parseGroupOfType("argument to '"+t+"'",o,c);if(c)a.push(u);else if(u!=null)s.push(u);else throw new ir("Null argument, please report this as a bug")}return{args:s,optArgs:a}}parseGroupOfType(t,r,n){switch(r){case"color":return this.parseColorGroup(n);case"size":return this.parseSizeGroup(n);case"url":return this.parseUrlGroup(n);case"math":case"text":return this.parseArgumentGroup(n,r);case"hbox":{var s=this.parseArgumentGroup(n,"text");return s!=null?{type:"styling",mode:s.mode,body:[s],style:"text"}:null}case"raw":{var a=this.parseStringGroup("raw",n);return a!=null?{type:"raw",mode:"text",string:a.text}:null}case"primitive":{if(n)throw new ir("A primitive argument cannot be optional");var i=this.parseGroup(t);if(i==null)throw new ir("Expected group as "+t,this.fetch());return i}case"original":case null:case void 0:return this.parseArgumentGroup(n);default:throw new ir("Unknown group type as "+t,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(t,r){var n=this.gullet.scanArgument(r);if(n==null)return null;for(var s="",a;(a=this.fetch()).text!=="EOF";)s+=a.text,this.consume();return this.consume(),n.text=s,n}parseRegexGroup(t,r){for(var n=this.fetch(),s=n,a="",i;(i=this.fetch()).text!=="EOF"&&t.test(a+i.text);)s=i,a+=s.text,this.consume();if(a==="")throw new ir("Invalid "+r+": '"+n.text+"'",n);return n.range(s,a)}parseColorGroup(t){var r=this.parseStringGroup("color",t);if(r==null)return null;var n=/^(#[a-f0-9]{3,4}|#[a-f0-9]{6}|#[a-f0-9]{8}|[a-f0-9]{6}|[a-z]+)$/i.exec(r.text);if(!n)throw new ir("Invalid color: '"+r.text+"'",r);var s=n[0];return/^[0-9a-f]{6}$/i.test(s)&&(s="#"+s),{type:"color-token",mode:this.mode,color:s}}parseSizeGroup(t){var r,n=!1;if(this.gullet.consumeSpaces(),!t&&this.gullet.future().text!=="{"?r=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):r=this.parseStringGroup("size",t),!r)return null;!t&&r.text.length===0&&(r.text="0pt",n=!0);var s=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(r.text);if(!s)throw new ir("Invalid size: '"+r.text+"'",r);var a={number:+(s[1]+s[2]),unit:s[3]};if(!kW(a))throw new ir("Invalid unit: '"+a.unit+"'",r);return{type:"size",mode:this.mode,value:a,isBlank:n}}parseUrlGroup(t){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var r=this.parseStringGroup("url",t);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),r==null)return null;var n=r.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:n}}parseArgumentGroup(t,r){var n=this.gullet.scanArgument(t);if(n==null)return null;var s=this.mode;r&&this.switchMode(r),this.gullet.beginGroup();var a=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var i={type:"ordgroup",mode:this.mode,loc:n.loc,body:a};return r&&this.switchMode(s),i}parseGroup(t,r){var n=this.fetch(),s=n.text,a;if(s==="{"||s==="\\begingroup"){this.consume();var i=s==="{"?"}":"\\endgroup";this.gullet.beginGroup();var o=this.parseExpression(!1,i),c=this.fetch();this.expect(i),this.gullet.endGroup(),a={type:"ordgroup",mode:this.mode,loc:xl.range(n,c),body:o,semisimple:s==="\\begingroup"||void 0}}else if(a=this.parseFunction(r,t)||this.parseSymbol(),a==null&&s[0]==="\\"&&!mH.hasOwnProperty(s)){if(this.settings.throwOnError)throw new ir("Undefined control sequence: "+s,n);a=this.formatUnsupportedCmd(s),this.consume()}return a}formLigatures(t){for(var r=t.length-1,n=0;n<r;++n){var s=t[n],a=s.text;a==="-"&&t[n+1].text==="-"&&(n+1<r&&t[n+2].text==="-"?(t.splice(n,3,{type:"textord",mode:"text",loc:xl.range(s,t[n+2]),text:"---"}),r-=2):(t.splice(n,2,{type:"textord",mode:"text",loc:xl.range(s,t[n+1]),text:"--"}),r-=1)),(a==="'"||a==="`")&&t[n+1].text===a&&(t.splice(n,2,{type:"textord",mode:"text",loc:xl.range(s,t[n+1]),text:a+a}),r-=1)}}parseSymbol(){var t=this.fetch(),r=t.text;if(/^\\verb[^a-zA-Z]/.test(r)){this.consume();var n=r.slice(5),s=n.charAt(0)==="*";if(s&&(n=n.slice(1)),n.length<2||n.charAt(0)!==n.slice(-1))throw new ir(`\\verb assertion failed --
                    please report what input caused this bug`);return n=n.slice(1,-1),{type:"verb",mode:"text",body:n,star:s}}_F.hasOwnProperty(r[0])&&!Is[this.mode][r[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+r[0]+'" used in math mode',t),r=_F[r[0]]+r.slice(1));var a=fle.exec(r);a&&(r=r.substring(0,a.index),r==="i"?r="":r==="j"&&(r=""));var i;if(Is[this.mode][r]){this.settings.strict&&this.mode==="math"&&vT.indexOf(r)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+r[0]+'" used in math mode',t);var o=Is[this.mode][r].group,c=xl.range(t),u;if(soe.hasOwnProperty(o)){var d=o;u={type:"atom",mode:this.mode,family:d,loc:c,text:r}}else u={type:o,mode:this.mode,loc:c,text:r};i=u}else if(r.charCodeAt(0)>=128)this.settings.strict&&(SW(r.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+r[0]+'" used in math mode',t):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+r[0]+'"'+(" ("+r.charCodeAt(0)+")"),t)),i={type:"textord",mode:"text",loc:xl.range(t),text:r};else return null;if(this.consume(),a)for(var f=0;f<a[0].length;f++){var h=a[0][f];if(!Q5[h])throw new ir("Unknown accent ' "+h+"'",t);var g=Q5[h][this.mode]||Q5[h].text;if(!g)throw new ir("Accent "+h+" unsupported in "+this.mode+" mode",t);i={type:"accent",mode:this.mode,loc:xl.range(t),label:g,isStretchy:!1,isShifty:!0,base:i}}return i}}PS.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var wN=function(t,r){if(!(typeof t=="string"||t instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var n=new PS(t,r);delete n.gullet.macros.current["\\df@tag"];var s=n.parse();if(delete n.gullet.macros.current["\\current@color"],delete n.gullet.macros.current["\\color"],n.gullet.macros.get("\\df@tag")){if(!r.displayMode)throw new ir("\\tag works only in display equations");s=[{type:"tag",mode:"text",body:s,tag:n.subparse([new Yl("\\df@tag")])}]}return s},gH=function(t,r,n){r.textContent="";var s=_N(t,n).toNode();r.appendChild(s)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),gH=function(){throw new ir("KaTeX doesn't work in quirks mode.")});var xle=function(t,r){var n=_N(t,r).toMarkup();return n},yle=function(t,r){var n=new nN(r);return wN(t,n)},pH=function(t,r,n){if(n.throwOnError||!(t instanceof ir))throw t;var s=Nt.makeSpan(["katex-error"],[new Oc(r)]);return s.setAttribute("title",t.toString()),s.setAttribute("style","color:"+n.errorColor),s},_N=function(t,r){var n=new nN(r);try{var s=wN(t,n);return Noe(s,t,n)}catch(a){return pH(a,t,n)}},vle=function(t,r){var n=new nN(r);try{var s=wN(t,n);return Eoe(s,t,n)}catch(a){return pH(a,t,n)}},ble="0.16.25",wle={Span:R2,Anchor:iN,SymbolNode:Oc,SvgNode:S0,PathNode:sh,LineNode:yT},CT={version:ble,render:gH,renderToString:xle,ParseError:ir,SETTINGS_SCHEMA:E4,__parse:yle,__renderToDomTree:_N,__renderToHTMLTree:vle,__setFontMetrics:Xie,__defineSymbol:ne,__defineFunction:Pr,__defineMacro:ke,__domTree:wle};const TT=(e,t=!1)=>{if(!e||typeof e!="string")return"";try{return CT.renderToString(e,{throwOnError:!1,displayMode:t,strict:!1})}catch(r){return console.error("Math rendering error:",r),`<span class="math-error" title="Math rendering error">${NT(e)}</span>`}},Ms=(e,t=!1)=>{if(!e||typeof e!="string")return"";let r=e;const n=/\$\$(.*?)\$\$/g;let s;const a=[];for(;(s=n.exec(e))!==null;)a.push({fullMatch:s[0],expression:s[1],index:s.index});for(let c=a.length-1;c>=0;c--){const{fullMatch:u,expression:d}=a[c];try{const f=CT.renderToString(d,{throwOnError:!1,displayMode:!0,strict:!1});r=r.replace(u,f)}catch(f){console.error("Math rendering error:",f),r=r.replace(u,NT(u))}}const i=/\$(.*?)\$/g,o=[];for(;(s=i.exec(r))!==null;)s[0].startsWith("$$")||o.push({fullMatch:s[0],expression:s[1],index:s.index});for(let c=o.length-1;c>=0;c--){const{fullMatch:u,expression:d}=o[c];try{const f=CT.renderToString(d,{throwOnError:!1,displayMode:!1,strict:!1});r=r.replace(u,f)}catch(f){console.error("Math rendering error:",f),r=r.replace(u,NT(u))}}return r},_le=e=>{if(!e||typeof e!="string")return"";if(e.includes("$"))return e;const t=["\\sqrt","\\frac","\\times","\\div","\\cdot","\\pm","\\mp","\\leq","\\geq","\\neq","\\approx","\\equiv","\\sum","\\prod","\\int","\\lim","\\sin","\\cos","\\tan","\\log","\\ln","\\exp"],r=[];let n="",s=!1,a=0;for(let o=0;o<e.length;o++){const c=e[o],u=e[o+1]||"",d=e[o-1]||"",f=c+u;if(e.substring(o,o+3),c==="\\"){const h=e.substring(o).match(/^\\([a-zA-Z]+)/);if(h){const g="\\"+h[1];if(t.some(p=>g.startsWith(p))||g.length>1){!s&&n.trim()&&(r.push({type:"text",content:n}),n=""),s=!0,n+=c;continue}}}if(f==="^{"||f==="_{"||c==="^"||c==="_"){!s&&n.trim()&&(r.push({type:"text",content:n}),n=""),s=!0,n+=c;continue}if(c==="{"){if(s){a++,n+=c;continue}else if(d==="^"||d==="_"||d==="\\"){s=!0,n+=c,a++;continue}}if(c==="}"&&s){if(n+=c,a--,a===0){const h=e.substring(o+1).trim();(!h||h.match(/^[\s,.!?;:]/))&&(r.push({type:"math",content:n}),n="",s=!1)}continue}if(s){if(n+=c,c===" "&&a===0){const h=e.substring(o+1).trim();h&&!h.match(/^[\\^_{]/)&&(r.push({type:"math",content:n.trim()}),n="",s=!1,n+=c)}}else n+=c}n&&r.push({type:s?"math":"text",content:n});let i="";for(const o of r)o.type==="math"?i+=`$${o.content}$`:i+=o.content;return i},NT=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML},Sle=({isOpen:e=!1,onClose:t,onSave:r,initialValue:n="",cursorPosition:s=null,inputRef:a=null})=>{const[i,o]=w.useState(n),[c,u]=w.useState({start:0,end:0}),[d,f]=w.useState(null),[h,g]=w.useState(null),[p,x]=w.useState(!1),v=w.useRef(null);w.useRef(null),w.useEffect(()=>{e&&(o(n),f(null),g(null),setTimeout(()=>{v.current?.focus(),i&&v.current?.setSelectionRange(i.length,i.length)},100))},[e,n]);const C=()=>{const{start:P,end:M}=c,I=P>0?i.substring(P-1,P):"",U=I&&I.trim()&&!I.match(/[{}()]/);let K="",te=0;U?(K="^{}",te=-1):(K="x^{2}",te=-3);const re=i.substring(0,P)+K+i.substring(M);o(re),setTimeout(()=>{v.current?.focus();const Z=P+K.length+te;v.current?.setSelectionRange(Z,Z)},0)},b=()=>{const{start:P,end:M}=c,I=i.substring(P,M);if(I){const U=i.substring(0,P)+`\\sqrt{${I}}`+i.substring(M);o(U),setTimeout(()=>{v.current?.focus();const K=P+I.length+8;v.current?.setSelectionRange(K,K)},0)}else{const U=i.substring(0,P)+"\\sqrt{}"+i.substring(M);o(U),setTimeout(()=>{v.current?.focus(),v.current?.setSelectionRange(P+6,P+6)},0)}},_=()=>{const{start:P}=c,M=i;if(d==="numerator"&&h!==null){const I=h;let U=0,K=-1;const te=I+6;for(let re=te;re<M.length;re++)if(M[re]==="{")U++;else if(M[re]==="}"){if(U===0){K=re+1;break}U--}if(K>0){const re=K+2;setTimeout(()=>{v.current?.focus(),v.current?.setSelectionRange(re,re)},0),f(null),g(null)}else{const re=i.substring(0,P)+"\\frac{}{}"+i.substring(c.end);o(re),setTimeout(()=>{v.current?.focus(),v.current?.setSelectionRange(P+6,P+6)},0),f("numerator"),g(P)}}else{const I=i.substring(0,P)+"\\frac{}{}"+i.substring(c.end);o(I),setTimeout(()=>{v.current?.focus(),v.current?.setSelectionRange(P+6,P+6)},0),f("numerator"),g(P)}},T=()=>{const{start:P,end:M}=c,I=i.substring(0,P)+"x^{}"+i.substring(M);o(I),x(!0),setTimeout(()=>{v.current?.focus(),v.current?.setSelectionRange(P+3,P+3)},0)},N=P=>{const{start:M,end:I}=c,U=i.substring(0,M)+P+i.substring(I);o(U),setTimeout(()=>{v.current?.focus();const K=M+P.length;v.current?.setSelectionRange(K,K)},0)},E=P=>{u({start:P.target.selectionStart,end:P.target.selectionEnd})},F=()=>{let P=i;i&&!i.includes("$")&&i.trim()&&/\\[a-zA-Z]+|[\^_]\{|\\times|\\div|\\sqrt|\\frac/.test(i)&&(P=`$${i}$`),r?.(P),t()};if(w.useEffect(()=>{const P=M=>{M.key==="Escape"&&e&&t()};return e&&document.addEventListener("keydown",P),()=>{document.removeEventListener("keydown",P)}},[e,t]),!e)return null;let j="";if(i&&i.trim())try{j=TT(i,!1),(!j||j.trim()==="")&&(j=`<span class="text-gray-500 font-mono">${Z5(i)}</span>`)}catch(P){console.error("Preview rendering error:",P),j=`<span class="text-red-500 font-mono">Error: ${Z5(i)}</span>`}return l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:P=>{P.target===P.currentTarget&&t()},role:"dialog","aria-modal":"true","aria-label":"Math Visual Editor",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 w-full max-w-2xl mx-auto",onClick:P=>P.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Math Visual Editor"}),l.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Math Expression"}),l.jsx("textarea",{ref:v,value:i,onChange:P=>{const M=P.target.value,I=P.target.selectionStart,U=i;if(M.length>U.length){const K=M.substring(0,I),te=M.substring(I),re=K.match(/\^{([^}]*)$/);if(re)if(te.startsWith("}")){const Z=re[1];p&&Z.length>0&&(setTimeout(()=>{if(v.current&&v.current.value===M){const B=I+1;v.current.setSelectionRange(B,B)}},10),x(!1))}else x(!1);else x(!1);K.match(/\\sqrt\{([^}]*)$/),K.match(/\\frac\{([^}]*)$/),K.match(/\\frac\{[^}]*\}\{([^}]*)$/)}o(M)},onSelect:E,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-mono text-sm",placeholder:"Type LaTeX code or use buttons below...",rows:4}),i&&i.trim()&&l.jsxs("div",{className:"mt-3 p-3 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("div",{className:"text-xs text-gray-600 mb-2 font-medium",children:"Preview:"}),l.jsx("div",{className:"text-gray-700",style:{minHeight:"1.5em",fontSize:"16px"},dangerouslySetInnerHTML:{__html:j||Z5(i)}})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Math Symbols"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:C,className:"px-3 py-2 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-sm font-medium text-blue-700 transition-colors",title:"Exponent (x)",children:"x"}),l.jsx("button",{onClick:T,className:"px-3 py-2 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-sm font-medium text-blue-700 transition-colors",title:"Exponent (x) - Type letter, click this, type number",children:"x"}),l.jsx("button",{onClick:b,className:"px-3 py-2 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-lg text-sm font-medium text-blue-700 transition-colors",title:"Square Root (x)",children:"x"}),l.jsx("button",{onClick:_,className:`px-3 py-2 border rounded-lg text-sm font-medium transition-colors ${d==="numerator"?"bg-green-50 hover:bg-green-100 border-green-300 text-green-700":"bg-blue-50 hover:bg-blue-100 border-blue-200 text-blue-700"}`,title:d==="numerator"?"Move to denominator (click again)":"Fraction (a/b) - Click for numerator, click again for denominator",children:"a/b"}),l.jsx("button",{onClick:()=>N("\\times"),className:"px-3 py-2 bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 transition-colors",title:"Times",children:""}),l.jsx("button",{onClick:()=>N("\\div"),className:"px-3 py-2 bg-gray-50 hover:bg-gray-100 border border-gray-200 rounded-lg text-sm font-medium text-gray-700 transition-colors",title:"Divide",children:""})]})]}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(at,{variant:"secondary",onClick:t,children:"Cancel"}),l.jsx(at,{variant:"primary",onClick:F,children:"Insert"})]})]})})},Z5=e=>{const t=document.createElement("div");return t.textContent=e,t.innerHTML},qo=({inputRef:e,onChange:t,position:r="right",size:n="small",showPreview:s=!1,className:a=""})=>{const[i,o]=w.useState(!1),[c,u]=w.useState(!1),[d,f]=w.useState(0),[h,g]=w.useState(null),[p,x]=w.useState(""),v=_=>{_.preventDefault(),_.stopPropagation();let T=null;if(typeof e=="function"?T=e():T=e?.current||e,!T){console.warn("MathEditorButton: No input reference provided");return}T.focus();const N=T.selectionStart!==null&&T.selectionStart!==void 0?T.selectionStart:T.selectionEnd!==null&&T.selectionEnd!==void 0?T.selectionEnd:T.value?.length||0;console.log(" Captured cursor position:",N,"from input value length:",T.value?.length),f(N),g(T),o(!0)},C=_=>{let T=h;if(T||(typeof e=="function"?T=e():T=e?.current||e),!T){console.warn("MathEditorButton: No input reference available for insert"),o(!1);return}const N=T.value||"",E=Math.max(0,Math.min(d,N.length));console.log(" Inserting formula at position:",E,"Value length:",N.length,"Formula:",_);const F=N.substring(0,E),j=N.substring(E),P=F+_+j;console.log(" New value:",P.substring(0,E)+"["+_+"]"+P.substring(E+_.length)),T.value=P,t&&t({target:{value:P,name:T.name}});const M=new Event("input",{bubbles:!0});if(T.dispatchEvent(M),T._valueTracker){const U=T._valueTracker;U.setValue(""),T.value=P,U.setValue(P)}const I=E+_.length;setTimeout(()=>{T.focus(),T.setSelectionRange(I,I),console.log(" Cursor moved to position:",I)},0),o(!1)};w.useEffect(()=>{console.log(" MathEditorButton rendered",{hasInputRef:!!e,inputRefType:typeof e,position:r,size:n})},[e,r,n]);const b=_=>{_.preventDefault(),_.stopPropagation();let T=null;typeof e=="function"?T=e():T=e?.current||e,x(T?.value||""),u(!0)};return w.useEffect(()=>{if(c){const _=setInterval(()=>{let T=null;typeof e=="function"?T=e():T=e?.current||e,T&&x(T.value||"")},300);return()=>clearInterval(_)}},[c,e]),l.jsxs(l.Fragment,{children:[s&&l.jsx("button",{type:"button",onClick:b,style:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:r==="right"?"48px":"auto",left:r==="left"?"48px":"auto",width:n==="small"?"32px":"40px",height:n==="small"?"32px":"40px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#10b981",color:"white",border:"2px solid #059669",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",zIndex:10,boxShadow:"0 2px 4px rgba(0,0,0,0.2)",minWidth:"32px",minHeight:"32px"},onMouseEnter:_=>{_.target.style.backgroundColor="#059669"},onMouseLeave:_=>{_.target.style.backgroundColor="#10b981"},title:"Preview Math (p)","aria-label":"Preview math rendering",children:l.jsx("span",{style:{fontSize:"11px",fontWeight:"bold"},children:"p"})}),l.jsx("button",{type:"button",onClick:v,style:{position:"absolute",top:"50%",transform:"translateY(-50%)",right:r==="right"?"8px":"auto",left:r==="left"?"8px":"auto",width:n==="small"?"32px":"40px",height:n==="small"?"32px":"40px",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#3b82f6",color:"white",border:"2px solid #2563eb",borderRadius:"6px",fontSize:"12px",fontWeight:"bold",cursor:"pointer",zIndex:10,boxShadow:"0 2px 4px rgba(0,0,0,0.2)",minWidth:"32px",minHeight:"32px"},onMouseEnter:_=>{_.target.style.backgroundColor="#2563eb"},onMouseLeave:_=>{_.target.style.backgroundColor="#3b82f6"},title:"Math Editor (fx)","aria-label":"Open math editor",children:l.jsx("span",{style:{fontSize:"11px",fontWeight:"bold"},children:"fx"})}),c&&l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:_=>{_.target===_.currentTarget&&u(!1)},role:"dialog","aria-modal":"true","aria-label":"Math Preview",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 p-6 w-full max-w-3xl mx-auto max-h-[90vh] overflow-auto",onClick:_=>_.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Math Preview"}),l.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Close",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preview"}),l.jsxs("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded text-xs text-gray-600 font-mono",children:["LaTeX: ",p||"(empty)"]}),l.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg min-h-[200px] text-lg",dangerouslySetInnerHTML:{__html:p?p.includes("$")?Ms(p,!1):Ms(_le(p),!1):'<span class="text-gray-400">No content to preview</span>'}})]}),l.jsx("div",{className:"flex justify-end",children:l.jsx("button",{onClick:()=>u(!1),className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors",children:"Close"})})]})}),l.jsx(Sle,{isOpen:i,onClose:()=>o(!1),onSave:C,initialValue:"",cursorPosition:d,inputRef:h||e?.current||e})]})},kle=({question:e,testId:t,testType:r="true_false",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onSave:c,isEditing:u=!1,isSaving:d=!1,validationErrors:f={},showCorrectAnswers:h=!1,studentId:g=null})=>{const{getItem:p,setItem:x}=kS();Ls();const{theme:v,isCyberpunk:C,isLight:b,isKpop:_,themeClasses:T}=da(),N=ua(v);w.useRef(null);const[E,F]=w.useState(""),[j,P]=w.useState(""),[M,I]=w.useState(""),[U,K]=w.useState(!1),[te,re]=w.useState(!0),[Z,B]=w.useState(""),[J,z]=w.useState(!1),[q,H]=w.useState(null);w.useEffect(()=>{if(e&&(I(e.question||""),P(e.correct_answer||""),n==="student"&&g)){const ie=p(`test_progress_${g}_${r}_${t}_${e.question_id}`);ie&&F(ie)}},[e,t,r,n,p]),w.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" TrueFalseQuestion syncing with parent studentAnswer:",a),F(a))},[a,n]),w.useEffect(()=>{if(n==="student"&&E&&t&&e?.question_id&&g){const ie=setTimeout(()=>{z(!0),x(`test_progress_${g}_${r}_${t}_${e.question_id}`,E),H(new Date().toLocaleTimeString()),setTimeout(()=>z(!1),1e3)},1e3);return()=>clearTimeout(ie)}},[E,t,r,e?.question_id,n,g,x]),w.useEffect(()=>{if(n==="teacher"&&(M||j)){const ie=setTimeout(()=>{z(!0);const Ee={question:M,correct_answer:j,timestamp:Date.now()};x(`teacher_form_${r}_${t}`,Ee),H(new Date().toLocaleTimeString()),setTimeout(()=>z(!1),1e3)},2e3);return()=>clearTimeout(ie)}},[M,j,t,r,n,x]);const R=w.useCallback(ie=>{n==="student"&&(F(ie),i&&i(e.question_id,ie),W(ie))},[n,e?.question_id,i]),L=w.useCallback(ie=>{I(ie),o&&o(e.question_id,ie),Q(ie)},[e?.question_id,o]),G=w.useCallback(ie=>{P(ie),o&&o(e.question_id,{...e,correct_answer:ie}),X(ie)},[e,o]),W=w.useCallback(ie=>{if(n==="student"){if(!ie){re(!1),B("Please select an answer");return}re(!0),B("")}},[n]),Q=w.useCallback(ie=>{if(n==="teacher"){if(!ie||ie.trim().length<10){re(!1),B("Question must be at least 10 characters long");return}re(!0),B("")}},[n]),X=w.useCallback(ie=>{if(n==="teacher"){if(!ie){re(!1),B("Please select a correct answer");return}re(!0),B("")}},[n]),se=w.useCallback(()=>{if(n!=="teacher"||!c)return;const ie={question_id:e.question_id,question:M,correct_answer:j,type:"true_false"};c(ie)},[n,c,e?.question_id,M,j]),le=w.useCallback(ie=>ie?Ms(ie,!1):"",[]),he=()=>l.jsxs("div",{className:`rounded-xl border-2 p-6 shadow-sm hover:shadow-md transition-shadow duration-200 ${C?Vt(0).className:_?hr(0).className:"bg-white border-gray-200"}`,style:C?{...Vt(0).style,...N.glowRed}:_?{...hr(0).style,...N.glow}:{},children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h4",{className:`text-lg font-semibold ${C||_?"":"text-gray-800"}`,style:C?{...N.textCyan,fontFamily:"monospace"}:_?{...N.headerText}:{},children:C?`QUESTION ${typeof s=="number"?s:e?.question_id}`:`Question ${typeof s=="number"?s:e?.question_id}`}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[J&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),q&&!J&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",q]})]})]}),l.jsx("div",{className:`question-text mb-6 leading-relaxed ${C?"":"text-gray-700"}`,style:C?{color:fe.cyan,fontFamily:"monospace",...N.textShadow}:{},dangerouslySetInnerHTML:{__html:le(M)}}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 ${C?"border":E==="true"?"border-blue-500 bg-blue-50 hover:bg-gray-50":"border-gray-200 hover:bg-gray-50"} ${h&&j==="true"?"ring-2 ring-green-400":""}`,style:C?{backgroundColor:fe.black,borderColor:fe.cyan,...E==="true"?N.glow:{}}:{},children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"true",checked:E==="true",onChange:()=>R("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${C?"border":_?E==="true"?"border-pink-500 bg-pink-500":"border-pink-500/50":E==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,style:C?{borderColor:fe.cyan,backgroundColor:E==="true"?fe.cyan:"transparent"}:_?{borderColor:E==="true"?He.primary:He.border,backgroundColor:E==="true"?He.primary:"transparent",...E==="true"?{...N.glow,boxShadow:`${N.glow.boxShadow}, 0 0 15px ${He.primary}`}:{}}:{},children:E==="true"&&l.jsx("div",{className:`w-2 h-2 rounded-full ${C?"":"bg-white"}`,style:C?{backgroundColor:fe.black}:{}})}),l.jsx("span",{className:`font-medium ${C||_?"":"text-gray-800"}`,style:C?{...N.textCyan,fontFamily:"monospace"}:_?{...N.textWhite}:{},children:C?"TRUE":"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 ${C?"border":E==="false"?"border-blue-500 bg-blue-50 hover:bg-gray-50":"border-gray-200 hover:bg-gray-50"} ${h&&j==="false"?"ring-2 ring-green-400":""}`,style:C?{backgroundColor:fe.black,borderColor:fe.cyan,...E==="false"?N.glow:{}}:{},children:[l.jsx("input",{type:"radio",name:`question_${e?.question_id}`,value:"false",checked:E==="false",onChange:()=>R("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${C?"border":_?E==="false"?"border-pink-500 bg-pink-500":"border-pink-500/50":E==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,style:C?{borderColor:fe.cyan,backgroundColor:E==="false"?fe.cyan:"transparent"}:_?{borderColor:E==="false"?He.primary:He.border,backgroundColor:E==="false"?He.primary:"transparent",...E==="false"?{...N.glow,boxShadow:`${N.glow.boxShadow}, 0 0 15px ${He.primary}`}:{}}:{},children:E==="false"&&l.jsx("div",{className:`w-2 h-2 rounded-full ${C?"":"bg-white"}`,style:C?{backgroundColor:fe.black}:{}})}),l.jsx("span",{className:`font-medium ${C||_?"":"text-gray-800"}`,style:C?{...N.textCyan,fontFamily:"monospace"}:_?{...N.textWhite}:{},children:C?"FALSE":"False"})]})]}),!te&&Z&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:Z})]}),we=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[J&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),q&&!J&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",q]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{id:`question_${e?.question_id}`,value:M,onChange:ie=>L(ie.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0}),l.jsx(qo,{inputRef:()=>document.getElementById(`question_${e?.question_id}`),onChange:ie=>L(ie.target.value)})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Correct Answer *"}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${j==="true"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"true",checked:j==="true",onChange:()=>G("true"),className:"sr-only","aria-label":"True"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${j==="true"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:j==="true"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"True"})]}),l.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer transition-all duration-200 hover:bg-gray-50 ${j==="false"?"border-blue-500 bg-blue-50":"border-gray-200"}`,children:[l.jsx("input",{type:"radio",name:`correct_${e?.question_id}`,value:"false",checked:j==="false",onChange:()=>G("false"),className:"sr-only","aria-label":"False"}),l.jsx("div",{className:`w-5 h-5 rounded-full border-2 mr-3 flex items-center justify-center ${j==="false"?"border-blue-500 bg-blue-500":"border-gray-300"}`,children:j==="false"&&l.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),l.jsx("span",{className:"text-gray-800 font-medium",children:"False"})]})]})]})]}),!te&&Z&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:Z}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(at,{variant:"success",onClick:se,disabled:!te||d,className:"w-full sm:w-auto",children:d?l.jsx(Xr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:"true-false-question-container",children:n==="student"?he():we()})},Cle=({question:e,testId:t,testType:r="multiple_choice",mode:n="student",studentAnswer:s,onAnswerChange:a,onQuestionChange:i,onOptionAdd:o,onOptionRemove:c,onSave:u,isEditing:d=!1,isSaving:f=!1,validationErrors:h={},showCorrectAnswers:g=!1,studentId:p=null,displayNumber:x})=>{const{getItem:v,setItem:C}=kS(),{showNotification:b}=Ls(),{theme:_,isCyberpunk:T,isLight:N,isKpop:E,themeClasses:F}=da(),j=ua(_);w.useRef(null);const[P,M]=w.useState(""),[I,U]=w.useState(["","","",""]),[K,te]=w.useState(""),[re,Z]=w.useState(""),[B,J]=w.useState(!1),[z,q]=w.useState(!0),[H,R]=w.useState(""),[L,G]=w.useState(!1),[W,Q]=w.useState(null);w.useEffect(()=>{if(e&&(Z(e.question||""),U(e.options||["","","",""]),te(e.correct_answer||""),n==="student"&&p)){const et=v(`test_progress_${p}_${r}_${t}_${e.question_id}`);et&&M(et)}},[e,t,r,n,v]),w.useEffect(()=>{n==="student"&&s!==void 0&&s!==null&&(console.log(" MultipleChoiceQuestion syncing with parent studentAnswer:",s),M(s))},[s,n]),w.useEffect(()=>{if(n==="student"&&P&&t&&e?.question_id&&p){const et=setTimeout(()=>{G(!0),C(`test_progress_${p}_${r}_${t}_${e.question_id}`,P),Q(new Date().toLocaleTimeString()),setTimeout(()=>G(!1),1e3)},1e3);return()=>clearTimeout(et)}},[P,t,r,e?.question_id,n,p,C]),w.useEffect(()=>{if(n==="teacher"&&(re||I.some(et=>et.trim()))){const et=setTimeout(()=>{G(!0);const vt={question:re,options:I,correct_answer:K,timestamp:Date.now()};C(`teacher_form_${r}_${t}`,vt),Q(new Date().toLocaleTimeString()),setTimeout(()=>G(!1),1e3)},2e3);return()=>clearTimeout(et)}},[re,I,K,t,r,n,C]),w.useCallback(et=>{if(n!=="student")return;const vt=String(et);M(vt),a&&a(e.question_id,vt),ie(vt)},[n,e?.question_id,a]);const X=w.useCallback(et=>{Z(et),i&&i(e.question_id,et),Ee(et)},[e?.question_id,i]),se=w.useCallback((et,vt)=>{const Te=[...I];Te[et]=vt,U(Te),i&&i(e.question_id,{...e,options:Te}),ye(Te)},[I,e,i]),le=w.useCallback(et=>{te(et),i&&i(e.question_id,{...e,correct_answer:et}),Ie(et)},[e,i]),he=w.useCallback(()=>{if(I.length<6){const et=[...I,""];U(et),o&&o(e.question_id,et)}else b("Maximum 6 options allowed","warning")},[I,e?.question_id,o,b]),we=w.useCallback(et=>{if(I.length>2){const vt=I.filter((Te,Ve)=>Ve!==et);if(U(vt),K===String.fromCharCode(65+et))te("");else if(K&&String.fromCharCode(65+et)<K){const Te=String.fromCharCode(65+et-1);te(Te)}c&&c(e.question_id,vt)}else b("Minimum 2 options required","warning")},[I,K,e?.question_id,c,b]),ie=w.useCallback(et=>{if(n==="student"){if(!et){q(!1),R("Please select an answer");return}q(!0),e?.correct_answer&&et===e.correct_answer?R(" Correct answer!"):e?.correct_answer?R(" Incorrect answer"):R("Answer selected")}},[n,e?.correct_answer]),Ee=w.useCallback(et=>!et||et.trim().length<10?(q(!1),R("Question must be at least 10 characters long"),!1):(q(!0),R(""),!0),[]),ye=w.useCallback(et=>{if(n!=="teacher")return;if(et.filter(Te=>Te.trim().length>0).length<2){q(!1),R("At least 2 options must be filled");return}if(et.some(Te=>Te.trim().length>0&&Te.trim().length<3)){q(!1),R("Each option must be at least 3 characters long");return}q(!0),R("")},[n]),Ie=w.useCallback(et=>{if(n==="teacher"){if(!et){q(!1),R("Please select a correct answer");return}q(!0),R("")}},[n]),ut=w.useCallback(()=>{if(n!=="teacher"||!u)return;const et={question_id:e.question_id,question:re,options:I.filter(vt=>vt.trim().length>0),correct_answer:K,type:"multiple_choice"};u(et)},[n,u,e?.question_id,re,I,K]),Qe=w.useCallback(et=>et?Ms(et,!1):"",[]);return n==="teacher"?l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e?.question_id||"New Question"]}),l.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[L&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),W&&!L&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",W]})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{id:`question_${e?.question_id}`,value:re,onChange:et=>X(et.target.value),placeholder:"Enter your question here...",className:"w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 resize-none",rows:3,required:!0}),l.jsx(qo,{inputRef:()=>document.getElementById(`question_${e?.question_id}`),onChange:et=>X(et.target.value)})]})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Answer Options *"}),l.jsx(at,{variant:"secondary",size:"small",onClick:he,disabled:I.length>=6,className:"px-3 py-1 text-sm",children:"+ Add Option"})]}),l.jsx("div",{className:"space-y-3",children:I.map((et,vt)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+vt)}),l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",value:et,onChange:Te=>se(vt,Te.target.value),placeholder:`Option ${String.fromCharCode(65+vt)}`,className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e?.question_id,"data-option-index":vt,required:!0}),l.jsx(qo,{inputRef:()=>document.querySelector(`[data-question-id="${e?.question_id}"][data-option-index="${vt}"]`),onChange:Te=>se(vt,Te.target.value)})]}),I.length>2&&l.jsx(at,{variant:"danger",size:"small",onClick:()=>we(vt),className:"px-2 py-1 text-sm",children:""})]},vt))})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:`correct_${e?.question_id}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{id:`correct_${e?.question_id}`,value:K,onChange:et=>le(et.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200",required:!0,children:[l.jsx("option",{value:"",children:"Select correct answer"}),I.map((et,vt)=>{if(!et.trim())return null;const Te=String.fromCharCode(65+vt);return l.jsxs("option",{value:Te,children:[Te,") ",et]},vt)})]})]})]}),!z&&H&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:H}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(at,{variant:"success",onClick:ut,disabled:!z||f,className:"w-full sm:w-auto",children:f?l.jsx(Xr,{size:"small"}):"Save Question"})})]}):l.jsxs("div",{className:`rounded-xl border-2 p-6 shadow-sm hover:shadow-md transition-shadow duration-200 ${T?Vt(0).className:E?hr(0).className:"bg-white border-gray-200"}`,style:T?{...Vt(0).style,...j.glowRed}:E?{...hr(0).style,...j.glow}:{},children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h4",{className:`text-lg font-semibold ${T||E?"":"text-gray-800"}`,style:T?{...j.textCyan,fontFamily:"monospace"}:E?{...j.headerText}:{},children:T?`QUESTION ${typeof x=="number"?x:e?.question_id}`:`Question ${typeof x=="number"?x:e?.question_id}`}),l.jsxs("div",{className:`flex items-center space-x-2 text-sm ${T||E?"":"text-gray-500"}`,style:T?{color:fe.cyan,fontFamily:"monospace"}:E?{...j.textAccent}:{},children:[L&&l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:"Saving..."})]}),W&&!L&&l.jsxs("div",{className:"text-green-600",children:[" Saved at ",W]})]})]}),l.jsx("div",{className:`question-text mb-6 leading-relaxed ${T?"":E?"text-violet-900":"text-gray-700"}`,style:T?{color:fe.cyan,fontFamily:"monospace",...j.textShadow}:E?{color:He.text}:{},dangerouslySetInnerHTML:{__html:Qe(re)}}),l.jsx("div",{className:"space-y-3",children:I.map((et,vt)=>l.jsxs("label",{className:`flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all duration-200 ${T?"border":E?P===String.fromCharCode(65+vt)?"border-pink-500 bg-pink-500/20":"border-pink-500/50 hover:border-pink-500":P===String.fromCharCode(65+vt)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,style:T?{backgroundColor:fe.black,borderColor:(P===String.fromCharCode(65+vt),fe.cyan),...P===String.fromCharCode(65+vt)?j.glow:{}}:E?{backgroundColor:P===String.fromCharCode(65+vt)?He.backgroundSecondary:He.background,borderColor:P===String.fromCharCode(65+vt)?He.primary:He.border,...P===String.fromCharCode(65+vt)?j.glow:{}}:{},children:[l.jsx("input",{type:"radio",name:`mcq_${t}_${e?.question_id}`,value:String.fromCharCode(65+vt),checked:P===String.fromCharCode(65+vt),onChange:Te=>{M(Te.target.value),a&&a(e?.question_id,Te.target.value)},className:"mr-3"}),l.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-semibold mr-3 ${T?"":E?P===String.fromCharCode(65+vt)?"bg-pink-500 text-white":"bg-pink-500/20 text-pink-400":"bg-gray-100 text-gray-600"}`,style:T?{backgroundColor:P===String.fromCharCode(65+vt)?fe.cyan:fe.black,border:`2px solid ${fe.cyan}`,color:P===String.fromCharCode(65+vt)?fe.black:fe.cyan,fontFamily:"monospace"}:E?{backgroundColor:P===String.fromCharCode(65+vt)?He.primary:He.background,border:`2px solid ${P===String.fromCharCode(65+vt)?He.primary:He.border}`,color:P===String.fromCharCode(65+vt)?He.white:He.primary,...P===String.fromCharCode(65+vt)?{...j.glow,boxShadow:`${j.glow.boxShadow}, 0 0 15px ${He.primary}`}:{}}:{},children:String.fromCharCode(65+vt)}),l.jsx("span",{className:`flex-1 ${T?"":E?"text-violet-900":""}`,style:T?{color:fe.cyan,fontFamily:"monospace"}:E?{color:He.text}:{},dangerouslySetInnerHTML:{__html:et?Ms(et):`Option ${String.fromCharCode(65+vt)}`}})]},vt))}),!z&&H&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:H})]})},Tle=({question:e,testId:t,testType:r="input",mode:n="student",displayNumber:s,studentAnswer:a,onAnswerChange:i,onQuestionChange:o,onAnswerAdd:c,onAnswerRemove:u,onSave:d,isEditing:f=!1,isSaving:h=!1,validationErrors:g={},showCorrectAnswers:p=!1,studentId:x=null})=>{const{getItem:v,setItem:C}=kS(),{showNotification:b}=Ls(),{theme:_,isCyberpunk:T,isLight:N,isKpop:E,themeClasses:F}=da(),j=ua(_),P=w.useRef(null),[M,I]=w.useState(""),[U,K]=w.useState([""]),[te,re]=w.useState(!1),[Z,B]=w.useState(!0),[J,z]=w.useState(""),[q,H]=w.useState(!1);w.useEffect(()=>{if(n==="student"&&e?.question_id&&t&&r&&x){const Ee=`test_progress_${x}_${r}_${t}_${e.question_id}`,ye=v(Ee);ye&&I(ye)}},[e?.question_id,r,t,n,x,v]),w.useEffect(()=>{n==="student"&&a!==void 0&&a!==null&&(console.log(" InputQuestion syncing with parent studentAnswer:",a),I(a))},[a,n]),w.useEffect(()=>{n==="teacher"&&e?.answers&&K(e.answers.length>0?e.answers:[""])},[e?.answers,n]),w.useEffect(()=>{if(n==="student"&&M&&e?.question_id&&t&&r&&x){const Ee=setTimeout(()=>{H(!0),C(`test_progress_${x}_${r}_${t}_${e.question_id}`,M),setTimeout(()=>H(!1),1e3)},1e3);return()=>clearTimeout(Ee)}},[M,e?.question_id,r,t,n,x,C]),w.useEffect(()=>{if(n==="teacher"&&U&&o){const Ee=setTimeout(()=>{o({...e,answers:U.filter(ye=>ye.trim())})},500);return()=>clearTimeout(Ee)}},[U,e,n,o]);const R=w.useCallback(Ee=>{I(Ee);const ye=Ee.trim().length>0;B(ye),z(ye?"":"Please enter an answer"),i&&i(e.question_id,Ee)},[e?.question_id,i]),L=w.useCallback((Ee,ye)=>{const Ie=[...U];Ie[Ee]=ye,K(Ie),i&&i(e.question_id,Ie)},[U,e?.question_id,i]),G=w.useCallback(()=>{if(n==="teacher"){const Ee=[...U,""];K(Ee),c&&c(e.question_id,Ee)}},[U,e?.question_id,n,c]),W=w.useCallback(Ee=>{if(n==="teacher"&&U.length>1){const ye=U.filter((Ie,ut)=>ut!==Ee);K(ye),u&&u(e.question_id,ye)}},[U,e?.question_id,n,u]),Q=w.useCallback(()=>{if(n==="student"){const Ee=M.trim().length>0;return B(Ee),z(Ee?"":"Please enter an answer"),Ee}else if(n==="teacher"){const Ee=U.some(ye=>ye.trim().length>0);return B(Ee),z(Ee?"":"Please enter at least one correct answer"),Ee}return!0},[M,U,n]),X=w.useCallback(Ee=>Ee?Ms(Ee,!1):"",[]),se=w.useCallback(()=>{re(!0)},[]),le=w.useCallback(()=>{re(!1),Q()},[Q]),he=w.useCallback(Ee=>{Ee.key==="Enter"&&n==="student"&&M.trim()&&(C(`test_progress_${r}_${t}_${e.question_id}`,M),b("Answer saved","success"))},[M,r,t,e?.question_id,n,C,b]),we=()=>l.jsxs("div",{className:`rounded-xl border-2 p-6 shadow-sm hover:shadow-md transition-shadow duration-200 ${T?Vt(0).className:E?hr(0).className:"bg-white border-gray-200"}`,style:T?{...Vt(0).style,...j.glowRed}:E?{...hr(0).style,...j.glow}:{},children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h4",{className:`text-lg font-semibold ${T||E?"":"text-gray-800"}`,style:T?{...j.textCyan,fontFamily:"monospace"}:E?{...j.headerText}:{},children:T?`QUESTION ${typeof s=="number"?s:e.question_id}`:`Question ${typeof s=="number"?s:e.question_id}`}),q&&l.jsxs("div",{className:`flex items-center space-x-1 text-sm ${T||E?"":"text-gray-500"}`,style:T?{color:fe.cyan,fontFamily:"monospace"}:E?{...j.textAccent}:{},children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsx("div",{className:`question-text mb-6 leading-relaxed ${T?"":"text-gray-700"}`,style:T?{color:fe.cyan,fontFamily:"monospace",...j.textShadow}:{},dangerouslySetInnerHTML:{__html:X(e.question)}}),l.jsx("div",{className:"space-y-3",children:l.jsx("div",{className:"relative",children:l.jsx("input",{ref:P,type:"text",id:`input_${e.question_id}`,placeholder:T?"ENTER YOUR ANSWER HERE...":"Enter your answer here...",value:M,onChange:Ee=>R(Ee.target.value),onFocus:se,onBlur:le,onKeyPress:he,className:`w-full px-4 py-3 pr-10 border-2 rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 ${T?"border":Z?te?"border-blue-500 text-gray-800 placeholder-gray-400 focus:ring-blue-500":"border-gray-300 hover:border-gray-400 text-gray-800 placeholder-gray-400":"border-red-300 focus:border-red-500 focus:ring-red-500 text-gray-800 placeholder-gray-400"}`,style:T?{backgroundColor:fe.black,borderColor:Z?fe.cyan:fe.red,color:fe.cyan,fontFamily:"monospace",...te?j.glow:{},...te?{}:{}}:{},"data-question-id":e.question_id,"aria-label":`Answer for question ${e.question_id}`,"aria-invalid":!Z,"aria-describedby":Z?void 0:`error-${e.question_id}`})})}),p&&e.correct_answers&&l.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[l.jsx("h5",{className:"text-sm font-semibold text-green-800 mb-2",children:"Correct Answers:"}),l.jsx("ul",{className:"space-y-1",children:e.correct_answers.map((Ee,ye)=>l.jsx("li",{className:"text-green-700 text-sm",dangerouslySetInnerHTML:{__html:` ${Ms(Ee,!1)}`}},ye))})]})]}),ie=()=>l.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-6 shadow-sm",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-800",children:["Question ",e.question_id||"New"]}),h&&l.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-500",children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:"Saving..."})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:`question_${e.question_id||"new"}`,className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",id:`question_${e.question_id||"new"}`,value:e.question||"",onChange:Ee=>o&&o({...e,question:Ee.target.value}),placeholder:"Enter question text",className:`w-full px-4 py-3 pr-10 border-2 rounded-lg text-gray-800 placeholder-gray-400 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 ${g.question?"border-red-300 focus:border-red-500 focus:ring-red-500":"border-gray-300 hover:border-gray-400 focus:border-blue-500"}`}),l.jsx(MathEditorButton,{inputRef:()=>document.getElementById(`question_${e.question_id||"new"}`),onChange:Ee=>o&&o({...e,question:Ee.target.value})})]}),g.question&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g.question})]}),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Correct Answers *"}),l.jsx(at,{type:"button",variant:"secondary",size:"small",onClick:G,className:"px-3 py-1 text-sm",children:"+ Add Answer"})]}),l.jsx("div",{className:"space-y-3",children:U.map((Ee,ye)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:ye+1}),l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",value:Ee,onChange:Ie=>L(ye,Ie.target.value),placeholder:`Correct answer ${ye+1}`,className:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200","data-question-id":e.question_id,"data-answer-index":ye}),l.jsx(MathEditorButton,{inputRef:()=>document.querySelector(`[data-question-id="${e.question_id}"][data-answer-index="${ye}"]`),onChange:Ie=>L(ye,Ie.target.value)})]}),U.length>1&&l.jsx(at,{type:"button",variant:"danger",size:"small",onClick:()=>W(ye),className:"px-2 py-1 text-sm",children:" Remove"})]},ye))}),g.answers&&l.jsx("div",{className:"mt-2 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:g.answers})]})]}),d&&l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx(at,{type:"button",variant:"success",onClick:d,disabled:h,className:"w-full sm:w-auto",children:h?l.jsx(Xr,{size:"small"}):"Save Question"})})]});return l.jsx("div",{className:`input-question-container ${n} ${te?"focused":""}`,children:n==="student"?we():ie()})};var j4={exports:{}},ry={},e6={},t6={},SF;function Rn(){return SF||(SF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e._registerNode=e.Konva=e.glob=void 0;const t=Math.PI/180;function r(){return typeof window<"u"&&({}.toString.call(window)==="[object Window]"||{}.toString.call(window)==="[object global]")}e.glob=typeof W4<"u"?W4:typeof window<"u"?window:typeof WorkerGlobalScope<"u"?self:{},e.Konva={_global:e.glob,version:"9.3.22",isBrowser:r(),isUnminified:/param/.test((function(s){}).toString()),dblClickWindow:400,getAngle(s){return e.Konva.angleDeg?s*t:s},enableTrace:!1,pointerEventsEnabled:!0,autoDrawEnabled:!0,hitOnDragEnabled:!1,capturePointerEventsEnabled:!1,_mouseListenClick:!1,_touchListenClick:!1,_pointerListenClick:!1,_mouseInDblClickWindow:!1,_touchInDblClickWindow:!1,_pointerInDblClickWindow:!1,_mouseDblClickPointerId:null,_touchDblClickPointerId:null,_pointerDblClickPointerId:null,_fixTextRendering:!1,pixelRatio:typeof window<"u"&&window.devicePixelRatio||1,dragDistance:3,angleDeg:!0,showWarnings:!0,dragButtons:[0,1],isDragging(){return e.Konva.DD.isDragging},isTransforming(){var s;return(s=e.Konva.Transformer)===null||s===void 0?void 0:s.isTransforming()},isDragReady(){return!!e.Konva.DD.node},releaseCanvasOnDestroy:!0,document:e.glob.document,_injectGlobal(s){e.glob.Konva=s}};const n=s=>{e.Konva[s.prototype.getClassName()]=s};e._registerNode=n,e.Konva._injectGlobal(e.Konva)})(t6)),t6}var r6={},kF;function Ca(){return kF||(kF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Util=e.Transform=void 0;const t=Rn();class r{constructor(T=[1,0,0,1,0,0]){this.dirty=!1,this.m=T&&T.slice()||[1,0,0,1,0,0]}reset(){this.m[0]=1,this.m[1]=0,this.m[2]=0,this.m[3]=1,this.m[4]=0,this.m[5]=0}copy(){return new r(this.m)}copyInto(T){T.m[0]=this.m[0],T.m[1]=this.m[1],T.m[2]=this.m[2],T.m[3]=this.m[3],T.m[4]=this.m[4],T.m[5]=this.m[5]}point(T){const N=this.m;return{x:N[0]*T.x+N[2]*T.y+N[4],y:N[1]*T.x+N[3]*T.y+N[5]}}translate(T,N){return this.m[4]+=this.m[0]*T+this.m[2]*N,this.m[5]+=this.m[1]*T+this.m[3]*N,this}scale(T,N){return this.m[0]*=T,this.m[1]*=T,this.m[2]*=N,this.m[3]*=N,this}rotate(T){const N=Math.cos(T),E=Math.sin(T),F=this.m[0]*N+this.m[2]*E,j=this.m[1]*N+this.m[3]*E,P=this.m[0]*-E+this.m[2]*N,M=this.m[1]*-E+this.m[3]*N;return this.m[0]=F,this.m[1]=j,this.m[2]=P,this.m[3]=M,this}getTranslation(){return{x:this.m[4],y:this.m[5]}}skew(T,N){const E=this.m[0]+this.m[2]*N,F=this.m[1]+this.m[3]*N,j=this.m[2]+this.m[0]*T,P=this.m[3]+this.m[1]*T;return this.m[0]=E,this.m[1]=F,this.m[2]=j,this.m[3]=P,this}multiply(T){const N=this.m[0]*T.m[0]+this.m[2]*T.m[1],E=this.m[1]*T.m[0]+this.m[3]*T.m[1],F=this.m[0]*T.m[2]+this.m[2]*T.m[3],j=this.m[1]*T.m[2]+this.m[3]*T.m[3],P=this.m[0]*T.m[4]+this.m[2]*T.m[5]+this.m[4],M=this.m[1]*T.m[4]+this.m[3]*T.m[5]+this.m[5];return this.m[0]=N,this.m[1]=E,this.m[2]=F,this.m[3]=j,this.m[4]=P,this.m[5]=M,this}invert(){const T=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),N=this.m[3]*T,E=-this.m[1]*T,F=-this.m[2]*T,j=this.m[0]*T,P=T*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),M=T*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);return this.m[0]=N,this.m[1]=E,this.m[2]=F,this.m[3]=j,this.m[4]=P,this.m[5]=M,this}getMatrix(){return this.m}decompose(){const T=this.m[0],N=this.m[1],E=this.m[2],F=this.m[3],j=this.m[4],P=this.m[5],M=T*F-N*E,I={x:j,y:P,rotation:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(T!=0||N!=0){const U=Math.sqrt(T*T+N*N);I.rotation=N>0?Math.acos(T/U):-Math.acos(T/U),I.scaleX=U,I.scaleY=M/U,I.skewX=(T*E+N*F)/M,I.skewY=0}else if(E!=0||F!=0){const U=Math.sqrt(E*E+F*F);I.rotation=Math.PI/2-(F>0?Math.acos(-E/U):-Math.acos(E/U)),I.scaleX=M/U,I.scaleY=U,I.skewX=0,I.skewY=(T*E+N*F)/M}return I.rotation=e.Util._getRotation(I.rotation),I}}e.Transform=r;const n="[object Array]",s="[object Number]",a="[object String]",i="[object Boolean]",o=Math.PI/180,c=180/Math.PI,u="#",d="",f="0",h="Konva warning: ",g="Konva error: ",p="rgb(",x={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]},v=/rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)/;let C=[];const b=typeof requestAnimationFrame<"u"&&requestAnimationFrame||function(_){setTimeout(_,60)};e.Util={_isElement(_){return!!(_&&_.nodeType==1)},_isFunction(_){return!!(_&&_.constructor&&_.call&&_.apply)},_isPlainObject(_){return!!_&&_.constructor===Object},_isArray(_){return Object.prototype.toString.call(_)===n},_isNumber(_){return Object.prototype.toString.call(_)===s&&!isNaN(_)&&isFinite(_)},_isString(_){return Object.prototype.toString.call(_)===a},_isBoolean(_){return Object.prototype.toString.call(_)===i},isObject(_){return _ instanceof Object},isValidSelector(_){if(typeof _!="string")return!1;const T=_[0];return T==="#"||T==="."||T===T.toUpperCase()},_sign(_){return _===0||_>0?1:-1},requestAnimFrame(_){C.push(_),C.length===1&&b(function(){const T=C;C=[],T.forEach(function(N){N()})})},createCanvasElement(){const _=document.createElement("canvas");try{_.style=_.style||{}}catch{}return _},createImageElement(){return document.createElement("img")},_isInDocument(_){for(;_=_.parentNode;)if(_==document)return!0;return!1},_urlToImage(_,T){const N=e.Util.createImageElement();N.onload=function(){T(N)},N.src=_},_rgbToHex(_,T,N){return((1<<24)+(_<<16)+(T<<8)+N).toString(16).slice(1)},_hexToRgb(_){_=_.replace(u,d);const T=parseInt(_,16);return{r:T>>16&255,g:T>>8&255,b:T&255}},getRandomColor(){let _=(Math.random()*16777215<<0).toString(16);for(;_.length<6;)_=f+_;return u+_},getRGB(_){let T;return _ in x?(T=x[_],{r:T[0],g:T[1],b:T[2]}):_[0]===u?this._hexToRgb(_.substring(1)):_.substr(0,4)===p?(T=v.exec(_.replace(/ /g,"")),{r:parseInt(T[1],10),g:parseInt(T[2],10),b:parseInt(T[3],10)}):{r:0,g:0,b:0}},colorToRGBA(_){return _=_||"black",e.Util._namedColorToRBA(_)||e.Util._hex3ColorToRGBA(_)||e.Util._hex4ColorToRGBA(_)||e.Util._hex6ColorToRGBA(_)||e.Util._hex8ColorToRGBA(_)||e.Util._rgbColorToRGBA(_)||e.Util._rgbaColorToRGBA(_)||e.Util._hslColorToRGBA(_)},_namedColorToRBA(_){const T=x[_.toLowerCase()];return T?{r:T[0],g:T[1],b:T[2],a:1}:null},_rgbColorToRGBA(_){if(_.indexOf("rgb(")===0){_=_.match(/rgb\(([^)]+)\)/)[1];const T=_.split(/ *, */).map(Number);return{r:T[0],g:T[1],b:T[2],a:1}}},_rgbaColorToRGBA(_){if(_.indexOf("rgba(")===0){_=_.match(/rgba\(([^)]+)\)/)[1];const T=_.split(/ *, */).map((N,E)=>N.slice(-1)==="%"?E===3?parseInt(N)/100:parseInt(N)/100*255:Number(N));return{r:T[0],g:T[1],b:T[2],a:T[3]}}},_hex8ColorToRGBA(_){if(_[0]==="#"&&_.length===9)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:parseInt(_.slice(7,9),16)/255}},_hex6ColorToRGBA(_){if(_[0]==="#"&&_.length===7)return{r:parseInt(_.slice(1,3),16),g:parseInt(_.slice(3,5),16),b:parseInt(_.slice(5,7),16),a:1}},_hex4ColorToRGBA(_){if(_[0]==="#"&&_.length===5)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:parseInt(_[4]+_[4],16)/255}},_hex3ColorToRGBA(_){if(_[0]==="#"&&_.length===4)return{r:parseInt(_[1]+_[1],16),g:parseInt(_[2]+_[2],16),b:parseInt(_[3]+_[3],16),a:1}},_hslColorToRGBA(_){if(/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.test(_)){const[T,...N]=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(_),E=Number(N[0])/360,F=Number(N[1])/100,j=Number(N[2])/100;let P,M,I;if(F===0)return I=j*255,{r:Math.round(I),g:Math.round(I),b:Math.round(I),a:1};j<.5?P=j*(1+F):P=j+F-j*F;const U=2*j-P,K=[0,0,0];for(let te=0;te<3;te++)M=E+1/3*-(te-1),M<0&&M++,M>1&&M--,6*M<1?I=U+(P-U)*6*M:2*M<1?I=P:3*M<2?I=U+(P-U)*(2/3-M)*6:I=U,K[te]=I*255;return{r:Math.round(K[0]),g:Math.round(K[1]),b:Math.round(K[2]),a:1}}},haveIntersection(_,T){return!(T.x>_.x+_.width||T.x+T.width<_.x||T.y>_.y+_.height||T.y+T.height<_.y)},cloneObject(_){const T={};for(const N in _)this._isPlainObject(_[N])?T[N]=this.cloneObject(_[N]):this._isArray(_[N])?T[N]=this.cloneArray(_[N]):T[N]=_[N];return T},cloneArray(_){return _.slice(0)},degToRad(_){return _*o},radToDeg(_){return _*c},_degToRad(_){return e.Util.warn("Util._degToRad is removed. Please use public Util.degToRad instead."),e.Util.degToRad(_)},_radToDeg(_){return e.Util.warn("Util._radToDeg is removed. Please use public Util.radToDeg instead."),e.Util.radToDeg(_)},_getRotation(_){return t.Konva.angleDeg?e.Util.radToDeg(_):_},_capitalize(_){return _.charAt(0).toUpperCase()+_.slice(1)},throw(_){throw new Error(g+_)},error(_){console.error(g+_)},warn(_){t.Konva.showWarnings&&console.warn(h+_)},each(_,T){for(const N in _)T(N,_[N])},_inRange(_,T,N){return T<=_&&_<N},_getProjectionToSegment(_,T,N,E,F,j){let P,M,I;const U=(_-N)*(_-N)+(T-E)*(T-E);if(U==0)P=_,M=T,I=(F-N)*(F-N)+(j-E)*(j-E);else{const K=((F-_)*(N-_)+(j-T)*(E-T))/U;K<0?(P=_,M=T,I=(_-F)*(_-F)+(T-j)*(T-j)):K>1?(P=N,M=E,I=(N-F)*(N-F)+(E-j)*(E-j)):(P=_+K*(N-_),M=T+K*(E-T),I=(P-F)*(P-F)+(M-j)*(M-j))}return[P,M,I]},_getProjectionToLine(_,T,N){const E=e.Util.cloneObject(_);let F=Number.MAX_VALUE;return T.forEach(function(j,P){if(!N&&P===T.length-1)return;const M=T[(P+1)%T.length],I=e.Util._getProjectionToSegment(j.x,j.y,M.x,M.y,_.x,_.y),U=I[0],K=I[1],te=I[2];te<F&&(E.x=U,E.y=K,F=te)}),E},_prepareArrayForTween(_,T,N){const E=[],F=[];if(_.length>T.length){const P=T;T=_,_=P}for(let P=0;P<_.length;P+=2)E.push({x:_[P],y:_[P+1]});for(let P=0;P<T.length;P+=2)F.push({x:T[P],y:T[P+1]});const j=[];return F.forEach(function(P){const M=e.Util._getProjectionToLine(P,E,N);j.push(M.x),j.push(M.y)}),j},_prepareToStringify(_){let T;_.visitedByCircularReferenceRemoval=!0;for(const N in _)if(_.hasOwnProperty(N)&&_[N]&&typeof _[N]=="object"){if(T=Object.getOwnPropertyDescriptor(_,N),_[N].visitedByCircularReferenceRemoval||e.Util._isElement(_[N]))if(T.configurable)delete _[N];else return null;else if(e.Util._prepareToStringify(_[N])===null)if(T.configurable)delete _[N];else return null}return delete _.visitedByCircularReferenceRemoval,_},_assign(_,T){for(const N in T)_[N]=T[N];return _},_getFirstPointerId(_){return _.touches?_.changedTouches[0].identifier:_.pointerId||999},releaseCanvas(..._){t.Konva.releaseCanvasOnDestroy&&_.forEach(T=>{T.width=0,T.height=0})},drawRoundedRectPath(_,T,N,E){let F=0,j=0,P=0,M=0;typeof E=="number"?F=j=P=M=Math.min(E,T/2,N/2):(F=Math.min(E[0]||0,T/2,N/2),j=Math.min(E[1]||0,T/2,N/2),M=Math.min(E[2]||0,T/2,N/2),P=Math.min(E[3]||0,T/2,N/2)),_.moveTo(F,0),_.lineTo(T-j,0),_.arc(T-j,j,j,Math.PI*3/2,0,!1),_.lineTo(T,N-M),_.arc(T-M,N-M,M,0,Math.PI/2,!1),_.lineTo(P,N),_.arc(P,N-P,P,Math.PI/2,Math.PI,!1),_.lineTo(0,F),_.arc(F,F,F,Math.PI,Math.PI*3/2,!1)}}})(r6)),r6}var ny={},Xd={},Jd={},CF;function xH(){if(CF)return Jd;CF=1,Object.defineProperty(Jd,"__esModule",{value:!0}),Jd.HitContext=Jd.SceneContext=Jd.Context=void 0;const e=Ca(),t=Rn();function r(C){const b=[],_=C.length,T=e.Util;for(let N=0;N<_;N++){let E=C[N];T._isNumber(E)?E=Math.round(E*1e3)/1e3:T._isString(E)||(E=E+""),b.push(E)}return b}const n=",",s="(",a=")",i="([",o="])",c=";",u="()",d="=",f=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","createLinearGradient","createPattern","createRadialGradient","drawImage","ellipse","fill","fillText","getImageData","createImageData","lineTo","moveTo","putImageData","quadraticCurveTo","rect","roundRect","restore","rotate","save","scale","setLineDash","setTransform","stroke","strokeText","transform","translate"],h=["fillStyle","strokeStyle","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","letterSpacing","lineCap","lineDashOffset","lineJoin","lineWidth","miterLimit","direction","font","textAlign","textBaseline","globalAlpha","globalCompositeOperation","imageSmoothingEnabled"],g=100;let p=class{constructor(b){this.canvas=b,t.Konva.enableTrace&&(this.traceArr=[],this._enableTrace())}fillShape(b){b.fillEnabled()&&this._fill(b)}_fill(b){}strokeShape(b){b.hasStroke()&&this._stroke(b)}_stroke(b){}fillStrokeShape(b){b.attrs.fillAfterStrokeEnabled?(this.strokeShape(b),this.fillShape(b)):(this.fillShape(b),this.strokeShape(b))}getTrace(b,_){let T=this.traceArr,N=T.length,E="",F,j,P,M;for(F=0;F<N;F++)j=T[F],P=j.method,P?(M=j.args,E+=P,b?E+=u:e.Util._isArray(M[0])?E+=i+M.join(n)+o:(_&&(M=M.map(I=>typeof I=="number"?Math.floor(I):I)),E+=s+M.join(n)+a)):(E+=j.property,b||(E+=d+j.val)),E+=c;return E}clearTrace(){this.traceArr=[]}_trace(b){let _=this.traceArr,T;_.push(b),T=_.length,T>=g&&_.shift()}reset(){const b=this.getCanvas().getPixelRatio();this.setTransform(1*b,0,0,1*b,0,0)}getCanvas(){return this.canvas}clear(b){const _=this.getCanvas();b?this.clearRect(b.x||0,b.y||0,b.width||0,b.height||0):this.clearRect(0,0,_.getWidth()/_.pixelRatio,_.getHeight()/_.pixelRatio)}_applyLineCap(b){const _=b.attrs.lineCap;_&&this.setAttr("lineCap",_)}_applyOpacity(b){const _=b.getAbsoluteOpacity();_!==1&&this.setAttr("globalAlpha",_)}_applyLineJoin(b){const _=b.attrs.lineJoin;_&&this.setAttr("lineJoin",_)}setAttr(b,_){this._context[b]=_}arc(b,_,T,N,E,F){this._context.arc(b,_,T,N,E,F)}arcTo(b,_,T,N,E){this._context.arcTo(b,_,T,N,E)}beginPath(){this._context.beginPath()}bezierCurveTo(b,_,T,N,E,F){this._context.bezierCurveTo(b,_,T,N,E,F)}clearRect(b,_,T,N){this._context.clearRect(b,_,T,N)}clip(...b){this._context.clip.apply(this._context,b)}closePath(){this._context.closePath()}createImageData(b,_){const T=arguments;if(T.length===2)return this._context.createImageData(b,_);if(T.length===1)return this._context.createImageData(b)}createLinearGradient(b,_,T,N){return this._context.createLinearGradient(b,_,T,N)}createPattern(b,_){return this._context.createPattern(b,_)}createRadialGradient(b,_,T,N,E,F){return this._context.createRadialGradient(b,_,T,N,E,F)}drawImage(b,_,T,N,E,F,j,P,M){const I=arguments,U=this._context;I.length===3?U.drawImage(b,_,T):I.length===5?U.drawImage(b,_,T,N,E):I.length===9&&U.drawImage(b,_,T,N,E,F,j,P,M)}ellipse(b,_,T,N,E,F,j,P){this._context.ellipse(b,_,T,N,E,F,j,P)}isPointInPath(b,_,T,N){return T?this._context.isPointInPath(T,b,_,N):this._context.isPointInPath(b,_,N)}fill(...b){this._context.fill.apply(this._context,b)}fillRect(b,_,T,N){this._context.fillRect(b,_,T,N)}strokeRect(b,_,T,N){this._context.strokeRect(b,_,T,N)}fillText(b,_,T,N){N?this._context.fillText(b,_,T,N):this._context.fillText(b,_,T)}measureText(b){return this._context.measureText(b)}getImageData(b,_,T,N){return this._context.getImageData(b,_,T,N)}lineTo(b,_){this._context.lineTo(b,_)}moveTo(b,_){this._context.moveTo(b,_)}rect(b,_,T,N){this._context.rect(b,_,T,N)}roundRect(b,_,T,N,E){this._context.roundRect(b,_,T,N,E)}putImageData(b,_,T){this._context.putImageData(b,_,T)}quadraticCurveTo(b,_,T,N){this._context.quadraticCurveTo(b,_,T,N)}restore(){this._context.restore()}rotate(b){this._context.rotate(b)}save(){this._context.save()}scale(b,_){this._context.scale(b,_)}setLineDash(b){this._context.setLineDash?this._context.setLineDash(b):"mozDash"in this._context?this._context.mozDash=b:"webkitLineDash"in this._context&&(this._context.webkitLineDash=b)}getLineDash(){return this._context.getLineDash()}setTransform(b,_,T,N,E,F){this._context.setTransform(b,_,T,N,E,F)}stroke(b){b?this._context.stroke(b):this._context.stroke()}strokeText(b,_,T,N){this._context.strokeText(b,_,T,N)}transform(b,_,T,N,E,F){this._context.transform(b,_,T,N,E,F)}translate(b,_){this._context.translate(b,_)}_enableTrace(){let b=this,_=f.length,T=this.setAttr,N,E;const F=function(j){let P=b[j],M;b[j]=function(){return E=r(Array.prototype.slice.call(arguments,0)),M=P.apply(b,arguments),b._trace({method:j,args:E}),M}};for(N=0;N<_;N++)F(f[N]);b.setAttr=function(){T.apply(b,arguments);const j=arguments[0];let P=arguments[1];(j==="shadowOffsetX"||j==="shadowOffsetY"||j==="shadowBlur")&&(P=P/this.canvas.getPixelRatio()),b._trace({property:j,val:P})}}_applyGlobalCompositeOperation(b){const _=b.attrs.globalCompositeOperation;!_||_==="source-over"||this.setAttr("globalCompositeOperation",_)}};Jd.Context=p,h.forEach(function(C){Object.defineProperty(p.prototype,C,{get(){return this._context[C]},set(b){this._context[C]=b}})});class x extends p{constructor(b,{willReadFrequently:_=!1}={}){super(b),this._context=b._canvas.getContext("2d",{willReadFrequently:_})}_fillColor(b){const _=b.fill();this.setAttr("fillStyle",_),b._fillFunc(this)}_fillPattern(b){this.setAttr("fillStyle",b._getFillPattern()),b._fillFunc(this)}_fillLinearGradient(b){const _=b._getLinearGradient();_&&(this.setAttr("fillStyle",_),b._fillFunc(this))}_fillRadialGradient(b){const _=b._getRadialGradient();_&&(this.setAttr("fillStyle",_),b._fillFunc(this))}_fill(b){const _=b.fill(),T=b.getFillPriority();if(_&&T==="color"){this._fillColor(b);return}const N=b.getFillPatternImage();if(N&&T==="pattern"){this._fillPattern(b);return}const E=b.getFillLinearGradientColorStops();if(E&&T==="linear-gradient"){this._fillLinearGradient(b);return}const F=b.getFillRadialGradientColorStops();if(F&&T==="radial-gradient"){this._fillRadialGradient(b);return}_?this._fillColor(b):N?this._fillPattern(b):E?this._fillLinearGradient(b):F&&this._fillRadialGradient(b)}_strokeLinearGradient(b){const _=b.getStrokeLinearGradientStartPoint(),T=b.getStrokeLinearGradientEndPoint(),N=b.getStrokeLinearGradientColorStops(),E=this.createLinearGradient(_.x,_.y,T.x,T.y);if(N){for(let F=0;F<N.length;F+=2)E.addColorStop(N[F],N[F+1]);this.setAttr("strokeStyle",E)}}_stroke(b){const _=b.dash(),T=b.getStrokeScaleEnabled();if(b.hasStroke()){if(!T){this.save();const E=this.getCanvas().getPixelRatio();this.setTransform(E,0,0,E,0,0)}this._applyLineCap(b),_&&b.dashEnabled()&&(this.setLineDash(_),this.setAttr("lineDashOffset",b.dashOffset())),this.setAttr("lineWidth",b.strokeWidth()),b.getShadowForStrokeEnabled()||this.setAttr("shadowColor","rgba(0,0,0,0)"),b.getStrokeLinearGradientColorStops()?this._strokeLinearGradient(b):this.setAttr("strokeStyle",b.stroke()),b._strokeFunc(this),T||this.restore()}}_applyShadow(b){var _,T,N;const E=(_=b.getShadowRGBA())!==null&&_!==void 0?_:"black",F=(T=b.getShadowBlur())!==null&&T!==void 0?T:5,j=(N=b.getShadowOffset())!==null&&N!==void 0?N:{x:0,y:0},P=b.getAbsoluteScale(),M=this.canvas.getPixelRatio(),I=P.x*M,U=P.y*M;this.setAttr("shadowColor",E),this.setAttr("shadowBlur",F*Math.min(Math.abs(I),Math.abs(U))),this.setAttr("shadowOffsetX",j.x*I),this.setAttr("shadowOffsetY",j.y*U)}}Jd.SceneContext=x;class v extends p{constructor(b){super(b),this._context=b._canvas.getContext("2d",{willReadFrequently:!0})}_fill(b){this.save(),this.setAttr("fillStyle",b.colorKey),b._fillFuncHit(this),this.restore()}strokeShape(b){b.hasHitStroke()&&this._stroke(b)}_stroke(b){if(b.hasHitStroke()){const _=b.getStrokeScaleEnabled();if(!_){this.save();const E=this.getCanvas().getPixelRatio();this.setTransform(E,0,0,E,0,0)}this._applyLineCap(b);const T=b.hitStrokeWidth(),N=T==="auto"?b.strokeWidth():T;this.setAttr("lineWidth",N),this.setAttr("strokeStyle",b.colorKey),b._strokeFuncHit(this),_||this.restore()}}}return Jd.HitContext=v,Jd}var TF;function FS(){if(TF)return Xd;TF=1,Object.defineProperty(Xd,"__esModule",{value:!0}),Xd.HitCanvas=Xd.SceneCanvas=Xd.Canvas=void 0;const e=Ca(),t=xH(),r=Rn();let n;function s(){if(n)return n;const c=e.Util.createCanvasElement(),u=c.getContext("2d");return n=(function(){const d=r.Konva._global.devicePixelRatio||1,f=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||u.oBackingStorePixelRatio||u.backingStorePixelRatio||1;return d/f})(),e.Util.releaseCanvas(c),n}let a=class{constructor(u){this.pixelRatio=1,this.width=0,this.height=0,this.isCache=!1;const f=(u||{}).pixelRatio||r.Konva.pixelRatio||s();this.pixelRatio=f,this._canvas=e.Util.createCanvasElement(),this._canvas.style.padding="0",this._canvas.style.margin="0",this._canvas.style.border="0",this._canvas.style.background="transparent",this._canvas.style.position="absolute",this._canvas.style.top="0",this._canvas.style.left="0"}getContext(){return this.context}getPixelRatio(){return this.pixelRatio}setPixelRatio(u){const d=this.pixelRatio;this.pixelRatio=u,this.setSize(this.getWidth()/d,this.getHeight()/d)}setWidth(u){this.width=this._canvas.width=u*this.pixelRatio,this._canvas.style.width=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}setHeight(u){this.height=this._canvas.height=u*this.pixelRatio,this._canvas.style.height=u+"px";const d=this.pixelRatio;this.getContext()._context.scale(d,d)}getWidth(){return this.width}getHeight(){return this.height}setSize(u,d){this.setWidth(u||0),this.setHeight(d||0)}toDataURL(u,d){try{return this._canvas.toDataURL(u,d)}catch{try{return this._canvas.toDataURL()}catch(h){return e.Util.error("Unable to get data URL. "+h.message+" For more info read https://konvajs.org/docs/posts/Tainted_Canvas.html."),""}}}};Xd.Canvas=a;class i extends a{constructor(u={width:0,height:0,willReadFrequently:!1}){super(u),this.context=new t.SceneContext(this,{willReadFrequently:u.willReadFrequently}),this.setSize(u.width,u.height)}}Xd.SceneCanvas=i;class o extends a{constructor(u={width:0,height:0}){super(u),this.hitCanvas=!0,this.context=new t.HitContext(this),this.setSize(u.width,u.height)}}return Xd.HitCanvas=o,Xd}var n6={},NF;function SN(){return NF||(NF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DD=void 0;const t=Rn(),r=Ca();e.DD={get isDragging(){let n=!1;return e.DD._dragElements.forEach(s=>{s.dragStatus==="dragging"&&(n=!0)}),n},justDragged:!1,get node(){let n;return e.DD._dragElements.forEach(s=>{n=s.node}),n},_dragElements:new Map,_drag(n){const s=[];e.DD._dragElements.forEach((a,i)=>{const{node:o}=a,c=o.getStage();c.setPointersPositions(n),a.pointerId===void 0&&(a.pointerId=r.Util._getFirstPointerId(n));const u=c._changedPointerPositions.find(d=>d.id===a.pointerId);if(u){if(a.dragStatus!=="dragging"){const d=o.dragDistance();if(Math.max(Math.abs(u.x-a.startPointerPos.x),Math.abs(u.y-a.startPointerPos.y))<d||(o.startDrag({evt:n}),!o.isDragging()))return}o._setDragPosition(n,a),s.push(o)}}),s.forEach(a=>{a.fire("dragmove",{type:"dragmove",target:a,evt:n},!0)})},_endDragBefore(n){const s=[];e.DD._dragElements.forEach(a=>{const{node:i}=a,o=i.getStage();if(n&&o.setPointersPositions(n),!o._changedPointerPositions.find(d=>d.id===a.pointerId))return;(a.dragStatus==="dragging"||a.dragStatus==="stopped")&&(e.DD.justDragged=!0,t.Konva._mouseListenClick=!1,t.Konva._touchListenClick=!1,t.Konva._pointerListenClick=!1,a.dragStatus="stopped");const u=a.node.getLayer()||a.node instanceof t.Konva.Stage&&a.node;u&&s.indexOf(u)===-1&&s.push(u)}),s.forEach(a=>{a.draw()})},_endDragAfter(n){e.DD._dragElements.forEach((s,a)=>{s.dragStatus==="stopped"&&s.node.fire("dragend",{type:"dragend",target:s.node,evt:n},!0),s.dragStatus!=="dragging"&&e.DD._dragElements.delete(a)})}},t.Konva.isBrowser&&(window.addEventListener("mouseup",e.DD._endDragBefore,!0),window.addEventListener("touchend",e.DD._endDragBefore,!0),window.addEventListener("touchcancel",e.DD._endDragBefore,!0),window.addEventListener("mousemove",e.DD._drag),window.addEventListener("touchmove",e.DD._drag),window.addEventListener("mouseup",e.DD._endDragAfter,!1),window.addEventListener("touchend",e.DD._endDragAfter,!1),window.addEventListener("touchcancel",e.DD._endDragAfter,!1))})(n6)),n6}var s6={},hl={},EF;function Un(){if(EF)return hl;EF=1,Object.defineProperty(hl,"__esModule",{value:!0}),hl.RGBComponent=n,hl.alphaComponent=s,hl.getNumberValidator=a,hl.getNumberOrArrayOfNumbersValidator=i,hl.getNumberOrAutoValidator=o,hl.getStringValidator=c,hl.getStringOrGradientValidator=u,hl.getFunctionValidator=d,hl.getNumberArrayValidator=f,hl.getBooleanValidator=h,hl.getComponentValidator=g;const e=Rn(),t=Ca();function r(p){return t.Util._isString(p)?'"'+p+'"':Object.prototype.toString.call(p)==="[object Number]"||t.Util._isBoolean(p)?p:Object.prototype.toString.call(p)}function n(p){return p>255?255:p<0?0:Math.round(p)}function s(p){return p>1?1:p<1e-4?1e-4:p}function a(){if(e.Konva.isUnminified)return function(p,x){return t.Util._isNumber(p)||t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a number.'),p}}function i(p){if(e.Konva.isUnminified)return function(x,v){let C=t.Util._isNumber(x),b=t.Util._isArray(x)&&x.length==p;return!C&&!b&&t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be a number or Array<number>('+p+")"),x}}function o(){if(e.Konva.isUnminified)return function(p,x){return t.Util._isNumber(p)||p==="auto"||t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a number or "auto".'),p}}function c(){if(e.Konva.isUnminified)return function(p,x){return t.Util._isString(p)||t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a string.'),p}}function u(){if(e.Konva.isUnminified)return function(p,x){const v=t.Util._isString(p),C=Object.prototype.toString.call(p)==="[object CanvasGradient]"||p&&p.addColorStop;return v||C||t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a string or a native gradient.'),p}}function d(){if(e.Konva.isUnminified)return function(p,x){return t.Util._isFunction(p)||t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a function.'),p}}function f(){if(e.Konva.isUnminified)return function(p,x){const v=Int8Array?Object.getPrototypeOf(Int8Array):null;return v&&p instanceof v||(t.Util._isArray(p)?p.forEach(function(C){t.Util._isNumber(C)||t.Util.warn('"'+x+'" attribute has non numeric element '+C+". Make sure that all elements are numbers.")}):t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a array of numbers.')),p}}function h(){if(e.Konva.isUnminified)return function(p,x){return p===!0||p===!1||t.Util.warn(r(p)+' is a not valid value for "'+x+'" attribute. The value should be a boolean.'),p}}function g(p){if(e.Konva.isUnminified)return function(x,v){return x==null||t.Util.isObject(x)||t.Util.warn(r(x)+' is a not valid value for "'+v+'" attribute. The value should be an object with properties '+p),x}}return hl}var AF;function Bn(){return AF||(AF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Factory=void 0;const t=Ca(),r=Un(),n="get",s="set";e.Factory={addGetterSetter(a,i,o,c,u){e.Factory.addGetter(a,i,o),e.Factory.addSetter(a,i,c,u),e.Factory.addOverloadedGetterSetter(a,i)},addGetter(a,i,o){const c=n+t.Util._capitalize(i);a.prototype[c]=a.prototype[c]||function(){const u=this.attrs[i];return u===void 0?o:u}},addSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]||e.Factory.overWriteSetter(a,i,o,c)},overWriteSetter(a,i,o,c){const u=s+t.Util._capitalize(i);a.prototype[u]=function(d){return o&&d!==void 0&&d!==null&&(d=o.call(this,d,i)),this._setAttr(i,d),c&&c.call(this),this}},addComponentsGetterSetter(a,i,o,c,u){const d=o.length,f=t.Util._capitalize,h=n+f(i),g=s+f(i);a.prototype[h]=function(){const x={};for(let v=0;v<d;v++){const C=o[v];x[C]=this.getAttr(i+f(C))}return x};const p=(0,r.getComponentValidator)(o);a.prototype[g]=function(x){const v=this.attrs[i];c&&(x=c.call(this,x,i)),p&&p.call(this,x,i);for(const C in x)x.hasOwnProperty(C)&&this._setAttr(i+f(C),x[C]);return x||o.forEach(C=>{this._setAttr(i+f(C),void 0)}),this._fireChangeEvent(i,v,x),u&&u.call(this),this},e.Factory.addOverloadedGetterSetter(a,i)},addOverloadedGetterSetter(a,i){const o=t.Util._capitalize(i),c=s+o,u=n+o;a.prototype[i]=function(){return arguments.length?(this[c](arguments[0]),this):this[u]()}},addDeprecatedGetterSetter(a,i,o,c){t.Util.error("Adding deprecated "+i);const u=n+t.Util._capitalize(i),d=i+" property is deprecated and will be removed soon. Look at Konva change log for more information.";a.prototype[u]=function(){t.Util.error(d);const f=this.attrs[i];return f===void 0?o:f},e.Factory.addSetter(a,i,c,function(){t.Util.error(d)}),e.Factory.addOverloadedGetterSetter(a,i)},backCompat(a,i){t.Util.each(i,function(o,c){const u=a.prototype[c],d=n+t.Util._capitalize(o),f=s+t.Util._capitalize(o);function h(){u.apply(this,arguments),t.Util.error('"'+o+'" method is deprecated and will be removed soon. Use ""'+c+'" instead.')}a.prototype[o]=h,a.prototype[d]=h,a.prototype[f]=h})},afterSetFilter(){this._filterUpToDate=!1}}})(s6)),s6}var jF;function $a(){if(jF)return ny;jF=1,Object.defineProperty(ny,"__esModule",{value:!0}),ny.Node=void 0;const e=FS(),t=SN(),r=Bn(),n=Rn(),s=Ca(),a=Un(),i="absoluteOpacity",o="allEventListeners",c="absoluteTransform",u="absoluteScale",d="canvas",f="Change",h="children",g="konva",p="listening",x="mouseenter",v="mouseleave",C="pointerenter",b="pointerleave",_="touchenter",T="touchleave",N="set",E="Shape",F=" ",j="stage",P="transform",M="Stage",I="visible",U=["xChange.konva","yChange.konva","scaleXChange.konva","scaleYChange.konva","skewXChange.konva","skewYChange.konva","rotationChange.konva","offsetXChange.konva","offsetYChange.konva","transformsEnabledChange.konva"].join(F);let K=1,te=class ET{constructor(B){this._id=K++,this.eventListeners={},this.attrs={},this.index=0,this._allEventListeners=null,this.parent=null,this._cache=new Map,this._attachedDepsListeners=new Map,this._lastPos=null,this._batchingTransformChange=!1,this._needClearTransformCache=!1,this._filterUpToDate=!1,this._isUnderCache=!1,this._dragEventId=null,this._shouldFireChangeEvents=!1,this.setAttrs(B),this._shouldFireChangeEvents=!0}hasChildren(){return!1}_clearCache(B){(B===P||B===c)&&this._cache.get(B)?this._cache.get(B).dirty=!0:B?this._cache.delete(B):this._cache.clear()}_getCache(B,J){let z=this._cache.get(B);return(z===void 0||(B===P||B===c)&&z.dirty===!0)&&(z=J.call(this),this._cache.set(B,z)),z}_calculate(B,J,z){if(!this._attachedDepsListeners.get(B)){const q=J.map(H=>H+"Change.konva").join(F);this.on(q,()=>{this._clearCache(B)}),this._attachedDepsListeners.set(B,!0)}return this._getCache(B,z)}_getCanvasCache(){return this._cache.get(d)}_clearSelfAndDescendantCache(B){this._clearCache(B),B===c&&this.fire("absoluteTransformChange")}clearCache(){if(this._cache.has(d)){const{scene:B,filter:J,hit:z,buffer:q}=this._cache.get(d);s.Util.releaseCanvas(B,J,z,q),this._cache.delete(d)}return this._clearSelfAndDescendantCache(),this._requestDraw(),this}cache(B){const J=B||{};let z={};(J.x===void 0||J.y===void 0||J.width===void 0||J.height===void 0)&&(z=this.getClientRect({skipTransform:!0,relativeTo:this.getParent()||void 0}));let q=Math.ceil(J.width||z.width),H=Math.ceil(J.height||z.height),R=J.pixelRatio,L=J.x===void 0?Math.floor(z.x):J.x,G=J.y===void 0?Math.floor(z.y):J.y,W=J.offset||0,Q=J.drawBorder||!1,X=J.hitCanvasPixelRatio||1;if(!q||!H){s.Util.error("Can not cache the node. Width or height of the node equals 0. Caching is skipped.");return}const se=Math.abs(Math.round(z.x)-L)>.5?1:0,le=Math.abs(Math.round(z.y)-G)>.5?1:0;q+=W*2+se,H+=W*2+le,L-=W,G-=W;const he=new e.SceneCanvas({pixelRatio:R,width:q,height:H}),we=new e.SceneCanvas({pixelRatio:R,width:0,height:0,willReadFrequently:!0}),ie=new e.HitCanvas({pixelRatio:X,width:q,height:H}),Ee=he.getContext(),ye=ie.getContext(),Ie=new e.SceneCanvas({width:he.width/he.pixelRatio+Math.abs(L),height:he.height/he.pixelRatio+Math.abs(G),pixelRatio:he.pixelRatio}),ut=Ie.getContext();return ie.isCache=!0,he.isCache=!0,this._cache.delete(d),this._filterUpToDate=!1,J.imageSmoothingEnabled===!1&&(he.getContext()._context.imageSmoothingEnabled=!1,we.getContext()._context.imageSmoothingEnabled=!1),Ee.save(),ye.save(),ut.save(),Ee.translate(-L,-G),ye.translate(-L,-G),ut.translate(-L,-G),Ie.x=L,Ie.y=G,this._isUnderCache=!0,this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this.drawScene(he,this,Ie),this.drawHit(ie,this),this._isUnderCache=!1,Ee.restore(),ye.restore(),Q&&(Ee.save(),Ee.beginPath(),Ee.rect(0,0,q,H),Ee.closePath(),Ee.setAttr("strokeStyle","red"),Ee.setAttr("lineWidth",5),Ee.stroke(),Ee.restore()),this._cache.set(d,{scene:he,filter:we,hit:ie,buffer:Ie,x:L,y:G}),this._requestDraw(),this}isCached(){return this._cache.has(d)}getClientRect(B){throw new Error('abstract "getClientRect" method call')}_transformedRect(B,J){const z=[{x:B.x,y:B.y},{x:B.x+B.width,y:B.y},{x:B.x+B.width,y:B.y+B.height},{x:B.x,y:B.y+B.height}];let q=1/0,H=1/0,R=-1/0,L=-1/0;const G=this.getAbsoluteTransform(J);return z.forEach(function(W){const Q=G.point(W);q===void 0&&(q=R=Q.x,H=L=Q.y),q=Math.min(q,Q.x),H=Math.min(H,Q.y),R=Math.max(R,Q.x),L=Math.max(L,Q.y)}),{x:q,y:H,width:R-q,height:L-H}}_drawCachedSceneCanvas(B){B.save(),B._applyOpacity(this),B._applyGlobalCompositeOperation(this);const J=this._getCanvasCache();B.translate(J.x,J.y);const z=this._getCachedSceneCanvas(),q=z.pixelRatio;B.drawImage(z._canvas,0,0,z.width/q,z.height/q),B.restore()}_drawCachedHitCanvas(B){const J=this._getCanvasCache(),z=J.hit;B.save(),B.translate(J.x,J.y),B.drawImage(z._canvas,0,0,z.width/z.pixelRatio,z.height/z.pixelRatio),B.restore()}_getCachedSceneCanvas(){let B=this.filters(),J=this._getCanvasCache(),z=J.scene,q=J.filter,H=q.getContext(),R,L,G,W;if(B){if(!this._filterUpToDate){const Q=z.pixelRatio;q.setSize(z.width/z.pixelRatio,z.height/z.pixelRatio);try{for(R=B.length,H.clear(),H.drawImage(z._canvas,0,0,z.getWidth()/Q,z.getHeight()/Q),L=H.getImageData(0,0,q.getWidth(),q.getHeight()),G=0;G<R;G++){if(W=B[G],typeof W!="function"){s.Util.error("Filter should be type of function, but got "+typeof W+" instead. Please check correct filters");continue}W.call(this,L),H.putImageData(L,0,0)}}catch(X){s.Util.error("Unable to apply filter. "+X.message+" This post my help you https://konvajs.org/docs/posts/Tainted_Canvas.html.")}this._filterUpToDate=!0}return q}return z}on(B,J){if(this._cache&&this._cache.delete(o),arguments.length===3)return this._delegate.apply(this,arguments);const z=B.split(F);for(let q=0;q<z.length;q++){const R=z[q].split("."),L=R[0],G=R[1]||"";this.eventListeners[L]||(this.eventListeners[L]=[]),this.eventListeners[L].push({name:G,handler:J})}return this}off(B,J){let z=(B||"").split(F),q=z.length,H,R,L,G,W,Q;if(this._cache&&this._cache.delete(o),!B)for(R in this.eventListeners)this._off(R);for(H=0;H<q;H++)if(L=z[H],G=L.split("."),W=G[0],Q=G[1],W)this.eventListeners[W]&&this._off(W,Q,J);else for(R in this.eventListeners)this._off(R,Q,J);return this}dispatchEvent(B){const J={target:this,type:B.type,evt:B};return this.fire(B.type,J),this}addEventListener(B,J){return this.on(B,function(z){J.call(this,z.evt)}),this}removeEventListener(B){return this.off(B),this}_delegate(B,J,z){const q=this;this.on(B,function(H){const R=H.target.findAncestors(J,!0,q);for(let L=0;L<R.length;L++)H=s.Util.cloneObject(H),H.currentTarget=R[L],z.call(R[L],H)})}remove(){return this.isDragging()&&this.stopDrag(),t.DD._dragElements.delete(this._id),this._remove(),this}_clearCaches(){this._clearSelfAndDescendantCache(c),this._clearSelfAndDescendantCache(i),this._clearSelfAndDescendantCache(u),this._clearSelfAndDescendantCache(j),this._clearSelfAndDescendantCache(I),this._clearSelfAndDescendantCache(p)}_remove(){this._clearCaches();const B=this.getParent();B&&B.children&&(B.children.splice(this.index,1),B._setChildrenIndices(),this.parent=null)}destroy(){return this.remove(),this.clearCache(),this}getAttr(B){const J="get"+s.Util._capitalize(B);return s.Util._isFunction(this[J])?this[J]():this.attrs[B]}getAncestors(){let B=this.getParent(),J=[];for(;B;)J.push(B),B=B.getParent();return J}getAttrs(){return this.attrs||{}}setAttrs(B){return this._batchTransformChanges(()=>{let J,z;if(!B)return this;for(J in B)J!==h&&(z=N+s.Util._capitalize(J),s.Util._isFunction(this[z])?this[z](B[J]):this._setAttr(J,B[J]))}),this}isListening(){return this._getCache(p,this._isListening)}_isListening(B){if(!this.listening())return!1;const z=this.getParent();return z&&z!==B&&this!==B?z._isListening(B):!0}isVisible(){return this._getCache(I,this._isVisible)}_isVisible(B){if(!this.visible())return!1;const z=this.getParent();return z&&z!==B&&this!==B?z._isVisible(B):!0}shouldDrawHit(B,J=!1){if(B)return this._isVisible(B)&&this._isListening(B);const z=this.getLayer();let q=!1;t.DD._dragElements.forEach(R=>{R.dragStatus==="dragging"&&(R.node.nodeType==="Stage"||R.node.getLayer()===z)&&(q=!0)});const H=!J&&!n.Konva.hitOnDragEnabled&&(q||n.Konva.isTransforming());return this.isListening()&&this.isVisible()&&!H}show(){return this.visible(!0),this}hide(){return this.visible(!1),this}getZIndex(){return this.index||0}getAbsoluteZIndex(){let B=this.getDepth(),J=this,z=0,q,H,R,L;function G(Q){for(q=[],H=Q.length,R=0;R<H;R++)L=Q[R],z++,L.nodeType!==E&&(q=q.concat(L.getChildren().slice())),L._id===J._id&&(R=H);q.length>0&&q[0].getDepth()<=B&&G(q)}const W=this.getStage();return J.nodeType!==M&&W&&G(W.getChildren()),z}getDepth(){let B=0,J=this.parent;for(;J;)B++,J=J.parent;return B}_batchTransformChanges(B){this._batchingTransformChange=!0,B(),this._batchingTransformChange=!1,this._needClearTransformCache&&(this._clearCache(P),this._clearSelfAndDescendantCache(c)),this._needClearTransformCache=!1}setPosition(B){return this._batchTransformChanges(()=>{this.x(B.x),this.y(B.y)}),this}getPosition(){return{x:this.x(),y:this.y()}}getRelativePointerPosition(){const B=this.getStage();if(!B)return null;const J=B.getPointerPosition();if(!J)return null;const z=this.getAbsoluteTransform().copy();return z.invert(),z.point(J)}getAbsolutePosition(B){let J=!1,z=this.parent;for(;z;){if(z.isCached()){J=!0;break}z=z.parent}J&&!B&&(B=!0);const q=this.getAbsoluteTransform(B).getMatrix(),H=new s.Transform,R=this.offset();return H.m=q.slice(),H.translate(R.x,R.y),H.getTranslation()}setAbsolutePosition(B){const{x:J,y:z,...q}=this._clearTransform();this.attrs.x=J,this.attrs.y=z,this._clearCache(P);const H=this._getAbsoluteTransform().copy();return H.invert(),H.translate(B.x,B.y),B={x:this.attrs.x+H.getTranslation().x,y:this.attrs.y+H.getTranslation().y},this._setTransform(q),this.setPosition({x:B.x,y:B.y}),this._clearCache(P),this._clearSelfAndDescendantCache(c),this}_setTransform(B){let J;for(J in B)this.attrs[J]=B[J]}_clearTransform(){const B={x:this.x(),y:this.y(),rotation:this.rotation(),scaleX:this.scaleX(),scaleY:this.scaleY(),offsetX:this.offsetX(),offsetY:this.offsetY(),skewX:this.skewX(),skewY:this.skewY()};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scaleX=1,this.attrs.scaleY=1,this.attrs.offsetX=0,this.attrs.offsetY=0,this.attrs.skewX=0,this.attrs.skewY=0,B}move(B){let J=B.x,z=B.y,q=this.x(),H=this.y();return J!==void 0&&(q+=J),z!==void 0&&(H+=z),this.setPosition({x:q,y:H}),this}_eachAncestorReverse(B,J){let z=[],q=this.getParent(),H,R;if(!(J&&J._id===this._id)){for(z.unshift(this);q&&(!J||q._id!==J._id);)z.unshift(q),q=q.parent;for(H=z.length,R=0;R<H;R++)B(z[R])}}rotate(B){return this.rotation(this.rotation()+B),this}moveToTop(){if(!this.parent)return s.Util.warn("Node has no parent. moveToTop function is ignored."),!1;const B=this.index,J=this.parent.getChildren().length;return B<J-1?(this.parent.children.splice(B,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0):!1}moveUp(){if(!this.parent)return s.Util.warn("Node has no parent. moveUp function is ignored."),!1;const B=this.index,J=this.parent.getChildren().length;return B<J-1?(this.parent.children.splice(B,1),this.parent.children.splice(B+1,0,this),this.parent._setChildrenIndices(),!0):!1}moveDown(){if(!this.parent)return s.Util.warn("Node has no parent. moveDown function is ignored."),!1;const B=this.index;return B>0?(this.parent.children.splice(B,1),this.parent.children.splice(B-1,0,this),this.parent._setChildrenIndices(),!0):!1}moveToBottom(){if(!this.parent)return s.Util.warn("Node has no parent. moveToBottom function is ignored."),!1;const B=this.index;return B>0?(this.parent.children.splice(B,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):!1}setZIndex(B){if(!this.parent)return s.Util.warn("Node has no parent. zIndex parameter is ignored."),this;(B<0||B>=this.parent.children.length)&&s.Util.warn("Unexpected value "+B+" for zIndex property. zIndex is just index of a node in children of its parent. Expected value is from 0 to "+(this.parent.children.length-1)+".");const J=this.index;return this.parent.children.splice(J,1),this.parent.children.splice(B,0,this),this.parent._setChildrenIndices(),this}getAbsoluteOpacity(){return this._getCache(i,this._getAbsoluteOpacity)}_getAbsoluteOpacity(){let B=this.opacity();const J=this.getParent();return J&&!J._isUnderCache&&(B*=J.getAbsoluteOpacity()),B}moveTo(B){return this.getParent()!==B&&(this._remove(),B.add(this)),this}toObject(){let B=this.getAttrs(),J,z,q,H,R;const L={attrs:{},className:this.getClassName()};for(J in B)z=B[J],R=s.Util.isObject(z)&&!s.Util._isPlainObject(z)&&!s.Util._isArray(z),!R&&(q=typeof this[J]=="function"&&this[J],delete B[J],H=q?q.call(this):null,B[J]=z,H!==z&&(L.attrs[J]=z));return s.Util._prepareToStringify(L)}toJSON(){return JSON.stringify(this.toObject())}getParent(){return this.parent}findAncestors(B,J,z){const q=[];J&&this._isMatch(B)&&q.push(this);let H=this.parent;for(;H;){if(H===z)return q;H._isMatch(B)&&q.push(H),H=H.parent}return q}isAncestorOf(B){return!1}findAncestor(B,J,z){return this.findAncestors(B,J,z)[0]}_isMatch(B){if(!B)return!1;if(typeof B=="function")return B(this);let J=B.replace(/ /g,"").split(","),z=J.length,q,H;for(q=0;q<z;q++)if(H=J[q],s.Util.isValidSelector(H)||(s.Util.warn('Selector "'+H+'" is invalid. Allowed selectors examples are "#foo", ".bar" or "Group".'),s.Util.warn('If you have a custom shape with such className, please change it to start with upper letter like "Triangle".'),s.Util.warn("Konva is awesome, right?")),H.charAt(0)==="#"){if(this.id()===H.slice(1))return!0}else if(H.charAt(0)==="."){if(this.hasName(H.slice(1)))return!0}else if(this.className===H||this.nodeType===H)return!0;return!1}getLayer(){const B=this.getParent();return B?B.getLayer():null}getStage(){return this._getCache(j,this._getStage)}_getStage(){const B=this.getParent();return B?B.getStage():null}fire(B,J={},z){return J.target=J.target||this,z?this._fireAndBubble(B,J):this._fire(B,J),this}getAbsoluteTransform(B){return B?this._getAbsoluteTransform(B):this._getCache(c,this._getAbsoluteTransform)}_getAbsoluteTransform(B){let J;if(B)return J=new s.Transform,this._eachAncestorReverse(function(z){const q=z.transformsEnabled();q==="all"?J.multiply(z.getTransform()):q==="position"&&J.translate(z.x()-z.offsetX(),z.y()-z.offsetY())},B),J;{J=this._cache.get(c)||new s.Transform,this.parent?this.parent.getAbsoluteTransform().copyInto(J):J.reset();const z=this.transformsEnabled();if(z==="all")J.multiply(this.getTransform());else if(z==="position"){const q=this.attrs.x||0,H=this.attrs.y||0,R=this.attrs.offsetX||0,L=this.attrs.offsetY||0;J.translate(q-R,H-L)}return J.dirty=!1,J}}getAbsoluteScale(B){let J=this;for(;J;)J._isUnderCache&&(B=J),J=J.getParent();const q=this.getAbsoluteTransform(B).decompose();return{x:q.scaleX,y:q.scaleY}}getAbsoluteRotation(){return this.getAbsoluteTransform().decompose().rotation}getTransform(){return this._getCache(P,this._getTransform)}_getTransform(){var B,J;const z=this._cache.get(P)||new s.Transform;z.reset();const q=this.x(),H=this.y(),R=n.Konva.getAngle(this.rotation()),L=(B=this.attrs.scaleX)!==null&&B!==void 0?B:1,G=(J=this.attrs.scaleY)!==null&&J!==void 0?J:1,W=this.attrs.skewX||0,Q=this.attrs.skewY||0,X=this.attrs.offsetX||0,se=this.attrs.offsetY||0;return(q!==0||H!==0)&&z.translate(q,H),R!==0&&z.rotate(R),(W!==0||Q!==0)&&z.skew(W,Q),(L!==1||G!==1)&&z.scale(L,G),(X!==0||se!==0)&&z.translate(-1*X,-1*se),z.dirty=!1,z}clone(B){let J=s.Util.cloneObject(this.attrs),z,q,H,R,L;for(z in B)J[z]=B[z];const G=new this.constructor(J);for(z in this.eventListeners)for(q=this.eventListeners[z],H=q.length,R=0;R<H;R++)L=q[R],L.name.indexOf(g)<0&&(G.eventListeners[z]||(G.eventListeners[z]=[]),G.eventListeners[z].push(L));return G}_toKonvaCanvas(B){B=B||{};const J=this.getClientRect(),z=this.getStage(),q=B.x!==void 0?B.x:Math.floor(J.x),H=B.y!==void 0?B.y:Math.floor(J.y),R=B.pixelRatio||1,L=new e.SceneCanvas({width:B.width||Math.ceil(J.width)||(z?z.width():0),height:B.height||Math.ceil(J.height)||(z?z.height():0),pixelRatio:R}),G=L.getContext(),W=new e.SceneCanvas({width:L.width/L.pixelRatio+Math.abs(q),height:L.height/L.pixelRatio+Math.abs(H),pixelRatio:L.pixelRatio});return B.imageSmoothingEnabled===!1&&(G._context.imageSmoothingEnabled=!1),G.save(),(q||H)&&G.translate(-1*q,-1*H),this.drawScene(L,void 0,W),G.restore(),L}toCanvas(B){return this._toKonvaCanvas(B)._canvas}toDataURL(B){B=B||{};const J=B.mimeType||null,z=B.quality||null,q=this._toKonvaCanvas(B).toDataURL(J,z);return B.callback&&B.callback(q),q}toImage(B){return new Promise((J,z)=>{try{const q=B?.callback;q&&delete B.callback,s.Util._urlToImage(this.toDataURL(B),function(H){J(H),q?.(H)})}catch(q){z(q)}})}toBlob(B){return new Promise((J,z)=>{try{const q=B?.callback;q&&delete B.callback,this.toCanvas(B).toBlob(H=>{J(H),q?.(H)},B?.mimeType,B?.quality)}catch(q){z(q)}})}setSize(B){return this.width(B.width),this.height(B.height),this}getSize(){return{width:this.width(),height:this.height()}}getClassName(){return this.className||this.nodeType}getType(){return this.nodeType}getDragDistance(){return this.attrs.dragDistance!==void 0?this.attrs.dragDistance:this.parent?this.parent.getDragDistance():n.Konva.dragDistance}_off(B,J,z){let q=this.eventListeners[B],H,R,L;for(H=0;H<q.length;H++)if(R=q[H].name,L=q[H].handler,(R!=="konva"||J==="konva")&&(!J||R===J)&&(!z||z===L)){if(q.splice(H,1),q.length===0){delete this.eventListeners[B];break}H--}}_fireChangeEvent(B,J,z){this._fire(B+f,{oldVal:J,newVal:z})}addName(B){if(!this.hasName(B)){const J=this.name(),z=J?J+" "+B:B;this.name(z)}return this}hasName(B){if(!B)return!1;const J=this.name();return J?(J||"").split(/\s/g).indexOf(B)!==-1:!1}removeName(B){const J=(this.name()||"").split(/\s/g),z=J.indexOf(B);return z!==-1&&(J.splice(z,1),this.name(J.join(" "))),this}setAttr(B,J){const z=this[N+s.Util._capitalize(B)];return s.Util._isFunction(z)?z.call(this,J):this._setAttr(B,J),this}_requestDraw(){if(n.Konva.autoDrawEnabled){const B=this.getLayer()||this.getStage();B?.batchDraw()}}_setAttr(B,J){const z=this.attrs[B];z===J&&!s.Util.isObject(J)||(J==null?delete this.attrs[B]:this.attrs[B]=J,this._shouldFireChangeEvents&&this._fireChangeEvent(B,z,J),this._requestDraw())}_setComponentAttr(B,J,z){let q;z!==void 0&&(q=this.attrs[B],q||(this.attrs[B]=this.getAttr(B)),this.attrs[B][J]=z,this._fireChangeEvent(B,q,z))}_fireAndBubble(B,J,z){J&&this.nodeType===E&&(J.target=this);const q=[x,v,C,b,_,T];if(!(q.indexOf(B)!==-1&&(z&&(this===z||this.isAncestorOf&&this.isAncestorOf(z))||this.nodeType==="Stage"&&!z))){this._fire(B,J);const R=q.indexOf(B)!==-1&&z&&z.isAncestorOf&&z.isAncestorOf(this)&&!z.isAncestorOf(this.parent);(J&&!J.cancelBubble||!J)&&this.parent&&this.parent.isListening()&&!R&&(z&&z.parent?this._fireAndBubble.call(this.parent,B,J,z):this._fireAndBubble.call(this.parent,B,J))}}_getProtoListeners(B){var J,z,q;const H=(J=this._cache.get(o))!==null&&J!==void 0?J:{};let R=H?.[B];if(R===void 0){R=[];let L=Object.getPrototypeOf(this);for(;L;){const G=(q=(z=L.eventListeners)===null||z===void 0?void 0:z[B])!==null&&q!==void 0?q:[];R.push(...G),L=Object.getPrototypeOf(L)}H[B]=R,this._cache.set(o,H)}return R}_fire(B,J){J=J||{},J.currentTarget=this,J.type=B;const z=this._getProtoListeners(B);if(z)for(let H=0;H<z.length;H++)z[H].handler.call(this,J);const q=this.eventListeners[B];if(q)for(let H=0;H<q.length;H++)q[H].handler.call(this,J)}draw(){return this.drawScene(),this.drawHit(),this}_createDragElement(B){const J=B?B.pointerId:void 0,z=this.getStage(),q=this.getAbsolutePosition();if(!z)return;const H=z._getPointerById(J)||z._changedPointerPositions[0]||q;t.DD._dragElements.set(this._id,{node:this,startPointerPos:H,offset:{x:H.x-q.x,y:H.y-q.y},dragStatus:"ready",pointerId:J})}startDrag(B,J=!0){t.DD._dragElements.has(this._id)||this._createDragElement(B);const z=t.DD._dragElements.get(this._id);z.dragStatus="dragging",this.fire("dragstart",{type:"dragstart",target:this,evt:B&&B.evt},J)}_setDragPosition(B,J){const z=this.getStage()._getPointerById(J.pointerId);if(!z)return;let q={x:z.x-J.offset.x,y:z.y-J.offset.y};const H=this.dragBoundFunc();if(H!==void 0){const R=H.call(this,q,B);R?q=R:s.Util.warn("dragBoundFunc did not return any value. That is unexpected behavior. You must return new absolute position from dragBoundFunc.")}(!this._lastPos||this._lastPos.x!==q.x||this._lastPos.y!==q.y)&&(this.setAbsolutePosition(q),this._requestDraw()),this._lastPos=q}stopDrag(B){const J=t.DD._dragElements.get(this._id);J&&(J.dragStatus="stopped"),t.DD._endDragBefore(B),t.DD._endDragAfter(B)}setDraggable(B){this._setAttr("draggable",B),this._dragChange()}isDragging(){const B=t.DD._dragElements.get(this._id);return B?B.dragStatus==="dragging":!1}_listenDrag(){this._dragCleanup(),this.on("mousedown.konva touchstart.konva",function(B){if(!(!(B.evt.button!==void 0)||n.Konva.dragButtons.indexOf(B.evt.button)>=0)||this.isDragging())return;let q=!1;t.DD._dragElements.forEach(H=>{this.isAncestorOf(H.node)&&(q=!0)}),q||this._createDragElement(B)})}_dragChange(){if(this.attrs.draggable)this._listenDrag();else{if(this._dragCleanup(),!this.getStage())return;const J=t.DD._dragElements.get(this._id),z=J&&J.dragStatus==="dragging",q=J&&J.dragStatus==="ready";z?this.stopDrag():q&&t.DD._dragElements.delete(this._id)}}_dragCleanup(){this.off("mousedown.konva"),this.off("touchstart.konva")}isClientRectOnScreen(B={x:0,y:0}){const J=this.getStage();if(!J)return!1;const z={x:-B.x,y:-B.y,width:J.width()+2*B.x,height:J.height()+2*B.y};return s.Util.haveIntersection(z,this.getClientRect())}static create(B,J){return s.Util._isString(B)&&(B=JSON.parse(B)),this._createNode(B,J)}static _createNode(B,J){let z=ET.prototype.getClassName.call(B),q=B.children,H,R,L;J&&(B.attrs.container=J),n.Konva[z]||(s.Util.warn('Can not find a node with class name "'+z+'". Fallback to "Shape".'),z="Shape");const G=n.Konva[z];if(H=new G(B.attrs),q)for(R=q.length,L=0;L<R;L++)H.add(ET._createNode(q[L]));return H}};ny.Node=te,te.prototype.nodeType="Node",te.prototype._attrsAffectingSize=[],te.prototype.eventListeners={},te.prototype.on.call(te.prototype,U,function(){if(this._batchingTransformChange){this._needClearTransformCache=!0;return}this._clearCache(P),this._clearSelfAndDescendantCache(c)}),te.prototype.on.call(te.prototype,"visibleChange.konva",function(){this._clearSelfAndDescendantCache(I)}),te.prototype.on.call(te.prototype,"listeningChange.konva",function(){this._clearSelfAndDescendantCache(p)}),te.prototype.on.call(te.prototype,"opacityChange.konva",function(){this._clearSelfAndDescendantCache(i)});const re=r.Factory.addGetterSetter;return re(te,"zIndex"),re(te,"absolutePosition"),re(te,"position"),re(te,"x",0,(0,a.getNumberValidator)()),re(te,"y",0,(0,a.getNumberValidator)()),re(te,"globalCompositeOperation","source-over",(0,a.getStringValidator)()),re(te,"opacity",1,(0,a.getNumberValidator)()),re(te,"name","",(0,a.getStringValidator)()),re(te,"id","",(0,a.getStringValidator)()),re(te,"rotation",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(te,"scale",["x","y"]),re(te,"scaleX",1,(0,a.getNumberValidator)()),re(te,"scaleY",1,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(te,"skew",["x","y"]),re(te,"skewX",0,(0,a.getNumberValidator)()),re(te,"skewY",0,(0,a.getNumberValidator)()),r.Factory.addComponentsGetterSetter(te,"offset",["x","y"]),re(te,"offsetX",0,(0,a.getNumberValidator)()),re(te,"offsetY",0,(0,a.getNumberValidator)()),re(te,"dragDistance",void 0,(0,a.getNumberValidator)()),re(te,"width",0,(0,a.getNumberValidator)()),re(te,"height",0,(0,a.getNumberValidator)()),re(te,"listening",!0,(0,a.getBooleanValidator)()),re(te,"preventDefault",!0,(0,a.getBooleanValidator)()),re(te,"filters",void 0,function(Z){return this._filterUpToDate=!1,Z}),re(te,"visible",!0,(0,a.getBooleanValidator)()),re(te,"transformsEnabled","all",(0,a.getStringValidator)()),re(te,"size"),re(te,"dragBoundFunc"),re(te,"draggable",!1,(0,a.getBooleanValidator)()),r.Factory.backCompat(te,{rotateDeg:"rotate",setRotationDeg:"setRotation",getRotationDeg:"getRotation"}),ny}var sy={},PF;function MS(){if(PF)return sy;PF=1,Object.defineProperty(sy,"__esModule",{value:!0}),sy.Container=void 0;const e=Bn(),t=$a(),r=Un();let n=class extends t.Node{constructor(){super(...arguments),this.children=[]}getChildren(a){const i=this.children||[];return a?i.filter(a):i}hasChildren(){return this.getChildren().length>0}removeChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.remove()}),this.children=[],this._requestDraw(),this}destroyChildren(){return this.getChildren().forEach(a=>{a.parent=null,a.index=0,a.destroy()}),this.children=[],this._requestDraw(),this}add(...a){if(a.length===0)return this;if(a.length>1){for(let o=0;o<a.length;o++)this.add(a[o]);return this}const i=a[0];return i.getParent()?(i.moveTo(this),this):(this._validateAdd(i),i.index=this.getChildren().length,i.parent=this,i._clearCaches(),this.getChildren().push(i),this._fire("add",{child:i}),this._requestDraw(),this)}destroy(){return this.hasChildren()&&this.destroyChildren(),super.destroy(),this}find(a){return this._generalFind(a,!1)}findOne(a){const i=this._generalFind(a,!0);return i.length>0?i[0]:void 0}_generalFind(a,i){const o=[];return this._descendants(c=>{const u=c._isMatch(a);return u&&o.push(c),!!(u&&i)}),o}_descendants(a){let i=!1;const o=this.getChildren();for(const c of o){if(i=a(c),i)return!0;if(c.hasChildren()&&(i=c._descendants(a),i))return!0}return!1}toObject(){const a=t.Node.prototype.toObject.call(this);return a.children=[],this.getChildren().forEach(i=>{a.children.push(i.toObject())}),a}isAncestorOf(a){let i=a.getParent();for(;i;){if(i._id===this._id)return!0;i=i.getParent()}return!1}clone(a){const i=t.Node.prototype.clone.call(this,a);return this.getChildren().forEach(function(o){i.add(o.clone())}),i}getAllIntersections(a){const i=[];return this.find("Shape").forEach(o=>{o.isVisible()&&o.intersects(a)&&i.push(o)}),i}_clearSelfAndDescendantCache(a){var i;super._clearSelfAndDescendantCache(a),!this.isCached()&&((i=this.children)===null||i===void 0||i.forEach(function(o){o._clearSelfAndDescendantCache(a)}))}_setChildrenIndices(){var a;(a=this.children)===null||a===void 0||a.forEach(function(i,o){i.index=o}),this._requestDraw()}drawScene(a,i,o){const c=this.getLayer(),u=a||c&&c.getCanvas(),d=u&&u.getContext(),f=this._getCanvasCache(),h=f&&f.scene,g=u&&u.isCache;if(!this.isVisible()&&!g)return this;if(h){d.save();const p=this.getAbsoluteTransform(i).getMatrix();d.transform(p[0],p[1],p[2],p[3],p[4],p[5]),this._drawCachedSceneCanvas(d),d.restore()}else this._drawChildren("drawScene",u,i,o);return this}drawHit(a,i){if(!this.shouldDrawHit(i))return this;const o=this.getLayer(),c=a||o&&o.hitCanvas,u=c&&c.getContext(),d=this._getCanvasCache();if(d&&d.hit){u.save();const h=this.getAbsoluteTransform(i).getMatrix();u.transform(h[0],h[1],h[2],h[3],h[4],h[5]),this._drawCachedHitCanvas(u),u.restore()}else this._drawChildren("drawHit",c,i);return this}_drawChildren(a,i,o,c){var u;const d=i&&i.getContext(),f=this.clipWidth(),h=this.clipHeight(),g=this.clipFunc(),p=typeof f=="number"&&typeof h=="number"||g,x=o===this;if(p){d.save();const C=this.getAbsoluteTransform(o);let b=C.getMatrix();d.transform(b[0],b[1],b[2],b[3],b[4],b[5]),d.beginPath();let _;if(g)_=g.call(this,d,this);else{const T=this.clipX(),N=this.clipY();d.rect(T||0,N||0,f,h)}d.clip.apply(d,_),b=C.copy().invert().getMatrix(),d.transform(b[0],b[1],b[2],b[3],b[4],b[5])}const v=!x&&this.globalCompositeOperation()!=="source-over"&&a==="drawScene";v&&(d.save(),d._applyGlobalCompositeOperation(this)),(u=this.children)===null||u===void 0||u.forEach(function(C){C[a](i,o,c)}),v&&d.restore(),p&&d.restore()}getClientRect(a={}){var i;const o=a.skipTransform,c=a.relativeTo;let u,d,f,h,g={x:1/0,y:1/0,width:0,height:0};const p=this;(i=this.children)===null||i===void 0||i.forEach(function(C){if(!C.visible())return;const b=C.getClientRect({relativeTo:p,skipShadow:a.skipShadow,skipStroke:a.skipStroke});b.width===0&&b.height===0||(u===void 0?(u=b.x,d=b.y,f=b.x+b.width,h=b.y+b.height):(u=Math.min(u,b.x),d=Math.min(d,b.y),f=Math.max(f,b.x+b.width),h=Math.max(h,b.y+b.height)))});const x=this.find("Shape");let v=!1;for(let C=0;C<x.length;C++)if(x[C]._isVisible(this)){v=!0;break}return v&&u!==void 0?g={x:u,y:d,width:f-u,height:h-d}:g={x:0,y:0,width:0,height:0},o?g:this._transformedRect(g,c)}};return sy.Container=n,e.Factory.addComponentsGetterSetter(n,"clip",["x","y","width","height"]),e.Factory.addGetterSetter(n,"clipX",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipY",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipWidth",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipHeight",void 0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(n,"clipFunc"),sy}var a6={},Pf={},FF;function yH(){if(FF)return Pf;FF=1,Object.defineProperty(Pf,"__esModule",{value:!0}),Pf.getCapturedShape=n,Pf.createEvent=s,Pf.hasPointerCapture=a,Pf.setPointerCapture=i,Pf.releaseCapture=o;const e=Rn(),t=new Map,r=e.Konva._global.PointerEvent!==void 0;function n(c){return t.get(c)}function s(c){return{evt:c,pointerId:c.pointerId}}function a(c,u){return t.get(c)===u}function i(c,u){o(c),u.getStage()&&(t.set(c,u),r&&u._fire("gotpointercapture",s(new PointerEvent("gotpointercapture"))))}function o(c,u){const d=t.get(c);if(!d)return;const f=d.getStage();f&&f.content,t.delete(c),r&&d._fire("lostpointercapture",s(new PointerEvent("lostpointercapture")))}return Pf}var MF;function Nle(){return MF||(MF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Stage=e.stages=void 0;const t=Ca(),r=Bn(),n=MS(),s=Rn(),a=FS(),i=SN(),o=Rn(),c=yH(),u="Stage",d="string",f="px",h="mouseout",g="mouseleave",p="mouseover",x="mouseenter",v="mousemove",C="mousedown",b="mouseup",_="pointermove",T="pointerdown",N="pointerup",E="pointercancel",F="lostpointercapture",j="pointerout",P="pointerleave",M="pointerover",I="pointerenter",U="contextmenu",K="touchstart",te="touchend",re="touchmove",Z="touchcancel",B="wheel",J=5,z=[[x,"_pointerenter"],[C,"_pointerdown"],[v,"_pointermove"],[b,"_pointerup"],[g,"_pointerleave"],[K,"_pointerdown"],[re,"_pointermove"],[te,"_pointerup"],[Z,"_pointercancel"],[p,"_pointerover"],[B,"_wheel"],[U,"_contextmenu"],[T,"_pointerdown"],[_,"_pointermove"],[N,"_pointerup"],[E,"_pointercancel"],[P,"_pointerleave"],[F,"_lostpointercapture"]],q={mouse:{[j]:h,[P]:g,[M]:p,[I]:x,[_]:v,[T]:C,[N]:b,[E]:"mousecancel",pointerclick:"click",pointerdblclick:"dblclick"},touch:{[j]:"touchout",[P]:"touchleave",[M]:"touchover",[I]:"touchenter",[_]:re,[T]:K,[N]:te,[E]:Z,pointerclick:"tap",pointerdblclick:"dbltap"},pointer:{[j]:j,[P]:P,[M]:M,[I]:I,[_]:_,[T]:T,[N]:N,[E]:E,pointerclick:"pointerclick",pointerdblclick:"pointerdblclick"}},H=Q=>Q.indexOf("pointer")>=0?"pointer":Q.indexOf("touch")>=0?"touch":"mouse",R=Q=>{const X=H(Q);if(X==="pointer")return s.Konva.pointerEventsEnabled&&q.pointer;if(X==="touch")return q.touch;if(X==="mouse")return q.mouse};function L(Q={}){return(Q.clipFunc||Q.clipWidth||Q.clipHeight)&&t.Util.warn("Stage does not support clipping. Please use clip for Layers or Groups."),Q}const G="Pointer position is missing and not registered by the stage. Looks like it is outside of the stage container. You can set it manually from event: stage.setPointersPositions(event);";e.stages=[];class W extends n.Container{constructor(X){super(L(X)),this._pointerPositions=[],this._changedPointerPositions=[],this._buildDOM(),this._bindContentEvents(),e.stages.push(this),this.on("widthChange.konva heightChange.konva",this._resizeDOM),this.on("visibleChange.konva",this._checkVisibility),this.on("clipWidthChange.konva clipHeightChange.konva clipFuncChange.konva",()=>{L(this.attrs)}),this._checkVisibility()}_validateAdd(X){const se=X.getType()==="Layer",le=X.getType()==="FastLayer";se||le||t.Util.throw("You may only add layers to the stage.")}_checkVisibility(){if(!this.content)return;const X=this.visible()?"":"none";this.content.style.display=X}setContainer(X){if(typeof X===d){let se;if(X.charAt(0)==="."){const le=X.slice(1);X=document.getElementsByClassName(le)[0]}else X.charAt(0)!=="#"?se=X:se=X.slice(1),X=document.getElementById(se);if(!X)throw"Can not find container in document with id "+se}return this._setAttr("container",X),this.content&&(this.content.parentElement&&this.content.parentElement.removeChild(this.content),X.appendChild(this.content)),this}shouldDrawHit(){return!0}clear(){const X=this.children,se=X.length;for(let le=0;le<se;le++)X[le].clear();return this}clone(X){return X||(X={}),X.container=typeof document<"u"&&document.createElement("div"),n.Container.prototype.clone.call(this,X)}destroy(){super.destroy();const X=this.content;X&&t.Util._isInDocument(X)&&this.container().removeChild(X);const se=e.stages.indexOf(this);return se>-1&&e.stages.splice(se,1),t.Util.releaseCanvas(this.bufferCanvas._canvas,this.bufferHitCanvas._canvas),this}getPointerPosition(){const X=this._pointerPositions[0]||this._changedPointerPositions[0];return X?{x:X.x,y:X.y}:(t.Util.warn(G),null)}_getPointerById(X){return this._pointerPositions.find(se=>se.id===X)}getPointersPositions(){return this._pointerPositions}getStage(){return this}getContent(){return this.content}_toKonvaCanvas(X){X=X||{},X.x=X.x||0,X.y=X.y||0,X.width=X.width||this.width(),X.height=X.height||this.height();const se=new a.SceneCanvas({width:X.width,height:X.height,pixelRatio:X.pixelRatio||1}),le=se.getContext()._context,he=this.children;return(X.x||X.y)&&le.translate(-1*X.x,-1*X.y),he.forEach(function(we){if(!we.isVisible())return;const ie=we._toKonvaCanvas(X);le.drawImage(ie._canvas,X.x,X.y,ie.getWidth()/ie.getPixelRatio(),ie.getHeight()/ie.getPixelRatio())}),se}getIntersection(X){if(!X)return null;const se=this.children,le=se.length,he=le-1;for(let we=he;we>=0;we--){const ie=se[we].getIntersection(X);if(ie)return ie}return null}_resizeDOM(){const X=this.width(),se=this.height();this.content&&(this.content.style.width=X+f,this.content.style.height=se+f),this.bufferCanvas.setSize(X,se),this.bufferHitCanvas.setSize(X,se),this.children.forEach(le=>{le.setSize({width:X,height:se}),le.draw()})}add(X,...se){if(arguments.length>1){for(let he=0;he<arguments.length;he++)this.add(arguments[he]);return this}super.add(X);const le=this.children.length;return le>J&&t.Util.warn("The stage has "+le+" layers. Recommended maximum number of layers is 3-5. Adding more layers into the stage may drop the performance. Rethink your tree structure, you can use Konva.Group."),X.setSize({width:this.width(),height:this.height()}),X.draw(),s.Konva.isBrowser&&this.content.appendChild(X.canvas._canvas),this}getParent(){return null}getLayer(){return null}hasPointerCapture(X){return c.hasPointerCapture(X,this)}setPointerCapture(X){c.setPointerCapture(X,this)}releaseCapture(X){c.releaseCapture(X,this)}getLayers(){return this.children}_bindContentEvents(){s.Konva.isBrowser&&z.forEach(([X,se])=>{this.content.addEventListener(X,le=>{this[se](le)},{passive:!1})})}_pointerenter(X){this.setPointersPositions(X);const se=R(X.type);se&&this._fire(se.pointerenter,{evt:X,target:this,currentTarget:this})}_pointerover(X){this.setPointersPositions(X);const se=R(X.type);se&&this._fire(se.pointerover,{evt:X,target:this,currentTarget:this})}_getTargetShape(X){let se=this[X+"targetShape"];return se&&!se.getStage()&&(se=null),se}_pointerleave(X){const se=R(X.type),le=H(X.type);if(!se)return;this.setPointersPositions(X);const he=this._getTargetShape(le),we=!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled;he&&we?(he._fireAndBubble(se.pointerout,{evt:X}),he._fireAndBubble(se.pointerleave,{evt:X}),this._fire(se.pointerleave,{evt:X,target:this,currentTarget:this}),this[le+"targetShape"]=null):we&&(this._fire(se.pointerleave,{evt:X,target:this,currentTarget:this}),this._fire(se.pointerout,{evt:X,target:this,currentTarget:this})),this.pointerPos=null,this._pointerPositions=[]}_pointerdown(X){const se=R(X.type),le=H(X.type);if(!se)return;this.setPointersPositions(X);let he=!1;this._changedPointerPositions.forEach(we=>{const ie=this.getIntersection(we);if(i.DD.justDragged=!1,s.Konva["_"+le+"ListenClick"]=!0,!ie||!ie.isListening()){this[le+"ClickStartShape"]=void 0;return}s.Konva.capturePointerEventsEnabled&&ie.setPointerCapture(we.id),this[le+"ClickStartShape"]=ie,ie._fireAndBubble(se.pointerdown,{evt:X,pointerId:we.id}),he=!0;const Ee=X.type.indexOf("touch")>=0;ie.preventDefault()&&X.cancelable&&Ee&&X.preventDefault()}),he||this._fire(se.pointerdown,{evt:X,target:this,currentTarget:this,pointerId:this._pointerPositions[0].id})}_pointermove(X){const se=R(X.type),le=H(X.type);if(!se||(s.Konva.isDragging()&&i.DD.node.preventDefault()&&X.cancelable&&X.preventDefault(),this.setPointersPositions(X),!(!(s.Konva.isDragging()||s.Konva.isTransforming())||s.Konva.hitOnDragEnabled)))return;const we={};let ie=!1;const Ee=this._getTargetShape(le);this._changedPointerPositions.forEach(ye=>{const Ie=c.getCapturedShape(ye.id)||this.getIntersection(ye),ut=ye.id,Qe={evt:X,pointerId:ut},$t=Ee!==Ie;if($t&&Ee&&(Ee._fireAndBubble(se.pointerout,{...Qe},Ie),Ee._fireAndBubble(se.pointerleave,{...Qe},Ie)),Ie){if(we[Ie._id])return;we[Ie._id]=!0}Ie&&Ie.isListening()?(ie=!0,$t&&(Ie._fireAndBubble(se.pointerover,{...Qe},Ee),Ie._fireAndBubble(se.pointerenter,{...Qe},Ee),this[le+"targetShape"]=Ie),Ie._fireAndBubble(se.pointermove,{...Qe})):Ee&&(this._fire(se.pointerover,{evt:X,target:this,currentTarget:this,pointerId:ut}),this[le+"targetShape"]=null)}),ie||this._fire(se.pointermove,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id})}_pointerup(X){const se=R(X.type),le=H(X.type);if(!se)return;this.setPointersPositions(X);const he=this[le+"ClickStartShape"],we=this[le+"ClickEndShape"],ie={};let Ee=!1;this._changedPointerPositions.forEach(ye=>{const Ie=c.getCapturedShape(ye.id)||this.getIntersection(ye);if(Ie){if(Ie.releaseCapture(ye.id),ie[Ie._id])return;ie[Ie._id]=!0}const ut=ye.id,Qe={evt:X,pointerId:ut};let $t=!1;s.Konva["_"+le+"InDblClickWindow"]?($t=!0,clearTimeout(this[le+"DblTimeout"])):i.DD.justDragged||(s.Konva["_"+le+"InDblClickWindow"]=!0,clearTimeout(this[le+"DblTimeout"])),this[le+"DblTimeout"]=setTimeout(function(){s.Konva["_"+le+"InDblClickWindow"]=!1},s.Konva.dblClickWindow),Ie&&Ie.isListening()?(Ee=!0,this[le+"ClickEndShape"]=Ie,Ie._fireAndBubble(se.pointerup,{...Qe}),s.Konva["_"+le+"ListenClick"]&&he&&he===Ie&&(Ie._fireAndBubble(se.pointerclick,{...Qe}),$t&&we&&we===Ie&&Ie._fireAndBubble(se.pointerdblclick,{...Qe}))):(this[le+"ClickEndShape"]=null,s.Konva["_"+le+"ListenClick"]&&this._fire(se.pointerclick,{evt:X,target:this,currentTarget:this,pointerId:ut}),$t&&this._fire(se.pointerdblclick,{evt:X,target:this,currentTarget:this,pointerId:ut}))}),Ee||this._fire(se.pointerup,{evt:X,target:this,currentTarget:this,pointerId:this._changedPointerPositions[0].id}),s.Konva["_"+le+"ListenClick"]=!1,X.cancelable&&le!=="touch"&&le!=="pointer"&&X.preventDefault()}_contextmenu(X){this.setPointersPositions(X);const se=this.getIntersection(this.getPointerPosition());se&&se.isListening()?se._fireAndBubble(U,{evt:X}):this._fire(U,{evt:X,target:this,currentTarget:this})}_wheel(X){this.setPointersPositions(X);const se=this.getIntersection(this.getPointerPosition());se&&se.isListening()?se._fireAndBubble(B,{evt:X}):this._fire(B,{evt:X,target:this,currentTarget:this})}_pointercancel(X){this.setPointersPositions(X);const se=c.getCapturedShape(X.pointerId)||this.getIntersection(this.getPointerPosition());se&&se._fireAndBubble(N,c.createEvent(X)),c.releaseCapture(X.pointerId)}_lostpointercapture(X){c.releaseCapture(X.pointerId)}setPointersPositions(X){const se=this._getContentPosition();let le=null,he=null;X=X||window.event,X.touches!==void 0?(this._pointerPositions=[],this._changedPointerPositions=[],Array.prototype.forEach.call(X.touches,we=>{this._pointerPositions.push({id:we.identifier,x:(we.clientX-se.left)/se.scaleX,y:(we.clientY-se.top)/se.scaleY})}),Array.prototype.forEach.call(X.changedTouches||X.touches,we=>{this._changedPointerPositions.push({id:we.identifier,x:(we.clientX-se.left)/se.scaleX,y:(we.clientY-se.top)/se.scaleY})})):(le=(X.clientX-se.left)/se.scaleX,he=(X.clientY-se.top)/se.scaleY,this.pointerPos={x:le,y:he},this._pointerPositions=[{x:le,y:he,id:t.Util._getFirstPointerId(X)}],this._changedPointerPositions=[{x:le,y:he,id:t.Util._getFirstPointerId(X)}])}_setPointerPosition(X){t.Util.warn('Method _setPointerPosition is deprecated. Use "stage.setPointersPositions(event)" instead.'),this.setPointersPositions(X)}_getContentPosition(){if(!this.content||!this.content.getBoundingClientRect)return{top:0,left:0,scaleX:1,scaleY:1};const X=this.content.getBoundingClientRect();return{top:X.top,left:X.left,scaleX:X.width/this.content.clientWidth||1,scaleY:X.height/this.content.clientHeight||1}}_buildDOM(){if(this.bufferCanvas=new a.SceneCanvas({width:this.width(),height:this.height()}),this.bufferHitCanvas=new a.HitCanvas({pixelRatio:1,width:this.width(),height:this.height()}),!s.Konva.isBrowser)return;const X=this.container();if(!X)throw"Stage has no container. A container is required.";X.innerHTML="",this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.userSelect="none",this.content.className="konvajs-content",this.content.setAttribute("role","presentation"),X.appendChild(this.content),this._resizeDOM()}cache(){return t.Util.warn("Cache function is not allowed for stage. You may use cache only for layers, groups and shapes."),this}clearCache(){return this}batchDraw(){return this.getChildren().forEach(function(X){X.batchDraw()}),this}}e.Stage=W,W.prototype.nodeType=u,(0,o._registerNode)(W),r.Factory.addGetterSetter(W,"container"),s.Konva.isBrowser&&document.addEventListener("visibilitychange",()=>{e.stages.forEach(Q=>{Q.batchDraw()})})})(a6)),a6}var ay={},i6={},RF;function Oi(){return RF||(RF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.shapes=void 0;const t=Rn(),r=Ca(),n=Bn(),s=$a(),a=Un(),i=Rn(),o=yH(),c="hasShadow",u="shadowRGBA",d="patternImage",f="linearGradient",h="radialGradient";let g;function p(){return g||(g=r.Util.createCanvasElement().getContext("2d"),g)}e.shapes={};function x(P){const M=this.attrs.fillRule;M?P.fill(M):P.fill()}function v(P){P.stroke()}function C(P){const M=this.attrs.fillRule;M?P.fill(M):P.fill()}function b(P){P.stroke()}function _(){this._clearCache(c)}function T(){this._clearCache(u)}function N(){this._clearCache(d)}function E(){this._clearCache(f)}function F(){this._clearCache(h)}class j extends s.Node{constructor(M){super(M);let I;for(;I=r.Util.getRandomColor(),!(I&&!(I in e.shapes)););this.colorKey=I,e.shapes[I]=this}getContext(){return r.Util.warn("shape.getContext() method is deprecated. Please do not use it."),this.getLayer().getContext()}getCanvas(){return r.Util.warn("shape.getCanvas() method is deprecated. Please do not use it."),this.getLayer().getCanvas()}getSceneFunc(){return this.attrs.sceneFunc||this._sceneFunc}getHitFunc(){return this.attrs.hitFunc||this._hitFunc}hasShadow(){return this._getCache(c,this._hasShadow)}_hasShadow(){return this.shadowEnabled()&&this.shadowOpacity()!==0&&!!(this.shadowColor()||this.shadowBlur()||this.shadowOffsetX()||this.shadowOffsetY())}_getFillPattern(){return this._getCache(d,this.__getFillPattern)}__getFillPattern(){if(this.fillPatternImage()){const I=p().createPattern(this.fillPatternImage(),this.fillPatternRepeat()||"repeat");if(I&&I.setTransform){const U=new r.Transform;U.translate(this.fillPatternX(),this.fillPatternY()),U.rotate(t.Konva.getAngle(this.fillPatternRotation())),U.scale(this.fillPatternScaleX(),this.fillPatternScaleY()),U.translate(-1*this.fillPatternOffsetX(),-1*this.fillPatternOffsetY());const K=U.getMatrix(),te=typeof DOMMatrix>"u"?{a:K[0],b:K[1],c:K[2],d:K[3],e:K[4],f:K[5]}:new DOMMatrix(K);I.setTransform(te)}return I}}_getLinearGradient(){return this._getCache(f,this.__getLinearGradient)}__getLinearGradient(){const M=this.fillLinearGradientColorStops();if(M){const I=p(),U=this.fillLinearGradientStartPoint(),K=this.fillLinearGradientEndPoint(),te=I.createLinearGradient(U.x,U.y,K.x,K.y);for(let re=0;re<M.length;re+=2)te.addColorStop(M[re],M[re+1]);return te}}_getRadialGradient(){return this._getCache(h,this.__getRadialGradient)}__getRadialGradient(){const M=this.fillRadialGradientColorStops();if(M){const I=p(),U=this.fillRadialGradientStartPoint(),K=this.fillRadialGradientEndPoint(),te=I.createRadialGradient(U.x,U.y,this.fillRadialGradientStartRadius(),K.x,K.y,this.fillRadialGradientEndRadius());for(let re=0;re<M.length;re+=2)te.addColorStop(M[re],M[re+1]);return te}}getShadowRGBA(){return this._getCache(u,this._getShadowRGBA)}_getShadowRGBA(){if(!this.hasShadow())return;const M=r.Util.colorToRGBA(this.shadowColor());if(M)return"rgba("+M.r+","+M.g+","+M.b+","+M.a*(this.shadowOpacity()||1)+")"}hasFill(){return this._calculate("hasFill",["fillEnabled","fill","fillPatternImage","fillLinearGradientColorStops","fillRadialGradientColorStops"],()=>this.fillEnabled()&&!!(this.fill()||this.fillPatternImage()||this.fillLinearGradientColorStops()||this.fillRadialGradientColorStops()))}hasStroke(){return this._calculate("hasStroke",["strokeEnabled","strokeWidth","stroke","strokeLinearGradientColorStops"],()=>this.strokeEnabled()&&this.strokeWidth()&&!!(this.stroke()||this.strokeLinearGradientColorStops()))}hasHitStroke(){const M=this.hitStrokeWidth();return M==="auto"?this.hasStroke():this.strokeEnabled()&&!!M}intersects(M){const I=this.getStage();if(!I)return!1;const U=I.bufferHitCanvas;return U.getContext().clear(),this.drawHit(U,void 0,!0),U.context.getImageData(Math.round(M.x),Math.round(M.y),1,1).data[3]>0}destroy(){return s.Node.prototype.destroy.call(this),delete e.shapes[this.colorKey],delete this.colorKey,this}_useBufferCanvas(M){var I;if(!((I=this.attrs.perfectDrawEnabled)!==null&&I!==void 0?I:!0))return!1;const K=M||this.hasFill(),te=this.hasStroke(),re=this.getAbsoluteOpacity()!==1;if(K&&te&&re)return!0;const Z=this.hasShadow(),B=this.shadowForStrokeEnabled();return!!(K&&te&&Z&&B)}setStrokeHitEnabled(M){r.Util.warn("strokeHitEnabled property is deprecated. Please use hitStrokeWidth instead."),M?this.hitStrokeWidth("auto"):this.hitStrokeWidth(0)}getStrokeHitEnabled(){return this.hitStrokeWidth()!==0}getSelfRect(){const M=this.size();return{x:this._centroid?-M.width/2:0,y:this._centroid?-M.height/2:0,width:M.width,height:M.height}}getClientRect(M={}){let I=!1,U=this.getParent();for(;U;){if(U.isCached()){I=!0;break}U=U.getParent()}const K=M.skipTransform,te=M.relativeTo||I&&this.getStage()||void 0,re=this.getSelfRect(),B=!M.skipStroke&&this.hasStroke()&&this.strokeWidth()||0,J=re.width+B,z=re.height+B,q=!M.skipShadow&&this.hasShadow(),H=q?this.shadowOffsetX():0,R=q?this.shadowOffsetY():0,L=J+Math.abs(H),G=z+Math.abs(R),W=q&&this.shadowBlur()||0,Q=L+W*2,X=G+W*2,se={width:Q,height:X,x:-(B/2+W)+Math.min(H,0)+re.x,y:-(B/2+W)+Math.min(R,0)+re.y};return K?se:this._transformedRect(se,te)}drawScene(M,I,U){const K=this.getLayer(),te=M||K.getCanvas(),re=te.getContext(),Z=this._getCanvasCache(),B=this.getSceneFunc(),J=this.hasShadow();let z;const q=I===this;if(!this.isVisible()&&!q)return this;if(Z){re.save();const H=this.getAbsoluteTransform(I).getMatrix();return re.transform(H[0],H[1],H[2],H[3],H[4],H[5]),this._drawCachedSceneCanvas(re),re.restore(),this}if(!B)return this;if(re.save(),this._useBufferCanvas()){z=this.getStage();const H=U||z.bufferCanvas,R=H.getContext();R.clear(),R.save(),R._applyLineJoin(this);const L=this.getAbsoluteTransform(I).getMatrix();R.transform(L[0],L[1],L[2],L[3],L[4],L[5]),B.call(this,R,this),R.restore();const G=H.pixelRatio;J&&re._applyShadow(this),re._applyOpacity(this),re._applyGlobalCompositeOperation(this),re.drawImage(H._canvas,H.x||0,H.y||0,H.width/G,H.height/G)}else{if(re._applyLineJoin(this),!q){const H=this.getAbsoluteTransform(I).getMatrix();re.transform(H[0],H[1],H[2],H[3],H[4],H[5]),re._applyOpacity(this),re._applyGlobalCompositeOperation(this)}J&&re._applyShadow(this),B.call(this,re,this)}return re.restore(),this}drawHit(M,I,U=!1){if(!this.shouldDrawHit(I,U))return this;const K=this.getLayer(),te=M||K.hitCanvas,re=te&&te.getContext(),Z=this.hitFunc()||this.sceneFunc(),B=this._getCanvasCache(),J=B&&B.hit;if(this.colorKey||r.Util.warn("Looks like your canvas has a destroyed shape in it. Do not reuse shape after you destroyed it. If you want to reuse shape you should call remove() instead of destroy()"),J){re.save();const q=this.getAbsoluteTransform(I).getMatrix();return re.transform(q[0],q[1],q[2],q[3],q[4],q[5]),this._drawCachedHitCanvas(re),re.restore(),this}if(!Z)return this;if(re.save(),re._applyLineJoin(this),!(this===I)){const q=this.getAbsoluteTransform(I).getMatrix();re.transform(q[0],q[1],q[2],q[3],q[4],q[5])}return Z.call(this,re,this),re.restore(),this}drawHitFromCache(M=0){const I=this._getCanvasCache(),U=this._getCachedSceneCanvas(),K=I.hit,te=K.getContext(),re=K.getWidth(),Z=K.getHeight();te.clear(),te.drawImage(U._canvas,0,0,re,Z);try{const B=te.getImageData(0,0,re,Z),J=B.data,z=J.length,q=r.Util._hexToRgb(this.colorKey);for(let H=0;H<z;H+=4)J[H+3]>M?(J[H]=q.r,J[H+1]=q.g,J[H+2]=q.b,J[H+3]=255):J[H+3]=0;te.putImageData(B,0,0)}catch(B){r.Util.error("Unable to draw hit graph from cached scene canvas. "+B.message)}return this}hasPointerCapture(M){return o.hasPointerCapture(M,this)}setPointerCapture(M){o.setPointerCapture(M,this)}releaseCapture(M){o.releaseCapture(M,this)}}e.Shape=j,j.prototype._fillFunc=x,j.prototype._strokeFunc=v,j.prototype._fillFuncHit=C,j.prototype._strokeFuncHit=b,j.prototype._centroid=!1,j.prototype.nodeType="Shape",(0,i._registerNode)(j),j.prototype.eventListeners={},j.prototype.on.call(j.prototype,"shadowColorChange.konva shadowBlurChange.konva shadowOffsetChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",_),j.prototype.on.call(j.prototype,"shadowColorChange.konva shadowOpacityChange.konva shadowEnabledChange.konva",T),j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillPatternImageChange.konva fillPatternRepeatChange.konva fillPatternScaleXChange.konva fillPatternScaleYChange.konva fillPatternOffsetXChange.konva fillPatternOffsetYChange.konva fillPatternXChange.konva fillPatternYChange.konva fillPatternRotationChange.konva",N),j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillLinearGradientColorStopsChange.konva fillLinearGradientStartPointXChange.konva fillLinearGradientStartPointYChange.konva fillLinearGradientEndPointXChange.konva fillLinearGradientEndPointYChange.konva",E),j.prototype.on.call(j.prototype,"fillPriorityChange.konva fillRadialGradientColorStopsChange.konva fillRadialGradientStartPointXChange.konva fillRadialGradientStartPointYChange.konva fillRadialGradientEndPointXChange.konva fillRadialGradientEndPointYChange.konva fillRadialGradientStartRadiusChange.konva fillRadialGradientEndRadiusChange.konva",F),n.Factory.addGetterSetter(j,"stroke",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(j,"strokeWidth",2,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"fillAfterStrokeEnabled",!1),n.Factory.addGetterSetter(j,"hitStrokeWidth","auto",(0,a.getNumberOrAutoValidator)()),n.Factory.addGetterSetter(j,"strokeHitEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(j,"perfectDrawEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(j,"shadowForStrokeEnabled",!0,(0,a.getBooleanValidator)()),n.Factory.addGetterSetter(j,"lineJoin"),n.Factory.addGetterSetter(j,"lineCap"),n.Factory.addGetterSetter(j,"sceneFunc"),n.Factory.addGetterSetter(j,"hitFunc"),n.Factory.addGetterSetter(j,"dash"),n.Factory.addGetterSetter(j,"dashOffset",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"shadowColor",void 0,(0,a.getStringValidator)()),n.Factory.addGetterSetter(j,"shadowBlur",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"shadowOpacity",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(j,"shadowOffset",["x","y"]),n.Factory.addGetterSetter(j,"shadowOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"shadowOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"fillPatternImage"),n.Factory.addGetterSetter(j,"fill",void 0,(0,a.getStringOrGradientValidator)()),n.Factory.addGetterSetter(j,"fillPatternX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"fillPatternY",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"fillLinearGradientColorStops"),n.Factory.addGetterSetter(j,"strokeLinearGradientColorStops"),n.Factory.addGetterSetter(j,"fillRadialGradientStartRadius",0),n.Factory.addGetterSetter(j,"fillRadialGradientEndRadius",0),n.Factory.addGetterSetter(j,"fillRadialGradientColorStops"),n.Factory.addGetterSetter(j,"fillPatternRepeat","repeat"),n.Factory.addGetterSetter(j,"fillEnabled",!0),n.Factory.addGetterSetter(j,"strokeEnabled",!0),n.Factory.addGetterSetter(j,"shadowEnabled",!0),n.Factory.addGetterSetter(j,"dashEnabled",!0),n.Factory.addGetterSetter(j,"strokeScaleEnabled",!0),n.Factory.addGetterSetter(j,"fillPriority","color"),n.Factory.addComponentsGetterSetter(j,"fillPatternOffset",["x","y"]),n.Factory.addGetterSetter(j,"fillPatternOffsetX",0,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"fillPatternOffsetY",0,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(j,"fillPatternScale",["x","y"]),n.Factory.addGetterSetter(j,"fillPatternScaleX",1,(0,a.getNumberValidator)()),n.Factory.addGetterSetter(j,"fillPatternScaleY",1,(0,a.getNumberValidator)()),n.Factory.addComponentsGetterSetter(j,"fillLinearGradientStartPoint",["x","y"]),n.Factory.addComponentsGetterSetter(j,"strokeLinearGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(j,"fillLinearGradientStartPointX",0),n.Factory.addGetterSetter(j,"strokeLinearGradientStartPointX",0),n.Factory.addGetterSetter(j,"fillLinearGradientStartPointY",0),n.Factory.addGetterSetter(j,"strokeLinearGradientStartPointY",0),n.Factory.addComponentsGetterSetter(j,"fillLinearGradientEndPoint",["x","y"]),n.Factory.addComponentsGetterSetter(j,"strokeLinearGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(j,"fillLinearGradientEndPointX",0),n.Factory.addGetterSetter(j,"strokeLinearGradientEndPointX",0),n.Factory.addGetterSetter(j,"fillLinearGradientEndPointY",0),n.Factory.addGetterSetter(j,"strokeLinearGradientEndPointY",0),n.Factory.addComponentsGetterSetter(j,"fillRadialGradientStartPoint",["x","y"]),n.Factory.addGetterSetter(j,"fillRadialGradientStartPointX",0),n.Factory.addGetterSetter(j,"fillRadialGradientStartPointY",0),n.Factory.addComponentsGetterSetter(j,"fillRadialGradientEndPoint",["x","y"]),n.Factory.addGetterSetter(j,"fillRadialGradientEndPointX",0),n.Factory.addGetterSetter(j,"fillRadialGradientEndPointY",0),n.Factory.addGetterSetter(j,"fillPatternRotation",0),n.Factory.addGetterSetter(j,"fillRule",void 0,(0,a.getStringValidator)()),n.Factory.backCompat(j,{dashArray:"dash",getDashArray:"getDash",setDashArray:"getDash",drawFunc:"sceneFunc",getDrawFunc:"getSceneFunc",setDrawFunc:"setSceneFunc",drawHitFunc:"hitFunc",getDrawHitFunc:"getHitFunc",setDrawHitFunc:"setHitFunc"})})(i6)),i6}var OF;function vH(){if(OF)return ay;OF=1,Object.defineProperty(ay,"__esModule",{value:!0}),ay.Layer=void 0;const e=Ca(),t=MS(),r=$a(),n=Bn(),s=FS(),a=Un(),i=Oi(),o=Rn(),c="#",u="beforeDraw",d="draw",f=[{x:0,y:0},{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],h=f.length;class g extends t.Container{constructor(x){super(x),this.canvas=new s.SceneCanvas,this.hitCanvas=new s.HitCanvas({pixelRatio:1}),this._waitingForDraw=!1,this.on("visibleChange.konva",this._checkVisibility),this._checkVisibility(),this.on("imageSmoothingEnabledChange.konva",this._setSmoothEnabled),this._setSmoothEnabled()}createPNGStream(){return this.canvas._canvas.createPNGStream()}getCanvas(){return this.canvas}getNativeCanvasElement(){return this.canvas._canvas}getHitCanvas(){return this.hitCanvas}getContext(){return this.getCanvas().getContext()}clear(x){return this.getContext().clear(x),this.getHitCanvas().getContext().clear(x),this}setZIndex(x){super.setZIndex(x);const v=this.getStage();return v&&v.content&&(v.content.removeChild(this.getNativeCanvasElement()),x<v.children.length-1?v.content.insertBefore(this.getNativeCanvasElement(),v.children[x+1].getCanvas()._canvas):v.content.appendChild(this.getNativeCanvasElement())),this}moveToTop(){r.Node.prototype.moveToTop.call(this);const x=this.getStage();return x&&x.content&&(x.content.removeChild(this.getNativeCanvasElement()),x.content.appendChild(this.getNativeCanvasElement())),!0}moveUp(){if(!r.Node.prototype.moveUp.call(this))return!1;const v=this.getStage();return!v||!v.content?!1:(v.content.removeChild(this.getNativeCanvasElement()),this.index<v.children.length-1?v.content.insertBefore(this.getNativeCanvasElement(),v.children[this.index+1].getCanvas()._canvas):v.content.appendChild(this.getNativeCanvasElement()),!0)}moveDown(){if(r.Node.prototype.moveDown.call(this)){const x=this.getStage();if(x){const v=x.children;x.content&&(x.content.removeChild(this.getNativeCanvasElement()),x.content.insertBefore(this.getNativeCanvasElement(),v[this.index+1].getCanvas()._canvas))}return!0}return!1}moveToBottom(){if(r.Node.prototype.moveToBottom.call(this)){const x=this.getStage();if(x){const v=x.children;x.content&&(x.content.removeChild(this.getNativeCanvasElement()),x.content.insertBefore(this.getNativeCanvasElement(),v[1].getCanvas()._canvas))}return!0}return!1}getLayer(){return this}remove(){const x=this.getNativeCanvasElement();return r.Node.prototype.remove.call(this),x&&x.parentNode&&e.Util._isInDocument(x)&&x.parentNode.removeChild(x),this}getStage(){return this.parent}setSize({width:x,height:v}){return this.canvas.setSize(x,v),this.hitCanvas.setSize(x,v),this._setSmoothEnabled(),this}_validateAdd(x){const v=x.getType();v!=="Group"&&v!=="Shape"&&e.Util.throw("You may only add groups and shapes to a layer.")}_toKonvaCanvas(x){return x=x||{},x.width=x.width||this.getWidth(),x.height=x.height||this.getHeight(),x.x=x.x!==void 0?x.x:this.x(),x.y=x.y!==void 0?x.y:this.y(),r.Node.prototype._toKonvaCanvas.call(this,x)}_checkVisibility(){this.visible()?this.canvas._canvas.style.display="block":this.canvas._canvas.style.display="none"}_setSmoothEnabled(){this.getContext()._context.imageSmoothingEnabled=this.imageSmoothingEnabled()}getWidth(){if(this.parent)return this.parent.width()}setWidth(){e.Util.warn('Can not change width of layer. Use "stage.width(value)" function instead.')}getHeight(){if(this.parent)return this.parent.height()}setHeight(){e.Util.warn('Can not change height of layer. Use "stage.height(value)" function instead.')}batchDraw(){return this._waitingForDraw||(this._waitingForDraw=!0,e.Util.requestAnimFrame(()=>{this.draw(),this._waitingForDraw=!1})),this}getIntersection(x){if(!this.isListening()||!this.isVisible())return null;let v=1,C=!1;for(;;){for(let b=0;b<h;b++){const _=f[b],T=this._getIntersection({x:x.x+_.x*v,y:x.y+_.y*v}),N=T.shape;if(N)return N;if(C=!!T.antialiased,!T.antialiased)break}if(C)v+=1;else return null}}_getIntersection(x){const v=this.hitCanvas.pixelRatio,C=this.hitCanvas.context.getImageData(Math.round(x.x*v),Math.round(x.y*v),1,1).data,b=C[3];if(b===255){const _=e.Util._rgbToHex(C[0],C[1],C[2]),T=i.shapes[c+_];return T?{shape:T}:{antialiased:!0}}else if(b>0)return{antialiased:!0};return{}}drawScene(x,v,C){const b=this.getLayer(),_=x||b&&b.getCanvas();return this._fire(u,{node:this}),this.clearBeforeDraw()&&_.getContext().clear(),t.Container.prototype.drawScene.call(this,_,v,C),this._fire(d,{node:this}),this}drawHit(x,v){const C=this.getLayer(),b=x||C&&C.hitCanvas;return C&&C.clearBeforeDraw()&&C.getHitCanvas().getContext().clear(),t.Container.prototype.drawHit.call(this,b,v),this}enableHitGraph(){return this.hitGraphEnabled(!0),this}disableHitGraph(){return this.hitGraphEnabled(!1),this}setHitGraphEnabled(x){e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening(x)}getHitGraphEnabled(x){return e.Util.warn("hitGraphEnabled method is deprecated. Please use layer.listening() instead."),this.listening()}toggleHitCanvas(){if(!this.parent||!this.parent.content)return;const x=this.parent;!!this.hitCanvas._canvas.parentNode?x.content.removeChild(this.hitCanvas._canvas):x.content.appendChild(this.hitCanvas._canvas)}destroy(){return e.Util.releaseCanvas(this.getNativeCanvasElement(),this.getHitCanvas()._canvas),super.destroy()}}return ay.Layer=g,g.prototype.nodeType="Layer",(0,o._registerNode)(g),n.Factory.addGetterSetter(g,"imageSmoothingEnabled",!0),n.Factory.addGetterSetter(g,"clearBeforeDraw",!0),n.Factory.addGetterSetter(g,"hitGraphEnabled",!0,(0,a.getBooleanValidator)()),ay}var iy={},DF;function Ele(){if(DF)return iy;DF=1,Object.defineProperty(iy,"__esModule",{value:!0}),iy.FastLayer=void 0;const e=Ca(),t=vH(),r=Rn();class n extends t.Layer{constructor(a){super(a),this.listening(!1),e.Util.warn('Konva.Fast layer is deprecated. Please use "new Konva.Layer({ listening: false })" instead.')}}return iy.FastLayer=n,n.prototype.nodeType="FastLayer",(0,r._registerNode)(n),iy}var oy={},IF;function kN(){if(IF)return oy;IF=1,Object.defineProperty(oy,"__esModule",{value:!0}),oy.Group=void 0;const e=Ca(),t=MS(),r=Rn();class n extends t.Container{_validateAdd(a){const i=a.getType();i!=="Group"&&i!=="Shape"&&e.Util.throw("You may only add groups and shapes to groups.")}}return oy.Group=n,n.prototype.nodeType="Group",(0,r._registerNode)(n),oy}var ly={},LF;function CN(){if(LF)return ly;LF=1,Object.defineProperty(ly,"__esModule",{value:!0}),ly.Animation=void 0;const e=Rn(),t=Ca(),r=(function(){return e.glob.performance&&e.glob.performance.now?function(){return e.glob.performance.now()}:function(){return new Date().getTime()}})();let n=class Ap{constructor(a,i){this.id=Ap.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:r(),frameRate:0},this.func=a,this.setLayers(i)}setLayers(a){let i=[];return a&&(i=Array.isArray(a)?a:[a]),this.layers=i,this}getLayers(){return this.layers}addLayer(a){const i=this.layers,o=i.length;for(let c=0;c<o;c++)if(i[c]._id===a._id)return!1;return this.layers.push(a),!0}isRunning(){const i=Ap.animations,o=i.length;for(let c=0;c<o;c++)if(i[c].id===this.id)return!0;return!1}start(){return this.stop(),this.frame.timeDiff=0,this.frame.lastTime=r(),Ap._addAnimation(this),this}stop(){return Ap._removeAnimation(this),this}_updateFrameObject(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}static _addAnimation(a){this.animations.push(a),this._handleAnimation()}static _removeAnimation(a){const i=a.id,o=this.animations,c=o.length;for(let u=0;u<c;u++)if(o[u].id===i){this.animations.splice(u,1);break}}static _runFrames(){const a={},i=this.animations;for(let o=0;o<i.length;o++){const c=i[o],u=c.layers,d=c.func;c._updateFrameObject(r());const f=u.length;let h;if(d?h=d.call(c,c.frame)!==!1:h=!0,!!h)for(let g=0;g<f;g++){const p=u[g];p._id!==void 0&&(a[p._id]=p)}}for(const o in a)a.hasOwnProperty(o)&&a[o].batchDraw()}static _animationLoop(){const a=Ap;a.animations.length?(a._runFrames(),t.Util.requestAnimFrame(a._animationLoop)):a.animRunning=!1}static _handleAnimation(){this.animRunning||(this.animRunning=!0,t.Util.requestAnimFrame(this._animationLoop))}};return ly.Animation=n,n.animations=[],n.animIdCounter=0,n.animRunning=!1,ly}var o6={},BF;function Ale(){return BF||(BF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Easings=e.Tween=void 0;const t=Ca(),r=CN(),n=$a(),s=Rn(),a={node:1,duration:1,easing:1,onFinish:1,yoyo:1},i=1,o=2,c=3,u=["fill","stroke","shadowColor"];let d=0;class f{constructor(p,x,v,C,b,_,T){this.prop=p,this.propFunc=x,this.begin=C,this._pos=C,this.duration=_,this._change=0,this.prevPos=0,this.yoyo=T,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.func=v,this._change=b-this.begin,this.pause()}fire(p){const x=this[p];x&&x()}setTime(p){p>this.duration?this.yoyo?(this._time=this.duration,this.reverse()):this.finish():p<0?this.yoyo?(this._time=0,this.play()):this.reset():(this._time=p,this.update())}getTime(){return this._time}setPosition(p){this.prevPos=this._pos,this.propFunc(p),this._pos=p}getPosition(p){return p===void 0&&(p=this._time),this.func(p,this.begin,this._change,this.duration)}play(){this.state=o,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onPlay")}reverse(){this.state=c,this._time=this.duration-this._time,this._startTime=this.getTimer()-this._time,this.onEnterFrame(),this.fire("onReverse")}seek(p){this.pause(),this._time=p,this.update(),this.fire("onSeek")}reset(){this.pause(),this._time=0,this.update(),this.fire("onReset")}finish(){this.pause(),this._time=this.duration,this.update(),this.fire("onFinish")}update(){this.setPosition(this.getPosition(this._time)),this.fire("onUpdate")}onEnterFrame(){const p=this.getTimer()-this._startTime;this.state===o?this.setTime(p):this.state===c&&this.setTime(this.duration-p)}pause(){this.state=i,this.fire("onPause")}getTimer(){return new Date().getTime()}}class h{constructor(p){const x=this,v=p.node,C=v._id,b=p.easing||e.Easings.Linear,_=!!p.yoyo;let T,N;typeof p.duration>"u"?T=.3:p.duration===0?T=.001:T=p.duration,this.node=v,this._id=d++;const E=v.getLayer()||(v instanceof s.Konva.Stage?v.getLayers():null);E||t.Util.error("Tween constructor have `node` that is not in a layer. Please add node into layer first."),this.anim=new r.Animation(function(){x.tween.onEnterFrame()},E),this.tween=new f(N,function(F){x._tweenFunc(F)},b,0,1,T*1e3,_),this._addListeners(),h.attrs[C]||(h.attrs[C]={}),h.attrs[C][this._id]||(h.attrs[C][this._id]={}),h.tweens[C]||(h.tweens[C]={});for(N in p)a[N]===void 0&&this._addAttr(N,p[N]);this.reset(),this.onFinish=p.onFinish,this.onReset=p.onReset,this.onUpdate=p.onUpdate}_addAttr(p,x){const v=this.node,C=v._id;let b,_,T,N,E;const F=h.tweens[C][p];F&&delete h.attrs[C][F][p];let j=v.getAttr(p);if(t.Util._isArray(x))if(b=[],_=Math.max(x.length,j.length),p==="points"&&x.length!==j.length&&(x.length>j.length?(N=j,j=t.Util._prepareArrayForTween(j,x,v.closed())):(T=x,x=t.Util._prepareArrayForTween(x,j,v.closed()))),p.indexOf("fill")===0)for(let P=0;P<_;P++)if(P%2===0)b.push(x[P]-j[P]);else{const M=t.Util.colorToRGBA(j[P]);E=t.Util.colorToRGBA(x[P]),j[P]=M,b.push({r:E.r-M.r,g:E.g-M.g,b:E.b-M.b,a:E.a-M.a})}else for(let P=0;P<_;P++)b.push(x[P]-j[P]);else u.indexOf(p)!==-1?(j=t.Util.colorToRGBA(j),E=t.Util.colorToRGBA(x),b={r:E.r-j.r,g:E.g-j.g,b:E.b-j.b,a:E.a-j.a}):b=x-j;h.attrs[C][this._id][p]={start:j,diff:b,end:x,trueEnd:T,trueStart:N},h.tweens[C][p]=this._id}_tweenFunc(p){const x=this.node,v=h.attrs[x._id][this._id];let C,b,_,T,N,E,F,j;for(C in v){if(b=v[C],_=b.start,T=b.diff,j=b.end,t.Util._isArray(_))if(N=[],F=Math.max(_.length,j.length),C.indexOf("fill")===0)for(E=0;E<F;E++)E%2===0?N.push((_[E]||0)+T[E]*p):N.push("rgba("+Math.round(_[E].r+T[E].r*p)+","+Math.round(_[E].g+T[E].g*p)+","+Math.round(_[E].b+T[E].b*p)+","+(_[E].a+T[E].a*p)+")");else for(E=0;E<F;E++)N.push((_[E]||0)+T[E]*p);else u.indexOf(C)!==-1?N="rgba("+Math.round(_.r+T.r*p)+","+Math.round(_.g+T.g*p)+","+Math.round(_.b+T.b*p)+","+(_.a+T.a*p)+")":N=_+T*p;x.setAttr(C,N)}}_addListeners(){this.tween.onPlay=()=>{this.anim.start()},this.tween.onReverse=()=>{this.anim.start()},this.tween.onPause=()=>{this.anim.stop()},this.tween.onFinish=()=>{const p=this.node,x=h.attrs[p._id][this._id];x.points&&x.points.trueEnd&&p.setAttr("points",x.points.trueEnd),this.onFinish&&this.onFinish.call(this)},this.tween.onReset=()=>{const p=this.node,x=h.attrs[p._id][this._id];x.points&&x.points.trueStart&&p.points(x.points.trueStart),this.onReset&&this.onReset()},this.tween.onUpdate=()=>{this.onUpdate&&this.onUpdate.call(this)}}play(){return this.tween.play(),this}reverse(){return this.tween.reverse(),this}reset(){return this.tween.reset(),this}seek(p){return this.tween.seek(p*1e3),this}pause(){return this.tween.pause(),this}finish(){return this.tween.finish(),this}destroy(){const p=this.node._id,x=this._id,v=h.tweens[p];this.pause(),this.anim&&this.anim.stop();for(const C in v)delete h.tweens[p][C];delete h.attrs[p][x],h.tweens[p]&&(Object.keys(h.tweens[p]).length===0&&delete h.tweens[p],Object.keys(h.attrs[p]).length===0&&delete h.attrs[p])}}e.Tween=h,h.attrs={},h.tweens={},n.Node.prototype.to=function(g){const p=g.onFinish;g.node=this,g.onFinish=function(){this.destroy(),p&&p()},new h(g).play()},e.Easings={BackEaseIn(g,p,x,v){return x*(g/=v)*g*((1.70158+1)*g-1.70158)+p},BackEaseOut(g,p,x,v){return x*((g=g/v-1)*g*((1.70158+1)*g+1.70158)+1)+p},BackEaseInOut(g,p,x,v){let C=1.70158;return(g/=v/2)<1?x/2*(g*g*(((C*=1.525)+1)*g-C))+p:x/2*((g-=2)*g*(((C*=1.525)+1)*g+C)+2)+p},ElasticEaseIn(g,p,x,v,C,b){let _=0;return g===0?p:(g/=v)===1?p+x:(b||(b=v*.3),!C||C<Math.abs(x)?(C=x,_=b/4):_=b/(2*Math.PI)*Math.asin(x/C),-(C*Math.pow(2,10*(g-=1))*Math.sin((g*v-_)*(2*Math.PI)/b))+p)},ElasticEaseOut(g,p,x,v,C,b){let _=0;return g===0?p:(g/=v)===1?p+x:(b||(b=v*.3),!C||C<Math.abs(x)?(C=x,_=b/4):_=b/(2*Math.PI)*Math.asin(x/C),C*Math.pow(2,-10*g)*Math.sin((g*v-_)*(2*Math.PI)/b)+x+p)},ElasticEaseInOut(g,p,x,v,C,b){let _=0;return g===0?p:(g/=v/2)===2?p+x:(b||(b=v*(.3*1.5)),!C||C<Math.abs(x)?(C=x,_=b/4):_=b/(2*Math.PI)*Math.asin(x/C),g<1?-.5*(C*Math.pow(2,10*(g-=1))*Math.sin((g*v-_)*(2*Math.PI)/b))+p:C*Math.pow(2,-10*(g-=1))*Math.sin((g*v-_)*(2*Math.PI)/b)*.5+x+p)},BounceEaseOut(g,p,x,v){return(g/=v)<1/2.75?x*(7.5625*g*g)+p:g<2/2.75?x*(7.5625*(g-=1.5/2.75)*g+.75)+p:g<2.5/2.75?x*(7.5625*(g-=2.25/2.75)*g+.9375)+p:x*(7.5625*(g-=2.625/2.75)*g+.984375)+p},BounceEaseIn(g,p,x,v){return x-e.Easings.BounceEaseOut(v-g,0,x,v)+p},BounceEaseInOut(g,p,x,v){return g<v/2?e.Easings.BounceEaseIn(g*2,0,x,v)*.5+p:e.Easings.BounceEaseOut(g*2-v,0,x,v)*.5+x*.5+p},EaseIn(g,p,x,v){return x*(g/=v)*g+p},EaseOut(g,p,x,v){return-x*(g/=v)*(g-2)+p},EaseInOut(g,p,x,v){return(g/=v/2)<1?x/2*g*g+p:-x/2*(--g*(g-2)-1)+p},StrongEaseIn(g,p,x,v){return x*(g/=v)*g*g*g*g+p},StrongEaseOut(g,p,x,v){return x*((g=g/v-1)*g*g*g*g+1)+p},StrongEaseInOut(g,p,x,v){return(g/=v/2)<1?x/2*g*g*g*g*g+p:x/2*((g-=2)*g*g*g*g+2)+p},Linear(g,p,x,v){return x*g/v+p}}})(o6)),o6}var $F;function AT(){return $F||($F=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Konva=void 0;const t=Rn(),r=Ca(),n=$a(),s=MS(),a=Nle(),i=vH(),o=Ele(),c=kN(),u=SN(),d=Oi(),f=CN(),h=Ale(),g=xH(),p=FS();e.Konva=r.Util._assign(t.Konva,{Util:r.Util,Transform:r.Transform,Node:n.Node,Container:s.Container,Stage:a.Stage,stages:a.stages,Layer:i.Layer,FastLayer:o.FastLayer,Group:c.Group,DD:u.DD,Shape:d.Shape,shapes:d.shapes,Animation:f.Animation,Tween:h.Tween,Easings:h.Easings,Context:g.Context,Canvas:p.Canvas}),e.default=e.Konva})(e6)),e6}var cy={},UF;function jle(){if(UF)return cy;UF=1,Object.defineProperty(cy,"__esModule",{value:!0}),cy.Arc=void 0;const e=Bn(),t=Oi(),r=Rn(),n=Un(),s=Rn();class a extends t.Shape{_sceneFunc(o){const c=r.Konva.getAngle(this.angle()),u=this.clockwise();o.beginPath(),o.arc(0,0,this.outerRadius(),0,c,u),o.arc(0,0,this.innerRadius(),c,0,!u),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}getSelfRect(){const o=this.innerRadius(),c=this.outerRadius(),u=this.clockwise(),d=r.Konva.getAngle(u?360-this.angle():this.angle()),f=Math.cos(Math.min(d,Math.PI)),h=1,g=Math.sin(Math.min(Math.max(Math.PI,d),3*Math.PI/2)),p=Math.sin(Math.min(d,Math.PI/2)),x=f*(f>0?o:c),v=h*c,C=g*(g>0?o:c),b=p*(p>0?c:o);return{x,y:u?-1*b:C,width:v-x,height:b-C}}}return cy.Arc=a,a.prototype._centroid=!0,a.prototype.className="Arc",a.prototype._attrsAffectingSize=["innerRadius","outerRadius","angle","clockwise"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1,(0,n.getBooleanValidator)()),cy}var uy={},dy={},zF;function bH(){if(zF)return dy;zF=1,Object.defineProperty(dy,"__esModule",{value:!0}),dy.Line=void 0;const e=Bn(),t=Rn(),r=Oi(),n=Un();function s(o,c,u,d,f,h,g){const p=Math.sqrt(Math.pow(u-o,2)+Math.pow(d-c,2)),x=Math.sqrt(Math.pow(f-u,2)+Math.pow(h-d,2)),v=g*p/(p+x),C=g*x/(p+x),b=u-v*(f-o),_=d-v*(h-c),T=u+C*(f-o),N=d+C*(h-c);return[b,_,T,N]}function a(o,c){const u=o.length,d=[];for(let f=2;f<u-2;f+=2){const h=s(o[f-2],o[f-1],o[f],o[f+1],o[f+2],o[f+3],c);isNaN(h[0])||(d.push(h[0]),d.push(h[1]),d.push(o[f]),d.push(o[f+1]),d.push(h[2]),d.push(h[3]))}return d}class i extends r.Shape{constructor(c){super(c),this.on("pointsChange.konva tensionChange.konva closedChange.konva bezierChange.konva",function(){this._clearCache("tensionPoints")})}_sceneFunc(c){const u=this.points(),d=u.length,f=this.tension(),h=this.closed(),g=this.bezier();if(!d)return;let p=0;if(c.beginPath(),c.moveTo(u[0],u[1]),f!==0&&d>4){const x=this.getTensionPoints(),v=x.length;for(p=h?0:4,h||c.quadraticCurveTo(x[0],x[1],x[2],x[3]);p<v-2;)c.bezierCurveTo(x[p++],x[p++],x[p++],x[p++],x[p++],x[p++]);h||c.quadraticCurveTo(x[v-2],x[v-1],u[d-2],u[d-1])}else if(g)for(p=2;p<d;)c.bezierCurveTo(u[p++],u[p++],u[p++],u[p++],u[p++],u[p++]);else for(p=2;p<d;p+=2)c.lineTo(u[p],u[p+1]);h?(c.closePath(),c.fillStrokeShape(this)):c.strokeShape(this)}getTensionPoints(){return this._getCache("tensionPoints",this._getTensionPoints)}_getTensionPoints(){return this.closed()?this._getTensionPointsClosed():a(this.points(),this.tension())}_getTensionPointsClosed(){const c=this.points(),u=c.length,d=this.tension(),f=s(c[u-2],c[u-1],c[0],c[1],c[2],c[3],d),h=s(c[u-4],c[u-3],c[u-2],c[u-1],c[0],c[1],d),g=a(c,d);return[f[2],f[3]].concat(g).concat([h[0],h[1],c[u-2],c[u-1],h[2],h[3],f[0],f[1],c[0],c[1]])}getWidth(){return this.getSelfRect().width}getHeight(){return this.getSelfRect().height}getSelfRect(){let c=this.points();if(c.length<4)return{x:c[0]||0,y:c[1]||0,width:0,height:0};this.tension()!==0?c=[c[0],c[1],...this._getTensionPoints(),c[c.length-2],c[c.length-1]]:c=this.points();let u=c[0],d=c[0],f=c[1],h=c[1],g,p;for(let x=0;x<c.length/2;x++)g=c[x*2],p=c[x*2+1],u=Math.min(u,g),d=Math.max(d,g),f=Math.min(f,p),h=Math.max(h,p);return{x:u,y:f,width:d-u,height:h-f}}}return dy.Line=i,i.prototype.className="Line",i.prototype._attrsAffectingSize=["points","bezier","tension"],(0,t._registerNode)(i),e.Factory.addGetterSetter(i,"closed",!1),e.Factory.addGetterSetter(i,"bezier",!1),e.Factory.addGetterSetter(i,"tension",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(i,"points",[],(0,n.getNumberArrayValidator)()),dy}var fy={},l6={},WF;function Ple(){return WF||(WF=1,(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.t2length=e.getQuadraticArcLength=e.getCubicArcLength=e.binomialCoefficients=e.cValues=e.tValues=void 0,e.tValues=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],e.cValues=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],e.binomialCoefficients=[[1],[1,1],[1,2,1],[1,3,3,1]];const t=(i,o,c)=>{let u,d;const h=c/2;u=0;for(let g=0;g<20;g++)d=h*e.tValues[20][g]+h,u+=e.cValues[20][g]*n(i,o,d);return h*u};e.getCubicArcLength=t;const r=(i,o,c)=>{c===void 0&&(c=1);const u=i[0]-2*i[1]+i[2],d=o[0]-2*o[1]+o[2],f=2*i[1]-2*i[0],h=2*o[1]-2*o[0],g=4*(u*u+d*d),p=4*(u*f+d*h),x=f*f+h*h;if(g===0)return c*Math.sqrt(Math.pow(i[2]-i[0],2)+Math.pow(o[2]-o[0],2));const v=p/(2*g),C=x/g,b=c+v,_=C-v*v,T=b*b+_>0?Math.sqrt(b*b+_):0,N=v*v+_>0?Math.sqrt(v*v+_):0,E=v+Math.sqrt(v*v+_)!==0?_*Math.log(Math.abs((b+T)/(v+N))):0;return Math.sqrt(g)/2*(b*T-v*N+E)};e.getQuadraticArcLength=r;function n(i,o,c){const u=s(1,c,i),d=s(1,c,o),f=u*u+d*d;return Math.sqrt(f)}const s=(i,o,c)=>{const u=c.length-1;let d,f;if(u===0)return 0;if(i===0){f=0;for(let h=0;h<=u;h++)f+=e.binomialCoefficients[u][h]*Math.pow(1-o,u-h)*Math.pow(o,h)*c[h];return f}else{d=new Array(u);for(let h=0;h<u;h++)d[h]=u*(c[h+1]-c[h]);return s(i-1,o,d)}},a=(i,o,c)=>{let u=1,d=i/o,f=(i-c(d))/o,h=0;for(;u>.001;){const g=c(d+f),p=Math.abs(i-g)/o;if(p<u)u=p,d+=f;else{const x=c(d-f),v=Math.abs(i-x)/o;v<u?(u=v,d-=f):f/=2}if(h++,h>500)break}return d};e.t2length=a})(l6)),l6}var HF;function TN(){if(HF)return fy;HF=1,Object.defineProperty(fy,"__esModule",{value:!0}),fy.Path=void 0;const e=Bn(),t=Rn(),r=Oi(),n=Ple();class s extends r.Shape{constructor(i){super(i),this.dataArray=[],this.pathLength=0,this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute()})}_readDataAttribute(){this.dataArray=s.parsePathData(this.data()),this.pathLength=s.getPathLength(this.dataArray)}_sceneFunc(i){const o=this.dataArray;i.beginPath();let c=!1;for(let u=0;u<o.length;u++){const d=o[u].command,f=o[u].points;switch(d){case"L":i.lineTo(f[0],f[1]);break;case"M":i.moveTo(f[0],f[1]);break;case"C":i.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":i.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":const h=f[0],g=f[1],p=f[2],x=f[3],v=f[4],C=f[5],b=f[6],_=f[7],T=p>x?p:x,N=p>x?1:p/x,E=p>x?x/p:1;i.translate(h,g),i.rotate(b),i.scale(N,E),i.arc(0,0,T,v,v+C,1-_),i.scale(1/N,1/E),i.rotate(-b),i.translate(-h,-g);break;case"z":c=!0,i.closePath();break}}!c&&!this.hasFill()?i.strokeShape(this):i.fillStrokeShape(this)}getSelfRect(){let i=[];this.dataArray.forEach(function(g){if(g.command==="A"){const p=g.points[4],x=g.points[5],v=g.points[4]+x;let C=Math.PI/180;if(Math.abs(p-v)<C&&(C=Math.abs(p-v)),x<0)for(let b=p-C;b>v;b-=C){const _=s.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],b,0);i.push(_.x,_.y)}else for(let b=p+C;b<v;b+=C){const _=s.getPointOnEllipticalArc(g.points[0],g.points[1],g.points[2],g.points[3],b,0);i.push(_.x,_.y)}}else if(g.command==="C")for(let p=0;p<=1;p+=.01){const x=s.getPointOnCubicBezier(p,g.start.x,g.start.y,g.points[0],g.points[1],g.points[2],g.points[3],g.points[4],g.points[5]);i.push(x.x,x.y)}else i=i.concat(g.points)});let o=i[0],c=i[0],u=i[1],d=i[1],f,h;for(let g=0;g<i.length/2;g++)f=i[g*2],h=i[g*2+1],isNaN(f)||(o=Math.min(o,f),c=Math.max(c,f)),isNaN(h)||(u=Math.min(u,h),d=Math.max(d,h));return{x:o,y:u,width:c-o,height:d-u}}getLength(){return this.pathLength}getPointAtLength(i){return s.getPointAtLengthOfDataArray(i,this.dataArray)}static getLineLength(i,o,c,u){return Math.sqrt((c-i)*(c-i)+(u-o)*(u-o))}static getPathLength(i){let o=0;for(let c=0;c<i.length;++c)o+=i[c].pathLength;return o}static getPointAtLengthOfDataArray(i,o){let c,u=0,d=o.length;if(!d)return null;for(;u<d&&i>o[u].pathLength;)i-=o[u].pathLength,++u;if(u===d)return c=o[u-1].points.slice(-2),{x:c[0],y:c[1]};if(i<.01)return o[u].command==="M"?(c=o[u].points.slice(0,2),{x:c[0],y:c[1]}):{x:o[u].start.x,y:o[u].start.y};const f=o[u],h=f.points;switch(f.command){case"L":return s.getPointOnLine(i,f.start.x,f.start.y,h[0],h[1]);case"C":return s.getPointOnCubicBezier((0,n.t2length)(i,s.getPathLength(o),T=>(0,n.getCubicArcLength)([f.start.x,h[0],h[2],h[4]],[f.start.y,h[1],h[3],h[5]],T)),f.start.x,f.start.y,h[0],h[1],h[2],h[3],h[4],h[5]);case"Q":return s.getPointOnQuadraticBezier((0,n.t2length)(i,s.getPathLength(o),T=>(0,n.getQuadraticArcLength)([f.start.x,h[0],h[2]],[f.start.y,h[1],h[3]],T)),f.start.x,f.start.y,h[0],h[1],h[2],h[3]);case"A":const g=h[0],p=h[1],x=h[2],v=h[3],C=h[5],b=h[6];let _=h[4];return _+=C*i/f.pathLength,s.getPointOnEllipticalArc(g,p,x,v,_,b)}return null}static getPointOnLine(i,o,c,u,d,f,h){f=f??o,h=h??c;const g=this.getLineLength(o,c,u,d);if(g<1e-10)return{x:o,y:c};if(u===o)return{x:f,y:h+(d>c?i:-i)};const p=(d-c)/(u-o),x=Math.sqrt(i*i/(1+p*p))*(u<o?-1:1),v=p*x;if(Math.abs(h-c-p*(f-o))<1e-10)return{x:f+x,y:h+v};const C=((f-o)*(u-o)+(h-c)*(d-c))/(g*g),b=o+C*(u-o),_=c+C*(d-c),T=this.getLineLength(f,h,b,_),N=Math.sqrt(i*i-T*T),E=Math.sqrt(N*N/(1+p*p))*(u<o?-1:1),F=p*E;return{x:b+E,y:_+F}}static getPointOnCubicBezier(i,o,c,u,d,f,h,g,p){function x(N){return N*N*N}function v(N){return 3*N*N*(1-N)}function C(N){return 3*N*(1-N)*(1-N)}function b(N){return(1-N)*(1-N)*(1-N)}const _=g*x(i)+f*v(i)+u*C(i)+o*b(i),T=p*x(i)+h*v(i)+d*C(i)+c*b(i);return{x:_,y:T}}static getPointOnQuadraticBezier(i,o,c,u,d,f,h){function g(b){return b*b}function p(b){return 2*b*(1-b)}function x(b){return(1-b)*(1-b)}const v=f*g(i)+u*p(i)+o*x(i),C=h*g(i)+d*p(i)+c*x(i);return{x:v,y:C}}static getPointOnEllipticalArc(i,o,c,u,d,f){const h=Math.cos(f),g=Math.sin(f),p={x:c*Math.cos(d),y:u*Math.sin(d)};return{x:i+(p.x*h-p.y*g),y:o+(p.x*g+p.y*h)}}static parsePathData(i){if(!i)return[];let o=i;const c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];o=o.replace(new RegExp(" ","g"),",");for(let v=0;v<c.length;v++)o=o.replace(new RegExp(c[v],"g"),"|"+c[v]);const u=o.split("|"),d=[],f=[];let h=0,g=0;const p=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;let x;for(let v=1;v<u.length;v++){let C=u[v],b=C.charAt(0);for(C=C.slice(1),f.length=0;x=p.exec(C);)f.push(x[0]);const _=[];for(let T=0,N=f.length;T<N;T++){if(f[T]==="00"){_.push(0,0);continue}const E=parseFloat(f[T]);isNaN(E)?_.push(0):_.push(E)}for(;_.length>0&&!isNaN(_[0]);){let T="",N=[];const E=h,F=g;let j,P,M,I,U,K,te,re,Z,B;switch(b){case"l":h+=_.shift(),g+=_.shift(),T="L",N.push(h,g);break;case"L":h=_.shift(),g=_.shift(),N.push(h,g);break;case"m":const J=_.shift(),z=_.shift();if(h+=J,g+=z,T="M",d.length>2&&d[d.length-1].command==="z"){for(let q=d.length-2;q>=0;q--)if(d[q].command==="M"){h=d[q].points[0]+J,g=d[q].points[1]+z;break}}N.push(h,g),b="l";break;case"M":h=_.shift(),g=_.shift(),T="M",N.push(h,g),b="L";break;case"h":h+=_.shift(),T="L",N.push(h,g);break;case"H":h=_.shift(),T="L",N.push(h,g);break;case"v":g+=_.shift(),T="L",N.push(h,g);break;case"V":g=_.shift(),T="L",N.push(h,g);break;case"C":N.push(_.shift(),_.shift(),_.shift(),_.shift()),h=_.shift(),g=_.shift(),N.push(h,g);break;case"c":N.push(h+_.shift(),g+_.shift(),h+_.shift(),g+_.shift()),h+=_.shift(),g+=_.shift(),T="C",N.push(h,g);break;case"S":P=h,M=g,j=d[d.length-1],j.command==="C"&&(P=h+(h-j.points[2]),M=g+(g-j.points[3])),N.push(P,M,_.shift(),_.shift()),h=_.shift(),g=_.shift(),T="C",N.push(h,g);break;case"s":P=h,M=g,j=d[d.length-1],j.command==="C"&&(P=h+(h-j.points[2]),M=g+(g-j.points[3])),N.push(P,M,h+_.shift(),g+_.shift()),h+=_.shift(),g+=_.shift(),T="C",N.push(h,g);break;case"Q":N.push(_.shift(),_.shift()),h=_.shift(),g=_.shift(),N.push(h,g);break;case"q":N.push(h+_.shift(),g+_.shift()),h+=_.shift(),g+=_.shift(),T="Q",N.push(h,g);break;case"T":P=h,M=g,j=d[d.length-1],j.command==="Q"&&(P=h+(h-j.points[0]),M=g+(g-j.points[1])),h=_.shift(),g=_.shift(),T="Q",N.push(P,M,h,g);break;case"t":P=h,M=g,j=d[d.length-1],j.command==="Q"&&(P=h+(h-j.points[0]),M=g+(g-j.points[1])),h+=_.shift(),g+=_.shift(),T="Q",N.push(P,M,h,g);break;case"A":I=_.shift(),U=_.shift(),K=_.shift(),te=_.shift(),re=_.shift(),Z=h,B=g,h=_.shift(),g=_.shift(),T="A",N=this.convertEndpointToCenterParameterization(Z,B,h,g,te,re,I,U,K);break;case"a":I=_.shift(),U=_.shift(),K=_.shift(),te=_.shift(),re=_.shift(),Z=h,B=g,h+=_.shift(),g+=_.shift(),T="A",N=this.convertEndpointToCenterParameterization(Z,B,h,g,te,re,I,U,K);break}d.push({command:T||b,points:N,start:{x:E,y:F},pathLength:this.calcLength(E,F,T||b,N)})}(b==="z"||b==="Z")&&d.push({command:"z",points:[],start:void 0,pathLength:0})}return d}static calcLength(i,o,c,u){let d,f,h,g;const p=s;switch(c){case"L":return p.getLineLength(i,o,u[0],u[1]);case"C":return(0,n.getCubicArcLength)([i,u[0],u[2],u[4]],[o,u[1],u[3],u[5]],1);case"Q":return(0,n.getQuadraticArcLength)([i,u[0],u[2]],[o,u[1],u[3]],1);case"A":d=0;const x=u[4],v=u[5],C=u[4]+v;let b=Math.PI/180;if(Math.abs(x-C)<b&&(b=Math.abs(x-C)),f=p.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],x,0),v<0)for(g=x-b;g>C;g-=b)h=p.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],g,0),d+=p.getLineLength(f.x,f.y,h.x,h.y),f=h;else for(g=x+b;g<C;g+=b)h=p.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],g,0),d+=p.getLineLength(f.x,f.y,h.x,h.y),f=h;return h=p.getPointOnEllipticalArc(u[0],u[1],u[2],u[3],C,0),d+=p.getLineLength(f.x,f.y,h.x,h.y),d}return 0}static convertEndpointToCenterParameterization(i,o,c,u,d,f,h,g,p){const x=p*(Math.PI/180),v=Math.cos(x)*(i-c)/2+Math.sin(x)*(o-u)/2,C=-1*Math.sin(x)*(i-c)/2+Math.cos(x)*(o-u)/2,b=v*v/(h*h)+C*C/(g*g);b>1&&(h*=Math.sqrt(b),g*=Math.sqrt(b));let _=Math.sqrt((h*h*(g*g)-h*h*(C*C)-g*g*(v*v))/(h*h*(C*C)+g*g*(v*v)));d===f&&(_*=-1),isNaN(_)&&(_=0);const T=_*h*C/g,N=_*-g*v/h,E=(i+c)/2+Math.cos(x)*T-Math.sin(x)*N,F=(o+u)/2+Math.sin(x)*T+Math.cos(x)*N,j=function(re){return Math.sqrt(re[0]*re[0]+re[1]*re[1])},P=function(re,Z){return(re[0]*Z[0]+re[1]*Z[1])/(j(re)*j(Z))},M=function(re,Z){return(re[0]*Z[1]<re[1]*Z[0]?-1:1)*Math.acos(P(re,Z))},I=M([1,0],[(v-T)/h,(C-N)/g]),U=[(v-T)/h,(C-N)/g],K=[(-1*v-T)/h,(-1*C-N)/g];let te=M(U,K);return P(U,K)<=-1&&(te=Math.PI),P(U,K)>=1&&(te=0),f===0&&te>0&&(te=te-2*Math.PI),f===1&&te<0&&(te=te+2*Math.PI),[E,F,h,g,I,te,x,f]}}return fy.Path=s,s.prototype.className="Path",s.prototype._attrsAffectingSize=["data"],(0,t._registerNode)(s),e.Factory.addGetterSetter(s,"data"),fy}var GF;function Fle(){if(GF)return uy;GF=1,Object.defineProperty(uy,"__esModule",{value:!0}),uy.Arrow=void 0;const e=Bn(),t=bH(),r=Un(),n=Rn(),s=TN();class a extends t.Line{_sceneFunc(o){super._sceneFunc(o);const c=Math.PI*2,u=this.points();let d=u;const f=this.tension()!==0&&u.length>4;f&&(d=this.getTensionPoints());const h=this.pointerLength(),g=u.length;let p,x;if(f){const b=[d[d.length-4],d[d.length-3],d[d.length-2],d[d.length-1],u[g-2],u[g-1]],_=s.Path.calcLength(d[d.length-4],d[d.length-3],"C",b),T=s.Path.getPointOnQuadraticBezier(Math.min(1,1-h/_),b[0],b[1],b[2],b[3],b[4],b[5]);p=u[g-2]-T.x,x=u[g-1]-T.y}else p=u[g-2]-u[g-4],x=u[g-1]-u[g-3];const v=(Math.atan2(x,p)+c)%c,C=this.pointerWidth();this.pointerAtEnding()&&(o.save(),o.beginPath(),o.translate(u[g-2],u[g-1]),o.rotate(v),o.moveTo(0,0),o.lineTo(-h,C/2),o.lineTo(-h,-C/2),o.closePath(),o.restore(),this.__fillStroke(o)),this.pointerAtBeginning()&&(o.save(),o.beginPath(),o.translate(u[0],u[1]),f?(p=(d[0]+d[2])/2-u[0],x=(d[1]+d[3])/2-u[1]):(p=u[2]-u[0],x=u[3]-u[1]),o.rotate((Math.atan2(-x,-p)+c)%c),o.moveTo(0,0),o.lineTo(-h,C/2),o.lineTo(-h,-C/2),o.closePath(),o.restore(),this.__fillStroke(o))}__fillStroke(o){const c=this.dashEnabled();c&&(this.attrs.dashEnabled=!1,o.setLineDash([])),o.fillStrokeShape(this),c&&(this.attrs.dashEnabled=!0)}getSelfRect(){const o=super.getSelfRect(),c=this.pointerWidth()/2;return{x:o.x,y:o.y-c,width:o.width,height:o.height+c*2}}}return uy.Arrow=a,a.prototype.className="Arrow",(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"pointerLength",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerWidth",10,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"pointerAtBeginning",!1),e.Factory.addGetterSetter(a,"pointerAtEnding",!0),uy}var hy={},VF;function Mle(){if(VF)return hy;VF=1,Object.defineProperty(hy,"__esModule",{value:!0}),hy.Circle=void 0;const e=Bn(),t=Oi(),r=Un(),n=Rn();class s extends t.Shape{_sceneFunc(i){i.beginPath(),i.arc(0,0,this.attrs.radius||0,0,Math.PI*2,!1),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius()!==i/2&&this.radius(i/2)}setHeight(i){this.radius()!==i/2&&this.radius(i/2)}}return hy.Circle=s,s.prototype._centroid=!0,s.prototype.className="Circle",s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),hy}var my={},qF;function Rle(){if(qF)return my;qF=1,Object.defineProperty(my,"__esModule",{value:!0}),my.Ellipse=void 0;const e=Bn(),t=Oi(),r=Un(),n=Rn();class s extends t.Shape{_sceneFunc(i){const o=this.radiusX(),c=this.radiusY();i.beginPath(),i.save(),o!==c&&i.scale(1,c/o),i.arc(0,0,o,0,Math.PI*2,!1),i.restore(),i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.radiusX()*2}getHeight(){return this.radiusY()*2}setWidth(i){this.radiusX(i/2)}setHeight(i){this.radiusY(i/2)}}return my.Ellipse=s,s.prototype.className="Ellipse",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radiusX","radiusY"],(0,n._registerNode)(s),e.Factory.addComponentsGetterSetter(s,"radius",["x","y"]),e.Factory.addGetterSetter(s,"radiusX",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"radiusY",0,(0,r.getNumberValidator)()),my}var gy={},KF;function Ole(){if(KF)return gy;KF=1,Object.defineProperty(gy,"__esModule",{value:!0}),gy.Image=void 0;const e=Ca(),t=Bn(),r=Oi(),n=Rn(),s=Un();class a extends r.Shape{constructor(o){super(o),this._loadListener=()=>{this._requestDraw()},this.on("imageChange.konva",c=>{this._removeImageLoad(c.oldVal),this._setImageLoad()}),this._setImageLoad()}_setImageLoad(){const o=this.image();o&&o.complete||o&&o.readyState===4||o&&o.addEventListener&&o.addEventListener("load",this._loadListener)}_removeImageLoad(o){o&&o.removeEventListener&&o.removeEventListener("load",this._loadListener)}destroy(){return this._removeImageLoad(this.image()),super.destroy(),this}_useBufferCanvas(){const o=!!this.cornerRadius(),c=this.hasShadow();return o&&c?!0:super._useBufferCanvas(!0)}_sceneFunc(o){const c=this.getWidth(),u=this.getHeight(),d=this.cornerRadius(),f=this.attrs.image;let h;if(f){const g=this.attrs.cropWidth,p=this.attrs.cropHeight;g&&p?h=[f,this.cropX(),this.cropY(),g,p,0,0,c,u]:h=[f,0,0,c,u]}(this.hasFill()||this.hasStroke()||d)&&(o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)),f&&(d&&o.clip(),o.drawImage.apply(o,h))}_hitFunc(o){const c=this.width(),u=this.height(),d=this.cornerRadius();o.beginPath(),d?e.Util.drawRoundedRectPath(o,c,u,d):o.rect(0,0,c,u),o.closePath(),o.fillStrokeShape(this)}getWidth(){var o,c;return(o=this.attrs.width)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.width}getHeight(){var o,c;return(o=this.attrs.height)!==null&&o!==void 0?o:(c=this.image())===null||c===void 0?void 0:c.height}static fromURL(o,c,u=null){const d=e.Util.createImageElement();d.onload=function(){const f=new a({image:d});c(f)},d.onerror=u,d.crossOrigin="Anonymous",d.src=o}}return gy.Image=a,a.prototype.className="Image",(0,n._registerNode)(a),t.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),t.Factory.addGetterSetter(a,"image"),t.Factory.addComponentsGetterSetter(a,"crop",["x","y","width","height"]),t.Factory.addGetterSetter(a,"cropX",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropY",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropWidth",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(a,"cropHeight",0,(0,s.getNumberValidator)()),gy}var lm={},YF;function Dle(){if(YF)return lm;YF=1,Object.defineProperty(lm,"__esModule",{value:!0}),lm.Tag=lm.Label=void 0;const e=Bn(),t=Oi(),r=kN(),n=Un(),s=Rn(),a=["fontFamily","fontSize","fontStyle","padding","lineHeight","text","width","height","pointerDirection","pointerWidth","pointerHeight"],i="Change.konva",o="none",c="up",u="right",d="down",f="left",h=a.length;class g extends r.Group{constructor(v){super(v),this.on("add.konva",function(C){this._addListeners(C.child),this._sync()})}getText(){return this.find("Text")[0]}getTag(){return this.find("Tag")[0]}_addListeners(v){let C=this,b;const _=function(){C._sync()};for(b=0;b<h;b++)v.on(a[b]+i,_)}getWidth(){return this.getText().width()}getHeight(){return this.getText().height()}_sync(){let v=this.getText(),C=this.getTag(),b,_,T,N,E,F,j;if(v&&C){switch(b=v.width(),_=v.height(),T=C.pointerDirection(),N=C.pointerWidth(),j=C.pointerHeight(),E=0,F=0,T){case c:E=b/2,F=-1*j;break;case u:E=b+N,F=_/2;break;case d:E=b/2,F=_+j;break;case f:E=-1*N,F=_/2;break}C.setAttrs({x:-1*E,y:-1*F,width:b,height:_}),v.setAttrs({x:-1*E,y:-1*F})}}}lm.Label=g,g.prototype.className="Label",(0,s._registerNode)(g);class p extends t.Shape{_sceneFunc(v){const C=this.width(),b=this.height(),_=this.pointerDirection(),T=this.pointerWidth(),N=this.pointerHeight(),E=this.cornerRadius();let F=0,j=0,P=0,M=0;typeof E=="number"?F=j=P=M=Math.min(E,C/2,b/2):(F=Math.min(E[0]||0,C/2,b/2),j=Math.min(E[1]||0,C/2,b/2),M=Math.min(E[2]||0,C/2,b/2),P=Math.min(E[3]||0,C/2,b/2)),v.beginPath(),v.moveTo(F,0),_===c&&(v.lineTo((C-T)/2,0),v.lineTo(C/2,-1*N),v.lineTo((C+T)/2,0)),v.lineTo(C-j,0),v.arc(C-j,j,j,Math.PI*3/2,0,!1),_===u&&(v.lineTo(C,(b-N)/2),v.lineTo(C+T,b/2),v.lineTo(C,(b+N)/2)),v.lineTo(C,b-M),v.arc(C-M,b-M,M,0,Math.PI/2,!1),_===d&&(v.lineTo((C+T)/2,b),v.lineTo(C/2,b+N),v.lineTo((C-T)/2,b)),v.lineTo(P,b),v.arc(P,b-P,P,Math.PI/2,Math.PI,!1),_===f&&(v.lineTo(0,(b+N)/2),v.lineTo(-1*T,b/2),v.lineTo(0,(b-N)/2)),v.lineTo(0,F),v.arc(F,F,F,Math.PI,Math.PI*3/2,!1),v.closePath(),v.fillStrokeShape(this)}getSelfRect(){let v=0,C=0,b=this.pointerWidth(),_=this.pointerHeight(),T=this.pointerDirection(),N=this.width(),E=this.height();return T===c?(C-=_,E+=_):T===d?E+=_:T===f?(v-=b*1.5,N+=b):T===u&&(N+=b*1.5),{x:v,y:C,width:N,height:E}}}return lm.Tag=p,p.prototype.className="Tag",(0,s._registerNode)(p),e.Factory.addGetterSetter(p,"pointerDirection",o),e.Factory.addGetterSetter(p,"pointerWidth",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(p,"pointerHeight",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(p,"cornerRadius",0,(0,n.getNumberOrArrayOfNumbersValidator)(4)),lm}var py={},XF;function wH(){if(XF)return py;XF=1,Object.defineProperty(py,"__esModule",{value:!0}),py.Rect=void 0;const e=Bn(),t=Oi(),r=Rn(),n=Ca(),s=Un();class a extends t.Shape{_sceneFunc(o){const c=this.cornerRadius(),u=this.width(),d=this.height();o.beginPath(),c?n.Util.drawRoundedRectPath(o,u,d,c):o.rect(0,0,u,d),o.closePath(),o.fillStrokeShape(this)}}return py.Rect=a,a.prototype.className="Rect",(0,r._registerNode)(a),e.Factory.addGetterSetter(a,"cornerRadius",0,(0,s.getNumberOrArrayOfNumbersValidator)(4)),py}var xy={},JF;function Ile(){if(JF)return xy;JF=1,Object.defineProperty(xy,"__esModule",{value:!0}),xy.RegularPolygon=void 0;const e=Bn(),t=Oi(),r=Un(),n=Rn();class s extends t.Shape{_sceneFunc(i){const o=this._getPoints();i.beginPath(),i.moveTo(o[0].x,o[0].y);for(let c=1;c<o.length;c++)i.lineTo(o[c].x,o[c].y);i.closePath(),i.fillStrokeShape(this)}_getPoints(){const i=this.attrs.sides,o=this.attrs.radius||0,c=[];for(let u=0;u<i;u++)c.push({x:o*Math.sin(u*2*Math.PI/i),y:-1*o*Math.cos(u*2*Math.PI/i)});return c}getSelfRect(){const i=this._getPoints();let o=i[0].x,c=i[0].y,u=i[0].x,d=i[0].y;return i.forEach(f=>{o=Math.min(o,f.x),c=Math.max(c,f.x),u=Math.min(u,f.y),d=Math.max(d,f.y)}),{x:o,y:u,width:c-o,height:d-u}}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(i){this.radius(i/2)}setHeight(i){this.radius(i/2)}}return xy.RegularPolygon=s,s.prototype.className="RegularPolygon",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["radius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"radius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"sides",0,(0,r.getNumberValidator)()),xy}var yy={},QF;function Lle(){if(QF)return yy;QF=1,Object.defineProperty(yy,"__esModule",{value:!0}),yy.Ring=void 0;const e=Bn(),t=Oi(),r=Un(),n=Rn(),s=Math.PI*2;class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.innerRadius(),0,s,!1),o.moveTo(this.outerRadius(),0),o.arc(0,0,this.outerRadius(),s,0,!0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(o){this.outerRadius(o/2)}setHeight(o){this.outerRadius(o/2)}}return yy.Ring=a,a.prototype.className="Ring",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(a),e.Factory.addGetterSetter(a,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(a,"outerRadius",0,(0,r.getNumberValidator)()),yy}var vy={},ZF;function Ble(){if(ZF)return vy;ZF=1,Object.defineProperty(vy,"__esModule",{value:!0}),vy.Sprite=void 0;const e=Bn(),t=Oi(),r=CN(),n=Un(),s=Rn();class a extends t.Shape{constructor(o){super(o),this._updated=!0,this.anim=new r.Animation(()=>{const c=this._updated;return this._updated=!1,c}),this.on("animationChange.konva",function(){this.frameIndex(0)}),this.on("frameIndexChange.konva",function(){this._updated=!0}),this.on("frameRateChange.konva",function(){this.anim.isRunning()&&(clearInterval(this.interval),this._setInterval())})}_sceneFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,f=this.animations()[c],h=this.frameOffsets(),g=f[d+0],p=f[d+1],x=f[d+2],v=f[d+3],C=this.image();if((this.hasFill()||this.hasStroke())&&(o.beginPath(),o.rect(0,0,x,v),o.closePath(),o.fillStrokeShape(this)),C)if(h){const b=h[c],_=u*2;o.drawImage(C,g,p,x,v,b[_+0],b[_+1],x,v)}else o.drawImage(C,g,p,x,v,0,0,x,v)}_hitFunc(o){const c=this.animation(),u=this.frameIndex(),d=u*4,f=this.animations()[c],h=this.frameOffsets(),g=f[d+2],p=f[d+3];if(o.beginPath(),h){const x=h[c],v=u*2;o.rect(x[v+0],x[v+1],g,p)}else o.rect(0,0,g,p);o.closePath(),o.fillShape(this)}_useBufferCanvas(){return super._useBufferCanvas(!0)}_setInterval(){const o=this;this.interval=setInterval(function(){o._updateIndex()},1e3/this.frameRate())}start(){if(this.isRunning())return;const o=this.getLayer();this.anim.setLayers(o),this._setInterval(),this.anim.start()}stop(){this.anim.stop(),clearInterval(this.interval)}isRunning(){return this.anim.isRunning()}_updateIndex(){const o=this.frameIndex(),c=this.animation(),u=this.animations(),d=u[c],f=d.length/4;o<f-1?this.frameIndex(o+1):this.frameIndex(0)}}return vy.Sprite=a,a.prototype.className="Sprite",(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"animation"),e.Factory.addGetterSetter(a,"animations"),e.Factory.addGetterSetter(a,"frameOffsets"),e.Factory.addGetterSetter(a,"image"),e.Factory.addGetterSetter(a,"frameIndex",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"frameRate",17,(0,n.getNumberValidator)()),e.Factory.backCompat(a,{index:"frameIndex",getIndex:"getFrameIndex",setIndex:"setFrameIndex"}),vy}var by={},eM;function $le(){if(eM)return by;eM=1,Object.defineProperty(by,"__esModule",{value:!0}),by.Star=void 0;const e=Bn(),t=Oi(),r=Un(),n=Rn();class s extends t.Shape{_sceneFunc(i){const o=this.innerRadius(),c=this.outerRadius(),u=this.numPoints();i.beginPath(),i.moveTo(0,0-c);for(let d=1;d<u*2;d++){const f=d%2===0?c:o,h=f*Math.sin(d*Math.PI/u),g=-1*f*Math.cos(d*Math.PI/u);i.lineTo(h,g)}i.closePath(),i.fillStrokeShape(this)}getWidth(){return this.outerRadius()*2}getHeight(){return this.outerRadius()*2}setWidth(i){this.outerRadius(i/2)}setHeight(i){this.outerRadius(i/2)}}return by.Star=s,s.prototype.className="Star",s.prototype._centroid=!0,s.prototype._attrsAffectingSize=["innerRadius","outerRadius"],(0,n._registerNode)(s),e.Factory.addGetterSetter(s,"numPoints",5,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"innerRadius",0,(0,r.getNumberValidator)()),e.Factory.addGetterSetter(s,"outerRadius",0,(0,r.getNumberValidator)()),by}var wp={},tM;function _H(){if(tM)return wp;tM=1,Object.defineProperty(wp,"__esModule",{value:!0}),wp.Text=void 0,wp.stringToArray=i;const e=Ca(),t=Bn(),r=Oi(),n=Rn(),s=Un(),a=Rn();function i(R){return[...R].reduce((L,G,W,Q)=>{if(new RegExp("\\p{Emoji}","u").test(G)){const X=Q[W+1];X&&new RegExp("\\p{Emoji_Modifier}|\\u200D","u").test(X)?(L.push(G+X),Q[W+1]=""):L.push(G)}else new RegExp("\\p{Regional_Indicator}{2}","u").test(G+(Q[W+1]||""))?L.push(G+Q[W+1]):W>0&&new RegExp("\\p{Mn}|\\p{Me}|\\p{Mc}","u").test(G)?L[L.length-1]+=G:G&&L.push(G);return L},[])}const o="auto",c="center",u="inherit",d="justify",f="Change.konva",h="2d",g="-",p="left",x="text",v="Text",C="top",b="bottom",_="middle",T="normal",N="px ",E=" ",F="right",j="rtl",P="word",M="char",I="none",U="",K=["direction","fontFamily","fontSize","fontStyle","fontVariant","padding","align","verticalAlign","lineHeight","text","width","height","wrap","ellipsis","letterSpacing"],te=K.length;function re(R){return R.split(",").map(L=>{L=L.trim();const G=L.indexOf(" ")>=0,W=L.indexOf('"')>=0||L.indexOf("'")>=0;return G&&!W&&(L=`"${L}"`),L}).join(", ")}let Z;function B(){return Z||(Z=e.Util.createCanvasElement().getContext(h),Z)}function J(R){R.fillText(this._partialText,this._partialTextX,this._partialTextY)}function z(R){R.setAttr("miterLimit",2),R.strokeText(this._partialText,this._partialTextX,this._partialTextY)}function q(R){return R=R||{},!R.fillLinearGradientColorStops&&!R.fillRadialGradientColorStops&&!R.fillPatternImage&&(R.fill=R.fill||"black"),R}class H extends r.Shape{constructor(L){super(q(L)),this._partialTextX=0,this._partialTextY=0;for(let G=0;G<te;G++)this.on(K[G]+f,this._setTextData);this._setTextData()}_sceneFunc(L){const G=this.textArr,W=G.length;if(!this.text())return;let Q=this.padding(),X=this.fontSize(),se=this.lineHeight()*X,le=this.verticalAlign(),he=this.direction(),we=0,ie=this.align(),Ee=this.getWidth(),ye=this.letterSpacing(),Ie=this.fill(),ut=this.textDecoration(),Qe=ut.indexOf("underline")!==-1,$t=ut.indexOf("line-through")!==-1,Ge;he=he===u?L.direction:he;let et=se/2,vt=_;if(n.Konva._fixTextRendering){const Te=this.measureSize("M");vt="alphabetic",et=(Te.fontBoundingBoxAscent-Te.fontBoundingBoxDescent)/2+se/2}for(he===j&&L.setAttr("direction",he),L.setAttr("font",this._getContextFont()),L.setAttr("textBaseline",vt),L.setAttr("textAlign",p),le===_?we=(this.getHeight()-W*se-Q*2)/2:le===b&&(we=this.getHeight()-W*se-Q*2),L.translate(Q,we+Q),Ge=0;Ge<W;Ge++){let Te=0,Ve=0;const pt=G[Ge],wt=pt.text,Ut=pt.width,ct=pt.lastInParagraph;if(L.save(),ie===F?Te+=Ee-Ut-Q*2:ie===c&&(Te+=(Ee-Ut-Q*2)/2),Qe){L.save(),L.beginPath();const yt=n.Konva._fixTextRendering?Math.round(X/4):Math.round(X/2),rt=Te,Oe=et+Ve+yt;L.moveTo(rt,Oe);const $e=ie===d&&!ct?Ee-Q*2:Ut;L.lineTo(rt+Math.round($e),Oe),L.lineWidth=X/15;const Mt=this._getLinearGradient();L.strokeStyle=Mt||Ie,L.stroke(),L.restore()}if($t){L.save(),L.beginPath();const yt=n.Konva._fixTextRendering?-Math.round(X/4):0;L.moveTo(Te,et+Ve+yt);const rt=ie===d&&!ct?Ee-Q*2:Ut;L.lineTo(Te+Math.round(rt),et+Ve+yt),L.lineWidth=X/15;const Oe=this._getLinearGradient();L.strokeStyle=Oe||Ie,L.stroke(),L.restore()}if(he!==j&&(ye!==0||ie===d)){const yt=wt.split(" ").length-1,rt=i(wt);for(let Oe=0;Oe<rt.length;Oe++){const $e=rt[Oe];$e===" "&&!ct&&ie===d&&(Te+=(Ee-Q*2-Ut)/yt),this._partialTextX=Te,this._partialTextY=et+Ve,this._partialText=$e,L.fillStrokeShape(this),Te+=this.measureSize($e).width+ye}}else ye!==0&&L.setAttr("letterSpacing",`${ye}px`),this._partialTextX=Te,this._partialTextY=et+Ve,this._partialText=wt,L.fillStrokeShape(this);L.restore(),W>1&&(et+=se)}}_hitFunc(L){const G=this.getWidth(),W=this.getHeight();L.beginPath(),L.rect(0,0,G,W),L.closePath(),L.fillStrokeShape(this)}setText(L){const G=e.Util._isString(L)?L:L==null?"":L+"";return this._setAttr(x,G),this}getWidth(){return this.attrs.width===o||this.attrs.width===void 0?this.getTextWidth()+this.padding()*2:this.attrs.width}getHeight(){return this.attrs.height===o||this.attrs.height===void 0?this.fontSize()*this.textArr.length*this.lineHeight()+this.padding()*2:this.attrs.height}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}measureSize(L){var G,W,Q,X,se,le,he,we,ie,Ee,ye;let Ie=B(),ut=this.fontSize(),Qe;Ie.save(),Ie.font=this._getContextFont(),Qe=Ie.measureText(L),Ie.restore();const $t=ut/100;return{actualBoundingBoxAscent:(G=Qe.actualBoundingBoxAscent)!==null&&G!==void 0?G:71.58203125*$t,actualBoundingBoxDescent:(W=Qe.actualBoundingBoxDescent)!==null&&W!==void 0?W:0,actualBoundingBoxLeft:(Q=Qe.actualBoundingBoxLeft)!==null&&Q!==void 0?Q:-7.421875*$t,actualBoundingBoxRight:(X=Qe.actualBoundingBoxRight)!==null&&X!==void 0?X:75.732421875*$t,alphabeticBaseline:(se=Qe.alphabeticBaseline)!==null&&se!==void 0?se:0,emHeightAscent:(le=Qe.emHeightAscent)!==null&&le!==void 0?le:100*$t,emHeightDescent:(he=Qe.emHeightDescent)!==null&&he!==void 0?he:-20*$t,fontBoundingBoxAscent:(we=Qe.fontBoundingBoxAscent)!==null&&we!==void 0?we:91*$t,fontBoundingBoxDescent:(ie=Qe.fontBoundingBoxDescent)!==null&&ie!==void 0?ie:21*$t,hangingBaseline:(Ee=Qe.hangingBaseline)!==null&&Ee!==void 0?Ee:72.80000305175781*$t,ideographicBaseline:(ye=Qe.ideographicBaseline)!==null&&ye!==void 0?ye:-21*$t,width:Qe.width,height:ut}}_getContextFont(){return this.fontStyle()+E+this.fontVariant()+E+(this.fontSize()+N)+re(this.fontFamily())}_addTextLine(L){this.align()===d&&(L=L.trim());const W=this._getTextWidth(L);return this.textArr.push({text:L,width:W,lastInParagraph:!1})}_getTextWidth(L){const G=this.letterSpacing(),W=L.length;return B().measureText(L).width+G*W}_setTextData(){let L=this.text().split(`
`),G=+this.fontSize(),W=0,Q=this.lineHeight()*G,X=this.attrs.width,se=this.attrs.height,le=X!==o&&X!==void 0,he=se!==o&&se!==void 0,we=this.padding(),ie=X-we*2,Ee=se-we*2,ye=0,Ie=this.wrap(),ut=Ie!==I,Qe=Ie!==M&&ut,$t=this.ellipsis();this.textArr=[],B().font=this._getContextFont();const Ge=$t?this._getTextWidth(U):0;for(let et=0,vt=L.length;et<vt;++et){let Te=L[et],Ve=this._getTextWidth(Te);if(le&&Ve>ie)for(;Te.length>0;){let pt=0,wt=i(Te).length,Ut="",ct=0;for(;pt<wt;){const yt=pt+wt>>>1,rt=i(Te),Oe=rt.slice(0,yt+1).join(""),$e=this._getTextWidth(Oe);($t&&he&&ye+Q>Ee?$e+Ge:$e)<=ie?(pt=yt+1,Ut=Oe,ct=$e):wt=yt}if(Ut){if(Qe){const Oe=i(Te),$e=i(Ut),Mt=Oe[$e.length],It=Mt===E||Mt===g;let At;if(It&&ct<=ie)At=$e.length;else{const tr=$e.lastIndexOf(E),ar=$e.lastIndexOf(g);At=Math.max(tr,ar)+1}At>0&&(pt=At,Ut=Oe.slice(0,pt).join(""),ct=this._getTextWidth(Ut))}if(Ut=Ut.trimRight(),this._addTextLine(Ut),W=Math.max(W,ct),ye+=Q,this._shouldHandleEllipsis(ye)){this._tryToAddEllipsisToLastLine();break}if(Te=i(Te).slice(pt).join("").trimLeft(),Te.length>0&&(Ve=this._getTextWidth(Te),Ve<=ie)){this._addTextLine(Te),ye+=Q,W=Math.max(W,Ve);break}}else break}else this._addTextLine(Te),ye+=Q,W=Math.max(W,Ve),this._shouldHandleEllipsis(ye)&&et<vt-1&&this._tryToAddEllipsisToLastLine();if(this.textArr[this.textArr.length-1]&&(this.textArr[this.textArr.length-1].lastInParagraph=!0),he&&ye+Q>Ee)break}this.textHeight=G,this.textWidth=W}_shouldHandleEllipsis(L){const G=+this.fontSize(),W=this.lineHeight()*G,Q=this.attrs.height,X=Q!==o&&Q!==void 0,se=this.padding(),le=Q-se*2;return!(this.wrap()!==I)||X&&L+W>le}_tryToAddEllipsisToLastLine(){const L=this.attrs.width,G=L!==o&&L!==void 0,W=this.padding(),Q=L-W*2,X=this.ellipsis(),se=this.textArr[this.textArr.length-1];!se||!X||(G&&(this._getTextWidth(se.text+U)<Q||(se.text=se.text.slice(0,se.text.length-3))),this.textArr.splice(this.textArr.length-1,1),this._addTextLine(se.text+U))}getStrokeScaleEnabled(){return!0}_useBufferCanvas(){const L=this.textDecoration().indexOf("underline")!==-1||this.textDecoration().indexOf("line-through")!==-1,G=this.hasShadow();return L&&G?!0:super._useBufferCanvas()}}return wp.Text=H,H.prototype._fillFunc=J,H.prototype._strokeFunc=z,H.prototype.className=v,H.prototype._attrsAffectingSize=["text","fontSize","padding","wrap","lineHeight","letterSpacing"],(0,a._registerNode)(H),t.Factory.overWriteSetter(H,"width",(0,s.getNumberOrAutoValidator)()),t.Factory.overWriteSetter(H,"height",(0,s.getNumberOrAutoValidator)()),t.Factory.addGetterSetter(H,"direction",u),t.Factory.addGetterSetter(H,"fontFamily","Arial"),t.Factory.addGetterSetter(H,"fontSize",12,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"fontStyle",T),t.Factory.addGetterSetter(H,"fontVariant",T),t.Factory.addGetterSetter(H,"padding",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"align",p),t.Factory.addGetterSetter(H,"verticalAlign",C),t.Factory.addGetterSetter(H,"lineHeight",1,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"wrap",P),t.Factory.addGetterSetter(H,"ellipsis",!1,(0,s.getBooleanValidator)()),t.Factory.addGetterSetter(H,"letterSpacing",0,(0,s.getNumberValidator)()),t.Factory.addGetterSetter(H,"text","",(0,s.getStringValidator)()),t.Factory.addGetterSetter(H,"textDecoration",""),wp}var wy={},rM;function Ule(){if(rM)return wy;rM=1,Object.defineProperty(wy,"__esModule",{value:!0}),wy.TextPath=void 0;const e=Ca(),t=Bn(),r=Oi(),n=TN(),s=_H(),a=Un(),i=Rn(),o="",c="normal";function u(h){h.fillText(this.partialText,0,0)}function d(h){h.strokeText(this.partialText,0,0)}class f extends r.Shape{constructor(g){super(g),this.dummyCanvas=e.Util.createCanvasElement(),this.dataArray=[],this._readDataAttribute(),this.on("dataChange.konva",function(){this._readDataAttribute(),this._setTextData()}),this.on("textChange.konva alignChange.konva letterSpacingChange.konva kerningFuncChange.konva fontSizeChange.konva fontFamilyChange.konva",this._setTextData),this._setTextData()}_getTextPathLength(){return n.Path.getPathLength(this.dataArray)}_getPointAtLength(g){if(!this.attrs.data)return null;const p=this.pathLength;return g-1>p?null:n.Path.getPointAtLengthOfDataArray(g,this.dataArray)}_readDataAttribute(){this.dataArray=n.Path.parsePathData(this.attrs.data),this.pathLength=this._getTextPathLength()}_sceneFunc(g){g.setAttr("font",this._getContextFont()),g.setAttr("textBaseline",this.textBaseline()),g.setAttr("textAlign","left"),g.save();const p=this.textDecoration(),x=this.fill(),v=this.fontSize(),C=this.glyphInfo;p==="underline"&&g.beginPath();for(let b=0;b<C.length;b++){g.save();const _=C[b].p0;g.translate(_.x,_.y),g.rotate(C[b].rotation),this.partialText=C[b].text,g.fillStrokeShape(this),p==="underline"&&(b===0&&g.moveTo(0,v/2+1),g.lineTo(v,v/2+1)),g.restore()}p==="underline"&&(g.strokeStyle=x,g.lineWidth=v/20,g.stroke()),g.restore()}_hitFunc(g){g.beginPath();const p=this.glyphInfo;if(p.length>=1){const x=p[0].p0;g.moveTo(x.x,x.y)}for(let x=0;x<p.length;x++){const v=p[x].p1;g.lineTo(v.x,v.y)}g.setAttr("lineWidth",this.fontSize()),g.setAttr("strokeStyle",this.colorKey),g.stroke()}getTextWidth(){return this.textWidth}getTextHeight(){return e.Util.warn("text.getTextHeight() method is deprecated. Use text.height() - for full height and text.fontSize() - for one line height."),this.textHeight}setText(g){return s.Text.prototype.setText.call(this,g)}_getContextFont(){return s.Text.prototype._getContextFont.call(this)}_getTextSize(g){const x=this.dummyCanvas.getContext("2d");x.save(),x.font=this._getContextFont();const v=x.measureText(g);return x.restore(),{width:v.width,height:parseInt(`${this.fontSize()}`,10)}}_setTextData(){const{width:g,height:p}=this._getTextSize(this.attrs.text);if(this.textWidth=g,this.textHeight=p,this.glyphInfo=[],!this.attrs.data)return null;const x=this.letterSpacing(),v=this.align(),C=this.kerningFunc(),b=Math.max(this.textWidth+((this.attrs.text||"").length-1)*x,0);let _=0;v==="center"&&(_=Math.max(0,this.pathLength/2-b/2)),v==="right"&&(_=Math.max(0,this.pathLength-b));const T=(0,s.stringToArray)(this.text());let N=_;for(let E=0;E<T.length;E++){const F=this._getPointAtLength(N);if(!F)return;let j=this._getTextSize(T[E]).width+x;if(T[E]===" "&&v==="justify"){const te=this.text().split(" ").length-1;j+=(this.pathLength-b)/te}const P=this._getPointAtLength(N+j);if(!P)return;const M=n.Path.getLineLength(F.x,F.y,P.x,P.y);let I=0;if(C)try{I=C(T[E-1],T[E])*this.fontSize()}catch{I=0}F.x+=I,P.x+=I,this.textWidth+=I;const U=n.Path.getPointOnLine(I+M/2,F.x,F.y,P.x,P.y),K=Math.atan2(P.y-F.y,P.x-F.x);this.glyphInfo.push({transposeX:U.x,transposeY:U.y,text:T[E],rotation:K,p0:F,p1:P}),N+=j}}getSelfRect(){if(!this.glyphInfo.length)return{x:0,y:0,width:0,height:0};const g=[];this.glyphInfo.forEach(function(N){g.push(N.p0.x),g.push(N.p0.y),g.push(N.p1.x),g.push(N.p1.y)});let p=g[0]||0,x=g[0]||0,v=g[1]||0,C=g[1]||0,b,_;for(let N=0;N<g.length/2;N++)b=g[N*2],_=g[N*2+1],p=Math.min(p,b),x=Math.max(x,b),v=Math.min(v,_),C=Math.max(C,_);const T=this.fontSize();return{x:p-T/2,y:v-T/2,width:x-p+T,height:C-v+T}}destroy(){return e.Util.releaseCanvas(this.dummyCanvas),super.destroy()}}return wy.TextPath=f,f.prototype._fillFunc=u,f.prototype._strokeFunc=d,f.prototype._fillFuncHit=u,f.prototype._strokeFuncHit=d,f.prototype.className="TextPath",f.prototype._attrsAffectingSize=["text","fontSize","data"],(0,i._registerNode)(f),t.Factory.addGetterSetter(f,"data"),t.Factory.addGetterSetter(f,"fontFamily","Arial"),t.Factory.addGetterSetter(f,"fontSize",12,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(f,"fontStyle",c),t.Factory.addGetterSetter(f,"align","left"),t.Factory.addGetterSetter(f,"letterSpacing",0,(0,a.getNumberValidator)()),t.Factory.addGetterSetter(f,"textBaseline","middle"),t.Factory.addGetterSetter(f,"fontVariant",c),t.Factory.addGetterSetter(f,"text",o),t.Factory.addGetterSetter(f,"textDecoration",""),t.Factory.addGetterSetter(f,"kerningFunc",void 0),wy}var _y={},nM;function zle(){if(nM)return _y;nM=1,Object.defineProperty(_y,"__esModule",{value:!0}),_y.Transformer=void 0;const e=Ca(),t=Bn(),r=$a(),n=Oi(),s=wH(),a=kN(),i=Rn(),o=Un(),c=Rn(),u="tr-konva",d=["resizeEnabledChange","rotateAnchorOffsetChange","rotateEnabledChange","enabledAnchorsChange","anchorSizeChange","borderEnabledChange","borderStrokeChange","borderStrokeWidthChange","borderDashChange","anchorStrokeChange","anchorStrokeWidthChange","anchorFillChange","anchorCornerRadiusChange","ignoreStrokeChange","anchorStyleFuncChange"].map(j=>j+`.${u}`).join(" "),f="nodesRect",h=["widthChange","heightChange","scaleXChange","scaleYChange","skewXChange","skewYChange","rotationChange","offsetXChange","offsetYChange","transformsEnabledChange","strokeWidthChange"],g={"top-left":-45,"top-center":0,"top-right":45,"middle-right":-90,"middle-left":90,"bottom-left":-135,"bottom-center":180,"bottom-right":135},p="ontouchstart"in i.Konva._global;function x(j,P,M){if(j==="rotater")return M;P+=e.Util.degToRad(g[j]||0);const I=(e.Util.radToDeg(P)%360+360)%360;return e.Util._inRange(I,315+22.5,360)||e.Util._inRange(I,0,22.5)?"ns-resize":e.Util._inRange(I,45-22.5,45+22.5)?"nesw-resize":e.Util._inRange(I,90-22.5,90+22.5)?"ew-resize":e.Util._inRange(I,135-22.5,135+22.5)?"nwse-resize":e.Util._inRange(I,180-22.5,180+22.5)?"ns-resize":e.Util._inRange(I,225-22.5,225+22.5)?"nesw-resize":e.Util._inRange(I,270-22.5,270+22.5)?"ew-resize":e.Util._inRange(I,315-22.5,315+22.5)?"nwse-resize":(e.Util.error("Transformer has unknown angle for cursor detection: "+I),"pointer")}const v=["top-left","top-center","top-right","middle-right","middle-left","bottom-left","bottom-center","bottom-right"];function C(j){return{x:j.x+j.width/2*Math.cos(j.rotation)+j.height/2*Math.sin(-j.rotation),y:j.y+j.height/2*Math.cos(j.rotation)+j.width/2*Math.sin(j.rotation)}}function b(j,P,M){const I=M.x+(j.x-M.x)*Math.cos(P)-(j.y-M.y)*Math.sin(P),U=M.y+(j.x-M.x)*Math.sin(P)+(j.y-M.y)*Math.cos(P);return{...j,rotation:j.rotation+P,x:I,y:U}}function _(j,P){const M=C(j);return b(j,P,M)}function T(j,P,M){let I=P;for(let U=0;U<j.length;U++){const K=i.Konva.getAngle(j[U]),te=Math.abs(K-P)%(Math.PI*2);Math.min(te,Math.PI*2-te)<M&&(I=K)}return I}let N=0;class E extends a.Group{constructor(P){super(P),this._movingAnchorName=null,this._transforming=!1,this._createElements(),this._handleMouseMove=this._handleMouseMove.bind(this),this._handleMouseUp=this._handleMouseUp.bind(this),this.update=this.update.bind(this),this.on(d,this.update),this.getNode()&&this.update()}attachTo(P){return this.setNode(P),this}setNode(P){return e.Util.warn("tr.setNode(shape), tr.node(shape) and tr.attachTo(shape) methods are deprecated. Please use tr.nodes(nodesArray) instead."),this.setNodes([P])}getNode(){return this._nodes&&this._nodes[0]}_getEventNamespace(){return u+this._id}setNodes(P=[]){this._nodes&&this._nodes.length&&this.detach();const M=P.filter(U=>U.isAncestorOf(this)?(e.Util.error("Konva.Transformer cannot be an a child of the node you are trying to attach"),!1):!0);return this._nodes=P=M,P.length===1&&this.useSingleNodeRotation()?this.rotation(P[0].getAbsoluteRotation()):this.rotation(0),this._nodes.forEach(U=>{const K=()=>{this.nodes().length===1&&this.useSingleNodeRotation()&&this.rotation(this.nodes()[0].getAbsoluteRotation()),this._resetTransformCache(),!this._transforming&&!this.isDragging()&&this.update()};if(U._attrsAffectingSize.length){const te=U._attrsAffectingSize.map(re=>re+"Change."+this._getEventNamespace()).join(" ");U.on(te,K)}U.on(h.map(te=>te+`.${this._getEventNamespace()}`).join(" "),K),U.on(`absoluteTransformChange.${this._getEventNamespace()}`,K),this._proxyDrag(U)}),this._resetTransformCache(),!!this.findOne(".top-left")&&this.update(),this}_proxyDrag(P){let M;P.on(`dragstart.${this._getEventNamespace()}`,I=>{M=P.getAbsolutePosition(),!this.isDragging()&&P!==this.findOne(".back")&&this.startDrag(I,!1)}),P.on(`dragmove.${this._getEventNamespace()}`,I=>{if(!M)return;const U=P.getAbsolutePosition(),K=U.x-M.x,te=U.y-M.y;this.nodes().forEach(re=>{if(re===P||re.isDragging())return;const Z=re.getAbsolutePosition();re.setAbsolutePosition({x:Z.x+K,y:Z.y+te}),re.startDrag(I)}),M=null})}getNodes(){return this._nodes||[]}getActiveAnchor(){return this._movingAnchorName}detach(){this._nodes&&this._nodes.forEach(P=>{P.off("."+this._getEventNamespace())}),this._nodes=[],this._resetTransformCache()}_resetTransformCache(){this._clearCache(f),this._clearCache("transform"),this._clearSelfAndDescendantCache("absoluteTransform")}_getNodeRect(){return this._getCache(f,this.__getNodeRect)}__getNodeShape(P,M=this.rotation(),I){const U=P.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),K=P.getAbsoluteScale(I),te=P.getAbsolutePosition(I),re=U.x*K.x-P.offsetX()*K.x,Z=U.y*K.y-P.offsetY()*K.y,B=(i.Konva.getAngle(P.getAbsoluteRotation())+Math.PI*2)%(Math.PI*2),J={x:te.x+re*Math.cos(B)+Z*Math.sin(-B),y:te.y+Z*Math.cos(B)+re*Math.sin(B),width:U.width*K.x,height:U.height*K.y,rotation:B};return b(J,-i.Konva.getAngle(M),{x:0,y:0})}__getNodeRect(){if(!this.getNode())return{x:-1e8,y:-1e8,width:0,height:0,rotation:0};const M=[];this.nodes().map(B=>{const J=B.getClientRect({skipTransform:!0,skipShadow:!0,skipStroke:this.ignoreStroke()}),z=[{x:J.x,y:J.y},{x:J.x+J.width,y:J.y},{x:J.x+J.width,y:J.y+J.height},{x:J.x,y:J.y+J.height}],q=B.getAbsoluteTransform();z.forEach(function(H){const R=q.point(H);M.push(R)})});const I=new e.Transform;I.rotate(-i.Konva.getAngle(this.rotation()));let U=1/0,K=1/0,te=-1/0,re=-1/0;M.forEach(function(B){const J=I.point(B);U===void 0&&(U=te=J.x,K=re=J.y),U=Math.min(U,J.x),K=Math.min(K,J.y),te=Math.max(te,J.x),re=Math.max(re,J.y)}),I.invert();const Z=I.point({x:U,y:K});return{x:Z.x,y:Z.y,width:te-U,height:re-K,rotation:i.Konva.getAngle(this.rotation())}}getX(){return this._getNodeRect().x}getY(){return this._getNodeRect().y}getWidth(){return this._getNodeRect().width}getHeight(){return this._getNodeRect().height}_createElements(){this._createBack(),v.forEach(P=>{this._createAnchor(P)}),this._createAnchor("rotater")}_createAnchor(P){const M=new s.Rect({stroke:"rgb(0, 161, 255)",fill:"white",strokeWidth:1,name:P+" _anchor",dragDistance:0,draggable:!0,hitStrokeWidth:p?10:"auto"}),I=this;M.on("mousedown touchstart",function(U){I._handleMouseDown(U)}),M.on("dragstart",U=>{M.stopDrag(),U.cancelBubble=!0}),M.on("dragend",U=>{U.cancelBubble=!0}),M.on("mouseenter",()=>{const U=i.Konva.getAngle(this.rotation()),K=this.rotateAnchorCursor(),te=x(P,U,K);M.getStage().content&&(M.getStage().content.style.cursor=te),this._cursorChange=!0}),M.on("mouseout",()=>{M.getStage().content&&(M.getStage().content.style.cursor=""),this._cursorChange=!1}),this.add(M)}_createBack(){const P=new n.Shape({name:"back",width:0,height:0,draggable:!0,sceneFunc(M,I){const U=I.getParent(),K=U.padding();M.beginPath(),M.rect(-K,-K,I.width()+K*2,I.height()+K*2),M.moveTo(I.width()/2,-K),U.rotateEnabled()&&U.rotateLineVisible()&&M.lineTo(I.width()/2,-U.rotateAnchorOffset()*e.Util._sign(I.height())-K),M.fillStrokeShape(I)},hitFunc:(M,I)=>{if(!this.shouldOverdrawWholeArea())return;const U=this.padding();M.beginPath(),M.rect(-U,-U,I.width()+U*2,I.height()+U*2),M.fillStrokeShape(I)}});this.add(P),this._proxyDrag(P),P.on("dragstart",M=>{M.cancelBubble=!0}),P.on("dragmove",M=>{M.cancelBubble=!0}),P.on("dragend",M=>{M.cancelBubble=!0}),this.on("dragmove",M=>{this.update()})}_handleMouseDown(P){if(this._transforming)return;this._movingAnchorName=P.target.name().split(" ")[0];const M=this._getNodeRect(),I=M.width,U=M.height,K=Math.sqrt(Math.pow(I,2)+Math.pow(U,2));this.sin=Math.abs(U/K),this.cos=Math.abs(I/K),typeof window<"u"&&(window.addEventListener("mousemove",this._handleMouseMove),window.addEventListener("touchmove",this._handleMouseMove),window.addEventListener("mouseup",this._handleMouseUp,!0),window.addEventListener("touchend",this._handleMouseUp,!0)),this._transforming=!0;const te=P.target.getAbsolutePosition(),re=P.target.getStage().getPointerPosition();this._anchorDragOffset={x:re.x-te.x,y:re.y-te.y},N++,this._fire("transformstart",{evt:P.evt,target:this.getNode()}),this._nodes.forEach(Z=>{Z._fire("transformstart",{evt:P.evt,target:Z})})}_handleMouseMove(P){let M,I,U;const K=this.findOne("."+this._movingAnchorName),te=K.getStage();te.setPointersPositions(P);const re=te.getPointerPosition();let Z={x:re.x-this._anchorDragOffset.x,y:re.y-this._anchorDragOffset.y};const B=K.getAbsolutePosition();this.anchorDragBoundFunc()&&(Z=this.anchorDragBoundFunc()(B,Z,P)),K.setAbsolutePosition(Z);const J=K.getAbsolutePosition();if(B.x===J.x&&B.y===J.y)return;if(this._movingAnchorName==="rotater"){const Q=this._getNodeRect();M=K.x()-Q.width/2,I=-K.y()+Q.height/2;let X=Math.atan2(-I,M)+Math.PI/2;Q.height<0&&(X-=Math.PI);const le=i.Konva.getAngle(this.rotation())+X,he=i.Konva.getAngle(this.rotationSnapTolerance()),ie=T(this.rotationSnaps(),le,he)-Q.rotation,Ee=_(Q,ie);this._fitNodesInto(Ee,P);return}const z=this.shiftBehavior();let q;z==="inverted"?q=this.keepRatio()&&!P.shiftKey:z==="none"?q=this.keepRatio():q=this.keepRatio()||P.shiftKey;let H=this.centeredScaling()||P.altKey;if(this._movingAnchorName==="top-left"){if(q){const Q=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-right").x(),y:this.findOne(".bottom-right").y()};U=Math.sqrt(Math.pow(Q.x-K.x(),2)+Math.pow(Q.y-K.y(),2));const X=this.findOne(".top-left").x()>Q.x?-1:1,se=this.findOne(".top-left").y()>Q.y?-1:1;M=U*this.cos*X,I=U*this.sin*se,this.findOne(".top-left").x(Q.x-M),this.findOne(".top-left").y(Q.y-I)}}else if(this._movingAnchorName==="top-center")this.findOne(".top-left").y(K.y());else if(this._movingAnchorName==="top-right"){if(q){const Q=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".bottom-left").x(),y:this.findOne(".bottom-left").y()};U=Math.sqrt(Math.pow(K.x()-Q.x,2)+Math.pow(Q.y-K.y(),2));const X=this.findOne(".top-right").x()<Q.x?-1:1,se=this.findOne(".top-right").y()>Q.y?-1:1;M=U*this.cos*X,I=U*this.sin*se,this.findOne(".top-right").x(Q.x+M),this.findOne(".top-right").y(Q.y-I)}var R=K.position();this.findOne(".top-left").y(R.y),this.findOne(".bottom-right").x(R.x)}else if(this._movingAnchorName==="middle-left")this.findOne(".top-left").x(K.x());else if(this._movingAnchorName==="middle-right")this.findOne(".bottom-right").x(K.x());else if(this._movingAnchorName==="bottom-left"){if(q){const Q=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-right").x(),y:this.findOne(".top-right").y()};U=Math.sqrt(Math.pow(Q.x-K.x(),2)+Math.pow(K.y()-Q.y,2));const X=Q.x<K.x()?-1:1,se=K.y()<Q.y?-1:1;M=U*this.cos*X,I=U*this.sin*se,K.x(Q.x-M),K.y(Q.y+I)}R=K.position(),this.findOne(".top-left").x(R.x),this.findOne(".bottom-right").y(R.y)}else if(this._movingAnchorName==="bottom-center")this.findOne(".bottom-right").y(K.y());else if(this._movingAnchorName==="bottom-right"){if(q){const Q=H?{x:this.width()/2,y:this.height()/2}:{x:this.findOne(".top-left").x(),y:this.findOne(".top-left").y()};U=Math.sqrt(Math.pow(K.x()-Q.x,2)+Math.pow(K.y()-Q.y,2));const X=this.findOne(".bottom-right").x()<Q.x?-1:1,se=this.findOne(".bottom-right").y()<Q.y?-1:1;M=U*this.cos*X,I=U*this.sin*se,this.findOne(".bottom-right").x(Q.x+M),this.findOne(".bottom-right").y(Q.y+I)}}else console.error(new Error("Wrong position argument of selection resizer: "+this._movingAnchorName));if(H=this.centeredScaling()||P.altKey,H){const Q=this.findOne(".top-left"),X=this.findOne(".bottom-right"),se=Q.x(),le=Q.y(),he=this.getWidth()-X.x(),we=this.getHeight()-X.y();X.move({x:-se,y:-le}),Q.move({x:he,y:we})}const L=this.findOne(".top-left").getAbsolutePosition();M=L.x,I=L.y;const G=this.findOne(".bottom-right").x()-this.findOne(".top-left").x(),W=this.findOne(".bottom-right").y()-this.findOne(".top-left").y();this._fitNodesInto({x:M,y:I,width:G,height:W,rotation:i.Konva.getAngle(this.rotation())},P)}_handleMouseUp(P){this._removeEvents(P)}getAbsoluteTransform(){return this.getTransform()}_removeEvents(P){var M;if(this._transforming){this._transforming=!1,typeof window<"u"&&(window.removeEventListener("mousemove",this._handleMouseMove),window.removeEventListener("touchmove",this._handleMouseMove),window.removeEventListener("mouseup",this._handleMouseUp,!0),window.removeEventListener("touchend",this._handleMouseUp,!0));const I=this.getNode();N--,this._fire("transformend",{evt:P,target:I}),(M=this.getLayer())===null||M===void 0||M.batchDraw(),I&&this._nodes.forEach(U=>{var K;U._fire("transformend",{evt:P,target:U}),(K=U.getLayer())===null||K===void 0||K.batchDraw()}),this._movingAnchorName=null}}_fitNodesInto(P,M){const I=this._getNodeRect(),U=1;if(e.Util._inRange(P.width,-this.padding()*2-U,U)){this.update();return}if(e.Util._inRange(P.height,-this.padding()*2-U,U)){this.update();return}const K=new e.Transform;if(K.rotate(i.Konva.getAngle(this.rotation())),this._movingAnchorName&&P.width<0&&this._movingAnchorName.indexOf("left")>=0){const q=K.point({x:-this.padding()*2,y:0});P.x+=q.x,P.y+=q.y,P.width+=this.padding()*2,this._movingAnchorName=this._movingAnchorName.replace("left","right"),this._anchorDragOffset.x-=q.x,this._anchorDragOffset.y-=q.y}else if(this._movingAnchorName&&P.width<0&&this._movingAnchorName.indexOf("right")>=0){const q=K.point({x:this.padding()*2,y:0});this._movingAnchorName=this._movingAnchorName.replace("right","left"),this._anchorDragOffset.x-=q.x,this._anchorDragOffset.y-=q.y,P.width+=this.padding()*2}if(this._movingAnchorName&&P.height<0&&this._movingAnchorName.indexOf("top")>=0){const q=K.point({x:0,y:-this.padding()*2});P.x+=q.x,P.y+=q.y,this._movingAnchorName=this._movingAnchorName.replace("top","bottom"),this._anchorDragOffset.x-=q.x,this._anchorDragOffset.y-=q.y,P.height+=this.padding()*2}else if(this._movingAnchorName&&P.height<0&&this._movingAnchorName.indexOf("bottom")>=0){const q=K.point({x:0,y:this.padding()*2});this._movingAnchorName=this._movingAnchorName.replace("bottom","top"),this._anchorDragOffset.x-=q.x,this._anchorDragOffset.y-=q.y,P.height+=this.padding()*2}if(this.boundBoxFunc()){const q=this.boundBoxFunc()(I,P);q?P=q:e.Util.warn("boundBoxFunc returned falsy. You should return new bound rect from it!")}const te=1e7,re=new e.Transform;re.translate(I.x,I.y),re.rotate(I.rotation),re.scale(I.width/te,I.height/te);const Z=new e.Transform,B=P.width/te,J=P.height/te;this.flipEnabled()===!1?(Z.translate(P.x,P.y),Z.rotate(P.rotation),Z.translate(P.width<0?P.width:0,P.height<0?P.height:0),Z.scale(Math.abs(B),Math.abs(J))):(Z.translate(P.x,P.y),Z.rotate(P.rotation),Z.scale(B,J));const z=Z.multiply(re.invert());this._nodes.forEach(q=>{var H;const R=q.getParent().getAbsoluteTransform(),L=q.getTransform().copy();L.translate(q.offsetX(),q.offsetY());const G=new e.Transform;G.multiply(R.copy().invert()).multiply(z).multiply(R).multiply(L);const W=G.decompose();q.setAttrs(W),(H=q.getLayer())===null||H===void 0||H.batchDraw()}),this.rotation(e.Util._getRotation(P.rotation)),this._nodes.forEach(q=>{this._fire("transform",{evt:M,target:q}),q._fire("transform",{evt:M,target:q})}),this._resetTransformCache(),this.update(),this.getLayer().batchDraw()}forceUpdate(){this._resetTransformCache(),this.update()}_batchChangeChild(P,M){this.findOne(P).setAttrs(M)}update(){var P;const M=this._getNodeRect();this.rotation(e.Util._getRotation(M.rotation));const I=M.width,U=M.height,K=this.enabledAnchors(),te=this.resizeEnabled(),re=this.padding(),Z=this.anchorSize(),B=this.find("._anchor");B.forEach(z=>{z.setAttrs({width:Z,height:Z,offsetX:Z/2,offsetY:Z/2,stroke:this.anchorStroke(),strokeWidth:this.anchorStrokeWidth(),fill:this.anchorFill(),cornerRadius:this.anchorCornerRadius()})}),this._batchChangeChild(".top-left",{x:0,y:0,offsetX:Z/2+re,offsetY:Z/2+re,visible:te&&K.indexOf("top-left")>=0}),this._batchChangeChild(".top-center",{x:I/2,y:0,offsetY:Z/2+re,visible:te&&K.indexOf("top-center")>=0}),this._batchChangeChild(".top-right",{x:I,y:0,offsetX:Z/2-re,offsetY:Z/2+re,visible:te&&K.indexOf("top-right")>=0}),this._batchChangeChild(".middle-left",{x:0,y:U/2,offsetX:Z/2+re,visible:te&&K.indexOf("middle-left")>=0}),this._batchChangeChild(".middle-right",{x:I,y:U/2,offsetX:Z/2-re,visible:te&&K.indexOf("middle-right")>=0}),this._batchChangeChild(".bottom-left",{x:0,y:U,offsetX:Z/2+re,offsetY:Z/2-re,visible:te&&K.indexOf("bottom-left")>=0}),this._batchChangeChild(".bottom-center",{x:I/2,y:U,offsetY:Z/2-re,visible:te&&K.indexOf("bottom-center")>=0}),this._batchChangeChild(".bottom-right",{x:I,y:U,offsetX:Z/2-re,offsetY:Z/2-re,visible:te&&K.indexOf("bottom-right")>=0}),this._batchChangeChild(".rotater",{x:I/2,y:-this.rotateAnchorOffset()*e.Util._sign(U)-re,visible:this.rotateEnabled()}),this._batchChangeChild(".back",{width:I,height:U,visible:this.borderEnabled(),stroke:this.borderStroke(),strokeWidth:this.borderStrokeWidth(),dash:this.borderDash(),x:0,y:0});const J=this.anchorStyleFunc();J&&B.forEach(z=>{J(z)}),(P=this.getLayer())===null||P===void 0||P.batchDraw()}isTransforming(){return this._transforming}stopTransform(){if(this._transforming){this._removeEvents();const P=this.findOne("."+this._movingAnchorName);P&&P.stopDrag()}}destroy(){return this.getStage()&&this._cursorChange&&this.getStage().content&&(this.getStage().content.style.cursor=""),a.Group.prototype.destroy.call(this),this.detach(),this._removeEvents(),this}toObject(){return r.Node.prototype.toObject.call(this)}clone(P){return r.Node.prototype.clone.call(this,P)}getClientRect(){return this.nodes().length>0?super.getClientRect():{x:0,y:0,width:0,height:0}}}_y.Transformer=E,E.isTransforming=()=>N>0;function F(j){return j instanceof Array||e.Util.warn("enabledAnchors value should be an array"),j instanceof Array&&j.forEach(function(P){v.indexOf(P)===-1&&e.Util.warn("Unknown anchor name: "+P+". Available names are: "+v.join(", "))}),j||[]}return E.prototype.className="Transformer",(0,c._registerNode)(E),t.Factory.addGetterSetter(E,"enabledAnchors",v,F),t.Factory.addGetterSetter(E,"flipEnabled",!0,(0,o.getBooleanValidator)()),t.Factory.addGetterSetter(E,"resizeEnabled",!0),t.Factory.addGetterSetter(E,"anchorSize",10,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"rotateEnabled",!0),t.Factory.addGetterSetter(E,"rotateLineVisible",!0),t.Factory.addGetterSetter(E,"rotationSnaps",[]),t.Factory.addGetterSetter(E,"rotateAnchorOffset",50,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"rotateAnchorCursor","crosshair"),t.Factory.addGetterSetter(E,"rotationSnapTolerance",5,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"borderEnabled",!0),t.Factory.addGetterSetter(E,"anchorStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(E,"anchorStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"anchorFill","white"),t.Factory.addGetterSetter(E,"anchorCornerRadius",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"borderStroke","rgb(0, 161, 255)"),t.Factory.addGetterSetter(E,"borderStrokeWidth",1,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"borderDash"),t.Factory.addGetterSetter(E,"keepRatio",!0),t.Factory.addGetterSetter(E,"shiftBehavior","default"),t.Factory.addGetterSetter(E,"centeredScaling",!1),t.Factory.addGetterSetter(E,"ignoreStroke",!1),t.Factory.addGetterSetter(E,"padding",0,(0,o.getNumberValidator)()),t.Factory.addGetterSetter(E,"nodes"),t.Factory.addGetterSetter(E,"node"),t.Factory.addGetterSetter(E,"boundBoxFunc"),t.Factory.addGetterSetter(E,"anchorDragBoundFunc"),t.Factory.addGetterSetter(E,"anchorStyleFunc"),t.Factory.addGetterSetter(E,"shouldOverdrawWholeArea",!1),t.Factory.addGetterSetter(E,"useSingleNodeRotation",!0),t.Factory.backCompat(E,{lineEnabled:"borderEnabled",rotateHandlerOffset:"rotateAnchorOffset",enabledHandlers:"enabledAnchors"}),_y}var Sy={},sM;function Wle(){if(sM)return Sy;sM=1,Object.defineProperty(Sy,"__esModule",{value:!0}),Sy.Wedge=void 0;const e=Bn(),t=Oi(),r=Rn(),n=Un(),s=Rn();class a extends t.Shape{_sceneFunc(o){o.beginPath(),o.arc(0,0,this.radius(),0,r.Konva.getAngle(this.angle()),this.clockwise()),o.lineTo(0,0),o.closePath(),o.fillStrokeShape(this)}getWidth(){return this.radius()*2}getHeight(){return this.radius()*2}setWidth(o){this.radius(o/2)}setHeight(o){this.radius(o/2)}}return Sy.Wedge=a,a.prototype.className="Wedge",a.prototype._centroid=!0,a.prototype._attrsAffectingSize=["radius"],(0,s._registerNode)(a),e.Factory.addGetterSetter(a,"radius",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"angle",0,(0,n.getNumberValidator)()),e.Factory.addGetterSetter(a,"clockwise",!1),e.Factory.backCompat(a,{angleDeg:"angle",getAngleDeg:"getAngle",setAngleDeg:"setAngle"}),Sy}var ky={},aM;function Hle(){if(aM)return ky;aM=1,Object.defineProperty(ky,"__esModule",{value:!0}),ky.Blur=void 0;const e=Bn(),t=$a(),r=Un();function n(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const s=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],a=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function i(c,u){const d=c.data,f=c.width,h=c.height;let g,p,x,v,C,b,_,T,N,E,F,j,P,M,I,U,K,te,re,Z;const B=u+u+1,J=f-1,z=h-1,q=u+1,H=q*(q+1)/2,R=new n,L=s[u],G=a[u];let W=null,Q=R,X=null,se=null;for(let le=1;le<B;le++)Q=Q.next=new n,le===q&&(W=Q);Q.next=R,x=p=0;for(let le=0;le<h;le++){j=P=M=I=v=C=b=_=0,T=q*(U=d[p]),N=q*(K=d[p+1]),E=q*(te=d[p+2]),F=q*(re=d[p+3]),v+=H*U,C+=H*K,b+=H*te,_+=H*re,Q=R;for(let he=0;he<q;he++)Q.r=U,Q.g=K,Q.b=te,Q.a=re,Q=Q.next;for(let he=1;he<q;he++)g=p+((J<he?J:he)<<2),v+=(Q.r=U=d[g])*(Z=q-he),C+=(Q.g=K=d[g+1])*Z,b+=(Q.b=te=d[g+2])*Z,_+=(Q.a=re=d[g+3])*Z,j+=U,P+=K,M+=te,I+=re,Q=Q.next;X=R,se=W;for(let he=0;he<f;he++)d[p+3]=re=_*L>>G,re!==0?(re=255/re,d[p]=(v*L>>G)*re,d[p+1]=(C*L>>G)*re,d[p+2]=(b*L>>G)*re):d[p]=d[p+1]=d[p+2]=0,v-=T,C-=N,b-=E,_-=F,T-=X.r,N-=X.g,E-=X.b,F-=X.a,g=x+((g=he+u+1)<J?g:J)<<2,j+=X.r=d[g],P+=X.g=d[g+1],M+=X.b=d[g+2],I+=X.a=d[g+3],v+=j,C+=P,b+=M,_+=I,X=X.next,T+=U=se.r,N+=K=se.g,E+=te=se.b,F+=re=se.a,j-=U,P-=K,M-=te,I-=re,se=se.next,p+=4;x+=f}for(let le=0;le<f;le++){P=M=I=j=C=b=_=v=0,p=le<<2,T=q*(U=d[p]),N=q*(K=d[p+1]),E=q*(te=d[p+2]),F=q*(re=d[p+3]),v+=H*U,C+=H*K,b+=H*te,_+=H*re,Q=R;for(let we=0;we<q;we++)Q.r=U,Q.g=K,Q.b=te,Q.a=re,Q=Q.next;let he=f;for(let we=1;we<=u;we++)p=he+le<<2,v+=(Q.r=U=d[p])*(Z=q-we),C+=(Q.g=K=d[p+1])*Z,b+=(Q.b=te=d[p+2])*Z,_+=(Q.a=re=d[p+3])*Z,j+=U,P+=K,M+=te,I+=re,Q=Q.next,we<z&&(he+=f);p=le,X=R,se=W;for(let we=0;we<h;we++)g=p<<2,d[g+3]=re=_*L>>G,re>0?(re=255/re,d[g]=(v*L>>G)*re,d[g+1]=(C*L>>G)*re,d[g+2]=(b*L>>G)*re):d[g]=d[g+1]=d[g+2]=0,v-=T,C-=N,b-=E,_-=F,T-=X.r,N-=X.g,E-=X.b,F-=X.a,g=le+((g=we+q)<z?g:z)*f<<2,v+=j+=X.r=d[g],C+=P+=X.g=d[g+1],b+=M+=X.b=d[g+2],_+=I+=X.a=d[g+3],X=X.next,T+=U=se.r,N+=K=se.g,E+=te=se.b,F+=re=se.a,j-=U,P-=K,M-=te,I-=re,se=se.next,p+=f}}const o=function(u){const d=Math.round(this.blurRadius());d>0&&i(u,d)};return ky.Blur=o,e.Factory.addGetterSetter(t.Node,"blurRadius",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),ky}var Cy={},iM;function Gle(){if(iM)return Cy;iM=1,Object.defineProperty(Cy,"__esModule",{value:!0}),Cy.Brighten=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=this.brightness()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=4)i[c]+=a,i[c+1]+=a,i[c+2]+=a};return Cy.Brighten=n,e.Factory.addGetterSetter(t.Node,"brightness",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Cy}var Ty={},oM;function Vle(){if(oM)return Ty;oM=1,Object.defineProperty(Ty,"__esModule",{value:!0}),Ty.Contrast=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=Math.pow((this.contrast()+100)/100,2),i=s.data,o=i.length;let c=150,u=150,d=150;for(let f=0;f<o;f+=4)c=i[f],u=i[f+1],d=i[f+2],c/=255,c-=.5,c*=a,c+=.5,c*=255,u/=255,u-=.5,u*=a,u+=.5,u*=255,d/=255,d-=.5,d*=a,d+=.5,d*=255,c=c<0?0:c>255?255:c,u=u<0?0:u>255?255:u,d=d<0?0:d>255?255:d,i[f]=c,i[f+1]=u,i[f+2]=d};return Ty.Contrast=n,e.Factory.addGetterSetter(t.Node,"contrast",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ty}var Ny={},lM;function qle(){if(lM)return Ny;lM=1,Object.defineProperty(Ny,"__esModule",{value:!0}),Ny.Emboss=void 0;const e=Bn(),t=$a(),r=Ca(),n=Un(),s=function(a){const i=this.embossStrength()*10,o=this.embossWhiteLevel()*255,c=this.embossDirection(),u=this.embossBlend(),d=a.data,f=a.width,h=a.height,g=f*4;let p=0,x=0,v=h;switch(c){case"top-left":p=-1,x=-1;break;case"top":p=-1,x=0;break;case"top-right":p=-1,x=1;break;case"right":p=0,x=1;break;case"bottom-right":p=1,x=1;break;case"bottom":p=1,x=0;break;case"bottom-left":p=1,x=-1;break;case"left":p=0,x=-1;break;default:r.Util.error("Unknown emboss direction: "+c)}do{const C=(v-1)*g;let b=p;v+b<1&&(b=0),v+b>h&&(b=0);const _=(v-1+b)*f*4;let T=f;do{const N=C+(T-1)*4;let E=x;T+E<1&&(E=0),T+E>f&&(E=0);const F=_+(T-1+E)*4,j=d[N]-d[F],P=d[N+1]-d[F+1],M=d[N+2]-d[F+2];let I=j;const U=I>0?I:-I,K=P>0?P:-P,te=M>0?M:-M;if(K>U&&(I=P),te>U&&(I=M),I*=i,u){const re=d[N]+I,Z=d[N+1]+I,B=d[N+2]+I;d[N]=re>255?255:re<0?0:re,d[N+1]=Z>255?255:Z<0?0:Z,d[N+2]=B>255?255:B<0?0:B}else{let re=o-I;re<0?re=0:re>255&&(re=255),d[N]=d[N+1]=d[N+2]=re}}while(--T)}while(--v)};return Ny.Emboss=s,e.Factory.addGetterSetter(t.Node,"embossStrength",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossWhiteLevel",.5,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossDirection","top-left",void 0,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"embossBlend",!1,void 0,e.Factory.afterSetFilter),Ny}var Ey={},cM;function Kle(){if(cM)return Ey;cM=1,Object.defineProperty(Ey,"__esModule",{value:!0}),Ey.Enhance=void 0;const e=Bn(),t=$a(),r=Un();function n(a,i,o,c,u){const d=o-i,f=u-c;if(d===0)return c+f/2;if(f===0)return c;let h=(a-i)/d;return h=f*h+c,h}const s=function(a){const i=a.data,o=i.length;let c=i[0],u=c,d,f=i[1],h=f,g,p=i[2],x=p,v;const C=this.enhance();if(C===0)return;for(let j=0;j<o;j+=4)d=i[j+0],d<c?c=d:d>u&&(u=d),g=i[j+1],g<f?f=g:g>h&&(h=g),v=i[j+2],v<p?p=v:v>x&&(x=v);u===c&&(u=255,c=0),h===f&&(h=255,f=0),x===p&&(x=255,p=0);let b,_,T,N,E,F;if(C>0)b=u+C*(255-u),_=c-C*(c-0),T=h+C*(255-h),N=f-C*(f-0),E=x+C*(255-x),F=p-C*(p-0);else{const j=(u+c)*.5;b=u+C*(u-j),_=c+C*(c-j);const P=(h+f)*.5;T=h+C*(h-P),N=f+C*(f-P);const M=(x+p)*.5;E=x+C*(x-M),F=p+C*(p-M)}for(let j=0;j<o;j+=4)i[j+0]=n(i[j+0],c,u,_,b),i[j+1]=n(i[j+1],f,h,N,T),i[j+2]=n(i[j+2],p,x,F,E)};return Ey.Enhance=s,e.Factory.addGetterSetter(t.Node,"enhance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ey}var Ay={},uM;function Yle(){if(uM)return Ay;uM=1,Object.defineProperty(Ay,"__esModule",{value:!0}),Ay.Grayscale=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=.34*r[s]+.5*r[s+1]+.16*r[s+2];r[s]=a,r[s+1]=a,r[s+2]=a}};return Ay.Grayscale=e,Ay}var jy={},dM;function Xle(){if(dM)return jy;dM=1,Object.defineProperty(jy,"__esModule",{value:!0}),jy.HSL=void 0;const e=Bn(),t=$a(),r=Un();e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"luminance",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter);const n=function(s){const a=s.data,i=a.length,o=1,c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=this.luminance()*127,f=o*c*Math.cos(u*Math.PI/180),h=o*c*Math.sin(u*Math.PI/180),g=.299*o+.701*f+.167*h,p=.587*o-.587*f+.33*h,x=.114*o-.114*f-.497*h,v=.299*o-.299*f-.328*h,C=.587*o+.413*f+.035*h,b=.114*o-.114*f+.293*h,_=.299*o-.3*f+1.25*h,T=.587*o-.586*f-1.05*h,N=.114*o+.886*f-.2*h;let E,F,j,P;for(let M=0;M<i;M+=4)E=a[M+0],F=a[M+1],j=a[M+2],P=a[M+3],a[M+0]=g*E+p*F+x*j+d,a[M+1]=v*E+C*F+b*j+d,a[M+2]=_*E+T*F+N*j+d,a[M+3]=P};return jy.HSL=n,jy}var Py={},fM;function Jle(){if(fM)return Py;fM=1,Object.defineProperty(Py,"__esModule",{value:!0}),Py.HSV=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=s.data,i=a.length,o=Math.pow(2,this.value()),c=Math.pow(2,this.saturation()),u=Math.abs(this.hue()+360)%360,d=o*c*Math.cos(u*Math.PI/180),f=o*c*Math.sin(u*Math.PI/180),h=.299*o+.701*d+.167*f,g=.587*o-.587*d+.33*f,p=.114*o-.114*d-.497*f,x=.299*o-.299*d-.328*f,v=.587*o+.413*d+.035*f,C=.114*o-.114*d+.293*f,b=.299*o-.3*d+1.25*f,_=.587*o-.586*d-1.05*f,T=.114*o+.886*d-.2*f;for(let N=0;N<i;N+=4){const E=a[N+0],F=a[N+1],j=a[N+2],P=a[N+3];a[N+0]=h*E+g*F+p*j,a[N+1]=x*E+v*F+C*j,a[N+2]=b*E+_*F+T*j,a[N+3]=P}};return Py.HSV=n,e.Factory.addGetterSetter(t.Node,"hue",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"saturation",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"value",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Py}var Fy={},hM;function Qle(){if(hM)return Fy;hM=1,Object.defineProperty(Fy,"__esModule",{value:!0}),Fy.Invert=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4)r[s]=255-r[s],r[s+1]=255-r[s+1],r[s+2]=255-r[s+2]};return Fy.Invert=e,Fy}var My={},mM;function Zle(){if(mM)return My;mM=1,Object.defineProperty(My,"__esModule",{value:!0}),My.Kaleidoscope=void 0;const e=Bn(),t=$a(),r=Ca(),n=Un(),s=function(o,c,u){const d=o.data,f=c.data,h=o.width,g=o.height,p=u.polarCenterX||h/2,x=u.polarCenterY||g/2;let v=Math.sqrt(p*p+x*x),C=h-p,b=g-x;const _=Math.sqrt(C*C+b*b);v=_>v?_:v;const T=g,N=h,E=360/N*Math.PI/180;for(let F=0;F<N;F+=1){const j=Math.sin(F*E),P=Math.cos(F*E);for(let M=0;M<T;M+=1){C=Math.floor(p+v*M/T*P),b=Math.floor(x+v*M/T*j);let I=(b*h+C)*4;const U=d[I+0],K=d[I+1],te=d[I+2],re=d[I+3];I=(F+M*h)*4,f[I+0]=U,f[I+1]=K,f[I+2]=te,f[I+3]=re}}},a=function(o,c,u){const d=o.data,f=c.data,h=o.width,g=o.height,p=u.polarCenterX||h/2,x=u.polarCenterY||g/2;let v=Math.sqrt(p*p+x*x),C=h-p,b=g-x;const _=Math.sqrt(C*C+b*b);v=_>v?_:v;const T=g,N=h,E=0;let F,j;for(C=0;C<h;C+=1)for(b=0;b<g;b+=1){const P=C-p,M=b-x,I=Math.sqrt(P*P+M*M)*T/v;let U=(Math.atan2(M,P)*180/Math.PI+360+E)%360;U=U*N/360,F=Math.floor(U),j=Math.floor(I);let K=(j*h+F)*4;const te=d[K+0],re=d[K+1],Z=d[K+2],B=d[K+3];K=(b*h+C)*4,f[K+0]=te,f[K+1]=re,f[K+2]=Z,f[K+3]=B}},i=function(o){const c=o.width,u=o.height;let d,f,h,g,p,x,v,C,b,_,T=Math.round(this.kaleidoscopePower());const N=Math.round(this.kaleidoscopeAngle()),E=Math.floor(c*(N%360)/360);if(T<1)return;const F=r.Util.createCanvasElement();F.width=c,F.height=u;const j=F.getContext("2d").getImageData(0,0,c,u);r.Util.releaseCanvas(F),s(o,j,{polarCenterX:c/2,polarCenterY:u/2});let P=c/Math.pow(2,T);for(;P<=8;)P=P*2,T-=1;P=Math.ceil(P);let M=P,I=0,U=M,K=1;for(E+P>c&&(I=M,U=0,K=-1),f=0;f<u;f+=1)for(d=I;d!==U;d+=K)h=Math.round(d+E)%c,b=(c*f+h)*4,p=j.data[b+0],x=j.data[b+1],v=j.data[b+2],C=j.data[b+3],_=(c*f+d)*4,j.data[_+0]=p,j.data[_+1]=x,j.data[_+2]=v,j.data[_+3]=C;for(f=0;f<u;f+=1)for(M=Math.floor(P),g=0;g<T;g+=1){for(d=0;d<M+1;d+=1)b=(c*f+d)*4,p=j.data[b+0],x=j.data[b+1],v=j.data[b+2],C=j.data[b+3],_=(c*f+M*2-d-1)*4,j.data[_+0]=p,j.data[_+1]=x,j.data[_+2]=v,j.data[_+3]=C;M*=2}a(j,o,{})};return My.Kaleidoscope=i,e.Factory.addGetterSetter(t.Node,"kaleidoscopePower",2,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"kaleidoscopeAngle",0,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),My}var Ry={},gM;function ece(){if(gM)return Ry;gM=1,Object.defineProperty(Ry,"__esModule",{value:!0}),Ry.Mask=void 0;const e=Bn(),t=$a(),r=Un();function n(h,g,p){let x=(p*h.width+g)*4;const v=[];return v.push(h.data[x++],h.data[x++],h.data[x++],h.data[x++]),v}function s(h,g){return Math.sqrt(Math.pow(h[0]-g[0],2)+Math.pow(h[1]-g[1],2)+Math.pow(h[2]-g[2],2))}function a(h){const g=[0,0,0];for(let p=0;p<h.length;p++)g[0]+=h[p][0],g[1]+=h[p][1],g[2]+=h[p][2];return g[0]/=h.length,g[1]/=h.length,g[2]/=h.length,g}function i(h,g){const p=n(h,0,0),x=n(h,h.width-1,0),v=n(h,0,h.height-1),C=n(h,h.width-1,h.height-1),b=g||10;if(s(p,x)<b&&s(x,C)<b&&s(C,v)<b&&s(v,p)<b){const _=a([x,p,C,v]),T=[];for(let N=0;N<h.width*h.height;N++){const E=s(_,[h.data[N*4],h.data[N*4+1],h.data[N*4+2]]);T[N]=E<b?0:255}return T}}function o(h,g){for(let p=0;p<h.width*h.height;p++)h.data[4*p+3]=g[p]}function c(h,g,p){const x=[1,1,1,1,0,1,1,1,1],v=Math.round(Math.sqrt(x.length)),C=Math.floor(v/2),b=[];for(let _=0;_<p;_++)for(let T=0;T<g;T++){const N=_*g+T;let E=0;for(let F=0;F<v;F++)for(let j=0;j<v;j++){const P=_+F-C,M=T+j-C;if(P>=0&&P<p&&M>=0&&M<g){const I=P*g+M,U=x[F*v+j];E+=h[I]*U}}b[N]=E===2040?255:0}return b}function u(h,g,p){const x=[1,1,1,1,1,1,1,1,1],v=Math.round(Math.sqrt(x.length)),C=Math.floor(v/2),b=[];for(let _=0;_<p;_++)for(let T=0;T<g;T++){const N=_*g+T;let E=0;for(let F=0;F<v;F++)for(let j=0;j<v;j++){const P=_+F-C,M=T+j-C;if(P>=0&&P<p&&M>=0&&M<g){const I=P*g+M,U=x[F*v+j];E+=h[I]*U}}b[N]=E>=1020?255:0}return b}function d(h,g,p){const x=[.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111,.1111111111111111],v=Math.round(Math.sqrt(x.length)),C=Math.floor(v/2),b=[];for(let _=0;_<p;_++)for(let T=0;T<g;T++){const N=_*g+T;let E=0;for(let F=0;F<v;F++)for(let j=0;j<v;j++){const P=_+F-C,M=T+j-C;if(P>=0&&P<p&&M>=0&&M<g){const I=P*g+M,U=x[F*v+j];E+=h[I]*U}}b[N]=E}return b}const f=function(h){const g=this.threshold();let p=i(h,g);return p&&(p=c(p,h.width,h.height),p=u(p,h.width,h.height),p=d(p,h.width,h.height),o(h,p)),h};return Ry.Mask=f,e.Factory.addGetterSetter(t.Node,"threshold",0,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Ry}var Oy={},pM;function tce(){if(pM)return Oy;pM=1,Object.defineProperty(Oy,"__esModule",{value:!0}),Oy.Noise=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=this.noise()*255,i=s.data,o=i.length,c=a/2;for(let u=0;u<o;u+=4)i[u+0]+=c-2*c*Math.random(),i[u+1]+=c-2*c*Math.random(),i[u+2]+=c-2*c*Math.random()};return Oy.Noise=n,e.Factory.addGetterSetter(t.Node,"noise",.2,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Oy}var Dy={},xM;function rce(){if(xM)return Dy;xM=1,Object.defineProperty(Dy,"__esModule",{value:!0}),Dy.Pixelate=void 0;const e=Bn(),t=Ca(),r=$a(),n=Un(),s=function(a){let i=Math.ceil(this.pixelSize()),o=a.width,c=a.height,u=Math.ceil(o/i),d=Math.ceil(c/i),f=a.data;if(i<=0){t.Util.error("pixelSize value can not be <= 0");return}for(let h=0;h<u;h+=1)for(let g=0;g<d;g+=1){let p=0,x=0,v=0,C=0;const b=h*i,_=b+i,T=g*i,N=T+i;let E=0;for(let F=b;F<_;F+=1)if(!(F>=o))for(let j=T;j<N;j+=1){if(j>=c)continue;const P=(o*j+F)*4;p+=f[P+0],x+=f[P+1],v+=f[P+2],C+=f[P+3],E+=1}p=p/E,x=x/E,v=v/E,C=C/E;for(let F=b;F<_;F+=1)if(!(F>=o))for(let j=T;j<N;j+=1){if(j>=c)continue;const P=(o*j+F)*4;f[P+0]=p,f[P+1]=x,f[P+2]=v,f[P+3]=C}}};return Dy.Pixelate=s,e.Factory.addGetterSetter(r.Node,"pixelSize",8,(0,n.getNumberValidator)(),e.Factory.afterSetFilter),Dy}var Iy={},yM;function nce(){if(yM)return Iy;yM=1,Object.defineProperty(Iy,"__esModule",{value:!0}),Iy.Posterize=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=Math.round(this.levels()*254)+1,i=s.data,o=i.length,c=255/a;for(let u=0;u<o;u+=1)i[u]=Math.floor(i[u]/c)*c};return Iy.Posterize=n,e.Factory.addGetterSetter(t.Node,"levels",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),Iy}var Ly={},vM;function sce(){if(vM)return Ly;vM=1,Object.defineProperty(Ly,"__esModule",{value:!0}),Ly.RGB=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue();for(let d=0;d<i;d+=4){const f=(.34*a[d]+.5*a[d+1]+.16*a[d+2])/255;a[d]=f*o,a[d+1]=f*c,a[d+2]=f*u,a[d+3]=a[d+3]}};return Ly.RGB=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),Ly}var By={},bM;function ace(){if(bM)return By;bM=1,Object.defineProperty(By,"__esModule",{value:!0}),By.RGBA=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=s.data,i=a.length,o=this.red(),c=this.green(),u=this.blue(),d=this.alpha();for(let f=0;f<i;f+=4){const h=1-d;a[f]=o*d+a[f]*h,a[f+1]=c*d+a[f+1]*h,a[f+2]=u*d+a[f+2]*h}};return By.RGBA=n,e.Factory.addGetterSetter(t.Node,"red",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"green",0,function(s){return this._filterUpToDate=!1,s>255?255:s<0?0:Math.round(s)}),e.Factory.addGetterSetter(t.Node,"blue",0,r.RGBComponent,e.Factory.afterSetFilter),e.Factory.addGetterSetter(t.Node,"alpha",1,function(s){return this._filterUpToDate=!1,s>1?1:s<0?0:s}),By}var $y={},wM;function ice(){if(wM)return $y;wM=1,Object.defineProperty($y,"__esModule",{value:!0}),$y.Sepia=void 0;const e=function(t){const r=t.data,n=r.length;for(let s=0;s<n;s+=4){const a=r[s+0],i=r[s+1],o=r[s+2];r[s+0]=Math.min(255,a*.393+i*.769+o*.189),r[s+1]=Math.min(255,a*.349+i*.686+o*.168),r[s+2]=Math.min(255,a*.272+i*.534+o*.131)}};return $y.Sepia=e,$y}var Uy={},_M;function oce(){if(_M)return Uy;_M=1,Object.defineProperty(Uy,"__esModule",{value:!0}),Uy.Solarize=void 0;const e=function(t){const r=t.data,n=t.width,s=t.height,a=n*4;let i=s;do{const o=(i-1)*a;let c=n;do{const u=o+(c-1)*4;let d=r[u],f=r[u+1],h=r[u+2];d>127&&(d=255-d),f>127&&(f=255-f),h>127&&(h=255-h),r[u]=d,r[u+1]=f,r[u+2]=h}while(--c)}while(--i)};return Uy.Solarize=e,Uy}var zy={},SM;function lce(){if(SM)return zy;SM=1,Object.defineProperty(zy,"__esModule",{value:!0}),zy.Threshold=void 0;const e=Bn(),t=$a(),r=Un(),n=function(s){const a=this.threshold()*255,i=s.data,o=i.length;for(let c=0;c<o;c+=1)i[c]=i[c]<a?0:255};return zy.Threshold=n,e.Factory.addGetterSetter(t.Node,"threshold",.5,(0,r.getNumberValidator)(),e.Factory.afterSetFilter),zy}var kM;function cce(){if(kM)return ry;kM=1,Object.defineProperty(ry,"__esModule",{value:!0}),ry.Konva=void 0;const e=AT(),t=jle(),r=Fle(),n=Mle(),s=Rle(),a=Ole(),i=Dle(),o=bH(),c=TN(),u=wH(),d=Ile(),f=Lle(),h=Ble(),g=$le(),p=_H(),x=Ule(),v=zle(),C=Wle(),b=Hle(),_=Gle(),T=Vle(),N=qle(),E=Kle(),F=Yle(),j=Xle(),P=Jle(),M=Qle(),I=Zle(),U=ece(),K=tce(),te=rce(),re=nce(),Z=sce(),B=ace(),J=ice(),z=oce(),q=lce();return ry.Konva=e.Konva.Util._assign(e.Konva,{Arc:t.Arc,Arrow:r.Arrow,Circle:n.Circle,Ellipse:s.Ellipse,Image:a.Image,Label:i.Label,Tag:i.Tag,Line:o.Line,Path:c.Path,Rect:u.Rect,RegularPolygon:d.RegularPolygon,Ring:f.Ring,Sprite:h.Sprite,Star:g.Star,Text:p.Text,TextPath:x.TextPath,Transformer:v.Transformer,Wedge:C.Wedge,Filters:{Blur:b.Blur,Brighten:_.Brighten,Contrast:T.Contrast,Emboss:N.Emboss,Enhance:E.Enhance,Grayscale:F.Grayscale,HSL:j.HSL,HSV:P.HSV,Invert:M.Invert,Kaleidoscope:I.Kaleidoscope,Mask:U.Mask,Noise:K.Noise,Pixelate:te.Pixelate,Posterize:re.Posterize,RGB:Z.RGB,RGBA:B.RGBA,Sepia:J.Sepia,Solarize:z.Solarize,Threshold:q.Threshold}}),ry}var uce=j4.exports,CM;function dce(){if(CM)return j4.exports;CM=1,Object.defineProperty(uce,"__esModule",{value:!0});const e=cce();return j4.exports=e.Konva,j4.exports}var SH=dce();const fce=ec(SH),hce=kU({__proto__:null,default:fce},[SH]);var Rw={exports:{}},TM;function mce(){return TM||(TM=1,(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var r=AT();Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return r.Konva}});const n=AT();e.exports=n.Konva})(Rw,Rw.exports)),Rw.exports}var gce=mce();const qv=ec(gce);var c6={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u6,NM;function pce(){return NM||(NM=1,u6=function(t){var r={},n=dg(),s=m7(),a=Object.assign;function i(S){for(var k="https://reactjs.org/docs/error-decoder.html?invariant="+S,O=1;O<arguments.length;O++)k+="&args[]="+encodeURIComponent(arguments[O]);return"Minified React error #"+S+"; visit "+k+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),u=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),f=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),p=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),v=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),b=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),N=Symbol.iterator;function E(S){return S===null||typeof S!="object"?null:(S=N&&S[N]||S["@@iterator"],typeof S=="function"?S:null)}function F(S){if(S==null)return null;if(typeof S=="function")return S.displayName||S.name||null;if(typeof S=="string")return S;switch(S){case d:return"Fragment";case u:return"Portal";case h:return"Profiler";case f:return"StrictMode";case v:return"Suspense";case C:return"SuspenseList"}if(typeof S=="object")switch(S.$$typeof){case p:return(S.displayName||"Context")+".Consumer";case g:return(S._context.displayName||"Context")+".Provider";case x:var k=S.render;return S=S.displayName,S||(S=k.displayName||k.name||"",S=S!==""?"ForwardRef("+S+")":"ForwardRef"),S;case b:return k=S.displayName||null,k!==null?k:F(S.type)||"Memo";case _:k=S._payload,S=S._init;try{return F(S(k))}catch{}}return null}function j(S){var k=S.type;switch(S.tag){case 24:return"Cache";case 9:return(k.displayName||"Context")+".Consumer";case 10:return(k._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return S=k.render,S=S.displayName||S.name||"",k.displayName||(S!==""?"ForwardRef("+S+")":"ForwardRef");case 7:return"Fragment";case 5:return k;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(k);case 8:return k===f?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof k=="function")return k.displayName||k.name||null;if(typeof k=="string")return k}return null}function P(S){var k=S,O=S;if(S.alternate)for(;k.return;)k=k.return;else{S=k;do k=S,(k.flags&4098)!==0&&(O=k.return),S=k.return;while(S)}return k.tag===3?O:null}function M(S){if(P(S)!==S)throw Error(i(188))}function I(S){var k=S.alternate;if(!k){if(k=P(S),k===null)throw Error(i(188));return k!==S?null:S}for(var O=S,V=k;;){var ee=O.return;if(ee===null)break;var ce=ee.alternate;if(ce===null){if(V=ee.return,V!==null){O=V;continue}break}if(ee.child===ce.child){for(ce=ee.child;ce;){if(ce===O)return M(ee),S;if(ce===V)return M(ee),k;ce=ce.sibling}throw Error(i(188))}if(O.return!==V.return)O=ee,V=ce;else{for(var je=!1,xt=ee.child;xt;){if(xt===O){je=!0,O=ee,V=ce;break}if(xt===V){je=!0,V=ee,O=ce;break}xt=xt.sibling}if(!je){for(xt=ce.child;xt;){if(xt===O){je=!0,O=ce,V=ee;break}if(xt===V){je=!0,V=ce,O=ee;break}xt=xt.sibling}if(!je)throw Error(i(189))}}if(O.alternate!==V)throw Error(i(190))}if(O.tag!==3)throw Error(i(188));return O.stateNode.current===O?S:k}function U(S){return S=I(S),S!==null?K(S):null}function K(S){if(S.tag===5||S.tag===6)return S;for(S=S.child;S!==null;){var k=K(S);if(k!==null)return k;S=S.sibling}return null}function te(S){if(S.tag===5||S.tag===6)return S;for(S=S.child;S!==null;){if(S.tag!==4){var k=te(S);if(k!==null)return k}S=S.sibling}return null}var re=Array.isArray,Z=t.getPublicInstance,B=t.getRootHostContext,J=t.getChildHostContext,z=t.prepareForCommit,q=t.resetAfterCommit,H=t.createInstance,R=t.appendInitialChild,L=t.finalizeInitialChildren,G=t.prepareUpdate,W=t.shouldSetTextContent,Q=t.createTextInstance,X=t.scheduleTimeout,se=t.cancelTimeout,le=t.noTimeout,he=t.isPrimaryRenderer,we=t.supportsMutation,ie=t.supportsPersistence,Ee=t.supportsHydration,ye=t.getInstanceFromNode,Ie=t.preparePortalMount,ut=t.getCurrentEventPriority,Qe=t.detachDeletedInstance,$t=t.supportsMicrotasks,Ge=t.scheduleMicrotask,et=t.supportsTestSelectors,vt=t.findFiberRoot,Te=t.getBoundingRect,Ve=t.getTextContent,pt=t.isHiddenSubtree,wt=t.matchAccessibilityRole,Ut=t.setFocusIfFocusable,ct=t.setupIntersectionObserver,yt=t.appendChild,rt=t.appendChildToContainer,Oe=t.commitTextUpdate,$e=t.commitMount,Mt=t.commitUpdate,It=t.insertBefore,At=t.insertInContainerBefore,tr=t.removeChild,ar=t.removeChildFromContainer,dr=t.resetTextContent,or=t.hideInstance,mr=t.hideTextInstance,ve=t.unhideInstance,Fe=t.unhideTextInstance,Be=t.clearContainer,Pe=t.cloneInstance,lt=t.createContainerChildSet,Ct=t.appendChildToContainerChildSet,Lt=t.finalizeContainerChildren,Ue=t.replaceContainerChildren,st=t.cloneHiddenInstance,dt=t.cloneHiddenTextInstance,Bt=t.canHydrateInstance,Yt=t.canHydrateTextInstance,xr=t.canHydrateSuspenseInstance,Rr=t.isSuspenseInstancePending,yr=t.isSuspenseInstanceFallback,Br=t.getSuspenseInstanceFallbackErrorDetails,me=t.registerSuspenseInstanceRetry,Ne=t.getNextHydratableSibling,be=t.getFirstHydratableChild,Ae=t.getFirstHydratableChildWithinContainer,ue=t.getFirstHydratableChildWithinSuspenseInstance,ge=t.hydrateInstance,Me=t.hydrateTextInstance,ot=t.hydrateSuspenseInstance,Je=t.getNextHydratableInstanceAfterSuspenseInstance,nt=t.commitHydratedContainer,mt=t.commitHydratedSuspenseInstance,de=t.clearSuspenseBoundary,Se=t.clearSuspenseBoundaryFromContainer,De=t.shouldDeleteUnhydratedTailInstances,Le=t.didNotMatchHydratedContainerTextInstance,tt=t.didNotMatchHydratedTextInstance,qt;function kr(S){if(qt===void 0)try{throw Error()}catch(O){var k=O.stack.trim().match(/\n( *(at )?)/);qt=k&&k[1]||""}return`
`+qt+S}var jr=!1;function _t(S,k){if(!S||jr)return"";jr=!0;var O=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(k)if(k=function(){throw Error()},Object.defineProperty(k.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(k,[])}catch(cr){var V=cr}Reflect.construct(S,[],k)}else{try{k.call()}catch(cr){V=cr}S.call(k.prototype)}else{try{throw Error()}catch(cr){V=cr}S()}}catch(cr){if(cr&&V&&typeof cr.stack=="string"){for(var ee=cr.stack.split(`
`),ce=V.stack.split(`
`),je=ee.length-1,xt=ce.length-1;1<=je&&0<=xt&&ee[je]!==ce[xt];)xt--;for(;1<=je&&0<=xt;je--,xt--)if(ee[je]!==ce[xt]){if(je!==1||xt!==1)do if(je--,xt--,0>xt||ee[je]!==ce[xt]){var Rt=`
`+ee[je].replace(" at new "," at ");return S.displayName&&Rt.includes("<anonymous>")&&(Rt=Rt.replace("<anonymous>",S.displayName)),Rt}while(1<=je&&0<=xt);break}}}finally{jr=!1,Error.prepareStackTrace=O}return(S=S?S.displayName||S.name:"")?kr(S):""}var ur=Object.prototype.hasOwnProperty,Gr=[],Mr=-1;function Tr(S){return{current:S}}function qr(S){0>Mr||(S.current=Gr[Mr],Gr[Mr]=null,Mr--)}function $r(S,k){Mr++,Gr[Mr]=S.current,S.current=k}var qn={},gr=Tr(qn),pn=Tr(!1),Zr=qn;function Zn(S,k){var O=S.type.contextTypes;if(!O)return qn;var V=S.stateNode;if(V&&V.__reactInternalMemoizedUnmaskedChildContext===k)return V.__reactInternalMemoizedMaskedChildContext;var ee={},ce;for(ce in O)ee[ce]=k[ce];return V&&(S=S.stateNode,S.__reactInternalMemoizedUnmaskedChildContext=k,S.__reactInternalMemoizedMaskedChildContext=ee),ee}function Fn(S){return S=S.childContextTypes,S!=null}function Ce(){qr(pn),qr(gr)}function Dt(S,k,O){if(gr.current!==qn)throw Error(i(168));$r(gr,k),$r(pn,O)}function Fr(S,k,O){var V=S.stateNode;if(k=k.childContextTypes,typeof V.getChildContext!="function")return O;V=V.getChildContext();for(var ee in V)if(!(ee in k))throw Error(i(108,j(S)||"Unknown",ee));return a({},O,V)}function Kr(S){return S=(S=S.stateNode)&&S.__reactInternalMemoizedMergedChildContext||qn,Zr=gr.current,$r(gr,S),$r(pn,pn.current),!0}function On(S,k,O){var V=S.stateNode;if(!V)throw Error(i(169));O?(S=Fr(S,k,Zr),V.__reactInternalMemoizedMergedChildContext=S,qr(pn),qr(gr),$r(gr,S)):qr(pn),$r(pn,O)}var Qr=Math.clz32?Math.clz32:yi,ns=Math.log,ta=Math.LN2;function yi(S){return S>>>=0,S===0?32:31-(ns(S)/ta|0)|0}var xn=64,Al=4194304;function sl(S){switch(S&-S){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return S&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return S&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return S}}function qe(S,k){var O=S.pendingLanes;if(O===0)return 0;var V=0,ee=S.suspendedLanes,ce=S.pingedLanes,je=O&268435455;if(je!==0){var xt=je&~ee;xt!==0?V=sl(xt):(ce&=je,ce!==0&&(V=sl(ce)))}else je=O&~ee,je!==0?V=sl(je):ce!==0&&(V=sl(ce));if(V===0)return 0;if(k!==0&&k!==V&&(k&ee)===0&&(ee=V&-V,ce=k&-k,ee>=ce||ee===16&&(ce&4194240)!==0))return k;if((V&4)!==0&&(V|=O&16),k=S.entangledLanes,k!==0)for(S=S.entanglements,k&=V;0<k;)O=31-Qr(k),ee=1<<O,V|=S[O],k&=~ee;return V}function Re(S,k){switch(S){case 1:case 2:case 4:return k+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return k+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ye(S,k){for(var O=S.suspendedLanes,V=S.pingedLanes,ee=S.expirationTimes,ce=S.pendingLanes;0<ce;){var je=31-Qr(ce),xt=1<<je,Rt=ee[je];Rt===-1?((xt&O)===0||(xt&V)!==0)&&(ee[je]=Re(xt,k)):Rt<=k&&(S.expiredLanes|=xt),ce&=~xt}}function Tt(S){return S=S.pendingLanes&-1073741825,S!==0?S:S&1073741824?1073741824:0}function St(){var S=xn;return xn<<=1,(xn&4194240)===0&&(xn=64),S}function Cr(S){for(var k=[],O=0;31>O;O++)k.push(S);return k}function jt(S,k,O){S.pendingLanes|=k,k!==536870912&&(S.suspendedLanes=0,S.pingedLanes=0),S=S.eventTimes,k=31-Qr(k),S[k]=O}function en(S,k){var O=S.pendingLanes&~k;S.pendingLanes=k,S.suspendedLanes=0,S.pingedLanes=0,S.expiredLanes&=k,S.mutableReadLanes&=k,S.entangledLanes&=k,k=S.entanglements;var V=S.eventTimes;for(S=S.expirationTimes;0<O;){var ee=31-Qr(O),ce=1<<ee;k[ee]=0,V[ee]=-1,S[ee]=-1,O&=~ce}}function Nn(S,k){var O=S.entangledLanes|=k;for(S=S.entanglements;O;){var V=31-Qr(O),ee=1<<V;ee&k|S[V]&k&&(S[V]|=k),O&=~ee}}var Xe=0;function br(S){return S&=-S,1<S?4<S?(S&268435455)!==0?16:536870912:4:1}var lr=s.unstable_scheduleCallback,_s=s.unstable_cancelCallback,_n=s.unstable_shouldYield,hn=s.unstable_requestPaint,Sn=s.unstable_now,jn=s.unstable_ImmediatePriority,sc=s.unstable_UserBlockingPriority,Li=s.unstable_NormalPriority,jh=s.unstable_IdlePriority,Nu=null,co=null;function V0(S){if(co&&typeof co.onCommitFiberRoot=="function")try{co.onCommitFiberRoot(Nu,S,void 0,(S.current.flags&128)===128)}catch{}}function Ag(S,k){return S===k&&(S!==0||1/S===1/k)||S!==S&&k!==k}var jl=typeof Object.is=="function"?Object.is:Ag,qc=null,q0=!1,K0=!1;function jg(S){qc===null?qc=[S]:qc.push(S)}function kb(S){q0=!0,jg(S)}function ri(){if(!K0&&qc!==null){K0=!0;var S=0,k=Xe;try{var O=qc;for(Xe=1;S<O.length;S++){var V=O[S];do V=V(!0);while(V!==null)}qc=null,q0=!1}catch(ee){throw qc!==null&&(qc=qc.slice(S+1)),lr(jn,ri),ee}finally{Xe=k,K0=!1}}return null}var Eu=[],Kc=0,Ph=null,Sd=0,Bi=[],Fo=0,Ta=null,uo=1,Pl="";function Fl(S,k){Eu[Kc++]=Sd,Eu[Kc++]=Ph,Ph=S,Sd=k}function Cb(S,k,O){Bi[Fo++]=uo,Bi[Fo++]=Pl,Bi[Fo++]=Ta,Ta=S;var V=uo;S=Pl;var ee=32-Qr(V)-1;V&=~(1<<ee),O+=1;var ce=32-Qr(k)+ee;if(30<ce){var je=ee-ee%5;ce=(V&(1<<je)-1).toString(32),V>>=je,ee-=je,uo=1<<32-Qr(k)+ee|O<<ee|V,Pl=ce+S}else uo=1<<ce|O<<ee|V,Pl=S}function Fh(S){S.return!==null&&(Fl(S,1),Cb(S,1,0))}function Mh(S){for(;S===Ph;)Ph=Eu[--Kc],Eu[Kc]=null,Sd=Eu[--Kc],Eu[Kc]=null;for(;S===Ta;)Ta=Bi[--Fo],Bi[Fo]=null,Pl=Bi[--Fo],Bi[Fo]=null,uo=Bi[--Fo],Bi[Fo]=null}var ni=null,$i=null,Ss=!1,Rh=!1,Ml=null;function Tb(S,k){var O=zo(5,null,null,0);O.elementType="DELETED",O.stateNode=k,O.return=S,k=S.deletions,k===null?(S.deletions=[O],S.flags|=16):k.push(O)}function Pg(S,k){switch(S.tag){case 5:return k=Bt(k,S.type,S.pendingProps),k!==null?(S.stateNode=k,ni=S,$i=be(k),!0):!1;case 6:return k=Yt(k,S.pendingProps),k!==null?(S.stateNode=k,ni=S,$i=null,!0):!1;case 13:if(k=xr(k),k!==null){var O=Ta!==null?{id:uo,overflow:Pl}:null;return S.memoizedState={dehydrated:k,treeContext:O,retryLane:1073741824},O=zo(18,null,null,0),O.stateNode=k,O.return=S,S.child=O,ni=S,$i=null,!0}return!1;default:return!1}}function ux(S){return(S.mode&1)!==0&&(S.flags&128)===0}function dx(S){if(Ss){var k=$i;if(k){var O=k;if(!Pg(S,k)){if(ux(S))throw Error(i(418));k=Ne(O);var V=ni;k&&Pg(S,k)?Tb(V,O):(S.flags=S.flags&-4097|2,Ss=!1,ni=S)}}else{if(ux(S))throw Error(i(418));S.flags=S.flags&-4097|2,Ss=!1,ni=S}}}function Nb(S){for(S=S.return;S!==null&&S.tag!==5&&S.tag!==3&&S.tag!==13;)S=S.return;ni=S}function Fg(S){if(!Ee||S!==ni)return!1;if(!Ss)return Nb(S),Ss=!0,!1;if(S.tag!==3&&(S.tag!==5||De(S.type)&&!W(S.type,S.memoizedProps))){var k=$i;if(k){if(ux(S))throw Eb(),Error(i(418));for(;k;)Tb(S,k),k=Ne(k)}}if(Nb(S),S.tag===13){if(!Ee)throw Error(i(316));if(S=S.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(i(317));$i=Je(S)}else $i=ni?Ne(S.stateNode):null;return!0}function Eb(){for(var S=$i;S;)S=Ne(S)}function kd(){Ee&&($i=ni=null,Rh=Ss=!1)}function fx(S){Ml===null?Ml=[S]:Ml.push(S)}var z3=o.ReactCurrentBatchConfig;function Mg(S,k){if(jl(S,k))return!0;if(typeof S!="object"||S===null||typeof k!="object"||k===null)return!1;var O=Object.keys(S),V=Object.keys(k);if(O.length!==V.length)return!1;for(V=0;V<O.length;V++){var ee=O[V];if(!ur.call(k,ee)||!jl(S[ee],k[ee]))return!1}return!0}function W3(S){switch(S.tag){case 5:return kr(S.type);case 16:return kr("Lazy");case 13:return kr("Suspense");case 19:return kr("SuspenseList");case 0:case 2:case 15:return S=_t(S.type,!1),S;case 11:return S=_t(S.type.render,!1),S;case 1:return S=_t(S.type,!0),S;default:return""}}function Cd(S,k,O){if(S=O.ref,S!==null&&typeof S!="function"&&typeof S!="object"){if(O._owner){if(O=O._owner,O){if(O.tag!==1)throw Error(i(309));var V=O.stateNode}if(!V)throw Error(i(147,S));var ee=V,ce=""+S;return k!==null&&k.ref!==null&&typeof k.ref=="function"&&k.ref._stringRef===ce?k.ref:(k=function(je){var xt=ee.refs;je===null?delete xt[ce]:xt[ce]=je},k._stringRef=ce,k)}if(typeof S!="string")throw Error(i(284));if(!O._owner)throw Error(i(290,S))}return S}function Rg(S,k){throw S=Object.prototype.toString.call(k),Error(i(31,S==="[object Object]"?"object with keys {"+Object.keys(k).join(", ")+"}":S))}function Ab(S){var k=S._init;return k(S._payload)}function jb(S){function k(Pt,bt){if(S){var zt=Pt.deletions;zt===null?(Pt.deletions=[bt],Pt.flags|=16):zt.push(bt)}}function O(Pt,bt){if(!S)return null;for(;bt!==null;)k(Pt,bt),bt=bt.sibling;return null}function V(Pt,bt){for(Pt=new Map;bt!==null;)bt.key!==null?Pt.set(bt.key,bt):Pt.set(bt.index,bt),bt=bt.sibling;return Pt}function ee(Pt,bt){return Pt=Vu(Pt,bt),Pt.index=0,Pt.sibling=null,Pt}function ce(Pt,bt,zt){return Pt.index=zt,S?(zt=Pt.alternate,zt!==null?(zt=zt.index,zt<bt?(Pt.flags|=2,bt):zt):(Pt.flags|=2,bt)):(Pt.flags|=1048576,bt)}function je(Pt){return S&&Pt.alternate===null&&(Pt.flags|=2),Pt}function xt(Pt,bt,zt,Ar){return bt===null||bt.tag!==6?(bt=bf(zt,Pt.mode,Ar),bt.return=Pt,bt):(bt=ee(bt,zt),bt.return=Pt,bt)}function Rt(Pt,bt,zt,Ar){var Yr=zt.type;return Yr===d?Lr(Pt,bt,zt.props.children,Ar,zt.key):bt!==null&&(bt.elementType===Yr||typeof Yr=="object"&&Yr!==null&&Yr.$$typeof===_&&Ab(Yr)===bt.type)?(Ar=ee(bt,zt.props),Ar.ref=Cd(Pt,bt,zt),Ar.return=Pt,Ar):(Ar=fp(zt.type,zt.key,zt.props,null,Pt.mode,Ar),Ar.ref=Cd(Pt,bt,zt),Ar.return=Pt,Ar)}function cr(Pt,bt,zt,Ar){return bt===null||bt.tag!==4||bt.stateNode.containerInfo!==zt.containerInfo||bt.stateNode.implementation!==zt.implementation?(bt=hp(zt,Pt.mode,Ar),bt.return=Pt,bt):(bt=ee(bt,zt.children||[]),bt.return=Pt,bt)}function Lr(Pt,bt,zt,Ar,Yr){return bt===null||bt.tag!==7?(bt=ii(zt,Pt.mode,Ar,Yr),bt.return=Pt,bt):(bt=ee(bt,zt),bt.return=Pt,bt)}function yn(Pt,bt,zt){if(typeof bt=="string"&&bt!==""||typeof bt=="number")return bt=bf(""+bt,Pt.mode,zt),bt.return=Pt,bt;if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case c:return zt=fp(bt.type,bt.key,bt.props,null,Pt.mode,zt),zt.ref=Cd(Pt,null,bt),zt.return=Pt,zt;case u:return bt=hp(bt,Pt.mode,zt),bt.return=Pt,bt;case _:var Ar=bt._init;return yn(Pt,Ar(bt._payload),zt)}if(re(bt)||E(bt))return bt=ii(bt,Pt.mode,zt,null),bt.return=Pt,bt;Rg(Pt,bt)}return null}function Er(Pt,bt,zt,Ar){var Yr=bt!==null?bt.key:null;if(typeof zt=="string"&&zt!==""||typeof zt=="number")return Yr!==null?null:xt(Pt,bt,""+zt,Ar);if(typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case c:return zt.key===Yr?Rt(Pt,bt,zt,Ar):null;case u:return zt.key===Yr?cr(Pt,bt,zt,Ar):null;case _:return Yr=zt._init,Er(Pt,bt,Yr(zt._payload),Ar)}if(re(zt)||E(zt))return Yr!==null?null:Lr(Pt,bt,zt,Ar,null);Rg(Pt,zt)}return null}function ys(Pt,bt,zt,Ar,Yr){if(typeof Ar=="string"&&Ar!==""||typeof Ar=="number")return Pt=Pt.get(zt)||null,xt(bt,Pt,""+Ar,Yr);if(typeof Ar=="object"&&Ar!==null){switch(Ar.$$typeof){case c:return Pt=Pt.get(Ar.key===null?zt:Ar.key)||null,Rt(bt,Pt,Ar,Yr);case u:return Pt=Pt.get(Ar.key===null?zt:Ar.key)||null,cr(bt,Pt,Ar,Yr);case _:var kn=Ar._init;return ys(Pt,bt,zt,kn(Ar._payload),Yr)}if(re(Ar)||E(Ar))return Pt=Pt.get(zt)||null,Lr(bt,Pt,Ar,Yr,null);Rg(bt,Ar)}return null}function ts(Pt,bt,zt,Ar){for(var Yr=null,kn=null,vn=bt,$n=bt=0,Pa=null;vn!==null&&$n<zt.length;$n++){vn.index>$n?(Pa=vn,vn=null):Pa=vn.sibling;var Ln=Er(Pt,vn,zt[$n],Ar);if(Ln===null){vn===null&&(vn=Pa);break}S&&vn&&Ln.alternate===null&&k(Pt,vn),bt=ce(Ln,bt,$n),kn===null?Yr=Ln:kn.sibling=Ln,kn=Ln,vn=Pa}if($n===zt.length)return O(Pt,vn),Ss&&Fl(Pt,$n),Yr;if(vn===null){for(;$n<zt.length;$n++)vn=yn(Pt,zt[$n],Ar),vn!==null&&(bt=ce(vn,bt,$n),kn===null?Yr=vn:kn.sibling=vn,kn=vn);return Ss&&Fl(Pt,$n),Yr}for(vn=V(Pt,vn);$n<zt.length;$n++)Pa=ys(vn,Pt,$n,zt[$n],Ar),Pa!==null&&(S&&Pa.alternate!==null&&vn.delete(Pa.key===null?$n:Pa.key),bt=ce(Pa,bt,$n),kn===null?Yr=Pa:kn.sibling=Pa,kn=Pa);return S&&vn.forEach(function(ki){return k(Pt,ki)}),Ss&&Fl(Pt,$n),Yr}function Vi(Pt,bt,zt,Ar){var Yr=E(zt);if(typeof Yr!="function")throw Error(i(150));if(zt=Yr.call(zt),zt==null)throw Error(i(151));for(var kn=Yr=null,vn=bt,$n=bt=0,Pa=null,Ln=zt.next();vn!==null&&!Ln.done;$n++,Ln=zt.next()){vn.index>$n?(Pa=vn,vn=null):Pa=vn.sibling;var ki=Er(Pt,vn,Ln.value,Ar);if(ki===null){vn===null&&(vn=Pa);break}S&&vn&&ki.alternate===null&&k(Pt,vn),bt=ce(ki,bt,$n),kn===null?Yr=ki:kn.sibling=ki,kn=ki,vn=Pa}if(Ln.done)return O(Pt,vn),Ss&&Fl(Pt,$n),Yr;if(vn===null){for(;!Ln.done;$n++,Ln=zt.next())Ln=yn(Pt,Ln.value,Ar),Ln!==null&&(bt=ce(Ln,bt,$n),kn===null?Yr=Ln:kn.sibling=Ln,kn=Ln);return Ss&&Fl(Pt,$n),Yr}for(vn=V(Pt,vn);!Ln.done;$n++,Ln=zt.next())Ln=ys(vn,Pt,$n,Ln.value,Ar),Ln!==null&&(S&&Ln.alternate!==null&&vn.delete(Ln.key===null?$n:Ln.key),bt=ce(Ln,bt,$n),kn===null?Yr=Ln:kn.sibling=Ln,kn=Ln);return S&&vn.forEach(function(K3){return k(Pt,K3)}),Ss&&Fl(Pt,$n),Yr}function hc(Pt,bt,zt,Ar){if(typeof zt=="object"&&zt!==null&&zt.type===d&&zt.key===null&&(zt=zt.props.children),typeof zt=="object"&&zt!==null){switch(zt.$$typeof){case c:e:{for(var Yr=zt.key,kn=bt;kn!==null;){if(kn.key===Yr){if(Yr=zt.type,Yr===d){if(kn.tag===7){O(Pt,kn.sibling),bt=ee(kn,zt.props.children),bt.return=Pt,Pt=bt;break e}}else if(kn.elementType===Yr||typeof Yr=="object"&&Yr!==null&&Yr.$$typeof===_&&Ab(Yr)===kn.type){O(Pt,kn.sibling),bt=ee(kn,zt.props),bt.ref=Cd(Pt,kn,zt),bt.return=Pt,Pt=bt;break e}O(Pt,kn);break}else k(Pt,kn);kn=kn.sibling}zt.type===d?(bt=ii(zt.props.children,Pt.mode,Ar,zt.key),bt.return=Pt,Pt=bt):(Ar=fp(zt.type,zt.key,zt.props,null,Pt.mode,Ar),Ar.ref=Cd(Pt,bt,zt),Ar.return=Pt,Pt=Ar)}return je(Pt);case u:e:{for(kn=zt.key;bt!==null;){if(bt.key===kn)if(bt.tag===4&&bt.stateNode.containerInfo===zt.containerInfo&&bt.stateNode.implementation===zt.implementation){O(Pt,bt.sibling),bt=ee(bt,zt.children||[]),bt.return=Pt,Pt=bt;break e}else{O(Pt,bt);break}else k(Pt,bt);bt=bt.sibling}bt=hp(zt,Pt.mode,Ar),bt.return=Pt,Pt=bt}return je(Pt);case _:return kn=zt._init,hc(Pt,bt,kn(zt._payload),Ar)}if(re(zt))return ts(Pt,bt,zt,Ar);if(E(zt))return Vi(Pt,bt,zt,Ar);Rg(Pt,zt)}return typeof zt=="string"&&zt!==""||typeof zt=="number"?(zt=""+zt,bt!==null&&bt.tag===6?(O(Pt,bt.sibling),bt=ee(bt,zt),bt.return=Pt,Pt=bt):(O(Pt,bt),bt=bf(zt,Pt.mode,Ar),bt.return=Pt,Pt=bt),je(Pt)):O(Pt,bt)}return hc}var Td=jb(!0),Pb=jb(!1),Og=Tr(null),Dg=null,Y0=null,hx=null;function mx(){hx=Y0=Dg=null}function Fb(S,k,O){he?($r(Og,k._currentValue),k._currentValue=O):($r(Og,k._currentValue2),k._currentValue2=O)}function Oh(S){var k=Og.current;qr(Og),he?S._currentValue=k:S._currentValue2=k}function Nd(S,k,O){for(;S!==null;){var V=S.alternate;if((S.childLanes&k)!==k?(S.childLanes|=k,V!==null&&(V.childLanes|=k)):V!==null&&(V.childLanes&k)!==k&&(V.childLanes|=k),S===O)break;S=S.return}}function X0(S,k){Dg=S,hx=Y0=null,S=S.dependencies,S!==null&&S.firstContext!==null&&((S.lanes&k)!==0&&(Ea=!0),S.firstContext=null)}function Mo(S){var k=he?S._currentValue:S._currentValue2;if(hx!==S)if(S={context:S,memoizedValue:k,next:null},Y0===null){if(Dg===null)throw Error(i(308));Y0=S,Dg.dependencies={lanes:0,firstContext:S}}else Y0=Y0.next=S;return k}var Au=null;function Ig(S){Au===null?Au=[S]:Au.push(S)}function gx(S,k,O,V){var ee=k.interleaved;return ee===null?(O.next=O,Ig(k)):(O.next=ee.next,ee.next=O),k.interleaved=O,Rl(S,V)}function Rl(S,k){S.lanes|=k;var O=S.alternate;for(O!==null&&(O.lanes|=k),O=S,S=S.return;S!==null;)S.childLanes|=k,O=S.alternate,O!==null&&(O.childLanes|=k),O=S,S=S.return;return O.tag===3?O.stateNode:null}var Ro=!1;function px(S){S.updateQueue={baseState:S.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mb(S,k){S=S.updateQueue,k.updateQueue===S&&(k.updateQueue={baseState:S.baseState,firstBaseUpdate:S.firstBaseUpdate,lastBaseUpdate:S.lastBaseUpdate,shared:S.shared,effects:S.effects})}function Yc(S,k){return{eventTime:S,lane:k,tag:0,payload:null,callback:null,next:null}}function Xc(S,k,O){var V=S.updateQueue;if(V===null)return null;if(V=V.shared,(bn&2)!==0){var ee=V.pending;return ee===null?k.next=k:(k.next=ee.next,ee.next=k),V.pending=k,Rl(S,O)}return ee=V.interleaved,ee===null?(k.next=k,Ig(V)):(k.next=ee.next,ee.next=k),V.interleaved=k,Rl(S,O)}function Dh(S,k,O){if(k=k.updateQueue,k!==null&&(k=k.shared,(O&4194240)!==0)){var V=k.lanes;V&=S.pendingLanes,O|=V,k.lanes=O,Nn(S,O)}}function J0(S,k){var O=S.updateQueue,V=S.alternate;if(V!==null&&(V=V.updateQueue,O===V)){var ee=null,ce=null;if(O=O.firstBaseUpdate,O!==null){do{var je={eventTime:O.eventTime,lane:O.lane,tag:O.tag,payload:O.payload,callback:O.callback,next:null};ce===null?ee=ce=je:ce=ce.next=je,O=O.next}while(O!==null);ce===null?ee=ce=k:ce=ce.next=k}else ee=ce=k;O={baseState:V.baseState,firstBaseUpdate:ee,lastBaseUpdate:ce,shared:V.shared,effects:V.effects},S.updateQueue=O;return}S=O.lastBaseUpdate,S===null?O.firstBaseUpdate=k:S.next=k,O.lastBaseUpdate=k}function ju(S,k,O,V){var ee=S.updateQueue;Ro=!1;var ce=ee.firstBaseUpdate,je=ee.lastBaseUpdate,xt=ee.shared.pending;if(xt!==null){ee.shared.pending=null;var Rt=xt,cr=Rt.next;Rt.next=null,je===null?ce=cr:je.next=cr,je=Rt;var Lr=S.alternate;Lr!==null&&(Lr=Lr.updateQueue,xt=Lr.lastBaseUpdate,xt!==je&&(xt===null?Lr.firstBaseUpdate=cr:xt.next=cr,Lr.lastBaseUpdate=Rt))}if(ce!==null){var yn=ee.baseState;je=0,Lr=cr=Rt=null,xt=ce;do{var Er=xt.lane,ys=xt.eventTime;if((V&Er)===Er){Lr!==null&&(Lr=Lr.next={eventTime:ys,lane:0,tag:xt.tag,payload:xt.payload,callback:xt.callback,next:null});e:{var ts=S,Vi=xt;switch(Er=k,ys=O,Vi.tag){case 1:if(ts=Vi.payload,typeof ts=="function"){yn=ts.call(ys,yn,Er);break e}yn=ts;break e;case 3:ts.flags=ts.flags&-65537|128;case 0:if(ts=Vi.payload,Er=typeof ts=="function"?ts.call(ys,yn,Er):ts,Er==null)break e;yn=a({},yn,Er);break e;case 2:Ro=!0}}xt.callback!==null&&xt.lane!==0&&(S.flags|=64,Er=ee.effects,Er===null?ee.effects=[xt]:Er.push(xt))}else ys={eventTime:ys,lane:Er,tag:xt.tag,payload:xt.payload,callback:xt.callback,next:null},Lr===null?(cr=Lr=ys,Rt=yn):Lr=Lr.next=ys,je|=Er;if(xt=xt.next,xt===null){if(xt=ee.shared.pending,xt===null)break;Er=xt,xt=Er.next,Er.next=null,ee.lastBaseUpdate=Er,ee.shared.pending=null}}while(!0);if(Lr===null&&(Rt=yn),ee.baseState=Rt,ee.firstBaseUpdate=cr,ee.lastBaseUpdate=Lr,k=ee.shared.interleaved,k!==null){ee=k;do je|=ee.lane,ee=ee.next;while(ee!==k)}else ce===null&&(ee.shared.lanes=0);tu|=je,S.lanes=je,S.memoizedState=yn}}function Rb(S,k,O){if(S=k.effects,k.effects=null,S!==null)for(k=0;k<S.length;k++){var V=S[k],ee=V.callback;if(ee!==null){if(V.callback=null,V=O,typeof ee!="function")throw Error(i(191,ee));ee.call(V)}}}var Pu={},al=Tr(Pu),Q0=Tr(Pu),Fu=Tr(Pu);function il(S){if(S===Pu)throw Error(i(174));return S}function Lg(S,k){$r(Fu,k),$r(Q0,S),$r(al,Pu),S=B(k),qr(al),$r(al,S)}function Ed(){qr(al),qr(Q0),qr(Fu)}function xx(S){var k=il(Fu.current),O=il(al.current);k=J(O,S.type,k),O!==k&&($r(Q0,S),$r(al,k))}function yx(S){Q0.current===S&&(qr(al),qr(Q0))}var Bs=Tr(0);function Bg(S){for(var k=S;k!==null;){if(k.tag===13){var O=k.memoizedState;if(O!==null&&(O=O.dehydrated,O===null||Rr(O)||yr(O)))return k}else if(k.tag===19&&k.memoizedProps.revealOrder!==void 0){if((k.flags&128)!==0)return k}else if(k.child!==null){k.child.return=k,k=k.child;continue}if(k===S)break;for(;k.sibling===null;){if(k.return===null||k.return===S)return null;k=k.return}k.sibling.return=k.return,k=k.sibling}return null}var vx=[];function bx(){for(var S=0;S<vx.length;S++){var k=vx[S];he?k._workInProgressVersionPrimary=null:k._workInProgressVersionSecondary=null}vx.length=0}var fo=o.ReactCurrentDispatcher,Ad=o.ReactCurrentBatchConfig,Mu=0,As=null,fa=null,Na=null,Z0=!1,Ih=!1,Lh=0,ef=0;function za(){throw Error(i(321))}function jd(S,k){if(k===null)return!1;for(var O=0;O<k.length&&O<S.length;O++)if(!jl(S[O],k[O]))return!1;return!0}function Bh(S,k,O,V,ee,ce){if(Mu=ce,As=k,k.memoizedState=null,k.updateQueue=null,k.lanes=0,fo.current=S===null||S.memoizedState===null?jx:Px,S=O(V,ee),Ih){ce=0;do{if(Ih=!1,Lh=0,25<=ce)throw Error(i(301));ce+=1,Na=fa=null,k.updateQueue=null,fo.current=Fx,S=O(V,ee)}while(Ih)}if(fo.current=Od,k=fa!==null&&fa.next!==null,Mu=0,Na=fa=As=null,Z0=!1,k)throw Error(i(300));return S}function $g(){var S=Lh!==0;return Lh=0,S}function Oo(){var S={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Na===null?As.memoizedState=Na=S:Na=Na.next=S,Na}function si(){if(fa===null){var S=As.alternate;S=S!==null?S.memoizedState:null}else S=fa.next;var k=Na===null?As.memoizedState:Na.next;if(k!==null)Na=k,fa=S;else{if(S===null)throw Error(i(310));fa=S,S={memoizedState:fa.memoizedState,baseState:fa.baseState,baseQueue:fa.baseQueue,queue:fa.queue,next:null},Na===null?As.memoizedState=Na=S:Na=Na.next=S}return Na}function Pd(S,k){return typeof k=="function"?k(S):k}function Ug(S){var k=si(),O=k.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=S;var V=fa,ee=V.baseQueue,ce=O.pending;if(ce!==null){if(ee!==null){var je=ee.next;ee.next=ce.next,ce.next=je}V.baseQueue=ee=ce,O.pending=null}if(ee!==null){ce=ee.next,V=V.baseState;var xt=je=null,Rt=null,cr=ce;do{var Lr=cr.lane;if((Mu&Lr)===Lr)Rt!==null&&(Rt=Rt.next={lane:0,action:cr.action,hasEagerState:cr.hasEagerState,eagerState:cr.eagerState,next:null}),V=cr.hasEagerState?cr.eagerState:S(V,cr.action);else{var yn={lane:Lr,action:cr.action,hasEagerState:cr.hasEagerState,eagerState:cr.eagerState,next:null};Rt===null?(xt=Rt=yn,je=V):Rt=Rt.next=yn,As.lanes|=Lr,tu|=Lr}cr=cr.next}while(cr!==null&&cr!==ce);Rt===null?je=V:Rt.next=xt,jl(V,k.memoizedState)||(Ea=!0),k.memoizedState=V,k.baseState=je,k.baseQueue=Rt,O.lastRenderedState=V}if(S=O.interleaved,S!==null){ee=S;do ce=ee.lane,As.lanes|=ce,tu|=ce,ee=ee.next;while(ee!==S)}else ee===null&&(O.lanes=0);return[k.memoizedState,O.dispatch]}function tf(S){var k=si(),O=k.queue;if(O===null)throw Error(i(311));O.lastRenderedReducer=S;var V=O.dispatch,ee=O.pending,ce=k.memoizedState;if(ee!==null){O.pending=null;var je=ee=ee.next;do ce=S(ce,je.action),je=je.next;while(je!==ee);jl(ce,k.memoizedState)||(Ea=!0),k.memoizedState=ce,k.baseQueue===null&&(k.baseState=ce),O.lastRenderedState=ce}return[ce,V]}function wx(){}function _x(S,k){var O=As,V=si(),ee=k(),ce=!jl(V.memoizedState,ee);if(ce&&(V.memoizedState=ee,Ea=!0),V=V.queue,Hg(Cx.bind(null,O,V,S),[S]),V.getSnapshot!==k||ce||Na!==null&&Na.memoizedState.tag&1){if(O.flags|=2048,Fd(9,kx.bind(null,O,V,ee,k),void 0,null),os===null)throw Error(i(349));(Mu&30)!==0||Sx(O,k,ee)}return ee}function Sx(S,k,O){S.flags|=16384,S={getSnapshot:k,value:O},k=As.updateQueue,k===null?(k={lastEffect:null,stores:null},As.updateQueue=k,k.stores=[S]):(O=k.stores,O===null?k.stores=[S]:O.push(S))}function kx(S,k,O,V){k.value=O,k.getSnapshot=V,Tx(k)&&Jc(S)}function Cx(S,k,O){return O(function(){Tx(k)&&Jc(S)})}function Tx(S){var k=S.getSnapshot;S=S.value;try{var O=k();return!jl(S,O)}catch{return!0}}function Jc(S){var k=Rl(S,1);k!==null&&_i(k,S,1,-1)}function zg(S){var k=Oo();return typeof S=="function"&&(S=S()),k.memoizedState=k.baseState=S,S={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pd,lastRenderedState:S},k.queue=S,S=S.dispatch=H3.bind(null,As,S),[k.memoizedState,S]}function Fd(S,k,O,V){return S={tag:S,create:k,destroy:O,deps:V,next:null},k=As.updateQueue,k===null?(k={lastEffect:null,stores:null},As.updateQueue=k,k.lastEffect=S.next=S):(O=k.lastEffect,O===null?k.lastEffect=S.next=S:(V=O.next,O.next=S,S.next=V,k.lastEffect=S)),S}function Ob(){return si().memoizedState}function Wg(S,k,O,V){var ee=Oo();As.flags|=S,ee.memoizedState=Fd(1|k,O,void 0,V===void 0?null:V)}function Ru(S,k,O,V){var ee=si();V=V===void 0?null:V;var ce=void 0;if(fa!==null){var je=fa.memoizedState;if(ce=je.destroy,V!==null&&jd(V,je.deps)){ee.memoizedState=Fd(k,O,ce,V);return}}As.flags|=S,ee.memoizedState=Fd(1|k,O,ce,V)}function Db(S,k){return Wg(8390656,8,S,k)}function Hg(S,k){return Ru(2048,8,S,k)}function Nx(S,k){return Ru(4,2,S,k)}function gs(S,k){return Ru(4,4,S,k)}function Gg(S,k){if(typeof k=="function")return S=S(),k(S),function(){k(null)};if(k!=null)return S=S(),k.current=S,function(){k.current=null}}function $h(S,k,O){return O=O!=null?O.concat([S]):null,Ru(4,4,Gg.bind(null,k,S),O)}function Md(){}function Ex(S,k){var O=si();k=k===void 0?null:k;var V=O.memoizedState;return V!==null&&k!==null&&jd(k,V[1])?V[0]:(O.memoizedState=[S,k],S)}function Vg(S,k){var O=si();k=k===void 0?null:k;var V=O.memoizedState;return V!==null&&k!==null&&jd(k,V[1])?V[0]:(S=S(),O.memoizedState=[S,k],S)}function rf(S,k,O){return(Mu&21)===0?(S.baseState&&(S.baseState=!1,Ea=!0),S.memoizedState=O):(jl(O,k)||(O=St(),As.lanes|=O,tu|=O,S.baseState=!0),k)}function qg(S,k){var O=Xe;Xe=O!==0&&4>O?O:4,S(!0);var V=Ad.transition;Ad.transition={};try{S(!1),k()}finally{Xe=O,Ad.transition=V}}function Rd(){return si().memoizedState}function Ib(S,k,O){var V=ja(S);if(O={lane:V,action:O,hasEagerState:!1,eagerState:null,next:null},Lb(S))Ax(k,O);else if(O=gx(S,k,O,V),O!==null){var ee=ks();_i(O,S,V,ee),Uh(O,k,V)}}function H3(S,k,O){var V=ja(S),ee={lane:V,action:O,hasEagerState:!1,eagerState:null,next:null};if(Lb(S))Ax(k,ee);else{var ce=S.alternate;if(S.lanes===0&&(ce===null||ce.lanes===0)&&(ce=k.lastRenderedReducer,ce!==null))try{var je=k.lastRenderedState,xt=ce(je,O);if(ee.hasEagerState=!0,ee.eagerState=xt,jl(xt,je)){var Rt=k.interleaved;Rt===null?(ee.next=ee,Ig(k)):(ee.next=Rt.next,Rt.next=ee),k.interleaved=ee;return}}catch{}finally{}O=gx(S,k,ee,V),O!==null&&(ee=ks(),_i(O,S,V,ee),Uh(O,k,V))}}function Lb(S){var k=S.alternate;return S===As||k!==null&&k===As}function Ax(S,k){Ih=Z0=!0;var O=S.pending;O===null?k.next=k:(k.next=O.next,O.next=k),S.pending=k}function Uh(S,k,O){if((O&4194240)!==0){var V=k.lanes;V&=S.pendingLanes,O|=V,k.lanes=O,Nn(S,O)}}var Od={readContext:Mo,useCallback:za,useContext:za,useEffect:za,useImperativeHandle:za,useInsertionEffect:za,useLayoutEffect:za,useMemo:za,useReducer:za,useRef:za,useState:za,useDebugValue:za,useDeferredValue:za,useTransition:za,useMutableSource:za,useSyncExternalStore:za,useId:za,unstable_isNewReconciler:!1},jx={readContext:Mo,useCallback:function(S,k){return Oo().memoizedState=[S,k===void 0?null:k],S},useContext:Mo,useEffect:Db,useImperativeHandle:function(S,k,O){return O=O!=null?O.concat([S]):null,Wg(4194308,4,Gg.bind(null,k,S),O)},useLayoutEffect:function(S,k){return Wg(4194308,4,S,k)},useInsertionEffect:function(S,k){return Wg(4,2,S,k)},useMemo:function(S,k){var O=Oo();return k=k===void 0?null:k,S=S(),O.memoizedState=[S,k],S},useReducer:function(S,k,O){var V=Oo();return k=O!==void 0?O(k):k,V.memoizedState=V.baseState=k,S={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:k},V.queue=S,S=S.dispatch=Ib.bind(null,As,S),[V.memoizedState,S]},useRef:function(S){var k=Oo();return S={current:S},k.memoizedState=S},useState:zg,useDebugValue:Md,useDeferredValue:function(S){return Oo().memoizedState=S},useTransition:function(){var S=zg(!1),k=S[0];return S=qg.bind(null,S[1]),Oo().memoizedState=S,[k,S]},useMutableSource:function(){},useSyncExternalStore:function(S,k,O){var V=As,ee=Oo();if(Ss){if(O===void 0)throw Error(i(407));O=O()}else{if(O=k(),os===null)throw Error(i(349));(Mu&30)!==0||Sx(V,k,O)}ee.memoizedState=O;var ce={value:O,getSnapshot:k};return ee.queue=ce,Db(Cx.bind(null,V,ce,S),[S]),V.flags|=2048,Fd(9,kx.bind(null,V,ce,O,k),void 0,null),O},useId:function(){var S=Oo(),k=os.identifierPrefix;if(Ss){var O=Pl,V=uo;O=(V&~(1<<32-Qr(V)-1)).toString(32)+O,k=":"+k+"R"+O,O=Lh++,0<O&&(k+="H"+O.toString(32)),k+=":"}else O=ef++,k=":"+k+"r"+O.toString(32)+":";return S.memoizedState=k},unstable_isNewReconciler:!1},Px={readContext:Mo,useCallback:Ex,useContext:Mo,useEffect:Hg,useImperativeHandle:$h,useInsertionEffect:Nx,useLayoutEffect:gs,useMemo:Vg,useReducer:Ug,useRef:Ob,useState:function(){return Ug(Pd)},useDebugValue:Md,useDeferredValue:function(S){var k=si();return rf(k,fa.memoizedState,S)},useTransition:function(){var S=Ug(Pd)[0],k=si().memoizedState;return[S,k]},useMutableSource:wx,useSyncExternalStore:_x,useId:Rd,unstable_isNewReconciler:!1},Fx={readContext:Mo,useCallback:Ex,useContext:Mo,useEffect:Hg,useImperativeHandle:$h,useInsertionEffect:Nx,useLayoutEffect:gs,useMemo:Vg,useReducer:tf,useRef:Ob,useState:function(){return tf(Pd)},useDebugValue:Md,useDeferredValue:function(S){var k=si();return fa===null?k.memoizedState=S:rf(k,fa.memoizedState,S)},useTransition:function(){var S=tf(Pd)[0],k=si().memoizedState;return[S,k]},useMutableSource:wx,useSyncExternalStore:_x,useId:Rd,unstable_isNewReconciler:!1};function Do(S,k){if(S&&S.defaultProps){k=a({},k),S=S.defaultProps;for(var O in S)k[O]===void 0&&(k[O]=S[O]);return k}return k}function Mx(S,k,O,V){k=S.memoizedState,O=O(V,k),O=O==null?k:a({},k,O),S.memoizedState=O,S.lanes===0&&(S.updateQueue.baseState=O)}var zh={isMounted:function(S){return(S=S._reactInternals)?P(S)===S:!1},enqueueSetState:function(S,k,O){S=S._reactInternals;var V=ks(),ee=ja(S),ce=Yc(V,ee);ce.payload=k,O!=null&&(ce.callback=O),k=Xc(S,ce,ee),k!==null&&(_i(k,S,ee,V),Dh(k,S,ee))},enqueueReplaceState:function(S,k,O){S=S._reactInternals;var V=ks(),ee=ja(S),ce=Yc(V,ee);ce.tag=1,ce.payload=k,O!=null&&(ce.callback=O),k=Xc(S,ce,ee),k!==null&&(_i(k,S,ee,V),Dh(k,S,ee))},enqueueForceUpdate:function(S,k){S=S._reactInternals;var O=ks(),V=ja(S),ee=Yc(O,V);ee.tag=2,k!=null&&(ee.callback=k),k=Xc(S,ee,V),k!==null&&(_i(k,S,V,O),Dh(k,S,V))}};function Bb(S,k,O,V,ee,ce,je){return S=S.stateNode,typeof S.shouldComponentUpdate=="function"?S.shouldComponentUpdate(V,ce,je):k.prototype&&k.prototype.isPureReactComponent?!Mg(O,V)||!Mg(ee,ce):!0}function $b(S,k,O){var V=!1,ee=qn,ce=k.contextType;return typeof ce=="object"&&ce!==null?ce=Mo(ce):(ee=Fn(k)?Zr:gr.current,V=k.contextTypes,ce=(V=V!=null)?Zn(S,ee):qn),k=new k(O,ce),S.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=zh,S.stateNode=k,k._reactInternals=S,V&&(S=S.stateNode,S.__reactInternalMemoizedUnmaskedChildContext=ee,S.__reactInternalMemoizedMaskedChildContext=ce),k}function Kg(S,k,O,V){S=k.state,typeof k.componentWillReceiveProps=="function"&&k.componentWillReceiveProps(O,V),typeof k.UNSAFE_componentWillReceiveProps=="function"&&k.UNSAFE_componentWillReceiveProps(O,V),k.state!==S&&zh.enqueueReplaceState(k,k.state,null)}function ac(S,k,O,V){var ee=S.stateNode;ee.props=O,ee.state=S.memoizedState,ee.refs={},px(S);var ce=k.contextType;typeof ce=="object"&&ce!==null?ee.context=Mo(ce):(ce=Fn(k)?Zr:gr.current,ee.context=Zn(S,ce)),ee.state=S.memoizedState,ce=k.getDerivedStateFromProps,typeof ce=="function"&&(Mx(S,k,ce,O),ee.state=S.memoizedState),typeof k.getDerivedStateFromProps=="function"||typeof ee.getSnapshotBeforeUpdate=="function"||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(k=ee.state,typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount(),k!==ee.state&&zh.enqueueReplaceState(ee,ee.state,null),ju(S,O,ee,V),ee.state=S.memoizedState),typeof ee.componentDidMount=="function"&&(S.flags|=4194308)}function Dd(S,k){try{var O="",V=k;do O+=W3(V),V=V.return;while(V);var ee=O}catch(ce){ee=`
Error generating stack: `+ce.message+`
`+ce.stack}return{value:S,source:k,stack:ee,digest:null}}function Ou(S,k,O){return{value:S,source:null,stack:O??null,digest:k??null}}function ol(S,k){try{console.error(k.value)}catch(O){setTimeout(function(){throw O})}}var Wh=typeof WeakMap=="function"?WeakMap:Map;function ic(S,k,O){O=Yc(-1,O),O.tag=3,O.payload={element:null};var V=k.value;return O.callback=function(){Ys||(Ys=!0,ha=V),ol(S,k)},O}function Yg(S,k,O){O=Yc(-1,O),O.tag=3;var V=S.type.getDerivedStateFromError;if(typeof V=="function"){var ee=k.value;O.payload=function(){return V(ee)},O.callback=function(){ol(S,k)}}var ce=S.stateNode;return ce!==null&&typeof ce.componentDidCatch=="function"&&(O.callback=function(){ol(S,k),typeof V!="function"&&(Dl===null?Dl=new Set([this]):Dl.add(this));var je=k.stack;this.componentDidCatch(k.value,{componentStack:je!==null?je:""})}),O}function Ub(S,k,O){var V=S.pingCache;if(V===null){V=S.pingCache=new Wh;var ee=new Set;V.set(k,ee)}else ee=V.get(k),ee===void 0&&(ee=new Set,V.set(k,ee));ee.has(O)||(ee.add(O),S=Yb.bind(null,S,k,O),k.then(S,S))}function zb(S){do{var k;if((k=S.tag===13)&&(k=S.memoizedState,k=k!==null?k.dehydrated!==null:!0),k)return S;S=S.return}while(S!==null);return null}function Du(S,k,O,V,ee){return(S.mode&1)===0?(S===k?S.flags|=65536:(S.flags|=128,O.flags|=131072,O.flags&=-52805,O.tag===1&&(O.alternate===null?O.tag=17:(k=Yc(-1,1),k.tag=2,Xc(O,k,1))),O.lanes|=1),S):(S.flags|=65536,S.lanes=ee,S)}var Hh=o.ReactCurrentOwner,Ea=!1;function Wa(S,k,O,V){k.child=S===null?Pb(k,null,O,V):Td(k,S.child,O,V)}function Xg(S,k,O,V,ee){O=O.render;var ce=k.ref;return X0(k,ee),V=Bh(S,k,O,V,ce,ee),O=$g(),S!==null&&!Ea?(k.updateQueue=S.updateQueue,k.flags&=-2053,S.lanes&=~ee,Zc(S,k,ee)):(Ss&&O&&Fh(k),k.flags|=1,Wa(S,k,V,ee),k.child)}function Id(S,k,O,V,ee){if(S===null){var ce=O.type;return typeof ce=="function"&&!yf(ce)&&ce.defaultProps===void 0&&O.compare===null&&O.defaultProps===void 0?(k.tag=15,k.type=ce,Qc(S,k,ce,V,ee)):(S=fp(O.type,null,V,k,k.mode,ee),S.ref=k.ref,S.return=k,k.child=S)}if(ce=S.child,(S.lanes&ee)===0){var je=ce.memoizedProps;if(O=O.compare,O=O!==null?O:Mg,O(je,V)&&S.ref===k.ref)return Zc(S,k,ee)}return k.flags|=1,S=Vu(ce,V),S.ref=k.ref,S.return=k,k.child=S}function Qc(S,k,O,V,ee){if(S!==null){var ce=S.memoizedProps;if(Mg(ce,V)&&S.ref===k.ref)if(Ea=!1,k.pendingProps=V=ce,(S.lanes&ee)!==0)(S.flags&131072)!==0&&(Ea=!0);else return k.lanes=S.lanes,Zc(S,k,ee)}return oc(S,k,O,V,ee)}function ps(S,k,O){var V=k.pendingProps,ee=V.children,ce=S!==null?S.memoizedState:null;if(V.mode==="hidden")if((k.mode&1)===0)k.memoizedState={baseLanes:0,cachePool:null,transitions:null},$r(zu,Aa),Aa|=O;else{if((O&1073741824)===0)return S=ce!==null?ce.baseLanes|O:O,k.lanes=k.childLanes=1073741824,k.memoizedState={baseLanes:S,cachePool:null,transitions:null},k.updateQueue=null,$r(zu,Aa),Aa|=S,null;k.memoizedState={baseLanes:0,cachePool:null,transitions:null},V=ce!==null?ce.baseLanes:O,$r(zu,Aa),Aa|=V}else ce!==null?(V=ce.baseLanes|O,k.memoizedState=null):V=O,$r(zu,Aa),Aa|=V;return Wa(S,k,ee,O),k.child}function is(S,k){var O=k.ref;(S===null&&O!==null||S!==null&&S.ref!==O)&&(k.flags|=512,k.flags|=2097152)}function oc(S,k,O,V,ee){var ce=Fn(O)?Zr:gr.current;return ce=Zn(k,ce),X0(k,ee),O=Bh(S,k,O,V,ce,ee),V=$g(),S!==null&&!Ea?(k.updateQueue=S.updateQueue,k.flags&=-2053,S.lanes&=~ee,Zc(S,k,ee)):(Ss&&V&&Fh(k),k.flags|=1,Wa(S,k,O,ee),k.child)}function ai(S,k,O,V,ee){if(Fn(O)){var ce=!0;Kr(k)}else ce=!1;if(X0(k,ee),k.stateNode===null)Gh(S,k),$b(k,O,V),ac(k,O,V,ee),V=!0;else if(S===null){var je=k.stateNode,xt=k.memoizedProps;je.props=xt;var Rt=je.context,cr=O.contextType;typeof cr=="object"&&cr!==null?cr=Mo(cr):(cr=Fn(O)?Zr:gr.current,cr=Zn(k,cr));var Lr=O.getDerivedStateFromProps,yn=typeof Lr=="function"||typeof je.getSnapshotBeforeUpdate=="function";yn||typeof je.UNSAFE_componentWillReceiveProps!="function"&&typeof je.componentWillReceiveProps!="function"||(xt!==V||Rt!==cr)&&Kg(k,je,V,cr),Ro=!1;var Er=k.memoizedState;je.state=Er,ju(k,V,je,ee),Rt=k.memoizedState,xt!==V||Er!==Rt||pn.current||Ro?(typeof Lr=="function"&&(Mx(k,O,Lr,V),Rt=k.memoizedState),(xt=Ro||Bb(k,O,xt,V,Er,Rt,cr))?(yn||typeof je.UNSAFE_componentWillMount!="function"&&typeof je.componentWillMount!="function"||(typeof je.componentWillMount=="function"&&je.componentWillMount(),typeof je.UNSAFE_componentWillMount=="function"&&je.UNSAFE_componentWillMount()),typeof je.componentDidMount=="function"&&(k.flags|=4194308)):(typeof je.componentDidMount=="function"&&(k.flags|=4194308),k.memoizedProps=V,k.memoizedState=Rt),je.props=V,je.state=Rt,je.context=cr,V=xt):(typeof je.componentDidMount=="function"&&(k.flags|=4194308),V=!1)}else{je=k.stateNode,Mb(S,k),xt=k.memoizedProps,cr=k.type===k.elementType?xt:Do(k.type,xt),je.props=cr,yn=k.pendingProps,Er=je.context,Rt=O.contextType,typeof Rt=="object"&&Rt!==null?Rt=Mo(Rt):(Rt=Fn(O)?Zr:gr.current,Rt=Zn(k,Rt));var ys=O.getDerivedStateFromProps;(Lr=typeof ys=="function"||typeof je.getSnapshotBeforeUpdate=="function")||typeof je.UNSAFE_componentWillReceiveProps!="function"&&typeof je.componentWillReceiveProps!="function"||(xt!==yn||Er!==Rt)&&Kg(k,je,V,Rt),Ro=!1,Er=k.memoizedState,je.state=Er,ju(k,V,je,ee);var ts=k.memoizedState;xt!==yn||Er!==ts||pn.current||Ro?(typeof ys=="function"&&(Mx(k,O,ys,V),ts=k.memoizedState),(cr=Ro||Bb(k,O,cr,V,Er,ts,Rt)||!1)?(Lr||typeof je.UNSAFE_componentWillUpdate!="function"&&typeof je.componentWillUpdate!="function"||(typeof je.componentWillUpdate=="function"&&je.componentWillUpdate(V,ts,Rt),typeof je.UNSAFE_componentWillUpdate=="function"&&je.UNSAFE_componentWillUpdate(V,ts,Rt)),typeof je.componentDidUpdate=="function"&&(k.flags|=4),typeof je.getSnapshotBeforeUpdate=="function"&&(k.flags|=1024)):(typeof je.componentDidUpdate!="function"||xt===S.memoizedProps&&Er===S.memoizedState||(k.flags|=4),typeof je.getSnapshotBeforeUpdate!="function"||xt===S.memoizedProps&&Er===S.memoizedState||(k.flags|=1024),k.memoizedProps=V,k.memoizedState=ts),je.props=V,je.state=ts,je.context=Rt,V=cr):(typeof je.componentDidUpdate!="function"||xt===S.memoizedProps&&Er===S.memoizedState||(k.flags|=4),typeof je.getSnapshotBeforeUpdate!="function"||xt===S.memoizedProps&&Er===S.memoizedState||(k.flags|=1024),V=!1)}return vi(S,k,O,V,ce,ee)}function vi(S,k,O,V,ee,ce){is(S,k);var je=(k.flags&128)!==0;if(!V&&!je)return ee&&On(k,O,!1),Zc(S,k,ce);V=k.stateNode,Hh.current=k;var xt=je&&typeof O.getDerivedStateFromError!="function"?null:V.render();return k.flags|=1,S!==null&&je?(k.child=Td(k,S.child,null,ce),k.child=Td(k,null,xt,ce)):Wa(S,k,xt,ce),k.memoizedState=V.state,ee&&On(k,O,!0),k.child}function Iu(S){var k=S.stateNode;k.pendingContext?Dt(S,k.pendingContext,k.pendingContext!==k.context):k.context&&Dt(S,k.context,!1),Lg(S,k.containerInfo)}function Ld(S,k,O,V,ee){return kd(),fx(ee),k.flags|=256,Wa(S,k,O,V),k.child}var bi={dehydrated:null,treeContext:null,retryLane:0};function nf(S){return{baseLanes:S,cachePool:null,transitions:null}}function Rx(S,k,O){var V=k.pendingProps,ee=Bs.current,ce=!1,je=(k.flags&128)!==0,xt;if((xt=je)||(xt=S!==null&&S.memoizedState===null?!1:(ee&2)!==0),xt?(ce=!0,k.flags&=-129):(S===null||S.memoizedState!==null)&&(ee|=1),$r(Bs,ee&1),S===null)return dx(k),S=k.memoizedState,S!==null&&(S=S.dehydrated,S!==null)?((k.mode&1)===0?k.lanes=1:yr(S)?k.lanes=8:k.lanes=1073741824,null):(je=V.children,S=V.fallback,ce?(V=k.mode,ce=k.child,je={mode:"hidden",children:je},(V&1)===0&&ce!==null?(ce.childLanes=0,ce.pendingProps=je):ce=vf(je,V,0,null),S=ii(S,V,O,null),ce.return=k,S.return=k,ce.sibling=S,k.child=ce,k.child.memoizedState=nf(O),k.memoizedState=bi,S):Jg(k,je));if(ee=S.memoizedState,ee!==null&&(xt=ee.dehydrated,xt!==null))return Wb(S,k,je,V,xt,ee,O);if(ce){ce=V.fallback,je=k.mode,ee=S.child,xt=ee.sibling;var Rt={mode:"hidden",children:V.children};return(je&1)===0&&k.child!==ee?(V=k.child,V.childLanes=0,V.pendingProps=Rt,k.deletions=null):(V=Vu(ee,Rt),V.subtreeFlags=ee.subtreeFlags&14680064),xt!==null?ce=Vu(xt,ce):(ce=ii(ce,je,O,null),ce.flags|=2),ce.return=k,V.return=k,V.sibling=ce,k.child=V,V=ce,ce=k.child,je=S.child.memoizedState,je=je===null?nf(O):{baseLanes:je.baseLanes|O,cachePool:null,transitions:je.transitions},ce.memoizedState=je,ce.childLanes=S.childLanes&~O,k.memoizedState=bi,V}return ce=S.child,S=ce.sibling,V=Vu(ce,{mode:"visible",children:V.children}),(k.mode&1)===0&&(V.lanes=O),V.return=k,V.sibling=null,S!==null&&(O=k.deletions,O===null?(k.deletions=[S],k.flags|=16):O.push(S)),k.child=V,k.memoizedState=null,V}function Jg(S,k){return k=vf({mode:"visible",children:k},S.mode,0,null),k.return=S,S.child=k}function Bd(S,k,O,V){return V!==null&&fx(V),Td(k,S.child,null,O),S=Jg(k,k.pendingProps.children),S.flags|=2,k.memoizedState=null,S}function Wb(S,k,O,V,ee,ce,je){if(O)return k.flags&256?(k.flags&=-257,V=Ou(Error(i(422))),Bd(S,k,je,V)):k.memoizedState!==null?(k.child=S.child,k.flags|=128,null):(ce=V.fallback,ee=k.mode,V=vf({mode:"visible",children:V.children},ee,0,null),ce=ii(ce,ee,je,null),ce.flags|=2,V.return=k,ce.return=k,V.sibling=ce,k.child=V,(k.mode&1)!==0&&Td(k,S.child,null,je),k.child.memoizedState=nf(je),k.memoizedState=bi,ce);if((k.mode&1)===0)return Bd(S,k,je,null);if(yr(ee))return V=Br(ee).digest,ce=Error(i(419)),V=Ou(ce,V,void 0),Bd(S,k,je,V);if(O=(je&S.childLanes)!==0,Ea||O){if(V=os,V!==null){switch(je&-je){case 4:ee=2;break;case 16:ee=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:ee=32;break;case 536870912:ee=268435456;break;default:ee=0}ee=(ee&(V.suspendedLanes|je))!==0?0:ee,ee!==0&&ee!==ce.retryLane&&(ce.retryLane=ee,Rl(S,ee),_i(V,S,ee,-1))}return xf(),V=Ou(Error(i(421))),Bd(S,k,je,V)}return Rr(ee)?(k.flags|=128,k.child=S.child,k=Jb.bind(null,S),me(ee,k),null):(S=ce.treeContext,Ee&&($i=ue(ee),ni=k,Ss=!0,Ml=null,Rh=!1,S!==null&&(Bi[Fo++]=uo,Bi[Fo++]=Pl,Bi[Fo++]=Ta,uo=S.id,Pl=S.overflow,Ta=k)),k=Jg(k,V.children),k.flags|=4096,k)}function lc(S,k,O){S.lanes|=k;var V=S.alternate;V!==null&&(V.lanes|=k),Nd(S.return,k,O)}function sf(S,k,O,V,ee){var ce=S.memoizedState;ce===null?S.memoizedState={isBackwards:k,rendering:null,renderingStartTime:0,last:V,tail:O,tailMode:ee}:(ce.isBackwards=k,ce.rendering=null,ce.renderingStartTime=0,ce.last=V,ce.tail=O,ce.tailMode=ee)}function Qg(S,k,O){var V=k.pendingProps,ee=V.revealOrder,ce=V.tail;if(Wa(S,k,V.children,O),V=Bs.current,(V&2)!==0)V=V&1|2,k.flags|=128;else{if(S!==null&&(S.flags&128)!==0)e:for(S=k.child;S!==null;){if(S.tag===13)S.memoizedState!==null&&lc(S,O,k);else if(S.tag===19)lc(S,O,k);else if(S.child!==null){S.child.return=S,S=S.child;continue}if(S===k)break e;for(;S.sibling===null;){if(S.return===null||S.return===k)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}V&=1}if($r(Bs,V),(k.mode&1)===0)k.memoizedState=null;else switch(ee){case"forwards":for(O=k.child,ee=null;O!==null;)S=O.alternate,S!==null&&Bg(S)===null&&(ee=O),O=O.sibling;O=ee,O===null?(ee=k.child,k.child=null):(ee=O.sibling,O.sibling=null),sf(k,!1,ee,O,ce);break;case"backwards":for(O=null,ee=k.child,k.child=null;ee!==null;){if(S=ee.alternate,S!==null&&Bg(S)===null){k.child=ee;break}S=ee.sibling,ee.sibling=O,O=ee,ee=S}sf(k,!0,O,null,ce);break;case"together":sf(k,!1,null,null,void 0);break;default:k.memoizedState=null}return k.child}function Gh(S,k){(k.mode&1)===0&&S!==null&&(S.alternate=null,k.alternate=null,k.flags|=2)}function Zc(S,k,O){if(S!==null&&(k.dependencies=S.dependencies),tu|=k.lanes,(O&k.childLanes)===0)return null;if(S!==null&&k.child!==S.child)throw Error(i(153));if(k.child!==null){for(S=k.child,O=Vu(S,S.pendingProps),k.child=O,O.return=k;S.sibling!==null;)S=S.sibling,O=O.sibling=Vu(S,S.pendingProps),O.return=k;O.sibling=null}return k.child}function Lu(S,k,O){switch(k.tag){case 3:Iu(k),kd();break;case 5:xx(k);break;case 1:Fn(k.type)&&Kr(k);break;case 4:Lg(k,k.stateNode.containerInfo);break;case 10:Fb(k,k.type._context,k.memoizedProps.value);break;case 13:var V=k.memoizedState;if(V!==null)return V.dehydrated!==null?($r(Bs,Bs.current&1),k.flags|=128,null):(O&k.child.childLanes)!==0?Rx(S,k,O):($r(Bs,Bs.current&1),S=Zc(S,k,O),S!==null?S.sibling:null);$r(Bs,Bs.current&1);break;case 19:if(V=(O&k.childLanes)!==0,(S.flags&128)!==0){if(V)return Qg(S,k,O);k.flags|=128}var ee=k.memoizedState;if(ee!==null&&(ee.rendering=null,ee.tail=null,ee.lastEffect=null),$r(Bs,Bs.current),V)break;return null;case 22:case 23:return k.lanes=0,ps(S,k,O)}return Zc(S,k,O)}function Ui(S){S.flags|=4}function $d(S,k){if(S!==null&&S.child===k.child)return!0;if((k.flags&16)!==0)return!1;for(S=k.child;S!==null;){if((S.flags&12854)!==0||(S.subtreeFlags&12854)!==0)return!1;S=S.sibling}return!0}var Bu,$u,zi,Wi;if(we)Bu=function(S,k){for(var O=k.child;O!==null;){if(O.tag===5||O.tag===6)R(S,O.stateNode);else if(O.tag!==4&&O.child!==null){O.child.return=O,O=O.child;continue}if(O===k)break;for(;O.sibling===null;){if(O.return===null||O.return===k)return;O=O.return}O.sibling.return=O.return,O=O.sibling}},$u=function(){},zi=function(S,k,O,V,ee){if(S=S.memoizedProps,S!==V){var ce=k.stateNode,je=il(al.current);O=G(ce,O,S,V,ee,je),(k.updateQueue=O)&&Ui(k)}},Wi=function(S,k,O,V){O!==V&&Ui(k)};else if(ie){Bu=function(S,k,O,V){for(var ee=k.child;ee!==null;){if(ee.tag===5){var ce=ee.stateNode;O&&V&&(ce=st(ce,ee.type,ee.memoizedProps,ee)),R(S,ce)}else if(ee.tag===6)ce=ee.stateNode,O&&V&&(ce=dt(ce,ee.memoizedProps,ee)),R(S,ce);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)ce=ee.child,ce!==null&&(ce.return=ee),Bu(S,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===k)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===k)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};var Uu=function(S,k,O,V){for(var ee=k.child;ee!==null;){if(ee.tag===5){var ce=ee.stateNode;O&&V&&(ce=st(ce,ee.type,ee.memoizedProps,ee)),Ct(S,ce)}else if(ee.tag===6)ce=ee.stateNode,O&&V&&(ce=dt(ce,ee.memoizedProps,ee)),Ct(S,ce);else if(ee.tag!==4){if(ee.tag===22&&ee.memoizedState!==null)ce=ee.child,ce!==null&&(ce.return=ee),Uu(S,ee,!0,!0);else if(ee.child!==null){ee.child.return=ee,ee=ee.child;continue}}if(ee===k)break;for(;ee.sibling===null;){if(ee.return===null||ee.return===k)return;ee=ee.return}ee.sibling.return=ee.return,ee=ee.sibling}};$u=function(S,k){var O=k.stateNode;if(!$d(S,k)){S=O.containerInfo;var V=lt(S);Uu(V,k,!1,!1),O.pendingChildren=V,Ui(k),Lt(S,V)}},zi=function(S,k,O,V,ee){var ce=S.stateNode,je=S.memoizedProps;if((S=$d(S,k))&&je===V)k.stateNode=ce;else{var xt=k.stateNode,Rt=il(al.current),cr=null;je!==V&&(cr=G(xt,O,je,V,ee,Rt)),S&&cr===null?k.stateNode=ce:(ce=Pe(ce,cr,O,je,V,k,S,xt),L(ce,O,V,ee,Rt)&&Ui(k),k.stateNode=ce,S?Ui(k):Bu(ce,k,!1,!1))}},Wi=function(S,k,O,V){O!==V?(S=il(Fu.current),O=il(al.current),k.stateNode=Q(V,S,O,k),Ui(k)):k.stateNode=S.stateNode}}else $u=function(){},zi=function(){},Wi=function(){};function Io(S,k){if(!Ss)switch(S.tailMode){case"hidden":k=S.tail;for(var O=null;k!==null;)k.alternate!==null&&(O=k),k=k.sibling;O===null?S.tail=null:O.sibling=null;break;case"collapsed":O=S.tail;for(var V=null;O!==null;)O.alternate!==null&&(V=O),O=O.sibling;V===null?k||S.tail===null?S.tail=null:S.tail.sibling=null:V.sibling=null}}function js(S){var k=S.alternate!==null&&S.alternate.child===S.child,O=0,V=0;if(k)for(var ee=S.child;ee!==null;)O|=ee.lanes|ee.childLanes,V|=ee.subtreeFlags&14680064,V|=ee.flags&14680064,ee.return=S,ee=ee.sibling;else for(ee=S.child;ee!==null;)O|=ee.lanes|ee.childLanes,V|=ee.subtreeFlags,V|=ee.flags,ee.return=S,ee=ee.sibling;return S.subtreeFlags|=V,S.childLanes=O,k}function Ud(S,k,O){var V=k.pendingProps;switch(Mh(k),k.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(k),null;case 1:return Fn(k.type)&&Ce(),js(k),null;case 3:return O=k.stateNode,Ed(),qr(pn),qr(gr),bx(),O.pendingContext&&(O.context=O.pendingContext,O.pendingContext=null),(S===null||S.child===null)&&(Fg(k)?Ui(k):S===null||S.memoizedState.isDehydrated&&(k.flags&256)===0||(k.flags|=1024,Ml!==null&&(up(Ml),Ml=null))),$u(S,k),js(k),null;case 5:yx(k),O=il(Fu.current);var ee=k.type;if(S!==null&&k.stateNode!=null)zi(S,k,ee,V,O),S.ref!==k.ref&&(k.flags|=512,k.flags|=2097152);else{if(!V){if(k.stateNode===null)throw Error(i(166));return js(k),null}if(S=il(al.current),Fg(k)){if(!Ee)throw Error(i(175));S=ge(k.stateNode,k.type,k.memoizedProps,O,S,k,!Rh),k.updateQueue=S,S!==null&&Ui(k)}else{var ce=H(ee,V,O,S,k);Bu(ce,k,!1,!1),k.stateNode=ce,L(ce,ee,V,O,S)&&Ui(k)}k.ref!==null&&(k.flags|=512,k.flags|=2097152)}return js(k),null;case 6:if(S&&k.stateNode!=null)Wi(S,k,S.memoizedProps,V);else{if(typeof V!="string"&&k.stateNode===null)throw Error(i(166));if(S=il(Fu.current),O=il(al.current),Fg(k)){if(!Ee)throw Error(i(176));if(S=k.stateNode,O=k.memoizedProps,(V=Me(S,O,k,!Rh))&&(ee=ni,ee!==null))switch(ee.tag){case 3:Le(ee.stateNode.containerInfo,S,O,(ee.mode&1)!==0);break;case 5:tt(ee.type,ee.memoizedProps,ee.stateNode,S,O,(ee.mode&1)!==0)}V&&Ui(k)}else k.stateNode=Q(V,S,O,k)}return js(k),null;case 13:if(qr(Bs),V=k.memoizedState,S===null||S.memoizedState!==null&&S.memoizedState.dehydrated!==null){if(Ss&&$i!==null&&(k.mode&1)!==0&&(k.flags&128)===0)Eb(),kd(),k.flags|=98560,ee=!1;else if(ee=Fg(k),V!==null&&V.dehydrated!==null){if(S===null){if(!ee)throw Error(i(318));if(!Ee)throw Error(i(344));if(ee=k.memoizedState,ee=ee!==null?ee.dehydrated:null,!ee)throw Error(i(317));ot(ee,k)}else kd(),(k.flags&128)===0&&(k.memoizedState=null),k.flags|=4;js(k),ee=!1}else Ml!==null&&(up(Ml),Ml=null),ee=!0;if(!ee)return k.flags&65536?k:null}return(k.flags&128)!==0?(k.lanes=O,k):(O=V!==null,O!==(S!==null&&S.memoizedState!==null)&&O&&(k.child.flags|=8192,(k.mode&1)!==0&&(S===null||(Bs.current&1)!==0?Fs===0&&(Fs=3):xf())),k.updateQueue!==null&&(k.flags|=4),js(k),null);case 4:return Ed(),$u(S,k),S===null&&Ie(k.stateNode.containerInfo),js(k),null;case 10:return Oh(k.type._context),js(k),null;case 17:return Fn(k.type)&&Ce(),js(k),null;case 19:if(qr(Bs),ee=k.memoizedState,ee===null)return js(k),null;if(V=(k.flags&128)!==0,ce=ee.rendering,ce===null)if(V)Io(ee,!1);else{if(Fs!==0||S!==null&&(S.flags&128)!==0)for(S=k.child;S!==null;){if(ce=Bg(S),ce!==null){for(k.flags|=128,Io(ee,!1),S=ce.updateQueue,S!==null&&(k.updateQueue=S,k.flags|=4),k.subtreeFlags=0,S=O,O=k.child;O!==null;)V=O,ee=S,V.flags&=14680066,ce=V.alternate,ce===null?(V.childLanes=0,V.lanes=ee,V.child=null,V.subtreeFlags=0,V.memoizedProps=null,V.memoizedState=null,V.updateQueue=null,V.dependencies=null,V.stateNode=null):(V.childLanes=ce.childLanes,V.lanes=ce.lanes,V.child=ce.child,V.subtreeFlags=0,V.deletions=null,V.memoizedProps=ce.memoizedProps,V.memoizedState=ce.memoizedState,V.updateQueue=ce.updateQueue,V.type=ce.type,ee=ce.dependencies,V.dependencies=ee===null?null:{lanes:ee.lanes,firstContext:ee.firstContext}),O=O.sibling;return $r(Bs,Bs.current&1|2),k.child}S=S.sibling}ee.tail!==null&&Sn()>Qh&&(k.flags|=128,V=!0,Io(ee,!1),k.lanes=4194304)}else{if(!V)if(S=Bg(ce),S!==null){if(k.flags|=128,V=!0,S=S.updateQueue,S!==null&&(k.updateQueue=S,k.flags|=4),Io(ee,!0),ee.tail===null&&ee.tailMode==="hidden"&&!ce.alternate&&!Ss)return js(k),null}else 2*Sn()-ee.renderingStartTime>Qh&&O!==1073741824&&(k.flags|=128,V=!0,Io(ee,!1),k.lanes=4194304);ee.isBackwards?(ce.sibling=k.child,k.child=ce):(S=ee.last,S!==null?S.sibling=ce:k.child=ce,ee.last=ce)}return ee.tail!==null?(k=ee.tail,ee.rendering=k,ee.tail=k.sibling,ee.renderingStartTime=Sn(),k.sibling=null,S=Bs.current,$r(Bs,V?S&1|2:S&1),k):(js(k),null);case 22:case 23:return dp(),O=k.memoizedState!==null,S!==null&&S.memoizedState!==null!==O&&(k.flags|=8192),O&&(k.mode&1)!==0?(Aa&1073741824)!==0&&(js(k),we&&k.subtreeFlags&6&&(k.flags|=8192)):js(k),null;case 24:return null;case 25:return null}throw Error(i(156,k.tag))}function Hb(S,k){switch(Mh(k),k.tag){case 1:return Fn(k.type)&&Ce(),S=k.flags,S&65536?(k.flags=S&-65537|128,k):null;case 3:return Ed(),qr(pn),qr(gr),bx(),S=k.flags,(S&65536)!==0&&(S&128)===0?(k.flags=S&-65537|128,k):null;case 5:return yx(k),null;case 13:if(qr(Bs),S=k.memoizedState,S!==null&&S.dehydrated!==null){if(k.alternate===null)throw Error(i(340));kd()}return S=k.flags,S&65536?(k.flags=S&-65537|128,k):null;case 19:return qr(Bs),null;case 4:return Ed(),null;case 10:return Oh(k.type._context),null;case 22:case 23:return dp(),null;case 24:return null;default:return null}}var af=!1,Ha=!1,Lo=typeof WeakSet=="function"?WeakSet:Set,Nr=null;function es(S,k){var O=S.ref;if(O!==null)if(typeof O=="function")try{O(null)}catch(V){Cs(S,k,V)}else O.current=null}function Bo(S,k,O){try{O()}catch(V){Cs(S,k,V)}}var Ox=!1;function Gb(S,k){for(z(S.containerInfo),Nr=k;Nr!==null;)if(S=Nr,k=S.child,(S.subtreeFlags&1028)!==0&&k!==null)k.return=S,Nr=k;else for(;Nr!==null;){S=Nr;try{var O=S.alternate;if((S.flags&1024)!==0)switch(S.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var V=O.memoizedProps,ee=O.memoizedState,ce=S.stateNode,je=ce.getSnapshotBeforeUpdate(S.elementType===S.type?V:Do(S.type,V),ee);ce.__reactInternalSnapshotBeforeUpdate=je}break;case 3:we&&Be(S.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(i(163))}}catch(xt){Cs(S,S.return,xt)}if(k=S.sibling,k!==null){k.return=S.return,Nr=k;break}Nr=S.return}return O=Ox,Ox=!1,O}function zd(S,k,O){var V=k.updateQueue;if(V=V!==null?V.lastEffect:null,V!==null){var ee=V=V.next;do{if((ee.tag&S)===S){var ce=ee.destroy;ee.destroy=void 0,ce!==void 0&&Bo(k,O,ce)}ee=ee.next}while(ee!==V)}}function of(S,k){if(k=k.updateQueue,k=k!==null?k.lastEffect:null,k!==null){var O=k=k.next;do{if((O.tag&S)===S){var V=O.create;O.destroy=V()}O=O.next}while(O!==k)}}function Zg(S){var k=S.ref;if(k!==null){var O=S.stateNode;switch(S.tag){case 5:S=Z(O);break;default:S=O}typeof k=="function"?k(S):k.current=S}}function Vh(S){var k=S.alternate;k!==null&&(S.alternate=null,Vh(k)),S.child=null,S.deletions=null,S.sibling=null,S.tag===5&&(k=S.stateNode,k!==null&&Qe(k)),S.stateNode=null,S.return=null,S.dependencies=null,S.memoizedProps=null,S.memoizedState=null,S.pendingProps=null,S.stateNode=null,S.updateQueue=null}function Dx(S){return S.tag===5||S.tag===3||S.tag===4}function Wd(S){e:for(;;){for(;S.sibling===null;){if(S.return===null||Dx(S.return))return null;S=S.return}for(S.sibling.return=S.return,S=S.sibling;S.tag!==5&&S.tag!==6&&S.tag!==18;){if(S.flags&2||S.child===null||S.tag===4)continue e;S.child.return=S,S=S.child}if(!(S.flags&2))return S.stateNode}}function qh(S,k,O){var V=S.tag;if(V===5||V===6)S=S.stateNode,k?At(O,S,k):rt(O,S);else if(V!==4&&(S=S.child,S!==null))for(qh(S,k,O),S=S.sibling;S!==null;)qh(S,k,O),S=S.sibling}function Ix(S,k,O){var V=S.tag;if(V===5||V===6)S=S.stateNode,k?It(O,S,k):yt(O,S);else if(V!==4&&(S=S.child,S!==null))for(Ix(S,k,O),S=S.sibling;S!==null;)Ix(S,k,O),S=S.sibling}var ra=null,ho=!1;function Ol(S,k,O){for(O=O.child;O!==null;)ep(S,k,O),O=O.sibling}function ep(S,k,O){if(co&&typeof co.onCommitFiberUnmount=="function")try{co.onCommitFiberUnmount(Nu,O)}catch{}switch(O.tag){case 5:Ha||es(O,k);case 6:if(we){var V=ra,ee=ho;ra=null,Ol(S,k,O),ra=V,ho=ee,ra!==null&&(ho?ar(ra,O.stateNode):tr(ra,O.stateNode))}else Ol(S,k,O);break;case 18:we&&ra!==null&&(ho?Se(ra,O.stateNode):de(ra,O.stateNode));break;case 4:we?(V=ra,ee=ho,ra=O.stateNode.containerInfo,ho=!0,Ol(S,k,O),ra=V,ho=ee):(ie&&(V=O.stateNode.containerInfo,ee=lt(V),Ue(V,ee)),Ol(S,k,O));break;case 0:case 11:case 14:case 15:if(!Ha&&(V=O.updateQueue,V!==null&&(V=V.lastEffect,V!==null))){ee=V=V.next;do{var ce=ee,je=ce.destroy;ce=ce.tag,je!==void 0&&((ce&2)!==0||(ce&4)!==0)&&Bo(O,k,je),ee=ee.next}while(ee!==V)}Ol(S,k,O);break;case 1:if(!Ha&&(es(O,k),V=O.stateNode,typeof V.componentWillUnmount=="function"))try{V.props=O.memoizedProps,V.state=O.memoizedState,V.componentWillUnmount()}catch(xt){Cs(O,k,xt)}Ol(S,k,O);break;case 21:Ol(S,k,O);break;case 22:O.mode&1?(Ha=(V=Ha)||O.memoizedState!==null,Ol(S,k,O),Ha=V):Ol(S,k,O);break;default:Ol(S,k,O)}}function Hd(S){var k=S.updateQueue;if(k!==null){S.updateQueue=null;var O=S.stateNode;O===null&&(O=S.stateNode=new Lo),k.forEach(function(V){var ee=G3.bind(null,S,V);O.has(V)||(O.add(V),V.then(ee,ee))})}}function ll(S,k){var O=k.deletions;if(O!==null)for(var V=0;V<O.length;V++){var ee=O[V];try{var ce=S,je=k;if(we){var xt=je;e:for(;xt!==null;){switch(xt.tag){case 5:ra=xt.stateNode,ho=!1;break e;case 3:ra=xt.stateNode.containerInfo,ho=!0;break e;case 4:ra=xt.stateNode.containerInfo,ho=!0;break e}xt=xt.return}if(ra===null)throw Error(i(160));ep(ce,je,ee),ra=null,ho=!1}else ep(ce,je,ee);var Rt=ee.alternate;Rt!==null&&(Rt.return=null),ee.return=null}catch(cr){Cs(ee,k,cr)}}if(k.subtreeFlags&12854)for(k=k.child;k!==null;)Kh(k,S),k=k.sibling}function Kh(S,k){var O=S.alternate,V=S.flags;switch(S.tag){case 0:case 11:case 14:case 15:if(ll(k,S),$o(S),V&4){try{zd(3,S,S.return),of(3,S)}catch(Er){Cs(S,S.return,Er)}try{zd(5,S,S.return)}catch(Er){Cs(S,S.return,Er)}}break;case 1:ll(k,S),$o(S),V&512&&O!==null&&es(O,O.return);break;case 5:if(ll(k,S),$o(S),V&512&&O!==null&&es(O,O.return),we){if(S.flags&32){var ee=S.stateNode;try{dr(ee)}catch(Er){Cs(S,S.return,Er)}}if(V&4&&(ee=S.stateNode,ee!=null)){var ce=S.memoizedProps;if(O=O!==null?O.memoizedProps:ce,V=S.type,k=S.updateQueue,S.updateQueue=null,k!==null)try{Mt(ee,k,V,O,ce,S)}catch(Er){Cs(S,S.return,Er)}}}break;case 6:if(ll(k,S),$o(S),V&4&&we){if(S.stateNode===null)throw Error(i(162));ee=S.stateNode,ce=S.memoizedProps,O=O!==null?O.memoizedProps:ce;try{Oe(ee,O,ce)}catch(Er){Cs(S,S.return,Er)}}break;case 3:if(ll(k,S),$o(S),V&4){if(we&&Ee&&O!==null&&O.memoizedState.isDehydrated)try{nt(k.containerInfo)}catch(Er){Cs(S,S.return,Er)}if(ie){ee=k.containerInfo,ce=k.pendingChildren;try{Ue(ee,ce)}catch(Er){Cs(S,S.return,Er)}}}break;case 4:if(ll(k,S),$o(S),V&4&&ie){ce=S.stateNode,ee=ce.containerInfo,ce=ce.pendingChildren;try{Ue(ee,ce)}catch(Er){Cs(S,S.return,Er)}}break;case 13:ll(k,S),$o(S),ee=S.child,ee.flags&8192&&(ce=ee.memoizedState!==null,ee.stateNode.isHidden=ce,!ce||ee.alternate!==null&&ee.alternate.memoizedState!==null||(hf=Sn())),V&4&&Hd(S);break;case 22:var je=O!==null&&O.memoizedState!==null;if(S.mode&1?(Ha=(O=Ha)||je,ll(k,S),Ha=O):ll(k,S),$o(S),V&8192){if(O=S.memoizedState!==null,(S.stateNode.isHidden=O)&&!je&&(S.mode&1)!==0)for(Nr=S,V=S.child;V!==null;){for(k=Nr=V;Nr!==null;){je=Nr;var xt=je.child;switch(je.tag){case 0:case 11:case 14:case 15:zd(4,je,je.return);break;case 1:es(je,je.return);var Rt=je.stateNode;if(typeof Rt.componentWillUnmount=="function"){var cr=je,Lr=je.return;try{var yn=cr;Rt.props=yn.memoizedProps,Rt.state=yn.memoizedState,Rt.componentWillUnmount()}catch(Er){Cs(cr,Lr,Er)}}break;case 5:es(je,je.return);break;case 22:if(je.memoizedState!==null){np(k);continue}}xt!==null?(xt.return=je,Nr=xt):np(k)}V=V.sibling}if(we){e:if(V=null,we)for(k=S;;){if(k.tag===5){if(V===null){V=k;try{ee=k.stateNode,O?or(ee):ve(k.stateNode,k.memoizedProps)}catch(Er){Cs(S,S.return,Er)}}}else if(k.tag===6){if(V===null)try{ce=k.stateNode,O?mr(ce):Fe(ce,k.memoizedProps)}catch(Er){Cs(S,S.return,Er)}}else if((k.tag!==22&&k.tag!==23||k.memoizedState===null||k===S)&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===S)break e;for(;k.sibling===null;){if(k.return===null||k.return===S)break e;V===k&&(V=null),k=k.return}V===k&&(V=null),k.sibling.return=k.return,k=k.sibling}}}break;case 19:ll(k,S),$o(S),V&4&&Hd(S);break;case 21:break;default:ll(k,S),$o(S)}}function $o(S){var k=S.flags;if(k&2){try{if(we){e:{for(var O=S.return;O!==null;){if(Dx(O)){var V=O;break e}O=O.return}throw Error(i(160))}switch(V.tag){case 5:var ee=V.stateNode;V.flags&32&&(dr(ee),V.flags&=-33);var ce=Wd(S);Ix(S,ce,ee);break;case 3:case 4:var je=V.stateNode.containerInfo,xt=Wd(S);qh(S,xt,je);break;default:throw Error(i(161))}}}catch(Rt){Cs(S,S.return,Rt)}S.flags&=-3}k&4096&&(S.flags&=-4097)}function lf(S,k,O){Nr=S,tp(S)}function tp(S,k,O){for(var V=(S.mode&1)!==0;Nr!==null;){var ee=Nr,ce=ee.child;if(ee.tag===22&&V){var je=ee.memoizedState!==null||af;if(!je){var xt=ee.alternate,Rt=xt!==null&&xt.memoizedState!==null||Ha;xt=af;var cr=Ha;if(af=je,(Ha=Rt)&&!cr)for(Nr=ee;Nr!==null;)je=Nr,Rt=je.child,je.tag===22&&je.memoizedState!==null?sp(ee):Rt!==null?(Rt.return=je,Nr=Rt):sp(ee);for(;ce!==null;)Nr=ce,tp(ce),ce=ce.sibling;Nr=ee,af=xt,Ha=cr}rp(S)}else(ee.subtreeFlags&8772)!==0&&ce!==null?(ce.return=ee,Nr=ce):rp(S)}}function rp(S){for(;Nr!==null;){var k=Nr;if((k.flags&8772)!==0){var O=k.alternate;try{if((k.flags&8772)!==0)switch(k.tag){case 0:case 11:case 15:Ha||of(5,k);break;case 1:var V=k.stateNode;if(k.flags&4&&!Ha)if(O===null)V.componentDidMount();else{var ee=k.elementType===k.type?O.memoizedProps:Do(k.type,O.memoizedProps);V.componentDidUpdate(ee,O.memoizedState,V.__reactInternalSnapshotBeforeUpdate)}var ce=k.updateQueue;ce!==null&&Rb(k,ce,V);break;case 3:var je=k.updateQueue;if(je!==null){if(O=null,k.child!==null)switch(k.child.tag){case 5:O=Z(k.child.stateNode);break;case 1:O=k.child.stateNode}Rb(k,je,O)}break;case 5:var xt=k.stateNode;O===null&&k.flags&4&&$e(xt,k.type,k.memoizedProps,k);break;case 6:break;case 4:break;case 12:break;case 13:if(Ee&&k.memoizedState===null){var Rt=k.alternate;if(Rt!==null){var cr=Rt.memoizedState;if(cr!==null){var Lr=cr.dehydrated;Lr!==null&&mt(Lr)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(i(163))}Ha||k.flags&512&&Zg(k)}catch(yn){Cs(k,k.return,yn)}}if(k===S){Nr=null;break}if(O=k.sibling,O!==null){O.return=k.return,Nr=O;break}Nr=k.return}}function np(S){for(;Nr!==null;){var k=Nr;if(k===S){Nr=null;break}var O=k.sibling;if(O!==null){O.return=k.return,Nr=O;break}Nr=k.return}}function sp(S){for(;Nr!==null;){var k=Nr;try{switch(k.tag){case 0:case 11:case 15:var O=k.return;try{of(4,k)}catch(Rt){Cs(k,O,Rt)}break;case 1:var V=k.stateNode;if(typeof V.componentDidMount=="function"){var ee=k.return;try{V.componentDidMount()}catch(Rt){Cs(k,ee,Rt)}}var ce=k.return;try{Zg(k)}catch(Rt){Cs(k,ce,Rt)}break;case 5:var je=k.return;try{Zg(k)}catch(Rt){Cs(k,je,Rt)}}}catch(Rt){Cs(k,k.return,Rt)}if(k===S){Nr=null;break}var xt=k.sibling;if(xt!==null){xt.return=k.return,Nr=xt;break}Nr=k.return}}var eu=0,Hi=1,cc=2,cf=3,Yh=4;if(typeof Symbol=="function"&&Symbol.for){var Uo=Symbol.for;eu=Uo("selector.component"),Hi=Uo("selector.has_pseudo_class"),cc=Uo("selector.role"),cf=Uo("selector.test_id"),Yh=Uo("selector.text")}function uc(S){var k=ye(S);if(k!=null){if(typeof k.memoizedProps["data-testname"]!="string")throw Error(i(364));return k}if(S=vt(S),S===null)throw Error(i(362));return S.stateNode.current}function Xh(S,k){switch(k.$$typeof){case eu:if(S.type===k.value)return!0;break;case Hi:e:{k=k.value,S=[S,0];for(var O=0;O<S.length;){var V=S[O++],ee=S[O++],ce=k[ee];if(V.tag!==5||!pt(V)){for(;ce!=null&&Xh(V,ce);)ee++,ce=k[ee];if(ee===k.length){k=!0;break e}else for(V=V.child;V!==null;)S.push(V,ee),V=V.sibling}}k=!1}return k;case cc:if(S.tag===5&&wt(S.stateNode,k.value))return!0;break;case Yh:if((S.tag===5||S.tag===6)&&(S=Ve(S),S!==null&&0<=S.indexOf(k.value)))return!0;break;case cf:if(S.tag===5&&(S=S.memoizedProps["data-testname"],typeof S=="string"&&S.toLowerCase()===k.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function ap(S){switch(S.$$typeof){case eu:return"<"+(F(S.value)||"Unknown")+">";case Hi:return":has("+(ap(S)||"")+")";case cc:return'[role="'+S.value+'"]';case Yh:return'"'+S.value+'"';case cf:return'[data-testname="'+S.value+'"]';default:throw Error(i(365))}}function dc(S,k){var O=[];S=[S,0];for(var V=0;V<S.length;){var ee=S[V++],ce=S[V++],je=k[ce];if(ee.tag!==5||!pt(ee)){for(;je!=null&&Xh(ee,je);)ce++,je=k[ce];if(ce===k.length)O.push(ee);else for(ee=ee.child;ee!==null;)S.push(ee,ce),ee=ee.sibling}}return O}function fc(S,k){if(!et)throw Error(i(363));S=uc(S),S=dc(S,k),k=[],S=Array.from(S);for(var O=0;O<S.length;){var V=S[O++];if(V.tag===5)pt(V)||k.push(V.stateNode);else for(V=V.child;V!==null;)S.push(V),V=V.sibling}return k}var ip=Math.ceil,Jh=o.ReactCurrentDispatcher,uf=o.ReactCurrentOwner,Ks=o.ReactCurrentBatchConfig,bn=0,os=null,Ps=null,na=0,Aa=0,zu=Tr(0),Fs=0,df=null,tu=0,xs=0,ff=0,Gd=null,wi=null,hf=0,Qh=1/0,Gi=null;function ss(){Qh=Sn()+500}var Ys=!1,ha=null,Dl=null,Wu=!1,cl=null,op=0,ma=0,Zh=null,mf=-1,gf=0;function ks(){return(bn&6)!==0?Sn():mf!==-1?mf:mf=Sn()}function ja(S){return(S.mode&1)===0?1:(bn&2)!==0&&na!==0?na&-na:z3.transition!==null?(gf===0&&(gf=St()),gf):(S=Xe,S!==0?S:ut())}function _i(S,k,O,V){if(50<ma)throw ma=0,Zh=null,Error(i(185));jt(S,O,V),((bn&2)===0||S!==os)&&(S===os&&((bn&2)===0&&(xs|=O),Fs===4&&ru(S,na)),Si(S,V),O===1&&bn===0&&(k.mode&1)===0&&(ss(),q0&&ri()))}function Si(S,k){var O=S.callbackNode;Ye(S,k);var V=qe(S,S===os?na:0);if(V===0)O!==null&&_s(O),S.callbackNode=null,S.callbackPriority=0;else if(k=V&-V,S.callbackPriority!==k){if(O!=null&&_s(O),k===1)S.tag===0?kb(Lx.bind(null,S)):jg(Lx.bind(null,S)),$t?Ge(function(){(bn&6)===0&&ri()}):lr(jn,ri),O=null;else{switch(br(V)){case 1:O=jn;break;case 4:O=sc;break;case 16:O=Li;break;case 536870912:O=jh;break;default:O=Li}O=Gx(O,lp.bind(null,S))}S.callbackPriority=k,S.callbackNode=O}}function lp(S,k){if(mf=-1,gf=0,(bn&6)!==0)throw Error(i(327));var O=S.callbackNode;if(nu()&&S.callbackNode!==O)return null;var V=qe(S,S===os?na:0);if(V===0)return null;if((V&30)!==0||(V&S.expiredLanes)!==0||k)k=Vd(S,V);else{k=V;var ee=bn;bn|=2;var ce=$x();(os!==S||na!==k)&&(Gi=null,ss(),Hu(S,k));do try{Ux();break}catch(xt){pf(S,xt)}while(!0);mx(),Jh.current=ce,bn=ee,Ps!==null?k=0:(os=null,na=0,k=Fs)}if(k!==0){if(k===2&&(ee=Tt(S),ee!==0&&(V=ee,k=cp(S,ee))),k===1)throw O=df,Hu(S,0),ru(S,V),Si(S,Sn()),O;if(k===6)ru(S,V);else{if(ee=S.current.alternate,(V&30)===0&&!Vb(ee)&&(k=Vd(S,V),k===2&&(ce=Tt(S),ce!==0&&(V=ce,k=cp(S,ce))),k===1))throw O=df,Hu(S,0),ru(S,V),Si(S,Sn()),O;switch(S.finishedWork=ee,S.finishedLanes=V,k){case 0:case 1:throw Error(i(345));case 2:Gu(S,wi,Gi);break;case 3:if(ru(S,V),(V&130023424)===V&&(k=hf+500-Sn(),10<k)){if(qe(S,0)!==0)break;if(ee=S.suspendedLanes,(ee&V)!==V){ks(),S.pingedLanes|=S.suspendedLanes&ee;break}S.timeoutHandle=X(Gu.bind(null,S,wi,Gi),k);break}Gu(S,wi,Gi);break;case 4:if(ru(S,V),(V&4194240)===V)break;for(k=S.eventTimes,ee=-1;0<V;){var je=31-Qr(V);ce=1<<je,je=k[je],je>ee&&(ee=je),V&=~ce}if(V=ee,V=Sn()-V,V=(120>V?120:480>V?480:1080>V?1080:1920>V?1920:3e3>V?3e3:4320>V?4320:1960*ip(V/1960))-V,10<V){S.timeoutHandle=X(Gu.bind(null,S,wi,Gi),V);break}Gu(S,wi,Gi);break;case 5:Gu(S,wi,Gi);break;default:throw Error(i(329))}}}return Si(S,Sn()),S.callbackNode===O?lp.bind(null,S):null}function cp(S,k){var O=Gd;return S.current.memoizedState.isDehydrated&&(Hu(S,k).flags|=256),S=Vd(S,k),S!==2&&(k=wi,wi=O,k!==null&&up(k)),S}function up(S){wi===null?wi=S:wi.push.apply(wi,S)}function Vb(S){for(var k=S;;){if(k.flags&16384){var O=k.updateQueue;if(O!==null&&(O=O.stores,O!==null))for(var V=0;V<O.length;V++){var ee=O[V],ce=ee.getSnapshot;ee=ee.value;try{if(!jl(ce(),ee))return!1}catch{return!1}}}if(O=k.child,k.subtreeFlags&16384&&O!==null)O.return=k,k=O;else{if(k===S)break;for(;k.sibling===null;){if(k.return===null||k.return===S)return!0;k=k.return}k.sibling.return=k.return,k=k.sibling}}return!0}function ru(S,k){for(k&=~ff,k&=~xs,S.suspendedLanes|=k,S.pingedLanes&=~k,S=S.expirationTimes;0<k;){var O=31-Qr(k),V=1<<O;S[O]=-1,k&=~V}}function Lx(S){if((bn&6)!==0)throw Error(i(327));nu();var k=qe(S,0);if((k&1)===0)return Si(S,Sn()),null;var O=Vd(S,k);if(S.tag!==0&&O===2){var V=Tt(S);V!==0&&(k=V,O=cp(S,V))}if(O===1)throw O=df,Hu(S,0),ru(S,k),Si(S,Sn()),O;if(O===6)throw Error(i(345));return S.finishedWork=S.current.alternate,S.finishedLanes=k,Gu(S,wi,Gi),Si(S,Sn()),null}function Bx(S){cl!==null&&cl.tag===0&&(bn&6)===0&&nu();var k=bn;bn|=1;var O=Ks.transition,V=Xe;try{if(Ks.transition=null,Xe=1,S)return S()}finally{Xe=V,Ks.transition=O,bn=k,(bn&6)===0&&ri()}}function dp(){Aa=zu.current,qr(zu)}function Hu(S,k){S.finishedWork=null,S.finishedLanes=0;var O=S.timeoutHandle;if(O!==le&&(S.timeoutHandle=le,se(O)),Ps!==null)for(O=Ps.return;O!==null;){var V=O;switch(Mh(V),V.tag){case 1:V=V.type.childContextTypes,V!=null&&Ce();break;case 3:Ed(),qr(pn),qr(gr),bx();break;case 5:yx(V);break;case 4:Ed();break;case 13:qr(Bs);break;case 19:qr(Bs);break;case 10:Oh(V.type._context);break;case 22:case 23:dp()}O=O.return}if(os=S,Ps=S=Vu(S.current,null),na=Aa=k,Fs=0,df=null,ff=xs=tu=0,wi=Gd=null,Au!==null){for(k=0;k<Au.length;k++)if(O=Au[k],V=O.interleaved,V!==null){O.interleaved=null;var ee=V.next,ce=O.pending;if(ce!==null){var je=ce.next;ce.next=ee,V.next=je}O.pending=V}Au=null}return S}function pf(S,k){do{var O=Ps;try{if(mx(),fo.current=Od,Z0){for(var V=As.memoizedState;V!==null;){var ee=V.queue;ee!==null&&(ee.pending=null),V=V.next}Z0=!1}if(Mu=0,Na=fa=As=null,Ih=!1,Lh=0,uf.current=null,O===null||O.return===null){Fs=1,df=k,Ps=null;break}e:{var ce=S,je=O.return,xt=O,Rt=k;if(k=na,xt.flags|=32768,Rt!==null&&typeof Rt=="object"&&typeof Rt.then=="function"){var cr=Rt,Lr=xt,yn=Lr.tag;if((Lr.mode&1)===0&&(yn===0||yn===11||yn===15)){var Er=Lr.alternate;Er?(Lr.updateQueue=Er.updateQueue,Lr.memoizedState=Er.memoizedState,Lr.lanes=Er.lanes):(Lr.updateQueue=null,Lr.memoizedState=null)}var ys=zb(je);if(ys!==null){ys.flags&=-257,Du(ys,je,xt,ce,k),ys.mode&1&&Ub(ce,cr,k),k=ys,Rt=cr;var ts=k.updateQueue;if(ts===null){var Vi=new Set;Vi.add(Rt),k.updateQueue=Vi}else ts.add(Rt);break e}else{if((k&1)===0){Ub(ce,cr,k),xf();break e}Rt=Error(i(426))}}else if(Ss&&xt.mode&1){var hc=zb(je);if(hc!==null){(hc.flags&65536)===0&&(hc.flags|=256),Du(hc,je,xt,ce,k),fx(Dd(Rt,xt));break e}}ce=Rt=Dd(Rt,xt),Fs!==4&&(Fs=2),Gd===null?Gd=[ce]:Gd.push(ce),ce=je;do{switch(ce.tag){case 3:ce.flags|=65536,k&=-k,ce.lanes|=k;var Pt=ic(ce,Rt,k);J0(ce,Pt);break e;case 1:xt=Rt;var bt=ce.type,zt=ce.stateNode;if((ce.flags&128)===0&&(typeof bt.getDerivedStateFromError=="function"||zt!==null&&typeof zt.componentDidCatch=="function"&&(Dl===null||!Dl.has(zt)))){ce.flags|=65536,k&=-k,ce.lanes|=k;var Ar=Yg(ce,xt,k);J0(ce,Ar);break e}}ce=ce.return}while(ce!==null)}Wx(O)}catch(Yr){k=Yr,Ps===O&&O!==null&&(Ps=O=O.return);continue}break}while(!0)}function $x(){var S=Jh.current;return Jh.current=Od,S===null?Od:S}function xf(){(Fs===0||Fs===3||Fs===2)&&(Fs=4),os===null||(tu&268435455)===0&&(xs&268435455)===0||ru(os,na)}function Vd(S,k){var O=bn;bn|=2;var V=$x();(os!==S||na!==k)&&(Gi=null,Hu(S,k));do try{qb();break}catch(ee){pf(S,ee)}while(!0);if(mx(),bn=O,Jh.current=V,Ps!==null)throw Error(i(261));return os=null,na=0,Fs}function qb(){for(;Ps!==null;)zx(Ps)}function Ux(){for(;Ps!==null&&!_n();)zx(Ps)}function zx(S){var k=Qb(S.alternate,S,Aa);S.memoizedProps=S.pendingProps,k===null?Wx(S):Ps=k,uf.current=null}function Wx(S){var k=S;do{var O=k.alternate;if(S=k.return,(k.flags&32768)===0){if(O=Ud(O,k,Aa),O!==null){Ps=O;return}}else{if(O=Hb(O,k),O!==null){O.flags&=32767,Ps=O;return}if(S!==null)S.flags|=32768,S.subtreeFlags=0,S.deletions=null;else{Fs=6,Ps=null;return}}if(k=k.sibling,k!==null){Ps=k;return}Ps=k=S}while(k!==null);Fs===0&&(Fs=5)}function Gu(S,k,O){var V=Xe,ee=Ks.transition;try{Ks.transition=null,Xe=1,Kb(S,k,O,V)}finally{Ks.transition=ee,Xe=V}return null}function Kb(S,k,O,V){do nu();while(cl!==null);if((bn&6)!==0)throw Error(i(327));O=S.finishedWork;var ee=S.finishedLanes;if(O===null)return null;if(S.finishedWork=null,S.finishedLanes=0,O===S.current)throw Error(i(177));S.callbackNode=null,S.callbackPriority=0;var ce=O.lanes|O.childLanes;if(en(S,ce),S===os&&(Ps=os=null,na=0),(O.subtreeFlags&2064)===0&&(O.flags&2064)===0||Wu||(Wu=!0,Gx(Li,function(){return nu(),null})),ce=(O.flags&15990)!==0,(O.subtreeFlags&15990)!==0||ce){ce=Ks.transition,Ks.transition=null;var je=Xe;Xe=1;var xt=bn;bn|=4,uf.current=null,Gb(S,O),Kh(O,S),q(S.containerInfo),S.current=O,lf(O),hn(),bn=xt,Xe=je,Ks.transition=ce}else S.current=O;if(Wu&&(Wu=!1,cl=S,op=ee),ce=S.pendingLanes,ce===0&&(Dl=null),V0(O.stateNode),Si(S,Sn()),k!==null)for(V=S.onRecoverableError,O=0;O<k.length;O++)ee=k[O],V(ee.value,{componentStack:ee.stack,digest:ee.digest});if(Ys)throw Ys=!1,S=ha,ha=null,S;return(op&1)!==0&&S.tag!==0&&nu(),ce=S.pendingLanes,(ce&1)!==0?S===Zh?ma++:(ma=0,Zh=S):ma=0,ri(),null}function nu(){if(cl!==null){var S=br(op),k=Ks.transition,O=Xe;try{if(Ks.transition=null,Xe=16>S?16:S,cl===null)var V=!1;else{if(S=cl,cl=null,op=0,(bn&6)!==0)throw Error(i(331));var ee=bn;for(bn|=4,Nr=S.current;Nr!==null;){var ce=Nr,je=ce.child;if((Nr.flags&16)!==0){var xt=ce.deletions;if(xt!==null){for(var Rt=0;Rt<xt.length;Rt++){var cr=xt[Rt];for(Nr=cr;Nr!==null;){var Lr=Nr;switch(Lr.tag){case 0:case 11:case 15:zd(8,Lr,ce)}var yn=Lr.child;if(yn!==null)yn.return=Lr,Nr=yn;else for(;Nr!==null;){Lr=Nr;var Er=Lr.sibling,ys=Lr.return;if(Vh(Lr),Lr===cr){Nr=null;break}if(Er!==null){Er.return=ys,Nr=Er;break}Nr=ys}}}var ts=ce.alternate;if(ts!==null){var Vi=ts.child;if(Vi!==null){ts.child=null;do{var hc=Vi.sibling;Vi.sibling=null,Vi=hc}while(Vi!==null)}}Nr=ce}}if((ce.subtreeFlags&2064)!==0&&je!==null)je.return=ce,Nr=je;else e:for(;Nr!==null;){if(ce=Nr,(ce.flags&2048)!==0)switch(ce.tag){case 0:case 11:case 15:zd(9,ce,ce.return)}var Pt=ce.sibling;if(Pt!==null){Pt.return=ce.return,Nr=Pt;break e}Nr=ce.return}}var bt=S.current;for(Nr=bt;Nr!==null;){je=Nr;var zt=je.child;if((je.subtreeFlags&2064)!==0&&zt!==null)zt.return=je,Nr=zt;else e:for(je=bt;Nr!==null;){if(xt=Nr,(xt.flags&2048)!==0)try{switch(xt.tag){case 0:case 11:case 15:of(9,xt)}}catch(Yr){Cs(xt,xt.return,Yr)}if(xt===je){Nr=null;break e}var Ar=xt.sibling;if(Ar!==null){Ar.return=xt.return,Nr=Ar;break e}Nr=xt.return}}if(bn=ee,ri(),co&&typeof co.onPostCommitFiberRoot=="function")try{co.onPostCommitFiberRoot(Nu,S)}catch{}V=!0}return V}finally{Xe=O,Ks.transition=k}}return!1}function Hx(S,k,O){k=Dd(O,k),k=ic(S,k,1),S=Xc(S,k,1),k=ks(),S!==null&&(jt(S,1,k),Si(S,k))}function Cs(S,k,O){if(S.tag===3)Hx(S,S,O);else for(;k!==null;){if(k.tag===3){Hx(k,S,O);break}else if(k.tag===1){var V=k.stateNode;if(typeof k.type.getDerivedStateFromError=="function"||typeof V.componentDidCatch=="function"&&(Dl===null||!Dl.has(V))){S=Dd(O,S),S=Yg(k,S,1),k=Xc(k,S,1),S=ks(),k!==null&&(jt(k,1,S),Si(k,S));break}}k=k.return}}function Yb(S,k,O){var V=S.pingCache;V!==null&&V.delete(k),k=ks(),S.pingedLanes|=S.suspendedLanes&O,os===S&&(na&O)===O&&(Fs===4||Fs===3&&(na&130023424)===na&&500>Sn()-hf?Hu(S,0):ff|=O),Si(S,k)}function Xb(S,k){k===0&&((S.mode&1)===0?k=1:(k=Al,Al<<=1,(Al&130023424)===0&&(Al=4194304)));var O=ks();S=Rl(S,k),S!==null&&(jt(S,k,O),Si(S,O))}function Jb(S){var k=S.memoizedState,O=0;k!==null&&(O=k.retryLane),Xb(S,O)}function G3(S,k){var O=0;switch(S.tag){case 13:var V=S.stateNode,ee=S.memoizedState;ee!==null&&(O=ee.retryLane);break;case 19:V=S.stateNode;break;default:throw Error(i(314))}V!==null&&V.delete(k),Xb(S,O)}var Qb;Qb=function(S,k,O){if(S!==null)if(S.memoizedProps!==k.pendingProps||pn.current)Ea=!0;else{if((S.lanes&O)===0&&(k.flags&128)===0)return Ea=!1,Lu(S,k,O);Ea=(S.flags&131072)!==0}else Ea=!1,Ss&&(k.flags&1048576)!==0&&Cb(k,Sd,k.index);switch(k.lanes=0,k.tag){case 2:var V=k.type;Gh(S,k),S=k.pendingProps;var ee=Zn(k,gr.current);X0(k,O),ee=Bh(null,k,V,S,ee,O);var ce=$g();return k.flags|=1,typeof ee=="object"&&ee!==null&&typeof ee.render=="function"&&ee.$$typeof===void 0?(k.tag=1,k.memoizedState=null,k.updateQueue=null,Fn(V)?(ce=!0,Kr(k)):ce=!1,k.memoizedState=ee.state!==null&&ee.state!==void 0?ee.state:null,px(k),ee.updater=zh,k.stateNode=ee,ee._reactInternals=k,ac(k,V,S,O),k=vi(null,k,V,!0,ce,O)):(k.tag=0,Ss&&ce&&Fh(k),Wa(null,k,ee,O),k=k.child),k;case 16:V=k.elementType;e:{switch(Gh(S,k),S=k.pendingProps,ee=V._init,V=ee(V._payload),k.type=V,ee=k.tag=V3(V),S=Do(V,S),ee){case 0:k=oc(null,k,V,S,O);break e;case 1:k=ai(null,k,V,S,O);break e;case 11:k=Xg(null,k,V,S,O);break e;case 14:k=Id(null,k,V,Do(V.type,S),O);break e}throw Error(i(306,V,""))}return k;case 0:return V=k.type,ee=k.pendingProps,ee=k.elementType===V?ee:Do(V,ee),oc(S,k,V,ee,O);case 1:return V=k.type,ee=k.pendingProps,ee=k.elementType===V?ee:Do(V,ee),ai(S,k,V,ee,O);case 3:e:{if(Iu(k),S===null)throw Error(i(387));V=k.pendingProps,ce=k.memoizedState,ee=ce.element,Mb(S,k),ju(k,V,null,O);var je=k.memoizedState;if(V=je.element,Ee&&ce.isDehydrated)if(ce={element:V,isDehydrated:!1,cache:je.cache,pendingSuspenseBoundaries:je.pendingSuspenseBoundaries,transitions:je.transitions},k.updateQueue.baseState=ce,k.memoizedState=ce,k.flags&256){ee=Dd(Error(i(423)),k),k=Ld(S,k,V,O,ee);break e}else if(V!==ee){ee=Dd(Error(i(424)),k),k=Ld(S,k,V,O,ee);break e}else for(Ee&&($i=Ae(k.stateNode.containerInfo),ni=k,Ss=!0,Ml=null,Rh=!1),O=Pb(k,null,V,O),k.child=O;O;)O.flags=O.flags&-3|4096,O=O.sibling;else{if(kd(),V===ee){k=Zc(S,k,O);break e}Wa(S,k,V,O)}k=k.child}return k;case 5:return xx(k),S===null&&dx(k),V=k.type,ee=k.pendingProps,ce=S!==null?S.memoizedProps:null,je=ee.children,W(V,ee)?je=null:ce!==null&&W(V,ce)&&(k.flags|=32),is(S,k),Wa(S,k,je,O),k.child;case 6:return S===null&&dx(k),null;case 13:return Rx(S,k,O);case 4:return Lg(k,k.stateNode.containerInfo),V=k.pendingProps,S===null?k.child=Td(k,null,V,O):Wa(S,k,V,O),k.child;case 11:return V=k.type,ee=k.pendingProps,ee=k.elementType===V?ee:Do(V,ee),Xg(S,k,V,ee,O);case 7:return Wa(S,k,k.pendingProps,O),k.child;case 8:return Wa(S,k,k.pendingProps.children,O),k.child;case 12:return Wa(S,k,k.pendingProps.children,O),k.child;case 10:e:{if(V=k.type._context,ee=k.pendingProps,ce=k.memoizedProps,je=ee.value,Fb(k,V,je),ce!==null)if(jl(ce.value,je)){if(ce.children===ee.children&&!pn.current){k=Zc(S,k,O);break e}}else for(ce=k.child,ce!==null&&(ce.return=k);ce!==null;){var xt=ce.dependencies;if(xt!==null){je=ce.child;for(var Rt=xt.firstContext;Rt!==null;){if(Rt.context===V){if(ce.tag===1){Rt=Yc(-1,O&-O),Rt.tag=2;var cr=ce.updateQueue;if(cr!==null){cr=cr.shared;var Lr=cr.pending;Lr===null?Rt.next=Rt:(Rt.next=Lr.next,Lr.next=Rt),cr.pending=Rt}}ce.lanes|=O,Rt=ce.alternate,Rt!==null&&(Rt.lanes|=O),Nd(ce.return,O,k),xt.lanes|=O;break}Rt=Rt.next}}else if(ce.tag===10)je=ce.type===k.type?null:ce.child;else if(ce.tag===18){if(je=ce.return,je===null)throw Error(i(341));je.lanes|=O,xt=je.alternate,xt!==null&&(xt.lanes|=O),Nd(je,O,k),je=ce.sibling}else je=ce.child;if(je!==null)je.return=ce;else for(je=ce;je!==null;){if(je===k){je=null;break}if(ce=je.sibling,ce!==null){ce.return=je.return,je=ce;break}je=je.return}ce=je}Wa(S,k,ee.children,O),k=k.child}return k;case 9:return ee=k.type,V=k.pendingProps.children,X0(k,O),ee=Mo(ee),V=V(ee),k.flags|=1,Wa(S,k,V,O),k.child;case 14:return V=k.type,ee=Do(V,k.pendingProps),ee=Do(V.type,ee),Id(S,k,V,ee,O);case 15:return Qc(S,k,k.type,k.pendingProps,O);case 17:return V=k.type,ee=k.pendingProps,ee=k.elementType===V?ee:Do(V,ee),Gh(S,k),k.tag=1,Fn(V)?(S=!0,Kr(k)):S=!1,X0(k,O),$b(k,V,ee),ac(k,V,ee,O),vi(null,k,V,!0,S,O);case 19:return Qg(S,k,O);case 22:return ps(S,k,O)}throw Error(i(156,k.tag))};function Gx(S,k){return lr(S,k)}function Zb(S,k,O,V){this.tag=S,this.key=O,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=k,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=V,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function zo(S,k,O,V){return new Zb(S,k,O,V)}function yf(S){return S=S.prototype,!(!S||!S.isReactComponent)}function V3(S){if(typeof S=="function")return yf(S)?1:0;if(S!=null){if(S=S.$$typeof,S===x)return 11;if(S===b)return 14}return 2}function Vu(S,k){var O=S.alternate;return O===null?(O=zo(S.tag,k,S.key,S.mode),O.elementType=S.elementType,O.type=S.type,O.stateNode=S.stateNode,O.alternate=S,S.alternate=O):(O.pendingProps=k,O.type=S.type,O.flags=0,O.subtreeFlags=0,O.deletions=null),O.flags=S.flags&14680064,O.childLanes=S.childLanes,O.lanes=S.lanes,O.child=S.child,O.memoizedProps=S.memoizedProps,O.memoizedState=S.memoizedState,O.updateQueue=S.updateQueue,k=S.dependencies,O.dependencies=k===null?null:{lanes:k.lanes,firstContext:k.firstContext},O.sibling=S.sibling,O.index=S.index,O.ref=S.ref,O}function fp(S,k,O,V,ee,ce){var je=2;if(V=S,typeof S=="function")yf(S)&&(je=1);else if(typeof S=="string")je=5;else e:switch(S){case d:return ii(O.children,ee,ce,k);case f:je=8,ee|=8;break;case h:return S=zo(12,O,k,ee|2),S.elementType=h,S.lanes=ce,S;case v:return S=zo(13,O,k,ee),S.elementType=v,S.lanes=ce,S;case C:return S=zo(19,O,k,ee),S.elementType=C,S.lanes=ce,S;case T:return vf(O,ee,ce,k);default:if(typeof S=="object"&&S!==null)switch(S.$$typeof){case g:je=10;break e;case p:je=9;break e;case x:je=11;break e;case b:je=14;break e;case _:je=16,V=null;break e}throw Error(i(130,S==null?S:typeof S,""))}return k=zo(je,O,k,ee),k.elementType=S,k.type=V,k.lanes=ce,k}function ii(S,k,O,V){return S=zo(7,S,V,k),S.lanes=O,S}function vf(S,k,O,V){return S=zo(22,S,V,k),S.elementType=T,S.lanes=O,S.stateNode={isHidden:!1},S}function bf(S,k,O){return S=zo(6,S,null,k),S.lanes=O,S}function hp(S,k,O){return k=zo(4,S.children!==null?S.children:[],S.key,k),k.lanes=O,k.stateNode={containerInfo:S.containerInfo,pendingChildren:null,implementation:S.implementation},k}function ew(S,k,O,V,ee){this.tag=k,this.containerInfo=S,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Cr(0),this.expirationTimes=Cr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Cr(0),this.identifierPrefix=V,this.onRecoverableError=ee,Ee&&(this.mutableSourceEagerHydrationData=null)}function Vx(S,k,O,V,ee,ce,je,xt,Rt){return S=new ew(S,k,O,xt,Rt),k===1?(k=1,ce===!0&&(k|=8)):k=0,ce=zo(3,null,null,k),S.current=ce,ce.stateNode=S,ce.memoizedState={element:V,isDehydrated:O,cache:null,transitions:null,pendingSuspenseBoundaries:null},px(ce),S}function mp(S){if(!S)return qn;S=S._reactInternals;e:{if(P(S)!==S||S.tag!==1)throw Error(i(170));var k=S;do{switch(k.tag){case 3:k=k.stateNode.context;break e;case 1:if(Fn(k.type)){k=k.stateNode.__reactInternalMemoizedMergedChildContext;break e}}k=k.return}while(k!==null);throw Error(i(171))}if(S.tag===1){var O=S.type;if(Fn(O))return Fr(S,O,k)}return k}function qd(S){var k=S._reactInternals;if(k===void 0)throw typeof S.render=="function"?Error(i(188)):(S=Object.keys(S).join(","),Error(i(268,S)));return S=U(k),S===null?null:S.stateNode}function gp(S,k){if(S=S.memoizedState,S!==null&&S.dehydrated!==null){var O=S.retryLane;S.retryLane=O!==0&&O<k?O:k}}function wf(S,k){gp(S,k),(S=S.alternate)&&gp(S,k)}function q3(S){return S=U(S),S===null?null:S.stateNode}function tw(){return null}return r.attemptContinuousHydration=function(S){if(S.tag===13){var k=Rl(S,134217728);if(k!==null){var O=ks();_i(k,S,134217728,O)}wf(S,134217728)}},r.attemptDiscreteHydration=function(S){if(S.tag===13){var k=Rl(S,1);if(k!==null){var O=ks();_i(k,S,1,O)}wf(S,1)}},r.attemptHydrationAtCurrentPriority=function(S){if(S.tag===13){var k=ja(S),O=Rl(S,k);if(O!==null){var V=ks();_i(O,S,k,V)}wf(S,k)}},r.attemptSynchronousHydration=function(S){switch(S.tag){case 3:var k=S.stateNode;if(k.current.memoizedState.isDehydrated){var O=sl(k.pendingLanes);O!==0&&(Nn(k,O|1),Si(k,Sn()),(bn&6)===0&&(ss(),ri()))}break;case 13:Bx(function(){var V=Rl(S,1);if(V!==null){var ee=ks();_i(V,S,1,ee)}}),wf(S,1)}},r.batchedUpdates=function(S,k){var O=bn;bn|=1;try{return S(k)}finally{bn=O,bn===0&&(ss(),q0&&ri())}},r.createComponentSelector=function(S){return{$$typeof:eu,value:S}},r.createContainer=function(S,k,O,V,ee,ce,je){return Vx(S,k,!1,null,O,V,ee,ce,je)},r.createHasPseudoClassSelector=function(S){return{$$typeof:Hi,value:S}},r.createHydrationContainer=function(S,k,O,V,ee,ce,je,xt,Rt){return S=Vx(O,V,!0,S,ee,ce,je,xt,Rt),S.context=mp(null),O=S.current,V=ks(),ee=ja(O),ce=Yc(V,ee),ce.callback=k??null,Xc(O,ce,ee),S.current.lanes=ee,jt(S,ee,V),Si(S,V),S},r.createPortal=function(S,k,O){var V=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:u,key:V==null?null:""+V,children:S,containerInfo:k,implementation:O}},r.createRoleSelector=function(S){return{$$typeof:cc,value:S}},r.createTestNameSelector=function(S){return{$$typeof:cf,value:S}},r.createTextSelector=function(S){return{$$typeof:Yh,value:S}},r.deferredUpdates=function(S){var k=Xe,O=Ks.transition;try{return Ks.transition=null,Xe=16,S()}finally{Xe=k,Ks.transition=O}},r.discreteUpdates=function(S,k,O,V,ee){var ce=Xe,je=Ks.transition;try{return Ks.transition=null,Xe=1,S(k,O,V,ee)}finally{Xe=ce,Ks.transition=je,bn===0&&ss()}},r.findAllNodes=fc,r.findBoundingRects=function(S,k){if(!et)throw Error(i(363));k=fc(S,k),S=[];for(var O=0;O<k.length;O++)S.push(Te(k[O]));for(k=S.length-1;0<k;k--){O=S[k];for(var V=O.x,ee=V+O.width,ce=O.y,je=ce+O.height,xt=k-1;0<=xt;xt--)if(k!==xt){var Rt=S[xt],cr=Rt.x,Lr=cr+Rt.width,yn=Rt.y,Er=yn+Rt.height;if(V>=cr&&ce>=yn&&ee<=Lr&&je<=Er){S.splice(k,1);break}else if(V!==cr||O.width!==Rt.width||Er<ce||yn>je){if(!(ce!==yn||O.height!==Rt.height||Lr<V||cr>ee)){cr>V&&(Rt.width+=cr-V,Rt.x=V),Lr<ee&&(Rt.width=ee-cr),S.splice(k,1);break}}else{yn>ce&&(Rt.height+=yn-ce,Rt.y=ce),Er<je&&(Rt.height=je-yn),S.splice(k,1);break}}}return S},r.findHostInstance=qd,r.findHostInstanceWithNoPortals=function(S){return S=I(S),S=S!==null?te(S):null,S===null?null:S.stateNode},r.findHostInstanceWithWarning=function(S){return qd(S)},r.flushControlled=function(S){var k=bn;bn|=1;var O=Ks.transition,V=Xe;try{Ks.transition=null,Xe=1,S()}finally{Xe=V,Ks.transition=O,bn=k,bn===0&&(ss(),ri())}},r.flushPassiveEffects=nu,r.flushSync=Bx,r.focusWithin=function(S,k){if(!et)throw Error(i(363));for(S=uc(S),k=dc(S,k),k=Array.from(k),S=0;S<k.length;){var O=k[S++];if(!pt(O)){if(O.tag===5&&Ut(O.stateNode))return!0;for(O=O.child;O!==null;)k.push(O),O=O.sibling}}return!1},r.getCurrentUpdatePriority=function(){return Xe},r.getFindAllNodesFailureDescription=function(S,k){if(!et)throw Error(i(363));var O=0,V=[];S=[uc(S),0];for(var ee=0;ee<S.length;){var ce=S[ee++],je=S[ee++],xt=k[je];if((ce.tag!==5||!pt(ce))&&(Xh(ce,xt)&&(V.push(ap(xt)),je++,je>O&&(O=je)),je<k.length))for(ce=ce.child;ce!==null;)S.push(ce,je),ce=ce.sibling}if(O<k.length){for(S=[];O<k.length;O++)S.push(ap(k[O]));return`findAllNodes was able to match part of the selector:
  `+(V.join(" > ")+`

No matching component was found for:
  `)+S.join(" > ")}return null},r.getPublicRootInstance=function(S){if(S=S.current,!S.child)return null;switch(S.child.tag){case 5:return Z(S.child.stateNode);default:return S.child.stateNode}},r.injectIntoDevTools=function(S){if(S={bundleType:S.bundleType,version:S.version,rendererPackageName:S.rendererPackageName,rendererConfig:S.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:q3,findFiberByHostInstance:S.findFiberByHostInstance||tw,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")S=!1;else{var k=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(k.isDisabled||!k.supportsFiber)S=!0;else{try{Nu=k.inject(S),co=k}catch{}S=!!k.checkDCE}}return S},r.isAlreadyRendering=function(){return!1},r.observeVisibleRects=function(S,k,O,V){if(!et)throw Error(i(363));S=fc(S,k);var ee=ct(S,O,V).disconnect;return{disconnect:function(){ee()}}},r.registerMutableSourceForHydration=function(S,k){var O=k._getVersion;O=O(k._source),S.mutableSourceEagerHydrationData==null?S.mutableSourceEagerHydrationData=[k,O]:S.mutableSourceEagerHydrationData.push(k,O)},r.runWithPriority=function(S,k){var O=Xe;try{return Xe=S,k()}finally{Xe=O}},r.shouldError=function(){return null},r.shouldSuspend=function(){return!1},r.updateContainer=function(S,k,O,V){var ee=k.current,ce=ks(),je=ja(ee);return O=mp(O),k.context===null?k.context=O:k.pendingContext=O,k=Yc(ce,je),k.payload={element:S},V=V===void 0?null:V,V!==null&&(k.callback=V),S=Xc(ee,k,je),S!==null&&(_i(S,ee,je,ce),Dh(S,ee,je)),je},r}),u6}var EM;function xce(){return EM||(EM=1,c6.exports=pce()),c6.exports}var yce=xce();const vce=ec(yce);var d6={exports:{}},Ff={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AM;function bce(){return AM||(AM=1,Ff.ConcurrentRoot=1,Ff.ContinuousEventPriority=4,Ff.DefaultEventPriority=16,Ff.DiscreteEventPriority=1,Ff.IdleEventPriority=536870912,Ff.LegacyRoot=0),Ff}var jM;function wce(){return jM||(jM=1,d6.exports=bce()),d6.exports}var kH=wce(),_ce=Rn();const PM={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let FM=!1,MM=!1;const NN=".react-konva-event";let CH=!1;function Sce(e){CH=e}const kce=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,Cce=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,Tce={};function RS(e,t,r=Tce){if(!FM&&"zIndex"in t&&(console.warn(Cce),FM=!0),!MM&&t.draggable){var n=t.x!==void 0||t.y!==void 0,s=t.onDragEnd||t.onDragMove;n&&!s&&(console.warn(kce),MM=!0)}for(var a in r)if(!PM[a]){var i=a.slice(0,2)==="on",o=r[a]!==t[a];if(i&&o){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),e.off(c,r[a])}var u=!t.hasOwnProperty(a);u&&e.setAttr(a,void 0)}var d=CH||t._useStrictMode,f={},h=!1;const g={};for(var a in t)if(!PM[a]){var i=a.slice(0,2)==="on",p=r[a]!==t[a];if(i&&p){var c=a.substr(2).toLowerCase();c.substr(0,7)==="content"&&(c="content"+c.substr(7,1).toUpperCase()+c.substr(8)),t[a]&&(g[c]=t[a])}!i&&(t[a]!==r[a]||d&&t[a]!==e.getAttr(a))&&(h=!0,f[a]=t[a])}h&&(e.setAttrs(f),yh(e));for(var c in g)e.on(c+NN,g[c])}function yh(e){if(!_ce.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}var f6=m7();const TH={},Nce={};qv.Node.prototype._applyProps=RS;function Ece(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),yh(e)}function Ace(e,t,r){let n=qv[e];n||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),n=qv.Group);const s={},a={};for(var i in t){var o=i.slice(0,2)==="on";o?a[i]=t[i]:s[i]=t[i]}const c=new n(s);return RS(c,a),c}function jce(e,t,r){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function Pce(e,t,r){return!1}function Fce(e){return e}function Mce(){return null}function Rce(){return null}function Oce(e,t,r,n){return Nce}function Dce(){}function Ice(e){}function Lce(e,t){return!1}function Bce(){return TH}function $ce(){return TH}const Uce=setTimeout,zce=clearTimeout,Wce=-1;function Hce(e,t){return!1}const Gce=!1,Vce=!0,qce=!0;function Kce(e,t){t.parent===e?t.moveToTop():e.add(t),yh(e)}function Yce(e,t){t.parent===e?t.moveToTop():e.add(t),yh(e)}function NH(e,t,r){t._remove(),e.add(t),t.setZIndex(r.getZIndex()),yh(e)}function Xce(e,t,r){NH(e,t,r)}function Jce(e,t){t.destroy(),t.off(NN),yh(e)}function Qce(e,t){t.destroy(),t.off(NN),yh(e)}function Zce(e,t,r){console.error(`Text components are not yet supported in ReactKonva. You text is: "${r}"`)}function eue(e,t,r){}function tue(e,t,r,n,s){RS(e,s,n)}function rue(e){e.hide(),yh(e)}function nue(e){}function sue(e,t){(t.visible==null||t.visible)&&e.show()}function aue(e,t){}function iue(e){}function oue(){}const lue=()=>kH.DefaultEventPriority,cue=Object.freeze(Object.defineProperty({__proto__:null,appendChild:Kce,appendChildToContainer:Yce,appendInitialChild:Ece,cancelTimeout:zce,clearContainer:iue,commitMount:eue,commitTextUpdate:Zce,commitUpdate:tue,createInstance:Ace,createTextInstance:jce,detachDeletedInstance:oue,finalizeInitialChildren:Pce,getChildHostContext:$ce,getCurrentEventPriority:lue,getPublicInstance:Fce,getRootHostContext:Bce,hideInstance:rue,hideTextInstance:nue,idlePriority:f6.unstable_IdlePriority,insertBefore:NH,insertInContainerBefore:Xce,isPrimaryRenderer:Gce,noTimeout:Wce,now:f6.unstable_now,prepareForCommit:Mce,preparePortalMount:Rce,prepareUpdate:Oce,removeChild:Jce,removeChildFromContainer:Qce,resetAfterCommit:Dce,resetTextContent:Ice,run:f6.unstable_runWithPriority,scheduleTimeout:Uce,shouldDeprioritizeSubtree:Lce,shouldSetTextContent:Hce,supportsMutation:qce,unhideInstance:sue,unhideTextInstance:aue,warnsIfNotActing:Vce},Symbol.toStringTag,{value:"Module"}));var uue=Object.defineProperty,due=Object.defineProperties,fue=Object.getOwnPropertyDescriptors,RM=Object.getOwnPropertySymbols,hue=Object.prototype.hasOwnProperty,mue=Object.prototype.propertyIsEnumerable,OM=(e,t,r)=>t in e?uue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,DM=(e,t)=>{for(var r in t||(t={}))hue.call(t,r)&&OM(e,r,t[r]);if(RM)for(var r of RM(t))mue.call(t,r)&&OM(e,r,t[r]);return e},gue=(e,t)=>due(e,fue(t)),IM,LM;typeof window<"u"&&((IM=window.document)!=null&&IM.createElement||((LM=window.navigator)==null?void 0:LM.product)==="ReactNative")?w.useLayoutEffect:w.useEffect;function EH(e,t,r){if(!e)return;if(r(e)===!0)return e;let n=e.child;for(;n;){const s=EH(n,t,r);if(s)return s;n=n.sibling}}function AH(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const BM=console.error;console.error=function(){const e=[...arguments].join("");if(e?.startsWith("Warning:")&&e.includes("useContext")){console.error=BM;return}return BM.apply(this,arguments)};const EN=AH(w.createContext(null));class jH extends w.Component{render(){return w.createElement(EN.Provider,{value:this._reactInternals},this.props.children)}}function pue(){const e=w.useContext(EN);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=w.useId();return w.useMemo(()=>{for(const n of[e,e?.alternate]){if(!n)continue;const s=EH(n,!1,a=>{let i=a.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(s)return s}},[e,t])}function xue(){const e=pue(),[t]=w.useState(()=>new Map);t.clear();let r=e;for(;r;){if(r.type&&typeof r.type=="object"){const s=r.type._context===void 0&&r.type.Provider===r.type?r.type:r.type._context;s&&s!==EN&&!t.has(s)&&t.set(s,w.useContext(AH(s)))}r=r.return}return t}function PH(){const e=xue();return w.useMemo(()=>Array.from(e.keys()).reduce((t,r)=>n=>w.createElement(t,null,w.createElement(r.Provider,gue(DM({},n),{value:e.get(r)}))),t=>w.createElement(jH,DM({},t))),[e])}function yue(e){const t=Rs.useRef({});return Rs.useLayoutEffect(()=>{t.current=e}),Rs.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const vue=e=>{const t=Rs.useRef(null),r=Rs.useRef(null),n=Rs.useRef(null),s=yue(e),a=PH(),i=o=>{const{forwardedRef:c}=e;c&&(typeof c=="function"?c(o):c.current=o)};return Rs.useLayoutEffect(()=>(r.current=new qv.Stage({width:e.width,height:e.height,container:t.current}),i(r.current),n.current=zp.createContainer(r.current,kH.LegacyRoot,!1,null),zp.updateContainer(Rs.createElement(a,{},e.children),n.current),()=>{qv.isBrowser&&(i(null),zp.updateContainer(null,n.current,null),r.current.destroy())}),[]),Rs.useLayoutEffect(()=>{i(r.current),RS(r.current,e,s),zp.updateContainer(Rs.createElement(a,{},e.children),n.current,null)}),Rs.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},ih="Layer",bue="FastLayer",vl="Group",wue="Label",Ja="Rect",Yf="Circle",_ue="Ellipse",Sue="Wedge",Qi="Line",kue="Sprite",D2="Image",Nc="Text",Cue="TextPath",Tue="Star",Nue="Ring",Eue="Arc",Aue="Tag",jue="Path",Pue="RegularPolygon",jT="Arrow",Fue="Shape",FH="Transformer",Mue="18.2.13",zp=vce(cue);zp.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:Rs.version,rendererPackageName:"react-konva"});const oh=Rs.forwardRef((e,t)=>Rs.createElement(jH,{},Rs.createElement(vue,{...e,forwardedRef:t}))),Rue=Sce,Oue=Object.freeze(Object.defineProperty({__proto__:null,Arc:Eue,Arrow:jT,Circle:Yf,Ellipse:_ue,FastLayer:bue,Group:vl,Image:D2,KonvaRenderer:zp,Label:wue,Layer:ih,Line:Qi,Path:jue,Rect:Ja,RegularPolygon:Pue,Ring:Nue,Shape:Fue,Sprite:kue,Stage:oh,Star:Tue,Tag:Aue,Text:Nc,TextPath:Cue,Transformer:FH,Wedge:Sue,useContextBridge:PH,useStrictMode:Rue,version:Mue},Symbol.toStringTag,{value:"Module"})),Kt=({children:e,hover:t=!0,className:r="",paddingClass:n="p-6",...s})=>{const a=`
    bg-white rounded-xl shadow-md border border-gray-200 ${n}
    ${t?"hover:shadow-lg hover:-translate-y-1 transition-all duration-200":""}
    ${r}
  `;return l.jsx(Ze.div,{className:a,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},...s,children:e})},Due=({children:e,className:t=""})=>l.jsx("div",{className:`border-b border-gray-200 pb-4 mb-4 ${t}`,children:e}),Iue=({children:e,className:t="",style:r={}})=>{const s=r&&r.color?"":"text-gray-800";return l.jsx("h3",{className:`text-xl font-semibold ${s} ${t}`,style:r,children:e})},Lue=({children:e,className:t=""})=>l.jsx("div",{className:`py-4 ${t}`,children:e}),Bue=({children:e,className:t=""})=>l.jsx("div",{className:`border-t border-gray-200 pt-4 mt-4 ${t}`,children:e});Kt.Header=Due;Kt.Title=Iue;Kt.Body=Lue;Kt.Footer=Bue;const Ds=({isOpen:e=!1,onClose:t,title:r="",children:n,size:s="medium",showCloseButton:a=!0,closeOnBackdropClick:i=!0,className:o="",...c})=>{const u=f=>{i&&f.target===f.currentTarget&&t()};Rs.useEffect(()=>{const f=p=>{p.key==="Escape"&&t()},h=window;h.__modalOpenCount||(h.__modalOpenCount=0);let g;return e&&(document.addEventListener("keydown",f),g=document.body.style.overflow,h.__modalOpenCount===0&&(document.body.style.overflow="hidden"),h.__modalOpenCount+=1),()=>{document.removeEventListener("keydown",f),h.__modalOpenCount&&h.__modalOpenCount>0&&(h.__modalOpenCount-=1),h.__modalOpenCount===0&&(g!==void 0?document.body.style.overflow=g||"":document.body.style.overflow="")}},[e,t]);const d={small:"max-w-md",medium:"max-w-2xl",large:"max-w-6xl"};return e?l.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:u,role:"dialog","aria-modal":"true","aria-label":r,...c,children:l.jsxs("div",{className:`
          bg-white rounded-xl shadow-md border border-gray-200 p-8
          hover:shadow-lg hover:-translate-y-1 transition-all duration-200
          w-full ${d[s]} mx-auto
          ${o}
          relative
        `,onClick:f=>f.stopPropagation(),children:[(r||a)&&l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r&&l.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:r}),a&&l.jsx("button",{onClick:t,className:"text-red-500 hover:text-red-700 hover:bg-red-50 transition-all duration-200 rounded-full p-2 text-2xl font-bold leading-none","aria-label":"Close modal",children:""})]}),l.jsx("div",{className:"space-y-6",children:n})]})}):null},$ue=e=>{const[t,r]=w.useState({width:800,height:600}),n=w.useRef(null),s=w.useCallback(()=>{if(e.current){e.current.getBoundingClientRect();const a=Math.min(1200,window.innerWidth*.8),i=Math.min(800,window.innerHeight*.6),o=4/3;let c=a,u=c/o;u>i&&(u=i,c=u*o),r({width:c,height:u})}},[e]);return w.useEffect(()=>(s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)),[s]),{canvasSize:t,stageRef:n,updateCanvasSize:s}},Uue=e=>{const[t,r]=w.useState({width:800,height:600}),[n,s]=w.useState({}),a=w.useCallback(()=>{if(e.current){const o=e.current.getBoundingClientRect();r({width:o.width,height:Math.max(400,o.height)})}},[e]),i=w.useCallback(o=>o<480?{stageHeight:300,blockMinSize:50,fontSize:12,padding:10,touchTargetSize:44,arrowThickness:4}:o<768?{stageHeight:400,blockMinSize:60,fontSize:14,padding:15,touchTargetSize:44,arrowThickness:4}:o<1024?{stageHeight:500,blockMinSize:70,fontSize:16,padding:20,touchTargetSize:40,arrowThickness:3}:{stageHeight:600,blockMinSize:80,fontSize:18,padding:25,touchTargetSize:32,arrowThickness:2},[]);return w.useEffect(()=>{const o=i(t.width);s(o)},[t.width,i]),w.useEffect(()=>{a();const o=()=>{a()};return window.addEventListener("resize",o),()=>window.removeEventListener("resize",o)},[a]),{containerSize:t,responsiveSettings:n,updateSize:a}},$M={convertToOriginal:(e,t,r)=>r?{x:Number(((e-r.x)/r.scale).toFixed(4)),y:Number(((t-r.y)/r.scale).toFixed(4))}:{x:e,y:t},convertToCanvas:(e,t,r)=>r?{x:Number((r.x+e*r.scale).toFixed(4)),y:Number((r.y+t*r.scale).toFixed(4))}:{x:e,y:t},isPointInImage:(e,t)=>t?e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height:!1,calculateImageScale:(e,t)=>{if(!e||!t)return 1;const r=40,n=t.width-r,s=t.height-r;return Math.min(n/e.width,s/e.height)},calculateImageInfo:(e,t)=>{if(!e||!t)return null;const r=40,n=t.width-r,s=t.height-r,a=Math.min(n/e.width,s/e.height),i=e.width*a,o=e.height*a,c=(t.width-i)/2,u=(t.height-o)/2;return{x:c,y:u,width:i,height:o,scale:a,originalWidth:e.width,originalHeight:e.height}}},zue=e=>{const t=w.useCallback((n,s)=>$M.convertToOriginal(n,s,e),[e]),r=w.useCallback((n,s)=>$M.convertToCanvas(n,s,e),[e]);return{convertToOriginal:t,convertToCanvas:r}},Wy={create:(e,t,r,n,s)=>({id:s,x:e-r/2,y:t-n/2,width:Math.max(r,30),height:Math.max(n,10),fill:"rgba(0, 123, 255, 0.15)",stroke:"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),validate:e=>e.width>0&&e.height>0,findAtPosition:(e,t,r)=>e.find(n=>t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height),generateId:()=>`block_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},jp={create:(e,t,r,n,s,a,i)=>({id:i,startX:e,startY:t,endX:r,endY:n,startBlock:s,endBlock:a,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,pointerLength:10,pointerWidth:10}),snapToNearestBlock:(e,t,r,n=60)=>{let s=null,a=1/0;for(const i of r){const o=i.x+i.width/2,c=i.y+i.height/2,u=Math.sqrt(Math.pow(e-o,2)+Math.pow(t-c,2));u<=n&&u<a&&(a=u,s=i)}return s?{x:s.x+s.width/2,y:s.y+s.height/2,blockId:s.id,block:s,distance:a}:null},validate:(e,t,r,n,s)=>jp.snapToNearestBlock(e,t,s)!==null,generateId:()=>`arrow_${Date.now()}_${Math.random().toString(36).substr(2,9)}`},h6={create:(e,t,r)=>({id:r,blockId:e,word:t}),update:(e,t,r)=>e.map(n=>n.blockId===t?{...n,word:r}:n),delete:(e,t)=>e.filter(r=>r.blockId!==t),generateId:e=>`word_${e}`,validate:e=>e&&e.trim().length>0},MH=async e=>{const t=[];if(e.size>512e3){const n=(e.size/1024).toFixed(1);t.push(`Image is too large (${n}KB). Maximum allowed size is 500KB. Please compress or resize your image.`)}return new Promise(n=>{const s=new Image;s.onload=()=>{(s.width>4e3||s.height>4e3)&&t.push(`Image is too large (${s.width}x${s.height} pixels). Maximum allowed dimensions are 4000x4000 pixels. Please resize your image.`),n({valid:t.length===0,errors:t,dimensions:{width:s.width,height:s.height}})},s.onerror=()=>{t.push("Invalid image file"),n({valid:!1,errors:t})},s.src=URL.createObjectURL(e)})},Wue=(e,t=500)=>new Promise(r=>{const n=document.createElement("canvas"),s=n.getContext("2d"),a=new Image;a.onload=()=>{let{width:i,height:o}=a;const c=2e3;if(i>c||o>c){const f=Math.min(c/i,c/o);i*=f,o*=f}n.width=i,n.height=o,s.drawImage(a,0,0,i,o);let u=.8;const d=()=>{n.toBlob(f=>{f.size<=t*1024||u<=.1?r(f):(u-=.1,d())},"image/jpeg",u)};d()},a.onerror=()=>{r(e)},a.src=URL.createObjectURL(e)}),Hue=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=s=>t(s.target.result),n.onerror=s=>r(s),n.readAsDataURL(e)}),Gue=()=>{const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);return{blockMinSize:e?60:40,arrowThickness:e?4:2,touchTargetSize:e?44:32,doubleTapDelay:e?300:200,isMobile:e}},Vue={testData:{blocks:[],words:[],arrows:[],imageUrl:null},canvas:{size:{width:800,height:600},image:null,imageInfo:null,selectedTool:"edit"},creation:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null},ui:{selectedBlock:null,showWordPanel:!1,isLoading:!1,error:null,showImageSizeModal:!1,imageSizeError:null}},que=(e,t)=>{switch(t.type){case"SET_CANVAS_SIZE":return{...e,canvas:{...e.canvas,size:t.payload}};case"SET_IMAGE":return{...e,canvas:{...e.canvas,image:t.payload}};case"SET_IMAGE_INFO":return{...e,canvas:{...e.canvas,imageInfo:t.payload}};case"SET_SELECTED_TOOL":return{...e,canvas:{...e.canvas,selectedTool:t.payload}};case"ADD_BLOCK":return{...e,testData:{...e.testData,blocks:[...e.testData.blocks,t.payload]}};case"ADD_WORD":return{...e,testData:{...e.testData,words:[...e.testData.words,t.payload]}};case"ADD_ARROW":return{...e,testData:{...e.testData,arrows:[...e.testData.arrows,t.payload]}};case"UPDATE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.map(r=>r.id===t.payload.id?{...r,...t.payload.updates}:r)}};case"DELETE_BLOCK":return{...e,testData:{...e.testData,blocks:e.testData.blocks.filter(r=>r.id!==t.payload),words:e.testData.words.filter(r=>r.blockId!==t.payload),arrows:e.testData.arrows.filter(r=>r.startBlock!==t.payload&&r.endBlock!==t.payload)}};case"UPDATE_WORDS":return{...e,testData:{...e.testData,words:t.payload}};case"SET_CREATION_STATE":return{...e,creation:{...e.creation,...t.payload}};case"SET_UI_STATE":return{...e,ui:{...e.ui,...t.payload}};case"SET_LOADING":return{...e,ui:{...e.ui,isLoading:t.payload}};case"SET_ERROR":return{...e,ui:{...e.ui,error:t.payload}};case"SHOW_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!0,imageSizeError:t.payload}};case"HIDE_IMAGE_SIZE_MODAL":return{...e,ui:{...e.ui,showImageSizeModal:!1,imageSizeError:null}};case"RESET_TESTDATA":return{...e,testData:{blocks:[],words:[],arrows:[],imageUrl:e.testData.imageUrl}};default:return e}},Kue=({testName:e="",showQuestionCount:t=!0,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const[o,c]=w.useReducer(que,Vue),{showNotification:u}=Ls(),{makeAuthenticatedRequest:d}=tc(),{user:f}=ws(),h=w.useRef(null),g=w.useRef(null),p=w.useRef(null),x=w.useRef({}),v=w.useRef({}),{canvasSize:C,stageRef:b}=$ue(h),{containerSize:_,responsiveSettings:T}=Uue(h),[N,E]=w.useState(null),F=T?.stageHeight??600,j=w.useMemo(()=>F+150,[F]),P=T?.padding??20;w.useEffect(()=>{if(!o.canvas.image||!h.current)return;const G=h.current?.clientWidth||800,W=h.current?.clientHeight||600,Q=G/o.canvas.image.width,X=W/o.canvas.image.height,se=Math.min(Q,X,1),le=o.canvas.image.width*se,he=o.canvas.image.height*se,we=(G-le)/2,ie=(W-he)/2;E({x:we,y:ie,width:le,height:he,scaleX:se,scaleY:se,scale:se,image:o.canvas.image})},[o.canvas.image,h.current?.clientWidth,h.current?.clientHeight]);const{convertToOriginal:M}=zue(N);w.useEffect(()=>{c({type:"SET_CANVAS_SIZE",payload:C})},[C]),w.useEffect(()=>{N&&c({type:"SET_IMAGE_INFO",payload:N})},[N]),w.useEffect(()=>{const G=p.current;if(!G)return;const W=o.ui.selectedBlock?.id?x.current[o.ui.selectedBlock.id]:null;W?(G.nodes([W]),G.getLayer()?.batchDraw()):(G.nodes([]),G.getLayer()?.batchDraw())},[o.ui.selectedBlock]);const I=w.useCallback(()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:null}}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,isDrawingArrow:!1,blockCreationStart:null,arrowStart:null,previewBlock:null,previewArrow:null}}),c({type:"RESET_TESTDATA"}),c({type:"SET_ERROR",payload:null})},[]),U=w.useCallback(async G=>{const W=G.target.files[0];if(!W){u("Please select a file","error");return}try{c({type:"SET_LOADING",payload:!0});const Q=await MH(W);if(!Q.valid){c({type:"SHOW_IMAGE_SIZE_MODAL",payload:{errors:Q.errors,fileSize:(W.size/1024).toFixed(1),dimensions:Q.dimensions}});return}let X=W;if(W.size>500*1024){u("Image is large, compressing to meet size requirements...","info");try{X=await Wue(W,500);const he=(W.size/1024).toFixed(1),we=(X.size/1024).toFixed(1);u(`Image compressed from ${he}KB to ${we}KB`,"success")}catch{u("Failed to compress image. Please try a smaller image.","error");return}}const se=await Hue(X),le=new Image;le.crossOrigin="anonymous",le.onload=()=>{c({type:"SET_IMAGE",payload:le}),c({type:"SET_UI_STATE",payload:{imageUrl:se}}),u("Image uploaded successfully!","success")},le.onerror=()=>{u("Failed to load image","error")},le.src=se}catch(Q){console.error("Image upload error:",Q),u("Error processing image","error")}finally{c({type:"SET_LOADING",payload:!1})}},[u]),K=w.useCallback(G=>{const W=b.current;if(!W)return;const Q=W.getPointerPosition();if(Q){if(o.canvas.selectedTool==="create"){const X=Wy.findAtPosition(o.testData.blocks,Q.x,Q.y);if(X){c({type:"SET_UI_STATE",payload:{selectedBlock:X}});return}c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!0,blockCreationStart:{x:Q.x,y:Q.y}}})}else if(o.canvas.selectedTool==="edit"){const X=Wy.findAtPosition(o.testData.blocks,Q.x,Q.y);c(X?{type:"SET_UI_STATE",payload:{selectedBlock:X}}:{type:"SET_UI_STATE",payload:{selectedBlock:null}})}else if(o.canvas.selectedTool==="arrow"){const X=G.target===W,se=Wy.findAtPosition(o.testData.blocks,Q.x,Q.y);(X||!se)&&c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!0,arrowStart:{x:Q.x,y:Q.y}}})}}},[o.canvas.selectedTool,N,o.testData.blocks]),te=w.useCallback(G=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const W=b.current;if(!W)return;const Q=W.getPointerPosition();if(!Q)return;const X=Math.abs(Q.x-o.creation.blockCreationStart.x),se=Math.abs(Q.y-o.creation.blockCreationStart.y),le=10,he=Math.max(X,le),we=Math.max(se,le);c({type:"SET_CREATION_STATE",payload:{previewBlock:{x:Math.min(Q.x,o.creation.blockCreationStart.x),y:Math.min(Q.y,o.creation.blockCreationStart.y),width:he,height:we,fill:"rgba(0, 123, 255, 0.3)",stroke:"#007bff",strokeWidth:2,dash:[5,5],opacity:.7}}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const W=b.current;if(!W)return;const Q=W.getPointerPosition();if(!Q)return;c({type:"SET_CREATION_STATE",payload:{previewArrow:{startX:o.creation.arrowStart.x,startY:o.creation.arrowStart.y,endX:Q.x,endY:Q.y,stroke:"#dc3545",fill:"#dc3545",strokeWidth:3,dash:[5,5],opacity:.7}}})}},[o.creation]),re=w.useCallback(G=>{if(o.creation.isCreatingBlock&&o.creation.blockCreationStart){const W=b.current;if(!W)return;const Q=W.getPointerPosition();if(!Q)return;const X=Math.abs(Q.x-o.creation.blockCreationStart.x),se=Math.abs(Q.y-o.creation.blockCreationStart.y),le=10,he=Math.max(X,le),we=Math.max(se,le),ie=Math.min(Q.x,o.creation.blockCreationStart.x)+he/2,Ee=Math.min(Q.y,o.creation.blockCreationStart.y)+we/2,ye=Wy.generateId(),Ie=Wy.create(ie,Ee,he,we,ye),ut=h6.create(ye,`Word ${o.testData.blocks.length+1}`,h6.generateId(ye));c({type:"ADD_BLOCK",payload:Ie}),c({type:"ADD_WORD",payload:ut}),c({type:"SET_CREATION_STATE",payload:{isCreatingBlock:!1,blockCreationStart:null,previewBlock:null}}),o.testData.blocks.length===0&&c({type:"SET_UI_STATE",payload:{showWordPanel:!0}})}else if(o.creation.isDrawingArrow&&o.creation.arrowStart){const W=b.current;if(!W)return;const Q=W.getPointerPosition();if(!Q)return;if(jp.validate(o.creation.arrowStart.x,o.creation.arrowStart.y,Q.x,Q.y,o.testData.blocks)){const X=jp.snapToNearestBlock(o.creation.arrowStart.x,o.creation.arrowStart.y,o.testData.blocks),se=jp.snapToNearestBlock(Q.x,Q.y,o.testData.blocks),le=X?X.x:o.creation.arrowStart.x,he=X?X.y:o.creation.arrowStart.y,we=se?se.x:Q.x,ie=se?se.y:Q.y,Ee=jp.generateId(),ye=Gue(),Ie=jp.create(le,he,we,ie,X?X.blockId:null,se?se.blockId:null,Ee,{strokeWidth:ye.arrowThickness,isMobile:ye.isMobile});c({type:"ADD_ARROW",payload:Ie}),u("Arrow created successfully!","success")}else u("Arrow must start near a block!","error");c({type:"SET_CREATION_STATE",payload:{isDrawingArrow:!1,arrowStart:null,previewArrow:null}})}},[o.creation,o.testData.blocks,u]),Z=w.useCallback(G=>{G.evt.preventDefault(),K(G)},[K]),B=w.useCallback(G=>{G.evt.preventDefault(),te(G)},[te]),J=w.useCallback(G=>{G.evt.preventDefault(),re(G)},[re]),z=w.useCallback(async()=>{console.log(" [MatchingTestCreator] handleSaveTest clicked");const G=q();if(Object.keys(G).length>0){console.warn(" [MatchingTestCreator] Validation errors:",G),u("Please fix validation errors before saving","error");return}try{console.log(" [MatchingTestCreator] Preparing data to save...",{blocks:o.testData.blocks.length,words:o.testData.words.length,arrows:o.testData.arrows.length,imageUrl:o.ui.imageUrl?"present":"missing"}),c({type:"SET_LOADING",payload:!0});let W=o.ui.imageUrl;if(o.ui.imageUrl&&o.ui.imageUrl.startsWith("data:")){const X=await d("/.netlify/functions/upload-image",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dataUrl:o.ui.imageUrl,folder:"matching_tests"})}),se=await X.json();if(X.ok&&se.success&&se.url)W=se.url;else throw new Error(se.message||"Upload failed")}const Q=o.testData.blocks.map((X,se)=>{let le;if(N){const ie=M(X.x,X.y),Ee=M(X.x+X.width,X.y+X.height);le={x:ie.x,y:ie.y,width:Number((Ee.x-ie.x).toFixed(4)),height:Number((Ee.y-ie.y).toFixed(4))}}else le={x:Number(X.x.toFixed(4)),y:Number(X.y.toFixed(4)),width:Number(X.width.toFixed(4)),height:Number(X.height.toFixed(4))};const he=o.testData.words.find(ie=>ie.blockId===X.id),we=o.testData.arrows.find(ie=>ie.startBlock===X.id);return{question_id:se+1,word:he?.word||`Word ${se+1}`,block_coordinates:le,has_arrow:!!we,arrow:we&&N?(()=>{const ie=M(we.startX,we.startY),Ee=M(we.endX,we.endY),ye=ie.x/N.originalWidth*100,Ie=ie.y/N.originalHeight*100,ut=Ee.x/N.originalWidth*100,Qe=Ee.y/N.originalHeight*100;return{start_x:Number(ie.x.toFixed(4)),start_y:Number(ie.y.toFixed(4)),end_x:Number(Ee.x.toFixed(4)),end_y:Number(Ee.y.toFixed(4)),rel_start_x:Number(ye.toFixed(4)),rel_start_y:Number(Ie.toFixed(4)),rel_end_x:Number(ut.toFixed(4)),rel_end_y:Number(Qe.toFixed(4)),image_width:N.originalWidth,image_height:N.originalHeight,style:we.style||{color:"#dc3545",thickness:3}}})():null}});r&&(console.log(" [MatchingTestCreator] Calling onTestSaved with processed data"),r({success:!0,message:"Test data prepared for assignment",blocks:o.testData.blocks,words:o.testData.words,arrows:o.testData.arrows,imageUrl:W,processedQuestions:Q}))}catch(W){console.error("Save error:",W),u(`Error saving test: ${W.message}`,"error")}finally{c({type:"SET_LOADING",payload:!1})}},[o.testData,o.ui.imageUrl,N,M,d,r,u,e,f]),q=w.useCallback(()=>{const G={};return e.trim()||(G.testName="Test name is required"),o.testData.blocks.length===0&&(G.blocks="At least one block is required"),G},[e,o.testData.blocks.length]),H=()=>l.jsxs("div",{className:"flex flex-wrap gap-2 p-4 bg-gray-50 border-b",children:[l.jsx(at,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"create"}),variant:o.canvas.selectedTool==="create"?"primary":"secondary",size:"sm",children:" Create Blocks"}),l.jsx(at,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"edit"}),variant:o.canvas.selectedTool==="edit"?"primary":"secondary",size:"sm",children:" Edit Blocks"}),l.jsx(at,{onClick:()=>c({type:"SET_SELECTED_TOOL",payload:"arrow"}),variant:o.canvas.selectedTool==="arrow"?"primary":"secondary",size:"sm",children:" Draw Arrows"}),l.jsx(at,{onClick:I,variant:"secondary",size:"sm",children:" Reset"}),l.jsx(at,{onClick:()=>g.current?.click(),variant:"secondary",size:"sm",children:" Upload Image"}),l.jsx("div",{className:"text-xs text-gray-500 text-center col-span-full",children:"Max size: 500KB  Max dimensions: 4000x4000px"})]}),R=()=>l.jsx(oh,{width:_.width,height:j,ref:b,onMouseDown:K,onMouseMove:te,onMouseUp:re,onTouchStart:Z,onTouchMove:B,onTouchEnd:J,className:o.canvas.selectedTool==="arrow"||o.canvas.selectedTool==="create"?"cursor-crosshair":"cursor-default",children:l.jsxs(ih,{children:[o.canvas.image&&N&&l.jsx(D2,{image:o.canvas.image,x:N.x,y:N.y,width:N.width,height:N.height}),o.testData.blocks.map(G=>l.jsxs(vl,{ref:W=>{W&&(v.current[G.id]=W)},draggable:o.canvas.selectedTool==="edit",x:G.x,y:G.y,onMouseEnter:W=>{const Q=W.target.getStage()?.container();Q&&(Q.style.cursor=o.ui.selectedBlock?.id===G.id?"nwse-resize":"move")},onMouseLeave:W=>{const Q=W.target.getStage()?.container();Q&&(Q.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onDragStart:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:G}})},onDragEnd:W=>{const{x:Q,y:X}=W.target.position();c({type:"UPDATE_BLOCK",payload:{id:G.id,updates:{x:Q,y:X}}})},onClick:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:G}})},onTap:()=>{c({type:"SET_UI_STATE",payload:{selectedBlock:G}})},children:[l.jsx(Ja,{ref:W=>{W&&(x.current[G.id]=W)},width:G.width,height:G.height,fill:G.fill,stroke:G.stroke,strokeWidth:G.strokeWidth,cornerRadius:G.cornerRadius,shadowColor:G.shadowColor,shadowBlur:G.shadowBlur,shadowOffset:G.shadowOffset,shadowOpacity:G.shadowOpacity,draggable:o.canvas.selectedTool==="edit",onDragEnd:W=>{const{x:Q,y:X}=W.target.getParent().position();c({type:"UPDATE_BLOCK",payload:{id:G.id,updates:{x:Q,y:X}}})},onMouseEnter:W=>{const Q=W.target.getStage()?.container();Q&&(Q.style.cursor=o.ui.selectedBlock?.id===G.id?"nwse-resize":"move")},onMouseLeave:W=>{const Q=W.target.getStage()?.container();Q&&(Q.style.cursor=o.canvas.selectedTool==="arrow"?"crosshair":"default")},onTransformEnd:W=>{const Q=x.current[G.id];if(!Q)return;const X=Math.max(10,Q.width()*Q.scaleX()),se=Math.max(10,Q.height()*Q.scaleY());Q.scaleX(1),Q.scaleY(1),c({type:"UPDATE_BLOCK",payload:{id:G.id,updates:{width:X,height:se}}})}}),l.jsx(Nc,{x:2,y:2,text:`${o.testData.blocks.indexOf(G)+1}`,fontSize:Math.min(T.fontSize,Math.max(8,G.width/4)),fontFamily:"Arial",fill:"#333",fontStyle:"bold",listening:!1})]},G.id)),l.jsx(FH,{ref:p,rotateEnabled:!1,flipEnabled:!1,boundBoxFunc:(G,W)=>({...W,width:Math.max(W.width,10),height:Math.max(W.height,10)})}),o.testData.arrows.map(G=>l.jsx(jT,{points:[G.startX,G.startY,G.endX,G.endY],stroke:G.stroke,fill:G.fill,strokeWidth:G.strokeWidth||T.arrowThickness,pointerLength:G.pointerLength,pointerWidth:G.pointerWidth},G.id)),o.creation.previewBlock&&l.jsx(Ja,{x:o.creation.previewBlock.x,y:o.creation.previewBlock.y,width:o.creation.previewBlock.width,height:o.creation.previewBlock.height,fill:o.creation.previewBlock.fill,stroke:o.creation.previewBlock.stroke,strokeWidth:o.creation.previewBlock.strokeWidth,dash:o.creation.previewBlock.dash,opacity:o.creation.previewBlock.opacity}),o.creation.previewArrow&&l.jsx(jT,{points:[o.creation.previewArrow.startX,o.creation.previewArrow.startY,o.creation.previewArrow.endX,o.creation.previewArrow.endY],stroke:o.creation.previewArrow.stroke,fill:o.creation.previewArrow.fill,strokeWidth:o.creation.previewArrow.strokeWidth,dash:o.creation.previewArrow.dash,opacity:o.creation.previewArrow.opacity})]})}),L=w.useMemo(()=>o.testData.blocks.length===0?null:l.jsxs("div",{className:"word-panel bg-gray-50 border-t border-gray-200 p-4 w-full flex-shrink-0",style:{height:"clamp(420px, 55vh, 640px)",overflowY:"auto"},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-800",children:"Words (Auto-created with blocks)"}),l.jsx("div",{className:"space-y-2",children:o.testData.words.map(G=>{const W=o.testData.blocks.find(Q=>Q.id===G.blockId);return l.jsxs("div",{className:"p-2 bg-white rounded border",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("span",{className:"text-xs text-gray-500",children:["Block ",o.testData.blocks.indexOf(W)+1]}),l.jsx("button",{onClick:()=>c({type:"DELETE_BLOCK",payload:W.id}),className:"text-red-500 hover:text-red-700 text-xs",children:""})]}),l.jsx("input",{type:"text",value:G.word,onChange:Q=>{const X=h6.update(o.testData.words,G.blockId,Q.target.value);c({type:"UPDATE_WORDS",payload:X})},className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Enter word text"})]},G.blockId)})})]}),[o.testData.words,o.testData.blocks]);return l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"flex flex-col h-screen bg-gray-100",children:[l.jsx("div",{className:"bg-white shadow-sm border-b p-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsx("div",{children:l.jsx("div",{className:"mt-2 text-sm text-gray-600",children:l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("span",{children:[l.jsx("strong",{children:"Test Name:"})," ",e||"Untitled Test"]}),l.jsxs("span",{children:[l.jsx("strong",{children:"Questions:"})," ",o.testData.blocks.length," (auto-generated from blocks)"]})]})})})})}),H(),l.jsxs("div",{className:"flex flex-col flex-1 overflow-y-auto gap-4",children:[l.jsx("div",{ref:h,className:"bg-white border overflow-hidden flex-none",style:{height:`${j}px`,minHeight:`${j}px`,maxHeight:`${j+60}px`,padding:`${P}px`},children:R()}),L]}),l.jsx("div",{className:"bg-white border-t p-4",children:l.jsx("div",{className:"flex justify-center",children:l.jsx(at,{onClick:z,disabled:a||o.ui.isLoading,variant:"primary",size:"lg",children:a||o.ui.isLoading?l.jsx(Xr,{size:"sm"}):"Save Test"})})}),l.jsx("input",{ref:g,type:"file",accept:"image/*,application/pdf",onChange:U,className:"hidden"}),l.jsx(Ds,{isOpen:o.ui.showImageSizeModal,onClose:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),title:" Image Too Large",size:"medium",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("span",{className:"text-red-600 text-2xl mr-2",children:""}),l.jsx("h4",{className:"text-lg font-semibold text-red-800",children:"Image Size Issues"})]}),l.jsx("div",{className:"text-red-700",children:o.ui.imageSizeError?.errors.map((G,W)=>l.jsxs("div",{className:"mb-2",children:[" ",G]},W))})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-blue-800 mb-2",children:" Current Image Details:"}),l.jsxs("div",{className:"text-blue-700 space-y-1",children:[l.jsxs("div",{children:[" File size: ",o.ui.imageSizeError?.fileSize,"KB"]}),o.ui.imageSizeError?.dimensions&&l.jsxs("div",{children:[" Dimensions: ",o.ui.imageSizeError.dimensions.width,"  ",o.ui.imageSizeError.dimensions.height," pixels"]})]})]}),l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-green-800 mb-2",children:" Requirements:"}),l.jsxs("div",{className:"text-green-700 space-y-1",children:[l.jsx("div",{children:" Maximum file size: 500KB"}),l.jsx("div",{children:" Maximum dimensions: 4000  4000 pixels"}),l.jsx("div",{children:" Supported formats: All image formats (JPEG, PNG, WebP, etc.)"})]})]}),l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[l.jsx("h5",{className:"font-semibold text-yellow-800 mb-2",children:" How to Fix:"}),l.jsxs("div",{className:"text-yellow-700 space-y-1",children:[l.jsx("div",{children:" Use an image editor to resize your image"}),l.jsx("div",{children:" Compress the image using online tools"}),l.jsx("div",{children:" Try a different image with smaller dimensions"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(at,{onClick:()=>c({type:"HIDE_IMAGE_SIZE_MODAL"}),variant:"secondary",children:"Close"}),l.jsx(at,{onClick:()=>{c({type:"HIDE_IMAGE_SIZE_MODAL"}),g.current?.click()},variant:"primary",children:"Try Another Image"})]})]})})]})},Yue="modulepreload",Xue=function(e){return"/"+e},UM={},ui=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){let u=function(d){return Promise.all(d.map(f=>Promise.resolve(f).then(h=>({status:"fulfilled",value:h}),h=>({status:"rejected",reason:h}))))};var i=u;document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=o?.nonce||o?.getAttribute("nonce");s=u(r.map(d=>{if(d=Xue(d),d in UM)return;UM[d]=!0;const f=d.endsWith(".css"),h=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${h}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Yue,f||(g.as="script"),g.crossOrigin="",g.href=d,c&&g.setAttribute("nonce",c),document.head.appendChild(g),f)return new Promise((p,x)=>{g.addEventListener("load",p),g.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${d}`)))})}))}function a(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return s.then(o=>{for(const c of o||[])c.status==="rejected"&&a(c.reason);return t().catch(a)})},D1=(e,t,r)=>{const[n,s]=w.useState(!1),[a,i]=w.useState(0),[o,c]=w.useState(!1),u=w.useRef(!1);w.useEffect(()=>{if(!e||!t||!r)return;const v=`anti_cheating_${r}_${e}_${t}`,C=Os(v);C&&(i(C.tabSwitches||0),c(C.isCheating||!1))},[e,t,r]);const d=w.useCallback(()=>{if(console.log(" handleTabSwitch called - isTracking:",u.current),!u.current){console.log(" Not tracking, returning early");return}console.log(" Tab switch detected - starting 7 second timer...");const v=Date.now();setTimeout(()=>{const C=Date.now()-v;console.log(" Timer completed - time hidden:",C,"ms"),C>=6500?(console.log(" Tab was hidden for sufficient time - counting as tab switch"),i(b=>{const _=b+1,T=_>=2;console.log(" Tab switch count updated:",{newCount:_,cheating:T}),c(T);const N=`anti_cheating_${r}_${e}_${t}`;return vs(N,{tabSwitches:_,isCheating:T},120*1e3),_})):console.log(" Tab was not hidden long enough - not counting as switch")},7e3)},[e,t,r]),f=w.useCallback(()=>{u.current&&(console.log(" Visibility change detected:",{hidden:document.hidden,isTracking:u.current}),document.hidden?d():console.log(" Tab became visible"))},[d]),h=w.useCallback(()=>{console.log(" startTracking called - setting up anti-cheating detection"),console.log(" Current document.hidden state:",document.hidden),console.log(" Current document.visibilityState:",document.visibilityState),s(!0),u.current=!0,document.addEventListener("visibilitychange",f),console.log(" Anti-cheating event listeners added (visibilitychange only)")},[f]),g=w.useCallback(()=>{console.log(" stopTracking called - removing anti-cheating detection"),s(!1),u.current=!1,document.removeEventListener("visibilitychange",f),console.log(" Anti-cheating event listeners removed")},[f]),p=w.useCallback(()=>{const v={caught_cheating:o,visibility_change_times:a};return console.log(" getCheatingData called:",v),v},[o,a]),x=w.useCallback(()=>{r&&e&&t&&j1(r,e,t),i(0),c(!1),console.log(" Anti-cheating data deleted from localStorage")},[r,e,t]);return{startTracking:h,stopTracking:g,clearData:x,getCheatingData:p,tabSwitches:a,isCheating:o,isTracking:n}},I2=(e,t)=>{const r=w.useRef(e),n=w.useRef(t),s=w.useRef(!1);return w.useEffect(()=>{n.current=t},[t]),w.useEffect(()=>{r.current=e},[e]),w.useEffect(()=>{if(typeof window>"u"||!e)return()=>{};const a=f=>{try{window.history.pushState({__intercept:!0,prevState:f??null,ts:Date.now()},document.title,window.location.href),s.current=!0}catch(h){console.warn("Failed to push intercept state",h)}},i=()=>{try{const f=window.history.state;if(f&&f.__intercept){const h=f.prevState??null;window.history.replaceState(h,document.title,window.location.href)}}catch(f){console.warn("Failed to restore previous state",f)}s.current=!1},o=()=>{s.current&&(r.current=!1,i(),window.history.go(-1))},c=()=>{},u=f=>{if(!r.current){s.current=!1;return}const h=f.state;a(h),n.current?.({source:"browser",confirm:o,cancel:c})},d=window.history.state;return a(d),window.addEventListener("popstate",u),()=>{window.removeEventListener("popstate",u),i()}},[e]),null},Jue=({testData:e,onTestComplete:t,onBackToCabinet:r,isTestComplete:n=!1,testScore:s=null})=>{const[a,i]=w.useState(null),[o,c]=w.useState(null);w.useEffect(()=>{(async()=>{try{const[$e,Mt]=await Promise.all([ui(()=>Promise.resolve().then(()=>Oue),void 0),ui(()=>Promise.resolve().then(()=>hce),void 0)]);i($e),c(Mt.default)}catch($e){console.error("Failed to load Konva:",$e)}})()},[]);const u=()=>a?{Stage:a.Stage,Layer:a.Layer,Rect:a.Rect,Arrow:a.Arrow,KonvaImage:a.Image,KonvaText:a.Text,Group:a.Group}:null,[d,f]=w.useState({}),[h,g]=w.useState({}),[p,x]=w.useState(0),[v,C]=w.useState(!1),[b,_]=w.useState(null),[T,N]=w.useState(0),[E,F]=w.useState(0),[j,P]=w.useState(null),[M,I]=w.useState(null),[U,K]=w.useState(!1),[te,re]=w.useState(!1),[Z,B]=w.useState(!1),[J,z]=w.useState(!0),q=w.useRef(null);I2(J,w.useCallback(({confirm:Oe,cancel:$e})=>{console.log(" MatchingTestStudent: Browser back button intercepted during test!"),console.log(" MatchingTestStudent: isBackInterceptEnabled:",J),console.log(" MatchingTestStudent: Setting pending navigation and showing modal"),q.current={confirm:Oe,cancel:$e},re(!0)},[J]));const{showNotification:H}=Ls(),{makeAuthenticatedRequest:R}=tc(),{user:L}=ws(),{startTracking:G,stopTracking:W,getCheatingData:Q,clearData:X}=D1("matching_type",e?.id,L?.student_id||L?.id),se=w.useRef(null),le=w.useRef(null),he=w.useRef(null),we=w.useRef(0),[ie,Ee]=w.useState(400);w.useRef({});const ye=w.useCallback(()=>{K(!0)},[]),Ie=w.useCallback(()=>{g({}),f({}),K(!1)},[]),ut=w.useCallback(()=>{q.current=null,re(!0)},[]),Qe=w.useCallback(()=>{console.log(" MatchingTestStudent: confirmBackToCabinet called"),console.log(" MatchingTestStudent: Current location:",window.location.href),console.log(" MatchingTestStudent: Current history state:",window.history.state),re(!1);const Oe=q.current;if(console.log(" MatchingTestStudent: Pending navigation:",Oe),q.current=null,e?.id&&L?.student_id){const Mt=`anti_cheating_${L?.student_id||L?.id||"unknown"}_matching_type_${e.id}`,At=(Os(Mt)||{tabSwitches:0}).tabSwitches||0,tr=At+1,ar=tr>=2;console.log(" MatchingTestStudent: Tab switch count:",At,"->",tr),vs(Mt,{tabSwitches:tr,isCheating:ar},hs.anti_cheating)}if(console.log(" MatchingTestStudent: Disabling intercept"),z(!1),Oe){console.log(" MatchingTestStudent: Cleaning up intercept history state");try{const $e=window.history.state;if(console.log(" MatchingTestStudent: Current history state before cleanup:",$e),$e&&$e.__intercept){const Mt=$e.prevState??null;console.log(" MatchingTestStudent: Restoring previous state:",Mt),window.history.replaceState(Mt,document.title,window.location.href),console.log(" MatchingTestStudent: History state after cleanup:",window.history.state)}}catch($e){console.warn(" MatchingTestStudent: Failed to restore history state:",$e)}}console.log(" MatchingTestStudent: Scheduling navigation in 100ms"),setTimeout(()=>{console.log(" MatchingTestStudent: Executing navigation to /student"),console.log(" MatchingTestStudent: Current location before navigation:",window.location.href),window.location.href="/student",console.log(" MatchingTestStudent: window.location.href set to /student")},100)},[r,e,L?.student_id,L?.id]),$t=w.useCallback(()=>{const Oe=q.current;q.current=null,Oe?.cancel&&Oe.cancel(),re(!1)},[]),Ge=w.useMemo(()=>{if(!e)return null;const Oe=e.blocks.map(It=>{let At=It.coordinates;if(typeof At=="string")try{At=JSON.parse(At)}catch(tr){console.error(" Failed to parse coordinates:",tr),At={x:0,y:0,width:100,height:100}}return At={x:(typeof At.x=="number"?At.x:Number(At.x))||0,y:(typeof At.y=="number"?At.y:Number(At.y))||0,width:(typeof At.width=="number"?At.width:Number(At.width))||30,height:(typeof At.height=="number"?At.height:Number(At.height))||10},{id:It.id,word:It.word,coordinates:At,hasArrow:It.hasArrow,arrow:It.arrow}}),$e=Array.isArray(e.arrows)?e.arrows:[],Mt=e.words.map(It=>({id:It.id,word:It.word,blockId:null,isPlaced:!1,isCorrect:!1}));return{blocks:Oe,arrows:$e,words:Mt}},[e]);w.useEffect(()=>{if(!e?.image_url)return;const Oe=new Image;Oe.crossOrigin="anonymous",Oe.onload=()=>{console.log(" Image loaded successfully"),N(Oe.width),F(Oe.height);const $e=se.current?.clientWidth||800,Mt=se.current?.clientHeight||600,It=$e/Oe.width,At=Mt/Oe.height,tr=Math.min(It,At,1),ar=Oe.width*tr,dr=Oe.height*tr,or=($e-ar)/2,mr=(Mt-dr)/2;_({x:or,y:mr,width:ar,height:dr,scaleX:tr,scaleY:tr,scale:tr,image:Oe}),we.current=se.current?.clientWidth||800,console.log(" Image info calculated:",{x:or,y:mr,width:ar,height:dr,scaleX:tr,scaleY:tr})},Oe.onerror=()=>{console.error(" Failed to load image"),H("Failed to load test image","error")},Oe.src=e.image_url},[e?.image_url,H]),w.useEffect(()=>{if(!Ge||!b)return;const Oe=we.current||se.current?.clientWidth||800,$e=12,Mt=38;let It=b.x,At=b.y+b.height+$e;const tr=b.x+b.width,ar={};Ge.words.forEach(mr=>{if(!Object.prototype.hasOwnProperty.call(h,mr.id)){const ve=typeof mr.word=="string"?mr.word:"",Fe=Math.max(60,ve.length*8+20);It+Fe>Math.min(Oe-$e,tr)&&(It=b.x,At+=Mt),d[mr.id]||(ar[mr.id]={x:It,y:At}),It+=Fe+$e}}),Object.keys(ar).length&&f(mr=>({...mr,...ar}));const dr=Object.values(ar).reduce((mr,ve)=>Math.max(mr,ve.y),At),or=Math.max(b.y+b.height+$e,dr+Mt+$e);Ee(Math.max(400,Math.ceil(or)))},[Ge,b,h,d]);const et=w.useCallback(()=>{if(!b||!Ge)return[];const Oe=u();return Oe?Ge.blocks.map($e=>{const Mt=$e.coordinates;let It,At,tr,ar;It=b.x+Mt.x*(b.scale??b.scaleX),At=b.y+Mt.y*(b.scale??b.scaleY),tr=Mt.width*(b.scale??b.scaleX),ar=Mt.height*(b.scale??b.scaleY);const dr=h[$e.id];return l.jsxs(Oe.Group,{children:[l.jsx(Oe.Rect,{x:It,y:At,width:tr,height:ar,fill:dr?"rgba(40, 167, 69, 0.4)":j===$e.id?"rgba(0, 123, 255, 0.25)":"rgba(0, 123, 255, 0.15)",stroke:dr?"#28a745":j===$e.id?"#0056b3":"#007bff",strokeWidth:2,cornerRadius:6,shadowColor:dr?"rgba(40, 167, 69, 0.3)":"rgba(0, 123, 255, 0.3)",shadowBlur:10,shadowOffset:{x:0,y:2},shadowOpacity:.5}),dr&&l.jsx(Oe.KonvaText,{x:It+5,y:At+ar/2-10,width:tr-10,height:20,text:Ge.words.find(or=>or.id===dr)?.word||"",fontSize:Math.min(12,tr/8),fontFamily:"Arial",fill:"#2c3e50",align:"center",verticalAlign:"middle",listening:!1})]},$e.id)}):[]},[b,Ge,h,a]),vt=w.useCallback(()=>{if(!b||!Ge)return[];const Oe=u();return Oe?(console.log(" Processing arrows:",Ge.arrows),Ge.arrows.map($e=>{if(console.log(" Arrow data:",$e),!$e.start||!$e.end)return console.warn(" Arrow missing start/end coordinates:",$e),null;let Mt,It,At,tr;if($e.rel_start_x!==null&&$e.rel_start_y!==null&&$e.rel_end_x!==null&&$e.rel_end_y!==null&&$e.image_width&&$e.image_height&&$e.image_width>0&&$e.image_height>0){const ar=$e.image_width,dr=$e.image_height,or=b.width/ar,mr=b.height/dr;Mt=b.x+Number($e.rel_start_x)/100*ar*or,It=b.y+Number($e.rel_start_y)/100*dr*mr,At=b.x+Number($e.rel_end_x)/100*ar*or,tr=b.y+Number($e.rel_end_y)/100*dr*mr}else{const ar=b.scale??b.scaleX??1,dr=Number($e.start.x),or=Number($e.start.y),mr=Number($e.end.x),ve=Number($e.end.y);dr<=b.width+1&&mr<=b.width+1&&or<=b.height+1&&ve<=b.height+1?(Mt=b.x+(isNaN(dr)?0:dr),It=b.y+(isNaN(or)?0:or),At=b.x+(isNaN(mr)?0:mr),tr=b.y+(isNaN(ve)?0:ve)):(Mt=b.x+(isNaN(dr)?0:dr)*ar,It=b.y+(isNaN(or)?0:or)*ar,At=b.x+(isNaN(mr)?0:mr)*ar,tr=b.y+(isNaN(ve)?0:ve)*ar)}return l.jsx(Oe.Arrow,{points:[Mt,It,At,tr],stroke:$e.style?.color||"#dc3545",fill:$e.style?.color||"#dc3545",strokeWidth:$e.style?.thickness||3,pointerLength:10,pointerWidth:10},$e.id)}).filter(Boolean)):[]},[b,Ge,a]),Te=w.useCallback(()=>{if(!Ge)return[];const Oe=u();return Oe?Ge.words.map($e=>{const Mt=d[$e.id]||{x:0,y:0},It=typeof $e.word=="string"?$e.word:"",At=Math.max(60,It.length*8+20);return Object.values(h).includes($e.id)?null:l.jsxs(Oe.Group,{x:Mt.x,y:Mt.y,draggable:!0,onDragEnd:ar=>Ve(ar,$e.id),children:[l.jsx(Oe.Rect,{width:At,height:34,fill:"#ffffff",stroke:"#ced4da",strokeWidth:1,cornerRadius:4,shadowColor:"rgba(0,0,0,0.1)",shadowBlur:5,shadowOffset:{x:0,y:2},shadowOpacity:.3,listening:!0}),l.jsx(Oe.KonvaText,{text:It,fontSize:14,fontFamily:"Arial",fill:"#343a40",padding:8,align:"center",verticalAlign:"middle",width:At,height:34,listening:!1})]},$e.id)}):[]},[Ge,d,h,b,a]),Ve=w.useCallback((Oe,$e)=>{const Mt=Oe.target.x(),It=Oe.target.y();if(f(Fe=>({...Fe,[$e]:{x:Mt,y:It}})),!b||!Ge)return;const At=Ge.words.find(Fe=>Fe.id===$e);if(!At)return;const tr=typeof At.word=="string"?At.word:"",ar=Math.max(60,tr.length*8+20),dr={x:Mt,y:It,width:ar,height:34},or=b.scale??b.scaleX??1,mr=(Fe,Be)=>!(Be.x>Fe.x+Fe.width||Be.x+Be.width<Fe.x||Be.y>Fe.y+Fe.height||Be.y+Be.height<Fe.y),ve=Ge.blocks.find(Fe=>{const Be=Fe.coordinates,Pe={x:b.x+Be.x*or,y:b.y+Be.y*or,width:Be.width*or,height:Be.height*or};return mr(dr,Pe)});if(ve){g(Lt=>({...Lt,[ve.id]:$e}));const Fe=ve.coordinates,Be=b.x+Fe.x*or,Pe=b.y+Fe.y*or,lt=Fe.width*or,Ct=Fe.height*or;f(Lt=>({...Lt,[$e]:{x:Be+(lt-ar)/2,y:Pe+(Ct-34)/2}})),H(`Word "${At.word}" placed in block`,"success")}},[b,Ge,H]),pt=w.useCallback(()=>{if(!Ge)return 0;const Oe=Ge.words.length,$e=Object.keys(h).length;return Oe>0?$e/Oe*100:0},[Ge,h]);w.useEffect(()=>{const Oe=pt();x(Oe)},[pt]),w.useEffect(()=>{if(e&&!M){const Oe=new Date;I(Oe),console.log(" Test timer started at:",Oe.toISOString()),G(),console.log(" Anti-cheating tracking started")}},[e,M,G]);const wt=w.useCallback(async()=>{if(Ge){C(!0);try{const Oe=Ge.words.length;let $e=0;console.log(" Scoring check - placedWords:",h),console.log(" Scoring check - blocks:",Ge.blocks.map(Ue=>({id:Ue.id,word:Ue.word}))),console.log(" Scoring check - words:",Ge.words.map(Ue=>({id:Ue.id,word:Ue.word}))),Ge.blocks.forEach(Ue=>{const st=h[Ue.id];if(console.log(` Block ${Ue.id} (expects "${Ue.word}") has placed word ID: ${st}`),st){const dt=Ge.words.find(Bt=>Bt.id===st);console.log(" Placed word:",dt),dt&&dt.word===Ue.word?($e++,console.log(` Correct! Block ${Ue.id} has correct word "${dt.word}"`)):console.log(` Incorrect! Block ${Ue.id} expected "${Ue.word}" but got "${dt?.word||"nothing"}"`)}else console.log(` Block ${Ue.id} has no word placed`)});const Mt=$e,It=Oe;console.log(` Final Score: ${Mt}/${It} (${Math.round(Mt/It*100)}%)`);const At=new Date,tr=M?Math.round((At-M)/1e3):0,ar=M?M.toISOString():At.toISOString();console.log(" Test timing:",{startedAt:ar,endTime:At.toISOString(),timeTaken:`${tr} seconds`});const dr=Q();console.log(" Anti-cheating data for submission:",dr);const or=L.student_id,mr=`retest_assignment_id_${or}_matching_type_${e.id}`,ve=localStorage.getItem(mr),{academicCalendarService:Fe}=await ui(async()=>{const{academicCalendarService:Ue}=await Promise.resolve().then(()=>JS);return{academicCalendarService:Ue}},void 0);await Fe.loadAcademicCalendar();const Pe=Fe.getCurrentTerm()?.id;if(!Pe)throw new Error("No current academic period found");const lt={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:or,academic_period_id:Pe,answers:h,score:Mt,maxScore:It,time_taken:tr,started_at:ar,submitted_at:At.toISOString(),caught_cheating:dr.caught_cheating,visibility_change_times:dr.visibility_change_times,retest_assignment_id:ve?Number(ve):null,parent_test_id:e.id};console.log(" Submitting test data:",lt);const Lt=await(await R("/.netlify/functions/submit-matching-type-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(lt)})).json();if(console.log(" Submission response:",Lt),Lt.success){if(H("Test submitted successfully!","success"),W(),X(),L?.student_id&&j1(L.student_id,"matching_type",e.id),!!ve&&L?.student_id){let dt=3;try{const xr=localStorage.getItem(`student_active_tests_${L.student_id}`);if(xr){const yr=JSON.parse(xr)?.tests?.find(Br=>Br.test_id===e.id&&Br.test_type==="matching_type");yr&&(dt=yr.retest_attempts_left||yr.max_attempts||3)}}catch(xr){console.error("Error checking active tests cache:",xr)}const Yt=(Mt>0&&It>0?Mt/It*100:0)>=50;if(Yt){const xr=`retest_attempt${dt}_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(xr,"true"),console.log(" Passed retest, marking last-slot key:",xr);let Rr=0;for(let me=1;me<=10;me++){const Ne=`retest_attempt${me}_${L.student_id}_matching_type_${e.id}`;localStorage.getItem(Ne)==="true"&&Rr++}const yr=`test_completed_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(yr,"true"),console.log(" Marked retest as completed (student passed):",yr);const Br=`retest_attempts_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(Br,JSON.stringify({used:Rr,max:dt})),console.log(" Set retest attempts metadata (student passed):",Br,{used:Rr,max:dt})}else{let xr=1;for(let Ne=1;Ne<=10;Ne++){const be=`retest_attempt${Ne}_${L.student_id}_matching_type_${e.id}`;if(localStorage.getItem(be)!=="true"){xr=Ne;break}}const Rr=`retest_attempt${xr}_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(Rr,"true"),console.log(" Marked retest attempt as completed:",Rr);let yr=0;for(let Ne=1;Ne<=10;Ne++){const be=`retest_attempt${Ne}_${L.student_id}_matching_type_${e.id}`;localStorage.getItem(be)==="true"&&yr++}const Br=dt-yr,me=Br<=0||Yt;if(console.log(" Retest completion check:",{usedAttempts:yr,maxAttempts:dt,attemptsLeft:Br,passed:Yt,shouldComplete:me}),me){const Ne=`test_completed_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(Ne,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",Ne);const be=`retest_attempts_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(be,JSON.stringify({used:yr,max:dt})),console.log(" Set retest attempts metadata (attempts exhausted):",be,{used:yr,max:dt})}}}else if(L?.student_id){const dt=`test_completed_${L.student_id}_matching_type_${e.id}`;localStorage.setItem(dt,"true"),console.log(" Test marked as completed in localStorage:",dt)}if(L?.student_id){const{setCachedData:dt,CACHE_TTL:Bt}=await ui(async()=>{const{setCachedData:xr,CACHE_TTL:Rr}=await Promise.resolve().then(()=>Dp);return{setCachedData:xr,CACHE_TTL:Rr}},void 0),Yt=`student_results_table_${L.student_id}`;dt(Yt,Lt,Bt.student_results_table),console.log(" Test results cached with key:",Yt)}const st=`retest1_${or}_matching_type_${e.id}`;localStorage.removeItem(st),localStorage.removeItem(mr),t&&(z(!1),t(Mt))}else throw new Error(Lt.message||"Failed to submit test")}catch(Oe){console.error(" Error submitting test:",Oe),H(`Error submitting test: ${Oe.message}`,"error")}finally{C(!1)}}},[Ge,h,e,L,M,R,H,t]);if(!e||!Ge)return l.jsx(Xr,{});const{theme:Ut,isCyberpunk:ct,themeClasses:yt}=da(),rt=ua(Ut);return l.jsx("div",{className:`min-h-screen p-4 ${ct?"bg-gradient-to-br from-black via-gray-900 to-purple-900":"bg-white"}`,style:ct?rt.background:{},children:l.jsxs("div",{className:"max-w-6xl mx-auto",children:[l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(at,{onClick:ut,variant:"outline",size:"sm",children:"Back to Cabinet"})}),l.jsxs("div",{className:`rounded-lg shadow-sm p-6 mb-6 border ${ct?Vt(2).className:`${yt.cardBg} ${yt.cardBorder}`}`,style:ct?{...Vt(2).style,...rt.glow}:{},children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${ct?"":yt.text}`,style:ct?{...rt.textCyan,fontFamily:"monospace"}:{},children:e.test_name})}),l.jsxs("div",{className:"text-right",children:[l.jsx("div",{className:`text-sm ${ct?"":yt.textSecondary}`,style:ct?{...rt.textYellow,fontFamily:"monospace"}:{},children:"Progress"}),l.jsxs("div",{className:`text-2xl font-bold ${ct?"":"text-blue-600"}`,style:ct?{...rt.textCyan,fontFamily:"monospace"}:{},children:[Math.round(p),"%"]})]})]}),l.jsx("div",{className:`mt-4 w-full ${yt.progressBg} rounded-full h-2 border ${ct?"border-cyan-400/50":yt.border}`,children:l.jsx("div",{className:`${yt.progressFill} h-2 rounded-full transition-all duration-300`,style:ct?{width:`${p}%`,boxShadow:"0 0 10px rgba(255, 215, 0, 0.5), 0 0 20px rgba(0, 255, 255, 0.3)"}:{width:`${p}%`}})})]}),l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:l.jsx("div",{className:"lg:col-span-3",children:l.jsxs(Kt,{className:`p-4 ${ct?Vt(3).className:""}`,style:ct?{...Vt(3).style,...rt.glow}:{},children:[l.jsx("div",{className:"mb-4 text-center",children:l.jsx(at,{onClick:ye,variant:"secondary",children:"Reset"})}),l.jsx("div",{ref:se,className:"w-full bg-gray-100 rounded-lg overflow-hidden",style:{height:`${ie}px`},children:b&&a?(()=>{const{Stage:Oe,Layer:$e,KonvaImage:Mt}=u();return l.jsxs(Oe,{ref:le,width:se.current?.clientWidth||800,height:ie,children:[l.jsxs($e,{children:[l.jsx(Mt,{ref:he,image:b.image,x:b.x,y:b.y,width:b.width,height:b.height,listening:!1}),et(),vt()]}),l.jsx($e,{listening:!0,children:Te()})]})})():b?l.jsxs("div",{className:"flex items-center justify-center h-full",children:[l.jsx(Xr,{size:"lg"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading Konva canvas..."})]}):null}),l.jsx("div",{className:"mt-4 text-center",children:l.jsx(at,{onClick:()=>B(!0),disabled:v||p<100,className:"",style:ct?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...rt.glow}:{},children:ct?v?"SUBMITTING...":"SUBMIT TEST":v?"Submitting...":"Submit Test"})})]})})}),l.jsx(Ds,{isOpen:U,onClose:()=>K(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and placed words."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>K(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:Ie,variant:"primary",children:"Reset"})]})]})}),l.jsx(Ds,{isOpen:te,onClose:$t,title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet? Your progress will be saved but you will exit the test."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:$t,variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:Oe=>{console.log(" MatchingTestStudent: Go Back button clicked in modal"),console.log(" MatchingTestStudent: Button click event:",Oe),Qe()},variant:"primary",children:"Go Back"})]})]})}),l.jsx(Ds,{isOpen:Z,onClose:()=>B(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>B(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:()=>{B(!1),wt()},variant:"primary",className:"",style:ct?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...rt.glow}:{},children:ct?"SUBMIT":"Submit"})]})]})})]})})},Que=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=ws(),{makeAuthenticatedRequest:o}=tc(),{showNotification:c}=Ls(),[u,d]=w.useState([{leftWord:"",rightWord:""},{leftWord:"",rightWord:""},{leftWord:"",rightWord:""}]),[f,h]=w.useState("drag"),[g,p]=w.useState(!1),[x,v]=w.useState(null),C=w.useCallback(()=>{d(F=>[...F,{leftWord:"",rightWord:""}])},[]),b=w.useCallback(F=>{u.length>1&&d(j=>j.filter((P,M)=>M!==F))},[u.length]),_=w.useCallback((F,j)=>{d(P=>P.map((M,I)=>I===F?{...M,leftWord:j}:M))},[]),T=w.useCallback((F,j)=>{d(P=>P.map((M,I)=>I===F?{...M,rightWord:j}:M))},[]),N=w.useCallback(()=>u.every(F=>F.leftWord.trim()&&F.rightWord.trim()),[u]),E=w.useCallback(async()=>{if(!N()){c("Please fill in all word pairs","error");return}p(!0),v(null);try{const F=u.map((P,M)=>({question_id:M+1,left_word:P.leftWord.trim(),right_word:P.rightWord.trim()})),j={test_name:e,num_questions:F.length,interaction_type:f,questions:F};console.log(" Saving word matching test:",j),t({testName:e,numQuestions:F.length,interactionType:f,wordPairs:u,questions:F})}catch(F){console.error("Error saving word matching test:",F),v(F.message),c("Failed to save test: "+F.message,"error")}finally{p(!1)}},[e,u,f,N,o,c,t]);return l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"max-w-6xl mx-auto p-0",children:[l.jsx(Kt,{className:"mb-6",children:l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Choose Interaction Type"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${f==="drag"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h("drag"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:f==="drag",onChange:()=>h("drag"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Drag & Drop"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students drag words from left list to right list"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" Easier for younger students",l.jsx("br",{})," Visual feedback on placement",l.jsx("br",{})," Mobile-friendly"]})]}),l.jsxs("div",{className:` p-4 border-2 rounded-lg cursor-pointer transition-all ${f==="arrow"?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>h("arrow"),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:f==="arrow",onChange:()=>h("arrow"),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Draw Arrows"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Students draw arrows connecting matching words"}),l.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:[" More challenging",l.jsx("br",{})," Better for visual learners",l.jsx("br",{})," Requires precision"]})]})]})]})}),l.jsx(Kt,{className:"mb-6",children:l.jsxs("div",{className:"word-pairs-section",children:[l.jsxs("div",{className:"pairs-header flex justify-between items-center mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Word Pairs"}),l.jsx(at,{onClick:C,size:"sm",children:"+ Add Pair"})]}),l.jsx("div",{className:"pairs-list space-y-3 p-0 md:p-4",children:u.map((F,j)=>l.jsxs("div",{className:"word-pair-row flex items-center space-x-2 md:space-x-4 p-2 md:p-4 bg-gray-50 rounded-lg border",children:[l.jsx("div",{className:"pair-number flex-shrink-0",children:l.jsx("span",{className:"number-badge w-6 h-6 md:w-8 md:h-8 bg-blue-500 text-white rounded-full flex items-center justify-center text-xs md:text-sm font-semibold",children:j+1})}),l.jsx("div",{className:"left-word flex-1",children:l.jsx("input",{type:"text",value:F.leftWord,onChange:P=>_(j,P.target.value),placeholder:"Left word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-arrow flex-shrink-0 text-gray-500 text-lg md:text-xl",children:""}),l.jsx("div",{className:"right-word flex-1",children:l.jsx("input",{type:"text",value:F.rightWord,onChange:P=>T(j,P.target.value),placeholder:"Right word...",className:"word-input w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),l.jsx("div",{className:"pair-actions flex-shrink-0",children:l.jsx(at,{onClick:()=>b(j),variant:"outline",size:"sm",className:"remove-btn w-6 h-6 md:w-8 md:h-8 p-0 text-red-500 hover:bg-red-50",disabled:u.length<=1,children:""})})]},j))})]})}),l.jsx(Kt,{className:"mb-6",children:l.jsxs("div",{className:"preview-section",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Preview"}),l.jsx("div",{className:"preview-pairs space-y-2",children:u.map((F,j)=>l.jsxs("div",{className:"preview-pair flex items-center space-x-2 text-sm",children:[l.jsxs("span",{className:"preview-number font-semibold text-blue-600",children:[j+1,"."]}),l.jsx("span",{className:"preview-left px-2 py-1 bg-white rounded border",children:F.leftWord||"Left word"}),l.jsx("span",{className:"preview-arrow text-gray-500",children:""}),l.jsx("span",{className:"preview-right px-2 py-1 bg-white rounded border",children:F.rightWord||"Right word"})]},j))})]})}),l.jsxs("div",{className:"flex justify-center space-x-4",children:[l.jsx(at,{onClick:E,disabled:!N()||g,className:"px-8",children:g?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test"}),l.jsx(at,{onClick:r,variant:"secondary",children:"Cancel"})]}),x&&l.jsx("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600",children:x})})]})},RH=({answeredCount:e=0,totalQuestions:t=0,timeElapsed:r=0,onSubmitTest:n,isSubmitting:s=!1,canSubmit:a=!1,className:i="",themeClasses:o,isCyberpunk:c})=>{const{theme:u,isKpop:d}=da(),f=ua(u),h=c!==void 0?c:u==="cyberpunk",g=d!==void 0?d:u==="kpop",p=t>0?Math.round(e/t*100):0,x=t-e,v=_=>{const T=Math.floor(_/3600),N=Math.floor(_%3600/60),E=_%60;return T>0?`${T}:${N.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}`:`${N}:${E.toString().padStart(2,"0")}`},C=_=>_>=100?"bg-green-500":_>=80?"bg-blue-500":_>=60?"bg-yellow-500":_>=40?"bg-orange-500":"bg-red-500",b=_=>_>=100?"text-green-600":_>=80?"text-blue-600":_>=60?"text-yellow-600":_>=40?"text-orange-600":"text-red-600";return l.jsxs("div",{className:`rounded-lg shadow-lg p-6 border-2 ${h?Vt(1).className:g?hr(1).className:"bg-white"} ${i}`,style:h?{...Vt(1).style,...f.glow}:g?{...hr(1).style,...f.glow}:{},children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:`text-lg font-semibold ${h||g?"":"text-gray-900"}`,style:h?{...f.textCyan,fontFamily:"monospace"}:g?{...f.headerText}:{},children:h?"TEST PROGRESS":"Test Progress"}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsx("span",{className:`text-sm font-mono ${h||g?"":"text-gray-600"}`,style:h?{...f.textYellow,fontFamily:"monospace"}:g?{...f.textAccent}:{},children:v(r)})]})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:`text-sm font-medium ${h||g?"":"text-gray-700"}`,style:h?{color:fe.yellow,fontFamily:"monospace"}:g?{...f.textAccent}:{},children:"Progress"}),l.jsxs("span",{className:`text-sm font-semibold ${h||g?"":b(p)}`,style:h?{...f.textCyan,fontFamily:"monospace"}:g?{...f.textPink}:{},children:[p,"%"]})]}),l.jsx("div",{className:`w-full rounded-full h-3 overflow-hidden border ${h?"bg-gray-800 border-cyan-400/50":g?"bg-black border-pink-500/50":"bg-gray-200"}`,style:h?f.glow:g?{...f.glow}:{},children:l.jsx(Ze.div,{className:`h-full transition-colors duration-300 ${h?"":C(p)}`,style:h?{background:`linear-gradient(to right, ${fe.yellow}, ${fe.cyan})`,boxShadow:`0 0 10px ${fe.cyan}`}:{},initial:{width:0},animate:{width:`${p}%`},transition:{duration:.5,ease:"easeOut"}})})]}),l.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-4",children:[l.jsxs("div",{className:`text-center p-2 sm:p-3 rounded-lg border ${h?Vt(3).className:g?hr(0).className:"bg-blue-50"}`,style:h?{...Vt(3).style,...f.glow}:g?{...hr(0).style,...f.glow}:{},children:[l.jsx("div",{className:`text-lg sm:text-2xl font-bold ${h||g?"":"text-blue-600"}`,style:h?{...f.textCyan,fontFamily:"monospace"}:g?{...f.textPink}:{},children:e}),l.jsx("div",{className:`text-xs ${h||g?"":"text-blue-600"}`,style:h?{color:fe.yellow,fontFamily:"monospace"}:g?{...f.textAccent}:{},children:"Answered"})]}),l.jsxs("div",{className:`text-center p-2 sm:p-3 rounded-lg border ${h?Vt(1).className:g?hr(1).className:"bg-gray-50"}`,style:h?{...Vt(1).style,...f.glow}:g?{...hr(1).style,...f.glowPurple}:{},children:[l.jsx("div",{className:`text-lg sm:text-2xl font-bold ${h||g?"":"text-gray-600"}`,style:h?{...f.textYellow,fontFamily:"monospace"}:g?{...f.textWhite}:{},children:x}),l.jsx("div",{className:`text-xs ${h||g?"":"text-gray-600"}`,style:h?{color:fe.yellow,fontFamily:"monospace"}:g?{...f.textAccent}:{},children:"Remaining"})]}),l.jsxs("div",{className:`text-center p-2 sm:p-3 rounded-lg border ${h?Vt(2).className:g?hr(2).className:"bg-purple-50"}`,style:h?{...Vt(2).style,...f.glow}:g?{...hr(2).style,...f.glowPurple}:{},children:[l.jsx("div",{className:`text-lg sm:text-2xl font-bold ${h||g?"":"text-purple-600"}`,style:h?{...f.textPurple,fontFamily:"monospace"}:g?{...f.textPurple}:{},children:t}),l.jsx("div",{className:`text-xs ${h||g?"":"text-purple-600"}`,style:h?{color:fe.yellow,fontFamily:"monospace"}:g?{...f.textAccent}:{},children:"Total"})]})]}),l.jsx("div",{className:"mb-4",children:e===t?l.jsx(Ze.div,{className:`flex items-center justify-center p-3 border rounded-lg ${h?"border":"bg-green-50 border-green-200"}`,style:h?{backgroundColor:fe.black,borderColor:fe.green,...f.glow}:{},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:`font-medium ${h||g?"":"text-green-600"}`,style:h?{...f.textGreen,fontFamily:"monospace"}:g?{color:He.success,textShadow:`0 0 10px ${He.success}`}:{},children:" All questions answered! Ready to submit."})}):x===1?l.jsx(Ze.div,{className:`flex items-center justify-center p-3 border rounded-lg ${h?"border":"bg-yellow-50 border-yellow-200"}`,style:h?{backgroundColor:fe.black,borderColor:fe.yellow,...f.glow}:{},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.3},children:l.jsx("span",{className:`font-medium ${h||g?"":"text-yellow-600"}`,style:h?{...f.textYellow,fontFamily:"monospace"}:g?{...f.textPink}:{},children:"Almost there! 1 question remaining."})}):l.jsx("div",{className:`flex items-center justify-center p-3 border rounded-lg ${h?"border":g?"bg-pink-500/10 border-pink-500/50":"bg-gray-50 border-gray-200"}`,style:h?{backgroundColor:fe.black,borderColor:fe.cyan}:g?{backgroundColor:He.backgroundSecondary,borderColor:He.border}:{},children:l.jsxs("span",{className:`font-medium ${h||g?"":"text-gray-600"}`,style:h?{color:fe.cyan,fontFamily:"monospace"}:g?{...f.textAccent}:{},children:[x," questions remaining"]})})}),a&&l.jsx("div",{className:"flex justify-center",children:l.jsx(Ze.button,{onClick:n,disabled:s,className:`px-8 py-3 rounded-lg font-semibold transition-all duration-300 border-2 ${c?"border":s?"bg-gray-400 cursor-not-allowed text-white":"bg-green-600 hover:bg-green-700 shadow-lg hover:shadow-xl text-white"}`,style:c?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...s?{}:f.glow}:{},whileHover:s?{}:{scale:1.05},whileTap:s?{}:{scale:.95},children:s?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:`animate-spin rounded-full h-4 w-4 border-b-2 ${c?"":"border-white"}`,style:c?{borderColor:fe.cyan}:{}}),l.jsx("span",{children:c?"SUBMITTING...":"Submitting..."})]}):l.jsxs("div",{className:"flex items-center space-x-2",children:[!c&&l.jsx("span",{children:""}),l.jsx("span",{children:c?"SUBMIT TEST":"Submit Test"})]})})})]})},Zue=(e,t)=>{const[r,n,s]=vW(`test_progress_${e}_${t}`,{}),[a,i]=w.useState(!1),[o,c]=w.useState(0),[u,d]=w.useState(0),[f,h]=w.useState(!1),[g,p]=w.useState(null),x=w.useRef(null),v=w.useRef(null),C=w.useCallback((z,q)=>{if(!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}n(H=>({...H,[z]:q})),console.log(`Saved progress for question ${z}:`,q)},[n]),b=w.useCallback(z=>!window.tokenManager||!window.tokenManager.isAuthenticated()?(console.warn("[WARN] Cannot get progress: No valid JWT token"),null):r[z]||null,[r]),_=w.useCallback(()=>{if(console.log(`[DEBUG] clearTestProgress called with testType: ${e}, testId: ${t}`),!window.tokenManager||!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const z=`test_progress_${e}_${t}`;console.log(`[DEBUG] Removing localStorage key: ${z}`);const q=Object.keys(r).length>0;s(),console.log(q?`[DEBUG] Progress cleared for test ${e}_${t}`:`[DEBUG] No progress found to clear for test ${e}_${t}`)},[s,e,t,r]),T=w.useCallback(()=>{x.current&&(T(x.current),x.current=null),v.current&&(T(v.current),v.current=null)},[]),N=w.useCallback(()=>{console.log(`[DEBUG] setupProgressTrackingForPage called with testType: ${e}, testId: ${t}`),v.current=setInterval(()=>{console.log("[DEBUG] Auto-saving progress..."),M()},3e4),console.log("[DEBUG] Progress tracking interval set up (30 seconds)")},[e,t]),E=w.useCallback(()=>{console.log(`[DEBUG] updateProgressDisplayForPage called with testType: ${e}, testId: ${t}`);const z=P(),q=u>0?Math.round(z/u*100):0;return console.log(`[DEBUG] Progress: ${z}/${u} questions answered`),console.log(`[DEBUG] Progress bar updated: ${q}%`),{answeredQuestions:z,totalQuestions:u,percentage:q}},[e,t,u]),F=w.useCallback(()=>{console.log("[DEBUG] updateSubmitButtonStateForPage called");const z=P();console.log(`[DEBUG] Submit button state check: ${z}/${u} questions answered`);const q=z===u&&u>0;return console.log(q?"[DEBUG] Submit button enabled - all questions answered":"[DEBUG] Submit button disabled - not all questions answered"),q},[u]),j=w.useCallback(()=>{console.log(`[DEBUG] loadSavedProgressForPage called with testType: ${e}, testId: ${t}`);try{if(console.log("[DEBUG] Loaded progress from localStorage:",r),Object.keys(r).length===0){console.log("[DEBUG] No saved progress found");return}const z=Object.keys(r).length;c(z),console.log(`[DEBUG] Restored ${z} answered questions`)}catch(z){console.error("[ERROR] Failed to load saved progress:",z),p(z.message)}},[e,t,r]),P=w.useCallback(()=>{console.log(`[DEBUG] getAnsweredQuestionsCountForPage called with testType: ${e}`);const z=Object.keys(r).length;return c(z),console.log(`[DEBUG] Found ${z} answered questions`),z},[e,r]),M=w.useCallback(()=>{console.log(`[DEBUG] saveProgressForPage called with testType: ${e}, testId: ${t}`);try{console.log("[DEBUG] Progress saved:",r)}catch(z){console.error("[ERROR] Failed to save progress:",z),p(z.message)}},[e,t,r]),I=w.useCallback(()=>{try{const z=`test_completed_${e}_${t}`,q=localStorage.getItem(z)==="true";return i(q),q}catch(z){return console.error("Error checking test completion:",z),!1}},[e,t]),U=w.useCallback(()=>{try{const z=`test_completed_${e}_${t}`;localStorage.setItem(z,"true"),i(!0),console.log(`Test ${e}_${t} marked as completed`)}catch(z){console.error("Error marking test completed:",z)}},[e,t]),K=w.useCallback(()=>{console.log("Marking test completed in UI:",{testType:e,testId:t}),U()},[e,t,U]),te=w.useCallback(z=>{try{const q=`test_creation_state_${e}_${t}`;localStorage.setItem(q,JSON.stringify(z)),console.log("Test creation state saved:",z)}catch(q){console.error("Error saving test creation state:",q)}},[e,t]),re=w.useCallback(()=>{try{const z=`test_creation_state_${e}_${t}`;localStorage.removeItem(z),console.log("Test creation state cleared")}catch(z){console.error("Error clearing test creation state:",z)}},[e,t]),Z=w.useCallback((z,q)=>{try{const H=`test_step_${e}_${t}_${z}`;localStorage.setItem(H,JSON.stringify(q)),console.log(`Step ${z} data saved:`,q)}catch(H){console.error(`Error saving step ${z} data:`,H)}},[e,t]),B=w.useCallback(z=>{try{const q=`test_step_${e}_${t}_${z}`,H=localStorage.getItem(q);return H?JSON.parse(H):null}catch(q){return console.error(`Error restoring step ${z} data:`,q),null}},[e,t]),J=w.useCallback(()=>{try{const z=`test_creation_state_${e}_${t}`,q=localStorage.getItem(z);return q?JSON.parse(q):null}catch(z){return console.error("Error restoring test creation state:",z),null}},[e,t]);return w.useEffect(()=>()=>{T()},[e,t,N,j,T]),w.useEffect(()=>{P()},[r,P]),{progress:r,isCompleted:a,answeredCount:o,totalQuestions:u,isLoading:f,error:g,saveProgress:C,getProgress:b,clearProgress:_,clearInterval:T,setupProgressTracking:N,updateProgress:E,updateSubmitButton:F,loadProgress:j,getAnsweredCount:P,saveProgressForPage:M,checkCompleted:I,markCompleted:U,markCompletedUI:K,saveState:te,clearState:re,saveStepData:Z,restoreStepData:B,restoreState:J,setTotalQuestions:d,setError:p}},ede=({testData:e,onTestComplete:t,onBackToCabinet:r})=>{const{user:n}=ws(),{makeAuthenticatedRequest:s}=tc(),{showNotification:a}=Ls(),{theme:i,isCyberpunk:o,isLight:c,isKpop:u,themeClasses:d}=da(),f=ua(i),[h,g]=w.useState({width:window.innerWidth,height:window.innerHeight});w.useEffect(()=>{const Pe=()=>{g({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",Pe),()=>window.removeEventListener("resize",Pe)},[]);const{startTracking:p,stopTracking:x,getCheatingData:v,clearData:C}=D1("word_matching",e?.id,n?.student_id||n?.id),[b,_]=w.useState(null),[T,N]=w.useState({}),[E,F]=w.useState(null),[j,P]=w.useState(0),M=w.useRef(null),I=w.useRef(null),U=w.useRef(!1),K=w.useRef(null),[te,re]=w.useState(800),Z={VERY_SMALL:400,MOBILE:600,TABLET:900},B={VERY_SMALL:.6,MOBILE:.8,TABLET:.9,DESKTOP:1},J={CANVAS_HEIGHT:400,BLOCK_WIDTH:140,BLOCK_HEIGHT:50,BLOCK_SPACING:80,MARGIN:50},z=h.width<Z.VERY_SMALL,q=h.width>=Z.VERY_SMALL&&h.width<Z.MOBILE,H=h.width>=Z.MOBILE&&h.width<Z.TABLET;h.width>=Z.TABLET;const R=z?B.VERY_SMALL:q?B.MOBILE:H?B.TABLET:B.DESKTOP;w.useEffect(()=>{const Pe=()=>{if(K.current){const Ct=K.current.clientWidth;console.log(" Container width detected:",Ct),Ct>0&&re(Ct)}};Pe();const lt=[setTimeout(Pe,50),setTimeout(Pe,100),setTimeout(Pe,200),setTimeout(Pe,500)];return window.addEventListener("resize",Pe),()=>{lt.forEach(Ct=>clearTimeout(Ct)),window.removeEventListener("resize",Pe)}},[b]);const L=J.BLOCK_WIDTH*R,G=J.BLOCK_HEIGHT*R,W=J.BLOCK_SPACING*R,Q=J.MARGIN*R,X=Q;console.log(" Mobile Debug:",{screenWidth:h.width,containerWidth:K.current?.clientWidth,canvasWidth:te,scale:R,blockWidth:L,margin:Q,leftBlockX:X,displayDataLoaded:!!b});const se=X+L+20+L+Q,le=se<=te;let he,we=L,ie=G;if(le)he=Math.min(Math.max(X+L+20,te-L-Q),te-L-Q);else{const Pe=te-Q*2,lt=Math.floor((Pe-20)/2);we=Math.max(60,lt),ie=Math.max(30,ie*(we/L)),he=X+we+20,console.log(" Very small screen - adjusted block size:",{availableWidth:Pe,maxBlockWidth:lt,actualBlockWidth:we,actualBlockHeight:ie})}console.log(" Right Block Position:",{rightBlockX:he,rightBlockRightEdge:he+we,canvasWidth:te,fits:he+we<=te,canFitSideBySide:le,minRequiredWidth:se});const Ee=Q,ye={DRAGGED_WORD:Math.max(8,14*R),ORIGINAL_WORD:Math.max(10,16*R),LEFT_WORD:Math.max(10,14*R)},Ie=Math.max(1,3*R),ut=w.useCallback((Pe,lt,Ct)=>{if(!Pe)return ie;const Lt=lt*.55,Ue=Math.floor(Ct/Lt),st=Math.ceil(Pe.length/Ue),dt=lt*1.1,Bt=12*R,Yt=st*dt+Bt,xr=Math.max(ie*.8,30*R);return Math.max(xr,Yt)},[ie,R]),$t=w.useCallback(()=>{if(!b?.leftWords||!b?.rightWords)return J.CANVAS_HEIGHT*R;let Pe=Q*2;for(let Ct=0;Ct<b.leftWords.length;Ct++){const Lt=b.leftWords[Ct],Ue=b.rightWords[Ct],st=ut(Lt,ye.LEFT_WORD,we),dt=ut(Ue,ye.ORIGINAL_WORD,we),Bt=Math.max(st,dt);Pe+=Bt,Ct<b.leftWords.length-1&&(Pe+=20*R)}const lt=J.CANVAS_HEIGHT*R;return Math.max(lt,Pe)},[b,ut,ye,we,Q,R])();w.useCallback((Pe,lt)=>{if(!Pe||!lt)return W;const Ct=Pe.map((st,dt)=>{const Bt=lt[dt],Yt=ut(st,ye.LEFT_WORD,we),xr=ut(Bt,ye.ORIGINAL_WORD,we);return Math.max(Yt,xr)}),Lt=Math.max(...Ct),Ue=20*R;return Lt+Ue},[W,ut,ye,we,R]);const et=w.useCallback(()=>{if(!b?.leftWords||!b?.rightWords)return[];const Pe=[];let lt=Q;for(let Ct=0;Ct<b.leftWords.length;Ct++){const Lt=b.leftWords[Ct],Ue=b.rightWords[Ct],st=ut(Lt,ye.LEFT_WORD,we),dt=ut(Ue,ye.ORIGINAL_WORD,we),Bt=Math.max(st,dt);Pe.push({y:lt,leftHeight:st,rightHeight:dt,rowHeight:Bt}),lt+=Bt+20*R}return Pe},[b,ut,ye,we,Q,R])(),[vt,Te]=w.useState([]),[Ve,pt]=w.useState(!1),[wt,Ut]=w.useState(!1),[ct,yt]=w.useState(null),[rt,Oe]=w.useState(!1),[$e,Mt]=w.useState(!1),[It,At]=w.useState(!0),tr=w.useRef(null);I2(It,w.useCallback(({confirm:Pe,cancel:lt})=>{console.log(" WordMatchingStudent: Browser back button intercepted during test!"),console.log(" WordMatchingStudent: isBackInterceptEnabled:",It),console.log(" WordMatchingStudent: Setting pending navigation and showing modal"),tr.current={confirm:Pe,cancel:lt},Mt(!0)},[It])),w.useEffect(()=>{if(e){if(console.log(" WordMatchingStudent: Initializing test data:",e),console.log(" Interaction type:",e.interaction_type),console.log(" Left words:",e.leftWords),console.log(" Right words:",e.rightWords),console.log(" Correct pairs:",e.correctPairs),!Array.isArray(e.leftWords)||!Array.isArray(e.rightWords)){console.error(" Invalid data structure - leftWords or rightWords not arrays:",{leftWords:e.leftWords,rightWords:e.rightWords});return}if(_(e),n?.student_id){const Ct=`test_progress_${n.student_id}_word_matching_${e.id}`,Lt=Os(Ct);Lt?(N(Lt.answers||{}),Te(Lt.arrows||[]),yt(new Date(Lt.startTime)),console.log(" Test progress restored:",Lt)):yt(new Date)}else yt(new Date);e?.id&&(n?.student_id||n?.id)&&p();const Pe=Number(e?.allowed_time||0),lt=n?.student_id||n?.id||"unknown";if(M.current=`test_timer_${lt}_word_matching_${e.id}`,U.current=!1,Pe>0)try{const Ct=localStorage.getItem(M.current),Lt=Date.now();if(Ct){const Ue=JSON.parse(Ct),st=Math.floor((Lt-new Date(Ue.lastTickAt).getTime())/1e3),dt=Math.max(0,Number(Ue.remainingSeconds||Pe)-Math.max(0,st));P(dt),I.current=Lt,console.log(" Timer initialized from cache:",{remaining:dt,allowedSeconds:Pe})}else P(Pe),I.current=Lt,localStorage.setItem(M.current,JSON.stringify({remainingSeconds:Pe,lastTickAt:new Date(Lt).toISOString(),startedAt:new Date(Lt).toISOString()})),console.log(" Timer initialized fresh:",{allowedSeconds:Pe});U.current=!0}catch(Ct){console.error("Timer cache init error:",Ct),P(Pe),U.current=!0}else P(0),U.current=!0}},[e,n?.student_id,n?.id,p]),w.useEffect(()=>{if(b&&ct&&n?.student_id){const Pe=setInterval(()=>{const lt={answers:T,arrows:vt,startTime:ct.toISOString()},Ct=`test_progress_${n.student_id}_word_matching_${e.id}`;vs(Ct,lt,hs.test_progress),console.log(" Progress auto-saved")},3e4);return()=>clearInterval(Pe)}},[b,T,vt,ct,n?.student_id,e?.id]);const ar=w.useCallback((Pe,lt)=>{if(console.log(" handleWordClick called:",{side:Pe,index:lt,interactionType:e?.interaction_type,selectedWord:E}),Pe==="right")if(e?.interaction_type==="arrow"){const Ct=vt.findIndex(Lt=>Lt.endWord.side==="right"&&Lt.endWord.index===lt);if(Ct!==-1){const Lt=vt[Ct].startWord.index;Te(Ue=>Ue.filter((st,dt)=>dt!==Ct)),N(Ue=>{const st={...Ue};return delete st[Lt],st}),E?.side==="right"&&E?.index===lt&&F(null);return}}else{const Ct=Object.keys(T).find(Lt=>T[Lt]===lt);if(Ct!==void 0){N(Lt=>{const Ue={...Lt};return delete Ue[Ct],Ue});return}}if(e?.interaction_type!=="arrow"){console.log(" Not arrow mode, ignoring click");return}if(E){if(E.side===Pe&&E.index===lt)console.log(" Deselecting word"),F(null);else if(E.side!==Pe){console.log(" Creating arrow connection:",{startWord:E,endWord:{side:Pe,index:lt}});const Ct={id:Date.now().toString(),startWord:E,endWord:{side:Pe,index:lt},color:"#3B82F6"};Te(Lt=>{const Ue=[...Lt,Ct];return console.log(" Updated arrows:",Ue),Ue}),N(Lt=>{const Ue={...Lt,[E.index]:lt};return console.log(" Updated answers:",Ue),Ue}),F(null)}}else console.log(" Selecting word:",{side:Pe,index:lt}),F({side:Pe,index:lt})},[E,e?.interaction_type,vt,T]);w.useCallback((Pe,lt)=>{e.interaction_type==="drag"&&N(Ct=>({...Ct,[Pe]:lt}))},[e?.interaction_type]);const dr=w.useCallback(()=>{Oe(!0)},[]),or=w.useCallback(()=>{N({}),Te([]),F(null),Oe(!1)},[]),mr=w.useCallback(()=>{tr.current=null,Mt(!0)},[]),ve=w.useCallback(()=>{console.log(" WordMatchingStudent: confirmBackToCabinet called"),console.log(" WordMatchingStudent: Current location:",window.location.href),console.log(" WordMatchingStudent: Current history state:",window.history.state),Mt(!1);const Pe=tr.current;if(console.log(" WordMatchingStudent: Pending navigation:",Pe),tr.current=null,e?.id&&n?.student_id){const Ct=`anti_cheating_${n?.student_id||n?.id||"unknown"}_word_matching_${e.id}`,Ue=(Os(Ct)||{tabSwitches:0}).tabSwitches||0,st=Ue+1,dt=st>=2;console.log(" WordMatchingStudent: Tab switch count:",Ue,"->",st),vs(Ct,{tabSwitches:st,isCheating:dt},hs.anti_cheating)}if(console.log(" WordMatchingStudent: Disabling intercept"),At(!1),Pe){console.log(" WordMatchingStudent: Cleaning up intercept history state");try{const lt=window.history.state;if(console.log(" WordMatchingStudent: Current history state before cleanup:",lt),lt&&lt.__intercept){const Ct=lt.prevState??null;console.log(" WordMatchingStudent: Restoring previous state:",Ct),window.history.replaceState(Ct,document.title,window.location.href),console.log(" WordMatchingStudent: History state after cleanup:",window.history.state)}}catch(lt){console.warn(" WordMatchingStudent: Failed to restore history state:",lt)}}console.log(" WordMatchingStudent: Scheduling navigation in 100ms"),setTimeout(()=>{console.log(" WordMatchingStudent: Executing navigation to /student"),console.log(" WordMatchingStudent: Current location before navigation:",window.location.href),window.location.href="/student",console.log(" WordMatchingStudent: window.location.href set to /student")},100)},[r,e,n?.student_id,n?.id]),Fe=w.useCallback(()=>{const Pe=tr.current;tr.current=null,Pe?.cancel&&Pe.cancel(),Mt(!1)},[]),Be=w.useCallback(async()=>{if(b){pt(!0);try{const Pe=b?.leftWords?.length||0;let lt=0,Ct={};e.interaction_type==="drag"?Object.entries(T).forEach(([ge,Me])=>{const ot=b?.correctPairs?.[ge];Me===ot&&lt++,Ct[ge]=Me}):vt.forEach(ge=>{const Me=ge.startWord.side==="left"?ge.startWord.index:ge.endWord.index,ot=ge.startWord.side==="right"?ge.startWord.index:ge.endWord.index;b?.correctPairs?.[Me]===ot&&lt++,Ct[Me]=ot});const Lt=lt,Ue=Pe;console.log(` Final Score: ${Lt}/${Ue} (${Math.round(Lt/Ue*100)}%)`);const st=new Date,dt=ct?Math.round((st-ct)/1e3):0,Bt=ct?ct.toISOString():st.toISOString(),Yt=v(),xr=n.student_id,Rr=`retest_assignment_id_${xr}_word_matching_${e.id}`,yr=localStorage.getItem(Rr),{academicCalendarService:Br}=await ui(async()=>{const{academicCalendarService:ge}=await Promise.resolve().then(()=>JS);return{academicCalendarService:ge}},void 0);await Br.loadAcademicCalendar();const Ne=Br.getCurrentTerm()?.id;if(!Ne)throw new Error("No current academic period found");const be={test_id:e.id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:xr,academic_period_id:Ne,parent_test_id:e.id,retest_assignment_id:yr?Number(yr):null,interaction_type:e.interaction_type,answers:Ct,score:Lt,maxScore:Ue,time_taken:dt,started_at:Bt,submitted_at:st.toISOString(),caught_cheating:Yt.caught_cheating,visibility_change_times:Yt.visibility_change_times};console.log(" Submission data being sent:",be),console.log(" TestData structure:",e),console.log(" Submitting test results...");const Ae=await s("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(be)});console.log(" Submission response received:",Ae.status);const ue=await Ae.json();if(ue.success){if(a("Test submitted successfully!","success"),x(),C(),n?.student_id&&j1(n.student_id,"word_matching",e.id),!!yr&&n?.student_id){let Me=3;try{const nt=localStorage.getItem(`student_active_tests_${n.student_id}`);if(nt){const de=JSON.parse(nt)?.tests?.find(Se=>Se.test_id===e.id&&Se.test_type==="word_matching");de&&(Me=de.retest_attempts_left||de.max_attempts||3)}}catch(nt){console.error("Error checking active tests cache:",nt)}const Je=(Lt>0&&Ue>0?Lt/Ue*100:0)>=50;if(Je){const nt=`retest_attempt${Me}_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(nt,"true"),console.log(" Passed retest, marking last-slot key:",nt);let mt=0;for(let De=1;De<=10;De++){const Le=`retest_attempt${De}_${n.student_id}_word_matching_${e.id}`;localStorage.getItem(Le)==="true"&&mt++}const de=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(de,"true"),console.log(" Marked retest as completed (student passed):",de);const Se=`retest_attempts_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Se,JSON.stringify({used:mt,max:Me})),console.log(" Set retest attempts metadata (student passed):",Se,{used:mt,max:Me})}else{let nt=1;for(let Le=1;Le<=10;Le++){const tt=`retest_attempt${Le}_${n.student_id}_word_matching_${e.id}`;if(localStorage.getItem(tt)!=="true"){nt=Le;break}}const mt=`retest_attempt${nt}_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(mt,"true"),console.log(" Marked retest attempt as completed:",mt);let de=0;for(let Le=1;Le<=10;Le++){const tt=`retest_attempt${Le}_${n.student_id}_word_matching_${e.id}`;localStorage.getItem(tt)==="true"&&de++}const Se=Me-de,De=Se<=0||Je;if(console.log(" Retest completion check:",{usedAttempts:de,maxAttempts:Me,attemptsLeft:Se,passed:Je,shouldComplete:De}),De){const Le=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Le,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",Le);const tt=`retest_attempts_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(tt,JSON.stringify({used:de,max:Me})),console.log(" Set retest attempts metadata (attempts exhausted):",tt,{used:de,max:Me})}}}else if(n?.student_id){const Me=`test_completed_${n.student_id}_word_matching_${e.id}`;localStorage.setItem(Me,"true"),console.log(" Test marked as completed in localStorage:",Me)}if(n?.student_id){const Me=`student_results_table_${n.student_id}`;vs(Me,ue,hs.student_results_table),console.log(" Test results cached with key:",Me)}if(n?.student_id){const Me=`retest1_${xr}_word_matching_${e.id}`;localStorage.removeItem(Me),localStorage.removeItem(Rr)}M.current&&localStorage.removeItem(M.current),t&&(At(!1),t({score:Lt,caught_cheating:Yt.caught_cheating,visibility_change_times:Yt.visibility_change_times})),pt(!1)}else throw new Error(ue.message||"Failed to submit test")}catch(Pe){console.error("Error submitting test:",Pe),pt(!1)}}},[b,T,vt,e,n,ct,v,x,C,s,t]);return w.useEffect(()=>{if(!b||!e||!ct)return;const Pe=Number(e?.allowed_time||0);if(!Pe)return;console.log(" Timer effect triggered:",{allowedSeconds:Pe,timeRemaining:j,initialized:U.current,testData:e?.id});const lt=setInterval(()=>{P(Ct=>{const Lt=Ct>0?Ct:Pe;if(Lt<=0)return 0;const Ue=Math.max(0,Lt-1);try{const st=Date.now();I.current||(I.current=st),M.current&&localStorage.setItem(M.current,JSON.stringify({remainingSeconds:Ue,lastTickAt:new Date(st).toISOString(),startedAt:ct?ct.toISOString():new Date(st-(Pe-Ue)*1e3).toISOString()}))}catch{}return Ue===0&&Be(),Ue})},1e3);return()=>clearInterval(lt)},[b,e?.allowed_time,ct,Be]),b?l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`max-w-4xl mx-auto p-6 ${o||u?"bg-black":"bg-white"}`,style:o?{backgroundColor:fe.black}:u?{...f.background}:{},children:[l.jsx(Ds,{isOpen:Ve,onClose:()=>{},title:"Submitting",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(Xr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Submitting test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your results"})]})}),l.jsx("div",{className:"flex justify-end mb-2",children:l.jsx(at,{onClick:mr,variant:"outline",size:"sm",disabled:Ve,children:"Back to Cabinet"})}),l.jsxs("div",{className:`rounded-lg border-2 p-6 mb-6 ${o?Vt(1).className:u?hr(1).className:`${d.cardBg} ${d.cardBorder}`}`,style:o?{...Vt(1).style,...f.glow,boxShadow:`${f.glow.boxShadow}, inset 0 0 20px ${bW(fe.cyan,.1)}`}:u?{...hr(1).style,borderColor:He.primary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:[l.jsxs("div",{className:"text-left mb-4",children:[l.jsx("h2",{className:`text-2xl font-bold ${o?"tracking-wider":d.text} mb-2`,style:o?{...f.textCyan,fontFamily:"monospace"}:u?{...f.headerText}:{},children:o?e.test_name.toUpperCase():e.test_name}),l.jsx("p",{className:`${o?"text-yellow-400 tracking-wider":d.textSecondary}`,style:o?{fontFamily:"monospace",textShadow:"0 0 5px rgba(255, 215, 0, 0.5)"}:{},children:o?e.interaction_type==="drag"?"DRAG WORDS FROM LEFT TO RIGHT TO MATCH THEM":"CLICK ON THE WORD OR PHRASE ON THE LEFT, THEN CLICK ON THE MATCHING WORD OR PHRASE ON THE RIGHT TO CONNECT THEM":e.interaction_type==="drag"?"Drag words from left to right to match them":"Click on the word or phrase on the left, then click on the matching word or phrase on the right to connect them"})]}),e&&l.jsx("div",{className:"mb-4",children:l.jsx(RH,{answeredCount:Object.keys(T).length+(e.interaction_type==="arrow"?vt.length:0),totalQuestions:b?.leftWords?.length||0,timeElapsed:(()=>{const Pe=Number(e?.allowed_time||0);return Pe<=0?0:j>0?j:Pe})(),themeClasses:d,isCyberpunk:o})})]}),e.interaction_type==="drag"?l.jsx(Kt,{className:`mb-6 ${o?Vt(0).className:u?hr(0).className:""}`,style:o?{...Vt(0).style,...f.glow}:u?{...hr(0).style,...f.glow}:{},children:l.jsx("div",{ref:K,className:"relative w-full",children:l.jsx(oh,{width:te,height:$t,className:`border-2 rounded-lg ${Ve?"pointer-events-none opacity-50":""} ${o?"border-cyan-400":"border-gray-200"}`,style:o?{borderColor:fe.cyan,backgroundColor:fe.black}:{},children:l.jsxs(ih,{children:[b.leftWords.map((Pe,lt)=>{const Ct=T[lt]!==void 0,Lt=ut(Pe,ye.LEFT_WORD,we),Ue=et[lt],st=Ue?Ue.y:Ee+lt*W;return l.jsxs(vl,{x:X,y:st,draggable:!Ct,onDragStart:dt=>{dt.target.moveToTop()},onDragEnd:dt=>{dt.target.getStage();const Bt=b.rightWords,Yt=we+60,xr=he-30;console.log(" Drop detection - Word dropped at:",dt.target.x(),dt.target.y());for(let Rr=0;Rr<Bt.length;Rr++){const yr=Bt[Rr],Br=et[Rr],me=Br?Br.y:Ee+Rr*W,Ne=ut(yr,ye.ORIGINAL_WORD,we),be=xr,Ae=xr+Yt,ue=me,ge=me+Ne;if(console.log(` Checking drop zone ${Rr}:`,{left:be,right:Ae,top:ue,bottom:ge,word:Bt[Rr]}),dt.target.x()>=be&&dt.target.x()<=Ae&&dt.target.y()>=ue&&dt.target.y()<=ge){if(Object.entries(T).some(([ot,Je])=>Je===Rr&&parseInt(ot)!==lt)){console.log(` Dropzone ${Rr} is already occupied, resetting position`),dt.target.position({x:X,y:st});return}console.log(` Match found! Word "${b.leftWords[lt]}" matched with "${Bt[Rr]}"`),N(ot=>({...ot,[lt]:Rr}));break}}console.log(" No match found, resetting position"),dt.target.position({x:X,y:st})},children:[l.jsx(Ja,{width:we,height:Lt,fill:Ct?u?"#1a0014":"#e5e7eb":u?He.primary:"#3b82f6",stroke:Ct?u?He.border:"#9ca3af":u?He.primary:"#1d4ed8",shadowBlur:u&&!Ct?15:0,shadowColor:u&&!Ct?He.primary:void 0,shadowOpacity:u&&!Ct?.6:void 0,strokeWidth:2,cornerRadius:8,opacity:Ct?.5:1}),l.jsx(Nc,{text:Pe,x:we/2,y:Lt/2,fontSize:ye.LEFT_WORD,fontFamily:"Arial",fill:Ct?"#dc2626":"white",align:"center",verticalAlign:"middle",width:we,offsetX:we/2,offsetY:Lt/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${lt}`)}),b.rightWords.map((Pe,lt)=>{const Ct=ut(Pe,ye.ORIGINAL_WORD,we),Lt=et[lt],Ue=Lt?Lt.y:Ee+lt*W,st=Object.keys(T).find(dt=>T[dt]===lt);return l.jsxs(vl,{x:he,y:Ue,onClick:()=>ar("right",lt),onTap:()=>ar("right",lt),children:[l.jsx(Ja,{width:we,height:Ct,fill:st?"#10b981":"#f3f4f6",stroke:st?"#059669":"#d1d5db",strokeWidth:2,cornerRadius:8,listening:!0}),l.jsx(Nc,{text:Pe,x:we/2,y:Ct/2,fontSize:ye.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:we,offsetX:we/2,offsetY:Ct/2,wrap:"word",ellipsis:!0,listening:!1}),st&&l.jsx(Nc,{text:b.leftWords[st],x:we/2,y:Ct-5,fontSize:ye.DRAGGED_WORD,fontFamily:"Arial",fill:"#dc2626",align:"center",verticalAlign:"middle",width:we,offsetX:we/2,offsetY:ye.DRAGGED_WORD/2,wrap:"word",ellipsis:!0})]},`right-${lt}`)})]})})})}):l.jsx(Kt,{className:`mb-6 ${o?Vt(0).className:u?hr(0).className:""}`,style:o?{...Vt(0).style,...f.glow}:u?{...hr(0).style,...f.glow}:{},children:l.jsx("div",{ref:K,className:"relative w-full",children:l.jsx(oh,{width:te,height:$t,className:`border-2 rounded-lg ${Ve?"pointer-events-none opacity-50":""} ${o?"border-cyan-400":"border-gray-200"}`,style:o?{borderColor:fe.cyan,backgroundColor:fe.black}:{},children:l.jsxs(ih,{children:[b?.leftWords?.map((Pe,lt)=>{const Ct=ut(Pe,ye.LEFT_WORD,we),Lt=et[lt],Ue=Lt?Lt.y:Ee+lt*W,st=E?.side==="left"&&E?.index===lt;return l.jsxs(vl,{x:X,y:Ue,onClick:()=>ar("left",lt),onTap:()=>ar("left",lt),children:[l.jsx(Ja,{width:we,height:Ct,fill:st?u?He.primary:"#3b82f6":u?He.backgroundSecondary:"#f3f4f6",stroke:st?u?He.primary:"#1d4ed8":u?He.border:"#d1d5db",shadowBlur:u&&st?20:0,shadowColor:u&&st?He.primary:void 0,shadowOpacity:u&&st?.8:void 0,strokeWidth:st?3:2,cornerRadius:8}),l.jsx(Nc,{text:Pe,x:we/2,y:Ct/2,fontSize:ye.LEFT_WORD,fontFamily:"Arial",fill:st?"white":"#374151",align:"center",verticalAlign:"middle",width:we,offsetX:we/2,offsetY:Ct/2,wrap:"word",ellipsis:!0,listening:!1})]},`left-${lt}`)}),b?.rightWords?.map((Pe,lt)=>{const Ct=ut(Pe,ye.ORIGINAL_WORD,we),Lt=et[lt],Ue=Lt?Lt.y:Ee+lt*W,st=E?.side==="right"&&E?.index===lt,Bt=vt.some(Yt=>Yt.endWord.side==="right"&&Yt.endWord.index===lt);return l.jsxs(vl,{x:he,y:Ue,onClick:()=>ar("right",lt),onTap:()=>ar("right",lt),onKeyDown:Yt=>{(Yt.key==="Tab"||Yt.key==="Enter")&&(Yt.preventDefault(),ar("right",lt))},tabIndex:0,children:[l.jsx(Ja,{width:we,height:Ct,fill:st?u?He.primary:"#3b82f6":Bt?u?He.success:"#10b981":u?He.backgroundSecondary:"#f3f4f6",stroke:st?u?He.primary:"#1d4ed8":Bt?u?He.success:"#059669":u?He.border:"#d1d5db",shadowBlur:u&&(st||Bt)?20:0,shadowColor:u&&st?He.primary:u&&Bt?He.success:void 0,shadowOpacity:u&&(st||Bt)?.8:void 0,strokeWidth:st?3:2,cornerRadius:8,listening:!0}),l.jsx(Nc,{text:Pe,x:we/2,y:Ct/2,fontSize:ye.ORIGINAL_WORD,fontFamily:"Arial",fill:"#000000",align:"center",verticalAlign:"middle",width:we,offsetX:we/2,offsetY:Ct/2,wrap:"word",ellipsis:!0,listening:!1})]},`right-${lt}`)}),vt.map((Pe,lt)=>{const Ct=b?.leftWords?.[Pe.startWord.index],Lt=b?.rightWords?.[Pe.endWord.index],Ue=ut(Ct,ye.LEFT_WORD,we),st=ut(Lt,ye.ORIGINAL_WORD,we),dt=et[Pe.startWord.index],Bt=et[Pe.endWord.index],Yt=dt?dt.y+Ue/2:Ee+Pe.startWord.index*W+Ue/2,xr=Bt?Bt.y+st/2:Ee+Pe.endWord.index*W+st/2;return l.jsx(Qi,{points:[X+we+20,Yt,he-20,xr],stroke:u?Pe.color||He.primary:Pe.color||"#3b82f6",shadowBlur:u?10:0,shadowColor:u?He.primary:void 0,shadowOpacity:u?.6:void 0,strokeWidth:u?Math.max(Ie,3):Ie,lineCap:"round",lineJoin:"round"},lt)})]})})})}),l.jsx(Kt,{className:o?Vt(1).className:u?hr(1).className:"",style:o?{...Vt(1).style,...f.glow}:u?{...hr(1).style,...f.glowPurple}:{},children:l.jsxs("div",{className:`submit-section flex justify-center space-x-4 ${Ve?"pointer-events-none opacity-50":""}`,children:[l.jsx(at,{onClick:dr,variant:"outline",disabled:Ve,children:"Reset"}),l.jsx(at,{onClick:()=>Ut(!0),disabled:Ve,className:`px-8 ${o?"":u?"bg-pink-500 text-white hover:bg-pink-600":""}`,style:o?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...f.glow}:{},children:Ve?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:o?fe.cyan:"white",className:"mr-2"}),o?"SUBMITTING...":"Submitting..."]}):o?"SUBMIT TEST":"Submit Test"})]})}),l.jsx(Ds,{isOpen:rt&&!Ve,onClose:()=>Oe(!1),title:"Reset Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to reset? This will clear all your progress and answers."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>Oe(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:or,variant:"primary",children:"Reset"})]})]})}),l.jsx(Ds,{isOpen:$e,onClose:Fe,title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to leave the test? Your progress will be saved."}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:Fe,variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:Pe=>{console.log(" WordMatchingStudent: Leave button clicked in modal"),console.log(" WordMatchingStudent: Button click event:",Pe),ve()},variant:"primary",children:"Leave"})]})]})}),l.jsx(Ds,{isOpen:wt,onClose:()=>Ut(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>Ut(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:()=>{Ut(!1),Be()},variant:"primary",className:"",style:o?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...f.glow}:{},children:o?"SUBMIT":"Submit"})]})]})})]}):l.jsx("div",{className:"flex justify-center items-center min-h-screen",children:l.jsx(Xr,{size:"lg"})})},I1=w.createContext(null);function tde(e,t){return{getTheme:function(){return t??null}}}function bd(){const e=w.useContext(I1);return e==null&&(function(t,...r){const n=new URL("https://lexical.dev/docs/error"),s=new URLSearchParams;s.append("code",t);for(const a of r)s.append("v",a);throw n.search=s.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(8),e}function rr(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const Cu=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,rde=Cu&&"documentMode"in document?document.documentMode:null,rd=Cu&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),Um=Cu&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),r_=!(!Cu||!("InputEvent"in window)||rde)&&"getTargetRanges"in new window.InputEvent("input"),Kv=Cu&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),d1=Cu&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,nde=Cu&&/Android/.test(navigator.userAgent),OH=Cu&&/^(?=.*Chrome).*/i.test(navigator.userAgent),zM=Cu&&nde&&OH,n_=Cu&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!OH;function DH(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}const sde=1,ade=3,ide=9,ode=11,zm=0,IH=1,f1=2,lde=0,cde=1,ude=2,s_=4,a_=8,AN=128,dde=1792|(112|(3|s_|a_)|AN),jN=1,PN=2,FN=3,MN=4,RN=5,ON=6,OS=Kv||d1||n_?"":"",T0=`

`,fde=Um?"":OS,Wm={bold:1,capitalize:1024,code:16,highlight:AN,italic:2,lowercase:256,strikethrough:s_,subscript:32,superscript:64,underline:a_,uppercase:512},hde={directionless:1,unmergeable:2},WM={center:PN,end:ON,justify:MN,left:jN,right:FN,start:RN},mde={[PN]:"center",[ON]:"end",[MN]:"justify",[jN]:"left",[FN]:"right",[RN]:"start"},gde={normal:0,segmented:2,token:1},pde={[lde]:"normal",[ude]:"segmented",[cde]:"token"},HM="$config";function LH(e,t,r,n,s,a){let i=e.getFirstChild();for(;i!==null;){const o=i.__key;i.__parent===t&&(Wt(i)&&LH(i,o,r,n,s,a),r.has(o)||a.delete(o),s.push(o)),i=i.getNextSibling()}}const xde=100;let PT=!1,DN=0;function yde(e){DN=e.timeStamp}function m6(e,t,r){const n=e.nodeName==="BR",s=t.__lexicalLineBreak;return s&&(e===s||n&&e.previousSibling===s)||n&&GS(e,r)!==void 0}function vde(e,t,r){const n=wu(Ic(r));let s=null,a=null;n!==null&&n.anchorNode===e&&(s=n.anchorOffset,a=n.focusOffset);const i=e.nodeValue;i!==null&&rE(t,i,s,a,!1)}function bde(e,t,r){if(Jt(e)){const n=e.anchor.getNode();if(n.is(r)&&e.format!==n.getFormat())return!1}return O0(t)&&r.isAttached()}function wde(e,t,r,n){for(let s=e;s&&!w0e(s);s=H2(s)){const a=GS(s,t);if(a!==void 0){const i=Xa(a,r);if(i)return Jn(i)||!Ws(s)?void 0:[s,i]}else if(s===n)return[n,RG(r)]}}function BH(e,t,r){PT=!0;const n=performance.now()-DN>xde;try{Ul(e,(()=>{const s=wr()||(function(h){return h.getEditorState().read((()=>{const g=wr();return g!==null?g.clone():null}))})(e),a=new Map,i=e.getRootElement(),o=e._editorState,c=e._blockCursorElement;let u=!1,d="";for(let h=0;h<t.length;h++){const g=t[h],p=g.type,x=g.target,v=wde(x,e,o,i);if(!v)continue;const[C,b]=v;if(p==="characterData")n&&_r(b)&&O0(x)&&bde(s,x,b)&&vde(x,b,e);else if(p==="childList"){u=!0;const _=g.addedNodes;for(let E=0;E<_.length;E++){const F=_[E],j=FG(F),P=F.parentNode;if(P!=null&&F!==c&&j===null&&!m6(F,P,e)){if(Um){const M=(Ws(F)?F.innerText:null)||F.nodeValue;M&&(d+=M)}P.removeChild(F)}}const T=g.removedNodes,N=T.length;if(N>0){let E=0;for(let F=0;F<N;F++){const j=T[F];(m6(j,x,e)||c===j)&&(x.appendChild(j),E++)}N!==E&&a.set(C,b)}}}if(a.size>0)for(const[h,g]of a)g.reconcileObservedMutation(h,e);const f=r.takeRecords();if(f.length>0){for(let h=0;h<f.length;h++){const g=f[h],p=g.addedNodes,x=g.target;for(let v=0;v<p.length;v++){const C=p[v],b=C.parentNode;b==null||C.nodeName!=="BR"||m6(C,x,e)||b.removeChild(C)}}r.takeRecords()}s!==null&&(u&&io(s),Um&&LG(e)&&s.insertRawText(d))}))}finally{PT=!1}}function $H(e){const t=e._observer;t!==null&&BH(e,t.takeRecords(),t)}function UH(e){(function(t){DN===0&&Ic(t).addEventListener("textInput",yde,!0)})(e),e._observer=new MutationObserver(((t,r)=>{BH(e,t,r)}))}function _de(e){const t=new Map,r=new Set;for(let n=typeof e=="function"?e:e.replace;n.prototype&&n.prototype.getType!==void 0;n=Object.getPrototypeOf(n)){const{ownNodeConfig:s}=oE(n);if(s&&s.stateConfigs)for(const a of s.stateConfigs){let i;"stateConfig"in a?(i=a.stateConfig,a.flat&&r.add(i.key)):i=a,t.set(i.key,i)}}return{flatKeys:r,sharedConfigMap:t}}let Sde=class zH{constructor(t,r,n=void 0,s=new Map,a=void 0){this.node=t,this.sharedNodeState=r,this.unknownState=n,this.knownState=s;const{sharedConfigMap:i}=this.sharedNodeState,o=a!==void 0?a:(function(c,u,d){let f=d.size;if(u)for(const h in u){const g=c.get(h);g&&d.has(g)||f++}return f})(i,n,s);this.size=o}getValue(t){const r=this.knownState.get(t);if(r!==void 0)return r;this.sharedNodeState.sharedConfigMap.set(t.key,t);let n=t.defaultValue;if(this.unknownState&&t.key in this.unknownState){const s=this.unknownState[t.key];s!==void 0&&(n=t.parse(s)),this.updateFromKnown(t,n)}return n}getInternalState(){return[this.unknownState,this.knownState]}toJSON(){const t={...this.unknownState},r={};for(const[n,s]of this.knownState)n.isEqual(s,n.defaultValue)?delete t[n.key]:t[n.key]=n.unparse(s);for(const n of this.sharedNodeState.flatKeys)n in t&&(r[n]=t[n],delete t[n]);return GM(t)&&(r.$=t),r}getWritable(t){if(this.node===t)return this;const{sharedNodeState:r,unknownState:n}=this,s=new Map(this.knownState);return new zH(t,r,(function(a,i,o){let c;if(o)for(const[u,d]of Object.entries(o)){const f=a.get(u);f?i.has(f)||i.set(f,f.parse(d)):(c=c||{},c[u]=d)}return c})(r.sharedConfigMap,s,n),s,this.size)}updateFromKnown(t,r){const n=t.key;this.sharedNodeState.sharedConfigMap.set(n,t);const{knownState:s,unknownState:a}=this;s.has(t)||a&&n in a||(a&&(delete a[n],this.unknownState=GM(a)),this.size++),s.set(t,r)}updateFromUnknown(t,r){const n=this.sharedNodeState.sharedConfigMap.get(t);n?this.updateFromKnown(n,n.parse(r)):(this.unknownState=this.unknownState||{},t in this.unknownState||this.size++,this.unknownState[t]=r)}updateFromJSON(t){const{knownState:r}=this;for(const n of r.keys())r.set(n,n.defaultValue);if(this.size=r.size,this.unknownState=void 0,t)for(const[n,s]of Object.entries(t))this.updateFromUnknown(n,s)}};function kde(e){const t=e.getWritable(),r=t.__state?t.__state.getWritable(t):new Sde(t,WH(t));return t.__state=r,r}function WH(e){return e.__state?e.__state.sharedNodeState:AG(G2(),e.getType()).sharedNodeState}function GM(e){if(e)for(const t in e)return e}function VM(e,t,r){for(const[n,s]of t.knownState){if(e.has(n.key))continue;e.add(n.key);const a=r?r.getValue(n):n.defaultValue;if(a!==s&&!n.isEqual(a,s))return!0}return!1}function qM(e,t,r){const{unknownState:n}=t,s=r?r.unknownState:void 0;if(n){for(const[a,i]of Object.entries(n))if(!e.has(a)&&(e.add(a),i!==(s?s[a]:void 0)))return!0}return!1}function KM(e,t){const r=e.__state;return r&&r.node===e?r.getWritable(t):r}function YM(e,t){const r=e.__mode,n=e.__format,s=e.__style,a=t.__mode,i=t.__format,o=t.__style,c=e.__state,u=t.__state;return(r===null||r===a)&&(n===null||n===i)&&(s===null||s===o)&&(e.__state===null||c===u||(function(d,f){if(d===f)return!0;if(d&&f&&d.size!==f.size)return!1;const h=new Set;return!(d&&VM(h,d,f)||f&&VM(h,f,d)||d&&qM(h,d,f)||f&&qM(h,f,d))})(c,u))}function XM(e,t){const r=e.mergeWithSibling(t),n=ca()._normalizedNodes;return n.add(e.__key),n.add(t.__key),r}function JM(e){let t,r,n=e;if(n.__text!==""||!n.isSimpleText()||n.isUnmergeable()){for(;(t=n.getPreviousSibling())!==null&&_r(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(t.__text!==""){if(YM(t,n)){n=XM(t,n);break}break}t.remove()}for(;(r=n.getNextSibling())!==null&&_r(r)&&r.isSimpleText()&&!r.isUnmergeable();){if(r.__text!==""){if(YM(n,r)){n=XM(n,r);break}break}r.remove()}}else n.remove()}function i_(e){return QM(e.anchor),QM(e.focus),e}function QM(e){for(;e.type==="element";){const t=e.getNode(),r=e.offset;let n,s;if(r===t.getChildrenSize()?(n=t.getChildAtIndex(r-1),s=!0):(n=t.getChildAtIndex(r),s=!1),_r(n)){e.set(n.__key,s?n.getTextContentSize():0,"text",!0);break}if(!Wt(n))break;e.set(n.__key,s?n.getChildrenSize():0,"element",!0)}}let Hm,No,Yv,DS,FT,MT,Gm,xu,RT,Xv,ci="",Zu=null,ed="",n0="",Pp=!1,o_=!1;function l_(e,t){const r=Gm.get(e);if(t!==null){const n=LT(e);n.parentNode===t&&t.removeChild(n)}if(xu.has(e)||No._keyToDOMMap.delete(e),Wt(r)){const n=u_(r,Gm);OT(n,0,n.length-1,null)}r!==void 0&&nE(Xv,Yv,DS,r,"destroyed")}function OT(e,t,r,n){let s=t;for(;s<=r;++s){const a=e[s];a!==void 0&&l_(a,n)}}function cm(e,t){e.setProperty("text-align",t)}const Cde="40px";function HH(e,t){const r=Hm.theme.indent;if(typeof r=="string"){const s=e.classList.contains(r);t>0&&!s?e.classList.add(r):t<1&&s&&e.classList.remove(r)}const n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||Cde;e.style.setProperty("padding-inline-start",t===0?"":`calc(${t} * ${n})`)}function GH(e,t){const r=e.style;t===0?cm(r,""):t===jN?cm(r,"left"):t===PN?cm(r,"center"):t===FN?cm(r,"right"):t===MN?cm(r,"justify"):t===RN?cm(r,"start"):t===ON&&cm(r,"end")}function DT(e,t){const r=(function(n){const s=n.__dir;if(s!==null)return s;if(hi(n))return null;const a=n.getParentOrThrow();return hi(a)&&a.__dir===null?"auto":null})(t);r!==null?e.dir=r:e.removeAttribute("dir")}function c_(e,t){const r=xu.get(e);r===void 0&&rr(60);const n=r.createDOM(Hm,No);if((function(s,a,i){const o=i._keyToDOMMap;(function(c,u,d){const f=`__lexicalKey_${u._key}`;c[f]=d})(a,i,s),o.set(s,a)})(e,n,No),_r(r)?n.setAttribute("data-lexical-text","true"):Jn(r)&&n.setAttribute("data-lexical-decorator","true"),Wt(r)){const s=r.__indent,a=r.__size;if(DT(n,r),s!==0&&HH(n,s),a!==0){const o=a-1;IT(u_(r,xu),r,0,o,r.getDOMSlot(n))}const i=r.__format;i!==0&&GH(n,i),r.isInline()||VH(null,r,n),VS(r)&&(ci+=T0,n0+=T0)}else{const s=r.getTextContent();if(Jn(r)){const a=r.decorate(No,Hm);a!==null&&qH(e,a),n.contentEditable="false"}ci+=s,n0+=s}return t!==null&&t.insertChild(n),nE(Xv,Yv,DS,r,"created"),n}function IT(e,t,r,n,s){const a=ci;ci="";let i=r;for(;i<=n;++i){c_(e[i],s);const o=xu.get(e[i]);o!==null&&_r(o)&&(Zu===null&&(Zu=o.getFormat()),ed===""&&(ed=o.getStyle()))}VS(t)&&(ci+=T0),s.element.__lexicalTextContent=ci,ci=a+ci}function ZM(e,t){if(e){const r=e.__last;if(r){const n=t.get(r);if(n)return g0(n)?"line-break":Jn(n)&&n.isInline()?"decorator":null}return"empty"}return null}function VH(e,t,r){const n=ZM(e,Gm),s=ZM(t,xu);n!==s&&t.getDOMSlot(r).setManagedLineBreak(s)}function Tde(e,t,r){var n;Zu=null,ed="",(function(s,a,i){const o=ci,c=s.__size,u=a.__size;ci="";const d=i.element;if(c===1&&u===1){const f=s.__first,h=a.__first;if(f===h)ov(f,d);else{const p=LT(f),x=c_(h,null);try{d.replaceChild(x,p)}catch(v){if(typeof v=="object"&&v!=null){const C=`${v.toString()} Parent: ${d.tagName}, new child: {tag: ${x.tagName} key: ${h}}, old child: {tag: ${p.tagName}, key: ${f}}.`;throw new Error(C)}throw v}l_(f,null)}const g=xu.get(h);_r(g)&&(Zu===null&&(Zu=g.getFormat()),ed===""&&(ed=g.getStyle()))}else{const f=u_(s,Gm),h=u_(a,xu);if(f.length!==c&&rr(227),h.length!==u&&rr(228),c===0)u!==0&&IT(h,a,0,u-1,i);else if(u===0){if(c!==0){const g=i.after==null&&i.before==null&&i.element.__lexicalLineBreak==null;OT(f,0,c-1,g?null:d),g&&(d.textContent="")}}else(function(g,p,x,v,C,b){const _=v-1,T=C-1;let N,E,F=b.getFirstChild(),j=0,P=0;for(;j<=_&&P<=T;){const U=p[j],K=x[P];if(U===K)F=g6(ov(K,b.element)),j++,P++;else{N===void 0&&(N=new Set(p)),E===void 0&&(E=new Set(x));const re=E.has(U),Z=N.has(K);if(re)if(Z){const B=Vm(No,K);B===F?F=g6(ov(K,b.element)):(b.withBefore(F).insertChild(B),ov(K,b.element)),j++,P++}else c_(K,b.withBefore(F)),P++;else F=g6(LT(U)),l_(U,b.element),j++}const te=xu.get(K);te!==null&&_r(te)&&(Zu===null&&(Zu=te.getFormat()),ed===""&&(ed=te.getStyle()))}const M=j>_,I=P>T;if(M&&!I){const U=x[T+1],K=U===void 0?null:No.getElementByKey(U);IT(x,g,P,T,b.withBefore(K))}else I&&!M&&OT(p,j,_,b.element)})(a,f,h,c,u,i)}VS(a)&&(ci+=T0),d.__lexicalTextContent=ci,ci=o+ci})(e,t,t.getDOMSlot(r)),n=t,Zu==null||Zu===n.__textFormat||o_||n.setTextFormat(Zu),(function(s){ed===""||ed===s.__textStyle||o_||s.setTextStyle(ed)})(t)}function u_(e,t){const r=[];let n=e.__first;for(;n!==null;){const s=t.get(n);s===void 0&&rr(101),r.push(n),n=s.__next}return r}function ov(e,t){const r=Gm.get(e);let n=xu.get(e);r!==void 0&&n!==void 0||rr(61);const s=Pp||MT.has(e)||FT.has(e),a=Vm(No,e);if(r===n&&!s){if(Wt(r)){const i=a.__lexicalTextContent;i!==void 0&&(ci+=i,n0+=i)}else{const i=r.getTextContent();n0+=i,ci+=i}return a}if(r!==n&&s&&nE(Xv,Yv,DS,n,"updated"),n.updateDOM(r,a,Hm)){const i=c_(e,null);return t===null&&rr(62),t.replaceChild(i,a),l_(e,null),i}if(Wt(r)&&Wt(n)){const i=n.__indent;(Pp||i!==r.__indent)&&HH(a,i);const o=n.__format;if((Pp||o!==r.__format)&&GH(a,o),s&&(Tde(r,n,a),hi(n)||n.isInline()||VH(r,n,a)),VS(n)&&(ci+=T0,n0+=T0),(Pp||n.__dir!==r.__dir)&&(DT(a,n),hi(n)&&!Pp))for(const c of n.getChildren())Wt(c)&&DT(Vm(No,c.getKey()),c)}else{const i=n.getTextContent();if(Jn(n)){const o=n.decorate(No,Hm);o!==null&&qH(e,o)}ci+=i,n0+=i}if(!o_&&hi(n)&&n.__cachedText!==n0){const i=n.getWritable();i.__cachedText=n0,n=i}return a}function qH(e,t){let r=No._pendingDecorators;const n=No._decorators;if(r===null){if(n[e]===t)return;r=MG(No)}r[e]=t}function g6(e){let t=e.nextSibling;return t!==null&&t===No._blockCursorElement&&(t=t.nextSibling),t}function Nde(e,t,r,n,s,a){ci="",n0="",Pp=n===f1,No=r,Hm=r._config,Yv=r._nodes,DS=No._listeners.mutation,FT=s,MT=a,Gm=e._nodeMap,xu=t._nodeMap,o_=t._readOnly,RT=new Map(r._keyToDOMMap);const i=new Map;return Xv=i,ov("root",null),No=void 0,Yv=void 0,FT=void 0,MT=void 0,Gm=void 0,xu=void 0,Hm=void 0,RT=void 0,Xv=void 0,i}function LT(e){const t=RT.get(e);return t===void 0&&rr(75,e),t}function ln(e){return{type:e}}const KH=ln("SELECTION_CHANGE_COMMAND"),Ede=ln("SELECTION_INSERT_CLIPBOARD_NODES_COMMAND"),IN=ln("CLICK_COMMAND"),Am=ln("DELETE_CHARACTER_COMMAND"),Yp=ln("INSERT_LINE_BREAK_COMMAND"),Jv=ln("INSERT_PARAGRAPH_COMMAND"),Xp=ln("CONTROLLED_TEXT_INSERTION_COMMAND"),LN=ln("PASTE_COMMAND"),BT=ln("REMOVE_TEXT_COMMAND"),Qv=ln("DELETE_WORD_COMMAND"),Zv=ln("DELETE_LINE_COMMAND"),To=ln("FORMAT_TEXT_COMMAND"),BN=ln("UNDO_COMMAND"),$N=ln("REDO_COMMAND"),Ade=ln("KEYDOWN_COMMAND"),YH=ln("KEY_ARROW_RIGHT_COMMAND"),jde=ln("MOVE_TO_END"),XH=ln("KEY_ARROW_LEFT_COMMAND"),Pde=ln("MOVE_TO_START"),JH=ln("KEY_ARROW_UP_COMMAND"),QH=ln("KEY_ARROW_DOWN_COMMAND"),d_=ln("KEY_ENTER_COMMAND"),ZH=ln("KEY_SPACE_COMMAND"),eG=ln("KEY_BACKSPACE_COMMAND"),tG=ln("KEY_ESCAPE_COMMAND"),rG=ln("KEY_DELETE_COMMAND"),nG=ln("KEY_TAB_COMMAND"),Fde=ln("INSERT_TAB_COMMAND"),Mde=ln("INDENT_CONTENT_COMMAND"),eR=ln("OUTDENT_CONTENT_COMMAND"),sG=ln("DROP_COMMAND"),aG=ln("FORMAT_ELEMENT_COMMAND"),iG=ln("DRAGSTART_COMMAND"),oG=ln("DRAGOVER_COMMAND"),Rde=ln("DRAGEND_COMMAND"),IS=ln("COPY_COMMAND"),UN=ln("CUT_COMMAND"),$T=ln("SELECT_ALL_COMMAND"),Ode=ln("CLEAR_EDITOR_COMMAND"),Dde=ln("CLEAR_HISTORY_COMMAND"),Ow=ln("CAN_REDO_COMMAND"),Dw=ln("CAN_UNDO_COMMAND"),Ide=ln("FOCUS_COMMAND"),Lde=ln("BLUR_COMMAND"),Bde=ln("KEY_MODIFIER_COMMAND"),Qd=Object.freeze({}),UT=30,zT=[["keydown",function(e,t){if(wv=e.timeStamp,lG=e.key,!t.isComposing()&&!Dr(t,Ade,e)&&e.key!=null){if(p6&&ER(e))return Ul(t,(()=>{Iw(t,x6)})),p6=!1,void(x6="");if((function(r){return ls(r,"ArrowRight",{shiftKey:"any"})})(e))Dr(t,YH,e);else if((function(r){return ls(r,"ArrowRight",e0)})(e))Dr(t,jde,e);else if((function(r){return ls(r,"ArrowLeft",{shiftKey:"any"})})(e))Dr(t,XH,e);else if((function(r){return ls(r,"ArrowLeft",e0)})(e))Dr(t,Pde,e);else if((function(r){return ls(r,"ArrowUp",{altKey:"any",shiftKey:"any"})})(e))Dr(t,JH,e);else if((function(r){return ls(r,"ArrowDown",{altKey:"any",shiftKey:"any"})})(e))Dr(t,QH,e);else if((function(r){return ls(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any",shiftKey:!0})})(e))_v=!0,Dr(t,d_,e);else if((function(r){return r.key===" "})(e))Dr(t,ZH,e);else if((function(r){return rd&&ls(r,"o",{ctrlKey:!0})})(e))e.preventDefault(),_v=!0,Dr(t,Yp,!0);else if((function(r){return ls(r,"Enter",{altKey:"any",ctrlKey:"any",metaKey:"any"})})(e))_v=!1,Dr(t,d_,e);else if((function(r){return ls(r,"Backspace",{shiftKey:"any"})||rd&&ls(r,"h",{ctrlKey:!0})})(e))ER(e)?Dr(t,eG,e):(e.preventDefault(),Dr(t,Am,!0));else if((function(r){return r.key==="Escape"})(e))Dr(t,tG,e);else if((function(r){return ls(r,"Delete",{})||rd&&ls(r,"d",{ctrlKey:!0})})(e))(function(r){return r.key==="Delete"})(e)?Dr(t,rG,e):(e.preventDefault(),Dr(t,Am,!1));else if((function(r){return ls(r,"Backspace",NR)})(e))e.preventDefault(),Dr(t,Qv,!0);else if((function(r){return ls(r,"Delete",NR)})(e))e.preventDefault(),Dr(t,Qv,!1);else if((function(r){return rd&&ls(r,"Backspace",{metaKey:!0})})(e))e.preventDefault(),Dr(t,Zv,!0);else if((function(r){return rd&&(ls(r,"Delete",{metaKey:!0})||ls(r,"k",{ctrlKey:!0}))})(e))e.preventDefault(),Dr(t,Zv,!1);else if((function(r){return ls(r,"b",e0)})(e))e.preventDefault(),Dr(t,To,"bold");else if((function(r){return ls(r,"u",e0)})(e))e.preventDefault(),Dr(t,To,"underline");else if((function(r){return ls(r,"i",e0)})(e))e.preventDefault(),Dr(t,To,"italic");else if((function(r){return ls(r,"Tab",{shiftKey:"any"})})(e))Dr(t,nG,e);else if((function(r){return ls(r,"z",e0)})(e))e.preventDefault(),Dr(t,BN,void 0);else if((function(r){return rd?ls(r,"z",{metaKey:!0,shiftKey:!0}):ls(r,"y",{ctrlKey:!0})||ls(r,"z",{ctrlKey:!0,shiftKey:!0})})(e))e.preventDefault(),Dr(t,$N,void 0);else{const r=t._editorState._selection;r===null||Jt(r)?AR(e)&&(e.preventDefault(),Dr(t,$T,e)):(function(n){return ls(n,"c",e0)})(e)?(e.preventDefault(),Dr(t,IS,e)):(function(n){return ls(n,"x",e0)})(e)?(e.preventDefault(),Dr(t,UN,e)):AR(e)&&(e.preventDefault(),Dr(t,$T,e))}(function(r){return r.ctrlKey||r.shiftKey||r.altKey||r.metaKey})(e)&&Dr(t,Bde,e)}}],["pointerdown",function(e,t){const r=e.target,n=e.pointerType;U1(r)&&n!=="touch"&&n!=="pen"&&e.button===0&&Ul(t,(()=>{kR(r)||(HT=!0)}))}],["compositionstart",function(e,t){Ul(t,(()=>{const r=wr();if(Jt(r)&&!t.isComposing()){const n=r.anchor,s=r.anchor.getNode();ro(n.key),(e.timeStamp<wv+UT||n.type==="element"||!r.isCollapsed()||s.getFormat()!==r.format||_r(s)&&s.getStyle()!==r.style)&&Dr(t,Xp,fde)}}))}],["compositionend",function(e,t){Um?Hy=!0:d1||!Kv&&!n_?Ul(t,(()=>{Iw(t,e.data)})):(p6=!0,x6=e.data)}],["input",function(e,t){e.stopPropagation(),Ul(t,(()=>{if(Ws(e.target)&&kR(e.target))return;const r=wr(),n=e.data,s=hG(e);if(n!=null&&Jt(r)&&dG(r,s,n,e.timeStamp,!1)){Hy&&(Iw(t,n),Hy=!1);const a=r.anchor.getNode(),i=wu(Ic(t));if(i===null)return;const o=r.isBackward(),c=o?r.anchor.offset:r.focus.offset,u=o?r.focus.offset:r.anchor.offset;r_&&!r.isCollapsed()&&_r(a)&&i.anchorNode!==null&&a.getTextContent().slice(0,c)+n+a.getTextContent().slice(c+u)===IG(i.anchorNode)||Dr(t,Xp,n);const d=n.length;Um&&d>1&&e.inputType==="insertCompositionText"&&!t.isComposing()&&(r.anchor.offset-=d),Kv||d1||n_||!t.isComposing()||(wv=0,ro(null))}else tE(!1,t,n!==null?n:void 0),Hy&&(Iw(t,n||void 0),Hy=!1);(function(){to();const a=ca();$H(a)})()}),{event:e}),Fp=null}],["click",function(e,t){Ul(t,(()=>{const r=wr(),n=wu(Ic(t)),s=$1();if(n){if(Jt(r)){const a=r.anchor,i=a.getNode();if(a.type==="element"&&a.offset===0&&r.isCollapsed()&&!hi(i)&&Zs().getChildrenSize()===1&&i.getTopLevelElementOrThrow().isEmpty()&&s!==null&&r.is(s))n.removeAllRanges(),r.dirty=!0;else if(e.detail===3&&!r.isCollapsed()&&i!==r.focus.getNode()){const o=(function(c,u){let d=c;for(;d!==Zs()&&d!=null;){if(u(d))return d;d=d.getParent()}return null})(i,(c=>Wt(c)&&!c.isInline()));Wt(o)&&o.select(0)}}else if(e.pointerType==="touch"||e.pointerType==="pen"){const a=n.anchorNode;(Ws(a)||O0(a))&&io(HN(s,n,t,e))}}Dr(t,IN,e)}))}],["cut",Qd],["copy",Qd],["dragstart",Qd],["dragover",Qd],["dragend",Qd],["paste",Qd],["focus",Qd],["blur",Qd],["drop",Qd]];r_&&zT.push(["beforeinput",(e,t)=>(function(r,n){const s=r.inputType,a=hG(r);s==="deleteCompositionText"||Um&&LG(n)||s!=="insertCompositionText"&&Ul(n,(()=>{const i=wr();if(s==="deleteContentBackward"){if(i===null){const g=$1();if(!Jt(g))return;io(g.clone())}if(Jt(i)){const g=i.anchor.key===i.focus.key;if(o=r.timeStamp,lG==="MediaLast"&&o<wv+UT&&n.isComposing()&&g){if(ro(null),wv=0,setTimeout((()=>{Ul(n,(()=>{ro(null)}))}),UT),Jt(i)){const p=i.anchor.getNode();p.markDirty(),_r(p)||rr(142),fG(i,p)}}else{ro(null),r.preventDefault();const p=i.anchor.getNode(),x=p.getTextContent(),v=p.canInsertTextAfter(),C=i.anchor.offset===0&&i.focus.offset===x.length;let b=zM&&g&&!C&&v;if(b&&i.isCollapsed()&&(b=!Jn(YT(i.anchor,!0))),!b){Dr(n,Am,!0);const _=wr();zM&&Jt(_)&&_.isCollapsed()&&(pm=_,setTimeout((()=>pm=null)))}}return}}var o;if(!Jt(i))return;const c=r.data;Fp!==null&&tE(!1,n,Fp),i.dirty&&Fp===null||!i.isCollapsed()||hi(i.anchor.getNode())||a===null||i.applyDOMRange(a),Fp=null;const u=i.anchor,d=i.focus,f=u.getNode(),h=d.getNode();if(s!=="insertText"&&s!=="insertTranspose")switch(r.preventDefault(),s){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":Dr(n,Xp,r);break;case"insertFromComposition":ro(null),Dr(n,Xp,r);break;case"insertLineBreak":ro(null),Dr(n,Yp,!1);break;case"insertParagraph":ro(null),_v&&!d1?(_v=!1,Dr(n,Yp,!1)):Dr(n,Jv,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":Dr(n,LN,r);break;case"deleteByComposition":(function(g,p){return g!==p||Wt(g)||Wt(p)||!jm(g)||!jm(p)})(f,h)&&Dr(n,BT,r);break;case"deleteByDrag":case"deleteByCut":Dr(n,BT,r);break;case"deleteContent":Dr(n,Am,!1);break;case"deleteWordBackward":Dr(n,Qv,!0);break;case"deleteWordForward":Dr(n,Qv,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":Dr(n,Zv,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":Dr(n,Zv,!1);break;case"formatStrikeThrough":Dr(n,To,"strikethrough");break;case"formatBold":Dr(n,To,"bold");break;case"formatItalic":Dr(n,To,"italic");break;case"formatUnderline":Dr(n,To,"underline");break;case"historyUndo":Dr(n,BN,void 0);break;case"historyRedo":Dr(n,$N,void 0)}else{if(c===`
`)r.preventDefault(),Dr(n,Yp,!1);else if(c===T0)r.preventDefault(),Dr(n,Jv,void 0);else if(c==null&&r.dataTransfer){const g=r.dataTransfer.getData("text/plain");r.preventDefault(),i.insertRawText(g)}else c!=null&&dG(i,a,c,r.timeStamp,!0)?(r.preventDefault(),Dr(n,Xp,c)):Fp=c;cG=r.timeStamp}}))})(e,t)]);let wv=0,lG=null,cG=0,Fp=null;const f_=new WeakMap;let WT=!1,HT=!1,_v=!1,Hy=!1,p6=!1,x6="",pm=null,uG=[0,"",0,"root",0];function dG(e,t,r,n,s){const a=e.anchor,i=e.focus,o=a.getNode(),c=ca(),u=wu(Ic(c)),d=u!==null?u.anchorNode:null,f=a.key,h=c.getElementByKey(f),g=r.length;return f!==i.key||!_r(o)||(!s&&(!r_||cG<n+50)||o.isDirty()&&g<2||OG(r))&&a.offset!==i.offset&&!o.isComposing()||t0(o)||o.isDirty()&&g>1||(s||!r_)&&h!==null&&!o.isComposing()&&d!==h1(h)||u!==null&&t!==null&&(!t.collapsed||t.startContainer!==u.anchorNode||t.startOffset!==u.anchorOffset)||o.getFormat()!==e.format||o.getStyle()!==e.style||(function(p,x){if(x.isSegmented())return!0;if(!p.isCollapsed())return!1;const v=p.anchor.offset,C=x.getParentOrThrow(),b=jm(x);return v===0?!x.canInsertTextBefore()||!C.canInsertTextBefore()&&!x.isComposing()||b||(function(_){const T=_.getPreviousSibling();return(_r(T)||Wt(T)&&T.isInline())&&!T.canInsertTextAfter()})(x):v===x.getTextContentSize()&&(!x.canInsertTextAfter()||!C.canInsertTextAfter()&&!x.isComposing()||b)})(e,o)}function tR(e,t){return O0(e)&&e.nodeValue!==null&&t!==0&&t!==e.nodeValue.length}function rR(e,t,r){const{anchorNode:n,anchorOffset:s,focusNode:a,focusOffset:i}=e;WT&&(WT=!1,tR(n,s)&&tR(a,i)&&!pm)||Ul(t,(()=>{if(!r)return void io(null);if(!W2(t,n,a))return;let o=wr();if(pm&&Jt(o)&&o.isCollapsed()){const c=o.anchor,u=pm.anchor;(c.key===u.key&&c.offset===u.offset+1||c.offset===1&&u.getNode().is(c.getNode().getPreviousSibling()))&&(o=pm.clone(),io(o))}if(pm=null,Jt(o)){const c=o.anchor,u=c.getNode();if(o.isCollapsed()){e.type==="Range"&&e.anchorNode===e.focusNode&&(o.dirty=!0);const d=Ic(t).event,f=d?d.timeStamp:performance.now(),[h,g,p,x,v]=uG,C=Zs(),b=t.isComposing()===!1&&C.getTextContent()==="";if(f<v+200&&c.offset===p&&c.key===x)P4(o,h,g);else if(c.type==="text")_r(u)||rr(141),fG(o,u);else if(c.type==="element"&&!b){Wt(u)||rr(259);const _=c.getNode();_.isEmpty()?(function(T,N){const E=N.getTextFormat(),F=N.getTextStyle();P4(T,E,F)})(o,_):P4(o,0,"")}}else{const d=c.key,f=o.focus.key,h=o.getNodes(),g=h.length,p=o.isBackward(),x=p?i:s,v=p?s:i,C=p?f:d,b=p?d:f;let _=dde,T=!1;for(let N=0;N<g;N++){const E=h[N],F=E.getTextContentSize();if(_r(E)&&F!==0&&!(N===0&&E.__key===C&&x===F||N===g-1&&E.__key===b&&v===0)&&(T=!0,_&=E.getFormat(),_===0))break}o.format=T?_:0}}Dr(t,KH,void 0)}))}function P4(e,t,r){e.format===t&&e.style===r||(e.format=t,e.style=r,e.dirty=!0)}function fG(e,t){P4(e,t.getFormat(),t.getStyle())}function hG(e){if(!e.getTargetRanges)return null;const t=e.getTargetRanges();return t.length===0?null:t[0]}function Iw(e,t){const r=e._compositionKey;if(ro(null),r!==null&&t!=null){if(t===""){const n=Xa(r),s=h1(e.getElementByKey(r));return void(s!==null&&s.nodeValue!==null&&_r(n)&&rE(n,s.nodeValue,null,null,!0))}if(t[t.length-1]===`
`){const n=wr();if(Jt(n)){const s=n.focus;return n.anchor.set(s.key,s.offset,s.type),void Dr(e,d_,null)}}}tE(!0,e,t)}function mG(e){let t=e.__lexicalEventHandles;return t===void 0&&(t=[],e.__lexicalEventHandles=t),t}const Jp=new Map;function gG(e){const t=y0e(e.target);if(t===null)return;const r=jG(t.anchorNode);if(r===null)return;HT&&(HT=!1,Ul(r,(()=>{const c=$1(),u=t.anchorNode;(Ws(u)||O0(u))&&io(HN(c,t,r,e))})));const n=eE(r),s=n[n.length-1],a=s._key,i=Jp.get(a),o=i||s;o!==r&&rR(t,o,!1),rR(t,r,!0),r!==s?Jp.set(a,r):i&&Jp.delete(a)}function nR(e){e._lexicalHandled=!0}function sR(e){return e._lexicalHandled===!0}function $de(e){const t=e.ownerDocument,r=f_.get(t);if(r===void 0)return;const n=r-1;n>=0||rr(164),f_.set(t,n),n===0&&t.removeEventListener("selectionchange",gG);const s=HS(e);ZN(s)?((function(i){if(i._parentEditor!==null){const o=eE(i),c=o[o.length-1]._key;Jp.get(c)===i&&Jp.delete(c)}else Jp.delete(i._key)})(s),e.__lexicalEditor=null):s&&rr(198);const a=mG(e);for(let i=0;i<a.length;i++)a[i]();e.__lexicalEventHandles=[]}function GT(e,t,r){to();const n=e.__key,s=e.getParent();if(s===null)return;const a=(function(o){const c=wr();if(!Jt(c)||!Wt(o))return c;const{anchor:u,focus:d}=c,f=u.getNode(),h=d.getNode();return XT(f,o)&&u.set(o.__key,0,"element"),XT(h,o)&&d.set(o.__key,0,"element"),c})(e);let i=!1;if(Jt(a)&&t){const o=a.anchor,c=a.focus;o.key===n&&(m_(o,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0),c.key===n&&(m_(c,e,s,e.getPreviousSibling(),e.getNextSibling()),i=!0)}else xo(a)&&t&&e.isSelected()&&e.selectPrevious();if(Jt(a)&&t&&!i){const o=e.getIndexWithinParent();Pm(e),h_(a,s,o,-1)}else Pm(e);r||Qo(s)||s.canBeEmpty()||!s.isEmpty()||GT(s,t),t&&a&&hi(s)&&s.isEmpty()&&s.selectEnd()}class L1{static getType(){const{ownNodeType:t}=oE(this);return t===void 0&&rr(64,this.name),t}static clone(t){rr(65,this.name)}$config(){return{}}config(t,r){const n=r.extends||Object.getPrototypeOf(this.constructor);return Object.assign(r,{extends:n,type:t}),{[t]:r}}afterCloneFrom(t){this.__key===t.__key?(this.__parent=t.__parent,this.__next=t.__next,this.__prev=t.__prev,this.__state=t.__state):t.__state&&(this.__state=t.__state.getWritable(this))}constructor(t){this.__type=this.constructor.getType(),this.__parent=null,this.__prev=null,this.__next=null,Object.defineProperty(this,"__state",{configurable:!0,enumerable:!1,value:void 0,writable:!0}),u0e(this,t)}getType(){return this.__type}isInline(){rr(137,this.constructor.name)}isAttached(){let t=this.__key;for(;t!==null;){if(t==="root")return!0;const r=Xa(t);if(r===null)break;t=r.__parent}return!1}isSelected(t){const r=t||wr();if(r==null)return!1;const n=r.getNodes().some((s=>s.__key===this.__key));if(_r(this))return n;if(Jt(r)&&r.anchor.type==="element"&&r.focus.type==="element"){if(r.isCollapsed())return!1;const s=this.getParent();if(Jn(this)&&this.isInline()&&s){const a=r.isBackward()?r.focus:r.anchor;if(s.is(a.getNode())&&a.offset===s.getChildrenSize()&&this.is(s.getLastChild()))return!1}}return n}getKey(){return this.__key}getIndexWithinParent(){const t=this.getParent();if(t===null)return-1;let r=t.getFirstChild(),n=0;for(;r!==null;){if(this.is(r))return n;n++,r=r.getNextSibling()}return-1}getParent(){const t=this.getLatest().__parent;return t===null?null:Xa(t)}getParentOrThrow(){const t=this.getParent();return t===null&&rr(66,this.__key),t}getTopLevelElement(){let t=this;for(;t!==null;){const r=t.getParent();if(Qo(r))return Wt(t)||t===this&&Jn(t)||rr(194),t;t=r}return null}getTopLevelElementOrThrow(){const t=this.getTopLevelElement();return t===null&&rr(67,this.__key),t}getParents(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r),r=r.getParent();return t}getParentKeys(){const t=[];let r=this.getParent();for(;r!==null;)t.push(r.__key),r=r.getParent();return t}getPreviousSibling(){const t=this.getLatest().__prev;return t===null?null:Xa(t)}getPreviousSiblings(){const t=[],r=this.getParent();if(r===null)return t;let n=r.getFirstChild();for(;n!==null&&!n.is(this);)t.push(n),n=n.getNextSibling();return t}getNextSibling(){const t=this.getLatest().__next;return t===null?null:Xa(t)}getNextSiblings(){const t=[];let r=this.getNextSibling();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getCommonAncestor(t){const r=Wt(this)?this:this.getParent(),n=Wt(t)?t:t.getParent(),s=r&&n?M4(r,n):null;return s?s.commonAncestor:null}is(t){return t!=null&&this.__key===t.__key}isBefore(t){const r=M4(this,t);return r!==null&&(r.type==="descendant"||(r.type==="branch"?zG(r)===-1:(r.type!=="same"&&r.type!=="ancestor"&&rr(279),!1)))}isParentOf(t){const r=M4(this,t);return r!==null&&r.type==="ancestor"}getNodesBetween(t){const r=this.isBefore(t),n=[],s=new Set;let a=this;for(;a!==null;){const i=a.__key;if(s.has(i)||(s.add(i),n.push(a)),a===t)break;const o=Wt(a)?r?a.getFirstChild():a.getLastChild():null;if(o!==null){a=o;continue}const c=r?a.getNextSibling():a.getPreviousSibling();if(c!==null){a=c;continue}const u=a.getParentOrThrow();if(s.has(u.__key)||n.push(u),u===t)break;let d=null,f=u;do{if(f===null&&rr(68),d=r?f.getNextSibling():f.getPreviousSibling(),f=f.getParent(),f===null)break;d!==null||s.has(f.__key)||n.push(f)}while(d===null);a=d}return r||n.reverse(),n}isDirty(){const t=ca()._dirtyLeaves;return t!==null&&t.has(this.__key)}getLatest(){const t=Xa(this.__key);return t===null&&rr(113),t}getWritable(){to();const t=bh(),r=ca(),n=t._nodeMap,s=this.__key,a=this.getLatest(),i=r._cloneNotNeeded,o=wr();if(o!==null&&o.setCachedNodes(null),i.has(s))return x_(a),a;const c=aE(a);return i.add(s),x_(c),n.set(s,c),c}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(t,r){rr(70)}updateDOM(t,r,n){rr(71)}exportDOM(t){return{element:this.createDOM(t._config,t)}}exportJSON(){const t=this.__state?this.__state.toJSON():void 0;return{type:this.__type,version:1,...t}}static importJSON(t){rr(18,this.name)}updateFromJSON(t){return(function(r,n){const s=r.getWritable(),a=n.$;let i=a;for(const o of WH(s).flatKeys)o in n&&(i!==void 0&&i!==a||(i={...a}),i[o]=n[o]);return(s.__state||i)&&kde(r).updateFromJSON(i),s})(this,t)}static transform(){return null}remove(t){GT(this,!0,t)}replace(t,r){to();let n=wr();n!==null&&(n=n.clone()),S6(this,t);const s=this.getLatest(),a=this.__key,i=t.__key,o=t.getWritable(),c=this.getParentOrThrow().getWritable(),u=c.__size;Pm(o);const d=s.getPreviousSibling(),f=s.getNextSibling(),h=s.__prev,g=s.__next,p=s.__parent;if(GT(s,!1,!0),d===null?c.__first=i:d.getWritable().__next=i,o.__prev=h,f===null?c.__last=i:f.getWritable().__prev=i,o.__next=g,o.__parent=p,c.__size=u,r&&(Wt(this)&&Wt(o)||rr(139),this.getChildren().forEach((x=>{o.append(x)}))),Jt(n)){io(n);const x=n.anchor,v=n.focus;x.key===a&&lR(x,o),v.key===a&&lR(v,o)}return Wf()===a&&ro(i),o}insertAfter(t,r=!0){to(),S6(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.getParent(),i=wr();let o=!1,c=!1;if(a!==null){const g=t.getIndexWithinParent();if(Pm(s),Jt(i)){const p=a.__key,x=i.anchor,v=i.focus;o=x.type==="element"&&x.key===p&&x.offset===g+1,c=v.type==="element"&&v.key===p&&v.offset===g+1}}const u=this.getNextSibling(),d=this.getParentOrThrow().getWritable(),f=s.__key,h=n.__next;if(u===null?d.__last=f:u.getWritable().__prev=f,d.__size++,n.__next=f,s.__next=h,s.__prev=n.__key,s.__parent=n.__parent,r&&Jt(i)){const g=this.getIndexWithinParent();h_(i,d,g+1);const p=d.__key;o&&i.anchor.set(p,g+2,"element"),c&&i.focus.set(p,g+2,"element")}return t}insertBefore(t,r=!0){to(),S6(this,t);const n=this.getWritable(),s=t.getWritable(),a=s.__key;Pm(s);const i=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),c=n.__prev,u=this.getIndexWithinParent();i===null?o.__first=a:i.getWritable().__next=a,o.__size++,n.__prev=a,s.__prev=c,s.__next=n.__key,s.__parent=n.__parent;const d=wr();return r&&Jt(d)&&h_(d,this.getParentOrThrow(),u),t}isParentRequired(){return!1}createParentElementNode(){return zs()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(t,r){to();const n=this.getPreviousSibling(),s=this.getParentOrThrow();if(n===null)return s.select(0,0);if(Wt(n))return n.select();if(!_r(n)){const a=n.getIndexWithinParent()+1;return s.select(a,a)}return n.select(t,r)}selectNext(t,r){to();const n=this.getNextSibling(),s=this.getParentOrThrow();if(n===null)return s.select();if(Wt(n))return n.select(0,0);if(!_r(n)){const a=n.getIndexWithinParent();return s.select(a,a)}return n.select(t,r)}markDirty(){this.getWritable()}reconcileObservedMutation(t,r){this.markDirty()}}class L2 extends L1{static getType(){return"linebreak"}static clone(t){return new L2(t.__key)}constructor(t){super(t)}getTextContent(){return`
`}createDOM(){return document.createElement("br")}updateDOM(){return!1}isInline(){return!0}static importDOM(){return{br:t=>(function(r){const n=r.parentElement;if(n!==null&&y_(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&Lw(s)){const a=n.lastChild;if(a===r||a.previousSibling===r&&Lw(a))return!0}}return!1})(t)||(function(r){const n=r.parentElement;if(n!==null&&y_(n)){const s=n.firstChild;if(s===r||s.nextSibling===r&&Lw(s))return!1;const a=n.lastChild;if(a===r||a.previousSibling===r&&Lw(a))return!0}return!1})(t)?null:{conversion:Ude,priority:0}}}static importJSON(t){return hd().updateFromJSON(t)}}function Ude(e){return{node:hd()}}function hd(){return rl(new L2)}function g0(e){return e instanceof L2}function Lw(e){return O0(e)&&/^( |\t|\r?\n)+$/.test(e.textContent||"")}function y6(e,t){return 16&t?"code":t&AN?"mark":32&t?"sub":64&t?"sup":null}function v6(e,t){return 1&t?"strong":2&t?"em":"span"}function pG(e,t,r,n,s){const a=n.classList;let i=Qp(s,"base");i!==void 0&&a.add(...i),i=Qp(s,"underlineStrikethrough");let o=!1;const c=t&a_&&t&s_;i!==void 0&&(r&a_&&r&s_?(o=!0,c||a.add(...i)):c&&a.remove(...i));for(const u in Wm){const d=Wm[u];if(i=Qp(s,u),i!==void 0)if(r&d){if(o&&(u==="underline"||u==="strikethrough")){t&d&&a.remove(...i);continue}t&d&&(!c||u!=="underline")&&u!=="strikethrough"||a.add(...i)}else t&d&&a.remove(...i)}}function xG(e,t,r){const n=t.firstChild,s=r.isComposing(),a=e+(s?OS:"");if(n==null)t.textContent=a;else{const i=n.nodeValue;if(i!==a)if(s||Um){const[o,c,u]=(function(d,f){const h=d.length,g=f.length;let p=0,x=0;for(;p<h&&p<g&&d[p]===f[p];)p++;for(;x+p<h&&x+p<g&&d[h-x-1]===f[g-x-1];)x++;return[p,h-p-x,f.slice(p,g-x)]})(i,a);c!==0&&n.deleteData(o,c),n.insertData(o,u)}else n.nodeValue=a}}function aR(e,t,r,n,s,a){xG(s,e,t);const i=a.theme.text;i!==void 0&&pG(0,0,n,e,i)}function Bw(e,t){const r=document.createElement(t);return r.appendChild(e),r}class vh extends L1{static getType(){return"text"}static clone(t){return new vh(t.__text,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__text=t.__text,this.__format=t.__format,this.__style=t.__style,this.__mode=t.__mode,this.__detail=t.__detail}constructor(t="",r){super(r),this.__text=t,this.__format=0,this.__style="",this.__mode=0,this.__detail=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){const t=this.getLatest();return pde[t.__mode]}getStyle(){return this.getLatest().__style}isToken(){return this.getLatest().__mode===1}isComposing(){return this.__key===Wf()}isSegmented(){return this.getLatest().__mode===2}isDirectionless(){return!!(1&this.getLatest().__detail)}isUnmergeable(){return!!(2&this.getLatest().__detail)}hasFormat(t){const r=Wm[t];return!!(this.getFormat()&r)}isSimpleText(){return this.__type==="text"&&this.__mode===0}getTextContent(){return this.getLatest().__text}getFormatFlags(t,r){return p_(this.getLatest().__format,t,r)}canHaveFormat(){return!0}isInline(){return!0}createDOM(t,r){const n=this.__format,s=y6(0,n),a=v6(0,n),i=s===null?a:s,o=document.createElement(i);let c=o;this.hasFormat("code")&&o.setAttribute("spellcheck","false"),s!==null&&(c=document.createElement(a),o.appendChild(c)),aR(c,this,0,n,this.__text,t);const u=this.__style;return u!==""&&(o.style.cssText=u),o}updateDOM(t,r,n){const s=this.__text,a=t.__format,i=this.__format,o=y6(0,a),c=y6(0,i),u=v6(0,a),d=v6(0,i);if((o===null?u:o)!==(c===null?d:c))return!0;if(o===c&&u!==d){const x=r.firstChild;x==null&&rr(48);const v=document.createElement(d);return aR(v,this,0,i,s,n),r.replaceChild(v,x),!1}let f=r;c!==null&&o!==null&&(f=r.firstChild,f==null&&rr(49)),xG(s,f,this);const h=n.theme.text;h!==void 0&&a!==i&&pG(0,a,i,f,h);const g=t.__style,p=this.__style;return g!==p&&(r.style.cssText=p),!1}static importDOM(){return{"#text":()=>({conversion:Gde,priority:0}),b:()=>({conversion:Wde,priority:0}),code:()=>({conversion:Zd,priority:0}),em:()=>({conversion:Zd,priority:0}),i:()=>({conversion:Zd,priority:0}),mark:()=>({conversion:Zd,priority:0}),s:()=>({conversion:Zd,priority:0}),span:()=>({conversion:zde,priority:0}),strong:()=>({conversion:Zd,priority:0}),sub:()=>({conversion:Zd,priority:0}),sup:()=>({conversion:Zd,priority:0}),u:()=>({conversion:Zd,priority:0})}}static importJSON(t){return wa().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTextContent(t.text).setFormat(t.format).setDetail(t.detail).setMode(t.mode).setStyle(t.style)}exportDOM(t){let{element:r}=super.exportDOM(t);return Ws(r)||rr(132),r.style.whiteSpace="pre-wrap",this.hasFormat("lowercase")?r.style.textTransform="lowercase":this.hasFormat("uppercase")?r.style.textTransform="uppercase":this.hasFormat("capitalize")&&(r.style.textTransform="capitalize"),this.hasFormat("bold")&&(r=Bw(r,"b")),this.hasFormat("italic")&&(r=Bw(r,"i")),this.hasFormat("strikethrough")&&(r=Bw(r,"s")),this.hasFormat("underline")&&(r=Bw(r,"u")),{element:r}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),...super.exportJSON()}}selectionTransform(t,r){}setFormat(t){const r=this.getWritable();return r.__format=typeof t=="string"?Wm[t]:t,r}setDetail(t){const r=this.getWritable();return r.__detail=typeof t=="string"?hde[t]:t,r}setStyle(t){const r=this.getWritable();return r.__style=t,r}toggleFormat(t){const r=p_(this.getFormat(),t,null);return this.setFormat(r)}toggleDirectionless(){const t=this.getWritable();return t.__detail^=1,t}toggleUnmergeable(){const t=this.getWritable();return t.__detail^=2,t}setMode(t){const r=gde[t];if(this.__mode===r)return this;const n=this.getWritable();return n.__mode=r,n}setTextContent(t){if(this.__text===t)return this;const r=this.getWritable();return r.__text=t,r}select(t,r){to();let n=t,s=r;const a=wr(),i=this.getTextContent(),o=this.__key;if(typeof i=="string"){const c=i.length;n===void 0&&(n=c),s===void 0&&(s=c)}else n=0,s=0;if(!Jt(a))return bG(o,n,o,s,"text","text");{const c=Wf();c!==a.anchor.key&&c!==a.focus.key||ro(o),a.setTextNodeRange(this,n,this,s)}return a}selectStart(){return this.select(0,0)}selectEnd(){const t=this.getTextContentSize();return this.select(t,t)}spliceText(t,r,n,s){const a=this.getWritable(),i=a.__text,o=n.length;let c=t;c<0&&(c=o+c,c<0&&(c=0));const u=wr();if(s&&Jt(u)){const f=t+o;u.setTextNodeRange(a,f,a,f)}const d=i.slice(0,c)+n+i.slice(c+r);return a.__text=d,a}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...t){to();const r=this.getLatest(),n=r.getTextContent();if(n==="")return[];const s=r.__key,a=Wf(),i=n.length;t.sort(((j,P)=>j-P)),t.push(i);const o=[],c=t.length;for(let j=0,P=0;j<i&&P<=c;P++){const M=t[P];M>j&&(o.push(n.slice(j,M)),j=M)}const u=o.length;if(u===1)return[r];const d=o[0],f=r.getParent();let h;const g=r.getFormat(),p=r.getStyle(),x=r.__detail;let v=!1,C=null,b=null;const _=wr();if(Jt(_)){const[j,P]=_.isBackward()?[_.focus,_.anchor]:[_.anchor,_.focus];j.type==="text"&&j.key===s&&(C=j),P.type==="text"&&P.key===s&&(b=P)}r.isSegmented()?(h=wa(d),h.__format=g,h.__style=p,h.__detail=x,h.__state=KM(r,h),v=!0):h=r.setTextContent(d);const T=[h];for(let j=1;j<u;j++){const P=wa(o[j]);P.__format=g,P.__style=p,P.__detail=x,P.__state=KM(r,P);const M=P.__key;a===s&&ro(M),T.push(P)}const N=C?C.offset:null,E=b?b.offset:null;let F=0;for(const j of T){if(!C&&!b)break;const P=F+j.getTextContentSize();if(C!==null&&N!==null&&N<=P&&N>=F&&(C.set(j.getKey(),N-F,"text"),N<P&&(C=null)),b!==null&&E!==null&&E<=P&&E>=F){b.set(j.getKey(),E-F,"text");break}F=P}if(f!==null){(function(M){const I=M.getPreviousSibling(),U=M.getNextSibling();I!==null&&x_(I),U!==null&&x_(U)})(this);const j=f.getWritable(),P=this.getIndexWithinParent();v?(j.splice(P,0,T),this.remove()):j.splice(P,1,T),Jt(_)&&h_(_,f,P,u-1)}return T}mergeWithSibling(t){const r=t===this.getPreviousSibling();r||t===this.getNextSibling()||rr(50);const n=this.__key,s=t.__key,a=this.__text,i=a.length;Wf()===s&&ro(n);const o=wr();if(Jt(o)){const f=o.anchor,h=o.focus;f!==null&&f.key===s&&gR(f,r,n,t,i),h!==null&&h.key===s&&gR(h,r,n,t,i)}const c=t.__text,u=r?c+a:a+c;this.setTextContent(u);const d=this.getWritable();return t.remove(),d}isTextEntity(){return!1}}function zde(e){return{forChild:zN(e.style),node:null}}function Wde(e){const t=e,r=t.style.fontWeight==="normal";return{forChild:zN(t.style,r?void 0:"bold"),node:null}}const iR=new WeakMap;function Hde(e){if(!Ws(e))return!1;if(e.nodeName==="PRE")return!0;const t=e.style.whiteSpace;return typeof t=="string"&&t.startsWith("pre")}function Gde(e){const t=e;e.parentElement===null&&rr(129);let r=t.textContent||"";if((function(n){let s,a=n.parentNode;const i=[n];for(;a!==null&&(s=iR.get(a))===void 0&&!Hde(a);)i.push(a),a=a.parentNode;const o=s===void 0?a:s;for(let c=0;c<i.length;c++)iR.set(i[c],o);return o})(t)!==null){const n=r.split(/(\r?\n|\t)/),s=[],a=n.length;for(let i=0;i<a;i++){const o=n[i];o===`
`||o===`\r
`?s.push(hd()):o==="	"?s.push(B1()):o!==""&&s.push(wa(o))}return{node:s}}if(r=r.replace(/\r/g,"").replace(/[ \t\n]+/g," "),r==="")return{node:null};if(r[0]===" "){let n=t,s=!0;for(;n!==null&&(n=oR(n,!1))!==null;){const a=n.textContent||"";if(a.length>0){/[ \t\n]$/.test(a)&&(r=r.slice(1)),s=!1;break}}s&&(r=r.slice(1))}if(r[r.length-1]===" "){let n=t,s=!0;for(;n!==null&&(n=oR(n,!0))!==null;)if((n.textContent||"").replace(/^( |\t|\r?\n)+/,"").length>0){s=!1;break}s&&(r=r.slice(0,r.length-1))}return r===""?{node:null}:{node:wa(r)}}function oR(e,t){let r=e;for(;;){let n;for(;(n=t?r.nextSibling:r.previousSibling)===null;){const a=r.parentElement;if(a===null)return null;r=a}if(r=n,Ws(r)){const a=r.style.display;if(a===""&&!ZT(r)||a!==""&&!a.startsWith("inline"))return null}let s=r;for(;(s=t?r.firstChild:r.lastChild)!==null;)r=s;if(O0(r))return r;if(r.nodeName==="BR")return null}}const Vde={code:"code",em:"italic",i:"italic",mark:"highlight",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function Zd(e){const t=Vde[e.nodeName.toLowerCase()];return t===void 0?{node:null}:{forChild:zN(e.style,t),node:null}}function wa(e=""){return rl(new vh(e))}function _r(e){return e instanceof vh}function zN(e,t){const r=e.fontWeight,n=e.textDecoration.split(" "),s=r==="700"||r==="bold",a=n.includes("line-through"),i=e.fontStyle==="italic",o=n.includes("underline"),c=e.verticalAlign;return u=>(_r(u)&&(s&&!u.hasFormat("bold")&&u.toggleFormat("bold"),a&&!u.hasFormat("strikethrough")&&u.toggleFormat("strikethrough"),i&&!u.hasFormat("italic")&&u.toggleFormat("italic"),o&&!u.hasFormat("underline")&&u.toggleFormat("underline"),c!=="sub"||u.hasFormat("subscript")||u.toggleFormat("subscript"),c!=="super"||u.hasFormat("superscript")||u.toggleFormat("superscript"),t&&!u.hasFormat(t)&&u.toggleFormat(t)),u)}class B2 extends vh{static getType(){return"tab"}static clone(t){return new B2(t.__key)}constructor(t){super("	",t),this.__detail=2}static importDOM(){return null}createDOM(t){const r=super.createDOM(t),n=Qp(t.theme,"tab");return n!==void 0&&r.classList.add(...n),r}static importJSON(t){return B1().updateFromJSON(t)}setTextContent(t){return t!=="	"&&t!==""&&rr(126),super.setTextContent("	")}spliceText(t,r,n,s){return n===""&&r===0||n==="	"&&r===1||rr(286),this}setDetail(t){return t!==2&&rr(127),this}setMode(t){return t!=="normal"&&rr(128),this}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function B1(){return rl(new B2)}function LS(e){return e instanceof B2}class qde{constructor(t,r,n){this._selection=null,this.key=t,this.offset=r,this.type=n}is(t){return this.key===t.key&&this.offset===t.offset&&this.type===t.type}isBefore(t){return this.key===t.key?this.offset<t.offset:UG(jc(N0(this,"next")),jc(N0(t,"next")))<0}getNode(){const t=Xa(this.key);return t===null&&rr(20),t}set(t,r,n,s){const a=this._selection,i=this.key;s&&this.key===t&&this.offset===r&&this.type===n||(this.key=t,this.offset=r,this.type=n,$2()||(Wf()===i&&ro(t),a!==null&&(a.setCachedNodes(null),a.dirty=!0)))}}function md(e,t,r){return new qde(e,t,r)}function b6(e,t){let r=t.__key,n=e.offset,s="element";if(_r(t)){s="text";const a=t.getTextContentSize();n>a&&(n=a)}else if(!Wt(t)){const a=t.getNextSibling();if(_r(a))r=a.__key,n=0,s="text";else{const i=t.getParent();i&&(r=i.__key,n=t.getIndexWithinParent()+1)}}e.set(r,n,s)}function lR(e,t){if(Wt(t)){const r=t.getLastDescendant();Wt(r)||_r(r)?b6(e,r):b6(e,t)}else b6(e,t)}class BS{constructor(t){this._cachedNodes=null,this._nodes=t,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){if(!xo(t))return!1;const r=this._nodes,n=t._nodes;return r.size===n.size&&Array.from(r).every((s=>n.has(s)))}isCollapsed(){return!1}isBackward(){return!1}getStartEndPoints(){return null}add(t){this.dirty=!0,this._nodes.add(t),this._cachedNodes=null}delete(t){this.dirty=!0,this._nodes.delete(t),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(t){return this._nodes.has(t)}clone(){return new BS(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(t){}insertText(){}insertNodes(t){const r=this.getNodes(),n=r.length,s=r[n-1];let a;if(_r(s))a=s.select();else{const i=s.getIndexWithinParent()+1;a=s.getParentOrThrow().select(i,i)}a.insertNodes(t);for(let i=0;i<n;i++)r[i].remove()}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=this._nodes,n=[];for(const s of r){const a=Xa(s);a!==null&&n.push(a)}return $2()||(this._cachedNodes=n),n}getTextContent(){const t=this.getNodes();let r="";for(let n=0;n<t.length;n++)r+=t[n].getTextContent();return r}deleteNodes(){const t=this.getNodes();if((wr()||$1())===this&&t[0]){const r=ao(t[0],"next");P0e(ch(r,r))}for(const r of t)r.remove()}}function Jt(e){return e instanceof hg}class hg{constructor(t,r,n,s){this.anchor=t,this.focus=r,t._selection=this,r._selection=this,this._cachedNodes=null,this.format=n,this.style=s,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(t){this._cachedNodes=t}is(t){return!!Jt(t)&&this.anchor.is(t.anchor)&&this.focus.is(t.focus)&&this.format===t.format&&this.style===t.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){const t=this._cachedNodes;if(t!==null)return t;const r=(function(n){const s=[],[a,i]=n.getTextSlices();a&&s.push(a.caret.origin);const o=new Set,c=new Set;for(const u of n)if(dd(u)){const{origin:d}=u;s.length===0?o.add(d):(c.add(d),s.push(d))}else{const{origin:d}=u;Wt(d)&&c.has(d)||s.push(d)}if(i&&s.push(i.caret.origin),Ym(n.focus)&&Wt(n.focus.origin)&&n.focus.getNodeAtCaret()===null)for(let u=Lc(n.focus.origin,"previous");dd(u)&&o.has(u.origin)&&!u.origin.isEmpty()&&u.origin.is(s[s.length-1]);u=uE(u))o.delete(u.origin),s.pop();for(;s.length>1;){const u=s[s.length-1];if(!Wt(u)||c.has(u)||u.isEmpty()||o.has(u))break;s.pop()}if(s.length===0&&n.isCollapsed()){const u=jc(n.anchor),d=jc(n.anchor.getFlipped()),f=g=>Xf(g)?g.origin:g.getNodeAtCaret(),h=f(u)||f(d)||(n.anchor.getNodeAtCaret()?u.origin:d.origin);s.push(h)}return s})(HG(OR(this),"next"));return $2()||(this._cachedNodes=r),r}setTextNodeRange(t,r,n,s){this.anchor.set(t.__key,r,"text"),this.focus.set(n.__key,s,"text")}getTextContent(){const t=this.getNodes();if(t.length===0)return"";const r=t[0],n=t[t.length-1],s=this.anchor,a=this.focus,i=s.isBefore(a),[o,c]=VT(this);let u="",d=!0;for(let f=0;f<t.length;f++){const h=t[f];if(Wt(h)&&!h.isInline())d||(u+=`
`),d=!h.isEmpty();else if(d=!1,_r(h)){let g=h.getTextContent();h===r?h===n?s.type==="element"&&a.type==="element"&&a.offset!==s.offset||(g=o<c?g.slice(o,c):g.slice(c,o)):g=i?g.slice(o):g.slice(c):h===n&&(g=i?g.slice(0,c):g.slice(0,o)),u+=g}else!Jn(h)&&!g0(h)||h===n&&this.isCollapsed()||(u+=h.getTextContent())}return u}applyDOMRange(t){const r=ca(),n=r.getEditorState()._selection,s=vG(t.startContainer,t.startOffset,t.endContainer,t.endOffset,r,n);if(s===null)return;const[a,i]=s;this.anchor.set(a.key,a.offset,a.type,!0),this.focus.set(i.key,i.offset,i.type,!0),i_(this)}clone(){const t=this.anchor,r=this.focus;return new hg(md(t.key,t.offset,t.type),md(r.key,r.offset,r.type),this.format,this.style)}toggleFormat(t){this.format=p_(this.format,t,null),this.dirty=!0}setFormat(t){this.format=t,this.dirty=!0}setStyle(t){this.style=t,this.dirty=!0}hasFormat(t){const r=Wm[t];return!!(this.format&r)}insertRawText(t){const r=t.split(/(\r?\n|\t)/),n=[],s=r.length;for(let a=0;a<s;a++){const i=r[a];i===`
`||i===`\r
`?n.push(hd()):i==="	"?n.push(B1()):n.push(wa(i))}this.insertNodes(n)}insertText(t){const r=this.anchor,n=this.focus,s=this.format,a=this.style;let i=r,o=n;!this.isCollapsed()&&n.isBefore(r)&&(i=n,o=r),i.type==="element"&&(function(v,C,b,_){const T=v.getNode(),N=T.getChildAtIndex(v.offset),E=wa();if(E.setFormat(b),E.setStyle(_),YN(N))N.splice(0,0,[E]);else{const F=hi(T)?zs().append(E):E;N===null?T.append(F):N.insertBefore(F)}v.is(C)&&C.set(E.__key,0,"text"),v.set(E.__key,0,"text")})(i,o,s,a),o.type==="element"&&Jm(o,jc(N0(o,"next")));const c=i.offset;let u=o.offset;const d=this.getNodes(),f=d.length;let h=d[0];_r(h)||rr(26);const g=h.getTextContent().length,p=h.getParentOrThrow();let x=d[f-1];if(f===1&&o.type==="element"&&(u=g,o.set(i.key,u,"text")),this.isCollapsed()&&c===g&&(t0(h)||!h.canInsertTextAfter()||!p.canInsertTextAfter()&&h.getNextSibling()===null)){let v=h.getNextSibling();if(_r(v)&&v.canInsertTextBefore()&&!t0(v)||(v=wa(),v.setFormat(s),v.setStyle(a),p.canInsertTextAfter()?h.insertAfter(v):p.insertAfter(v)),v.select(0,0),h=v,t!=="")return void this.insertText(t)}else if(this.isCollapsed()&&c===0&&(t0(h)||!h.canInsertTextBefore()||!p.canInsertTextBefore()&&h.getPreviousSibling()===null)){let v=h.getPreviousSibling();if(_r(v)&&!t0(v)||(v=wa(),v.setFormat(s),p.canInsertTextBefore()?h.insertBefore(v):p.insertBefore(v)),v.select(),h=v,t!=="")return void this.insertText(t)}else if(h.isSegmented()&&c!==g){const v=wa(h.getTextContent());v.setFormat(s),h.replace(v),h=v}else if(!this.isCollapsed()&&t!==""){const v=x.getParent();if(!p.canInsertTextBefore()||!p.canInsertTextAfter()||Wt(v)&&(!v.canInsertTextBefore()||!v.canInsertTextAfter()))return this.insertText(""),yG(this.anchor,this.focus,null),void this.insertText(t)}if(f===1){if(jm(h)){const _=wa(t);return _.select(),void h.replace(_)}const v=h.getFormat(),C=h.getStyle();if(c!==u||v===s&&C===a){if(LS(h)){const _=wa(t);return _.setFormat(s),_.setStyle(a),_.select(),void h.replace(_)}}else{if(h.getTextContent()!==""){const _=wa(t);if(_.setFormat(s),_.setStyle(a),_.select(),c===0)h.insertBefore(_,!1);else{const[T]=h.splitText(c);T.insertAfter(_,!1)}return void(_.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length))}h.setFormat(s),h.setStyle(a)}const b=u-c;h=h.spliceText(c,b,t,!0),h.getTextContent()===""?h.remove():this.anchor.type==="text"&&(h.isComposing()?this.anchor.offset-=t.length:(this.format=v,this.style=C))}else{const v=new Set([...h.getParentKeys(),...x.getParentKeys()]),C=Wt(h)?h:h.getParentOrThrow();let b=Wt(x)?x:x.getParentOrThrow(),_=x;if(!C.is(b)&&b.isInline())do _=b,b=b.getParentOrThrow();while(b.isInline());if(o.type==="text"&&(u!==0||x.getTextContent()==="")||o.type==="element"&&x.getIndexWithinParent()<u)if(_r(x)&&!jm(x)&&u!==x.getTextContentSize()){if(x.isSegmented()){const j=wa(x.getTextContent());x.replace(j),x=j}hi(o.getNode())||o.type!=="text"||(x=x.spliceText(0,u,"")),v.add(x.__key)}else{const j=x.getParentOrThrow();j.canBeEmpty()||j.getChildrenSize()!==1?x.remove():j.remove()}else v.add(x.__key);const T=b.getChildren(),N=new Set(d),E=C.is(b),F=C.isInline()&&h.getNextSibling()===null?C:h;for(let j=T.length-1;j>=0;j--){const P=T[j];if(P.is(h)||Wt(P)&&P.isParentOf(h))break;P.isAttached()&&(!N.has(P)||P.is(_)?E||F.insertAfter(P,!1):P.remove())}if(!E){let j=b,P=null;for(;j!==null;){const M=j.getChildren(),I=M.length;(I===0||M[I-1].is(P))&&(v.delete(j.__key),P=j),j=j.getParent()}}if(jm(h))if(c===g)h.select();else{const j=wa(t);j.select(),h.replace(j)}else h=h.spliceText(c,g-c,t,!0),h.getTextContent()===""?h.remove():h.isComposing()&&this.anchor.type==="text"&&(this.anchor.offset-=t.length);for(let j=1;j<f;j++){const P=d[j],M=P.__key;v.has(M)||P.remove()}}}removeText(){const t=wr()===this;R4(this,F0e(OR(this))),t&&wr()!==this&&io(this)}formatText(t,r=null){if(this.isCollapsed())return this.toggleFormat(t),void ro(null);const n=this.getNodes(),s=[];for(const T of n)_r(T)&&s.push(T);const a=T=>{n.forEach((N=>{if(Wt(N)){const E=N.getFormatFlags(t,T);N.setTextFormat(E)}}))},i=s.length;if(i===0)return this.toggleFormat(t),ro(null),void a(r);const o=this.anchor,c=this.focus,u=this.isBackward(),d=u?c:o,f=u?o:c;let h=0,g=s[0],p=d.type==="element"?0:d.offset;if(d.type==="text"&&p===g.getTextContentSize()&&(h=1,g=s[1],p=0),g==null)return;const x=g.getFormatFlags(t,r);a(x);const v=i-1;let C=s[v];const b=f.type==="text"?f.offset:C.getTextContentSize();if(g.is(C)){if(p===b)return;if(t0(g)||p===0&&b===g.getTextContentSize())g.setFormat(x);else{const T=g.splitText(p,b),N=p===0?T[0]:T[1];N.setFormat(x),d.type==="text"&&d.set(N.__key,0,"text"),f.type==="text"&&f.set(N.__key,b-p,"text")}return void(this.format=x)}p===0||t0(g)||([,g]=g.splitText(p),p=0),g.setFormat(x);const _=C.getFormatFlags(t,x);b>0&&(b===C.getTextContentSize()||t0(C)||([C]=C.splitText(b)),C.setFormat(_));for(let T=h+1;T<v;T++){const N=s[T],E=N.getFormatFlags(t,_);N.setFormat(E)}d.type==="text"&&d.set(g.__key,p,"text"),f.type==="text"&&f.set(C.__key,b,"text"),this.format=x|_}insertNodes(t){if(t.length===0)return;if(this.isCollapsed()||this.removeText(),this.anchor.key==="root"){this.insertParagraph();const p=wr();return Jt(p)||rr(134),p.insertNodes(t)}const r=(this.isBackward()?this.focus:this.anchor).getNode(),n=C6(r,Ec),s=t[t.length-1];if(Wt(n)&&"__language"in n){if("__language"in t[0])this.insertText(t[0].getTextContent());else{const p=w6(this);n.splice(p,0,t),s.selectEnd()}return}if(!t.some((p=>(Wt(p)||Jn(p))&&!p.isInline()))){Wt(n)||rr(211,r.constructor.name,r.getType());const p=w6(this);return n.splice(p,0,t),void s.selectEnd()}const a=(function(p){const x=zs();let v=null;for(let C=0;C<p.length;C++){const b=p[C],_=g0(b);if(_||Jn(b)&&b.isInline()||Wt(b)&&b.isInline()||_r(b)||b.isParentRequired()){if(v===null&&(v=b.createParentElementNode(),x.append(v),_))continue;v!==null&&v.append(b)}else x.append(b),v=null}return x})(t),i=a.getLastDescendant(),o=a.getChildren(),c=!Wt(n)||!n.isEmpty()?this.insertParagraph():null,u=o[o.length-1];let d=o[0];var f;Wt(f=d)&&Ec(f)&&!f.isEmpty()&&Wt(n)&&(!n.isEmpty()||n.canMergeWhenEmpty())&&(Wt(n)||rr(211,r.constructor.name,r.getType()),n.append(...d.getChildren()),d=o[1]),d&&(n===null&&rr(212,r.constructor.name,r.getType()),(function(p,x,v){const C=x.getParentOrThrow().getLastChild();let b=x;const _=[x];for(;b!==C;)b.getNextSibling()||rr(140),b=b.getNextSibling(),_.push(b);let T=p;for(const N of _)T=T.insertAfter(N)})(n,d));const h=C6(i,Ec);c&&Wt(h)&&(c.canMergeWhenEmpty()||Ec(u))&&(h.append(...c.getChildren()),c.remove()),Wt(n)&&n.isEmpty()&&n.remove(),i.selectEnd();const g=Wt(n)?n.getLastChild():null;g0(g)&&h!==n&&g.remove()}insertParagraph(){if(this.anchor.key==="root"){const i=zs();return Zs().splice(this.anchor.offset,0,[i]),i.select(),i}const t=w6(this),r=C6(this.anchor.getNode(),Ec);Wt(r)||rr(213);const n=r.getChildAtIndex(t),s=n?[n,...n.getNextSiblings()]:[],a=r.insertNewAfter(this,!1);return a?(a.append(...s),a.selectStart(),a):null}insertLineBreak(t){const r=hd();if(this.insertNodes([r]),t){const n=r.getParentOrThrow(),s=r.getIndexWithinParent();n.select(s,s)}}extract(){const t=this.getNodes(),r=t.length,n=r-1,s=this.anchor,a=this.focus;let i=t[0],o=t[n];const[c,u]=VT(this);if(r===0)return[];if(r===1){if(_r(i)&&!this.isCollapsed()){const f=c>u?u:c,h=c>u?c:u,g=i.splitText(f,h),p=f===0?g[0]:g[1];return p!=null?[p]:[]}return[i]}const d=s.isBefore(a);if(_r(i)){const f=d?c:u;f===i.getTextContentSize()?t.shift():f!==0&&([,i]=i.splitText(f),t[0]=i)}if(_r(o)){const f=o.getTextContent().length,h=d?u:c;h===0?t.pop():h!==f&&([o]=o.splitText(h),t[n]=o)}return t}modify(t,r,n){if(pR(this,t,r,n))return;const s=t==="move",a=ca(),i=wu(Ic(a));if(!i)return;const o=a._blockCursorElement,c=a._rootElement,u=this.focus.getNode();if(c===null||o===null||!Wt(u)||u.isInline()||u.canBeEmpty()||JT(o,a,c),this.dirty){let d=Vm(a,this.anchor.key),f=Vm(a,this.focus.key);this.anchor.type==="text"&&(d=h1(d)),this.focus.type==="text"&&(f=h1(f)),d&&f&&wG(i,d,this.anchor.offset,f,this.focus.offset)}if((function(d,f,h,g){d.modify(f,h,g)})(i,t,r?"backward":"forward",n),i.rangeCount>0){const d=i.getRangeAt(0),f=this.anchor.getNode(),h=hi(f)?f:p0e(f);if(this.applyDOMRange(d),this.dirty=!0,!s){const g=this.getNodes(),p=[];let x=!1;for(let v=0;v<g.length;v++){const C=g[v];XT(C,h)?p.push(C):x=!0}if(x&&p.length>0)if(r){const v=p[0];Wt(v)?v.selectStart():v.getParentOrThrow().selectStart()}else{const v=p[p.length-1];Wt(v)?v.selectEnd():v.getParentOrThrow().selectEnd()}i.anchorNode===d.startContainer&&i.anchorOffset===d.startOffset||(function(v){const C=v.focus,b=v.anchor,_=b.key,T=b.offset,N=b.type;b.set(C.key,C.offset,C.type,!0),C.set(_,T,N,!0)})(this)}}n==="lineboundary"&&pR(this,t,r,n,"decorators")}forwardDeletion(t,r,n){if(!n&&(t.type==="element"&&Wt(r)&&t.offset===r.getChildrenSize()||t.type==="text"&&t.offset===r.getTextContentSize())){const s=r.getParent(),a=r.getNextSibling()||(s===null?null:s.getNextSibling());if(Wt(a)&&a.isShadowRoot())return!0}return!1}deleteCharacter(t){const r=this.isCollapsed();if(this.isCollapsed()){const n=this.anchor;let s=n.getNode();if(this.forwardDeletion(n,s,t))return;const a=fE(N0(n,t?"previous":"next"));if(a.getTextSlices().every((o=>o===null||o.distance===0))){let o={type:"initial"};for(const c of a.iterNodeCarets("shadowRoot"))if(dd(c)){if(!c.origin.isInline()){if(c.origin.isShadowRoot()){if(o.type==="merge-block")break;if(Wt(a.anchor.origin)&&a.anchor.origin.isEmpty()){const u=jc(c);R4(this,ch(u,u)),a.anchor.origin.remove()}return}o.type!=="merge-next-block"&&o.type!=="merge-block"||(o={block:o.block,caret:c,type:"merge-block"})}}else{if(o.type==="merge-block")break;if(Ym(c)){if(Wt(c.origin)){if(c.origin.isInline()){if(!c.origin.isParentOf(a.anchor.origin))break}else o={block:c.origin,type:"merge-next-block"};continue}if(Jn(c.origin)){if(!c.origin.isIsolated())if(o.type==="merge-next-block"&&(c.origin.isKeyboardSelectable()||!c.origin.isInline())&&Wt(a.anchor.origin)&&a.anchor.origin.isEmpty()){a.anchor.origin.remove();const u=WN();u.add(c.origin.getKey()),io(u)}else c.origin.remove();return}break}}if(o.type==="merge-block"){const{caret:c,block:u}=o;return R4(this,ch(!c.origin.isEmpty()&&u.isEmpty()?mE(ao(u,c.direction)):a.anchor,c)),this.removeText()}}const i=this.focus;if(this.modify("extend",t,"character"),this.isCollapsed()){if(t&&n.offset===0&&uR(this,n.getNode()))return}else{const o=i.type==="text"?i.getNode():null;if(s=n.type==="text"?n.getNode():null,o!==null&&o.isSegmented()){const c=i.offset,u=o.getTextContentSize();if(o.is(s)||t&&c!==u||!t&&c!==0)return void dR(o,t,c)}else if(s!==null&&s.isSegmented()){const c=n.offset,u=s.getTextContentSize();if(s.is(o)||t&&c!==0||!t&&c!==u)return void dR(s,t,c)}(function(c,u){const d=c.anchor,f=c.focus,h=d.getNode(),g=f.getNode();if(h===g&&d.type==="text"&&f.type==="text"){const p=d.offset,x=f.offset,v=p<x,C=v?p:x,b=v?x:p,_=b-1;C!==_&&(function(T){return!(OG(T)||Kde(T))})(h.getTextContent().slice(C,b))&&(u?f.set(f.key,_,f.type):d.set(d.key,_,d.type))}})(this,t)}}if(this.removeText(),t&&!r&&this.isCollapsed()&&this.anchor.type==="element"&&this.anchor.offset===0){const n=this.anchor.getNode();n.isEmpty()&&hi(n.getParent())&&n.getPreviousSibling()===null&&uR(this,n)}}deleteLine(t){this.isCollapsed()&&this.modify("extend",t,"lineboundary"),this.isCollapsed()?this.deleteCharacter(t):this.removeText()}deleteWord(t){if(this.isCollapsed()){const r=this.anchor,n=r.getNode();if(this.forwardDeletion(r,n,t))return;this.modify("extend",t,"word")}this.removeText()}isBackward(){return this.focus.isBefore(this.anchor)}getStartEndPoints(){return[this.anchor,this.focus]}}function xo(e){return e instanceof BS}function cR(e){const t=e.offset;if(e.type==="text")return t;const r=e.getNode();return t===r.getChildrenSize()?r.getTextContent().length:0}function VT(e){const t=e.getStartEndPoints();if(t===null)return[0,0];const[r,n]=t;return r.type==="element"&&n.type==="element"&&r.key===n.key&&r.offset===n.offset?[0,0]:[cR(r),cR(n)]}function uR(e,t){for(let r=t;r;r=r.getParent()){if(Wt(r)){if(r.collapseAtStart(e))return!0;if(Qo(r))break}if(r.getPreviousSibling())break}return!1}const Kde=(()=>{try{const e=new RegExp("\\p{Emoji}","u"),t=e.test.bind(e);if(t("")&&t("#")&&t(""))return t}catch{}return()=>!1})();function dR(e,t,r){const n=e,s=n.getTextContent().split(/(?=\s)/g),a=s.length;let i=0,o=0;for(let u=0;u<a;u++){const d=u===a-1;if(o=i,i+=s[u].length,t&&i===r||i>r||d){s.splice(u,1),d&&(o=void 0);break}}const c=s.join("").trim();c===""?n.remove():(n.setTextContent(c),n.select(o,o))}function fR(e,t,r,n){let s,a=t;if(Ws(e)){let i=!1;const o=e.childNodes,c=o.length,u=n._blockCursorElement;a===c&&(i=!0,a=c-1);let d=o[a],f=!1;if(d===u)d=o[a+1],f=!0;else if(u!==null){const h=u.parentNode;e===h&&t>Array.prototype.indexOf.call(h.children,u)&&a--}if(s=Wp(d),_r(s))a=Jf(s,i?"next":"previous");else{let h=Wp(e);if(h===null)return null;if(Wt(h)){const g=n.getElementByKey(h.getKey());g===null&&rr(214),[h,a]=h.getDOMSlot(g).resolveChildIndex(h,g,e,t),Wt(h)||rr(215),i&&a>=h.getChildrenSize()&&(a=Math.max(0,h.getChildrenSize()-1));let x=h.getChildAtIndex(a);if(Wt(x)&&(function(v,C,b){const _=v.getParent();return b===null||_===null||!_.canBeEmpty()||_!==b.getNode()})(x,0,r)){const v=i?x.getLastDescendant():x.getFirstDescendant();v===null?h=x:(x=v,h=Wt(x)?x:x.getParentOrThrow()),a=0}_r(x)?(s=x,h=null,a=Jf(x,i?"next":"previous")):x!==h&&i&&!f&&(Wt(h)||rr(216),a=Math.min(h.getChildrenSize(),a+1))}else{const g=h.getIndexWithinParent();a=t===0&&Jn(h)&&Wp(e)===h?g:g+1,h=h.getParentOrThrow()}if(Wt(h))return md(h.__key,a,"element")}}else s=Wp(e);return _r(s)?md(s.__key,Jf(s,a,"clamp"),"text"):null}function hR(e,t,r){const n=e.offset,s=e.getNode();if(n===0){const a=s.getPreviousSibling(),i=s.getParent();if(t){if((r||!t)&&a===null&&Wt(i)&&i.isInline()){const o=i.getPreviousSibling();_r(o)&&e.set(o.__key,o.getTextContent().length,"text")}}else Wt(a)&&!r&&a.isInline()?e.set(a.__key,a.getChildrenSize(),"element"):_r(a)&&e.set(a.__key,a.getTextContent().length,"text")}else if(n===s.getTextContent().length){const a=s.getNextSibling(),i=s.getParent();if(t&&Wt(a)&&a.isInline())e.set(a.__key,0,"element");else if((r||t)&&a===null&&Wt(i)&&i.isInline()&&!i.canInsertTextAfter()){const o=i.getNextSibling();_r(o)&&e.set(o.__key,0,"text")}}}function yG(e,t,r){if(e.type==="text"&&t.type==="text"){const n=e.isBefore(t),s=e.is(t);hR(e,n,s),hR(t,!n,s),s&&t.set(e.key,e.offset,e.type);const a=ca();if(a.isComposing()&&a._compositionKey!==e.key&&Jt(r)){const i=r.anchor,o=r.focus;e.set(i.key,i.offset,i.type,!0),t.set(o.key,o.offset,o.type,!0)}}}function vG(e,t,r,n,s,a){if(e===null||r===null||!W2(s,e,r))return null;const i=fR(e,t,Jt(a)?a.anchor:null,s);if(i===null)return null;const o=fR(r,n,Jt(a)?a.focus:null,s);if(o===null)return null;if(i.type==="element"&&o.type==="element"){const c=Wp(e),u=Wp(r);if(Jn(c)&&Jn(u))return null}return yG(i,o,a),[i,o]}function qT(e){return Wt(e)&&!e.isInline()}function bG(e,t,r,n,s,a){const i=bh(),o=new hg(md(e,t,s),md(r,n,a),0,"");return o.dirty=!0,i._selection=o,o}function $S(){const e=md("root",0,"element"),t=md("root",0,"element");return new hg(e,t,0,"")}function WN(){return new BS(new Set)}function HN(e,t,r,n){const s=r._window;if(s===null)return null;const a=n||s.event,i=a?a.type:void 0,o=i==="selectionchange",c=!PT&&(o||i==="beforeinput"||i==="compositionstart"||i==="compositionend"||i==="click"&&a&&a.detail===3||i==="drop"||i===void 0);let u,d,f,h;if(Jt(e)&&!c)return e.clone();if(t===null)return null;if(u=t.anchorNode,d=t.focusNode,f=t.anchorOffset,h=t.focusOffset,o&&Jt(e)&&!W2(r,u,d))return e.clone();const g=vG(u,f,d,h,r,e);if(g===null)return null;const[p,x]=g;return new hg(p,x,Jt(e)?e.format:0,Jt(e)?e.style:"")}function wr(){return bh()._selection}function $1(){return ca()._editorState._selection}function h_(e,t,r,n=1){const s=e.anchor,a=e.focus,i=s.getNode(),o=a.getNode();if(!t.is(i)&&!t.is(o))return;const c=t.__key;if(e.isCollapsed()){const u=s.offset;if(r<=u&&n>0||r<u&&n<0){const d=Math.max(0,u+n);s.set(c,d,"element"),a.set(c,d,"element"),mR(e)}}else{const u=e.isBackward(),d=u?a:s,f=d.getNode(),h=u?s:a,g=h.getNode();if(t.is(f)){const p=d.offset;(r<=p&&n>0||r<p&&n<0)&&d.set(c,Math.max(0,p+n),"element")}if(t.is(g)){const p=h.offset;(r<=p&&n>0||r<p&&n<0)&&h.set(c,Math.max(0,p+n),"element")}}mR(e)}function mR(e){const t=e.anchor,r=t.offset,n=e.focus,s=n.offset,a=t.getNode(),i=n.getNode();if(e.isCollapsed()){if(!Wt(a))return;const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(_r(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text"),n.set(u.__key,d,"text")}}else{if(Wt(a)){const o=a.getChildrenSize(),c=r>=o,u=c?a.getChildAtIndex(o-1):a.getChildAtIndex(r);if(_r(u)){let d=0;c&&(d=u.getTextContentSize()),t.set(u.__key,d,"text")}}if(Wt(i)){const o=i.getChildrenSize(),c=s>=o,u=c?i.getChildAtIndex(o-1):i.getChildAtIndex(s);if(_r(u)){let d=0;c&&(d=u.getTextContentSize()),n.set(u.__key,d,"text")}}}}function m_(e,t,r,n,s){let a=null,i=0,o=null;n!==null?(a=n.__key,_r(n)?(i=n.getTextContentSize(),o="text"):Wt(n)&&(i=n.getChildrenSize(),o="element")):s!==null&&(a=s.__key,_r(s)?o="text":Wt(s)&&(o="element")),a!==null&&o!==null?e.set(a,i,o):(i=t.getIndexWithinParent(),i===-1&&(i=r.getChildrenSize()),e.set(r.__key,i,"element"))}function gR(e,t,r,n,s){e.type==="text"?e.set(r,e.offset+(t?0:s),"text"):e.offset>n.getIndexWithinParent()&&e.set(e.key,e.offset-1,"element")}function wG(e,t,r,n,s){try{e.setBaseAndExtent(t,r,n,s)}catch{}}function Yde(e,t,r,n,s,a,i){const o=n.anchorNode,c=n.focusNode,u=n.anchorOffset,d=n.focusOffset,f=document.activeElement;if(s.has(NG)&&f!==a||f!==null&&QN(f))return;if(!Jt(t))return void(e!==null&&W2(r,o,c)&&n.removeAllRanges());const h=t.anchor,g=t.focus,p=h.key,x=g.key,v=Vm(r,p),C=Vm(r,x),b=h.offset,_=g.offset,T=t.format,N=t.style,E=t.isCollapsed();let F=v,j=C,P=!1;if(h.type==="text"){F=h1(v);const re=h.getNode();P=re.getFormat()!==T||re.getStyle()!==N}else Jt(e)&&e.anchor.type==="text"&&(P=!0);var M,I,U,K,te;if(g.type==="text"&&(j=h1(C)),F!==null&&j!==null&&(E&&(e===null||P||Jt(e)&&(e.format!==T||e.style!==N))&&(M=T,I=N,U=b,K=p,te=performance.now(),uG=[M,I,U,K,te]),u!==b||d!==_||o!==F||c!==j||n.type==="Range"&&E||(f!==null&&a.contains(f)||a.focus({preventScroll:!0}),h.type==="element"))){if(wG(n,F,b,j,_),!s.has(r0e)&&t.isCollapsed()&&a!==null&&a===document.activeElement){const re=Jt(t)&&t.anchor.type==="element"?F.childNodes[b]||null:n.rangeCount>0?n.getRangeAt(0):null;if(re!==null){let Z;if(re instanceof Text){const B=document.createRange();B.selectNode(re),Z=B.getBoundingClientRect()}else Z=re.getBoundingClientRect();(function(B,J,z){const q=BG(z),H=sE(q);if(q===null||H===null)return;let{top:R,bottom:L}=J,G=0,W=0,Q=z;for(;Q!==null;){const X=Q===q.body;if(X)G=0,W=Ic(B).innerHeight;else{const le=Q.getBoundingClientRect();G=le.top,W=le.bottom}let se=0;if(R<G?se=-(G-R):L>W&&(se=L-W),se!==0)if(X)H.scrollBy(0,se);else{const le=Q.scrollTop;Q.scrollTop+=se;const he=Q.scrollTop-le;R-=he,L-=he}if(X)break;Q=H2(Q)}})(r,Z,a)}}WT=!0}}function Xde(e){let t=wr()||$1();t===null&&(t=Zs().selectEnd()),t.insertNodes(e)}function w6(e){let t=e;e.isCollapsed()||t.removeText();const r=wr();Jt(r)&&(t=r),Jt(t)||rr(161);const n=t.anchor;let s=n.getNode(),a=n.offset;for(;!Ec(s);){const i=s;if([s,a]=Jde(s,a),i.is(s))break}return a}function Jde(e,t){const r=e.getParent();if(!r){const s=zs();return Zs().append(s),s.select(),[Zs(),0]}if(_r(e)){const s=e.splitText(t);if(s.length===0)return[r,e.getIndexWithinParent()];const a=t===0?0:1;return[r,s[0].getIndexWithinParent()+a]}if(!Wt(e)||t===0)return[r,e.getIndexWithinParent()];const n=e.getChildAtIndex(t);if(n){const s=new hg(md(e.__key,t,"element"),md(e.__key,t,"element"),0,""),a=e.insertNewAfter(s);a&&a.append(n,...n.getNextSiblings())}return[r,e.getIndexWithinParent()+1]}function pR(e,t,r,n,s="decorators-and-blocks"){if(t==="move"&&n==="character"&&!e.isCollapsed()){const[d,f]=r===e.isBackward()?[e.focus,e.anchor]:[e.anchor,e.focus];return f.set(d.key,d.offset,d.type),!0}const a=N0(e.focus,r?"previous":"next"),i=n==="lineboundary",o=t==="move";let c=a,u=s==="decorators-and-blocks";if(!WG(c)){for(const d of c){u=!1;const{origin:f}=d;if(!Jn(f)||f.isIsolated()||(c=d,!i||!f.isInline()))break}if(u)for(const d of fE(a).iterNodeCarets(t==="extend"?"shadowRoot":"root")){if(dd(d))d.origin.isInline()||(c=d);else{if(Wt(d.origin))continue;Jn(d.origin)&&!d.origin.isInline()&&(c=d)}break}}if(c===a)return!1;if(o&&!i&&Jn(c.origin)&&c.origin.isKeyboardSelectable()){const d=WN();return d.add(c.origin.getKey()),io(d),!0}return c=jc(c),o&&Jm(e.anchor,c),Jm(e.focus,c),u||!i}let ji=null,Pi=null,wl=!1,_6=!1,F4=0;const xR={characterData:!0,childList:!0,subtree:!0};function $2(){return wl||ji!==null&&ji._readOnly}function to(){wl&&rr(13)}function _G(){F4>99&&rr(14)}function bh(){return ji===null&&rr(195,SG()),ji}function ca(){return Pi===null&&rr(196,SG()),Pi}function SG(){let e=0;const t=new Set,r=WS.version;if(typeof window<"u")for(const s of document.querySelectorAll("[contenteditable]")){const a=HS(s);if(ZN(a))e++;else if(a){let i=String(a.constructor.version||"<0.17.1");i===r&&(i+=" (separately built, likely a bundler configuration issue)"),t.add(i)}}let n=` Detected on the page: ${e} compatible editor(s) with version ${r}`;return t.size&&(n+=` and incompatible editors with versions ${Array.from(t).join(", ")}`),n}function Qde(){return Pi}function yR(e,t,r){const n=t.__type,s=AG(e,n);let a=r.get(n);a===void 0&&(a=Array.from(s.transforms),r.set(n,a));const i=a.length;for(let o=0;o<i&&(a[o](t),t.isAttached());o++);}function vR(e,t){return e!==void 0&&e.__key!==t&&e.isAttached()}function kG(e,t){if(!t)return;const r=e._updateTags;let n=t;Array.isArray(t)||(n=[t]);for(const s of n)r.add(s)}function Zde(e){return GN(e,ca()._nodes)}function GN(e,t){const r=e.type,n=t.get(r);n===void 0&&rr(17,r);const s=n.klass;e.type!==s.getType()&&rr(18,s.name);const a=s.importJSON(e),i=e.children;if(Wt(a)&&Array.isArray(i))for(let o=0;o<i.length;o++){const c=GN(i[o],t);a.append(c)}return a}function bR(e,t,r){const n=ji,s=wl,a=Pi;ji=t,wl=!0,Pi=e;try{return r()}finally{ji=n,wl=s,Pi=a}}function s0(e,t){const r=e._pendingEditorState,n=e._rootElement,s=e._headless||n===null;if(r===null)return;const a=e._editorState,i=a._selection,o=r._selection,c=e._dirtyType!==zm,u=ji,d=wl,f=Pi,h=e._updating,g=e._observer;let p=null;if(e._pendingEditorState=null,e._editorState=r,!s&&c&&g!==null){Pi=e,ji=r,wl=!1,e._updating=!0;try{const E=e._dirtyType,F=e._dirtyElements,j=e._dirtyLeaves;g.disconnect(),p=Nde(a,r,e,E,F,j)}catch(E){if(E instanceof Error&&e._onError(E),_6)throw E;return EG(e,null,n,r),UH(e),e._dirtyType=f1,_6=!0,s0(e,a),void(_6=!1)}finally{g.observe(n,xR),e._updating=h,ji=u,wl=d,Pi=f}}r._readOnly||(r._readOnly=!0);const x=e._dirtyLeaves,v=e._dirtyElements,C=e._normalizedNodes,b=e._updateTags,_=e._deferred;c&&(e._dirtyType=zm,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set),(function(E,F){const j=E._decorators;let P=E._pendingDecorators||j;const M=F._nodeMap;let I;for(I in P)M.has(I)||(P===j&&(P=MG(E)),delete P[I])})(e,r);const T=s?null:wu(Ic(e));if(e._editable&&T!==null&&(c||o===null||o.dirty)&&n!==null&&!b.has(n0e)){Pi=e,ji=r;try{if(g!==null&&g.disconnect(),c||o===null||o.dirty){const E=e._blockCursorElement;E!==null&&JT(E,e,n),Yde(i,o,e,T,b,n)}(function(E,F,j){let P=E._blockCursorElement;if(Jt(j)&&j.isCollapsed()&&j.anchor.type==="element"&&F.contains(document.activeElement)){const M=j.anchor,I=M.getNode(),U=M.offset;let K=!1,te=null;if(U===I.getChildrenSize())k6(I.getChildAtIndex(U-1))&&(K=!0);else{const re=I.getChildAtIndex(U);if(re!==null&&k6(re)){const Z=re.getPreviousSibling();(Z===null||k6(Z))&&(K=!0,te=E.getElementByKey(re.__key))}}if(K){const re=E.getElementByKey(I.__key);return P===null&&(E._blockCursorElement=P=(function(Z){const B=Z.theme,J=document.createElement("div");J.contentEditable="false",J.setAttribute("data-lexical-cursor","true");let z=B.blockCursor;if(z!==void 0){if(typeof z=="string"){const q=DH(z);z=B.blockCursor=q}z!==void 0&&J.classList.add(...z)}return J})(E._config)),F.style.caretColor="transparent",void(te===null?re.appendChild(P):re.insertBefore(P,te))}}P!==null&&JT(P,E,F)})(e,n,o)}finally{g!==null&&g.observe(n,xR),Pi=f,ji=u}}p!==null&&(function(E,F,j,P,M){const I=Array.from(E._listeners.mutation),U=I.length;for(let K=0;K<U;K++){const[te,re]=I[K];for(const Z of re){const B=F.get(Z);B!==void 0&&te(B,{dirtyLeaves:P,prevEditorState:M,updateTags:j})}}})(e,p,b,x,a),Jt(o)||o===null||i!==null&&i.is(o)||e.dispatchCommand(KH,void 0);const N=e._pendingDecorators;N!==null&&(e._decorators=N,e._pendingDecorators=null,Sv("decorator",e,!0,N)),(function(E,F,j){const P=CR(F),M=CR(j);P!==M&&Sv("textcontent",E,!0,M)})(e,t||a,r),Sv("update",e,!0,{dirtyElements:v,dirtyLeaves:x,editorState:r,mutatedNodes:p,normalizedNodes:C,prevEditorState:t||a,tags:b}),(function(E,F){if(E._deferred=[],F.length!==0){const j=E._updating;E._updating=!0;try{for(let P=0;P<F.length;P++)F[P]()}finally{E._updating=j}}})(e,_),(function(E){const F=E._updates;if(F.length!==0){const j=F.shift();if(j){const[P,M]=j;US(E,P,M)}}})(e)}function Sv(e,t,r,...n){const s=t._updating;t._updating=r;try{const a=Array.from(t._listeners[e]);for(let i=0;i<a.length;i++)a[i].apply(null,n)}finally{t._updating=s}}function wR(e,t){const r=e._updates;let n=t||!1;for(;r.length!==0;){const s=r.shift();if(s){const[a,i]=s,o=e._pendingEditorState;let c;i!==void 0&&(c=i.onUpdate,i.skipTransforms&&(n=!0),i.discrete&&(o===null&&rr(191),o._flushSync=!0),c&&e._deferred.push(c),kG(e,i.tag)),o==null?US(e,a,i):a()}}return n}function US(e,t,r){const n=e._updateTags;let s,a=!1,i=!1;r!==void 0&&(s=r.onUpdate,kG(e,r.tag),a=r.skipTransforms||!1,i=r.discrete||!1),s&&e._deferred.push(s);const o=e._editorState;let c=e._pendingEditorState,u=!1;(c===null||c._readOnly)&&(c=e._pendingEditorState=CG(c||o),u=!0),c._flushSync=i;const d=ji,f=wl,h=Pi,g=e._updating;ji=c,wl=!1,e._updating=!0,Pi=e;const p=e._headless||e.getRootElement()===null;XN(null);try{u&&(p?o._selection!==null&&(c._selection=o._selection.clone()):c._selection=(function(b,_){const T=b.getEditorState()._selection,N=wu(Ic(b));return Jt(T)||T==null?HN(T,N,b,_):T.clone()})(e,r&&r.event||null));const v=e._compositionKey;t(),a=wR(e,a),(function(b,_){const T=_.getEditorState()._selection,N=b._selection;if(Jt(N)){const E=N.anchor,F=N.focus;let j;if(E.type==="text"&&(j=E.getNode(),j.selectionTransform(T,N)),F.type==="text"){const P=F.getNode();j!==P&&P.selectionTransform(T,N)}}})(c,e),e._dirtyType!==zm&&(a?(function(b,_){const T=_._dirtyLeaves,N=b._nodeMap;for(const E of T){const F=N.get(E);_r(F)&&F.isAttached()&&F.isSimpleText()&&!F.isUnmergeable()&&JM(F)}})(c,e):(function(b,_){const T=_._dirtyLeaves,N=_._dirtyElements,E=b._nodeMap,F=Wf(),j=new Map;let P=T,M=P.size,I=N,U=I.size;for(;M>0||U>0;){if(M>0){_._dirtyLeaves=new Set;for(const K of P){const te=E.get(K);_r(te)&&te.isAttached()&&te.isSimpleText()&&!te.isUnmergeable()&&JM(te),te!==void 0&&vR(te,F)&&yR(_,te,j),T.add(K)}if(P=_._dirtyLeaves,M=P.size,M>0){F4++;continue}}_._dirtyLeaves=new Set,_._dirtyElements=new Map,I.delete("root")&&I.set("root",!0);for(const K of I){const te=K[0],re=K[1];if(N.set(te,re),!re)continue;const Z=E.get(te);Z!==void 0&&vR(Z,F)&&yR(_,Z,j)}P=_._dirtyLeaves,M=P.size,I=_._dirtyElements,U=I.size,F4++}_._dirtyLeaves=T,_._dirtyElements=N})(c,e),wR(e),(function(b,_,T,N){const E=b._nodeMap,F=_._nodeMap,j=[];for(const[P]of N){const M=F.get(P);M!==void 0&&(M.isAttached()||(Wt(M)&&LH(M,P,E,F,j,N),E.has(P)||N.delete(P),j.push(P)))}for(const P of j)F.delete(P);for(const P of T){const M=F.get(P);M===void 0||M.isAttached()||(E.has(P)||T.delete(P),F.delete(P))}})(o,c,e._dirtyLeaves,e._dirtyElements)),v!==e._compositionKey&&(c._flushSync=!0);const C=c._selection;if(Jt(C)){const b=c._nodeMap,_=C.anchor.key,T=C.focus.key;b.get(_)!==void 0&&b.get(T)!==void 0||rr(19)}else xo(C)&&C._nodes.size===0&&(c._selection=null)}catch(v){return v instanceof Error&&e._onError(v),e._pendingEditorState=o,e._dirtyType=f1,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void s0(e)}finally{ji=d,wl=f,Pi=h,e._updating=g,F4=0}e._dirtyType!==zm||e._deferred.length>0||(function(v,C){const b=C.getEditorState()._selection,_=v._selection;if(_!==null){if(_.dirty||!_.is(b))return!0}else if(b!==null)return!0;return!1})(c,e)?c._flushSync?(c._flushSync=!1,s0(e)):u&&l0e((()=>{s0(e)})):(c._flushSync=!1,u&&(n.clear(),e._deferred=[],e._pendingEditorState=null))}function Ul(e,t,r){Pi===e&&r===void 0?t():US(e,t,r)}class kv{constructor(t,r,n){this.element=t,this.before=r||null,this.after=n||null}withBefore(t){return new kv(this.element,t,this.after)}withAfter(t){return new kv(this.element,this.before,t)}withElement(t){return this.element===t?this:new kv(t,this.before,this.after)}insertChild(t){const r=this.before||this.getManagedLineBreak();return r!==null&&r.parentElement!==this.element&&rr(222),this.element.insertBefore(t,r),this}removeChild(t){return t.parentElement!==this.element&&rr(223),this.element.removeChild(t),this}replaceChild(t,r){return r.parentElement!==this.element&&rr(224),this.element.replaceChild(t,r),this}getFirstChild(){const t=this.after?this.after.nextSibling:this.element.firstChild;return t===this.before||t===this.getManagedLineBreak()?null:t}getManagedLineBreak(){return this.element.__lexicalLineBreak||null}setManagedLineBreak(t){if(t===null)this.removeManagedLineBreak();else{const r=t==="decorator"&&(d1||Kv);this.insertManagedLineBreak(r)}}removeManagedLineBreak(){const t=this.getManagedLineBreak();if(t){const r=this.element,n=t.nodeName==="IMG"?t.nextSibling:null;n&&r.removeChild(n),r.removeChild(t),r.__lexicalLineBreak=void 0}}insertManagedLineBreak(t){const r=this.getManagedLineBreak();if(r){if(t===(r.nodeName==="IMG"))return;this.removeManagedLineBreak()}const n=this.element,s=this.before,a=document.createElement("br");if(n.insertBefore(a,s),t){const i=document.createElement("img");i.setAttribute("data-lexical-linebreak","true"),i.style.cssText="display: inline !important; border: 0px !important; margin: 0px !important;",i.alt="",n.insertBefore(i,a),n.__lexicalLineBreak=i}else n.__lexicalLineBreak=a}getFirstChildOffset(){let t=0;for(let r=this.after;r!==null;r=r.previousSibling)t++;return t}resolveChildIndex(t,r,n,s){if(n===this.element){const c=this.getFirstChildOffset();return[t,Math.min(c+t.getChildrenSize(),Math.max(c,s))]}const a=_R(r,n);a.push(s);const i=_R(r,this.element);let o=t.getIndexWithinParent();for(let c=0;c<i.length;c++){const u=a[c],d=i[c];if(u===void 0||u<d)break;if(u>d){o+=1;break}}return[t.getParentOrThrow(),o]}}function _R(e,t){const r=[];let n=t;for(;n!==e&&n!==null;n=n.parentNode){let s=0;for(let a=n.previousSibling;a!==null;a=a.previousSibling)s++;r.push(s)}return n!==e&&rr(225),r.reverse()}class Ao extends L1{constructor(t){super(t),this.__first=null,this.__last=null,this.__size=0,this.__format=0,this.__style="",this.__indent=0,this.__dir=null,this.__textFormat=0,this.__textStyle=""}afterCloneFrom(t){super.afterCloneFrom(t),this.__key===t.__key&&(this.__first=t.__first,this.__last=t.__last,this.__size=t.__size),this.__indent=t.__indent,this.__format=t.__format,this.__style=t.__style,this.__dir=t.__dir,this.__textFormat=t.__textFormat,this.__textStyle=t.__textStyle}getFormat(){return this.getLatest().__format}getFormatType(){const t=this.getFormat();return mde[t]||""}getStyle(){return this.getLatest().__style}getIndent(){return this.getLatest().__indent}getChildren(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r),r=r.getNextSibling();return t}getChildrenKeys(){const t=[];let r=this.getFirstChild();for(;r!==null;)t.push(r.__key),r=r.getNextSibling();return t}getChildrenSize(){return this.getLatest().__size}isEmpty(){return this.getChildrenSize()===0}isDirty(){const t=ca()._dirtyElements;return t!==null&&t.has(this.__key)}isLastChild(){const t=this.getLatest(),r=this.getParentOrThrow().getLastChild();return r!==null&&r.is(t)}getAllTextNodes(){const t=[];let r=this.getFirstChild();for(;r!==null;){if(_r(r)&&t.push(r),Wt(r)){const n=r.getAllTextNodes();t.push(...n)}r=r.getNextSibling()}return t}getFirstDescendant(){let t=this.getFirstChild();for(;Wt(t);){const r=t.getFirstChild();if(r===null)break;t=r}return t}getLastDescendant(){let t=this.getLastChild();for(;Wt(t);){const r=t.getLastChild();if(r===null)break;t=r}return t}getDescendantByIndex(t){const r=this.getChildren(),n=r.length;if(t>=n){const a=r[n-1];return Wt(a)&&a.getLastDescendant()||a||null}const s=r[t];return Wt(s)&&s.getFirstDescendant()||s||null}getFirstChild(){const t=this.getLatest().__first;return t===null?null:Xa(t)}getFirstChildOrThrow(){const t=this.getFirstChild();return t===null&&rr(45,this.__key),t}getLastChild(){const t=this.getLatest().__last;return t===null?null:Xa(t)}getLastChildOrThrow(){const t=this.getLastChild();return t===null&&rr(96,this.__key),t}getChildAtIndex(t){const r=this.getChildrenSize();let n,s;if(t<r/2){for(n=this.getFirstChild(),s=0;n!==null&&s<=t;){if(s===t)return n;n=n.getNextSibling(),s++}return null}for(n=this.getLastChild(),s=r-1;n!==null&&s>=t;){if(s===t)return n;n=n.getPreviousSibling(),s--}return null}getTextContent(){let t="";const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContent(),Wt(a)&&s!==n-1&&!a.isInline()&&(t+=T0)}return t}getTextContentSize(){let t=0;const r=this.getChildren(),n=r.length;for(let s=0;s<n;s++){const a=r[s];t+=a.getTextContentSize(),Wt(a)&&s!==n-1&&!a.isInline()&&(t+=T0.length)}return t}getDirection(){return this.getLatest().__dir}getTextFormat(){return this.getLatest().__textFormat}hasFormat(t){if(t!==""){const r=WM[t];return!!(this.getFormat()&r)}return!1}hasTextFormat(t){const r=Wm[t];return!!(this.getTextFormat()&r)}getFormatFlags(t,r){return p_(this.getLatest().__textFormat,t,r)}getTextStyle(){return this.getLatest().__textStyle}select(t,r){to();const n=wr();let s=t,a=r;const i=this.getChildrenSize();if(!this.canBeEmpty()){if(t===0&&r===0){const c=this.getFirstChild();if(_r(c)||Wt(c))return c.select(0,0)}else if(!(t!==void 0&&t!==i||r!==void 0&&r!==i)){const c=this.getLastChild();if(_r(c)||Wt(c))return c.select()}}s===void 0&&(s=i),a===void 0&&(a=i);const o=this.__key;return Jt(n)?(n.anchor.set(o,s,"element"),n.focus.set(o,a,"element"),n.dirty=!0,n):bG(o,s,o,a,"element","element")}selectStart(){const t=this.getFirstDescendant();return t?t.selectStart():this.select()}selectEnd(){const t=this.getLastDescendant();return t?t.selectEnd():this.select()}clear(){const t=this.getWritable();return this.getChildren().forEach((r=>r.remove())),t}append(...t){return this.splice(this.getChildrenSize(),0,t)}setDirection(t){const r=this.getWritable();return r.__dir=t,r}setFormat(t){return this.getWritable().__format=t!==""?WM[t]:0,this}setStyle(t){return this.getWritable().__style=t||"",this}setTextFormat(t){const r=this.getWritable();return r.__textFormat=t,r}setTextStyle(t){const r=this.getWritable();return r.__textStyle=t,r}setIndent(t){return this.getWritable().__indent=t,this}splice(t,r,n){const s=n.length,a=this.getChildrenSize(),i=this.getWritable();t+r<=a||rr(226,String(t),String(r),String(a));const o=i.__key,c=[],u=[],d=this.getChildAtIndex(t+r);let f=null,h=a-r+s;if(t!==0)if(t===a)f=this.getLastChild();else{const p=this.getChildAtIndex(t);p!==null&&(f=p.getPreviousSibling())}if(r>0){let p=f===null?this.getFirstChild():f.getNextSibling();for(let x=0;x<r;x++){p===null&&rr(100);const v=p.getNextSibling(),C=p.__key;Pm(p.getWritable()),u.push(C),p=v}}let g=f;for(let p=0;p<s;p++){const x=n[p];g!==null&&x.is(g)&&(f=g=g.getPreviousSibling());const v=x.getWritable();v.__parent===o&&h--,Pm(v);const C=x.__key;if(g===null)i.__first=C,v.__prev=null;else{const b=g.getWritable();b.__next=C,v.__prev=b.__key}x.__key===o&&rr(76),v.__parent=o,c.push(C),g=x}if(t+r===a)g!==null&&(g.getWritable().__next=null,i.__last=g.__key);else if(d!==null){const p=d.getWritable();if(g!==null){const x=g.getWritable();p.__prev=g.__key,x.__next=d.__key}else p.__prev=null}if(i.__size=h,u.length){const p=wr();if(Jt(p)){const x=new Set(u),v=new Set(c),{anchor:C,focus:b}=p;SR(C,x,v)&&m_(C,C.getNode(),this,f,d),SR(b,x,v)&&m_(b,b.getNode(),this,f,d),h!==0||this.canBeEmpty()||Qo(this)||this.remove()}}return i}getDOMSlot(t){return new kv(t)}exportDOM(t){const{element:r}=super.exportDOM(t);if(Ws(r)){const n=this.getIndent();n>0&&(r.style.paddingInlineStart=40*n+"px");const s=this.getDirection();s&&(r.dir=s)}return{element:r}}exportJSON(){const t={children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),...super.exportJSON()},r=this.getTextFormat(),n=this.getTextStyle();return r!==0&&(t.textFormat=r),n!==""&&(t.textStyle=n),t}updateFromJSON(t){return super.updateFromJSON(t).setFormat(t.format).setIndent(t.indent).setDirection(t.direction).setTextFormat(t.textFormat||0).setTextStyle(t.textStyle||"")}insertNewAfter(t,r){return null}canIndent(){return!0}collapseAtStart(t){return!1}excludeFromCopy(t){return!1}canReplaceWith(t){return!0}canInsertAfter(t){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(t){return!1}extractWithChild(t,r,n){return!1}canMergeWhenEmpty(){return!1}reconcileObservedMutation(t,r){const n=this.getDOMSlot(t);let s=n.getFirstChild();for(let a=this.getFirstChild();a;a=a.getNextSibling()){const i=r.getElementByKey(a.getKey());i!==null&&(s==null?(n.insertChild(i),s=i):s!==i&&n.replaceChild(i,s),s=s.nextSibling)}}}function Wt(e){return e instanceof Ao}function SR(e,t,r){let n=e.getNode();for(;n;){const s=n.__key;if(t.has(s)&&!r.has(s))return!0;n=n.getParent()}return!1}class VN extends L1{decorate(t,r){rr(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Jn(e){return e instanceof VN}class U2 extends Ao{static getType(){return"root"}static clone(){return new U2}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){rr(51)}getTextContent(){const t=this.__cachedText;return!$2()&&ca()._dirtyType!==zm||t===null?super.getTextContent():t}remove(){rr(52)}replace(t){rr(53)}insertBefore(t){rr(54)}insertAfter(t){rr(55)}updateDOM(t,r){return!1}splice(t,r,n){for(const s of n)Wt(s)||Jn(s)||rr(282);return super.splice(t,r,n)}static importJSON(t){return Zs().updateFromJSON(t)}collapseAtStart(){return!0}}function hi(e){return e instanceof U2}function CG(e){return new zS(new Map(e._nodeMap))}function qN(){return new zS(new Map([["root",new U2]]))}function TG(e){const t=e.exportJSON(),r=e.constructor;if(t.type!==r.getType()&&rr(130,r.name),Wt(e)){const n=t.children;Array.isArray(n)||rr(59,r.name);const s=e.getChildren();for(let a=0;a<s.length;a++){const i=TG(s[a]);n.push(i)}}return t}class zS{constructor(t,r){this._nodeMap=t,this._selection=r||null,this._flushSync=!1,this._readOnly=!1}isEmpty(){return this._nodeMap.size===1&&this._selection===null}read(t,r){return bR(r&&r.editor||null,this,t)}clone(t){const r=new zS(this._nodeMap,t===void 0?this._selection:t);return r._readOnly=!0,r}toJSON(){return bR(null,this,(()=>({root:TG(Zs())})))}}const g_="historic",e0e="history-push",Cv="history-merge",t0e="paste",NG="collaboration",r0e="skip-scroll-into-view",n0e="skip-dom-selection";class KN extends Ao{static getType(){return"artificial"}createDOM(t){return document.createElement("div")}}class z2 extends Ao{static getType(){return"paragraph"}static clone(t){return new z2(t.__key)}createDOM(t){const r=document.createElement("p"),n=Qp(t.theme,"paragraph");return n!==void 0&&r.classList.add(...n),r}updateDOM(t,r,n){return!1}static importDOM(){return{p:t=>({conversion:s0e,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(Ws(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n)}return{element:r}}static importJSON(t){return zs().updateFromJSON(t)}exportJSON(){return{...super.exportJSON(),textFormat:this.getTextFormat(),textStyle:this.getTextStyle()}}insertNewAfter(t,r){const n=zs();n.setTextFormat(t.format),n.setTextStyle(t.style);const s=this.getDirection();return n.setDirection(s),n.setFormat(this.getFormatType()),n.setStyle(this.getStyle()),this.insertAfter(n,r),n}collapseAtStart(){const t=this.getChildren();if(t.length===0||_r(t[0])&&t[0].getTextContent().trim()===""){if(this.getNextSibling()!==null)return this.selectNext(),this.remove(),!0;if(this.getPreviousSibling()!==null)return this.selectPrevious(),this.remove(),!0}return!1}}function s0e(e){const t=zs();return e.style&&(t.setFormat(e.style.textAlign),iE(e,t)),{node:t}}function zs(){return rl(new z2)}function YN(e){return e instanceof z2}const zn=0,Mp=1,a0e=4;function EG(e,t,r,n){const s=e._keyToDOMMap;s.clear(),e._editorState=qN(),e._pendingEditorState=n,e._compositionKey=null,e._dirtyType=zm,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null;const a=e._observer;a!==null&&(a.disconnect(),e._observer=null),t!==null&&(t.textContent=""),r!==null&&(r.textContent="",s.set("root",r))}function i0e(e){const t=e||{},r=Qde(),n=t.theme||{},s=e===void 0?r:t.parentEditor||null,a=t.disableEvents||!1,i=qN(),o=t.namespace||(s!==null?s._config.namespace:DG()),c=t.editorState,u=[U2,vh,L2,B2,z2,KN,...t.nodes||[]],{onError:d,html:f}=t,h=t.editable===void 0||t.editable;let g;if(e===void 0&&r!==null)g=r._nodes;else{g=new Map;for(let x=0;x<u.length;x++){let v=u[x],C=null,b=null;if(typeof v!="function"){const F=v;v=F.replace,C=F.with,b=F.withKlass||null}const{ownNodeConfig:_}=oE(v),T=v.getType(),N=v.transform(),E=new Set;_&&_.$transform&&E.add(_.$transform),N!==null&&E.add(N),g.set(T,{exportDOM:f&&f.export?f.export.get(v):void 0,klass:v,replace:C,replaceWithKlass:b,sharedNodeState:_de(u[x]),transforms:E})}}const p=new WS(i,s,g,{disableEvents:a,namespace:o,theme:n},d||console.error,(function(x,v){const C=new Map,b=new Set,_=T=>{Object.keys(T).forEach((N=>{let E=C.get(N);E===void 0&&(E=[],C.set(N,E)),E.push(T[N])}))};return x.forEach((T=>{const N=T.klass.importDOM;if(N==null||b.has(N))return;b.add(N);const E=N.call(T.klass);E!==null&&_(E)})),v&&_(v),C})(g,f?f.import:void 0),h,e);return c!==void 0&&(p._pendingEditorState=c,p._dirtyType=f1),p}class WS{constructor(t,r,n,s,a,i,o,c){this._createEditorArgs=c,this._parentEditor=r,this._rootElement=null,this._editorState=t,this._pendingEditorState=null,this._compositionKey=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=s,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=zm,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=DG(),this._onError=a,this._htmlConversions=i,this._editable=o,this._headless=r!==null&&r._headless,this._window=null,this._blockCursorElement=null}isComposing(){return this._compositionKey!=null}registerUpdateListener(t){const r=this._listeners.update;return r.add(t),()=>{r.delete(t)}}registerEditableListener(t){const r=this._listeners.editable;return r.add(t),()=>{r.delete(t)}}registerDecoratorListener(t){const r=this._listeners.decorator;return r.add(t),()=>{r.delete(t)}}registerTextContentListener(t){const r=this._listeners.textcontent;return r.add(t),()=>{r.delete(t)}}registerRootListener(t){const r=this._listeners.root;return t(this._rootElement,null),r.add(t),()=>{t(null,this._rootElement),r.delete(t)}}registerCommand(t,r,n){n===void 0&&rr(35);const s=this._commands;s.has(t)||s.set(t,[new Set,new Set,new Set,new Set,new Set]);const a=s.get(t);a===void 0&&rr(36,String(t));const i=a[n];return i.add(r),()=>{i.delete(r),a.every((o=>o.size===0))&&s.delete(t)}}registerMutationListener(t,r,n){const s=this.resolveRegisteredNodeAfterReplacements(this.getRegisteredNode(t)).klass,a=this._listeners.mutation;let i=a.get(r);i===void 0&&(i=new Set,a.set(r,i)),i.add(s);const o=n&&n.skipInitialization;return o!==void 0&&o||this.initializeMutationListener(r,s),()=>{i.delete(s),i.size===0&&a.delete(r)}}getRegisteredNode(t){const r=this._nodes.get(t.getType());return r===void 0&&rr(37,t.name),r}resolveRegisteredNodeAfterReplacements(t){for(;t.replaceWithKlass;)t=this.getRegisteredNode(t.replaceWithKlass);return t}initializeMutationListener(t,r){const n=this._editorState,s=FR(n).get(r.getType());if(!s)return;const a=new Map;for(const i of s.keys())a.set(i,"created");a.size>0&&t(a,{dirtyLeaves:new Set,prevEditorState:n,updateTags:new Set(["registerMutationListener"])})}registerNodeTransformToKlass(t,r){const n=this.getRegisteredNode(t);return n.transforms.add(r),n}registerNodeTransform(t,r){const n=this.registerNodeTransformToKlass(t,r),s=[n],a=n.replaceWithKlass;if(a!=null){const i=this.registerNodeTransformToKlass(a,r);s.push(i)}return(function(i,o){const c=FR(i.getEditorState()),u=[];for(const d of o){const f=c.get(d);f&&u.push(f)}u.length!==0&&i.update((()=>{for(const d of u)for(const f of d.keys()){const h=Xa(f);h&&h.markDirty()}}),i._pendingEditorState===null?{tag:Cv}:void 0)})(this,s.map((i=>i.klass.getType()))),()=>{s.forEach((i=>i.transforms.delete(r)))}}hasNode(t){return this._nodes.has(t.getType())}hasNodes(t){return t.every(this.hasNode.bind(this))}dispatchCommand(t,r){return Dr(this,t,r)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(t){const r=this._rootElement;if(t!==r){const n=Qp(this._config.theme,"root"),s=this._pendingEditorState||this._editorState;if(this._rootElement=t,EG(this,r,t,s),r!==null&&(this._config.disableEvents||$de(r),n!=null&&r.classList.remove(...n)),t!==null){const a=sE(t),i=t.style;i.userSelect="text",i.whiteSpace="pre-wrap",i.wordBreak="break-word",t.setAttribute("data-lexical-editor","true"),this._window=a,this._dirtyType=f1,UH(this),this._updateTags.add(Cv),s0(this),this._config.disableEvents||(function(o,c){const u=o.ownerDocument,d=f_.get(u);(d===void 0||d<1)&&u.addEventListener("selectionchange",gG),f_.set(u,(d||0)+1),o.__lexicalEditor=c;const f=mG(o);for(let h=0;h<zT.length;h++){const[g,p]=zT[h],x=typeof p=="function"?v=>{sR(v)||(nR(v),(c.isEditable()||g==="click")&&p(v,c))}:v=>{if(sR(v))return;nR(v);const C=c.isEditable();switch(g){case"cut":return C&&Dr(c,UN,v);case"copy":return Dr(c,IS,v);case"paste":return C&&Dr(c,LN,v);case"dragstart":return C&&Dr(c,iG,v);case"dragover":return C&&Dr(c,oG,v);case"dragend":return C&&Dr(c,Rde,v);case"focus":return C&&Dr(c,Ide,v);case"blur":return C&&Dr(c,Lde,v);case"drop":return C&&Dr(c,sG,v)}};o.addEventListener(g,x),f.push((()=>{o.removeEventListener(g,x)}))}})(t,this),n!=null&&t.classList.add(...n)}else this._window=null,this._updateTags.add(Cv),s0(this);Sv("root",this,!1,t,r)}}getElementByKey(t){return this._keyToDOMMap.get(t)||null}getEditorState(){return this._editorState}setEditorState(t,r){t.isEmpty()&&rr(38);let n=t;n._readOnly&&(n=CG(t),n._selection=t._selection?t._selection.clone():null),$H(this);const s=this._pendingEditorState,a=this._updateTags,i=r!==void 0?r.tag:null;s===null||s.isEmpty()||(i!=null&&a.add(i),s0(this)),this._pendingEditorState=n,this._dirtyType=f1,this._dirtyElements.set("root",!1),this._compositionKey=null,i!=null&&a.add(i),this._updating||s0(this)}parseEditorState(t,r){return(function(n,s,a){const i=qN(),o=ji,c=wl,u=Pi,d=s._dirtyElements,f=s._dirtyLeaves,h=s._cloneNotNeeded,g=s._dirtyType;s._dirtyElements=new Map,s._dirtyLeaves=new Set,s._cloneNotNeeded=new Set,s._dirtyType=0,ji=i,wl=!1,Pi=s,XN(null);try{const p=s._nodes;GN(n.root,p),a&&a(),i._readOnly=!0}catch(p){p instanceof Error&&s._onError(p)}finally{s._dirtyElements=d,s._dirtyLeaves=f,s._cloneNotNeeded=h,s._dirtyType=g,ji=o,wl=c,Pi=u}return i})(typeof t=="string"?JSON.parse(t):t,this,r)}read(t){return s0(this),this.getEditorState().read(t,{editor:this})}update(t,r){(function(n,s,a){n._updating?n._updates.push([s,a]):US(n,s,a)})(this,t,r)}focus(t,r={}){const n=this._rootElement;n!==null&&(n.setAttribute("autocapitalize","off"),Ul(this,(()=>{const s=wr(),a=Zs();s!==null?s.dirty||io(s.clone()):a.getChildrenSize()!==0&&(r.defaultSelection==="rootStart"?a.selectStart():a.selectEnd()),h0e("focus"),m0e((()=>{n.removeAttribute("autocapitalize"),t&&t()}))})),this._pendingEditorState===null&&n.removeAttribute("autocapitalize"))}blur(){const t=this._rootElement;t!==null&&t.blur();const r=wu(this._window);r!==null&&r.removeAllRanges()}isEditable(){return this._editable}setEditable(t){this._editable!==t&&(this._editable=t,Sv("editable",this,!0,t))}toJSON(){return{editorState:this._editorState.toJSON()}}}WS.version="0.35.0+prod.esm";let KT=null;function XN(e){KT=e}let o0e=1;function AG(e,t){const r=JN(e,t);return r===void 0&&rr(30,t),r}function JN(e,t){return e._nodes.get(t)}const l0e=typeof queueMicrotask=="function"?queueMicrotask:e=>{Promise.resolve().then(e)};function kR(e){return Jn(lh(e))}function QN(e){const t=document.activeElement;if(!Ws(t))return!1;const r=t.nodeName;return Jn(lh(e))&&(r==="INPUT"||r==="TEXTAREA"||t.contentEditable==="true"&&HS(t)==null)}function W2(e,t,r){const n=e.getRootElement();try{return n!==null&&n.contains(t)&&n.contains(r)&&t!==null&&!QN(t)&&jG(t)===e}catch{return!1}}function ZN(e){return e instanceof WS}function jG(e){let t=e;for(;t!=null;){const r=HS(t);if(ZN(r))return r;t=H2(t)}return null}function HS(e){return e?e.__lexicalEditor:null}function jm(e){return LS(e)||e.isToken()}function t0(e){return jm(e)||e.isSegmented()}function O0(e){return U1(e)&&e.nodeType===ade}function c0e(e){return U1(e)&&e.nodeType===ide}function h1(e){let t=e;for(;t!=null;){if(O0(t))return t;t=t.firstChild}return null}function p_(e,t,r){const n=Wm[t];if(r!==null&&(e&n)==(r&n))return e;let s=e^n;return t==="subscript"?s&=-65:t==="superscript"?s&=-33:t==="lowercase"?(s&=-513,s&=-1025):t==="uppercase"?(s&=-257,s&=-1025):t==="capitalize"&&(s&=-257,s&=-513),s}function PG(e){return _r(e)||g0(e)||Jn(e)}function u0e(e,t){const r=(function(){const i=KT;return KT=null,i})();if((t=t||r&&r.__key)!=null)return void(e.__key=t);to(),_G();const n=ca(),s=bh(),a=""+o0e++;s._nodeMap.set(a,e),Wt(e)?n._dirtyElements.set(a,!0):n._dirtyLeaves.add(a),n._cloneNotNeeded.add(a),n._dirtyType=IH,e.__key=a}function Pm(e){const t=e.getParent();if(t!==null){const r=e.getWritable(),n=t.getWritable(),s=e.getPreviousSibling(),a=e.getNextSibling(),i=a!==null?a.__key:null,o=s!==null?s.__key:null,c=s!==null?s.getWritable():null,u=a!==null?a.getWritable():null;s===null&&(n.__first=i),a===null&&(n.__last=o),c!==null&&(c.__next=i),u!==null&&(u.__prev=o),r.__prev=null,r.__next=null,r.__parent=null,n.__size--}}function x_(e){_G();const t=e.getLatest(),r=t.__parent,n=bh(),s=ca(),a=n._nodeMap,i=s._dirtyElements;r!==null&&(function(c,u,d){let f=c;for(;f!==null;){if(d.has(f))return;const h=u.get(f);if(h===void 0)break;d.set(f,!1),f=h.__parent}})(r,a,i);const o=t.__key;s._dirtyType=IH,Wt(e)?i.set(o,!0):s._dirtyLeaves.add(o)}function ro(e){to();const t=ca(),r=t._compositionKey;if(e!==r){if(t._compositionKey=e,r!==null){const n=Xa(r);n!==null&&n.getWritable()}if(e!==null){const n=Xa(e);n!==null&&n.getWritable()}}}function Wf(){return $2()?null:ca()._compositionKey}function Xa(e,t){const r=(t||bh())._nodeMap.get(e);return r===void 0?null:r}function FG(e,t){const r=GS(e,ca());return r!==void 0?Xa(r,t):null}function GS(e,t){return e[`__lexicalKey_${t._key}`]}function lh(e,t){let r=e;for(;r!=null;){const n=FG(r,t);if(n!==null)return n;r=H2(r)}return null}function MG(e){const t=e._decorators,r=Object.assign({},t);return e._pendingDecorators=r,r}function CR(e){return e.read((()=>Zs().getTextContent()))}function Zs(){return RG(bh())}function RG(e){return e._nodeMap.get("root")}function io(e){to();const t=bh();e!==null&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function Wp(e){const t=ca(),r=(function(n,s){let a=n;for(;a!=null;){const i=GS(a,s);if(i!==void 0)return i;a=H2(a)}return null})(e,t);return r===null?e===t.getRootElement()?Xa("root"):null:Xa(r)}function OG(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function eE(e){const t=[];let r=e;for(;r!==null;)t.push(r),r=r._parentEditor;return t}function DG(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substring(0,5)}function IG(e){return O0(e)?e.nodeValue:null}function tE(e,t,r){const n=wu(Ic(t));if(n===null)return;const s=n.anchorNode;let{anchorOffset:a,focusOffset:i}=n;if(s!==null){let o=IG(s);const c=lh(s);if(o!==null&&_r(c)){if(o===OS&&r){const u=r.length;o=r,a=u,i=u}o!==null&&rE(c,o,a,i,e)}}}function rE(e,t,r,n,s){let a=e;if(a.isAttached()&&(s||!a.isDirty())){const i=a.isComposing();let o=t;(i||s)&&t[t.length-1]===OS&&(o=t.slice(0,-1));const c=a.getTextContent();if(s||o!==c){if(o===""){if(ro(null),Kv||d1||n_)a.remove();else{const x=ca();setTimeout((()=>{x.update((()=>{a.isAttached()&&a.remove()}))}),20)}return}const u=a.getParent(),d=$1(),f=a.getTextContentSize(),h=Wf(),g=a.getKey();if(a.isToken()||h!==null&&g===h&&!i||Jt(d)&&(u!==null&&!u.canInsertTextBefore()&&d.anchor.offset===0||d.anchor.key===e.__key&&d.anchor.offset===0&&!a.canInsertTextBefore()&&!i||d.focus.key===e.__key&&d.focus.offset===f&&!a.canInsertTextAfter()&&!i))return void a.markDirty();const p=wr();if(!Jt(p)||r===null||n===null)return void TR(a,o,p);if(p.setTextNodeRange(a,r,a,n),a.isSegmented()){const x=wa(a.getTextContent());a.replace(x),a=x}TR(a,o,p)}}}function TR(e,t,r){if(e.setTextContent(t),Jt(r)){const n=e.getKey();for(const s of["anchor","focus"]){const a=r[s];a.type==="text"&&a.key===n&&(a.offset=Jf(e,a.offset,"clamp"))}}}function $w(e,t,r){const n=t[r]||!1;return n==="any"||n===e[r]}function d0e(e,t){return $w(e,t,"altKey")&&$w(e,t,"ctrlKey")&&$w(e,t,"shiftKey")&&$w(e,t,"metaKey")}function ls(e,t,r){return d0e(e,r)&&e.key.toLowerCase()===t.toLowerCase()}const e0={ctrlKey:!rd,metaKey:rd},NR={altKey:rd,ctrlKey:!rd};function ER(e){return e.key==="Backspace"}function AR(e){return ls(e,"a",e0)}function f0e(e){const t=Zs();if(Jt(e)){const r=e.anchor,n=e.focus,s=r.getNode().getTopLevelElementOrThrow().getParentOrThrow();return r.set(s.getKey(),0,"element"),n.set(s.getKey(),s.getChildrenSize(),"element"),i_(e),e}{const r=t.select(0,t.getChildrenSize());return io(i_(r)),r}}function Qp(e,t){e.__lexicalClassNameCache===void 0&&(e.__lexicalClassNameCache={});const r=e.__lexicalClassNameCache,n=r[t];if(n!==void 0)return n;const s=e[t];if(typeof s=="string"){const a=DH(s);return r[t]=a,a}return s}function nE(e,t,r,n,s){if(r.size===0)return;const a=n.__type,i=n.__key,o=t.get(a);o===void 0&&rr(33,a);const c=o.klass;let u=e.get(c);u===void 0&&(u=new Map,e.set(c,u));const d=u.get(i),f=d==="destroyed"&&s==="created";(d===void 0||f)&&u.set(i,f?"updated":s)}function jR(e,t,r){const n=e.getParent();let s=r,a=e;return n!==null&&(t&&r===0?(s=a.getIndexWithinParent(),a=n):t||r!==a.getChildrenSize()||(s=a.getIndexWithinParent()+1,a=n)),a.getChildAtIndex(t?s-1:s)}function YT(e,t){const r=e.offset;if(e.type==="element")return jR(e.getNode(),t,r);{const n=e.getNode();if(t&&r===0||!t&&r===n.getTextContentSize()){const s=t?n.getPreviousSibling():n.getNextSibling();return s===null?jR(n.getParentOrThrow(),t,n.getIndexWithinParent()+(t?0:1)):s}}return null}function LG(e){const t=Ic(e).event,r=t&&t.inputType;return r==="insertFromPaste"||r==="insertFromPasteAsQuotation"}function Dr(e,t,r){return(function(n,s,a){const i=eE(n);for(let o=4;o>=0;o--)for(let c=0;c<i.length;c++){const u=i[c],d=u._commands.get(s);if(d!==void 0){const f=d[o];if(f!==void 0){const h=Array.from(f),g=h.length;let p=!1;if(Ul(u,(()=>{for(let x=0;x<g;x++)if(h[x](a,n))return void(p=!0)})),p)return p}}}return!1})(e,t,r)}function VS(e){return!hi(e)&&!e.isLastChild()&&!e.isInline()}function Vm(e,t){const r=e._keyToDOMMap.get(t);return r===void 0&&rr(75,t),r}function H2(e){const t=e.assignedSlot||e.parentElement;return QT(t)?t.host:t}function BG(e){return c0e(e)?e:Ws(e)?e.ownerDocument:null}function h0e(e){to(),ca()._updateTags.add(e)}function m0e(e){to(),ca()._deferred.push(e)}function XT(e,t){let r=e.getParent();for(;r!==null;){if(r.is(t))return!0;r=r.getParent()}return!1}function sE(e){const t=BG(e);return t?t.defaultView:null}function Ic(e){const t=e._window;return t===null&&rr(78),t}function g0e(e){return Wt(e)&&e.isInline()||Jn(e)&&e.isInline()}function p0e(e){let t=e.getParentOrThrow();for(;t!==null;){if(Qo(t))return t;t=t.getParentOrThrow()}return t}function Qo(e){return hi(e)||Wt(e)&&e.isShadowRoot()}function rl(e){const t=ca(),r=e.getType(),n=JN(t,r);n===void 0&&rr(200,e.constructor.name,r);const{replace:s,replaceWithKlass:a}=n;if(s!==null){const i=s(e),o=i.constructor;return a!==null?i instanceof a||rr(201,a.name,a.getType(),o.name,o.getType(),e.constructor.name,r):i instanceof e.constructor&&o!==e.constructor||rr(202,o.name,o.getType(),e.constructor.name,r),i.__key===e.__key&&rr(203,e.constructor.name,r,o.name,o.getType()),i}return e}function S6(e,t){!hi(e.getParent())||Wt(t)||Jn(t)||rr(99)}function x0e(e){const t=Xa(e);return t===null&&rr(63,e),t}function k6(e){return(Jn(e)||Wt(e)&&!e.canBeEmpty())&&!e.isInline()}function JT(e,t,r){r.style.removeProperty("caret-color"),t._blockCursorElement=null;const n=e.parentElement;n!==null&&n.removeChild(e)}function wu(e){return Cu?(e||window).getSelection():null}function y0e(e){const t=sE(e);return t?t.getSelection():null}function $G(e){return Ws(e)&&e.tagName==="A"}function Ws(e){return U1(e)&&e.nodeType===sde}function U1(e){return typeof e=="object"&&e!==null&&"nodeType"in e&&typeof e.nodeType=="number"}function QT(e){return U1(e)&&e.nodeType===ode}function ZT(e){const t=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|mark|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var|#text)$/,"i");return e.nodeName.match(t)!==null}function y_(e){const t=new RegExp(/^(address|article|aside|blockquote|canvas|dd|div|dl|dt|fieldset|figcaption|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hr|li|main|nav|noscript|ol|p|pre|section|table|td|tfoot|ul|video)$/,"i");return e.nodeName.match(t)!==null}function Ec(e){if(Jn(e)&&!e.isInline())return!0;if(!Wt(e)||Qo(e))return!1;const t=e.getFirstChild(),r=t===null||g0(t)||_r(t)||t.isInline();return!e.isInline()&&e.canBeEmpty()!==!1&&r}function C6(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function G2(){return ca()}const PR=new WeakMap,v0e=new Map;function FR(e){if(!e._readOnly&&e.isEmpty())return v0e;e._readOnly||rr(192);let t=PR.get(e);return t||(t=(function(r){const n=new Map;for(const[s,a]of r._nodeMap){const i=a.__type;let o=n.get(i);o||(o=new Map,n.set(i,o)),o.set(s,a)}return n})(e),PR.set(e,t)),t}function aE(e){const t=e.constructor.clone(e);return t.afterCloneFrom(e),t}function iE(e,t){const r=parseInt(e.style.paddingInlineStart,10)||0,n=Math.round(r/40);t.setIndent(n)}function b0e(e){e.__lexicalUnmanaged=!0}function w0e(e){return e.__lexicalUnmanaged===!0}function Gy(e,t){return(function(r,n){return Object.prototype.hasOwnProperty.call(r,n)})(e,t)&&e[t]!==L1[t]}function oE(e){const t=HM in e.prototype?e.prototype[HM]():void 0,r=(function(i){return i===VN||i===Ao||i===L1})(e),n=!r&&Gy(e,"getType")?e.getType():void 0;let s,a=n;if(t)if(n)s=t[n];else for(const[i,o]of Object.entries(t))a=i,s=o;if(!r&&a&&(Gy(e,"getType")||(e.getType=()=>a),Gy(e,"clone")||(e.clone=i=>(XN(i),new e)),Gy(e,"importJSON")||(e.importJSON=s&&s.$importJSON||(i=>new e().updateFromJSON(i))),!Gy(e,"importDOM")&&s)){const{importDOM:i}=s;i&&(e.importDOM=()=>i)}return{ownNodeConfig:s,ownNodeType:a}}function _0e(e){const t=G2();return to(),new(t.resolveRegisteredNodeAfterReplacements(t.getRegisteredNode(e))).klass}const S0e={next:"previous",previous:"next"};class lE{constructor(t){this.origin=t}[Symbol.iterator](){return hE({hasNext:Ym,initial:this.getAdjacentCaret(),map:t=>t,step:t=>t.getAdjacentCaret()})}getAdjacentCaret(){return ao(this.getNodeAtCaret(),this.direction)}getSiblingCaret(){return ao(this.origin,this.direction)}remove(){const t=this.getNodeAtCaret();return t&&t.remove(),this}replaceOrInsert(t,r){const n=this.getNodeAtCaret();return t.is(this.origin)||t.is(n)||(n===null?this.insert(t):n.replace(t,r)),this}splice(t,r,n="next"){const s=n===this.direction?r:Array.from(r).reverse();let a=this;const i=this.getParentAtCaret(),o=new Map;for(let c=a.getAdjacentCaret();c!==null&&o.size<t;c=c.getAdjacentCaret()){const u=c.origin.getWritable();o.set(u.getKey(),u)}for(const c of s){if(o.size>0){const u=a.getNodeAtCaret();if(u){if(o.delete(u.getKey()),o.delete(c.getKey()),!(u.is(c)||a.origin.is(c))){const d=c.getParent();d&&d.is(i)&&c.remove(),u.replace(c)}}else u===null&&rr(263,Array.from(o).join(" "))}else a.insert(c);a=ao(c,this.direction)}for(const c of o.values())c.remove();return this}}class e2 extends lE{type="child";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Lc(t,this.direction)}getParentCaret(t="root"){return ao(cE(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=z1(this.direction);return ao(this.getNodeAtCaret(),t)||Lc(this.origin,t)}getParentAtCaret(){return this.origin}getChildCaret(){return this}isSameNodeCaret(t){return t instanceof e2&&this.direction===t.direction&&this.origin.is(t.origin)}isSamePointCaret(t){return this.isSameNodeCaret(t)}}const k0e={root:hi,shadowRoot:Qo};function z1(e){return S0e[e]}function cE(e,t="root"){return k0e[t](e)?null:e}class qm extends lE{type="sibling";getLatest(){const t=this.origin.getLatest();return t===this.origin?this:ao(t,this.direction)}getSiblingCaret(){return this}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return Wt(this.origin)?Lc(this.origin,this.direction):null}getParentCaret(t="root"){return ao(cE(this.getParentAtCaret(),t),this.direction)}getFlipped(){const t=z1(this.direction);return ao(this.getNodeAtCaret(),t)||Lc(this.origin.getParentOrThrow(),t)}isSamePointCaret(t){return t instanceof qm&&this.direction===t.direction&&this.origin.is(t.origin)}isSameNodeCaret(t){return(t instanceof qm||t instanceof Km)&&this.direction===t.direction&&this.origin.is(t.origin)}}class Km extends lE{type="text";constructor(t,r){super(t),this.offset=r}getLatest(){const t=this.origin.getLatest();return t===this.origin?this:Xm(t,this.direction,this.offset)}getParentAtCaret(){return this.origin.getParent()}getChildCaret(){return null}getParentCaret(t="root"){return ao(cE(this.getParentAtCaret(),t),this.direction)}getFlipped(){return Xm(this.origin,z1(this.direction),this.offset)}isSamePointCaret(t){return t instanceof Km&&this.direction===t.direction&&this.origin.is(t.origin)&&this.offset===t.offset}isSameNodeCaret(t){return(t instanceof qm||t instanceof Km)&&this.direction===t.direction&&this.origin.is(t.origin)}getSiblingCaret(){return ao(this.origin,this.direction)}}function Xf(e){return e instanceof Km}function Ym(e){return e instanceof qm}function dd(e){return e instanceof e2}const C0e={next:class extends Km{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends Km{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},T0e={next:class extends qm{direction="next";getNodeAtCaret(){return this.origin.getNextSibling()}insert(e){return this.origin.insertAfter(e),this}},previous:class extends qm{direction="previous";getNodeAtCaret(){return this.origin.getPreviousSibling()}insert(e){return this.origin.insertBefore(e),this}}},N0e={next:class extends e2{direction="next";getNodeAtCaret(){return this.origin.getFirstChild()}insert(e){return this.origin.splice(0,0,[e]),this}},previous:class extends e2{direction="previous";getNodeAtCaret(){return this.origin.getLastChild()}insert(e){return this.origin.splice(this.origin.getChildrenSize(),0,[e]),this}}};function ao(e,t){return e?new T0e[t](e):null}function Xm(e,t,r){return e?new C0e[t](e,Jf(e,r)):null}function Jf(e,t,r="error"){const n=e.getTextContentSize();let s=t==="next"?n:t==="previous"?0:t;return(s<0||s>n)&&(r!=="clamp"&&(function(a,...i){const o=new URL("https://lexical.dev/docs/error"),c=new URLSearchParams;c.append("code",a);for(const u of i)c.append("v",u);o.search=c.toString(),console.warn(`Minified Lexical warning #${a}; visit ${o.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)})(284,String(t),String(n),e.getKey()),s=s<0?0:n),s}function MR(e,t){return new A0e(e,t)}function Lc(e,t){return Wt(e)?new N0e[t](e):null}function E0e(e){return e&&e.getChildCaret()||e}function uE(e){return e&&E0e(e.getAdjacentCaret())}class dE{type="node-caret-range";constructor(t,r,n){this.anchor=t,this.focus=r,this.direction=n}getLatest(){const t=this.anchor.getLatest(),r=this.focus.getLatest();return t===this.anchor&&r===this.focus?this:new dE(t,r,this.direction)}isCollapsed(){return this.anchor.isSamePointCaret(this.focus)}getTextSlices(){const t=s=>{const a=this[s].getLatest();return Xf(a)?(function(i,o){const{direction:c,origin:u}=i,d=Jf(u,o==="focus"?z1(c):c);return MR(i,d-i.offset)})(a,s):null},r=t("anchor"),n=t("focus");if(r&&n){const{caret:s}=r,{caret:a}=n;if(s.isSameNodeCaret(a))return[MR(s,a.offset-s.offset),null]}return[r,n]}iterNodeCarets(t="root"){const r=Xf(this.anchor)?this.anchor.getSiblingCaret():this.anchor.getLatest(),n=this.focus.getLatest(),s=Xf(n),a=i=>i.isSameNodeCaret(n)?null:uE(i)||i.getParentCaret(t);return hE({hasNext:i=>i!==null&&!(s&&n.isSameNodeCaret(i)),initial:r.isSameNodeCaret(n)?null:a(r),map:i=>i,step:a})}[Symbol.iterator](){return this.iterNodeCarets("root")}}class A0e{type="slice";constructor(t,r){this.caret=t,this.distance=r}getSliceIndices(){const{distance:t,caret:{offset:r}}=this,n=r+t;return n<r?[n,r]:[r,n]}getTextContent(){const[t,r]=this.getSliceIndices();return this.caret.origin.getTextContent().slice(t,r)}getTextContentSize(){return Math.abs(this.distance)}removeTextSlice(){const{caret:{origin:t,direction:r}}=this,[n,s]=this.getSliceIndices(),a=t.getTextContent();return Xm(t.setTextContent(a.slice(0,n)+a.slice(s)),r,n)}}function fE(e){return ch(e,ao(Zs(),e.direction))}function j0e(e){return ch(e,e)}function ch(e,t){return e.direction!==t.direction&&rr(265),new dE(e,t,e.direction)}function hE(e){const{initial:t,hasNext:r,step:n,map:s}=e;let a=t;return{[Symbol.iterator](){return this},next(){if(!r(a))return{done:!0,value:void 0};const i={done:!1,value:s(a)};return a=n(a),i}}}function UG(e,t){const r=M4(e.origin,t.origin);switch(r===null&&rr(275,e.origin.getKey(),t.origin.getKey()),r.type){case"same":{const n=e.type==="text",s=t.type==="text";return n&&s?(function(a,i){return Math.sign(a-i)})(e.offset,t.offset):e.type===t.type?0:n?-1:s?1:e.type==="child"?-1:1}case"ancestor":return e.type==="child"?-1:1;case"descendant":return t.type==="child"?1:-1;case"branch":return zG(r)}}function zG(e){const{a:t,b:r}=e,n=t.__key,s=r.__key;let a=t,i=r;for(;a&&i;a=a.getNextSibling(),i=i.getNextSibling()){if(a.__key===s)return-1;if(i.__key===n)return 1}return a===null?1:-1}function Uw(e,t){return t.is(e)}function RR(e){return Wt(e)?[e.getLatest(),null]:[e.getParent(),e.getLatest()]}function M4(e,t){if(e.is(t))return{commonAncestor:e,type:"same"};const r=new Map;for(let[n,s]=RR(e);n;s=n,n=n.getParent())r.set(n,s);for(let[n,s]=RR(t);n;s=n,n=n.getParent()){const a=r.get(n);if(a!==void 0)return a===null?(Uw(e,n)||rr(276),{commonAncestor:n,type:"ancestor"}):s===null?(Uw(t,n)||rr(277),{commonAncestor:n,type:"descendant"}):((Wt(a)||Uw(e,a))&&(Wt(s)||Uw(t,s))&&n.is(a.getParent())&&n.is(s.getParent())||rr(278),{a,b:s,commonAncestor:n,type:"branch"})}return null}function N0(e,t){const{type:r,key:n,offset:s}=e,a=x0e(e.key);return r==="text"?(_r(a)||rr(266,a.getType(),n),Xm(a,t,s)):(Wt(a)||rr(267,a.getType(),n),M0e(a,e.offset,t))}function Jm(e,t){const{origin:r,direction:n}=t,s=n==="next";Xf(t)?e.set(r.getKey(),t.offset,"text"):Ym(t)?_r(r)?e.set(r.getKey(),Jf(r,n),"text"):e.set(r.getParentOrThrow().getKey(),r.getIndexWithinParent()+(s?1:0),"element"):(dd(t)&&Wt(r)||rr(268),e.set(r.getKey(),s?0:r.getChildrenSize(),"element"))}function P0e(e){const t=wr(),r=Jt(t)?t:$S();return R4(r,e),io(r),r}function R4(e,t){Jm(e.anchor,t.anchor),Jm(e.focus,t.focus)}function OR(e){const{anchor:t,focus:r}=e,n=N0(t,"next"),s=N0(r,"next"),a=UG(n,s)<=0?"next":"previous";return ch(m1(n,a),m1(s,a))}function mE(e){const{direction:t,origin:r}=e,n=ao(r,z1(t)).getNodeAtCaret();return n?ao(n,t):Lc(r.getParentOrThrow(),t)}function DR(e,t="root"){const r=[e];for(let n=dd(e)?e.getParentCaret(t):e.getSiblingCaret();n!==null;n=n.getParentCaret(t))r.push(mE(n));return r}function T6(e){return!!e&&e.origin.isAttached()}function F0e(e,t="removeEmptySlices"){if(e.isCollapsed())return e;const r="root",n="next";let s=t;const a=HG(e,n),i=DR(a.anchor,r),o=DR(a.focus.getFlipped(),r),c=new Set,u=[];for(const p of a.iterNodeCarets(r))if(dd(p))c.add(p.origin.getKey());else if(Ym(p)){const{origin:x}=p;Wt(x)&&!c.has(x.getKey())||u.push(x)}for(const p of u)p.remove();for(const p of a.getTextSlices()){if(!p)continue;const{origin:x}=p.caret,v=x.getTextContentSize(),C=mE(ao(x,n)),b=x.getMode();if(Math.abs(p.distance)===v&&s==="removeEmptySlices"||b==="token"&&p.distance!==0)C.remove();else if(p.distance!==0){s="removeEmptySlices";let _=p.removeTextSlice();const T=p.caret.origin;if(b==="segmented"){const N=_.origin,E=wa(N.getTextContent()).setStyle(N.getStyle()).setFormat(N.getFormat());C.replaceOrInsert(E),_=Xm(E,n,_.offset)}T.is(i[0].origin)&&(i[0]=_),T.is(o[0].origin)&&(o[0]=_.getFlipped())}}let d,f;for(const p of i)if(T6(p)){d=jc(p);break}for(const p of o)if(T6(p)){f=jc(p);break}const h=(function(p,x,v){if(!p||!x)return null;const C=p.getParentAtCaret(),b=x.getParentAtCaret();if(!C||!b)return null;const _=C.getParents().reverse();_.push(C);const T=b.getParents().reverse();T.push(b);const N=Math.min(_.length,T.length);let E;for(E=0;E<N&&_[E]===T[E];E++);const F=(M,I)=>{let U;for(let K=E;K<M.length;K++){const te=M[K];if(Qo(te))return;!U&&I(te)&&(U=te)}return U},j=F(_,Ec),P=j&&F(T,(M=>v.has(M.getKey())&&Ec(M)));return j&&P?[j,P]:null})(d,f,c);if(h){const[p,x]=h;Lc(p,"previous").splice(0,x.getChildren()),x.remove()}const g=[d,f,...i,...o].find(T6);if(g)return j0e(m1(jc(g),e.direction));rr(269,JSON.stringify(i.map((p=>p.origin.__key))))}function jc(e){const t=(function(s){let a=s;for(;dd(a);){const i=uE(a);if(!dd(i))break;a=i}return a})(e.getLatest()),{direction:r}=t;if(_r(t.origin))return Xf(t)?t:Xm(t.origin,r,r);const n=t.getAdjacentCaret();return Ym(n)&&_r(n.origin)?Xm(n.origin,r,z1(r)):t}function WG(e){return Xf(e)&&e.offset!==Jf(e.origin,e.direction)}function m1(e,t){return e.direction===t?e:e.getFlipped()}function HG(e,t){return e.direction===t?e:ch(m1(e.focus,t),m1(e.anchor,t))}function M0e(e,t,r){let n=Lc(e,"next");for(let s=0;s<t;s++){const a=n.getAdjacentCaret();if(a===null)break;n=a}return m1(n,r)}const GG=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,R0e=GG?w.useLayoutEffect:w.useEffect,zw={tag:Cv};function VG({initialConfig:e,children:t}){const r=w.useMemo((()=>{const{theme:n,namespace:s,nodes:a,onError:i,editorState:o,html:c}=e,u=tde(null,n),d=i0e({editable:e.editable,html:c,namespace:s,nodes:a,onError:f=>i(f,d),theme:n});return(function(f,h){if(h!==null){if(h===void 0)f.update((()=>{const g=Zs();if(g.isEmpty()){const p=zs();g.append(p);const x=GG?document.activeElement:null;(wr()!==null||x!==null&&x===f.getRootElement())&&p.select()}}),zw);else if(h!==null)switch(typeof h){case"string":{const g=f.parseEditorState(h);f.setEditorState(g,zw);break}case"object":f.setEditorState(h,zw);break;case"function":f.update((()=>{Zs().isEmpty()&&h(f)}),zw)}}})(d,o),[d,u]}),[]);return R0e((()=>{const n=e.editable,[s]=r;s.setEditable(n===void 0||n)}),[]),l.jsx(I1.Provider,{value:r,children:t})}const O0e=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?w.useLayoutEffect:w.useEffect;function D0e(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}function I0e(){return(function(e){const[t]=bd(),r=w.useMemo((()=>e(t)),[t,e]),[n,s]=w.useState((()=>r.initialValueFn())),a=w.useRef(n);return O0e((()=>{const{initialValueFn:i,subscribe:o}=r,c=i();return a.current!==c&&(a.current=c,s(c)),o((u=>{a.current=u,s(u)}))}),[r,e]),n})(D0e)}function L0e(){return Zs().getTextContent()}function B0e(e,t=!0){if(e)return!1;let r=L0e();return t&&(r=r.trim()),r===""}function $0e(e){if(!B0e(e,!1))return!1;const t=Zs().getChildren(),r=t.length;if(r>1)return!1;for(let n=0;n<r;n++){const s=t[n];if(Jn(s))return!1;if(Wt(s)){if(!YN(s)||s.__indent!==0)return!1;const a=s.getChildren(),i=a.length;for(let o=0;o<i;o++){const c=a[n];if(!_r(c))return!1}}}return!0}function qG(e){return()=>$0e(e)}const e8=new Map;function KG(e){const t={};if(!e)return t;const r=e.split(";");for(const n of r)if(n!==""){const[s,a]=n.split(/:([^]+)/);s&&a&&(t[s.trim()]=a.trim())}return t}function IR(e){let t=e8.get(e);return t===void 0&&(t=KG(e),e8.set(e,t)),t}function YG(e){const t=G2().getElementByKey(e.getKey());if(t===null)return null;const r=t.ownerDocument.defaultView;return r===null?null:r.getComputedStyle(t)}function XG(e){return YG(hi(e)?e:e.getParentOrThrow())}function LR(e){const t=XG(e);return t!==null&&t.direction==="rtl"}function JG(e,t){const r=e.getStartEndPoints();if(t.isSelected(e)&&!t0(t)&&r!==null){const[n,s]=r,a=e.isBackward(),i=n.getNode(),o=s.getNode(),c=t.is(i),u=t.is(o);if(c||u){const[d,f]=VT(e),h=i.is(o),g=t.is(a?o:i),p=t.is(a?i:o);let x,v=0;h?(v=d>f?f:d,x=d>f?d:f):g?(v=a?f:d,x=void 0):p&&(v=0,x=a?d:f),t.__text=t.__text.slice(v,x)}}return t}function U0e(e){const t=e.getStyle(),r=KG(t);e8.set(t,r)}function z0e(e,t){const r=e.getFormatType(),n=e.getIndent();r!==t.getFormatType()&&t.setFormat(r),n!==t.getIndent()&&t.setIndent(n)}function Zp(e,t,r=z0e){if(e===null)return;const n=e.getStartEndPoints(),s=new Map;let a=null;if(n){const[i,o]=n;a=$S(),a.anchor.set(i.key,i.offset,i.type),a.focus.set(o.key,o.offset,o.type);const c=N6(i.getNode(),Ec),u=N6(o.getNode(),Ec);Wt(c)&&s.set(c.getKey(),c),Wt(u)&&s.set(u.getKey(),u)}for(const i of e.getNodes())if(Wt(i)&&Ec(i))s.set(i.getKey(),i);else if(n===null){const o=N6(i,Ec);Wt(o)&&s.set(o.getKey(),o)}for(const[i,o]of s){const c=t();r(o,c),o.replace(c,!0),a&&(i===a.anchor.key&&a.anchor.set(c.getKey(),a.anchor.offset,a.anchor.type),i===a.focus.key&&a.focus.set(c.getKey(),a.focus.offset,a.focus.type))}a&&e.is(wr())&&io(a)}function QG(e){const t=ZG(e);return t!==null&&t.writingMode==="vertical-rl"}function ZG(e){const t=e.anchor.getNode();return Wt(t)?YG(t):XG(t)}function BR(e,t){let r=QG(e)?!t:t;eV(e)&&(r=!r);const n=N0(e.focus,r?"previous":"next");if(WG(n))return!1;for(const s of fE(n)){if(dd(s))return!s.origin.isInline();if(!Wt(s.origin)){if(Jn(s.origin))return!0;break}}return!1}function W0e(e,t,r,n){e.modify(t?"extend":"move",r,n)}function eV(e){const t=ZG(e);return t!==null&&t.direction==="rtl"}function $R(e,t,r){const n=eV(e);let s;s=QG(e)||n?!r:r,W0e(e,t,s,"character")}function N6(e,t){let r=e;for(;r!==null&&r.getParent()!==null&&!t(r);)r=r.getParentOrThrow();return t(r)?r:null}function H0e(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}const tV=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,G0e=tV&&"documentMode"in document?document.documentMode:null;!(!tV||!("InputEvent"in window)||G0e)&&"getTargetRanges"in new window.InputEvent("input");function rV(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}function mg(...e){return()=>{for(let t=e.length-1;t>=0;t--)e[t]();e.length=0}}function di(e,...t){const r=rV(...t);r.length>0&&e.classList.add(...r)}function Qf(e,...t){const r=rV(...t);r.length>0&&e.classList.remove(...r)}function V0e(e){return e?e.getAdjacentCaret():null}function q0e(e,t){let r=e;for(;r!=null;){if(r instanceof t)return r;r=r.getParent()}return null}function K0e(e){const t=qS(e,(r=>Wt(r)&&!r.isInline()));return Wt(t)||H0e(4,e.__key),t}const qS=(e,t)=>{let r=e;for(;r!==Zs()&&r!=null;){if(t(r))return r;r=r.getParent()}return null};function bm(e,t){return e!==null&&Object.getPrototypeOf(e).constructor.name===t.name}function nV(e,t){const r=[],n=Array.from(e).reverse();for(let s=n.pop();s!==void 0;s=n.pop())if(t(s))r.push(s);else if(Wt(s))for(const a of Y0e(s))n.push(a);return r}function Y0e(e){return X0e(Lc(e,"previous"))}function X0e(e){return hE({hasNext:Ym,initial:e.getAdjacentCaret(),map:t=>t.origin.getLatest(),step:t=>t.getAdjacentCaret()})}function J0e(e){const t=window.location.origin,r=n=>{if(n.origin!==t)return;const s=e.getRootElement();if(document.activeElement!==s)return;const a=n.data;if(typeof a=="string"){let i;try{i=JSON.parse(a)}catch{return}if(i&&i.protocol==="nuanria_messaging"&&i.type==="request"){const o=i.payload;if(o&&o.functionId==="makeChanges"){const c=o.args;if(c){const[u,d,f,h,g,p]=c;e.update((()=>{const x=wr();if(Jt(x)){const v=x.anchor;let C=v.getNode(),b=0,_=0;if(_r(C)&&u>=0&&d>=0&&(b=u,_=u+d,x.setTextNodeRange(C,b,C,_)),b===_&&f===""||(x.insertRawText(f),C=v.getNode()),_r(C)){b=h,_=h+g;const T=C.getTextContentSize();b=b>T?T:b,_=_>T?T:_,x.setTextNodeRange(C,b,C,_)}n.stopImmediatePropagation()}}))}}}}};return window.addEventListener("message",r,!0),()=>{window.removeEventListener("message",r,!0)}}function Q0e(e,t){const r=t.body?t.body.childNodes:[];let n=[];const s=[];for(let a=0;a<r.length;a++){const i=r[a];if(!aV.has(i.nodeName)){const o=iV(i,e,s,!1);o!==null&&(n=n.concat(o))}}return(function(a){for(const i of a)i.getNextSibling()instanceof KN&&i.insertAfter(hd());for(const i of a){const o=i.getChildren();for(const c of o)i.insertBefore(c);i.remove()}})(s),n}function Z0e(e,t){if(typeof document>"u"||typeof window>"u"&&global.window===void 0)throw new Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");const r=document.createElement("div"),n=Zs().getChildren();for(let s=0;s<n.length;s++)sV(e,n[s],r,t);return r.innerHTML}function sV(e,t,r,n=null){let s=n===null||t.isSelected(n);const a=Wt(t)&&t.excludeFromCopy("html");let i=t;if(n!==null){let g=aE(t);g=_r(g)&&n!==null?JG(n,g):g,i=g}const o=Wt(i)?i.getChildren():[],c=JN(e,i.getType());let u;u=c&&c.exportDOM!==void 0?c.exportDOM(e,i):i.exportDOM(e);const{element:d,after:f}=u;if(!d)return!1;const h=document.createDocumentFragment();for(let g=0;g<o.length;g++){const p=o[g],x=sV(e,p,h,n);!s&&Wt(t)&&x&&t.extractWithChild(p,n,"html")&&(s=!0)}if(s&&!a){if((Ws(d)||QT(d))&&d.append(h),r.append(d),f){const g=f.call(i,d);g&&(QT(d)?d.replaceChildren(g):d.replaceWith(g))}}else r.append(h);return s}const aV=new Set(["STYLE","SCRIPT"]);function iV(e,t,r,n,s=new Map,a){let i=[];if(aV.has(e.nodeName))return i;let o=null;const c=(function(p,x){const{nodeName:v}=p,C=x._htmlConversions.get(v.toLowerCase());let b=null;if(C!==void 0)for(const _ of C){const T=_(p);T!==null&&(b===null||(b.priority||0)<=(T.priority||0))&&(b=T)}return b!==null?b.conversion:null})(e,t),u=c?c(e):null;let d=null;if(u!==null){d=u.after;const p=u.node;if(o=Array.isArray(p)?p[p.length-1]:p,o!==null){for(const[,x]of s)if(o=x(o,a),!o)break;o&&i.push(...Array.isArray(p)?p:[o])}u.forChild!=null&&s.set(e.nodeName,u.forChild)}const f=e.childNodes;let h=[];const g=(o==null||!Qo(o))&&(o!=null&&qT(o)||n);for(let p=0;p<f.length;p++)h.push(...iV(f[p],t,r,g,new Map(s),o));return d!=null&&(h=d(h)),y_(e)&&(h=efe(e,h,g?()=>{const p=new KN;return r.push(p),p}:zs)),o==null?h.length>0?i=i.concat(h):y_(e)&&(function(p){return p.nextSibling==null||p.previousSibling==null?!1:ZT(p.nextSibling)&&ZT(p.previousSibling)})(e)&&(i=i.concat(hd())):Wt(o)&&o.append(...h),i}function efe(e,t,r){const n=e.style.textAlign,s=[];let a=[];for(let i=0;i<t.length;i++){const o=t[i];if(qT(o))n&&!o.getFormat()&&o.setFormat(n),s.push(o);else if(a.push(o),i===t.length-1||i<t.length-1&&qT(t[i+1])){const c=r();c.setFormat(n),c.append(...a),s.push(c),a=[]}}return s}function v_(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function tfe(e,t=wr()){return t==null&&v_(166),Jt(t)&&t.isCollapsed()||t.getNodes().length===0?"":Z0e(e,t)}function rfe(e,t=wr()){return t==null&&v_(166),Jt(t)&&t.isCollapsed()||t.getNodes().length===0?null:JSON.stringify(nfe(e,t))}function UR(e,t,r){const n=e.getData("application/x-lexical-editor");if(n)try{const o=JSON.parse(n);if(o.namespace===r._config.namespace&&Array.isArray(o.nodes))return zR(r,sfe(o.nodes),t)}catch{}const s=e.getData("text/html"),a=e.getData("text/plain");if(s&&a!==s)try{const o=new DOMParser().parseFromString((function(c){return window.trustedTypes&&window.trustedTypes.createPolicy?window.trustedTypes.createPolicy("lexical",{createHTML:u=>u}).createHTML(c):c})(s),"text/html");return zR(r,Q0e(r,o),t)}catch{}const i=a||e.getData("text/uri-list");if(i!=null)if(Jt(t)){const o=i.split(/(\r?\n|\t)/);o[o.length-1]===""&&o.pop();for(let c=0;c<o.length;c++){const u=wr();if(Jt(u)){const d=o[c];d===`
`||d===`\r
`?u.insertParagraph():d==="	"?u.insertNodes([B1()]):u.insertText(d)}}}else t.insertRawText(i)}function zR(e,t,r){e.dispatchCommand(Ede,{nodes:t,selection:r})||(r.insertNodes(t),(function(n){if(Jt(n)&&n.isCollapsed()){const s=n.anchor;let a=null;const i=N0(s,"previous");if(i)if(Xf(i))a=i.origin;else{const o=ch(i,Lc(Zs(),"next").getFlipped());for(const c of o){if(_r(c.origin)){a=c.origin;break}if(Wt(c.origin)&&!c.origin.isInline())break}}if(a&&_r(a)){const o=a.getFormat(),c=a.getStyle();n.format===o&&n.style===c||(n.format=o,n.style=c,n.dirty=!0)}}})(r))}function oV(e,t,r,n=[]){let s=t===null||r.isSelected(t);const a=Wt(r)&&r.excludeFromCopy("html");let i=r;if(t!==null){let u=aE(r);u=_r(u)&&t!==null?JG(t,u):u,i=u}const o=Wt(i)?i.getChildren():[],c=(function(u){const d=u.exportJSON(),f=u.constructor;if(d.type!==f.getType()&&v_(58,f.name),Wt(u)){const h=d.children;Array.isArray(h)||v_(59,f.name)}return d})(i);if(_r(i)){const u=i.__text;u.length>0?c.text=u:s=!1}for(let u=0;u<o.length;u++){const d=o[u],f=oV(e,t,d,c.children);!s&&Wt(r)&&f&&r.extractWithChild(d,t,"clone")&&(s=!0)}if(s&&!a)n.push(c);else if(Array.isArray(c.children))for(let u=0;u<c.children.length;u++){const d=c.children[u];n.push(d)}return s}function nfe(e,t){const r=[],n=Zs().getChildren();for(let s=0;s<n.length;s++)oV(e,t,n[s],r);return{namespace:e._config.namespace,nodes:r}}function sfe(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r],s=Zde(n);_r(s)&&U0e(s),t.push(s)}return t}let _p=null;async function WR(e,t,r){if(_p!==null)return!1;if(t!==null)return new Promise(((u,d)=>{e.update((()=>{u(HR(e,t,r))}))}));const n=e.getRootElement(),s=e._window||window,a=window.document,i=wu(s);if(n===null||i===null)return!1;const o=a.createElement("span");o.style.cssText="position: fixed; top: -1000px;",o.append(a.createTextNode("#")),n.append(o);const c=new Range;return c.setStart(o,0),c.setEnd(o,1),i.removeAllRanges(),i.addRange(c),new Promise(((u,d)=>{const f=e.registerCommand(IS,(h=>(bm(h,ClipboardEvent)&&(f(),_p!==null&&(window.clearTimeout(_p),_p=null),u(HR(e,h,r))),!0)),a0e);_p=window.setTimeout((()=>{f(),_p=null,u(!1)}),50),a.execCommand("copy"),o.remove()}))}function HR(e,t,r){if(r===void 0){const s=wu(e._window);if(!s)return!1;const a=s.anchorNode,i=s.focusNode;if(a!==null&&i!==null&&!W2(e,a,i))return!1;const o=wr();if(o===null)return!1;r=ife(o)}t.preventDefault();const n=t.clipboardData;return n!==null&&(ofe(n,r),!0)}const afe=[["text/html",tfe],["application/x-lexical-editor",rfe]];function ife(e=wr()){const t={"text/plain":e?e.getTextContent():""};if(e){const r=G2();for(const[n,s]of afe){const a=s(r,e);a!==null&&(t[n]=a)}}return t}function ofe(e,t){for(const r in t){const n=t[r];n!==void 0&&e.setData(r,n)}}function GR(e,t){if(document.caretRangeFromPoint!==void 0){const r=document.caretRangeFromPoint(e,t);return r===null?null:{node:r.startContainer,offset:r.startOffset}}if(document.caretPositionFromPoint!=="undefined"){const r=document.caretPositionFromPoint(e,t);return r===null?null:{node:r.offsetNode,offset:r.offset}}return null}const W1=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,lfe=W1&&"documentMode"in document?document.documentMode:null,cfe=!(!W1||!("InputEvent"in window)||lfe)&&"getTargetRanges"in new window.InputEvent("input"),ufe=W1&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),VR=W1&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,dfe=W1&&/^(?=.*Chrome).*/i.test(navigator.userAgent),ffe=W1&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!dfe,qR=ln("DRAG_DROP_PASTE_FILE");let V2=class lV extends Ao{static getType(){return"quote"}static clone(t){return new lV(t.__key)}createDOM(t){const r=document.createElement("blockquote");return di(r,t.theme.quote),r}updateDOM(t,r){return!1}static importDOM(){return{blockquote:t=>({conversion:hfe,priority:0})}}exportDOM(t){const{element:r}=super.exportDOM(t);if(Ws(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return q2().updateFromJSON(t)}insertNewAfter(t,r){const n=zs(),s=this.getDirection();return n.setDirection(s),this.insertAfter(n,r),n}collapseAtStart(){const t=zs();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}canMergeWhenEmpty(){return!0}};function q2(){return rl(new V2)}function KR(e){return e instanceof V2}let K2=class cV extends Ao{static getType(){return"heading"}static clone(t){return new cV(t.__tag,t.__key)}constructor(t,r){super(r),this.__tag=t}getTag(){return this.__tag}setTag(t){const r=this.getWritable();return this.__tag=t,r}createDOM(t){const r=this.__tag,n=document.createElement(r),s=t.theme.heading;if(s!==void 0){const a=s[r];di(n,a)}return n}updateDOM(t,r,n){return t.__tag!==this.__tag}static importDOM(){return{h1:t=>({conversion:Sp,priority:0}),h2:t=>({conversion:Sp,priority:0}),h3:t=>({conversion:Sp,priority:0}),h4:t=>({conversion:Sp,priority:0}),h5:t=>({conversion:Sp,priority:0}),h6:t=>({conversion:Sp,priority:0}),p:t=>{const r=t.firstChild;return r!==null&&YR(r)?{conversion:()=>({node:null}),priority:3}:null},span:t=>YR(t)?{conversion:r=>({node:Hf("h1")}),priority:3}:null}}exportDOM(t){const{element:r}=super.exportDOM(t);if(Ws(r)){this.isEmpty()&&r.append(document.createElement("br"));const n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();s&&(r.dir=s)}return{element:r}}static importJSON(t){return Hf(t.tag).updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setTag(t.tag)}exportJSON(){return{...super.exportJSON(),tag:this.getTag()}}insertNewAfter(t,r=!0){const n=t?t.anchor.offset:0,s=this.getLastDescendant(),a=!s||t&&t.anchor.key===s.getKey()&&n===s.getTextContentSize()||!t?zs():Hf(this.getTag()),i=this.getDirection();if(a.setDirection(i),this.insertAfter(a,r),n===0&&!this.isEmpty()&&t){const o=zs();o.select(),this.replace(o,!0)}return a}collapseAtStart(){const t=this.isEmpty()?zs():Hf(this.getTag());return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}extractWithChild(){return!0}};function YR(e){return e.nodeName.toLowerCase()==="span"&&e.style.fontSize==="26pt"}function Sp(e){const t=e.nodeName.toLowerCase();let r=null;return t!=="h1"&&t!=="h2"&&t!=="h3"&&t!=="h4"&&t!=="h5"&&t!=="h6"||(r=Hf(t),e.style!==null&&(iE(e,r),r.setFormat(e.style.textAlign))),{node:r}}function hfe(e){const t=q2();return e.style!==null&&(t.setFormat(e.style.textAlign),iE(e,t)),{node:t}}function Hf(e="h1"){return rl(new K2(e))}function mfe(e){return e instanceof K2}function Ww(e){let t=null;if(bm(e,DragEvent)?t=e.dataTransfer:bm(e,ClipboardEvent)&&(t=e.clipboardData),t===null)return[!1,[],!1];const r=t.types,n=r.includes("Files"),s=r.includes("text/html")||r.includes("text/plain");return[n,Array.from(t.files),s]}function XR(e){const t=wr();if(!Jt(t))return!1;const r=new Set,n=t.getNodes();for(let s=0;s<n.length;s++){const a=n[s],i=a.getKey();if(r.has(i))continue;const o=qS(a,(u=>Wt(u)&&!u.isInline()));if(o===null)continue;const c=o.getKey();o.canIndent()&&!r.has(c)&&(r.add(c),e(o))}return r.size>0}function JR(e){const t=lh(e);return Jn(t)}function E6(e){for(const t of["lowercase","uppercase","capitalize"])e.hasFormat(t)&&e.toggleFormat(t)}function gfe(e){return mg(e.registerCommand(IN,(t=>{const r=wr();return!!xo(r)&&(r.clear(),!0)}),zn),e.registerCommand(Am,(t=>{const r=wr();return Jt(r)?(r.deleteCharacter(t),!0):!!xo(r)&&(r.deleteNodes(),!0)}),zn),e.registerCommand(Qv,(t=>{const r=wr();return!!Jt(r)&&(r.deleteWord(t),!0)}),zn),e.registerCommand(Zv,(t=>{const r=wr();return!!Jt(r)&&(r.deleteLine(t),!0)}),zn),e.registerCommand(Xp,(t=>{const r=wr();if(typeof t=="string")r!==null&&r.insertText(t);else{if(r===null)return!1;const n=t.dataTransfer;if(n!=null)UR(n,r,e);else if(Jt(r)){const s=t.data;return s&&r.insertText(s),!0}}return!0}),zn),e.registerCommand(BT,(()=>{const t=wr();return!!Jt(t)&&(t.removeText(),!0)}),zn),e.registerCommand(To,(t=>{const r=wr();return!!Jt(r)&&(r.formatText(t),!0)}),zn),e.registerCommand(aG,(t=>{const r=wr();if(!Jt(r)&&!xo(r))return!1;const n=r.getNodes();for(const s of n){const a=qS(s,(i=>Wt(i)&&!i.isInline()));a!==null&&a.setFormat(t)}return!0}),zn),e.registerCommand(Yp,(t=>{const r=wr();return!!Jt(r)&&(r.insertLineBreak(t),!0)}),zn),e.registerCommand(Jv,(()=>{const t=wr();return!!Jt(t)&&(t.insertParagraph(),!0)}),zn),e.registerCommand(Fde,(()=>(Xde([B1()]),!0)),zn),e.registerCommand(Mde,(()=>XR((t=>{const r=t.getIndent();t.setIndent(r+1)}))),zn),e.registerCommand(eR,(()=>XR((t=>{const r=t.getIndent();r>0&&t.setIndent(Math.max(0,r-1))}))),zn),e.registerCommand(JH,(t=>{const r=wr();if(xo(r)){const n=r.getNodes();if(n.length>0)return n[0].selectPrevious(),!0}else if(Jt(r)){const n=YT(r.focus,!0);if(!t.shiftKey&&Jn(n)&&!n.isIsolated()&&!n.isInline())return n.selectPrevious(),t.preventDefault(),!0}return!1}),zn),e.registerCommand(QH,(t=>{const r=wr();if(xo(r)){const n=r.getNodes();if(n.length>0)return n[0].selectNext(0,0),!0}else if(Jt(r)){if((function(s){const a=s.focus;return a.key==="root"&&a.offset===Zs().getChildrenSize()})(r))return t.preventDefault(),!0;const n=YT(r.focus,!1);if(!t.shiftKey&&Jn(n)&&!n.isIsolated()&&!n.isInline())return n.selectNext(),t.preventDefault(),!0}return!1}),zn),e.registerCommand(XH,(t=>{const r=wr();if(xo(r)){const n=r.getNodes();if(n.length>0)return t.preventDefault(),LR(n[0])?n[0].selectNext(0,0):n[0].selectPrevious(),!0}if(!Jt(r))return!1;if(BR(r,!0)){const n=t.shiftKey;return t.preventDefault(),$R(r,n,!0),!0}return!1}),zn),e.registerCommand(YH,(t=>{const r=wr();if(xo(r)){const s=r.getNodes();if(s.length>0)return t.preventDefault(),LR(s[0])?s[0].selectPrevious():s[0].selectNext(0,0),!0}if(!Jt(r))return!1;const n=t.shiftKey;return!!BR(r,!1)&&(t.preventDefault(),$R(r,n,!1),!0)}),zn),e.registerCommand(eG,(t=>{if(JR(t.target))return!1;const r=wr();if(Jt(r)){if((function(n){if(!n.isCollapsed())return!1;const{anchor:s}=n;if(s.offset!==0)return!1;const a=s.getNode();if(hi(a))return!1;const i=K0e(a);return i.getIndent()>0&&(i.is(a)||a.is(i.getFirstDescendant()))})(r))return t.preventDefault(),e.dispatchCommand(eR,void 0);if(VR&&navigator.language==="ko-KR")return!1}else if(!xo(r))return!1;return t.preventDefault(),e.dispatchCommand(Am,!0)}),zn),e.registerCommand(rG,(t=>{if(JR(t.target))return!1;const r=wr();return!(!Jt(r)&&!xo(r))&&(t.preventDefault(),e.dispatchCommand(Am,!1))}),zn),e.registerCommand(d_,(t=>{const r=wr();if(!Jt(r))return!1;if(E6(r),t!==null){if((VR||ufe||ffe)&&cfe)return!1;if(t.preventDefault(),t.shiftKey)return e.dispatchCommand(Yp,!1)}return e.dispatchCommand(Jv,void 0)}),zn),e.registerCommand(tG,(()=>{const t=wr();return!!Jt(t)&&(e.blur(),!0)}),zn),e.registerCommand(sG,(t=>{const[,r]=Ww(t);if(r.length>0){const s=GR(t.clientX,t.clientY);if(s!==null){const{offset:a,node:i}=s,o=lh(i);if(o!==null){const c=$S();if(_r(o))c.anchor.set(o.getKey(),a,"text"),c.focus.set(o.getKey(),a,"text");else{const d=o.getParentOrThrow().getKey(),f=o.getIndexWithinParent()+1;c.anchor.set(d,f,"element"),c.focus.set(d,f,"element")}const u=i_(c);io(u)}e.dispatchCommand(qR,r)}return t.preventDefault(),!0}const n=wr();return!!Jt(n)}),zn),e.registerCommand(iG,(t=>{const[r]=Ww(t),n=wr();return!(r&&!Jt(n))}),zn),e.registerCommand(oG,(t=>{const[r]=Ww(t),n=wr();if(r&&!Jt(n))return!1;const s=GR(t.clientX,t.clientY);if(s!==null){const a=lh(s.node);Jn(a)&&t.preventDefault()}return!0}),zn),e.registerCommand($T,(()=>(f0e(),!0)),zn),e.registerCommand(IS,(t=>(WR(e,bm(t,ClipboardEvent)?t:null),!0)),zn),e.registerCommand(UN,(t=>((async function(r,n){await WR(n,bm(r,ClipboardEvent)?r:null),n.update((()=>{const s=wr();Jt(s)?s.removeText():xo(s)&&s.getNodes().forEach((a=>a.remove()))}))})(t,e),!0)),zn),e.registerCommand(LN,(t=>{const[,r,n]=Ww(t);return r.length>0&&!n?(e.dispatchCommand(qR,r),!0):U1(t.target)&&QN(t.target)?!1:wr()!==null&&((function(s,a){s.preventDefault(),a.update((()=>{const i=wr(),o=bm(s,InputEvent)||bm(s,KeyboardEvent)?null:s.clipboardData;o!=null&&i!==null&&UR(o,i,a)}),{tag:t0e})})(t,e),!0)}),zn),e.registerCommand(ZH,(t=>{const r=wr();return Jt(r)&&E6(r),!1}),zn),e.registerCommand(nG,(t=>{const r=wr();return Jt(r)&&E6(r),!1}),zn))}const t8=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?w.useLayoutEffect:w.useEffect;function QR(e){return e.getEditorState().read(qG(e.isComposing()))}function uV({contentEditable:e,placeholder:t=null,ErrorBoundary:r}){const[n]=bd(),s=(function(a,i){const[o,c]=w.useState((()=>a.getDecorators()));return t8((()=>a.registerDecoratorListener((u=>{GC.flushSync((()=>{c(u)}))}))),[a]),w.useEffect((()=>{c(a.getDecorators())}),[a]),w.useMemo((()=>{const u=[],d=Object.keys(o);for(let f=0;f<d.length;f++){const h=d[f],g=l.jsx(i,{onError:x=>a._onError(x),children:l.jsx(w.Suspense,{fallback:null,children:o[h]})}),p=a.getElementByKey(h);p!==null&&u.push(GC.createPortal(g,p,h))}return u}),[i,o,a])})(n,r);return(function(a){t8((()=>mg(gfe(a),J0e(a))),[a])})(n),l.jsxs(l.Fragment,{children:[e,l.jsx(pfe,{content:t}),s]})}function pfe({content:e}){const[t]=bd(),r=(function(s){const[a,i]=w.useState((()=>QR(s)));return t8((()=>{function o(){const c=QR(s);i(c)}return o(),mg(s.registerUpdateListener((()=>{o()})),s.registerEditableListener((()=>{o()})))}),[s]),a})(t),n=I0e();return r?typeof e=="function"?e(n):e:null}const dV=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0?w.useLayoutEffect:w.useEffect;function xfe({editor:e,ariaActiveDescendant:t,ariaAutoComplete:r,ariaControls:n,ariaDescribedBy:s,ariaErrorMessage:a,ariaExpanded:i,ariaInvalid:o,ariaLabel:c,ariaLabelledBy:u,ariaMultiline:d,ariaOwns:f,ariaRequired:h,autoCapitalize:g,className:p,id:x,role:v="textbox",spellCheck:C=!0,style:b,tabIndex:_,"data-testid":T,...N},E){const[F,j]=w.useState(e.isEditable()),P=w.useCallback((I=>{I&&I.ownerDocument&&I.ownerDocument.defaultView?e.setRootElement(I):e.setRootElement(null)}),[e]),M=w.useMemo((()=>(function(...I){return U=>{I.forEach((K=>{typeof K=="function"?K(U):K!=null&&(K.current=U)}))}})(E,P)),[P,E]);return dV((()=>(j(e.isEditable()),e.registerEditableListener((I=>{j(I)})))),[e]),l.jsx("div",{"aria-activedescendant":F?t:void 0,"aria-autocomplete":F?r:"none","aria-controls":F?n:void 0,"aria-describedby":s,...a!=null?{"aria-errormessage":a}:{},"aria-expanded":F&&v==="combobox"?!!i:void 0,...o!=null?{"aria-invalid":o}:{},"aria-label":c,"aria-labelledby":u,"aria-multiline":d,"aria-owns":F?f:void 0,"aria-readonly":!F||void 0,"aria-required":h,autoCapitalize:g,className:p,contentEditable:F,"data-testid":T,id:x,ref:M,role:v,spellCheck:C,style:b,tabIndex:_,...N})}const yfe=w.forwardRef(xfe);function ZR(e){return e.getEditorState().read(qG(e.isComposing()))}const fV=w.forwardRef(vfe);function vfe(e,t){const{placeholder:r,...n}=e,[s]=bd();return l.jsxs(l.Fragment,{children:[l.jsx(yfe,{editor:s,...n,ref:t}),r!=null&&l.jsx(bfe,{editor:s,content:r})]})}function bfe({content:e,editor:t}){const r=(function(i){const[o,c]=w.useState((()=>ZR(i)));return dV((()=>{function u(){const d=ZR(i);c(d)}return u(),mg(i.registerUpdateListener((()=>{u()})),i.registerEditableListener((()=>{u()})))}),[i]),o})(t),[n,s]=w.useState(t.isEditable());if(w.useLayoutEffect((()=>(s(t.isEditable()),t.registerEditableListener((i=>{s(i)})))),[t]),!r)return null;let a=null;return typeof e=="function"?a=e(n):e!==null&&(a=e),a===null?null:l.jsx("div",{"aria-hidden":!0,children:a})}const Hw=0,r8=1,n8=2,du=0,wfe=1,eO=2,_fe=3,Sfe=4;function kfe(e,t,r,n,s){if(e===null||r.size===0&&n.size===0&&!s)return du;const a=t._selection,i=e._selection;if(s)return wfe;if(!(Jt(a)&&Jt(i)&&i.isCollapsed()&&a.isCollapsed()))return du;const o=(function(C,b,_){const T=C._nodeMap,N=[];for(const E of b){const F=T.get(E);F!==void 0&&N.push(F)}for(const[E,F]of _){if(!F)continue;const j=T.get(E);j===void 0||hi(j)||N.push(j)}return N})(t,r,n);if(o.length===0)return du;if(o.length>1){const C=t._nodeMap,b=C.get(a.anchor.key),_=C.get(i.anchor.key);return b&&_&&!e._nodeMap.has(b.__key)&&_r(b)&&b.__text.length===1&&a.anchor.offset===1?eO:du}const c=o[0],u=e._nodeMap.get(c.__key);if(!_r(u)||!_r(c)||u.__mode!==c.__mode)return du;const d=u.__text,f=c.__text;if(d===f)return du;const h=a.anchor,g=i.anchor;if(h.key!==g.key||h.type!=="text")return du;const p=h.offset,x=g.offset,v=f.length-d.length;return v===1&&x===p-1?eO:v===-1&&x===p+1?_fe:v===-1&&x===p?Sfe:du}function Cfe(e,t){let r=Date.now(),n=du;return(s,a,i,o,c,u)=>{const d=Date.now();if(u.has(g_))return n=du,r=d,n8;const f=kfe(s,a,o,c,e.isComposing()),h=(()=>{const g=i===null||i.editor===e,p=u.has(e0e);if(!p&&g&&u.has(Cv))return Hw;if(s===null)return r8;const x=a._selection;return o.size>0||c.size>0?p===!1&&f!==du&&f===n&&d<r+t&&g||o.size===1&&(function(v,C,b){const _=C._nodeMap.get(v),T=b._nodeMap.get(v),N=C._selection,E=b._selection;return!(Jt(N)&&Jt(E)&&N.anchor.type==="element"&&N.focus.type==="element"&&E.anchor.type==="text"&&E.focus.type==="text"||!_r(_)||!_r(T)||_.__parent!==T.__parent)&&JSON.stringify(C.read((()=>_.exportJSON())))===JSON.stringify(b.read((()=>T.exportJSON())))})(Array.from(o)[0],s,a)?Hw:r8:x!==null?Hw:n8})();return r=d,n=f,h}}function tO(e){e.undoStack=[],e.redoStack=[],e.current=null}function Tfe(e,t,r){const n=Cfe(e,r);return mg(e.registerCommand(BN,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(c.length!==0){const u=i.current,d=c.pop();u!==null&&(o.push(u),a.dispatchCommand(Ow,!0)),c.length===0&&a.dispatchCommand(Dw,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:g_})}})(e,t),!0)),zn),e.registerCommand($N,(()=>((function(a,i){const o=i.redoStack,c=i.undoStack;if(o.length!==0){const u=i.current;u!==null&&(c.push(u),a.dispatchCommand(Dw,!0));const d=o.pop();o.length===0&&a.dispatchCommand(Ow,!1),i.current=d||null,d&&d.editor.setEditorState(d.editorState,{tag:g_})}})(e,t),!0)),zn),e.registerCommand(Ode,(()=>(tO(t),!1)),zn),e.registerCommand(Dde,(()=>(tO(t),e.dispatchCommand(Ow,!1),e.dispatchCommand(Dw,!1),!0)),zn),e.registerUpdateListener((({editorState:a,prevEditorState:i,dirtyLeaves:o,dirtyElements:c,tags:u})=>{const d=t.current,f=t.redoStack,h=t.undoStack,g=d===null?null:d.editorState;if(d!==null&&a===g)return;const p=n(i,a,d,o,c,u);if(p===r8)f.length!==0&&(t.redoStack=[],e.dispatchCommand(Ow,!1)),d!==null&&(h.push({...d}),e.dispatchCommand(Dw,!0));else if(p===n8)return;t.current={editor:e,editorState:a}})))}function Nfe(){return{current:null,redoStack:[],undoStack:[]}}function hV({delay:e,externalHistoryState:t}){const[r]=bd();return(function(n,s,a=1e3){const i=w.useMemo((()=>s||Nfe()),[s]);w.useEffect((()=>Tfe(n,i,a)),[a,n,i])})(r,t,e),null}function mV({defaultSelection:e}){const[t]=bd();return w.useEffect((()=>{t.focus((()=>{const r=document.activeElement,n=t.getRootElement();n===null||r!==null&&n.contains(r)||n.focus({preventScroll:!0})}),{defaultSelection:e})}),[e,t]),null}function s8(e,t){return s8=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},s8(e,t)}var rO={error:null},Efe=(function(e){var t,r;function n(){for(var a,i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];return(a=e.call.apply(e,[this].concat(o))||this).state=rO,a.resetErrorBoundary=function(){for(var u,d=arguments.length,f=new Array(d),h=0;h<d;h++)f[h]=arguments[h];a.props.onReset==null||(u=a.props).onReset.apply(u,f),a.reset()},a}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,s8(t,r),n.getDerivedStateFromError=function(a){return{error:a}};var s=n.prototype;return s.reset=function(){this.setState(rO)},s.componentDidCatch=function(a,i){var o,c;(o=(c=this.props).onError)==null||o.call(c,a,i)},s.componentDidUpdate=function(a,i){var o,c,u,d,f=this.state.error,h=this.props.resetKeys;f!==null&&i.error!==null&&((u=a.resetKeys)===void 0&&(u=[]),(d=h)===void 0&&(d=[]),u.length!==d.length||u.some((function(g,p){return!Object.is(g,d[p])})))&&((o=(c=this.props).onResetKeysChange)==null||o.call(c,a.resetKeys,h),this.reset())},s.render=function(){var a=this.state.error,i=this.props,o=i.fallbackRender,c=i.FallbackComponent,u=i.fallback;if(a!==null){var d={error:a,resetErrorBoundary:this.resetErrorBoundary};if(w.isValidElement(u))return u;if(typeof o=="function")return o(d);if(c)return w.createElement(c,d);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},n})(w.Component);function gV({children:e,onError:t}){return l.jsx(Efe,{fallback:l.jsx("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"},children:"An error was thrown."}),onError:t,children:e})}const gE=/^(\d+(?:\.\d+)?)px$/,e1={BOTH:3,NO_STATUS:0,ROW:1};class H1 extends Ao{static getType(){return"tablecell"}static clone(t){return new H1(t.__headerState,t.__colSpan,t.__width,t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__rowSpan=t.__rowSpan,this.__backgroundColor=t.__backgroundColor,this.__verticalAlign=t.__verticalAlign}static importDOM(){return{td:t=>({conversion:nO,priority:0}),th:t=>({conversion:nO,priority:0})}}static importJSON(t){return pV().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeaderStyles(t.headerState).setColSpan(t.colSpan||1).setRowSpan(t.rowSpan||1).setWidth(t.width||void 0).setBackgroundColor(t.backgroundColor||null).setVerticalAlign(t.verticalAlign||void 0)}constructor(t=e1.NO_STATUS,r=1,n,s){super(s),this.__colSpan=r,this.__rowSpan=1,this.__headerState=t,this.__width=n,this.__backgroundColor=null,this.__verticalAlign=void 0}createDOM(t){const r=document.createElement(this.getTag());return this.__width&&(r.style.width=`${this.__width}px`),this.__colSpan>1&&(r.colSpan=this.__colSpan),this.__rowSpan>1&&(r.rowSpan=this.__rowSpan),this.__backgroundColor!==null&&(r.style.backgroundColor=this.__backgroundColor),a8(this.__verticalAlign)&&(r.style.verticalAlign=this.__verticalAlign),di(r,t.theme.tableCell,this.hasHeader()&&t.theme.tableCellHeader),r}exportDOM(t){const r=super.exportDOM(t);if(Ws(r.element)){const n=r.element;n.setAttribute("data-temporary-table-cell-lexical-key",this.getKey()),n.style.border="1px solid black",this.__colSpan>1&&(n.colSpan=this.__colSpan),this.__rowSpan>1&&(n.rowSpan=this.__rowSpan),n.style.width=`${this.getWidth()||75}px`,n.style.verticalAlign=this.getVerticalAlign()||"top",n.style.textAlign="start",this.__backgroundColor===null&&this.hasHeader()&&(n.style.backgroundColor="#f2f3f5")}return r}exportJSON(){return{...super.exportJSON(),...a8(this.__verticalAlign)&&{verticalAlign:this.__verticalAlign},backgroundColor:this.getBackgroundColor(),colSpan:this.__colSpan,headerState:this.__headerState,rowSpan:this.__rowSpan,width:this.getWidth()}}getColSpan(){return this.getLatest().__colSpan}setColSpan(t){const r=this.getWritable();return r.__colSpan=t,r}getRowSpan(){return this.getLatest().__rowSpan}setRowSpan(t){const r=this.getWritable();return r.__rowSpan=t,r}getTag(){return this.hasHeader()?"th":"td"}setHeaderStyles(t,r=e1.BOTH){const n=this.getWritable();return n.__headerState=t&r|n.__headerState&~r,n}getHeaderStyles(){return this.getLatest().__headerState}setWidth(t){const r=this.getWritable();return r.__width=t,r}getWidth(){return this.getLatest().__width}getBackgroundColor(){return this.getLatest().__backgroundColor}setBackgroundColor(t){const r=this.getWritable();return r.__backgroundColor=t,r}getVerticalAlign(){return this.getLatest().__verticalAlign}setVerticalAlign(t){const r=this.getWritable();return r.__verticalAlign=t||void 0,r}toggleHeaderStyle(t){const r=this.getWritable();return(r.__headerState&t)===t?r.__headerState-=t:r.__headerState+=t,r}hasHeaderState(t){return(this.getHeaderStyles()&t)===t}hasHeader(){return this.getLatest().__headerState!==e1.NO_STATUS}updateDOM(t){return t.__headerState!==this.__headerState||t.__width!==this.__width||t.__colSpan!==this.__colSpan||t.__rowSpan!==this.__rowSpan||t.__backgroundColor!==this.__backgroundColor||t.__verticalAlign!==this.__verticalAlign}isShadowRoot(){return!0}collapseAtStart(){return!0}canBeEmpty(){return!1}canIndent(){return!1}}function a8(e){return e==="middle"||e==="bottom"}function nO(e){const t=e,r=e.nodeName.toLowerCase();let n;gE.test(t.style.width)&&(n=parseFloat(t.style.width));const s=pV(r==="th"?e1.ROW:e1.NO_STATUS,t.colSpan,n);s.__rowSpan=t.rowSpan;const a=t.style.backgroundColor;a!==""&&(s.__backgroundColor=a);const i=t.style.verticalAlign;a8(i)&&(s.__verticalAlign=i);const o=t.style,c=(o&&o.textDecoration||"").split(" "),u=o.fontWeight==="700"||o.fontWeight==="bold",d=c.includes("line-through"),f=o.fontStyle==="italic",h=c.includes("underline");return{after:g=>{const p=[];let x=null;const v=()=>{if(x){const C=x.getFirstChild();g0(C)&&x.getChildrenSize()===1&&C.remove()}};for(const C of g)g0e(C)||_r(C)||g0(C)?(_r(C)&&(u&&C.toggleFormat("bold"),d&&C.toggleFormat("strikethrough"),f&&C.toggleFormat("italic"),h&&C.toggleFormat("underline")),x?x.append(C):(x=zs().append(C),p.push(x))):(p.push(C),v(),x=null);return v(),p.length===0&&p.push(zs()),p},node:s}}function pV(e=e1.NO_STATUS,t=1,r){return rl(new H1(e,t,r))}function t2(e){return e instanceof H1}function i8(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}class G1 extends Ao{static getType(){return"tablerow"}static clone(t){return new G1(t.__height,t.__key)}static importDOM(){return{tr:t=>({conversion:Afe,priority:0})}}static importJSON(t){return xV().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHeight(t.height)}constructor(t,r){super(r),this.__height=t}exportJSON(){const t=this.getHeight();return{...super.exportJSON(),...t===void 0?void 0:{height:t}}}createDOM(t){const r=document.createElement("tr");return this.__height&&(r.style.height=`${this.__height}px`),di(r,t.theme.tableRow),r}extractWithChild(t,r,n){return n==="html"}isShadowRoot(){return!0}setHeight(t){const r=this.getWritable();return r.__height=t,r}getHeight(){return this.getLatest().__height}updateDOM(t){return t.__height!==this.__height}canBeEmpty(){return!1}canIndent(){return!1}}function Afe(e){const t=e;let r;return gE.test(t.style.height)&&(r=parseFloat(t.style.height)),{after:n=>nV(n,t2),node:xV(r)}}function xV(e){return rl(new G1(e))}function yV(e){return e instanceof G1}const vV=typeof window<"u"&&window.document!==void 0&&window.document.createElement!==void 0,jfe=vV&&"documentMode"in document?document.documentMode:null;vV&&"InputEvent"in window&&!jfe&&new window.InputEvent("input");function Pfe(e,t,r){const n=[];let s=null,a=null;function i(c){let u=n[c];return u===void 0&&(n[c]=u=[]),u}const o=e.getChildren();for(let c=0;c<o.length;c++){const u=o[c];yV(u)||i8(209);const d=i(c);for(let f=u.getFirstChild(),h=0;f!=null;f=f.getNextSibling()){for(t2(f)||i8(147);d[h]!==void 0;)h++;const g={cell:f,startColumn:h,startRow:c},{__rowSpan:p,__colSpan:x}=f;for(let v=0;v<p&&!(c+v>=o.length);v++){const C=i(c+v);for(let b=0;b<x;b++)C[h+b]=g}}}return[n,s,a]}function Vy(e){return Ws(e)&&e.nodeName==="TABLE"}function Ffe(e,t){for(let r=t,n=null;r!==null;r=r.getParent()){if(e.is(r))return n;t2(r)&&(n=r)}return null}function Mfe(e,t,r){return Ffe(e,lh(t,r))}function sO(e,t,r){if(!t.theme.tableAlignment)return;const n=[],s=[];for(const a of["center","right"]){const i=t.theme.tableAlignment[a];i&&(a===r?s:n).push(i)}Qf(e,...n),di(e,...s)}const Rfe=new WeakSet;function aO(e=G2()){return Rfe.has(e)}class Y2 extends Ao{static getType(){return"table"}getColWidths(){return this.getLatest().__colWidths}setColWidths(t){const r=this.getWritable();return r.__colWidths=t,r}static clone(t){return new Y2(t.__key)}afterCloneFrom(t){super.afterCloneFrom(t),this.__colWidths=t.__colWidths,this.__rowStriping=t.__rowStriping,this.__frozenColumnCount=t.__frozenColumnCount,this.__frozenRowCount=t.__frozenRowCount}static importDOM(){return{table:t=>({conversion:Ofe,priority:1})}}static importJSON(t){return bV().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setRowStriping(t.rowStriping||!1).setFrozenColumns(t.frozenColumnCount||0).setFrozenRows(t.frozenRowCount||0).setColWidths(t.colWidths)}constructor(t){super(t),this.__rowStriping=!1,this.__frozenColumnCount=0,this.__frozenRowCount=0}exportJSON(){return{...super.exportJSON(),colWidths:this.getColWidths(),frozenColumnCount:this.__frozenColumnCount?this.__frozenColumnCount:void 0,frozenRowCount:this.__frozenRowCount?this.__frozenRowCount:void 0,rowStriping:this.__rowStriping?this.__rowStriping:void 0}}extractWithChild(t,r,n){return n==="html"}getDOMSlot(t){const r=Vy(t)?t:t.querySelector("table");return Vy(r)||i8(229),super.getDOMSlot(t).withElement(r).withAfter(r.querySelector("colgroup"))}createDOM(t,r){const n=document.createElement("table");this.__style&&(n.style.cssText=this.__style);const s=document.createElement("colgroup");if(n.appendChild(s),b0e(s),di(n,t.theme.table),this.updateTableElement(null,n,t),aO(r)){const a=document.createElement("div"),i=t.theme.tableScrollableWrapper;return i?di(a,i):a.style.cssText="overflow-x: auto;",a.appendChild(n),this.updateTableWrapper(null,a,n,t),a}return n}updateTableWrapper(t,r,n,s){this.__frozenColumnCount!==(t?t.__frozenColumnCount:0)&&(function(a,i,o,c){c>0?(di(a,o.theme.tableFrozenColumn),i.setAttribute("data-lexical-frozen-column","true")):(Qf(a,o.theme.tableFrozenColumn),i.removeAttribute("data-lexical-frozen-column"))})(r,n,s,this.__frozenColumnCount),this.__frozenRowCount!==(t?t.__frozenRowCount:0)&&(function(a,i,o,c){c>0?(di(a,o.theme.tableFrozenRow),i.setAttribute("data-lexical-frozen-row","true")):(Qf(a,o.theme.tableFrozenRow),i.removeAttribute("data-lexical-frozen-row"))})(r,n,s,this.__frozenRowCount)}updateTableElement(t,r,n){this.__style!==(t?t.__style:"")&&(r.style.cssText=this.__style),this.__rowStriping!==(!!t&&t.__rowStriping)&&(function(s,a,i){i?(di(s,a.theme.tableRowStriping),s.setAttribute("data-lexical-row-striping","true")):(Qf(s,a.theme.tableRowStriping),s.removeAttribute("data-lexical-row-striping"))})(r,n,this.__rowStriping),(function(s,a,i,o){const c=s.querySelector("colgroup");if(!c)return;const u=[];for(let d=0;d<i;d++){const f=document.createElement("col"),h=o&&o[d];h&&(f.style.width=`${h}px`),u.push(f)}c.replaceChildren(...u)})(r,0,this.getColumnCount(),this.getColWidths()),sO(r,n,this.getFormatType())}updateDOM(t,r,n){const s=this.getDOMSlot(r).element;return r===s===aO()||(Ws(a=r)&&a.nodeName==="DIV"&&this.updateTableWrapper(t,r,s,n),this.updateTableElement(t,s,n),!1);var a}exportDOM(t){const r=super.exportDOM(t),{element:n}=r;return{after:s=>{if(r.after&&(s=r.after(s)),!Vy(s)&&Ws(s)&&(s=s.querySelector("table")),!Vy(s))return null;sO(s,t._config,this.getFormatType());const[a]=Pfe(this),i=new Map;for(const d of a)for(const f of d){const h=f.cell.getKey();i.has(h)||i.set(h,{colSpan:f.cell.getColSpan(),startColumn:f.startColumn})}const o=new Set;for(const d of s.querySelectorAll(":scope > tr > [data-temporary-table-cell-lexical-key]")){const f=d.getAttribute("data-temporary-table-cell-lexical-key");if(f){const h=i.get(f);if(d.removeAttribute("data-temporary-table-cell-lexical-key"),h){i.delete(f);for(let g=0;g<h.colSpan;g++)o.add(g+h.startColumn)}}}const c=s.querySelector(":scope > colgroup");if(c){const d=Array.from(s.querySelectorAll(":scope > colgroup > col")).filter(((f,h)=>o.has(h)));c.replaceChildren(...d)}const u=s.querySelectorAll(":scope > tr");if(u.length>0){const d=document.createElement("tbody");for(const f of u)d.appendChild(f);s.append(d)}return s},element:!Vy(n)&&Ws(n)?n.querySelector("table"):n}}canBeEmpty(){return!1}isShadowRoot(){return!0}getCordsFromCellNode(t,r){const{rows:n,domRows:s}=r;for(let a=0;a<n;a++){const i=s[a];if(i!=null)for(let o=0;o<i.length;o++){const c=i[o];if(c==null)continue;const{elem:u}=c,d=Mfe(this,u);if(d!==null&&t.is(d))return{x:o,y:a}}}throw new Error("Cell not found in table.")}getDOMCellFromCords(t,r,n){const{domRows:s}=n,a=s[r];if(a==null)return null;const i=a[t<a.length?t:a.length-1];return i??null}getDOMCellFromCordsOrThrow(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(!s)throw new Error("Cell not found at cords.");return s}getCellNodeFromCords(t,r,n){const s=this.getDOMCellFromCords(t,r,n);if(s==null)return null;const a=lh(s.elem);return t2(a)?a:null}getCellNodeFromCordsOrThrow(t,r,n){const s=this.getCellNodeFromCords(t,r,n);if(!s)throw new Error("Node at cords not TableCellNode.");return s}getRowStriping(){return!!this.getLatest().__rowStriping}setRowStriping(t){const r=this.getWritable();return r.__rowStriping=t,r}setFrozenColumns(t){const r=this.getWritable();return r.__frozenColumnCount=t,r}getFrozenColumns(){return this.getLatest().__frozenColumnCount}setFrozenRows(t){const r=this.getWritable();return r.__frozenRowCount=t,r}getFrozenRows(){return this.getLatest().__frozenRowCount}canSelectBefore(){return!0}canIndent(){return!1}getColumnCount(){const t=this.getFirstChild();if(!t)return 0;let r=0;return t.getChildren().forEach((n=>{t2(n)&&(r+=n.getColSpan())})),r}}function Ofe(e){const t=bV();e.hasAttribute("data-lexical-row-striping")&&t.setRowStriping(!0),e.hasAttribute("data-lexical-frozen-column")&&t.setFrozenColumns(1),e.hasAttribute("data-lexical-frozen-row")&&t.setFrozenRows(1);const r=e.querySelector(":scope > colgroup");if(r){let n=[];for(const s of r.querySelectorAll(":scope > col")){let a=s.style.width||"";if(!gE.test(a)&&(a=s.getAttribute("width")||"",!/^\d+$/.test(a))){n=void 0;break}n.push(parseFloat(a))}n&&t.setColWidths(n)}return{after:n=>nV(n,yV),node:t}}function bV(){return rl(new Y2)}function Gf(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function o8(e){let t=1,r=e.getParent();for(;r!=null;){if(rs(r)){const n=r.getParent();if(wn(n)){t++,r=n.getParent();continue}Gf(40)}return t}return t}function l8(e){let t=e.getParent();wn(t)||Gf(40);let r=t;for(;r!==null;)r=r.getParent(),wn(r)&&(t=r);return t}function wV(e){let t=[];const r=e.getChildren().filter(rs);for(let n=0;n<r.length;n++){const s=r[n],a=s.getFirstChild();wn(a)?t=t.concat(wV(a)):t.push(s)}return t}function nd(e){return rs(e)&&wn(e.getFirstChild())}function iO(e){return Jl().append(e)}function _V(e,t){return rs(e)&&(t.length===0||t.length===1&&e.is(t[0])&&e.getChildrenSize()===0)}function oO(e){const t=wr();if(t!==null){let r=t.getNodes();if(Jt(t)){const s=t.getStartEndPoints();s===null&&Gf(143);const[a]=s,i=a.getNode(),o=i.getParent();if(Qo(i)){const c=i.getFirstChild();if(c)r=c.selectStart().getNodes();else{const u=zs();i.append(u),r=u.select().getNodes()}}else if(_V(i,r)){const c=_l(e);if(Qo(o)){i.replace(c);const u=Jl();Wt(i)&&(u.setFormat(i.getFormatType()),u.setIndent(i.getIndent())),c.append(u)}else if(rs(i)){const u=i.getParentOrThrow();Qm(c,u.getChildren()),u.replace(c)}return}}const n=new Set;for(let s=0;s<r.length;s++){const a=r[s];if(Wt(a)&&a.isEmpty()&&!rs(a)&&!n.has(a.getKey())){lO(a,e);continue}let i=PG(a)?a.getParent():rs(a)&&a.isEmpty()?a:null;for(;i!=null;){const o=i.getKey();if(wn(i)){if(!n.has(o)){const c=_l(e);Qm(c,i.getChildren()),i.replace(c),n.add(o)}break}{const c=i.getParent();if(Qo(c)&&!n.has(o)){n.add(o),lO(i,e);break}i=c}}}}}function Qm(e,t){e.splice(e.getChildrenSize(),0,t)}function lO(e,t){if(wn(e))return e;const r=e.getPreviousSibling(),n=e.getNextSibling(),s=Jl();let a;if(Qm(s,e.getChildren()),wn(r)&&t===r.getListType())r.append(s),wn(n)&&t===n.getListType()&&(Qm(r,n.getChildren()),n.remove()),a=r;else if(wn(n)&&t===n.getListType())n.getFirstChildOrThrow().insertBefore(s),a=n;else{const i=_l(t);i.append(s),e.replace(i),a=i}return s.setFormat(e.getFormatType()),s.setIndent(e.getIndent()),e.remove(),a}function pE(e,t){const r=e.getLastChild(),n=t.getFirstChild();r&&n&&nd(r)&&nd(n)&&(pE(r.getFirstChild(),n.getFirstChild()),n.remove());const s=t.getChildren();s.length>0&&e.append(...s),t.remove()}function Dfe(){const e=wr();if(Jt(e)){const t=new Set,r=e.getNodes(),n=e.anchor.getNode();if(_V(n,r))t.add(l8(n));else for(let s=0;s<r.length;s++){const a=r[s];if(PG(a)){const i=q0e(a,D0);i!=null&&t.add(l8(i))}}for(const s of t){let a=s;const i=wV(s);for(const o of i){const c=zs().setTextStyle(e.style).setTextFormat(e.format);Qm(c,o.getChildren()),a.insertAfter(c),a=c,o.__key===e.anchor.key&&Jm(e.anchor,jc(Lc(c,"next"))),o.__key===e.focus.key&&Jm(e.focus,jc(Lc(c,"next"))),o.remove()}s.remove()}}}function SV(e){const t=e.getListType()!=="check";let r=e.getStart();for(const n of e.getChildren())rs(n)&&(n.getValue()!==r&&n.setValue(r),t&&n.getLatest().__checked!=null&&n.setChecked(void 0),wn(n.getFirstChild())||r++)}function Ife(e){const t=new Set;if(nd(e)||t.has(e.getKey()))return;const r=e.getParent(),n=e.getNextSibling(),s=e.getPreviousSibling();if(nd(n)&&nd(s)){const a=s.getFirstChild();if(wn(a)){a.append(e);const i=n.getFirstChild();wn(i)&&(Qm(a,i.getChildren()),n.remove(),t.add(n.getKey()))}}else if(nd(n)){const a=n.getFirstChild();if(wn(a)){const i=a.getFirstChild();i!==null&&i.insertBefore(e)}}else if(nd(s)){const a=s.getFirstChild();wn(a)&&a.append(e)}else if(wn(r)){const a=Jl().setTextFormat(e.getTextFormat()).setTextStyle(e.getTextStyle()),i=_l(r.getListType()).setTextFormat(r.getTextFormat()).setTextStyle(r.getTextStyle());a.append(i),i.append(e),s?s.insertAfter(a):n?n.insertBefore(a):r.append(a)}}function Lfe(e){if(nd(e))return;const t=e.getParent(),r=t?t.getParent():void 0;if(wn(r?r.getParent():void 0)&&rs(r)&&wn(t)){const n=t?t.getFirstChild():void 0,s=t?t.getLastChild():void 0;if(e.is(n))r.insertBefore(e),t.isEmpty()&&r.remove();else if(e.is(s))r.insertAfter(e),t.isEmpty()&&r.remove();else{const a=t.getListType(),i=Jl(),o=_l(a);i.append(o),e.getPreviousSiblings().forEach((d=>o.append(d)));const c=Jl(),u=_l(a);c.append(u),Qm(u,e.getNextSiblings()),r.insertBefore(i),r.insertAfter(c),r.replace(e)}}}function Bfe(){const e=wr();if(!Jt(e)||!e.isCollapsed())return!1;const t=e.anchor.getNode();if(!rs(t)||t.getChildrenSize()!==0)return!1;const r=l8(t),n=t.getParent();wn(n)||Gf(40);const s=n.getParent();let a;if(Qo(s))a=zs(),r.insertAfter(a);else{if(!rs(s))return!1;a=Jl(),s.insertAfter(a)}a.setTextStyle(e.style).setTextFormat(e.format).select();const i=t.getNextSiblings();if(i.length>0){const o=_l(n.getListType());if(rs(a)){const c=Jl();c.append(o),a.insertAfter(c)}else a.insertAfter(o);o.append(...i)}return(function(o){let c=o;for(;c.getNextSibling()==null&&c.getPreviousSibling()==null;){const u=c.getParent();if(u==null||!rs(u)&&!wn(u))break;c=u}c.remove()})(t),!0}function b_(...e){const t=[];for(const r of e)if(r&&typeof r=="string")for(const[n]of r.matchAll(/\S+/g))t.push(n);return t}let D0=class extends Ao{$config(){return this.config("listitem",{$transform:t=>{if(t.__checked==null)return;const r=t.getParent();wn(r)&&r.getListType()!=="check"&&t.getChecked()!=null&&t.setChecked(void 0)},extends:Ao,importDOM:{li:()=>({conversion:$fe,priority:0})}})}constructor(t=1,r=void 0,n){super(n),this.__value=t===void 0?1:t,this.__checked=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__value=t.__value,this.__checked=t.__checked}createDOM(t){const r=document.createElement("li");return this.updateListItemDOM(null,r,t),r}updateListItemDOM(t,r,n){const s=this.getParent();wn(s)&&s.getListType()==="check"&&(function(o,c,u,d){wn(c.getFirstChild())?(o.removeAttribute("role"),o.removeAttribute("tabIndex"),o.removeAttribute("aria-checked")):(o.setAttribute("role","checkbox"),o.setAttribute("tabIndex","-1"),u&&c.__checked===u.__checked||o.setAttribute("aria-checked",c.getChecked()?"true":"false"))})(r,this,t),r.value=this.__value,(function(o,c,u){const d=[],f=[],h=c.list,g=h?h.listitem:void 0;let p;if(h&&h.nested&&(p=h.nested.listitem),g!==void 0&&d.push(...b_(g)),h){const x=u.getParent(),v=wn(x)&&x.getListType()==="check",C=u.getChecked();v&&!C||f.push(h.listitemUnchecked),v&&C||f.push(h.listitemChecked),v&&d.push(C?h.listitemChecked:h.listitemUnchecked)}if(p!==void 0){const x=b_(p);u.getChildren().some((v=>wn(v)))?d.push(...x):f.push(...x)}f.length>0&&Qf(o,...f),d.length>0&&di(o,...d)})(r,n.theme,this);const a=t?t.__style:"",i=this.__style;a!==i&&(i===""?r.removeAttribute("style"):r.style.cssText=i),(function(o,c,u){const d=IR(c.__textStyle);for(const f in d)o.style.setProperty(`--listitem-marker-${f}`,d[f]);if(u)for(const f in IR(u.__textStyle))f in d||o.style.removeProperty(`--listitem-marker-${f}`)})(r,this,t)}updateDOM(t,r,n){const s=r;return this.updateListItemDOM(t,s,n),!1}updateFromJSON(t){return super.updateFromJSON(t).setValue(t.value).setChecked(t.checked)}exportDOM(t){const r=this.createDOM(t._config),n=this.getFormatType();n&&(r.style.textAlign=n);const s=this.getDirection();return s&&(r.dir=s),{element:r}}exportJSON(){return{...super.exportJSON(),checked:this.getChecked(),value:this.getValue()}}append(...t){for(let r=0;r<t.length;r++){const n=t[r];if(Wt(n)&&this.canMergeWith(n)){const s=n.getChildren();this.append(...s),n.remove()}else super.append(n)}return this}replace(t,r){if(rs(t))return super.replace(t);this.setIndent(0);const n=this.getParentOrThrow();if(!wn(n))return t;if(n.__first===this.getKey())n.insertBefore(t);else if(n.__last===this.getKey())n.insertAfter(t);else{const s=_l(n.getListType());let a=this.getNextSibling();for(;a;){const i=a;a=a.getNextSibling(),s.append(i)}n.insertAfter(t),t.insertAfter(s)}return r&&(Wt(t)||Gf(139),this.getChildren().forEach((s=>{t.append(s)}))),this.remove(),n.getChildrenSize()===0&&n.remove(),t}insertAfter(t,r=!0){const n=this.getParentOrThrow();if(wn(n)||Gf(39),rs(t))return super.insertAfter(t,r);const s=this.getNextSiblings();if(n.insertAfter(t,r),s.length!==0){const a=_l(n.getListType());s.forEach((i=>a.append(i))),t.insertAfter(a,r)}return t}remove(t){const r=this.getPreviousSibling(),n=this.getNextSibling();super.remove(t),r&&n&&nd(r)&&nd(n)&&(pE(r.getFirstChild(),n.getFirstChild()),n.remove())}insertNewAfter(t,r=!0){const n=Jl().updateFromJSON(this.exportJSON()).setChecked(!this.getChecked()&&void 0);return this.insertAfter(n,r),n}collapseAtStart(t){const r=zs();this.getChildren().forEach((i=>r.append(i)));const n=this.getParentOrThrow(),s=n.getParentOrThrow(),a=rs(s);if(n.getChildrenSize()===1)if(a)n.remove(),s.select();else{n.insertBefore(r),n.remove();const i=t.anchor,o=t.focus,c=r.getKey();i.type==="element"&&i.getNode().is(this)&&i.set(c,i.offset,"element"),o.type==="element"&&o.getNode().is(this)&&o.set(c,o.offset,"element")}else n.insertBefore(r),this.remove();return!0}getValue(){return this.getLatest().__value}setValue(t){const r=this.getWritable();return r.__value=t,r}getChecked(){const t=this.getLatest();let r;const n=this.getParent();return wn(n)&&(r=n.getListType()),r==="check"?!!t.__checked:void 0}setChecked(t){const r=this.getWritable();return r.__checked=t,r}toggleChecked(){const t=this.getWritable();return t.setChecked(!t.__checked)}getIndent(){const t=this.getParent();if(t===null||!this.isAttached())return this.getLatest().__indent;let r=t.getParentOrThrow(),n=0;for(;rs(r);)r=r.getParentOrThrow().getParentOrThrow(),n++;return n}setIndent(t){typeof t!="number"&&Gf(117),(t=Math.floor(t))>=0||Gf(199);let r=this.getIndent();for(;r!==t;)r<t?(Ife(this),r++):(Lfe(this),r--);return this}canInsertAfter(t){return rs(t)}canReplaceWith(t){return rs(t)}canMergeWith(t){return rs(t)||YN(t)}extractWithChild(t,r){if(!Jt(r))return!1;const n=r.anchor.getNode(),s=r.focus.getNode();return this.isParentOf(n)&&this.isParentOf(s)&&this.getTextContent().length===r.getTextContent().length}isParentRequired(){return!0}createParentElementNode(){return _l("bullet")}canMergeWhenEmpty(){return!0}};function $fe(e){if(e.classList.contains("task-list-item")){for(const r of e.children)if(r.tagName==="INPUT")return Ufe(r)}const t=e.getAttribute("aria-checked");return{node:Jl(t==="true"||t!=="false"&&void 0)}}function Ufe(e){return e.getAttribute("type")!=="checkbox"?{node:null}:{node:Jl(e.hasAttribute("checked"))}}function Jl(e){return rl(new D0(void 0,e))}function rs(e){return e instanceof D0}let wh=class extends Ao{$config(){return this.config("list",{$transform:t=>{(function(r){const n=r.getNextSibling();wn(n)&&r.getListType()===n.getListType()&&pE(r,n)})(t),SV(t)},extends:Ao,importDOM:{ol:()=>({conversion:uO,priority:0}),ul:()=>({conversion:uO,priority:0})}})}constructor(t="number",r=1,n){super(n);const s=Wfe[t]||t;this.__listType=s,this.__tag=s==="number"?"ol":"ul",this.__start=r}afterCloneFrom(t){super.afterCloneFrom(t),this.__listType=t.__listType,this.__tag=t.__tag,this.__start=t.__start}getTag(){return this.getLatest().__tag}setListType(t){const r=this.getWritable();return r.__listType=t,r.__tag=t==="number"?"ol":"ul",r}getListType(){return this.getLatest().__listType}getStart(){return this.getLatest().__start}setStart(t){const r=this.getWritable();return r.__start=t,r}createDOM(t,r){const n=this.__tag,s=document.createElement(n);return this.__start!==1&&s.setAttribute("start",String(this.__start)),s.__lexicalListType=this.__listType,cO(s,t.theme,this),s}updateDOM(t,r,n){return t.__tag!==this.__tag||(cO(r,n.theme,this),!1)}updateFromJSON(t){return super.updateFromJSON(t).setListType(t.listType).setStart(t.start)}exportDOM(t){const r=this.createDOM(t._config,t);return Ws(r)&&(this.__start!==1&&r.setAttribute("start",String(this.__start)),this.__listType==="check"&&r.setAttribute("__lexicalListType","check")),{element:r}}exportJSON(){return{...super.exportJSON(),listType:this.getListType(),start:this.getStart(),tag:this.getTag()}}canBeEmpty(){return!1}canIndent(){return!1}splice(t,r,n){let s=n;for(let a=0;a<n.length;a++){const i=n[a];rs(i)||(s===n&&(s=[...n]),s[a]=Jl().append(!Wt(i)||wn(i)||i.isInline()?i:wa(i.getTextContent())))}return super.splice(t,r,s)}extractWithChild(t){return rs(t)}};function cO(e,t,r){const n=[],s=[],a=t.list;if(a!==void 0){const i=a[`${r.__tag}Depth`]||[],o=o8(r)-1,c=o%i.length,u=i[c],d=a[r.__tag];let f;const h=a.nested,g=a.checklist;if(h!==void 0&&h.list&&(f=h.list),d!==void 0&&n.push(d),g!==void 0&&r.__listType==="check"&&n.push(g),u!==void 0){n.push(...b_(u));for(let p=0;p<i.length;p++)p!==c&&s.push(r.__tag+p)}if(f!==void 0){const p=b_(f);o>1?n.push(...p):s.push(...p)}}s.length>0&&Qf(e,...s),n.length>0&&di(e,...n)}function zfe(e){const t=[];for(let r=0;r<e.length;r++){const n=e[r];if(rs(n)){t.push(n);const s=n.getChildren();s.length>1&&s.forEach((a=>{wn(a)&&t.push(iO(a))}))}else t.push(iO(n))}return t}function uO(e){const t=e.nodeName.toLowerCase();let r=null;return t==="ol"?r=_l("number",e.start):t==="ul"&&(r=(function(n){if(n.getAttribute("__lexicallisttype")==="check"||n.classList.contains("contains-task-list"))return!0;for(const s of n.childNodes)if(Ws(s)&&s.hasAttribute("aria-checked"))return!0;return!1})(e)?_l("check"):_l("bullet")),{after:zfe,node:r}}const Wfe={ol:"number",ul:"bullet"};function _l(e="number",t=1){return rl(new wh(e,t))}function wn(e){return e instanceof wh}const Hfe=ln("UPDATE_LIST_START_COMMAND"),xE=ln("INSERT_UNORDERED_LIST_COMMAND"),yE=ln("INSERT_ORDERED_LIST_COMMAND"),vE=ln("REMOVE_LIST_COMMAND");function Gfe(e){return mg(e.registerCommand(yE,(()=>(oO("number"),!0)),Mp),e.registerCommand(Hfe,(t=>{const{listNodeKey:r,newStart:n}=t,s=Xa(r);return!!wn(s)&&(s.getListType()==="number"&&(s.setStart(n),SV(s)),!0)}),Mp),e.registerCommand(xE,(()=>(oO("bullet"),!0)),Mp),e.registerCommand(vE,(()=>(Dfe(),!0)),Mp),e.registerCommand(Jv,(()=>Bfe()),Mp),e.registerNodeTransform(D0,(t=>{const r=t.getFirstChild();if(r){if(_r(r)){const n=r.getStyle(),s=r.getFormat();t.getTextStyle()!==n&&t.setTextStyle(n),t.getTextFormat()!==s&&t.setTextFormat(s)}}else{const n=wr();Jt(n)&&(n.style!==t.getTextStyle()||n.format!==t.getTextFormat())&&n.isCollapsed()&&t.is(n.anchor.getNode())&&t.setTextStyle(n.style).setTextFormat(n.format)}})),e.registerNodeTransform(vh,(t=>{const r=t.getParent();if(rs(r)&&t.is(r.getFirstChild())){const n=t.getStyle(),s=t.getFormat();n===r.getTextStyle()&&s===r.getTextFormat()||r.setTextStyle(n).setTextFormat(s)}})))}function Vfe(e){const t=r=>{const n=r.getParent();if(wn(r.getFirstChild())||!wn(n))return;const s=qS(r,(a=>rs(a)&&wn(a.getParent())&&rs(a.getPreviousSibling())));if(s===null&&r.getIndent()>0)r.setIndent(0);else if(rs(s)){const a=s.getPreviousSibling();if(rs(a)){const i=(function(c){let u=c,d=u.getFirstChild();for(;wn(d);){const f=d.getLastChild();if(!rs(f))break;u=f,d=u.getFirstChild()}return u})(a),o=i.getParent();if(wn(o)){const c=o8(o);c+1<o8(n)&&r.setIndent(c)}}}};return e.registerNodeTransform(wh,(r=>{const n=[r];for(;n.length>0;){const s=n.shift();if(wn(s)){for(const a of s.getChildren())if(rs(a)){t(a);const i=a.getFirstChild();wn(i)&&n.push(i)}}}}))}var A6={exports:{}},dO;function qfe(){return dO||(dO=1,(function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var r=(function(n){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,a=0,i={},o={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function b(_){return _ instanceof c?new c(_.type,b(_.content),_.alias):Array.isArray(_)?_.map(b):_.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(b){return Object.prototype.toString.call(b).slice(8,-1)},objId:function(b){return b.__id||Object.defineProperty(b,"__id",{value:++a}),b.__id},clone:function b(_,T){T=T||{};var N,E;switch(o.util.type(_)){case"Object":if(E=o.util.objId(_),T[E])return T[E];N={},T[E]=N;for(var F in _)_.hasOwnProperty(F)&&(N[F]=b(_[F],T));return N;case"Array":return E=o.util.objId(_),T[E]?T[E]:(N=[],T[E]=N,_.forEach(function(j,P){N[P]=b(j,T)}),N);default:return _}},getLanguage:function(b){for(;b;){var _=s.exec(b.className);if(_)return _[1].toLowerCase();b=b.parentElement}return"none"},setLanguage:function(b,_){b.className=b.className.replace(RegExp(s,"gi"),""),b.classList.add("language-"+_)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(N){var b=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(N.stack)||[])[1];if(b){var _=document.getElementsByTagName("script");for(var T in _)if(_[T].src==b)return _[T]}return null}},isActive:function(b,_,T){for(var N="no-"+_;b;){var E=b.classList;if(E.contains(_))return!0;if(E.contains(N))return!1;b=b.parentElement}return!!T}},languages:{plain:i,plaintext:i,text:i,txt:i,extend:function(b,_){var T=o.util.clone(o.languages[b]);for(var N in _)T[N]=_[N];return T},insertBefore:function(b,_,T,N){N=N||o.languages;var E=N[b],F={};for(var j in E)if(E.hasOwnProperty(j)){if(j==_)for(var P in T)T.hasOwnProperty(P)&&(F[P]=T[P]);T.hasOwnProperty(j)||(F[j]=E[j])}var M=N[b];return N[b]=F,o.languages.DFS(o.languages,function(I,U){U===M&&I!=b&&(this[I]=F)}),F},DFS:function b(_,T,N,E){E=E||{};var F=o.util.objId;for(var j in _)if(_.hasOwnProperty(j)){T.call(_,j,_[j],N||j);var P=_[j],M=o.util.type(P);M==="Object"&&!E[F(P)]?(E[F(P)]=!0,b(P,T,null,E)):M==="Array"&&!E[F(P)]&&(E[F(P)]=!0,b(P,T,j,E))}}},plugins:{},highlightAll:function(b,_){o.highlightAllUnder(document,b,_)},highlightAllUnder:function(b,_,T){var N={callback:T,container:b,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",N),N.elements=Array.prototype.slice.apply(N.container.querySelectorAll(N.selector)),o.hooks.run("before-all-elements-highlight",N);for(var E=0,F;F=N.elements[E++];)o.highlightElement(F,_===!0,N.callback)},highlightElement:function(b,_,T){var N=o.util.getLanguage(b),E=o.languages[N];o.util.setLanguage(b,N);var F=b.parentElement;F&&F.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(F,N);var j=b.textContent,P={element:b,language:N,grammar:E,code:j};function M(U){P.highlightedCode=U,o.hooks.run("before-insert",P),P.element.innerHTML=P.highlightedCode,o.hooks.run("after-highlight",P),o.hooks.run("complete",P),T&&T.call(P.element)}if(o.hooks.run("before-sanity-check",P),F=P.element.parentElement,F&&F.nodeName.toLowerCase()==="pre"&&!F.hasAttribute("tabindex")&&F.setAttribute("tabindex","0"),!P.code){o.hooks.run("complete",P),T&&T.call(P.element);return}if(o.hooks.run("before-highlight",P),!P.grammar){M(o.util.encode(P.code));return}if(_&&n.Worker){var I=new Worker(o.filename);I.onmessage=function(U){M(U.data)},I.postMessage(JSON.stringify({language:P.language,code:P.code,immediateClose:!0}))}else M(o.highlight(P.code,P.grammar,P.language))},highlight:function(b,_,T){var N={code:b,grammar:_,language:T};if(o.hooks.run("before-tokenize",N),!N.grammar)throw new Error('The language "'+N.language+'" has no grammar.');return N.tokens=o.tokenize(N.code,N.grammar),o.hooks.run("after-tokenize",N),c.stringify(o.util.encode(N.tokens),N.language)},tokenize:function(b,_){var T=_.rest;if(T){for(var N in T)_[N]=T[N];delete _.rest}var E=new f;return h(E,E.head,b),d(b,E,_,E.head,0),p(E)},hooks:{all:{},add:function(b,_){var T=o.hooks.all;T[b]=T[b]||[],T[b].push(_)},run:function(b,_){var T=o.hooks.all[b];if(!(!T||!T.length))for(var N=0,E;E=T[N++];)E(_)}},Token:c};n.Prism=o;function c(b,_,T,N){this.type=b,this.content=_,this.alias=T,this.length=(N||"").length|0}c.stringify=function b(_,T){if(typeof _=="string")return _;if(Array.isArray(_)){var N="";return _.forEach(function(M){N+=b(M,T)}),N}var E={type:_.type,content:b(_.content,T),tag:"span",classes:["token",_.type],attributes:{},language:T},F=_.alias;F&&(Array.isArray(F)?Array.prototype.push.apply(E.classes,F):E.classes.push(F)),o.hooks.run("wrap",E);var j="";for(var P in E.attributes)j+=" "+P+'="'+(E.attributes[P]||"").replace(/"/g,"&quot;")+'"';return"<"+E.tag+' class="'+E.classes.join(" ")+'"'+j+">"+E.content+"</"+E.tag+">"};function u(b,_,T,N){b.lastIndex=_;var E=b.exec(T);if(E&&N&&E[1]){var F=E[1].length;E.index+=F,E[0]=E[0].slice(F)}return E}function d(b,_,T,N,E,F){for(var j in T)if(!(!T.hasOwnProperty(j)||!T[j])){var P=T[j];P=Array.isArray(P)?P:[P];for(var M=0;M<P.length;++M){if(F&&F.cause==j+","+M)return;var I=P[M],U=I.inside,K=!!I.lookbehind,te=!!I.greedy,re=I.alias;if(te&&!I.pattern.global){var Z=I.pattern.toString().match(/[imsuy]*$/)[0];I.pattern=RegExp(I.pattern.source,Z+"g")}for(var B=I.pattern||I,J=N.next,z=E;J!==_.tail&&!(F&&z>=F.reach);z+=J.value.length,J=J.next){var q=J.value;if(_.length>b.length)return;if(!(q instanceof c)){var H=1,R;if(te){if(R=u(B,z,b,K),!R||R.index>=b.length)break;var Q=R.index,L=R.index+R[0].length,G=z;for(G+=J.value.length;Q>=G;)J=J.next,G+=J.value.length;if(G-=J.value.length,z=G,J.value instanceof c)continue;for(var W=J;W!==_.tail&&(G<L||typeof W.value=="string");W=W.next)H++,G+=W.value.length;H--,q=b.slice(z,G),R.index-=z}else if(R=u(B,0,q,K),!R)continue;var Q=R.index,X=R[0],se=q.slice(0,Q),le=q.slice(Q+X.length),he=z+q.length;F&&he>F.reach&&(F.reach=he);var we=J.prev;se&&(we=h(_,we,se),z+=se.length),g(_,we,H);var ie=new c(j,U?o.tokenize(X,U):X,re,X);if(J=h(_,we,ie),le&&h(_,J,le),H>1){var Ee={cause:j+","+M,reach:he};d(b,_,T,J.prev,z,Ee),F&&Ee.reach>F.reach&&(F.reach=Ee.reach)}}}}}}function f(){var b={value:null,prev:null,next:null},_={value:null,prev:b,next:null};b.next=_,this.head=b,this.tail=_,this.length=0}function h(b,_,T){var N=_.next,E={value:T,prev:_,next:N};return _.next=E,N.prev=E,b.length++,E}function g(b,_,T){for(var N=_.next,E=0;E<T&&N!==b.tail;E++)N=N.next;_.next=N,N.prev=_,b.length-=E}function p(b){for(var _=[],T=b.head.next;T!==b.tail;)_.push(T.value),T=T.next;return _}if(!n.document)return n.addEventListener&&(o.disableWorkerMessageHandler||n.addEventListener("message",function(b){var _=JSON.parse(b.data),T=_.language,N=_.code,E=_.immediateClose;n.postMessage(o.highlight(N,o.languages[T],T)),E&&n.close()},!1)),o;var x=o.util.currentScript();x&&(o.filename=x.src,x.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var C=document.readyState;C==="loading"||C==="interactive"&&x&&x.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o})(t);e.exports&&(e.exports=r),typeof W4<"u"&&(W4.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(n){n.type==="entity"&&(n.attributes.title=n.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(s,a){var i={};i["language-"+a]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[a]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};o["language-"+a]={pattern:/[\s\S]+/,inside:r.languages[a]};var c={};c[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},r.languages.insertBefore("markup","cdata",c)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(n,s){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+n+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:r.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,(function(n){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;n.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},n.languages.css.atrule.inside.rest=n.languages.css;var a=n.languages.markup;a&&(a.tag.addInlined("style","css"),a.tag.addAttribute("style","css"))})(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,(function(){if(typeof r>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var n="Loading",s=function(x,v){return" Error "+x+" while fetching file: "+v},a=" Error: File does not exist or is empty",i={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",c="loading",u="loaded",d="failed",f="pre[data-src]:not(["+o+'="'+u+'"]):not(['+o+'="'+c+'"])';function h(x,v,C){var b=new XMLHttpRequest;b.open("GET",x,!0),b.onreadystatechange=function(){b.readyState==4&&(b.status<400&&b.responseText?v(b.responseText):b.status>=400?C(s(b.status,b.statusText)):C(a))},b.send(null)}function g(x){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(x||"");if(v){var C=Number(v[1]),b=v[2],_=v[3];return b?_?[C,Number(_)]:[C,void 0]:[C,C]}}r.hooks.add("before-highlightall",function(x){x.selector+=", "+f}),r.hooks.add("before-sanity-check",function(x){var v=x.element;if(v.matches(f)){x.code="",v.setAttribute(o,c);var C=v.appendChild(document.createElement("CODE"));C.textContent=n;var b=v.getAttribute("data-src"),_=x.language;if(_==="none"){var T=(/\.(\w+)$/.exec(b)||[,"none"])[1];_=i[T]||T}r.util.setLanguage(C,_),r.util.setLanguage(v,_);var N=r.plugins.autoloader;N&&N.loadLanguages(_),h(b,function(E){v.setAttribute(o,u);var F=g(v.getAttribute("data-range"));if(F){var j=E.split(/\r\n?|\n/g),P=F[0],M=F[1]==null?j.length:F[1];P<0&&(P+=j.length),P=Math.max(0,Math.min(P-1,j.length)),M<0&&(M+=j.length),M=Math.max(0,Math.min(M,j.length)),E=j.slice(P,M).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(P+1))}C.textContent=E,r.highlightElement(C)},function(E){v.setAttribute(o,d),C.textContent=E})}}),r.plugins.fileHighlight={highlight:function(v){for(var C=(v||document).querySelectorAll(f),b=0,_;_=C[b++];)r.highlightElement(_)}};var p=!1;r.fileHighlight=function(){p||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),p=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}})()})(A6)),A6.exports}qfe();Prism.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/};Prism.languages.javascript=Prism.languages.extend("clike",{"class-name":[Prism.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/});Prism.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/;Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:Prism.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:Prism.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:Prism.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/});Prism.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:Prism.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}});Prism.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}});Prism.languages.markup&&(Prism.languages.markup.tag.addInlined("script","javascript"),Prism.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript"));Prism.languages.js=Prism.languages.javascript;Prism.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]};Prism.languages.markup.tag.inside["attr-value"].inside.entity=Prism.languages.markup.entity;Prism.languages.markup.doctype.inside["internal-subset"].inside=Prism.languages.markup;Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Object.defineProperty(Prism.languages.markup.tag,"addInlined",{value:function(t,r){var n={};n["language-"+r]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:Prism.languages[r]},n.cdata=/^<!\[CDATA\[|\]\]>$/i;var s={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:n}};s["language-"+r]={pattern:/[\s\S]+/,inside:Prism.languages[r]};var a={};a[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:s},Prism.languages.insertBefore("markup","cdata",a)}});Object.defineProperty(Prism.languages.markup.tag,"addAttribute",{value:function(e,t){Prism.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:Prism.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}});Prism.languages.html=Prism.languages.markup;Prism.languages.mathml=Prism.languages.markup;Prism.languages.svg=Prism.languages.markup;Prism.languages.xml=Prism.languages.extend("markup",{});Prism.languages.ssml=Prism.languages.xml;Prism.languages.atom=Prism.languages.xml;Prism.languages.rss=Prism.languages.xml;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function r(d){return d=d.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+d+")")}var n=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return n}),a=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+a+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+a+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(n),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+a+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(n),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:r(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:r(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:r(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:r(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(d){["url","bold","italic","strike","code-snippet"].forEach(function(f){d!==f&&(e.languages.markdown[d].inside.content.inside[f]=e.languages.markdown[f])})}),e.hooks.add("after-tokenize",function(d){if(d.language!=="markdown"&&d.language!=="md")return;function f(h){if(!(!h||typeof h=="string"))for(var g=0,p=h.length;g<p;g++){var x=h[g];if(x.type!=="code"){f(x.content);continue}var v=x.content[1],C=x.content[3];if(v&&C&&v.type==="code-language"&&C.type==="code-block"&&typeof v.content=="string"){var b=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");b=(/[a-z][\w-]*/i.exec(b)||[""])[0].toLowerCase();var _="language-"+b;C.alias?typeof C.alias=="string"?C.alias=[C.alias,_]:C.alias.push(_):C.alias=[_]}}}f(d.tokens)}),e.hooks.add("wrap",function(d){if(d.type==="code-block"){for(var f="",h=0,g=d.classes.length;h<g;h++){var p=d.classes[h],x=/language-(.+)/.exec(p);if(x){f=x[1];break}}var v=e.languages[f];if(v)d.content=e.highlight(u(d.content),v,f);else if(f&&f!=="none"&&e.plugins.autoloader){var C="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);d.attributes.id=C,e.plugins.autoloader.loadLanguages(f,function(){var b=document.getElementById(C);b&&(b.innerHTML=e.highlight(b.textContent,e.languages[f],f))})}}});var i=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},c=String.fromCodePoint||String.fromCharCode;function u(d){var f=d.replace(i,"");return f=f.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,g){if(g=g.toLowerCase(),g[0]==="#"){var p;return g[1]==="x"?p=parseInt(g.slice(2),16):p=Number(g.slice(1)),c(p)}else{var x=o[g];return x||h}}),f}e.languages.md=e.languages.markdown})(Prism);Prism.languages.c=Prism.languages.extend("clike",{comment:{pattern:/\/\/(?:[^\r\n\\]|\\(?:\r\n?|\n|(?![\r\n])))*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},string:{pattern:/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},"class-name":{pattern:/(\b(?:enum|struct)\s+(?:__attribute__\s*\(\([\s\S]*?\)\)\s*)?)\w+|\b[a-z]\w*_t\b/,lookbehind:!0},keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|__attribute__|asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|inline|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|typeof|union|unsigned|void|volatile|while)\b/,function:/\b[a-z_]\w*(?=\s*\()/i,number:/(?:\b0x(?:[\da-f]+(?:\.[\da-f]*)?|\.[\da-f]+)(?:p[+-]?\d+)?|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?)[ful]{0,4}/i,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*/%&|^!=<>]=?/});Prism.languages.insertBefore("c","string",{char:{pattern:/'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n]){0,32}'/,greedy:!0}});Prism.languages.insertBefore("c","string",{macro:{pattern:/(^[\t ]*)#\s*[a-z](?:[^\r\n\\/]|\/(?!\*)|\/\*(?:[^*]|\*(?!\/))*\*\/|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,greedy:!0,alias:"property",inside:{string:[{pattern:/^(#\s*include\s*)<[^>]+>/,lookbehind:!0},Prism.languages.c.string],char:Prism.languages.c.char,comment:Prism.languages.c.comment,"macro-name":[{pattern:/(^#\s*define\s+)\w+\b(?!\()/i,lookbehind:!0},{pattern:/(^#\s*define\s+)\w+\b(?=\()/i,lookbehind:!0,alias:"function"}],directive:{pattern:/^(#\s*)[a-z]+/,lookbehind:!0,alias:"keyword"},"directive-hash":/^#/,punctuation:/##|\\(?=[\r\n])/,expression:{pattern:/\S[\s\S]*/,inside:Prism.languages.c}}}});Prism.languages.insertBefore("c","function",{constant:/\b(?:EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|__DATE__|__FILE__|__LINE__|__TIMESTAMP__|__TIME__|__func__|stderr|stdin|stdout)\b/});delete Prism.languages.c.boolean;(function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var r=e.languages.markup;r&&(r.tag.addInlined("style","css"),r.tag.addAttribute("style","css"))})(Prism);Prism.languages.objectivec=Prism.languages.extend("c",{string:{pattern:/@?"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,greedy:!0},keyword:/\b(?:asm|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|in|inline|int|long|register|return|self|short|signed|sizeof|static|struct|super|switch|typedef|typeof|union|unsigned|void|volatile|while)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/});delete Prism.languages.objectivec["class-name"];Prism.languages.objc=Prism.languages.objectivec;Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};(function(e){var t=e.languages.powershell={comment:[{pattern:/(^|[^`])<#[\s\S]*?#>/,lookbehind:!0},{pattern:/(^|[^`])#.*/,lookbehind:!0}],string:[{pattern:/"(?:`[\s\S]|[^`"])*"/,greedy:!0,inside:null},{pattern:/'(?:[^']|'')*'/,greedy:!0}],namespace:/\[[a-z](?:\[(?:\[[^\]]*\]|[^\[\]])*\]|[^\[\]])*\]/i,boolean:/\$(?:false|true)\b/i,variable:/\$\w+\b/,function:[/\b(?:Add|Approve|Assert|Backup|Block|Checkpoint|Clear|Close|Compare|Complete|Compress|Confirm|Connect|Convert|ConvertFrom|ConvertTo|Copy|Debug|Deny|Disable|Disconnect|Dismount|Edit|Enable|Enter|Exit|Expand|Export|Find|ForEach|Format|Get|Grant|Group|Hide|Import|Initialize|Install|Invoke|Join|Limit|Lock|Measure|Merge|Move|New|Open|Optimize|Out|Ping|Pop|Protect|Publish|Push|Read|Receive|Redo|Register|Remove|Rename|Repair|Request|Reset|Resize|Resolve|Restart|Restore|Resume|Revoke|Save|Search|Select|Send|Set|Show|Skip|Sort|Split|Start|Step|Stop|Submit|Suspend|Switch|Sync|Tee|Test|Trace|Unblock|Undo|Uninstall|Unlock|Unprotect|Unpublish|Unregister|Update|Use|Wait|Watch|Where|Write)-[a-z]+\b/i,/\b(?:ac|cat|chdir|clc|cli|clp|clv|compare|copy|cp|cpi|cpp|cvpa|dbp|del|diff|dir|ebp|echo|epal|epcsv|epsn|erase|fc|fl|ft|fw|gal|gbp|gc|gci|gcs|gdr|gi|gl|gm|gp|gps|group|gsv|gu|gv|gwmi|iex|ii|ipal|ipcsv|ipsn|irm|iwmi|iwr|kill|lp|ls|measure|mi|mount|move|mp|mv|nal|ndr|ni|nv|ogv|popd|ps|pushd|pwd|rbp|rd|rdr|ren|ri|rm|rmdir|rni|rnp|rp|rv|rvpa|rwmi|sal|saps|sasv|sbp|sc|select|set|shcm|si|sl|sleep|sls|sort|sp|spps|spsv|start|sv|swmi|tee|trcm|type|write)\b/i],keyword:/\b(?:Begin|Break|Catch|Class|Continue|Data|Define|Do|DynamicParam|Else|ElseIf|End|Exit|Filter|Finally|For|ForEach|From|Function|If|InlineScript|Parallel|Param|Process|Return|Sequence|Switch|Throw|Trap|Try|Until|Using|Var|While|Workflow)\b/i,operator:{pattern:/(^|\W)(?:!|-(?:b?(?:and|x?or)|as|(?:Not)?(?:Contains|In|Like|Match)|eq|ge|gt|is(?:Not)?|Join|le|lt|ne|not|Replace|sh[lr])\b|-[-=]?|\+[+=]?|[*\/%]=?)/i,lookbehind:!0},punctuation:/[|{}[\];(),.]/};t.string[0].inside={function:{pattern:/(^|[^`])\$\((?:\$\([^\r\n()]*\)|(?!\$\()[^\r\n)])*\)/,lookbehind:!0,inside:t},boolean:t.boolean,variable:t.variable}})(Prism);var fO={},hO;function Kfe(){return hO||(hO=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),fO}Kfe();var mO={},gO;function Yfe(){return gO||(gO=1,(function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,r=0;r<2;r++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string})(Prism)),mO}Yfe();Prism.languages.swift={comment:{pattern:/(^|[^\\:])(?:\/\/.*|\/\*(?:[^/*]|\/(?!\*)|\*(?!\/)|\/\*(?:[^*]|\*(?!\/))*\*\/)*\*\/)/,lookbehind:!0,greedy:!0},"string-literal":[{pattern:RegExp(/(^|[^"#])/.source+"(?:"+/"(?:\\(?:\((?:[^()]|\([^()]*\))*\)|\r\n|[^(])|[^\\\r\n"])*"/.source+"|"+/"""(?:\\(?:\((?:[^()]|\([^()]*\))*\)|[^(])|[^\\"]|"(?!""))*"""/.source+")"+/(?!["#])/.source),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\\($/,alias:"punctuation"},punctuation:/\\(?=[\r\n])/,string:/[\s\S]+/}},{pattern:RegExp(/(^|[^"#])(#+)/.source+"(?:"+/"(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|\r\n|[^#])|[^\\\r\n])*?"/.source+"|"+/"""(?:\\(?:#+\((?:[^()]|\([^()]*\))*\)|[^#])|[^\\])*?"""/.source+")\\2"),lookbehind:!0,greedy:!0,inside:{interpolation:{pattern:/(\\#+\()(?:[^()]|\([^()]*\))*(?=\))/,lookbehind:!0,inside:null},"interpolation-punctuation":{pattern:/^\)|\\#+\($/,alias:"punctuation"},string:/[\s\S]+/}}],directive:{pattern:RegExp(/#/.source+"(?:"+(/(?:elseif|if)\b/.source+"(?:[ 	]*"+/(?:![ \t]*)?(?:\b\w+\b(?:[ \t]*\((?:[^()]|\([^()]*\))*\))?|\((?:[^()]|\([^()]*\))*\))(?:[ \t]*(?:&&|\|\|))?/.source+")+")+"|"+/(?:else|endif)\b/.source+")"),alias:"property",inside:{"directive-name":/^#\w+/,boolean:/\b(?:false|true)\b/,number:/\b\d+(?:\.\d+)*\b/,operator:/!|&&|\|\||[<>]=?/,punctuation:/[(),]/}},literal:{pattern:/#(?:colorLiteral|column|dsohandle|file(?:ID|Literal|Path)?|function|imageLiteral|line)\b/,alias:"constant"},"other-directive":{pattern:/#\w+\b/,alias:"property"},attribute:{pattern:/@\w+/,alias:"atrule"},"function-definition":{pattern:/(\bfunc\s+)\w+/,lookbehind:!0,alias:"function"},label:{pattern:/\b(break|continue)\s+\w+|\b[a-zA-Z_]\w*(?=\s*:\s*(?:for|repeat|while)\b)/,lookbehind:!0,alias:"important"},keyword:/\b(?:Any|Protocol|Self|Type|actor|as|assignment|associatedtype|associativity|async|await|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic|else|enum|extension|fallthrough|fileprivate|final|for|func|get|guard|higherThan|if|import|in|indirect|infix|init|inout|internal|is|isolated|lazy|left|let|lowerThan|mutating|none|nonisolated|nonmutating|open|operator|optional|override|postfix|precedencegroup|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|set|some|static|struct|subscript|super|switch|throw|throws|try|typealias|unowned|unsafe|var|weak|where|while|willSet)\b/,boolean:/\b(?:false|true)\b/,nil:{pattern:/\bnil\b/,alias:"constant"},"short-argument":/\$\d+\b/,omit:{pattern:/\b_\b/,alias:"keyword"},number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,"class-name":/\b[A-Z](?:[A-Z_\d]*[a-z]\w*)?\b/,function:/\b[a-z_]\w*(?=\s*\()/i,constant:/\b(?:[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,operator:/[-+*/%=!<>&|^~?]+|\.[.\-+*/%=!<>&|^~?]+/,punctuation:/[{}[\]();,.:\\]/};Prism.languages.swift["string-literal"].forEach(function(e){e.inside.interpolation.inside=Prism.languages.swift});var pO={},xO;function Xfe(){return xO||(xO=1,(function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript})(Prism)),pO}Xfe();var yO={},vO;function Jfe(){return vO||(vO=1,(function(e){var t=/\b(?:abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|exports|extends|final|finally|float|for|goto|if|implements|import|instanceof|int|interface|long|module|native|new|non-sealed|null|open|opens|package|permits|private|protected|provides|public|record(?!\s*[(){}[\]<>=%~.:,;?+\-*/&|^])|requires|return|sealed|short|static|strictfp|super|switch|synchronized|this|throw|throws|to|transient|transitive|try|uses|var|void|volatile|while|with|yield)\b/,r=/(?:[a-z]\w*\s*\.\s*)*(?:[A-Z]\w*\s*\.\s*)*/.source,n={pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z](?:[\d_A-Z]*[a-z]\w*)?\b/.source),lookbehind:!0,inside:{namespace:{pattern:/^[a-z]\w*(?:\s*\.\s*[a-z]\w*)*(?:\s*\.)?/,inside:{punctuation:/\./}},punctuation:/\./}};e.languages.java=e.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"/,lookbehind:!0,greedy:!0},"class-name":[n,{pattern:RegExp(/(^|[^\w.])/.source+r+/[A-Z]\w*(?=\s+\w+\s*[;,=()]|\s*(?:\[[\s,]*\]\s*)?::\s*new\b)/.source),lookbehind:!0,inside:n.inside},{pattern:RegExp(/(\b(?:class|enum|extends|implements|instanceof|interface|new|record|throws)\s+)/.source+r+/[A-Z]\w*\b/.source),lookbehind:!0,inside:n.inside}],keyword:t,function:[e.languages.clike.function,{pattern:/(::\s*)[a-z_]\w*/,lookbehind:!0}],number:/\b0b[01][01_]*L?\b|\b0x(?:\.[\da-f_p+-]+|[\da-f_]+(?:\.[\da-f_p+-]+)?)\b|(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?\d[\d_]*)?[dfl]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|--|\+\+|&&|\|\||::|[?:~]|[-+*/%&|^!=<>]=?)/m,lookbehind:!0},constant:/\b[A-Z][A-Z_\d]+\b/}),e.languages.insertBefore("java","string",{"triple-quoted-string":{pattern:/"""[ \t]*[\r\n](?:(?:"|"")?(?:\\.|[^"\\]))*"""/,greedy:!0,alias:"string"},char:{pattern:/'(?:\\.|[^'\\\r\n]){1,6}'/,greedy:!0}}),e.languages.insertBefore("java","class-name",{annotation:{pattern:/(^|[^.])@\w+(?:\s*\.\s*\w+)*/,lookbehind:!0,alias:"punctuation"},generics:{pattern:/<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&)|<(?:[\w\s,.?]|&(?!&))*>)*>)*>)*>/,inside:{"class-name":n,keyword:t,punctuation:/[<>(),.:]/,operator:/[?&|]/}},import:[{pattern:RegExp(/(\bimport\s+)/.source+r+/(?:[A-Z]\w*|\*)(?=\s*;)/.source),lookbehind:!0,inside:{namespace:n.inside.namespace,punctuation:/\./,operator:/\*/,"class-name":/\w+/}},{pattern:RegExp(/(\bimport\s+static\s+)/.source+r+/(?:\w+|\*)(?=\s*;)/.source),lookbehind:!0,alias:"static",inside:{namespace:n.inside.namespace,static:/\b\w+$/,punctuation:/\./,operator:/\*/,"class-name":/\w+/}}],namespace:{pattern:RegExp(/(\b(?:exports|import(?:\s+static)?|module|open|opens|package|provides|requires|to|transitive|uses|with)\s+)(?!<keyword>)[a-z]\w*(?:\.[a-z]\w*)*\.?/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0,inside:{punctuation:/\./}}})})(Prism)),yO}Jfe();var bO={},wO;function Qfe(){return wO||(wO=1,(function(e){var t=/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|char8_t|class|co_await|co_return|co_yield|compl|concept|const|const_cast|consteval|constexpr|constinit|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|final|float|for|friend|goto|if|import|inline|int|int16_t|int32_t|int64_t|int8_t|long|module|mutable|namespace|new|noexcept|nullptr|operator|override|private|protected|public|register|reinterpret_cast|requires|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|uint16_t|uint32_t|uint64_t|uint8_t|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,r=/\b(?!<keyword>)\w+(?:\s*\.\s*\w+)*\b/.source.replace(/<keyword>/g,function(){return t.source});e.languages.cpp=e.languages.extend("c",{"class-name":[{pattern:RegExp(/(\b(?:class|concept|enum|struct|typename)\s+)(?!<keyword>)\w+/.source.replace(/<keyword>/g,function(){return t.source})),lookbehind:!0},/\b[A-Z]\w*(?=\s*::\s*\w+\s*\()/,/\b[A-Z_]\w*(?=\s*::\s*~\w+\s*\()/i,/\b\w+(?=\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>\s*::\s*\w+\s*\()/],keyword:t,number:{pattern:/(?:\b0b[01']+|\b0x(?:[\da-f']+(?:\.[\da-f']*)?|\.[\da-f']+)(?:p[+-]?[\d']+)?|(?:\b[\d']+(?:\.[\d']*)?|\B\.[\d']+)(?:e[+-]?[\d']+)?)[ful]{0,4}/i,greedy:!0},operator:/>>=?|<<=?|->|--|\+\+|&&|\|\||[?:~]|<=>|[-+*/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/,boolean:/\b(?:false|true)\b/}),e.languages.insertBefore("cpp","string",{module:{pattern:RegExp(/(\b(?:import|module)\s+)/.source+"(?:"+/"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|<[^<>\r\n]*>/.source+"|"+/<mod-name>(?:\s*:\s*<mod-name>)?|:\s*<mod-name>/.source.replace(/<mod-name>/g,function(){return r})+")"),lookbehind:!0,greedy:!0,inside:{string:/^[<"][\s\S]+/,operator:/:/,punctuation:/\./}},"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),e.languages.insertBefore("cpp","keyword",{"generic-function":{pattern:/\b(?!operator\b)[a-z_]\w*\s*<(?:[^<>]|<[^<>]*>)*>(?=\s*\()/i,inside:{function:/^\w+/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:e.languages.cpp}}}}),e.languages.insertBefore("cpp","operator",{"double-colon":{pattern:/::/,alias:"punctuation"}}),e.languages.insertBefore("cpp","class-name",{"base-clause":{pattern:/(\b(?:class|struct)\s+\w+\s*:\s*)[^;{}"'\s]+(?:\s+[^;{}"'\s]+)*(?=\s*[;{])/,lookbehind:!0,greedy:!0,inside:e.languages.extend("cpp",{})}}),e.languages.insertBefore("inside","double-colon",{"class-name":/\b[a-z_]\w*\b(?!\s*::)/i},e.languages.cpp["base-clause"])})(Prism)),bO}Qfe();function kV(e,t){for(const r of e.childNodes){if(Ws(r)&&r.tagName===t)return!0;kV(r,t)}return!1}const lv="data-language",qy="data-highlight-language",Gw="data-theme";class gg extends Ao{static getType(){return"code"}static clone(t){return new gg(t.__language,t.__key)}constructor(t,r){super(r),this.__language=t||void 0,this.__isSyntaxHighlightSupported=!1,this.__theme=void 0}afterCloneFrom(t){super.afterCloneFrom(t),this.__language=t.__language,this.__theme=t.__theme,this.__isSyntaxHighlightSupported=t.__isSyntaxHighlightSupported}createDOM(t){const r=document.createElement("code");di(r,t.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(lv,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(qy,n));const s=this.getTheme();s&&r.setAttribute(Gw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),r}updateDOM(t,r,n){const s=this.__language,a=t.__language;s?s!==a&&r.setAttribute(lv,s):a&&r.removeAttribute(lv);const i=this.__isSyntaxHighlightSupported;t.__isSyntaxHighlightSupported&&a?i&&s?s!==a&&r.setAttribute(qy,s):r.removeAttribute(qy):i&&s&&r.setAttribute(qy,s);const o=this.__theme,c=t.__theme;o?o!==c&&r.setAttribute(Gw,o):c&&r.removeAttribute(Gw);const u=this.__style,d=t.__style;return u?u!==d&&r.setAttribute("style",u):d&&r.removeAttribute("style"),!1}exportDOM(t){const r=document.createElement("pre");di(r,t._config.theme.code),r.setAttribute("spellcheck","false");const n=this.getLanguage();n&&(r.setAttribute(lv,n),this.getIsSyntaxHighlightSupported()&&r.setAttribute(qy,n));const s=this.getTheme();s&&r.setAttribute(Gw,s);const a=this.getStyle();return a&&r.setAttribute("style",a),{element:r}}static importDOM(){return{code:t=>t.textContent!=null&&(/\r?\n/.test(t.textContent)||kV(t,"BR"))?{conversion:_O,priority:1}:null,div:()=>({conversion:Zfe,priority:1}),pre:()=>({conversion:_O,priority:0}),table:t=>j6(t)?{conversion:ehe,priority:3}:null,td:t=>{const r=t,n=r.closest("table");return r.classList.contains("js-file-line")||n&&j6(n)?{conversion:SO,priority:3}:null},tr:t=>{const r=t.closest("table");return r&&j6(r)?{conversion:SO,priority:3}:null}}}static importJSON(t){return c0().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setLanguage(t.language).setTheme(t.theme)}exportJSON(){return{...super.exportJSON(),language:this.getLanguage(),theme:this.getTheme()}}insertNewAfter(t,r=!0){const n=this.getChildren(),s=n.length;if(s>=2&&n[s-1].getTextContent()===`
`&&n[s-2].getTextContent()===`
`&&t.isCollapsed()&&t.anchor.key===this.__key&&t.anchor.offset===s){n[s-1].remove(),n[s-2].remove();const c=zs();return this.insertAfter(c,r),c}const{anchor:a,focus:i}=t,o=(a.isBefore(i)?a:i).getNode();if(_r(o)){let c=rhe(o);const u=[];for(;;)if(LS(c))u.push(B1()),c=c.getNextSibling();else{if(!NV(c))break;{let v=0;const C=c.getTextContent(),b=c.getTextContentSize();for(;v<b&&C[v]===" ";)v++;if(v!==0&&u.push(TV(" ".repeat(v))),v!==b)break;c=c.getNextSibling()}}const d=o.splitText(a.offset)[0],f=a.offset===0?0:1,h=d.getIndexWithinParent()+f,g=o.getParentOrThrow(),p=[hd(),...u];g.splice(h,0,p);const x=u[u.length-1];x?x.select():a.offset===0?d.selectPrevious():d.getNextSibling().selectNext(0,0)}if(bE(o)){const{offset:c}=t.anchor;o.splice(c,0,[hd()]),o.select(c+1,c+1)}return null}canIndent(){return!1}collapseAtStart(){const t=zs();return this.getChildren().forEach((r=>t.append(r))),this.replace(t),!0}setLanguage(t){const r=this.getWritable();return r.__language=t||void 0,r}getLanguage(){return this.getLatest().__language}setIsSyntaxHighlightSupported(t){const r=this.getWritable();return r.__isSyntaxHighlightSupported=t,r}getIsSyntaxHighlightSupported(){return this.getLatest().__isSyntaxHighlightSupported}setTheme(t){const r=this.getWritable();return r.__theme=t||void 0,r}getTheme(){return this.getLatest().__theme}}function c0(e,t){return _0e(gg).setLanguage(e).setTheme(t)}function bE(e){return e instanceof gg}function _O(e){return{node:c0(e.getAttribute(lv))}}function Zfe(e){const t=e,r=kO(t);return r||(function(n){let s=n.parentElement;for(;s!==null;){if(kO(s))return!0;s=s.parentElement}return!1})(t)?{node:r?c0():null}:{node:null}}function ehe(){return{node:c0()}}function SO(){return{node:null}}function kO(e){return e.style.fontFamily.match("monospace")!==null}function j6(e){return e.classList.contains("js-file-line-container")}let KS=class CV extends vh{constructor(t="",r,n){super(t,n),this.__highlightType=r}static getType(){return"code-highlight"}static clone(t){return new CV(t.__text,t.__highlightType||void 0,t.__key)}getHighlightType(){return this.getLatest().__highlightType}setHighlightType(t){const r=this.getWritable();return r.__highlightType=t||void 0,r}canHaveFormat(){return!1}createDOM(t){const r=super.createDOM(t),n=P6(t.theme,this.__highlightType);return di(r,n),r}updateDOM(t,r,n){const s=super.updateDOM(t,r,n),a=P6(n.theme,t.__highlightType),i=P6(n.theme,this.__highlightType);return a!==i&&(a&&Qf(r,a),i&&di(r,i)),s}static importJSON(t){return TV().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setHighlightType(t.highlightType)}exportJSON(){return{...super.exportJSON(),highlightType:this.getHighlightType()}}setFormat(t){return this}isParentRequired(){return!0}createParentElementNode(){return c0()}};function P6(e,t){return t&&e&&e.codeHighlight&&e.codeHighlight[t]}function TV(e="",t){return rl(new KS(e,t))}function NV(e){return e instanceof KS}function the(e,t){let r=e;for(let n=ao(e,t);n&&(NV(n.origin)||LS(n.origin));n=V0e(n))r=n.origin;return r}function rhe(e){return the(e,"previous")}(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach((function(r){var n=t[r],s=[];/^\w+$/.test(r)||s.push(/\w+/.exec(r)[0]),r==="diff"&&s.push("bold"),e.languages.diff[r]={pattern:RegExp("^(?:["+n+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(r)[0]}}}})),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);const nhe=new Set(["http:","https:","mailto:","sms:","tel:"]);class _h extends Ao{static getType(){return"link"}static clone(t){return new _h(t.__url,{rel:t.__rel,target:t.__target,title:t.__title},t.__key)}constructor(t="",r={},n){super(n);const{target:s=null,rel:a=null,title:i=null}=r;this.__url=t,this.__target=s,this.__rel=a,this.__title=i}createDOM(t){const r=document.createElement("a");return this.updateLinkDOM(null,r,t),di(r,t.theme.link),r}updateLinkDOM(t,r,n){if($G(r)){t&&t.__url===this.__url||(r.href=this.sanitizeUrl(this.__url));for(const s of["target","rel","title"]){const a=`__${s}`,i=this[a];t&&t[a]===i||(i?r[s]=i:r.removeAttribute(s))}}}updateDOM(t,r,n){return this.updateLinkDOM(t,r,n),!1}static importDOM(){return{a:t=>({conversion:she,priority:1})}}static importJSON(t){return w_().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setURL(t.url).setRel(t.rel||null).setTarget(t.target||null).setTitle(t.title||null)}sanitizeUrl(t){t=TO(t);try{const r=new URL(TO(t));if(!nhe.has(r.protocol))return"about:blank"}catch{return t}return t}exportJSON(){return{...super.exportJSON(),rel:this.getRel(),target:this.getTarget(),title:this.getTitle(),url:this.getURL()}}getURL(){return this.getLatest().__url}setURL(t){const r=this.getWritable();return r.__url=t,r}getTarget(){return this.getLatest().__target}setTarget(t){const r=this.getWritable();return r.__target=t,r}getRel(){return this.getLatest().__rel}setRel(t){const r=this.getWritable();return r.__rel=t,r}getTitle(){return this.getLatest().__title}setTitle(t){const r=this.getWritable();return r.__title=t,r}insertNewAfter(t,r=!0){const n=w_(this.__url,{rel:this.__rel,target:this.__target,title:this.__title});return this.insertAfter(n,r),n}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}canBeEmpty(){return!1}isInline(){return!0}extractWithChild(t,r,n){if(!Jt(r))return!1;const s=r.anchor.getNode(),a=r.focus.getNode();return this.isParentOf(s)&&this.isParentOf(a)&&r.getTextContent().length>0}isEmailURI(){return this.__url.startsWith("mailto:")}isWebSiteURI(){return this.__url.startsWith("https://")||this.__url.startsWith("http://")}}function she(e){let t=null;if($G(e)){const r=e.textContent;(r!==null&&r!==""||e.children.length>0)&&(t=w_(e.getAttribute("href")||"",{rel:e.getAttribute("rel"),target:e.getAttribute("target"),title:e.getAttribute("title")}))}return{node:t}}function w_(e="",t){return rl(new _h(e,t))}function ahe(e){return e instanceof _h}class V1 extends _h{constructor(t="",r={},n){super(t,r,n),this.__isUnlinked=r.isUnlinked!==void 0&&r.isUnlinked!==null&&r.isUnlinked}static getType(){return"autolink"}static clone(t){return new V1(t.__url,{isUnlinked:t.__isUnlinked,rel:t.__rel,target:t.__target,title:t.__title},t.__key)}getIsUnlinked(){return this.__isUnlinked}setIsUnlinked(t){const r=this.getWritable();return r.__isUnlinked=t,r}createDOM(t){return this.__isUnlinked?document.createElement("span"):super.createDOM(t)}updateDOM(t,r,n){return super.updateDOM(t,r,n)||t.__isUnlinked!==this.__isUnlinked}static importJSON(t){return CO().updateFromJSON(t)}updateFromJSON(t){return super.updateFromJSON(t).setIsUnlinked(t.isUnlinked||!1)}static importDOM(){return null}exportJSON(){return{...super.exportJSON(),isUnlinked:this.__isUnlinked}}insertNewAfter(t,r=!0){const n=this.getParentOrThrow().insertNewAfter(t,r);if(Wt(n)){const s=CO(this.__url,{isUnlinked:this.__isUnlinked,rel:this.__rel,target:this.__target,title:this.__title});return n.append(s),s}return null}}function CO(e="",t){return rl(new V1(e,t))}function ihe(e){return e instanceof V1}const ohe=/^\+?[0-9\s()-]{5,}$/;function TO(e){return e.match(/^[a-z][a-z0-9+.-]*:/i)||e.match(/^[/#.]/)?e:e.includes("@")?`mailto:${e}`:ohe.test(e)?`tel:${e}`:`https://${e}`}function c8(e,t){const r={};for(const n of e){const s=t(n);s&&(r[s]?r[s].push(n):r[s]=[n])}return r}function lhe(e){const t=c8(e,(r=>r.type));return{element:t.element||[],multilineElement:t["multiline-element"]||[],textFormat:t["text-format"]||[],textMatch:t["text-match"]||[]}}const NO=/[!-/:-@[-`{-~\s]/;function che(e){return _r(e)&&!e.hasFormat("code")}function uhe(e,...t){const r=new URL("https://lexical.dev/docs/error"),n=new URLSearchParams;n.append("code",e);for(const s of t)n.append("v",s);throw r.search=n.toString(),Error(`Minified Lexical error #${e}; visit ${r.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}function EO(e,t,r){const n=r.length;for(let s=t;s>=n;s--){const a=s-n;if(EV(e,a,r,0,n)&&e[a+n]!==" ")return a}return-1}function EV(e,t,r,n,s){for(let a=0;a<s;a++)if(e[t+a]!==r[n+a])return!1;return!0}function dhe(e,t=YS){const r=lhe(t),n=c8(r.textFormat,(({tag:i})=>i[i.length-1])),s=c8(r.textMatch,(({trigger:i})=>i));for(const i of t){const o=i.type;if(o==="element"||o==="text-match"||o==="multiline-element"){const c=i.dependencies;for(const u of c)e.hasNode(u)||uhe(173,u.getType())}}const a=(i,o,c)=>{(function(u,d,f,h){const g=u.getParent();if(!Qo(g)||u.getFirstChild()!==d)return!1;const p=d.getTextContent();if(p[f-1]!==" ")return!1;for(const{regExp:x,replace:v}of h){const C=p.match(x);if(C&&C[0].length===(C[0].endsWith(" ")?f:f-1)){const b=d.getNextSiblings(),[_,T]=d.splitText(f);if(v(u,T?[T,...b]:b,C,!1)!==!1)return _.remove(),!0}}return!1})(i,o,c,r.element)||(function(u,d,f,h){const g=u.getParent();if(!Qo(g)||u.getFirstChild()!==d)return!1;const p=d.getTextContent();if(p[f-1]!==" ")return!1;for(const{regExpStart:x,replace:v,regExpEnd:C}of h){if(C&&!("optional"in C)||C&&"optional"in C&&!C.optional)continue;const b=p.match(x);if(b&&b[0].length===(b[0].endsWith(" ")?f:f-1)){const _=d.getNextSiblings(),[T,N]=d.splitText(f);if(v(u,N?[N,..._]:_,b,null,null,!1)!==!1)return T.remove(),!0}}return!1})(i,o,c,r.multilineElement)||(function(u,d,f){let h=u.getTextContent();const g=f[h[d-1]];if(g==null)return!1;d<h.length&&(h=h.slice(0,d));for(const p of g){if(!p.replace||!p.regExp)continue;const x=h.match(p.regExp);if(x===null)continue;const v=x.index||0,C=v+x[0].length;let b;return v===0?[b]=u.splitText(C):[,b]=u.splitText(v,C),b.selectNext(0,0),p.replace(b,x),!0}return!1})(o,c,s)||(function(u,d,f){const h=u.getTextContent(),g=d-1,p=h[g],x=f[p];if(!x)return!1;for(const v of x){const{tag:C}=v,b=C.length,_=g-b+1;if(b>1&&!EV(h,_,C,0,b)||h[_-1]===" ")continue;const T=h[g+1];if(v.intraword===!1&&T&&!NO.test(T))continue;const N=u;let E=N,F=EO(h,_,C),j=E;for(;F<0&&(j=j.getPreviousSibling())&&!g0(j);)if(_r(j)){if(j.hasFormat("code"))continue;const B=j.getTextContent();E=j,F=EO(B,B.length,C)}if(F<0||E===N&&F+b===_)continue;const P=E.getTextContent();if(F>0&&P[F-1]===p)continue;const M=P[F-1];if(v.intraword===!1&&M&&!NO.test(M))continue;const I=N.getTextContent(),U=I.slice(0,_)+I.slice(g+1);N.setTextContent(U);const K=E===N?U:P;E.setTextContent(K.slice(0,F)+K.slice(F+b));const te=wr(),re=$S();io(re);const Z=g-b*(E===N?2:1)+1;re.anchor.set(E.__key,F,"text"),re.focus.set(N.__key,Z,"text");for(const B of v.format)re.hasFormat(B)||re.formatText(B);re.anchor.set(re.focus.key,re.focus.offset,re.focus.type);for(const B of v.format)re.hasFormat(B)&&re.toggleFormat(B);return Jt(te)&&(re.format=te.format),!0}})(o,c,n)};return e.registerUpdateListener((({tags:i,dirtyLeaves:o,editorState:c,prevEditorState:u})=>{if(i.has(NG)||i.has(g_)||e.isComposing())return;const d=c.read(wr),f=u.read(wr);if(!Jt(f)||!Jt(d)||!d.isCollapsed()||d.is(f))return;const h=d.anchor.key,g=d.anchor.offset,p=c._nodeMap.get(h);!_r(p)||!o.has(h)||g!==1&&g>f.anchor.offset+1||e.update((()=>{if(!che(p))return;const x=p.getParent();x===null||bE(x)||a(x,p,d.anchor.offset)}))}))}const fhe=/^(\s*)(\d{1,})\.\s/,hhe=/^(\s*)[-*+]\s/,mhe=/^(#{1,6})\s/,ghe=/^>\s/,phe=/^[ \t]*```([\w-]+)?/,xhe=/[ \t]*```$/,AV=e=>(t,r,n,s)=>{const a=e(n);a.append(...r),t.replace(a),s||a.select(0,0)},jV=e=>(t,r,n,s)=>{const a=t.getPreviousSibling(),i=t.getNextSibling(),o=Jl(e==="check"?n[3]==="x":void 0);if(wn(i)&&i.getListType()===e){const u=i.getFirstChild();u!==null?u.insertBefore(o):i.append(o),t.remove()}else if(wn(a)&&a.getListType()===e)a.append(o),t.remove();else{const u=_l(e,e==="number"?Number(n[2]):void 0);u.append(o),t.replace(u)}o.append(...r),s||o.select(0,0);const c=(function(u){const d=u.match(/\t/g),f=u.match(/ /g);let h=0;return d&&(h+=d.length),f&&(h+=Math.floor(f.length/4)),h})(n[1]);c&&o.setIndent(c)},wE=(e,t,r)=>{const n=[],s=e.getChildren();let a=0;for(const i of s)if(rs(i)){if(i.getChildrenSize()===1){const d=i.getFirstChild();if(wn(d)){n.push(wE(d,t,r+1));continue}}const o=" ".repeat(4*r),c=e.getListType(),u=c==="number"?`${e.getStart()+a}. `:c==="check"?`- [${i.getChecked()?"x":" "}] `:"- ";n.push(o+u+t(i)),a++}return n.join(`
`)},yhe={dependencies:[K2],export:(e,t)=>{if(!mfe(e))return null;const r=Number(e.getTag().slice(1));return"#".repeat(r)+" "+t(e)},regExp:mhe,replace:AV((e=>{const t="h"+e[1].length;return Hf(t)})),type:"element"},vhe={dependencies:[V2],export:(e,t)=>{if(!KR(e))return null;const r=t(e).split(`
`),n=[];for(const s of r)n.push("> "+s);return n.join(`
`)},regExp:ghe,replace:(e,t,r,n)=>{if(n){const a=e.getPreviousSibling();if(KR(a))return a.splice(a.getChildrenSize(),0,[hd(),...t]),void e.remove()}const s=q2();s.append(...t),e.replace(s),n||s.select(0,0)},type:"element"},bhe={dependencies:[gg],export:e=>{if(!bE(e))return null;const t=e.getTextContent();return"```"+(e.getLanguage()||"")+(t?`
`+t:"")+"\n```"},regExpEnd:{optional:!0,regExp:xhe},regExpStart:phe,replace:(e,t,r,n,s,a)=>{let i,o;if(!t&&s){if(s.length===1)n?(i=c0(),o=r[1]+s[0]):(i=c0(r[1]),o=s[0].startsWith(" ")?s[0].slice(1):s[0]);else{if(i=c0(r[1]),s[0].trim().length===0)for(;s.length>0&&!s[0].length;)s.shift();else s[0]=s[0].startsWith(" ")?s[0].slice(1):s[0];for(;s.length>0&&!s[s.length-1].length;)s.pop();o=s.join(`
`)}const c=wa(o);i.append(c),e.append(i)}else t&&AV((c=>c0(c?c[1]:void 0)))(e,t,r,a)},type:"multiline-element"},whe={dependencies:[wh,D0],export:(e,t)=>wn(e)?wE(e,t,0):null,regExp:hhe,replace:jV("bullet"),type:"element"},_he={dependencies:[wh,D0],export:(e,t)=>wn(e)?wE(e,t,0):null,regExp:fhe,replace:jV("number"),type:"element"},She={format:["code"],tag:"`",type:"text-format"},khe={format:["highlight"],tag:"==",type:"text-format"},Che={format:["bold","italic"],tag:"***",type:"text-format"},The={format:["bold","italic"],intraword:!1,tag:"___",type:"text-format"},Nhe={format:["bold"],tag:"**",type:"text-format"},Ehe={format:["bold"],intraword:!1,tag:"__",type:"text-format"},Ahe={format:["strikethrough"],tag:"~~",type:"text-format"},jhe={format:["italic"],tag:"*",type:"text-format"},Phe={format:["italic"],intraword:!1,tag:"_",type:"text-format"},Fhe={dependencies:[_h],export:(e,t,r)=>{if(!ahe(e)||ihe(e))return null;const n=e.getTitle(),s=t(e);return n?`[${s}](${e.getURL()} "${n}")`:`[${s}](${e.getURL()})`},importRegExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))/,regExp:/(?:\[(.*?)\])(?:\((?:([^()\s]+)(?:\s"((?:[^"]*\\")*[^"]*)"\s*)?)\))$/,replace:(e,t)=>{const[,r,n,s]=t,a=w_(n,{title:s}),i=r.split("[").length-1,o=r.split("]").length-1;let c=r,u="";if(i<o)return;if(i>o){const f=r.split("[");u="["+f[0],c=f.slice(1).join("[")}const d=wa(c);return d.setFormat(e.getFormat()),a.append(d),e.replace(a),u&&a.insertBefore(wa(u)),d},trigger:")",type:"text-match"},Mhe=[yhe,vhe,whe,_he],Rhe=[bhe],Ohe=[She,Che,The,Nhe,Ehe,khe,jhe,Phe,Ahe],Dhe=[Fhe],YS=[...Mhe,...Rhe,...Ohe,...Dhe];function AO(e,t){return e.getEditorState().read((()=>{const r=Xa(t);return r!==null&&r.isSelected()}))}function Ihe(e){const[t]=bd(),[r,n]=w.useState((()=>AO(t,e)));return w.useEffect((()=>{let s=!0;const a=t.registerUpdateListener((()=>{s&&n(AO(t,e))}));return()=>{s=!1,a()}}),[t,e]),[r,w.useCallback((s=>{t.update((()=>{let a=wr();xo(a)||(a=WN(),io(a)),xo(a)&&(s?a.add(e):a.delete(e))}))}),[t,e]),w.useCallback((()=>{t.update((()=>{const s=wr();xo(s)&&s.clear()}))}),[t])]}function Lhe({nodeKey:e}){const[t]=bd(),[r,n,s]=Ihe(e);return w.useEffect((()=>mg(t.registerCommand(IN,(a=>{const i=t.getElementByKey(e);return a.target===i&&(a.shiftKey||s(),n(!r),!0)}),Mp))),[s,t,r,e,n]),w.useEffect((()=>{const a=t.getElementByKey(e),i=t._config.theme.hrSelected??"selected";a!==null&&(r?di(a,i):Qf(a,i))}),[t,r,e]),null}class X2 extends VN{static getType(){return"horizontalrule"}static clone(t){return new X2(t.__key)}static importJSON(t){return _E().updateFromJSON(t)}static importDOM(){return{hr:()=>({conversion:Bhe,priority:0})}}exportDOM(){return{element:document.createElement("hr")}}createDOM(t){const r=document.createElement("hr");return di(r,t.theme.hr),r}getTextContent(){return`
`}isInline(){return!1}updateDOM(){return!1}decorate(){return l.jsx(Lhe,{nodeKey:this.__key})}}function Bhe(){return{node:_E()}}function _E(){return rl(new X2)}function $he(e){return e instanceof X2}const Uhe=[{dependencies:[X2],export:e=>$he(e)?"***":null,regExp:/^(---|\*\*\*|___)\s?$/,replace:(e,t,r,n)=>{const s=_E();n||e.getNextSibling()!=null?e.replace(s):e.insertBefore(s),s.selectNext()},type:"element"},...YS];function PV({transformers:e=Uhe}){const[t]=bd();return w.useEffect((()=>dhe(t,e)),[t,e]),null}function FV({hasStrictIndent:e=!1}){const[t]=bd();return w.useEffect((()=>{if(!t.hasNodes([wh,D0]))throw new Error("ListPlugin: ListNode and/or ListItemNode not registered on editor")}),[t]),w.useEffect((()=>{if(e)return Vfe(t)}),[t,e]),(function(r){w.useEffect((()=>Gfe(r)),[r])})(t),null}const zhe=({onChange:e})=>{const[t]=w.useContext(I1)||[];return w.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{Zs().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},Whe=()=>{const[e]=w.useContext(I1)||[],t=w.useCallback(()=>{e&&e.dispatchCommand(To,"bold")},[e]),r=w.useCallback(()=>{e&&e.dispatchCommand(To,"italic")},[e]),n=w.useCallback(()=>{e&&e.dispatchCommand(To,"underline")},[e]),s=w.useCallback(()=>{e&&e.dispatchCommand(To,"strikethrough")},[e]),a=w.useCallback(g=>{e&&e.update(()=>{const p=wr();Jt(p)&&Zp(p,()=>Hf(g))})},[e]),i=w.useCallback(()=>{e&&e.update(()=>{const g=wr();Jt(g)&&Zp(g,()=>zs())})},[e]);w.useCallback(()=>{e&&e.update(()=>{const g=wr();Jt(g)&&Zp(g,()=>q2())})},[e]);const o=w.useCallback(()=>{e&&e.dispatchCommand(xE)},[e]),c=w.useCallback(()=>{e&&e.dispatchCommand(yE)},[e]),u=w.useCallback(()=>{e&&e.dispatchCommand(vE)},[e]),d=w.useCallback(g=>{e&&e.update(()=>{const p=wr();Jt(p)&&p.getNodes().forEach(x=>{_r(x)&&x.setStyle(`color: ${g}`)})})},[e]),f=w.useCallback(g=>{e&&e.update(()=>{const p=wr();Jt(p)&&p.getNodes().forEach(v=>{if(_r(v)){const C=v.getStyle(),b=C?C.replace(/font-size:\s*\d+px;?\s*/g,"").trim():"",_=b?`${b}; font-size: ${g}px;`:`font-size: ${g}px;`;v.setStyle(_)}})})},[e]),h=w.useCallback(g=>{e&&e.dispatchCommand(aG,g)},[e]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:t,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:r,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>a("h1"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>a("h2"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>a("h3"),className:"px-2 py-1 text-xs font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:o,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:" List"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1. List"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:"No List"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Color:"}),l.jsx("button",{type:"button",onClick:()=>d("#000000"),className:"w-6 h-6 bg-black border border-gray-300 rounded hover:bg-gray-800",title:"Black"}),l.jsx("button",{type:"button",onClick:()=>d("#ff0000"),className:"w-6 h-6 bg-red-500 border border-gray-300 rounded hover:bg-red-600",title:"Red"}),l.jsx("button",{type:"button",onClick:()=>d("#0000ff"),className:"w-6 h-6 bg-blue-500 border border-gray-300 rounded hover:bg-blue-600",title:"Blue"}),l.jsx("button",{type:"button",onClick:()=>d("#008000"),className:"w-6 h-6 bg-green-500 border border-gray-300 rounded hover:bg-green-600",title:"Green"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Size:"}),l.jsx("button",{type:"button",onClick:()=>f(12),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Small",children:"12px"}),l.jsx("button",{type:"button",onClick:()=>f(16),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Normal",children:"16px"}),l.jsx("button",{type:"button",onClick:()=>f(20),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Large",children:"20px"}),l.jsx("button",{type:"button",onClick:()=>f(24),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Extra Large",children:"24px"})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("span",{className:"text-xs text-gray-600",children:"Align:"}),l.jsx("button",{type:"button",onClick:()=>h("left"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Left",children:""}),l.jsx("button",{type:"button",onClick:()=>h("center"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Center",children:""}),l.jsx("button",{type:"button",onClick:()=>h("right"),className:"px-2 py-1 text-xs border border-gray-300 rounded hover:bg-gray-200",title:"Align Right",children:""})]})]})},Hhe=({value:e,onChange:t,placeholder:r})=>{const n={namespace:"LexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[K2,wh,D0,V2,gg,KS,Y2,H1,G1,V1,_h],onError:s=>{console.error("Lexical error:",s)},editorState:e?(()=>{try{const s=JSON.parse(e);return JSON.stringify(s)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(VG,{initialConfig:n,children:[l.jsx(Whe,{}),l.jsx(zhe,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(uV,{contentEditable:l.jsx(fV,{className:"p-4 min-h-32 focus:outline-none",placeholder:r}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:gV}),l.jsx(hV,{}),l.jsx(mV,{}),l.jsx(FV,{}),l.jsx(PV,{transformers:YS})]})]})})},Ghe=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{user:i}=ws(),{post:o}=tc(),{showNotification:c}=Ls(),[u,d]=w.useState({test_name:e,num_questions:1,passing_score:100,questions:[{id:1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048}]}),[f,h]=w.useState({isLoading:!1,error:null,showPreview:!0});w.useEffect(()=>{d(C=>({...C,test_name:e||""}))},[e]);const g=()=>{if(u.num_questions>=3){h(_=>({..._,error:"Maximum 3 questions allowed for performance reasons"}));return}const b={id:Math.max(...u.questions.map(_=>_.id))+1,question_json:"",canvas_width:600,canvas_height:800,max_canvas_width:1536,max_canvas_height:2048};d(_=>({..._,num_questions:_.num_questions+1,questions:[..._.questions,b]}))},p=C=>{u.questions.length<=1||d(b=>({...b,num_questions:b.num_questions-1,questions:b.questions.filter(_=>_.id!==C)}))},x=(C,b)=>{d(_=>({..._,questions:_.questions.map(T=>T.id===C?{...T,question_json:b}:T)}))},v=async()=>{if(!u.test_name.trim()){h(C=>({...C,error:"Test name is required"}));return}if(u.questions.some(C=>!C.question_json.trim())){h(C=>({...C,error:"All questions must have content"}));return}h(C=>({...C,isLoading:!0,error:null}));try{const C={test_name:u.test_name,num_questions:u.num_questions,passing_score:u.passing_score,questions:u.questions.map((b,_)=>({question_id:_+1,question_json:b.question_json,canvas_width:b.canvas_width,canvas_height:b.canvas_height,max_canvas_width:b.max_canvas_width,max_canvas_height:b.max_canvas_height}))};t&&t(C)}catch(C){console.error("Error preparing drawing test:",C),h(b=>({...b,error:"Failed to prepare drawing test. Please try again."})),c("Failed to prepare drawing test","error")}finally{h(C=>({...C,isLoading:!1}))}};return l.jsxs("div",{className:"drawing-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Drawing Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test where students draw based on your instructions"})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Drawing Questions (",u.num_questions,"/3)"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"Maximum 3 questions for optimal performance"})]}),l.jsxs(at,{onClick:g,disabled:u.num_questions>=3,variant:"primary",size:"sm",className:"flex items-center gap-2",children:[l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Question"]})]}),l.jsx("div",{className:"space-y-4",children:u.questions.map((C,b)=>l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"text-md font-medium text-gray-800",children:["Text ",b+1]}),u.questions.length>1&&l.jsx(at,{onClick:()=>p(C.id),variant:"secondary",size:"sm",className:"text-red-600 hover:text-red-700",children:l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:l.jsx("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})})})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Content *"}),l.jsx(Hhe,{value:C.question_json,onChange:_=>x(C.id,_),placeholder:""})]})]},C.id))})]}),f.error&&l.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 rounded-lg text-red-700",children:f.error}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx(at,{onClick:r,variant:"secondary",disabled:f.isLoading,children:"Cancel"}),l.jsx(at,{onClick:v,variant:"primary",disabled:f.isLoading||!u.test_name.trim(),className:"flex items-center gap-2",children:f.isLoading?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white"}),"Saving..."]}):"Save Test"})]})]})},Vhe=({id:e,x:t,y:r,width:n,height:s,text:a,fontSize:i,color:o,isSelected:c,onSelect:u,onUpdate:d,onDelete:f})=>{const[h,g]=w.useState(!1),p=w.useRef(!1),x=w.useRef(null),v=w.useRef({x:0,y:0}),C=w.useRef(null),b=5,_=()=>{p.current=!0,g(!0)},T=()=>{if(p.current=!1,g(!1),C.current)try{C.current.draggable(!1)}catch{}},N=()=>{x.current&&(clearTimeout(x.current),x.current=null)};w.useEffect(()=>()=>{N()},[]),w.useEffect(()=>{if(C.current)try{C.current.draggable(p.current)}catch{}},[h]);const E=j=>{j.cancelBubble=!0,d(e,{isEditing:!0})},F=j=>{d(e,{x:j.target.x(),y:j.target.y()})};return l.jsxs(vl,{ref:C,x:t,y:r,draggable:h,dragBoundFunc:j=>p.current?j:{x:t,y:r},name:"textbox-group",onClick:j=>{j.cancelBubble=!0,u(e)},onTap:j=>{j.cancelBubble=!0,u(e),N()},onDblClick:E,onDblTap:E,onPointerDown:j=>{j.cancelBubble=!0;const P=j.evt||{};v.current={x:P.clientX??0,y:P.clientY??0},N(),x.current=setTimeout(()=>{_()},400)},onPointerMove:j=>{if(!x.current)return;const P=j.evt||{},M=Math.abs((P.clientX??0)-v.current.x),I=Math.abs((P.clientY??0)-v.current.y);(M>b||I>b)&&N()},onPointerUp:j=>{j.cancelBubble=!0,N(),T()},onPointerLeave:()=>{N(),T()},onDragEnd:j=>{F(j),T()},children:[l.jsx(Ja,{width:n,height:s,fill:c?"#fef3c7":"#ffffff",stroke:c?"#f59e0b":"#d1d5db",strokeWidth:c?2:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1},name:"textbox-rect",onTap:j=>{j.cancelBubble=!0,u(e),N()},onDblTap:j=>{j.cancelBubble=!0,E(j)}}),l.jsx(Nc,{text:a,width:n,height:s,padding:8,align:"left",verticalAlign:"top",fontSize:i,fill:o,wrap:"word",name:"textbox-text",onTap:j=>{j.cancelBubble=!0,u(e),N()},onDblTap:j=>{j.cancelBubble=!0,E(j)}})]})},qhe=({x:e,y:t,width:r,height:n,initialText:s,onSave:a,onCancel:i})=>{const o=w.useRef(null);w.useEffect(()=>{o.current&&(o.current.focus(),o.current.select())},[]);const c=u=>{u.key==="Enter"&&!u.shiftKey?(u.preventDefault(),a(o.current.value)):u.key==="Escape"&&i()};return l.jsx("textarea",{ref:o,defaultValue:s,style:{position:"absolute",top:t,left:e,width:r,height:n,fontSize:"14px",border:"2px solid #f59e0b",borderRadius:"6px",padding:"8px",background:"white",resize:"none",outline:"none",fontFamily:"inherit",lineHeight:"1.4",zIndex:1e3},onKeyDown:c,onBlur:()=>a(o.current.value)})},Khe=({width:e,height:t,lines:r,onDrawingChange:n,currentTool:s,currentColor:a,currentThickness:i,zoom:o,onZoomChange:c,isPanning:u,isFullscreen:d,constrainPanPosition:f,handleWheel:h,stageRef:g,setIsPanning:p,responsiveDimensions:x,canvasSize:v,question:C,textBoxes:b,setTextBoxes:_,selectedTextBox:T,setSelectedTextBox:N,handleTextBoxSelect:E,handleTextBoxUpdate:F,handleTextBoxDelete:j,isEditingText:P,editingTextBox:M,setIsEditingText:I,setEditingTextBox:U,setCurrentTool:K})=>{const[te,re]=w.useState(!1),[Z,B]=w.useState([]),[J,z]=w.useState(null),[q,H]=w.useState(null),R=w.useRef(null),[L,G]=w.useState(.25),[W,Q]=w.useState({x:0,y:0}),X=w.useRef(null),se=w.useRef(null),le=w.useRef(!1),he=6;w.useEffect(()=>{const Ue=()=>{const st=R.current;if(!st)return;const dt=st.clientWidth||1,Bt=st.clientHeight||1,Yt=Math.min(dt/(v.width||1),Bt/(v.height||1));G(Math.min(Yt,1))};return Ue(),window.addEventListener("resize",Ue),()=>window.removeEventListener("resize",Ue)},[v.width,v.height,d]);const we=Ue=>{const st=g.current,dt=st.getPointerPosition();if(s==="pan"){if(Pe(Ue.target))try{st.draggable(!1),le.current=!0}catch{}return}if(s==="text"){const Yt={x:(dt.x-st.x())/st.scaleX(),y:(dt.y-st.y())/st.scaleY()};X.current={...Yt},se.current={x:dt.x,y:dt.y};return}re(!0);const Bt={x:(dt.x-st.x())/st.scaleX(),y:(dt.y-st.y())/st.scaleY()};H(Bt),s==="pencil"?B([{x:Bt.x,y:Bt.y,color:a,thickness:i}]):s==="eraser"?B([{x:Bt.x,y:Bt.y,color:a,thickness:i,tool:"eraser"}]):["line","rectangle","circle"].includes(s)&&z({type:s,startX:Bt.x,startY:Bt.y,endX:Bt.x,endY:Bt.y,color:a,thickness:i})},ie=Ue=>{const st=g.current,dt=st.getPointerPosition(),Bt={x:(dt.x-st.x())/st.scaleX(),y:(dt.y-st.y())/st.scaleY()};if(Q(Bt),s!=="pan"){if(s==="text"&&X.current&&se.current){const Yt=Math.abs(dt.x-se.current.x),xr=Math.abs(dt.y-se.current.y);(Yt>he||xr>he)&&(X.current=null)}if(te)if(s==="pencil"){const Yt=[...Z,{x:Bt.x,y:Bt.y,color:a,thickness:i}];B(Yt)}else if(s==="eraser"){const Yt=[...Z,{x:Bt.x,y:Bt.y,color:a,thickness:i,tool:"eraser"}];B(Yt)}else["line","rectangle","circle"].includes(s)&&J&&z({...J,endX:Bt.x,endY:Bt.y})}},Ee=Ue=>{const st=g.current;if(s==="pan"){if(le.current){try{st.draggable(!0)}catch{}le.current=!1}return}if(s==="text"&&X.current){const dt=Ue&&Ue.target;if(dt&&typeof dt.name=="function"&&dt.name()==="canvas-bg"){const Yt={id:Date.now(),x:X.current.x,y:X.current.y,width:150,height:60,text:"Double-click to edit",fontSize:14,color:"#000000"};_(xr=>[...xr,Yt]),N(Yt.id)}X.current=null,se.current=null}if(te){if(s==="pencil"){const dt=[...r,Z];n(dt),B([])}else if(s==="eraser"){const dt=[...r,Z];n(dt),B([])}else if(["line","rectangle","circle"].includes(s)&&J){const dt=[...r,J];n(dt),z(null)}re(!1),H(null)}},[ye,Ie]=w.useState(null),[ut,Qe]=w.useState(null),[$t,Ge]=w.useState(!1),[et,vt]=w.useState(null),[Te,Ve]=w.useState(!1),[pt,wt]=w.useState(!1),[Ut,ct]=w.useState([]),[yt,rt]=w.useState(null),[Oe,$e]=w.useState({totalGestures:0,zoomGestures:0,panGestures:0,combinedGestures:0,averageResponseTime:0});let Mt=null;const At=(window.devicePixelRatio||1)>1.5,tr={scaleDelta:At?.03:.04,centerDelta:At?4:6,minTouchDistance:8,gestureHysteresis:.02},ar=()=>{Ve(!1),vt(null),Ie(null),Qe(null),re(!1),H(null),wt(!1),rt(null),Mt&&(cancelAnimationFrame(Mt),Mt=null),g.current&&g.current.stop()},dr=Ue=>{if(Ue.length<2)return 0;const st=Ue[0],dt=Ue[1];return Math.sqrt(Math.pow(dt.clientX-st.clientX,2)+Math.pow(dt.clientY-st.clientY,2))},or=Ue=>{if(Ue.length<2)return null;const st=Ue[0],dt=Ue[1];return{x:(st.clientX+dt.clientX)/2,y:(st.clientY+dt.clientY)/2}},mr=Ue=>{ct(st=>[...st,{type:Ue,timestamp:Date.now()}].slice(-5))},ve=()=>{const Ue=Date.now(),st=Ut.filter(Yt=>Ue-Yt.timestamp<500);if(st.length<2)return 0;const dt=st[st.length-1],Bt=st[st.length-2];return dt.type===Bt.type?tr.gestureHysteresis:0},Fe=(Ue,st)=>{$e(dt=>({totalGestures:dt.totalGestures+1,zoomGestures:Ue.includes("zoom")?dt.zoomGestures+1:dt.zoomGestures,panGestures:Ue.includes("pan")?dt.panGestures+1:dt.panGestures,combinedGestures:Ue==="zoom+pan"?dt.combinedGestures+1:dt.combinedGestures,averageResponseTime:(dt.averageResponseTime+st)/2}))},Be=(Ue,st,dt,Bt)=>{const Yt=g.current,xr=Yt.scaleX(),Rr=Yt.position();let yr=xr,Br=Rr;if(Ue){const be=dt/ye,Ae=xr*be,ue=C?.max_canvas_width||1536,ge=C?.max_canvas_height||2048,Me=ue/v.width,ot=ge/v.height,Je=Math.min(Me,ot,1);yr=Math.max(.25,Math.min(Je,Ae));const nt=Bt,mt={x:(nt.x-Yt.x())/xr,y:(nt.y-Yt.y())/xr};Br={x:nt.x-mt.x*yr,y:nt.y-mt.y*yr}}if(st){const be=Bt.x-ut.x,Ae=Bt.y-ut.y;Ue?Br={x:Br.x+be,y:Br.y+Ae}:Br={x:Rr.x+be,y:Rr.y+Ae}}Mt||(Mt=requestAnimationFrame(()=>{Yt.scale({x:yr,y:yr}),Yt.position(Br),Yt.batchDraw(),Mt=null})),Ue&&st?(vt("zoom+pan"),wt(!0)):Ue?(vt("zoom"),wt(!0)):st&&vt("pan");const Ne=Date.now()-(yt||Date.now());Fe(Ue&&st?"zoom+pan":Ue?"zoom":"pan",Ne),console.log(" Combined gesture",{doZoom:Ue,doPan:st,scale:yr.toFixed(2),pos:Br})},Pe=Ue=>{if(!Ue||typeof Ue.name!="function")return!1;if((Ue.name()||"").includes("textbox-"))return!0;const dt=Ue.getParent&&Ue.getParent();return dt&&typeof dt.name=="function"&&(dt.name()||"").includes("textbox-")},lt=Ue=>{const st=Ue.evt.touches,dt=Ue.target;if(Pe(dt)){if(s==="pan"&&g.current)try{g.current.draggable(!1),le.current=!0}catch{}return}st.length===2?(Ue.evt.preventDefault(),Ve(!0),vt(null),Ie(dr(st)),Qe(or(st)),re(!1),rt(Date.now())):st.length===1&&(Ve(!1),vt(null),we(Ue))},Ct=Ue=>{const st=Ue.evt.touches,dt=Ue.target;if(!Pe(dt))if(st.length===2&&Te){Ue.evt.preventDefault();const Bt=g.current,Yt=dr(st),xr=or(st);if(ye&&ut&&Bt&&Yt>tr.minTouchDistance){const Rr=Math.abs(Yt/ye-1),yr=Math.sqrt(Math.pow(xr.x-ut.x,2)+Math.pow(xr.y-ut.y,2)),Br=ve(),me=tr.scaleDelta-Br,Ne=tr.centerDelta-Br*10,be=Rr>me,Ae=yr>Ne;(be||Ae)&&(Be(be,Ae,Yt,xr),be&&Ae?mr("zoom+pan"):be?mr("zoom"):Ae&&mr("pan")),console.log(" Gesture Debug",{scaleDelta:Rr.toFixed(3),centerDelta:yr.toFixed(1),doZoom:be,doPan:Ae,hysteresis:Br.toFixed(3),adjustedScaleDelta:me.toFixed(3),adjustedCenterDelta:Ne.toFixed(1),gestureHistory:Ut.slice(-3)})}Ie(Yt),Qe(xr)}else st.length===1&&!Te&&(Ue.evt.preventDefault(),ie())},Lt=Ue=>{const st=Ue.evt.touches,dt=Ue.target;Pe(dt)||(st.length===0?(Ee(Ue),ar(),wt(!1)):st.length===1&&(Ve(!1),vt(null),Ie(null),Qe(null),wt(!1)))};return l.jsx("div",{className:"relative w-full block sm:flex sm:justify-center",children:l.jsx("div",{className:"w-full max-w-full block sm:flex sm:justify-center",children:l.jsxs("div",{className:"relative",style:{border:d&&(x.width<window.innerWidth-40||x.height<window.innerHeight-40)?"2px solid #000000":"none",borderRadius:"8px",overflow:"hidden"},children:[l.jsx("div",{ref:R,className:"w-full h-full",style:{touchAction:"manipulation"},children:l.jsx(oh,{ref:g,width:x.width,height:x.height,scaleX:d?x.zoom:o,scaleY:d?x.zoom:o,onMouseDown:we,onMousemove:ie,onMouseup:Ee,onTouchStart:lt,onTouchMove:Ct,onTouchEnd:Lt,onWheel:h||(()=>{}),onDragStart:()=>{console.log(" Drag started"),s==="pan"&&p(!0)},onDragEnd:()=>{if(console.log(" Drag ended"),s==="pan"&&(p(!1),f)){const Ue=g.current,st=R.current,dt=st?.clientWidth||x.width,Bt=st?.clientHeight||x.height,Yt=v.width*Ue.scaleX(),xr=v.height*Ue.scaleY(),Rr=Ue.x(),yr=Ue.y();(Rr>dt||Rr<-Yt||yr>Bt||yr<-xr)&&f(Ue)}},draggable:s==="pan"&&o>.25,className:`border-0 rounded-none shadow-none sm:border sm:rounded-lg sm:shadow-sm ${s==="pan"?"cursor-grab":u?"cursor-grabbing":"cursor-crosshair"}`,style:{width:"100%",height:"auto"},onLoad:()=>{console.log(" DrawingTestStudent - Stage loaded with dimensions:",x.width,"x",x.height),console.log(" DrawingTestStudent - Canvas size:",v.width,"x",v.height),console.log(" DrawingTestStudent - Current zoom level:",o),console.log(" DrawingTestStudent - Effective display size:",Math.round(v.width*o),"x",Math.round(v.height*o)),console.log(" DrawingTestStudent - Total pixels displayed:",Math.round(v.width*o*v.height*o))},children:l.jsxs(ih,{children:[l.jsx(Ja,{x:0,y:0,width:v.width,height:v.height,fill:"white",name:"canvas-bg"}),r.map((Ue,st)=>{if(Array.isArray(Ue)){const dt=Ue[0]?.tool==="eraser";return l.jsx(Qi,{points:Ue.flatMap(Bt=>[Bt.x,Bt.y]),stroke:dt?"black":Ue[0]?.color||"#000000",strokeWidth:dt?(Ue[0]?.thickness||2)*7:Ue[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:dt?"destination-out":"source-over"},st)}else{if(Ue.type==="line")return l.jsx(Qi,{points:[Ue.startX,Ue.startY,Ue.endX,Ue.endY],stroke:Ue.color,strokeWidth:Ue.thickness,lineCap:"round"},st);if(Ue.type==="rectangle"){const dt=Math.abs(Ue.endX-Ue.startX),Bt=Math.abs(Ue.endY-Ue.startY),Yt=Math.min(Ue.startX,Ue.endX),xr=Math.min(Ue.startY,Ue.endY);return l.jsx(Ja,{x:Yt,y:xr,width:dt,height:Bt,stroke:Ue.color,strokeWidth:Ue.thickness,fill:"transparent"},st)}else if(Ue.type==="circle"){const dt=Math.sqrt(Math.pow(Ue.endX-Ue.startX,2)+Math.pow(Ue.endY-Ue.startY,2))/2,Bt=(Ue.startX+Ue.endX)/2,Yt=(Ue.startY+Ue.endY)/2;return l.jsx(Yf,{x:Bt,y:Yt,radius:dt,stroke:Ue.color,strokeWidth:Ue.thickness,fill:"transparent"},st)}}return null}),b.map(Ue=>l.jsx(Vhe,{...Ue,isSelected:T===Ue.id,onSelect:E,onUpdate:F,onDelete:j},Ue.id)),s==="pencil"&&l.jsx(Qi,{points:Z.flatMap(Ue=>[Ue.x,Ue.y]),stroke:a,strokeWidth:i,tension:.5,lineCap:"round",lineJoin:"round"}),s==="eraser"&&l.jsx(Qi,{points:Z.flatMap(Ue=>[Ue.x,Ue.y]),stroke:"black",strokeWidth:i*7,tension:.5,lineCap:"round",lineJoin:"round",globalCompositeOperation:"destination-out"}),J&&J.type==="line"&&l.jsx(Qi,{points:[J.startX,J.startY,J.endX,J.endY],stroke:J.color,strokeWidth:J.thickness,lineCap:"round"}),J&&J.type==="rectangle"&&l.jsx(Ja,{x:Math.min(J.startX,J.endX),y:Math.min(J.startY,J.endY),width:Math.abs(J.endX-J.startX),height:Math.abs(J.endY-J.startY),stroke:J.color,strokeWidth:J.thickness,fill:"transparent"}),J&&J.type==="circle"&&l.jsx(Yf,{x:(J.startX+J.endX)/2,y:(J.startY+J.endY)/2,radius:Math.sqrt(Math.pow(J.endX-J.startX,2)+Math.pow(J.endY-J.startY,2))/2,stroke:J.color,strokeWidth:J.thickness,fill:"transparent"}),s==="eraser"&&l.jsx(Yf,{x:W.x,y:W.y,radius:i*7/2,stroke:"#666666",strokeWidth:2,fill:"rgba(102, 102, 102, 0.2)",dash:[5,5],listening:!1}),s==="pencil"&&l.jsx(Qi,{points:[W.x-10,W.y,W.x+10,W.y,W.x,W.y-10,W.x,W.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="line"&&l.jsx(Qi,{points:[W.x-10,W.y,W.x+10,W.y,W.x,W.y-10,W.x,W.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="rectangle"&&l.jsx(Qi,{points:[W.x-10,W.y,W.x+10,W.y,W.x,W.y-10,W.x,W.y+10],stroke:"#666666",strokeWidth:1,listening:!1}),s==="circle"&&l.jsx(Qi,{points:[W.x-10,W.y,W.x+10,W.y,W.x,W.y-10,W.x,W.y+10],stroke:"#666666",strokeWidth:1,listening:!1})]})})}),P&&M&&l.jsx(qhe,{x:M.x,y:M.y,width:M.width,height:M.height,initialText:M.text,onSave:Ue=>{F(M.id,{text:Ue}),I(!1),U(null)},onCancel:()=>{I(!1),U(null)}}),l.jsxs("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[l.jsx("button",{onClick:()=>{const Ue=g.current,st=Ue.scaleX(),dt=C?.max_canvas_width||1536,Bt=C?.max_canvas_height||2048,Yt=dt/v.width,xr=Bt/v.height,Rr=Math.min(Yt,xr,5),yr=Math.min(Rr,Ue.scaleX()*1.2);Ue.scale({x:yr,y:yr}),Ue.batchDraw(),console.log(" DrawingTestStudent - Zoom In button:",st.toFixed(2),"->",yr.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(v.width*yr),"x",Math.round(v.height*yr)),console.log(" DrawingTestStudent - New resolution:",Math.round(v.width*yr*v.height*yr),"pixels"),c(yr)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom In",children:"+"}),l.jsx("button",{onClick:()=>{const Ue=g.current,st=Ue.scaleX(),dt=Math.max(.25,Ue.scaleX()*.8);Ue.scale({x:dt,y:dt}),Ue.batchDraw(),console.log(" DrawingTestStudent - Zoom Out button:",st.toFixed(2),"->",dt.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(v.width*dt),"x",Math.round(v.height*dt)),console.log(" DrawingTestStudent - New resolution:",Math.round(v.width*dt*v.height*dt),"pixels"),c(dt)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 font-bold",title:"Zoom Out",children:""}),l.jsx("button",{onClick:()=>{const Ue=g.current,st=Ue.scaleX();Ue.scale({x:1,y:1}),Ue.position({x:0,y:0}),Ue.batchDraw(),console.log(" DrawingTestStudent - Reset zoom:",st.toFixed(2),"-> 1.00"),console.log(" DrawingTestStudent - Reset effective size:",v.width,"x",v.height),console.log(" DrawingTestStudent - Reset resolution:",v.width*v.height,"pixels"),c(1)},className:"w-8 h-8 bg-white border border-gray-300 rounded shadow-sm hover:bg-gray-50 flex items-center justify-center text-gray-600 text-xs",title:"Reset Zoom",children:"1:1"})]}),l.jsxs("div",{className:"absolute bottom-2 left-2 bg-white border border-gray-300 rounded px-2 py-1 text-xs text-gray-600 shadow-sm",children:[Math.round(o*100),"%"]})]})})})},Yhe=({content:e})=>{if(!e)return l.jsx("div",{className:"text-gray-500 italic",children:"No instructions provided"});const t=n=>{if(!n)return"";if(n.type==="text"){let s=n.text||"";if(n.format&&(n.format&1&&(s=`<strong>${s}</strong>`),n.format&2&&(s=`<em>${s}</em>`),n.format&8&&(s=`<u>${s}</u>`),n.format&16&&(s=`<s>${s}</s>`)),n.style){const a=n.style.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}if(n.textStyle){const a=n.textStyle.match(/color:\s*([^;]+)/);a&&(s=`<span style="color: ${a[1].trim()}">${s}</span>`)}return s}if(n.type==="paragraph"){const s=n.children?n.children.map(t).join(""):"";let a="text-left";return n.format&&(n.format==="center"?a="text-center":n.format==="right"?a="text-right":n.format==="left"&&(a="text-left")),`<p class="${a}">${s}</p>`}if(n.type==="heading"){const s=n.tag||"h1",a=n.children?n.children.map(t).join(""):"";return`<${s}>${a}</${s}>`}if(n.type==="list"){const s=n.listType==="bullet"?"ul":"ol",a=n.children?n.children.map(i=>{if(i.type==="listitem"){const o=i.children?i.children.map(t).join(""):"";let c="margin: 4px 0; display: list-item;";return i.format&&(i.format==="center"?c+=" text-align: center;":i.format==="right"?c+=" text-align: right;":i.format==="left"&&(c+=" text-align: left;")),`<li style="${c}">${o}</li>`}return""}).join(""):"";return`<${s} style="margin: 8px 0; padding-left: 20px; list-style-type: ${n.listType==="bullet"?"disc":"decimal"}; display: block;">${a}</${s}>`}return n.children?n.children.map(t).join(""):""};let r=e;if(typeof e=="string"&&e.startsWith("{"))try{const n=JSON.parse(e);n.text?r=n.text:n.content?r=n.content:n.root&&n.root.children&&(r=n.root.children.map(t).join(""))}catch(n){console.log("Failed to parse Lexical content:",n)}return l.jsx("div",{className:"max-w-none rich-text-content",style:{lineHeight:"1.6",fontSize:"14px"},dangerouslySetInnerHTML:{__html:r}})},Xhe=({question:e,questionIndex:t,studentAnswer:r,onAnswerChange:n,mode:s,testId:a,testType:i})=>{Ls();const[o,c]=w.useState([]),[u,d]=w.useState(!0),[f,h]=w.useState("pencil"),[g,p]=w.useState("#000000"),[x,v]=w.useState(2),[C,b]=w.useState([]),[_,T]=w.useState(-1),[N,E]=w.useState({width:600,height:800}),[F,j]=w.useState(1),[P,M]=w.useState(!1),[I,U]=w.useState(!1),[K,te]=w.useState(!1),[re,Z]=w.useState([]),[B,J]=w.useState(null),[z,q]=w.useState(!1),[H,R]=w.useState(null),L=_>0,G=_<C.length-1,[W,Q]=w.useState(!1),X=w.useRef(null),se=w.useRef(null),[le,he]=w.useState({width:600,height:800}),we=w.useRef(!1),[ie,Ee]=w.useState(.25),ye=["#000000","#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA500","#800080","#008000","#808080","#FFC0CB","#A52A2A","#000080"];w.useEffect(()=>{const ct=()=>{te(window.innerWidth>=1024)};return ct(),window.addEventListener("resize",ct),()=>window.removeEventListener("resize",ct)},[]),w.useEffect(()=>{if(e){const ct=e.max_canvas_width||1536,yt=e.max_canvas_height||2048,rt=e.canvas_width||600,Oe=e.canvas_height||800;if(E({width:ct,height:yt}),we.current)console.log(" DrawingTestStudent - Preserving user zoom:",F.toFixed(2));else{j(1),we.current=!0;const Mt=(rt-ct*1)/2,It=(Oe-yt*1)/2;if(!isNaN(Mt)&&!isNaN(It)&&X.current){const At={x:Mt,y:It};X.current.position(At),X.current.batchDraw()}console.log(" DrawingTestStudent - Canvas size set:",ct,"x",yt),console.log(" DrawingTestStudent - Viewport size:",rt,"x",Oe),console.log(" DrawingTestStudent - Initial zoom:",1 .toFixed(2)),console.log(" DrawingTestStudent - Image resolution:",ct*yt,"pixels"),console.log(" DrawingTestStudent - Aspect ratio:",(ct/yt).toFixed(2))}if(r&&typeof r=="string")try{const $e=JSON.parse(r);$e.lines?c($e.lines):c($e),$e.textBoxes&&Z($e.textBoxes)}catch{console.log("No valid drawing data found")}d(!1)}},[e,r]),w.useEffect(()=>{const ct=()=>{const yt=se.current;if(!yt)return;const rt=yt.clientWidth||1,Oe=yt.clientHeight||1,$e=Math.min(rt/(N.width||1),Oe/(N.height||1));Ee(Math.min($e,1))};return ct(),window.addEventListener("resize",ct),()=>window.removeEventListener("resize",ct)},[N.width,N.height,W]);const Ie=ct=>{c(ct);const yt={lines:ct,textBoxes:re};n(e.question_id,JSON.stringify(yt)),ut(ct,re)},ut=(ct,yt=re)=>{const rt=C.slice(0,_+1);rt.push({lines:[...ct],textBoxes:[...yt]}),b(rt),T(rt.length-1)},Qe=()=>{if(L){const ct=_-1,yt=C[ct];if(yt&&typeof yt=="object"&&yt.lines){c([...yt.lines]),Z([...yt.textBoxes]);const rt={lines:yt.lines,textBoxes:yt.textBoxes};n(e.question_id,JSON.stringify(rt))}else{const rt=yt||[];c([...rt]),n(e.question_id,JSON.stringify(rt))}T(ct)}},$t=()=>{if(G){const ct=_+1,yt=C[ct];if(yt&&typeof yt=="object"&&yt.lines){c([...yt.lines]),Z([...yt.textBoxes]);const rt={lines:yt.lines,textBoxes:yt.textBoxes};n(e.question_id,JSON.stringify(rt))}else{const rt=yt||[];c([...rt]),n(e.question_id,JSON.stringify(rt))}T(ct)}},Ge=()=>{c([]),Z([]),J(null),n(e.question_id,"")},et=ct=>{J(ct)},vt=(ct,yt)=>{const rt=re.map($e=>$e.id===ct?{...$e,...yt}:$e);Z(rt),ut(o,rt);const Oe={lines:o,textBoxes:rt};if(n(e.question_id,JSON.stringify(Oe)),yt.isEditing){const $e=re.find(Mt=>Mt.id===ct);R($e),q(!0)}},Te=ct=>{const yt=re.filter(Oe=>Oe.id!==ct);Z(yt),B===ct&&J(null),ut(o,yt);const rt={lines:o,textBoxes:yt};n(e.question_id,JSON.stringify(rt))},Ve=()=>{if(W){const rt=e?.canvas_width||600,Oe=e?.canvas_height||800,$e=window.innerWidth-40,Mt=window.innerHeight-40,It=$e/rt,At=Mt/Oe,tr=Math.min(It,At,1);return{width:rt,height:Oe,zoom:tr}}const ct=e?.canvas_width||600,yt=e?.canvas_height||800;return{width:ct,height:yt,zoom:1}};w.useEffect(()=>{const ct=()=>{he(Ve())};return ct(),window.addEventListener("resize",ct),()=>window.removeEventListener("resize",ct)},[W,N]);const pt=ct=>{ct.evt.preventDefault();const yt=X.current,rt=yt.scaleX(),Oe=yt.getPointerPosition(),$e={x:(Oe.x-yt.x())/rt,y:(Oe.y-yt.y())/rt},Mt=ct.evt.deltaY>0?rt*.9:rt*1.1,It=e?.max_canvas_width||1536,At=e?.max_canvas_height||2048,tr=It/N.width,ar=At/N.height,dr=Math.min(tr,ar,1),or=Math.max(ie,Math.min(dr,Mt)),mr={x:Oe.x-$e.x*or,y:Oe.y-$e.y*or};if(or<=ie&&se.current){const ve=se.current.clientWidth||1,Fe=se.current.clientHeight||1;mr.x=(ve-N.width*or)/2,mr.y=(Fe-N.height*or)/2}yt.scale({x:or,y:or}),yt.position(mr),yt.batchDraw(),console.log(" DrawingTestStudent - Wheel zoom:",rt.toFixed(2),"->",or.toFixed(2)),console.log(" DrawingTestStudent - New effective size:",Math.round(N.width*or),"x",Math.round(N.height*or)),console.log(" DrawingTestStudent - New resolution:",Math.round(N.width*or*N.height*or),"pixels"),j(or),we.current=!0},wt=ct=>{const yt=ct.scaleX(),rt=se.current,Oe=rt?.clientWidth||le.width,$e=rt?.clientHeight||le.height,Mt=N.width*yt,It=N.height*yt;if(yt<=ie){const Be=(Oe-Mt)/2,Pe=($e-It)/2;ct.position({x:Be,y:Pe}),ct.batchDraw();return}if(Mt<=Oe&&It<=$e){const Be=(Oe-Mt)/2,Pe=($e-It)/2;ct.position({x:Be,y:Pe}),ct.batchDraw();return}const At=Math.max(0,Mt-Oe),tr=Math.max(0,It-$e),ar=-At,dr=-tr,or=ct.x(),mr=ct.y(),ve=Math.max(ar,Math.min(At,or)),Fe=Math.max(dr,Math.min(tr,mr));(ve!==or||Fe!==mr)&&(ct.position({x:ve,y:Fe}),ct.batchDraw())},Ut=()=>{if(W)document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen();else{const ct=se.current;ct&&(ct.requestFullscreen?ct.requestFullscreen():ct.webkitRequestFullscreen?ct.webkitRequestFullscreen():ct.msRequestFullscreen&&ct.msRequestFullscreen())}};return w.useEffect(()=>{const ct=()=>{Q(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",ct),document.addEventListener("webkitfullscreenchange",ct),document.addEventListener("msfullscreenchange",ct),()=>{document.removeEventListener("fullscreenchange",ct),document.removeEventListener("webkitfullscreenchange",ct),document.removeEventListener("msfullscreenchange",ct)}},[]),w.useEffect(()=>()=>{X.current&&X.current.stop()},[]),u?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx(Xr,{})}):e?l.jsxs("div",{className:`drawing-question w-full max-w-full mx-0 p-0 sm:p-2 ${W?"fixed inset-0 z-50 bg-white overflow-y-auto":""}`,children:[!W&&l.jsx("div",{className:"mb-4",children:l.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Question ",t+1]})}),!W&&e.question_json&&e.question_json.trim()&&l.jsxs("div",{className:"mb-2 p-2 bg-gray-50 border border-gray-200 rounded-lg",children:[l.jsx("h4",{className:"text-sm font-semibold text-gray-800 mb-2",children:"Task:"}),l.jsx("div",{className:"text-gray-700",children:l.jsx(Yhe,{content:e.question_json})})]}),!W&&l.jsx(Kt,{className:"p-1 sm:p-2 mb-2",children:l.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 flex-wrap",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"hidden sm:block text-sm text-gray-700",children:"Tool:"}),l.jsxs("div",{className:"flex flex-nowrap sm:flex-wrap gap-1 overflow-x-auto",children:[l.jsx("button",{onClick:()=>h("pencil"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="pencil"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pencil (Freehand drawing)",children:""}),l.jsx("button",{onClick:()=>h("line"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="line"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Line",children:""}),l.jsx("button",{onClick:()=>h("rectangle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="rectangle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Rectangle",children:""}),l.jsx("button",{onClick:()=>h("circle"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="circle"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Circle",children:""}),l.jsx("button",{onClick:()=>h("eraser"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="eraser"?"bg-red-500 text-white border-red-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Eraser",children:""}),l.jsx("button",{onClick:()=>h("text"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="text"?"bg-green-500 text-white border-green-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Text Box",children:""}),l.jsx("button",{onClick:()=>h("pan"),className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${f==="pan"?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,title:"Pan (Move canvas)",children:""})]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"History:"}),l.jsxs("div",{className:"flex gap-1",children:[l.jsx("button",{onClick:Qe,disabled:!L,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${L?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Undo (Ctrl+Z)",children:""}),l.jsx("button",{onClick:$t,disabled:!G,className:`px-2 sm:px-3 py-1 sm:py-2 text-xs sm:text-sm border rounded-lg transition-colors ${G?"bg-white text-gray-700 border-gray-300 hover:bg-gray-50":"bg-gray-100 text-gray-400 border-gray-200 cursor-not-allowed"}`,title:"Redo (Ctrl+Y)",children:""})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>M(!P),className:"flex items-center gap-1 sm:gap-2 px-2 sm:px-3 py-1 sm:py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx("div",{className:"w-6 h-6 rounded border border-gray-300",style:{backgroundColor:g}}),l.jsx("span",{className:"text-xs sm:text-sm text-gray-700",children:"Color"})]}),P&&l.jsx("div",{className:"absolute top-full left-0 mt-2 p-4 bg-white border border-gray-300 rounded-lg shadow-lg z-30 min-w-max",children:l.jsx("div",{className:"flex flex-wrap gap-2 max-w-xs",children:ye.map(ct=>l.jsx("button",{onClick:()=>{p(ct),M(!1)},className:`w-10 h-10 rounded border-2 hover:scale-110 transition-transform flex-shrink-0 ${g===ct?"border-gray-800":"border-gray-300"}`,style:{backgroundColor:ct},title:ct},ct))})})]}),l.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[l.jsx("label",{className:"text-xs sm:text-sm text-gray-700",children:"Thickness:"}),l.jsx("input",{type:"range",min:"1",max:"10",value:x,onChange:ct=>v(parseInt(ct.target.value)),className:"w-16 sm:w-20"}),l.jsxs("span",{className:"text-xs text-gray-500 w-6 sm:w-8",children:[x,"px"]})]}),l.jsx(at,{onClick:Ge,variant:"secondary",size:"sm",children:"Clear"})]})}),l.jsx(Kt,{paddingClass:"p-0 sm:p-2",children:l.jsxs("div",{ref:se,className:"w-full drawing-canvas-container relative p-0 m-0",children:[l.jsx(Khe,{width:N.width,height:N.height,lines:o,onDrawingChange:Ie,currentTool:f,currentColor:g,currentThickness:x,zoom:F,onZoomChange:j,isPanning:I,isFullscreen:W,constrainPanPosition:wt,handleWheel:pt,stageRef:X,setIsPanning:U,responsiveDimensions:le,canvasSize:N,question:e,textBoxes:re,setTextBoxes:Z,selectedTextBox:B,setSelectedTextBox:J,handleTextBoxSelect:et,handleTextBoxUpdate:vt,handleTextBoxDelete:Te,isEditingText:z,editingTextBox:H,setIsEditingText:q,setEditingTextBox:R,setCurrentTool:h}),l.jsx("button",{onClick:Ut,className:"absolute top-2 left-2 bg-black bg-opacity-50 hover:bg-opacity-70 text-white p-2 rounded-lg transition-all duration-200 z-10",title:W?"Exit Fullscreen":"Enter Fullscreen",children:W?l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"})}):l.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:l.jsx("path",{d:"M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"})})})]})})]}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No drawing question data available"})})})},O4={enhanceUserData(e,t){const r={id:e.id||e.student_id||e.teacher_id,username:e.username||e.student_id,name:e.name||e.first_name,surname:e.surname||e.last_name,nickname:e.nickname,role:t,is_active:e.is_active!==void 0?e.is_active:!0,created_at:e.created_at,updated_at:e.updated_at};switch(t){case"student":return{...r,student_id:e.student_id,grade:e.grade,class:e.class,number:e.number,subjects:e.subjects||[]};case"teacher":return{...r,teacher_id:e.teacher_id,first_name:e.first_name,last_name:e.last_name,email:e.email,phone:e.phone,subjects:e.subjects||[]};case"admin":return{...r,admin_id:e.admin_id,permissions:e.permissions||["all"]};default:return r}},async studentLogin(e){console.log("Trying student login...");try{const t=await fetch("/.netlify/functions/student-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:e.username,password:e.password})}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.student,role:"student",response:t};throw new Error(r.message||"Student login failed")}catch(t){throw console.error("Student login error:",t),new Error(t.message||"Student login failed")}},async teacherLogin(e){console.log("Trying teacher login...");try{const t=await fetch("/.netlify/functions/teacher-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.teacher,role:"teacher",response:t};throw new Error(r.message||"Teacher login failed")}catch(t){throw console.error("Teacher login error:",t),new Error(t.message||"Teacher login failed")}},async adminLogin(e){console.log("Trying admin login...");try{const t=await fetch("/.netlify/functions/admin-login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),r=await t.json();if(t.ok&&r.success)return{success:!0,token:r.accessToken,refreshToken:r.refreshToken,data:r.admin,role:"admin",response:t};throw new Error(r.message||"Admin login failed")}catch(t){throw console.error("Admin login error:",t),new Error(t.message||"Admin login failed")}},async login(e){const{username:t,password:r}=e;console.log("Attempting login with:",t,r);try{if(t==="admin"){const o=await this.adminLogin(e),c=await o.json();return await this.handleLoginResponse(o,"admin",c)}const n=await this.teacherLogin(e),s=await n.json();if(n.ok&&s.success)return await this.handleLoginResponse(n,"teacher",s);const a=await this.studentLogin(e),i=await a.json();return a.ok&&i.success?await this.handleLoginResponse(a,"student",i):(this.handleLoginFailure(),{success:!1,message:"Login failed. Please check your credentials and try again."})}catch(n){return console.error("Login error:",n),this.handleLoginFailure(),{success:!1,message:n.message||"Login failed"}}},async handleLoginResponse(e,t,r){if(e.ok&&r.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),this.handleLoginFailure(),{success:!1,message:"JWT system not available"};if(r.accessToken&&r.role)try{window.tokenManager.setTokens(r.accessToken,r.role),window.roleBasedLoader.setupAccessAfterLogin()}catch(n){return console.error("[ERROR] Failed to initialize JWT system:",n),this.handleLoginFailure(),{success:!1,message:"Failed to initialize JWT system"}}return this.resetLoginForm(),await this.handlePostLoginActions(r,t),{success:!0,data:r,role:t}}return{success:!1,message:"Login failed"}},async handlePostLoginActions(e,t){console.log(`Handling post-login actions for role: ${t}`);try{switch(t){case"student":e.student&&(this.populateStudentInfo(e.student),window.loadStudentData&&await window.loadStudentData());break;case"teacher":e.teacher&&(this.populateTeacherInfo(e.teacher),window.loadTeacherData&&await window.loadTeacherData());break;case"admin":e.admin&&window.loadAdminData&&await window.loadAdminData();break;default:console.warn(`Unknown role for post-login actions: ${t}`)}}catch(r){console.error("Error in post-login actions:",r)}},handleLoginFailure(){console.log("All login attempts failed"),this.resetLoginForm(),window.showNotification&&window.showNotification("Login failed. Please check your credentials and try again.","error")},resetLoginForm(){const e=document.getElementById("unifiedLoginForm");if(e){e.querySelectorAll("input").forEach(n=>{n.disabled=!1,n.style.opacity="1",n.style.cursor="text",n.removeAttribute("readonly"),n.style.pointerEvents="auto"});const r=e.querySelector('button[type="submit"]');r&&(r.disabled=!1,r.style.opacity="1",r.style.cursor="pointer",r.style.pointerEvents="auto",r.innerHTML="Login"),e.classList.remove("test-submitting","disabled"),e.style.pointerEvents="auto",console.log("Login form reset successfully - all inputs re-enabled")}},async logout(){console.log(" Logout initiated...");try{return window.tokenManager&&window.tokenManager.logout(),window.roleBasedLoader&&window.roleBasedLoader.reloadRoleAccess(),window.clearTestLocalStorage&&window.clearTestLocalStorage(),this.resetInterfaceAfterSessionClear(),console.log(" Logout completed - user session cleared, test data cleared, and interface reset"),{success:!0}}catch(e){return console.error("Logout error:",e),this.resetInterfaceAfterSessionClear(),{success:!0}}},resetInterfaceAfterSessionClear(){try{window.forceLogout=!0,window.preventAutoLogin=!0,window.isClearingSession=!0,window.forceLogoutComplete=!0,document.querySelectorAll(".section").forEach(s=>{s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0"}),document.querySelectorAll('[id$="-cabinet"], [id$="-container"], [id*="cabinet"], [id*="container"]').forEach(s=>{s.id&&s.id!=="login-section"&&(s.classList.remove("active"),s.style.display="none",s.style.visibility="hidden",s.style.opacity="0")}),document.body.classList.remove("student-logged-in","teacher-logged-in","admin-logged-in"),document.body.classList.add("force-logout");const r=document.getElementById("login-section");r&&(r.classList.add("active"),r.style.display="block",r.style.visibility="visible",r.style.opacity="1"),document.querySelectorAll("input, select, textarea").forEach(s=>{s.type!=="hidden"&&(s.value="",s.checked=!1)}),console.log(" Interface reset to login state")}catch(e){console.error("Error resetting interface:",e),localStorage.clear(),sessionStorage.clear(),window.location.reload()}},async changePassword(e){try{return{success:!0,message:(await xa.post("/auth/change-password",{currentPassword:e.currentPassword,newPassword:e.newPassword,confirmPassword:e.confirmPassword})).data.message}}catch(t){throw new Error(t.response?.data?.message||"Password change failed")}},async verifyToken(e){try{const t=await xa.get("/auth/verify",{headers:{Authorization:`Bearer ${e}`}});return{success:!0,valid:t.data.valid,user:t.data.user}}catch(t){return{success:!1,valid:!1,error:t.message}}},async refreshToken(e){try{const t=await xa.post("/auth/refresh",{refreshToken:e});return{success:!0,token:t.data.token,refreshToken:t.data.refreshToken}}catch(t){throw new Error(t.response?.data?.message||"Token refresh failed")}},async getUserProfile(){try{return{success:!0,user:(await xa.get("/auth/profile")).data.user}}catch(e){throw new Error(e.response?.data?.message||"Failed to get user profile")}},async updateUserProfile(e){try{return{success:!0,user:(await xa.put("/auth/profile",e)).data.user}}catch(t){throw new Error(t.response?.data?.message||"Failed to update user profile")}},populateStudentInfo(e){console.log("=== populateStudentInfo called ==="),console.log("Student object:",e);const t=document.getElementById("studentName");if(t){const s=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=s,console.log("Set student name to:",s)}const r=document.getElementById("studentGrade");r&&(r.textContent=e?.grade||"",console.log("Set student grade to:",e?.grade));const n=document.getElementById("studentClass");n&&(n.textContent=e?.class||"",console.log("Set student class to:",e?.class)),console.log("Student info populated successfully")},populateTeacherInfo(e){console.log("=== populateTeacherInfo called ==="),console.log("Teacher object:",e);const t=document.getElementById("teacherName");if(t){const n=`${e?.name||""} ${e?.surname||""}`.trim();t.textContent=n,console.log("Set teacher name to:",n)}const r=document.getElementById("teacherUsername");r&&(r.textContent=e?.username||"",console.log("Set teacher username to:",e?.username)),console.log("Teacher info populated successfully")},getCurrentTeacherId(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.sub?e.role==="teacher"?(console.log(`[DEBUG] Found teacher ID from JWT: ${e.sub}`),e.sub):(console.warn(`[WARN] Unsupported role for teacher function: ${e.role}`),null):(console.warn("[WARN] No teacher ID found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher ID from JWT:",e),null}},getCurrentAdmin(){const e=window.tokenManager?.getToken();if(!e)return null;const t=window.tokenManager.decodeToken(e);if(!t||t.role!=="admin")throw new Error("getCurrentAdmin() called by non-admin user");return{id:t.sub,username:t.username,role:t.role}},getCurrentTeacherUsername(){try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())return console.warn("[WARN] No valid JWT token found for teacher"),null;const e=window.tokenManager.decodeToken(window.tokenManager.getAccessToken());return e&&e.username?(console.log(`[DEBUG] Found teacher username from JWT: ${e.username}`),e.username):(console.warn("[WARN] No teacher username found in JWT token"),null)}catch(e){return console.error("[ERROR] Error getting current teacher username from JWT:",e),null}},isAdmin(){try{const e=window.tokenManager?.getToken();if(!e)return!1;const t=window.tokenManager.decodeToken(e);return t&&t.role==="admin"}catch(e){return console.error("[ERROR] Error checking admin status:",e),!1}},getCurrentAdminId(){try{const e=this.getCurrentAdmin();return e?e.id:null}catch(e){return console.error("[ERROR] Error getting admin ID:",e),null}}},Jhe=()=>{const e=Za(),{login:t,setUserData:r,isAuthenticated:n,user:s}=ws(),[a,i]=w.useState({username:"",password:""}),[o,c]=w.useState(!1),[u,d]=w.useState(""),[f,h]=w.useState([]),[g,p]=w.useState(!1);w.useEffect(()=>{x()},[]);const x=w.useCallback(async()=>{console.log("Checking for existing JWT session...");try{(window.forceLogout||window.preventAutoLogin)&&(window.forceLogout=!1,window.preventAutoLogin=!1)}catch{}if(window.tokenManager)if(await window.tokenManager.isAuthenticated()){console.log("JWT session valid, checking user role...");try{const U=await window.tokenManager.getAccessToken(),K=window.tokenManager.decodeToken(U);K&&K.role?console.log("User role from JWT:",K.role):console.log("No valid role found in JWT, showing login")}catch(U){console.error("Error decoding JWT token:",U)}}else console.log("No valid JWT session found, showing login");else console.log("No tokenManager found, showing login")},[]),v=w.useCallback(async I=>{if(I.preventDefault(),window.forceLogout||window.preventAutoLogin){console.log(" Login blocked - force logout in progress"),j("Please wait for the logout process to complete.","warning");return}const{username:U,password:K}=a;if(!U||!K){d("Please enter both username and password");return}c(!0),d("");try{let te,re;U==="admin"?(te=await O4.adminLogin({username:U,password:K}),re=Ko.ADMIN):/^\d+$/.test(U)?(te=await O4.studentLogin({username:U,password:K}),re=Ko.STUDENT):(te=await O4.teacherLogin({username:U,password:K}),re=Ko.TEACHER);let Z,B;if(te.response?(Z=te,B=te.response):(Z=await te.json(),B=te),await C(B,re,Z)){j("Login successful!","success");try{if("credentials"in navigator&&window.PasswordCredential&&a?.username&&a?.password){const J=new window.PasswordCredential({id:String(a.username),password:String(a.password)});await navigator.credentials.store(J)}}catch{}try{window.forceLogout=!1,window.preventAutoLogin=!1}catch{}}}catch(te){console.error("Login error:",te),d("Invalid username or password")}finally{c(!1)}},[a]),C=w.useCallback(async(I,U,K)=>{if(I.ok&&K.success){if(!window.tokenManager||!window.roleBasedLoader)return console.error("[ERROR] JWT system not available during login response handling"),E(),!1;try{K.token&&(window.tokenManager.setTokens(K.token,U),K.refreshToken&&window.tokenManager.setRefreshToken(K.refreshToken),console.log("JWT token stored successfully"));const te={...K.data,...K,role:U};return r(te),await b(te),!0}catch(te){return console.error("Error handling login response:",te),E(te),!1}}else return console.error("Login failed:",K.error||"Unknown error"),d(K.error||"Login failed. Please check your credentials."),!1},[t]),b=w.useCallback(async I=>{if(console.log("Handling post-login actions for role:",I.role),g){console.log(" Post-login already handled, skipping");return}p(!0);try{switch(I.role){case Ko.STUDENT:await _(I),e("/student");break;case Ko.TEACHER:await T(I),e("/teacher");break;case Ko.ADMIN:await N(I),e("/admin");break;default:console.error("Unknown user role:",I.role),E()}}catch(U){console.error("Error in post-login actions:",U),E(U)}},[e,g]);w.useEffect(()=>{n||p(!1)},[n]);const _=w.useCallback(async I=>{console.log("Populating student info:",I)},[]),T=w.useCallback(async I=>{console.log("Populating teacher info:",I)},[]),N=w.useCallback(async I=>{console.log("Populating admin info:",I)},[]),E=w.useCallback((I=null)=>{console.error("Login failure:",I),d("Login failed. Please check your credentials and try again."),F()},[]),F=w.useCallback(()=>{i({username:"",password:""}),d(""),c(!1)},[]),j=w.useCallback((I,U)=>{const K={id:Date.now(),message:I,type:U,timestamp:new Date};h(te=>[...te,K]),setTimeout(()=>{h(te=>te.filter(re=>re.id!==K.id))},pg.NOTIFICATION_DURATION)},[]),P=w.useCallback(I=>{const{name:U,value:K}=I.target;i(te=>({...te,[U]:K})),u&&d("")},[u]),M=w.useCallback(I=>{I.key==="Enter"&&!o&&v(I)},[v,o]);return l.jsxs(Ze.div,{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900 flex items-center justify-center p-4",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsxs(Ze.div,{className:"w-full max-w-md",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsxs(Ze.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx(Ze.div,{className:"flex justify-center mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.5,type:"spring"},children:l.jsx("img",{src:"/pics/logo_mws.png",alt:"MWS Logo",className:"h-64 w-64 object-contain"})}),l.jsx(Ze.h1,{className:"text-2xl font-bold mb-2 text-cyan-400 tracking-wider",style:{fontFamily:"monospace",textShadow:"0 0 10px rgba(0, 255, 255, 0.5), 0 0 20px rgba(0, 255, 255, 0.3), 2px 2px 0px #000, -2px -2px 0px #000, 2px -2px 0px #000, -2px 2px 0px #000, 0px 2px 0px #000, 0px -2px 0px #000, 2px 0px 0px #000, -2px 0px 0px #000"},initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.3},children:"TEST MANAGEMENT SYSTEM"}),l.jsx(Ze.div,{className:"text-lg text-cyan-400 tracking-wider",style:{fontFamily:"monospace",textShadow:"0 0 5px rgba(0, 255, 255, 0.5)"},initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.3},children:l.jsx("div",{children:"FOR MATHAYOMWATSING SCHOOL STUDENTS"})})]}),l.jsxs(Ze.div,{className:"bg-black rounded-xl shadow-2xl p-8 border-2 border-cyan-400",style:{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.7,duration:.5,type:"spring"},children:[l.jsx(Ze.h2,{className:"text-2xl font-semibold text-center mb-6 text-yellow-400 tracking-wider",style:{fontFamily:"monospace",textShadow:"0 0 10px rgba(255, 215, 0, 0.5)"},initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{delay:.8,duration:.3},children:"LOGIN"}),l.jsxs("form",{onSubmit:v,className:"space-y-6",children:[l.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.9,duration:.3},children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium mb-2 text-cyan-400 tracking-wider",style:{fontFamily:"monospace"},children:"USERNAME"}),l.jsx(Ze.input,{type:"text",id:"username",name:"username",value:a.username,onChange:P,onKeyDown:M,placeholder:"ENTER YOUR USERNAME",required:!0,autoComplete:"username",autoCapitalize:"none",spellCheck:!1,disabled:o,className:"w-full px-4 py-3 bg-gray-800 border-2 border-yellow-400 rounded-lg text-yellow-400 placeholder-purple-400 focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 transition-all duration-200 disabled:bg-gray-900 disabled:border-gray-600 disabled:cursor-not-allowed disabled:text-gray-500",style:{fontFamily:"monospace",boxShadow:"0 0 10px rgba(255, 215, 0, 0.2)",textShadow:"0 0 5px rgba(255, 215, 0, 0.3)"},"aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02,boxShadow:"0 0 15px rgba(0, 255, 255, 0.4)"},transition:{duration:.2}})]}),l.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:1,duration:.3},children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium mb-2 text-cyan-400 tracking-wider",style:{fontFamily:"monospace"},children:"PASSWORD"}),l.jsx(Ze.input,{type:"password",id:"password",name:"password",value:a.password,onChange:P,onKeyDown:M,placeholder:"ENTER YOUR PASSWORD",required:!0,autoComplete:"current-password",disabled:o,className:"w-full px-4 py-3 bg-gray-800 border-2 border-yellow-400 rounded-lg text-yellow-400 placeholder-purple-400 focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 transition-all duration-200 disabled:bg-gray-900 disabled:border-gray-600 disabled:cursor-not-allowed disabled:text-gray-500",style:{fontFamily:"monospace",boxShadow:"0 0 10px rgba(255, 215, 0, 0.2)",textShadow:"0 0 5px rgba(255, 215, 0, 0.3)"},"aria-describedby":u?"error-message":void 0,whileFocus:{scale:1.02,boxShadow:"0 0 15px rgba(0, 255, 255, 0.4)"},transition:{duration:.2}})]}),l.jsx(Ai,{children:u&&l.jsx(Ze.div,{id:"error-message",className:"bg-gray-800 border-2 border-red-500 rounded-lg p-3",style:{boxShadow:"0 0 15px rgba(239, 68, 68, 0.5), inset 0 0 10px rgba(239, 68, 68, 0.1)"},role:"alert","aria-live":"polite",initial:{opacity:0,height:0,y:-10},animate:{opacity:1,height:"auto",y:0},exit:{opacity:0,height:0,y:-10},transition:{duration:.3},children:l.jsx("p",{className:"text-sm text-red-400 tracking-wider",style:{fontFamily:"monospace"},children:u.toUpperCase()})})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.1,duration:.3},children:l.jsx(Ze.button,{type:"submit",disabled:o,className:"w-full px-6 py-4 bg-yellow-400 text-black font-bold rounded-lg border-2 border-cyan-400 tracking-wider disabled:opacity-50 disabled:cursor-not-allowed relative overflow-hidden",style:{fontFamily:"monospace",boxShadow:"0 0 20px rgba(255, 215, 0, 0.5), 0 0 40px rgba(0, 255, 255, 0.3)",textShadow:"0 0 5px rgba(0, 0, 0, 0.5)"},whileHover:{scale:1.05,boxShadow:"0 0 30px rgba(255, 215, 0, 0.7), 0 0 60px rgba(0, 255, 255, 0.5)"},whileTap:{scale:.95},transition:{duration:.2},children:o?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",className:"mr-2"}),"LOGGING IN..."]}):"LOG IN"})})]}),l.jsx(Ze.div,{className:"mt-6 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.2,duration:.3},children:l.jsx(IU,{to:"/privacy",className:"text-xs text-purple-400 hover:text-cyan-400 underline tracking-wider transition-colors duration-200",style:{fontFamily:"monospace",textShadow:"0 0 5px rgba(147, 51, 234, 0.5)"},children:"PRIVACY POLICY"})})]})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:l.jsx(Ai,{children:f.map(I=>l.jsx(Ze.div,{initial:{opacity:0,x:300,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:300,scale:.8},transition:{duration:.3,type:"spring"},children:l.jsx(bu,{type:I.type,message:I.message,onClose:()=>h(U=>U.filter(K=>K.id!==I.id))})},I.id))})})]})},Xs={async getStudentData(){console.log("getStudentData called - loading student subjects");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-subjects")).json();if(t.success)return console.log("Student data loaded successfully:",t.subjects),t.subjects;throw new Error(t.error||"Failed to load student data")}catch(e){throw console.error("Error loading student data:",e),e}},getStudentSubjects(e){return console.log("getStudentSubjects called with subjects:",e),e.map(t=>({id:t.id||t.subject_id,name:t.subject,grade:t.grade,class:t.class,testResults:t.test_results||[]}))},async getTeacherData(){console.log("getTeacherData called - loading teacher subjects");try{const e=await this.getCurrentTeacherId();if(!e)throw new Error("No valid teacher session found");const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-subjects")).json();if(r.success)return console.log("Teacher data loaded successfully:",r.subjects),{teacher_id:e,subjects:r.subjects,hasSubjects:r.subjects.length>0};throw new Error(r.error||"Failed to load teacher data")}catch(e){throw console.error("Error loading teacher data:",e),e}},getTeacherSubjects(e){return console.log("getTeacherSubjects called with subjects:",e),e.map(t=>{let r=[];return t.classes&&Array.isArray(t.classes)&&(r=t.classes.map(n=>({grade:n.grade,class:n.class,className:n.class}))),{id:t.subject_id,name:t.subject,classes:r,assignments:t.assignments||[],description:t.description||""}})},getGradeButtons(){return console.log("getGradeButtons called"),["M1","M2","M3","M4","M5","M6"].map(t=>({id:t,name:t,classes:this.generateClassButtons(t)}))},generateClassButtons(e){const t=[];for(let r=1;r<=10;r++)t.push({id:`${e}_${r}`,name:`${e}/${r}`,grade:e,class:r});return t},async getAdminData(){console.log("getAdminData called - loading admin data");try{if(!await this.getCurrentAdminId())throw new Error("No valid admin session found");const[t,r,n]=await Promise.allSettled([this.getAllTeachers(),this.getAllSubjects(),this.getAllUsers()]);return{teachers:t.status==="fulfilled"?t.value:[],subjects:r.status==="fulfilled"?r.value:[],users:n.status==="fulfilled"?n.value:[],loadedAt:new Date().toISOString()}}catch(e){throw console.error("Error loading admin data:",e),e}},async saveTeacherSubjects(e){console.log("saveTeacherSubjects called with subjects:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-teacher-subjects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subjects:e})})).json();if(r.success)return console.log("Teacher subjects saved successfully"),r;throw new Error(r.error||"Failed to save teacher subjects")}catch(t){throw console.error("Error saving teacher subjects:",t),t}},async deleteTeacherSubject(e){console.log("deleteTeacherSubject called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/delete-teacher-subject",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher subject assignment deleted successfully"),r;throw new Error(r.error||"Failed to delete teacher subject assignment")}catch(t){throw console.error("Error deleting teacher subject assignment:",t),t}},async getSubjectsDropdown(){console.log("getSubjectsDropdown called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("Subjects dropdown data loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,value:r.subject_name}));throw new Error(t.error||"Failed to load subjects dropdown")}catch(e){throw console.error("Error loading subjects dropdown:",e),e}},async getGradesAndClasses(){console.log("getGradesAndClasses called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-teacher-grades-classes")).json();if(t.success)return console.log("Grades and classes loaded successfully"),t.data;throw new Error(t.message||"Failed to load grades and classes")}catch(e){throw console.error("Error loading grades and classes:",e),e}},async saveSubjectClasses(e,t){console.log("saveSubjectClasses called with subjectId:",e,"classes:",t);try{const r=await this.getCurrentTeacherId();if(!r)throw new Error("No valid teacher session found");const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-subject-classes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({teacher_id:r,subject_id:e,classes:t})})).json();if(s.success)return console.log("Subject classes saved successfully"),s;throw new Error(s.error||"Failed to save subject classes")}catch(r){throw console.error("Error saving subject classes:",r),r}},async getAllSubjects(){console.log("getAllSubjects called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-subjects")).json();if(t.success)return console.log("All subjects loaded successfully"),t.subjects.map(r=>({id:r.id,name:r.subject_name,description:r.description||"",created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all subjects")}catch(e){throw console.error("Error loading all subjects:",e),e}},async getSubjectsForSelection(){console.log("getSubjectsForSelection called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-subjects")).json();if(t.success)return console.log("Subjects for selection loaded successfully"),t.subjects;throw new Error(t.message||"Failed to load subjects for selection")}catch(e){throw console.error("Error loading subjects for selection:",e),e}},async addAcademicYear(e){console.log("addAcademicYear called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/add-academic-year",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Academic year added successfully"),r;throw new Error(r.error||"Failed to add academic year")}catch(t){throw console.error("Error adding academic year:",t),t}},async getAllUsers(){console.log("getAllUsers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-users")).json();if(t.success)return console.log("All users loaded successfully"),t.users.map(r=>({id:r.id,student_id:r.student_id,grade:r.grade,class:r.class,number:r.number,name:r.name,surname:r.surname,nickname:r.nickname,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all users")}catch(e){throw console.error("Error loading all users:",e),e}},async getAllTeachers(){console.log("getAllTeachers called");try{const t=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-all-teachers")).json();if(t.success)return console.log("All teachers loaded successfully"),t.teachers.map(r=>({id:r.id,teacher_id:r.teacher_id,username:r.username,name:r.name,surname:r.surname,email:r.email,created_at:r.created_at,updated_at:r.updated_at}));throw new Error(t.error||"Failed to load all teachers")}catch(e){throw console.error("Error loading all teachers:",e),e}},async createUser(e){console.log("createUser called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-user",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("User created successfully"),r;throw new Error(r.error||"Failed to create user")}catch(t){throw console.error("Error creating user:",t),t}},async updateUser(e,t){console.log("updateUser called with userId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-user/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("User updated successfully"),n;throw new Error(n.error||"Failed to update user")}catch(r){throw console.error("Error updating user:",r),r}},async createTeacher(e){console.log("createTeacher called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-teacher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Teacher created successfully"),r;throw new Error(r.error||"Failed to create teacher")}catch(t){throw console.error("Error creating teacher:",t),t}},async updateTeacher(e,t){console.log("updateTeacher called with teacherId:",e,"data:",t);try{const n=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/update-teacher/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(n.success)return console.log("Teacher updated successfully"),n;throw new Error(n.error||"Failed to update teacher")}catch(r){throw console.error("Error updating teacher:",r),r}},async updateStudentInfo(e){console.log("updateStudentInfo called with data:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-student-info",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(r.success)return console.log("Student info updated successfully"),r;throw new Error(r.error||"Failed to update student info")}catch(t){throw console.error("Error updating student info:",t),t}},async changePassword(e){console.log("changePassword called");let t;if(e.studentId)t="/.netlify/functions/change-student-password";else if(e.username)t="/.netlify/functions/change-teacher-password";else throw new Error("Invalid password data: missing studentId or username");try{const n=await(await window.tokenManager.makeAuthenticatedRequest(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();if(n.success)return console.log("Password changed successfully"),n;throw new Error(n.error||"Failed to change password")}catch(r){throw console.error("Error changing password:",r),r}},async getCurrentTeacherId(){try{const{SecureToken:e}=await ui(async()=>{const{SecureToken:n}=await Promise.resolve().then(()=>G4);return{SecureToken:n}},void 0),t=await(window.tokenManager?.getToken()||e.get())||localStorage.getItem("accessToken");if(!t)return null;const r=JSON.parse(atob(t.split(".")[1]));return r.teacher_id||r.sub||null}catch(e){return console.error("Error getting current teacher ID:",e),null}},async getCurrentAdminId(){try{const{SecureToken:e}=await ui(async()=>{const{SecureToken:n}=await Promise.resolve().then(()=>G4);return{SecureToken:n}},void 0),t=await(window.tokenManager?.getToken()||e.get())||localStorage.getItem("accessToken");if(!t)return null;const r=JSON.parse(atob(t.split(".")[1]));return r.admin_id||r.sub||null}catch(e){return console.error("Error getting current admin ID:",e),null}}},MV=w.createContext(),RV=({children:e})=>{const[t,r]=w.useState(null),[n,s]=w.useState([]),[a,i]=w.useState([]),[o,c]=w.useState([]),[u,d]=w.useState([]),[f,h]=w.useState([]),[g,p]=w.useState([]),[x,v]=w.useState([]),[C,b]=w.useState(!1),[_,T]=w.useState(null),[N,E]=w.useState(!1),[F,j]=w.useState(!1),[P,M]=w.useState(!1),[I,U]=w.useState(null),[K,te]=w.useState(null),[re,Z]=w.useState(null),B=w.useCallback(async()=>{try{b(!0),T(null);const Fe=`student_subjects_${t?.student_id||t?.id||""}`;console.log(" UserContext: Checking cache for key:",Fe);const Be=Os(Fe);if(Be){console.log(" UserContext: Cache HIT! Using cached student data"),s(Be),J(Be);return}console.log(" UserContext: Cache MISS! Fetching from API");const Pe=await Xs.getStudentData();if(Pe)s(Pe),J(Pe),console.log(" UserContext: Caching student data with key:",Fe),vs(Fe,Pe,hs.student_subjects);else throw new Error("No subjects data received")}catch(ve){T(ve.message||"Failed to load student data"),console.error("Error loading student data:",ve)}finally{b(!1)}},[t?.student_id,t?.id]),J=ve=>{console.log("Displaying student subjects:",ve),s(ve)},z=w.useCallback(async()=>{try{if(b(!0),T(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid teacher session found in loadTeacherData, redirecting to login"),T("No valid teacher session found");return}const Fe=`teacher_subjects_${t?.teacher_id||t?.id||""}`,Be=Os(Fe);if(Be){s(Be),Be.length===0?At():q(Be);return}const Pe=await Xs.getTeacherSubjects();if(Pe.success)s(Pe.subjects),vs(Fe,Pe.subjects,hs.teacher_subjects),Pe.subjects.length===0?At():q(Pe.subjects);else throw new Error(Pe.message||"Failed to load teacher data")}catch(ve){T(ve.message||"Failed to load teacher data"),console.error("Error loading teacher data:",ve)}finally{b(!1)}},[t?.teacher_id,t?.id]),q=ve=>{console.log("Showing main cabinet with subjects:",ve),s(ve)},H=ve=>{console.log("Displaying grade buttons:",ve),c(ve)},R=async()=>{try{if(b(!0),T(null),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.error("No valid admin session found in loadAdminData, redirecting to login"),T("No valid admin session found");return}await Promise.all([Ee(),vt(),Q()])}catch(ve){T(ve.message||"Failed to load admin data"),console.error("Error loading admin data:",ve)}finally{b(!1)}},L=ve=>{console.log(" populateStudentInfoDirectly called with:",ve);try{r(ve),console.log(" Set student profile:",ve)}catch(Fe){console.error("Error populating student info:",Fe)}},G=ve=>{console.log("=== populateStudentInfo called ==="),r(ve)},W=ve=>{console.log("=== populateTeacherInfo called ==="),r(ve)},Q=w.useCallback(async()=>{try{b(!0);const ve="admin_users_",Fe=Os(ve);if(Fe){d(Fe),X(Fe);return}const Be=await Xs.getAllUsers();if(Be.success)d(Be.users),X(Be.users),vs(ve,Be.users,hs.admin_users);else throw new Error(Be.message||"Failed to load users")}catch(ve){T(ve.message||"Failed to load users"),console.error("Error loading users:",ve)}finally{b(!1)}},[]),X=ve=>{console.log("Displaying all users:",ve),d(ve)},se=(ve,Fe)=>{console.log("Displaying users table:",ve,Fe),d(ve)},le=()=>{console.log("Toggling users content")},he=()=>{console.log("Showing add user form"),E(!0)},we=()=>{console.log("Hiding add user form"),E(!1)},ie=ve=>{console.log("Editing user row:",ve);const Fe=u.find(Be=>Be.id===ve);U(Fe)},Ee=w.useCallback(async()=>{try{const ve="admin_teachers_",Fe=Os(ve);if(Fe){h(Fe),ye(Fe);return}const Be=await Xs.getAllTeachers();if(Be.success)h(Be.teachers),ye(Be.teachers),vs(ve,Be.teachers,hs.admin_teachers);else throw new Error(Be.message||"Failed to load teachers")}catch(ve){T(ve.message||"Failed to load teachers"),console.error("Error loading teachers:",ve)}},[]),ye=ve=>{console.log("Displaying all teachers:",ve),h(ve)},Ie=(ve,Fe)=>{console.log("Displaying teachers table:",ve,Fe),h(ve)},ut=()=>{console.log("Toggling teachers content")},Qe=()=>{console.log("Showing add teacher form"),j(!0)},$t=()=>{console.log("Hiding add teacher form"),j(!1)},Ge=ve=>{console.log("Editing teacher:",ve);const Fe=f.find(Be=>Be.id===ve);te(Fe)},et=ve=>{console.log("Editing teacher row:",ve);const Fe=f.find(Be=>Be.id===ve);te(Fe)},vt=w.useCallback(async()=>{try{const ve="admin_subjects_",Fe=Os(ve);if(Fe){p(Fe),Te(Fe);return}const Be=await Xs.getAllSubjects();if(Be.success)p(Be.subjects),Te(Be.subjects),vs(ve,Be.subjects,hs.admin_subjects);else throw new Error(Be.message||"Failed to load subjects")}catch(ve){T(ve.message||"Failed to load subjects"),console.error("Error loading subjects:",ve)}},[]),Te=ve=>{console.log("Displaying all subjects:",ve),p(ve)},Ve=(ve,Fe)=>{console.log("Displaying subjects table:",ve,Fe),p(ve)},pt=()=>{console.log("Toggling subjects content")},wt=()=>{console.log("Showing add subject form"),M(!0)},Ut=()=>{console.log("Hiding add subject form"),M(!1)},ct=ve=>{console.log("Editing subject row:",ve);const Fe=g.find(Be=>Be.id===ve);Z(Fe)},yt=ve=>{console.log("Displaying academic year:",ve),v(ve)},rt=()=>{console.log("Showing add academic year form")},Oe=()=>{console.log("Hiding add academic year form")},$e=ve=>{console.log("Handling add academic year:",ve)},Mt=()=>{console.log("Toggling academic year content")},It=()=>{console.log("Showing academic year editor")},At=()=>{console.log("Showing subject selection")},tr=()=>{console.log("Showing main cabinet")},ar=ve=>{r(Fe=>({...Fe,...ve}))},dr=()=>{r(null),s([]),i([]),c([]),d([]),h([]),p([]),v([]),T(null)},or=w.useCallback(ve=>{dr(),ve&&w7(ve)},[]),mr={userProfile:t,userSubjects:n,userClasses:a,userGrades:o,allUsers:u,allTeachers:f,allSubjects:g,academicYears:x,isLoading:C,error:_,showUserForm:N,showTeacherForm:F,showSubjectForm:P,editingUser:I,editingTeacher:K,editingSubject:re,loadStudentData:B,displayStudentSubjects:J,populateStudentInfoDirectly:L,populateStudentInfo:G,loadTeacherData:z,showMainCabinetWithSubjects:q,displayGradeButtons:H,populateTeacherInfo:W,showSubjectSelection:At,showMainCabinet:tr,loadAdminData:R,getAllUsers:Q,displayAllUsers:X,displayUsersTable:se,toggleUsersContent:le,showAddUserForm:he,hideAddUserForm:we,editUserRow:ie,loadAllTeachers:Ee,displayAllTeachers:ye,displayTeachersTable:Ie,toggleTeachersContent:ut,showAddTeacherForm:Qe,hideAddTeacherForm:$t,editTeacher:Ge,editTeacherRow:et,loadAllSubjects:vt,displayAllSubjects:Te,displaySubjectsTable:Ve,toggleSubjectsContent:pt,showAddSubjectForm:wt,hideAddSubjectForm:Ut,editSubjectRow:ct,displayAcademicYear:yt,showAddAcademicYearForm:rt,hideAddAcademicYearForm:Oe,handleAddAcademicYear:$e,toggleAcademicYearContent:Mt,showAcademicYearEditor:It,updateUserProfile:ar,clearUserData:dr,clearUserDataWithCache:or,setUserProfile:r,setUserSubjects:s,setUserClasses:i,setUserGrades:c,setAllUsers:d,setAllTeachers:h,setAllSubjects:p,setAcademicYears:v,setError:T};return l.jsx(MV.Provider,{value:mr,children:e})},XS=()=>{const e=w.useContext(MV);if(!e)throw new Error("useUser must be used within a UserProvider");return e},a0={STUDENT_LOGIN:"/.netlify/functions/student-login",TEACHER_LOGIN:"/.netlify/functions/teacher-login",ADMIN_LOGIN:"/.netlify/functions/admin-login",CHANGE_PASSWORD:"/.netlify/functions/change-password",GET_TEST_QUESTIONS:"/.netlify/functions/get-test-questions",SUBMIT_MULTIPLE_CHOICE_TEST:"/.netlify/functions/submit-multiple-choice-test",SUBMIT_TRUE_FALSE_TEST:"/.netlify/functions/submit-true-false-test",SUBMIT_INPUT_TEST:"/.netlify/functions/submit-input-test",SUBMIT_MATCHING_TEST:"/.netlify/functions/submit-matching-test",SUBMIT_DRAWING_TEST:"/.netlify/functions/submit-drawing-test",GET_STUDENT_SUBJECTS:"/.netlify/functions/get-student-subjects",GET_TEACHER_SUBJECTS:"/.netlify/functions/get-teacher-subjects",GET_ALL_USERS:"/.netlify/functions/get-all-users",GET_ALL_TEACHERS:"/.netlify/functions/get-all-teachers",GET_ALL_SUBJECTS:"/.netlify/functions/get-all-subjects",GET_ACADEMIC_YEAR:"/.netlify/functions/get-academic-year",SAVE_MULTIPLE_CHOICE_TEST:"/.netlify/functions/save-multiple-choice-test",SAVE_TRUE_FALSE_TEST:"/.netlify/functions/save-true-false-test",SAVE_INPUT_TEST:"/.netlify/functions/save-input-test",SAVE_MATCHING_TEST:"/.netlify/functions/save-matching-test",SAVE_DRAWING_TEST:"/.netlify/functions/save-drawing-test",UPDATE_DRAWING_TEST_SCORE:"/.netlify/functions/update-drawing-test-score",UPDATE_SPEAKING_TEST_SCORE:"/.netlify/functions/update-speaking-test-score",UPDATE_TEST_SCORE:"/.netlify/functions/update-test-score",ASSIGN_TEST_TO_CLASSES:"/.netlify/functions/assign-test-to-classes",GET_TEACHER_ACTIVE_TESTS:"/.netlify/functions/get-teacher-active-tests",GET_STUDENT_ACTIVE_TESTS:"/.netlify/functions/get-student-active-tests"},us={MULTIPLE_CHOICE:"multiple_choice",TRUE_FALSE:"true_false",INPUT:"input",MATCHING:"matching_type",WORD_MATCHING:"word_matching",DRAWING:"drawing",FILL_BLANKS:"fill_blanks"},Ko={STUDENT:"student",TEACHER:"teacher",ADMIN:"admin"};Array.from({length:10},(e,t)=>t+1);const pg={NOTIFICATION_DURATION:3e3},Zf=(e,t,r)=>{if(!e||!Array.isArray(e)||e.length===0)return{score:0,total:0,percentage:0};let n=0;return e.forEach((s,a)=>{const i=Array.isArray(t)?t[a]:t[String(s.question_id||s.id||a)];i!=null&&g1(s,i,r)&&n++}),{score:n,total:e.length,percentage:Math.round(n/e.length*100)}},r2=(e,t)=>{console.log(" Getting correct answer for question:",e,"testType:",t);let r="";switch(t){case us.TRUE_FALSE:r=e.correct_answer?"true":"false",console.log(" TRUE_FALSE correct_answer from question:",r,typeof r);break;case us.MULTIPLE_CHOICE:const n=e.correct_answer.charCodeAt(0)-65,s=`option_${String.fromCharCode(97+n)}`,a=e[s];a?r=a:r=`Option ${e.correct_answer}`;break;case us.INPUT:e.correct_answers&&Array.isArray(e.correct_answers)?r=e.correct_answers.join(", "):r=e.correct_answer||"Unknown";break;case us.MATCHING:r=e.correct_answer||e.answer;break;case us.WORD_MATCHING:r=e.correct_answer||e.answer;break;case us.DRAWING:r="Drawing required";break;case us.FILL_BLANKS:e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?r=e.correct_answers[0]:r=e.correct_answer||"Unknown";break;default:r="Unknown"}return console.log(" Correct answer:",r),r},g1=(e,t,r)=>{if(console.log("[DEBUG] checkAnswerCorrectness called for question:",e,"studentAnswer:",t,"testType:",r),!t||t==="")return console.log("[DEBUG] No student answer provided"),!1;let n=!1;switch(r){case us.TRUE_FALSE:n=t.toLowerCase()==="true"===e.correct_answer;break;case us.MULTIPLE_CHOICE:let a="";if(typeof t=="string"){const o=t.trim();if(/^[a-z]$/i.test(o))a=o.toUpperCase();else if(/^\d+$/.test(o)){const c=parseInt(o,10),u=c>=0?c:NaN;Number.isNaN(u)||(a=String.fromCharCode(65+u))}}else if(typeof t=="number"){const o=t;Number.isNaN(o)||(a=String.fromCharCode(65+o))}n=a!==""&&a===String(e.correct_answer||"").toUpperCase();break;case us.INPUT:if(e.correct_answers&&Array.isArray(e.correct_answers)){const o=t.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();n=e.correct_answers.some(c=>{const u=c.replace(/[.,/*';:!@#$%^&*()_+=\[\]{}|\\:";'<>?,.\s-]+/g,"").toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1})}else{const o=t.toLowerCase().trim(),c=e.correct_answer.toLowerCase().trim();o===c?n=!0:c&&o.includes(c)?c.length===1?n=o.startsWith(c)||o.endsWith(c):n=!0:n=!1}break;case us.MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case us.WORD_MATCHING:if(e.correct_answer&&typeof e.correct_answer=="object"){const o=typeof t=="string"?JSON.parse(t||"{}"):t;n=JSON.stringify(o)===JSON.stringify(e.correct_answer)}break;case us.DRAWING:console.warn("Drawing tests should not be auto-scored!"),n=!1;break;case us.FILL_BLANKS:const i=e.correct_answers&&Array.isArray(e.correct_answers)&&e.correct_answers.length>0?e.correct_answers[0]:e.correct_answer;if(i&&t){let o="";if(typeof t=="string"){const c=t.trim();if(/^[a-z]$/i.test(c))o=c.toUpperCase();else if(/^\d+$/.test(c)){const u=parseInt(c,10),d=u>=0?u:NaN;Number.isNaN(d)||(o=String.fromCharCode(65+d))}}else if(typeof t=="number"){const c=t;Number.isNaN(c)||(o=String.fromCharCode(65+c))}n=o!==""&&o===String(i||"").toUpperCase()}break;default:console.warn(`[WARN] Unknown test type for answer checking: ${r}`),n=!1}return console.log(`[DEBUG] Answer correctness: ${n}`),n};class Qhe{constructor(){this.academicCalendar=null,this.loaded=!1}async loadAcademicCalendar(){if(this.loaded)return this.academicCalendar;try{const t=async n=>{const s=await fetch(n,{headers:{Accept:"application/json"},credentials:"include"}),a=s.headers&&s.headers.get&&s.headers.get("content-type")||"";if(!s.ok)throw new Error(`HTTP ${s.status}`);if(!a.includes("application/json"))throw new Error("Non-JSON response");return await s.json()};let r=null;if(r=await t("/academic_year.json"),!Array.isArray(r))throw new Error("Invalid academic calendar format");return this.academicCalendar=r,this.loaded=!0,console.log(" Academic calendar loaded:",this.academicCalendar.length,"terms"),this.academicCalendar}catch(t){return console.error(" Error loading academic calendar:",t),null}}getCurrentTerm(){if(!this.academicCalendar)return null;const t=new Date;return this.academicCalendar.find(n=>{const s=new Date(n.start_date),a=new Date(n.end_date);return t>=s&&t<=a})}getCurrentSemester(){const t=this.getCurrentTerm();if(!t)return null;const r=t.semester,n=this.academicCalendar.filter(s=>s.semester===r&&s.academic_year===t.academic_year);return{semester:r,currentTerm:t,allTerms:n}}getCurrentAcademicPeriodId(){return this.getCurrentTerm()?.id||null}getSemesterTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.semester===t):[]}getAcademicYearTerms(t){return this.academicCalendar?this.academicCalendar.filter(r=>r.academic_year===t):[]}getCurrentSemesterWithTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,allTerms:s,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getCurrentSemesterTerms(){const t=this.getCurrentSemester();if(!t)return null;const{semester:r,currentTerm:n,allTerms:s}=t;return{semester:r,currentTerm:n,terms:s.map(a=>({id:a.id,term:a.term,start_date:a.start_date,end_date:a.end_date,isCurrent:a.id===n.id,label:`Term ${a.term}${a.id===n.id?" (Current)":""}`}))}}getTermById(t){return this.academicCalendar?this.academicCalendar.find(r=>r.id===t):null}isCurrentTerm(t){return this.getCurrentTerm()?.id===t}getAcademicYears(){return this.academicCalendar?[...new Set(this.academicCalendar.map(r=>r.academic_year))].sort():[]}getAcademicYearSemesterTerms(t,r){return this.academicCalendar?this.academicCalendar.filter(n=>n.academic_year===t&&n.semester===r):[]}}const _u=new Qhe,JS=Object.freeze(Object.defineProperty({__proto__:null,academicCalendarService:_u},Symbol.toStringTag,{value:"Module"})),Pn={async getTestInfo(e,t){console.log(`[DEBUG] getTestInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test info data received:",s),s.success)return console.log("[DEBUG] Test info retrieved successfully"),s.test_info;throw new Error(s.error||"Failed to get test info")}catch(r){throw console.error("[ERROR] Failed to get test info:",r),r}},async getTestQuestions(e,t){console.log(`[DEBUG] getTestQuestions called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions data received:",s),s.success)return console.log("[DEBUG] Test questions retrieved successfully"),s.questions;throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions:",r),r}},async getTestQuestionsWithInfo(e,t){console.log(`[DEBUG] getTestQuestionsWithInfo called with testType: ${e}, testId: ${t}`);try{const r=`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`;console.log("[DEBUG] Fetching test questions with info from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Test questions with info data received:",s),s.success)return console.log("[DEBUG] Test questions with info retrieved successfully"),{questions:s.questions,testInfo:s.test_info};throw new Error(s.error||"Failed to get test questions")}catch(r){throw console.error("[ERROR] Failed to get test questions with info:",r),r}},async getActiveTests(){console.log("getActiveTests called - extracting studentId from JWT token");try{const e="/.netlify/functions/get-student-active-tests";console.log("[DEBUG] Fetching active tests from:",e);const t=await window.tokenManager.makeAuthenticatedRequest(e);if(console.log("[DEBUG] Response status:",t.status),!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Active tests data received:",r),r.success)return console.log("[DEBUG] Active tests retrieved successfully"),r.tests;throw new Error(r.error||"Failed to get active tests")}catch(e){throw console.error("[ERROR] Failed to get active tests:",e),e}},async getTeacherTests(e=!1){console.log("getTeacherTests called - extracting teacherId from JWT token");try{const t="/.netlify/functions/get-teacher-active-tests",r=e?`${t}?ts=${Date.now()}`:t;console.log("[DEBUG] Fetching teacher tests from:",r);const n=await window.tokenManager.makeAuthenticatedRequest(r);if(console.log("[DEBUG] Response status:",n.status),!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Teacher tests data received:",s),s.success)return console.log("[DEBUG] Teacher tests retrieved successfully"),s.tests;throw new Error(s.error||"Failed to get teacher tests")}catch(t){throw console.error("[ERROR] Failed to get teacher tests:",t),t}},async submitTest(e,t,r,n={},s=null){console.log("Submitting test:",{testType:e,testId:t});try{if(Object.keys(r).length===0)throw new Error("Please answer at least one question before submitting.");let a;try{const T=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-test-questions?test_type=${e}&test_id=${t}`)).json();if(T.success)a=T.test_info;else throw new Error("Failed to get test information")}catch(_){console.error("Error getting test info:",_);const T=await this.getTestQuestions(e,t);a={test_name:`Test ${t}`,num_questions:T.length}}const i=await this.getTestQuestions(e,t);let o,c;if(e==="drawing")o=null,c=null;else{const _=n?.answers_by_id?n.answers_by_id:r;o=Zf(i,_,e).score,c=a.num_questions}const u=this.transformAnswersForSubmission(r,e),d=a.teacher_id||null,f=a.subject_id||null,h=s?.student_id||s?.id||(window.tokenManager?.getCurrentUser?window.tokenManager.getCurrentUser()?.student_id||window.tokenManager.getCurrentUser()?.id:null);await _u.loadAcademicCalendar();const p=_u.getCurrentTerm()?.id;if(!p)throw new Error("No current academic period found");const x={test_id:t,test_name:a.test_name,test_type:e,teacher_id:d,subject_id:f,student_id:h,academic_period_id:p,answers:u,score:o,maxScore:c,time_taken:n.time_taken||null,started_at:n.started_at||null,submitted_at:n.submitted_at||new Date().toISOString(),caught_cheating:n.caught_cheating||!1,visibility_change_times:n.visibility_change_times||0,answers_by_id:n.answers_by_id||null,question_order:n.question_order||null,retest_assignment_id:n.retest_assignment_id||null,parent_test_id:n.parent_test_id||t};console.log(" testService retest_assignment_id:",n.retest_assignment_id),console.log(" testService timingData:",n),console.log(" testService commonData.retest_assignment_id:",x.retest_assignment_id);let v;switch(e){case"multiple_choice":v="/.netlify/functions/submit-multiple-choice-test";break;case"true_false":v="/.netlify/functions/submit-true-false-test";break;case"input":v="/.netlify/functions/submit-input-test";break;case"matching_type":v="/.netlify/functions/submit-matching-type-test";break;case"word_matching":v="/.netlify/functions/submit-word-matching-test";break;case"drawing":v="/.netlify/functions/submit-drawing-test";break;case"fill_blanks":v="/.netlify/functions/submit-fill-blanks-test";break;default:throw new Error(`Unsupported test type: ${e}`)}console.log("Submitting to:",v),console.log("Submission data:",x),console.log("Submission data JSON:",JSON.stringify(x,null,2)),console.log(" Final submission retest_assignment_id:",x.retest_assignment_id);const C=await window.tokenManager.makeAuthenticatedRequest(v,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const b=await C.json();if(console.log("Test submission result:",b),b.success)return this.clearTestProgress(e,t),{success:!0,score:o,maxScore:c,result:b};throw new Error(b.error||"Failed to submit test")}catch(a){throw console.error("Error submitting test:",a),a}},async createTest(e){try{return(await xa.post("/tests/create",e)).data}catch(t){throw new Error(t.message||"Failed to create test")}},async updateTest(e,t,r){try{return(await xa.put(`/tests/${e}/${t}`,r)).data}catch(n){throw new Error(n.message||"Failed to update test")}},async deleteTest(e,t){try{return(await xa.delete(`/tests/${e}/${t}`)).data}catch(r){throw new Error(r.message||"Failed to delete test")}},async duplicateTest(e,t){try{return(await xa.post(`/tests/${e}/${t}/duplicate`)).data}catch(r){throw new Error(r.message||"Failed to duplicate test")}},async publishTest(e,t){try{return(await xa.post(`/tests/${e}/${t}/publish`)).data}catch(r){throw new Error(r.message||"Failed to publish test")}},async unpublishTest(e,t){try{return(await xa.post(`/tests/${e}/${t}/unpublish`)).data}catch(r){throw new Error(r.message||"Failed to unpublish test")}},async removeClassAssignment(e,t,r){try{return(await xa.delete(`/tests/${e}/${t}/assignments/${r}`)).data}catch(n){throw new Error(n.message||"Failed to remove class assignment")}},async getTestStatistics(e,t){try{return(await xa.get(`/tests/${e}/${t}/statistics`)).data}catch(r){throw new Error(r.message||"Failed to get test statistics")}},async exportTest(e,t,r="json"){try{return(await xa.get(`/tests/${e}/${t}/export?format=${r}`)).data}catch(n){throw new Error(n.message||"Failed to export test")}},async importTest(e,t){try{return(await xa.uploadFile(`/tests/import?type=${t}`,e)).data}catch(r){throw new Error(r.message||"Failed to import test")}},async getTestResults(e,t){try{return(await xa.get(`/tests/${e}/${t}/results`)).data}catch(r){throw new Error(r.message||"Failed to get test results")}},async getStudentTestResults(){try{console.log("[DEBUG] Fetching student test results from: /.netlify/functions/get-student-test-results");const e=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-student-test-results");if(console.log("[DEBUG] Response status:",e.status),!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(console.log("[DEBUG] Student test results data received:",t),t.success)return console.log("[DEBUG] Student test results retrieved successfully"),t;throw new Error(t.error||"Failed to get student test results")}catch(e){throw console.error("[ERROR] Failed to get student test results:",e),new Error(e.message||"Failed to get student test results")}},async getClassResults(e,t,r){try{return(await xa.get(`/tests/class-results/${e}/${t}/${r}`)).data}catch(n){throw new Error(n.message||"Failed to get class results")}},async saveTestProgress(e,t,r){try{return(await xa.post(`/tests/${e}/${t}/progress`,{progress:r})).data}catch(n){throw new Error(n.message||"Failed to save test progress")}},async getTestProgress(e,t){try{return(await xa.get(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to get test progress")}},async clearTestProgress(e,t){try{return(await xa.delete(`/tests/${e}/${t}/progress`)).data}catch(r){throw new Error(r.message||"Failed to clear test progress")}},async validateTestData(e){try{return(await xa.post("/tests/validate",e)).data}catch(t){throw new Error(t.message||"Failed to validate test data")}},async getTestPreview(e,t){try{return(await xa.get(`/tests/${e}/${t}/preview`)).data}catch(r){throw new Error(r.message||"Failed to get test preview")}},isAnswerCorrect(e,t,r,n){switch(n){case"multiple_choice":return String.fromCharCode(65+parseInt(t))===r.correct_answer;case"true_false":return t.toLowerCase()==="true"===r.correct_answer;case"input":const i=r.correct_answers||[],o=t.toLowerCase().trim();return i.some(c=>{const u=c.toLowerCase().trim();return o===u?!0:u&&o.includes(u)?u.length===1?o.startsWith(u)||o.endsWith(u):!0:!1});case"matching_type":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"word_matching":return JSON.stringify(t)===JSON.stringify(r.correct_answer);case"drawing":return t&&t!=="No answer";default:return!1}},transformAnswersForSubmission(e,t){switch(t){case"multiple_choice":return e;case"true_false":return e;case"input":return e;case"matching_type":return e;case"word_matching":return e;case"drawing":if(Array.isArray(e)&&e.length>0)try{const r=e[0];return typeof r=="string"&&r.startsWith("[")?JSON.parse(r):e}catch(r){return console.warn("Failed to parse drawing answers:",r),e}return e;default:return e}},async markAssignmentCompleted(e){try{console.log(`[DEBUG] markAssignmentCompleted called with assignmentId: ${e}`);const t=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mark-test-completed",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignment_id:e})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Mark assignment completed response:",r),r.success)return console.log(`Assignment ${e} marked as completed successfully`),{success:!0,message:r.message};throw new Error(r.error||"Failed to mark assignment as completed")}catch(t){throw console.error("Error marking assignment completed:",t),t}},async activateAssignment(e){try{console.log(`[DEBUG] activateAssignment called with assignmentId: ${e}`);const t=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/activate-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assignment_id:e})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(console.log("[DEBUG] Activate assignment response:",r),r.success)return console.log(`Assignment ${e} activated successfully`),{success:!0,message:r.message};throw new Error(r.error||"Failed to activate assignment")}catch(t){throw console.error("Error activating assignment:",t),t}},clearTestProgress(e,t){try{const r=`test_progress_${e}_${t}`;localStorage.removeItem(r),console.log(`Test progress cleared for ${e}_${t}`)}catch(r){console.error("Error clearing test progress:",r)}},async saveMultipleChoiceTest(e){console.log("[DEBUG] saveMultipleChoiceTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-multiple-choice-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save multiple choice test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving multiple choice test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveTrueFalseTest(e){console.log("[DEBUG] saveTrueFalseTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-true-false-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save true/false test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving true/false test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveInputTest(e){console.log("[DEBUG] saveInputTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-input-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save input test response:",r),r.success?{success:!0,test_id:r.test_id,message:"Test saved successfully"}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving input test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveMatchingTest(e){console.log("[DEBUG] saveMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"matching_type",num_questions:e.num_blocks})})).json();return console.log("[DEBUG] Save matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveWordMatchingTest(e){console.log("[DEBUG] saveWordMatchingTest called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,test_type:"word_matching"})})).json();return console.log("[DEBUG] Save word matching test response:",r),r.success?{success:!0,test_id:r.test_id,message:r.message,assignments_count:r.assignments_count}:{success:!1,message:r.message||"Failed to save test"}}catch(t){return console.error("Error saving word matching test:",t),{success:!1,message:"Error saving test: "+t.message}}},async saveDrawingTest(e){console.log("[DEBUG] saveDrawingTest called with:",e);try{const t={...e,test_type:"drawing"},n=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();return console.log("[DEBUG] Save drawing test response:",n),n.success?{success:!0,data:{test_id:n.test_id}}:{success:!1,message:n.message||"Failed to save test"}}catch(t){return console.error("Error saving drawing test:",t),{success:!1,message:"Error saving test: "+t.message}}},async getDrawingTest(e){console.log("[DEBUG] getDrawingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-drawing-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get drawing test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting drawing test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitDrawingTest(e,t,r,n){console.log("[DEBUG] submitDrawingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-drawing-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit drawing test response:",a),a.success?{success:!0,data:a.data}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting drawing test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async updateDrawingTestScore(e,t,r){console.log("[DEBUG] updateDrawingTestScore called with:",{resultId:e,score:t,maxScore:r});try{const s=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-drawing-test-score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({result_id:e,score:t,max_score:r})})).json();return console.log("[DEBUG] Update drawing test score response:",s),s.success?{success:!0,data:s.data}:{success:!1,message:s.message||"Failed to update score"}}catch(n){return console.error("Error updating drawing test score:",n),{success:!1,message:"Error updating score: "+n.message}}},async getWordMatchingTest(e){console.log("[DEBUG] getWordMatchingTest called with testId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-word-matching-test?test_id=${e}`,{method:"GET"})).json();return console.log("[DEBUG] Get word matching test response:",r),r.success?{success:!0,data:r.data}:{success:!1,message:r.message||"Failed to get test"}}catch(t){return console.error("Error getting word matching test:",t),{success:!1,message:"Error getting test: "+t.message}}},async submitWordMatchingTest(e,t,r,n){console.log("[DEBUG] submitWordMatchingTest called with:",{testId:e,answers:t,timeTaken:r,antiCheatingData:n});try{const a=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/submit-word-matching-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_id:e,answers:t,time_taken:r,caught_cheating:n?.caught_cheating||!1,visibility_change_times:n?.visibility_change_times||0})})).json();return console.log("[DEBUG] Submit word matching test response:",a),a.success?{success:!0,result:a.result}:{success:!1,message:a.message||"Failed to submit test"}}catch(s){return console.error("Error submitting word matching test:",s),{success:!1,message:"Error submitting test: "+s.message}}},async assignTestToClasses(e){console.log("[DEBUG] assignTestToClasses called with:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return console.log("[DEBUG] Save test with assignments response:",r),r.success?{success:!0,message:"Test assigned successfully"}:{success:!1,message:r.message||"Failed to assign test"}}catch(t){return console.error("Error assigning test to classes:",t),{success:!1,message:"Error assigning test: "+t.message}}},async removeClassAssignment(e){console.log("[DEBUG] removeClassAssignment called with assignmentId:",e);try{const r=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/remove-class-assignment?assignment_id=${e}`,{method:"DELETE"})).json();return console.log("[DEBUG] Remove class assignment response:",r),r.success?{success:!0,message:"Assignment removed successfully"}:{success:!1,message:r.message||"Failed to remove assignment"}}catch(t){return console.error("Error removing class assignment:",t),{success:!1,message:"Error removing assignment: "+t.message}}},async updateTestQuestions(e,t,r){try{console.log(`[DEBUG] updateTestQuestions called with testType: ${e}, testId: ${t}`);const n=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-test-questions",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t,questions:r})});if(!n.ok){let a=`HTTP error! status: ${n.status}`;try{const i=await n.json();a=i.details||i.error||a,console.error("[DEBUG] Update questions error response:",i)}catch{}throw new Error(a)}const s=await n.json();if(console.log("[DEBUG] Update questions response:",s),s.success)return console.log(`Questions for ${e}_${t} updated successfully`),{success:!0,message:s.message};{const a=s.error||s.details||"Failed to update questions";throw console.error("[DEBUG] Update questions error:",a,s),new Error(a)}}catch(n){throw console.error("Error updating questions:",n),n}},async updateTestSettings(e,t,r){try{console.log(`[DEBUG] updateTestSettings called with testType: ${e}, testId: ${t}`);const n=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/update-test-settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({test_type:e,test_id:t,...r})});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.json();if(console.log("[DEBUG] Update settings response:",s),s.success)return console.log(`Settings for ${e}_${t} updated successfully`),{success:!0,message:s.message};throw new Error(s.error||"Failed to update settings")}catch(n){throw console.error("Error updating settings:",n),n}}},OV=w.createContext(),DV=({children:e})=>{const[t,r]=w.useState(null),[n,s]=w.useState([]),[a,i]=w.useState({}),[o,c]=w.useState({}),[u,d]=w.useState(!1),[f,h]=w.useState(null),[g,p]=w.useState([]),[x,v]=w.useState(!1),[C,b]=w.useState(null),[_,T]=w.useState({isOpen:!1,testType:null,testId:null,testName:null,questions:[]}),[N,E]=w.useState(null),[F,j]=w.useState(0),{getItem:P,setItem:M,removeItem:I}=vW();w.useEffect(()=>{let ve;return u&&N&&(ve=setInterval(()=>{const Fe=Math.floor((Date.now()-N)/1e3);j(Fe)},1e3)),()=>{ve&&clearInterval(ve)}},[u,N]);const U=async(ve,Fe)=>{try{v(!0),b(null),console.log(`[DEBUG] loadTestForPage called with testType: ${ve}, testId: ${Fe}`);const Be=await Pn.getTestInfo(ve,Fe);console.log("[DEBUG] Test info retrieved:",Be);const Pe=await Pn.getTestQuestions(ve,Fe);console.log("[DEBUG] Test questions retrieved:",Pe),r({...Be,testType:ve,testId:Fe}),s(Pe),d(!0),E(Date.now()),j(0),K(ve,Fe),console.log("[DEBUG] Test loaded successfully")}catch(Be){b(Be.message||"Failed to load test"),console.error("Error loading test:",Be)}finally{v(!1)}},K=(ve,Fe)=>{try{const Be=`test_progress_${ve}_${Fe}`,Pe=P(Be);Pe&&(i(Pe.answers||{}),c(Pe.progress||{}))}catch(Be){console.error("Error loading saved progress:",Be)}},te=(ve,Fe,Be,Pe)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot save progress: No valid JWT token");return}const Ct=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${ve}_${Fe}`,Lt={...a,[Be]:Pe},Ue={...o,[Be]:{answered:!0,timestamp:Date.now()}};i(Lt),c(Ue),M(Ct,{answers:Lt,progress:Ue,lastSaved:Date.now()}),console.log(`Saved progress for question ${Be}:`,Pe)}catch(lt){console.error("Error saving test progress:",lt)}},re=(ve,Fe,Be)=>{try{if(window.tokenManager&&!window.tokenManager.isAuthenticated())return console.warn("[WARN] Cannot get progress: No valid JWT token"),null;const lt=`test_progress_${window.tokenManager?.getDecodedToken()?.sub||"unknown"}_${ve}_${Fe}`;return P(lt)?.answers?.[Be]||null}catch(Pe){return console.error("Error getting test progress:",Pe),null}},Z=(ve,Fe)=>{try{if(console.log(`[DEBUG] clearTestProgress called with testType: ${ve}, testId: ${Fe}`),window.tokenManager&&!window.tokenManager.isAuthenticated()){console.warn("[WARN] Cannot clear progress: No valid JWT token");return}const Be=window.tokenManager?.getDecodedToken()?.sub||"unknown",Pe=`test_progress_${Be}_${ve}_${Fe}`;console.log(`[DEBUG] Removing localStorage key: ${Pe}`);const lt=P(Pe)!==null;I(Pe),i({}),c({});for(let Ct=0;Ct<localStorage.length;Ct++){const Lt=localStorage.key(Ct);Lt&&Lt.startsWith(`test_progress_${Be}_${ve}_${Fe}_`)&&(localStorage.removeItem(Lt),console.log(`[DEBUG] Cleared individual question key: ${Lt}`))}console.log(lt?`[DEBUG] Progress cleared for test ${ve}_${Fe}`:`[DEBUG] No progress found to clear for test ${ve}_${Fe}`)}catch(Be){console.error("Error clearing test progress:",Be)}},B=async(ve,Fe,Be="")=>{try{v(!0),b(null),console.log("Submitting test:",{testType:ve,testId:Fe});const Pe=Q(ve,Fe);if(Object.keys(Pe).length===0){b("Please answer at least one question before submitting.");return}let lt;try{lt=await Pn.getTestInfo(ve,Fe)}catch(Yt){console.error("Error getting test info:",Yt);const xr=await Pn.getTestQuestions(ve,Fe);lt={test_name:`Test ${Fe}`,num_questions:xr.length}}const Ct=await Pn.getTestQuestions(ve,Fe),Lt=Zf(Ct,Pe,ve),Ue=lt.num_questions,st=se(Pe,ve),dt={test_id:Fe,test_name:lt.test_name,score:Lt,maxScore:Ue,answers:st},Bt=await Pn.submitTest(ve,Fe,dt);if(Bt.success){if(h(Bt.result),H(ve,Fe,Be),Z(ve,Fe),Be){const Yt=`student_results_table_${Be}`;ve!=="drawing"?(console.log(" TestContext: Caching test results after submission with key:",Yt),vs(Yt,Bt.result,hs.student_results_table)):console.log(" TestContext: Skipping cache for drawing test submission (teacher-scored).")}return Be&&j1(Be,ve,Fe),d(!1),Bt.results}else throw new Error(Bt.message||"Test submission failed")}catch(Pe){throw b(Pe.message||"Failed to submit test"),Pe}finally{v(!1)}},J=(ve,Fe,Be)=>{h({testType:ve,testId:Fe,answers:Be}),d(!1)},z=()=>{r(null),s([]),i({}),c({}),d(!1),h(null),b(null),E(null),j(0)},q=(ve,Fe,Be="")=>{try{const Pe=`test_completed_${Be}_${ve}_${Fe}`;return P(Pe)===!0}catch(Pe){return console.error("Error checking test completion:",Pe),!1}},H=(ve,Fe,Be="")=>{try{const Pe=`test_completed_${Be}_${ve}_${Fe}`;M(Pe,!0)}catch(Pe){console.error("Error marking test completed:",Pe)}},R=ve=>Object.keys(a).length,L=()=>{const ve=R(t?.testType),Fe=n.length;return{canSubmit:ve===Fe,answeredCount:ve,totalQuestions:Fe}},G=()=>{t&&Z(t.testType,t.testId),z()},W=(ve="")=>{try{const Fe=`student_results_table_${ve}`;console.log(" TestContext: Clearing test results cache:",Fe),localStorage.removeItem(Fe),console.log(" TestContext: Test results cache cleared")}catch(Fe){console.error("Error clearing test results cache:",Fe)}},Q=(ve,Fe)=>({...a}),X=(ve,Fe,Be=null)=>{try{if(!ve)return"No answer";switch(Fe){case"true_false":return ve?"True":"False";case"multiple_choice":if(Be&&typeof ve=="string"&&!isNaN(parseInt(ve))){const Pe=parseInt(ve),lt=`option_${String.fromCharCode(97+Pe)}`,Ct=Be[lt];if(Ct)return Ct}return String(ve).toUpperCase();case"input":return String(ve);case"matching_type":return typeof ve=="object"?Object.entries(ve).map(([Pe,lt])=>`${Pe}  ${lt}`).join(", "):String(ve);case"word_matching":return typeof ve=="object"?Object.entries(ve).map(([Pe,lt])=>`${Pe}  ${lt}`).join(", "):String(ve);case"drawing":return"Drawing submitted";default:return String(ve)}}catch(Pe){return console.error("Error formatting student answer:",Pe),"Error displaying answer"}},se=(ve,Fe)=>{try{if(!ve||typeof ve!="object")return{};const Be={};return Object.entries(ve).forEach(([Pe,lt])=>{if(lt!=null)switch(Fe){case"true_false":Be[Pe]=!!lt;break;case"multiple_choice":Be[Pe]=String(lt).toUpperCase();break;case"input":Be[Pe]=String(lt).trim();break;case"matching_type":typeof lt=="object"?Be[Pe]=lt:Be[Pe]=String(lt);break;case"word_matching":typeof lt=="object"?Be[Pe]=lt:Be[Pe]=String(lt);break;case"drawing":Be[Pe]=lt;break;default:Be[Pe]=lt}}),Be}catch(Be){return console.error("Error transforming answers for submission:",Be),ve||{}}},le=w.useCallback(async(ve="")=>{const Fe=`student_active_tests_${ve}`,Be=b7(Fe,{includeExpired:!0}),Pe=Be?.data,lt=Array.isArray(Pe)?!0:!!Pe,Ct=hs.student_active_tests?hs.student_active_tests*.5:0,Lt=!lt||Be?.isExpired||Ct>0&&Be?.age>Ct,Ue=!lt||Be?.isExpired===!0;if(lt&&p(Pe),!Lt)return v(!1),Pe;if(!Ue&&lt)return v(!1),(async()=>{try{const st=await Pn.getActiveTests();if(p(st),vs(Fe,st,hs.student_active_tests),ve)try{localStorage.setItem(`last_cabinet_refresh_${ve}`,Date.now().toString())}catch(dt){console.warn("Unable to persist last cabinet refresh timestamp:",dt)}}catch(st){console.warn("Background refresh of active tests failed:",st)}})(),Pe;v(!0);try{const st=await Pn.getActiveTests();if(p(st),vs(Fe,st,hs.student_active_tests),ve)try{localStorage.setItem(`last_cabinet_refresh_${ve}`,Date.now().toString())}catch(dt){console.warn("Unable to persist last cabinet refresh timestamp:",dt)}return st}catch(st){return b(st.message||"Failed to load active tests"),p([]),[]}finally{v(!1)}},[]),he=async()=>{try{return v(!0),await Pn.getTeacherTests()}catch(ve){return b(ve.message||"Failed to load teacher tests"),[]}finally{v(!1)}},we=async ve=>{try{return v(!0),await Pn.createTest(ve)}catch(Fe){throw b(Fe.message||"Failed to create test"),Fe}finally{v(!1)}},ie=async(ve,Fe)=>{try{return v(!0),await Pn.deleteTest(ve,Fe)}catch(Be){throw b(Be.message||"Failed to delete test"),Be}finally{v(!1)}},Ee=async(ve,Fe)=>{try{return await Pn.getTestInfo(ve,Fe)}catch(Be){throw console.error("Error getting test info:",Be),Be}},ye=async(ve,Fe)=>{try{return await Pn.getTestQuestions(ve,Fe)}catch(Be){throw console.error("Error getting test questions:",Be),Be}},Ie=async(ve,Fe,Be)=>{try{console.log("Showing test results:",{testType:ve,testId:Fe,studentAnswers:Be});const Pe=await Ee(ve,Fe),lt=await ye(ve,Fe);$t(Pe,lt,ve,Be),d(!1),console.log("Test results displayed successfully")}catch(Pe){console.error("Error showing test results:",Pe),b("Failed to display test results"),h({testType:ve,testId:Fe,answers:Be,showResults:!0,error:"Could not load detailed results"}),d(!1)}},ut=async(ve,Fe,Be)=>{try{v(!0);const Pe=await Ee(ve,Fe),lt=await ye(ve,Fe);$t(Pe,lt,ve,Be)}catch(Pe){b(Pe.message||"Failed to load test results")}finally{v(!1)}},Qe=w.useCallback(async(ve="")=>{try{v(!0);const Fe=`student_results_table_${ve}`;console.log(" TestContext: Checking cache for key:",Fe);const Be=Os(Fe);if(Be)return console.log(" TestContext: Cache HIT! Using cached test results"),h(Be),Be;console.log(" TestContext: Cache MISS! Fetching from API");const Pe=await Pn.getStudentTestResults();return console.log(" TestContext: Test results loaded:",Pe),console.log(" TestContext: Results data:",Pe?.results||Pe),console.log(" TestContext: Results length:",Pe?.results?.length||0),h(Pe),console.log(" TestContext: Caching test results with key:",Fe),console.log(" TestContext: Results being cached:",Pe),console.log(" TestContext: Results.results being cached:",Pe.results),vs(Fe,Pe,hs.student_results_table),Pe}catch(Fe){throw console.error("Error loading test results:",Fe),b(Fe.message||"Failed to load test results"),Fe}finally{v(!1)}},[]),$t=(ve,Fe,Be,Pe)=>{try{console.log("Displaying test results:",{testInfo:ve,questions:Fe,testType:Be,studentAnswers:Pe});const lt=Zf(Fe,Pe,Be),Ct=ve?.num_questions||Fe?.length||0,Lt=Ct>0?Math.round(lt/Ct*100):0,Ue=Lt>=60,st=Fe.map((dt,Bt)=>{const Yt=dt.question_id||dt.id,xr=Pe[Yt],Rr=g1(dt,xr,Be);return{questionNumber:Bt+1,question:dt.question||dt.question_text,userAnswer:X(xr,Be),correctAnswer:r2(dt,Be),isCorrect:Rr,questionType:Be}});h({testInfo:ve,questions:Fe,testType:Be,studentAnswers:Pe,showResults:!0,score:lt,totalQuestions:Ct,percentage:Lt,passed:Ue,questionAnalysis:st,timestamp:new Date().toISOString()}),c(dt=>({...dt,score:lt,totalQuestions:Ct,percentage:Lt,passed:Ue,lastUpdated:Date.now()})),Ge(),console.log(`Test results displayed: ${lt}/${Ct} (${Lt}%) - ${Ue?"PASSED":"FAILED"}`)}catch(lt){console.error("Error displaying test results:",lt),b("Failed to display test results")}},Ge=w.useCallback(()=>{try{console.log("Setting up test results page event listeners");const ve=Ct=>{if(Ct.key==="Escape"&&G(),Ct.ctrlKey&&Ct.key==="p"&&(Ct.preventDefault(),window.print()),Ct.key==="Enter"&&f&&!f.passed){const Lt=document.getElementById("retake-test-button");Lt&&Lt.click()}},Fe=()=>{window.print()},Be=()=>{if(f){const Ct=`Test: ${f.testInfo?.test_name||"Test"}
Score: ${f.score}/${f.totalQuestions} (${f.percentage}%)
Status: ${f.passed?"PASSED":"FAILED"}
Completed: ${new Date(f.timestamp).toLocaleString()}`;navigator.clipboard.writeText(Ct).then(()=>{console.log("Results copied to clipboard")}).catch(Lt=>{console.error("Failed to copy results:",Lt)})}};document.addEventListener("keydown",ve);const Pe=document.getElementById("print-results");Pe&&Pe.addEventListener("click",Fe);const lt=document.getElementById("copy-results");return lt&&lt.addEventListener("click",Be),()=>{document.removeEventListener("keydown",ve),Pe&&Pe.removeEventListener("click",Fe),lt&&lt.removeEventListener("click",Be)}}catch(ve){console.error("Error setting up test results page event listeners:",ve)}},[G,f]),et=async(ve,Fe,Be)=>{try{v(!0),b(null),console.log("Viewing test details:",{testType:ve,testId:Fe,testName:Be}),T({isOpen:!0,testType:ve,testId:Fe,testName:Be,questions:[],isLoading:!0});const Pe=await Pn.getTestQuestions(ve,Fe);Pe&&Pe.length>0?(T({isOpen:!0,testType:ve,testId:Fe,testName:Be,questions:Pe,isLoading:!1}),console.log(`Test details loaded: ${Pe.length} questions`)):(b("Could not load test questions. Please try again."),T({isOpen:!0,testType:ve,testId:Fe,testName:Be,questions:[],isLoading:!1,error:"No questions available for this test"}))}catch(Pe){console.error("Error loading test details:",Pe),b("Error loading test details. Please try again."),T({isOpen:!0,testType:ve,testId:Fe,testName:Be,questions:[],isLoading:!1,error:Pe.message||"Failed to load test details"})}finally{v(!1)}},vt=(ve,Fe,Be,Pe)=>{try{console.log("Showing test details modal:",{testType:ve,testId:Fe,testName:Be,questions:Pe}),T({isOpen:!0,testType:ve,testId:Fe,testName:Be,questions:Pe||[],isLoading:!1,error:null})}catch(lt){console.error("Error showing test details modal:",lt),b("Failed to show test details modal")}},Te=()=>{try{console.log("Closing test details modal"),T({isOpen:!1,testType:null,testId:null,testName:null,questions:[],isLoading:!1,error:null})}catch(ve){console.error("Error closing test details modal:",ve)}},Ve=(ve,Fe)=>{try{switch(Fe){case"multiple_choice":return l.jsxs("div",{className:"answer-options",children:[l.jsx("p",{children:l.jsx("strong",{children:"Options:"})}),l.jsxs("p",{children:["A) ",ve.option_a||"No text"]}),l.jsxs("p",{children:["B) ",ve.option_b||"No text"]}),ve.option_c&&l.jsxs("p",{children:["C) ",ve.option_c]}),ve.option_d&&l.jsxs("p",{children:["D) ",ve.option_d]}),ve.option_e&&l.jsxs("p",{children:["E) ",ve.option_e]}),ve.option_f&&l.jsxs("p",{children:["F) ",ve.option_f]}),l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ve.correct_answer||"Not specified"]})})]});case"true_false":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ve.correct_answer?"True":"False"]})})});case"input":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ve.correct_answer||"Not specified"]})})});case"matching_type":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ve.correct_answer?JSON.stringify(ve.correct_answer):"Not specified"]})})});case"word_matching":return l.jsx("div",{className:"answer-options",children:l.jsx("p",{className:"correct-answer",children:l.jsxs("strong",{children:["Correct Answer: ",ve.correct_answer?JSON.stringify(ve.correct_answer):"Not specified"]})})});default:return l.jsx("p",{children:"Unknown question type"})}}catch(Be){return console.error("Error formatting question answer display:",Be),l.jsx("p",{children:"Error displaying question"})}},pt=(ve,Fe)=>{try{console.log("Navigating to test:",{testType:ve,testId:Fe}),r({testType:ve,testId:Fe}),d(!0),U(ve,Fe)}catch(Be){console.error("Error navigating to test:",Be),b("Failed to navigate to test")}},wt=()=>{try{console.log("Hiding test sections"),r(null),s([]),i({}),c({}),d(!1),h(null),b(null)}catch(ve){console.error("Error hiding test sections:",ve)}},Ut=(ve,Fe,Be,Pe)=>{try{console.log("Displaying test on page:",{testInfo:ve,questions:Fe,testType:Be,testId:Pe}),r({...ve,testType:Be,testId:Pe}),s(Fe),d(!0),K(Be,Pe),It(Be,Pe),$e(Be,Pe)}catch(lt){console.error("Error displaying test on page:",lt),b("Failed to display test on page")}},ct=(ve,Fe,Be)=>{try{return console.log("Rendering questions for page:",{questions:ve,testType:Fe,testId:Be}),!ve||!Array.isArray(ve)?(console.warn("Invalid questions array for rendering"),[]):ve.map((Pe,lt)=>{const Ct=Lt=>{const Ue={...a,[Pe.question_id]:Lt};i(Ue),te(Fe,Be,Pe.question_id,Lt)};return{question:Pe,index:lt,testType:Fe,testId:Be,studentAnswer:a[Pe.question_id]||"",onAnswerChange:Ct}})}catch(Pe){return console.error("Error rendering questions for page:",Pe),[]}},yt=w.useCallback((ve,Fe)=>{try{if(!ve||!Fe){console.warn("Cannot save progress: missing testType or testId");return}const Be=`test_progress_${ve}_${Fe}`,Pe={answers:a,progress:o,lastSaved:Date.now(),testType:ve,testId:Fe};M(Be,Pe),console.log(`Progress saved for test ${ve}_${Fe}:`,Pe)}catch(Be){console.error("Error saving progress for page:",Be)}},[a,o,M]),rt=w.useCallback(ve=>{try{return!a||Object.keys(a).length===0?0:Object.values(a).filter(Be=>Be==null?!1:typeof Be=="string"?Be.trim()!=="":typeof Be=="object"?Object.keys(Be).length>0:!0).length}catch(Fe){return console.error("Error getting answered questions count for page:",Fe),0}},[a]),Oe=w.useCallback((ve,Fe)=>{try{console.log("Updating progress display for page:",{testType:ve,testId:Fe});const Be=rt(ve),Pe=n.length,lt=Pe>0?Math.round(Be/Pe*100):0,Ct=Be===Pe&&Pe>0;c(dt=>({...dt,answeredCount:Be,totalQuestions:Pe,percentage:lt,canSubmit:Ct,remainingQuestions:Pe-Be,lastUpdated:Date.now()}));const Lt=document.getElementById("progress-bar"),Ue=document.getElementById("progress-text"),st=document.getElementById("submit-test-button");return Lt&&(Lt.style.width=`${lt}%`,Lt.className=Lt.className.replace(/bg-\w+-\d+/,""),lt>=100?Lt.classList.add("bg-green-500"):lt>=80?Lt.classList.add("bg-blue-500"):lt>=60?Lt.classList.add("bg-yellow-500"):lt>=40?Lt.classList.add("bg-orange-500"):Lt.classList.add("bg-red-500")),Ue&&(Ue.textContent=`${Be}/${Pe} questions answered (${lt}%)`),st&&(st.disabled=!Ct,Ct?(st.textContent=" Submit Test",st.classList.remove("bg-gray-400"),st.classList.add("bg-green-600","hover:bg-green-700")):(st.textContent=` Complete ${Pe-Be} more question${Pe-Be!==1?"s":""}`,st.classList.remove("bg-green-600","hover:bg-green-700"),st.classList.add("bg-gray-400"))),{answeredCount:Be,totalQuestions:Pe,percentage:lt,canSubmit:Ct}}catch(Be){return console.error("Error updating progress display for page:",Be),{answeredCount:0,totalQuestions:0,percentage:0,canSubmit:!1}}},[n.length,rt]),$e=w.useCallback((ve,Fe)=>{try{console.log("Setting up test page event listeners:",{testType:ve,testId:Fe});const Be=setInterval(()=>{Object.keys(a).length>0&&(yt(ve,Fe),console.log("Auto-saved progress for test:",ve,Fe))},3e4),Pe=setInterval(()=>{Oe(ve,Fe)},2e3),lt=dt=>{dt.key==="Escape"&&window.confirm("Are you sure you want to exit the test? Your progress will be saved.")&&G(),dt.ctrlKey&&dt.key==="s"&&(dt.preventDefault(),yt(ve,Fe),console.log("Manual save triggered")),dt.key},Ct=dt=>{Object.keys(a).length>0&&(dt.preventDefault(),dt.returnValue="Your test progress will be saved. Are you sure you want to leave?")},Lt=()=>{document.hidden&&(console.log("Tab became hidden - saving progress"),yt(ve,Fe))},Ue=()=>{console.log("Window focused - updating progress"),Oe(ve,Fe)},st=()=>{console.log("Window blurred - saving progress"),yt(ve,Fe)};return document.addEventListener("keydown",lt),window.addEventListener("beforeunload",Ct),document.addEventListener("visibilitychange",Lt),window.addEventListener("focus",Ue),window.addEventListener("blur",st),window.testIntervals||(window.testIntervals={}),window.testIntervals[`autosave_${ve}_${Fe}`]=Be,window.testIntervals[`progress_${ve}_${Fe}`]=Pe,()=>{clearInterval(Be),clearInterval(Pe),document.removeEventListener("keydown",lt),window.removeEventListener("beforeunload",Ct),document.removeEventListener("visibilitychange",Lt),window.removeEventListener("focus",Ue),window.removeEventListener("blur",st),window.testIntervals&&(delete window.testIntervals[`autosave_${ve}_${Fe}`],delete window.testIntervals[`progress_${ve}_${Fe}`])}}catch(Be){console.error("Error setting up test page event listeners:",Be)}},[a,yt,Oe,G]),Mt=w.useCallback(()=>{try{const ve=rt(t?.testType),Fe=n.length,Be=ve===Fe&&Fe>0,Pe=document.getElementById("submit-test-button");return Pe&&(Pe.disabled=!Be,Pe.textContent=Be?"Submit Test":`Complete ${Fe-ve} more questions`),{canSubmit:Be,answeredCount:ve,totalQuestions:Fe}}catch(ve){return console.error("Error updating submit button state for page:",ve),{canSubmit:!1,answeredCount:0,totalQuestions:0}}},[t,n.length,rt]),It=w.useCallback((ve,Fe)=>{try{console.log("Setting up progress tracking for page:",{testType:ve,testId:Fe});const Be=setInterval(()=>{Oe(ve,Fe),Mt()},1e3),Pe=setInterval(()=>{Object.keys(a).length>0&&yt(ve,Fe)},3e4);return window.testIntervals||(window.testIntervals={}),window.testIntervals[`progress_${ve}_${Fe}`]=Be,window.testIntervals[`autosave_${ve}_${Fe}`]=Pe,()=>{clearInterval(Be),clearInterval(Pe),window.testIntervals&&(delete window.testIntervals[`progress_${ve}_${Fe}`],delete window.testIntervals[`autosave_${ve}_${Fe}`])}}catch(Be){console.error("Error setting up progress tracking for page:",Be)}},[a,Oe,Mt,yt]),At=w.useCallback(async(ve,Fe)=>{const Be=document.getElementById("submit-test-button");try{const Pe=rt(ve),lt=n.length;if(Pe<lt){b(`Please answer all ${lt} questions before submitting.`);return}if(!window.confirm("Are you sure you want to submit your test? This action cannot be undone."))return;Be&&(Be.disabled=!0,Be.innerHTML=`
          <div class="flex items-center justify-center space-x-2">
            <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-white"></div>
            <span>Submitting...</span>
          </div>
        `),await B(ve,Fe)&&(Z(ve,Fe),J(ve,Fe,a),console.log("Test submitted successfully!"))}catch(Pe){console.error("Error submitting test from page:",Pe),b("Failed to submit test. Please try again."),Be&&(Be.disabled=!1,Be.textContent="Submit Test")}},[rt,n.length,B,Z,J,a]),tr=w.useCallback(()=>{try{if(!t)return null;const ve=["true_false","multiple_choice","input","matching_type","word_matching"];return ve.includes(t.testType)?t.testType:ve.includes(t.test_type)?t.test_type:null}catch(ve){return console.error("Error getting current test type:",ve),null}},[t]),ar=w.useCallback((ve,Fe)=>{try{console.log("Clearing progress tracking interval:",{testType:ve,testId:Fe});const Be=`progress_interval_${ve}_${Fe}`,Pe=`autosave_interval_${ve}_${Fe}`;window.testIntervals&&(window.testIntervals[Be]&&(clearInterval(window.testIntervals[Be]),delete window.testIntervals[Be]),window.testIntervals[Pe]&&(clearInterval(window.testIntervals[Pe]),delete window.testIntervals[Pe])),console.log(`Cleared progress tracking intervals for test ${ve}_${Fe}`)}catch(Be){console.error("Error clearing progress tracking interval:",Be)}},[]),mr={currentTest:t,testQuestions:n,studentAnswers:a,testProgress:o,isTestActive:u,testResults:f,activeTests:g,isLoading:x,error:C,testDetailsModal:_,testStartTime:N,timeElapsed:F,loadTestForPage:U,submitTest:B,navigateToTestResults:J,navigateBackToCabinet:z,clearTestDataAndReturnToCabinet:G,saveTestProgress:te,getTestProgress:re,clearTestProgress:Z,loadSavedProgressForPage:K,isTestCompleted:q,markTestCompleted:H,markTestCompletedInUI:(ve,Fe)=>{console.log("Marking test completed in UI:",{testType:ve,testId:Fe}),H(ve,Fe)},getAnsweredQuestionsCount:R,updateSubmitButtonState:L,updateSubmitButtonStateForPage:Mt,loadStudentActiveTests:le,loadActiveTests:le,loadTeacherActiveTests:he,getTestInfo:Ee,getTestQuestions:ye,createTest:we,deleteTest:ie,showTestResults:Ie,loadTestResults:Qe,loadTestResultsForPage:ut,displayTestResultsOnPage:$t,setupTestResultsPageEventListeners:Ge,clearTestResultsCache:W,viewTestDetails:et,showTestDetailsModal:vt,closeTestDetailsModal:Te,getQuestionAnswerDisplay:Ve,navigateToTest:pt,hideTestSections:wt,displayTestOnPage:Ut,renderQuestionsForPage:ct,setupTestPageEventListeners:$e,setupProgressTrackingForPage:It,updateProgressDisplayForPage:Oe,submitTestFromPage:At,getAnsweredQuestionsCountForPage:rt,getCurrentTestType:tr,saveProgressForPage:yt,clearProgressTrackingInterval:ar,collectTestAnswers:Q,calculateTestScore:Zf,checkAnswerCorrectness:g1,formatStudentAnswerForDisplay:X,getCorrectAnswer:r2,transformAnswersForSubmission:se,clearAllTestData:()=>{try{console.log("Clearing old test data from localStorage (older than 15 days)...");const Fe=Date.now()-360*60*60*1e3,Be=[];for(let Pe=0;Pe<localStorage.length;Pe++){const lt=localStorage.key(Pe);if(!(!lt||!((lt.startsWith("test_")||lt.startsWith("student_")||lt.startsWith("teacher_")||lt.startsWith("admin_")||lt.includes("progress")||lt.includes("answers"))&&!lt.includes("test_completed_"))))try{const Lt=localStorage.getItem(lt);if(!Lt){Be.push(lt);continue}let Ue=null;if(Lt.startsWith("{")||Lt.startsWith("[")){const st=JSON.parse(Lt),dt=st.timestamp||st.lastSaved||st.lastTickAt||st.createdAt||st.updatedAt||st.startedAt||st.started_at||st.created_at;dt&&(Ue=new Date(dt).getTime())}if(!Ue){const st=`${lt}__ts`,dt=localStorage.getItem(st);dt&&(Ue=parseInt(dt)||null)}if(!Ue)continue;Ue<Fe&&Be.push(lt)}catch{continue}}return Be.forEach(Pe=>{console.log(`Removing old localStorage key: ${Pe}`),I(Pe)}),console.log(`Cleared ${Be.length} old test-related items from localStorage`),{success:!0,clearedCount:Be.length}}catch(ve){return console.error("Error clearing old test data:",ve),{success:!1,error:ve.message}}},setCurrentTest:r,setTestQuestions:s,setStudentAnswers:i,setTestProgress:c,setIsTestActive:d,setTestResults:h,setError:b};return l.jsx(OV.Provider,{value:mr,children:e})},J2=()=>{const e=w.useContext(OV);if(!e)throw new Error("useTest must be used within a TestProvider");return e},Zhe=()=>{const[e,t]=w.useState("en"),n={en:{title:"Privacy Policy",subtitle:"App: MWS Student App",website:"Website: mathayomwatsing.netlify.app",lastUpdated:"Last updated:",introduction:{title:"Introduction",text1:"The MWS Student App is an independent educational project created by Aleksandr Petrov to provide learning tools for students. This app is not officially affiliated with or endorsed by Mathayomwatsing School.",text2:"This Privacy Policy explains how we collect, use, store, and protect personal information. By using this app, you agree to this policy.",dataController:"Independent Developer:",dataControllerText:"Aleksandr Petrov is responsible for managing and protecting personal data collected through the MWS Student App and Website: mathayomwatsing.netlify.app",pdpaTitle:"PDPA Compliance",pdpaText:"This app complies with Thailand's Personal Data Protection Act, B.E. 2562 (PDPA). We are committed to protecting your personal data in accordance with PDPA requirements, including lawful collection, purpose limitation, data minimization, accuracy, security, and your rights as a data subject."},consent:{title:"User Consent",text1:"Users (or their parents/legal guardians if under 18) consent to data collection and usage as described in this policy.",text2:"If you do not agree, please do not use the app. Continued use after updates to this policy constitutes acceptance."},appPurpose:{title:"App Purpose",text:"The MWS Student App (Independent Project) enables students to:",items:["Take online tests and assessments","View test results and academic progress","Track learning achievements and performance","Access educational content and resources"]},childrenPrivacy:{title:"Children's Privacy",text1:"The MWS Student App is designed for students. We do not knowingly collect more data than necessary to provide educational functionality.",text2:"Parents or guardians may contact the app developer to review, delete, or request updates to a student's information. We comply with COPPA (Children's Online Privacy Protection Act), Thailand's PDPA (Personal Data Protection Act, B.E. 2562), and equivalent child-data protection laws applicable in your jurisdiction."},dataCollection:{title:"Data Collection",text:"We collect only the data necessary to provide educational functionality:",accountInfo:{title:"Account Information",text:"Student name, ID, grade, and class (for authentication and personalization)."},testData:{title:"Test Data",text:"Answers, scores, progress, and completion status."},usageData:{title:"Usage Data",text:"App interactions, feature usage, and error logs (to improve functionality and stability)."},important:"Important:",importantText:"This app does not use or share personal data for advertising or commercial purposes. All data collection is strictly for educational and assessment use. We comply with COPPA (Children's Online Privacy Protection Act), Thailand's PDPA (Personal Data Protection Act, B.E. 2562), and equivalent child-data protection laws. This app does not display advertisements or use tracking SDKs."},dataUsage:{title:"How We Use Your Data",text:"Your data is used exclusively for educational purposes:",items:["Deliver and maintain educational services","Track learning progress and achievements","Provide feedback on academic performance","Improve app functionality and user experience","Provide technical support"]},cookies:{title:"Cookies and Local Storage",text1:"This app uses cookies and local storage technologies to provide essential functionality and improve your experience.",essentialCookies:{title:"Essential Cookies and Storage",text:"We use essential cookies and local storage for:",items:["Authentication: Storing login tokens to keep you signed in securely","Session Management: Maintaining your active session during app usage","Test Progress: Saving your test progress locally to prevent data loss","User Preferences: Storing your theme preferences and settings"],note:"These essential cookies and storage are necessary for the app to function properly and cannot be disabled."},storageTypes:{title:"Types of Storage Used",text:"We use the following storage mechanisms:",httpCookies:{title:"HTTP Cookies",text:"Secure, HttpOnly cookies for authentication tokens. These cookies are essential for maintaining your login session and are automatically deleted when you log out."},localStorage:{title:"Local Storage",text:"Browser local storage for user data, test progress, and preferences. This data remains on your device until you clear your browser data or log out."},sessionStorage:{title:"Session Storage",text:"Temporary session storage used as a fallback when local storage is unavailable. This data is automatically cleared when you close your browser."}},cookieManagement:{title:"Managing Cookies and Storage",text:"You can manage cookies and local storage through your browser settings. However, disabling essential cookies or storage may prevent the app from functioning correctly. To clear stored data, you can:",items:["Log out of the app, which will clear authentication tokens","Clear your browser's cookies and local storage through browser settings","Contact us at aleksandr.p@mws.ac.th to request data deletion"]},thirdPartyCookies:{title:"Third-Party Cookies",text:"This app does not use third-party cookies for advertising or tracking purposes. We do not share cookie data with third parties."},consent:{title:"Cookie Consent",text:"By using this app, you consent to the use of essential cookies and local storage as described in this policy. These are necessary for the app's core functionality and security."}},dataStorage:{title:"Data Storage & Security",text1:"Data is stored securely, locally on devices, or on encrypted cloud servers (Supabase). All transmissions are encrypted.",text2:"Technical and organizational measures are applied to prevent unauthorized access, alteration, disclosure, or destruction."},dataHosting:{title:"Data Hosting",text1:"The app's data is securely stored using trusted cloud infrastructure (Supabase). These services comply with global security standards including GDPR and ISO 27001.",text2:"All data hosting providers are contractually obligated to maintain the same level of data protection and security as outlined in this Privacy Policy. Data is stored in secure, encrypted databases with regular backups and monitoring."},dataSharing:{title:"Data Sharing and Disclosure",text:"We do not sell, rent, or trade user data. Data may be shared only:",schoolAdmin:{title:"Parents/Guardians:",text:"With parents/guardians for their childs data review."},legal:{title:"Legal Requirements:",text:"For legal obligations, if required by law or in response to valid legal requests."},serviceProviders:{title:"Service Providers:",text:"With trusted service providers (bound by contracts to protect data and use it only for specified purposes)."}},academicIntegrity:{title:"Academic Integrity",text:"The app includes anti-cheating measures to ensure fair assessment. This includes monitoring app state changes, preventing unauthorized actions during tests, and detecting suspicious behavior. By using this app, you agree to maintain academic honesty and integrity."},userRights:{title:"Your Rights",text:"Users have the right to:",items:["Access, correct, or delete personal data","Object to processing of personal data","Request data portability"],contact:"To exercise these rights, please contact app developer at aleksandr.p@mws.ac.th",pdpaTitle:"Under Thailand's PDPA, you have the right to:",pdpaItems:["Access and obtain a copy of your personal data","Request correction of any incomplete or inaccurate information","Request deletion or suspension of use of your personal data","Withdraw consent at any time (where applicable)","Lodge a complaint with the Personal Data Protection Committee (PDPC) if you believe your data has been mishandled"]},dataRetention:{title:"Data Retention",text:"We retain personal data only as long as necessary to provide educational services and comply with legal obligations. Academic records may be retained according to educational data retention requirements."},changes:{title:"Changes to This Privacy Policy",text:'We may update this Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last updated" date. You are advised to review this Privacy Policy periodically for any changes.'},contact:{title:"Contact",text:"For privacy inquiries, contact:",school:"Aleksandr Petrov",email:"aleksandr.p@mws.ac.th"},backToLogin:" Back to Login"},th:{title:"",subtitle:": MWS Student App",website:": mathayomwatsing.netlify.app",lastUpdated:":",introduction:{title:"",text1:"MWS Student App  Aleksandr Petrov  ",text2:"    ",dataController:":",dataControllerText:"Aleksandr Petrov  MWS Student App : mathayomwatsing.netlify.app",pdpaTitle:" PDPA",pdpaText:" .. 2562 (PDPA)  PDPA      "},consent:{title:"",text1:" (/ 18 ) ",text2:"  "},appPurpose:{title:"",text:"MWS Student App () :",items:["","","",""]},childrenPrivacy:{title:"",text1:" ",text2:"    COPPA ()  .. 2562 (PDPA) "},dataCollection:{title:"",text:":",accountInfo:{title:"",text:"    ()"},testData:{title:"",text:"   "},usageData:{title:"",text:"   ()"},important:":",importantText:"   COPPA ()  .. 2562 (PDPA)   SDK "},dataUsage:{title:"",text:":",items:["","","","",""]},cookies:{title:"",text1:"",essentialCookies:{title:"",text:":",items:[": ",": ",": ",": "],note:""},storageTypes:{title:"",text:":",httpCookies:{title:" HTTP",text:" HttpOnly  "},localStorage:{title:"",text:"   "},sessionStorage:{title:"",text:" "}},cookieManagement:{title:"",text:"    :",items:[" ",""," aleksandr.p@mws.ac.th "]},thirdPartyCookies:{title:"",text:" "},consent:{title:"",text:"  "}},dataStorage:{title:"",text1:"  (Supabase) ",text2:"   "},dataHosting:{title:"",text1:" (Supabase)  GDPR  ISO 27001",text2:" "},dataSharing:{title:"",text:"   :",schoolAdmin:{title:"/:",text:"/"},legal:{title:":",text:" "},serviceProviders:{title:":",text:" ()"}},academicIntegrity:{title:"",text:"     "},userRights:{title:"",text:":",items:["  ","",""],contact:"  aleksandr.p@mws.ac.th",pdpaTitle:" .. 2562 (PDPA)  :",pdpaItems:["","",""," ()"," (PDPC) "]},dataRetention:{title:"",text:" "},changes:{title:"",text:'   "" '},contact:{title:"",text:" :",school:"Aleksandr Petrov",email:"aleksandr.p@mws.ac.th"},backToLogin:" "}}[e],s=new Date().toLocaleDateString(e==="th"?"th-TH":"en-US",{year:"numeric",month:"long",day:"numeric"});return l.jsx("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsx("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 mb-8",children:l.jsx("div",{className:"px-6 py-6 border-b border-gray-200",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:n.title}),l.jsx("p",{className:"text-sm text-gray-600",children:n.subtitle}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:n.website}),l.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[n.lastUpdated," ",s]})]}),l.jsxs("div",{className:"flex gap-2 ml-4",children:[l.jsx("button",{onClick:()=>t("en"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${e==="en"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"English"}),l.jsx("button",{onClick:()=>t("th"),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${e==="th"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:""})]})]})})}),l.jsxs("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 p-6 sm:p-8 space-y-8",children:[l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.introduction.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.introduction.text1}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mt-4",children:n.introduction.text2}),l.jsx("div",{className:"mt-4 bg-gray-50 border border-gray-200 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm leading-6 text-gray-700",children:[l.jsx("span",{className:"font-semibold",children:n.introduction.dataController})," ",n.introduction.dataControllerText]})}),l.jsx("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm leading-6 text-blue-800",children:[l.jsxs("span",{className:"font-semibold",children:[n.introduction.pdpaTitle,":"]})," ",n.introduction.pdpaText]})})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.consent.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.consent.text1}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mt-4",children:n.consent.text2})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.appPurpose.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.appPurpose.text}),l.jsx("ul",{className:"list-disc list-inside mt-3 space-y-2 text-base leading-7 text-gray-700 ml-4",children:n.appPurpose.items.map((a,i)=>l.jsx("li",{children:a},i))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.childrenPrivacy.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.childrenPrivacy.text1}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mt-4",children:n.childrenPrivacy.text2})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.dataCollection.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mb-4",children:n.dataCollection.text}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.dataCollection.accountInfo.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.dataCollection.accountInfo.text})]}),l.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.dataCollection.testData.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.dataCollection.testData.text})]}),l.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.dataCollection.usageData.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.dataCollection.usageData.text})]})]}),l.jsx("div",{className:"mt-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("p",{className:"text-sm leading-6 text-yellow-800",children:[l.jsx("span",{className:"font-semibold",children:n.dataCollection.important})," ",n.dataCollection.importantText]})})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.dataUsage.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mb-4",children:n.dataUsage.text}),l.jsx("ul",{className:"list-disc list-inside space-y-2 text-base leading-7 text-gray-700 ml-4",children:n.dataUsage.items.map((a,i)=>l.jsx("li",{children:a},i))})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.cookies.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mb-4",children:n.cookies.text1}),l.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.essentialCookies.title}),l.jsx("p",{className:"text-sm text-gray-700 mb-2",children:n.cookies.essentialCookies.text}),l.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-700 ml-4",children:n.cookies.essentialCookies.items.map((a,i)=>l.jsx("li",{children:a},i))}),l.jsx("p",{className:"text-sm text-gray-700 mt-2 italic",children:n.cookies.essentialCookies.note})]}),l.jsxs("div",{className:"space-y-4 mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:n.cookies.storageTypes.title}),l.jsx("p",{className:"text-sm text-gray-700 mb-3",children:n.cookies.storageTypes.text}),l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.storageTypes.httpCookies.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.cookies.storageTypes.httpCookies.text})]}),l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.storageTypes.localStorage.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.cookies.storageTypes.localStorage.text})]}),l.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.storageTypes.sessionStorage.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.cookies.storageTypes.sessionStorage.text})]})]}),l.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.cookieManagement.title}),l.jsx("p",{className:"text-sm text-gray-700 mb-2",children:n.cookies.cookieManagement.text}),l.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-gray-700 ml-4",children:n.cookies.cookieManagement.items.map((a,i)=>l.jsx("li",{children:a},i))})]}),l.jsxs("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.thirdPartyCookies.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.cookies.thirdPartyCookies.text})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:n.cookies.consent.title}),l.jsx("p",{className:"text-sm text-gray-700",children:n.cookies.consent.text})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.dataStorage.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.dataStorage.text1}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mt-4",children:n.dataStorage.text2})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.dataHosting.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.dataHosting.text1}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mt-4",children:n.dataHosting.text2})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.dataSharing.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.dataSharing.text}),l.jsxs("ul",{className:"list-disc list-inside space-y-2 text-base leading-7 text-gray-700 ml-4 mt-4",children:[l.jsxs("li",{children:[l.jsx("strong",{children:n.dataSharing.schoolAdmin.title})," ",n.dataSharing.schoolAdmin.text]}),l.jsxs("li",{children:[l.jsx("strong",{children:n.dataSharing.legal.title})," ",n.dataSharing.legal.text]}),l.jsxs("li",{children:[l.jsx("strong",{children:n.dataSharing.serviceProviders.title})," ",n.dataSharing.serviceProviders.text]})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.academicIntegrity.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.academicIntegrity.text})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.userRights.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mb-4",children:n.userRights.text}),l.jsx("ul",{className:"list-disc list-inside space-y-2 text-base leading-7 text-gray-700 ml-4",children:n.userRights.items.map((a,i)=>l.jsx("li",{children:a},i))}),l.jsx("p",{className:"text-base leading-7 text-gray-700 mt-4",children:e==="en"?l.jsxs(l.Fragment,{children:["To exercise these rights, please contact app developer at"," ",l.jsx("a",{href:"mailto:aleksandr.p@mws.ac.th",className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"aleksandr.p@mws.ac.th"})]}):l.jsxs(l.Fragment,{children:[" "," ",l.jsx("a",{href:"mailto:aleksandr.p@mws.ac.th",className:"text-blue-600 hover:text-blue-800 underline font-medium",children:"aleksandr.p@mws.ac.th"})]})}),l.jsxs("div",{className:"mt-6 bg-blue-50 border-l-4 border-blue-400 rounded-lg p-5",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:n.userRights.pdpaTitle}),l.jsx("ul",{className:"list-disc list-inside space-y-2 text-sm leading-6 text-gray-700 ml-2",children:n.userRights.pdpaItems.map((a,i)=>l.jsx("li",{children:a},i))})]})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.dataRetention.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.dataRetention.text})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.changes.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.changes.text})]}),l.jsxs("section",{children:[l.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:n.contact.title}),l.jsx("p",{className:"text-base leading-7 text-gray-700",children:n.contact.text}),l.jsxs("div",{className:"mt-4 bg-gray-50 border border-gray-200 rounded-lg p-4",children:[l.jsx("p",{className:"text-base text-gray-700",children:l.jsx("strong",{children:n.contact.school})}),l.jsx("p",{className:"text-sm text-gray-600 mt-2",children:l.jsx("a",{href:`mailto:${n.contact.email}`,className:"text-blue-600 hover:text-blue-800 underline font-medium",children:n.contact.email})})]})]}),l.jsx("div",{className:"pt-6 border-t border-gray-200 mt-8",children:l.jsx(IU,{to:"/login",className:"inline-flex items-center text-blue-600 hover:text-blue-800 font-medium",children:n.backToLogin})})]})]})})},eme=({children:e,className:t="",asBackground:r=!1})=>{const{theme:n,isCyberpunk:s}=da(),a=s?"bg-gradient-to-br from-black via-gray-900 to-purple-900":"bg-white",i=s?ua("cyberpunk").background:{},o=r?`${a} min-h-screen ${t}`:t;return l.jsx("div",{className:o,style:i,children:e})},cv=window.location.hostname==="mathayomwatsing.netlify.app";cv&&(console.log=()=>{},console.debug=()=>{},console.info=()=>{},console.warn=()=>{});const _e={debug:(e,...t)=>{cv||console.log(e,...t)},warn:(e,...t)=>{cv||console.warn(e,...t)},error:(e,...t)=>{console.error(e,...t)},info:(e,...t)=>{cv||console.info(e,...t)},isEnabled:()=>!cv},tme=({visible:e,onClose:t})=>{const{theme:r,setTheme:n,isCyberpunk:s,isLight:a,isKpop:i,themeClasses:o}=da(),c=ua(r),u=d=>{d!==r&&n(d)};return e?l.jsx(Ai,{children:e&&l.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[l.jsx(Ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t,className:"fixed inset-0 bg-black bg-opacity-50"}),l.jsxs(Ze.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:`relative w-full max-w-md mx-4 rounded-lg shadow-xl ${s?Vt(0).className:i?hr(0).className:"bg-white border border-gray-200"}`,style:s?{...Vt(0).style,...c.glow}:i?{...hr(0).style}:{},children:[l.jsx("div",{className:`px-6 py-4 border-b ${s?"border-cyan-400":i?"border-violet-500":"border-gray-200"}`,style:s?{borderColor:fe.cyan,borderBottomWidth:"2px"}:i?{borderColor:He.primary,borderBottomWidth:"2px"}:{},children:l.jsx("h2",{className:`text-2xl font-bold ${s?`${o.headerText} tracking-wider`:i?"text-violet-600":"text-gray-900"}`,style:s||i?c.textShadow:{},children:s?"SETTINGS":"Settings"})}),l.jsx("div",{className:"px-6 py-6",children:l.jsxs("div",{children:[l.jsx("h3",{className:`text-lg font-semibold mb-4 ${s?o.text:i?"text-violet-700":"text-gray-900"}`,children:s?"THEME":"Theme"}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("button",{onClick:()=>u("light"),className:`w-full p-4 rounded-lg border-2 transition-all ${a?s?"border-cyan-400":"bg-blue-50 border-blue-500":s?"border-gray-700 hover:border-cyan-400":"bg-white border-gray-300 hover:border-gray-400"}`,style:a&&s?{backgroundColor:fe.black,borderColor:fe.cyan,borderWidth:"2px"}:s?{backgroundColor:fe.black,borderColor:fe.cyan,borderWidth:"2px"}:{},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${a?s?"bg-cyan-400 border-cyan-400":"bg-blue-500 border-blue-500":s?"border-gray-600":"border-gray-400"}`,children:a&&l.jsx("div",{className:`w-full h-full rounded-full ${s?"bg-cyan-400":"bg-blue-500"}`})}),l.jsx("span",{className:`font-medium ${a?s?"text-cyan-400":"text-blue-600":s?"text-gray-400":"text-gray-600"}`,children:s?"LIGHT THEME":"Light Theme"})]}),a&&l.jsx("span",{className:`text-sm ${s?"text-cyan-400":"text-blue-600"}`,children:s?"ACTIVE":"Active"})]})}),l.jsx("button",{onClick:()=>u("cyberpunk"),className:`w-full p-4 rounded-lg border-2 transition-all ${s?"border-cyan-400":i?"bg-violet-50 border-violet-300 hover:border-violet-400":a?"bg-gray-50 border-gray-300 hover:border-gray-400":"bg-white border-gray-300 hover:border-gray-400"}`,style:s?{backgroundColor:fe.black,borderColor:fe.cyan,borderWidth:"2px",...c.glow}:{},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${s?"bg-cyan-400 border-cyan-400":"border-gray-400"}`,children:s&&l.jsx("div",{className:"w-full h-full rounded-full bg-cyan-400"})}),l.jsx("span",{className:`font-medium ${s?"text-cyan-400":i?"text-violet-600":"text-gray-600"}`,style:s?c.textShadow:{},children:s?"CYBERPUNK THEME":"Cyberpunk Theme"})]}),s&&l.jsx("span",{className:"text-sm text-cyan-400",children:"ACTIVE"})]})}),l.jsx("button",{onClick:()=>u("kpop"),className:`w-full p-4 rounded-lg border-2 transition-all ${i?"border-violet-500":s?"bg-black border-gray-700 hover:border-cyan-400":a?"bg-gray-50 border-gray-300 hover:border-gray-400":"bg-white border-gray-300 hover:border-gray-400"}`,style:i?{backgroundColor:He.background,borderColor:He.primary,borderWidth:"2px",...c.shadow}:s?{backgroundColor:fe.black,borderColor:fe.cyan,borderWidth:"2px"}:{},children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-5 h-5 rounded-full border-2 ${i?"bg-violet-500 border-violet-500":"border-gray-400"}`,children:i&&l.jsx("div",{className:"w-full h-full rounded-full bg-violet-500"})}),l.jsx("span",{className:`font-medium ${i?"text-violet-600":s?"text-gray-400":"text-gray-600"}`,style:i?c.textShadow:{},children:i?"K-POP THEME":"K-Pop Theme"})]}),i&&l.jsx("span",{className:"text-sm text-violet-600",children:"Active"})]})})]})]})}),l.jsx("div",{className:`px-6 py-4 border-t ${s?"border-cyan-400":i?"border-violet-500":"border-gray-200"}`,style:s?{borderColor:fe.cyan,borderTopWidth:"2px"}:i?{borderColor:He.primary,borderTopWidth:"2px"}:{},children:l.jsx("button",{onClick:t,className:`w-full py-2 px-4 rounded-lg font-medium transition-colors ${s?"bg-cyan-400 text-black hover:bg-cyan-300":i?"bg-violet-500 text-white hover:bg-violet-600":"bg-blue-500 text-white hover:bg-blue-600"}`,children:s?"CLOSE":"Close"})})]})]})}):null},Q2=({testResults:e,onBackToCabinet:t,onRetakeTest:r,isLoading:n=!1,caught_cheating:s=!1,visibility_change_times:a=0,themeClasses:i,isCyberpunk:o})=>{const[c,u]=w.useState(!1),{theme:d,isKpop:f}=da(),h=ua(d),g=o!==void 0?o:d==="cyberpunk",p=()=>{u(!0),t&&t()};if(!e||!e.showResults)return l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsx("div",{className:"text-center",children:l.jsx("p",{className:"text-gray-500",children:"No test results to display"})})});const{testInfo:x,testType:v,score:C,totalQuestions:b,percentage:_,passed:T,questionAnalysis:N,timestamp:E}=e,F=M=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching"})[M]||M,j=M=>M>=80?"text-green-600 bg-green-50":M>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50",P=M=>M?"text-green-600 bg-green-100 border-green-200":"text-red-600 bg-red-100 border-red-200";return n?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test results..."})]})}):l.jsxs("div",{className:`${g||f?"bg-black":"bg-gray-50"} py-8 overflow-y-auto`,style:g?h.background:f?h.backgroundSecondary:{},children:[l.jsx(Ds,{isOpen:c,onClose:()=>{},title:"Navigating",size:"small",children:l.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[l.jsx(Xr,{size:"lg",className:"mb-3"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Returning to cabinet..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait"})]})}),l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs(Ze.div,{className:`rounded-lg shadow-lg p-6 mb-6 border-2 ${g?Vt(0).className:f?hr(0).className:"bg-white"}`,style:g?{...Vt(0).style,...h.glowRed}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},children:[(e?.caught_cheating||s)&&l.jsx("div",{className:`mb-6 border-2 rounded-lg ${g||f?"border":"border-red-500 bg-red-50"}`,style:g?{backgroundColor:fe.black,borderColor:fe.red,...h.glowRed}:f?{backgroundColor:He.background,borderColor:He.error,...h.glowRed}:{},children:l.jsxs("div",{className:"flex items-start space-x-3 p-4",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:`h-6 w-6 ${g||f?"":"text-red-600"}`,style:g?{color:fe.red}:f?{color:He.error}:{},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:g||f?"":"text-red-700",style:g?{...h.textRed,fontFamily:"monospace"}:f?{color:He.error,...h.textShadowRed}:{},children:"Suspicious activity was detected during this test. Your teacher has been notified."})})]})}),l.jsxs("div",{className:"flex justify-between items-start mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:`text-3xl font-bold mb-2 ${g?"":"text-gray-900"}`,style:g?{...h.textCyan,fontFamily:"monospace"}:f?{...h.headerText}:{},children:g?"TEST RESULTS":"Test Results"}),l.jsx("h2",{className:`text-xl mb-1 ${g?"":"text-gray-700"}`,style:g?{...h.textYellow,fontFamily:"monospace"}:f?{...h.headerText}:{},children:x?.test_name||"Test"}),l.jsxs("p",{className:`text-sm ${g?"":"text-gray-500"}`,style:g?{color:fe.cyan,fontFamily:"monospace"}:{},children:[F(v),"  Completed on ",new Date(E).toLocaleDateString()]})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium border ${g?"border":P(T)}`,style:g?{backgroundColor:fe.black,borderColor:T?fe.green:fe.red,color:T?fe.green:fe.red,fontFamily:"monospace",...T?h.textShadowGreen:h.textShadowRed}:{},children:T?" PASSED":" FAILED"})})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:`text-center p-4 rounded-lg border ${g?Vt(1).className:f?hr(1).className:"bg-gray-50"}`,style:g?{...Vt(1).style,...h.glow}:f?{...hr(1).style,borderColor:He.primary,...h.glow}:{},children:[l.jsx("div",{className:`text-3xl font-bold ${g?"":"text-gray-900"}`,style:g?{...h.textCyan,fontFamily:"monospace"}:{},children:C}),l.jsx("div",{className:`text-sm ${g?"":"text-gray-600"}`,style:g?{color:fe.yellow,fontFamily:"monospace"}:{},children:"Correct Answers"})]}),l.jsxs("div",{className:`text-center p-4 rounded-lg border ${g?Vt(2).className:f?hr(2).className:"bg-gray-50"}`,style:g?{...Vt(2).style,...h.glow}:f?{...hr(2).style,borderColor:He.primary,...h.glow}:{},children:[l.jsx("div",{className:`text-3xl font-bold ${g?"":"text-gray-900"}`,style:g?{...h.textCyan,fontFamily:"monospace"}:{},children:b}),l.jsx("div",{className:`text-sm ${g?"":"text-gray-600"}`,style:g?{color:fe.yellow,fontFamily:"monospace"}:{},children:"Total Questions"})]}),l.jsxs("div",{className:`text-center p-4 rounded-lg border ${g?Vt(3).className:f?hr(0).className:"bg-gray-50"}`,style:g?{...Vt(3).style,...h.glow}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},children:[l.jsxs("div",{className:`text-3xl font-bold ${g?"":j(_).split(" ")[0]}`,style:g?{...h.textCyan,fontFamily:"monospace"}:{},children:[_,"%"]}),l.jsx("div",{className:`text-sm ${g?"":"text-gray-600"}`,style:g?{color:fe.yellow,fontFamily:"monospace"}:{},children:"Score"})]})]}),l.jsx("div",{className:`w-full rounded-full h-3 mb-6 border ${g?"bg-gray-800 border-cyan-400/50":f?"bg-black border-pink-500/50":"bg-gray-200"}`,style:g?h.glow:f?{...h.glow}:{},children:l.jsx(Ze.div,{className:`h-3 rounded-full ${g||f?"":j(_).split(" ")[1]}`,style:g?{background:`linear-gradient(to right, ${fe.yellow}, ${fe.cyan})`,boxShadow:`0 0 10px ${fe.cyan}`}:f?{background:`linear-gradient(to right, ${He.primary}, ${He.secondary})`,boxShadow:`0 0 10px ${He.primary}`}:{},initial:{width:0},animate:{width:`${_}%`},transition:{duration:1,ease:"easeOut"}})})]}),v!=="matching_type"&&v!=="word_matching"&&l.jsxs(Ze.div,{className:`rounded-lg shadow-lg p-6 border-2 ${g?Vt(1).className:f?hr(1).className:"bg-white"}`,style:g?{...Vt(1).style,...h.glow}:f?{...hr(1).style,borderColor:He.primary,...h.glow}:{},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:[l.jsx("h3",{className:`text-2xl font-bold mb-6 ${g?"":"text-gray-900"}`,style:g?{...h.textCyan,fontFamily:"monospace"}:f?{...h.headerText}:{},children:g?"QUESTION REVIEW":"Question Review"}),l.jsx("div",{className:"space-y-4",children:N.map((M,I)=>l.jsxs(Ze.div,{className:`p-4 rounded-lg border-2 ${g||f?"border":M.isCorrect?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,style:g?{backgroundColor:fe.black,borderColor:M.isCorrect?fe.green:fe.red,boxShadow:M.isCorrect?h.glow.boxShadow:h.glowRed.boxShadow}:f?{backgroundColor:He.background,borderColor:M.isCorrect?He.success:He.error,boxShadow:M.isCorrect?h.glow.boxShadow:h.glowRed.boxShadow}:{},initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:I*.1},children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("h4",{className:`text-lg font-semibold ${g?"":"text-gray-900"}`,style:g?{...h.textCyan,fontFamily:"monospace"}:{},children:["Question ",M.questionNumber]}),l.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium border ${g?"border":M.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,style:g?{backgroundColor:fe.black,borderColor:M.isCorrect?fe.green:fe.red,color:M.isCorrect?fe.green:fe.red,fontFamily:"monospace",...M.isCorrect?h.textShadowGreen:h.textShadowRed}:{},children:M.isCorrect?" Correct":" Incorrect"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("p",{className:`font-medium mb-2 ${g?"":"text-gray-800"}`,style:g?{...h.textYellow,fontFamily:"monospace"}:{},children:"Question:"}),l.jsx("p",{className:`p-3 rounded border ${g?"border":"text-gray-700 bg-gray-100"}`,style:g?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:M.question})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:`font-medium mb-2 ${g?"":"text-gray-800"}`,style:g?{...h.textYellow,fontFamily:"monospace"}:{},children:"Your Answer:"}),l.jsx("p",{className:`p-3 rounded border ${g?"border":M.isCorrect?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,style:g?{backgroundColor:fe.black,borderColor:M.isCorrect?fe.green:fe.red,color:M.isCorrect?fe.green:fe.red,fontFamily:"monospace",...M.isCorrect?h.textShadowGreen:h.textShadowRed}:{},children:M.userAnswer||"No answer provided"})]}),l.jsxs("div",{children:[l.jsx("p",{className:`font-medium mb-2 ${g?"":"text-gray-800"}`,style:g?{...h.textYellow,fontFamily:"monospace"}:{},children:"Correct Answer:"}),l.jsx("p",{className:`p-3 rounded border ${g?"border":"bg-blue-100 text-blue-800"}`,style:g?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:M.correctAnswer})]})]})]},I))})]}),l.jsxs(Ze.div,{className:`rounded-lg shadow-lg p-6 mt-6 border-2 ${g?Vt(0).className:f?hr(0).className:"bg-white"}`,style:g?{...Vt(0).style,...h.glow}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},children:[l.jsx("h3",{className:`text-2xl font-bold mb-4 ${g?"":"text-gray-900"}`,style:g?{color:fe.cyan,fontFamily:"monospace",...h.textShadow}:f?{...h.headerText}:{},children:g?"SUMMARY STATISTICS":"Summary Statistics"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:`text-center p-4 rounded-lg border-2 ${g?Vt(2).className:f?hr(1).className:"bg-blue-50"}`,style:g?{...Vt(2).style,...h.glow}:f?{...hr(1).style,borderColor:He.primary,...h.glow}:{},children:[l.jsx("div",{className:`text-2xl font-bold ${g?"":"text-blue-600"}`,style:g?{color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:N.filter(M=>M.isCorrect).length}),l.jsx("div",{className:`text-sm ${g?"":"text-blue-600"}`,style:g?{color:fe.cyan,fontFamily:"monospace"}:{},children:g?"CORRECT":"Correct"})]}),l.jsxs("div",{className:`text-center p-4 rounded-lg border-2 ${g?Vt(0).className:f?hr(2).className:"bg-red-50"}`,style:g?{...Vt(0).style,...h.glowRed}:f?{...hr(2).style,borderColor:He.error,...h.glowRed}:{},children:[l.jsx("div",{className:`text-2xl font-bold ${g?"":"text-red-600"}`,style:g?{color:fe.red,fontFamily:"monospace",...h.textShadowRed}:{},children:N.filter(M=>!M.isCorrect).length}),l.jsx("div",{className:`text-sm ${g?"":"text-red-600"}`,style:g?{color:fe.red,fontFamily:"monospace"}:{},children:g?"INCORRECT":"Incorrect"})]}),l.jsxs("div",{className:`text-center p-4 rounded-lg border-2 ${g?Vt(1).className:f?hr(0).className:"bg-gray-50"}`,style:g?{...Vt(1).style,...h.glow}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},children:[l.jsxs("div",{className:`text-2xl font-bold ${g?"":"text-gray-600"}`,style:g?{color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:[Math.round(N.filter(M=>M.isCorrect).length/b*100),"%"]}),l.jsx("div",{className:`text-sm ${g?"":"text-gray-600"}`,style:g?{color:fe.cyan,fontFamily:"monospace"}:{},children:g?"ACCURACY":"Accuracy"})]}),l.jsxs("div",{className:`text-center p-4 rounded-lg border-2 ${g?Vt(2).className:f?hr(1).className:"bg-purple-50"}`,style:g?{...Vt(2).style,...h.glow}:f?{...hr(1).style,borderColor:He.secondary,...h.glowPurple}:{},children:[l.jsx("div",{className:`text-2xl font-bold ${g?"":"text-purple-600"}`,style:g?{color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:b}),l.jsx("div",{className:`text-sm ${g?"":"text-purple-600"}`,style:g?{color:fe.cyan,fontFamily:"monospace"}:{},children:g?"TOTAL":"Total"})]})]})]}),l.jsx(Ze.div,{className:`rounded-lg shadow-lg p-6 mt-6 border-2 ${g?Vt(0).className:f?hr(0).className:"bg-white"}`,style:g?{...Vt(0).style,...h.glowRed}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.6},children:l.jsx("div",{className:"flex justify-center",children:l.jsx(at,{onClick:p,variant:"primary",className:"flex items-center gap-2",disabled:c,children:c?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white",className:"mr-2"}),"Navigating..."]}):" Back to Cabinet"})})})]})]})},rme=["/login","/privacy","/privacy-policy"],nme=["privacy","terms","legal"],sme=e=>{const t=e.toLowerCase();return rme.some(r=>t===r||t.startsWith(`${r}/`))?!0:nme.some(r=>t.includes(r))};let ame=class{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data"}getToken(){return localStorage.getItem(this.tokenKey)}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}setToken(t){localStorage.setItem(this.tokenKey,t)}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){this.setToken(t),this.setUserData({role:r}),localStorage.setItem("accessToken",t)}isAuthenticated(){const t=this.getToken();if(!t)return!1;try{const r=JSON.parse(atob(t.split(".")[1])),n=Date.now()/1e3;return r.exp>n}catch(r){return console.error("Error decoding token:",r),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}clearAuth(){localStorage.removeItem(this.tokenKey),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey)}logout(){this.clearAuth(),window.location.href="/login"}getAuthHeader(){const t=this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401){if(await this.refreshToken())return s.Authorization=`Bearer ${this.getToken()}`,fetch(t,{...r,headers:s});throw this.logout(),new Error("Authentication failed")}return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json();return this.setToken(n.accessToken),n.refreshToken&&this.setRefreshToken(n.refreshToken),!0}}catch(r){console.error("Error refreshing token:",r)}return!1}getAccessToken(){return this.getToken()}decodeToken(t){try{return JSON.parse(atob(t.split(".")[1]))}catch(r){return console.error("Error decoding token:",r),null}}init(){if(!this.isAuthenticated()){const t=window.location.pathname||"/",r=sme(t);return console.info("[TokenManager:template] Unauthenticated visitor on path:",t,"public?",r),r||(window.location.href="/login"),!1}return this.setupTokenRefresh(),!0}setupTokenRefresh(){setInterval(async()=>{this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}};const p1=new ame;window.tokenManager=p1;typeof document<"u"&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{p1.init()}):p1.init());const IV=async(e,t,r,n,s=!1)=>{try{console.log(" Fetching teacher student results:",{teacherId:e,grade:t,className:r,termId:n,forceRefresh:s});const a=s?`&_t=${Date.now()}`:"",o=await(await p1.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-student-results?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}${a}`,{cache:s?"no-cache":"default",headers:s?{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"}:{}})).json();if(o.success)return console.log(" Teacher student results loaded:",o.results.length,"results"),console.log(" Students loaded:",o.students?.length||0,"students"),{success:!0,results:o.results,students:o.students||[],count:o.results.length,student_count:o.student_count||0};throw new Error(o.error||"Failed to load teacher student results")}catch(a){return console.error("Error fetching teacher student results:",a),{success:!1,error:a.message,results:[]}}},LV=async(e,t)=>{try{console.log(" Fetching student results view:",{studentId:e,academicPeriodId:t});const r=t?`&academic_period_id=${t}`:"",s=await(await p1.makeAuthenticatedRequest(`/.netlify/functions/get-student-results-view?student_id=${e}${r}`)).json();if(s.success)return console.log(" Student results view loaded:",s.results.length,"results"),{success:!0,results:s.results,count:s.results.length};throw new Error(s.error||"Failed to load student results view")}catch(r){return console.error("Error fetching student results view:",r),{success:!1,error:r.message,results:[]}}},ime=async(e,t,r,n)=>{try{console.log(" Fetching class summary:",{teacherId:e,grade:t,className:r,academicPeriodId:n});const a=await(await p1.makeAuthenticatedRequest(`/.netlify/functions/get-class-summary?teacher_id=${e}&grade=${t}&class=${r}&academic_period_id=${n}`)).json();if(a.success)return console.log(" Class summary loaded:",a.summary),{success:!0,summary:a.summary,hasData:!!a.summary};throw new Error(a.error||"Failed to load class summary")}catch(s){return console.error("Error fetching class summary:",s),{success:!1,error:s.message,summary:null}}},ome=async(e,t,r,n,s={})=>{try{const a=await IV(e,t,r,n);if(!a.success)return a;let i=a.results;return s.subject&&(i=i.filter(o=>o.subject&&o.subject.toLowerCase().includes(s.subject.toLowerCase()))),s.testType&&(i=i.filter(o=>o.test_type===s.testType)),s.minScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100>=s.minScore)),s.maxScore!==void 0&&(i=i.filter(o=>o.score/o.max_score*100<=s.maxScore)),s.passed!==void 0&&(i=i.filter(o=>o.score>=o.passing_score===s.passed)),{success:!0,results:i,count:i.length,originalCount:a.results.length}}catch(a){return console.error("Error filtering teacher student results:",a),{success:!1,error:a.message,results:[]}}},lme=async(e,t,r={})=>{try{const n=await LV(e,t);if(!n.success)return n;let s=n.results;return r.subject&&(s=s.filter(a=>a.subject&&a.subject.toLowerCase().includes(r.subject.toLowerCase()))),r.testType&&(s=s.filter(a=>a.test_type===r.testType)),r.semester&&(s=s.filter(a=>a.semester===r.semester)),r.passed!==void 0&&(s=s.filter(a=>a.score>=a.passing_score===r.passed)),{success:!0,results:s,count:s.length,originalCount:n.results.length}}catch(n){return console.error("Error filtering student results view:",n),{success:!1,error:n.message,results:[]}}},cme={getTeacherStudentResults:IV,getStudentResultsView:LV,getClassSummary:ime,getTeacherStudentResultsFiltered:ome,getStudentResultsViewFiltered:lme},ume=({testType:e,testId:t,isShuffled:r,allowedTime:n,onSave:s,onCancel:a,canEdit:i=!0})=>{const[o,c]=w.useState(!1),[u,d]=w.useState(r||!1),[f,h]=w.useState(!!n),[g,p]=w.useState(n?Math.floor(n/60):""),[x,v]=w.useState(!1);w.useEffect(()=>{d(r||!1)},[r]),w.useEffect(()=>{h(!!n),p(n?Math.floor(n/60):"")},[n]),w.useEffect(()=>{!i&&o&&c(!1)},[i,o]);const C=async()=>{v(!0);try{const _=f&&g?Math.floor(parseFloat(g)*60):null,T={};["input","true_false","multiple_choice"].includes(e)&&(T.is_shuffled=u),T.allowed_time=_,await s(T),c(!1)}catch(_){console.error("Error saving settings:",_),alert("Failed to save settings. Please try again.")}finally{v(!1)}},b=()=>{d(r||!1),h(!!n),p(n?Math.floor(n/60):""),c(!1)};return o?l.jsxs("div",{className:"space-y-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[["input","true_false","multiple_choice"].includes(e)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",id:"is_shuffled",checked:u,onChange:_=>d(_.target.checked),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("label",{htmlFor:"is_shuffled",className:"text-sm font-medium text-gray-700",children:"Shuffle questions"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",id:"enable_timer",checked:f,onChange:_=>{h(_.target.checked),_.target.checked||p("")},className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsx("label",{htmlFor:"enable_timer",className:"text-sm font-medium text-gray-700",children:"Enable timer"})]}),f&&l.jsxs("div",{className:"ml-6 flex items-center space-x-2",children:[l.jsx("input",{type:"number",min:"1",step:"1",value:g,onChange:_=>p(_.target.value.replace(/[^0-9]/g,"")),placeholder:"Minutes",className:"w-24 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"}),l.jsx("span",{className:"text-sm text-gray-600",children:"minutes"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[l.jsx(at,{onClick:C,variant:"primary",size:"sm",disabled:x||f&&!g,children:x?"Saving...":"Save"}),l.jsx(at,{onClick:b,variant:"outline",size:"sm",children:"Cancel"})]})]}):l.jsxs("div",{className:"flex items-center space-x-4",children:[["input","true_false","multiple_choice"].includes(e)&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Shuffled:"}),l.jsx("span",{className:`text-sm font-semibold ${u?"text-green-600":"text-gray-400"}`,children:u?" Yes":" No"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Timer:"}),f&&g?l.jsxs("span",{className:"text-sm font-semibold text-blue-600",children:[" ",g," minutes"]}):l.jsx("span",{className:"text-sm font-semibold text-gray-400",children:" Not set"})]}),i&&l.jsx(at,{onClick:()=>c(!0),variant:"outline",size:"sm",children:" Edit"})]})},SE=({isOpen:e,onClose:t,testType:r,testId:n,testName:s,questions:a=[],isLoading:i=!1,onSave:o,canEdit:c=!0,canEditSettings:u=!0,subject:d,createdAt:f,assignments:h=[],testInfo:g=null,onSettingsSave:p})=>{const[x,v]=w.useState(!1),[C,b]=w.useState([]),[_,T]=w.useState(!1),[N,E]=w.useState(!1),F=Array.isArray(a)?a:[],j=!!c,P=u!==void 0?!!u:!!c;if(w.useEffect(()=>{F.length>0?b(JSON.parse(JSON.stringify(F))):b([]),E(!1)},[F]),w.useEffect(()=>{e||(v(!1),E(!1),T(!1))},[e]),w.useEffect(()=>{!j&&x&&(v(!1),E(!1))},[j,x]),!e)return null;const M=R=>({multiple_choice:"Multiple Choice",true_false:"True/False",input:"Input",matching_type:"Matching",word_matching:"Word Matching",fill_blanks:"Fill in the Blanks"})[R]||R,I=(R,L)=>{switch(L){case"multiple_choice":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"grid grid-cols-1 gap-2",children:[R.option_a&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"A"}),l.jsx("span",{className:"text-gray-700",children:R.option_a})]}),R.option_b&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"B"}),l.jsx("span",{className:"text-gray-700",children:R.option_b})]}),R.option_c&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"C"}),l.jsx("span",{className:"text-gray-700",children:R.option_c})]}),R.option_d&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"D"}),l.jsx("span",{className:"text-gray-700",children:R.option_d})]}),R.option_e&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"E"}),l.jsx("span",{className:"text-gray-700",children:R.option_e})]}),R.option_f&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:R.option_f})]})]})]});case"true_false":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Options:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"T"}),l.jsx("span",{className:"text-gray-700",children:"True"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:"F"}),l.jsx("span",{className:"text-gray-700",children:"False"})]})]})]});case"input":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Answer Format:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Type your answer in the text input field"})})]});case"matching_type":return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Instructions:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("span",{className:"text-gray-600 italic",children:"Match the items by connecting them with lines or selecting pairs"})})]});default:return null}},U=(R,L)=>{if(!R.correct_answer&&!R.correct_answers)return null;let G="";switch(L){case"multiple_choice":G=R.correct_answer?.toUpperCase()||"";break;case"true_false":G=R.correct_answer?"True":"False";break;case"input":Array.isArray(R.correct_answers)?G=R.correct_answers.join(", "):G=R.correct_answer||R.correct_answers||"";break;case"matching_type":G=typeof R.correct_answer=="object"?JSON.stringify(R.correct_answer):R.correct_answer;break;default:G=String(R.correct_answer||R.correct_answers||"")}return l.jsxs("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded",children:[l.jsx("p",{className:"font-medium text-green-800 mb-1",children:"Correct Answer:"}),l.jsx("p",{className:"text-green-700 font-mono",children:G})]})},K=async()=>{if(!N){console.log("No changes to save");return}console.log("Saving questions...",{testType:r,testId:n,questionsCount:C.length}),T(!0);try{o?await o(r,n,C):await Pn.updateTestQuestions(r,n,C),E(!1),v(!1)}catch(R){console.error("Error saving questions:",R),alert("Failed to save questions. Please try again.")}finally{T(!1)}};w.useEffect(()=>{x&&console.log("Edit mode is ON",{hasChanges:N,questionsCount:C.length})},[x,N,C.length]);const te=(R,L)=>{if(!x)return l.jsxs(l.Fragment,{children:[I(R,"multiple_choice"),U(R,"multiple_choice")]});const G=`mc_question_${n}_${L}`,W=X=>{const se=[...C];se[L].question=X,b(se),E(!0)},Q=(X,se)=>{const le=[...C];le[L][X]=se,b(le),E(!0)};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text:"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{id:G,className:"w-full p-2 pr-20 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",rows:3,value:C[L]?.question||"",onChange:X=>{W(X.target.value)}}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(G),onChange:X=>W(X.target.value)})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Options:"}),l.jsx("button",{type:"button",onClick:()=>{const X=[...C],se=X[L],le=["A","B","C","D","E","F"];if(le.filter(we=>{const ie=`option_${we.toLowerCase()}`;return se[ie]&&se[ie].trim()!==""}).length<6){const we=le.find(ie=>{const Ee=`option_${ie.toLowerCase()}`;return!se[Ee]||se[Ee].trim()===""});if(we){const ie=`option_${we.toLowerCase()}`;se[ie]="",b(X),E(!0)}}},className:"text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200",disabled:["A","B","C","D","E","F"].filter(X=>{const se=`option_${X.toLowerCase()}`;return C[L]?.[se]&&C[L][se].trim()!==""}).length>=6,children:"+ Add Option"})]}),["A","B","C","D","E","F"].map(X=>{const se=`option_${X.toLowerCase()}`,le=C[L]?.[se],he=le??"",we=typeof le=="string"&&le.trim()!=="";return!we&&!(le==="")&&X!=="A"&&X!=="B"?null:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded w-8 text-center",children:X}),l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",id:`mc_option_${n}_${L}_${X}`,className:"w-full p-2 pr-20 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",value:he,onChange:Ee=>{Q(se,Ee.target.value)},placeholder:`Option ${X}`}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`mc_option_${n}_${L}_${X}`),onChange:Ee=>Q(se,Ee.target.value)})]}),we&&l.jsx("button",{type:"button",onClick:()=>{const Ee=[...C];Ee[L][se]=null,b(Ee),E(!0)},className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200",title:"Remove option",children:""})]},X)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer:"}),l.jsxs("select",{className:"p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",value:C[L]?.correct_answer||"",onChange:X=>{const se=[...C];se[L].correct_answer=X.target.value,b(se),E(!0)},children:[l.jsx("option",{value:"",children:"Select correct answer"}),["A","B","C","D","E","F"].map(X=>{const se=`option_${X.toLowerCase()}`,le=C[L]?.[se]||"";return!le||le.trim()===""?null:l.jsxs("option",{value:X.toLowerCase(),children:["Option ",X]},X)})]})]})]})},re=(R,L)=>{if(!x)return l.jsxs(l.Fragment,{children:[I(R,"true_false"),U(R,"true_false")]});const G=`tf_question_${n}_${L}`,W=Q=>{const X=[...C];X[L].question=Q,b(X),E(!0)};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text:"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{id:G,className:"w-full p-2 pr-20 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",rows:3,value:C[L]?.question||"",onChange:Q=>{W(Q.target.value)}}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(G),onChange:Q=>W(Q.target.value)})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer:"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs("label",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"radio",name:`correct_answer_${L}`,value:"true",checked:C[L]?.correct_answer===!0||C[L]?.correct_answer==="true",onChange:()=>{const Q=[...C];Q[L].correct_answer=!0,b(Q),E(!0)}}),l.jsx("span",{children:"True"})]}),l.jsxs("label",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"radio",name:`correct_answer_${L}`,value:"false",checked:C[L]?.correct_answer===!1||C[L]?.correct_answer==="false",onChange:()=>{const Q=[...C];Q[L].correct_answer=!1,b(Q),E(!0)}}),l.jsx("span",{children:"False"})]})]})]})]})},Z=(R,L)=>{if(!x)return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Question:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",dangerouslySetInnerHTML:{__html:Ms(R.question||R.question_text||"")}}),l.jsx("p",{className:"font-medium text-gray-700 mb-2 mt-4",children:"Correct Answer(s):"}),l.jsx("div",{className:"bg-green-50 p-3 rounded border border-green-200",children:Array.isArray(R.correct_answers)?l.jsx("ul",{className:"list-disc list-inside space-y-1",children:R.correct_answers.map((le,he)=>l.jsx("li",{dangerouslySetInnerHTML:{__html:Ms(String(le))}},he))}):l.jsx("span",{dangerouslySetInnerHTML:{__html:Ms(String(R.correct_answer||R.correct_answers||""))}})})]});const G=`input_question_${n}_${L}`,W=C[L]?.question??C[L]?.question_text??"",Q=le=>{const he=[...C];he[L].question_text!==void 0?he[L].question_text=le:he[L].question=le,b(he),E(!0)},X=(le,he)=>{const we=[...C];Array.isArray(we[L].correct_answers)||(we[L].correct_answers=[]),we[L].correct_answers[le]=he,b(we),E(!0)},se=le=>{const he=[...C];he[L].correct_answers!==void 0&&!Array.isArray(he[L].correct_answers)?he[L].correct_answers=le:(he[L].correct_answer,he[L].correct_answer=le),b(he),E(!0)};return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text (supports math: $...$ for inline, $$...$$ for display):"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{id:G,className:"w-full p-2 pr-20 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 font-mono text-sm",rows:4,value:W,onChange:le=>{Q(le.target.value)},placeholder:"Enter question text. Use $x^2$ for math expressions."}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(G),onChange:le=>Q(le.target.value)})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s) (supports math: $...$ for inline, $$...$$ for display):"}),Array.isArray(C[L]?.correct_answers)?l.jsxs("div",{className:"space-y-2",children:[C[L].correct_answers.map((le,he)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",id:`input_answer_${n}_${L}_${he}`,className:"w-full p-2 pr-20 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 font-mono text-sm",value:String(le),onChange:we=>{X(he,we.target.value)},placeholder:"Enter answer (supports math: $x^2$)"}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`input_answer_${n}_${L}_${he}`),onChange:we=>X(he,we.target.value)})]}),l.jsx("button",{type:"button",onClick:()=>{const we=[...C];we[L].correct_answers.splice(he,1),b(we),E(!0)},className:"px-3 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Remove"})]},he)),l.jsx("button",{type:"button",onClick:()=>{const le=[...C];le[L].correct_answers||(le[L].correct_answers=[]),le[L].correct_answers.push(""),b(le),E(!0)},className:"px-3 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 text-sm",children:"+ Add Answer"})]}):l.jsx("div",{children:l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",id:`input_answer_${n}_${L}_single`,className:"w-full p-2 pr-20 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 font-mono text-sm",value:String(C[L]?.correct_answer||C[L]?.correct_answers||""),onChange:le=>{se(le.target.value)},placeholder:"Enter answer (supports math: $x^2$)"}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`input_answer_${n}_${L}_single`),onChange:le=>se(le.target.value)})]})})]})]})},B=Rs.useCallback(()=>{b(R=>{const L=R.map(W=>{const Q=W?.question_id??W?.id,X=Number(Q);return Number.isFinite(X)?X:null}).filter(W=>W!==null),G=L.length>0?Math.max(...L)+1:1;return[...R,{id:null,question_id:G,left_word:"",right_word:"",__isNew:!0}]}),E(!0)},[b,E]),J=(R,L)=>{if(!x)return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Word Pair:"}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex-1 bg-gray-100 p-3 rounded",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Left:"})," ",R.left_word]}),l.jsx("span",{className:"text-gray-400",children:""}),l.jsxs("div",{className:"flex-1 bg-gray-100 p-3 rounded",children:[l.jsx("span",{className:"font-semibold text-gray-700",children:"Right:"})," ",R.right_word]})]})]});const G=(X,se,le)=>C.filter((we,ie)=>ie===le?!1:se==="left"?we.left_word?.toLowerCase()===X?.toLowerCase():we.right_word?.toLowerCase()===X?.toLowerCase()).length>0,W=G(C[L]?.left_word,"left",L),Q=G(C[L]?.right_word,"right",L);return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Left Word:"}),l.jsx("input",{type:"text",className:`w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${W?"border-red-300 bg-red-50":"border-gray-300"}`,value:C[L]?.left_word||"",onChange:X=>{const se=[...C];se[L].left_word=X.target.value,b(se),E(!0)},placeholder:"Enter left word"}),W&&l.jsx("p",{className:"text-xs text-red-600 mt-1",children:" Duplicate left word detected"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Right Word:"}),l.jsx("input",{type:"text",className:`w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 ${Q?"border-red-300 bg-red-50":"border-gray-300"}`,value:C[L]?.right_word||"",onChange:X=>{const se=[...C];se[L].right_word=X.target.value,b(se),E(!0)},placeholder:"Enter right word"}),Q&&l.jsx("p",{className:"text-xs text-red-600 mt-1",children:" Duplicate right word detected"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("button",{type:"button",onClick:()=>{if(L>0){const X=[...C];[X[L-1],X[L]]=[X[L],X[L-1]],b(X),E(!0)}},disabled:L===0,className:"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:" Move Up"}),l.jsx("button",{type:"button",onClick:()=>{if(L<C.length-1){const X=[...C];[X[L],X[L+1]]=[X[L+1],X[L]],b(X),E(!0)}},disabled:L===C.length-1,className:"px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:" Move Down"}),l.jsx("button",{type:"button",onClick:()=>{if(window.confirm("Are you sure you want to remove this word pair?")){const X=C.filter((se,le)=>le!==L);b(X),E(!0)}},className:"px-3 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200 text-sm",children:"Remove"})]})]})},z=(R,L)=>{if(!x)return l.jsxs("div",{className:"space-y-2",children:[l.jsx("p",{className:"font-medium text-gray-700 mb-2",children:"Question:"}),l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:JSON.stringify(R.question_json,null,2)})}),l.jsx("p",{className:"font-medium text-gray-700 mb-2 mt-4",children:"Correct Answers:"}),l.jsx("div",{className:"bg-green-50 p-3 rounded border border-green-200",children:Array.isArray(R.correct_answers)?l.jsx("ul",{className:"list-disc list-inside space-y-1",children:R.correct_answers.map((Q,X)=>l.jsx("li",{children:String(Q)},X))}):l.jsx("span",{children:String(R.correct_answers)})})]});const G=JSON.stringify(R.question_json||{},null,2),W=Array.isArray(R.correct_answers)?R.correct_answers:[R.correct_answers||""];return l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question JSON (structured text):"}),l.jsx("textarea",{className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 font-mono text-sm",rows:6,value:G,onChange:Q=>{try{const X=JSON.parse(Q.target.value),se=[...C];se[L].question_json=X,b(se),E(!0)}catch(X){console.error("Invalid JSON:",X)}},placeholder:'{"type": "paragraph", "children": [...]}'}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Edit the JSON structure for the question text"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s):"}),l.jsxs("div",{className:"space-y-2",children:[W.map((Q,X)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("input",{type:"text",className:"flex-1 p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",value:String(Q),onChange:se=>{const le=[...C];le[L].correct_answers[X]=se.target.value,b(le),E(!0)},placeholder:"Enter answer"}),l.jsx("button",{type:"button",onClick:()=>{const se=[...C];se[L].correct_answers.splice(X,1),b(se),E(!0)},className:"px-3 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Remove"})]},X)),l.jsx("button",{type:"button",onClick:()=>{const Q=[...C];Q[L].correct_answers||(Q[L].correct_answers=[]),Q[L].correct_answers.push(""),b(Q),E(!0)},className:"px-3 py-2 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 text-sm",children:"+ Add Answer"})]})]})]})},q=x?C:F,H=q.length;return l.jsx(Ai,{children:l.jsxs(Ze.div,{className:"fixed inset-0 z-50 overflow-y-auto",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},children:[l.jsx(Ze.div,{className:"fixed inset-0 bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:t}),l.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:l.jsxs(Ze.div,{className:"relative bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.3},children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 flex-shrink-0",children:[l.jsx("div",{className:"flex items-center space-x-3",children:l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:s||"Test Details"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[M(r),"  ",H," Question",H!==1?"s":""]})]})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[j&&["input","multiple_choice","true_false","word_matching"].includes(r)&&l.jsx(at,{onClick:()=>{x&&N?window.confirm("You have unsaved changes. Are you sure you want to cancel?")&&(v(!1),b(JSON.parse(JSON.stringify(a))),E(!1)):v(!x)},variant:x?"outline":"primary",size:"sm",className:"flex items-center space-x-1",children:x?" Cancel Edit":" Edit Questions"}),l.jsx(at,{onClick:t,variant:"outline",size:"sm",className:"flex items-center space-x-1",children:" Close"})]})]}),l.jsx("div",{className:"p-6 overflow-y-auto flex-1 min-h-0",children:i?l.jsx("div",{className:"flex items-center justify-center py-12",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading test details..."})]})}):l.jsxs("div",{className:"space-y-6",children:[!j&&l.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded text-sm text-yellow-800",children:"Editing is disabled because this test has an active assignment."}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Test Information"}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d&&l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Subject:"}),l.jsx("p",{className:"text-sm text-gray-900",children:d})]}),f&&l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Created:"}),l.jsx("p",{className:"text-sm text-gray-900",children:new Date(f).toLocaleDateString()})]})]}),h&&h.length>0&&l.jsxs("div",{className:"mt-4",children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:h.map((R,L)=>l.jsxs("span",{className:"bg-gray-100 text-gray-700 px-2 py-1 rounded text-xs font-medium",children:[R.grade,"/",R.class]},L))})]}),g&&p&&l.jsx("div",{className:"mt-4 pt-4 border-t border-blue-200",children:l.jsx(ume,{testType:r,testId:n,isShuffled:g?.is_shuffled,allowedTime:g?.allowed_time,onSave:p,canEdit:P})})]}),H===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"No Questions Available"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"This test doesn't have any questions yet."}),x&&r==="word_matching"&&l.jsx("button",{type:"button",onClick:B,className:"px-4 py-2 text-sm font-medium text-blue-600 border border-dashed border-blue-300 rounded hover:bg-blue-50",children:"+ Add Word Pair"})]}):l.jsxs("div",{className:"space-y-6",children:[q.map((R,L)=>l.jsxs(Ze.div,{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:L*.1,duration:.3},children:[l.jsx("div",{className:"flex items-start justify-between mb-4",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:["Question ",L+1]}),l.jsx("span",{className:"text-gray-500 text-sm",children:M(r)})]})}),l.jsx("div",{className:"mb-4",children:x?l.jsxs("div",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:[r==="multiple_choice"&&te(R,L),r==="true_false"&&re(R,L),r==="input"&&Z(R,L),r==="word_matching"&&J(R,L),r==="fill_blanks"&&z(R,L)]}):l.jsxs(l.Fragment,{children:[l.jsx("p",{className:"text-gray-800 font-medium text-lg leading-relaxed",children:r==="input"?l.jsx("span",{dangerouslySetInnerHTML:{__html:Ms(R.question||R.question_text||"")}}):r==="word_matching"?l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("span",{className:"bg-blue-100 px-3 py-1 rounded",children:R.left_word}),l.jsx("span",{className:"text-gray-400",children:""}),l.jsx("span",{className:"bg-green-100 px-3 py-1 rounded",children:R.right_word})]}):r==="fill_blanks"?l.jsx("div",{className:"bg-gray-100 p-3 rounded",children:l.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:JSON.stringify(R.question_json,null,2)})}):R.question||R.question_text}),I(R,r),U(R,r)]})})]},R.id||R.question_id||L)),x&&r==="word_matching"&&l.jsx("div",{className:"flex justify-center pt-2",children:l.jsx("button",{type:"button",onClick:B,className:"px-4 py-2 text-sm font-medium text-blue-600 border border-dashed border-blue-300 rounded hover:bg-blue-50",children:"+ Add Word Pair"})})]})]})}),l.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[l.jsx("div",{className:"text-sm text-gray-600",children:H>0&&l.jsx("span",{children:x?N?l.jsx("span",{className:"text-orange-600 font-semibold",children:" Unsaved changes"}):l.jsxs("span",{children:["Showing ",H," question",H!==1?"s":""]}):l.jsxs("span",{children:["Showing ",H," question",H!==1?"s":""]})})}),l.jsxs("div",{className:"flex items-center space-x-3",children:[x&&l.jsx("button",{onClick:K,disabled:_||!N,className:`px-4 py-2 rounded-md font-medium flex items-center space-x-2 min-w-[140px] justify-center transition-all ${_||!N?"bg-gray-400 text-gray-700 cursor-not-allowed opacity-60":"bg-blue-600 text-white hover:bg-blue-700 cursor-pointer"}`,children:_?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),l.jsx("span",{children:"Saving..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{children:"Save Changes"})]})}),l.jsx(at,{onClick:t,variant:x?"outline":"primary",className:"flex items-center space-x-2",children:"Close"})]})]})]})})]})})},dme=({onChange:e})=>{const[t]=w.useContext(I1)||[];return w.useEffect(()=>{if(e&&t)return t.registerUpdateListener(({editorState:r})=>{r.read(()=>{Zs().getTextContent();const s=r.toJSON();e(JSON.stringify(s))})})},[t,e]),null},fme=({onAddBlank:e,blankCount:t})=>{const[r]=w.useContext(I1)||[],n=w.useCallback(()=>{r&&r.dispatchCommand(To,"bold")},[r]),s=w.useCallback(()=>{r&&r.dispatchCommand(To,"italic")},[r]),a=w.useCallback(()=>{r&&r.dispatchCommand(To,"underline")},[r]),i=w.useCallback(()=>{r&&r.dispatchCommand(To,"strikethrough")},[r]),o=w.useCallback(p=>{r&&r.update(()=>{const x=wr();Jt(x)&&Zp(x,()=>Hf(p))})},[r]),c=w.useCallback(()=>{r&&r.update(()=>{const p=wr();Jt(p)&&Zp(p,()=>zs())})},[r]),u=w.useCallback(()=>{r&&r.update(()=>{const p=wr();Jt(p)&&Zp(p,()=>q2())})},[r]),d=w.useCallback(()=>{r&&r.dispatchCommand(xE)},[r]),f=w.useCallback(()=>{r&&r.dispatchCommand(yE)},[r]),h=w.useCallback(()=>{r&&r.dispatchCommand(vE)},[r]),g=w.useCallback(()=>{!r||!e||(r.update(()=>{const p=wr();if(Jt(p)){const v=`${t+1}_________`,C=wa(v);C.setStyle("background-color: #f0f9ff; border: 1px dashed #3b82f6; padding: 2px 4px; border-radius: 4px; font-family: monospace;"),p.insertNodes([C])}}),e())},[r,e,t]);return l.jsxs("div",{className:"flex flex-wrap items-center gap-1 p-2 border-b border-gray-300 bg-gray-50",children:[l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:n,className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Bold",children:"B"}),l.jsx("button",{type:"button",onClick:s,className:"px-2 py-1 text-sm italic border border-gray-300 rounded hover:bg-gray-200",title:"Italic",children:"I"}),l.jsx("button",{type:"button",onClick:a,className:"px-2 py-1 text-sm underline border border-gray-300 rounded hover:bg-gray-200",title:"Underline",children:"U"}),l.jsx("button",{type:"button",onClick:i,className:"px-2 py-1 text-sm line-through border border-gray-300 rounded hover:bg-gray-200",title:"Strikethrough",children:"S"})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:()=>o("h1"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 1",children:"H1"}),l.jsx("button",{type:"button",onClick:()=>o("h2"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 2",children:"H2"}),l.jsx("button",{type:"button",onClick:()=>o("h3"),className:"px-2 py-1 text-sm font-bold border border-gray-300 rounded hover:bg-gray-200",title:"Heading 3",children:"H3"}),l.jsx("button",{type:"button",onClick:c,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Paragraph",children:"P"}),l.jsx("button",{type:"button",onClick:u,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Quote",children:'"'})]}),l.jsxs("div",{className:"flex items-center gap-1 border-r border-gray-300 pr-2",children:[l.jsx("button",{type:"button",onClick:d,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Bullet List",children:""}),l.jsx("button",{type:"button",onClick:f,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Numbered List",children:"1."}),l.jsx("button",{type:"button",onClick:h,className:"px-2 py-1 text-sm border border-gray-300 rounded hover:bg-gray-200",title:"Remove List",children:""})]}),e&&l.jsx("div",{className:"flex items-center gap-1 border-l border-gray-300 pl-2",children:l.jsxs("button",{type:"button",onClick:g,className:"px-3 py-1 text-sm font-medium bg-blue-500 text-white border border-blue-600 rounded hover:bg-blue-600 transition-colors",title:"Add Blank",children:[l.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"currentColor",className:"inline mr-1",children:l.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})}),"Add Blank"]})})]})},hme=({value:e,onChange:t,placeholder:r,onAddBlank:n,blankCount:s=0})=>{const a={namespace:"FillBlanksLexicalEditor",theme:{root:"p-4 min-h-32 focus:outline-none",paragraph:"mb-2",heading:{h1:"text-3xl font-bold mb-4",h2:"text-2xl font-bold mb-3",h3:"text-xl font-bold mb-2"},quote:"border-l-4 border-gray-300 pl-4 italic text-gray-600 mb-2",list:{nested:{listitem:"list-none"},ol:"list-decimal list-inside mb-2",ul:"list-disc list-inside mb-2",listitem:"mb-1"},text:{bold:"font-bold",italic:"italic",underline:"underline",strikethrough:"line-through"}},nodes:[K2,wh,D0,V2,gg,KS,Y2,H1,G1,V1,_h],onError:i=>{console.error("Lexical error:",i)},editorState:e?(()=>{try{const i=JSON.parse(e);return JSON.stringify(i)}catch{return JSON.stringify({root:{children:[{children:[{detail:0,format:0,mode:"normal",style:"",text:e,type:"text",version:1}],direction:"ltr",format:"",indent:0,type:"paragraph",version:1}],direction:"ltr",format:"",indent:0,type:"root",version:1}})}})():void 0};return l.jsx("div",{className:"border border-gray-300 rounded-lg overflow-hidden",children:l.jsxs(VG,{initialConfig:a,children:[l.jsx(fme,{onAddBlank:n,blankCount:s}),l.jsx(dme,{onChange:t}),l.jsxs("div",{className:"relative",children:[l.jsx(uV,{contentEditable:l.jsx(fV,{className:"p-4 min-h-32 focus:outline-none"}),placeholder:l.jsx("div",{className:"absolute top-4 left-4 text-gray-400 pointer-events-none",children:r}),ErrorBoundary:gV}),l.jsx(hV,{}),l.jsx(mV,{}),l.jsx(FV,{}),l.jsx(PV,{transformers:YS})]})]})})},mme=({testName:e="",allowedTime:t=null,onTestSaved:r,onCancel:n,onBackToCabinet:s,isSaving:a=!1,validationErrors:i={}})=>{const{user:o}=ws(),{post:c}=tc(),{showNotification:u}=Ls(),[d,f]=w.useState({test_name:e,test_text:"",num_questions:1,num_blanks:0,passing_score:100,separate_type:!0,allowed_time:t,blanks:[]}),[h,g]=w.useState({isLoading:!1,error:null,showPreview:!0});w.useEffect(()=>{f(F=>({...F,test_name:e||"",allowed_time:t}))},[e,t]);const p=F=>{f(j=>({...j,test_text:F}))},x=()=>{const j={id:d.blanks.length+1,position:0,question:"",options:["","","",""],correct_answer:""};f(P=>({...P,blanks:[...P.blanks,j],num_blanks:P.num_blanks+1}))},v=F=>{f(j=>({...j,blanks:j.blanks.filter(P=>P.id!==F),num_blanks:j.num_blanks-1}))},C=F=>{f(j=>({...j,blanks:j.blanks.map(P=>P.id===F?{...P,options:[...P.options,""]}:P)}))},b=(F,j)=>{f(P=>({...P,blanks:P.blanks.map(M=>M.id===F?{...M,options:M.options.filter((I,U)=>U!==j),correct_answer:M.correct_answer===String.fromCharCode(65+j)?"":M.correct_answer}:M)}))},_=(F,j,P)=>{f(M=>({...M,blanks:M.blanks.map(I=>I.id===F?{...I,options:I.options.map((U,K)=>K===j?P:U)}:I)}))},T=(F,j)=>{console.log(" [DEBUG] updateBlankQuestion called:",{blankId:F,question:j}),f(P=>({...P,blanks:P.blanks.map(M=>M.id===F?{...M,question:j}:M)})),console.log(" [DEBUG] updateBlankQuestion completed")},N=(F,j)=>{f(P=>({...P,blanks:P.blanks.map(M=>M.id===F?{...M,correct_answer:j}:M)}))},E=async()=>{if(!d.test_name.trim()){g(F=>({...F,error:"Test name is required"}));return}if(!d.test_text.trim()){g(F=>({...F,error:"Test text is required"}));return}if(d.blanks.length===0){g(F=>({...F,error:"At least one blank is required"}));return}if(console.log(" [DEBUG] Validating blanks:",d.blanks),d.blanks.forEach((F,j)=>{console.log(` [DEBUG] Blank ${j+1}:`,{question:F.question,questionTrimmed:F.question?.trim(),correct_answer:F.correct_answer,options:F.options})}),d.separate_type===!1){if(d.blanks.some(F=>!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing correct answer"),g(F=>({...F,error:"All blanks must have correct answers"}));return}}else if(d.blanks.some(F=>!F.question.trim()||!F.correct_answer)){console.log(" [DEBUG] Validation failed - some blanks missing question or correct answer"),g(F=>({...F,error:"All blanks must have question text and correct answer"}));return}console.log(" [DEBUG] Validation passed - all blanks have question and correct answer"),g(F=>({...F,isLoading:!0,error:null}));try{const F={test_name:d.test_name,test_text:d.test_text,num_questions:d.blanks.length,num_blanks:d.blanks.length,separate_type:d.separate_type,passing_score:d.passing_score,allowed_time:d.allowed_time,blanks:d.blanks.map((j,P)=>({question_id:P+1,question_json:j.question,question:j.question,options:j.options,correct_answer:j.correct_answer,blank_positions:{},blank_options:j.options||[],correct_answers:[j.correct_answer]}))};console.log(" [DEBUG] Calling onTestSaved with data:",F),r?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),r(F),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(F){console.error("Error preparing fill blanks test:",F),g(j=>({...j,error:"Failed to prepare fill blanks test. Please try again."})),u("Failed to prepare fill blanks test","error")}finally{g(F=>({...F,isLoading:!1}))}};return l.jsxs("div",{className:"fill-blanks-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Fill Blanks Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a test with text content and multiple choice blanks"}),h.error&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-red-600 text-sm",children:h.error})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!0?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(F=>({...F,separate_type:!0})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!0,onChange:()=>f(F=>({...F,separate_type:!0})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Separate Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Multiple choice questions below the text"})]}),l.jsxs("div",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${d.separate_type===!1?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>f(F=>({...F,separate_type:!1})),children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx("input",{type:"radio",checked:d.separate_type===!1,onChange:()=>f(F=>({...F,separate_type:!1})),className:"mr-3"}),l.jsx("h4",{className:"font-medium",children:"Inline Mode"})]}),l.jsx("p",{className:"text-sm text-gray-600",children:"Dropdown for option inside the text"})]})]}),l.jsx(hme,{value:d.test_text,onChange:p,placeholder:"Type your text here. Use the 'Add Blank' button in the toolbar to insert blanks.",onAddBlank:x,blankCount:d.blanks.length})]}),d.separate_type===!0&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,j)=>l.jsxs(Kt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Configuration"]}),l.jsx(at,{variant:"danger",size:"small",onClick:()=>v(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Question Text for Blank ",F.id," *"]}),l.jsx("input",{type:"text",placeholder:"Enter question text for this blank",value:F.question,onChange:P=>T(F.id,P.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((P,M)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+M)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+M)}`,value:P||"",onChange:I=>_(F.id,M,I.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(at,{variant:"danger",size:"small",onClick:()=>b(F.id,M),className:"px-2 py-1 text-sm",children:""})]},M)),F.options.length<6&&l.jsx(at,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:P=>N(F.id,P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(P=>P.trim().length>0).map((P,M)=>l.jsxs("option",{value:String.fromCharCode(65+M),children:[String.fromCharCode(65+M),") ",P]},M))]})]})]},F.id))}),d.separate_type===!1&&l.jsx("div",{className:"space-y-4",children:d.blanks.map((F,j)=>l.jsxs(Kt,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("h4",{className:"text-md font-medium",children:["Blank ",F.id," Options"]}),l.jsx(at,{variant:"danger",size:"small",onClick:()=>v(F.id),className:"px-2 py-1 text-sm",children:"Remove Blank"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsx("h5",{className:"text-sm font-medium text-gray-700",children:"Answer Options:"}),F.options.map((P,M)=>l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center text-sm font-semibold text-gray-600",children:String.fromCharCode(65+M)}),l.jsx("input",{type:"text",placeholder:`Option ${String.fromCharCode(65+M)}`,value:P||"",onChange:I=>_(F.id,M,I.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200"}),F.options.length>2&&l.jsx(at,{variant:"danger",size:"small",onClick:()=>b(F.id,M),className:"px-2 py-1 text-sm",children:""})]},M)),F.options.length<6&&l.jsx(at,{variant:"secondary",size:"small",onClick:()=>C(F.id),className:"w-full",children:"+ Add Option"})]}),l.jsxs("div",{className:"mt-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correct Answer *"}),l.jsxs("select",{value:F.correct_answer||"",onChange:P=>N(F.id,P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),F.options.filter(P=>P.trim().length>0).map((P,M)=>l.jsxs("option",{value:String.fromCharCode(65+M),children:[String.fromCharCode(65+M),") ",P]},M))]})]})]},F.id))}),l.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[l.jsx(at,{onClick:n,variant:"secondary",disabled:a,children:"Cancel"}),l.jsx(at,{onClick:E,variant:"primary",disabled:a||d.blanks.length===0,children:a?l.jsx(Xr,{size:"sm"}):"Save Test"})]})]})},gme=({testText:e,blanks:t,separateType:r=!0,testId:n,testName:s="Unknown Test",teacherId:a="Unknown Teacher",subjectId:i,onTestComplete:o,onAnswerChange:c})=>{console.log(" FillBlanksTestStudent Props Debug:"),console.log("- testText:",e),console.log("- blanks:",t),console.log("- separateType:",r),console.log("- testId:",n),console.log("- testName:",s),console.log("- teacherId:",a),console.log("- subjectId:",i);const{theme:u,isCyberpunk:d,isLight:f,isKpop:h,themeClasses:g}=da(),p=ua(u);if(!e||!t||!Array.isArray(t))return console.log(" FillBlanksTestStudent: Missing test data"),l.jsx("div",{className:`min-h-screen flex items-center justify-center ${d?"":h?"bg-black":"bg-gray-50"}`,style:d?{backgroundColor:fe.black}:h?{...p.background}:{},children:l.jsx(Kt,{className:`max-w-md w-full ${d?Vt(0).className:""}`,style:d?{...Vt(0).style,...p.glow}:{},children:l.jsxs(Kt.Body,{className:"text-center",children:[l.jsx("div",{className:`text-6xl mb-4 ${d?"":"text-gray-500"}`,style:d?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsx("h2",{className:`text-xl font-semibold mb-2 ${d?"":"text-gray-900"}`,style:d?{color:fe.cyan,fontFamily:"monospace",...p.textShadow}:{},children:d?"NO TEST DATA":"No Test Data"}),l.jsx("p",{className:`mb-4 ${d?"":"text-gray-600"}`,style:d?{color:fe.cyan,fontFamily:"monospace"}:{},children:d?"UNABLE TO LOAD FILL BLANKS TEST DATA":"Unable to load fill blanks test data"}),l.jsx(at,{onClick:()=>window.history.back(),variant:"primary",children:"Back to Dashboard"})]})})});const[x,v]=w.useState({}),[C,b]=w.useState(!1),[_,T]=w.useState(null),[N,E]=w.useState(null),[F,j]=w.useState(!1),[P,M]=w.useState(null),{showNotification:I}=Ls(),{makeAuthenticatedRequest:U}=tc(),{user:K}=ws(),{startTracking:te,stopTracking:re,getCheatingData:Z,clearData:B}=D1("fill_blanks",n,K?.student_id||K?.id);kS();const J=w.useCallback((R,L)=>{try{let G=R;if(typeof R=="string"&&R.startsWith("{"))try{const se=JSON.parse(R);se.root&&se.root.children&&(G=se.root.children.map(le=>le.children?le.children.map(he=>he.style&&he.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":he.text||"").join(""):"").join(" "))}catch(se){console.error("Error parsing Lexical JSON:",se)}let W=G;L.forEach((se,le)=>{const he=`[${le+1}_________]`;W=W.replace("[BLANK_PLACEHOLDER]",he)});const X=W.split(/(\[\d+_________\])/).map((se,le)=>se.match(/\[\d+_________\]/)?l.jsx("span",{className:`inline-block px-3 py-1 mx-1 border-2 rounded-lg font-mono font-bold shadow-sm ${d?"border":"bg-purple-100 text-purple-800 border-purple-400"}`,style:d?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...p.glow}:{},children:se},le):l.jsx("span",{style:d?{color:fe.cyan,fontFamily:"monospace"}:h?{color:He.text}:{},children:se},le));return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap ",style:d?{color:fe.cyan,fontFamily:"monospace"}:h?{...p.textWhite}:{},children:X})})}catch(G){return console.error("Error rendering text with blanks:",G),l.jsx("div",{className:d||h?"":"text-red-500",style:d?{color:fe.red,fontFamily:"monospace",...p.textShadowRed}:h?{color:He.error,textShadow:`0 0 8px ${He.error}`}:{},children:d?"ERROR LOADING TEST CONTENT":"Error loading test content"})}},[d,p]),z=w.useCallback((R,L)=>{try{let G=R;if(typeof R=="string"&&R.startsWith("{"))try{const se=JSON.parse(R);se.root&&se.root.children&&(G=se.root.children.map(le=>le.children?le.children.map(he=>he.style&&he.style.includes("background-color: #f0f9ff")?"[BLANK_PLACEHOLDER]":he.text||"").join(""):"").join(" "))}catch(se){console.error("Error parsing Lexical JSON:",se)}const W=[];L.forEach((se,le)=>{const he=x[se.id],we=he?se.options[he.charCodeAt(0)-65]:null,ie=we?l.jsx("span",{className:`inline-block px-3 py-2 rounded-lg border-2 cursor-pointer transition-all duration-200 font-bold shadow-sm ${d?"border":"bg-green-100 text-green-800 border-green-400 hover:bg-green-200 hover:border-green-500"}`,onClick:()=>E(se.id),style:d?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...p.glow}:{},children:we},le):l.jsxs("span",{className:`inline-block px-3 py-2 rounded-lg border-2 cursor-pointer transition-all duration-200 font-bold shadow-sm ${d?"border":"bg-purple-100 text-purple-800 border-purple-400 hover:bg-purple-200 hover:border-purple-500"}`,onClick:()=>E(se.id),style:d?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...p.glow}:{},children:[le+1,"_________"]},le);W.push(ie),G=G.replace("[BLANK_PLACEHOLDER]",`__BLANK_${se.id}__`)});const Q=G.split(/__BLANK_\d+__/),X=[];for(let se=0;se<Q.length;se++)Q[se]&&X.push(l.jsx("span",{style:d?{color:fe.cyan,fontFamily:"monospace"}:h?{color:He.text}:{},children:Q[se]},`text-${se}`)),se<W.length&&X.push(W[se]);return l.jsx("div",{className:"prose max-w-none mb-6",children:l.jsx("div",{className:"text-lg leading-relaxed whitespace-pre-wrap ",style:d?{color:fe.cyan,fontFamily:"monospace"}:h?{...p.textWhite}:{},children:X})})}catch(G){return console.error("Error rendering text with inline blanks:",G),l.jsx("div",{className:d?"":"text-red-500",style:d?{color:fe.red,fontFamily:"monospace",...p.textShadowRed}:{},children:d?"ERROR LOADING TEST CONTENT":"Error loading test content"})}},[x,d,p]),q=w.useCallback((R,L)=>{const G={...x,[R]:L};v(G),c&&c(R,L)},[x,c]),H=w.useCallback(R=>l.jsx("div",{className:"space-y-6",children:R.map((L,G)=>{const W=L.blank_options||L.options||[];L.correct_answers;const Q=L.question_json||L.question||`Blank ${G+1}`;return console.log(` Blank ${G+1} question text:`,Q),l.jsxs(Kt,{className:`p-4 ${d?Vt(G%4).className:""}`,style:d?{...Vt(G%4).style,...p.glow}:{},children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("h4",{className:`text-lg font-semibold mb-2 ${d?"":"text-gray-800"}`,style:d?{color:fe.cyan,fontFamily:"monospace",...p.textShadow}:{},children:d?`QUESTION ${G+1}`:`Question ${G+1}`}),l.jsx("p",{className:`mb-4 ${d?"":"text-gray-600"}`,style:d?{color:fe.cyan,fontFamily:"monospace"}:{},children:Q})]}),l.jsx("div",{className:"space-y-3",children:W.filter(X=>X&&X.trim().length>0).map((X,se)=>l.jsxs("label",{className:`flex items-center space-x-3 cursor-pointer p-2 rounded-lg transition-colors border-2 ${d?"border":"hover:bg-gray-50"}`,style:d?{backgroundColor:fe.black,borderColor:fe.cyan,...x[L.question_id||L.id||G]===String.fromCharCode(65+se)?p.glow:{}}:{},children:[l.jsx("input",{type:"radio",name:`blank_${L.question_id||L.id||G}`,value:String.fromCharCode(65+se),checked:x[L.question_id||L.id||G]===String.fromCharCode(65+se),onChange:le=>q(L.question_id||L.id||G,le.target.value),className:`w-4 h-4 ${d?"":"text-blue-600 border-gray-300 focus:ring-blue-500"}`,style:d?{accentColor:fe.cyan}:{}}),l.jsxs("span",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-sm font-semibold border-2 ${d?"border":"bg-gray-100 text-gray-600"}`,style:d?{backgroundColor:x[L.question_id||L.id||G]===String.fromCharCode(65+se)?fe.cyan:fe.black,borderColor:fe.cyan,color:x[L.question_id||L.id||G]===String.fromCharCode(65+se)?fe.black:fe.cyan,fontFamily:"monospace"}:{},children:String.fromCharCode(65+se)}),l.jsx("span",{className:d?"":"text-gray-700",style:d?{color:fe.cyan,fontFamily:"monospace"}:{},children:X})]})]},se))})]},L.question_id||L.id||G)})}),[x,q,d,p]);return w.useEffect(()=>{if(n&&K?.student_id){T(new Date),te(),console.log(" Anti-cheating tracking started for fill blanks test");const L=`test_progress_${K.student_id}_fill_blanks_${n}`,G=Os(L);G&&(v(G.answers||{}),T(new Date(G.startTime)),console.log(" Fill blanks test progress restored:",G))}},[n,K?.student_id,t,te]),w.useEffect(()=>{if(_&&K?.student_id&&n){const R=setInterval(()=>{const L={answers:x,startTime:_.toISOString()},G=`test_progress_${K.student_id}_fill_blanks_${n}`;vs(G,L,hs.test_progress),console.log(" Fill blanks progress auto-saved")},3e4);return()=>clearInterval(R)}},[_,x,K?.student_id,n]),w.useEffect(()=>()=>{re(),B(),console.log(" Fill blanks test component unmounted - anti-cheating cleanup")},[re,B]),w.useCallback(async()=>{b(!0);try{const R=t.length;let L=0;t.forEach((Ge,et)=>{const vt=x[Ge.id];vt&&vt===Ge.correct_answer&&L++});const G=L,W=R;console.log(` Fill Blanks Score: ${G}/${W} (${Math.round(G/W*100)}%)`);const Q=new Date,X=_?Math.round((Q-_)/1e3):0,se=_?_.toISOString():Q.toISOString(),le=Z();console.log(" Anti-cheating data for fill blanks submission:",le);const he=K.student_id,we=`retest_assignment_id_${he}_fill_blanks_${n}`,ie=localStorage.getItem(we),{academicCalendarService:Ee}=await ui(async()=>{const{academicCalendarService:Ge}=await Promise.resolve().then(()=>JS);return{academicCalendarService:Ge}},void 0);await Ee.loadAcademicCalendar();const Ie=Ee.getCurrentTerm()?.id;if(!Ie)throw new Error("No current academic period found");const ut={test_id:n,test_name:s,teacher_id:a||null,subject_id:i||null,student_id:he,academic_period_id:Ie,parent_test_id:n,retest_assignment_id:ie?Number(ie):null,answers:x,score:G,maxScore:W,time_taken:X,started_at:se,submitted_at:Q.toISOString(),caught_cheating:le.caught_cheating,visibility_change_times:le.visibility_change_times};console.log(" Submitting fill blanks test:",ut);const $t=await(await U("/.netlify/functions/submit-fill-blanks-test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ut)})).json();if($t.success){if(I("Test submitted successfully!","success"),re(),B(),console.log(" Anti-cheating tracking stopped and data cleared for fill blanks test"),K?.student_id&&(j1(K.student_id,"fill_blanks",n),console.log(" Fill blanks test data cleared from cache")),!!ie&&K?.student_id){let et=3;try{const Ve=localStorage.getItem(`student_active_tests_${K.student_id}`);if(Ve){const wt=JSON.parse(Ve)?.tests?.find(Ut=>Ut.test_id===n&&Ut.test_type==="fill_blanks");wt&&(et=wt.retest_attempts_left||wt.max_attempts||3)}}catch(Ve){console.error("Error checking active tests cache:",Ve)}const Te=(G>0&&W>0?G/W*100:0)>=50;if(Te){const Ve=`retest_attempt${et}_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(Ve,"true"),console.log(" Passed retest, marking last-slot key:",Ve);let pt=0;for(let ct=1;ct<=10;ct++){const yt=`retest_attempt${ct}_${K.student_id}_fill_blanks_${n}`;localStorage.getItem(yt)==="true"&&pt++}const wt=`test_completed_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(wt,"true"),console.log(" Marked retest as completed (student passed):",wt);const Ut=`retest_attempts_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(Ut,JSON.stringify({used:pt,max:et})),console.log(" Set retest attempts metadata (student passed):",Ut,{used:pt,max:et})}else{let Ve=1;for(let yt=1;yt<=10;yt++){const rt=`retest_attempt${yt}_${K.student_id}_fill_blanks_${n}`;if(localStorage.getItem(rt)!=="true"){Ve=yt;break}}const pt=`retest_attempt${Ve}_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(pt,"true"),console.log(" Marked retest attempt as completed:",pt);let wt=0;for(let yt=1;yt<=10;yt++){const rt=`retest_attempt${yt}_${K.student_id}_fill_blanks_${n}`;localStorage.getItem(rt)==="true"&&wt++}const Ut=et-wt,ct=Ut<=0||Te;if(console.log(" Retest completion check:",{usedAttempts:wt,maxAttempts:et,attemptsLeft:Ut,passed:Te,shouldComplete:ct}),ct){const yt=`test_completed_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(yt,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",yt);const rt=`retest_attempts_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(rt,JSON.stringify({used:wt,max:et})),console.log(" Set retest attempts metadata (attempts exhausted):",rt,{used:wt,max:et})}}}else if(K?.student_id){const et=`test_completed_${K.student_id}_fill_blanks_${n}`;localStorage.setItem(et,"true"),console.log(" Fill blanks test marked as completed in localStorage:",et)}if(K?.student_id){const et=`retest1_${he}_fill_blanks_${n}`;localStorage.removeItem(et),localStorage.removeItem(we)}if(K?.student_id){const et=`student_results_table_${K.student_id}`;vs(et,$t,hs.student_results_table),console.log(" Fill blanks test results cached with key:",et)}setShowSubmitModal(!1),setTimeout(()=>{o&&o(G)},2e3)}else throw new Error($t.message||"Failed to submit test")}catch(R){console.error("Error submitting test:",R),I("Error submitting test. Please try again.","error")}finally{b(!1)}},[x,t,n,s,a,i,_,Z,re,B,U,I,o,K]),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:`space-y-4 ${d||h?"bg-black":""}`,style:d?{backgroundColor:fe.black}:h?{...p.background}:{},children:l.jsxs(Kt,{className:d?Vt(0).className:h?hr(0).className:"",style:d?{...Vt(0).style,...p.glow}:h?{...hr(0).style,...p.glow}:{},children:[C&&l.jsx(Kt.Header,{children:l.jsx("div",{className:"flex items-center justify-center",children:l.jsxs("div",{className:`flex items-center space-x-2 text-sm ${d?"":h?"text-violet-600":"text-gray-500"}`,style:d?{color:fe.cyan,fontFamily:"monospace"}:h?{color:He.primary}:{},children:[l.jsx(Xr,{size:"small"}),l.jsx("span",{children:d?"SUBMITTING...":"Submitting..."})]})})}),l.jsx(Kt.Body,{style:d?{backgroundColor:fe.black}:h?{backgroundColor:He.background}:{},children:r===!0?l.jsxs(l.Fragment,{children:[J(e,t),H(t)]}):l.jsx(l.Fragment,{children:z(e,t)})}),r===!1&&N&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 overflow-y-auto",children:l.jsxs("div",{className:`rounded-lg p-6 max-w-md w-full mx-4 border-2 ${d?Vt(0).className:"bg-white"}`,style:d?{...Vt(0).style,...p.glow}:{},children:[l.jsx("h3",{className:"text-lg font-semibold mb-4 ",style:d?{color:fe.cyan,fontFamily:"monospace",...p.textShadow}:{},children:d?"SELECT ANSWER":"Select Answer"}),l.jsx("div",{className:"space-y-2",children:t.find(R=>R.id===N)?.options.filter(R=>R.trim().length>0).map((R,L)=>l.jsxs("button",{onClick:()=>{q(N,String.fromCharCode(65+L)),E(null)},className:`w-full text-left px-4 py-2 rounded-lg border-2 ${d?"border":"hover:bg-gray-100 border-gray-200"}`,style:d?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace"}:{},children:[l.jsxs("span",{className:`font-semibold mr-2 ${d?"":"text-blue-600"}`,style:d?{color:fe.cyan,fontFamily:"monospace"}:{},children:[String.fromCharCode(65+L),")"]}),R]},L))}),l.jsx("div",{className:"mt-4 flex justify-end",children:l.jsx(at,{onClick:()=>E(null),variant:"secondary",size:"sm",children:"Cancel"})})]})}),l.jsx(Kt.Footer,{children:l.jsx("div",{className:"flex gap-3"})})]})})};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pme=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xme=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),jO=e=>{const t=xme(e);return t.charAt(0).toUpperCase()+t.slice(1)},BV=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),yme=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var vme={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=w.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>w.createElement("svg",{ref:c,...vme,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:BV("lucide",s),...!a&&!yme(o)&&{"aria-hidden":"true"},...o},[...i.map(([u,d])=>w.createElement(u,d)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q1=(e,t)=>{const r=w.forwardRef(({className:n,...s},a)=>w.createElement(bme,{ref:a,iconNode:t,className:BV(`lucide-${pme(jO(e))}`,`lucide-${e}`,n),...s}));return r.displayName=jO(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wme=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],_me=q1("download",wme);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sme=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]],kme=q1("maximize-2",Sme);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cme=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],Tme=q1("rotate-cw",Cme);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$V=q1("x",Nme);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Ame=q1("zoom-in",Eme);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],Pme=q1("zoom-out",jme),lu={WIDTH:1536,HEIGHT:2048,ASPECT_RATIO:1536/2048},UV={MIN:.25,MAX:1,INITIAL:.25,STEP:.1},um={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",ERASER:"eraser"},PO={CURSOR_COLOR:"#ff0000",CURSOR_OPACITY:.3},FO={ERASER_TO_THICKNESS_RATIO:2.5,THICKNESS_TO_ERASER_RATIO:.4},__={MAX_ENTRIES:10,MAX_MEMORY_KB:500,COMPRESSION_THRESHOLD:200},zV=e=>{try{const t=JSON.stringify(e);return new Blob([t]).size/1024}catch(t){return console.warn("Error calculating memory usage:",t),0}},Fme=e=>Array.isArray(e)?e.map(t=>Array.isArray(t)?Mme(t):t):e,Mme=e=>{if(e.length<=2)return e;const t=[e[0]],r=2;for(let n=1;n<e.length-1;n++){const s=e[n-1],a=e[n];e[n+1],Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2))>r&&t.push(a)}return t.push(e[e.length-1]),t},Rme=(e,t=Date.now())=>{const r=zV(e);return{data:[...e],timestamp:t,memoryUsage:r,compressed:r>__.COMPRESSION_THRESHOLD}},MO=(e,t,r)=>{const n=Rme(t),s=zV(t),a=e.slice(0,r+1);a.push(n);let i=a;return s>__.MAX_MEMORY_KB&&(i=Ome(a)),i.length>__.MAX_ENTRIES&&(i=i.slice(-10)),{history:i,index:i.length-1}},Ome=e=>e.map(t=>t.memoryUsage>__.COMPRESSION_THRESHOLD?{...t,data:Fme(t.data),compressed:!0}:t),RO=(e,t)=>{if(t<0||t>=e.length)return[];const r=e[t];return r?r.compressed?Dme(r.data):[...r.data]:[]},Dme=e=>[...e],OO=e=>e>0,DO=(e,t)=>e<t-1,Ime=()=>({history:[],index:-1}),Lme=()=>{const[e,t]=w.useState({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null}),[r,n]=w.useState([]),[s,a]=w.useState([]),i=w.useCallback(N=>{t(E=>({...E,...N}))},[]),o=w.useCallback(()=>{t({zoom:1,position:{x:0,y:0},rotation:0,currentTool:"pencil",currentColor:"#000000",currentThickness:2,eraserSize:10,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:[],historyIndex:-1,isFullscreen:!1,preFullscreenState:null})},[]),c=w.useCallback(N=>{const E={x:N.x,y:N.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,isDrawing:!0,currentLine:[E]})):["line","rectangle","circle"].includes(e.currentTool)&&t(F=>({...F,isDrawing:!0,currentShape:{type:e.currentTool,startX:N.x,startY:N.y,endX:N.x,endY:N.y,color:e.currentColor,thickness:e.currentThickness}}))},[e.currentTool,e.currentColor,e.currentThickness]),u=w.useCallback(N=>{if(!e.isDrawing)return;const E={x:N.x,y:N.y,color:e.currentColor,thickness:e.currentThickness};e.currentTool==="pencil"?t(F=>({...F,currentLine:[...F.currentLine,E]})):e.currentShape&&t(F=>({...F,currentShape:{...F.currentShape,endX:N.x,endY:N.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape]),d=w.useCallback(()=>{if(!e.isDrawing)return;let N=r;if(e.currentTool==="pencil"&&e.currentLine.length>0?(N=[...r,e.currentLine],n(N)):e.currentShape&&(N=[...r,e.currentShape],n(N)),N!==r){const E=MO(e.drawingHistory,N,e.historyIndex);t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null,drawingHistory:E.history,historyIndex:E.index}))}else t(E=>({...E,isDrawing:!1,currentLine:[],currentShape:null}))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,r,e.drawingHistory,e.historyIndex]),f=w.useCallback(N=>Math.round(N*FO.ERASER_TO_THICKNESS_RATIO),[]),h=w.useCallback(N=>Math.round(N*FO.THICKNESS_TO_ERASER_RATIO),[]),g=w.useCallback(N=>{t(E=>({...E,currentThickness:N,eraserSize:f(N)}))},[f]),p=w.useCallback(N=>{t(E=>({...E,eraserSize:N,currentThickness:h(N)}))},[h]),x=w.useCallback(N=>{const E=MO(e.drawingHistory,N,e.historyIndex);t(F=>({...F,drawingHistory:E.history,historyIndex:E.index}))},[e.drawingHistory,e.historyIndex]),v=w.useCallback(()=>{if(OO(e.historyIndex)){const N=e.historyIndex-1,E=RO(e.drawingHistory,N);n([...E]),t(F=>({...F,historyIndex:N}))}},[e.historyIndex,e.drawingHistory]),C=w.useCallback(()=>{if(DO(e.historyIndex,e.drawingHistory.length)){const N=e.historyIndex+1,E=RO(e.drawingHistory,N);n([...E]),t(F=>({...F,historyIndex:N}))}},[e.historyIndex,e.drawingHistory]),b=w.useCallback(()=>{const N=Ime();t(E=>({...E,drawingHistory:N.history,historyIndex:N.index}))},[]),_=OO(e.historyIndex),T=DO(e.historyIndex,e.drawingHistory.length);return{drawingState:e,setDrawingState:t,drawingData:r,setDrawingData:n,textBoxes:s,setTextBoxes:a,updateDrawingState:i,resetDrawingState:o,startDrawing:c,continueDrawing:u,finishDrawing:d,handleThicknessChange:g,handleEraserSizeChange:p,saveToHistoryState:x,undo:v,redo:C,clearHistoryState:b,canUndoState:_,canRedoState:T}},IO={SCALE_DELTA:.05,CENTER_DELTA:20},Hp=e=>{if(e.length<2)return 0;const t=e[0],r=e[1];return Math.sqrt(Math.pow(r.clientX-t.clientX,2)+Math.pow(r.clientY-t.clientY,2))},If=e=>{if(e.length<2)return null;const t=e[0],r=e[1];return{x:(t.clientX+r.clientX)/2,y:(t.clientY+r.clientY)/2}},Bme=(e,t)=>{if(e.length!==2||!t)return null;const r=Hp(e),n=Hp(t),s=If(e),a=If(t);if(n===0)return null;const i=Math.abs(r/n-1),o=Math.sqrt(Math.pow(s.x-a.x,2)+Math.pow(s.y-a.y,2));return i>IO.SCALE_DELTA?"zoom":o>IO.CENTER_DELTA?"pan":null},$me=e=>{let t;return function(){const r=arguments,n=this;t&&cancelAnimationFrame(t),t=requestAnimationFrame(()=>{e.apply(n,r),t=null})}},Rp=(e,t)=>{const r=t.getPointerPosition();return{x:(r.x-t.x())/t.scaleX(),y:(r.y-t.y())/t.scaleY()}},xc={PENCIL:"pencil",LINE:"line",RECTANGLE:"rectangle",CIRCLE:"circle",PAN:"pan"},S_={color:"#000000",thickness:2},LO=(e,t,r)=>({x:e.x,y:e.y,color:t||S_.color,thickness:r||S_.thickness}),Ume=(e,t,r,n,s)=>({type:e,startX:t.x,startY:t.y,endX:r.x,endY:r.y,color:n||S_.color,thickness:s||S_.thickness}),WV=(e,t,r,n,s,a)=>{const i=e-r,o=t-n,c=s-r,u=a-n,d=i*c+o*u,f=c*c+u*u;let h=-1;f!==0&&(h=d/f);let g,p;h<0?(g=r,p=n):h>1?(g=s,p=a):(g=r+h*c,p=n+h*u);const x=e-g,v=t-p;return Math.sqrt(x*x+v*v)},zme=(e,t)=>{if(t.length===0)return[e];const r=t.sort((a,i)=>a.index-i.index),n=[];let s=0;for(const a of r)a.index>s&&n.push(e.slice(s,a.index+1)),s=a.index+1;return s<e.length&&n.push(e.slice(s)),n.filter(a=>a.length>0)},Wme=(e,t,r,n)=>{const s=[],a=r/2;for(let i=0;i<n.length-1;i++){const o=n[i],c=n[i+1],u=WV(e,t,o.x,o.y,c.x,c.y);u<=a&&s.push({index:i,point:{x:o.x,y:o.y},distance:u})}return s},Hme=(e,t,r,n)=>{const s=Wme(t,r,n,e);return s.length===0?[e]:zme(e,s)},Gme=(e,t,r,n)=>{if(n.type==="rectangle"){const s=Math.min(n.startX,n.endX),a=Math.min(n.startY,n.endY),i=Math.abs(n.endX-n.startX),o=Math.abs(n.endY-n.startY);return e>=s&&e<=s+i&&t>=a&&t<=a+o}else if(n.type==="circle"){const s=(n.startX+n.endX)/2,a=(n.startY+n.endY)/2,i=Math.sqrt(Math.pow(n.endX-n.startX,2)+Math.pow(n.endY-n.startY,2))/2;return Math.sqrt(Math.pow(e-s,2)+Math.pow(t-a,2))<=i}return!1},BO=(e,t,r,n)=>{const s=[];for(const a of n)if(Array.isArray(a)){const i=Hme(a,e,t,r);s.push(...i)}else a.type==="line"?WV(e,t,a.startX,a.startY,a.endX,a.endY)>r/2&&s.push(a):(a.type==="rectangle"||a.type==="circle")&&(Gme(e,t,r,a)||s.push(a));return s},Vme=(e,t,r,n,s,a,i,o,c)=>{const[u,d]=w.useState({isActive:!1,type:null,lastDistance:null,lastCenter:null}),f=w.useCallback(E=>{if(E.evt.preventDefault(),E.evt.stopPropagation(),e.currentTool===xc.PAN)return;const F=E.target.getStage(),j=Rp(E,F),P=LO(j,e.currentColor,e.currentThickness);e.currentTool===xc.PENCIL?t(M=>({...M,isDrawing:!0,currentLine:[P]})):[xc.LINE,xc.RECTANGLE,xc.CIRCLE].includes(e.currentTool)&&t(M=>({...M,isDrawing:!0,currentShape:Ume(e.currentTool,j,j,e.currentColor,e.currentThickness)}))},[e.currentTool,e.currentColor,e.currentThickness,t]),h=w.useCallback(E=>{const F=BO(E.x,E.y,e.eraserSize,r);n(F),s(F)},[e.eraserSize,r,n,s]),g=w.useCallback(E=>{o&&(a(),x("Undo",E))},[o,a]),p=w.useCallback(E=>{c&&(i(),x("Redo",E))},[c,i]),x=w.useCallback((E,F)=>{const j=F.target.getStage(),P=Rp(F,j),M=new Konva.Circle({x:P.x,y:P.y,radius:20,stroke:"#4CAF50",strokeWidth:3,opacity:.8,listening:!1});j.add(M),M.to({scaleX:2,scaleY:2,opacity:0,duration:.3,onFinish:()=>{M.destroy()}})},[]),v=w.useCallback(E=>{if(E.evt.preventDefault(),E.evt.stopPropagation(),!e.isDrawing)return;const F=E.target.getStage(),j=Rp(E,F),P=LO(j,e.currentColor,e.currentThickness);e.currentTool===xc.PENCIL?t(M=>({...M,currentLine:[...M.currentLine,P]})):e.currentShape&&t(M=>({...M,currentShape:{...M.currentShape,endX:j.x,endY:j.y}}))},[e.isDrawing,e.currentTool,e.currentColor,e.currentThickness,e.currentShape,t]),C=w.useCallback(E=>{E&&E.evt&&(E.evt.preventDefault(),E.evt.stopPropagation()),e.isDrawing&&(e.currentTool===xc.PENCIL&&e.currentLine.length>0?n(F=>[...F,e.currentLine]):e.currentShape&&n(F=>[...F,e.currentShape]),t(F=>({...F,isDrawing:!1,currentLine:[],currentShape:null})))},[e.isDrawing,e.currentTool,e.currentLine,e.currentShape,n,t]),b=w.useCallback(E=>{E.evt.preventDefault(),E.evt.stopPropagation();const F=E.evt.touches;if(F.length===2)d({isActive:!0,type:"pan",lastDistance:Hp(F),lastCenter:If(F)});else if(F.length===1)if(e.currentTool===xc.ERASER){const j=E.target.getStage(),P=Rp(E,j);h(P)}else e.currentTool===xc.UNDO?g(E):e.currentTool===xc.REDO?p(E):f(E)},[Hp,If,f,e.currentTool,h,g,p]),_=w.useCallback($me(E=>{E.evt.preventDefault(),E.evt.stopPropagation();const F=E.evt.touches;if(F.length===2&&u.isActive){const j=Bme(F,u);if(j==="zoom"){const P=Hp(F),M=If(F),I=P/u.lastDistance,U=Math.max(.25,Math.min(1,e.zoom*I));t(K=>({...K,zoom:U,position:{x:M.x-(M.x-K.position.x)*(U/K.zoom),y:M.y-(M.y-K.position.y)*(U/K.zoom)}}))}else if(j==="pan"){const P=If(F),M=P.x-u.lastCenter.x,I=P.y-u.lastCenter.y;t(U=>({...U,position:{x:U.position.x+M,y:U.position.y+I}}))}d(P=>({...P,lastDistance:Hp(F),lastCenter:If(F)}))}else if(F.length===1)if(e.currentTool===xc.ERASER){const j=E.target.getStage(),P=Rp(E,j),M=BO(P.x,P.y,e.eraserSize,r);n(M)}else if(e.currentTool===xc.PAN){const j=If(F),P=j.x-u.lastCenter.x,M=j.y-u.lastCenter.y;t(I=>({...I,position:{x:I.position.x+P,y:I.position.y+M}})),d(I=>({...I,lastCenter:j}))}else v(E)}),[u,e.zoom,t,v]),T=w.useCallback(E=>{_(E)},[_]),N=w.useCallback(E=>{E.evt.preventDefault(),E.evt.stopPropagation();const F=E.evt.touches;F.length===0?(C(E),d({isActive:!1,type:null,lastDistance:null,lastCenter:null})):F.length===1&&d(j=>({...j,isActive:!1}))},[C]);return{handleTouchStart:b,handleTouchMove:T,handleTouchEnd:N,handleEraserStart:h,handleUndoTouch:g,handleRedoTouch:p,showTouchFeedback:x}},qme=(e,t)=>{const[r,n]=w.useState(e.MIN),[s,a]=w.useState({x:0,y:0}),i=w.useCallback((h,g,p)=>{const x=Math.max(e.MIN,Math.min(e.MAX,h));if(g){const v=x/r,C={x:g.x-(g.x-s.x)*v,y:g.y-(g.y-s.y)*v};return{zoom:x,position:C}}else{const v=t.width*x,C=t.height*x,b={x:(p.width-v)/2,y:(p.height-C)/2};return{zoom:x,position:b}}},[r,s,e,t]),o=w.useCallback(()=>{const h=Math.min(r*(1+e.STEP),e.MAX);n(h)},[r,e]),c=w.useCallback(()=>{const h=Math.max(r/(1+e.STEP),e.MIN);n(h)},[r,e]),u=w.useCallback((h,g,p)=>{const x=i(h,g,p);n(x.zoom),a(x.position)},[i]),d=w.useCallback((h,g)=>{a(p=>({x:p.x+h,y:p.y+g}))},[]),f=w.useCallback(()=>{n(e.INITIAL),a({x:0,y:0})},[e.INITIAL]);return{zoom:r,setZoom:n,position:s,setPosition:a,handleZoomIn:o,handleZoomOut:c,handleZoomToPoint:u,handlePan:d,resetZoom:f}},Kme=e=>{const[t,r]=w.useState([]),[n,s]=w.useState(0),a=w.useCallback(f=>{if(console.log("parseDrawingData - input drawing:",f),console.log("parseDrawingData - drawing.answers:",f?.answers),!f?.answers)return console.log("parseDrawingData - no answers found, returning empty array"),[];try{if(typeof f.answers=="string"){console.log("parseDrawingData - parsing string answers");const h=JSON.parse(f.answers);return console.log("parseDrawingData - parsed string result:",h),h&&typeof h=="object"&&h.lines&&console.log("parseDrawingData - new format detected with lines and textBoxes"),h}if(f.answers&&typeof f.answers=="object"&&f.answers.lines)return console.log("parseDrawingData - answers is new format object"),f.answers;if(Array.isArray(f.answers)){if(console.log("parseDrawingData - answers is array"),f.answers.every(g=>typeof g=="string"))try{const g=f.answers.map(p=>{try{return JSON.parse(p)}catch{return p}});return console.log("parseDrawingData - parsed array elements"),g}catch{return console.log("parseDrawingData - failed to parse array elements, returning raw"),f.answers}return f.answers}return console.log("parseDrawingData - answers is neither string nor array, returning empty array"),[]}catch(h){return console.error("Error parsing drawing data:",h),[]}},[]),i=w.useCallback(f=>{if(console.log("processQuestions - input answers:",f),console.log("processQuestions - answers type:",typeof f),console.log("processQuestions - answers isArray:",Array.isArray(f)),f&&typeof f=="object"&&f.lines){console.log("processQuestions - new format detected with lines and textBoxes"),console.log("processQuestions - lines count:",f.lines?.length),console.log("processQuestions - textBoxes count:",f.textBoxes?.length);const g=o(f.lines);return console.log("processQuestions - canvas groups:",g),console.log("processQuestions - number of canvas groups:",g.length),g.map((p,x)=>(console.log(`processQuestions - canvas ${x} strokes:`,p),console.log(`processQuestions - canvas ${x} stroke count:`,p.length),{questionNumber:x+1,drawingData:p,textBoxes:f.textBoxes||[]}))}if(Array.isArray(f)&&f.every(g=>g&&typeof g=="object"&&g.lines))return console.log("processQuestions - array of {lines,textBoxes} detected"),f.map((g,p)=>({questionNumber:p+1,drawingData:g.lines||[],textBoxes:g.textBoxes||[]}));if(!Array.isArray(f))return console.log("processQuestions - answers is not array or object, returning empty array"),[];console.log("processQuestions - processing",f.length,"answers (old format)");const h=o(f);return console.log("processQuestions - canvas groups:",h),console.log("processQuestions - number of canvas groups:",h.length),h.map((g,p)=>(console.log(`processQuestions - canvas ${p} strokes:`,g),console.log(`processQuestions - canvas ${p} stroke count:`,g.length),{questionNumber:p+1,drawingData:g,textBoxes:[]}))},[]),o=w.useCallback(f=>{console.log("groupStrokesByCanvas - input answers:",f);const h=c(f);return console.log("groupStrokesByCanvas - using strategy:",h),h==="by_question_boundary"?u(f):h==="by_stroke_type"?d(f):[f]},[]),c=w.useCallback(f=>{console.log("determineGroupingStrategy - analyzing answers:",f);let h=0,g=0;return f.forEach(p=>{Array.isArray(p)?h++:typeof p=="object"&&g++}),console.log("determineGroupingStrategy - arrayCount:",h,"objectCount:",g),h>0&&g>0?"by_stroke_type":f.length>3?"by_question_boundary":"single_canvas"},[]),u=w.useCallback(f=>{console.log("groupByQuestionBoundary - grouping answers:",f);const h=[];let g=[];const p=Math.ceil(f.length/2);for(let x=0;x<f.length;x++)g.push(f[x]),(x+1)%p===0&&x<f.length-1&&(h.push([...g]),g=[]);return g.length>0&&h.push(g),console.log("groupByQuestionBoundary - result:",h),h},[]),d=w.useCallback(f=>{console.log("groupByStrokeType - grouping answers:",f);const h=[],g=[];f.forEach(x=>{Array.isArray(x)?h.push(x):typeof x=="object"&&g.push(x)});const p=[];return h.length>0&&p.push(h),g.length>0&&p.push(g),console.log("groupByStrokeType - result:",p),p},[]);return w.useEffect(()=>{if(e){console.log("useDataParsing - drawing object:",e),console.log("useDataParsing - drawing.answers:",e.answers),console.log("useDataParsing - drawing.answers type:",typeof e.answers),console.log("useDataParsing - drawing.answers length:",e.answers?.length);const f=a(e);console.log("useDataParsing - parsed answers:",f),console.log("useDataParsing - parsed answers type:",typeof f),console.log("useDataParsing - parsed answers length:",f?.length);const h=i(f);console.log("useDataParsing - processed questions:",h),console.log("useDataParsing - processed questions length:",h?.length),h.length>0&&(console.log("useDataParsing - first question drawingData:",h[0]?.drawingData),console.log("useDataParsing - first question drawingData length:",h[0]?.drawingData?.length)),r(h),s(0)}},[e,a,i]),{questionsData:t,setQuestionsData:r,currentQuestionIndex:n,setCurrentQuestionIndex:s,parseDrawingData:a,processQuestions:i}},$O={MIN:.25,INITIAL:1},Yme=(e,t)=>{const[r,n]=w.useState(!1),[s,a]=w.useState(null),i=w.useCallback(()=>{document.fullscreenElement||(a({zoom:e.zoom,position:{...e.position}}),document.documentElement.requestFullscreen().then(()=>{n(!0),t(c=>({...c,zoom:$O.MIN,position:{x:0,y:0},isFullscreen:!0}))}).catch(c=>{console.error("Error entering fullscreen:",c)}))},[e.zoom,e.position,t]),o=w.useCallback(()=>{document.fullscreenElement&&document.exitFullscreen().then(()=>{n(!1),s?(t(c=>({...c,zoom:s.zoom,position:s.position,isFullscreen:!1})),a(null)):t(c=>({...c,zoom:$O.INITIAL,position:{x:0,y:0},isFullscreen:!1}))}).catch(c=>{console.error("Error exiting fullscreen:",c)})},[s,t]);return{isFullscreen:r,enterFullscreen:i,exitFullscreen:o}},HV=w.forwardRef(({drawingData:e,textBoxes:t=[],drawingState:r,canvasSize:n,zoom:s,position:a,onTouchStart:i,onTouchMove:o,onTouchEnd:c,mousePosition:u,isMouseOverCanvas:d,isEraserDrawing:f},h)=>{const g=w.useRef(null),[p,x]=w.useState(.25),[v,C]=w.useState(null),[b,_]=w.useState({x:0,y:0}),[T,N]=w.useState(!1),E=w.useCallback(({x:q,y:H,size:R,visible:L,isDrawing:G})=>!L||!q||!H?null:l.jsx(Yf,{x:q,y:H,radius:R/2,stroke:PO.CURSOR_COLOR,strokeWidth:2,dash:[5,5],opacity:G?.8:PO.CURSOR_OPACITY,listening:!1,zIndex:1e3}),[]),F=w.useCallback(q=>{if(r.currentTool===um.ERASER){const H=q.target.getStage(),R=Rp(q,H);_(R)}},[r.currentTool]),j=w.useCallback(()=>{r.currentTool===um.ERASER&&N(!0)},[r.currentTool]),P=w.useCallback(()=>{N(!1)},[]);w.useEffect(()=>{const q=h.current;if(q)return q.on("mousemove",F),q.on("mouseenter",j),q.on("mouseleave",P),()=>{q.off("mousemove",F),q.off("mouseenter",j),q.off("mouseleave",P)}},[F,j,P,h]),w.useEffect(()=>{const q=n.width??n.WIDTH,H=n.height??n.HEIGHT,R=()=>{const L=g.current;if(!L)return;const G=L.clientWidth||1,W=L.clientHeight||1,Q=Math.abs(r.rotation%180)===90,X=Q?H:q,se=Q?q:H,le=Math.min(G/(X||1),W/(se||1));x(Math.min(le,1))};return R(),window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[n.width,n.height,n.WIDTH,n.HEIGHT,r.rotation]);const M=w.useMemo(()=>{const q=g.current;if(!q||!v)return 0;const H=q.clientWidth||1,R=q.clientHeight||1,L=Math.min(H/Math.max(v.width,1),R/Math.max(v.height,1));return Math.min(L,UV.MAX)},[v]),I=w.useMemo(()=>Math.max(s,p||1),[s,p]),U=w.useMemo(()=>{const q=n.width??n.WIDTH,H=n.height??n.HEIGHT;if(!g.current)return{x:0,y:0};const R=g.current.clientWidth||1,L=g.current.clientHeight||1,G=(R-q*I)/2,W=(L-H*I)/2;return s<=p?{x:G,y:W}:{x:a.x!==void 0?a.x:G,y:a.y!==void 0?a.y:W}},[a,s,p,I,n.width,n.height,v,M]);w.useEffect(()=>{if(!Array.isArray(e)||e.length===0){C(null);return}let q=1/0,H=1/0,R=-1/0,L=-1/0;const G=(se,le)=>{Number.isFinite(se)&&Number.isFinite(le)&&(se<q&&(q=se),le<H&&(H=le),se>R&&(R=se),le>L&&(L=le))};if(e.forEach(se=>{if(Array.isArray(se))se.forEach(le=>G(le.x,le.y));else if(se&&typeof se=="object"){if(se.type==="line")G(se.startX,se.startY),G(se.endX,se.endY);else if(se.type==="rectangle")G(se.startX,se.startY),G(se.endX,se.endY);else if(se.type==="circle"){const le=Math.sqrt(Math.pow(se.endX-se.startX,2)+Math.pow(se.endY-se.startY,2))/2,he=(se.startX+se.endX)/2,we=(se.startY+se.endY)/2;G(he-le,we-le),G(he+le,we+le)}}}),!Number.isFinite(q)||!Number.isFinite(H)||!Number.isFinite(R)||!Number.isFinite(L)){C(null);return}const W=16,Q=Math.max(1,R-q+W*2),X=Math.max(1,L-H+W*2);C({minX:q-W,minY:H-W,width:Q,height:X})},[e]),w.useEffect(()=>{console.log("CanvasViewer - drawingData:",e),console.log("CanvasViewer - drawingData length:",e?.length),console.log("CanvasViewer - textBoxes:",t),console.log("CanvasViewer - textBoxes length:",t?.length),e&&e.length>0&&console.log("CanvasViewer - first item:",e[0]),t&&t.length>0&&console.log("CanvasViewer - first textBox:",t[0])},[e,t]),w.useEffect(()=>{const q=n.width??n.WIDTH,H=n.height??n.HEIGHT;console.log("CanvasViewer - canvas dimensions:",{width:q,height:H}),console.log("CanvasViewer - zoom:",s,"fitZoom:",p,"displayScale:",I),console.log("CanvasViewer - stagePosition:",U)},[n,s,p,I,U]);const K=(q,H)=>{if(console.log(`CanvasViewer - rendering element ${H}:`,q),Array.isArray(q))return console.log(`CanvasViewer - rendering line with ${q.length} points`),l.jsx(Qi,{points:q.flatMap(R=>[R.x,R.y]),stroke:q[0]?.color||"#000000",strokeWidth:q[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},H);if(q.type==="line")return l.jsx(Qi,{points:[q.startX,q.startY,q.endX,q.endY],stroke:q.color,strokeWidth:q.thickness,lineCap:"round"},H);if(q.type==="rectangle"){const R=Math.abs(q.endX-q.startX),L=Math.abs(q.endY-q.startY),G=Math.min(q.startX,q.endX),W=Math.min(q.startY,q.endY);return l.jsx(Ja,{x:G,y:W,width:R,height:L,stroke:q.color,strokeWidth:q.thickness,fill:"transparent"},H)}else if(q.type==="circle"){const R=Math.sqrt(Math.pow(q.endX-q.startX,2)+Math.pow(q.endY-q.startY,2))/2,L=(q.startX+q.endX)/2,G=(q.startY+q.endY)/2;return l.jsx(Yf,{x:L,y:G,radius:R,stroke:q.color,strokeWidth:q.thickness,fill:"transparent"},H)}return null},te=()=>{if(!r.isDrawing)return null;if(r.currentTool===um.PENCIL&&r.currentLine.length>0)return l.jsx(Qi,{points:r.currentLine.flatMap(q=>[q.x,q.y]),stroke:r.currentColor,strokeWidth:r.currentThickness,tension:.5,lineCap:"round",lineJoin:"round"});if(r.currentShape){const{type:q,startX:H,startY:R,endX:L,endY:G,color:W,thickness:Q}=r.currentShape;if(q===um.LINE)return l.jsx(Qi,{points:[H,R,L,G],stroke:W,strokeWidth:Q,lineCap:"round"});if(q===um.RECTANGLE){const X=Math.abs(L-H),se=Math.abs(G-R),le=Math.min(H,L),he=Math.min(R,G);return l.jsx(Ja,{x:le,y:he,width:X,height:se,stroke:W,strokeWidth:Q,fill:"transparent"})}else if(q===um.CIRCLE){const X=Math.sqrt(Math.pow(L-H,2)+Math.pow(G-R,2))/2,se=(H+L)/2,le=(R+G)/2;return l.jsx(Yf,{x:se,y:le,radius:X,stroke:W,strokeWidth:Q,fill:"transparent"})}}return null},re=r.isFullscreen?{position:"fixed",inset:0,width:"100vw",height:"100vh",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f3f4f6",zIndex:60}:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"transparent"},Z={transform:`rotate(${r.rotation}deg)`,transformOrigin:"center center"},B=w.useCallback(q=>{q.preventDefault(),q.stopPropagation()},[]),J=w.useCallback(q=>{q.preventDefault(),q.stopPropagation()},[]),z=w.useCallback(q=>{q.preventDefault(),q.stopPropagation()},[]);return l.jsx("div",{style:{...re,touchAction:"none",WebkitTouchCallout:"none"},ref:g,className:"select-none",onTouchStart:B,onTouchMove:J,onTouchEnd:z,children:l.jsx("div",{style:{...Z,touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onTouchStart:B,onTouchMove:J,onTouchEnd:z,children:l.jsx(oh,{ref:h,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),scaleX:I,scaleY:I,x:U.x,y:U.y,onTouchStart:i,onTouchMove:o,onTouchEnd:c,children:l.jsxs(ih,{children:[l.jsx(Ja,{x:0,y:0,width:Math.max((n.width??n.WIDTH)||0,1536),height:Math.max((n.height??n.HEIGHT)||0,2048),fill:"white"}),e.map((q,H)=>(console.log(`CanvasViewer - mapping item ${H}:`,q),K(q,H))),t&&t.map((q,H)=>l.jsx(Ja,{x:q.x,y:q.y,width:q.width,height:q.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}},`textbox-${H}`)),t&&t.map((q,H)=>l.jsx(Nc,{x:q.x+8,y:q.y+8,width:q.width-16,height:q.height-16,text:q.text,fontSize:q.fontSize||14,fill:q.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"},`text-${H}`)),te(),r.currentTool===um.ERASER&&l.jsx(E,{x:b.x,y:b.y,size:r.eraserSize,visible:T,isDrawing:f})]})})})})});HV.displayName="CanvasViewer";function Xme({containerRef:e,canvasSize:t,rotation:r=0}){const[n,s]=w.useState(1),[a,i]=w.useState({x:0,y:0}),o=w.useRef({width:1,height:1}),c=w.useRef(.01),u=w.useRef(0),d=w.useRef(!1),f=w.useCallback(()=>{const T=t?.width??t?.WIDTH??0,N=t?.height??t?.HEIGHT??0,E=Math.abs(r%180)===90;return{width:E?N:T,height:E?T:N}},[t,r]),h=w.useCallback(()=>{const T=e?.current;if(!T)return{width:1,height:1};const N=T.clientWidth||1,E=T.clientHeight||1;return o.current={width:N,height:E},{width:N,height:E}},[e]),g=w.useCallback(()=>{const{width:T,height:N}=o.current,{width:E,height:F}=f(),j=T/Math.max(E,1),P=N/Math.max(F,1);return Math.min(j,P,1)*.98},[f]),p=w.useCallback(T=>{const{width:N,height:E}=o.current,{width:F,height:j}=f(),P=Math.max(c.current,Math.min(T,1.5));let M=(N-F*P)/2,I=(E-j*P)/2;const U=N-F*P,K=E-j*P;M=Math.min(Math.max(0,M),Math.max(0,U)),I=Math.min(Math.max(0,I),Math.max(0,K));try{console.log("[Camera] centerAtScale",{targetScale:T,clampedScale:P,container:{containerW:N,containerH:E},canvas:{canvasW:F,canvasH:j},translate:{x:M,y:I},rotation:r})}catch{}i({x:M,y:I}),s(P)},[f]),x=w.useCallback(()=>{const{width:T,height:N}=h(),{width:E,height:F}=f(),j=g();let P=(T-E*j)/2,M=(N-F*j)/2;const I=T-E*j,U=N-F*j;P=Math.min(Math.max(0,P),Math.max(0,I)),M=Math.min(Math.max(0,M),Math.max(0,U));try{console.log("[Camera] fitCanvas",{scale:j,container:{containerW:T,containerH:N},canvas:{canvasW:E,canvasH:F},translate:{x:P,y:M},rotation:r})}catch{}s(j),i({x:P,y:M}),c.current=j,d.current=!1},[f,h,g]),v=w.useCallback(()=>{const{width:T,height:N}=h(),{width:E,height:F}=f(),j=(T-E)/2,P=(N-F)/2;s(1),i({x:j,y:P})},[f,h]),C=w.useCallback((T,N)=>{const{width:E,height:F}=o.current,{width:j,height:P}=f(),M=Math.max(c.current,Math.min(T,1.5));if(N&&Number.isFinite(N.x)&&Number.isFinite(N.y)){const I={x:(N.x-a.x)/n,y:(N.y-a.y)/n},U=N.x-I.x*M,K=N.y-I.y*M;try{console.log("[Camera] zoomTo(pointer) ->",{from:n,to:M})}catch{}s(M),i({x:U,y:K}),u.current=Date.now()+400,d.current=!0}else{let I=(E-j*M)/2,U=(F-P*M)/2;const K=E-j*M,te=F-P*M;I=Math.min(Math.max(0,I),Math.max(0,K)),U=Math.min(Math.max(0,U),Math.max(0,te));try{console.log("[Camera] zoomTo(center) ->",{from:n,to:M})}catch{}s(M),i({x:I,y:U}),u.current=Date.now()+400,d.current=!0}},[f,n,a]),b=w.useCallback((T,N)=>{const E=n*T,{width:F,height:j}=o.current,P={x:F/2,y:j/2};C(E,N||P)},[n,C]),_=w.useCallback((T,N)=>{i(E=>({x:E.x+T,y:E.y+N})),u.current=Date.now()+200,d.current=!0},[]);return w.useEffect(()=>{const T=e?.current;if(!T)return;const N=new ResizeObserver(()=>{h();const E=g();if(c.current=E,!(Date.now()<u.current)&&!d.current){try{console.log("[Camera] resize centerAtScale",{scale:n})}catch{}p(n)}});return N.observe(T),h(),()=>N.disconnect()},[e,h,g,p,n]),w.useEffect(()=>{d.current=!1,c.current=g(),p(n)},[r,t?.width,t?.height,t?.WIDTH,t?.HEIGHT,g,p,n]),w.useMemo(()=>({scale:n,translate:a,setScale:s,setTranslate:i,centerAtScale:p,fitCanvas:x,oneToOne:v,zoomTo:C,zoomByFactor:b,panBy:_}),[n,a,p,x,v,C,b,_])}const Ky=new Map,GV=w.forwardRef(({drawingData:e,textBoxes:t=[],canvasSize:r,rotation:n=0,onScaleChange:s,persistKey:a="viewer",onTextBoxEdit:i},o)=>{const c=w.useRef(null),u=w.useRef(null),d=Xme({containerRef:c,canvasSize:r,rotation:n}),[f,h]=w.useState({width:1,height:1}),g=w.useRef(null),p=w.useRef(null),[x,v]=w.useState(null);w.useEffect(()=>{console.log("[ViewerCanvas] drawingData received:",e),console.log("[ViewerCanvas] drawingData length:",e?.length),e&&e.length>0&&console.log("[ViewerCanvas] First drawing element:",e[0]),console.log("[ViewerCanvas] textBoxes:",t),console.log("[ViewerCanvas] textBoxes length:",t?.length)},[e]),w.useEffect(()=>{typeof s=="function"&&s(d.scale);try{console.log("[ViewerCanvas] scale changed",{scale:d.scale})}catch{}if(a){const z=Ky.get(a)||{};Ky.set(a,{...z,scale:d.scale})}},[d.scale,s]),w.useEffect(()=>{if(a){const z=Ky.get(a)||{};Ky.set(a,{...z,translate:{x:d.translate.x,y:d.translate.y}})}},[a,d.translate.x,d.translate.y]),w.useImperativeHandle(o,()=>({zoomIn:z=>d.zoomByFactor(1.1,z),zoomOut:z=>d.zoomByFactor(1/1.1,z),fitCanvas:()=>d.fitCanvas(),oneToOne:()=>d.oneToOne(),getScale:()=>d.scale,getStage:()=>u.current,getPointerPosition:()=>u.current?.getPointerPosition?.(),exportPNGFullCanvas:()=>{const z=u.current;if(!z)return null;const q=r?.width??r?.WIDTH??1536,H=r?.height??r?.HEIGHT??2048,R={scaleX:z.scaleX(),scaleY:z.scaleY(),x:z.x(),y:z.y(),width:z.width(),height:z.height()},L=g.current,G=p.current,W=L?{x:L.x(),y:L.y(),scaleX:L.scaleX(),scaleY:L.scaleY()}:null,Q=G?{x:G.x(),y:G.y(),rotation:G.rotation()}:null;try{return z.scale({x:1,y:1}),z.position({x:0,y:0}),z.size({width:q,height:H}),L&&(L.position({x:0,y:0}),L.scale({x:1,y:1})),G&&(G.position({x:0,y:0}),G.rotation(0)),z.batchDraw(),z.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:q,height:H})}finally{G&&Q&&(G.position({x:Q.x,y:Q.y}),G.rotation(Q.rotation)),L&&W&&(L.position({x:W.x,y:W.y}),L.scale({x:W.scaleX,y:W.scaleY})),z.scale({x:R.scaleX,y:R.scaleY}),z.position({x:R.x,y:R.y}),z.size({width:R.width,height:R.height}),z.batchDraw()}}}),[d]),w.useEffect(()=>{const z=c.current;if(!z)return;const q=()=>{h({width:z.clientWidth||1,height:z.clientHeight||1})};q();const H=new ResizeObserver(q);return H.observe(z),()=>H.disconnect()},[]),w.useEffect(()=>{if(!Array.isArray(e)||e.length===0){v(null);return}let z=1/0,q=1/0,H=-1/0,R=-1/0;const L=(X,se)=>{Number.isFinite(X)&&Number.isFinite(se)&&(X<z&&(z=X),se<q&&(q=se),X>H&&(H=X),se>R&&(R=se))};if(e.forEach(X=>{if(Array.isArray(X))X.forEach(se=>L(se.x,se.y));else if(X&&typeof X=="object"){if(X.type==="line")L(X.startX,X.startY),L(X.endX,X.endY);else if(X.type==="rectangle")L(X.startX,X.startY),L(X.endX,X.endY);else if(X.type==="circle"){const se=Math.hypot(X.endX-X.startX,X.endY-X.startY)/2,le=(X.startX+X.endX)/2,he=(X.startY+X.endY)/2;L(le-se,he-se),L(le+se,he+se)}}}),!Number.isFinite(z)||!Number.isFinite(q)||!Number.isFinite(H)||!Number.isFinite(R)){v(null);return}const G=16,W=Math.max(1,H-z+G*2),Q=Math.max(1,R-q+G*2);v({minX:z-G,minY:q-G,width:W,height:Q,centerX:z-G+W/2,centerY:q-G+Q/2})},[e]);const C=w.useMemo(()=>{if(!x)return{scale:1,x:0,y:0};const z=r?.width??r?.WIDTH??1536,q=r?.height??r?.HEIGHT??2048,H=Math.min(z/Math.max(1,x.width),q/Math.max(1,x.height),1),R=x.width*H,L=x.height*H,G=(z-R)/2,W=(q-L)/2,Q=G-x.minX*H,X=W-x.minY*H;return{scale:H,x:Q,y:X}},[x,r?.width,r?.height,r?.WIDTH,r?.HEIGHT]),b=w.useRef(!1);w.useEffect(()=>{if(b.current)return;const z=a?Ky.get(a):null;z&&Number.isFinite(z.scale)&&z.translate&&Number.isFinite(z.translate.x)&&Number.isFinite(z.translate.y)?(d.setScale(z.scale),d.setTranslate(z.translate)):d.fitCanvas(),b.current=!0},[a,d]),w.useEffect(()=>{try{console.log("[ViewerCanvas] rotation changed",{rotation:n,scale:d.scale,translate:d.translate})}catch{}d.fitCanvas()},[n]),w.useEffect(()=>{d.centerAtScale(d.scale)},[n]);const _=z=>{z.evt.preventDefault();const q=u.current;if(!q)return;const H=q.getPointerPosition(),R=Math.pow(1.0015,-z.evt.deltaY);d.zoomByFactor(R,H)},T=w.useRef(!1),N=w.useRef({x:0,y:0}),E=()=>{const z=c.current;if(!z)return 1;const q=z.clientWidth||1,H=z.clientHeight||1,R=r?.width??r?.WIDTH??1,L=r?.height??r?.HEIGHT??1,G=Math.abs(n%180)===90,W=G?L:R,Q=G?R:L,X=Math.min(q/W,H/Q);return Math.min(X,1)},F=z=>{const q=E();d.scale<=q||(T.current=!0,N.current={x:z.evt.clientX,y:z.evt.clientY})},j=z=>{if(!T.current)return;const q=z.evt.clientX-N.current.x,H=z.evt.clientY-N.current.y;N.current={x:z.evt.clientX,y:z.evt.clientY},d.panBy(q,H)},P=()=>{T.current=!1},M=1536,I=2048,U=(z,q)=>{if(console.log(`[ViewerCanvas] Rendering drawing element ${q}:`,z),Array.isArray(z))return console.log(`[ViewerCanvas] Array item with ${z.length} points:`,z.slice(0,3)),l.jsx(Qi,{points:z.flatMap(H=>[H.x,H.y]),stroke:z[0]?.color||"#000000",strokeWidth:z[0]?.thickness||2,tension:.5,lineCap:"round",lineJoin:"round"},q);if(z?.type==="line")return l.jsx(Qi,{points:[z.startX,z.startY,z.endX,z.endY],stroke:z.color,strokeWidth:z.thickness,lineCap:"round"},q);if(z?.type==="rectangle"){const H=Math.abs(z.endX-z.startX),R=Math.abs(z.endY-z.startY),L=Math.min(z.startX,z.endX),G=Math.min(z.startY,z.endY);return l.jsx(Ja,{x:L,y:G,width:H,height:R,stroke:z.color,strokeWidth:z.thickness,fill:"transparent"},q)}else if(z?.type==="circle"){const H=Math.sqrt(Math.pow(z.endX-z.startX,2)+Math.pow(z.endY-z.startY,2))/2,R=(z.startX+z.endX)/2,L=(z.startY+z.endY)/2;return l.jsx(Yf,{x:R,y:L,radius:H,stroke:z.color,strokeWidth:z.thickness,fill:"transparent"},q)}return null},K=w.useRef(new Map),te=w.useRef(null),re=w.useRef({x:0,y:0}),Z=w.useCallback(z=>{const q=c.current;q&&(q.setPointerCapture?.(z.pointerId),K.current.set(z.pointerId,{x:z.clientX,y:z.clientY}),N.current={x:z.clientX,y:z.clientY})},[]),B=w.useCallback(z=>{const q=K.current;if(q.has(z.pointerId)){if(q.set(z.pointerId,{x:z.clientX,y:z.clientY}),q.size===2){const H=Array.from(q.values()),R=H[1].x-H[0].x,L=H[1].y-H[0].y,G=Math.hypot(R,L),W={x:(H[0].x+H[1].x)/2,y:(H[0].y+H[1].y)/2},Q=u.current,X=Q&&Q.getPointerPosition()||W;if(te.current!=null){const se=G/Math.max(1,te.current);d.zoomByFactor(se,X)}te.current=G,re.current=X}else if(q.size===1){const H=E();if(d.scale<=H)return;const R=z.clientX-N.current.x,L=z.clientY-N.current.y;N.current={x:z.clientX,y:z.clientY},d.panBy(R,L)}}},[]),J=w.useCallback(z=>{const q=c.current;q&&(q.releasePointerCapture?.(z.pointerId),K.current.delete(z.pointerId),K.current.size<2&&(te.current=null),T.current=!1)},[]);return l.jsx("div",{ref:c,style:{width:"100%",height:"100%",display:"block",backgroundColor:"transparent",touchAction:"none",WebkitTouchCallout:"none"},className:"select-none",onPointerDown:Z,onPointerMove:B,onPointerUp:J,children:l.jsx(oh,{ref:u,width:f.width,height:f.height,onWheel:_,onMouseDown:F,onMouseMove:j,onMouseUp:P,onMouseLeave:P,children:l.jsx(ih,{children:l.jsx(vl,{ref:g,x:d.translate.x,y:d.translate.y,scaleX:d.scale,scaleY:d.scale,children:(()=>{const z=(n%360+360)%360;let q=0,H=0;z===90?q=I:z===180?(q=M,H=I):z===270&&(H=M);try{console.log("[ViewerCanvas] rotatedGroup offset",{rotation:n,norm:z,tx:q,ty:H,canvasW:M,canvasH:I})}catch{}return l.jsxs(vl,{ref:p,x:q,y:H,rotation:n,children:[l.jsx(Ja,{x:0,y:0,width:M,height:I,fill:"white"}),l.jsxs(vl,{x:C.x,y:C.y,scaleX:C.scale,scaleY:C.scale,children:[Array.isArray(e)?(console.log("[ViewerCanvas] Rendering",e.length,"drawing elements"),e.map((R,L)=>U(R,L))):null,Array.isArray(t)&&t.map((R,L)=>l.jsxs(vl,{x:R.x,y:R.y,children:[l.jsx(Ja,{width:R.width,height:R.height,fill:"#ffffff",stroke:"#d1d5db",strokeWidth:1,cornerRadius:6,shadowColor:"black",shadowBlur:2,shadowOffset:{x:1,y:1}}),l.jsx(Nc,{text:R.text,x:8,y:8,width:Math.max(0,(R.width||0)-16),height:Math.max(0,(R.height||0)-16),fontSize:R.fontSize||14,fill:R.color||"#000000",wrap:"word",align:"left",verticalAlign:"top"})]},`tb-${L}`))]})]})})()})})})})});GV.displayName="ViewerCanvas";const Jme=({zoom:e,onZoomIn:t,onZoomOut:r,onRotate:n,onDownload:s,onFullscreen:a,isFullscreen:i})=>l.jsxs("div",{className:"absolute top-4 right-4 flex flex-col space-y-2 items-center justify-center",children:[l.jsx(at,{onClick:t,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom In",children:l.jsx(Ame,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(at,{onClick:r,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Zoom Out",children:l.jsx(Pme,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(at,{onClick:n,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Rotate",children:l.jsx(Tme,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(at,{onClick:s,variant:"secondary",size:"icon",className:"w-10 h-10",title:"Download",children:l.jsx(_me,{className:"w-4 h-4 mx-auto my-auto"})}),l.jsx(at,{onClick:a,variant:"secondary",size:"icon",className:"w-10 h-10",title:i?"Exit Fullscreen":"Enter Fullscreen",children:i?l.jsx($V,{className:"w-4 h-4 mx-auto my-auto"}):l.jsx(kme,{className:"w-4 h-4 mx-auto my-auto"})})]}),Qme=({currentQuestion:e,totalQuestions:t,onPrevious:r,onNext:n,drawingDataLength:s})=>t<=1?null:l.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b border-gray-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(at,{onClick:r,disabled:e===0,variant:"outline",size:"sm",children:"Previous"}),l.jsxs("span",{className:"text-sm text-gray-600",children:["Question ",e+1," of ",t]}),l.jsx(at,{onClick:n,disabled:e===t-1,variant:"outline",size:"sm",children:"Next"})]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[s," lines"]})]})}),VV=({drawing:e,isOpen:t,onClose:r,onScoreChange:n,onMaxScoreChange:s,isTeacherView:a=!1,onSaveScore:i})=>{const{drawingState:o,setDrawingState:c,drawingData:u,setDrawingData:d,textBoxes:f,setTextBoxes:h,saveToHistoryState:g,undo:p,redo:x,canUndoState:v,canRedoState:C}=Lme(),{questionsData:b,currentQuestionIndex:_,setCurrentQuestionIndex:T}=Kme(e),{zoom:N,position:E,handleZoomIn:F,handleZoomOut:j}=qme(UV,lu),{isFullscreen:P,enterFullscreen:M,exitFullscreen:I}=Yme(o,c),{handleTouchStart:U,handleTouchMove:K,handleTouchEnd:te}=Vme(o,c,u,d,g,p,x,v,C),re=w.useRef(null),Z=w.useRef(null),[B,J]=w.useState(1),[z,q]=w.useState(""),[H,R]=w.useState("");w.useEffect(()=>{if(console.log("DrawingModal - questionsData:",b),console.log("DrawingModal - currentQuestionIndex:",_),b.length>0){const he=b[_]?.drawingData||[],we=b[_]?.textBoxes||[];console.log("DrawingModal - setting drawingData:",he),console.log("DrawingModal - setting textBoxes:",we),d(he),h(we)}},[b,_,d,h]),w.useEffect(()=>{t&&e&&(q((Number.isFinite(e.score)?e.score:0).toString()),R("10"))},[t,e]);const L=()=>{_>0&&T(_-1)},G=()=>{_<b.length-1&&T(_+1)},W=()=>{v&&p()},Q=()=>{C&&x()};w.useEffect(()=>{const he=we=>{(we.ctrlKey||we.metaKey)&&(we.key==="z"&&!we.shiftKey?(we.preventDefault(),W()):(we.key==="y"||we.key==="z"&&we.shiftKey)&&(we.preventDefault(),Q()))};return document.addEventListener("keydown",he),()=>document.removeEventListener("keydown",he)},[W,Q]);const X=()=>{c(he=>({...he,rotation:(he.rotation+90)%360}))},se=()=>{if(a&&Z.current){const Ee=Z.current.exportPNGFullCanvas();if(!Ee)return;const ye=document.createElement("a");ye.href=Ee,ye.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(ye),ye.click(),document.body.removeChild(ye);return}const he=re.current;if(!he)return;const we=he.toDataURL({mimeType:"image/png",quality:1,pixelRatio:1,x:0,y:0,width:lu.WIDTH,height:lu.HEIGHT}),ie=document.createElement("a");ie.href=we,ie.download=`drawing-${e?.name||"student"}-${new Date().toISOString().split("T")[0]}.png`,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie)},le=async()=>{if(!a)return r();const he=parseInt(z,10),we=10;Number.isFinite(he)&&(typeof i=="function"?await i({resultId:e.id,score:Math.max(0,Math.min(10,he)),maxScore:we}):(n&&n(e.id,he),s&&s(e.id,we))),r()};return!t||!e?null:l.jsx(Ai,{children:l.jsx(Ze.div,{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:r,children:l.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-xl max-w-4xl h-[90vh] w-full mx-4 flex flex-col select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.9,opacity:0},onClick:he=>he.stopPropagation(),children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Drawing Submission"}),l.jsxs("p",{className:"text-sm text-gray-600",children:[e.name," ",e.surname," - ",e.test_name]})]}),l.jsx(at,{onClick:r,variant:"ghost",size:"icon",className:"text-gray-400 hover:text-gray-600",children:l.jsx($V,{className:"w-5 h-5"})})]}),b.length>1&&l.jsx(Qme,{currentQuestion:_,totalQuestions:b.length,onPrevious:L,onNext:G,drawingDataLength:b[_]?.drawingData?.length||0}),l.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0",children:[l.jsxs("div",{className:"flex-1 min-h-0 relative overflow-hidden bg-gray-100 p-0 sm:p-4 select-none",style:{touchAction:"none",WebkitTouchCallout:"none"},children:[a?l.jsx(GV,{ref:Z,drawingData:u,textBoxes:f,canvasSize:{width:lu.WIDTH,height:lu.HEIGHT,WIDTH:lu.WIDTH,HEIGHT:lu.HEIGHT},rotation:o.rotation,onScaleChange:J}):l.jsx(HV,{ref:re,drawingData:u,textBoxes:f,drawingState:o,canvasSize:{width:lu.WIDTH,height:lu.HEIGHT,WIDTH:lu.WIDTH,HEIGHT:lu.HEIGHT},zoom:N,position:E,onTouchStart:U,onTouchMove:K,onTouchEnd:te,mousePosition:{x:0,y:0},isMouseOverCanvas:!1,isEraserDrawing:!1}),l.jsx(Jme,{zoom:a?B:N,onZoomIn:()=>{if(a&&Z.current){try{console.log("[ZoomButton] ZoomIn click (teacher)",{before:Z.current.getScale?.()})}catch{}Z.current.zoomIn(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomIn after",{after:Z.current.getScale?.()})}catch{}},0)}else F()},onZoomOut:()=>{if(a&&Z.current){try{console.log("[ZoomButton] ZoomOut click (teacher)",{before:Z.current.getScale?.()})}catch{}Z.current.zoomOut(void 0),setTimeout(()=>{try{console.log("[ZoomButton] ZoomOut after",{after:Z.current.getScale?.()})}catch{}},0)}else j()},onRotate:X,onDownload:se,onFullscreen:P?I:M,isFullscreen:P}),l.jsxs("div",{className:"absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white px-3 py-1 rounded-full text-sm",children:[Math.round((a?B:N)*100),"%"]})]}),a&&l.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Score:"}),l.jsx("input",{type:"number",min:"0",max:10,value:z,onChange:he=>q(he.target.value),className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Max:"}),l.jsx("input",{type:"number",value:10,disabled:!0,className:"w-20 px-3 py-1 text-sm border border-gray-300 rounded bg-gray-100"})]}),l.jsx(at,{onClick:le,variant:"primary",size:"sm",children:"Save"})]})})]})]})})})},qV=({testType:e,testId:t,studentAnswers:r,onBackToCabinet:n,compact:s=!1,showAll:a=!1,onToggleShowAll:i,maxInitial:o=3})=>{const c=Za(),{user:u,isAuthenticated:d}=ws(),{testResults:f,loadTestResults:h}=J2(),{theme:g,isCyberpunk:p,isLight:x,isKpop:v,themeClasses:C}=da(),b=ua(g);w.useEffect(()=>{},[g,p]);const[_,T]=w.useState(!0),[N,E]=w.useState(""),[F,j]=w.useState([]),[P,M]=w.useState([]),[I,U]=w.useState(null),[K,te]=w.useState([]),[re,Z]=w.useState(0),[B,J]=w.useState(0),[z,q]=w.useState(!1),[H,R]=w.useState(null),L=w.useCallback(Ee=>{const ye=Ee.best_retest_score||Ee.score,Ie=Ee.best_retest_max_score||Ee.max_score,ut=Math.round(ye/Ie*100);return{score:ye,maxScore:Ie,percentage:ut}},[]);w.useEffect(()=>{G()},[e,t]),w.useEffect(()=>{!e&&!t&&(f&&f.results?(_e.debug(" Using cached test results from TestContext"),M(f.results),T(!1)):Q())},[e,t,f]);const G=w.useCallback(async()=>{_e.debug(" Initializing Student Results...");try{if(T(!0),E(""),!d||!u){_e.debug(" User not authenticated"),E("User not authenticated");return}if(u.role!==Ko.STUDENT){_e.error(" Invalid user role for student results:",u.role),E("Access denied. Student role required.");return}_e.debug(" Loading test results..."),await h(u?.student_id||u?.id||""),e&&t&&r&&(_e.debug(" Loading specific test results..."),await W(e,t,r)),_e.debug(" Student Results initialization complete!")}catch(Ee){_e.error(" Error initializing student results:",Ee),E("Failed to initialize student results")}finally{T(!1)}},[d,u,e,t,r,h]),W=w.useCallback(async(Ee,ye,Ie)=>{_e.debug(" Loading specific test results:",Ee,ye);try{const ut=await Pn.getTestInfo(Ee,ye);_e.debug(" Test info loaded:",ut),U(ut);const Qe=await Pn.getTestQuestions(Ee,ye);_e.debug(" Test questions loaded:",Qe),te(Qe);const $t=Zf(Qe,Ie,Ee).score,Ge=Qe.length>0?Math.round($t/Qe.length*100):0;Z($t),J(Ge),_e.debug(" Test results calculated:",{score:$t,percentage:Ge})}catch(ut){throw _e.error(" Error loading specific test results:",ut),ut}},[]),Q=w.useCallback(async(Ee=0)=>{_e.debug(" Loading all student results using existing test results API...",Ee>0?`(retry ${Ee})`:"");try{if(!(u?.student_id||u?.sub))throw new Error("Student ID not found");const Ie=await Pn.getStudentTestResults();if(Ie.success){_e.debug(" All student results loaded:",Ie.results.length,"results");const ut=Ie.results.map(Qe=>({...Qe,caught_cheating:Qe.caught_cheating||!1,visibility_change_times:Qe.visibility_change_times||0}));M(ut),R(new Date),Ie.results.length===0&&Ee===0&&(_e.debug(" No results found, retrying in 2 seconds..."),setTimeout(()=>{Q(1)},2e3))}else throw new Error(Ie.error||"Failed to load student results")}catch(ye){_e.error(" Error loading all student results:",ye),E(ye.message)}},[u]),X=w.useCallback(Ee=>({"Listening and Speaking":"L&S","Reading and Writing":"R&W","English for Career":"Eng for Career","Science Fundamental":"Science F","Science Supplementary":"Science S","Math Fundamental":"Math F","Math Supplementary":"Math S","English for Communication":"Eng for Comm"})[Ee]||Ee,[]),se=w.useCallback(Ee=>{if(!Ee||Ee.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:p?"":"text-gray-500",style:p?{...b.textCyan,fontFamily:"monospace"}:{},children:p?"NO RESULTS AVAILABLE":"No results available"})});const ye=a?Ee:Ee.slice(0,o);return l.jsxs("div",{className:"overflow-x-auto",children:[l.jsxs("table",{className:`w-full divide-y border-2 ${p?"divide-cyan-400 border-cyan-400":v?"divide-pink-500 border-pink-500":"divide-gray-200"}`,style:p?{backgroundColor:fe.black,borderColor:fe.cyan}:v?{backgroundColor:He.background,borderColor:He.primary,...b.glow}:{},children:[l.jsx("thead",{className:p||v?"":"bg-gray-50",style:p?{backgroundColor:fe.black,borderBottom:`2px solid ${fe.cyan}`}:v?{backgroundColor:He.backgroundSecondary,borderBottom:`2px solid ${He.primary}`,...b.glow}:{},children:l.jsxs("tr",{children:[l.jsx("th",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"SUBJECT":"Subject"}),l.jsx("th",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"TEACHER":"Teacher"}),l.jsx("th",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"TEST NAME":"Test Name"}),l.jsx("th",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"RESULT":"Result"}),l.jsx("th",{className:`hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-3 text-left text-xs font-medium uppercase tracking-wider ${p?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:{},children:p?"DATE":"Date"})]})}),l.jsx("tbody",{className:`divide-y ${p?"divide-cyan-400":v?"divide-pink-500":"bg-white divide-gray-200"}`,style:p?{backgroundColor:fe.black}:v?{backgroundColor:He.background}:{},children:ye.map((Ie,ut)=>l.jsxs("tr",{className:p?"border-b border-cyan-400":v?"border-b border-pink-500/50 hover:bg-pink-500/10":"hover:bg-gray-50",style:p?{backgroundColor:fe.black,borderBottomColor:fe.cyan}:{},children:[l.jsx("td",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs font-medium ${p||v?"":"text-gray-900"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textWhite}:{},children:l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs border ${p?"border":v?"bg-pink-500/20 text-pink-400 border-pink-500":"bg-blue-100 text-blue-800"}`,style:p?{backgroundColor:fe.black,borderColor:fe.yellow,color:fe.yellow,fontFamily:"monospace",...b.textShadowYellow}:v?{backgroundColor:He.backgroundSecondary,borderColor:He.primary,color:He.primary,...b.glow}:{},children:X(Ie.subject)})}),l.jsx("td",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs truncate max-w-12 sm:max-w-none ${p||v?"":"text-gray-500"}`,style:p?{color:fe.cyan,fontFamily:"monospace"}:v?{...b.textAccent}:{},children:Ie.teacher_name}),l.jsx("td",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs truncate max-w-16 sm:max-w-none ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textWhite}:{},children:p?Ie.test_name.toUpperCase():Ie.test_name}),l.jsx("td",{className:`px-1 sm:px-4 lg:px-6 py-1 sm:py-4 whitespace-nowrap text-xs text-left ${p||v?"":"text-gray-500"}`,style:p?{color:fe.cyan,fontFamily:"monospace"}:v?{...b.textAccent}:{},children:l.jsx("div",{className:"flex flex-col items-start space-y-1",children:Ie.test_type==="drawing"?Ie.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold border ${p?"border":""}`,style:(()=>{const{score:Qe,maxScore:$t,percentage:Ge}=L(Ie);if(p){const et=Ge>=80?fe.green:Ge>=60?fe.yellow:fe.red;return{backgroundColor:fe.black,borderColor:et,color:et,fontFamily:"monospace",...Ge>=80?b.textShadowGreen:Ge>=60?b.textShadowYellow:b.textShadowRed}}if(v){const et=Ge>=80?He.success:Ge>=60?He.primary:He.error;return{backgroundColor:He.backgroundSecondary,borderColor:et,color:et,...b.glow,textShadow:`0 0 10px ${et}, 0 0 20px ${et}`}}return Ge>=80?{}:Ge>=60?{}:{}})(),children:(()=>{const{score:Qe,maxScore:$t,percentage:Ge}=L(Ie);return`${Qe}/${$t} (${Ge}%)`})()}):l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold border ${p?"border":v?"bg-pink-500/20 text-pink-400 border-pink-500":"bg-gray-100 text-gray-800"}`,style:p?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...b.textShadow}:v?{backgroundColor:He.backgroundSecondary,borderColor:He.primary,color:He.primary,...b.glow}:{},children:p?"PENDING REVIEW":"Pending Review"}):Ie.test_type==="speaking"?Ie.score!==null?l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold border ${p?"border":""}`,style:(()=>{const{score:Qe,maxScore:$t,percentage:Ge}=L(Ie);if(p){const et=Ge>=80?fe.cyan:fe.red;return{backgroundColor:fe.black,borderColor:et,color:et,fontFamily:"monospace",...Ge>=80?b.textShadow:b.textShadowRed}}return{}})(),children:(()=>{const{score:Qe,maxScore:$t,percentage:Ge}=L(Ie);return`${Qe}/${$t} (${Ge}%)`})()}):l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold border ${p?"border":v?"bg-pink-500/20 text-pink-400 border-pink-500":"bg-gray-100 text-gray-800"}`,style:p?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...b.textShadow}:v?{backgroundColor:He.backgroundSecondary,borderColor:He.primary,color:He.primary,...b.glow}:{},children:p?"PENDING REVIEW":"Pending Review"}):l.jsx("span",{className:`px-0.5 sm:px-2 py-0.5 rounded text-xs font-semibold border ${p?"border":""}`,style:(()=>{const{score:Qe,maxScore:$t,percentage:Ge}=L(Ie);if(p){const et=Ge>=80?fe.cyan:fe.red;return{backgroundColor:fe.black,borderColor:et,color:et,fontFamily:"monospace",...Ge>=80?b.textShadow:b.textShadowRed}}return Ge>=80?{}:Ge>=60?{}:{}})(),children:(()=>{const{score:Qe,maxScore:$t,percentage:Ge}=L(Ie);return`${Qe}/${$t} (${Ge}%)`})()})})}),l.jsx("td",{className:`hidden sm:table-cell px-2 sm:px-4 lg:px-6 py-2 sm:py-4 whitespace-nowrap text-xs sm:text-sm ${p||v?"":"text-gray-500"}`,style:p?{color:fe.cyan,fontFamily:"monospace"}:v?{...b.textAccent}:{},children:new Date(Ie.submitted_at).toLocaleDateString()})]},ut))})]}),Ee.length>o&&i&&l.jsx("div",{className:"text-center pt-4",children:l.jsx("button",{onClick:i,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:a?"Show Less":`Show ${Ee.length-o} More`})})]})},[X,a,o,i,p,b,g]),le=w.useCallback((Ee,ye)=>{if(_e.debug(" formatAnswer called with:",{answer:Ee,testType:ye,answerType:typeof Ee}),!Ee)return"No answer";switch(ye){case"true_false":const Ie=typeof Ee=="boolean"?Ee:Ee==="true";return _e.debug(" Boolean answer processed:",Ie),Ie?"True":"False";case"multiple_choice":return Ee.toUpperCase();case"input":return Ee;case"word_matching":return typeof Ee=="object"?Object.entries(Ee).map(([ut,Qe])=>`${ut}  ${Qe}`).join(", "):Ee;case"drawing":return"Drawing submitted";default:return Ee}},[]),he=w.useCallback(()=>!I||!K||!r?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:`rounded-lg shadow p-6 border ${p?Vt(0).className:"bg-white"}`,style:p?{...Vt(0).style,...b.glowRed}:v?{backgroundColor:He.background,borderColor:He.primary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:[l.jsx("h2",{className:`text-2xl font-bold mb-4 ${p||v?"":"text-gray-900"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.headerText}:{},children:p?`TEST RESULTS: ${(I.test_name||I.title||"TEST").toUpperCase()}`:`Test Results: ${I.test_name||I.title||"Test"}`}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`text-3xl font-bold ${p?"text-cyan-400":"text-blue-600"}`,style:p?b.textShadow:{},children:re}),l.jsx("p",{className:`text-sm ${p?C.textSecondary:"text-gray-500"}`,children:"Correct Answers"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`text-3xl font-bold ${p?C.text:"text-gray-900"}`,style:p?b.textShadow:{},children:K.length}),l.jsx("p",{className:`text-sm ${p?C.textSecondary:"text-gray-500"}`,children:"Total Questions"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-3xl font-bold ${p?B>=80?"text-green-400":B>=60?"text-yellow-400":"text-red-400":B>=80?"text-green-600":B>=60?"text-yellow-600":"text-red-600"}`,style:p?b.textShadow:{},children:[B,"%"]}),l.jsx("p",{className:`text-sm ${p?C.textSecondary:"text-gray-500"}`,children:"Score"})]})]})]}),l.jsxs("div",{className:`rounded-lg shadow p-6 border ${p?Vt(1).className:"bg-white"}`,style:p?{...Vt(1).style,...b.glowYellow}:{},children:[l.jsx("h3",{className:`text-lg font-semibold mb-4 ${p?"":"text-gray-900"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:{},children:p?"QUESTIONS REVIEW":"Questions Review"}),l.jsx("div",{className:"space-y-4",children:K.map((Ee,ye)=>{const Ie=r[ye],ut=r2(Ee,e),Qe=g1(Ee,Ie,e);return l.jsxs("div",{className:`border rounded-lg p-4 ${p?"border":Qe?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,style:p?{backgroundColor:fe.black,borderColor:Qe?fe.green:fe.red,boxShadow:Qe?b.glowGreen.boxShadow:b.glowRed.boxShadow}:{},children:[l.jsxs("div",{className:"flex justify-between items-start mb-2",children:[l.jsx("h4",{className:`font-medium ${p?"":"text-gray-900"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:{},children:p?`QUESTION ${ye+1}`:`Question ${ye+1}`}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium border ${p?"border":""}`,style:p?{backgroundColor:fe.black,borderColor:Qe?fe.green:fe.red,color:Qe?fe.green:fe.red,fontFamily:"monospace",...Qe?b.textShadowGreen:b.textShadowRed}:{},children:p?Qe?"CORRECT":"INCORRECT":Qe?"Correct":"Incorrect"})]}),l.jsx("p",{className:`mb-3 ${p?C.text:"text-gray-700"}`,children:Ee.question}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:`text-sm font-medium ${p?C.textSecondary:"text-gray-500"}`,children:p?"YOUR ANSWER:":"Your Answer:"}),l.jsx("p",{className:`text-sm ${p?C.text:"text-gray-900"}`,children:le(Ie,e)})]}),l.jsxs("div",{children:[l.jsx("span",{className:`text-sm font-medium ${p?C.textSecondary:"text-gray-500"}`,children:p?"CORRECT ANSWER:":"Correct Answer:"}),l.jsx("p",{className:`text-sm ${p?C.text:"text-gray-900"}`,children:le(ut,e)})]})]})]},ye)})})]})]}),[I,K,r,e,re,B,r2,g1,le]),we=w.useCallback(()=>{if(!P||P.length===0)return l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:p?C.textSecondary:"text-gray-500",children:p?"NO TEST RESULTS AVAILABLE YET.":"No test results available yet."})});const Ee={};return P.forEach(ye=>{const Ie=ye.subject||"Unknown Subject";Ee[Ie]||(Ee[Ie]=[]),Ee[Ie].push(ye)}),l.jsx("div",{className:"space-y-6",children:Object.entries(Ee).map(([ye,Ie],ut)=>l.jsxs("div",{className:`rounded-lg shadow border ${p?Vt(ut).className:v?hr(ut).className:"bg-white"}`,style:p?{...Vt(ut).style,boxShadow:ut%4===0?b.glowRed.boxShadow:ut%4===1?b.glowYellow.boxShadow:ut%4===2?b.glowPurple.boxShadow:b.glow.boxShadow}:v?{...hr(ut).style,...ut%2===0?b.glow:b.glowPurple}:{},children:[l.jsx("div",{className:`px-6 py-4 border-b ${p?"border":v?"border-violet-300":"border-gray-200"}`,style:p?{borderBottomColor:fe.cyan}:v?{borderBottomColor:He.border}:{},children:l.jsx("h3",{className:`text-lg font-semibold ${p?C.text:v?"":"text-gray-900"}`,style:p?b.textShadow:v?{...b.headerText}:{},children:p?ye.toUpperCase():ye})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:`min-w-full divide-y border-2 ${p?"divide-cyan-400 border-cyan-400":v?"divide-pink-500 border-pink-500":"divide-gray-200"}`,style:p?{backgroundColor:fe.black,borderColor:fe.cyan}:v?{backgroundColor:He.background,borderColor:He.primary,...b.glow}:{},children:[l.jsx("thead",{className:p||v?"":"bg-gray-50",style:p?{backgroundColor:fe.black,borderBottom:`2px solid ${fe.cyan}`}:v?{backgroundColor:He.backgroundSecondary,borderBottom:`2px solid ${He.primary}`,...b.glow}:{},children:l.jsxs("tr",{children:[l.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"TEST NAME":"Test Name"}),l.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"TEACHER":"Teacher"}),l.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"SCORE":"Score"}),l.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium uppercase tracking-wider ${p||v?"":"text-gray-500"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textPink}:{},children:p?"DATE":"Date"})]})}),l.jsx("tbody",{className:`divide-y ${p?"divide-cyan-400":v?"divide-pink-500":"bg-white divide-gray-200"}`,style:p?{backgroundColor:fe.black}:v?{backgroundColor:He.background}:{},children:Ie.map((Qe,$t)=>{const{score:Ge,maxScore:et,percentage:vt}=L(Qe),Te=p?vt>=80?"text-green-400":vt>=60?"text-yellow-400":"text-red-400":vt>=80?"text-green-600":vt>=60?"text-yellow-600":"text-red-600";return l.jsxs("tr",{className:p?"border-b border-cyan-400":"hover:bg-gray-50",style:p?{backgroundColor:fe.black,borderBottomColor:fe.cyan}:{},children:[l.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm font-medium ${p||v?"":"text-gray-900"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.textWhite}:{},children:p?Qe.test_name.toUpperCase():Qe.test_name}),l.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${p||v?"":"text-gray-500"}`,style:p?{color:fe.cyan,fontFamily:"monospace"}:v?{...b.textAccent}:{},children:Qe.teacher_name||(p?"UNKNOWN":"Unknown")}),l.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:l.jsxs("span",{className:p||v?"":Te,style:p?{color:vt>=80?fe.green:vt>=60?fe.yellow:fe.red,fontFamily:"monospace",...vt>=80?b.textShadowGreen:vt>=60?b.textShadowYellow:b.textShadowRed}:v?{color:vt>=80?He.success:vt>=60?He.primary:He.error,textShadow:vt>=80?`0 0 10px ${He.success}, 0 0 20px ${He.success}`:vt>=60?`0 0 10px ${He.primary}, 0 0 20px ${He.primary}`:`0 0 10px ${He.error}, 0 0 20px ${He.error}`}:{},children:[Ge,"/",et," (",vt,"%)"]})}),l.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${p||v?"":"text-gray-500"}`,style:p?{color:fe.cyan,fontFamily:"monospace"}:v?{...b.textAccent}:{},children:new Date(Qe.submitted_at).toLocaleDateString()})]},$t)})})]})})]},ye))})},[P]);w.useCallback(()=>{_e.debug(" Clearing test data and returning to cabinet..."),U(null),te([]),setStudentAnswers(null),Z(0),J(0),q(!1),n?n():c("/student")},[n,c]);const ie=w.useCallback(()=>{_e.debug(" Navigating back to cabinet..."),n?n():c("/student")},[n,c]);return w.useCallback((Ee,ye)=>{const Ie={id:Date.now(),message:Ee,type:ye,timestamp:new Date};j(ut=>[...ut,Ie]),setTimeout(()=>{j(ut=>ut.filter(Qe=>Qe.id!==Ie.id))},pg.NOTIFICATION_DURATION)},[]),_?l.jsx("div",{className:`min-h-screen flex items-center justify-center ${p?"":"bg-white"}`,style:p?b.background:{},children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:`mt-4 ${p?"":"text-gray-600"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:{},children:p?"LOADING STUDENT RESULTS...":"Loading Student Results..."})]})}):N?l.jsx("div",{className:`min-h-screen flex items-center justify-center ${p?"":"bg-white"}`,style:p?b.background:{},children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:`border-2 rounded-lg p-6 max-w-md ${p?"border":"bg-red-50 border-red-200"}`,style:p?{backgroundColor:fe.black,borderColor:fe.red,...b.glowRed}:{},children:[l.jsx("h2",{className:`text-lg font-semibold mb-2 ${p?"":"text-red-800"}`,style:p?{...b.textRed,fontFamily:"monospace"}:{},children:p?"RESULTS ERROR":"Results Error"}),l.jsx("p",{className:`mb-4 ${p?"":"text-red-600"}`,style:p?{color:fe.red,fontFamily:"monospace"}:{},children:N}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs("div",{children:[_?l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Xr,{size:"md"}),l.jsx("p",{className:`mt-2 ${p?"":"text-gray-600"}`,style:p?{...b.textCyan,fontFamily:"monospace"}:{},children:p?"LOADING RESULTS...":"Loading results..."})]}):N?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:`text-4xl mb-2 ${p?"":"text-red-500"}`,style:p?{color:fe.red}:{},children:""}),l.jsx("p",{className:p?"":"text-red-600",style:p?{color:fe.red,fontFamily:"monospace"}:{},children:N})]}):se(P),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:F.map(Ee=>l.jsx(bu,{type:Ee.type,message:Ee.message,onClose:()=>j(ye=>ye.filter(Ie=>Ie.id!==Ee.id))},Ee.id))})]}):l.jsxs("div",{className:`min-h-screen ${p?"bg-gradient-to-br from-black via-gray-900 to-purple-900":"bg-white"}`,style:p?b.background:{},children:[l.jsx("div",{className:`shadow-sm border-b ${p?"border":v?"":`${C.headerBg} ${C.headerBorder}`}`,style:p?{backgroundColor:fe.black,borderBottomColor:fe.cyan,borderBottomWidth:"2px"}:v?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:`text-2xl font-bold ${p||v?"":C.headerText}`,style:p?{...b.textCyan,fontFamily:"monospace"}:v?{...b.headerText}:{},children:p?"STUDENT RESULTS":"Student Results"}),l.jsxs("p",{className:`text-sm mt-1 ${p?"":C.textSecondary}`,style:p?{color:fe.cyan,fontFamily:"monospace"}:{},children:["Last updated: ",H?H.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[I&&l.jsx(at,{variant:"outline",onClick:()=>q(!z),children:z?"Hide Details":"Show Details"}),l.jsx(at,{variant:"outline",onClick:ie,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:z&&I?he():we()}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:F.map(Ee=>l.jsx(bu,{type:Ee.type,message:Ee.message,onClose:()=>j(ye=>ye.filter(Ie=>Ie.id!==Ee.id))},Ee.id))}),selectedDrawing&&l.jsx(VV,{drawing:selectedDrawing,isOpen:isDrawingModalOpen,onClose:()=>setIsDrawingModalOpen(!1)})]})},Zme=({isMenuOpen:e,onToggleMenu:t,onShowPasswordChange:r})=>{const n=Za(),s=ku(),{user:a,isAuthenticated:i,logout:o}=ws(),{studentData:c,loadStudentData:u}=XS(),{activeTests:d,testResults:f,loadActiveTests:h,loadTestResults:g,viewTestDetails:p,testDetailsModal:x,closeTestDetailsModal:v}=J2(),{theme:C,isCyberpunk:b,isLight:_,isKpop:T,themeClasses:N}=da(),E=ua(C);w.useEffect(()=>{_e.debug(" [DEBUG] StudentCabinet mounted/rendered, location:",s.pathname)},[s.pathname]);const[F,j]=w.useState(!0),[P,M]=w.useState(""),[I,U]=w.useState([]),[K,te]=w.useState(null),[re,Z]=w.useState(!1),[B,J]=w.useState(null),[z,q]=w.useState(null),[H,R]=w.useState(new Set),[L,G]=w.useState(!1),[W,Q]=w.useState(!1),[X,se]=w.useState(!1),[le,he]=w.useState(!1),[we,ie]=w.useState(!1);w.useEffect(()=>{Ee()},[]),w.useEffect(()=>()=>{se(!1)},[]),w.useEffect(()=>{if(X){const Te=setTimeout(()=>{se(!1)},1e3);return()=>clearTimeout(Te)}},[X]);const Ee=w.useCallback(async()=>{_e.debug(" Initializing Student Cabinet...");try{if(j(!0),M(""),!i||!a){_e.debug(" User not authenticated, redirecting to login"),n("/login");return}if(a.role!==Ko.STUDENT){_e.error(" Invalid user role for student cabinet:",a.role),M("Access denied. Student role required.");return}_e.debug(" Loading active tests (single API call)...");const Te=a?.student_id||a?.id||"";if(ye(Te)){_e.debug(" Cache refresh triggered - clearing cache");try{const pt=`student_active_tests_${Te}`,wt=`student_results_table_${Te}`;localStorage.removeItem(pt),localStorage.removeItem(wt)}catch{}}else _e.debug(" Using cached active tests (background revalidation will keep data fresh)");await h(Te),_e.debug(" Student Cabinet initialization complete!")}catch(Te){_e.error(" Error initializing student cabinet:",Te),M("Failed to initialize student cabinet")}finally{j(!1)}},[i,a,n]),ye=w.useCallback(Te=>{if(window.studentCabinetRefreshRequested)return window.studentCabinetRefreshRequested=!1,_e.debug(" Manual refresh requested"),!0;if(window.recentTestCompleted)return window.recentTestCompleted=!1,_e.debug(" Test completed - cache refresh triggered"),!0;const Ve=localStorage.getItem(`last_cabinet_refresh_${Te}`);if(Ve&&Date.now()-parseInt(Ve)>300*1e3)return _e.debug(" Time-based refresh triggered"),!0;try{for(let pt=0;pt<localStorage.length;pt++){const wt=localStorage.key(pt);if(wt&&wt.startsWith(`retest_assignment_id_${Te}_`))return _e.debug(" Retest assignment key detected, forcing cache refresh:",wt),!0}}catch{}return _e.debug(" No refresh triggers - using existing cache"),!1},[]);w.useCallback(async()=>{_e.debug(" Calculating average score...");try{if(f&&f.length>0){const Te=f.reduce((pt,wt)=>{const Ut=wt.best_retest_score||wt.score,ct=wt.best_retest_max_score||wt.max_score;return typeof Ut=="number"&&typeof ct=="number"&&ct>0?pt+Math.round(Ut/ct*100):pt},0),Ve=Math.round(Te/f.length);q(Ve),_e.debug(" Average score calculated:",Ve)}}catch(Te){_e.error(" Error calculating average score:",Te)}},[f]),w.useEffect(()=>{if(X){_e.debug(" Skipping completed tests initialization during navigation");return}const Te=a?.student_id||a?.id;if(!Te){_e.debug(" Student ID not available yet, skipping localStorage initialization");return}const Ve=new Set;for(let pt=0;pt<localStorage.length;pt++){const wt=localStorage.key(pt);if(wt&&wt.startsWith(`test_completed_${Te}_`)&&localStorage.getItem(wt)==="true"){const ct=wt.replace(`test_completed_${Te}_`,"").split("_");if(ct.length>=2){const yt=ct[0],rt=ct.slice(1).join("_"),Oe=`${yt}_${rt}`;Ve.add(Oe),_e.debug(" Found completed test in localStorage:",Oe)}}}R(Ve),he(!0),_e.debug(" Initialized completed tests from localStorage:",Array.from(Ve))},[a?.student_id,a?.id,X]),w.useEffect(()=>{_e.debug(" testResults structure:",f);const Te=f?.results||f;if(_e.debug(" resultsArray:",Te),Te&&Te.length>0){const Ve=a?.student_id||a?.id||"",pt=new Set;Te.forEach(wt=>{const Ut=`${wt.test_type}_${wt.test_id}`;pt.add(Ut),localStorage.setItem(`test_completed_${Ve}_${wt.test_type}_${wt.test_id}`,"true")}),R(wt=>{const Ut=new Set([...wt,...pt]);return _e.debug(" Updated completed tests (merged):",Array.from(Ut)),Ut})}},[f,a?.student_id,a?.id]);const Ie=w.useCallback(async(Te,Ve,pt=!1,wt=null)=>{_e.debug(" Checking test completion:",Te,Ve,"retestAvailable:",pt);try{const Ut=a?.student_id||a?.id||"";if(pt){_e.debug(" Retest available from backend, checking attempt limits.");const Oe=`retest_attempts_${Ut}_${Te}_${Ve}`;let $e;try{const mr=localStorage.getItem(Oe);$e=mr?JSON.parse(mr):void 0}catch(mr){_e.warn(" Failed to parse attempts metadata:",mr)}const Mt=[];for(let mr=1;mr<=10;mr++){const ve=`retest_attempt${mr}_${Ut}_${Te}_${Ve}`;localStorage.getItem(ve)==="true"&&Mt.push(ve)}const It=Mt.length,At=typeof wt?.retest_attempts_left=="number"?wt.retest_attempts_left:void 0,tr=typeof wt?.retest_attempt_number=="number"?wt.retest_attempt_number:void 0,ar=typeof wt?.retest_max_attempts=="number"?wt.retest_max_attempts:void 0;if(At===0)return _e.debug(" API reports no attempts left. Retest considered completed."),!0;const dr=ar??(At!=null&&tr!=null?At+tr:$e?.max??3),or=$e?.used??It;return _e.debug(" Retest check:",{attemptsMeta:$e,attemptKeys:Mt,usedAttempts:or,totalAttempts:dr,attemptsLeftFromApi:At,retriesRemaining:At??dr-or}),or>=dr?(_e.debug(" Maximum retest attempts reached (meta/localStorage)."),!0):(_e.debug(" Retest attempts available, allowing start."),!1)}const ct=`test_completed_${Ut}_${Te}_${Ve}`,yt=localStorage.getItem(ct);if(_e.debug(" localStorage key:",ct),_e.debug(" localStorage value:",yt),Te==="word_matching"){_e.debug(" Debug: All localStorage keys for student",Ut);for(let Oe=0;Oe<localStorage.length;Oe++){const $e=localStorage.key(Oe);$e&&$e.includes(Ut)&&$e.includes("word_matching")&&_e.debug(" Found word_matching key:",$e,"=",localStorage.getItem($e))}}if(yt==="true")return _e.debug(" Found completion status in local storage:",yt),!0;const rt=f?.results||f;return rt&&rt.length>0&&(_e.debug(" Checking database results:",rt.length,"results"),rt.some($e=>(_e.debug(" Checking result:",$e.test_type,$e.test_id,"vs",Te,Ve),$e.test_type===Te&&$e.test_id===Ve)))?(_e.debug(" Found completion status in database results"),localStorage.setItem(ct,"true"),!0):(_e.debug(" Test not completed according to local storage or database"),!1)}catch(Ut){return _e.error(" Error checking test completion:",Ut),!1}},[f,a?.student_id,a?.id]),ut=w.useCallback((Te,Ve)=>{const pt={id:Date.now(),message:Te,type:Ve,timestamp:new Date};U(wt=>[...wt,pt]),setTimeout(()=>{U(wt=>wt.filter(Ut=>Ut.id!==pt.id))},pg.NOTIFICATION_DURATION)},[]),Qe=w.useCallback(async Te=>{_e.debug(" Showing test details:",Te);try{await p(Te.test_type,Te.test_id,Te.test_name)}catch(Ve){_e.error("Error loading test details:",Ve),ut("Failed to load test details","error")}},[p,ut]),$t=w.useCallback(Te=>{_e.debug(" Starting test:",Te);const Ve=`${Te.test_type}_${Te.test_id}`;if(H.has(Ve)&&!Te?.retest_available){ut("This test has already been completed","warning");return}if(_e.debug(" Checking retest conditions:"),_e.debug(" test.retest_available:",Te?.retest_available),_e.debug(" testKey:",Ve),_e.debug(" completedTests.has(testKey):",H.has(Ve)),_e.debug(" completedTests:",Array.from(H)),Te?.retest_available&&!Te?.retest_is_completed){const pt=a?.student_id||a?.id||"",wt=`retest1_${pt}_${Te.test_type}_${Te.test_id}`;localStorage.setItem(wt,"true"),_e.debug(" Set retest key:",wt);const Ut=`retest_in_progress_${pt}_${Te.test_type}_${Te.test_id}`;localStorage.setItem(Ut,"1"),_e.debug(" Set in-progress retest lock:",Ut);try{const ct=`anti_cheating_${pt}_${Te.test_type}_${Te.test_id}`;localStorage.removeItem(ct);const yt=`speaking_test_data_${pt}_${Te.test_id}`;localStorage.removeItem(yt);const rt=`speaking_progress_${Te.test_id}`;localStorage.removeItem(rt);const Oe=`_${pt}_${Te.test_type}_${Te.test_id}`,$e=[];for(let It=0;It<localStorage.length;It++){const At=localStorage.key(It);At&&(At.startsWith("retest_attempt")||(At.endsWith(Oe)||At.includes(`answers_${pt}_${Te.test_type}_${Te.test_id}`)||At.includes(`progress_${pt}_${Te.test_type}_${Te.test_id}`)||At.includes(`state_${pt}_${Te.test_type}_${Te.test_id}`)||At.includes(`selected_${pt}_${Te.test_type}_${Te.test_id}`))&&$e.push(At))}$e.forEach(It=>localStorage.removeItem(It)),_e.debug(" Cleared generic cached keys for retest start:",$e);const Mt=`retest_attempts_${pt}_${Te.test_type}_${Te.test_id}`;_e.debug(" Cleared per-test cached keys for retest start:",{antiCheatKey:ct,speakingCacheKey:yt,speakingProgressKey:rt})}catch{}if(_e.debug(" Test retest_assignment_id:",Te.retest_assignment_id),_e.debug(" Test retest_assignment_id type:",typeof Te.retest_assignment_id),Te?.retest_assignment_id){const ct=`retest_assignment_id_${pt}_${Te.test_type}_${Te.test_id}`;localStorage.setItem(ct,String(Te.retest_assignment_id)),_e.debug(" Set retest assignment ID:",ct,"=",Te.retest_assignment_id)}else _e.debug(" No retest assignment ID found in test data")}else _e.debug(" Retest assignment ID storage skipped - retest not available");if(se(!0),_e.debug(" Set isStartingTest to true for test:",Te.test_type),Te.test_type==="matching_type"){_e.debug(" Redirecting to matching test page for testId:",Te.test_id),n(`/student/matching-test/${Te.test_id}`);return}if(Te.test_type==="word_matching"){_e.debug(" Redirecting to word matching test page for testId:",Te.test_id),n(`/student/word-matching-test/${Te.test_id}`);return}if(Te.test_type==="speaking"){_e.debug(" Redirecting to speaking test page for testId:",Te.test_id),n(`/student/speaking-test/${Te.test_id}`);return}n(`/student/test/${Te.test_type}/${Te.test_id}`)},[n,H,ut,a?.student_id,a?.id]),Ge=w.useCallback(()=>{G(Te=>!Te)},[]),et=w.useCallback(()=>{Q(Te=>!Te)},[]),vt=w.useCallback(async Te=>{if(_e.debug(" Starting test:",Te),X){_e.debug(" Test already starting, ignoring click");return}try{if(await Ie(Te.test_type,Te.test_id,Te?.retest_available,Te)){ut("This test has already been completed","warning");return}$t(Te)}catch(Ve){_e.error(" Error starting test:",Ve),ut("Failed to start test. Please try again.","error")}},[Ie,$t,ut,X]);return w.useCallback(Te=>{_e.debug(" Viewing test details:",Te),Qe(Te)},[Qe]),F?l.jsx(Ze.div,{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsxs(Ze.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx(Xr,{size:"lg"}),l.jsx(Ze.p,{className:"mt-4 text-gray-600",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.3},children:"Loading Student Cabinet..."})]})}):P?l.jsx(Ze.div,{className:"min-h-screen bg-gradient-to-br from-red-50 to-pink-100 flex items-center justify-center",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:l.jsx(Ze.div,{className:"text-center",initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2,duration:.5},children:l.jsxs(Ze.div,{className:"bg-white border border-red-200 rounded-xl p-8 max-w-md shadow-lg",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3,duration:.3},children:[l.jsx(Ze.div,{className:"text-4xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.4,duration:.3,type:"spring"},children:""}),l.jsx("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-6",children:P}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):(_e.debug(" [DEBUG] StudentCabinet rendering, location:",s.pathname,"isLoading:",F),l.jsxs(Ze.div,{className:`min-h-screen ${b?"bg-gradient-to-br from-black via-gray-900 to-purple-900":T?"bg-black":"bg-white"}`,style:b?E.background:T?E.backgroundSecondary:{},initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Ze.div,{className:`${T?"":N.headerBg} border-b-2 ${T?"":N.headerBorder}`,style:b?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:T?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(Ze.div,{className:"flex items-center space-x-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Ze.div,{className:`h-12 w-12 rounded-full flex items-center justify-center border-2 ${b?"bg-cyan-400/20 border-cyan-400":T?"bg-pink-500/20 border-pink-500":"bg-white/20 border-white"}`,style:b?{boxShadow:"0 0 10px rgba(0, 255, 255, 0.5)"}:T?{boxShadow:"0 2px 4px rgba(139, 92, 246, 0.2)"}:{},initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:`font-semibold text-xl ${b?"text-cyan-400 tracking-wider":T?"":"text-white"}`,style:b?{fontFamily:"monospace",textShadow:"0 0 5px rgba(0, 255, 255, 0.5)"}:{},children:a?.name?.charAt(0)||"S"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:`text-lg sm:text-xl md:text-2xl font-bold ${b?"tracking-wider":N.headerText}`,style:b?{...E.textCyan,fontFamily:"monospace"}:T?{...E.headerText}:{},children:b?`${a?.name?.toUpperCase()} ${a?.surname?.toUpperCase()}`:`${a?.name} ${a?.surname}`}),l.jsx("p",{className:`text-sm sm:text-base md:text-lg ${b?"tracking-wider":"text-white"}`,style:b?{...E.textYellow,fontFamily:"monospace"}:{},children:b?`GRADE ${a?.grade} - CLASS ${a?.class}`:`Grade ${a?.grade} - Class ${a?.class}`})]})]}),l.jsxs(Ze.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:t,className:`flex items-center space-x-1 sm:space-x-2 border-2 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm ${b?"bg-cyan-400/10 border-cyan-400 text-cyan-400 hover:bg-cyan-400/20 focus:ring-cyan-400 tracking-wider":T?"bg-pink-500/10 border-pink-400 text-pink-400 hover:bg-pink-500/20 focus:ring-pink-400":"bg-white/10 border-white text-white hover:bg-white/20 focus:ring-white"}`,style:b?{zIndex:1e3,fontFamily:"monospace",boxShadow:"0 0 10px rgba(0, 255, 255, 0.3)",textShadow:"0 0 5px rgba(0, 255, 255, 0.5)"}:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(Ze.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:e?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(Ai,{children:e&&l.jsx(Ze.div,{className:`absolute right-0 mt-2 w-48 rounded-xl shadow-lg z-50 overflow-hidden border-2 ${b?Vt(0).className:T?hr(0).className:"bg-white"}`,style:b?{...Vt(0).style,...E.glow}:T?{...hr(0).style}:{},initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(Ze.button,{onClick:r,className:`block w-full text-left px-4 py-3 text-sm transition-colors ${b?"hover:bg-cyan-400/30":T?"text-pink-400 hover:bg-pink-500/20":"text-gray-700 hover:bg-blue-50"}`,style:b?{color:fe.cyan,fontFamily:"monospace",...E.textShadow}:T?{color:He.primary}:{},whileHover:{x:4},transition:{duration:.2},children:b?"CHANGE PASSWORD":"Change Password"}),l.jsx(Ze.button,{onClick:()=>{t(),ie(!0)},className:`block w-full text-left px-4 py-3 text-sm transition-colors ${b?"hover:bg-cyan-400/30":T?"text-pink-400 hover:bg-pink-500/20":"text-gray-700 hover:bg-gray-50"}`,style:b?{color:fe.cyan,fontFamily:"monospace",...E.textShadow}:T?{color:He.primary}:{},whileHover:{x:4},transition:{duration:.2},children:b?"SETTINGS":"Settings"}),l.jsx(Ze.button,{onClick:()=>{t(),n("/student/join-game")},className:`block w-full text-left px-4 py-3 text-sm transition-colors ${b?"hover:bg-cyan-400/30":T?"text-pink-400 hover:bg-pink-500/20":"text-gray-700 hover:bg-blue-50"}`,style:b?{color:fe.cyan,fontFamily:"monospace",...E.textShadow}:T?{color:He.primary}:{},whileHover:{x:4},transition:{duration:.2},children:b?"JOIN GAME":"Join Game"}),l.jsx(Ze.button,{onClick:()=>{t(),o()},className:`block w-full text-left px-4 py-3 text-sm transition-colors ${b?"hover:bg-red-400/30":T?"text-red-600 hover:bg-red-50":"text-gray-700 hover:bg-red-50"}`,style:b?{color:fe.red,fontFamily:"monospace",...E.textShadowRed}:T?{color:He.error}:{},whileHover:{x:4},transition:{duration:.2},children:b?"LOGOUT":"Logout"})]})})})]})]})})}),l.jsxs(Ze.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:[l.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 mb-8",children:l.jsx("div",{className:"lg:col-span-1 space-y-6",children:z!==null&&l.jsx(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.7,duration:.5},children:l.jsxs(Kt,{children:[l.jsx(Kt.Header,{children:l.jsx(Kt.Title,{children:"Average Score"})}),l.jsx(Kt.Body,{children:l.jsxs(Ze.div,{className:"text-center",initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.8,duration:.3},children:[l.jsxs(Ze.div,{className:"text-4xl font-bold text-blue-600 mb-2",initial:{scale:0},animate:{scale:1},transition:{delay:.9,duration:.5,type:"spring"},children:[z,"%"]}),l.jsx("p",{className:`text-sm ${b||T?"":"text-gray-500"}`,style:b?{color:fe.yellow,fontFamily:"monospace"}:T?{...E.textAccent}:{},children:"Overall Performance"})]})})]})})})}),l.jsxs("div",{className:"space-y-6",children:[l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(Kt,{className:b?Vt(0).className:T?hr(0).className:"",style:b?{...Vt(0).style,boxShadow:"0 0 20px rgba(255, 0, 60, 0.3), 0 0 40px rgba(255, 0, 60, 0.2)"}:T?{...hr(0).style,...E.glow}:{},children:[l.jsx(Kt.Header,{style:T?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,padding:"1.5rem",borderRadius:"0.5rem 0.5rem 0 0",boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx(Kt.Title,{className:"text-center ",style:b?{...E.textCyan,fontFamily:"monospace",color:fe.cyan}:T?{...E.headerText}:{},children:b?"ACTIVE TESTS":"Active Tests"})}),l.jsx(Kt.Body,{children:d&&d.length>0?l.jsxs("div",{className:"relative",children:[_e.debug(" Rendering overlay, isStartingTest:",X),X&&l.jsx("div",{className:`absolute inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50 rounded-lg border-2 ${b?"border-cyan-400":T?"border-pink-500":"border-blue-200"}`,style:b?{backgroundColor:fe.black+"E6",borderColor:fe.cyan}:T?{borderColor:He.border}:{},children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`animate-spin rounded-full h-12 w-12 border-4 mx-auto mb-4 ${b?"border-cyan-400/30 border-t-cyan-400":T?"border-pink-500/30 border-t-pink-500":"border-blue-200 border-t-blue-600"}`,style:T?{...E.glow}:{}}),l.jsx("p",{className:`font-semibold text-lg ${b?"text-cyan-400":T?"":"text-blue-600"}`,style:b?{color:fe.cyan,fontFamily:"monospace"}:T?{...E.textPink}:{},children:"Starting test..."}),l.jsx("p",{className:`text-sm mt-1 ${b?"text-cyan-400":T?"":"text-gray-500"}`,style:b?{color:fe.cyan,fontFamily:"monospace"}:T?{...E.textAccent}:{},children:"Please wait..."})]})}),l.jsxs("div",{className:"space-y-4",children:[(L?d:d.slice(0,3)).map((Te,Ve)=>l.jsx(Ze.div,{className:`rounded-lg p-4 transition-shadow ${b?Vt(Ve+1).className:T?hr(Ve+1).className:"border border-gray-200 hover:shadow-md"}`,style:b?{...Vt(Ve+1).style,boxShadow:(Ve+1)%4===0?E.glowRed.boxShadow:(Ve+1)%4===1?E.glowYellow.boxShadow:(Ve+1)%4===2?E.glowPurple.boxShadow:E.glow.boxShadow}:T?{...hr(Ve+1).style,...Ve%2===0?E.glow:E.glowPurple}:{},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:L?0:.7+Ve*.1,duration:.3},whileHover:{scale:1.02},children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"sm:hidden",children:[l.jsx("h3",{className:`text-sm font-medium mb-1 break-words leading-tight ${b||T?"":"text-gray-900"}`,style:b?{...E.textCyan,fontFamily:"monospace"}:T?{...E.textWhite}:{},children:b?Te.test_name.toUpperCase():Te.test_name}),l.jsxs("div",{className:`flex items-center space-x-2 text-xs ${b||T?"":"text-gray-500"}`,style:b?{color:fe.cyan,fontFamily:"monospace"}:T?{...E.textAccent}:{},children:[l.jsx("span",{children:Te.teacher_name}),l.jsx("span",{children:""}),l.jsx("span",{children:new Date(Te.assigned_at).toLocaleDateString("en-US",{year:"2-digit",month:"numeric",day:"numeric"})})]})]}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-3 text-sm",children:[l.jsx("h3",{className:`text-lg font-medium break-words leading-tight ${b||T?"":"text-gray-900"}`,style:b?{...E.textCyan,fontFamily:"monospace"}:T?{...E.textWhite}:{},children:b?Te.test_name.toUpperCase():Te.test_name}),l.jsx("span",{className:`px-2 py-1 rounded text-xs ${b?"bg-yellow-400/20 text-yellow-400 border border-yellow-400/50":T?"bg-pink-500/20 text-pink-400 border border-pink-500":"bg-blue-100 text-blue-800"}`,style:T?{...E.glow}:{},children:Te.subject}),l.jsx("span",{className:b||T?"":"text-gray-500",style:b?{color:fe.cyan,fontFamily:"monospace"}:T?{...E.textAccent}:{},children:Te.teacher_name}),l.jsx("span",{className:b||T?"":"text-gray-500",style:b?{color:fe.cyan,fontFamily:"monospace"}:T?{...E.textAccent}:{},children:new Date(Te.assigned_at).toLocaleDateString()})]})]}),l.jsx("div",{className:"flex space-x-2 ml-4",children:(()=>{const pt=`${Te.test_type}_${Te.test_id}`,wt=H.has(pt);let Ut=!1;if(typeof window<"u"&&Te?.retest_available){const ct=a?.student_id||a?.id||"";if(ct)try{const yt=`test_completed_${ct}_${Te.test_type}_${Te.test_id}`,rt=localStorage.getItem(yt)==="true",Oe=`retest_attempts_${ct}_${Te.test_type}_${Te.test_id}`;let $e;const Mt=localStorage.getItem(Oe);if(Mt)try{$e=JSON.parse(Mt)}catch(dr){_e.warn(" Failed to parse retest attempts metadata in render:",dr)}let It=typeof $e?.used=="number"?$e.used:void 0;if(It==null){let dr=0;for(let or=1;or<=10;or++){const mr=`retest_attempt${or}_${ct}_${Te.test_type}_${Te.test_id}`;localStorage.getItem(mr)==="true"&&dr++}It=dr}const At=typeof Te?.retest_attempts_left=="number"?Te.retest_attempts_left:void 0,ar=(typeof Te?.retest_max_attempts=="number"?Te.retest_max_attempts:void 0)??($e?.max!=null?$e.max:At!=null&&typeof Te?.retest_attempt_number=="number"?At+Te.retest_attempt_number:void 0);(At===0||ar!=null&&It!=null&&It>=ar||rt&&At==null&&ar==null)&&(Ut=!0)}catch(yt){_e.warn(" Failed to evaluate local retest completion:",yt)}}return le?Te?.retest_is_completed||Ut?l.jsx(at,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):Te?.retest_available&&!Te?.retest_is_completed&&!Ut?(Te.retest_attempts_left||0)>0?l.jsx(at,{variant:"primary",size:"sm",onClick:()=>vt(Te),disabled:X,className:b?"":T?"bg-pink-500 text-white hover:bg-pink-600":"",style:b?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...E.glow}:T?{backgroundColor:He.primary,color:He.white}:{},children:b?"START RETEST":"Start Retest"}):l.jsx(at,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):wt?l.jsx(at,{variant:"secondary",size:"xs",disabled:!0,className:"bg-green-100 text-green-800 border-green-200",children:" Completed"}):(_e.debug(" Button render, isStartingTest:",X,"test:",Te.test_type),l.jsx(at,{variant:"primary",size:"sm",onClick:()=>vt(Te),disabled:X,className:b?"":T?"bg-pink-500 text-white hover:bg-pink-600":"",style:b?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...E.glow}:T?{backgroundColor:He.primary,color:He.white,borderWidth:"0px"}:{},children:b?"START TEST":"Start Test"})):l.jsx(at,{variant:"secondary",size:"sm",disabled:!0,className:b?"":T?"bg-pink-500/20 text-pink-400 border-pink-500/50":"bg-gray-100 text-gray-500 border-gray-200",style:b?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace"}:{},children:"Loading..."})})()})]})},`${Te.test_type}_${Te.test_id}`)),d.length>3&&l.jsx("div",{className:"text-center pt-2",children:l.jsx("button",{onClick:Ge,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:L?"Show Less":`Show ${d.length-3} More`})})]})]}):l.jsxs(Ze.div,{className:"text-center py-12",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.3},children:[l.jsx(Ze.img,{src:"/pics/no-tests.png",alt:"No active tests",className:"w-24 h-24 mx-auto mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.8,duration:.5,type:"spring"}}),l.jsx("h3",{className:`text-lg font-semibold mb-2 ${b||T?"":"text-gray-800"}`,style:b?{...E.textCyan,fontFamily:"monospace"}:T?{...E.textPink}:{},children:"No Active Tests"})]})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(Kt,{className:`${b?Vt(2).className:T?hr(2).className:""}`,paddingClass:"py-6 px-3 sm:p-6",style:b?{...Vt(2).style,...E.glowPurple}:T?{...hr(2).style,...E.glowPurple}:{},children:[l.jsx(Kt.Header,{style:T?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,padding:"1.5rem",borderRadius:"0.5rem 0.5rem 0 0",boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx(Kt.Title,{className:" text-center",style:b?{...E.textCyan,fontFamily:"monospace"}:T?{...E.headerText}:{},children:b?"TEST RESULTS":"Test Results"})}),l.jsx(Kt.Body,{children:f&&f.showResults?l.jsx(Q2,{testResults:f,onBackToCabinet:()=>{setTestResults(null)},onRetakeTest:(Te,Ve)=>{h(),setTestResults(null)},isLoading:F}):l.jsx(qV,{compact:!0,showAll:W,onToggleShowAll:et,maxInitial:3})})]})})]})]}),l.jsx(SE,{isOpen:x.isOpen,onClose:v,testType:x.testType,testId:x.testId,testName:x.testName,questions:x.questions||[],isLoading:x.isLoading||!1}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:I.map(Te=>l.jsx(bu,{type:Te.type,message:Te.message,onClose:()=>U(Ve=>Ve.filter(pt=>pt.id!==Te.id))},Te.id))}),l.jsx(tme,{visible:we,onClose:()=>ie(!1)})]},s.pathname))},ege=({testInfo:e,questions:t,testType:r,studentAnswers:n,onBackToCabinet:s,checkAnswerCorrectness:a,formatStudentAnswerForDisplay:i,getCorrectAnswer:o,caughtCheating:c=!1})=>{const{theme:u,isCyberpunk:d,isKpop:f}=da(),h=ua(u),[g,p]=w.useState(0),[x,v]=w.useState(0),[C,b]=w.useState(!0);if(w.useEffect(()=>{const N=()=>{try{const E=Zf(t,n,r).score,F=e?.num_questions||t?.length||0,j=F>0?Math.round(E/F*100):0;p(E),v(j),b(!1)}catch(E){console.error("Error calculating test results:",E),p(0),v(0),b(!1)}};t&&t.length>0?N():b(!1)},[t,n,r,e,Zf]),C)return l.jsx("div",{className:"flex justify-center items-center min-h-64",children:l.jsx("div",{className:"text-lg",children:"Calculating results..."})});const _=e?.num_questions||t?.length||0,T=e?.test_name||e?.title||"Test";return l.jsxs("div",{className:`test-results-page max-w-4xl mx-auto p-6 overflow-y-auto min-h-screen ${d||f?"bg-black":""}`,style:d?h.background:f?h.backgroundSecondary:{},children:[l.jsx(Kt,{className:`mb-6 border-2 ${d?Vt(0).className:f?hr(0).className:""}`,style:d?{...Vt(0).style,...h.glowRed}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},children:l.jsxs("div",{className:"results-header text-center",children:[l.jsx("h2",{className:`text-2xl font-bold mb-2 ${d?"":"text-gray-800"}`,style:d?{...h.textCyan,fontFamily:"monospace"}:f?{...h.headerText}:{},children:d?`TEST RESULTS: ${T.toUpperCase()}`:`Test Results: ${T}`}),l.jsx("p",{className:d?"":"text-gray-600",style:d?{color:fe.yellow,fontFamily:"monospace"}:{},children:r==="matching_type"?"Matching Test":r==="multiple_choice"?"Multiple Choice Test":r==="true_false"?"True/False Test":r==="input"?"Input Test":r==="drawing"?"Drawing Test":"Test"})]})}),c&&l.jsx(Kt,{className:`mb-6 border-2 ${d||f?"border":"border-red-500 bg-red-50"}`,style:d?{backgroundColor:fe.black,borderColor:fe.red,...h.glowRed}:f?{backgroundColor:He.background,borderColor:He.error,...h.glowRed}:{},children:l.jsxs("div",{className:"flex items-start space-x-3 p-4",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:`h-6 w-6 ${d||f?"":"text-red-600"}`,style:d?{color:fe.red}:f?{color:He.error}:{},fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),l.jsx("div",{className:"flex-1",children:l.jsx("p",{className:d||f?"":"text-red-700",style:d?{...h.textRed,fontFamily:"monospace"}:f?{color:He.error,...h.textShadowRed}:{},children:"Suspicious activity was detected during this test. Your teacher has been notified."})})]})}),l.jsx(Kt,{className:`mb-6 border-2 ${d?Vt(1).className:f?hr(1).className:""}`,style:d?{...Vt(1).style,...h.glow}:f?{...hr(1).style,borderColor:He.primary,...h.glow}:{},children:l.jsxs("div",{className:"results-summary",children:[l.jsx("h3",{className:`text-xl font-semibold mb-4 text-center ${d?"":"text-gray-800"}`,style:d?{...h.textCyan,fontFamily:"monospace"}:f?{...h.headerText}:{},children:d?`YOUR SCORE: ${g} / ${_} (${x}%)`:`Your Score: ${g} / ${_} (${x}%)`}),l.jsx("div",{className:`w-full rounded-full h-4 mb-4 border ${d?"bg-gray-800 border-cyan-400/50":f?"bg-black border-pink-500/50":"bg-gray-200"}`,style:d?h.glow:f?{...h.glow}:{},children:l.jsx("div",{className:`h-4 rounded-full transition-all duration-500 ${d||f?"":x>=80?"bg-green-500":x>=60?"bg-yellow-500":"bg-red-500"}`,style:d?{background:`linear-gradient(to right, ${fe.yellow}, ${fe.cyan})`,boxShadow:`0 0 10px ${fe.cyan}`,width:`${x}%`}:f?{background:`linear-gradient(to right, ${He.primary}, ${He.secondary})`,boxShadow:`0 0 10px ${He.primary}`,width:`${x}%`}:{width:`${x}%`}})}),l.jsx("div",{className:"text-center",children:l.jsx("p",{className:`text-lg font-medium ${d?"":x>=80?"text-green-600":x>=60?"text-yellow-600":"text-red-600"}`,style:d?{color:x>=80?fe.green:x>=60?fe.yellow:fe.red,fontFamily:"monospace",...x>=80?h.textShadowGreen:x>=60?h.textShadowYellow:h.textShadowRed}:{},children:x>=80?"Excellent!":x>=60?"Good job!":"Keep practicing!"})})]})}),t&&t.length>0&&l.jsx(Kt,{className:`mb-6 border-2 ${d?Vt(2).className:f?hr(1).className:""}`,style:d?{...Vt(2).style,...h.glow}:f?{...hr(1).style,borderColor:He.primary,...h.glow}:{},children:l.jsxs("div",{className:"questions-review",children:[l.jsx("h3",{className:`text-xl font-semibold mb-4 ${d?"":"text-gray-800"}`,style:d?{...h.textCyan,fontFamily:"monospace"}:f?{...h.headerText}:{},children:d?"QUESTION REVIEW":"Question Review"}),l.jsx("div",{className:"space-y-4",children:t.map((N,E)=>{const F=n[String(N.question_id)]||"No answer",j=a(N,F,r);return l.jsxs("div",{className:`question-review p-4 rounded-lg border-2 ${d||f?"border":j?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,style:d?{backgroundColor:fe.black,borderColor:j?fe.green:fe.red,boxShadow:j?h.glow.boxShadow:h.glowRed.boxShadow}:f?{backgroundColor:He.background,borderColor:j?He.success:He.error,boxShadow:j?h.glow.boxShadow:h.glowRed.boxShadow}:{},children:[l.jsxs("div",{className:"question-review-header flex justify-between items-start mb-3",children:[l.jsxs("h4",{className:`text-lg font-medium ${d?"":"text-gray-800"}`,style:d?{...h.textCyan,fontFamily:"monospace"}:{},children:["Question ",E+1]}),l.jsx("span",{className:`text-2xl font-bold ${d?"":j?"text-green-600":"text-red-600"}`,style:d?{color:j?fe.green:fe.red,fontFamily:"monospace",...j?h.textShadowGreen:h.textShadowRed}:{},children:j?"":""})]}),l.jsx("div",{className:"question-text mb-3",children:l.jsx("p",{className:`p-3 rounded border ${d?"border":"text-gray-700 bg-gray-100"}`,style:d?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:N.question})}),l.jsxs("div",{className:"answer-section space-y-2",children:[l.jsxs("p",{className:"student-answer",children:[l.jsx("strong",{className:d?"":"text-gray-600",style:d?{color:fe.yellow,fontFamily:"monospace"}:{},children:"Your Answer:"})," ",l.jsx("span",{className:`p-3 rounded border font-medium ${d?"border":j?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,style:d?{backgroundColor:fe.black,borderColor:j?fe.green:fe.red,color:j?fe.green:fe.red,fontFamily:"monospace",...j?h.textShadowGreen:h.textShadowRed}:{},children:i(F,r,N)})]}),!j&&l.jsxs("p",{className:"correct-answer",children:[l.jsx("strong",{className:d?"":"text-gray-600",style:d?{color:fe.yellow,fontFamily:"monospace"}:{},children:"Correct Answer:"})," ",l.jsx("span",{className:`p-3 rounded border font-medium ${d?"border":"bg-blue-100 text-blue-800"}`,style:d?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...h.textShadow}:{},children:r==="multiple_choice"?String(N.correct_answer||"").toUpperCase():i(o(N,r),r,N)})]})]})]},N.question_id||E)})})]})}),l.jsx(Kt,{className:`border-2 ${d?Vt(0).className:f?hr(0).className:""}`,style:d?{...Vt(0).style,...h.glowRed}:f?{...hr(0).style,borderColor:He.primary,...h.glow}:{},children:l.jsx("div",{className:"results-actions text-center",children:l.jsx(at,{onClick:s,className:`px-8 py-3 text-lg font-medium ${d?"":"bg-blue-600 hover:bg-blue-700 text-white"}`,style:d?{backgroundColor:fe.cyan,color:fe.black,fontFamily:"monospace",...h.glow}:{},children:d?"BACK TO CABINET":"Back to Cabinet"})})})]})};class tge{constructor(){this.activeRequests=new Map,this.completedRequests=new Map,this.maxCacheSize=100,this.cacheTimeout=3e4}generateKey(t,r,n={}){const s=Object.keys(n).sort().reduce((a,i)=>(a[i]=n[i],a),{});return`${t}_${r}_${JSON.stringify(s)}`}isRequestInProgress(t){return this.activeRequests.has(t)}getCachedResult(t){const r=this.completedRequests.get(t);return r&&Date.now()-r.timestamp<this.cacheTimeout?r.result:null}startRequest(t,r){return this.activeRequests.set(t,r),r.finally(()=>{this.activeRequests.delete(t)}),r}cacheResult(t,r){if(this.completedRequests.size>=this.maxCacheSize){const n=this.completedRequests.keys().next().value;this.completedRequests.delete(n)}this.completedRequests.set(t,{result:r,timestamp:Date.now()})}async deduplicateApiCall(t,r,n,s){const a=this.generateKey(t,r,n);if(this.isRequestInProgress(a))return console.log(" API deduplication: Request already in progress, waiting...",a),this.activeRequests.get(a);const i=this.getCachedResult(a);if(i)return console.log(" API deduplication: Using cached result",a),i;console.log(" API deduplication: Making new request",a);const o=this.startRequest(a,s());try{const c=await o;return this.cacheResult(a,c),c}catch(c){throw c}}clearCache(){this.activeRequests.clear(),this.completedRequests.clear(),console.log(" API deduplication: Cache cleared")}}const UO=new tge,rge=(e,t)=>{let r;return(...n)=>{clearTimeout(r),r=setTimeout(()=>e.apply(null,n),t)}},nge=({onBackToCabinet:e,currentTest:t})=>{const r=Za(),n=ku(),{user:s,isAuthenticated:a}=ws(),{activeTests:i,loadActiveTests:o}=J2(),{theme:c,isCyberpunk:u,isLight:d,isKpop:f,themeClasses:h}=da(),g=ua(c),p=w.useCallback(rge((ue,ge,Me)=>{try{if(window.skipInitialProgressSave&&Me.answers&&Me.answers.length===0){_e.debug(" Skipping empty progress save during restoration"),window.skipInitialProgressSave=!1;return}const Je=`test_progress_${s?.student_id||s?.id||"unknown"}_${ue}_${ge}`,nt=localStorage.getItem(Je);if(nt&&Me.answers&&Me.answers.length===0)try{const mt=JSON.parse(nt);if(mt.answers&&mt.answers.length>0){_e.debug(" Skipping empty progress save - existing progress is better:",mt.answers);return}}catch{}localStorage.setItem(Je,JSON.stringify(Me)),_e.debug(`Saved test progress for ${ue}_${ge}:`,Me)}catch(ot){_e.error("Error saving test progress:",ot)}},1e3),[s?.student_id,s?.id]),x=w.useCallback((ue,ge,Me)=>{p(ue,ge,Me)},[p]),v=w.useCallback((ue,ge)=>{try{const ot=`test_progress_${s?.student_id||s?.id||"unknown"}_${ue}_${ge}`,Je=localStorage.getItem(ot);return Je?JSON.parse(Je):null}catch(Me){return _e.error("Error getting test progress:",Me),null}},[s?.student_id,s?.id]),C=w.useCallback((ue,ge)=>{try{const Me=s?.student_id||s?.id||"unknown",ot=`test_progress_${Me}_${ue}_${ge}`;localStorage.removeItem(ot);for(let Je=0;Je<localStorage.length;Je++){const nt=localStorage.key(Je);nt&&nt.startsWith(`test_progress_${Me}_${ue}_${ge}_`)&&(localStorage.removeItem(nt),_e.debug(` Cleared individual question key: ${nt}`))}_e.debug(`Cleared test progress for ${ue}_${ge}`)}catch(Me){_e.error("Error clearing test progress:",Me)}},[s?.student_id,s?.id]),[b,_]=w.useState(!0),[T,N]=w.useState(!1),[E,F]=w.useState(""),[j,P]=w.useState(!1),[M,I]=w.useState(""),[U,K]=w.useState([]),[te,re]=w.useState(t?"test":"list"),[Z,B]=w.useState(null),[J,z]=w.useState(null),[q,H]=w.useState(null),[R,L]=w.useState([]),[G,W]=w.useState([]),[Q,X]=w.useState(0),[se,le]=w.useState(0),[he,we]=w.useState(null),ie=Rs.useRef(null),Ee=Rs.useRef(null),[ye,Ie]=w.useState(!1),[ut,Qe]=w.useState(!1),[$t,Ge]=w.useState(null),[et,vt]=w.useState(null),[Te,Ve]=w.useState(!1),[pt,wt]=w.useState(!1),[Ut,ct]=w.useState(!1),[yt,rt]=w.useState(!1),Oe=w.useRef(null);I2(yt,w.useCallback(({confirm:ue,cancel:ge})=>{Oe.current={confirm:ue,cancel:ge},wt(!0)},[])),w.useEffect(()=>{(te==="test"||te==="results")&&Z?rt(!0):(rt(!1),Oe.current=null)},[te,Z]);const[$e,Mt]=w.useState({isInitialized:!1,initializationId:null,lastTestId:null,initializationCount:0}),[It,At]=w.useState({isRestored:!1,restoredTestId:null,restorationCount:0}),{startTracking:tr,stopTracking:ar,getCheatingData:dr,clearData:or,isCheating:mr,tabSwitches:ve}=D1(Z?.test_type,Z?.test_id,s?.student_id||s?.id);w.useEffect(()=>{(()=>{const ge=[];for(let Me=0;Me<localStorage.length;Me++){const ot=localStorage.key(Me);if(ot&&ot.startsWith("test_progress_")&&!ot.includes("_51712_")&&!ot.includes("_51736_")){const Je=ot.split("_");Je.length===4&&Je[0]==="test"&&Je[1]==="progress"&&ge.push(ot)}}ge.forEach(Me=>{localStorage.removeItem(Me),_e.debug(" Cleared old cache key:",Me)})})()},[]);const Fe=w.useCallback(()=>{const ue=Z?.test_id,ge=s?.student_id||s?.id;if(!ge||!ue)return _e.debug(" Skipping initialization - missing required data:",{studentId:ge,currentTestId:ue}),!1;const Me=`${ge}_${ue}_${Date.now()}`;return $e.isInitialized&&$e.lastTestId===ue?(_e.debug(" Already initialized for this test - skipping"),!1):$e.initializationId?(_e.debug(" Initialization in progress - skipping duplicate"),!1):(_e.debug(" Starting initialization:",Me),Mt({isInitialized:!1,initializationId:Me,lastTestId:ue}),!0)},[$e,Z,s?.student_id,s?.id]),Be=w.useCallback(()=>{Mt(ue=>({...ue,isInitialized:!0,initializationId:null})),_e.debug(" Initialization completed")},[]),Pe=w.useCallback(async()=>{_e.debug(" Initializing Student Tests...");try{if(_(!0),I(""),!a||!s){_e.debug(" User not authenticated"),I("User not authenticated");return}if(s.role!==Ko.STUDENT){_e.error(" Invalid user role for student tests:",s.role),I("Access denied. Student role required.");return}_e.debug(" Loading active tests..."),await o(),Be(),_e.debug(" Student Tests initialization complete!")}catch(ue){_e.error(" Error initializing student tests:",ue),I("Failed to initialize student tests")}finally{_(!1)}},[a,s,o,Be]);w.useEffect(()=>{Fe()&&Pe()},[Fe,Pe]),w.useEffect(()=>{t&&(_e.debug(" Auto-starting test from prop:",t),P(!0),Lt(t))},[t]),w.useCallback(async()=>{_e.debug(" Loading student active tests...");try{const ue=await Pn.getActiveTests();_e.debug(" Active tests loaded:",ue);const ge=ue.map(Me=>({...Me,subject_id:Me.subject_id||Me.subjectId,teacher_id:Me.teacher_id||Me.teacherId,is_active:Me.is_active!==void 0?Me.is_active:!0,created_at:Me.created_at||Me.createdAt,updated_at:Me.updated_at||Me.updatedAt}));return vt(new Date),ge}catch(ue){throw _e.error(" Error loading active tests:",ue),ue}},[]),w.useCallback(async(ue,ge)=>{_e.debug(" Checking test completion:",ue,ge);try{const Me=v(ue,ge);return Me&&Me.completed}catch(Me){return _e.error(" Error checking test completion:",Me),!1}},[v]),w.useEffect(()=>{if(R.length>0&&Z?.test_id){const ue=setTimeout(()=>{let ge=!1;const Me=new Array(R.length).fill("");if(R.forEach((ot,Je)=>{const mt=`test_progress_${s?.student_id||s?.id||"unknown"}_${J}_${Z?.test_id}_${ot.question_id}`,de=localStorage.getItem(mt);if(de){const Se=de.replace(/^"(.*)"$/,"$1");Me[Je]=Se,ge=!0}}),ge){W(Me);const ot=Me.filter(nt=>nt&&typeof nt=="string"&&nt.trim()!=="").length,Je=R.length>0?ot/R.length*100:0;X(Je)}},100);return()=>clearTimeout(ue)}},[R,J,Z?.test_id]);const lt=w.useCallback(async(ue,ge)=>{_e.debug(" Marking test as completed:",ue,ge);try{const Me=v(ue,ge)||{};Me.completed=!0,Me.completedAt=new Date().toISOString(),x(ue,ge,Me);const Je=`test_completed_${s?.student_id||s?.id||""}_${ue}_${ge}`;localStorage.setItem(Je,"true"),_e.debug(" Test completion marked in localStorage:",Je),_e.debug(" localStorage value after setting:",localStorage.getItem(Je)),yr("Test marked as completed","success")}catch(Me){_e.error(" Error marking test as completed:",Me),yr("Failed to mark test as completed","error")}},[v,x]),Ct=w.useCallback(ue=>{_e.debug(" Showing test details:",ue),Ge(ue),Qe(!0)},[]),Lt=w.useCallback(async ue=>{_e.debug(" Starting test:",ue);let ge=Date.now(),Me;try{F(""),N(!0),ge=Date.now();const ot=()=>{const gr=Date.now()-ge,Zr=Math.max(0,250-gr);setTimeout(()=>{_(!1),N(!1)},Zr)};let Je=!1;Me=setTimeout(()=>{Je=!0,F("Loading is taking longer than expected...")},15e3);const mt=`test_completed_${s?.student_id||s?.id||""}_${ue.test_type}_${ue.test_id}`,de=localStorage.getItem(mt)==="true";if(de&&!ue?.retest_available){_e.debug(" Test already completed, redirecting to main cabinet"),yr("This test has already been completed","info"),r("/student");return}if(de&&ue?.retest_available&&_e.debug(" Test completed but retest available, allowing retest"),ue.test_type===us.MATCHING){_e.debug(" Redirecting to matching test page for testId:",ue.test_id),r(`/student/matching-test/${ue.test_id}`);return}if(ue.test_type===us.WORD_MATCHING){_e.debug(" Redirecting to word matching test page for testId:",ue.test_id),r(`/student/word-matching-test/${ue.test_id}`);return}B(ue),z(ue.test_type),At({isRestored:!1,restoredTestId:null,restorationCount:0});const[Se,De]=await Promise.all([UO.deduplicateApiCall("GET",`test-info-${ue.test_type}-${ue.test_id}`,{testType:ue.test_type,testId:ue.test_id},()=>Pn.getTestInfo(ue.test_type,ue.test_id)),UO.deduplicateApiCall("GET",`test-questions-${ue.test_type}-${ue.test_id}`,{testType:ue.test_type,testId:ue.test_id},()=>Pn.getTestQuestions(ue.test_type,ue.test_id))]);H(Se);let Le=De;try{if(!!Se?.is_shuffled){const pn=s?.student_id||s?.id||"unknown",Zr=`${pn}:${ue.test_type}:${ue.test_id}`,Zn=Array.from(Zr).reduce((Dt,Fr)=>(Dt<<5)-Dt+Fr.charCodeAt(0),0)>>>0,Fn=`test_shuffle_order_${pn}_${ue.test_type}_${ue.test_id}`,Ce=localStorage.getItem(Fn);if(Ce){const Dt=JSON.parse(Ce),Fr=new Map(De.map(Kr=>[Kr.question_id,Kr]));Le=Dt.map(Kr=>Fr.get(Kr)).filter(Boolean)}else{const Fr=function(On){return function(){var Qr=On+=1831565813;return Qr=Math.imul(Qr^Qr>>>15,Qr|1),Qr^=Qr+Math.imul(Qr^Qr>>>7,Qr|61),((Qr^Qr>>>14)>>>0)/4294967296}}(Zn);Le=[...De];for(let On=Le.length-1;On>0;On--){const Qr=Math.floor(Fr()*(On+1));[Le[On],Le[Qr]]=[Le[Qr],Le[On]]}const Kr=Le.map(On=>On.question_id);localStorage.setItem(Fn,JSON.stringify(Kr))}}}catch(gr){_e.error("Shuffle error (ignored):",gr)}L(Le),ot();const tt=ue.test_id;if(It.isRestored&&It.restoredTestId===tt){_e.debug(" Progress already restored for this test - skipping");return}At(gr=>({...gr,restorationCount:gr.restorationCount+1}));const qt=s?.student_id||s?.id||"unknown",kr=`test_progress_${qt}_${ue.test_type}_${ue.test_id}`,jr=localStorage.getItem(kr);let _t=new Array(De.length).fill("");if(jr)try{const gr=JSON.parse(jr);gr.answers&&Array.isArray(gr.answers)&&(_t=gr.answers)}catch(gr){_e.error("Error parsing main progress:",gr)}De.forEach((gr,pn)=>{const Zr=`test_progress_${qt}_${ue.test_type}_${ue.test_id}_${gr.question_id}`,Zn=localStorage.getItem(Zr);if(Zn){const Fn=Zn.replace(/^"(.*)"$/,"$1");_t[pn]=Fn}});const ur=_t.filter(gr=>gr&&typeof gr=="string"&&gr.trim()!=="").length;if(ur>0){W(_t);const gr=De.length>0?ur/De.length*100:0;X(gr)}else W(_t),X(0);At(gr=>({...gr,isRestored:!0,restoredTestId:tt})),ur>0&&(_e.debug(" Existing progress found - preventing overwrite during initialization"),window.skipInitialProgressSave=!0);const Gr=Number(Se?.allowed_time||0),Mr=s?.student_id||s?.id||"unknown";if(ie.current=`test_timer_${Mr}_${ue.test_type}_${ue.test_id}`,Gr>0)try{const gr=localStorage.getItem(ie.current),pn=Date.now();if(gr){const Zr=JSON.parse(gr),Zn=Math.floor((pn-new Date(Zr.lastTickAt).getTime())/1e3),Fn=Math.max(0,Number(Zr.remainingSeconds||Gr)-Math.max(0,Zn));le(Fn),Ee.current=pn}else le(Gr),Ee.current=pn,localStorage.setItem(ie.current,JSON.stringify({remainingSeconds:Gr,lastTickAt:new Date(pn).toISOString(),startedAt:new Date(pn).toISOString()}))}catch(gr){_e.error("Timer cache init error:",gr),le(Gr)}else le(0);const Tr=new Date;we(Tr),_e.debug(" Test timer started at:",Tr.toISOString());const $r=`anti_cheating_${s?.student_id||s?.id||"unknown"}_${ue.test_type}_${ue.test_id}`,qn=Os($r);qn?qn.isCheating&&(_e.debug(" WARNING: Student has been flagged for cheating in THIS test!"),_e.debug(" Tab switches detected in this test:",qn.tabSwitches),yr(` Warning: Suspicious activity detected in this test (${qn.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning")):_e.debug(" No existing anti-cheating data found for this test - starting fresh"),tr(),_e.debug(" Anti-cheating tracking started"),re("test"),_e.debug(" Test started successfully")}catch(ot){_e.error(" Error starting test:",ot),yr("Failed to start test","error"),F("Failed to load test data. Please try again.")}finally{const ot=Date.now()-ge,nt=Math.max(0,250-ot);setTimeout(()=>{_(!1),N(!1)},nt),P(!1);try{Me&&clearTimeout(Me)}catch{}}},[v]),Ue=w.useCallback(async()=>{if(!Z||!q||!R||!G){yr("No test data to submit","error");return}_e.debug(" Submitting test:",Z);try{Ie(!0);const ue=Zf(R,G,Z.test_type),ge=new Date,Me=he?Math.round((ge-he)/1e3):0,ot=he?he.toISOString():ge.toISOString();_e.debug(" Test timing:",{startedAt:ot,endTime:ge.toISOString(),timeTaken:`${Me} seconds`});const Je=dr();_e.debug(" Anti-cheating data for submission:",Je),ct(Je.caught_cheating||!1);const nt={};R.forEach((de,Se)=>{nt[de.question_id]=G[Se]??""}),Z.test_type==="drawing"&&(_e.debug(" Drawing test answers being submitted:",G),_e.debug(" Drawing test answers type:",typeof G[0]),_e.debug(" Drawing test answers content:",G[0]));const mt=await Pn.submitTest(Z.test_type,Z.test_id,G,{time_taken:(()=>{const de=Number(q?.allowed_time||0);return de>0?Math.min(Me,de):Me})(),started_at:ot,submitted_at:ge.toISOString(),answers_by_id:nt,question_order:R.map(de=>de.question_id),caught_cheating:Je.caught_cheating,visibility_change_times:Je.visibility_change_times,retest_assignment_id:(()=>{const Se=`retest_assignment_id_${s?.student_id||s?.id||""}_${Z.test_type}_${Z.test_id}`,De=localStorage.getItem(Se);return _e.debug(" Frontend retest key:",Se),_e.debug(" Frontend retest assignment ID from localStorage:",De),_e.debug(" Frontend retest assignment ID converted:",De?Number(De):null),_e.debug(" Frontend current test data:",Z),_e.debug(" Frontend current test retest_assignment_id:",Z.retest_assignment_id),De?Number(De):null})(),parent_test_id:Z.test_id},s);if(_e.debug(" Test submission result:",mt),mt.success){window.recentTestCompleted=!0,_e.debug(" Test completed - cache refresh triggered");const de=s?.student_id||s?.id||"",Se=`retest_assignment_id_${de}_${Z.test_type}_${Z.test_id}`,De=!!localStorage.getItem(Se);let Le=!1;if(De){const _t=typeof Z?.retest_max_attempts=="number"?Z.retest_max_attempts:void 0,ur=typeof Z?.retest_attempts_left=="number"?Z.retest_attempts_left:void 0,Gr=typeof Z?.retest_attempt_number=="number"?Z.retest_attempt_number:void 0,Mr=_t??(ur!=null&&Gr!=null?ur+Gr:1),Tr=(mt?.percentage_score??mt?.percentage??0)>=50;if(Tr){const qr=`retest_attempt${Mr}_${de}_${Z.test_type}_${Z.test_id}`;localStorage.setItem(qr,"true"),_e.debug(" Passed retest, marking last-slot key:",qr);let $r=0;for(let gr=1;gr<=10;gr++){const pn=`retest_attempt${gr}_${de}_${Z.test_type}_${Z.test_id}`;localStorage.getItem(pn)==="true"&&$r++}if(de&&Z.test_type&&Z.test_id){const gr=`test_completed_${de}_${Z.test_type}_${Z.test_id}`;localStorage.setItem(gr,"true"),_e.debug(" Marked retest as completed (student passed):",gr);const pn=`retest_attempts_${de}_${Z.test_type}_${Z.test_id}`;localStorage.setItem(pn,JSON.stringify({used:$r,max:Mr})),_e.debug(" Set retest attempts metadata (student passed):",pn,{used:$r,max:Mr})}const qn=`retest1_${de}_${Z.test_type}_${Z.test_id}`;localStorage.removeItem(qn),Le=!0}else{let qr=1;for(let Zr=1;Zr<=10;Zr++){const Zn=`retest_attempt${Zr}_${de}_${Z.test_type}_${Z.test_id}`;if(localStorage.getItem(Zn)!=="true"){qr=Zr;break}}const $r=`retest_attempt${qr}_${de}_${Z.test_type}_${Z.test_id}`;localStorage.setItem($r,"true"),_e.debug(" Marked retest attempt as completed:",$r);let qn=0;for(let Zr=1;Zr<=10;Zr++){const Zn=`retest_attempt${Zr}_${de}_${Z.test_type}_${Z.test_id}`;localStorage.getItem(Zn)==="true"&&qn++}const gr=Mr>0&&qn>=Mr,pn=gr||Tr;if(_e.debug(" Retest completion check:",{usedAttempts:qn,maxAttempts:Mr,attemptsExhausted:gr,passed:Tr,shouldComplete:pn,studentId:!!de,test_type:!!Z?.test_type,test_id:!!Z?.test_id}),pn)if(!de||!Z?.test_type||!Z?.test_id)_e.error(" Cannot set completion key - missing required fields:",{studentId:de,test_type:Z?.test_type,test_id:Z?.test_id});else{const Zr=`test_completed_${de}_${Z.test_type}_${Z.test_id}`;localStorage.setItem(Zr,"true"),_e.debug(" Marked retest as completed (attempts exhausted or passed):",Zr),_e.debug(" Verification - completion key value:",localStorage.getItem(Zr));const Zn=`retest_attempts_${de}_${Z.test_type}_${Z.test_id}`;localStorage.setItem(Zn,JSON.stringify({used:qn,max:Mr})),_e.debug(" Set retest attempts metadata (attempts exhausted):",Zn,{used:qn,max:Mr});const Fn=`retest1_${de}_${Z.test_type}_${Z.test_id}`;localStorage.removeItem(Fn),_e.debug(" Removed retest key after completion:",Fn),Le=!0}else _e.debug(" Retest NOT completed - conditions not met:",{attemptsExhausted:gr,passed:Tr,shouldComplete:pn})}}if(_e.debug(" Marking test as completed..."),await lt(Z.test_type,Z.test_id),Z.test_type!=="drawing"){_e.debug(" Caching test results after submission...");const ur=`student_results_table_${s?.student_id||s?.id||"unknown"}`,{setCachedData:Gr,CACHE_TTL:Mr}=await ui(async()=>{const{setCachedData:Tr,CACHE_TTL:qr}=await Promise.resolve().then(()=>Dp);return{setCachedData:Tr,CACHE_TTL:qr}},void 0);Gr(ur,mt,Mr.student_results_table),_e.debug(" Test results cached with key:",ur)}else _e.debug(" Drawing test submitted - not caching results (will appear after teacher grades)");_e.debug(" Clearing test progress..."),C(Z.test_type,Z.test_id);try{const _t=s?.student_id||s?.id||"unknown",ur=`test_timer_${_t}_${Z.test_type}_${Z.test_id}`;localStorage.removeItem(ur);const Gr=`test_shuffle_order_${_t}_${Z.test_type}_${Z.test_id}`;localStorage.removeItem(Gr)}catch{}if(s?.student_id){const _t=`test_completed_${s.student_id}_${Z.test_type}_${Z.test_id}`;localStorage.setItem(_t,"true"),_e.debug(" Test marked as completed in localStorage:",_t)}try{const _t=s?.student_id||s?.id||"",ur=`retest1_${_t}_${Z.test_type}_${Z.test_id}`,Gr=`retest_assignment_id_${_t}_${Z.test_type}_${Z.test_id}`;Le?(localStorage.removeItem(ur),localStorage.removeItem(Gr),_e.debug(" Cleared retest keys (completion):",ur,Gr)):_e.debug(" Retest still pending - keeping keys:",ur,Gr)}catch(_t){_e.warn(" Failed to manage retest keys:",_t)}_e.debug(" Clearing test progress and anti-cheating data for THIS test only...");const tt=s?.student_id||s?.id||"unknown",qt=[],kr=`test_progress_${tt}_${Z.test_type}_${Z.test_id}`,jr=`anti_cheating_${tt}_${Z.test_type}_${Z.test_id}`;for(let _t=0;_t<localStorage.length;_t++){const ur=localStorage.key(_t);ur&&(ur===kr||ur===jr)&&qt.push(ur)}if(qt.forEach(_t=>{localStorage.removeItem(_t),_e.debug(` Cleared for THIS test only: ${_t}`)}),_e.debug(" Clearing anti-cheating data..."),ar(),or(),Z.test_type!=="drawing")re("results");else{rt(!1),Oe.current=null;try{const _t=window.history.state;if(_t&&_t.__intercept){const ur=_t.prevState??null;window.history.replaceState(ur,document.title,window.location.href)}}catch(_t){_e.warn("Failed to restore history state for drawing test:",_t)}setTimeout(()=>{window.location.href="/student"},100)}yr("Test submitted successfully!","success"),_e.debug(" Test submitted successfully")}else throw _e.error(" Test submission failed:",mt.error),new Error(mt.error||"Failed to submit test")}catch(ue){_e.error(" Error submitting test:",ue),yr("Failed to submit test","error")}finally{Ie(!1)}},[Z,q,R,G,lt,C]);w.useCallback(()=>(_e.debug(" Collecting test answers..."),G),[G]);const st=w.useCallback(()=>{if(!R||!G)return;const ue=G.filter(Me=>Me&&typeof Me=="string"&&Me.trim()!=="").length,ge=R.length>0?ue/R.length*100:0;if(X(ge),_e.debug(` Progress updated: ${ue}/${R.length} questions answered (${Math.round(ge)}%)`),Z){const Me={answers:G,progress:ge,lastSaved:new Date().toISOString()};x(Z.test_type,Z.test_id,Me)}},[R,G,Z,x]);w.useEffect(()=>{st()},[st]);const dt=w.useCallback(()=>G?G.filter(ge=>ge&&typeof ge=="string"&&ge.trim()!=="").length:0,[G,R]),Bt=w.useCallback(()=>{if(Z&&s?.student_id){const ge=`anti_cheating_${s?.student_id||s?.id||"unknown"}_${Z.test_type}_${Z.test_id}`,Je=((Os(ge)||{tabSwitches:0}).tabSwitches||0)+1,nt=Je>=2;vs(ge,{tabSwitches:Je,isCheating:nt},hs.anti_cheating)}rt(!1),Oe.current=null;try{const ue=window.history.state;if(ue&&ue.__intercept){const ge=ue.prevState??null;window.history.replaceState(ge,document.title,window.location.href)}}catch(ue){_e.warn("Failed to restore history state in goBack:",ue)}setTimeout(()=>{window.location.href="/student"},100)},[e,r,Z,s?.student_id,yt,n]),Yt=w.useCallback(()=>{wt(!1);const ue=Oe.current;if(Oe.current=null,rt(!1),ue)try{const ge=window.history.state;if(ge&&ge.__intercept){const Me=ge.prevState??null;window.history.replaceState(Me,document.title,window.location.href)}}catch(ge){_e.warn("Failed to restore history state:",ge)}setTimeout(()=>{Bt()},10)},[Bt]),xr=w.useCallback(()=>{const ue=Oe.current;Oe.current=null,ue?.cancel&&ue.cancel(),wt(!1)},[]);w.useCallback(()=>{_e.debug(" Showing test results..."),re("results")},[]);const Rr=w.useCallback((ue,ge,Me=null)=>{switch(_e.debug(" Formatting student answer for display:",ue,"testType:",ge,"question:",Me),ge){case us.MULTIPLE_CHOICE:if(ue.toString().startsWith("Option "))return ue;if(Me&&typeof ue=="string"&&!isNaN(parseInt(ue))){const ot=parseInt(ue),Je=`option_${String.fromCharCode(97+ot)}`,nt=Me[Je];if(nt)return _e.debug(" Converted",ue,"to option text:",nt),nt;{const mt=String.fromCharCode(65+ot);return _e.debug(" Converted",ue,"to",mt),mt}}else{if(typeof ue=="string"&&isNaN(parseInt(ue)))return _e.debug(" Already formatted text:",ue),ue;{const ot=String.fromCharCode(65+parseInt(ue));return _e.debug(" Converted",ue,"to",ot),ot}}case us.TRUE_FALSE:return ue==="true"?"True":"False";case us.INPUT:return ue;case us.MATCHING:return typeof ue=="object"?JSON.stringify(ue):ue;case us.WORD_MATCHING:return typeof ue=="object"?JSON.stringify(ue):ue;case us.DRAWING:return ue&&ue.trim()!==""?"Drawing submitted":"No drawing";case us.FILL_BLANKS:return ue;default:return _e.warn(" Unknown test type for answer formatting:",ge),ue}},[]),yr=w.useCallback((ue,ge)=>{const Me={id:Date.now(),message:ue,type:ge,timestamp:new Date};K(ot=>[...ot,Me]),setTimeout(()=>{K(ot=>ot.filter(Je=>Je.id!==Me.id))},pg.NOTIFICATION_DURATION)},[]);w.useEffect(()=>{st()},[st]),w.useEffect(()=>{if(te!=="test")return;const ue=Number(q?.allowed_time||0);if(!ue)return;const ge=setInterval(()=>{le(Me=>{const ot=Math.max(0,Me-1);try{const Je=Date.now();Ee.current||(Ee.current=Je),ie.current&&localStorage.setItem(ie.current,JSON.stringify({remainingSeconds:ot,lastTickAt:new Date(Je).toISOString(),startedAt:he?he.toISOString():new Date(Je-(ue-ot)*1e3).toISOString()}))}catch{}return ot===0&&Ue(),ot})},1e3);return()=>clearInterval(ge)},[te,q?.allowed_time,Ue,he]);const Br=w.useCallback((ue,ge)=>{if(!ue)return null;const Me=(ot,Je)=>{const nt=[...G];nt[ge]=Je,W(nt),_e.debug(` Answer changed: question ${ot} = ${Je}`),_e.debug(" Updated studentAnswers:",nt)};switch(Z.test_type){case us.TRUE_FALSE:return l.jsx(kle,{question:ue,questionIndex:ge,studentAnswer:G[ge]||"",onAnswerChange:Me,mode:"student",testId:Z?.test_id,testType:J,displayNumber:ge+1});case us.MULTIPLE_CHOICE:return l.jsx(Cle,{question:ue,questionIndex:ge,studentAnswer:G[ge]||"",onAnswerChange:Me,mode:"student",testId:Z?.test_id,testType:J,displayNumber:ge+1});case us.INPUT:return l.jsx(Tle,{question:ue,questionIndex:ge,studentAnswer:G[ge]||"",onAnswerChange:Me,mode:"student",testId:Z?.test_id,testType:J,displayNumber:ge+1});case us.MATCHING:return _e.error("Matching test reached renderQuestion - this should not happen"),l.jsxs("div",{className:"text-center p-8",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-600 mb-4",children:"Matching Test"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"Redirecting to matching test page..."}),l.jsx(at,{onClick:()=>r("/student"),variant:"primary",children:"Back to Dashboard"})]});case us.DRAWING:return l.jsx(Xhe,{question:ue,questionIndex:ge,studentAnswer:G[ge]||"",onAnswerChange:Me,mode:"student",testId:Z?.test_id,testType:J});case us.FILL_BLANKS:return ge===0?l.jsx(gme,{testText:q?.test_text,blanks:(R||[]).map((ot,Je)=>({id:ot.question_id||Je+1,options:ot.blank_options||[],correct_answer:ot.correct_answers?.[0]||ot.correct_answer,question:ot.question_json||""})),separateType:q?.separate_type,testId:Z?.test_id,testName:q?.test_name||Z?.test_name,teacherId:q?.teacher_id||Z?.teacher_id,subjectId:q?.subject_id||Z?.subject_id,onTestComplete:Ue,onAnswerChange:(ot,Je)=>{const nt=R.findIndex(mt=>mt.question_id===ot);if(nt!==-1){const mt=[...G];mt[nt]=Je,W(mt),_e.debug(` Fill Blanks answer changed: question ${ot} = ${Je}`)}}},`fill-blanks-${Z?.test_id}-${q?.test_name}`):null;default:return l.jsx("div",{children:"Unsupported question type"})}},[Z,G,J]);function me(){return!Z||!q||!R?null:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:`rounded-lg border-2 p-6 ${u?Vt(0).className:f?hr(0).className:`${h.cardBg} ${h.cardBorder}`}`,style:u?{...Vt(0).style,...g.glowRed,boxShadow:`${g.glowRed.boxShadow}, inset 0 0 20px ${bW(fe.red,.1)}`}:f?{...hr(0).style,borderColor:He.primary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:[l.jsx("div",{className:"flex justify-between items-center mb-4",children:l.jsx("h2",{className:`text-2xl font-bold ${u?"tracking-wider":h.text}`,style:u?{...g.textCyan,fontFamily:"monospace"}:f?{...g.headerText}:{},children:u?(q.test_name||q.title||"Test").toUpperCase():q.test_name||q.title||"Test"})}),l.jsx("div",{className:"mb-4",children:l.jsx(RH,{answeredCount:dt(),totalQuestions:R.length,percentage:Math.round(Q),timeElapsed:Number(q?.allowed_time||0)>0?se:0,showDetails:!0,themeClasses:h,isCyberpunk:u})})]}),l.jsxs("div",{className:`rounded-lg shadow p-6 border ${u?Vt(1).className:f?hr(1).className:`${h.cardBg} ${h.cardBorder}`}`,style:u?{...Vt(1).style,...g.glow}:f?{...hr(1).style,...g.glowPurple}:{},children:[l.jsx("h3",{className:`text-lg font-semibold ${u?"":h.text} mb-6`,style:u?{...g.textCyan,fontFamily:"monospace"}:{},children:"Answer all questions below:"}),l.jsx("div",{className:"space-y-8",children:R.map((ue,ge)=>l.jsx("div",{className:"question-container",children:Br(ue,ge)},ue.question_id||ge))})]}),l.jsx("div",{className:"flex justify-center",children:l.jsx(at,{variant:"primary",size:"lg",onClick:()=>Ve(!0),disabled:ye||dt()<R.length,loading:ye,className:"",style:u?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...g.glow}:{},children:u?ye?"SUBMITTING...":`SUBMIT TEST (${dt()}/${R.length})`:ye?"Submitting...":`Submit Test (${dt()}/${R.length})`})})]})}if(b)return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900 flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:t?"Starting Test...":"Loading Student Tests..."})]})});if(M)return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900 flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Tests Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:M}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});const Ne=n.pathname.startsWith("/student/test/");if(_e.debug(" [DEBUG] StudentTests render check - isTestRoute:",Ne,"pathname:",n.pathname,"propCurrentTest:",!!t),!Ne&&t)return _e.debug(" [DEBUG] Not on test route anymore, hiding component. Current path:",n.pathname),null;return l.jsxs("div",{className:`min-h-screen overflow-y-auto ${u?"bg-gradient-to-br from-black via-gray-900 to-purple-900":f?"bg-black":"bg-white"}`,style:u?{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"}:f?{...g.background}:{},children:[l.jsx(Ds,{isOpen:pt,onClose:xr,title:"Exit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:xr,variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:Yt,variant:"primary",children:"Go Back"})]})]})}),l.jsx(Ds,{isOpen:Te,onClose:()=>Ve(!1),title:"Submit Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>Ve(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:()=>{Ve(!1),Ue()},variant:"primary",className:"",style:u?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...g.glow}:{},children:u?"SUBMIT":"Submit"})]})]})}),te!=="results"&&l.jsx("div",{className:`${f?"":h.headerBg} border-b-2 ${f?"":h.headerBorder}`,style:u?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:f?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${h.headerText} ${u?"tracking-wider":""}`,style:u?g.textShadow:f?{...g.headerText}:{},children:u?"STUDENT TEST":"Student Test"})}),l.jsx(at,{variant:"outline",onClick:()=>{Oe.current=null,wt(!0)},className:`border-2 ${h.buttonOutline} ${u?"tracking-wider":""}`,style:u?{fontFamily:"monospace",boxShadow:"0 0 10px rgba(0, 255, 255, 0.3)",textShadow:"0 0 5px rgba(0, 255, 255, 0.5)"}:{},children:u?"BACK TO CABINET":"Back to Cabinet"})]})})}),mr&&te==="results"&&l.jsx("div",{className:"bg-red-100 border-l-4 border-red-500 p-4 mx-4 sm:mx-6 lg:mx-8 mt-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsxs("p",{className:"text-sm text-red-700",children:[l.jsx("strong",{children:"Academic Integrity Warning:"}),"This test has been flagged for suspicious behavior. You have switched tabs ",ve," times during the test."]})})]})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 overflow-y-auto",children:[!t&&te==="list"&&be(),te==="test"&&me(),te==="results"&&Ae()]}),te==="test"&&T&&l.jsxs("div",{className:"fixed inset-0 bg-white/80 backdrop-blur-[1px] flex flex-col items-center justify-center z-50",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-3 text-gray-700",children:"Preparing your test"}),E&&l.jsx("div",{className:"mt-3 text-sm text-gray-500",children:E})]}),l.jsx(SE,{isOpen:ut,onClose:()=>Qe(!1),testType:$t?.test_type,testId:$t?.test_id,testName:$t?.test_name,questions:$t?.questions,isLoading:b}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:U.map(ue=>l.jsx(bu,{type:ue.type,message:ue.message,onClose:()=>K(ge=>ge.filter(Me=>Me.id!==ue.id))},ue.id))})]});function be(){return!i||i.length===0?l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:h.textSecondary,children:"No active tests available for your class."})}):l.jsx("div",{className:"space-y-6",children:i.map((ue,ge)=>l.jsx("div",{className:`rounded-lg shadow p-6 border ${u?Vt(ge).className:`${h.cardBg} ${h.cardBorder}`}`,style:u?{...Vt(ge).style,boxShadow:ge%2===0?g.glowRed.boxShadow:g.glow.boxShadow}:{},children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:`text-lg font-semibold mb-2 ${u?"":h.text}`,style:u?{...g.textCyan,fontFamily:"monospace"}:f?{backgroundColor:He.primary,color:He.white,...g.glow}:{},children:u?ue.test_name.toUpperCase():ue.test_name}),l.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-3 gap-4 text-sm ${h.textSecondary}`,children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Subject:"})," ",ue.subject]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Teacher:"})," ",ue.teacher_name]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium",children:"Type:"})," ",ue.test_type]})]}),l.jsxs("div",{className:`mt-2 text-sm ${h.textSecondary}`,children:["Assigned: ",new Date(ue.assigned_at).toLocaleDateString()]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(at,{variant:"outline",onClick:()=>Ct(ue),disabled:j||b,children:"View Details"}),l.jsx(at,{variant:"primary",onClick:()=>Lt(ue),disabled:j||b,children:j?"Starting...":"Start Test"})]})]})},ge))})}function Ae(){if(!Z||!q||!R||!G)return null;const ue={};return G.forEach((ge,Me)=>{if(R[Me]){const ot=R[Me].question_id||R[Me].id||Me;ue[String(ot)]=ge,_e.debug(" Converting answer:",{index:Me,questionId:ot,answer:ge,question:R[Me]})}}),_e.debug(" Final answersObject:",ue),_e.debug(" Questions structure:",R.map(ge=>({id:ge.question_id,correct_answer:ge.correct_answer}))),l.jsx(ege,{testInfo:q,questions:R,testType:Z.test_type,studentAnswers:ue,onBackToCabinet:Bt,checkAnswerCorrectness:g1,formatStudentAnswerForDisplay:Rr,getCorrectAnswer:r2,caughtCheating:Ut})}},sge=()=>{const{testId:e}=E2(),t=Za(),{user:r}=ws(),{makeAuthenticatedRequest:n}=tc(),{showNotification:s}=Ls(),{theme:a,isCyberpunk:i,isLight:o,isKpop:c,themeClasses:u}=da(),d=ua(a),[f,h]=w.useState(null),[g,p]=w.useState(!0),[x,v]=w.useState(null),[C,b]=w.useState(null),[_,T]=w.useState(!1),[N,E]=w.useState(!1),F=w.useRef(null),[j,P]=w.useState(!1);D1("matching_type",f?.id);const M=w.useCallback(()=>{if(!r?.student_id||!e)return!1;const re=`test_completed_${r.student_id}_matching_type_${e}`,Z=localStorage.getItem(re)==="true",B=`retest1_${r.student_id}_matching_type_${e}`,J=localStorage.getItem(B)==="true";return Z&&!J?(_e.debug(" Test already completed, redirecting to cabinet"),s("This test has already been completed","info"),t("/student"),!0):!1},[r?.student_id,e,t,s]),I=w.useCallback(async()=>{if(!e){v("Test ID is required"),p(!1);return}if(!M())try{p(!0),v(null);const re=await n(`/.netlify/functions/get-matching-type-test?test_id=${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!re.ok)throw new Error("Failed to load test data");const Z=await re.json();if(!Z.success)throw new Error(Z.message||"Failed to load test");const B=Z.data;_e.debug(" Test data from get-matching-type-test:",B);const J=await n(`/.netlify/functions/get-test-questions?test_id=${e}&test_type=matching_type`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!J.ok)throw new Error("Failed to load test questions");const z=await J.json();if(!z.success)throw new Error(z.message||"Failed to load test questions");_e.debug(" Questions data from get-test-questions:",z);const q={id:B.test_id,test_name:B.test_name,teacher_id:B.teacher_id,subject_id:B.subject_id,image_url:B.image_url,image:null,blocks:(()=>{if(Array.isArray(z.questions)&&z.questions.length>0){const H=z.questions[0];return Array.isArray(H.blocks)?H.blocks.map((R,L)=>{let G=R.block_coordinates||R.coordinates||(typeof R.x=="number"?{x:R.x,y:R.y,width:R.width,height:R.height}:null);if(typeof G=="string")try{G=JSON.parse(G)}catch{G=null}return(!G||typeof G!="object")&&(G={x:0,y:0,width:30,height:10}),G={x:(typeof G.x=="number"?G.x:Number(G.x))||0,y:(typeof G.y=="number"?G.y:Number(G.y))||0,width:(typeof G.width=="number"?G.width:Number(G.width))||30,height:(typeof G.height=="number"?G.height:Number(G.height))||10},{id:R.block_id||R.question_id||R.id||L+1,word:R.word||`Word ${L+1}`,coordinates:G,hasArrow:!!R.has_arrow,arrow:R.arrow||null}}):z.questions.map(R=>{_e.debug(" Processing question:",R);let L;try{L=typeof R.block_coordinates=="string"?JSON.parse(R.block_coordinates):R.block_coordinates}catch{L={x:0,y:0,width:100,height:100}}return(!L||typeof L!="object")&&(L={x:0,y:0,width:100,height:100}),L={x:(typeof L.x=="number"?L.x:Number(L.x))||0,y:(typeof L.y=="number"?L.y:Number(L.y))||0,width:(typeof L.width=="number"?L.width:Number(L.width))||100,height:(typeof L.height=="number"?L.height:Number(L.height))||100},{id:R.question_id,word:R.word,coordinates:L,hasArrow:R.has_arrow,arrow:R.arrow}})}return[]})(),words:(()=>{if(Array.isArray(z.questions)&&z.questions.length>0){const H=z.questions[0];if(Array.isArray(H.words)){const R=H.words,L=Array.isArray(H.blocks)?H.blocks:[];return typeof R[0]=="string"?R.map((W,Q)=>({id:`w_${L[Q]?.question_id||L[Q]?.block_id||z.questions[Q]?.question_id||Q+1}_${Q}`,word:String(W),blockId:null,isPlaced:!1,isCorrect:!1})):R.map((W,Q)=>({id:`w_${W.question_id||W.id||Q+1}_${Q}`,word:W.word||String(W.text||""),blockId:null,isPlaced:!1,isCorrect:!1}))}return z.questions.map(R=>({id:`w_${R.question_id}`,word:R.word,blockId:null,isPlaced:!1,isCorrect:!1}))}return[]})(),arrows:B.arrows?B.arrows.map(H=>(_e.debug(" Processing arrow:",H),{id:H.id,questionId:H.question_id,blockId:H.block_id||H.question_id,start:{x:Number(H.start_x)||0,y:Number(H.start_y)||0},end:{x:Number(H.end_x)||0,y:Number(H.end_y)||0},rel_start_x:H.rel_start_x!==null?Number(H.rel_start_x):null,rel_start_y:H.rel_start_y!==null?Number(H.rel_start_y):null,rel_end_x:H.rel_end_x!==null?Number(H.rel_end_x):null,rel_end_y:H.rel_end_y!==null?Number(H.rel_end_y):null,image_width:H.image_width?Number(H.image_width):null,image_height:H.image_height?Number(H.image_height):null,style:(typeof H.style=="string"?JSON.parse(H.style):H.style)||{color:"#dc3545",thickness:3}})):[]};if(B.image_url){const H=new Image;H.crossOrigin="anonymous",H.onload=()=>{q.image=H,h(q),p(!1)},H.onerror=()=>{_e.warn("Failed to load test image"),h(q),p(!1)},H.src=B.image_url}else h(q),p(!1)}catch(re){_e.error("Error loading test data:",re),v(re.message||"Failed to load test"),p(!1)}},[e,n]);w.useEffect(()=>{r?.student_id&&I()},[I,r?.student_id]);const U=w.useCallback(async re=>{_e.debug("Test completed:",re),s("Test completed successfully!","success");const Z=parseInt(re)||0,B=f?.blocks?.length||f?.words?.length||0,J=B>0?Math.round(Z/B*100):0,z={showResults:!0,testInfo:{test_name:f?.test_name||"Test",id:f?.id,test_id:f?.id},testType:"matching_type",score:Z,totalQuestions:B,percentage:J,passed:J>=60,questionAnalysis:f?.questions?.map((q,H)=>({questionNumber:H+1,isCorrect:H<Z,userAnswer:H<Z?`Matched: ${q.word}`:"Not answered",correctAnswer:`Match: ${q.word}`}))||Array.from({length:B},(q,H)=>({questionNumber:H+1,isCorrect:H<Z,userAnswer:H<Z?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};_e.debug(" Using test results data:",z),b(z),T(!0)},[f,s]),K=w.useCallback(()=>{E(!1),F.current=null,t("/student")},[t]);I2(N&&_,w.useCallback(({confirm:re,cancel:Z})=>{F.current={confirm:re,cancel:Z},P(!0)},[])),w.useEffect(()=>{_?E(!0):(E(!1),F.current=null)},[_]),w.useCallback(()=>{P(!1);const re=F.current;if(F.current=null,E(!1),re)try{const Z=window.history.state;if(Z&&Z.__intercept){const B=Z.prevState??null;window.history.replaceState(B,document.title,window.location.href)}}catch(Z){_e.warn("Failed to restore history state:",Z)}setTimeout(()=>{b(null),T(!1),t("/student")},10)},[t]),w.useCallback(()=>{const re=F.current;F.current=null,re?.cancel&&re.cancel(),P(!1)},[]);const te=w.useCallback(()=>{T(!1),b(null),I()},[I]);return g?l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900 flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsx(Kt,{className:"max-w-md w-full",children:l.jsxs(Kt.Body,{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading test..."})]})})}):x?l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900 flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsx(Kt,{className:"max-w-md w-full",children:l.jsxs(Kt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:x}),l.jsx("button",{onClick:K,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})}):f?_&&C?l.jsx("div",{className:`overflow-y-auto min-h-screen ${i?"bg-gradient-to-br from-black via-gray-900 to-purple-900":c?"bg-black":"bg-white"}`,style:i?{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"}:c?{backgroundColor:He.backgroundSecondary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.4), 0 0 60px rgba(236, 72, 153, 0.2)"}:{},children:l.jsx(Q2,{testResults:C,onBackToCabinet:()=>{E(!1),F.current=null,b(null),T(!1),t("/student")},onRetakeTest:te,isLoading:!1})}):l.jsx("div",{className:`min-h-screen ${i?"bg-gradient-to-br from-black via-gray-900 to-purple-900":c?"bg-black":"bg-white"}`,style:i?d.background:c?{backgroundColor:He.backgroundSecondary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.4), 0 0 60px rgba(236, 72, 153, 0.2)"}:{},children:l.jsx(Jue,{testData:f,onTestComplete:U,onBackToCabinet:K})}):l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900 flex items-center justify-center",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsx(Kt,{className:"max-w-md w-full",children:l.jsxs(Kt.Body,{className:"text-center",children:[l.jsx("div",{className:"text-gray-500 text-6xl mb-4",children:""}),l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Test Data"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to load test data"}),l.jsx("button",{onClick:K,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Dashboard"})]})})})},age=()=>{const{testId:e}=E2(),t=Za(),{user:r}=ws(),{makeAuthenticatedRequest:n}=tc(),{showNotification:s}=Ls(),{theme:a,isCyberpunk:i,isLight:o,isKpop:c,themeClasses:u}=da(),d=ua(a),[f,h]=w.useState(null),[g,p]=w.useState(!0),[x,v]=w.useState(null),[C,b]=w.useState(null),[_,T]=w.useState(!1),N=w.useCallback(()=>{if(!r?.student_id||!e)return!1;const P=`test_completed_${r.student_id}_word_matching_${e}`,M=`retest1_${r.student_id}_word_matching_${e}`;return localStorage.getItem(M)==="true"?!1:localStorage.getItem(P)==="true"},[r?.student_id,e]),E=w.useCallback(async()=>{if(!e){v("Test ID is required"),p(!1);return}if(N()){s("This test has already been completed","warning"),t("/student");return}p(!0),v(null);try{const P=`word_matching_test_${e}`,M=Os(P);if(M){if(_e.debug(" Word matching test loaded from cache:",M),M.id){let K=M,te=Array.isArray(K.correctPairs)?K.correctPairs:K.correctPairs&&typeof K.correctPairs=="object"?Object.keys(K.correctPairs).map(re=>[Number(re),K.correctPairs[re]]).sort((re,Z)=>re[0]-Z[0]).map(([,re])=>re):null;if(Array.isArray(K.leftWords)&&Array.isArray(K.rightWords)&&Array.isArray(te)){const re=K.rightWords.map((H,R)=>R),Z=K.leftWords.map((H,R)=>R);for(let H=re.length-1;H>0;H--){const R=Math.floor(Math.random()*(H+1));[re[H],re[R]]=[re[R],re[H]]}for(let H=Z.length-1;H>0;H--){const R=Math.floor(Math.random()*(H+1));[Z[H],Z[R]]=[Z[R],Z[H]]}const B=re.map(H=>K.rightWords[H]),J=Z.map(H=>K.leftWords[H]),z=new Map(re.map((H,R)=>[H,R])),q=Z.map(H=>{const R=te[H];return z.get(R)});K={...K,leftWords:J,rightWords:B,correctPairs:q}}h(K)}else{let te={id:M.test_id,test_id:M.test_id,test_name:M.test_name,teacher_id:M.teacher_id,subject_id:M.subject_id,num_questions:M.num_questions,interaction_type:M.interaction_type,passing_score:M.passing_score,allowed_time:M.allowed_time,created_at:M.created_at,updated_at:M.updated_at,leftWords:M.leftWords,rightWords:M.rightWords,correctPairs:M.correctPairs,originalPairs:M.originalPairs},re=Array.isArray(te.correctPairs)?te.correctPairs:te.correctPairs&&typeof te.correctPairs=="object"?Object.keys(te.correctPairs).map(Z=>[Number(Z),te.correctPairs[Z]]).sort((Z,B)=>Z[0]-B[0]).map(([,Z])=>Z):null;if(Array.isArray(te.leftWords)&&Array.isArray(te.rightWords)&&Array.isArray(re)){const Z=te.rightWords.map((R,L)=>L),B=te.leftWords.map((R,L)=>L);for(let R=Z.length-1;R>0;R--){const L=Math.floor(Math.random()*(R+1));[Z[R],Z[L]]=[Z[L],Z[R]]}for(let R=B.length-1;R>0;R--){const L=Math.floor(Math.random()*(R+1));[B[R],B[L]]=[B[L],B[R]]}const J=Z.map(R=>te.rightWords[R]),z=B.map(R=>te.leftWords[R]),q=new Map(Z.map((R,L)=>[R,L])),H=B.map(R=>{const L=re[R];return q.get(L)});te={...te,leftWords:z,rightWords:J,correctPairs:H}}h(te)}p(!1);return}const U=await(await n(`/.netlify/functions/get-word-matching-test?test_id=${e}`)).json();if(U.success){const K={id:U.data.test_id,test_id:U.data.test_id,test_name:U.data.test_name,teacher_id:U.data.teacher_id,subject_id:U.data.subject_id,num_questions:U.data.num_questions,interaction_type:U.data.interaction_type,passing_score:U.data.passing_score,allowed_time:U.data.allowed_time,created_at:U.data.created_at,updated_at:U.data.updated_at,leftWords:U.data.leftWords,rightWords:U.data.rightWords,correctPairs:U.data.correctPairs,originalPairs:U.data.originalPairs};let te=K,re=Array.isArray(te.correctPairs)?te.correctPairs:te.correctPairs&&typeof te.correctPairs=="object"?Object.keys(te.correctPairs).map(Z=>[Number(Z),te.correctPairs[Z]]).sort((Z,B)=>Z[0]-B[0]).map(([,Z])=>Z):null;if(Array.isArray(te.leftWords)&&Array.isArray(te.rightWords)&&Array.isArray(re)){const Z=te.rightWords.map((R,L)=>L),B=te.leftWords.map((R,L)=>L);for(let R=Z.length-1;R>0;R--){const L=Math.floor(Math.random()*(R+1));[Z[R],Z[L]]=[Z[L],Z[R]]}for(let R=B.length-1;R>0;R--){const L=Math.floor(Math.random()*(R+1));[B[R],B[L]]=[B[L],B[R]]}const J=Z.map(R=>te.rightWords[R]),z=B.map(R=>te.leftWords[R]),q=new Map(Z.map((R,L)=>[R,L])),H=B.map(R=>{const L=re[R];return q.get(L)});te={...te,leftWords:z,rightWords:J,correctPairs:H}}h(te),vs(P,te,hs.word_matching_test),_e.debug(" Word matching test loaded from API and cached:",K)}else throw new Error(U.message||"Failed to load test")}catch(P){_e.error("Error loading word matching test:",P),v(P.message),s("Failed to load test: "+P.message,"error")}finally{p(!1)}},[e,N,n,s,t]),F=w.useCallback(async P=>{_e.debug("Test completed:",P),s("Test completed successfully!","success");const M=typeof P=="object"?parseInt(P.score)||0:parseInt(P)||0,I=typeof P=="object"&&P.caught_cheating||!1,U=typeof P=="object"&&P.visibility_change_times||0,K=f?.num_questions||0,te=K>0?Math.round(M/K*100):0,re={showResults:!0,testInfo:{test_name:f?.test_name||"Test",id:f?.id,test_id:f?.id},testType:"word_matching",score:M,totalQuestions:K,percentage:te,passed:te>=60,questionAnalysis:Array.isArray(f?.correctPairs)?f.correctPairs.map((Z,B)=>({questionNumber:B+1,isCorrect:B<M,userAnswer:B<M?`${Z.left}  ${Z.right}`:"Not answered",correctAnswer:`${Z.left}  ${Z.right}`})):Array.from({length:K},(Z,B)=>({questionNumber:B+1,isCorrect:B<M,userAnswer:B<M?"Matched":"Not answered",correctAnswer:"Match required"})),timestamp:new Date().toISOString(),caught_cheating:I,visibility_change_times:U};_e.debug(" Using test results data:",re),b(re),T(!0)},[f,s]),j=w.useCallback(()=>{t("/student")},[t]);return w.useEffect(()=>{E()},[E]),g?l.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsxs(Kt,{className:"p-8 text-center",children:[l.jsx(Xr,{size:"lg",className:"mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading word matching test..."})]})}):x?l.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsx(Kt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-red-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Error Loading Test"}),l.jsx("p",{className:"text-gray-600 mb-4",children:x}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})}):f?_&&C?l.jsx("div",{className:`overflow-y-auto min-h-screen ${i?"bg-gradient-to-br from-black via-gray-900 to-purple-900":c?"bg-black":"bg-white"}`,style:i?{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"}:c?{backgroundColor:He.backgroundSecondary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.4), 0 0 60px rgba(236, 72, 153, 0.2)"}:{},children:l.jsx(Q2,{testResults:C,onBackToCabinet:()=>{b(null),T(!1),t("/student")},onRetakeTest:(P,M)=>{b(null),T(!1),E()},isLoading:!1,caught_cheating:C.caught_cheating||!1,visibility_change_times:C.visibility_change_times||0})}):l.jsx(Ze.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:`min-h-screen py-8 ${i?"bg-gradient-to-br from-black via-gray-900 to-purple-900":c?"bg-black":"bg-white"}`,style:i?d.background:c?{backgroundColor:He.backgroundSecondary,boxShadow:"0 0 30px rgba(236, 72, 153, 0.4), 0 0 60px rgba(236, 72, 153, 0.2)"}:{},children:l.jsx(ede,{testData:f,onTestComplete:F,onBackToCabinet:j})}):l.jsx("div",{className:"flex justify-center items-center min-h-screen bg-gradient-to-br from-black via-gray-900 to-purple-900",style:{backgroundImage:"radial-gradient(circle at 20% 50%, rgba(255, 215, 0, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 255, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%)"},children:l.jsx(Kt,{className:"p-8 text-center",children:l.jsxs("div",{className:"text-gray-600 mb-4",children:[l.jsx("svg",{className:"w-16 h-16 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),l.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Test Not Found"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"The requested test could not be found."}),l.jsx("button",{onClick:()=>t("/student"),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Back to Cabinet"})]})})})},ige=w.forwardRef(({onRecordingComplete:e,minDuration:t=0,maxDuration:r=600,minWords:n=50,maxAttempts:s=3,currentAttempt:a=1},i)=>{const{theme:o,isCyberpunk:c,isKpop:u,themeClasses:d}=da(),f=ua(o),[h,g]=w.useState(!1),[p,x]=w.useState(!1),[v,C]=w.useState(0),[b,_]=w.useState(null),[T,N]=w.useState(null),[E,F]=w.useState("good"),[j,P]=w.useState(!1),[M,I]=w.useState(null),U=w.useRef(null),K=w.useRef([]),te=w.useRef(null),re=w.useRef(null),Z=w.useRef(null),B=w.useRef(null),J=w.useRef(null);w.useImperativeHandle(i,()=>({startRecording:()=>z(),stopRecording:()=>q(),pauseRecording:()=>L(),resumeRecording:()=>G()}));const z=w.useCallback(async()=>{try{if(N(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");if(!window.isSecureContext&&!window.location.hostname.includes("localhost"))throw new Error("Microphone access requires HTTPS. Please use a secure connection.");const le=window.AudioContext||window.webkitAudioContext;Z.current||(Z.current=new le),Z.current.state!=="running"&&await Z.current.resume().catch(()=>{}),console.log(" Requesting microphone permission...");const he=await navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1,noiseSuppression:!1,autoGainControl:!1,channelCount:1}});console.log(" Microphone permission granted"),te.current=he;try{let Ie=document.getElementById("ios-audio-sink");Ie||(Ie=document.createElement("audio"),Ie.id="ios-audio-sink",Ie.muted=!0,Ie.playsInline=!0,Ie.style.display="none",document.body.appendChild(Ie)),Ie.srcObject=he,await Ie.play().catch(()=>{})}catch{}const we=Z.current.createAnalyser();Z.current.createMediaStreamSource(he).connect(we),we.fftSize=256,B.current=we,W();let Ee="audio/webm;codecs=opus";typeof MediaRecorder<"u"&&MediaRecorder.isTypeSupported&&!MediaRecorder.isTypeSupported(Ee)&&(MediaRecorder.isTypeSupported("audio/mp4")?Ee="audio/mp4":MediaRecorder.isTypeSupported("audio/aac")?Ee="audio/aac":Ee="");const ye=new MediaRecorder(he,Ee?{mimeType:Ee}:void 0);U.current=ye,K.current=[],ye.ondataavailable=Ie=>{Ie.data.size>0&&K.current.push(Ie.data)},ye.onstop=async()=>{const Ie=Ee&&Ee.startsWith("audio/")?Ee:"audio/webm",ut=new Blob(K.current,{type:Ie});_(ut),I(ut),P(!0),te.current&&te.current.getTracks().forEach(Qe=>Qe.stop()),J.current&&cancelAnimationFrame(J.current)},ye.start(),g(!0),C(0),re.current=setInterval(()=>{C(Ie=>{const ut=Ie+1;return ut>=r&&q(),ut})},1e3)}catch(le){console.error("Error starting recording:",le);const he=/iPad|iPhone|iPod/.test(navigator.userAgent)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1;le.name==="NotAllowedError"?N(he?"Microphone access denied. Please go to Settings > Safari > Microphone and allow access, then refresh the page.":"Microphone access denied. Please allow microphone access in your browser settings and try again."):le.name==="NotFoundError"?N("No microphone found. Please connect a microphone and try again."):le.name==="NotSupportedError"?N("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox."):le.message.includes("HTTPS")?N("Microphone access requires HTTPS. Please use a secure connection."):N(`Failed to access microphone: ${le.message}`)}},[r]),q=w.useCallback(()=>{if(U.current&&h&&(U.current.stop(),g(!1),x(!1),re.current&&clearInterval(re.current),v<t)){N(`Recording must be at least ${t} seconds long.`);return}},[h,v,t]),H=w.useCallback(()=>{M&&(e(M,v),P(!1),I(null))},[M,v,e]),R=w.useCallback(()=>{P(!1),I(null),_(null),N(null),C(0)},[]),L=w.useCallback(()=>{U.current&&h&&!p&&(U.current.pause(),x(!0),re.current&&clearInterval(re.current))},[h,p]),G=w.useCallback(()=>{U.current&&h&&p&&(U.current.resume(),x(!1),re.current=setInterval(()=>{C(le=>{const he=le+1;return he>=r&&q(),he})},1e3))},[h,p,r,q]),W=w.useCallback(()=>{if(!B.current)return;const le=B.current,he=new Uint8Array(le.frequencyBinCount),we=()=>{le.getByteFrequencyData(he);const ie=he.reduce((Ee,ye)=>Ee+ye,0)/he.length;ie<10?F("poor"):ie<30?F("fair"):F("good"),h&&(J.current=requestAnimationFrame(we))};we()},[h]),Q=le=>{const he=Math.floor(le/60),we=le%60;return`${he}:${we.toString().padStart(2,"0")}`},X=()=>{switch(E){case"poor":return"text-red-600";case"fair":return"text-yellow-600";case"good":return"text-green-600";default:return"text-gray-600"}},se=()=>{switch(E){case"poor":return"Poor audio quality - speak closer to microphone";case"fair":return"Fair audio quality - good for recording";case"good":return"Excellent audio quality";default:return"Monitoring audio quality..."}};return l.jsxs("div",{className:`audio-recorder rounded-lg shadow-lg py-3 px-0 sm:p-6 ${c?Vt(1).className:u?hr(1).className:"bg-white"}`,style:c?{...Vt(1).style,...f.glow}:u?{...hr(1).style,borderColor:He.primary}:{},children:[l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("h3",{className:"text-xl font-semibold mb-2 ",style:c?{...f.textCyan,fontFamily:"monospace"}:u?{...f.headerText}:{},children:c?"RECORD YOUR RESPONSE":"Record Your Response"}),l.jsx("p",{className:c?"":"text-gray-600",style:c?{color:fe.cyan,fontFamily:"monospace"}:u?{...f.textAccent}:{},children:c?"SPEAK CLEARLY AND AT A NORMAL PACE. YOU CAN PAUSE AND RESUME IF NEEDED.":"Speak clearly and at a normal pace. You can pause and resume if needed."})]}),l.jsxs("div",{className:"text-center mb-6",children:[l.jsx("div",{className:`text-4xl font-bold mb-2 ${c||u?"":"text-blue-600"}`,style:c?{...f.textCyan,fontFamily:"monospace"}:u?{...f.textPink}:{},children:Q(v)}),l.jsx("div",{className:`text-sm ${u?"":X()}`,style:c?{color:fe.cyan,fontFamily:"monospace"}:u?{color:E==="good"?He.success:E==="fair"?He.primary:He.error,...f.textShadow}:{},children:se()}),p&&l.jsx("div",{className:`font-semibold mt-2 ${c||u?"":"text-yellow-600"}`,style:c?{color:fe.yellow,fontFamily:"monospace",...f.textShadowYellow}:u?{color:He.primary,...f.textShadow}:{},children:c?" RECORDING PAUSED":" Recording Paused"})]}),h&&l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"flex justify-center items-center space-x-1 h-8",children:Array.from({length:20},(le,he)=>l.jsx("div",{className:"bg-blue-400 rounded-sm",style:{width:"4px",height:`${Math.random()*20+4}px`,animation:"pulse 0.5s ease-in-out infinite"}},he))})}),l.jsx("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center mb-6",children:!h&&!j?l.jsx("button",{onClick:z,className:`w-full sm:w-auto ${u?"bg-pink-500 hover:bg-pink-600":c?"bg-red-600 hover:bg-red-700 font-mono":"bg-red-600 hover:bg-red-700"} text-white px-6 py-4 rounded-full flex items-center justify-center min-h-[48px] text-lg font-semibold`,style:c?{...f.glowRed}:u?{...f.shadow}:{},children:l.jsx("span",{children:c?"START RECORDING":"Start Recording"})}):h?l.jsx("button",{onClick:q,className:`w-full sm:w-auto ${c?"bg-gray-600 hover:bg-gray-700 font-mono":"bg-gray-600 hover:bg-gray-700"} text-white px-6 py-4 rounded-full flex items-center justify-center min-h-[48px] text-lg font-semibold`,style:c?{...f.glow}:u?{...f.shadow}:{},children:l.jsx("span",{children:c?"STOP":"Stop"})}):j?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:R,className:`w-full sm:w-auto ${c?"bg-yellow-600 hover:bg-yellow-700 font-mono":u?"bg-yellow-500 hover:bg-yellow-600":"bg-yellow-600 hover:bg-yellow-700"} text-white px-6 py-4 rounded-full flex items-center justify-center min-h-[48px] text-lg font-semibold`,style:c?{...f.glowYellow}:u?{...f.shadow}:{},children:l.jsx("span",{children:c?"RERECORD":"Rerecord"})}),l.jsx("button",{onClick:H,className:`w-full sm:w-auto ${c?"bg-green-600 hover:bg-green-700 font-mono":u?"bg-green-500 hover:bg-green-600":"bg-green-600 hover:bg-green-700"} text-white px-6 py-4 rounded-full flex items-center justify-center min-h-[48px] text-lg font-semibold`,style:c?{...f.glowGreen}:u?{...f.shadow}:{},children:l.jsx("span",{children:c?"SEND":"Send"})})]}):null}),T&&l.jsx("div",{className:`mt-4 py-3 px-0 sm:p-4 ${u?"bg-red-500/10 border border-red-500/50":"bg-red-50 border border-red-200"} rounded-lg`,style:u?{...f.glowRed}:{},children:l.jsx("p",{className:u?"text-red-400":"text-red-800",style:u?{color:He.error,...f.textShadowRed}:{},children:T})}),l.jsxs("div",{className:`mt-4 text-center text-sm ${c||u?"":"text-gray-600"}`,style:c?{color:fe.cyan,fontFamily:"monospace"}:u?{...f.textAccent}:{},children:[c?`ATTEMPT ${a} OF ${s}`:`Attempt ${a} of ${s}`,a<s&&l.jsx("span",{className:`ml-2 ${c||u?"":"text-blue-600"}`,style:c?{color:fe.cyan,fontFamily:"monospace"}:u?{color:He.primary,...f.textShadow}:{},children:c?"(YOU CAN RE-RECORD IF NEEDED)":"(You can re-record if needed)"})]})]})}),KV=({audioBlob:e,audioUrl:t,recordingTime:r,className:n=""})=>{const{theme:s,isCyberpunk:a,themeClasses:i}=da(),o=ua(s),c=typeof window<"u"&&window.location.pathname.includes("/student"),u=a&&c,[d,f]=w.useState(!1),[h,g]=w.useState(0),[p,x]=w.useState(0),[v,C]=w.useState(1),[b,_]=w.useState(1),[T,N]=w.useState(!0),[E,F]=w.useState(""),[j,P]=w.useState(!1),[M,I]=w.useState(null),[U,K]=w.useState(!1),te=w.useRef(null),re=w.useRef(null),Z=w.useRef(!1);w.useEffect(()=>()=>{Z.current=!0},[]),w.useEffect(()=>{let W=!1;if(t)W||F(t);else if(e){if(!e||e.size===0){W||N(!1);return}if(!(e instanceof Blob)){console.error("audioBlob is not a Blob:",typeof e,e),W||N(!1);return}const Q=URL.createObjectURL(e);return W||F(Q),()=>{W=!0,URL.revokeObjectURL(Q)}}return()=>{W=!0}},[e,t]),w.useEffect(()=>{let W=!1;const Q=se=>{try{const le=new URL(se);return/\/storage\/v1\/object\/public\//.test(le.pathname)}catch{return!1}};async function X(se){if(!se)return null;if(/\/object\/sign\//.test(se)||!Q(se))return se;try{const he=new URL(se).pathname.replace(/^\/storage\/v1\/object\/public\//,""),we=he.split("/")[0],ie=he.substring(we.length+1),Ee=await fetch(`/.netlify/functions/get-speaking-test-new?action=sign-audio&bucket=${encodeURIComponent(we)}&file_path=${encodeURIComponent(ie)}`);if(Ee.ok){const{url:ye}=await Ee.json();return!W&&!Z.current&&(K(!0),F(ye)),ye}}catch(le){console.error("Failed to get signed URL:",le)}return null}return(async()=>{if(t){const se=await X(t);se&&!W&&!Z.current?F(se):!Q(t)&&!W&&!Z.current&&F(t)}})(),()=>{W=!0}},[t]),w.useEffect(()=>{let W=!1;return E&&(W||(P(!1),I(null),N(!0))),()=>{W=!0}},[E]),w.useEffect(()=>{if(te.current&&E){const W=te.current;let Q=!1;try{W.src=E}catch{}W.load();const X=()=>{if(Q||Z.current)return;let $t=W.duration;if($t===1/0)try{W.currentTime=1e101,W.ontimeupdate=()=>{if(Q||Z.current)return;W.ontimeupdate=null;const Ge=W.duration;Q||(x(isFinite(Ge)&&Ge>0?Ge:0),W.currentTime=0,N(!1))};return}catch(Ge){console.warn("Seek trick failed:",Ge)}if(isNaN($t)||!isFinite($t)||$t<=0){const Ge=W.seekable&&W.seekable.length>0&&isFinite(W.seekable.end(0)),et=!Ge&&W.buffered&&W.buffered.length>0&&isFinite(W.buffered.end(W.buffered.length-1));Ge?$t=W.seekable.end(0):et&&($t=W.buffered.end(W.buffered.length-1))}isNaN($t)||!isFinite($t)||$t<=0?(console.warn("Invalid audio duration after fallbacks:",$t),r&&r>0?Q||x(r):Q||x(0)):Q||x($t),Q||N(!1)},se=()=>{Q||Z.current||X()},le=()=>{Q||Z.current||X()},he=()=>{Q||Z.current||X()},we=()=>{Q||Z.current||X()},ie=()=>{Q||Z.current||g(W.currentTime)},Ee=()=>{Q||Z.current||(f(!1),g(0))},ye=()=>{Q||Z.current||f(!0)},Ie=()=>{Q||Z.current||f(!1)},ut=$t=>{if(Q||Z.current)return;console.error("Audio loading error:",$t),console.error("Audio error details:",{error:W.error,networkState:W.networkState,readyState:W.readyState,src:W.src,currentSrc:W.currentSrc});const Ge=W.error?.code;Ge===4&&P(!0),I(W.error||{code:Ge}),N(!1)},Qe=setTimeout(()=>{Q||Z.current||W.readyState===0&&N(!1)},6e3);return W.addEventListener("loadedmetadata",se),W.addEventListener("durationchange",le),W.addEventListener("canplay",he),W.addEventListener("canplaythrough",we),W.addEventListener("timeupdate",ie),W.addEventListener("ended",Ee),W.addEventListener("play",ye),W.addEventListener("pause",Ie),W.addEventListener("error",ut),()=>{Q=!0,clearTimeout(Qe),W.removeEventListener("loadedmetadata",se),W.removeEventListener("durationchange",le),W.removeEventListener("canplay",he),W.removeEventListener("canplaythrough",we),W.removeEventListener("timeupdate",ie),W.removeEventListener("ended",Ee),W.removeEventListener("play",ye),W.removeEventListener("pause",Ie),W.removeEventListener("error",ut),W.pause(),W.src="",W.load()}}},[E,r]),w.useEffect(()=>{let W=!1;return r&&r>0&&(isNaN(p)||!isFinite(p)||p<=0)&&(W||x(r)),()=>{W=!0}},[r,p]);const B=()=>{te.current&&(d?te.current.pause():te.current.play().catch(W=>{console.error("Play failed:",W)}))},J=W=>{if(te.current&&re.current&&p>0){const Q=re.current.getBoundingClientRect(),X=W.clientX-Q.left,se=Q.width,le=Math.max(0,Math.min(p,X/se*p));isFinite(le)&&le>=0&&(te.current.currentTime=le,g(le))}},z=W=>{const Q=parseFloat(W.target.value);C(Q),te.current&&(te.current.volume=Q)},q=W=>{const Q=parseFloat(W.target.value);_(Q),te.current&&(te.current.playbackRate=Q)},H=W=>{if(isNaN(W))return"0:00";const Q=Math.floor(W/60),X=Math.floor(W%60);return`${Q}:${X.toString().padStart(2,"0")}`};if(!e&&!t)return l.jsx("div",{className:`audio-player ${n} ${u?Vt(0).className:""}`,style:u?{...Vt(0).style,...o.glow}:{},children:l.jsx("div",{className:`text-center py-8 ${u?"":"text-gray-500"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?"NO AUDIO AVAILABLE":"No audio available"})});const L=(W=>{try{const X=(W||"").toLowerCase().split("?")[0].split("#")[0];return X.endsWith(".webm")?"audio/webm":X.endsWith(".mp3")?"audio/mpeg":X.endsWith(".m4a")?"audio/mp4":X.endsWith(".aac")?"audio/aac":X.endsWith(".wav")?"audio/wav":void 0}catch{return}})(E||t),G=Rs.useMemo(()=>typeof window>"u"?!0:document.createElement("audio").canPlayType("audio/webm")!=="",[]);return l.jsxs("div",{className:`audio-player rounded-lg p-4 ${n} ${u?Vt(0).className:"bg-gray-50"}`,style:u?{...Vt(0).style,...o.glow}:{},children:[l.jsx("audio",{ref:te,preload:"metadata",controls:!1,style:{display:"none"},crossOrigin:"anonymous",children:l.jsx("source",{src:E,type:L})}),T?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("div",{className:`inline-block animate-spin rounded-full h-6 w-6 border-b-2 ${u?"":"border-blue-600"}`,style:u?{borderColor:fe.cyan}:{}}),l.jsx("p",{className:`text-sm mt-2 ${u?"":"text-gray-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?"LOADING AUDIO...":"Loading audio..."})]}):j?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:`text-sm ${u?"":"text-red-600"}`,style:u?{color:fe.red,fontFamily:"monospace",...o.textShadowRed}:{},children:u?"THIS AUDIO FORMAT ISN'T SUPPORTED BY YOUR BROWSER.":"This audio format isn't supported by your browser."}),E?l.jsx("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:`underline text-sm ${u?"":"text-blue-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace",...o.textShadow}:{},children:u?"OPEN IN NEW TAB":"Open in new tab"}):null,L?l.jsx("p",{className:`text-xs mt-1 ${u?"":"text-gray-500"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?`DETECTED TYPE: ${L}`:`Detected type: ${L}`}):null,l.jsx("p",{className:`text-xs mt-1 ${u?"":"text-gray-500"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?`BROWSER WEBM SUPPORT: ${G?"YES":"NO"}${G?"":" - TRY USING CHROME, FIREFOX, OR EDGE"}`:`Browser WebM support: ${G?"Yes":"No"}${G?"":" - Try using Chrome, Firefox, or Edge"}`}),l.jsx("p",{className:`text-xs mt-1 ${u?"":"text-gray-500"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?"PREFERRED FORMAT: WEBM":"Preferred format: WebM"})]}):M?l.jsxs("div",{className:"text-center py-4",children:[l.jsx("p",{className:`text-sm ${u?"":"text-red-600"}`,style:u?{color:fe.red,fontFamily:"monospace",...o.textShadowRed}:{},children:u?"PLAYBACK FAILED. PLEASE TRY OPENING THE AUDIO DIRECTLY.":"Playback failed. Please try opening the audio directly."}),E?l.jsx("a",{href:E,target:"_blank",rel:"noopener noreferrer",className:`underline text-sm ${u?"":"text-blue-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace",...o.textShadow}:{},children:u?"OPEN IN NEW TAB":"Open in new tab"}):null,L?l.jsx("p",{className:`text-xs mt-1 ${u?"":"text-gray-500"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?`DETECTED TYPE: ${L}`:`Detected type: ${L}`}):null]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"mb-4",children:[l.jsx("div",{ref:re,className:`w-full rounded-full cursor-pointer transition-all ${u?"bg-gray-800 border-2 border-gray-700":"bg-gray-200 border-2 border-gray-300"}`,style:u?{...o.glow,height:"8px",minHeight:"8px"}:{height:"8px",minHeight:"8px",boxShadow:"inset 0 1px 2px rgba(0, 0, 0, 0.1)"},onClick:J,children:l.jsx("div",{className:`rounded-full transition-all ${u?"":"bg-blue-600"}`,style:u?{backgroundColor:fe.cyan,width:`${h/p*100}%`,height:"4px",boxShadow:`0 0 8px ${fe.cyan}`,marginTop:"2px"}:{width:`${h/p*100}%`,height:"4px",marginTop:"2px",boxShadow:"0 1px 3px rgba(37, 99, 235, 0.4)"}})}),l.jsxs("div",{className:`flex justify-between text-sm mt-2 font-medium ${u?"":"text-gray-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:[l.jsx("span",{children:H(h)}),l.jsx("span",{children:H(p)})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:B,className:`p-3 rounded-full transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center border-2 ${u?"border":"bg-blue-600 text-white hover:bg-blue-700"}`,style:u?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...o.glow}:{},children:d?l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zM7 8a1 1 0 012 0v4a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v4a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})}):l.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("svg",{className:`w-5 h-5 ${u?"":"text-gray-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.617.793L4.617 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.617l3.766-3.793a1 1 0 011.617.793zM14.657 2.929a1 1 0 011.414 0A9.972 9.972 0 0119 10a9.972 9.972 0 01-2.929 7.071 1 1 0 01-1.414-1.414A7.971 7.971 0 0017 10c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.828a1 1 0 011.415 0A5.983 5.983 0 0115 10a5.984 5.984 0 01-1.757 4.243 1 1 0 01-1.415-1.415A3.984 3.984 0 0013 10a3.983 3.983 0 00-1.172-2.828 1 1 0 010-1.415z",clipRule:"evenodd"})}),l.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:v,onChange:z,className:`w-24 h-3 rounded-lg appearance-none cursor-pointer min-h-[20px] ${u?"bg-gray-800":"bg-gray-200"}`,style:u?{accentColor:fe.cyan}:{}}),l.jsxs("span",{className:`text-sm w-10 font-medium ${u?"":"text-gray-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:[Math.round(v*100),"%"]})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:`text-sm ${u?"":"text-gray-600"}`,style:u?{color:fe.cyan,fontFamily:"monospace"}:{},children:u?"SPEED:":"Speed:"}),l.jsxs("select",{value:b,onChange:q,className:`text-sm border rounded px-2 py-1 ${u?"border":"border-gray-300"}`,style:u?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace"}:{},children:[l.jsx("option",{value:"0.5",children:"0.5x"}),l.jsx("option",{value:"0.75",children:"0.75x"}),l.jsx("option",{value:"1",children:"1x"}),l.jsx("option",{value:"1.25",children:"1.25x"}),l.jsx("option",{value:"1.5",children:"1.5x"}),l.jsx("option",{value:"2",children:"2x"})]})]})]})]})]})},oge=({transcript:e,scores:t,audioBlob:r,recordingTime:n,onReRecord:s,onFinalSubmit:a,canReRecord:i,attemptNumber:o,maxAttempts:c,isSubmitting:u=!1})=>{const{theme:d,isCyberpunk:f,isKpop:h,themeClasses:g}=da(),p=ua(d),[x,v]=w.useState(!1);console.log(" FeedbackDisplay received recordingTime:",n);const C=(E,F)=>{const j=E/F*100;return f?j>=80?fe.cyan:fe.red:j>=80?"text-green-600":j>=60?"text-yellow-600":"text-red-600"},b=(E,F)=>{if(f)return"";const j=E/F*100;return j>=80?"text-green-600":j>=60?"text-yellow-600":"text-red-600"},_=(E,F)=>{const j=E/F*100;return j>=90?"A+":j>=80?"A":j>=70?"B":j>=60?"C":j>=50?"D":"F"},T=()=>_(t?.overall_score||0,100),N=()=>C(t?.overall_score||0,100);return console.log(" FeedbackDisplay received scores:",t),console.log(" Individual score values:",{grammar_score:t?.grammar_score,vocabulary_score:t?.vocabulary_score,pronunciation_score:t?.pronunciation_score,fluency_score:t?.fluency_score,content_score:t?.content_score}),l.jsxs("div",{className:`feedback-display rounded-lg shadow-lg p-3 sm:p-6 ${f?Vt(0).className:"bg-white"}`,style:f?{...Vt(0).style,...p.glow}:h?{...hr(0).style,borderColor:He.primary}:{},children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2 ",style:f?{...p.textCyan,fontFamily:"monospace"}:h?{...p.headerText}:{},children:f?"SPEAKING TEST RESULTS":"Speaking Test Results"}),l.jsx("p",{className:f?"":"text-gray-600",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"REVIEW YOUR PERFORMANCE AND DECIDE WHETHER TO SUBMIT OR RE-RECORD.":"Review your performance and decide whether to submit or re-record."})]}),l.jsx("div",{className:`p-3 sm:p-6 rounded-lg mb-6 border-2 ${f?Vt(1).className:h?hr(1).className:"bg-gradient-to-r from-blue-50 to-green-50"}`,style:f?{...Vt(1).style,...p.glow}:h?{...hr(1).style,borderColor:He.primary}:{},children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:`text-4xl font-bold ${f?"":N()}`,style:f?{color:C(t?.overall_score||0,100),fontFamily:"monospace",...t?.overall_score>=80?p.textShadow:p.textShadowRed}:{},children:[t?.overall_score||0,"/100"]}),l.jsx("div",{className:`text-2xl font-semibold mt-2 ${f?"":N()}`,style:f?{color:C(t?.overall_score||0,100),fontFamily:"monospace",...t?.overall_score>=80?p.textShadow:p.textShadowRed}:{},children:f?`GRADE: ${T()}`:`Grade: ${T()}`}),l.jsx("div",{className:`mt-2 ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:t?.overall_score>=80?f?"EXCELLENT WORK!":"Excellent work!":t?.overall_score>=60?f?"GOOD JOB!":"Good job!":t?.overall_score>=50?f?"NOT BAD, BUT COULD BE BETTER.":"Not bad, but could be better.":f?"KEEP PRACTICING!":"Keep practicing!"})]})}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[l.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${f?Vt(2).className:"bg-white"}`,style:f?{...Vt(2).style}:{},children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:`font-semibold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"GRAMMAR":"Grammar"}),l.jsxs("span",{className:`font-bold ${f?"":b(t?.grammar_score||0,25)}`,style:f?{color:C(t?.grammar_score||0,25),fontFamily:"monospace"}:{},children:[t?.grammar_score||0,"/25"]})]}),l.jsx("div",{className:`text-sm ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?`${t?.grammar_mistakes||0} MISTAKES FOUND`:`${t?.grammar_mistakes||0} mistakes found`}),l.jsx("div",{className:`w-full rounded-full h-2 mt-2 ${f?"bg-gray-800":"bg-gray-200"}`,children:l.jsx("div",{className:`h-2 rounded-full ${f?"":"bg-green-600"}`,style:f?{backgroundColor:C(t?.grammar_score||0,25),width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}:{width:`${Math.min((t?.grammar_score||0)/25*100,100)}%`}})})]}),l.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${f?Vt(0).className:"bg-white"}`,style:f?{...Vt(0).style}:{},children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:`font-semibold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"VOCABULARY":"Vocabulary"}),l.jsxs("span",{className:`font-bold ${f?"":b(t?.vocabulary_score||0,20)}`,style:f?{color:C(t?.vocabulary_score||0,20),fontFamily:"monospace"}:{},children:[t?.vocabulary_score||0,"/20"]})]}),l.jsx("div",{className:`text-sm ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?`${t?.vocabulary_mistakes||0} VOCABULARY ISSUES`:`${t?.vocabulary_mistakes||0} vocabulary issues`}),l.jsx("div",{className:`w-full rounded-full h-2 mt-2 ${f?"bg-gray-800":"bg-gray-200"}`,children:l.jsx("div",{className:`h-2 rounded-full ${f?"":"bg-purple-600"}`,style:f?{backgroundColor:C(t?.vocabulary_score||0,20),width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}:{width:`${Math.min((t?.vocabulary_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${f?Vt(1).className:"bg-white"}`,style:f?{...Vt(1).style}:{},children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:`font-semibold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"PRONUNCIATION":"Pronunciation"}),l.jsxs("span",{className:`font-bold ${f?"":b(t?.pronunciation_score||0,15)}`,style:f?{color:C(t?.pronunciation_score||0,15),fontFamily:"monospace"}:{},children:[t?.pronunciation_score||0,"/15"]})]}),l.jsx("div",{className:`text-sm ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"CLARITY AND ACCURACY":"Clarity and accuracy"}),l.jsx("div",{className:`w-full rounded-full h-2 mt-2 ${f?"bg-gray-800":"bg-gray-200"}`,children:l.jsx("div",{className:`h-2 rounded-full ${f?"":"bg-orange-600"}`,style:f?{backgroundColor:C(t?.pronunciation_score||0,15),width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}:{width:`${Math.min((t?.pronunciation_score||0)/15*100,100)}%`}})})]}),l.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${f?Vt(2).className:"bg-white"}`,style:f?{...Vt(2).style}:{},children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:`font-semibold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"FLUENCY":"Fluency"}),l.jsxs("span",{className:`font-bold ${f?"":b(t?.fluency_score||0,20)}`,style:f?{color:C(t?.fluency_score||0,20),fontFamily:"monospace"}:{},children:[t?.fluency_score||0,"/20"]})]}),l.jsx("div",{className:`text-sm ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"PACE, PAUSES, AND FLOW":"Pace, pauses, and flow"}),l.jsx("div",{className:`w-full rounded-full h-2 mt-2 ${f?"bg-gray-800":"bg-gray-200"}`,children:l.jsx("div",{className:`h-2 rounded-full ${f?"":"bg-blue-600"}`,style:f?{backgroundColor:C(t?.fluency_score||0,20),width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}:{width:`${Math.min((t?.fluency_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${f?Vt(0).className:"bg-white"}`,style:f?{...Vt(0).style}:{},children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:`font-semibold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"CONTENT":"Content"}),l.jsxs("span",{className:`font-bold ${f?"":b(t?.content_score||0,20)}`,style:f?{color:C(t?.content_score||0,20),fontFamily:"monospace"}:{},children:[t?.content_score||0,"/20"]})]}),l.jsx("div",{className:`text-sm ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"HOW WELL ADDRESSED THE PROMPT":"How well addressed the prompt"}),l.jsx("div",{className:`w-full rounded-full h-2 mt-2 ${f?"bg-gray-800":"bg-gray-200"}`,children:l.jsx("div",{className:`h-2 rounded-full ${f?"":"bg-indigo-600"}`,style:f?{backgroundColor:C(t?.content_score||0,20),width:`${Math.min((t?.content_score||0)/20*100,100)}%`}:{width:`${Math.min((t?.content_score||0)/20*100,100)}%`}})})]}),l.jsxs("div",{className:`border rounded-lg p-3 sm:p-4 ${f?Vt(1).className:"bg-white"}`,style:f?{...Vt(1).style}:{},children:[l.jsxs("div",{className:"flex justify-between items-center mb-2",children:[l.jsx("span",{className:`font-semibold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"WORD COUNT":"Word Count"}),l.jsxs("span",{className:`font-bold ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:[t?.word_count||0," ",f?"WORDS":"words"]})]}),l.jsx("div",{className:`text-sm ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"TOTAL WORDS SPOKEN":"Total words spoken"}),l.jsx("div",{className:`w-full rounded-full h-2 mt-2 ${f?"bg-gray-800":"bg-gray-200"}`,children:l.jsx("div",{className:`h-2 rounded-full ${f?"":"bg-gray-600"}`,style:f?{backgroundColor:fe.cyan,width:`${Math.min((t?.word_count||0)/100*100,100)}%`}:{width:`${Math.min((t?.word_count||0)/100*100,100)}%`}})})]})]}),r&&l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-3 ",style:f?{...p.textCyan,fontFamily:"monospace"}:{},children:f?"YOUR RECORDING":"Your Recording"}),l.jsx(KV,{audioBlob:r,recordingTime:n})]}),t?.feedback&&l.jsx("div",{className:`mb-6 py-3 px-0 sm:p-6 rounded-lg border-2 ${f?Vt(2).className:h?hr(2).className:"bg-gradient-to-r from-green-50 to-blue-50 border-green-200"}`,style:f?{...Vt(2).style,...p.glow}:h?{...hr(2).style,borderColor:He.primary}:{},children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("div",{className:`font-semibold mb-3 text-lg ${f?"":"text-green-800"}`,style:f?{...p.textCyan,fontFamily:"monospace"}:{},children:f?"AI FEEDBACK":"AI Feedback"}),l.jsx("p",{className:`leading-relaxed ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:t.feedback})]})]})}),t?.improved_transcript&&l.jsxs("div",{className:`mb-6 rounded-lg p-3 sm:p-4 border-2 ${f?Vt(0).className:h?hr(0).className:"bg-green-50 border-green-200"}`,style:f?{...Vt(0).style,...p.glow}:h?{...hr(0).style,borderColor:He.primary}:{},children:[l.jsxs("div",{className:"flex items-start space-x-2 mb-3",children:[l.jsx("span",{className:"text-lg",children:""}),l.jsxs("div",{children:[l.jsx("h4",{className:`font-semibold mb-2 ${f?"":"text-green-800"}`,style:f?{...p.textCyan,fontFamily:"monospace"}:{},children:f?"IMPROVED VERSION":"Improved Version"}),l.jsx("p",{className:`text-sm mb-3 ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"HERE'S HOW YOUR RESPONSE COULD BE IMPROVED WITH BETTER GRAMMAR AND VOCABULARY:":"Here's how your response could be improved with better grammar and vocabulary:"})]})]}),l.jsx("div",{className:`border rounded p-3 ${f?"border-cyan-400":"bg-white border-green-200"}`,style:f?{backgroundColor:fe.black,borderColor:fe.cyan}:{},children:l.jsx("p",{className:`leading-relaxed ${f?"":"text-gray-800"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:t.improved_transcript})})]}),l.jsx("div",{className:"mb-6",children:l.jsx("button",{onClick:()=>v(!x),className:`text-sm ${f?"":"text-blue-600 hover:text-blue-800"}`,style:f?{color:fe.cyan,fontFamily:"monospace",...p.textShadow}:{},children:f?x?"HIDE DETAILS":"SHOW DETAILS":x?"Hide Details":"Show Details"})}),x&&l.jsxs("div",{className:`mb-6 p-3 sm:p-4 rounded-lg border-2 ${f?Vt(2).className:h?hr(2).className:"bg-blue-50"}`,style:f?{...Vt(2).style,...p.glow}:h?{...hr(2).style,borderColor:He.primary}:{},children:[l.jsx("h4",{className:"font-semibold mb-3 ",style:f?{...p.textCyan,fontFamily:"monospace"}:{},children:f?"DETAILED ANALYSIS":"Detailed Analysis"}),l.jsxs("div",{className:"space-y-3 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"font-medium ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"WORD COUNT ANALYSIS:":"Word Count Analysis:"}),l.jsx("span",{className:`ml-2 ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?`YOU SPOKE ${t?.word_count||0} WORDS. ${t?.word_count>=50?"GREAT JOB MEETING THE MINIMUM REQUIREMENT!":"CONSIDER SPEAKING MORE TO MEET THE MINIMUM WORD REQUIREMENT."}`:`You spoke ${t?.word_count||0} words. ${t?.word_count>=50?"Great job meeting the minimum requirement!":"Consider speaking more to meet the minimum word requirement."}`})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"GRAMMAR ANALYSIS:":"Grammar Analysis:"}),l.jsx("span",{className:`ml-2 ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:t?.grammar_mistakes===0?f?"PERFECT GRAMMAR!":"Perfect grammar!":f?`FOUND ${t?.grammar_mistakes||0} GRAMMAR ${t?.grammar_mistakes===1?"MISTAKE":"MISTAKES"}.`:`Found ${t?.grammar_mistakes||0} grammar ${t?.grammar_mistakes===1?"mistake":"mistakes"}.`}),t?.grammar_corrections&&t.grammar_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.grammar_corrections.map((E,F)=>l.jsx("div",{className:`border rounded p-2 sm:p-3 ${f?Vt(1).className:"bg-yellow-50 border-yellow-200"}`,style:f?{...Vt(1).style}:{},children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:`font-mono text-sm ${f?"":"text-red-600"}`,style:f?{color:fe.red,fontFamily:"monospace"}:{},children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:`font-medium ${f?"":"text-red-600"}`,style:f?{color:fe.red,fontFamily:"monospace"}:{},children:E.mistake}),l.jsx("span",{className:"mx-2 ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsx("span",{className:`font-medium ${f?"":"text-green-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:E.correction})]}),l.jsxs("div",{className:`text-xs mt-1 ${f?"":"text-blue-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:[l.jsx("strong",{children:f?"EXPLANATION:":"Explanation:"})," ",E.explanation]})]})]})},F))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"VOCABULARY ANALYSIS:":"Vocabulary Analysis:"}),l.jsx("span",{className:`ml-2 ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:t?.vocabulary_mistakes===0?f?"EXCELLENT VOCABULARY USAGE!":"Excellent vocabulary usage!":f?`FOUND ${t?.vocabulary_mistakes||0} VOCABULARY ${t?.vocabulary_mistakes===1?"ISSUE":"ISSUES"}.`:`Found ${t?.vocabulary_mistakes||0} vocabulary ${t?.vocabulary_mistakes===1?"issue":"issues"}.`}),t?.vocabulary_corrections&&t.vocabulary_corrections.length>0&&l.jsx("div",{className:"mt-2 space-y-2",children:t.vocabulary_corrections.map((E,F)=>l.jsx("div",{className:`border rounded p-2 sm:p-3 ${f?Vt(0).className:"bg-purple-50 border-purple-200"}`,style:f?{...Vt(0).style}:{},children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:`font-mono text-sm ${f?"":"text-purple-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:`font-medium ${f?"":"text-purple-600"}`,style:f?{color:fe.red,fontFamily:"monospace"}:{},children:E.mistake}),l.jsx("span",{className:"mx-2 ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsx("span",{className:`font-medium ${f?"":"text-green-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:E.correction})]}),l.jsxs("div",{className:`text-xs mt-1 ${f?"":"text-blue-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:[l.jsx("strong",{children:f?"EXPLANATION:":"Explanation:"})," ",E.explanation]})]})]})},F))})]}),l.jsxs("div",{children:[l.jsx("span",{className:"font-medium ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"PRONUNCIATION ANALYSIS:":"Pronunciation Analysis:"}),l.jsx("span",{className:`ml-2 ${f?"":"text-gray-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:t?.pronunciation_corrections&&t.pronunciation_corrections.length>0?f?`FOUND ${t.pronunciation_corrections.length} PRONUNCIATION ${t.pronunciation_corrections.length===1?"TIP":"TIPS"} TO HELP IMPROVE CLARITY.`:`Found ${t.pronunciation_corrections.length} pronunciation ${t.pronunciation_corrections.length===1?"tip":"tips"} to help improve clarity.`:f?"GREAT PRONUNCIATION! YOUR SPEECH WAS CLEAR AND EASY TO UNDERSTAND.":"Great pronunciation! Your speech was clear and easy to understand."})]}),t?.pronunciation_corrections&&t.pronunciation_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"PRONUNCIATION TIPS:":"Pronunciation Tips:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.pronunciation_corrections.map((E,F)=>l.jsx("div",{className:`border rounded p-2 sm:p-3 ${f?Vt(1).className:"bg-orange-50 border-orange-200"}`,style:f?{...Vt(1).style}:{},children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:`font-mono text-sm ${f?"":"text-orange-600"}`,style:f?{color:fe.yellow,fontFamily:"monospace"}:{},children:""}),l.jsx("div",{className:"flex-1",children:l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:`font-medium ${f?"":"text-orange-700"}`,style:f?{color:fe.red,fontFamily:"monospace"}:{},children:E.word}),l.jsx("span",{className:"mx-2 ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsx("span",{className:`font-medium ${f?"":"text-green-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:E.correction})]})})]})},F))})]}),t?.language_use_corrections&&t.language_use_corrections.length>0&&l.jsxs("div",{children:[l.jsx("span",{className:"font-medium ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?"LANGUAGE USE SUGGESTIONS:":"Language Use Suggestions:"}),l.jsx("div",{className:"mt-2 space-y-2",children:t.language_use_corrections.map((E,F)=>l.jsx("div",{className:`border rounded p-2 sm:p-3 ${f?Vt(2).className:"bg-blue-50 border-blue-200"}`,style:f?{...Vt(2).style}:{},children:l.jsxs("div",{className:"flex items-start space-x-2",children:[l.jsx("span",{className:`font-mono text-sm ${f?"":"text-blue-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:`font-medium ${f?"":"text-blue-700"}`,style:f?{color:fe.red,fontFamily:"monospace"}:{},children:E.mistake}),l.jsx("span",{className:"mx-2 ",style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:""}),l.jsx("span",{className:`font-medium ${f?"":"text-green-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:E.suggestion})]}),E.explanation&&l.jsxs("div",{className:`text-xs mt-1 ${f?"":"text-blue-700"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:[l.jsx("strong",{children:f?"WHY:":"Why:"})," ",E.explanation]})]})]})},F))})]})]})]}),l.jsx("div",{className:`text-sm mb-3 ${f?"":"text-gray-600"}`,style:f?{color:fe.cyan,fontFamily:"monospace"}:{},children:f?`ATTEMPT ${o} OF ${c}`:`Attempt ${o} of ${c}`}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-center justify-center",children:[i&&l.jsxs("button",{onClick:s,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium border-2 ${f?"border":"bg-yellow-600 text-white hover:bg-yellow-700"}`,style:f?{backgroundColor:fe.black,borderColor:fe.yellow,color:fe.yellow,fontFamily:"monospace",...p.glowYellow}:{},children:[l.jsx("span",{children:""}),l.jsx("span",{children:f?"RE-RECORD":"Re-record"})]}),l.jsx("button",{onClick:a,disabled:u,className:`w-full sm:w-auto px-4 py-2.5 rounded-lg flex items-center justify-center space-x-2 min-h-[40px] text-base font-medium border-2 ${f?"border":u?"bg-gray-400 cursor-not-allowed text-white":"bg-green-600 hover:bg-green-700 text-white"}`,style:f?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",...h?{}:u?{}:p.glow}:{},children:u?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:`w-4 h-4 border-2 border-t-transparent rounded-full animate-spin ${f?"":"border-white"}`,style:f?{borderColor:fe.cyan}:{}}),l.jsx("span",{children:f?"SUBMITTING...":"Submitting..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{children:""}),l.jsx("span",{children:f?"SUBMIT FINAL":"Submit Final"})]})})]}),!i&&l.jsx("div",{className:`mt-4 p-2 sm:p-3 rounded-lg border-2 ${f?Vt(1).className:"bg-yellow-50 border-yellow-200"}`,style:f?{...Vt(1).style}:{},children:l.jsxs("p",{className:`text-sm ${f?"":"text-yellow-800"}`,style:f?{color:fe.yellow,fontFamily:"monospace",...p.textShadowYellow}:{},children:[l.jsx("strong",{children:f?"MAXIMUM ATTEMPTS REACHED.":"Maximum attempts reached."})," ",f?'THIS IS YOUR FINAL ATTEMPT. CLICK "SUBMIT FINAL" TO COMPLETE THE TEST.':'This is your final attempt. Click "Submit Final" to complete the test.']})})]})};async function lge(e,t){if(!e)return e;try{const r=await e.arrayBuffer(),n=await cge(t),s=await uge(n,r),a=await fge(s,16e3),i=await hge(a),o=dge(i);return new Blob([o],{type:"audio/wav"})}catch(r){return console.warn("convertBlobToWav16kHz: failed to convert, returning original blob",r),e}}async function cge(e){const t=window.AudioContext||window.webkitAudioContext;if(!t)throw new Error("AudioContext is not supported in this browser");const r=new t;if(r.state==="suspended"&&r.resume)try{await r.resume()}catch{}return r}function uge(e,t){return new Promise((r,n)=>{const s=t.slice(0),a=e.decodeAudioData(s,r,n);a&&typeof a.then=="function"&&a.then(r).catch(n)})}function dge(e){const t=e.numberOfChannels||1,r=e.sampleRate||44100,n=e.length,s=2,a=t*s,i=r*a,o=n*a,c=44+o,u=new ArrayBuffer(c),d=new DataView(u);Vw(d,0,"RIFF"),d.setUint32(4,36+o,!0),Vw(d,8,"WAVE"),Vw(d,12,"fmt "),d.setUint32(16,16,!0),d.setUint16(20,1,!0),d.setUint16(22,t,!0),d.setUint32(24,r,!0),d.setUint32(28,i,!0),d.setUint16(32,a,!0),d.setUint16(34,s*8,!0),Vw(d,36,"data"),d.setUint32(40,o,!0);let f=44;const h=[];for(let g=0;g<t;g++)h.push(e.getChannelData(g));for(let g=0;g<n;g++)for(let p=0;p<t;p++){let x=h[p][g];x=Math.max(-1,Math.min(1,x)),d.setInt16(f,x<0?x*32768:x*32767,!0),f+=2}return u}function Vw(e,t,r){for(let n=0;n<r.length;n++)e.setUint8(t+n,r.charCodeAt(n))}async function fge(e,t){const r=e.sampleRate;if(r===t)return e;const n=e.numberOfChannels,s=t/r,a=Math.round(e.length*s),i=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(!i)return console.warn("OfflineAudioContext not supported, cannot resample"),e;const o=new i(n,a,t),c=o.createBufferSource();c.buffer=e,c.connect(o.destination),c.start();try{return await o.startRendering()}catch(u){return console.warn("Resampling failed, returning original buffer",u),e}}async function hge(e){if(e.numberOfChannels===1)return e;const t=1,r=e.length,n=e.sampleRate,s=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(!s)return console.warn("OfflineAudioContext not supported, cannot convert to mono"),e;const a=new s(t,r,n),i=a.createBufferSource();if(i.buffer=e,e.numberOfChannels===2){const o=a.createChannelMerger(1),c=a.createChannelSplitter(2);i.connect(c),c.connect(o,0,0),c.connect(o,1,0),o.connect(a.destination)}else{const o=a.createChannelSplitter(1);i.connect(o),o.connect(a.destination,0,0)}i.start();try{return await a.startRendering()}catch(o){return console.warn("Mono conversion failed, returning original buffer",o),e}}const mge=({testData:e,onComplete:t,onExit:r,onTestComplete:n})=>{const[s,a]=w.useState("recording"),[i,o]=w.useState(null),[c,u]=w.useState(""),[d,f]=w.useState(null),[h,g]=w.useState(!1),[p,x]=w.useState(!1),[v,C]=w.useState(!1),[b,_]=w.useState(null),[T,N]=w.useState(1),[E]=w.useState(e.allowed_attempts||e.max_attempts||3),[F,j]=w.useState(!1),[P,M]=w.useState(0),[I,U]=w.useState(!1),[K,te]=w.useState(!0),[re,Z]=w.useState("audio/webm"),[B,J]=w.useState(null),[z,q]=w.useState(null),[H,R]=w.useState(!1),L=w.useRef(null),{theme:G,isCyberpunk:W,isKpop:Q,themeClasses:X}=da(),se=ua(G),[le,he]=w.useState(0),[we,ie]=w.useState(null),Ee=tc(),{user:ye}=ws(),{makeAuthenticatedRequest:Ie}=Ee,ut=w.useRef(null);I2(K,w.useCallback(({confirm:rt,cancel:Oe})=>{console.log(" SpeakingTestStudent: Browser back button intercepted during test!"),console.log(" SpeakingTestStudent: isBackInterceptEnabled:",K),console.log(" SpeakingTestStudent: Setting pending navigation and showing modal"),L.current={confirm:rt,cancel:Oe},C(!0)},[K])),w.useEffect(()=>{s!=="completed"?te(!0):(te(!1),L.current=null)},[s]),w.useEffect(()=>{if(e?.test_id&&ye?.student_id){const rt=`speaking_attempts_${ye.student_id}_${e.test_id}`,Oe=localStorage.getItem(rt);if(Oe){const $e=parseInt(Oe,10);$e>0&&$e<=E&&(N($e),console.log(" Loaded attempts from localStorage:",$e))}}},[e,ye,E]),w.useEffect(()=>{if(e&&!we){const rt=new Date;ie(rt),console.log(" Speaking test timer started at:",rt.toISOString())}},[e,we]),w.useEffect(()=>{let rt=0;s==="recording"?rt=25:s==="processing"||s==="error"?rt=50:s==="feedback"?rt=75:s==="completed"&&(rt=100),he(rt)},[s]),w.useEffect(()=>{(async()=>{try{if(!window.isSecureContext&&!window.location.hostname.includes("localhost")){_("Microphone access requires HTTPS. Please use a secure connection.");return}if(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia){_("Microphone access is not supported in this browser. Please use a modern browser like Chrome, Safari, or Firefox.");return}if(navigator.permissions)try{(await navigator.permissions.query({name:"microphone"})).state==="granted"?(j(!0),console.log(" Microphone permission already granted")):console.log(" Microphone permission not yet granted - user will need to click record button")}catch(Oe){console.log(" Could not check microphone permission status:",Oe)}}catch(Oe){console.error(" Error checking microphone permission:",Oe)}})()},[]),w.useEffect(()=>{const rt=setInterval(()=>{i&&s==="recording"&&Qe()},3e4);return()=>clearInterval(rt)},[i,s]);const Qe=w.useCallback(async()=>{try{const rt={test_id:e.test_id,audio_blob:i?await $t(i):null,audio_mime_type:i&&i.type||"audio/webm",attempt_number:T,step:s,timestamp:new Date().toISOString()};localStorage.setItem(`speaking_progress_${e.test_id}`,JSON.stringify(rt))}catch(rt){console.error("Failed to save progress:",rt)}},[e.test_id,i,T,s]),$t=rt=>new Promise((Oe,$e)=>{const Mt=new FileReader;Mt.onloadend=()=>{const At=Mt.result.split(",")[1];Oe(At)},Mt.onerror=$e,Mt.readAsDataURL(rt)}),Ge=w.useCallback(rt=>{if(e?.test_id&&ye?.student_id){const Oe=`speaking_attempts_${ye.student_id}_${e.test_id}`;localStorage.setItem(Oe,rt.toString()),console.log(" Saved attempts to localStorage:",rt)}},[e,ye]),et=w.useCallback(async(rt,Oe,$e,Mt,It,At)=>{if(e?.test_id&&ye?.student_id)try{const{setCachedData:tr,CACHE_TTL:ar}=await ui(async()=>{const{setCachedData:ve,CACHE_TTL:Fe}=await Promise.resolve().then(()=>Dp);return{setCachedData:ve,CACHE_TTL:Fe}},void 0),dr=`speaking_test_data_${ye.student_id}_${e.test_id}`,mr={audioBlob:rt?await $t(rt):null,audioMimeType:At||"audio/webm",transcript:Oe,scores:$e,recordingTime:Mt,currentStep:It,timestamp:Date.now()};tr(dr,mr,ar.speaking_test_data),console.log(" Saved speaking test data to cache:",dr)}catch(tr){console.error("Failed to save speaking test data to cache:",tr)}},[e,ye]),vt=w.useCallback(async()=>{if(e?.test_id&&ye?.student_id)try{const{getCachedData:rt}=await ui(async()=>{const{getCachedData:Mt}=await Promise.resolve().then(()=>Dp);return{getCachedData:Mt}},void 0),Oe=`speaking_test_data_${ye.student_id}_${e.test_id}`,$e=rt(Oe);if($e){if(console.log(" Loaded speaking test data from cache:",$e),$e.audioBlob){const Mt=$e.audioMimeType||"audio/webm",It=new Blob([Uint8Array.from(atob($e.audioBlob),At=>At.charCodeAt(0))],{type:Mt});o(It),Z(Mt)}return $e.transcript&&u($e.transcript),$e.scores&&f($e.scores),$e.recordingTime&&M($e.recordingTime),$e.currentStep&&a($e.currentStep),$e.audioMimeType&&Z($e.audioMimeType),!0}}catch(rt){console.error("Failed to load speaking test data from cache:",rt)}return!1},[e,ye]);w.useEffect(()=>{if(e?.test_id&&ye?.student_id){try{const rt=ye.student_id,Oe=`retest_assignment_id_${rt}_speaking_${e.test_id}`,$e=`retest_in_progress_${rt}_speaking_${e.test_id}`;if(!!localStorage.getItem(Oe)||!!localStorage.getItem($e)){const It=`speaking_test_data_${rt}_${e.test_id}`,At=`anti_cheating_${rt}_speaking_${e.test_id}`,tr=`speaking_progress_${e.test_id}`;localStorage.removeItem(It),localStorage.removeItem(At),localStorage.removeItem(tr),console.log(" Cleared speaking per-test cache for retest start:",{cacheKey:It,antiCheatKey:At,progressKey:tr})}}catch{}vt()}},[e,ye,vt]),w.useEffect(()=>{e?.test_id&&ye?.student_id&&(i||c||d)&&et(i,c,d,P,s,re)},[i,c,d,P,s,e,ye,et,re]);const Te=w.useCallback(async(rt,Oe)=>{if(I){console.log(" Already processing, skipping duplicate call");return}console.log(" Recording completed, duration:",Oe),U(!0),o(rt),Z(rt?.type||"audio/webm"),M(Oe),a("processing"),_(null);try{const $e=await lge(rt,null),Mt=await $t($e),It=new Date,At=e.start_time?Math.round((It-e.start_time)/1e3):0,tr=e.start_time?new Date(e.start_time).toISOString():It.toISOString(),dr=`retest_assignment_id_${ye.student_id}_speaking_${e.test_id}`,or=localStorage.getItem(dr),mr={test_id:e.test_id,question_id:e.question_id||1,audio_blob:Mt,audio_mime_type:"audio/wav"};q(mr),console.log(" Processing audio with AI...");try{const ve=await Ie("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(mr)});let Fe;try{const Ct=await ve.text();Fe=JSON.parse(Ct)}catch{throw new Error("AI_SERVER_ERROR")}if(!Fe.success)throw new Error(Fe.message||Fe.error||"AI processing failed");J(null),q(null),console.log(" AI Analysis Result:",Fe),u(Fe.transcript);const Be=Fe.transcript?Fe.transcript.split(/\s+/).filter(Ct=>Ct.length>0).length:0;console.log(" Word Count Verification:",{aiCount:Fe.word_count,actualCount:Be,transcript:Fe.transcript});const Pe=Be,lt={overall_score:Fe.overall_score,word_count:Pe,grammar_score:Fe.grammar_score,vocabulary_score:Fe.vocabulary_score,pronunciation_score:Fe.pronunciation_score,fluency_score:Fe.fluency_score,content_score:Fe.content_score,grammar_mistakes:Fe.grammar_mistakes,vocabulary_mistakes:Fe.vocabulary_mistakes,feedback:Fe.feedback,improved_transcript:Fe.improved_transcript,grammar_corrections:Fe.grammar_corrections||[],vocabulary_corrections:Fe.vocabulary_corrections||[],language_use_corrections:Fe.language_use_corrections||[],pronunciation_corrections:Fe.pronunciation_corrections||[],ai_feedback:Fe.ai_feedback||null};console.log(" Mapped Scores:",lt),console.log(" Individual scores check:",{grammar_score:Fe.grammar_score,vocabulary_score:Fe.vocabulary_score,pronunciation_score:Fe.pronunciation_score,fluency_score:Fe.fluency_score,content_score:Fe.content_score}),f(lt),a("feedback"),localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(ve){console.error(" AI submission error:",ve),o(rt),Z(rt?.type||"audio/webm");let Fe="Looks like AI servers are overloaded, please try again";ve.message==="AI_SERVER_ERROR"||ve.message.includes("JSON")||ve.message.includes("invalid")?Fe="Looks like AI servers are overloaded, please try again":ve.message.includes("No valid authentication token found")?(Fe="Your session has expired. Please refresh the page and try again.",setTimeout(()=>{window.location.reload()},3e3)):ve.message&&(Fe=ve.message),J(Fe),a("error"),U(!1)}}catch($e){console.error("Speaking test submission error:",$e),_($e.message),a("recording")}finally{U(!1)}},[e,ye,Ie,T,Ge,I,i]),Ve=w.useCallback(async()=>{if(!(!z||!i)){R(!0),J(null),a("processing");try{const rt=await Ie("/.netlify/functions/process-speaking-audio-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(z)});let Oe;try{const At=await rt.text();Oe=JSON.parse(At)}catch{throw new Error("AI_SERVER_ERROR")}if(!Oe.success)throw new Error(Oe.message||Oe.error||"AI processing failed");J(null),q(null),R(!1),u(Oe.transcript);const Mt=Oe.transcript?Oe.transcript.split(/\s+/).filter(At=>At.length>0).length:0,It={overall_score:Oe.overall_score,word_count:Mt,grammar_score:Oe.grammar_score,vocabulary_score:Oe.vocabulary_score,pronunciation_score:Oe.pronunciation_score,fluency_score:Oe.fluency_score,content_score:Oe.content_score,grammar_mistakes:Oe.grammar_mistakes,vocabulary_mistakes:Oe.vocabulary_mistakes,feedback:Oe.feedback,improved_transcript:Oe.improved_transcript,grammar_corrections:Oe.grammar_corrections||[],vocabulary_corrections:Oe.vocabulary_corrections||[],language_use_corrections:Oe.language_use_corrections||[],pronunciation_corrections:Oe.pronunciation_corrections||[],ai_feedback:Oe.ai_feedback||null};f(It),a("feedback"),localStorage.removeItem(`speaking_progress_${e.test_id}`)}catch(rt){console.error(" Resend error:",rt);let Oe="Looks like AI servers are overloaded, please try again";rt.message==="AI_SERVER_ERROR"||rt.message.includes("JSON")?Oe="Looks like AI servers are overloaded, please try again":rt.message&&(Oe=rt.message),J(Oe),a("error"),R(!1)}}},[z,i,Ie,e]);w.useEffect(()=>{s==="processing"&&!c&&!d&&(console.log(' Detected stuck "processing" state on reload. Attempting recovery...'),i?(console.log(" Resuming processing from cached audio blob..."),Te(i,P)):(console.log(" No cached audio blob found. Resetting to recording step."),a("recording")))},[s,c,d,i,P,Te]);const pt=w.useCallback(()=>{if(T<E){o(null),u(""),f(null),_(null),U(!1),Z("audio/webm");const rt=T+1;N(rt),Ge(rt),a("recording")}else _("Maximum attempts reached")},[T,E,Ge]),wt=w.useCallback(async()=>{if(!(!c||!d)){g(!0);try{const rt=new Date,Oe=e.start_time?Math.round((rt-e.start_time)/1e3):0,$e=e.start_time?new Date(e.start_time).toISOString():rt.toISOString(),Mt=ye.student_id,It=`retest_assignment_id_${Mt}_speaking_${e.test_id}`,At=localStorage.getItem(It),{academicCalendarService:tr}=await ui(async()=>{const{academicCalendarService:Fe}=await Promise.resolve().then(()=>JS);return{academicCalendarService:Fe}},void 0);await tr.loadAcademicCalendar();const dr=tr.getCurrentTerm()?.id;if(!dr)throw new Error("No current academic period found");const or={test_id:e.test_id,test_name:e.test_name,teacher_id:e.teacher_id||null,subject_id:e.subject_id||null,student_id:Mt,academic_period_id:dr,question_id:e.question_id||1,audio_blob:i?await $t(i):null,audio_duration:i?.duration||0,time_taken:Oe,started_at:$e,submitted_at:rt.toISOString(),caught_cheating:!1,visibility_change_times:0,is_completed:!0,retest_assignment_id:At?Number(At):null,parent_test_id:e.test_id,audio_mime_type:re||"audio/webm",transcript:c,scores:d,final_submission:!0};console.log(" Final submission with WebM blob (size:",i?.size,"bytes):",or),console.log(" Making final submission request...");const mr=await Ie("/.netlify/functions/submit-speaking-test-final",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(or)});console.log(" Final submission response status:",mr.status);const ve=await mr.json();if(console.log(" Final submission result:",ve),ve.success){if(ye?.student_id){const Bt=`test_completed_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(Bt,"true"),console.log(" Speaking test marked as completed in localStorage:",Bt);const Yt=`retest_in_progress_${ye.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Yt),console.log(" Cleared in-progress retest lock:",Yt);const xr=`speaking_attempts_${ye.student_id}_${e.test_id}`;localStorage.removeItem(xr),console.log(" Cleared attempts from localStorage upon submission");const{clearTestData:Rr}=await ui(async()=>{const{clearTestData:yr}=await Promise.resolve().then(()=>Dp);return{clearTestData:yr}},void 0);Rr(ye.student_id,"speaking_test_data",e.test_id),console.log(" Cleared speaking test data from cache upon submission");try{const yr=`anti_cheating_${ye.student_id}_speaking_${e.test_id}`;localStorage.removeItem(yr),console.log(" Cleared anti-cheating key:",yr)}catch{}}console.log(" Caching speaking test results after submission...");const Be=`student_results_table_${ye?.student_id||ye?.id||"unknown"}`,{setCachedData:Pe,getCachedData:lt,CACHE_TTL:Ct,clearTestData:Lt}=await ui(async()=>{const{setCachedData:Bt,getCachedData:Yt,CACHE_TTL:xr,clearTestData:Rr}=await Promise.resolve().then(()=>Dp);return{setCachedData:Bt,getCachedData:Yt,CACHE_TTL:xr,clearTestData:Rr}},void 0),Ue={id:Date.now(),test_id:e.test_id,test_type:"speaking",test_name:e.test_name,score:Math.round(d.overall_score/10),max_score:10,percentage:d.overall_score,caught_cheating:!1,visibility_change_times:0,is_completed:!0,submitted_at:new Date().toISOString(),subject:"Listening and Speaking",teacher_name:e.teacher_name||"Unknown"};let st={success:!0,results:[],count:0};try{const Bt=lt(Be);Bt&&Array.isArray(Bt.results)&&(st.results=Bt.results.slice())}catch{}if(st.results.unshift(Ue),st.count=st.results.length,Pe(Be,st,Ct.student_results_table),console.log(" Speaking test results cached (merged) with key:",Be),ye?.student_id&&Lt(ye.student_id,"speaking",e.test_id),!!At&&ye?.student_id){let Bt=3;try{const Rr=localStorage.getItem(`student_active_tests_${ye.student_id}`);if(Rr){const Br=JSON.parse(Rr)?.tests?.find(me=>me.test_id===e.test_id&&me.test_type==="speaking");Br&&(Bt=Br.retest_attempts_left||Br.max_attempts||3)}}catch(Rr){console.error("Error checking active tests cache:",Rr)}const xr=(d?.overall_score??0)>=50;if(xr){const Rr=`retest_attempt${Bt}_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(Rr,"true"),console.log(" Passed retest, marking last-slot key:",Rr);let yr=0;for(let Ne=1;Ne<=10;Ne++){const be=`retest_attempt${Ne}_${ye.student_id}_speaking_${e.test_id}`;localStorage.getItem(be)==="true"&&yr++}const Br=`test_completed_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(Br,"true"),console.log(" Marked retest as completed (student passed):",Br);const me=`retest_attempts_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(me,JSON.stringify({used:yr,max:Bt})),console.log(" Set retest attempts metadata (student passed):",me,{used:yr,max:Bt})}else{let Rr=1;for(let be=1;be<=10;be++){const Ae=`retest_attempt${be}_${ye.student_id}_speaking_${e.test_id}`;if(localStorage.getItem(Ae)!=="true"){Rr=be;break}}const yr=`retest_attempt${Rr}_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(yr,"true"),console.log(" Marked retest attempt as completed:",yr);let Br=0;for(let be=1;be<=10;be++){const Ae=`retest_attempt${be}_${ye.student_id}_speaking_${e.test_id}`;localStorage.getItem(Ae)==="true"&&Br++}const me=Bt-Br,Ne=me<=0||xr;if(console.log(" Retest completion check:",{usedAttempts:Br,maxAttempts:Bt,attemptsLeft:me,passed:xr,shouldComplete:Ne}),Ne){const be=`test_completed_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(be,"true"),console.log(" Marked retest as completed (attempts exhausted or passed):",be);const Ae=`retest_attempts_${ye.student_id}_speaking_${e.test_id}`;localStorage.setItem(Ae,JSON.stringify({used:Br,max:Bt})),console.log(" Set retest attempts metadata (attempts exhausted):",Ae,{used:Br,max:Bt})}}}if(ye?.student_id){const Bt=`retest1_${ye.student_id}_speaking_${e.test_id}`,Yt=`retest_assignment_id_${ye.student_id}_speaking_${e.test_id}`;localStorage.removeItem(Bt),localStorage.removeItem(Yt)}try{n&&n(d.overall_score),typeof r=="function"&&r()}catch{}return}else throw new Error(ve.message||"Failed to submit speaking test")}catch(rt){console.error("Speaking test submission error:",rt),_(rt.message)}finally{g(!1)}}},[e,ye,Ie,c,d,i,T,t]);w.useCallback(()=>{a("completed"),t({test_id:e.test_id,transcript:c,scores:d,attempt_number:T})},[e.test_id,c,d,T,t]);const Ut=w.useCallback(()=>{console.log(" SpeakingTestStudent: handleExitConfirm called"),console.log(" SpeakingTestStudent: Current location:",window.location.href),console.log(" SpeakingTestStudent: Current history state:",window.history.state),C(!1);const rt=L.current;if(console.log(" SpeakingTestStudent: Pending navigation:",rt),L.current=null,e?.test_id&&ye?.student_id){const $e=`anti_cheating_${ye?.student_id||ye?.id||"unknown"}_speaking_${e.test_id}`,It=(Os($e)||{tabSwitches:0}).tabSwitches||0,At=It+1,tr=At>=2;console.log(" SpeakingTestStudent: Tab switch count:",It,"->",At),vs($e,{tabSwitches:At,isCheating:tr},hs.anti_cheating)}if(console.log(" SpeakingTestStudent: Disabling intercept"),te(!1),rt){console.log(" SpeakingTestStudent: Cleaning up intercept history state");try{const Oe=window.history.state;if(console.log(" SpeakingTestStudent: Current history state before cleanup:",Oe),Oe&&Oe.__intercept){const $e=Oe.prevState??null;console.log(" SpeakingTestStudent: Restoring previous state:",$e),window.history.replaceState($e,document.title,window.location.href),console.log(" SpeakingTestStudent: History state after cleanup:",window.history.state)}}catch(Oe){console.warn(" SpeakingTestStudent: Failed to restore history state:",Oe)}}console.log(" SpeakingTestStudent: Scheduling navigation in 100ms"),setTimeout(()=>{console.log(" SpeakingTestStudent: Executing navigation to /student"),console.log(" SpeakingTestStudent: Current location before navigation:",window.location.href),window.location.href="/student",console.log(" SpeakingTestStudent: window.location.href set to /student")},100)},[r,e,ye?.student_id,ye?.id]),ct=w.useCallback(()=>{const rt=L.current;L.current=null,rt?.cancel&&rt.cancel(),C(!1),s!=="completed"&&te(!0)},[s]),yt=()=>{switch(s){case"recording":return l.jsxs("div",{className:"speaking-test-recording",children:[l.jsx("h2",{className:`text-2xl font-bold mb-4 text-center ${X.text} ${W?"tracking-wider":""}`,style:W?{fontFamily:"monospace",textShadow:"0 0 10px rgba(0, 255, 255, 0.5), 0 0 20px rgba(0, 255, 255, 0.3)"}:Q?{...se.headerText}:{},children:W?e.test_name.toUpperCase():e.test_name}),l.jsxs("div",{className:"mb-6 text-center",children:[l.jsx("h3",{className:`text-lg font-semibold mb-2 ${W?"":X.text}`,style:W?{...se.textCyan,fontFamily:"monospace"}:Q?{...se.headerText}:{},children:W?"INSTRUCTIONS:":"Instructions:"}),l.jsx("p",{className:`mb-4 ${W?"":X.textSecondary}`,style:W?{color:fe.cyan,fontFamily:"monospace",...se.textShadow}:Q?{...se.textAccent}:{},children:e.prompt}),l.jsx("div",{className:`${W?"bg-cyan-400/10 border border-cyan-400/30":Q?"bg-pink-500/10 border border-pink-500/30":"bg-blue-50 border border-blue-200"} p-3 sm:p-4 rounded-lg`,children:l.jsxs("p",{className:`text-sm ${W?"text-cyan-300":Q?"text-pink-400":"text-blue-800"}`,style:Q?{...se.textAccent}:{},children:[l.jsx("strong",{children:"Requirements:"})," Minimum ",e.min_words||50," words, 0-",e.max_duration||600," seconds duration"]})})]}),l.jsx(ige,{ref:ut,onRecordingComplete:Te,minDuration:0,maxDuration:e.max_duration||600,minWords:e.min_words||50,maxAttempts:E,currentAttempt:T}),b&&l.jsx("div",{className:`mt-4 p-3 sm:p-4 ${Q?"bg-red-500/10 border border-red-500/50":"bg-red-50 border border-red-200"} rounded-lg`,style:Q?{...se.glowRed}:{},children:l.jsx("p",{className:Q?"text-red-400":"text-red-800",style:Q?{color:He.error,...se.textShadowRed}:{},children:b})})]});case"processing":return l.jsxs("div",{className:`transcription-status ${Q?hr(0).className:X.cardBg} rounded-lg shadow-lg p-4 sm:p-8 text-center ${Q?"":X.cardBorder} border`,style:Q?{...hr(0).style,borderColor:He.primary,...se.glow}:{},children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("div",{className:`text-6xl mb-4 ${X.textSecondary}`,children:""}),l.jsx("h3",{className:`text-2xl font-semibold mb-2 ${X.text}`,style:Q?{...se.headerText}:{},children:"Processing Your Speech"}),l.jsx("p",{className:`text-lg ${W?"text-cyan-400":Q?"text-pink-400":"text-blue-600"}`,style:Q?{...se.textPink}:{},children:"Please wait while we process your audio..."})]}),l.jsxs("div",{className:"inline-flex space-x-1",children:[l.jsx("div",{className:`w-2 h-2 rounded-full animate-bounce ${W?"bg-cyan-400":Q?"bg-pink-500":"bg-blue-600"}`,style:Q?{boxShadow:`0 0 8px ${He.primary}`}:{}}),l.jsx("div",{className:`w-2 h-2 rounded-full animate-bounce ${W?"bg-cyan-400":Q?"bg-pink-500":"bg-blue-600"}`,style:Q?{boxShadow:`0 0 8px ${He.primary}`,animationDelay:"0.1s"}:{animationDelay:"0.1s"}}),l.jsx("div",{className:`w-2 h-2 rounded-full animate-bounce ${W?"bg-cyan-400":Q?"bg-pink-500":"bg-blue-600"}`,style:Q?{boxShadow:`0 0 8px ${He.primary}`,animationDelay:"0.2s"}:{animationDelay:"0.2s"}})]})]});case"feedback":return console.log(" Rendering feedback step with Submit Final button"),l.jsx(oge,{transcript:c,scores:d,audioBlob:i,recordingTime:P,onReRecord:pt,onFinalSubmit:()=>x(!0),canReRecord:T<E,attemptNumber:T,maxAttempts:E,isSubmitting:h});case"error":return l.jsx("div",{className:`p-4 sm:p-6 rounded-lg ${W?"bg-red-900/50 border border-red-500":Q?"bg-red-500/10 border border-red-500/50":"bg-red-50 border border-red-200"}`,style:W?{...se.glowRed}:Q?{...se.shadow}:{},children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("span",{className:"text-2xl",children:""}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:`text-lg font-semibold mb-2 ${W||Q?"text-red-400":"text-red-800"}`,children:W?"ERROR: AI PROCESSING FAILED":"AI Processing Error"}),l.jsx("p",{className:`mb-4 ${W?"text-red-300 font-mono":Q?"text-red-300":"text-red-700"}`,children:B}),l.jsx("p",{className:`text-sm mb-4 ${W?"text-cyan-400 font-mono":Q?"text-gray-300":"text-gray-600"}`,children:'Your recording has been saved. Click "Resend" to try again.'}),l.jsx("button",{onClick:Ve,disabled:H,className:`w-full sm:w-auto px-6 py-4 rounded-full min-h-[48px] text-lg font-semibold flex items-center justify-center ${W?"bg-green-600 text-black font-mono":Q?"bg-green-500 text-white":"bg-green-600 text-white"} ${H?"opacity-50 cursor-not-allowed":""}`,style:W?{...se.glowGreen}:Q?{...se.shadow}:{},children:l.jsx("span",{children:H?W?"RESENDING...":"Resending...":W?"RESEND":"Resend"})})]})]})});case"completed":const rt={showResults:!0,testInfo:{test_name:e?.test_name||"Speaking Test",id:e?.test_id,test_id:e?.test_id},testType:"speaking",score:d?.overall_score||0,totalQuestions:1,percentage:d?.overall_score||0,passed:(d?.overall_score||0)>=50,questionAnalysis:[{questionNumber:1,userAnswer:c,correctAnswer:"Speaking test completed",isCorrect:!0,score:d?.overall_score||0,maxScore:100,feedback:`Word Count: ${d?.word_count||0}, Grammar: ${d?.grammar_score||0}/40, Vocabulary: ${d?.vocab_score||0}/30`}],timestamp:new Date().toISOString(),caught_cheating:!1,visibility_change_times:0};return l.jsx("div",{className:"speaking-test-completed",children:l.jsx(Q2,{testResults:rt,onBackToCabinet:()=>{L.current=null,C(!0)},onRetakeTest:()=>{a("recording"),u(""),f(null),o(null),Z("audio/webm"),N(1)},isLoading:!1})});default:return null}};return l.jsxs("div",{className:"max-w-4xl mx-auto py-6 px-0 sm:p-6",children:[l.jsx(Ds,{isOpen:p&&!h,onClose:()=>x(!1),title:"Submit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:`${X.textSecondary} mb-6`,children:"Are you sure you want to submit?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>x(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:()=>{x(!1),wt()},variant:"primary",className:W?"":Q?"bg-pink-500 text-white hover:bg-pink-600":"",style:W?{backgroundColor:fe.black,borderColor:fe.cyan,color:fe.cyan,fontFamily:"monospace",borderWidth:"2px",...se.glow}:Q?{backgroundColor:He.primary,color:He.white,...se.glow}:{},children:W?"SUBMIT":"Submit"})]})]})}),l.jsx(Ds,{isOpen:v,onClose:ct,title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:`${X.textSecondary} mb-6`,children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:ct,variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:rt=>{console.log(" SpeakingTestStudent: Go Back button clicked in modal"),console.log(" SpeakingTestStudent: Button click event:",rt),Ut()},variant:"primary",children:"Go Back"})]})]})}),l.jsxs("div",{className:`${Q?hr(0).className:X.cardBg} rounded-lg shadow-sm py-3 px-0 sm:p-6 ${Q?"":X.cardBorder} border`,style:Q?{...hr(0).style,borderColor:He.primary}:{},children:[b&&l.jsx("div",{className:`mb-4 p-4 ${Q?"bg-red-500/10 border border-red-500/50":"bg-red-50 border border-red-200"} rounded-lg`,style:Q?{...se.glowRed}:{},children:l.jsx("p",{className:Q?"text-red-400":"text-red-800",style:Q?{color:He.error,...se.textShadowRed}:{},children:b})}),yt()]})]})},gge=e=>function(){var t=e+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296},pge=(e,t,r)=>{if(e.length===1)return e[0];const n=`${r}:speaking:${t}`,s=Array.from(n).reduce((o,c)=>(o<<5)-o+c.charCodeAt(0),0)>>>0,a=gge(s),i=Math.floor(a()*e.length);return e[i]},xge=()=>{const{testId:e}=E2(),t=Za(),{user:r}=ws(),n=tc(),{showNotification:s}=Ls(),[a,i]=w.useState(null),[o,c]=w.useState([]),[u,d]=w.useState(null),[f,h]=w.useState(!0),[g,p]=w.useState(null),[x,v]=w.useState(!1),[C,b]=w.useState(null),[_,T]=w.useState(!1),{startTracking:N,stopTracking:E}=D1("speaking",e,r?.student_id||r?.id);w.useEffect(()=>{F(),j()},[e]),w.useEffect(()=>{if(a&&!x){_e.debug(" Speaking test - initializing anti-cheating tracking");const B=r?.student_id||r?.id||"unknown",J=`anti_cheating_${B}_speaking_${e}`,z=localStorage.getItem(J);if(_e.debug(" Checking for anti-cheating data with key:",J),_e.debug(" Key format: anti_cheating_{studentId}_{testType}_{testId}"),_e.debug(" Current test details:",{testType:"speaking",testId:e,studentId:B}),z)try{const q=JSON.parse(z);_e.debug(" Found existing anti-cheating data for THIS speaking test:",q),_e.debug(" Visibility change times for this test:",q.tabSwitches||0),_e.debug(" Cheating status for this test:",q.isCheating||!1),q.isCheating&&(_e.debug(" WARNING: Student has been flagged for cheating in THIS speaking test!"),_e.debug(" Tab switches detected in this test:",q.tabSwitches),s(` Warning: Suspicious activity detected in this speaking test (${q.tabSwitches} tab switches). Continued violations may result in test disqualification.`,"warning"))}catch(q){_e.error(" Error parsing existing anti-cheating data:",q)}else _e.debug(" No existing anti-cheating data found for this speaking test - starting fresh");N(),_e.debug(" Anti-cheating tracking started for speaking test")}return()=>{a&&(_e.debug(" Cleaning up anti-cheating tracking for speaking test"),E())}},[a,x,e,r?.student_id,r?.id,N,E,s]);const F=async()=>{try{h(!0);const B=await n.getSpeakingTest(e);if(B.success)i(B.test);else throw new Error(B.message||"Failed to load test");const J=await n.getSpeakingTestQuestions(e);if(J.success){const z=J.questions;c(z);const q=r?.student_id||r?.id,H=pge(z,e,q);d(H),_e.debug(" Selected question for student:",{studentId:q,testId:e,totalQuestions:z.length,selectedQuestion:H?.id,selectedPrompt:H?.prompt?.substring(0,50)+"..."})}}catch(B){_e.error("Error loading test data:",B),p(B.message)}finally{h(!1)}},j=()=>{const J=`test_completed_${r?.student_id||r?.id}_speaking_${e}`;if(localStorage.getItem(J)==="true"){v(!0);const q=localStorage.getItem(`speaking_test_result_${e}`);q&&b(JSON.parse(q))}},P=async B=>{try{v(!0),b(B),localStorage.setItem(`speaking_test_result_${e}`,JSON.stringify(B)),window.dispatchEvent(new CustomEvent("testCompleted",{detail:{testId:e,testType:"speaking"}})),setTimeout(()=>{t("/student")},2e3)}catch(J){_e.error("Error handling test completion:",J)}},M=()=>{if(_e.debug(" Navigating back to cabinet from speaking test..."),a&&r?.student_id){_e.debug(" Cabinet navigation detected - counting as cheating attempt");const J=`anti_cheating_${r?.student_id||r?.id||"unknown"}_speaking_${e}`,z=localStorage.getItem(J);let q=0,H=!1;if(z)try{const W=JSON.parse(z);q=W.tabSwitches||0,H=W.isCheating||!1}catch(W){_e.error(" Error parsing existing anti-cheating data:",W)}const R=q+1,L=R>=2;_e.debug(` Tab switch count: ${q}  ${R} (cheating: ${L})`);const G={tabSwitches:R,isCheating:L,lastUpdated:new Date().toISOString()};localStorage.setItem(J,JSON.stringify(G)),_e.debug(" Anti-cheating data updated for cabinet navigation:",G)}t("/student")},{theme:I,isCyberpunk:U,isKpop:K,themeClasses:te}=da(),re=ua(I);if(f)return l.jsxs("div",{className:`min-h-screen overflow-y-auto ${U?"bg-gradient-to-br from-black via-gray-900 to-purple-900":K?"bg-black":"bg-white"}`,style:U?re.background:K?re.backgroundSecondary:{},children:[l.jsx("div",{className:`${K?"":te.headerBg} shadow-sm border-b ${K?"":te.headerBorder}`,style:U?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:K?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${te.headerText}`,style:K?{...re.headerText}:{},children:"Speaking Test"})}),l.jsx(at,{variant:"outline",onClick:()=>T(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`inline-block animate-spin rounded-full h-8 w-8 border-b-2 ${U?"border-cyan-400":"border-blue-600"}`}),l.jsx("p",{className:`${te.textSecondary} mt-4`,children:"Loading speaking test..."})]})})})]});if(g)return l.jsxs("div",{className:`min-h-screen overflow-y-auto ${U?"bg-gradient-to-br from-black via-gray-900 to-purple-900":K?"bg-black":"bg-white"}`,style:U?re.background:K?re.backgroundSecondary:{},children:[l.jsx("div",{className:`${K?"":te.headerBg} shadow-sm border-b ${K?"":te.headerBorder}`,style:U?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:K?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${te.headerText}`,style:K?{...re.headerText}:{},children:"Speaking Test"})}),l.jsx(at,{variant:"outline",onClick:()=>T(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`text-6xl mb-4 ${U?"text-red-400":"text-red-600"}`,children:""}),l.jsx("h2",{className:`text-2xl font-bold ${te.text} mb-2`,children:"Error Loading Test"}),l.jsx("p",{className:`${te.textSecondary} mb-6`,children:g})]})})})]});if(x&&C)return l.jsxs("div",{className:`min-h-screen overflow-y-auto ${U?"bg-gradient-to-br from-black via-gray-900 to-purple-900":K?"bg-black":"bg-white"}`,style:U?re.background:K?re.backgroundSecondary:{},children:[l.jsx("div",{className:`${K?"":te.headerBg} shadow-sm border-b ${K?"":te.headerBorder}`,style:U?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:K?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${te.headerText}`,style:K?{...re.headerText}:{},children:"Speaking Test Results"})}),l.jsx(at,{variant:"outline",onClick:()=>T(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx(Q2,{testType:"speaking",testData:a,result:C,onRetake:()=>{v(!1),b(null);const B=JSON.parse(localStorage.getItem("userData")||"{}").student_id;localStorage.removeItem(`test_completed_${B}_speaking_${e}`)}})})]});if(!a||o.length===0)return l.jsxs("div",{className:`min-h-screen overflow-y-auto ${U?"bg-gradient-to-br from-black via-gray-900 to-purple-900":K?"bg-black":"bg-white"}`,style:U?re.background:K?re.backgroundSecondary:{},children:[l.jsx("div",{className:`${K?"":te.headerBg} shadow-sm border-b ${K?"":te.headerBorder}`,style:U?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:K?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${te.headerText}`,style:K?{...re.headerText}:{},children:"Speaking Test"})}),l.jsx(at,{variant:"outline",onClick:()=>T(!0),children:"Back to Cabinet"})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:`text-6xl mb-4 ${te.textSecondary}`,children:""}),l.jsx("h2",{className:`text-2xl font-bold ${te.text} mb-2`,children:"No Test Data"}),l.jsx("p",{className:`${te.textSecondary} mb-6`,children:"Unable to load test information"})]})})})]});const Z=u;return l.jsxs("div",{className:`min-h-screen overflow-y-auto ${U?"bg-gradient-to-br from-black via-gray-900 to-purple-900":K?"bg-black":"bg-gray-50"}`,style:U?re.background:K?re.backgroundSecondary:{},children:[l.jsx(Ds,{isOpen:_,onClose:()=>T(!1),title:"Exit Speaking Test",size:"small",children:l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-gray-600 mb-6",children:"Are you sure you want to go back to cabinet?"}),l.jsxs("div",{className:"flex gap-3 justify-center",children:[l.jsx(at,{onClick:()=>T(!1),variant:"secondary",children:"Cancel"}),l.jsx(at,{onClick:()=>{T(!1),M()},variant:"primary",children:"Go Back"})]})]})}),l.jsx("div",{className:`${K?"":te.headerBg} shadow-sm border-b ${K?"":te.headerBorder}`,style:U?{boxShadow:"0 0 20px rgba(0, 255, 255, 0.5), 0 0 40px rgba(0, 255, 255, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.1)"}:K?{backgroundColor:He.background,borderBottom:`2px solid ${He.primary}`,boxShadow:"0 0 30px rgba(236, 72, 153, 0.8), 0 0 60px rgba(236, 72, 153, 0.6), 0 0 90px rgba(236, 72, 153, 0.4), inset 0 0 40px rgba(236, 72, 153, 0.5), inset 0 0 80px rgba(236, 72, 153, 0.3), inset 0 0 120px rgba(236, 72, 153, 0.15)"}:{},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsx("div",{children:l.jsx("h1",{className:`text-2xl font-bold ${te.headerText}`,style:K?{...re.headerText}:{},children:"Speaking Test"})}),l.jsx(at,{variant:"outline",onClick:()=>T(!0),children:"Back to Cabinet"})]})})}),l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[o.length>1&&u&&l.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-5 h-5 bg-blue-500 rounded-full flex items-center justify-center",children:l.jsx("span",{className:"text-white text-xs font-bold",children:"i"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Question Selection"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["This test has ",o.length," questions. You have been assigned ",l.jsxs("strong",{children:["Question ",u.question_number]}),"."]})})]})]})}),l.jsx(mge,{testData:{...a,test_id:parseInt(e),question_id:Z?.id,prompt:Z?.prompt,start_time:Date.now()},onComplete:P,onExit:M,onTestComplete:P})]})]})},yge=()=>{const e="https://mini-game-socket.onrender.com";return e.includes("/ws")?e:e.endsWith("/")?`${e}ws`:`${e}/ws`};function YV(e,t,r){const[n,s]=w.useState(!1),[a,i]=w.useState(null),[o,c]=w.useState(null),u=w.useRef(null),d=w.useRef(0),f=10,h=1e3,g=w.useRef(null),p=w.useRef(null),x=w.useRef(new Map),v=w.useRef(null),C=w.useCallback(F=>{g.current=setInterval(()=>{F.readyState===WebSocket.OPEN&&(F.send(JSON.stringify({type:"ping"})),p.current=setTimeout(()=>{console.log("No pong received, closing connection"),F.close()},1e4))},3e4)},[]),b=w.useCallback(()=>{if(d.current>=f){i("Max reconnection attempts reached");return}d.current++;const F=Math.min(h*Math.pow(2,d.current-1),6e4);console.log(`Reconnecting in ${F}ms (attempt ${d.current})`),setTimeout(()=>{v.current&&v.current()},F)},[]),_=w.useCallback(()=>{if(!e||!t){console.warn("[WebSocket] Cannot connect: missing sessionCode or userId",{sessionCode:e,userId:t});return}u.current&&(u.current.close(),u.current=null);const j=`${yge()}?session=${e}&userId=${t}&role=${r||"student"}`;console.log("[WebSocket] Connecting to:",j);try{const P=new WebSocket(j);P.onopen=()=>{console.log("WebSocket connected"),s(!0),i(null),d.current=0,C(P)},P.onmessage=M=>{try{const I=JSON.parse(M.data);if(console.log("[WebSocket] ========== RAW MESSAGE RECEIVED =========="),console.log("[WebSocket] Message type:",I.type),console.log("[WebSocket] Full message:",I),c(I),I.type==="pong"){clearTimeout(p.current);return}const U=x.current.get(I.type)||[];console.log(`[WebSocket] Found ${U.length} handlers for type: ${I.type}`),I.type==="spell-cast"&&(console.log("[WebSocket] ========== SPELL-CAST MESSAGE DETECTED =========="),console.log("[WebSocket] Spell-cast data:",I),console.log("[WebSocket] Number of handlers:",U.length)),I.type==="spell-hit"&&(console.log("[WebSocket] Spell-hit message received:",I),console.log(`[WebSocket] Found ${U.length} handlers for spell-hit`)),U.forEach((K,te)=>{try{console.log(`[WebSocket] Calling handler ${te+1}/${U.length} for ${I.type}`),K(I)}catch(re){console.error(`[WebSocket] Error in handler ${te+1} for ${I.type}:`,re)}})}catch(I){console.error("[WebSocket] Error parsing message:",I,M.data)}},P.onerror=M=>{console.error("WebSocket error:",M),i("Connection error")},P.onclose=M=>{const I=M.code,U=M.reason||"No reason provided",K=M.wasClean;console.log(`WebSocket closed: code=${I}, reason=${U}, wasClean=${K}`),s(!1),T(),I!==1e3&&I!==1001&&!K?(console.log("Connection closed unexpectedly, will attempt to reconnect"),b()):console.log("Connection closed cleanly, not reconnecting")},u.current=P}catch(P){console.error("[WebSocket] Failed to create WebSocket:",P),i("Failed to create WebSocket connection")}},[e,t,r,C,b]);v.current=_;const T=()=>{g.current&&(clearInterval(g.current),g.current=null),p.current&&(clearTimeout(p.current),p.current=null)},N=w.useCallback((F,j)=>{if(u.current&&u.current.readyState===WebSocket.OPEN){const P={type:F,payload:j};console.log("[WebSocket] Sending message:",P),u.current.send(JSON.stringify(P))}else console.warn("[WebSocket] Not connected, cannot send message",{readyState:u.current?.readyState,type:F,payload:j})},[]),E=w.useCallback((F,j)=>(x.current.has(F)||x.current.set(F,[]),x.current.get(F).push(j),()=>{const P=x.current.get(F);if(P){const M=P.indexOf(j);M>-1&&P.splice(M,1)}}),[]);return w.useEffect(()=>(_(),()=>{T(),u.current&&u.current.close()}),[_]),{isConnected:n,error:a,lastMessage:o,sendMessage:N,onMessage:E}}function vge(e,t,r,n,s){return new Promise((a,i)=>{const o=[],c=document.createElement("canvas");c.width=t,c.height=r;const u=c.getContext("2d");let d=0,f=!1;if(s.length===0){a(o);return}if(!e||!e.complete||e.naturalWidth===0){i(new Error("Sprite sheet image not loaded"));return}s.forEach(h=>{try{const g=Math.floor(h/n),x=h%n*t,v=g*r;(x+t>e.width||v+r>e.height)&&console.warn(`Frame ${h} extends beyond sprite sheet bounds. Sheet: ${e.width}x${e.height}, Frame: ${x},${v} ${t}x${r}`),u.clearRect(0,0,t,r),u.drawImage(e,x,v,t,r,0,0,t,r);const C=new Image;C.onerror=()=>{f||(f=!0,i(new Error(`Failed to create frame image for frame ${h}`)))},C.onload=()=>{d++,d===s.length&&!f&&a(o)},C.src=c.toDataURL(),o.push(C)}catch(g){f||(f=!0,i(g))}})})}function QS(){const e=w.useRef(new Map),t=w.useCallback(s=>new Promise((a,i)=>{let o=s;if(s&&!s.startsWith("http://")&&!s.startsWith("https://")&&!s.startsWith("/")&&!s.startsWith("data:")&&(o=`/${s}`),e.current.has(s)){a(e.current.get(s));return}const c=new Image;c.crossOrigin="anonymous",c.onload=()=>{e.current.set(s,c),a(c)},c.onerror=u=>{console.error(`Failed to load image: ${o} (original: ${s})`,u),i(new Error(`Failed to load image: ${o}`))},c.src=o}),[]),r=w.useCallback(async(s,a,i,o,c)=>{const u=`${s}_${a}_${i}_${o}_${c.join(",")}`;if(e.current.has(u))return e.current.get(u);const d=await t(s),f=await vge(d,a,i,o,c);return e.current.set(u,f),f},[t]),n=w.useCallback(async s=>{const a=s.map(i=>t(i));return Promise.all(a)},[t]);return{loadImage:t,loadSpriteSheet:r,loadMultipleImages:n}}const k_={archer:{gender:"men",spriteSheet:"Archer_spritelist.png",frameWidth:48,frameHeight:48,framesPerRow:14,animations:{idle:{file:"Idle.png",numFrames:6,frameDuration:500},walk:{file:"Walk.png",numFrames:8,frameDuration:200},run:{file:"Walk.png",numFrames:8,frameDuration:150},attack:{file:"Shot_1.png",numFrames:14,frameDuration:200},hurt:{file:"Hurt.png",numFrames:3,frameDuration:300},dead:{file:"Dead.png",numFrames:3,frameDuration:0}}},swordsman:{gender:"men",spriteSheet:null,frameWidth:64,frameHeight:64,framesPerRow:null,animations:{idle:{file:"Idle.png",numFrames:8,frameDuration:500},walk:{file:"Walk.png",numFrames:8,frameDuration:200},run:{file:"Walk.png",numFrames:8,frameDuration:150},attack:{file:"Attack_1.png",numFrames:6,frameDuration:200},hurt:{file:"Hurt.png",numFrames:3,frameDuration:300},dead:{file:"Dead.png",numFrames:3,frameDuration:0}}},wizard:{gender:"men",spriteSheet:null,frameWidth:64,frameHeight:64,framesPerRow:null,animations:{idle:{file:"Idle.png",numFrames:6,frameDuration:500},walk:{file:"Walk.png",numFrames:7,frameDuration:200},run:{file:"Walk.png",numFrames:7,frameDuration:150},attack:{file:"Attack_1.png",numFrames:10,frameDuration:200},hurt:{file:"Hurt.png",numFrames:4,frameDuration:300},dead:{file:"Dead.png",numFrames:4,frameDuration:0}}},enchantress:{gender:"women",spriteSheet:null,frameWidth:64,frameHeight:64,framesPerRow:null,animations:{idle:{file:"Idle.png",numFrames:5,frameDuration:500},walk:{file:"Walk.png",numFrames:8,frameDuration:200},run:{file:"Walk.png",numFrames:8,frameDuration:150},attack:{file:"Attack_1.png",numFrames:6,frameDuration:200},hurt:{file:"Hurt.png",numFrames:2,frameDuration:300},dead:{file:"Dead.png",numFrames:5,frameDuration:0}}},knight:{gender:"women",spriteSheet:null,frameWidth:64,frameHeight:64,framesPerRow:null,animations:{idle:{file:"Idle.png",numFrames:6,frameDuration:500},walk:{file:"Walk.png",numFrames:8,frameDuration:200},run:{file:"Walk.png",numFrames:8,frameDuration:150},attack:{file:"Attack_1.png",numFrames:5,frameDuration:200},hurt:{file:"Hurt.png",numFrames:3,frameDuration:300},dead:{file:"Dead.png",numFrames:4,frameDuration:0}}},musketeer:{gender:"women",spriteSheet:null,frameWidth:64,frameHeight:64,framesPerRow:null,animations:{idle:{file:"Idle.png",numFrames:5,frameDuration:500},walk:{file:"Walk.png",numFrames:8,frameDuration:200},run:{file:"Walk.png",numFrames:8,frameDuration:150},attack:{file:"Attack_1.png",numFrames:5,frameDuration:200},hurt:{file:"Hurt.png",numFrames:2,frameDuration:300},dead:{file:"Dead.png",numFrames:4,frameDuration:0}}}},zO=[{id:"archer",name:"Archer"},{id:"swordsman",name:"Swordsman"},{id:"wizard",name:"Wizard"},{id:"enchantress",name:"Enchantress"},{id:"knight",name:"Knight"},{id:"musketeer",name:"Musketeer"}],bge=({studentNickname:e,onSelect:t,onJoinLobby:r,hasSelectedCharacter:n})=>{const[s,a]=w.useState(null),[i,o]=w.useState({}),[c,u]=w.useState({}),{loadSpriteSheet:d,loadImage:f}=QS(),h=w.useRef({});w.useEffect(()=>{(async()=>{const x={},v={};for(const C of zO)try{const b=k_[C.id];if(!b)continue;const _=C.id.charAt(0).toUpperCase()+C.id.slice(1),T=b.animations.idle;let N,E,F,j=b.frameWidth,P=b.frameHeight;if(T.file){N=`Art/Characters/${b.gender}/${_}/${T.file}`;const M=T.numFrames||6;E=M,F=Array.from({length:M},(I,U)=>U);try{const I=await f(N),U=Math.floor(I.width/M),K=I.height;console.log(`${C.id} Idle.png dimensions: ${I.width}x${I.height}, calculated frame: ${U}x${K}`),Math.abs(U-j)>5&&(console.log(`Using calculated frame dimensions: ${U}x${K} (config had ${j}x${P})`),j=U,P=K)}catch(I){console.warn(`Could not pre-check image dimensions for ${C.id}:`,I)}}else if(T.frameIndices&&b.spriteSheet)N=`Art/Characters/${b.gender}/${_}/${b.spriteSheet}`,E=b.framesPerRow||14,F=T.frameIndices;else{N=b.spriteSheet?`Art/Characters/${b.gender}/${_}/${b.spriteSheet}`:`Art/Characters/${b.gender}/${_}/Idle.png`;const M=T.numFrames||6;E=M,F=Array.from({length:M},(I,U)=>U)}try{const M=await d(N,j,P,E,F);console.log(`Loaded ${M.length} frames for ${C.id} from ${N} (expected ${F.length})`),M.length!==F.length&&console.warn(`Frame count mismatch for ${C.id}: got ${M.length}, expected ${F.length}`),x[C.id]=M}catch(M){console.error(`Failed to extract frames for ${C.id}:`,M)}v[C.id]=0}catch(b){console.error(`Failed to load character ${C.id}:`,b)}o(x),u(v)})()},[d]),w.useEffect(()=>(Object.keys(i).forEach(p=>{const x=i[p];if(!x||x.length===0)return;const C=k_[p]?.animations?.idle?.frameDuration||500;h.current[p]=setInterval(()=>{u(b=>({...b,[p]:((b[p]||0)+1)%x.length}))},C)}),()=>{Object.values(h.current).forEach(p=>{clearInterval(p)}),h.current={}}),[i]);const g=p=>{a(p),t(p)};return l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-4xl w-full",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx(Ze.h1,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-4xl font-bold text-white mb-2",children:"Choose Your Champion"}),l.jsxs(Ze.p,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-xl text-gray-300",children:["Welcome, ",e,"!"]})]}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:zO.map((p,x)=>l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:x*.1},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>g(p.id),className:`
                relative cursor-pointer rounded-lg overflow-hidden
                ${s===p.id?"ring-4 ring-yellow-400 shadow-2xl":"ring-2 ring-gray-600 hover:ring-yellow-500"}
                bg-gradient-to-br from-gray-800 to-gray-900
                transition-all duration-300
              `,children:[l.jsx("div",{className:"aspect-square flex items-center justify-center bg-gray-900 p-4",children:i[p.id]&&i[p.id].length>0?(()=>{const v=c[p.id]||0,C=i[p.id][v];return C?l.jsx("img",{src:C.src,alt:p.name,className:"max-w-full max-h-full object-contain",style:{imageRendering:"pixelated"}}):l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-400"})})})():l.jsx("div",{className:"w-full h-full flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-yellow-400"})})}),l.jsx("div",{className:"p-4 bg-gray-800 text-center",children:l.jsx("h3",{className:"text-lg font-semibold text-white",children:p.name})}),s===p.id&&l.jsx(Ze.div,{initial:{scale:0},animate:{scale:1},className:"absolute top-2 right-2 bg-yellow-400 rounded-full p-2",children:l.jsx("svg",{className:"w-6 h-6 text-gray-900",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},p.id))}),l.jsx(Ze.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},className:"text-center mt-8 text-gray-400",children:s?'Click "Join Lobby" to continue':"Click on a character to select"}),s&&l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"mt-6 text-center",children:[l.jsx(Ze.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{console.log("[CharacterSelection] Join Lobby button clicked",{selectedId:s,onJoinLobby:!!r}),r?r():console.error("[CharacterSelection] onJoinLobby is not defined")},disabled:!r,className:`px-8 py-4 text-white font-bold text-lg rounded-lg shadow-lg transition-all ${r?"bg-gradient-to-r from-green-500 to-emerald-600 hover:from-green-600 hover:to-emerald-700 cursor-pointer":"bg-gray-500 cursor-not-allowed opacity-50"}`,children:"Join Lobby"}),!r&&l.jsx("p",{className:"text-red-400 text-sm mt-2",children:"Error: Join function not available"})]})]})})},wge=({players:e,studentNickname:t,onStartGame:r,isTeacher:n=!1})=>l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-2xl w-full",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx(Ze.h1,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-4xl font-bold text-white mb-2",children:"Game Lobby"}),l.jsx(Ze.p,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1},className:"text-xl text-gray-300",children:n?"Waiting for players to join...":"Waiting for game to start..."})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-800 to-indigo-900 rounded-2xl p-6 shadow-2xl mb-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-white mb-4",children:["Players (",e.length,")"]}),l.jsx("div",{className:"space-y-3",children:e.length===0?l.jsx("p",{className:"text-gray-400 text-center py-8",children:"No players in lobby yet..."}):e.map((s,a)=>l.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:a*.1},className:`flex items-center justify-between p-4 rounded-lg ${s.studentNickname===t?"bg-yellow-500 bg-opacity-30 border-2 border-yellow-400":"bg-gray-700 bg-opacity-50"}`,children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-lg",children:a+1}),l.jsxs("div",{children:[l.jsxs("p",{className:"text-white font-semibold text-lg",children:[s.studentNickname||s.studentName,s.studentNickname===t&&l.jsx("span",{className:"ml-2 text-yellow-400 text-sm",children:"(You)"})]}),s.selectedCharacter&&l.jsxs("p",{className:"text-gray-400 text-sm capitalize",children:["Character: ",s.selectedCharacter]})]})]}),s.selectedCharacter&&l.jsx("div",{className:"text-green-400",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]},s.studentId))})]}),n&&e.length>0&&l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"text-center",children:l.jsxs(at,{onClick:r,className:"px-8 py-4 text-lg font-bold bg-green-600 hover:bg-green-700",children:["Start Game (",e.length," ",e.length===1?"player":"players",")"]})}),!n&&l.jsxs(Ze.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"text-center",children:[l.jsx("div",{className:"inline-block",children:l.jsx(Ze.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-yellow-400 border-t-transparent rounded-full mx-auto mb-4"})}),l.jsx("p",{className:"text-gray-400",children:"The teacher will start the game when ready..."})]})]})}),_ge=({questions:e,onAnswer:t,cardAnswers:r,damage:n})=>{const[s,a]=w.useState(0),[i,o]=w.useState(null),[c,u]=w.useState(new Set),[d,f]=w.useState(!1),h=e[s],g=c.has(h?.question_id);w.useEffect(()=>{f(!1)},[s]),w.useEffect(()=>{r.length>0&&!d&&r[r.length-1].questionId===h?.question_id&&s<e.length-1&&(f(!0),setTimeout(()=>{a(b=>b<e.length-1?b+1:b),o(null)},2e3))},[r,s,h?.question_id,e.length,d]);const p=v=>{g||(o(v),u(C=>new Set([...C,h.question_id])),t(h.question_id,v))},x=v=>{if(!g)return i===v?"bg-yellow-500 hover:bg-yellow-600":"bg-blue-600 hover:bg-blue-700";const C=h.correct_answer===v,b=i===v;return C?"bg-green-500":b&&!C?"bg-red-500":"bg-gray-600"};return h?l.jsx("div",{className:"min-h-screen flex flex-col p-4",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"flex-1 flex flex-col w-full max-w-6xl mx-auto",children:[l.jsxs("div",{className:"mb-4",children:[l.jsxs("div",{className:"flex justify-between text-white mb-2",children:[l.jsxs("span",{children:["Question ",s+1," of 3"]}),l.jsxs("span",{children:["Damage: ",n]})]}),l.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:l.jsx(Ze.div,{initial:{width:0},animate:{width:`${(s+1)/3*100}%`},className:"bg-yellow-400 h-2 rounded-full"})})]}),l.jsxs("div",{className:"flex-1 flex flex-col justify-center bg-gradient-to-br from-purple-800 to-indigo-900 rounded-2xl p-8 shadow-2xl mb-4",children:[h.question_image_url?l.jsx("div",{className:"mb-4 flex justify-center",children:l.jsx("img",{src:h.question_image_url,alt:"Question",className:"max-h-64 rounded-lg"})}):null,l.jsx("h2",{className:"text-3xl font-bold text-white text-center",children:Ms(h.question_text||"")}),g&&l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-6 text-center",children:i===h.correct_answer?l.jsx("div",{className:"text-green-400 text-2xl font-bold",children:" Correct! +5 damage"}):l.jsxs("div",{className:"text-red-400 text-2xl font-bold",children:[" Wrong! The correct answer is ",h.correct_answer]})})]}),l.jsx("div",{className:"flex-1 grid grid-cols-2 gap-4",children:["A","B","C","D"].map(v=>{const C=h[`option_${v.toLowerCase()}`];return C?l.jsxs(Ze.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>p(v),disabled:g,className:`
                  p-6 rounded-xl text-white font-semibold
                  transition-all duration-200
                  flex flex-col items-center justify-center
                  ${x(v)}
                  ${g?"cursor-not-allowed":"cursor-pointer"}
                `,children:[l.jsx("span",{className:"text-3xl font-bold mb-2",children:v}),l.jsx("span",{className:"text-lg text-center",children:Ms(C)})]},v):null})})]},h.question_id)}):l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx("div",{className:"text-white text-xl",children:"Loading questions..."})})},Sge=({onEnterQueue:e,correctAnswers:t,finalDamage:r})=>{const[n,s]=w.useState(!1);return w.useEffect(()=>{const a=setTimeout(()=>{s(!0),e()},2e3);return()=>clearTimeout(a)},[e]),l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-2xl w-full text-center",children:[l.jsxs("div",{className:"bg-gradient-to-br from-purple-800 to-indigo-900 rounded-2xl p-8 shadow-2xl mb-6",children:[l.jsx("h2",{className:"text-3xl font-bold text-white mb-6",children:"Cards Complete!"}),l.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[l.jsx("div",{className:"text-4xl font-bold text-yellow-400 mb-2",children:t}),l.jsx("div",{className:"text-gray-300",children:"Correct Answers"})]}),l.jsxs("div",{className:"bg-gray-800 rounded-lg p-4",children:[l.jsx("div",{className:"text-4xl font-bold text-red-400 mb-2",children:r}),l.jsx("div",{className:"text-gray-300",children:"Total Damage"})]})]})]}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-gradient-to-br from-blue-800 to-cyan-900 rounded-2xl p-8 shadow-2xl",children:n?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"flex justify-center mb-4",children:l.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-white"})}),l.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Finding Opponent..."}),l.jsx("p",{className:"text-gray-300",children:"Please wait while we match you with another player"})]}):l.jsxs(l.Fragment,{children:[l.jsx("h3",{className:"text-2xl font-bold text-white mb-2",children:"Entering Queue"}),l.jsx("p",{className:"text-gray-300",children:"Preparing to find your opponent..."})]})})]})})},WO=({characterId:e,position:t,isMoving:r,direction:n,isAttacking:s=!1,isHurt:a=!1,isDead:i=!1})=>{const[o,c]=w.useState("idle"),[u,d]=w.useState(0),[f,h]=w.useState({}),{loadSpriteSheet:g,loadImage:p}=QS(),x=w.useRef(null),v=k_[e]||k_.archer,C=v.gender;w.useEffect(()=>{(async()=>{const F={},{animations:j}=v;for(const[P,M]of Object.entries(j))try{const I=e.charAt(0).toUpperCase()+e.slice(1);let U,K,te=v.frameWidth,re=v.frameHeight;if(M.file){U=`Art/Characters/${C}/${I}/${M.file}`;const B=M.numFrames||2;K=B;try{const J=await p(U),z=Math.floor(J.width/B),q=J.height;console.log(`${e} ${P} ${M.file} dimensions: ${J.width}x${J.height}, calculated frame: ${z}x${q}`),Math.abs(z-te)>5&&(console.log(`Using calculated frame dimensions for ${P}: ${z}x${q} (config had ${te}x${re})`),te=z,re=q)}catch(J){console.warn(`Could not pre-check image dimensions for ${e} ${P}:`,J)}}else v.spriteSheet?(U=`Art/Characters/${C}/${I}/${v.spriteSheet}`,K=v.framesPerRow||14):(U=`Art/Characters/${C}/${I}/${M.file}`,K=M.framesPerRow||v.framesPerRow||14);let Z;if(M.frameIndices&&M.frameIndices.length>0)Z=await g(U,te,re,K,M.frameIndices);else{const B=M.numFrames||2,J=Array.from({length:B},(z,q)=>q);Z=await g(U,te,re,K,J)}F[P]={frames:Z,frameDuration:M.frameDuration}}catch(I){console.error(`Failed to load ${e} ${P} sprite sheet:`,I),F[P]=null}h(F)})()},[e,v,g]),w.useEffect(()=>{c(i?"dead":a?"hurt":s?"attack":r?"walk":"idle")},[r,s,a,i]),w.useEffect(()=>{const E=f[o];if(!E||!E.frames||E.frames.length===0)return;const F=E.frames.length,j=E.frameDuration||(o==="attack"?150:o==="hurt"?300:o==="dead"?0:500);if(j===0){d(0);return}return x.current=setInterval(()=>{d(P=>{const M=(P+1)%F;return o==="attack"&&M===0?(c("idle"),0):M})},j),()=>{x.current&&clearInterval(x.current)}},[o,f]);const b=f[o];if(!b||!b.frames||b.frames.length===0)return null;const{frameWidth:_,frameHeight:T}=v,N=b.frames[u];return N?l.jsx(vl,{x:t.x,y:t.y,children:l.jsx(D2,{image:N,x:-30,y:-50,width:60,height:100,scaleX:n})}):null},qw={fire_arrow:{frames:8,frameDuration:80,speed:10,path:"Art/Spells/Fire Arrow/PNG/Fire Arrow_Frame_",isSingleImage:!1},fire_arrow_archer:{frames:1,frameDuration:0,speed:10,path:"Art/Characters/men/Archer/Arrow.png",isSingleImage:!0},water_spell:{frames:8,frameDuration:80,speed:5,path:"Art/Spells/Water Spell/PNG/Water Spell_Frame_",isSingleImage:!1}},kge=({spell:e,onUpdate:t,isMobile:r=!1,characterId:n=null})=>{const[s,a]=w.useState(e.startPosition||{x:0,y:0}),[i,o]=w.useState(0),[c,u]=w.useState([]),{loadImage:d}=QS(),f=w.useRef(null),h=w.useRef(null),p=e.type==="fire_arrow"?n==="archer"?qw.fire_arrow_archer:qw.fire_arrow:qw[e.type]||qw.fire_arrow,v=(()=>{if(!e.startPosition||!e.targetPosition)return p.speed;const _=Math.abs(r?e.targetPosition.y-e.startPosition.y:e.targetPosition.x-e.startPosition.x),E=2500/16;return _/E})();w.useEffect(()=>{(async()=>{const T=[];if(p.isSingleImage)try{const N=await d(p.path);T.push(N)}catch(N){console.error("Failed to load spell image:",N)}else for(let N=1;N<=p.frames;N++)try{const E=`${p.path}${String(N).padStart(2,"0")}.png`,F=await d(E);T.push(F)}catch(E){console.error(`Failed to load spell frame ${N}:`,E)}u(T)})()},[e.type,p,d]),w.useEffect(()=>{if(c.length===0||p.isSingleImage){o(0);return}return f.current=setInterval(()=>{o(_=>(_+1)%c.length)},p.frameDuration),()=>{f.current&&clearInterval(f.current)}},[c.length,p.frameDuration,p.isSingleImage]),w.useEffect(()=>(h.current=setInterval(()=>{a(_=>{let T=_.x,N=_.y;if(r?N=_.y-v*e.direction:T=_.x+v*e.direction,r?N<-50||N>1050:T<-50||T>850)return h.current&&clearInterval(h.current),_;const F={x:T,y:N};return t(F),F})},16),()=>{h.current&&clearInterval(h.current)}),[v,e.direction,r,t]);const C=c[i];if(!C||c.length===0)return null;const b=r?e.direction===1?-90:90:e.direction===1?0:180;return l.jsx(vl,{x:s.x,y:s.y,rotation:b,children:l.jsx(D2,{image:C,x:-20,y:-20,width:40,height:40})})},HO=800,GO=600,Mf=5,VO=()=>{const e=window.innerWidth,t=window.innerHeight,r=e/t,n=r<1.2,s=r>=1.5;return{isMobile:n,isDesktop:s,aspectRatio:r,width:e,height:t}},Cge=({matchData:e,selectedCharacter:t,studentNickname:r,damage:n,battleState:s,onPlayerMove:a,onSpellCast:i,onSpellHit:o,onRoundReady:c})=>{const[u,d]=w.useState(()=>VO()),[f,h]=w.useState({x:100,y:300}),[g,p]=w.useState({x:700,y:300}),[x,v]=w.useState([]),[C,b]=w.useState(200),[_,T]=w.useState(200),[N,E]=w.useState(10),[F,j]=w.useState(!1),P=w.useRef(!1),[M,I]=w.useState(null),[U,K]=w.useState(!0),[te,re]=w.useState(0),Z=w.useRef(0),[B,J]=w.useState({}),[z,q]=w.useState({up:!1,down:!1,left:!1,right:!1}),[H,R]=w.useState(!1),[L,G]=w.useState(!1),W=w.useRef(new Set),Q=w.useRef(new Map),{loadImage:X}=QS(),se=w.useRef(null),le=w.useRef(0),he=w.useRef(null),we=60,ie=100,Ee=-30,ye=-50;w.useEffect(()=>{const Te=()=>{d(VO())};return window.addEventListener("resize",Te),()=>window.removeEventListener("resize",Te)},[]),w.useEffect(()=>{(async()=>{const Ve=await X("Art/Background/PNG/game_background_3/game_background_3.png");I(Ve)})()},[X]),w.useEffect(()=>{u.isMobile?(h({x:u.width/2,y:u.height-150}),p({x:u.width/2,y:150})):(h({x:100,y:300}),p({x:700,y:300}))},[u]),w.useEffect(()=>{if(s&&!F&&s.player1Hp!==void 0&&s.player2Hp!==void 0){const Te=U?s.player1Hp:s.player2Hp,Ve=U?s.player2Hp:s.player1Hp;b(Te),T(Ve),j(!0),console.log("[BattlePhase] HP initialized:",{playerHp:Te,opponentHp:Ve})}},[s,U,F]),w.useEffect(()=>{s&&(s.opponentPosition&&p(s.opponentPosition),(s.player1Hp!==void 0||s.player2Hp!==void 0)&&b(Te=>{const Ve=U?s.player1Hp!==void 0?s.player1Hp:Te:s.player2Hp!==void 0?s.player2Hp:Te;return T(pt=>{const wt=U?s.player2Hp!==void 0?s.player2Hp:pt:s.player1Hp!==void 0?s.player1Hp:pt,Ut=Ve-Te,ct=wt-pt;if(console.log("[BattlePhase] HP Bar Update Calculation:",{battleState:{player1Hp:s.player1Hp,player2Hp:s.player2Hp},isPlayer1:U,player:{currentHp:Te,newHp:Ve,change:Ut,calculation:`${Te} + ${Ut} = ${Ve}`,decreased:Ve<Te},opponent:{currentHp:pt,newHp:wt,change:ct,calculation:`${pt} + ${ct} = ${wt}`,decreased:wt<pt}}),Ve<Te){const yt=Te-Ve;console.log("[BattlePhase] Player HP decreased:",{previous:Te,damage:yt,calculation:`${Te} - ${yt} = ${Ve}`,final:Ve}),R(!0),setTimeout(()=>R(!1),500)}if(wt<pt){const yt=pt-wt;console.log("[BattlePhase] Opponent HP decreased:",{previous:pt,damage:yt,calculation:`${pt} - ${yt} = ${wt}`,final:wt}),G(!0),setTimeout(()=>G(!1),500)}return(Ve!==Te||wt!==pt)&&console.log("[BattlePhase] Applying HP bar update:",{playerHp:{from:Te,to:Ve},opponentHp:{from:pt,to:wt}}),wt}),Ve}),s.roundTimeLeft!==void 0&&!P.current&&(E(Math.max(0,s.roundTimeLeft)),P.current=!0))},[s,U]),w.useEffect(()=>{s?.round&&(P.current=!1)},[s?.round]),w.useEffect(()=>{s?.activeSpells&&(s.activeSpells.forEach(Te=>{!Te.isTemp&&Q.current&&Q.current.forEach((Ve,pt)=>{Ve.casterId===Te.casterId&&Ve.type===Te.type&&(o(Te.id,Ve.hitTargetId),Q.current.delete(pt))})}),v(s.activeSpells))},[s?.activeSpells,o]);const Ie=w.useCallback((Te,Ve)=>{const pt=Date.now(),wt=pt-Z.current,Ut=1e3;if(wt<Ut){const $e=Ut-wt;re($e);return}Z.current=pt,re(Ut);const ct=40;let yt;u.isMobile?yt={x:f.x,y:f.y-ct}:yt={x:f.x+ct,y:f.y};const rt=u.isMobile?{x:g.x,y:g.y}:{x:g.x,y:g.y},Oe={id:`temp_${Date.now()}_${Math.random()}`,type:Te,startPosition:yt,targetPosition:rt,direction:Ve,casterId:U?"player1":"player2",createdAt:Date.now(),isTemp:!0};v($e=>[...$e,Oe]),i(Te,Ve)},[f,g,u,U,i]);w.useEffect(()=>{if(te<=0)return;const Te=setInterval(()=>{const pt=Date.now()-Z.current,Ut=Math.max(0,1e3-pt);re(Ut),Ut===0&&clearInterval(Te)},50);return()=>clearInterval(Te)},[te]),w.useEffect(()=>{const Te=pt=>{J(wt=>({...wt,[pt.key.toLowerCase()]:!0}))},Ve=pt=>{J(wt=>({...wt,[pt.key.toLowerCase()]:!1}))};return window.addEventListener("keydown",Te),window.addEventListener("keyup",Ve),()=>{window.removeEventListener("keydown",Te),window.removeEventListener("keyup",Ve)}},[]),w.useEffect(()=>{if(!u.isMobile)return;const Te=Ut=>{Ut.preventDefault();const ct=Ut.touches[0];he.current={x:ct.clientX,y:ct.clientY}},Ve=Ut=>{if(Ut.preventDefault(),!he.current)return;const ct=Ut.touches[0],yt=ct.clientX-he.current.x,rt=ct.clientY-he.current.y,Oe=10;q({up:rt<-Oe,down:rt>Oe,left:yt<-Oe,right:yt>Oe})},pt=Ut=>{Ut.preventDefault(),he.current=null,q({up:!1,down:!1,left:!1,right:!1})},wt=se.current?.getStage()?.container();return wt&&(wt.addEventListener("touchstart",Te,{passive:!1}),wt.addEventListener("touchmove",Ve,{passive:!1}),wt.addEventListener("touchend",pt,{passive:!1})),()=>{wt&&(wt.removeEventListener("touchstart",Te),wt.removeEventListener("touchmove",Ve),wt.removeEventListener("touchend",pt))}},[u.isMobile]),w.useEffect(()=>{const Te=setInterval(()=>{const Ve=Date.now();if(Ve-le.current<50)return;le.current=Ve;let pt=f.x,wt=f.y,Ut=!1;if(u.isMobile){const yt=u.height/2,rt=u.height-100,Oe=0,$e=u.width-50;z.left&&(pt=Math.max(Oe,pt-Mf),Ut=!0),z.right&&(pt=Math.min($e,pt+Mf),Ut=!0),z.up&&(wt=Math.max(yt,wt-Mf),Ut=!0),z.down&&(wt=Math.min(rt,wt+Mf),Ut=!0)}else{const ct=HO/2,yt=0,rt=ct-50,Oe=0,$e=GO-100;(B.a||B.arrowleft)&&(pt=Math.max(yt,pt-Mf),Ut=!0),(B.d||B.arrowright)&&(pt=Math.min(rt,pt+Mf),Ut=!0),(B.w||B.arrowup)&&(wt=Math.max(Oe,wt-Mf),Ut=!0),(B.s||B.arrowdown)&&(wt=Math.min($e,wt+Mf),Ut=!0)}Ut&&(h({x:pt,y:wt}),a({x:pt,y:wt}))},16);return()=>clearInterval(Te)},[B,z,f,a,u]),w.useEffect(()=>{if(u.isMobile)return;const Te=(Ve,pt)=>{B[Ve]&&(Ie(pt,U?1:-1),J(Ut=>({...Ut,[Ve]:!1})))};Te("1","fire_arrow"),Te("2","water_spell")},[B,U,u.isMobile,Ie]),w.useEffect(()=>{if(N>0){const Te=setInterval(()=>{E(Ve=>Ve<=0?0:Ve-.1)},100);return()=>clearInterval(Te)}},[N]);const ut=w.useCallback((Te,Ve)=>{const pt=x.find(ar=>ar.id===Te);if(!pt)return;const wt=pt.casterId||pt.owner,Ut=wt===(U?"player1":"player2"),ct=wt===(U?"player2":"player1"),yt={x:f.x+Ee,y:f.y+ye,width:we,height:ie},rt={x:g.x+Ee,y:g.y+ye,width:we,height:ie},Oe=40,$e=20,Mt={x:Ve.x-$e,y:Ve.y-$e,width:Oe,height:Oe},It=(ar,dr)=>ar.x<dr.x+dr.width&&ar.x+ar.width>dr.x&&ar.y<dr.y+dr.height&&ar.y+ar.height>dr.y;let At=!1,tr=null;if(Ut?(At=It(Mt,rt),At&&(tr=U?"player2":"player1")):ct&&(At=It(Mt,yt),At&&(tr=U?"player1":"player2")),At&&tr){if(W.current.has(Te))return;W.current.add(Te),tr===(U?"player1":"player2")?(R(!0),setTimeout(()=>R(!1),500)):(G(!0),setTimeout(()=>G(!1),500)),pt.isTemp?Q.current.set(Te,{hitTargetId:tr,casterId:pt.casterId,type:pt.type}):(v(ar=>ar.filter(dr=>dr.id!==Te)),W.current.delete(Te),o(Te,tr))}},[x,f,g,U,o]);w.useEffect(()=>{const Te=new Set(x.map(Ve=>Ve.id));W.current.forEach(Ve=>{Te.has(Ve)||W.current.delete(Ve)})},[x]),w.useEffect(()=>{s&&s.round&&!s.roundTimeLeft&&c()},[s,c]);const Qe=Te=>{const Ve=(u.isMobile,U?1:-1);Ie(Te,Ve)},$t=Math.min(100,te/1e3*100),Ge=te>0,et=u.isMobile?u.width:HO,vt=u.isMobile?u.height:GO;return l.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-900 relative overflow-hidden",children:[l.jsx("div",{className:`absolute ${u.isMobile?"top-1 left-1 right-1":"top-4 left-4 right-4"} z-10`,children:u.isMobile?l.jsxs("div",{className:"flex items-center gap-1 bg-gray-800 bg-opacity-90 rounded-lg px-2 py-1",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-white text-[10px] truncate mb-0.5",children:r}),l.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5",children:l.jsx(Ze.div,{className:"bg-green-500 h-1.5 rounded-full transition-all duration-300",initial:{width:`${C/200*100}%`},animate:{width:`${C/200*100}%`},transition:{duration:.3,ease:"easeOut"}})}),l.jsxs("div",{className:"text-white text-[9px] mt-0.5",children:[C,"/200"]})]}),l.jsx("div",{className:"bg-gray-700 rounded px-2 py-1 mx-1",children:l.jsxs("div",{className:"text-white text-sm font-bold",children:[Math.ceil(N),"s"]})}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("div",{className:"text-white text-[10px] truncate mb-0.5",children:"Opponent"}),l.jsx("div",{className:"w-full bg-gray-700 rounded-full h-1.5",children:l.jsx(Ze.div,{className:"bg-red-500 h-1.5 rounded-full transition-all duration-300",initial:{width:`${_/200*100}%`},animate:{width:`${_/200*100}%`},transition:{duration:.3,ease:"easeOut"}})}),l.jsxs("div",{className:"text-white text-[9px] mt-0.5",children:[_,"/200"]})]})]}):l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{className:"bg-gray-800 rounded-lg p-2 md:p-4 min-w-[150px] md:min-w-[200px]",children:[l.jsx("div",{className:"text-white text-xs md:text-sm mb-1",children:r}),l.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 md:h-4",children:l.jsx(Ze.div,{className:"bg-green-500 h-3 md:h-4 rounded-full transition-all duration-300",initial:{width:`${C/200*100}%`},animate:{width:`${C/200*100}%`},transition:{duration:.3,ease:"easeOut"}})}),l.jsxs("div",{className:"text-white text-xs mt-1",children:[C," / 200 HP"]})]}),l.jsx("div",{className:"bg-gray-800 rounded-lg p-2 md:p-4 text-center",children:l.jsxs("div",{className:"text-white text-xl md:text-2xl font-bold",children:[Math.ceil(N),"s"]})}),l.jsxs("div",{className:"bg-gray-800 rounded-lg p-2 md:p-4 min-w-[150px] md:min-w-[200px]",children:[l.jsx("div",{className:"text-white text-xs md:text-sm mb-1",children:"Opponent"}),l.jsx("div",{className:"w-full bg-gray-700 rounded-full h-3 md:h-4",children:l.jsx(Ze.div,{className:"bg-red-500 h-3 md:h-4 rounded-full transition-all duration-300",initial:{width:`${_/200*100}%`},animate:{width:`${_/200*100}%`},transition:{duration:.3,ease:"easeOut"}})}),l.jsxs("div",{className:"text-white text-xs mt-1",children:[_," / 200 HP"]})]})]})}),l.jsx("div",{className:"relative",children:l.jsx(oh,{width:et,height:vt,ref:se,children:l.jsxs(ih,{children:[M&&l.jsx(vl,{rotation:u.isMobile?90:0,x:u.isMobile?et/2:0,y:u.isMobile?vt/2:0,offsetX:u.isMobile?vt/2:0,offsetY:u.isMobile?et/2:0,children:l.jsx(D2,{image:M,x:0,y:0,width:u.isMobile?vt:et,height:u.isMobile?et:vt})}),u.isMobile?l.jsx(Ja,{x:0,y:vt/2-2,width:et,height:4,fill:"#666",opacity:.5}):l.jsx(Ja,{x:et/2-2,y:0,width:4,height:vt,fill:"#666",opacity:.5}),l.jsx(WO,{characterId:t,position:f,isMoving:u.isMobile?Object.values(z).some(Te=>Te):Object.values(B).some(Te=>Te),direction:(u.isMobile,U?1:-1),isHurt:H}),l.jsx(WO,{characterId:e?.opponentCharacter||"archer",position:g,isMoving:!1,direction:(u.isMobile,U?-1:1),isHurt:L}),x.map(Te=>{const wt=(Te.casterId||Te.owner)===(U?"player1":"player2")?t:e?.opponentCharacter||"archer";return l.jsx(kge,{spell:Te,isMobile:u.isMobile,characterId:wt,onUpdate:Ut=>ut(Te.id,Ut)},Te.id)}),l.jsx(Nc,{x:f.x-30,y:f.y-60,text:r,fontSize:14,fill:"white",fontStyle:"bold"}),l.jsx(Nc,{x:g.x-30,y:g.y-60,text:e?.opponentNickname||"Opponent",fontSize:14,fill:"white",fontStyle:"bold"})]})})}),u.isMobile?l.jsxs("div",{className:"absolute bottom-2 left-2 right-2 z-10",children:[l.jsxs("div",{className:"flex justify-center gap-2",children:[l.jsxs("button",{onClick:()=>Qe("fire_arrow"),disabled:Ge,className:`relative bg-red-600 text-white font-semibold py-2 px-3 rounded-lg shadow-lg transition-all text-xs ${Ge?"opacity-50 cursor-not-allowed":"hover:bg-red-700 active:scale-95"}`,children:[l.jsx("span",{className:"relative z-10",children:" Fire"}),Ge&&l.jsx("div",{className:"absolute inset-0 bg-red-800 rounded-lg transition-all duration-50",style:{clipPath:`inset(${100-$t}% 0 0 0)`,transition:"clip-path 0.05s linear"}})]}),l.jsxs("button",{onClick:()=>Qe("water_spell"),disabled:Ge,className:`relative bg-blue-600 text-white font-semibold py-2 px-3 rounded-lg shadow-lg transition-all text-xs ${Ge?"opacity-50 cursor-not-allowed":"hover:bg-blue-700 active:scale-95"}`,children:[l.jsx("span",{className:"relative z-10",children:" Water"}),Ge&&l.jsx("div",{className:"absolute inset-0 bg-blue-800 rounded-lg transition-all duration-50",style:{clipPath:`inset(${100-$t}% 0 0 0)`,transition:"clip-path 0.05s linear"}})]})]}),l.jsx("div",{className:"text-white text-[10px] text-center mt-1 opacity-75",children:"Touch and drag to move"})]}):l.jsxs("div",{className:"mt-4 text-center text-white",children:[l.jsxs("div",{className:"mb-2",children:[l.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"WASD"})," or ",l.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"Arrow Keys"})," to move"]}),l.jsxs("div",{children:[l.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"1"})," Fire Arrow | ",l.jsx("kbd",{className:"px-2 py-1 bg-gray-800 rounded",children:"2"})," Water Spell"]})]})]})},Tge=({results:e,onExit:t})=>{const[r,n]=w.useState(!0),[s,a]=w.useState(!1);if(w.useEffect(()=>{const c=setTimeout(()=>{a(!0)},500),u=setTimeout(()=>{n(!1)},4e3);return()=>{clearTimeout(c),clearTimeout(u)}},[]),!e)return l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx("div",{className:"text-white",children:"Loading results..."})});if(e.tournamentComplete&&e.winner)return l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-2xl w-full text-center",children:[l.jsx(Ze.h1,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"text-5xl font-bold text-yellow-400 mb-8",children:" Tournament Winner! "}),l.jsx(Ze.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"bg-gradient-to-br from-yellow-400 to-orange-500 rounded-full w-32 h-32 flex items-center justify-center mx-auto mb-6",children:l.jsx("span",{className:"text-6xl",children:""})}),l.jsx(Ze.h2,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-3xl font-bold text-white mb-4",children:e.winner.nickname}),l.jsx(Ze.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5},className:"bg-gray-800 rounded-lg p-6 mb-6",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4 text-white",children:[l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-green-400",children:e.winner.hp}),l.jsx("div",{className:"text-sm text-gray-400",children:"Final HP"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-blue-400",children:e.winner.correctAnswers}),l.jsx("div",{className:"text-sm text-gray-400",children:"Correct Cards"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-red-400",children:e.winner.damageDealt}),l.jsx("div",{className:"text-sm text-gray-400",children:"Damage Dealt"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"text-2xl font-bold text-orange-400",children:e.winner.damageReceived}),l.jsx("div",{className:"text-sm text-gray-400",children:"Damage Received"})]})]})}),l.jsx(Ze.button,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.7},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg",children:"Exit Game"})]})});const i=[e.player1,e.player2].filter(c=>c).sort((c,u)=>(c.place||999)-(u.place||999)),o=i.slice(0,3);return l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:l.jsxs(Ai,{children:[r&&l.jsxs(Ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"text-center",children:[l.jsx(Ze.h1,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"text-6xl font-bold text-yellow-400 mb-8",children:"Top 3 Reveal!"}),l.jsx("div",{className:"flex justify-center gap-8",children:o.map((c,u)=>l.jsxs(Ze.div,{initial:{y:100,opacity:0},animate:{y:0,opacity:s?1:0},transition:{delay:u*.3},className:"text-center",children:[l.jsx("div",{className:`
                    w-32 h-32 rounded-full flex items-center justify-center text-4xl font-bold
                    ${u===0?"bg-yellow-400 text-gray-900":""}
                    ${u===1?"bg-gray-300 text-gray-900":""}
                    ${u===2?"bg-orange-400 text-gray-900":""}
                  `,children:u+1}),l.jsx("div",{className:"mt-4 text-white text-xl font-bold",children:c.nickname}),l.jsxs("div",{className:"text-gray-300",children:[c.hp," HP"]})]},c.id))})]}),!r&&l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"max-w-4xl w-full",children:l.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-8 shadow-2xl",children:[l.jsx("h2",{className:"text-3xl font-bold text-white mb-6 text-center",children:"Final Leaderboard"}),l.jsx("div",{className:"space-y-4",children:i.map((c,u)=>l.jsxs(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:u*.1},className:`
                      bg-gray-700 rounded-lg p-4 flex items-center justify-between
                      ${u===0?"ring-2 ring-yellow-400":""}
                    `,children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:`
                        w-12 h-12 rounded-full flex items-center justify-center font-bold text-xl
                        ${u===0?"bg-yellow-400 text-gray-900":""}
                        ${u===1?"bg-gray-300 text-gray-900":""}
                        ${u===2?"bg-orange-400 text-gray-900":""}
                        ${u>2?"bg-gray-600 text-white":""}
                      `,children:u+1}),l.jsxs("div",{children:[l.jsx("div",{className:"text-white font-bold text-lg",children:c.nickname}),l.jsxs("div",{className:"text-gray-400 text-sm",children:["Correct Cards: ",c.correctAnswers," | Damage Dealt: ",c.damageDealt," | Damage Received: ",c.damageReceived]})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"text-yellow-400 font-bold text-xl",children:[c.hp," HP"]}),l.jsxs("div",{className:"text-gray-400 text-sm",children:["Place: ",c.place]})]})]},c.id))}),l.jsx("div",{className:"mt-8 text-center",children:l.jsx(Ze.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:t,className:"bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-8 rounded-lg",children:"Exit Game"})})]})})]})})},Nge=({result:e,onReEnterQueue:t,onViewResults:r})=>{const n=e?.place===1;return e?.hp===0?l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-red-900 via-gray-900 to-black",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full text-center",children:[l.jsx(Ze.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200},className:"text-8xl mb-6",children:""}),l.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"You've Been Eliminated"}),l.jsx("p",{className:"text-gray-300 mb-6",children:"You've been eliminated from the tournament. Wait for the tournament to complete to see final results."}),l.jsx("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"text-white text-sm space-y-2",children:[l.jsxs("div",{children:["Final HP: ",l.jsx("span",{className:"text-red-400 font-bold",children:"0"})]}),l.jsxs("div",{children:["Correct Cards: ",l.jsx("span",{className:"text-blue-400 font-bold",children:e?.correctAnswers||0})]}),l.jsxs("div",{children:["Damage Dealt: ",l.jsx("span",{className:"text-green-400 font-bold",children:e?.damageDealt||0})]}),l.jsxs("div",{children:["Damage Received: ",l.jsx("span",{className:"text-orange-400 font-bold",children:e?.damageReceived||0})]})]})})]})}):n?l.jsx("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-green-900 via-blue-900 to-indigo-900",children:l.jsxs(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full text-center",children:[l.jsx(Ze.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"text-8xl mb-6",children:""}),l.jsx("h2",{className:"text-3xl font-bold text-white mb-4",children:"Match Won!"}),l.jsx("p",{className:"text-gray-300 mb-6",children:"Congratulations! You won this match. You can continue in the tournament."}),l.jsx("div",{className:"bg-gray-800 rounded-lg p-4 mb-6",children:l.jsxs("div",{className:"text-white text-sm space-y-2",children:[l.jsxs("div",{children:["Remaining HP: ",l.jsx("span",{className:"text-green-400 font-bold",children:e?.hp||0})]}),l.jsxs("div",{children:["Correct Cards: ",l.jsx("span",{className:"text-blue-400 font-bold",children:e?.correctAnswers||0})]}),l.jsxs("div",{children:["Damage Dealt: ",l.jsx("span",{className:"text-green-400 font-bold",children:e?.damageDealt||0})]}),l.jsxs("div",{children:["Damage Received: ",l.jsx("span",{className:"text-orange-400 font-bold",children:e?.damageReceived||0})]})]})}),l.jsxs("div",{className:"space-y-3",children:[l.jsx(at,{onClick:t,className:"w-full bg-green-600 hover:bg-green-700",children:"Continue in Tournament"}),l.jsx(at,{onClick:r,variant:"outline",className:"w-full",children:"View Results"})]})]})}):null},Ege=({sessionCode:e,gameId:t,studentData:r,onExit:n})=>{const{showNotification:s}=Ls(),[a,i]=w.useState("character-selection"),[o,c]=w.useState([]),[u,d]=w.useState(null),[f,h]=w.useState(r?.nickname||""),[g,p]=w.useState([]),[x,v]=w.useState([]),[C,b]=w.useState(5),[_,T]=w.useState(null),[N,E]=w.useState(null),[F,j]=w.useState(null),[P,M]=w.useState(null),I=Rs.useRef(null),U=r?.student_id,K=r?.role||"student",{isConnected:te,error:re,sendMessage:Z,onMessage:B}=YV(e,U,K);w.useEffect(()=>{if(!B)return;const Q=B("character-selection",Ve=>{h(Ve.studentNickname||r?.nickname||r?.name||"")}),X=B("character-selected",Ve=>{}),se=B("lobby-update",Ve=>{c(Ve.players||[])}),le=B("lobby-joined",Ve=>{console.log("[DuelGame] Lobby joined message received:",Ve),i("lobby"),c(Ve.players||[]),s("Joined lobby successfully!","success")}),he=B("start-card-phase",Ve=>{const pt=Ve.questions||[];pt.length>0?(p(pt),v([]),b(5),Ve.lateJoiner&&Ve.assignedCharacter?(console.log("[DuelGame] Late joiner detected, assigned character:",Ve.assignedCharacter),d(Ve.assignedCharacter),i("cards"),s("Game already started! You've been assigned a character and can join now.","info")):(console.log("[DuelGame] Starting card phase (questions:",pt.length,")"),i("cards"),T(null),I.current=null)):console.warn("[DuelGame] Received start-card-phase with no questions, staying in current phase")}),we=B("card-result",Ve=>{v(pt=>[...pt,{questionId:Ve.questionId,isCorrect:Ve.isCorrect}]),b(Ve.currentDamage)}),ie=B("cards-complete",Ve=>{i("queue")}),Ee=B("queue-joined",Ve=>{}),ye=B("match-found",Ve=>{const pt={matchId:Ve.matchId,opponentId:Ve.opponentId,opponentNickname:Ve.opponentNickname,opponentCharacter:Ve.opponentCharacter,opponentDamage:Ve.opponentDamage,isPlayer1:Ve.isPlayer1};I.current=pt,T(pt),i("battle"),console.log("[DuelGame] Match found, sending round-ready"),Z("round-ready",{matchId:Ve.matchId})}),Ie=B("round-start",Ve=>{E(pt=>({...pt,round:Ve.round,roundTimeLeft:Ve.duration/1e3,player1Hp:Ve.player1Hp,player2Hp:Ve.player2Hp}))}),ut=B("opponent-move",Ve=>{E(pt=>({...pt,opponentPosition:Ve.position}))}),Qe=B("spell-cast",Ve=>{const pt={...Ve.spell,casterId:Ve.spell.casterId||Ve.spell.owner};E(wt=>{let Ut=null;const ct=(wt?.activeSpells||[]).filter(yt=>yt.isTemp&&yt.casterId===pt.casterId&&yt.type===pt.type&&Math.abs(pt.createdAt-(yt.createdAt||0))<=1e3?(Ut=yt,!1):!0);if(Ut&&wt?.tempSpellHits?.has(Ut.id)){const yt=wt.tempSpellHits.get(Ut.id),rt=I.current?.matchId;rt&&Z("spell-hit",{matchId:rt,spellId:pt.id,hitPlayerId:yt.hitTargetId});const Oe=new Map(wt.tempSpellHits);return Oe.delete(Ut.id),{...wt,activeSpells:[...ct,pt],tempSpellHits:Oe}}return{...wt,activeSpells:[...ct,pt]}})}),$t=B("spell-hit",Ve=>{console.log("[DuelGame] Spell hit received, updating HP:",{spellId:Ve.spellId,player1Hp:Ve.player1Hp,player2Hp:Ve.player2Hp,prevPlayer1Hp:N?.player1Hp,prevPlayer2Hp:N?.player2Hp}),E(pt=>({...pt,player1Hp:Ve.player1Hp??pt?.player1Hp??200,player2Hp:Ve.player2Hp??pt?.player2Hp??200,activeSpells:pt?.activeSpells?.filter(wt=>wt.id!==Ve.spellId)||[]}))}),Ge=B("round-end",Ve=>{E(pt=>({...pt,player1Hp:Ve.player1Hp,player2Hp:Ve.player2Hp,roundTimeLeft:0}))}),et=B("match-end",Ve=>{const pt=r?.student_id,wt=Ve.results.player1?.id===pt?Ve.results.player1:Ve.results.player2?.id===pt?Ve.results.player2:null;wt&&(M(wt),i("match-result"))}),vt=B("tournament-end",Ve=>{j({tournamentComplete:!0,winner:Ve.winner}),i("results")}),Te=B("error",Ve=>{s(Ve.message||"An error occurred","error")});return()=>{Q(),X(),se(),le(),he(),we(),ie(),Ee(),ye(),Ie(),ut(),Qe(),$t(),Ge(),et(),vt(),Te()}},[B,s,r,Z]),w.useEffect(()=>{I.current=_},[_]),w.useEffect(()=>{te&&r?.student_id&&Z("join-session",{sessionCode:e,studentId:r.student_id,studentName:r.name,studentNickname:r.nickname})},[te,e,r,Z]);const J=Q=>{d(Q),Z("character-selected",{sessionCode:e,studentId:r?.student_id,characterId:Q})},z=()=>{if(console.log("[DuelGame] Join Lobby clicked",{sessionCode:e,studentId:r?.student_id}),!u){s("Please select a character first","error");return}if(!e||!r?.student_id){s("Missing session code or student ID","error");return}Z("join-lobby",{sessionCode:e,studentId:r?.student_id})},q=(Q,X)=>{Z("card-answered",{sessionCode:e,questionId:Q,answer:X,studentId:r?.student_id})},H=()=>{Z("enter-queue",{sessionCode:e,studentId:r?.student_id})},R=Q=>{_?.matchId&&Z("player-move",{matchId:_.matchId,position:Q})},L=(Q,X)=>{const se=I.current?.matchId;se?(console.log("[DuelGame] Sending spell-cast to server:",{matchId:se,spellType:Q,direction:X}),Z("spell-cast",{matchId:se,spellType:Q,direction:X})):console.warn("[DuelGame] Cannot send spell-cast: no matchId in ref",I.current)},G=(Q,X)=>{const se=I.current?.matchId;se&&Z("spell-hit",{matchId:se,spellId:Q,hitPlayerId:X})},W=()=>{_?.matchId&&Z("round-ready",{matchId:_.matchId})};return te?l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900",children:l.jsxs(Ai,{mode:"wait",children:[a==="character-selection"&&l.jsx(bge,{studentNickname:f||r?.nickname||r?.name,onSelect:J,onJoinLobby:z,hasSelectedCharacter:!!u},"character-selection"),a==="lobby"&&l.jsx(wge,{players:o,studentNickname:f||r?.nickname||r?.name,isTeacher:!1,onStartGame:()=>{Z("start-game",{sessionCode:e})}},"lobby"),a==="cards"&&g.length>0&&l.jsx(_ge,{questions:g,onAnswer:q,cardAnswers:x,damage:C},"cards"),a==="cards"&&g.length===0&&l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-white text-xl",children:"Loading questions..."})]})}),a==="queue"&&l.jsx(Sge,{onEnterQueue:H,correctAnswers:x.filter(Q=>Q.isCorrect).length,finalDamage:C},"queue"),a==="battle"&&l.jsx(Cge,{matchData:_,selectedCharacter:u,studentNickname:f||r?.nickname||r?.name,damage:C,battleState:N,onPlayerMove:R,onSpellCast:L,onSpellHit:G,onRoundReady:W},"battle"),a==="match-result"&&l.jsx(Nge,{result:P,onReEnterQueue:()=>{M(null),i("queue"),H()},onViewResults:()=>{i("results")}},"match-result"),a==="results"&&l.jsx(Tge,{results:F,onExit:n},"results")]})}):l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Connecting to game server..."}),re&&l.jsx("p",{className:"mt-2 text-red-500",children:re})]})})},Age=()=>{const{sessionCode:e}=E2(),t=Za(),{showNotification:r}=Ls(),[n,s]=w.useState(null),[a,i]=w.useState(!0),[o,c]=w.useState({username:"",password:""}),[u,d]=w.useState(!1),[f,h]=w.useState(""),[g,p]=w.useState(null);w.useEffect(()=>{const v=sessionStorage.getItem(`game_student_${e}`);if(v)try{const C=JSON.parse(v);p(C),i(!1)}catch{}},[e]);const x=async v=>{v.preventDefault(),d(!0),h("");try{const C=o.username;if(!/^\d+$/.test(C)){h("Please use your student ID to log in"),d(!1);return}const b=await O4.studentLogin({username:C,password:o.password});if(b.success&&b.data){const _={student_id:b.data.student_id||C,name:b.data.name||b.data.first_name||"",surname:b.data.surname||b.data.last_name||"",nickname:b.data.nickname||"",grade:b.data.grade||null,class:b.data.class||null,number:b.data.number||null,role:"student"};p(_),sessionStorage.setItem(`game_student_${e}`,JSON.stringify(_)),i(!1),r("Login successful!","success")}else h(b.message||"Invalid username or password")}catch(C){console.error("Login error:",C),h("Login failed. Please try again.")}finally{d(!1)}};return e?l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 relative",children:[l.jsx(Ai,{children:a&&!g&&l.jsx(Ze.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:l.jsxs(Ze.div,{initial:{scale:.9,y:20},animate:{scale:1,y:0},exit:{scale:.9,y:20},className:"bg-white rounded-lg shadow-2xl max-w-md w-full p-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-2 text-center",children:"Join Duel Game"}),l.jsxs("p",{className:"text-gray-600 mb-6 text-center text-sm",children:["Session Code: ",l.jsx("span",{className:"font-mono font-bold text-blue-600",children:e})]}),l.jsx("p",{className:"text-gray-700 mb-4 text-center",children:"Please log in with your student ID to join the game"}),l.jsxs("form",{onSubmit:x,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",id:"username",value:o.username,onChange:v=>c({...o,username:v.target.value}),placeholder:"Enter your student ID",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0,autoFocus:!0})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"password",id:"password",value:o.password,onChange:v=>c({...o,password:v.target.value}),placeholder:"Enter your password",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",required:!0})]}),f&&l.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-md text-sm",children:f}),l.jsx(at,{type:"submit",disabled:u,className:"w-full",children:u?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm"}),l.jsx("span",{className:"ml-2",children:"Logging in..."})]}):"Log In & Join Game"})]}),l.jsx("p",{className:"mt-4 text-xs text-gray-500 text-center",children:"Don't have an account? Contact your teacher."})]})})}),g?l.jsx(Ege,{sessionCode:e,gameId:n,studentData:g,onExit:()=>t("/student")}):l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Waiting for login..."})]})})]}):l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-gray-50 to-gray-100",children:l.jsxs(Kt,{className:"max-w-md w-full p-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Invalid Session"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"No session code provided."}),l.jsx(at,{onClick:()=>t("/student"),children:"Go Back"})]})})},jge=({onJoin:e})=>{const[t,r]=w.useState(""),[n,s]=w.useState(!1),a=Za(),{showNotification:i}=Ls(),{theme:o,isCyberpunk:c,isKpop:u,themeClasses:d}=da(),f=ua(o),h=async()=>{if(!t||t.length<4){i("Please enter a valid session code","error");return}s(!0),a(`/student/duel/${t.toUpperCase()}`),e&&e(t.toUpperCase())},g=v=>{v.key==="Enter"&&h()},p=c?Vt(0):u?hr(0):null;p?.style?.backgroundColor;const x=p?.style?.borderColor||(c?fe.cyan:u?He.primary:"#e5e7eb");return l.jsx(Kt,{className:`max-w-md w-full p-6 ${c?`${p.className} !bg-black`:u?`${p.className} !bg-gray-900`:""}`,style:c?{backgroundColor:"#000000",borderColor:x,...p?.style,...f.glow}:u?{backgroundColor:"#1a0014",borderColor:x,...p?.style,...f.glow}:{backgroundColor:"#ffffff",borderColor:"#e5e7eb"},children:l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[l.jsx("h2",{className:`text-2xl font-bold mb-4 text-center ${c?"text-cyan-400":u?"text-pink-400":"text-gray-900"}`,style:c?{fontFamily:"monospace",...f.textShadow}:{},children:c?"JOIN DUEL GAME":"Join Duel Game"}),l.jsx("p",{className:`mb-6 text-center ${c?"text-cyan-300":u?"text-pink-300":"text-gray-600"}`,children:"Enter the session code provided by your teacher"}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:`block text-sm font-medium mb-2 ${c?"text-cyan-400":u?"text-pink-400":"text-gray-700"}`,style:c?{fontFamily:"monospace",...f.textShadow}:{},children:"Session Code"}),l.jsx("input",{type:"text",value:t,onChange:v=>r(v.target.value.toUpperCase()),onKeyPress:g,placeholder:"Enter code (e.g., ABC123)",maxLength:10,className:`w-full px-4 py-3 rounded-lg text-center text-2xl font-bold tracking-widest uppercase transition-all ${c?"bg-gray-800/50 border-2 border-cyan-400/50 text-cyan-400 focus:ring-2 focus:ring-cyan-400 focus:border-cyan-400 placeholder-cyan-400/30":u?"bg-gray-800/50 border-2 border-pink-400/50 text-pink-400 focus:ring-2 focus:ring-pink-400 focus:border-pink-400 placeholder-pink-400/30":"border border-gray-300 text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}`,style:c?{fontFamily:"monospace",boxShadow:"0 0 10px rgba(34, 211, 238, 0.3)",...t?{boxShadow:"0 0 15px rgba(34, 211, 238, 0.5)"}:{}}:u?{boxShadow:"0 0 10px rgba(244, 114, 182, 0.3)",...t?{boxShadow:"0 0 15px rgba(244, 114, 182, 0.5)"}:{}}:{},disabled:n})]}),l.jsx(at,{onClick:h,disabled:n||!t,className:`w-full ${c?"bg-cyan-500 hover:bg-cyan-600 text-white border-cyan-400":u?"bg-pink-500 hover:bg-pink-600 text-white border-pink-400":""}`,style:c?{fontFamily:"monospace",...f.textShadow,boxShadow:"0 0 15px rgba(34, 211, 238, 0.5)"}:u?{boxShadow:"0 0 15px rgba(244, 114, 182, 0.5)"}:{},children:n?c?"JOINING...":"Joining...":c?"JOIN GAME":"Join Game"})]})})},Pge=()=>{const e=Za(),{theme:t,isCyberpunk:r,isLight:n,isKpop:s,themeClasses:a}=da(),i=ua(t);return l.jsx("div",{className:"min-h-screen p-4",style:r?{...i.background,backgroundImage:"radial-gradient(circle at 20% 50%, rgba(0, 255, 210, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 80%, rgba(0, 255, 210, 0.05) 0%, transparent 50%)"}:s?{...i.background}:{backgroundColor:"#ffffff"},children:l.jsxs("div",{className:"max-w-4xl mx-auto pt-8",children:[l.jsx(Ze.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},className:"mb-4",children:l.jsxs(at,{onClick:()=>e("/student"),variant:"secondary",className:`mb-4 ${r?"bg-cyan-500/20 hover:bg-cyan-500/30 text-cyan-400 border-cyan-400/50":s?"bg-pink-500/20 hover:bg-pink-500/30 text-pink-400 border-pink-400/50":""}`,style:r?{color:fe.cyan,fontFamily:"monospace",...i.textShadow}:s?{color:He.primary}:{},children:[" ",r?"BACK TO CABINET":"Back to Cabinet"]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:l.jsxs(Kt,{className:`${r?`${Vt(0).className} !bg-black`:s?`${hr(0).className} !bg-gray-900`:""} max-w-2xl mx-auto`,style:r?{backgroundColor:"#000000",borderColor:fe.cyan,...Vt(0).style,...i.glow}:s?{backgroundColor:"#1a0014",borderColor:He.primary,...hr(0).style}:{},children:[l.jsx(Kt.Header,{children:l.jsx(Kt.Title,{className:"text-center",style:r?{color:fe.cyan,fontFamily:"monospace",...i.textShadow}:s?{color:He.primary}:{},children:r?"JOIN DUEL GAME":"Join Duel Game"})}),l.jsx(Kt.Body,{children:l.jsx("div",{className:"flex justify-center",children:l.jsx(jge,{})})})]})})]})})},Fge=()=>{const{testType:e,testId:t}=E2(),r=Za(),{activeTests:n}=J2(),s=()=>{_e.debug(" [DEBUG] handleBackToCabinet called in TestPage"),_e.debug(" [DEBUG] Current location before navigate:",window.location.pathname),_e.debug(' [DEBUG] Calling navigate("/student")'),r("/student"),_e.debug(" [DEBUG] Navigate called, checking result..."),setTimeout(()=>{_e.debug(" [DEBUG] Location after navigate:",window.location.pathname),window.location.pathname!=="/student"&&(_e.debug(" [DEBUG] Navigation failed, forcing window.location.href"),window.location.href="/student")},50)},a=n.find(o=>o.test_type===e&&o.test_id===parseInt(t)),i=ku();return _e.debug(" [DEBUG] TestPage rendering, location:",i.pathname,"testType:",e,"testId:",t),l.jsx(nge,{onBackToCabinet:s,currentTest:a||{test_type:e,test_id:parseInt(t)}},`test-${e}-${t}`)},Mge=()=>{const e=Za(),{user:t,isAuthenticated:r,isLoading:n}=ws(),[s,a]=w.useState(!1),[i,o]=w.useState(!0),[c,u]=w.useState(""),[d,f]=w.useState([]),[h,g]=w.useState(!1),[p,x]=w.useState(!1),[v,C]=w.useState({currentPassword:"",newPassword:"",confirmPassword:""}),b=w.useCallback(async()=>{_e.debug(" Initializing Student Application...");try{if(o(!0),u(""),!r||!t){_e.debug(" User not authenticated, redirecting to login"),e("/login");return}if(t.role!==Ko.STUDENT){_e.error(" Invalid user role for student app:",t.role),u("Access denied. Student role required.");return}_e.debug(" Initializing event listeners..."),_(),_e.debug(" Setting up back to cabinet button listeners..."),T(),_e.debug(" Setting up password change form listener..."),N(),_e.debug(" Loading student data..."),await E(),_e.debug(" Exposing student functions globally..."),F(),_e.debug(" Populating student info from user data..."),K(t),a(!0),_e.debug(" Student Application initialization complete!")}catch(Z){_e.error(" Error initializing student app:",Z),u("Failed to initialize student application")}finally{o(!1)}},[r,t,e]);w.useEffect(()=>{n||b()},[n,r,t,b]);const _=w.useCallback(()=>{_e.debug(" Setting up student event listeners...");const Z=J=>{h&&!J.target.closest(".student-menu")&&g(!1)},B=J=>{J.key==="Escape"&&h&&g(!1)};return document.addEventListener("click",Z),document.addEventListener("keydown",B),()=>{document.removeEventListener("click",Z),document.removeEventListener("keydown",B)}},[h]),T=w.useCallback(()=>{_e.debug(" Setting up back to cabinet listeners...")},[]),N=w.useCallback(()=>{_e.debug(" Setting up password change form...")},[]),E=w.useCallback(async()=>{_e.debug(" Loading student data...");try{_e.debug(" Student data loaded successfully")}catch(Z){throw _e.error(" Error loading student data:",Z),Z}},[]),F=w.useCallback(()=>{_e.debug(" Exposing student functions globally..."),window.toggleStudentMenu=j,window.showChangePasswordTab=P,window.hideChangePasswordTab=M,window.navigateBackToCabinet=U,window.handlePasswordChange=I,window.populateStudentInfoDirectly=K,_e.debug(" All student functions exposed globally")},[]),j=w.useCallback(()=>{_e.debug(" toggleStudentMenu called"),g(Z=>{const B=!Z;return _e.debug(" Menu state changed from",Z,"to",B),B}),_e.debug(" Toggled dropdown menu")},[]),P=w.useCallback(()=>{_e.debug(" showChangePasswordTab called"),x(!0),g(!1)},[]),M=w.useCallback(()=>{_e.debug(" hideChangePasswordTab called"),x(!1),C({currentPassword:"",newPassword:"",confirmPassword:""})},[]),I=w.useCallback(async Z=>{Z.preventDefault(),_e.debug(" handlePasswordChange called");const{currentPassword:B,newPassword:J,confirmPassword:z}=v;if(!B||!J||!z){te("Please fill in all fields","error");return}if(J!==z){te("New passwords do not match","error");return}if(J.length<6){te("New password must be at least 6 characters long","error");return}const q=/[a-zA-Z]/.test(J),H=/[0-9]/.test(J);if(!q||!H){te("New password must contain both letters and numbers","error");return}if(!t||!t.student_id){te("Session expired. Please login again.","error");return}const R=t.student_id;if(window.confirm("Are you sure you want to change your password?"))try{o(!0);const L=await Xs.changePassword({studentId:R,currentPassword:B,newPassword:J});L.success?(te("Password changed successfully!","success"),M()):te(L.message||"Failed to change password","error")}catch(L){_e.error("Password change error:",L),te("Failed to change password. Please try again.","error")}finally{o(!1)}},[v,t]),U=w.useCallback(()=>{if(_e.debug("[DEBUG] navigateBackToCabinet called"),!r||!t){_e.warn("[WARN] No valid user found, redirecting to login"),e("/login");return}t.role===Ko.STUDENT?(_e.debug("[DEBUG] Navigating to student cabinet"),e("/student")):(_e.warn("[WARN] Unknown user role, redirecting to login"),e("/login"))},[r,t,e]),K=w.useCallback(Z=>{_e.debug(" populateStudentInfoDirectly called with:",Z);try{_e.debug(" Student info populated successfully")}catch(B){_e.error(" Error populating student info:",B)}},[]),te=w.useCallback((Z,B)=>{const J={id:Date.now(),message:Z,type:B,timestamp:new Date};f(z=>[...z,J]),setTimeout(()=>{f(z=>z.filter(q=>q.id!==J.id))},pg.NOTIFICATION_DURATION)},[]),re=w.useCallback(Z=>{const{name:B,value:J}=Z.target;C(z=>({...z,[B]:J}))},[]);return i?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Initializing Student Application..."})]})}):c?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Initialization Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:c}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):s?l.jsxs(eme,{asBackground:!0,children:[l.jsxs(v7,{children:[l.jsx(Ts,{path:"/",element:l.jsxs("div",{className:"student-app",children:[l.jsx(Zme,{isMenuOpen:h,onToggleMenu:j,onShowPasswordChange:P}),p&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Change Password"}),l.jsxs("form",{onSubmit:I,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",name:"currentPassword",value:v.currentPassword,onChange:re,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",name:"newPassword",value:v.newPassword,onChange:re,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:v.confirmPassword,onChange:re,required:!0,minLength:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(at,{type:"button",variant:"secondary",onClick:M,className:"flex-1",children:"Cancel"}),l.jsx(at,{type:"submit",variant:"primary",disabled:i,className:"flex-1",children:i?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",className:"mr-2"}),"Changing..."]}):"Change Password"})]})]})]})})]})}),l.jsx(Ts,{path:"/test/:testType/:testId",element:l.jsx(Fge,{})}),l.jsx(Ts,{path:"matching-test/:testId",element:l.jsx(sge,{})}),l.jsx(Ts,{path:"word-matching-test/:testId",element:l.jsx(age,{})}),l.jsx(Ts,{path:"speaking-test/:testId",element:l.jsx(xge,{})}),l.jsx(Ts,{path:"/results",element:l.jsx(qV,{})}),l.jsx(Ts,{path:"/join-game",element:l.jsx(Pge,{})})]}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:d.map(Z=>l.jsx(bu,{type:Z.type,message:Z.message,onClose:()=>f(B=>B.filter(J=>J.id!==Z.id))},Z.id))})]}):l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Setting up Student Application..."})]})})},Rge=()=>l.jsx($U,{children:l.jsx(DV,{children:l.jsx(RV,{children:l.jsx(_ie,{children:l.jsx(Mge,{})})})})}),Oge=({result:e,isOpen:t,onClose:r,initialTab:n="overview",editingSpeakingScore:s,tempSpeakingScore:a,isSavingSpeakingScore:i,onStartSpeakingScoreEdit:o,onSaveSpeakingScore:c,onCancelSpeakingScoreEdit:u,onTempSpeakingScoreChange:d})=>{const[f,h]=w.useState(n),g=w.useRef(!1);if(w.useEffect(()=>()=>{g.current=!0},[]),w.useEffect(()=>{t&&h(n)},[t,n]),!t||!e)return null;const p={test_id:e.test_id,test_name:e.test_name,subject_id:e.subject_id};let x=e?.__audioUrl||void 0;const v=x?void 0:e?.answers;typeof v=="string"?x=v:v&&typeof v=="object"&&(x=v.audio_url),w.useEffect(()=>{console.log("[SpeakingReview] Transcript sources",{fromResult:e?.transcript,fromAnswersObject:typeof v=="object"&&v?.transcript?v.transcript:void 0,hasAnswers:!!v,test_id:e?.test_id,student_id:e?.student_id})},[e?.test_id,e?.student_id]);const[C,b]=w.useState("");w.useEffect(()=>{const T=new AbortController;let N=!1;const E=e?.__studentId||e?.student_id;return!e?.transcript&&!(typeof v=="object"&&v?.transcript)&&e?.test_id&&E&&(async()=>{try{const F=`/.netlify/functions/get-speaking-test-new?action=transcript&test_id=${encodeURIComponent(e.test_id)}&student_id=${encodeURIComponent(E)}`;console.log("[SpeakingReview] Fetching transcript from API:",{url:F});const j=await(window.tokenManager?.getToken()||va.get())||localStorage.getItem("accessToken")||localStorage.getItem("token"),P=await fetch(F,{headers:{Authorization:j?`Bearer ${j}`:""},signal:T.signal});console.log("[SpeakingReview] Transcript API response:",{ok:P.ok,status:P.status});const M=await P.json().catch(()=>({}));console.log("[SpeakingReview] Transcript API body:",M),!N&&!g.current&&(P.ok?b(M.transcript||""):console.warn("[SpeakingReview] Transcript API failed:",M?.error||"unknown error"))}catch(F){F.name!=="AbortError"&&!g.current&&console.error("[SpeakingReview] Transcript fetch error:",F)}})(),()=>{N=!0;try{T.abort()}catch{}}},[e]);const _={score:e.score,max_score:e.max_score,percentage:e.percentage,audio_url:x,transcript:e.transcript||C||(typeof v=="object"&&v?.transcript?v.transcript:void 0),time_taken:e.time_taken,started_at:e.started_at,submitted_at:e.submitted_at};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-600 text-white px-6 py-4 flex justify-between items-center",children:[l.jsxs("h2",{className:"text-xl font-semibold",children:["Speaking Test Review - ",p.test_name]}),l.jsx("button",{onClick:r,className:"text-white hover:text-gray-200 text-2xl font-bold",children:""})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"flex space-x-8 px-6",children:[{id:"audio",label:"Audio"},{id:"transcript",label:"Transcript"},{id:"analysis",label:"AI Analysis"},{id:"scoring",label:"Scoring"}].map(T=>l.jsx("button",{onClick:()=>h(T.id),className:`py-4 px-1 border-b-2 font-medium text-sm ${f===T.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:T.label},T.id))})}),l.jsxs("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[f==="overview"&&l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Test Name"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.test_name})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[_.score," / ",_.max_score]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Time Taken"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.time_taken?`${Math.floor(_.time_taken/60)}:${(_.time_taken%60).toString().padStart(2,"0")}`:"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Submitted At"}),l.jsx("p",{className:"mt-1 text-sm text-gray-900",children:_.submitted_at?new Date(_.submitted_at).toLocaleString():"N/A"})]})]})}),f==="audio"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Audio Recording"}),_.audio_url?l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Click the play button to listen to the student's recording:"}),l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx(KV,{audioUrl:_.audio_url,className:"w-full"})})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No audio recording available"})})]}),f==="transcript"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Transcript"}),_.transcript?l.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:l.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:_.transcript})}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No transcript available"})})]}),f==="analysis"&&l.jsxs("div",{className:"space-y-6",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"AI Analysis Results"}),(()=>{let T=e.ai_feedback;if(T&&typeof T=="string")try{T=JSON.parse(T)}catch{T=null}return T?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Overall Performance"}),l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl font-bold text-gray-800",children:T.overall_score||0}),l.jsx("div",{className:"text-sm text-gray-600",children:"Overall Score (0-100)"})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-4",children:"Category Breakdown"}),l.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[T.grammar_score||0,"/25"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Grammar"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-green-600",children:[T.vocabulary_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Vocabulary"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[T.pronunciation_score||0,"/15"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Pronunciation"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-orange-600",children:[T.fluency_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Fluency"})]}),l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"text-lg font-bold text-red-600",children:[T.content_score||0,"/20"]}),l.jsx("div",{className:"text-xs text-gray-600",children:"Content"})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Performance Metrics"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Word Count:"}),l.jsx("span",{className:"text-sm font-medium",children:T.word_count||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Grammar Mistakes:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:T.grammar_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Vocabulary Issues:"}),l.jsx("span",{className:"text-sm font-medium text-red-600",children:T.vocabulary_mistakes||0})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Difficulty Level:"}),l.jsx("span",{className:"text-sm font-medium",children:T.difficulty_level||"N/A"})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"AI Feedback"}),T.feedback?l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:T.feedback})}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("p",{className:"text-sm",children:"No AI feedback available"})})]})]}),T.improved_transcript&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Improved Transcript"}),l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:l.jsx("p",{className:"text-sm text-gray-700",children:T.improved_transcript})})]}),T.grammar_corrections&&T.grammar_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Grammar Corrections"}),l.jsx("div",{className:"space-y-3",children:T.grammar_corrections.map((N,E)=>l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-red-800",children:"Mistake:"})," ",N.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Correction:"})," ",N.correction]}),N.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",N.explanation]})]},E))})]}),T.vocabulary_corrections&&T.vocabulary_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Vocabulary Improvements"}),l.jsx("div",{className:"space-y-3",children:T.vocabulary_corrections.map((N,E)=>l.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-yellow-800",children:"Original:"})," ",N.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-green-800",children:"Better:"})," ",N.correction]}),N.explanation&&l.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[l.jsx("span",{className:"font-medium",children:"Explanation:"})," ",N.explanation]})]},E))})]}),T.language_use_corrections&&T.language_use_corrections.length>0&&l.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"text-md font-semibold text-gray-800 mb-3",children:"Language Use Suggestions"}),l.jsx("div",{className:"space-y-3",children:T.language_use_corrections.map((N,E)=>l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[l.jsxs("div",{className:"text-sm",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Original:"})," ",N.mistake]}),l.jsxs("div",{className:"text-sm mt-1",children:[l.jsx("span",{className:"font-medium text-blue-800",children:"Suggestion:"})," ",N.suggestion]}),N.explanation&&l.jsx("div",{className:"text-xs text-blue-700 mt-1",children:N.explanation})]},E))})]})]}):l.jsx("div",{className:"text-center py-8 text-gray-500",children:l.jsx("p",{children:"No AI analysis available for this result"})})})()]}),f==="scoring"&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 text-center",children:"Score Details"}),s?l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 place-items-center",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Score"}),l.jsx("input",{type:"number",min:"0",max:_.max_score,value:a,onChange:T=>d(T.target.value),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Max Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.max_score," (Fixed)"]})]})]}),l.jsxs("div",{className:"flex justify-center space-x-3",children:[l.jsx("button",{onClick:c,disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Saving...":"Save Score"}),l.jsx("button",{onClick:u,className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",children:"Cancel"})]})]}):l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("div",{className:"grid grid-cols-1 place-items-center gap-2",children:l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 text-center",children:"Current Score"}),l.jsxs("p",{className:"mt-1 text-sm text-gray-900 text-center",children:[_.score," / ",_.max_score]})]})}),l.jsx("button",{onClick:()=>o(e.id,_.score),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 mx-auto",children:"Edit Score"})]})]})]}),l.jsx("div",{className:"bg-gray-50 px-6 py-4 flex justify-end space-x-3",children:l.jsx("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50",children:"Close"})})]})})},Dge=({isOpen:e,onClose:t,testResult:r,questions:n,isLoadingQuestions:s,onScoreUpdate:a})=>{const[i,o]=w.useState(!1),[c,u]=w.useState(""),[d,f]=w.useState(!1),h=M=>{if(!M)return{};if(typeof M=="string")try{return JSON.parse(M)}catch{return{}}return M||{}},g=()=>{const M=r.best_retest_score!==null&&r.best_retest_score!==void 0?r.best_retest_score:r.score||0;u(M.toString()),o(!0)},p=()=>{o(!1),u("")},x=async M=>{M&&(M.preventDefault(),M.stopPropagation());const I=r?.id||r?.result_id;if(!I){console.error("TestAnswerModal: No id/result_id found",r),alert("Error: Test result ID not found");return}console.log("TestAnswerModal: Saving score",{resultId:I,score:c,testType:r.test_type}),f(!0);try{const U=r.test_type||r.testType,K={resultId:I,score:parseInt(c)||0,testType:U};console.log("TestAnswerModal: Sending payload",K);let te;if(window.tokenManager?.makeAuthenticatedRequest)te=await window.tokenManager.makeAuthenticatedRequest(a0.UPDATE_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(K)});else{const{SecureToken:re}=await ui(async()=>{const{SecureToken:B}=await Promise.resolve().then(()=>G4);return{SecureToken:B}},void 0),Z=await(window.tokenManager?.getToken()||re.get())||localStorage.getItem("accessToken")||localStorage.getItem("token");te=await fetch(a0.UPDATE_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:Z?`Bearer ${Z}`:""},body:JSON.stringify(K)})}if(console.log("TestAnswerModal: Response status",te.status),te.ok){const re=await te.json();console.log("TestAnswerModal: Score updated successfully",re),a&&a(re),o(!1),u("")}else{const re=await te.json().catch(()=>({error:"Unknown error"}));console.error("TestAnswerModal: Error response",re),alert(re.error||`Failed to update score. Status: ${te.status}`)}}catch(U){console.error("TestAnswerModal: Exception updating score:",U),alert(`Failed to update score: ${U.message||U}`)}finally{f(!1)}},v=w.useMemo(()=>{const M=r?.answers;if(console.log(" [TestAnswerModal] Raw testResult.answers:",M),console.log(" [TestAnswerModal] Raw testResult.answers type:",typeof M),console.log(" [TestAnswerModal] testResult.retest_offered:",r?.retest_offered),M&&typeof M=="object"&&M.answers_by_id)return console.log(" [TestAnswerModal] Found answers_by_id format"),console.log(" [TestAnswerModal] answers_by_id:",M.answers_by_id),console.log(" [TestAnswerModal] question_order:",M.question_order),M.answers_by_id||{};const I=h(M);return console.log(" [TestAnswerModal] Parsed student answers:",I),console.log(" [TestAnswerModal] Full testResult:",r),I},[r?.answers]),C=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((M,I)=>{const U=M.question_id||M.id||I+1,K=String(U),te=Number(U),re=v[K]!==void 0?v[K]:v[te]!==void 0?v[te]:v[U]!==void 0?v[U]:void 0,Z=M.correct_answer,B=re===Z,J=z=>{if(M.options&&Array.isArray(M.options)){const H=z.charCodeAt(0)-65;return M.options[H]||z}const q=`option_${z.toLowerCase()}`;return M[q]||z};return l.jsxs("tr",{className:B?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:I+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",dangerouslySetInnerHTML:{__html:Ms(M.question)}}),l.jsx("td",{className:"px-4 py-3 text-sm",children:re?l.jsxs("span",{className:`font-medium ${B?"text-green-700":"text-red-700"}`,children:[re," - ",l.jsx("span",{dangerouslySetInnerHTML:{__html:Ms(String(J(re)))}})]}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700",children:[Z," - ",l.jsx("span",{dangerouslySetInnerHTML:{__html:Ms(String(J(Z)))}})]}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:B?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},K)})})]})}),b=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((M,I)=>{const U=M.question_id||M.id||I+1,K=String(U),te=Number(U),re=v[K]!==void 0?v[K]:v[te]!==void 0?v[te]:v[U]!==void 0?v[U]:void 0,Z=M.correct_answer;let B;typeof re=="boolean"?B=re:typeof re=="string"?B=re.toLowerCase().trim()==="true":re===1||re==="1"?B=!0:re===0||re==="0"?B=!1:B=!!re;let J;typeof Z=="boolean"?J=Z:typeof Z=="string"?J=Z.toLowerCase().trim()==="true":J=!!Z;const z=B===J;I===0&&console.log(" [TestAnswerModal] True/False First Question Debug:",{questionIdStr:K,studentAnswer:re,studentAnswerType:typeof re,normalizedStudentAnswer:B,correctAnswer:Z,correctAnswerType:typeof Z,normalizedCorrectAnswer:J,isCorrect:z});const q=re!=null?B:null,H=J;return l.jsxs("tr",{className:z?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:I+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",dangerouslySetInnerHTML:{__html:Ms(M.question)}}),l.jsx("td",{className:"px-4 py-3 text-sm",children:q!==null?l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${q?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:q?"True":"False"}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm",children:l.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${H?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:H?"True":"False"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:z?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},K)})})]})}),_=()=>{if(!n||n.length===0)return l.jsx("p",{className:"text-gray-500",children:"No questions available"});const M=(I,U)=>{if(!I||!U||U.length===0)return!1;const K=String(I).toLowerCase().trim();return U.some(te=>{const re=String(te).toLowerCase().trim();return K===re||re.length>=2&&K.includes(re)?!0:re.length===1?K.startsWith(re)||K.endsWith(re):!1})};return l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Question"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Answer(s)"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((I,U)=>{const K=I.question_id||I.id||U+1,te=String(K),re=Number(K),Z=v[te]!==void 0?v[te]:v[re]!==void 0?v[re]:v[K]!==void 0?v[K]:void 0,B=Array.isArray(I.correct_answers)?I.correct_answers:I.correct_answer?[I.correct_answer]:[],J=M(Z,B);return U===0&&console.log(" [TestAnswerModal] First question debug:",{questionIdNum:K,questionIdStr:te,questionIdNumKey:re,studentAnswer:Z,studentAnswers:v,studentAnswersKeys:Object.keys(v),correctAnswers:B,question:I}),l.jsxs("tr",{className:J?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:U+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",dangerouslySetInnerHTML:{__html:Ms(I.question)}}),l.jsx("td",{className:"px-4 py-3 text-sm",children:Z?l.jsx("span",{className:`font-medium ${J?"text-green-700":"text-red-700"}`,dangerouslySetInnerHTML:{__html:(()=>{const z=String(Z);if(z.includes("$"))return Ms(z);if(/\\[a-zA-Z]+|[\^_]\{|\\times|\\div|\\sqrt|\\frac/.test(z))try{return TT(z)}catch{return Ms(z)}return Ms(z)})()}}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B.length>0?l.jsx("div",{className:"space-y-1",children:B.map((z,q)=>{const H=String(z);return l.jsx("div",{className:"text-xs bg-gray-100 px-2 py-1 rounded",dangerouslySetInnerHTML:{__html:(()=>{if(H.includes("$"))return Ms(H);if(/\\[a-zA-Z]+|[\^_]\{|\\times|\\div|\\sqrt|\\frac/.test(H))try{return TT(H)}catch{return Ms(H)}return Ms(H)})()}},q)})}):l.jsx("span",{className:"text-gray-400",children:"No correct answer defined"})}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:J?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},te)})})]})})},T=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-16",children:"Q#"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Left Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Correct Match"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((M,I)=>{const U=M.question_id||M.id||I+1,K=String(U),te=Number(U),re=v[K]!==void 0?v[K]:v[te]!==void 0?v[te]:v[U]!==void 0?v[U]:void 0,Z=M.left_word,B=M.right_word;let J=null,z=!1;if(re){if(typeof re=="object")J=re.definition||re.right||re.word,z=re.word===Z&&(re.definition||re.right)===B;else if(typeof re=="string")try{const q=JSON.parse(re);J=q.definition||q.right||q.word,z=q.word===Z&&(q.definition||q.right)===B}catch{J=re}}return l.jsxs("tr",{className:z?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm font-medium text-gray-900",children:I+1}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:Z}),l.jsx("td",{className:"px-4 py-3 text-sm",children:J?l.jsx("span",{className:z?"text-green-700 font-medium":"text-red-700 font-medium",children:J}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:B}),l.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-sm",children:z?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:" Correct"}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:" Wrong"})})]},K)})})]})}),N=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsx("div",{className:"space-y-6",children:n.map((M,I)=>{const U=M.question_id||M.id||I+1,K=String(U),te=Number(U);I===0&&console.log(" [TestAnswerModal] Fill Blanks First Question Debug:",{questionIdNum:U,questionIdStr:K,questionIdNumKey:te,question:M,studentAnswers:v,studentAnswersKeys:Object.keys(v),correctAnswers:M.correct_answers});const re=v[K]!==void 0?v[K]:v[te]!==void 0?v[te]:v[U]!==void 0?v[U]:void 0,Z=Array.isArray(M.correct_answers)?M.correct_answers:[];let B=[];return Array.isArray(re)?B=re:re!=null?B=[re]:B=[],l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Question ",I+1]}),l.jsxs("div",{className:"space-y-3",children:[M.question_json&&l.jsx("div",{className:"text-sm text-gray-700 mb-4",children:typeof M.question_json=="string"?M.question_json:M.question_json.text||M.question_json.question||"Question text not available"}),l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Blank #"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Correct Answer"}),l.jsx("th",{className:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase w-20",children:"Status"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.map((J,z)=>{let q=B[z];const H=z+1,R=String(H),L=Number(H);(q==null||q==="")&&(q=v[R]!==void 0?v[R]:v[L]!==void 0?v[L]:q),I===0&&z===0&&console.log(" [TestAnswerModal] Fill Blanks First Blank Debug:",{blankIndex:z,potentialBlankId:H,potentialBlankIdStr:R,potentialBlankIdNum:L,studentAns:q,studentAnswersForQ:B,correctAns:J,studentAnswersKeys:Object.keys(v)});const G=String(q||"").trim().toLowerCase()===String(J||"").trim().toLowerCase();return l.jsxs("tr",{className:G?"bg-green-50":"bg-red-50",children:[l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm font-medium text-gray-900",children:z+1}),l.jsx("td",{className:"px-4 py-2 text-sm",children:q?l.jsx("span",{className:G?"text-green-700 font-medium":"text-red-700 font-medium",children:String(q)}):l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})}),l.jsx("td",{className:"px-4 py-2 text-sm text-gray-700",children:String(J)}),l.jsx("td",{className:"px-4 py-2 whitespace-nowrap text-sm",children:G?l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:""}):l.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800",children:""})})]},z)})})]})]})]},K)})}),E=()=>!n||n.length===0?l.jsx("p",{className:"text-gray-500",children:"No questions available"}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Matching type tests require visual comparison. Answers stored as connection pairs."}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[l.jsx("thead",{className:"bg-gray-50",children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Word"}),l.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Student Connection"})]})}),l.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map((M,I)=>{const U=M.question_id||M.id||I+1,K=String(U),te=Number(U),re=v[K]!==void 0?v[K]:v[te]!==void 0?v[te]:v[U]!==void 0?v[U]:void 0;return l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:M.word}),l.jsx("td",{className:"px-4 py-3 text-sm text-gray-700",children:re?typeof re=="object"?JSON.stringify(re):re:l.jsx("span",{className:"text-gray-400 italic",children:"No answer"})})]},K)})})]})})]}),F=()=>{if(!r)return null;const M=r.test_type||r.testType;if(s)return l.jsxs("div",{className:"flex items-center justify-center py-12",children:[l.jsx(Xr,{size:"lg"}),l.jsx("span",{className:"ml-4 text-gray-600",children:"Loading questions..."})]});if(!n||n.length===0)return l.jsxs("div",{className:"text-center py-8",children:[l.jsx("p",{className:"text-gray-500",children:"Unable to load questions for this test."}),l.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:["Test ID: ",r.test_id,", Type: ",M]})]});switch(M){case"multiple_choice":return C();case"true_false":return b();case"input":return _();case"word_matching":return T();case"fill_blanks":return N();case"matching_type":return E();default:return l.jsxs("div",{className:"text-center py-8",children:[l.jsxs("p",{className:"text-gray-500",children:['Test type "',M,'" is not supported for answer viewing.']}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Drawing and Speaking tests have their own dedicated modals."})]})}};if(!r)return null;r.test_type||r.testType;const j=`${r.name||""} ${r.surname||""}`.trim(),P=`${r.test_name||"Test"} - ${j||r.student_id}`;return l.jsxs(Ds,{isOpen:e,onClose:t,title:P,size:"large",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[l.jsxs("div",{className:"flex space-x-6",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Score"}),(()=>{const M=r.test_type||r.testType,I=["multiple_choice","true_false","input"].includes(M),U=r.best_retest_score!==null&&r.best_retest_score!==void 0?r.best_retest_score:r.score||0,K=r.best_retest_max_score||r.max_score||0;return I&&i?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"number",min:"0",max:K,value:c,onChange:te=>u(te.target.value),className:"w-16 px-2 py-1 text-sm border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsxs("span",{className:"text-lg font-semibold text-gray-500",children:["/ ",K]}),l.jsx("button",{type:"button",onClick:x,disabled:d,className:"px-2 py-1 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50",children:d?"Saving...":"Save"}),l.jsx("button",{type:"button",onClick:p,disabled:d,className:"px-2 py-1 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:[U," / ",K,r.best_retest_score!==null&&r.best_retest_score!==void 0&&l.jsx("span",{className:"ml-2 text-xs text-blue-600",children:"(Retest Best)"})]}),I&&l.jsx("button",{onClick:g,className:"ml-2 px-2 py-1 text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:"Click to edit score",children:"Edit"})]})})()]}),r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0&&r.best_retest_percentage>0||r.percentage&&r.percentage>0?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Percentage"}),l.jsx("div",{className:"text-lg font-semibold text-gray-900",children:r.best_retest_percentage!==null&&r.best_retest_percentage!==void 0?`${r.best_retest_percentage.toFixed(1)}%`:`${r.percentage?.toFixed(1)||"0.0"}%`})]}):null,r.subject&&r.subject!=="N/A"?l.jsxs("div",{children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Subject"}),l.jsx("div",{className:"text-sm font-medium text-gray-700",children:r.subject})]}):null]}),r.submitted_at&&l.jsxs("div",{className:"text-right",children:[l.jsx("span",{className:"text-xs text-gray-500",children:"Submitted"}),l.jsx("div",{className:"text-sm text-gray-700",children:new Date(r.submitted_at).toLocaleString()})]})]}),l.jsx("div",{className:"max-h-[70vh] overflow-y-auto",children:F()}),r.caught_cheating&&l.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsxs("p",{className:"text-sm text-red-800",children:[" This test was flagged for suspicious activity (visibility changes: ",r.visibility_change_times||0,")"]})})]})},Ige=({isOpen:e,onClose:t,testResult:r,onScoreUpdate:n})=>{const[s,a]=w.useState(""),[i,o]=w.useState(!1);Rs.useEffect(()=>{if(console.log("EditScoreModal: useEffect triggered",{isOpen:e,testResult:r}),e&&r){const h=r.best_retest_score!==null&&r.best_retest_score!==void 0?r.best_retest_score:r.score||0;a(h.toString()),console.log("EditScoreModal: Initialized with score",h)}},[e,r]);const c=async h=>{h.preventDefault(),h.stopPropagation();const g=r?.id||r?.result_id;if(!g){console.error("EditScoreModal: No id/result_id found",r),alert("Error: Test result ID not found");return}console.log("EditScoreModal: Saving score",{resultId:g,score:s,testType:r.test_type}),o(!0);try{const p=r.test_type||r.testType,x={resultId:g,score:parseInt(s)||0,testType:p};console.log("EditScoreModal: Sending payload",x);let v;if(window.tokenManager?.makeAuthenticatedRequest)v=await window.tokenManager.makeAuthenticatedRequest(a0.UPDATE_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});else{const{SecureToken:C}=await ui(async()=>{const{SecureToken:_}=await Promise.resolve().then(()=>G4);return{SecureToken:_}},void 0),b=await(window.tokenManager?.getToken()||C.get())||localStorage.getItem("accessToken")||localStorage.getItem("token");v=await fetch(a0.UPDATE_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:b?`Bearer ${b}`:""},body:JSON.stringify(x)})}if(console.log("EditScoreModal: Response status",v.status),v.ok){const C=await v.json();console.log("EditScoreModal: Score updated successfully",C),n&&n(C),t()}else{const C=await v.json().catch(()=>({error:"Unknown error"}));console.error("EditScoreModal: Error response",C),alert(C.error||`Failed to update score. Status: ${v.status}`)}}catch(p){console.error("EditScoreModal: Exception updating score:",p),alert(`Failed to update score: ${p.message||p}`)}finally{o(!1)}};if(console.log("EditScoreModal: Rendering",{isOpen:e,testResult:r,hasTestResult:!!r}),!r)return console.log("EditScoreModal: No testResult, returning null"),null;const u=r.best_retest_max_score||r.max_score||0,d=`${r.name||""} ${r.surname||""}`.trim()||r.student_id,f=`Edit Score - ${r.test_name||"Test"} - ${d}`;return l.jsx(Ds,{isOpen:e,onClose:t,title:f,size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Score"}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("input",{type:"number",min:"0",max:u,value:s,onChange:h=>a(h.target.value),className:"w-24 px-3 py-2 text-base border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsxs("span",{className:"text-lg font-semibold text-gray-600",children:["/ ",u]})]}),l.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:["Enter a score between 0 and ",u]})]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[l.jsx("button",{onClick:t,disabled:i,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),l.jsx("button",{type:"button",onClick:c,disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-md hover:bg-green-700 disabled:opacity-50",children:i?"Saving...":"Save"})]})]})})};class Kw extends Rs.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){if(console.error("ErrorBoundary caught an error:",t,r),t.message&&t.message.includes("Minified React error #300")){console.warn("React error #300 caught and handled by ErrorBoundary");return}}render(){return this.state.hasError?l.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded-md",children:[l.jsx("h3",{className:"text-red-800 font-medium",children:"Something went wrong"}),l.jsx("p",{className:"text-red-600 text-sm mt-1",children:"An error occurred while rendering this component."})]}):this.props.children}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var C_={};C_.version="0.18.5";var XV=1252,Lge=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],kE={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},CE=function(e){Lge.indexOf(e)!=-1&&(XV=kE[0]=e)};function Bge(){CE(1252)}var gu=function(e){CE(e)};function TE(){gu(1200),Bge()}function qO(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function $ge(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function JV(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var uv=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?$ge(e.slice(2)):t==254&&r==255?JV(e.slice(2)):t==65279?e.slice(1):e},Yw=function(t){return String.fromCharCode(t)},KO=function(t){return String.fromCharCode(t)},n2,Vf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function s2(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=Vf.charAt(a)+Vf.charAt(i)+Vf.charAt(o)+Vf.charAt(c);return t}function Ql(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Vf.indexOf(e.charAt(u++)),i=Vf.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=Vf.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=Vf.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Mn=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),I0=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function uh(e){return Mn?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function YO(e){return Mn?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Vl=function(t){return Mn?I0(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function ZS(e){if(typeof ArrayBuffer>"u")return Vl(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Sh(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Uge(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function NE(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return NE(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Fi=Mn?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:I0(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function zge(e){for(var t=[],r=0,n=e.length+250,s=uh(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=uh(65535),n=65530)}return t.push(s.slice(0,r)),Fi(t)}var Zo=/\u0000/g,dv=/[\u0001-\u0006]/g;function t1(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function pu(e,t){var r=""+e;return r.length>=t?r:_a("0",t-r.length)+r}function EE(e,t){var r=""+e;return r.length>=t?r:_a(" ",t-r.length)+r}function T_(e,t){var r=""+e;return r.length>=t?r:r+_a(" ",t-r.length)}function Wge(e,t){var r=""+Math.round(e);return r.length>=t?r:_a("0",t-r.length)+r}function Hge(e,t){var r=""+e;return r.length>=t?r:_a("0",t-r.length)+r}var XO=Math.pow(2,32);function kp(e,t){if(e>XO||e<-XO)return Wge(e,t);var r=Math.round(e);return Hge(r,t)}function N_(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var JO=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],F6=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Gge(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var on={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},QO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vge={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function E_(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,d=0,f=Math.floor(s);u<t&&(f=Math.floor(s),o=f*i+a,d=f*u+c,!(s-f<5e-8));)s=1/(s-f),a=i,i=o,c=u,u=d;if(d>t&&(u>t?(d=c,o=a):(d=u,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function wm(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=Qge(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var QV=new Date(1899,11,31,0,0,0),qge=QV.getTime(),Kge=new Date(1900,2,1,0,0,0);function ZV(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Kge&&(r+=1440*60*1e3),(r-(qge+(e.getTimezoneOffset()-QV.getTimezoneOffset())*6e4))/(1440*60*1e3)}function AE(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Yge(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Xge(e){var t=e<0?12:11,r=AE(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Jge(e){var t=AE(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function a2(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Xge(e):t===10?r=e.toFixed(10).substr(0,12):r=Jge(e),AE(Yge(r.toUpperCase()))}function Zm(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):a2(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Bc(14,ZV(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Qge(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function Zge(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return F6[r.m-1][1];case 5:return F6[r.m-1][0];default:return F6[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return JO[r.q][0];default:return JO[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?pu(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=pu(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var d=u>0?pu(c,u):"";return d}function qf(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var eq=/%/g;function epe(e,t,r){var n=t.replace(eq,""),s=t.length-n.length;return p0(e,n,r*Math.pow(10,2*s))+_a("%",s)}function tpe(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return p0(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function tq(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+tq(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var rq=/# (\?+)( ?)\/( ?)(\d+)/;function rpe(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?_a(" ",e[1].length+1+e[4].length):EE(i,e[1].length)+e[2]+"/"+e[3]+pu(o,e[4].length))}function npe(e,t,r){return r+(t===0?"":""+t)+_a(" ",e[1].length+2+e[4].length)}var nq=/^#*0*\.([0#]+)/,sq=/\).*[0#]/,aq=/\(###\) ###\\?-####/;function Go(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function ZO(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function eD(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function spe(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ape(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function vc(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sq)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vc("n",n,r):"("+vc("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return tpe(e,t,r);if(t.indexOf("%")!==-1)return epe(e,t,r);if(t.indexOf("E")!==-1)return tq(t,r);if(t.charCodeAt(0)===36)return"$"+vc(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+kp(c,t.length);if(t.match(/^[#?]+$/))return s=kp(r,0),s==="0"&&(s=""),s.length>t.length?s:Go(t.substr(0,t.length-s.length))+s;if(a=t.match(rq))return rpe(a,c,u);if(t.match(/^#+0+$/))return u+kp(c,t.length-t.indexOf("0"));if(a=t.match(nq))return s=ZO(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Go(a[1])).replace(/\.$/,"."+Go(a[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+_a("0",Go(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+ZO(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+qf(kp(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vc(e,t,-r):qf(""+(Math.floor(r)+spe(r,a[1].length)))+"."+pu(eD(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return vc(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=t1(vc(e,t.replace(/[\\-]/g,""),r)),i=0,t1(t1(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<s.length?s.charAt(i++):p==="0"?"0":""}));if(t.match(aq))return s=vc(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=E_(c,Math.pow(10,i)-1,!1),s=""+u,d=p0("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=T_(o[2],i),d.length<a[4].length&&(d=Go(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=E_(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?EE(o[1],i)+a[2]+"/"+a[3]+T_(o[2],i):_a(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=kp(r,0),t.length<=s.length?s:Go(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,h=t.length-s.length-f;return Go(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=eD(r,a[1].length),r<0?"-"+vc(e,t,-r):qf(ape(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?pu(0,3-p.length):"")+p})+"."+pu(i,a[1].length);switch(t){case"###,##0.00":return vc(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=qf(kp(c,0));return g!=="0"?u+g:"";case"###,###.00":return vc(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vc(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function ipe(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return p0(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function ope(e,t,r){var n=t.replace(eq,""),s=t.length-n.length;return p0(e,n,r*Math.pow(10,2*s))+_a("%",s)}function iq(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+iq(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,d){return c+u+d.substr(0,(s+a)%s)+"."+d.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ju(e,t,r){if(e.charCodeAt(0)===40&&!t.match(sq)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ju("n",n,r):"("+Ju("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ipe(e,t,r);if(t.indexOf("%")!==-1)return ope(e,t,r);if(t.indexOf("E")!==-1)return iq(t,r);if(t.charCodeAt(0)===36)return"$"+Ju(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+pu(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:Go(t.substr(0,t.length-s.length))+s;if(a=t.match(rq))return npe(a,c,u);if(t.match(/^#+0+$/))return u+pu(c,t.length-t.indexOf("0"));if(a=t.match(nq))return s=(""+r).replace(/^([^\.]+)$/,"$1."+Go(a[1])).replace(/\.$/,"."+Go(a[1])),s=s.replace(/\.(\d*)$/,function(p,x){return"."+x+_a("0",Go(a[1]).length-x.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+qf(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ju(e,t,-r):qf(""+r)+"."+_a("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Ju(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=t1(Ju(e,t.replace(/[\\-]/g,""),r)),i=0,t1(t1(t.replace(/\\/g,"")).replace(/[0#]/g,function(p){return i<s.length?s.charAt(i++):p==="0"?"0":""}));if(t.match(aq))return s=Ju(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var d="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=E_(c,Math.pow(10,i)-1,!1),s=""+u,d=p0("n",a[1],o[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),s+=d+a[2]+"/"+a[3],d=T_(o[2],i),d.length<a[4].length&&(d=Go(a[4].substr(a[4].length-d.length))+d),s+=d,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=E_(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?EE(o[1],i)+a[2]+"/"+a[3]+T_(o[2],i):_a(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:Go(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var f=t.indexOf(".")-i,h=t.length-s.length-f;return Go(t.substr(0,f)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ju(e,t,-r):qf(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?pu(0,3-p.length):"")+p})+"."+pu(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=qf(""+c);return g!=="0"?u+g:"";default:if(t.match(/\.[0#?]*$/))return Ju(e,t.slice(0,t.lastIndexOf(".")),r)+Go(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function p0(e,t,r){return(r|0)===r?Ju(e,t,r):vc(e,t,r)}function lpe(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var oq=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function K1(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":N_(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(oq))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function cpe(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,d,f,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!N_(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(f=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(f);s[s.length]={t:"t",v:a},++i;break;case"\\":var g=e.charAt(++i),p=g==="("||g===")"?g:"t";s[s.length]={t:p,v:g},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=wm(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=wm(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"":var x={t:o,v:o};if(u==null&&(u=wm(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(x.v=u.H>=12?"P":"A"),x.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(x.v=u.H>=12?"PM":"AM"),x.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="/"?(u!=null&&(x.v=u.H>=12?"":""),x.t="T",i+=5,h="h"):(x.t="t",++i),u==null&&x.t==="T")return"";s[s.length]=x,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(oq)){if(u==null&&(u=wm(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",K1(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var v=0,C=0,b;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,c="h",v<1&&(v=1);break;case"s":(b=s[i].v.match(/\.0+$/))&&(C=Math.max(C,b[0].length-1)),v<3&&(v=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",v<2&&(v=2));break;case"X":break;case"Z":v<1&&s[i].v.match(/[Hh]/)&&(v=1),v<2&&s[i].v.match(/[Mm]/)&&(v=2),v<3&&s[i].v.match(/[Ss]/)&&(v=3)}switch(v){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var _="",T;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=Zge(s[i].t.charCodeAt(0),s[i].v,u,C),s[i].t="t";break;case"n":case"?":for(T=i+1;s[T]!=null&&((o=s[T].t)==="?"||o==="D"||(o===" "||o==="t")&&s[T+1]!=null&&(s[T+1].t==="?"||s[T+1].t==="t"&&s[T+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[T].v==="/"||s[T].v===" "&&s[T+1]!=null&&s[T+1].t=="?"));)s[i].v+=s[T].v,s[T]={v:"",t:";"},++T;_+=s[i].v,i=T-1;break;case"G":s[i].t="t",s[i].v=Zm(t,r);break}var N="",E,F;if(_.length>0){_.charCodeAt(0)==40?(E=t<0&&_.charCodeAt(0)===45?-t:t,F=p0("n",_,E)):(E=t<0&&n>1?-t:t,F=p0("n",_,E),E<0&&s[0]&&s[0].t=="t"&&(F=F.substr(1),s[0].v="-"+s[0].v)),T=F.length-1;var j=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){j=i;break}var P=s.length;if(j===s.length&&F.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(T>=s[i].v.length-1?(T-=s[i].v.length,s[i].v=F.substr(T+1,s[i].v.length)):T<0?s[i].v="":(s[i].v=F.substr(0,T+1),T=-1),s[i].t="t",P=i);T>=0&&P<s.length&&(s[P].v=F.substr(0,T+1)+s[P].v)}else if(j!==s.length&&F.indexOf("E")===-1){for(T=F.indexOf(".")-1,i=j;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(d=s[i].v.indexOf(".")>-1&&i===j?s[i].v.indexOf(".")-1:s[i].v.length-1,N=s[i].v.substr(d+1);d>=0;--d)T>=0&&(s[i].v.charAt(d)==="0"||s[i].v.charAt(d)==="#")&&(N=F.charAt(T--)+N);s[i].v=N,s[i].t="t",P=i}for(T>=0&&P<s.length&&(s[P].v=F.substr(0,T+1)+s[P].v),T=F.indexOf(".")+1,i=j;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==j)){for(d=s[i].v.indexOf(".")>-1&&i===j?s[i].v.indexOf(".")+1:0,N=s[i].v.substr(0,d);d<s[i].v.length;++d)T<F.length&&(N+=F.charAt(T++));s[i].v=N,s[i].t="t",P=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(E=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=p0(s[i].t,s[i].v,E),s[i].t="t");var M="";for(i=0;i!==s.length;++i)s[i]!=null&&(M+=s[i].v);return M}var tD=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function rD(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function upe(e,t){var r=lpe(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(tD),o=r[1].match(tD);return rD(t,i)?[n,r[0]]:rD(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Bc(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:on)[e],n==null&&(n=r.table&&r.table[QO[e]]||on[QO[e]]),n==null&&(n=Vge[e]||"General");break}if(N_(n,0))return Zm(t,r);t instanceof Date&&(t=ZV(t,r.date1904));var s=upe(n,t);if(N_(s[1]))return Zm(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return cpe(s[1],t,r,s[0])}function x0(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(on[r]==null){t<0&&(t=r);continue}if(on[r]==e){t=r;break}}t<0&&(t=391)}return on[t]=e,t}function e3(e){for(var t=0;t!=392;++t)e[t]!==void 0&&x0(e[t],t)}function Y1(){on=Gge()}var dpe={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},lq=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fpe(e){var t=typeof e=="number"?on[e]:e;return t=t.replace(lq,"(\\d+)"),new RegExp("^"+t+"$")}function hpe(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(lq)||[]).forEach(function(f,h){var g=parseInt(r[h+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=g;break;case"d":a=g;break;case"h":i=g;break;case"s":c=g;break;case"m":i>=0?o=g:s=g;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?d:u+"T"+d}var mpe=(function(){var e={};e.version="1.2.0";function t(){for(var F=0,j=new Array(256),P=0;P!=256;++P)F=P,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,F=F&1?-306674912^F>>>1:F>>>1,j[P]=F;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function n(F){var j=0,P=0,M=0,I=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)I[M]=F[M];for(M=0;M!=256;++M)for(P=F[M],j=256+M;j<4096;j+=256)P=I[j]=P>>>8^F[P&255];var U=[];for(M=1;M!=16;++M)U[M-1]=typeof Int32Array<"u"?I.subarray(M*256,M*256+256):I.slice(M*256,M*256+256);return U}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],d=s[5],f=s[6],h=s[7],g=s[8],p=s[9],x=s[10],v=s[11],C=s[12],b=s[13],_=s[14];function T(F,j){for(var P=j^-1,M=0,I=F.length;M<I;)P=P>>>8^r[(P^F.charCodeAt(M++))&255];return~P}function N(F,j){for(var P=j^-1,M=F.length-15,I=0;I<M;)P=_[F[I++]^P&255]^b[F[I++]^P>>8&255]^C[F[I++]^P>>16&255]^v[F[I++]^P>>>24]^x[F[I++]]^p[F[I++]]^g[F[I++]]^h[F[I++]]^f[F[I++]]^d[F[I++]]^u[F[I++]]^c[F[I++]]^o[F[I++]]^i[F[I++]]^a[F[I++]]^r[F[I++]];for(M+=15;I<M;)P=P>>>8^r[(P^F[I++])&255];return~P}function E(F,j){for(var P=j^-1,M=0,I=F.length,U=0,K=0;M<I;)U=F.charCodeAt(M++),U<128?P=P>>>8^r[(P^U)&255]:U<2048?(P=P>>>8^r[(P^(192|U>>6&31))&255],P=P>>>8^r[(P^(128|U&63))&255]):U>=55296&&U<57344?(U=(U&1023)+64,K=F.charCodeAt(M++)&1023,P=P>>>8^r[(P^(240|U>>8&7))&255],P=P>>>8^r[(P^(128|U>>2&63))&255],P=P>>>8^r[(P^(128|K>>6&15|(U&3)<<4))&255],P=P>>>8^r[(P^(128|K&63))&255]):(P=P>>>8^r[(P^(224|U>>12&15))&255],P=P>>>8^r[(P^(128|U>>6&63))&255],P=P>>>8^r[(P^(128|U&63))&255]);return~P}return e.table=r,e.bstr=T,e.buf=N,e.str=E,e})(),Jr=(function(){var t={};t.version="1.2.1";function r(me,Ne){for(var be=me.split("/"),Ae=Ne.split("/"),ue=0,ge=0,Me=Math.min(be.length,Ae.length);ue<Me;++ue){if(ge=be[ue].length-Ae[ue].length)return ge;if(be[ue]!=Ae[ue])return be[ue]<Ae[ue]?-1:1}return be.length-Ae.length}function n(me){if(me.charAt(me.length-1)=="/")return me.slice(0,-1).indexOf("/")===-1?me:n(me.slice(0,-1));var Ne=me.lastIndexOf("/");return Ne===-1?me:me.slice(0,Ne+1)}function s(me){if(me.charAt(me.length-1)=="/")return s(me.slice(0,-1));var Ne=me.lastIndexOf("/");return Ne===-1?me:me.slice(Ne+1)}function a(me,Ne){typeof Ne=="string"&&(Ne=new Date(Ne));var be=Ne.getHours();be=be<<6|Ne.getMinutes(),be=be<<5|Ne.getSeconds()>>>1,me.write_shift(2,be);var Ae=Ne.getFullYear()-1980;Ae=Ae<<4|Ne.getMonth()+1,Ae=Ae<<5|Ne.getDate(),me.write_shift(2,Ae)}function i(me){var Ne=me.read_shift(2)&65535,be=me.read_shift(2)&65535,Ae=new Date,ue=be&31;be>>>=5;var ge=be&15;be>>>=4,Ae.setMilliseconds(0),Ae.setFullYear(be+1980),Ae.setMonth(ge-1),Ae.setDate(ue);var Me=Ne&31;Ne>>>=5;var ot=Ne&63;return Ne>>>=6,Ae.setHours(Ne),Ae.setMinutes(ot),Ae.setSeconds(Me<<1),Ae}function o(me){eo(me,0);for(var Ne={},be=0;me.l<=me.length-4;){var Ae=me.read_shift(2),ue=me.read_shift(2),ge=me.l+ue,Me={};switch(Ae){case 21589:be=me.read_shift(1),be&1&&(Me.mtime=me.read_shift(4)),ue>5&&(be&2&&(Me.atime=me.read_shift(4)),be&4&&(Me.ctime=me.read_shift(4))),Me.mtime&&(Me.mt=new Date(Me.mtime*1e3));break}me.l=ge,Ne[Ae]=Me}return Ne}var c;function u(){return c||(c={})}function d(me,Ne){if(me[0]==80&&me[1]==75)return ve(me,Ne);if((me[0]|32)==109&&(me[1]|32)==105)return dt(me,Ne);if(me.length<512)throw new Error("CFB file size "+me.length+" < 512");var be=3,Ae=512,ue=0,ge=0,Me=0,ot=0,Je=0,nt=[],mt=me.slice(0,512);eo(mt,0);var de=f(mt);switch(be=de[0],be){case 3:Ae=512;break;case 4:Ae=4096;break;case 0:if(de[1]==0)return ve(me,Ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+be)}Ae!==512&&(mt=me.slice(0,Ae),eo(mt,28));var Se=me.slice(0,Ae);h(mt,be);var De=mt.read_shift(4,"i");if(be===3&&De!==0)throw new Error("# Directory Sectors: Expected 0 saw "+De);mt.l+=4,Me=mt.read_shift(4,"i"),mt.l+=4,mt.chk("00100000","Mini Stream Cutoff Size: "),ot=mt.read_shift(4,"i"),ue=mt.read_shift(4,"i"),Je=mt.read_shift(4,"i"),ge=mt.read_shift(4,"i");for(var Le=-1,tt=0;tt<109&&(Le=mt.read_shift(4,"i"),!(Le<0));++tt)nt[tt]=Le;var qt=g(me,Ae);v(Je,ge,qt,Ae,nt);var kr=b(qt,Me,nt,Ae);kr[Me].name="!Directory",ue>0&&ot!==K&&(kr[ot].name="!MiniFAT"),kr[nt[0]].name="!FAT",kr.fat_addrs=nt,kr.ssz=Ae;var jr={},_t=[],ur=[],Gr=[];_(Me,kr,qt,_t,ue,jr,ur,ot),p(ur,Gr,_t),_t.shift();var Mr={FileIndex:ur,FullPaths:Gr};return Ne&&Ne.raw&&(Mr.raw={header:Se,sectors:qt}),Mr}function f(me){if(me[me.l]==80&&me[me.l+1]==75)return[0,0];me.chk(te,"Header Signature: "),me.l+=16;var Ne=me.read_shift(2,"u");return[me.read_shift(2,"u"),Ne]}function h(me,Ne){var be=9;switch(me.l+=2,be=me.read_shift(2)){case 9:if(Ne!=3)throw new Error("Sector Shift: Expected 9 saw "+be);break;case 12:if(Ne!=4)throw new Error("Sector Shift: Expected 12 saw "+be);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+be)}me.chk("0600","Mini Sector Shift: "),me.chk("000000000000","Reserved: ")}function g(me,Ne){for(var be=Math.ceil(me.length/Ne)-1,Ae=[],ue=1;ue<be;++ue)Ae[ue-1]=me.slice(ue*Ne,(ue+1)*Ne);return Ae[be-1]=me.slice(be*Ne),Ae}function p(me,Ne,be){for(var Ae=0,ue=0,ge=0,Me=0,ot=0,Je=be.length,nt=[],mt=[];Ae<Je;++Ae)nt[Ae]=mt[Ae]=Ae,Ne[Ae]=be[Ae];for(;ot<mt.length;++ot)Ae=mt[ot],ue=me[Ae].L,ge=me[Ae].R,Me=me[Ae].C,nt[Ae]===Ae&&(ue!==-1&&nt[ue]!==ue&&(nt[Ae]=nt[ue]),ge!==-1&&nt[ge]!==ge&&(nt[Ae]=nt[ge])),Me!==-1&&(nt[Me]=Ae),ue!==-1&&Ae!=nt[Ae]&&(nt[ue]=nt[Ae],mt.lastIndexOf(ue)<ot&&mt.push(ue)),ge!==-1&&Ae!=nt[Ae]&&(nt[ge]=nt[Ae],mt.lastIndexOf(ge)<ot&&mt.push(ge));for(Ae=1;Ae<Je;++Ae)nt[Ae]===Ae&&(ge!==-1&&nt[ge]!==ge?nt[Ae]=nt[ge]:ue!==-1&&nt[ue]!==ue&&(nt[Ae]=nt[ue]));for(Ae=1;Ae<Je;++Ae)if(me[Ae].type!==0){if(ot=Ae,ot!=nt[ot])do ot=nt[ot],Ne[Ae]=Ne[ot]+"/"+Ne[Ae];while(ot!==0&&nt[ot]!==-1&&ot!=nt[ot]);nt[Ae]=-1}for(Ne[0]+="/",Ae=1;Ae<Je;++Ae)me[Ae].type!==2&&(Ne[Ae]+="/")}function x(me,Ne,be){for(var Ae=me.start,ue=me.size,ge=[],Me=Ae;be&&ue>0&&Me>=0;)ge.push(Ne.slice(Me*U,Me*U+U)),ue-=U,Me=xm(be,Me*4);return ge.length===0?Ht(0):Fi(ge).slice(0,me.size)}function v(me,Ne,be,Ae,ue){var ge=K;if(me===K){if(Ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(me!==-1){var Me=be[me],ot=(Ae>>>2)-1;if(!Me)return;for(var Je=0;Je<ot&&(ge=xm(Me,Je*4))!==K;++Je)ue.push(ge);v(xm(Me,Ae-4),Ne-1,be,Ae,ue)}}function C(me,Ne,be,Ae,ue){var ge=[],Me=[];ue||(ue=[]);var ot=Ae-1,Je=0,nt=0;for(Je=Ne;Je>=0;){ue[Je]=!0,ge[ge.length]=Je,Me.push(me[Je]);var mt=be[Math.floor(Je*4/Ae)];if(nt=Je*4&ot,Ae<4+nt)throw new Error("FAT boundary crossed: "+Je+" 4 "+Ae);if(!me[mt])break;Je=xm(me[mt],nt)}return{nodes:ge,data:mD([Me])}}function b(me,Ne,be,Ae){var ue=me.length,ge=[],Me=[],ot=[],Je=[],nt=Ae-1,mt=0,de=0,Se=0,De=0;for(mt=0;mt<ue;++mt)if(ot=[],Se=mt+Ne,Se>=ue&&(Se-=ue),!Me[Se]){Je=[];var Le=[];for(de=Se;de>=0;){Le[de]=!0,Me[de]=!0,ot[ot.length]=de,Je.push(me[de]);var tt=be[Math.floor(de*4/Ae)];if(De=de*4&nt,Ae<4+De)throw new Error("FAT boundary crossed: "+de+" 4 "+Ae);if(!me[tt]||(de=xm(me[tt],De),Le[de]))break}ge[Se]={nodes:ot,data:mD([Je])}}return ge}function _(me,Ne,be,Ae,ue,ge,Me,ot){for(var Je=0,nt=Ae.length?2:0,mt=Ne[me].data,de=0,Se=0,De;de<mt.length;de+=128){var Le=mt.slice(de,de+128);eo(Le,64),Se=Le.read_shift(2),De=DE(Le,0,Se-nt),Ae.push(De);var tt={name:De,type:Le.read_shift(1),color:Le.read_shift(1),L:Le.read_shift(4,"i"),R:Le.read_shift(4,"i"),C:Le.read_shift(4,"i"),clsid:Le.read_shift(16),state:Le.read_shift(4,"i"),start:0,size:0},qt=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);qt!==0&&(tt.ct=T(Le,Le.l-8));var kr=Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2)+Le.read_shift(2);kr!==0&&(tt.mt=T(Le,Le.l-8)),tt.start=Le.read_shift(4,"i"),tt.size=Le.read_shift(4,"i"),tt.size<0&&tt.start<0&&(tt.size=tt.type=0,tt.start=K,tt.name=""),tt.type===5?(Je=tt.start,ue>0&&Je!==K&&(Ne[Je].name="!StreamData")):tt.size>=4096?(tt.storage="fat",Ne[tt.start]===void 0&&(Ne[tt.start]=C(be,tt.start,Ne.fat_addrs,Ne.ssz)),Ne[tt.start].name=tt.name,tt.content=Ne[tt.start].data.slice(0,tt.size)):(tt.storage="minifat",tt.size<0?tt.size=0:Je!==K&&tt.start!==K&&Ne[Je]&&(tt.content=x(tt,Ne[Je].data,(Ne[ot]||{}).data))),tt.content&&eo(tt.content,0),ge[De]=tt,Me.push(tt)}}function T(me,Ne){return new Date((Wl(me,Ne+4)/1e7*Math.pow(2,32)+Wl(me,Ne)/1e7-11644473600)*1e3)}function N(me,Ne){return u(),d(c.readFileSync(me),Ne)}function E(me,Ne){var be=Ne&&Ne.type;switch(be||Mn&&Buffer.isBuffer(me)&&(be="buffer"),be||"base64"){case"file":return N(me,Ne);case"base64":return d(Vl(Ql(me)),Ne);case"binary":return d(Vl(me),Ne)}return d(me,Ne)}function F(me,Ne){var be=Ne||{},Ae=be.root||"Root Entry";if(me.FullPaths||(me.FullPaths=[]),me.FileIndex||(me.FileIndex=[]),me.FullPaths.length!==me.FileIndex.length)throw new Error("inconsistent CFB structure");me.FullPaths.length===0&&(me.FullPaths[0]=Ae+"/",me.FileIndex[0]={name:Ae,type:5}),be.CLSID&&(me.FileIndex[0].clsid=be.CLSID),j(me)}function j(me){var Ne="Sh33tJ5";if(!Jr.find(me,"/"+Ne)){var be=Ht(4);be[0]=55,be[1]=be[3]=50,be[2]=54,me.FileIndex.push({name:Ne,type:2,content:be,size:4,L:69,R:69,C:69}),me.FullPaths.push(me.FullPaths[0]+Ne),P(me)}}function P(me,Ne){F(me);for(var be=!1,Ae=!1,ue=me.FullPaths.length-1;ue>=0;--ue){var ge=me.FileIndex[ue];switch(ge.type){case 0:Ae?be=!0:(me.FileIndex.pop(),me.FullPaths.pop());break;case 1:case 2:case 5:Ae=!0,isNaN(ge.R*ge.L*ge.C)&&(be=!0),ge.R>-1&&ge.L>-1&&ge.R==ge.L&&(be=!0);break;default:be=!0;break}}if(!(!be&&!Ne)){var Me=new Date(1987,1,19),ot=0,Je=Object.create?Object.create(null):{},nt=[];for(ue=0;ue<me.FullPaths.length;++ue)Je[me.FullPaths[ue]]=!0,me.FileIndex[ue].type!==0&&nt.push([me.FullPaths[ue],me.FileIndex[ue]]);for(ue=0;ue<nt.length;++ue){var mt=n(nt[ue][0]);Ae=Je[mt],Ae||(nt.push([mt,{name:s(mt).replace("/",""),type:1,clsid:Z,ct:Me,mt:Me,content:null}]),Je[mt]=!0)}for(nt.sort(function(De,Le){return r(De[0],Le[0])}),me.FullPaths=[],me.FileIndex=[],ue=0;ue<nt.length;++ue)me.FullPaths[ue]=nt[ue][0],me.FileIndex[ue]=nt[ue][1];for(ue=0;ue<nt.length;++ue){var de=me.FileIndex[ue],Se=me.FullPaths[ue];if(de.name=s(Se).replace("/",""),de.L=de.R=de.C=-(de.color=1),de.size=de.content?de.content.length:0,de.start=0,de.clsid=de.clsid||Z,ue===0)de.C=nt.length>1?1:-1,de.size=0,de.type=5;else if(Se.slice(-1)=="/"){for(ot=ue+1;ot<nt.length&&n(me.FullPaths[ot])!=Se;++ot);for(de.C=ot>=nt.length?-1:ot,ot=ue+1;ot<nt.length&&n(me.FullPaths[ot])!=n(Se);++ot);de.R=ot>=nt.length?-1:ot,de.type=1}else n(me.FullPaths[ue+1]||"")==n(Se)&&(de.R=ue+1),de.type=2}}}function M(me,Ne){var be=Ne||{};if(be.fileType=="mad")return Bt(me,be);switch(P(me),be.fileType){case"zip":return Be(me,be)}var Ae=(function(De){for(var Le=0,tt=0,qt=0;qt<De.FileIndex.length;++qt){var kr=De.FileIndex[qt];if(kr.content){var jr=kr.content.length;jr>0&&(jr<4096?Le+=jr+63>>6:tt+=jr+511>>9)}}for(var _t=De.FullPaths.length+3>>2,ur=Le+7>>3,Gr=Le+127>>7,Mr=ur+tt+_t+Gr,Tr=Mr+127>>7,qr=Tr<=109?0:Math.ceil((Tr-109)/127);Mr+Tr+qr+127>>7>Tr;)qr=++Tr<=109?0:Math.ceil((Tr-109)/127);var $r=[1,qr,Tr,Gr,_t,tt,Le,0];return De.FileIndex[0].size=Le<<6,$r[7]=(De.FileIndex[0].start=$r[0]+$r[1]+$r[2]+$r[3]+$r[4]+$r[5])+($r[6]+7>>3),$r})(me),ue=Ht(Ae[7]<<9),ge=0,Me=0;{for(ge=0;ge<8;++ge)ue.write_shift(1,re[ge]);for(ge=0;ge<8;++ge)ue.write_shift(2,0);for(ue.write_shift(2,62),ue.write_shift(2,3),ue.write_shift(2,65534),ue.write_shift(2,9),ue.write_shift(2,6),ge=0;ge<3;++ge)ue.write_shift(2,0);for(ue.write_shift(4,0),ue.write_shift(4,Ae[2]),ue.write_shift(4,Ae[0]+Ae[1]+Ae[2]+Ae[3]-1),ue.write_shift(4,0),ue.write_shift(4,4096),ue.write_shift(4,Ae[3]?Ae[0]+Ae[1]+Ae[2]-1:K),ue.write_shift(4,Ae[3]),ue.write_shift(-4,Ae[1]?Ae[0]-1:K),ue.write_shift(4,Ae[1]),ge=0;ge<109;++ge)ue.write_shift(-4,ge<Ae[2]?Ae[1]+ge:-1)}if(Ae[1])for(Me=0;Me<Ae[1];++Me){for(;ge<236+Me*127;++ge)ue.write_shift(-4,ge<Ae[2]?Ae[1]+ge:-1);ue.write_shift(-4,Me===Ae[1]-1?K:Me+1)}var ot=function(De){for(Me+=De;ge<Me-1;++ge)ue.write_shift(-4,ge+1);De&&(++ge,ue.write_shift(-4,K))};for(Me=ge=0,Me+=Ae[1];ge<Me;++ge)ue.write_shift(-4,B.DIFSECT);for(Me+=Ae[2];ge<Me;++ge)ue.write_shift(-4,B.FATSECT);ot(Ae[3]),ot(Ae[4]);for(var Je=0,nt=0,mt=me.FileIndex[0];Je<me.FileIndex.length;++Je)mt=me.FileIndex[Je],mt.content&&(nt=mt.content.length,!(nt<4096)&&(mt.start=Me,ot(nt+511>>9)));for(ot(Ae[6]+7>>3);ue.l&511;)ue.write_shift(-4,B.ENDOFCHAIN);for(Me=ge=0,Je=0;Je<me.FileIndex.length;++Je)mt=me.FileIndex[Je],mt.content&&(nt=mt.content.length,!(!nt||nt>=4096)&&(mt.start=Me,ot(nt+63>>6)));for(;ue.l&511;)ue.write_shift(-4,B.ENDOFCHAIN);for(ge=0;ge<Ae[4]<<2;++ge){var de=me.FullPaths[ge];if(!de||de.length===0){for(Je=0;Je<17;++Je)ue.write_shift(4,0);for(Je=0;Je<3;++Je)ue.write_shift(4,-1);for(Je=0;Je<12;++Je)ue.write_shift(4,0);continue}mt=me.FileIndex[ge],ge===0&&(mt.start=mt.size?mt.start-1:K);var Se=ge===0&&be.root||mt.name;if(nt=2*(Se.length+1),ue.write_shift(64,Se,"utf16le"),ue.write_shift(2,nt),ue.write_shift(1,mt.type),ue.write_shift(1,mt.color),ue.write_shift(-4,mt.L),ue.write_shift(-4,mt.R),ue.write_shift(-4,mt.C),mt.clsid)ue.write_shift(16,mt.clsid,"hex");else for(Je=0;Je<4;++Je)ue.write_shift(4,0);ue.write_shift(4,mt.state||0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(4,mt.start),ue.write_shift(4,mt.size),ue.write_shift(4,0)}for(ge=1;ge<me.FileIndex.length;++ge)if(mt=me.FileIndex[ge],mt.size>=4096)if(ue.l=mt.start+1<<9,Mn&&Buffer.isBuffer(mt.content))mt.content.copy(ue,ue.l,0,mt.size),ue.l+=mt.size+511&-512;else{for(Je=0;Je<mt.size;++Je)ue.write_shift(1,mt.content[Je]);for(;Je&511;++Je)ue.write_shift(1,0)}for(ge=1;ge<me.FileIndex.length;++ge)if(mt=me.FileIndex[ge],mt.size>0&&mt.size<4096)if(Mn&&Buffer.isBuffer(mt.content))mt.content.copy(ue,ue.l,0,mt.size),ue.l+=mt.size+63&-64;else{for(Je=0;Je<mt.size;++Je)ue.write_shift(1,mt.content[Je]);for(;Je&63;++Je)ue.write_shift(1,0)}if(Mn)ue.l=ue.length;else for(;ue.l<ue.length;)ue.write_shift(1,0);return ue}function I(me,Ne){var be=me.FullPaths.map(function(Je){return Je.toUpperCase()}),Ae=be.map(function(Je){var nt=Je.split("/");return nt[nt.length-(Je.slice(-1)=="/"?2:1)]}),ue=!1;Ne.charCodeAt(0)===47?(ue=!0,Ne=be[0].slice(0,-1)+Ne):ue=Ne.indexOf("/")!==-1;var ge=Ne.toUpperCase(),Me=ue===!0?be.indexOf(ge):Ae.indexOf(ge);if(Me!==-1)return me.FileIndex[Me];var ot=!ge.match(dv);for(ge=ge.replace(Zo,""),ot&&(ge=ge.replace(dv,"!")),Me=0;Me<be.length;++Me)if((ot?be[Me].replace(dv,"!"):be[Me]).replace(Zo,"")==ge||(ot?Ae[Me].replace(dv,"!"):Ae[Me]).replace(Zo,"")==ge)return me.FileIndex[Me];return null}var U=64,K=-2,te="d0cf11e0a1b11ae1",re=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",B={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:K,FREESECT:-1,HEADER_SIGNATURE:te,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function J(me,Ne,be){u();var Ae=M(me,be);c.writeFileSync(Ne,Ae)}function z(me){for(var Ne=new Array(me.length),be=0;be<me.length;++be)Ne[be]=String.fromCharCode(me[be]);return Ne.join("")}function q(me,Ne){var be=M(me,Ne);switch(Ne&&Ne.type||"buffer"){case"file":return u(),c.writeFileSync(Ne.filename,be),be;case"binary":return typeof be=="string"?be:z(be);case"base64":return s2(typeof be=="string"?be:z(be));case"buffer":if(Mn)return Buffer.isBuffer(be)?be:I0(be);case"array":return typeof be=="string"?Vl(be):be}return be}var H;function R(me){try{var Ne=me.InflateRaw,be=new Ne;if(be._processChunk(new Uint8Array([3,0]),be._finishFlushFlag),be.bytesRead)H=me;else throw new Error("zlib does not expose bytesRead")}catch(Ae){console.error("cannot use native zlib: "+(Ae.message||Ae))}}function L(me,Ne){if(!H)return or(me,Ne);var be=H.InflateRaw,Ae=new be,ue=Ae._processChunk(me.slice(me.l),Ae._finishFlushFlag);return me.l+=Ae.bytesRead,ue}function G(me){return H?H.deflateRawSync(me):Oe(me)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function se(me){var Ne=(me<<1|me<<11)&139536|(me<<5|me<<15)&558144;return(Ne>>16|Ne>>8|Ne)&255}for(var le=typeof Uint8Array<"u",he=le?new Uint8Array(256):[],we=0;we<256;++we)he[we]=se(we);function ie(me,Ne){var be=he[me&255];return Ne<=8?be>>>8-Ne:(be=be<<8|he[me>>8&255],Ne<=16?be>>>16-Ne:(be=be<<8|he[me>>16&255],be>>>24-Ne))}function Ee(me,Ne){var be=Ne&7,Ae=Ne>>>3;return(me[Ae]|(be<=6?0:me[Ae+1]<<8))>>>be&3}function ye(me,Ne){var be=Ne&7,Ae=Ne>>>3;return(me[Ae]|(be<=5?0:me[Ae+1]<<8))>>>be&7}function Ie(me,Ne){var be=Ne&7,Ae=Ne>>>3;return(me[Ae]|(be<=4?0:me[Ae+1]<<8))>>>be&15}function ut(me,Ne){var be=Ne&7,Ae=Ne>>>3;return(me[Ae]|(be<=3?0:me[Ae+1]<<8))>>>be&31}function Qe(me,Ne){var be=Ne&7,Ae=Ne>>>3;return(me[Ae]|(be<=1?0:me[Ae+1]<<8))>>>be&127}function $t(me,Ne,be){var Ae=Ne&7,ue=Ne>>>3,ge=(1<<be)-1,Me=me[ue]>>>Ae;return be<8-Ae||(Me|=me[ue+1]<<8-Ae,be<16-Ae)||(Me|=me[ue+2]<<16-Ae,be<24-Ae)||(Me|=me[ue+3]<<24-Ae),Me&ge}function Ge(me,Ne,be){var Ae=Ne&7,ue=Ne>>>3;return Ae<=5?me[ue]|=(be&7)<<Ae:(me[ue]|=be<<Ae&255,me[ue+1]=(be&7)>>8-Ae),Ne+3}function et(me,Ne,be){var Ae=Ne&7,ue=Ne>>>3;return be=(be&1)<<Ae,me[ue]|=be,Ne+1}function vt(me,Ne,be){var Ae=Ne&7,ue=Ne>>>3;return be<<=Ae,me[ue]|=be&255,be>>>=8,me[ue+1]=be,Ne+8}function Te(me,Ne,be){var Ae=Ne&7,ue=Ne>>>3;return be<<=Ae,me[ue]|=be&255,be>>>=8,me[ue+1]=be&255,me[ue+2]=be>>>8,Ne+16}function Ve(me,Ne){var be=me.length,Ae=2*be>Ne?2*be:Ne+5,ue=0;if(be>=Ne)return me;if(Mn){var ge=YO(Ae);if(me.copy)me.copy(ge);else for(;ue<me.length;++ue)ge[ue]=me[ue];return ge}else if(le){var Me=new Uint8Array(Ae);if(Me.set)Me.set(me);else for(;ue<be;++ue)Me[ue]=me[ue];return Me}return me.length=Ae,me}function pt(me){for(var Ne=new Array(me),be=0;be<me;++be)Ne[be]=0;return Ne}function wt(me,Ne,be){var Ae=1,ue=0,ge=0,Me=0,ot=0,Je=me.length,nt=le?new Uint16Array(32):pt(32);for(ge=0;ge<32;++ge)nt[ge]=0;for(ge=Je;ge<be;++ge)me[ge]=0;Je=me.length;var mt=le?new Uint16Array(Je):pt(Je);for(ge=0;ge<Je;++ge)nt[ue=me[ge]]++,Ae<ue&&(Ae=ue),mt[ge]=0;for(nt[0]=0,ge=1;ge<=Ae;++ge)nt[ge+16]=ot=ot+nt[ge-1]<<1;for(ge=0;ge<Je;++ge)ot=me[ge],ot!=0&&(mt[ge]=nt[ot+16]++);var de=0;for(ge=0;ge<Je;++ge)if(de=me[ge],de!=0)for(ot=ie(mt[ge],Ae)>>Ae-de,Me=(1<<Ae+4-de)-1;Me>=0;--Me)Ne[ot|Me<<de]=de&15|ge<<4;return Ae}var Ut=le?new Uint16Array(512):pt(512),ct=le?new Uint16Array(32):pt(32);if(!le){for(var yt=0;yt<512;++yt)Ut[yt]=0;for(yt=0;yt<32;++yt)ct[yt]=0}(function(){for(var me=[],Ne=0;Ne<32;Ne++)me.push(5);wt(me,ct,32);var be=[];for(Ne=0;Ne<=143;Ne++)be.push(8);for(;Ne<=255;Ne++)be.push(9);for(;Ne<=279;Ne++)be.push(7);for(;Ne<=287;Ne++)be.push(8);wt(be,Ut,288)})();var rt=(function(){for(var Ne=le?new Uint8Array(32768):[],be=0,Ae=0;be<X.length-1;++be)for(;Ae<X[be+1];++Ae)Ne[Ae]=be;for(;Ae<32768;++Ae)Ne[Ae]=29;var ue=le?new Uint8Array(259):[];for(be=0,Ae=0;be<Q.length-1;++be)for(;Ae<Q[be+1];++Ae)ue[Ae]=be;function ge(ot,Je){for(var nt=0;nt<ot.length;){var mt=Math.min(65535,ot.length-nt),de=nt+mt==ot.length;for(Je.write_shift(1,+de),Je.write_shift(2,mt),Je.write_shift(2,~mt&65535);mt-- >0;)Je[Je.l++]=ot[nt++]}return Je.l}function Me(ot,Je){for(var nt=0,mt=0,de=le?new Uint16Array(32768):[];mt<ot.length;){var Se=Math.min(65535,ot.length-mt);if(Se<10){for(nt=Ge(Je,nt,+(mt+Se==ot.length)),nt&7&&(nt+=8-(nt&7)),Je.l=nt/8|0,Je.write_shift(2,Se),Je.write_shift(2,~Se&65535);Se-- >0;)Je[Je.l++]=ot[mt++];nt=Je.l*8;continue}nt=Ge(Je,nt,+(mt+Se==ot.length)+2);for(var De=0;Se-- >0;){var Le=ot[mt];De=(De<<5^Le)&32767;var tt=-1,qt=0;if((tt=de[De])&&(tt|=mt&-32768,tt>mt&&(tt-=32768),tt<mt))for(;ot[tt+qt]==ot[mt+qt]&&qt<250;)++qt;if(qt>2){Le=ue[qt],Le<=22?nt=vt(Je,nt,he[Le+1]>>1)-1:(vt(Je,nt,3),nt+=5,vt(Je,nt,he[Le-23]>>5),nt+=3);var kr=Le<8?0:Le-4>>2;kr>0&&(Te(Je,nt,qt-Q[Le]),nt+=kr),Le=Ne[mt-tt],nt=vt(Je,nt,he[Le]>>3),nt-=3;var jr=Le<4?0:Le-2>>1;jr>0&&(Te(Je,nt,mt-tt-X[Le]),nt+=jr);for(var _t=0;_t<qt;++_t)de[De]=mt&32767,De=(De<<5^ot[mt])&32767,++mt;Se-=qt-1}else Le<=143?Le=Le+48:nt=et(Je,nt,1),nt=vt(Je,nt,he[Le]),de[De]=mt&32767,++mt}nt=vt(Je,nt,0)-1}return Je.l=(nt+7)/8|0,Je.l}return function(Je,nt){return Je.length<8?ge(Je,nt):Me(Je,nt)}})();function Oe(me){var Ne=Ht(50+Math.floor(me.length*1.1)),be=rt(me,Ne);return Ne.slice(0,be)}var $e=le?new Uint16Array(32768):pt(32768),Mt=le?new Uint16Array(32768):pt(32768),It=le?new Uint16Array(128):pt(128),At=1,tr=1;function ar(me,Ne){var be=ut(me,Ne)+257;Ne+=5;var Ae=ut(me,Ne)+1;Ne+=5;var ue=Ie(me,Ne)+4;Ne+=4;for(var ge=0,Me=le?new Uint8Array(19):pt(19),ot=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Je=1,nt=le?new Uint8Array(8):pt(8),mt=le?new Uint8Array(8):pt(8),de=Me.length,Se=0;Se<ue;++Se)Me[W[Se]]=ge=ye(me,Ne),Je<ge&&(Je=ge),nt[ge]++,Ne+=3;var De=0;for(nt[0]=0,Se=1;Se<=Je;++Se)mt[Se]=De=De+nt[Se-1]<<1;for(Se=0;Se<de;++Se)(De=Me[Se])!=0&&(ot[Se]=mt[De]++);var Le=0;for(Se=0;Se<de;++Se)if(Le=Me[Se],Le!=0){De=he[ot[Se]]>>8-Le;for(var tt=(1<<7-Le)-1;tt>=0;--tt)It[De|tt<<Le]=Le&7|Se<<3}var qt=[];for(Je=1;qt.length<be+Ae;)switch(De=It[Qe(me,Ne)],Ne+=De&7,De>>>=3){case 16:for(ge=3+Ee(me,Ne),Ne+=2,De=qt[qt.length-1];ge-- >0;)qt.push(De);break;case 17:for(ge=3+ye(me,Ne),Ne+=3;ge-- >0;)qt.push(0);break;case 18:for(ge=11+Qe(me,Ne),Ne+=7;ge-- >0;)qt.push(0);break;default:qt.push(De),Je<De&&(Je=De);break}var kr=qt.slice(0,be),jr=qt.slice(be);for(Se=be;Se<286;++Se)kr[Se]=0;for(Se=Ae;Se<30;++Se)jr[Se]=0;return At=wt(kr,$e,286),tr=wt(jr,Mt,30),Ne}function dr(me,Ne){if(me[0]==3&&!(me[1]&3))return[uh(Ne),2];for(var be=0,Ae=0,ue=YO(Ne||1<<18),ge=0,Me=ue.length>>>0,ot=0,Je=0;(Ae&1)==0;){if(Ae=ye(me,be),be+=3,Ae>>>1)Ae>>1==1?(ot=9,Je=5):(be=ar(me,be),ot=At,Je=tr);else{be&7&&(be+=8-(be&7));var nt=me[be>>>3]|me[(be>>>3)+1]<<8;if(be+=32,nt>0)for(!Ne&&Me<ge+nt&&(ue=Ve(ue,ge+nt),Me=ue.length);nt-- >0;)ue[ge++]=me[be>>>3],be+=8;continue}for(;;){!Ne&&Me<ge+32767&&(ue=Ve(ue,ge+32767),Me=ue.length);var mt=$t(me,be,ot),de=Ae>>>1==1?Ut[mt]:$e[mt];if(be+=de&15,de>>>=4,(de>>>8&255)===0)ue[ge++]=de;else{if(de==256)break;de-=257;var Se=de<8?0:de-4>>2;Se>5&&(Se=0);var De=ge+Q[de];Se>0&&(De+=$t(me,be,Se),be+=Se),mt=$t(me,be,Je),de=Ae>>>1==1?ct[mt]:Mt[mt],be+=de&15,de>>>=4;var Le=de<4?0:de-2>>1,tt=X[de];for(Le>0&&(tt+=$t(me,be,Le),be+=Le),!Ne&&Me<De&&(ue=Ve(ue,De+100),Me=ue.length);ge<De;)ue[ge]=ue[ge-tt],++ge}}}return Ne?[ue,be+7>>>3]:[ue.slice(0,ge),be+7>>>3]}function or(me,Ne){var be=me.slice(me.l||0),Ae=dr(be,Ne);return me.l+=Ae[1],Ae[0]}function mr(me,Ne){if(me)typeof console<"u"&&console.error(Ne);else throw new Error(Ne)}function ve(me,Ne){var be=me;eo(be,0);var Ae=[],ue=[],ge={FileIndex:Ae,FullPaths:ue};F(ge,{root:Ne.root});for(var Me=be.length-4;(be[Me]!=80||be[Me+1]!=75||be[Me+2]!=5||be[Me+3]!=6)&&Me>=0;)--Me;be.l=Me+4,be.l+=4;var ot=be.read_shift(2);be.l+=6;var Je=be.read_shift(4);for(be.l=Je,Me=0;Me<ot;++Me){be.l+=20;var nt=be.read_shift(4),mt=be.read_shift(4),de=be.read_shift(2),Se=be.read_shift(2),De=be.read_shift(2);be.l+=8;var Le=be.read_shift(4),tt=o(be.slice(be.l+de,be.l+de+Se));be.l+=de+Se+De;var qt=be.l;be.l=Le+4,Fe(be,nt,mt,ge,tt),be.l=qt}return ge}function Fe(me,Ne,be,Ae,ue){me.l+=2;var ge=me.read_shift(2),Me=me.read_shift(2),ot=i(me);if(ge&8257)throw new Error("Unsupported ZIP encryption");for(var Je=me.read_shift(4),nt=me.read_shift(4),mt=me.read_shift(4),de=me.read_shift(2),Se=me.read_shift(2),De="",Le=0;Le<de;++Le)De+=String.fromCharCode(me[me.l++]);if(Se){var tt=o(me.slice(me.l,me.l+Se));(tt[21589]||{}).mt&&(ot=tt[21589].mt),((ue||{})[21589]||{}).mt&&(ot=ue[21589].mt)}me.l+=Se;var qt=me.slice(me.l,me.l+nt);switch(Me){case 8:qt=L(me,mt);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Me)}var kr=!1;ge&8&&(Je=me.read_shift(4),Je==134695760&&(Je=me.read_shift(4),kr=!0),nt=me.read_shift(4),mt=me.read_shift(4)),nt!=Ne&&mr(kr,"Bad compressed size: "+Ne+" != "+nt),mt!=be&&mr(kr,"Bad uncompressed size: "+be+" != "+mt),xr(Ae,De,qt,{unsafe:!0,mt:ot})}function Be(me,Ne){var be=Ne||{},Ae=[],ue=[],ge=Ht(1),Me=be.compression?8:0,ot=0,Je=0,nt=0,mt=0,de=0,Se=me.FullPaths[0],De=Se,Le=me.FileIndex[0],tt=[],qt=0;for(Je=1;Je<me.FullPaths.length;++Je)if(De=me.FullPaths[Je].slice(Se.length),Le=me.FileIndex[Je],!(!Le.size||!Le.content||De=="Sh33tJ5")){var kr=mt,jr=Ht(De.length);for(nt=0;nt<De.length;++nt)jr.write_shift(1,De.charCodeAt(nt)&127);jr=jr.slice(0,jr.l),tt[de]=mpe.buf(Le.content,0);var _t=Le.content;Me==8&&(_t=G(_t)),ge=Ht(30),ge.write_shift(4,67324752),ge.write_shift(2,20),ge.write_shift(2,ot),ge.write_shift(2,Me),Le.mt?a(ge,Le.mt):ge.write_shift(4,0),ge.write_shift(-4,tt[de]),ge.write_shift(4,_t.length),ge.write_shift(4,Le.content.length),ge.write_shift(2,jr.length),ge.write_shift(2,0),mt+=ge.length,Ae.push(ge),mt+=jr.length,Ae.push(jr),mt+=_t.length,Ae.push(_t),ge=Ht(46),ge.write_shift(4,33639248),ge.write_shift(2,0),ge.write_shift(2,20),ge.write_shift(2,ot),ge.write_shift(2,Me),ge.write_shift(4,0),ge.write_shift(-4,tt[de]),ge.write_shift(4,_t.length),ge.write_shift(4,Le.content.length),ge.write_shift(2,jr.length),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(4,0),ge.write_shift(4,kr),qt+=ge.l,ue.push(ge),qt+=jr.length,ue.push(jr),++de}return ge=Ht(22),ge.write_shift(4,101010256),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,de),ge.write_shift(2,de),ge.write_shift(4,qt),ge.write_shift(4,mt),ge.write_shift(2,0),Fi([Fi(Ae),Fi(ue),ge])}var Pe={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function lt(me,Ne){if(me.ctype)return me.ctype;var be=me.name||"",Ae=be.match(/\.([^\.]+)$/);return Ae&&Pe[Ae[1]]||Ne&&(Ae=(be=Ne).match(/[\.\\]([^\.\\])+$/),Ae&&Pe[Ae[1]])?Pe[Ae[1]]:"application/octet-stream"}function Ct(me){for(var Ne=s2(me),be=[],Ae=0;Ae<Ne.length;Ae+=76)be.push(Ne.slice(Ae,Ae+76));return be.join(`\r
`)+`\r
`}function Lt(me){var Ne=me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(nt){var mt=nt.charCodeAt(0).toString(16).toUpperCase();return"="+(mt.length==1?"0"+mt:mt)});Ne=Ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Ne.charAt(0)==`
`&&(Ne="=0D"+Ne.slice(1)),Ne=Ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var be=[],Ae=Ne.split(`\r
`),ue=0;ue<Ae.length;++ue){var ge=Ae[ue];if(ge.length==0){be.push("");continue}for(var Me=0;Me<ge.length;){var ot=76,Je=ge.slice(Me,Me+ot);Je.charAt(ot-1)=="="?ot--:Je.charAt(ot-2)=="="?ot-=2:Je.charAt(ot-3)=="="&&(ot-=3),Je=ge.slice(Me,Me+ot),Me+=ot,Me<ge.length&&(Je+="="),be.push(Je)}}return be.join(`\r
`)}function Ue(me){for(var Ne=[],be=0;be<me.length;++be){for(var Ae=me[be];be<=me.length&&Ae.charAt(Ae.length-1)=="=";)Ae=Ae.slice(0,Ae.length-1)+me[++be];Ne.push(Ae)}for(var ue=0;ue<Ne.length;++ue)Ne[ue]=Ne[ue].replace(/[=][0-9A-Fa-f]{2}/g,function(ge){return String.fromCharCode(parseInt(ge.slice(1),16))});return Vl(Ne.join(`\r
`))}function st(me,Ne,be){for(var Ae="",ue="",ge="",Me,ot=0;ot<10;++ot){var Je=Ne[ot];if(!Je||Je.match(/^\s*$/))break;var nt=Je.match(/^(.*?):\s*([^\s].*)$/);if(nt)switch(nt[1].toLowerCase()){case"content-location":Ae=nt[2].trim();break;case"content-type":ge=nt[2].trim();break;case"content-transfer-encoding":ue=nt[2].trim();break}}switch(++ot,ue.toLowerCase()){case"base64":Me=Vl(Ql(Ne.slice(ot).join("")));break;case"quoted-printable":Me=Ue(Ne.slice(ot));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ue)}var mt=xr(me,Ae.slice(be.length),Me,{unsafe:!0});ge&&(mt.ctype=ge)}function dt(me,Ne){if(z(me.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var be=Ne&&Ne.root||"",Ae=(Mn&&Buffer.isBuffer(me)?me.toString("binary"):z(me)).split(`\r
`),ue=0,ge="";for(ue=0;ue<Ae.length;++ue)if(ge=Ae[ue],!!/^Content-Location:/i.test(ge)&&(ge=ge.slice(ge.indexOf("file")),be||(be=ge.slice(0,ge.lastIndexOf("/")+1)),ge.slice(0,be.length)!=be))for(;be.length>0&&(be=be.slice(0,be.length-1),be=be.slice(0,be.lastIndexOf("/")+1),ge.slice(0,be.length)!=be););var Me=(Ae[1]||"").match(/boundary="(.*?)"/);if(!Me)throw new Error("MAD cannot find boundary");var ot="--"+(Me[1]||""),Je=[],nt=[],mt={FileIndex:Je,FullPaths:nt};F(mt);var de,Se=0;for(ue=0;ue<Ae.length;++ue){var De=Ae[ue];De!==ot&&De!==ot+"--"||(Se++&&st(mt,Ae.slice(de,ue),be),de=ue)}return mt}function Bt(me,Ne){var be=Ne||{},Ae=be.boundary||"SheetJS";Ae="------="+Ae;for(var ue=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Ae.slice(2)+'"',"","",""],ge=me.FullPaths[0],Me=ge,ot=me.FileIndex[0],Je=1;Je<me.FullPaths.length;++Je)if(Me=me.FullPaths[Je].slice(ge.length),ot=me.FileIndex[Je],!(!ot.size||!ot.content||Me=="Sh33tJ5")){Me=Me.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(qt){return"_x"+qt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(qt){return"_u"+qt.charCodeAt(0).toString(16)+"_"});for(var nt=ot.content,mt=Mn&&Buffer.isBuffer(nt)?nt.toString("binary"):z(nt),de=0,Se=Math.min(1024,mt.length),De=0,Le=0;Le<=Se;++Le)(De=mt.charCodeAt(Le))>=32&&De<128&&++de;var tt=de>=Se*4/5;ue.push(Ae),ue.push("Content-Location: "+(be.root||"file:///C:/SheetJS/")+Me),ue.push("Content-Transfer-Encoding: "+(tt?"quoted-printable":"base64")),ue.push("Content-Type: "+lt(ot,Me)),ue.push(""),ue.push(tt?Lt(mt):Ct(mt))}return ue.push(Ae+`--\r
`),ue.join(`\r
`)}function Yt(me){var Ne={};return F(Ne,me),Ne}function xr(me,Ne,be,Ae){var ue=Ae&&Ae.unsafe;ue||F(me);var ge=!ue&&Jr.find(me,Ne);if(!ge){var Me=me.FullPaths[0];Ne.slice(0,Me.length)==Me?Me=Ne:(Me.slice(-1)!="/"&&(Me+="/"),Me=(Me+Ne).replace("//","/")),ge={name:s(Ne),type:2},me.FileIndex.push(ge),me.FullPaths.push(Me),ue||Jr.utils.cfb_gc(me)}return ge.content=be,ge.size=be?be.length:0,Ae&&(Ae.CLSID&&(ge.clsid=Ae.CLSID),Ae.mt&&(ge.mt=Ae.mt),Ae.ct&&(ge.ct=Ae.ct)),ge}function Rr(me,Ne){F(me);var be=Jr.find(me,Ne);if(be){for(var Ae=0;Ae<me.FileIndex.length;++Ae)if(me.FileIndex[Ae]==be)return me.FileIndex.splice(Ae,1),me.FullPaths.splice(Ae,1),!0}return!1}function yr(me,Ne,be){F(me);var Ae=Jr.find(me,Ne);if(Ae){for(var ue=0;ue<me.FileIndex.length;++ue)if(me.FileIndex[ue]==Ae)return me.FileIndex[ue].name=s(be),me.FullPaths[ue]=be,!0}return!1}function Br(me){P(me,!0)}return t.find=I,t.read=E,t.parse=d,t.write=q,t.writeFile=J,t.utils={cfb_new:Yt,cfb_add:xr,cfb_del:Rr,cfb_mov:yr,cfb_gc:Br,ReadShift:Tv,CheckField:jq,prep_blob:eo,bconcat:Fi,use_zlib:R,_deflateRaw:Oe,_inflateRaw:or,consts:B},t})();function gpe(e){return typeof e=="string"?ZS(e):Array.isArray(e)?Uge(e):e}function Z2(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=ZS(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?id(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([gpe(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Sh(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function ppe(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function ka(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function nD(e,t){for(var r=[],n=ka(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function t3(e){for(var t=[],r=ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function r3(e){for(var t=[],r=ka(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function xpe(e){for(var t=[],r=ka(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var A_=new Date(1899,11,30,0,0,0);function gi(e,t){var r=e.getTime(),n=A_.getTime()+(e.getTimezoneOffset()-A_.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var cq=new Date,ype=A_.getTime()+(cq.getTimezoneOffset()-A_.getTimezoneOffset())*6e4,sD=cq.getTimezoneOffset();function n3(e){var t=new Date;return t.setTime(e*24*60*60*1e3+ype),t.getTimezoneOffset()!==sD&&t.setTime(t.getTime()+(t.getTimezoneOffset()-sD)*6e4),t}function vpe(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var aD=new Date("2017-02-19T19:06:09.000Z"),uq=isNaN(aD.getFullYear())?new Date("2/19/17"):aD,bpe=uq.getFullYear()==2017;function Hs(e,t){var r=new Date(e);if(bpe)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(uq.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function eg(e,t){if(Mn&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return id(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return id(JV(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return id(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return id(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function Gs(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Gs(e[r]));return t}function _a(e,t){for(var r="";r.length<t;)r+=e;return r}function yu(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var wpe=["january","february","march","april","may","june","july","august","september","october","november","december"];function x1(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&wpe.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var _pe=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}})();function dq(e){return e?e.content&&e.type?eg(e.content,!0):e.data?uv(e.data):e.asNodeBuffer&&Mn?uv(e.asNodeBuffer().toString("binary")):e.asBinary?uv(e.asBinary()):e._data&&e._data.getContent?uv(eg(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function fq(e){if(!e)return null;if(e.data)return qO(e.data);if(e.asNodeBuffer&&Mn)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?qO(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Spe(e){return e&&e.name.slice(-4)===".bin"?fq(e):dq(e)}function kc(e,t){for(var r=e.FullPaths||ka(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function jE(e,t){var r=kc(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function qa(e,t,r){if(!r)return Spe(jE(e,t));if(!t)return null;try{return qa(e,t)}catch{return null}}function ql(e,t,r){if(!r)return dq(jE(e,t));if(!t)return null;try{return ql(e,t)}catch{return null}}function kpe(e,t,r){return fq(jE(e,t))}function iD(e){for(var t=e.FullPaths||ka(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function En(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Mn?n=I0(r):n=zge(r),Jr.utils.cfb_add(e,t,n)}Jr.utils.cfb_add(e,t,r)}else e.file(t,r)}function PE(){return Jr.utils.cfb_new()}function hq(e,t){switch(t.type){case"base64":return Jr.read(e,{type:"base64"});case"binary":return Jr.read(e,{type:"binary"});case"buffer":case"array":return Jr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fv(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Ua=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Cpe=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,oD=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Tpe=/<[^>]*>/g,Po=Ua.match(oD)?oD:Tpe,Npe=/<\w*:/,Epe=/<(\/?)\w+:/;function fn(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(Cpe),o=0,c="",u=0,d="",f="",h=1;if(i)for(u=0;u!=i.length;++u){for(f=i[u],a=0;a!=f.length&&f.charCodeAt(a)!==61;++a);for(d=f.slice(0,a).trim();f.charCodeAt(a+1)==32;)++a;for(h=(s=f.charCodeAt(a+1))==34||s==39?1:0,c=f.slice(a+1+h,f.length-h),o=0;o!=d.length&&d.charCodeAt(o)!==58;++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=c,n[d.toLowerCase()]=c;else{var g=(o===5&&d.slice(0,5)==="xmlns"?"xmlns":"")+d.slice(o+1);if(n[g]&&d.slice(o-3,o)=="ext")continue;n[g]=c,n[g.toLowerCase()]=c}}return n}function wd(e){return e.replace(Epe,"<$1")}var mq={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},FE=t3(mq),Hn=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return mq[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}})(),ME=/[&<>'"]/g,Ape=/[\u0000-\u0008\u000b-\u001f]/g;function ms(e){var t=e+"";return t.replace(ME,function(r){return FE[r]}).replace(Ape,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lD(e){return ms(e).replace(/ /g,"_x0020_")}var gq=/[\u0000-\u001f]/g;function RE(e){var t=e+"";return t.replace(ME,function(r){return FE[r]}).replace(/\n/g,"<br/>").replace(gq,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function jpe(e){var t=e+"";return t.replace(ME,function(r){return FE[r]}).replace(gq,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var cD=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function Ppe(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Us(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function M6(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function uD(e){var t=uh(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function dD(e){return I0(e,"binary").toString("utf8")}var Xw="foo bar baz",bs=Mn&&(dD(Xw)==M6(Xw)&&dD||uD(Xw)==M6(Xw)&&uD)||M6,id=Mn?function(e){return I0(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},i2=(function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),pq=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}})(),Fpe=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),Mpe=/<\/?(?:vt:)?variant>/g,Rpe=/<(?:vt:)([^>]*)>([\s\S]*)</;function fD(e,t){var r=fn(e),n=e.match(Fpe(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(Mpe,"").match(Rpe);i&&s.push({v:bs(i[2]),t:i[1]})}),s}var xq=/(^\s|\s$|\n)/;function no(e,t){return"<"+e+(t.match(xq)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function o2(e){return ka(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function pr(e,t,r){return"<"+e+(r!=null?o2(r):"")+(t!=null?(t.match(xq)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function u8(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Ope(e,t){switch(typeof e){case"string":var r=pr("vt:lpwstr",ms(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return pr((e|0)==e?"vt:i4":"vt:r8",ms(String(e)));case"boolean":return pr("vt:bool",e?"true":"false")}if(e instanceof Date)return pr("vt:filetime",u8(e));throw new Error("Unable to serialize "+e)}function OE(e){if(Mn&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return bs(Sh(NE(e)));throw new Error("Bad input format: expected Buffer or string")}var l2=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fi={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},xg=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zl={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Dpe(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function Ipe(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var hD=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},mD=Mn?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:I0(t)})):hD(e)}:hD,gD=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(u0(e,s)));return n.join("").replace(Zo,"")},DE=Mn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Zo,""):gD(e,t,r)}:gD,pD=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},yq=Mn?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):pD(e,t,r)}:pD,xD=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(Op(e,s)));return n.join("")},eb=Mn?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):xD(t,r,n)}:xD,vq=function(e,t){var r=Wl(e,t);return r>0?eb(e,t+4,t+4+r-1):""},bq=vq,wq=function(e,t){var r=Wl(e,t);return r>0?eb(e,t+4,t+4+r-1):""},_q=wq,Sq=function(e,t){var r=2*Wl(e,t);return r>0?eb(e,t+4,t+4+r-1):""},kq=Sq,Cq=function(t,r){var n=Wl(t,r);return n>0?DE(t,r+4,r+4+n):""},Tq=Cq,Nq=function(e,t){var r=Wl(e,t);return r>0?eb(e,t+4,t+4+r):""},Eq=Nq,Aq=function(e,t){return Dpe(e,t)},j_=Aq,IE=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Mn&&(bq=function(t,r){if(!Buffer.isBuffer(t))return vq(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},_q=function(t,r){if(!Buffer.isBuffer(t))return wq(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},kq=function(t,r){if(!Buffer.isBuffer(t))return Sq(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},Tq=function(t,r){if(!Buffer.isBuffer(t))return Cq(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},Eq=function(t,r){if(!Buffer.isBuffer(t))return Nq(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},j_=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):Aq(t,r)},IE=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Op=function(e,t){return e[t]},u0=function(e,t){return e[t+1]*256+e[t]},Lpe=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Wl=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},xm=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},Bpe=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Tv(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,Mn&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(u0(this,u)),u+=2;e*=2;break;case"utf8":r=eb(this,this.l,this.l+e);break;case"utf16le":e*=2,r=DE(this,this.l,this.l+e);break;case"wstr":return Tv.call(this,e,"dbcs");case"lpstr-ansi":r=bq(this,this.l),e=4+Wl(this,this.l);break;case"lpstr-cp":r=_q(this,this.l),e=4+Wl(this,this.l);break;case"lpwstr":r=kq(this,this.l),e=4+2*Wl(this,this.l);break;case"lpp4":e=4+Wl(this,this.l),r=Tq(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Wl(this,this.l),r=Eq(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Op(this,this.l+e++))!==0;)a.push(Yw(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=u0(this,this.l+e))!==0;)a.push(Yw(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Op(this,u),this.l=u+1,o=Tv.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Yw(u0(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=Op(this,u),this.l=u+1,o=Tv.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(Yw(Op(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Op(this,this.l),this.l++,n;case 2:return n=(t==="i"?Lpe:u0)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?xm:Bpe)(this,this.l),this.l+=4,n):(s=Wl(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=j_(this,this.l):s=j_([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=yq(this,this.l,e);break}}return this.l+=e,r}var $pe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Upe=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zpe=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Wpe(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)zpe(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,$pe(this,t,this.l);break;case 8:if(n=8,r==="f"){Ipe(this,t,this.l);break}case 16:break;case-4:n=4,Upe(this,t,this.l);break}return this.l+=n,this}function jq(e,t){var r=yq(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function eo(e,t){e.l=t,e.read_shift=Tv,e.chk=jq,e.write_shift=Wpe}function jo(e,t){e.l+=t}function Ht(e){var t=uh(e);return eo(t,0),t}function L0(e,t,r){if(e){var n,s,a;eo(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=m2[o]||m2[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var d=u.f&&u.f(e,a,r);if(e.l=c,t(d,u,o))return}}}function Sl(){var e=[],t=Mn?256:2048,r=function(u){var d=Ht(u);return eo(d,0),d},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),Fi(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function Xt(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=m2[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&IE(r)&&e.push(r)}}function Nv(e,t,r){var n=Gs(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yD(e,t,r){var n=Gs(e);return n.s=Nv(n.s,t.s,r),n.e=Nv(n.e,t.s,r),n}function Ev(e,t){if(e.cRel&&e.c<0)for(e=Gs(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Gs(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=cn(e);return!e.cRel&&e.cRel!=null&&(r=Vpe(r)),!e.rRel&&e.rRel!=null&&(r=Hpe(r)),r}function R6(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+oa(e.s.c)+":"+(e.e.cRel?"":"$")+oa(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+La(e.s.r)+":"+(e.e.rRel?"":"$")+La(e.e.r):Ev(e.s,t.biff)+":"+Ev(e.e,t.biff)}function LE(e){return parseInt(Gpe(e),10)-1}function La(e){return""+(e+1)}function Hpe(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Gpe(e){return e.replace(/\$(\d+)$/,"$1")}function BE(e){for(var t=qpe(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function oa(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Vpe(e){return e.replace(/^([A-Z])/,"$$$1")}function qpe(e){return e.replace(/^\$([A-Z])/,"$1")}function Kpe(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function la(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function cn(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Tl(e){var t=e.indexOf(":");return t==-1?{s:la(e),e:la(e)}:{s:la(e.slice(0,t)),e:la(e.slice(t+1))}}function Tn(e,t){return typeof t>"u"||typeof t=="number"?Tn(e.s,e.e):(typeof e!="string"&&(e=cn(e)),typeof t!="string"&&(t=cn(t)),e==t?e:e+":"+t)}function Vn(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function vD(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Bc(e.z,r?gi(t):t)}catch{}try{return e.w=Bc((e.XF||{}).numFmtId||(r?14:0),r?gi(t):t)}catch{return""+t}}function E0(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?B0[e.v]||e.v:t==null?vD(e,e.v):vD(e,t))}function kh(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Pq(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?la(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var d=Vn(a["!ref"]);u.s.c=d.s.c,u.s.r=d.s.r,u.e.c=Math.max(u.e.c,d.e.c),u.e.r=Math.max(u.e.r,d.e.r),i==-1&&(u.e.r=i=d.e.r+1)}for(var f=0;f!=t.length;++f)if(t[f]){if(!Array.isArray(t[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[f].length;++h)if(!(typeof t[f][h]>"u")){var g={v:t[f][h]},p=i+f,x=o+h;if(u.s.r>p&&(u.s.r=p),u.s.c>x&&(u.s.c=x),u.e.r<p&&(u.e.r=p),u.e.c<x&&(u.e.c=x),t[f][h]&&typeof t[f][h]=="object"&&!Array.isArray(t[f][h])&&!(t[f][h]instanceof Date))g=t[f][h];else if(Array.isArray(g.v)&&(g.f=t[f][h][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(n.nullError)g.t="e",g.v=0;else if(n.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=n.dateNF||on[14],n.cellDates?(g.t="d",g.w=Bc(g.z,gi(g.v))):(g.t="n",g.v=gi(g.v),g.w=Bc(g.z,g.v))):g.t="s";if(s)a[p]||(a[p]=[]),a[p][x]&&a[p][x].z&&(g.z=a[p][x].z),a[p][x]=g;else{var v=cn({c:x,r:p});a[v]&&a[v].z&&(g.z=a[v].z),a[v]=g}}}return u.s.c<1e7&&(a["!ref"]=Tn(u)),a}function X1(e,t){return Pq(null,e,t)}function Ype(e){return e.read_shift(4,"i")}function vu(e,t){return t||(t=Ht(4)),t.write_shift(4,e),t}function Eo(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Mi(e,t){var r=!1;return t==null&&(r=!0,t=Ht(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function Xpe(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Jpe(e,t){return t||(t=Ht(4)),t.write_shift(2,0),t.write_shift(2,0),t}function $E(e,t){var r=e.l,n=e.read_shift(1),s=Eo(e),a=[],i={t:s,h:s};if((n&1)!==0){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(Xpe(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function Qpe(e,t){var r=!1;return t==null&&(r=!0,t=Ht(15+4*e.t.length)),t.write_shift(1,0),Mi(e.t,t),r?t.slice(0,t.l):t}var Zpe=$E;function e1e(e,t){var r=!1;return t==null&&(r=!0,t=Ht(23+4*e.t.length)),t.write_shift(1,1),Mi(e.t,t),t.write_shift(4,1),Jpe({},t),r?t.slice(0,t.l):t}function Wc(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function yg(e,t){return t==null&&(t=Ht(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function vg(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function bg(e,t){return t==null&&(t=Ht(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var t1e=Eo,Fq=Mi;function UE(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function P_(e,t){var r=!1;return t==null&&(r=!0,t=Ht(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var r1e=Eo,d8=UE,zE=P_;function WE(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?j_([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):xm(t,0)>>2;return r?s/100:s}function Mq(e,t){t==null&&(t=Ht(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Rq(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function n1e(e,t){return t||(t=Ht(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var wg=Rq,J1=n1e;function So(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function tg(e,t){return(t||Ht(8)).write_shift(8,e,"f")}function s1e(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=Fm[s];u&&(t.rgb=u2(u));break;case 2:t.rgb=u2([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function F_(e,t){if(t||(t=Ht(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function a1e(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function i1e(e,t){t||(t=Ht(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function Oq(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function o1e(e){return Oq(e,1)}function l1e(e){return Oq(e,2)}var HE=2,gl=3,Jw=11,bD=12,M_=19,Qw=64,c1e=65,u1e=71,d1e=4108,f1e=4126,Ni=80,Dq=81,h1e=[Ni,Dq],f8={1:{n:"CodePage",t:HE},2:{n:"Category",t:Ni},3:{n:"PresentationFormat",t:Ni},4:{n:"ByteCount",t:gl},5:{n:"LineCount",t:gl},6:{n:"ParagraphCount",t:gl},7:{n:"SlideCount",t:gl},8:{n:"NoteCount",t:gl},9:{n:"HiddenCount",t:gl},10:{n:"MultimediaClipCount",t:gl},11:{n:"ScaleCrop",t:Jw},12:{n:"HeadingPairs",t:d1e},13:{n:"TitlesOfParts",t:f1e},14:{n:"Manager",t:Ni},15:{n:"Company",t:Ni},16:{n:"LinksUpToDate",t:Jw},17:{n:"CharacterCount",t:gl},19:{n:"SharedDoc",t:Jw},22:{n:"HyperlinksChanged",t:Jw},23:{n:"AppVersion",t:gl,p:"version"},24:{n:"DigSig",t:c1e},26:{n:"ContentType",t:Ni},27:{n:"ContentStatus",t:Ni},28:{n:"Language",t:Ni},29:{n:"Version",t:Ni},255:{},2147483648:{n:"Locale",t:M_},2147483651:{n:"Behavior",t:M_},1919054434:{}},h8={1:{n:"CodePage",t:HE},2:{n:"Title",t:Ni},3:{n:"Subject",t:Ni},4:{n:"Author",t:Ni},5:{n:"Keywords",t:Ni},6:{n:"Comments",t:Ni},7:{n:"Template",t:Ni},8:{n:"LastAuthor",t:Ni},9:{n:"RevNumber",t:Ni},10:{n:"EditTime",t:Qw},11:{n:"LastPrinted",t:Qw},12:{n:"CreatedDate",t:Qw},13:{n:"ModifiedDate",t:Qw},14:{n:"PageCount",t:gl},15:{n:"WordCount",t:gl},16:{n:"CharCount",t:gl},17:{n:"Thumbnail",t:u1e},18:{n:"Application",t:Ni},19:{n:"DocSecurity",t:gl},255:{},2147483648:{n:"Locale",t:M_},2147483651:{n:"Behavior",t:M_},1919054434:{}},wD={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},m1e=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function g1e(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var p1e=g1e([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Fm=Gs(p1e),B0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Iq={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},m8={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Zw={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function GE(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function x1e(e){var t=GE();if(!e||!e.match)return t;var r={};if((e.match(Po)||[]).forEach(function(n){var s=fn(n);switch(s[0].replace(Npe,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[m8[s.ContentType]]!==void 0&&t[m8[s.ContentType]].push(s.PartName);break}}),t.xmlns!==fi.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function Lq(e,t){var r=xpe(m8),n=[],s;n[n.length]=Ua,n[n.length]=pr("Types",null,{xmlns:fi.CT,"xmlns:xsd":fi.xsd,"xmlns:xsi":fi.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return pr("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=pr("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:Zw[c][t.bookType]||Zw[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=pr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Zw[c][t.bookType]||Zw[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=pr("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var In={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function c2(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Av(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Po)||[]).forEach(function(s){var a=fn(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:fv(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function r1(e){var t=[Ua,pr("Relationships",null,{xmlns:fi.RELS})];return ka(e["!id"]).forEach(function(r){t[t.length]=pr("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ds(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[In.HLINK,In.XPATH,In.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var y1e="application/vnd.oasis.opendocument.spreadsheet";function v1e(e,t){for(var r=OE(e),n,s;n=l2.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=fn(n[0],!1),s.path=="/"&&s.type!==y1e)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function b1e(e){var t=[Ua];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function _D(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function w1e(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function _1e(e){var t=[Ua];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(_D(e[r][0],e[r][1])),t.push(w1e("",e[r][0]));return t.push(_D("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function Bq(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+C_.version+"</meta:generator></office:meta></office:document-meta>"}var Rc=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],S1e=(function(){for(var e=new Array(Rc.length),t=0;t<Rc.length;++t){var r=Rc[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function $q(e){var t={};e=bs(e);for(var r=0;r<Rc.length;++r){var n=Rc[r],s=e.match(S1e[r]);s!=null&&s.length>0&&(t[n[1]]=Hn(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Hs(t[n[1]]))}return t}function O6(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=ms(t),n[n.length]=r?pr(e,t,r):no(e,t))}function Uq(e,t){var r=t||{},n=[Ua,pr("cp:coreProperties",null,{"xmlns:cp":fi.CORE_PROPS,"xmlns:dc":fi.dc,"xmlns:dcterms":fi.dcterms,"xmlns:dcmitype":fi.dcmitype,"xmlns:xsi":fi.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&O6("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:u8(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&O6("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:u8(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Rc.length;++a){var i=Rc[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&O6(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Mm=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],zq=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Wq(e,t,r,n){var s=[];if(typeof e=="string")s=fD(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(d){return{v:d}}));var i=typeof t=="string"?fD(t,n).map(function(d){return d.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function k1e(e,t,r){var n={};return t||(t={}),e=bs(e),Mm.forEach(function(s){var a=(e.match(i2(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Hn(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&Wq(n.HeadingPairs,n.TitlesOfParts,t,r),t}function Hq(e){var t=[],r=pr;return e||(e={}),e.Application="SheetJS",t[t.length]=Ua,t[t.length]=pr("Properties",null,{xmlns:fi.EXT_PROPS,"xmlns:vt":fi.vt}),Mm.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=ms(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+ms(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var C1e=/<[^>]+>[^<]*/g;function T1e(e,t){var r={},n="",s=e.match(C1e);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=fn(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Hn(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),d=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Hn(d);break;case"bool":r[n]=Us(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=Hs(d);break;case"cy":case"error":r[n]=Hn(d);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function Gq(e){var t=[Ua,pr("Properties",null,{xmlns:fi.CUST_PROPS,"xmlns:vt":fi.vt})];if(!e)return t.join("");var r=1;return ka(e).forEach(function(s){++r,t[t.length]=pr("property",Ope(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ms(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var g8={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},D6;function N1e(e,t,r){D6||(D6=t3(g8)),t=D6[t]||t,e[t]=r}function E1e(e,t){var r=[];return ka(g8).map(function(n){for(var s=0;s<Rc.length;++s)if(Rc[s][1]==n)return Rc[s];for(s=0;s<Mm.length;++s)if(Mm[s][1]==n)return Mm[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(no(g8[n[1]]||n[1],s))}}),pr("DocumentProperties",r.join(""),{xmlns:zl.o})}function A1e(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&ka(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Rc.length;++i)if(a==Rc[i][1])return;for(i=0;i<Mm.length;++i)if(a==Mm[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(pr(lD(a),o,{"dt:dt":c}))}}),t&&ka(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(pr(lD(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+zl.o+'">'+s.join("")+"</"+n+">"}function VE(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function j1e(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=Ht(8);return i.write_shift(4,n),i.write_shift(4,s),i}function Vq(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function qq(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function Kq(e,t,r){return t===31?qq(e):Vq(e,t,r)}function p8(e,t,r){return Kq(e,t,r===!1?0:4)}function P1e(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return Kq(e,t,0)}function F1e(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Zo,""),e.l-s&2&&(e.l+=2)}return r}function M1e(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Zo,"");return r}function R1e(e){var t=e.l,r=R_(e,Dq);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=R_(e,gl);return[r,n]}function O1e(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(R1e(e));return r}function SD(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Zo,"").replace(dv,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function Yq(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function D1e(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function R_(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==bD&&n!==t&&h1e.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===bD?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return Vq(e,n,4).replace(Zo,"");case 31:return qq(e);case 64:return VE(e);case 65:return Yq(e);case 71:return D1e(e);case 80:return p8(e,n,!a.raw).replace(Zo,"");case 81:return P1e(e,n).replace(Zo,"");case 4108:return O1e(e);case 4126:case 4127:return n==4127?F1e(e):M1e(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function kD(e,t){var r=Ht(4),n=Ht(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ht(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=j1e(t);break;case 31:case 80:for(n=Ht(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Fi([r,n])}function CD(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var d=e.read_shift(4),f=e.read_shift(4);a[i]=[d,f+r]}a.sort(function(b,_){return b[1]-_[1]});var h={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var g=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,g=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],g=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],g=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(g=!1,e.l=a[i][1]),g)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var p=t[a[i][0]];if(h[p.n]=R_(e,p.t,{raw:!0}),p.p==="version"&&(h[p.n]=String(h[p.n]>>16)+"."+("0000"+String(h[p.n]&65535)).slice(-4)),p.n=="CodePage")switch(h[p.n]){case 0:h[p.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:gu(o=h[p.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[p.n])}}else if(a[i][0]===1){if(o=h.CodePage=R_(e,HE),gu(o),c!==-1){var x=e.l;e.l=a[c][1],u=SD(e,o),e.l=x}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=SD(e,o)}else{var v=u[a[i][0]],C;switch(e[e.l]){case 65:e.l+=4,C=Yq(e);break;case 30:e.l+=4,C=p8(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,C=p8(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,C=e.read_shift(4,"i");break;case 19:e.l+=4,C=e.read_shift(4);break;case 5:e.l+=4,C=e.read_shift(8,"f");break;case 11:e.l+=4,C=Ma(e,4);break;case 64:e.l+=4,C=Hs(VE(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[v]=C}}return e.l=r+n,h}var Xq=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function I1e(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function TD(e,t,r){var n=Ht(8),s=[],a=[],i=8,o=0,c=Ht(8),u=Ht(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=Ht(8),u.write_shift(4,0),s.unshift(u);var d=[Ht(4)];for(d[0].write_shift(4,e.length),o=0;o<e.length;++o){var f=e[o][0];for(c=Ht(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=Fi(d),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(Xq.indexOf(e[o][0])>-1||zq.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],g=0;if(t){g=+t[e[o][0]];var p=r[g];if(p.p=="version"&&typeof h=="string"){var x=h.split(".");h=(+x[0]<<16)+(+x[1]||0)}c=kD(p.t,h)}else{var v=I1e(h);v==-1&&(v=31,h=String(h)),c=kD(v,h)}a.push(c),u=Ht(8),u.write_shift(4,t?g:2+o),s.push(u),i+=8+c.length}var C=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,C),C+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),Fi([n].concat(s).concat(a))}function ND(e,t,r){var n=e.content;if(!n)return{};eo(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),d=n.read_shift(16);if(d!==Jr.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var f=CD(n,t),h={SystemIdentifier:u};for(var g in f)h[g]=f[g];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var p;try{p=CD(n,null)}catch{}for(g in p)h[g]=p[g];return h.FMTID=[a,i],h}function ED(e,t,r,n,s,a){var i=Ht(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Jr.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=TD(e,r,n);if(o.push(c),s){var u=TD(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return Fi(o)}function Rf(e,t){return e.read_shift(t),null}function L1e(e,t){t||(t=Ht(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function B1e(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ma(e,t){return e.read_shift(t)===1}function Vo(e,t){return t||(t=Ht(2)),t.write_shift(2,+!!e),t}function Ka(e){return e.read_shift(2,"u")}function Cc(e,t){return t||(t=Ht(2)),t.write_shift(2,e),t}function Jq(e,t){return B1e(e,t,Ka)}function $1e(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Qq(e,t,r){return r||(r=Ht(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function tb(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function U1e(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",d=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=d,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function z1e(e){var t=e.t||"",r=Ht(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ht(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return Fi(s)}function rg(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function rb(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):rg(e,n,r)}function _g(e,t,r){if(r.biff>5)return rb(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Zq(e,t,r){return r||(r=Ht(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function W1e(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function H1e(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Zo,"");return n&&(e.l+=24),s}function G1e(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Zo,"");return r+i}function V1e(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return H1e(e);case"0303000000000000c000000000000046":return G1e(e);default:throw new Error("Unsupported Moniker "+r)}}function e4(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Zo,""):"";return r}function AD(e,t){t||(t=Ht(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function q1e(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",d,f;s&16&&(a=e4(e,r-e.l)),s&128&&(i=e4(e,r-e.l)),(s&257)===257&&(o=e4(e,r-e.l)),(s&257)===1&&(c=V1e(e,r-e.l)),s&8&&(u=e4(e,r-e.l)),s&32&&(d=e.read_shift(16)),s&64&&(f=VE(e)),e.l=r;var h=i||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var g={Target:h};return d&&(g.guid=d),f&&(g.time=f),a&&(g.Tooltip=a),g}function K1e(e){var t=Ht(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),AD(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&AD(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function eK(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function tK(e,t){var r=eK(e);return r[3]=0,r}function _d(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function ng(e,t,r,n){return n||(n=Ht(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Y1e(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function X1e(e,t,r){return t===0?"":_g(e,t,r)}function J1e(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function rK(e){var t=e.read_shift(2),r=WE(e);return[t,r]}function Q1e(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=tb(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function s3(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function nK(e,t){return t||(t=Ht(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function sK(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var Z1e=sK;function aK(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function exe(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function txe(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function po(e){e.l+=2,e.l+=e.read_shift(2)}var rxe={0:po,4:po,5:po,6:po,7:txe,8:po,9:po,10:po,11:po,12:po,13:exe,14:po,15:po,16:po,17:po,18:po,19:po,20:po,21:aK};function nxe(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push(rxe[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function t4(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function qE(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Ht(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function sxe(e,t){return t===0||e.read_shift(2),1200}function axe(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=_g(e,0,r);return e.read_shift(t+n-e.l),s}function ixe(e,t){var r=!t||t.biff==8,n=Ht(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function oxe(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function lxe(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=tb(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function cxe(e,t){var r=!t||t.biff>=8?2:1,n=Ht(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function uxe(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(U1e(e));return a.Count=n,a.Unique=s,a}function dxe(e,t){var r=Ht(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=z1e(e[s]);var a=Fi([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function fxe(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function hxe(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function mxe(e){var t=Y1e(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function gxe(e){return e.read_shift(2),e.read_shift(4)}function jD(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function pxe(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function xxe(){var e=Ht(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function yxe(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function vxe(e){var t=Ht(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function bxe(){}function wxe(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=tb(e,0,r),n}function _xe(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=Ht(s);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function Sxe(e){var t=_d(e);return t.isst=e.read_shift(4),t}function kxe(e,t,r,n){var s=Ht(10);return ng(e,t,n,s),s.write_shift(4,r),s}function Cxe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=_d(e);r.biff==2&&e.l++;var a=rb(e,n-e.l,r);return s.val=a,s}function Txe(e,t,r,n,s){var a=!s||s.biff==8,i=Ht(8+ +a+(1+a)*r.length);return ng(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function Nxe(e,t,r){var n=e.read_shift(2),s=_g(e,0,r);return[n,s]}function Exe(e,t,r,n){var s=r&&r.biff==5;n||(n=Ht(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var Axe=_g;function PD(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function jxe(e,t){var r=t.biff==8||!t.biff?4:2,n=Ht(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Pxe(e){var t=e.read_shift(2),r=e.read_shift(2),n=rK(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Fxe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(rK(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function Mxe(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function Rxe(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=m1e[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function Oxe(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Rxe(e,t,n.fStyle,r),n}function FD(e,t,r,n){var s=r&&r.biff==5;n||(n=Ht(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function Dxe(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Ixe(e){var t=Ht(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function MD(e,t,r){var n=_d(e);(r.biff==2||t==9)&&++e.l;var s=$1e(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function Lxe(e,t,r,n,s,a){var i=Ht(8);return ng(e,t,n,i),Qq(r,a,i),i}function Bxe(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=_d(e),s=So(e);return n.val=s,n}function $xe(e,t,r,n){var s=Ht(14);return ng(e,t,n,s),tg(r,s),s}var RD=X1e;function Uxe(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=rg(e,a),o=[];n>e.l;)o.push(rb(e));return[a,s,i,o]}function OD(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=Q1e(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var zxe=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function DD(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=rg(e,i,r);s&32&&(u=zxe[u.charCodeAt(0)]);var d=n-e.l;r&&r.biff==2&&--d;var f=n==e.l||o===0||!(d>0)?[]:nwe(e,d,r,o);return{chKey:a,Name:u,itab:c,rgce:f}}function iK(e,t,r){if(r.biff<8)return Wxe(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(J1e(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function Wxe(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=tb(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Hxe(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=rg(e,n,r),i=rg(e,s,r);return[a,i]}function Gxe(e,t,r){var n=sK(e);e.l++;var s=e.read_shift(1);return t-=8,[swe(e,t,r),s,n]}function ID(e,t,r){var n=Z1e(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,twe(e,t,r)]}function Vxe(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function qxe(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=_g(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function Kxe(e,t,r){return qxe(e,t,r)}function Yxe(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(s3(e));return r}function Xxe(e){var t=Ht(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)nK(e[r],t);return t}function Jxe(e,t,r){if(r&&r.biff<8)return Zxe(e,t,r);var n=aK(e),s=nxe(e,t-22,n[1]);return{cmo:n,ft:s}}var Qxe={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function Zxe(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Qxe[n]||jo)(e,t,r)),{cmo:[s,n,a],ft:i}}function eye(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=W1e(e,6,r);var o=e.read_shift(2);e.read_shift(2),Ka(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var d=e[e.l],f=rg(e,e.lens[u+1]-e.lens[u]-1);if(s+=f,s.length>=(d?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function tye(e,t){var r=s3(e);e.l+=16;var n=q1e(e,t-24);return[r,n]}function rye(e){var t=Ht(24),r=la(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return Fi([t,K1e(e[1])])}function nye(e,t){e.read_shift(2);var r=s3(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Zo,""),[r,n]}function sye(e){var t=e[1].Tooltip,r=Ht(10+2*(t.length+1));r.write_shift(2,2048);var n=la(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function aye(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=wD[r]||r,r=e.read_shift(2),t[1]=wD[r]||r,t}function iye(e){return e||(e=Ht(4)),e.write_shift(2,1),e.write_shift(2,1),e}function oye(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(tK(e));return r}function lye(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(tK(e));return r}function cye(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function oK(e,t,r){if(!r.cellStyles)return jo(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function uye(e,t){var r=Ht(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function dye(e,t){var r={};return t<32||(e.l+=16,r.header=So(e),r.footer=So(e),e.l+=2),r}function fye(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function hye(e){for(var t=Ht(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var mye=_d,gye=Jq,pye=rb;function xye(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function yye(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=_d(e);++e.l;var s=_g(e,t-7,r);return n.t="str",n.val=s,n}function vye(e){var t=_d(e);++e.l;var r=So(e);return t.t="n",t.val=r,t}function bye(e,t,r){var n=Ht(15);return ib(n,e,t),n.write_shift(8,r,"f"),n}function wye(e){var t=_d(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function _ye(e,t,r){var n=Ht(9);return ib(n,e,t),n.write_shift(2,r),n}function Sye(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function kye(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Cye(e,t,r){var n=e.l+t,s=_d(e),a=e.read_shift(2),i=rg(e,a,r);return e.l=n,s.t="str",s.val=i,s}var Tye=[2,3,48,49,131,139,140,245],x8=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=t3({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],d=uh(1);switch(c.type){case"base64":d=Vl(Ql(o));break;case"binary":d=Vl(o);break;case"buffer":case"array":d=o;break}eo(d,0);var f=d.read_shift(1),h=!!(f&136),g=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:g=!0,h=!0;break;case 49:g=!0,h=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,v=521;f==2&&(x=d.read_shift(2)),d.l+=3,f!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(v=d.read_shift(2));var C=d.read_shift(2),b=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=e[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var _=[],T={},N=Math.min(d.length,f==2?521:v-10-(g?264:0)),E=p?32:11;d.l<N&&d[d.l]!=13;)switch(T={},T.name=n2.utils.decode(b,d.slice(d.l,d.l+E)).replace(/[\u0000\r\n].*$/g,""),d.l+=E,T.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(T.offset=d.read_shift(4)),T.len=d.read_shift(1),f==2&&(T.offset=d.read_shift(2)),T.dec=d.read_shift(1),T.name.length&&_.push(T),f!=2&&(d.l+=p?13:14),T.type){case"B":(!g||T.len!=8)&&c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(d[d.l]!==13&&(d.l=v-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=v;var F=0,j=0;for(u[0]=[],j=0;j!=_.length;++j)u[0][j]=_[j].name;for(;x-- >0;){if(d[d.l]===42){d.l+=C;continue}for(++d.l,u[++F]=[],j=0,j=0;j!=_.length;++j){var P=d.slice(d.l,d.l+_[j].len);d.l+=_[j].len,eo(P,0);var M=n2.utils.decode(b,P);switch(_[j].type){case"C":M.trim().length&&(u[F][j]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[F][j]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[F][j]=M;break;case"F":u[F][j]=parseFloat(M.trim());break;case"+":case"I":u[F][j]=p?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[F][j]=!0;break;case"N":case"F":u[F][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));u[F][j]="##MEMO##"+(p?parseInt(M.trim(),10):P.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[F][j]=+M||0);break;case"@":u[F][j]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[F][j]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[F][j]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[F][j]=-P.read_shift(-8,"f");break;case"B":if(g&&_[j].len==8){u[F][j]=P.read_shift(8,"f");break}case"G":case"P":P.l+=_[j].len;break;case"0":if(_[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[j].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=_,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var d=X1(r(o,u),u);return d["!cols"]=u.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete u.DBF,d}function s(o,c){try{return kh(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&gu(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var d=Sl(),f=I_(o,{header:1,raw:!0,cellDates:!0}),h=f[0],g=f.slice(1),p=o["!cols"]||[],x=0,v=0,C=0,b=1;for(x=0;x<h.length;++x){if(((p[x]||{}).DBF||{}).name){h[x]=p[x].DBF.name,++C;continue}if(h[x]!=null){if(++C,typeof h[x]=="number"&&(h[x]=h[x].toString(10)),typeof h[x]!="string")throw new Error("DBF Invalid column name "+h[x]+" |"+typeof h[x]+"|");if(h.indexOf(h[x])!==x){for(v=0;v<1024;++v)if(h.indexOf(h[x]+"_"+v)==-1){h[x]+="_"+v;break}}}}var _=Vn(o["!ref"]),T=[],N=[],E=[];for(x=0;x<=_.e.c-_.s.c;++x){var F="",j="",P=0,M=[];for(v=0;v<g.length;++v)g[v][x]!=null&&M.push(g[v][x]);if(M.length==0||h[x]==null){T[x]="?";continue}for(v=0;v<M.length;++v){switch(typeof M[v]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=M[v]instanceof Date?"D":"C";break;default:j="C"}P=Math.max(P,String(M[v]).length),F=F&&F!=j?"C":j}P>250&&(P=250),j=((p[x]||{}).DBF||{}).type,j=="C"&&p[x].DBF.len>P&&(P=p[x].DBF.len),F=="B"&&j=="N"&&(F="N",E[x]=p[x].DBF.dec,P=p[x].DBF.len),N[x]=F=="C"||j=="N"?P:a[F]||0,b+=N[x],T[x]=F}var I=d.next(32);for(I.write_shift(4,318902576),I.write_shift(4,g.length),I.write_shift(2,296+32*C),I.write_shift(2,b),x=0;x<4;++x)I.write_shift(4,0);for(I.write_shift(4,0|(+t[XV]||3)<<8),x=0,v=0;x<h.length;++x)if(h[x]!=null){var U=d.next(32),K=(h[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);U.write_shift(1,K,"sbcs"),U.write_shift(1,T[x]=="?"?"C":T[x],"sbcs"),U.write_shift(4,v),U.write_shift(1,N[x]||a[T[x]]||0),U.write_shift(1,E[x]||0),U.write_shift(1,2),U.write_shift(4,0),U.write_shift(1,0),U.write_shift(4,0),U.write_shift(4,0),v+=N[x]||a[T[x]]||0}var te=d.next(264);for(te.write_shift(4,13),x=0;x<65;++x)te.write_shift(4,0);for(x=0;x<g.length;++x){var re=d.next(b);for(re.write_shift(1,0),v=0;v<h.length;++v)if(h[v]!=null)switch(T[v]){case"L":re.write_shift(1,g[x][v]==null?63:g[x][v]?84:70);break;case"B":re.write_shift(8,g[x][v]||0,"f");break;case"N":var Z="0";for(typeof g[x][v]=="number"&&(Z=g[x][v].toFixed(E[v]||0)),C=0;C<N[v]-Z.length;++C)re.write_shift(1,32);re.write_shift(1,Z,"sbcs");break;case"D":g[x][v]?(re.write_shift(4,("0000"+g[x][v].getFullYear()).slice(-4),"sbcs"),re.write_shift(2,("00"+(g[x][v].getMonth()+1)).slice(-2),"sbcs"),re.write_shift(2,("00"+g[x][v].getDate()).slice(-2),"sbcs")):re.write_shift(8,"00000000","sbcs");break;case"C":var B=String(g[x][v]!=null?g[x][v]:"").slice(0,N[v]);for(re.write_shift(1,B,"sbcs"),C=0;C<N[v]-B.length;++C)re.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}})(),lK=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+ka(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,g){var p=e[g];return typeof p=="number"?KO(p):p},n=function(h,g,p){var x=g.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?h:KO(x)};e["|"]=254;function s(h,g){switch(g.type){case"base64":return a(Ql(h),g);case"binary":return a(h,g);case"buffer":return a(Mn&&Buffer.isBuffer(h)?h.toString("binary"):Sh(h),g);case"array":return a(eg(h),g)}throw new Error("Unrecognized type "+g.type)}function a(h,g){var p=h.split(/[\n\r]+/),x=-1,v=-1,C=0,b=0,_=[],T=[],N=null,E={},F=[],j=[],P=[],M=0,I;for(+g.codepage>=0&&gu(+g.codepage);C!==p.length;++C){M=0;var U=p[C].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),K=U.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),te=K[0],re;if(U.length>0)switch(te){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":K[1].charAt(0)=="P"&&T.push(U.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,B=!1,J=!1,z=!1,q=-1,H=-1;for(b=1;b<K.length;++b)switch(K[b].charAt(0)){case"A":break;case"X":v=parseInt(K[b].slice(1))-1,B=!0;break;case"Y":for(x=parseInt(K[b].slice(1))-1,B||(v=0),I=_.length;I<=x;++I)_[I]=[];break;case"K":re=K[b].slice(1),re.charAt(0)==='"'?re=re.slice(1,re.length-1):re==="TRUE"?re=!0:re==="FALSE"?re=!1:isNaN(yu(re))?isNaN(x1(re).getDate())||(re=Hs(re)):(re=yu(re),N!==null&&K1(N)&&(re=n3(re))),Z=!0;break;case"E":z=!0;var R=n1(K[b].slice(1),{r:x,c:v});_[x][v]=[_[x][v],R];break;case"S":J=!0,_[x][v]=[_[x][v],"S5S"];break;case"G":break;case"R":q=parseInt(K[b].slice(1))-1;break;case"C":H=parseInt(K[b].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}if(Z&&(_[x][v]&&_[x][v].length==2?_[x][v][0]=re:_[x][v]=re,N=null),J){if(z)throw new Error("SYLK shared formula cannot have own formula");var L=q>-1&&_[q][H];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");_[x][v][1]=TK(L[1],{r:x-q,c:v-H})}break;case"F":var G=0;for(b=1;b<K.length;++b)switch(K[b].charAt(0)){case"X":v=parseInt(K[b].slice(1))-1,++G;break;case"Y":for(x=parseInt(K[b].slice(1))-1,I=_.length;I<=x;++I)_[I]=[];break;case"M":M=parseInt(K[b].slice(1))/20;break;case"F":break;case"G":break;case"P":N=T[parseInt(K[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=K[b].slice(1).split(" "),I=parseInt(P[0],10);I<=parseInt(P[1],10);++I)M=parseInt(P[2],10),j[I-1]=M===0?{hidden:!0}:{wch:M},dh(j[I-1]);break;case"C":v=parseInt(K[b].slice(1))-1,j[v]||(j[v]={});break;case"R":x=parseInt(K[b].slice(1))-1,F[x]||(F[x]={}),M>0?(F[x].hpt=M,F[x].hpx=v1(M)):M===0&&(F[x].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}G<1&&(N=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+U)}}return F.length>0&&(E["!rows"]=F),j.length>0&&(E["!cols"]=j),g&&g.sheetRows&&(_=_.slice(0,g.sheetRows)),[_,E]}function i(h,g){var p=s(h,g),x=p[0],v=p[1],C=X1(x,g);return ka(v).forEach(function(b){C[b]=v[b]}),C}function o(h,g){return kh(i(h,g),g)}function c(h,g,p,x){var v="C;Y"+(p+1)+";X"+(x+1)+";K";switch(h.t){case"n":v+=h.v||0,h.f&&!h.F&&(v+=";E"+ZE(h.f,{r:p,c:x}));break;case"b":v+=h.v?"TRUE":"FALSE";break;case"e":v+=h.w||h.v;break;case"d":v+='"'+(h.w||h.v)+'"';break;case"s":v+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return v}function u(h,g){g.forEach(function(p,x){var v="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?v+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=d2(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=f2(p.wpx)),typeof p.wch=="number"&&(v+=Math.round(p.wch))),v.charAt(v.length-1)!=" "&&h.push(v)})}function d(h,g){g.forEach(function(p,x){var v="F;";p.hidden?v+="M0;":p.hpt?v+="M"+20*p.hpt+";":p.hpx&&(v+="M"+20*h2(p.hpx)+";"),v.length>2&&h.push(v+"R"+(x+1))})}function f(h,g){var p=["ID;PWXL;N;E"],x=[],v=Vn(h["!ref"]),C,b=Array.isArray(h),_=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),h["!cols"]&&u(p,h["!cols"]),h["!rows"]&&d(p,h["!rows"]),p.push("B;Y"+(v.e.r-v.s.r+1)+";X"+(v.e.c-v.s.c+1)+";D"+[v.s.c,v.s.r,v.e.c,v.e.r].join(" "));for(var T=v.s.r;T<=v.e.r;++T)for(var N=v.s.c;N<=v.e.c;++N){var E=cn({r:T,c:N});C=b?(h[T]||[])[N]:h[E],!(!C||C.v==null&&(!C.f||C.F))&&x.push(c(C,h,T,N))}return p.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:o,to_sheet:i,from_sheet:f}})(),cK=(function(){function e(a,i){switch(i.type){case"base64":return t(Ql(a),i);case"binary":return t(a,i);case"buffer":return t(Mn&&Buffer.isBuffer(a)?a.toString("binary"):Sh(a),i);case"array":return t(eg(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,d=0,f=[];d!==o.length;++d){if(o[d].trim()==="BOT"){f[++c]=[],u=0;continue}if(!(c<0)){var h=o[d].trim().split(","),g=h[0],p=h[1];++d;for(var x=o[d]||"";(x.match(/["]/g)||[]).length&1&&d<o.length-1;)x+=`
`+o[++d];switch(x=x.trim(),+g){case-1:if(x==="BOT"){f[++c]=[],u=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][u]=!0:x==="FALSE"?f[c][u]=!1:isNaN(yu(p))?isNaN(x1(p).getDate())?f[c][u]=p:f[c][u]=Hs(p):f[c][u]=yu(p),++u;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][u++]=x!==""?x:null;break}if(x==="EOD")break}}return i&&i.sheetRows&&(f=f.slice(0,i.sheetRows)),f}function r(a,i){return X1(e(a,i),i)}function n(a,i){return kh(r(a,i),i)}var s=(function(){var a=function(c,u,d,f,h){c.push(u),c.push(d+","+f),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,d,f){c.push(u+","+d),c.push(u==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var u=[],d=Vn(c["!ref"]),f,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,d.e.r-d.s.r+1,""),a(u,"TUPLES",0,d.e.c-d.s.c+1,""),a(u,"DATA",0,0,"");for(var g=d.s.r;g<=d.e.r;++g){i(u,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var x=cn({r:g,c:p});if(f=h?(c[g]||[])[p]:c[x],!f){i(u,1,0,"");continue}switch(f.t){case"n":var v=f.w;!v&&f.v!=null&&(v=f.v),v==null?f.f&&!f.F?i(u,1,0,"="+f.f):i(u,1,0,""):i(u,0,v,"V");break;case"b":i(u,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Bc(f.z||on[14],gi(Hs(f.v)))),i(u,0,f.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var C=`\r
`,b=u.join(C);return b}})();return{to_workbook:n,to_sheet:r,from_sheet:s}})(),uK=(function(){function e(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,h){for(var g=f.split(`
`),p=-1,x=-1,v=0,C=[];v!==g.length;++v){var b=g[v].trim().split(":");if(b[0]==="cell"){var _=la(b[1]);if(C.length<=_.r)for(p=C.length;p<=_.r;++p)C[p]||(C[p]=[]);switch(p=_.r,x=_.c,b[2]){case"t":C[p][x]=e(b[3]);break;case"v":C[p][x]=+b[3];break;case"vtf":var T=b[b.length-1];case"vtc":switch(b[3]){case"nl":C[p][x]=!!+b[4];break;default:C[p][x]=+b[4];break}b[2]=="vtf"&&(C[p][x]=[C[p][x],T])}}}return h&&h.sheetRows&&(C=C.slice(0,h.sheetRows)),C}function n(f,h){return X1(r(f,h),h)}function s(f,h){return kh(n(f,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(f){if(!f||!f["!ref"])return"";for(var h=[],g=[],p,x="",v=Tl(f["!ref"]),C=Array.isArray(f),b=v.s.r;b<=v.e.r;++b)for(var _=v.s.c;_<=v.e.c;++_)if(x=cn({r:b,c:_}),p=C?(f[b]||[])[_]:f[x],!(!p||p.v==null||p.t==="z")){switch(g=["cell",x,"t"],p.t){case"s":case"str":g.push(t(p.v));break;case"n":p.f?(g[2]="vtf",g[3]="n",g[4]=p.v,g[5]=t(p.f)):(g[2]="v",g[3]=p.v);break;case"b":g[2]="vt"+(p.f?"f":"c"),g[3]="nl",g[4]=p.v?"1":"0",g[5]=t(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var T=gi(Hs(p.v));g[2]="vtc",g[3]="nd",g[4]=""+T,g[5]=p.w||Bc(p.z||on[14],T);break;case"e":continue}h.push(g.join(":"))}return h.push("sheet:c:"+(v.e.c-v.s.c+1)+":r:"+(v.e.r-v.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function d(f){return[a,i,o,i,u(f),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:d}})(),y1=(function(){function e(d,f,h,g,p){p.raw?f[h][g]=d:d===""||(d==="TRUE"?f[h][g]=!0:d==="FALSE"?f[h][g]=!1:isNaN(yu(d))?isNaN(x1(d).getDate())?f[h][g]=d:f[h][g]=Hs(d):f[h][g]=yu(d))}function t(d,f){var h=f||{},g=[];if(!d||d.length===0)return g;for(var p=d.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var v=10,C=0,b=0;b<=x;++b)C=p[b].indexOf(" "),C==-1?C=p[b].length:C++,v=Math.max(v,C);for(b=0;b<=x;++b){g[b]=[];var _=0;for(e(p[b].slice(0,v).trim(),g,b,_,h),_=1;_<=(p[b].length-v)/10+1;++_)e(p[b].slice(v+(_-1)*10,v+_*10).trim(),g,b,_,h)}return h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(d){for(var f={},h=!1,g=0,p=0;g<d.length;++g)(p=d.charCodeAt(g))==34?h=!h:!h&&p in r&&(f[p]=(f[p]||0)+1);p=[];for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&p.push([f[g],g]);if(!p.length){f=n;for(g in f)Object.prototype.hasOwnProperty.call(f,g)&&p.push([f[g],g])}return p.sort(function(x,v){return x[0]-v[0]||n[x[1]]-n[v[1]]}),r[p.pop()[1]]||44}function a(d,f){var h=f||{},g="",p=h.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(g=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(g=d.charAt(4),d=d.slice(6)):g=s(d.slice(0,1024)):h&&h.FS?g=h.FS:g=s(d.slice(0,1024));var v=0,C=0,b=0,_=0,T=0,N=g.charCodeAt(0),E=!1,F=0,j=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var P=h.dateNF!=null?fpe(h.dateNF):null;function M(){var I=d.slice(_,T),U={};if(I.charAt(0)=='"'&&I.charAt(I.length-1)=='"'&&(I=I.slice(1,-1).replace(/""/g,'"')),I.length===0)U.t="z";else if(h.raw)U.t="s",U.v=I;else if(I.trim().length===0)U.t="s",U.v=I;else if(I.charCodeAt(0)==61)I.charCodeAt(1)==34&&I.charCodeAt(I.length-1)==34?(U.t="s",U.v=I.slice(2,-1).replace(/""/g,'"')):U2e(I)?(U.t="n",U.f=I.slice(1)):(U.t="s",U.v=I);else if(I=="TRUE")U.t="b",U.v=!0;else if(I=="FALSE")U.t="b",U.v=!1;else if(!isNaN(b=yu(I)))U.t="n",h.cellText!==!1&&(U.w=I),U.v=b;else if(!isNaN(x1(I).getDate())||P&&I.match(P)){U.z=h.dateNF||on[14];var K=0;P&&I.match(P)&&(I=hpe(I,h.dateNF,I.match(P)||[]),K=1),h.cellDates?(U.t="d",U.v=Hs(I,K)):(U.t="n",U.v=gi(Hs(I,K))),h.cellText!==!1&&(U.w=Bc(U.z,U.v instanceof Date?gi(U.v):U.v)),h.cellNF||delete U.z}else U.t="s",U.v=I;if(U.t=="z"||(h.dense?(p[v]||(p[v]=[]),p[v][C]=U):p[cn({c:C,r:v})]=U),_=T+1,j=d.charCodeAt(_),x.e.c<C&&(x.e.c=C),x.e.r<v&&(x.e.r=v),F==N)++C;else if(C=0,++v,h.sheetRows&&h.sheetRows<=v)return!0}e:for(;T<d.length;++T)switch(F=d.charCodeAt(T)){case 34:j===34&&(E=!E);break;case N:case 10:case 13:if(!E&&M())break e;break}return T-_>0&&M(),p["!ref"]=Tn(x),p}function i(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?a(d,f):X1(t(d,f),f)}function o(d,f){var h="",g=f.type=="string"?[0,0,0,0]:oA(d,f);switch(f.type){case"base64":h=Ql(d);break;case"binary":h=d;break;case"buffer":f.codepage==65001?h=d.toString("utf8"):f.codepage&&typeof n2<"u"||(h=Mn&&Buffer.isBuffer(d)?d.toString("binary"):Sh(d));break;case"array":h=eg(d);break;case"string":h=d;break;default:throw new Error("Unrecognized type "+f.type)}return g[0]==239&&g[1]==187&&g[2]==191?h=bs(h.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?h=bs(h):f.type=="binary"&&typeof n2<"u",h.slice(0,19)=="socialcalc:version:"?uK.to_sheet(f.type=="string"?h:bs(h),f):i(h,f)}function c(d,f){return kh(o(d,f),f)}function u(d){for(var f=[],h=Vn(d["!ref"]),g,p=Array.isArray(d),x=h.s.r;x<=h.e.r;++x){for(var v=[],C=h.s.c;C<=h.e.c;++C){var b=cn({r:x,c:C});if(g=p?(d[x]||[])[C]:d[b],!g||g.v==null){v.push("          ");continue}for(var _=(g.w||(E0(g),g.w)||"").slice(0,10);_.length<10;)_+=" ";v.push(_+(C===0?" ":""))}f.push(v.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}})();function Nye(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=lK.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return y1.to_workbook(e,t)}}var Rm=(function(){function e(R,L,G){if(R){eo(R,R.l||0);for(var W=G.Enum||q;R.l<R.length;){var Q=R.read_shift(2),X=W[Q]||W[65535],se=R.read_shift(2),le=R.l+se,he=X.f&&X.f(R,se,G);if(R.l=le,L(he,X,Q))return}}}function t(R,L){switch(L.type){case"base64":return r(Vl(Ql(R)),L);case"binary":return r(Vl(R),L);case"buffer":case"array":return r(R,L)}throw"Unsupported type "+L.type}function r(R,L){if(!R)return R;var G=L||{},W=G.dense?[]:{},Q="Sheet1",X="",se=0,le={},he=[],we=[],ie={s:{r:0,c:0},e:{r:0,c:0}},Ee=G.sheetRows||0;if(R[2]==0&&(R[3]==8||R[3]==9)&&R.length>=16&&R[14]==5&&R[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(R[2]==2)G.Enum=q,e(R,function(Qe,$t,Ge){switch(Ge){case 0:G.vers=Qe,Qe>=4096&&(G.qpro=!0);break;case 6:ie=Qe;break;case 204:Qe&&(X=Qe);break;case 222:X=Qe;break;case 15:case 51:G.qpro||(Qe[1].v=Qe[1].v.slice(1));case 13:case 14:case 16:Ge==14&&(Qe[2]&112)==112&&(Qe[2]&15)>1&&(Qe[2]&15)<15&&(Qe[1].z=G.dateNF||on[14],G.cellDates&&(Qe[1].t="d",Qe[1].v=n3(Qe[1].v))),G.qpro&&Qe[3]>se&&(W["!ref"]=Tn(ie),le[Q]=W,he.push(Q),W=G.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},se=Qe[3],Q=X||"Sheet"+(se+1),X="");var et=G.dense?(W[Qe[0].r]||[])[Qe[0].c]:W[cn(Qe[0])];if(et){et.t=Qe[1].t,et.v=Qe[1].v,Qe[1].z!=null&&(et.z=Qe[1].z),Qe[1].f!=null&&(et.f=Qe[1].f);break}G.dense?(W[Qe[0].r]||(W[Qe[0].r]=[]),W[Qe[0].r][Qe[0].c]=Qe[1]):W[cn(Qe[0])]=Qe[1];break}},G);else if(R[2]==26||R[2]==14)G.Enum=H,R[2]==14&&(G.qpro=!0,R.l=0),e(R,function(Qe,$t,Ge){switch(Ge){case 204:Q=Qe;break;case 22:Qe[1].v=Qe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Qe[3]>se&&(W["!ref"]=Tn(ie),le[Q]=W,he.push(Q),W=G.dense?[]:{},ie={s:{r:0,c:0},e:{r:0,c:0}},se=Qe[3],Q="Sheet"+(se+1)),Ee>0&&Qe[0].r>=Ee)break;G.dense?(W[Qe[0].r]||(W[Qe[0].r]=[]),W[Qe[0].r][Qe[0].c]=Qe[1]):W[cn(Qe[0])]=Qe[1],ie.e.c<Qe[0].c&&(ie.e.c=Qe[0].c),ie.e.r<Qe[0].r&&(ie.e.r=Qe[0].r);break;case 27:Qe[14e3]&&(we[Qe[14e3][0]]=Qe[14e3][1]);break;case 1537:we[Qe[0]]=Qe[1],Qe[0]==se&&(Q=Qe[1]);break}},G);else throw new Error("Unrecognized LOTUS BOF "+R[2]);if(W["!ref"]=Tn(ie),le[X||Q]=W,he.push(X||Q),!we.length)return{SheetNames:he,Sheets:le};for(var ye={},Ie=[],ut=0;ut<we.length;++ut)le[he[ut]]?(Ie.push(we[ut]||he[ut]),ye[we[ut]]=le[we[ut]]||le[he[ut]]):(Ie.push(we[ut]),ye[we[ut]]={"!ref":"A1"});return{SheetNames:Ie,Sheets:ye}}function n(R,L){var G=L||{};if(+G.codepage>=0&&gu(+G.codepage),G.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Sl(),Q=Vn(R["!ref"]),X=Array.isArray(R),se=[];vr(W,0,a(1030)),vr(W,6,c(Q));for(var le=Math.min(Q.e.r,8191),he=Q.s.r;he<=le;++he)for(var we=La(he),ie=Q.s.c;ie<=Q.e.c;++ie){he===Q.s.r&&(se[ie]=oa(ie));var Ee=se[ie]+we,ye=X?(R[he]||[])[ie]:R[Ee];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?vr(W,13,g(he,ie,ye.v)):vr(W,14,x(he,ie,ye.v));else{var Ie=E0(ye);vr(W,15,f(he,ie,Ie.slice(0,239)))}}return vr(W,1),W.end()}function s(R,L){var G=L||{};if(+G.codepage>=0&&gu(+G.codepage),G.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Sl();vr(W,0,i(R));for(var Q=0,X=0;Q<R.SheetNames.length;++Q)(R.Sheets[R.SheetNames[Q]]||{})["!ref"]&&vr(W,27,z(R.SheetNames[Q],X++));var se=0;for(Q=0;Q<R.SheetNames.length;++Q){var le=R.Sheets[R.SheetNames[Q]];if(!(!le||!le["!ref"])){for(var he=Vn(le["!ref"]),we=Array.isArray(le),ie=[],Ee=Math.min(he.e.r,8191),ye=he.s.r;ye<=Ee;++ye)for(var Ie=La(ye),ut=he.s.c;ut<=he.e.c;++ut){ye===he.s.r&&(ie[ut]=oa(ut));var Qe=ie[ut]+Ie,$t=we?(le[ye]||[])[ut]:le[Qe];if(!(!$t||$t.t=="z"))if($t.t=="n")vr(W,23,M(ye,ut,se,$t.v));else{var Ge=E0($t);vr(W,22,F(ye,ut,se,Ge.slice(0,239)))}}++se}}return vr(W,1),W.end()}function a(R){var L=Ht(2);return L.write_shift(2,R),L}function i(R){var L=Ht(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var G=0,W=0,Q=0,X=0;X<R.SheetNames.length;++X){var se=R.SheetNames[X],le=R.Sheets[se];if(!(!le||!le["!ref"])){++Q;var he=Tl(le["!ref"]);G<he.e.r&&(G=he.e.r),W<he.e.c&&(W=he.e.c)}}return G>8191&&(G=8191),L.write_shift(2,G),L.write_shift(1,Q),L.write_shift(1,W),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(R,L,G){var W={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&G.qpro?(W.s.c=R.read_shift(1),R.l++,W.s.r=R.read_shift(2),W.e.c=R.read_shift(1),R.l++,W.e.r=R.read_shift(2),W):(W.s.c=R.read_shift(2),W.s.r=R.read_shift(2),L==12&&G.qpro&&(R.l+=2),W.e.c=R.read_shift(2),W.e.r=R.read_shift(2),L==12&&G.qpro&&(R.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(R){var L=Ht(8);return L.write_shift(2,R.s.c),L.write_shift(2,R.s.r),L.write_shift(2,R.e.c),L.write_shift(2,R.e.r),L}function u(R,L,G){var W=[{c:0,r:0},{t:"n",v:0},0,0];return G.qpro&&G.vers!=20768?(W[0].c=R.read_shift(1),W[3]=R.read_shift(1),W[0].r=R.read_shift(2),R.l+=2):(W[2]=R.read_shift(1),W[0].c=R.read_shift(2),W[0].r=R.read_shift(2)),W}function d(R,L,G){var W=R.l+L,Q=u(R,L,G);if(Q[1].t="s",G.vers==20768){R.l++;var X=R.read_shift(1);return Q[1].v=R.read_shift(X,"utf8"),Q}return G.qpro&&R.l++,Q[1].v=R.read_shift(W-R.l,"cstr"),Q}function f(R,L,G){var W=Ht(7+G.length);W.write_shift(1,255),W.write_shift(2,L),W.write_shift(2,R),W.write_shift(1,39);for(var Q=0;Q<W.length;++Q){var X=G.charCodeAt(Q);W.write_shift(1,X>=128?95:X)}return W.write_shift(1,0),W}function h(R,L,G){var W=u(R,L,G);return W[1].v=R.read_shift(2,"i"),W}function g(R,L,G){var W=Ht(7);return W.write_shift(1,255),W.write_shift(2,L),W.write_shift(2,R),W.write_shift(2,G,"i"),W}function p(R,L,G){var W=u(R,L,G);return W[1].v=R.read_shift(8,"f"),W}function x(R,L,G){var W=Ht(13);return W.write_shift(1,255),W.write_shift(2,L),W.write_shift(2,R),W.write_shift(8,G,"f"),W}function v(R,L,G){var W=R.l+L,Q=u(R,L,G);if(Q[1].v=R.read_shift(8,"f"),G.qpro)R.l=W;else{var X=R.read_shift(2);T(R.slice(R.l,R.l+X),Q),R.l+=X}return Q}function C(R,L,G){var W=L&32768;return L&=-32769,L=(W?R:0)+(L>=8192?L-16384:L),(W?"":"$")+(G?oa(L):La(L))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(R,L){eo(R,0);for(var G=[],W=0,Q="",X="",se="",le="";R.l<R.length;){var he=R[R.l++];switch(he){case 0:G.push(R.read_shift(8,"f"));break;case 1:X=C(L[0].c,R.read_shift(2),!0),Q=C(L[0].r,R.read_shift(2),!1),G.push(X+Q);break;case 2:{var we=C(L[0].c,R.read_shift(2),!0),ie=C(L[0].r,R.read_shift(2),!1);X=C(L[0].c,R.read_shift(2),!0),Q=C(L[0].r,R.read_shift(2),!1),G.push(we+ie+":"+X+Q)}break;case 3:if(R.l<R.length){console.error("WK1 premature formula end");return}break;case 4:G.push("("+G.pop()+")");break;case 5:G.push(R.read_shift(2));break;case 6:{for(var Ee="";he=R[R.l++];)Ee+=String.fromCharCode(he);G.push('"'+Ee.replace(/"/g,'""')+'"')}break;case 8:G.push("-"+G.pop());break;case 23:G.push("+"+G.pop());break;case 22:G.push("NOT("+G.pop()+")");break;case 20:case 21:le=G.pop(),se=G.pop(),G.push(["AND","OR"][he-20]+"("+se+","+le+")");break;default:if(he<32&&_[he])le=G.pop(),se=G.pop(),G.push(se+_[he]+le);else if(b[he]){if(W=b[he][1],W==69&&(W=R[R.l++]),W>G.length){console.error("WK1 bad formula parse 0x"+he.toString(16)+":|"+G.join("|")+"|");return}var ye=G.slice(-W);G.length-=W,G.push(b[he][0]+"("+ye.join(",")+")")}else return he<=7?console.error("WK1 invalid opcode "+he.toString(16)):he<=24?console.error("WK1 unsupported op "+he.toString(16)):he<=30?console.error("WK1 invalid opcode "+he.toString(16)):he<=115?console.error("WK1 unsupported function opcode "+he.toString(16)):console.error("WK1 unrecognized opcode "+he.toString(16))}}G.length==1?L[1].f=""+G[0]:console.error("WK1 bad formula parse |"+G.join("|")+"|")}function N(R){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=R.read_shift(2),L[3]=R[R.l++],L[0].c=R[R.l++],L}function E(R,L){var G=N(R);return G[1].t="s",G[1].v=R.read_shift(L-4,"cstr"),G}function F(R,L,G,W){var Q=Ht(6+W.length);Q.write_shift(2,R),Q.write_shift(1,G),Q.write_shift(1,L),Q.write_shift(1,39);for(var X=0;X<W.length;++X){var se=W.charCodeAt(X);Q.write_shift(1,se>=128?95:se)}return Q.write_shift(1,0),Q}function j(R,L){var G=N(R);G[1].v=R.read_shift(2);var W=G[1].v>>1;if(G[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return G[1].v=W,G}function P(R,L){var G=N(R),W=R.read_shift(4),Q=R.read_shift(4),X=R.read_shift(2);if(X==65535)return W===0&&Q===3221225472?(G[1].t="e",G[1].v=15):W===0&&Q===3489660928?(G[1].t="e",G[1].v=42):G[1].v=0,G;var se=X&32768;return X=(X&32767)-16446,G[1].v=(1-se*2)*(Q*Math.pow(2,X+32)+W*Math.pow(2,X)),G}function M(R,L,G,W){var Q=Ht(14);if(Q.write_shift(2,R),Q.write_shift(1,G),Q.write_shift(1,L),W==0)return Q.write_shift(4,0),Q.write_shift(4,0),Q.write_shift(2,65535),Q;var X=0,se=0,le=0,he=0;return W<0&&(X=1,W=-W),se=Math.log2(W)|0,W/=Math.pow(2,se-31),he=W>>>0,(he&2147483648)==0&&(W/=2,++se,he=W>>>0),W-=he,he|=2147483648,he>>>=0,W*=Math.pow(2,32),le=W>>>0,Q.write_shift(4,le),Q.write_shift(4,he),se+=16383+(X?32768:0),Q.write_shift(2,se),Q}function I(R,L){var G=P(R);return R.l+=L-14,G}function U(R,L){var G=N(R),W=R.read_shift(4);return G[1].v=W>>6,G}function K(R,L){var G=N(R),W=R.read_shift(8,"f");return G[1].v=W,G}function te(R,L){var G=K(R);return R.l+=L-10,G}function re(R,L){return R[R.l+L-1]==0?R.read_shift(L,"cstr"):""}function Z(R,L){var G=R[R.l++];G>L-1&&(G=L-1);for(var W="";W.length<G;)W+=String.fromCharCode(R[R.l++]);return W}function B(R,L,G){if(!(!G.qpro||L<21)){var W=R.read_shift(1);R.l+=17,R.l+=1,R.l+=2;var Q=R.read_shift(L-21,"cstr");return[W,Q]}}function J(R,L){for(var G={},W=R.l+L;R.l<W;){var Q=R.read_shift(2);if(Q==14e3){for(G[Q]=[0,""],G[Q][0]=R.read_shift(2);R[R.l];)G[Q][1]+=String.fromCharCode(R[R.l]),R.l++;R.l++}}return G}function z(R,L){var G=Ht(5+R.length);G.write_shift(2,14e3),G.write_shift(2,L);for(var W=0;W<R.length;++W){var Q=R.charCodeAt(W);G[G.l++]=Q>127?95:Q}return G[G.l++]=0,G}var q={0:{n:"BOF",f:Ka},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:v},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:re},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},H={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:E},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:I},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:J},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:U},38:{n:"??"},39:{n:"NUMBER27",f:K},40:{n:"FORMULA28",f:te},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:re},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:B},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}})();function Eye(e){var t={},r=e.match(Po),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=fn(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=kE[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var Aye=(function(){var e=i2("t"),t=i2("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Hn(i[1])},c=a.match(t);return c&&(o.s=Eye(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}})(),jye=(function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}})(),Pye=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Fye=/<(?:\w+:)?r>/,Mye=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function KE(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Hn(bs(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=bs(e),r&&(n.h=RE(n.t))):e.match(Fye)&&(n.r=bs(e),n.t=Hn(bs((e.replace(Mye,"").match(Pye)||[]).join("").replace(Po,""))),r&&(n.h=jye(Aye(n.r)))),n):{t:""}}var Rye=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Oye=/<(?:\w+:)?(?:si|sstItem)>/g,Dye=/<\/(?:\w+:)?(?:si|sstItem)>/;function Iye(e,t){var r=[],n="";if(!e)return r;var s=e.match(Rye);if(s){n=s[2].replace(Oye,"").split(Dye);for(var a=0;a!=n.length;++a){var i=KE(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=fn(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var Lye=/^\s|\s$|[\t\n\r]/;function dK(e,t){if(!t.bookSST)return"";var r=[Ua];r[r.length]=pr("sst",null,{xmlns:xg[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(Lye)&&(a+=' xml:space="preserve"'),a+=">"+ms(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Bye(e){return[e.read_shift(4),e.read_shift(4)]}function $ye(e,t){var r=[],n=!1;return L0(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function Uye(e,t){return t||(t=Ht(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var zye=Qpe;function Wye(e){var t=Sl();Xt(t,159,Uye(e));for(var r=0;r<e.length;++r)Xt(t,19,zye(e[r]));return Xt(t,160),t.end()}function fK(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function y0(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Hye(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=y0(e,4),t.U=y0(e,4),t.W=y0(e,4),t}function Gye(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Vye(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Gye(e));return t}function qye(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Kye(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=y0(e,4),t.U=y0(e,4),t.W=y0(e,4),t}function Yye(e){var t=Kye(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function hK(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function mK(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Xye(e){var t=y0(e);switch(t.Minor){case 2:return[t.Minor,Jye(e)];case 3:return[t.Minor,Qye()];case 4:return[t.Minor,Zye(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Jye(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=hK(e,r),s=mK(e,e.length-e.l);return{t:"Std",h:n,v:s}}function Qye(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Zye(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Po,function(a){var i=fn(a);switch(wd(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function eve(e,t){var r={},n=r.EncryptionVersionInfo=y0(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=hK(e,s),t-=s,r.EncryptionVerifier=mK(e,t),r}function tve(e){var t={},r=t.EncryptionVersionInfo=y0(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function YE(e){var t=0,r,n=fK(e),s=n.length+1,a,i,o,c,u;for(r=uh(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=(t&16384)===0?0:1,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var gK=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var d=i[u],f=0;f!=7;++f)d&64&&(o^=r[c]),d*=2,--c;return o};return function(i){for(var o=fK(i),c=a(o),u=o.length,d=uh(16),f=0;f!=16;++f)d[f]=0;var h,g,p;for((u&1)===1&&(h=c>>8,d[u]=s(e[0],h),--u,h=c&255,g=o[o.length-1],d[u]=s(g,h));u>0;)--u,h=c>>8,d[u]=s(o[u],h),--u,h=c&255,d[u]=s(o[u],h);for(u=15,p=15-o.length;p>0;)h=c>>8,d[u]=s(e[p],h),--u,--p,h=c&255,d[u]=s(o[u],h),--u,--p;return d}})(),rve=function(e,t,r,n,s){s||(s=t),n||(n=gK(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},nve=function(e){var t=0,r=gK(e);return function(n){var s=rve("",n,t,r);return t=s[1],s[0]}};function sve(e,t,r,n){var s={key:Ka(e),verificationBytes:Ka(e)};return r.password&&(s.verifier=YE(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=nve(r.password)),s}function ave(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=tve(e):n.Data=eve(e,t),n}function ive(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?ave(e,t-2,n):sve(e,r.biff>=8?t:t-2,r,n),n}var pK=(function(){function e(s,a){switch(a.type){case"base64":return t(Ql(s),a);case"binary":return t(s,a);case"buffer":return t(Mn&&Buffer.isBuffer(s)?s.toString("binary"):Sh(s),a);case"array":return t(eg(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(o)&&(o[f]=[]);for(var h=/\\\w+\b/g,g=0,p,x=-1;p=h.exec(d);){switch(p[0]){case"\\cell":var v=d.slice(g,h.lastIndex-p[0].length);if(v[0]==" "&&(v=v.slice(1)),++x,v.length){var C={v,t:"s"};Array.isArray(o)?o[f][x]=C:o[cn({r:f,c:x})]=C}break}g=h.lastIndex}x>u.e.c&&(u.e.c=x)}),o["!ref"]=Tn(u),o}function r(s,a){return kh(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Vn(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var d=i.s.c;d<=i.e.c;++d)a.push("\\cellx"+(d+1));for(a.push("\\pard\\intbl"),d=i.s.c;d<=i.e.c;++d){var f=cn({r:u,c:d});o=c?(s[u]||[])[d]:s[f],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(E0(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function ove(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function u2(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function lve(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function cve(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function O_(e,t){if(t===0)return e;var r=lve(ove(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),u2(cve(r))}var xK=6,uve=15,dve=1,wo=xK;function d2(e){return Math.floor((e+Math.round(128/wo)/256)*wo)}function f2(e){return Math.floor((e-5)/wo*100+.5)/100}function D_(e){return Math.round((e*wo+5)/wo*256)/256}function I6(e){return D_(f2(d2(e)))}function XE(e){var t=Math.abs(e-I6(e)),r=wo;if(t>.005)for(wo=dve;wo<uve;++wo)Math.abs(e-I6(e))<=t&&(t=Math.abs(e-I6(e)),r=wo);wo=r}function dh(e){e.width?(e.wpx=d2(e.width),e.wch=f2(e.wpx),e.MDW=wo):e.wpx?(e.wch=f2(e.wpx),e.width=D_(e.wch),e.MDW=wo):typeof e.wch=="number"&&(e.width=D_(e.wch),e.wpx=d2(e.width),e.MDW=wo),e.customWidth&&delete e.customWidth}var fve=96,yK=fve;function h2(e){return e*96/yK}function v1(e){return e*yK/96}var hve={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function mve(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Po)||[]).forEach(function(i){var o=fn(i);switch(wd(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=Us(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=Us(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function gve(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Po)||[]).forEach(function(i){var o=fn(i);switch(wd(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function pve(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Po)||[]).forEach(function(i){var o=fn(i);switch(wd(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=bs(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?Us(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?Us(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?Us(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?Us(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?Us(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?Us(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?Us(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=kE[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=Us(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=Fm[s.color.index];s.color.index==81&&(c=Fm[1]),c||(c=Fm[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=O_(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function xve(e,t,r){t.NumberFmt=[];for(var n=ka(on),s=0;s<n.length;++s)t.NumberFmt[n[s]]=on[n[s]];var a=e[0].match(Po);if(a)for(s=0;s<a.length;++s){var i=fn(a[s]);switch(wd(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Hn(bs(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}x0(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function yve(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=pr("numFmt",null,{numFmtId:n,formatCode:ms(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=pr("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var r4=["numFmtId","fillId","fontId","borderId","xfId"],n4=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function vve(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Po)||[]).forEach(function(a){var i=fn(a),o=0;switch(wd(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<r4.length;++o)n[r4[o]]&&(n[r4[o]]=parseInt(n[r4[o]],10));for(o=0;o<n4.length;++o)n[n4[o]]&&(n[n4[o]]=Us(n[n4[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=Us(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function bve(e){var t=[];return t[t.length]=pr("cellXfs",null),e.forEach(function(r){t[t.length]=pr("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=pr("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var wve=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var d={};if(!o)return d;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(t))&&xve(f,d,u),(f=o.match(s))&&pve(f,d,c,u),(f=o.match(n))&&gve(f,d,c,u),(f=o.match(a))&&mve(f,d,c,u),(f=o.match(r))&&vve(f,d,u),d}})();function vK(e,t){var r=[Ua,pr("styleSheet",null,{xmlns:xg[0],"xmlns:vt":fi.vt})],n;return e.SSF&&(n=yve(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=bve(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function _ve(e,t){var r=e.read_shift(2),n=Eo(e);return[r,n]}function Sve(e,t,r){r||(r=Ht(6+4*t.length)),r.write_shift(2,e),Mi(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function kve(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=a1e(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=s1e(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Eo(e),n}function Cve(e,t){t||(t=Ht(153)),t.write_shift(2,e.sz*20),i1e(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),F_(e.color,t);var n=0;return n=2,t.write_shift(1,n),Mi(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Tve=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],L6,Nve=jo;function LD(e,t){t||(t=Ht(84)),L6||(L6=t3(Tve));var r=L6[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(F_({auto:1},t),F_({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Eve(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function bK(e,t,r){r||(r=Ht(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Yy(e,t){return t||(t=Ht(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ave=jo;function jve(e,t){return t||(t=Ht(51)),t.write_shift(1,0),Yy(null,t),Yy(null,t),Yy(null,t),Yy(null,t),Yy(null,t),t.length>t.l?t.slice(0,t.l):t}function Pve(e,t){return t||(t=Ht(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),P_(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Fve(e,t,r){var n=Ht(2052);return n.write_shift(4,e),P_(t,n),P_(r,n),n.length>n.l?n.slice(0,n.l):n}function Mve(e,t,r){var n={};n.NumberFmt=[];for(var s in on)n.NumberFmt[s]=on[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return L0(e,function(c,u,d){switch(d){case 44:n.NumberFmt[c[0]]=c[1],x0(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=O_(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(d),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(d);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+d.toString(16))}}),n}function Rve(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(Xt(e,615,vu(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&Xt(e,44,Sve(s,t[s]))}),Xt(e,616))}}function Ove(e){var t=1;Xt(e,611,vu(t)),Xt(e,43,Cve({sz:12,color:{theme:1},name:"Calibri",family:2})),Xt(e,612)}function Dve(e){var t=2;Xt(e,603,vu(t)),Xt(e,45,LD({patternType:"none"})),Xt(e,45,LD({patternType:"gray125"})),Xt(e,604)}function Ive(e){var t=1;Xt(e,613,vu(t)),Xt(e,46,jve()),Xt(e,614)}function Lve(e){var t=1;Xt(e,626,vu(t)),Xt(e,47,bK({numFmtId:0},65535)),Xt(e,627)}function Bve(e,t){Xt(e,617,vu(t.length)),t.forEach(function(r){Xt(e,47,bK(r,0))}),Xt(e,618)}function $ve(e){var t=1;Xt(e,619,vu(t)),Xt(e,48,Pve({xfId:0,name:"Normal"})),Xt(e,620)}function Uve(e){var t=0;Xt(e,505,vu(t)),Xt(e,506)}function zve(e){var t=0;Xt(e,508,Fve(t,"TableStyleMedium9","PivotStyleMedium4")),Xt(e,509)}function Wve(e,t){var r=Sl();return Xt(r,278),Rve(r,e.SSF),Ove(r),Dve(r),Ive(r),Lve(r),Bve(r,t.cellXfs),$ve(r),Uve(r),zve(r),Xt(r,279),r.end()}var Hve=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Gve(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Po)||[]).forEach(function(s){var a=fn(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[Hve.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Vve(){}function qve(){}var Kve=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Yve=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Xve=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Jve(e,t,r){t.themeElements={};var n;[["clrScheme",Kve,Gve],["fontScheme",Yve,Vve],["fmtScheme",Xve,qve]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var Qve=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function wK(e,t){(!e||e.length===0)&&(e=JE());var r,n={};if(!(r=e.match(Qve)))throw new Error("themeElements not found in theme");return Jve(r[0],n,t),n.raw=e,n}function JE(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Ua];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Zve(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=hq(a,{type:"array"})}catch{return}var o=ql(i,"theme/theme/theme1.xml",!0);if(o)return wK(o,r)}}function e2e(e){return e.read_shift(4)}function t2e(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=r2e(e,4);break;case 2:t.xclrValue=eK(e);break;case 3:t.xclrValue=e2e(e);break;case 4:e.l+=4;break}return e.l+=8,t}function r2e(e,t){return jo(e,t)}function n2e(e,t){return jo(e,t)}function s2e(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=t2e(e);break;case 6:n[1]=n2e(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function a2e(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(s2e(e,r-e.l));return{ixfe:n,ext:a}}function i2e(e,t){t.forEach(function(r){r[0]})}function o2e(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Eo(e)}}function l2e(e){var t=Ht(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Mi(e.name,t),t.slice(0,t.l)}function c2e(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function u2e(e){var t=Ht(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function d2e(e,t){var r=Ht(8+2*t.length);return r.write_shift(4,e),Mi(t,r),r.slice(0,r.l)}function f2e(e){return e.l+=4,e.read_shift(4)!=0}function h2e(e,t){var r=Ht(8);return r.write_shift(4,e),r.write_shift(4,1),r}function m2e(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return L0(e,function(c,u,d){switch(d){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(d),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}}),n}function g2e(){var e=Sl();return Xt(e,332),Xt(e,334,vu(1)),Xt(e,335,l2e({name:"XLDAPR",version:12e4,flags:3496657072})),Xt(e,336),Xt(e,339,d2e(1,"XLDAPR")),Xt(e,52),Xt(e,35,vu(514)),Xt(e,4096,vu(0)),Xt(e,4097,Cc(1)),Xt(e,36),Xt(e,53),Xt(e,340),Xt(e,337,h2e(1)),Xt(e,51,u2e([[1,0]])),Xt(e,338),Xt(e,333),e.end()}function p2e(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Po,function(o){var c=fn(o);switch(wd(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function _K(){var e=[Ua];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function x2e(e){var t=[];if(!e)return t;var r=1;return(e.match(Po)||[]).forEach(function(n){var s=fn(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function y2e(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=cn(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function v2e(e,t,r){var n=[];return L0(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function b2e(e,t,r,n){if(!e)return e;var s=n||{},a=!1;L0(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function w2e(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Gp=1024;function SK(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[pr("xml",null,{"xmlns:v":zl.v,"xmlns:o":zl.o,"xmlns:x":zl.x,"xmlns:mv":zl.mv}).replace(/\/>/,">"),pr("o:shapelayout",pr("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),pr("v:shapetype",[pr("v:stroke",null,{joinstyle:"miter"}),pr("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Gp<e*1e3;)Gp+=1e3;return t.forEach(function(a){var i=la(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?pr("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=pr("v:fill",c,o),d={on:"t",obscured:"t"};++Gp,s=s.concat(["<v:shape"+o2({id:"_x0000_s"+Gp,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,pr("v:shadow",null,d),pr("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",no("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),no("x:AutoFill","False"),no("x:Row",String(i.r)),no("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function BD(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=la(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=Vn(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=Tn(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var d={a:i.author,t:i.t,r:i.r,T:r};i.h&&(d.h=i.h);for(var f=a.c.length-1;f>=0;--f){if(!r&&a.c[f].T)return;r&&!a.c[f].T&&a.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(d.a==n[f].id){d.a=n[f].name||d.a;break}}a.c.push(d)})}function _2e(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=fn(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},d=la(c.ref);if(!(t.sheetRows&&t.sheetRows<=d.r)){var f=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!f&&!!f[1]&&KE(f[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function kK(e){var t=[Ua,pr("comments",null,{xmlns:xg[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=ms(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(ms(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(no("t",ms(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(no("t",ms(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function S2e(e,t){var r=[],n=!1,s={},a=0;return e.replace(Po,function(o,c){var u=fn(o);switch(wd(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function k2e(e,t,r){var n=[Ua,pr("ThreadedComments",null,{xmlns:fi.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(pr("threadedComment",no("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function C2e(e,t){var r=[],n=!1;return e.replace(Po,function(a){var i=fn(a);switch(wd(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function T2e(e){var t=[Ua,pr("personList",null,{xmlns:fi.TCMNT,"xmlns:x":xg[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(pr("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function N2e(e){var t={};t.iauthor=e.read_shift(4);var r=wg(e);return t.rfx=r.s,t.ref=cn(r.s),e.l+=16,t}function E2e(e,t){return t==null&&(t=Ht(36)),t.write_shift(4,e[1].iauthor),J1(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var A2e=Eo;function j2e(e){return Mi(e.slice(0,54))}function P2e(e,t){var r=[],n=[],s={},a=!1;return L0(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function F2e(e){var t=Sl(),r=[];return Xt(t,628),Xt(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),Xt(t,632,j2e(s.a)))})}),Xt(t,631),Xt(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:la(n[0]),e:la(n[0])};Xt(t,635,E2e([a,s])),s.t&&s.t.length>0&&Xt(t,637,e1e(s)),Xt(t,636),delete s.iauthor})}),Xt(t,634),Xt(t,629),t.end()}var M2e="application/vnd.ms-office.vbaProject";function R2e(e){var t=Jr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Jr.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Jr.write(t)}function O2e(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Jr.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var CK=["xlsb","xlsm","xlam","biff8","xla"];function D2e(){return{"!type":"dialog"}}function I2e(){return{"!type":"dialog"}}function L2e(){return{"!type":"macro"}}function B2e(){return{"!type":"macro"}}var n1=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,d=i.length>0?parseInt(i,10)|0:0;return o?d+=t.c:--d,c?u+=t.r:--u,s+(o?"":"$")+oa(d)+(c?"":"$")+La(u)}return function(s,a){return t=a,s.replace(e,r)}})(),QE=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,ZE=(function(){return function(t,r){return t.replace(QE,function(n,s,a,i,o,c){var u=BE(i)-(a?0:r.c),d=LE(c)-(o?0:r.r),f=d==0?"":o?d+1:"["+d+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+f+"C"+h})}})();function TK(e,t){return e.replace(QE,function(r,n,s,a,i,o){return n+(s=="$"?s+a:oa(BE(a)+t.c))+(i=="$"?i+o:La(LE(o)+t.r))})}function $2e(e,t,r){var n=Tl(t),s=n.s,a=la(r),i={r:a.r-s.r,c:a.c-s.c};return TK(e,i)}function U2e(e){return e.length!=1}function $D(e){return e.replace(/_xlfn\./g,"")}function Va(e){e.l+=1}function fh(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function NK(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return EK(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=fh(e),o=fh(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function EK(e){var t=fh(e),r=fh(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function z2e(e,t,r){if(r.biff<8)return EK(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=fh(e),i=fh(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function AK(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return W2e(e);var n=e.read_shift(r&&r.biff==12?4:2),s=fh(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function W2e(e){var t=fh(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function H2e(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function G2e(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return V2e(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function V2e(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function q2e(e,t,r){var n=(e[e.l++]&96)>>5,s=NK(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function K2e(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=NK(e,a,r);return[n,s,i]}function Y2e(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function X2e(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function J2e(e,t,r){var n=(e[e.l++]&96)>>5,s=z2e(e,t-1,r);return[n,s]}function Q2e(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function UD(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Z2e(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function ebe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function tbe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function rbe(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function nbe(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function jK(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function sbe(e){return e.read_shift(2),jK(e)}function abe(e){return e.read_shift(2),jK(e)}function ibe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=AK(e,0,r);return[n,s]}function obe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=G2e(e,0,r);return[n,s]}function lbe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=AK(e,0,r);return[n,s,a]}function cbe(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[fwe[s],MK[s],n]}function ube(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:dbe(e);return[s,(a[0]===0?MK:dwe)[a[1]]]}function dbe(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fbe(e,t,r){e.l+=r&&r.biff==2?3:4}function hbe(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function mbe(e){return e.l++,B0[e.read_shift(1)]}function gbe(e){return e.l++,e.read_shift(2)}function pbe(e){return e.l++,e.read_shift(1)!==0}function xbe(e){return e.l++,So(e)}function ybe(e,t,r){return e.l++,tb(e,t-1,r)}function vbe(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ma(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=B0[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=So(e);break;case 2:r[1]=_g(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function bbe(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?wg:s3)(e));return s}function wbe(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=vbe(e,r.biff);return i}function _be(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function Sbe(e,t,r){if(r.biff==5)return kbe(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function kbe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Cbe(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Tbe(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function Nbe(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Ebe(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var Abe=jo,jbe=jo,Pbe=jo;function nb(e,t,r){return e.l+=2,[H2e(e)]}function eA(e){return e.l+=6,[]}var Fbe=nb,Mbe=eA,Rbe=eA,Obe=nb;function PK(e){return e.l+=2,[Ka(e),e.read_shift(2)&1]}var Dbe=nb,Ibe=PK,Lbe=eA,Bbe=nb,$be=nb,Ube=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zbe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=Ube[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function Wbe(e){return e.l+=2,[e.read_shift(4)]}function Hbe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Gbe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Vbe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function qbe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Kbe(e){return e.l+=4,[0,0]}var zD={1:{n:"PtgExp",f:hbe},2:{n:"PtgTbl",f:Pbe},3:{n:"PtgAdd",f:Va},4:{n:"PtgSub",f:Va},5:{n:"PtgMul",f:Va},6:{n:"PtgDiv",f:Va},7:{n:"PtgPower",f:Va},8:{n:"PtgConcat",f:Va},9:{n:"PtgLt",f:Va},10:{n:"PtgLe",f:Va},11:{n:"PtgEq",f:Va},12:{n:"PtgGe",f:Va},13:{n:"PtgGt",f:Va},14:{n:"PtgNe",f:Va},15:{n:"PtgIsect",f:Va},16:{n:"PtgUnion",f:Va},17:{n:"PtgRange",f:Va},18:{n:"PtgUplus",f:Va},19:{n:"PtgUminus",f:Va},20:{n:"PtgPercent",f:Va},21:{n:"PtgParen",f:Va},22:{n:"PtgMissArg",f:Va},23:{n:"PtgStr",f:ybe},26:{n:"PtgSheet",f:Hbe},27:{n:"PtgEndSheet",f:Gbe},28:{n:"PtgErr",f:mbe},29:{n:"PtgBool",f:pbe},30:{n:"PtgInt",f:gbe},31:{n:"PtgNum",f:xbe},32:{n:"PtgArray",f:Q2e},33:{n:"PtgFunc",f:cbe},34:{n:"PtgFuncVar",f:ube},35:{n:"PtgName",f:_be},36:{n:"PtgRef",f:ibe},37:{n:"PtgArea",f:q2e},38:{n:"PtgMemArea",f:Cbe},39:{n:"PtgMemErr",f:Abe},40:{n:"PtgMemNoMem",f:jbe},41:{n:"PtgMemFunc",f:Tbe},42:{n:"PtgRefErr",f:Nbe},43:{n:"PtgAreaErr",f:Y2e},44:{n:"PtgRefN",f:obe},45:{n:"PtgAreaN",f:J2e},46:{n:"PtgMemAreaN",f:Vbe},47:{n:"PtgMemNoMemN",f:qbe},57:{n:"PtgNameX",f:Sbe},58:{n:"PtgRef3d",f:lbe},59:{n:"PtgArea3d",f:K2e},60:{n:"PtgRefErr3d",f:Ebe},61:{n:"PtgAreaErr3d",f:X2e},255:{}},Ybe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Xbe={1:{n:"PtgElfLel",f:PK},2:{n:"PtgElfRw",f:Bbe},3:{n:"PtgElfCol",f:Fbe},6:{n:"PtgElfRwV",f:$be},7:{n:"PtgElfColV",f:Obe},10:{n:"PtgElfRadical",f:Dbe},11:{n:"PtgElfRadicalS",f:Lbe},13:{n:"PtgElfColS",f:Mbe},15:{n:"PtgElfColSV",f:Rbe},16:{n:"PtgElfRadicalLel",f:Ibe},25:{n:"PtgList",f:zbe},29:{n:"PtgSxName",f:Wbe},255:{}},Jbe={0:{n:"PtgAttrNoop",f:Kbe},1:{n:"PtgAttrSemi",f:nbe},2:{n:"PtgAttrIf",f:tbe},4:{n:"PtgAttrChoose",f:Z2e},8:{n:"PtgAttrGoto",f:ebe},16:{n:"PtgAttrSum",f:fbe},32:{n:"PtgAttrBaxcel",f:UD},33:{n:"PtgAttrBaxcel",f:UD},64:{n:"PtgAttrSpace",f:sbe},65:{n:"PtgAttrSpaceSemi",f:abe},128:{n:"PtgAttrIfError",f:rbe},255:{}};function sb(e,t,r,n){if(n.biff<8)return jo(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=wbe(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=bbe(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(jo(e,t)),a}function ab(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=zD[a]||zD[Ybe[a]],(a===24||a===25)&&(s=(a===24?Xbe:Jbe)[e[e.l+1]]),!s||!s.f?jo(e,t):i.push([s.n,s.f(e,t,r)]);return i}function Qbe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var Zbe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function ewe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function FK(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function WD(e,t,r){var n=FK(e,t,r);return n=="#REF"?n:ewe(n,r)}function bo(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0}},o=[],c,u,d,f=0,h=0,g,p="";if(!e[0]||!e[0][0])return"";for(var x=-1,v="",C=0,b=e[0].length;C<b;++C){var _=e[0][C];switch(_[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),x>=0){switch(e[0][x][1][0]){case 0:v=_a(" ",e[0][x][1][1]);break;case 1:v=_a("\r",e[0][x][1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}u=u+v,x=-1}o.push(u+Zbe[_[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Nv(_[1][1],i,s),o.push(Ev(d,a));break;case"PtgRefN":d=r?Nv(_[1][1],r,s):_[1][1],o.push(Ev(d,a));break;case"PtgRef3d":f=_[1][1],d=Nv(_[1][2],i,s),p=WD(n,f,s),o.push(p+"!"+Ev(d,a));break;case"PtgFunc":case"PtgFuncVar":var T=_[1][0],N=_[1][1];T||(T=0),T&=127;var E=T==0?[]:o.slice(-T);o.length-=T,N==="User"&&(N=E.shift()),o.push(N+"("+E.join(",")+")");break;case"PtgBool":o.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(_[1]);break;case"PtgNum":o.push(String(_[1]));break;case"PtgStr":o.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(_[1]);break;case"PtgAreaN":g=yD(_[1][1],r?{s:r}:i,s),o.push(R6(g,s));break;case"PtgArea":g=yD(_[1][1],i,s),o.push(R6(g,s));break;case"PtgArea3d":f=_[1][1],g=_[1][2],p=WD(n,f,s),o.push(p+"!"+R6(g,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=_[1][2];var F=(n.names||[])[h-1]||(n[0]||[])[h],j=F?F.Name:"SH33TJSNAME"+String(h);j&&j.slice(0,6)=="_xlfn."&&!s.xlfn&&(j=j.slice(6)),o.push(j);break;case"PtgNameX":var P=_[1][1];h=_[1][2];var M;if(s.biff<=5)P<0&&(P=-P),n[P]&&(M=n[P][h]);else{var I="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][h]&&n[P][h].itab>0&&(I=n.SheetNames[n[P][h].itab-1]+"!"):I=n.SheetNames[h-1]+"!"),n[P]&&n[P][h])I+=n[P][h].Name;else if(n[0]&&n[0][h])I+=n[0][h].Name;else{var U=(FK(n,P,s)||"").split(";;");U[h-1]?I=U[h-1]:I+="SH33TJSERRX"}o.push(I);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var K="(",te=")";if(x>=0){switch(v="",e[0][x][1][0]){case 2:K=_a(" ",e[0][x][1][1])+K;break;case 3:K=_a("\r",e[0][x][1][1])+K;break;case 4:te=_a(" ",e[0][x][1][1])+te;break;case 5:te=_a("\r",e[0][x][1][1])+te;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][x][1][0])}x=-1}o.push(K+o.pop()+te);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":d={c:_[1][1],r:_[1][0]};var re={c:r.c,r:r.r};if(n.sharedf[cn(d)]){var Z=n.sharedf[cn(d)];o.push(bo(Z,i,re,n,s))}else{var B=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(d.c<u[0].s.c||d.c>u[0].e.c)&&!(d.r<u[0].s.r||d.r>u[0].e.r)){o.push(bo(u[1],i,re,n,s)),B=!0;break}B||o.push(_[1])}break;case"PtgArray":o.push("{"+Qbe(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=C;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var J=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&J.indexOf(e[0][C][0])==-1){_=e[0][x];var z=!0;switch(_[1][0]){case 4:z=!1;case 0:v=_a(" ",_[1][1]);break;case 5:z=!1;case 1:v=_a("\r",_[1][1]);break;default:if(v="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}o.push((z?v:"")+o.pop()+(z?"":v)),x=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function twe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],jo(e,t-2)];var o=ab(e,i,r);return t!==i+s&&(a=sb(e,t-i-s,o,r)),e.l=n,[o,a]}function rwe(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],jo(e,t-2)];var o=ab(e,i,r);return t!==i+s&&(a=sb(e,t-i-s,o,r)),e.l=n,[o,a]}function nwe(e,t,r,n){var s=e.l+t,a=ab(e,n,r),i;return s!==e.l&&(i=sb(e,s-e.l,a,r)),[a,i]}function swe(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=ab(e,a,r);return a==65535?[[],jo(e,t-2)]:(t!==a+2&&(s=sb(e,n-a-2,i,r)),[i,s])}function awe(e){var t;if(u0(e,e.l+6)!==65535)return[So(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function iwe(e){if(e==null){var t=Ht(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return tg(e);return tg(0)}function B6(e,t,r){var n=e.l+t,s=_d(e);r.biff==2&&++e.l;var a=awe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=rwe(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function owe(e,t,r,n,s){var a=ng(t,r,s),i=iwe(e.v),o=Ht(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=Ht(e.bf.length),d=0;d<e.bf.length;++d)u[d]=e.bf[d];var f=Fi([a,i,o,u]);return f}function a3(e,t,r){var n=e.read_shift(4),s=ab(e,n,r),a=e.read_shift(4),i=a>0?sb(e,a,s,r):null;return[s,i]}var lwe=a3,i3=a3,cwe=a3,uwe=a3,dwe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},MK={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fwe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function HD(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function hwe(e){var t="of:="+e.replace(QE,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function $6(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function mwe(e){return e.replace(/\./,"!")}var jv={},s1={},Pv=typeof Map<"u";function tA(e,t,r){var n=0,s=e.length;if(r){if(Pv?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=Pv?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(Pv?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function o3(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(wo=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=f2(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=D_(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Om(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ch(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){x0(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function RK(e,t,r,n,s,a){try{n.cellNF&&(e.z=on[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Hs(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(on[t]==null&&x0(dpe[t]||"General",t),e.t==="e")e.w=e.w||B0[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=a2(e.v);else if(e.t==="d"){var i=gi(e.v);(i|0)===i?e.w=i.toString(10):e.w=a2(i)}else{if(e.v===void 0)return"";e.w=Zm(e.v,s1)}else e.t==="d"?e.w=Bc(t,gi(e.v),s1):e.w=Bc(t,e.v,s1)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=O_(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=O_(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function gwe(e,t,r){if(e&&e["!ref"]){var n=Vn(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function pwe(e,t){var r=Vn(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Tn(r))}var xwe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,ywe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,vwe=/<(?:\w:)?hyperlink [^>]*>/mg,bwe=/"(\w*:\w*)"/,wwe=/<(?:\w:)?col\b[^>]*[\/]?>/g,_we=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Swe=/<(?:\w:)?pageMargins[^>]*\/>/g,OK=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kwe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Cwe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Twe(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",d="",f=e.match(ywe);f?(u=e.slice(0,f.index),d=e.slice(f.index+f[0].length)):u=d=e;var h=u.match(OK);h?rA(h[0],o,s,r):(h=u.match(kwe))&&Ewe(h[0],h[1]||"",o,s,r);var g=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var p=u.slice(g,g+50).match(bwe);p&&pwe(o,p[1])}var x=u.match(Cwe);x&&x[1]&&Uwe(x[1],s);var v=[];if(t.cellStyles){var C=u.match(wwe);C&&Dwe(v,C)}f&&Hwe(f[1],o,t,c,a,i);var b=d.match(_we);b&&(o["!autofilter"]=Lwe(b[0]));var _=[],T=d.match(xwe);if(T)for(g=0;g!=T.length;++g)_[g]=Vn(T[g].slice(T[g].indexOf('"')+1));var N=d.match(vwe);N&&Mwe(o,N,n);var E=d.match(Swe);if(E&&(o["!margins"]=Rwe(fn(E[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Tn(c)),t.sheetRows>0&&o["!ref"]){var F=Vn(o["!ref"]);t.sheetRows<=+F.e.r&&(F.e.r=t.sheetRows-1,F.e.r>c.e.r&&(F.e.r=c.e.r),F.e.r<F.s.r&&(F.s.r=F.e.r),F.e.c>c.e.c&&(F.e.c=c.e.c),F.e.c<F.s.c&&(F.s.c=F.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Tn(F))}return v.length>0&&(o["!cols"]=v),_.length>0&&(o["!merges"]=_),o}function Nwe(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Tn(e[r])+'"/>';return t+"</mergeCells>"}function rA(e,t,r,n){var s=fn(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Hn(bs(s.codeName)))}function Ewe(e,t,r,n,s){rA(e.slice(0,e.indexOf(">")),r,n,s)}function Awe(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=id(ms(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+pr("outlinePr",null,u)}!a&&!o||(s[s.length]=pr("sheetPr",o,i))}var jwe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Pwe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Fwe(e){var t={sheet:1};return jwe.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Pwe.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=YE(e.password).toString(16).toUpperCase()),pr("sheetProtection",null,t)}function Mwe(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=fn(bs(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Hn(a.location))):(a.Target="#"+Hn(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Vn(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var d=cn({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=a)}}}function Rwe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Owe(e){return Om(e),pr("pageMargins",null,e)}function Dwe(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=fn(t[n],!0);s.hidden&&(s.hidden=Us(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,XE(s.width)),dh(s);a<=i;)e[a++]=Gs(s)}}function Iwe(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=pr("col",null,o3(s,n)));return r[r.length]="</cols>",r.join("")}function Lwe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function Bwe(e,t,r,n){var s=typeof e.ref=="string"?e.ref:Tn(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=Tl(s);i.s.r==i.e.r&&(i.e.r=Tl(t["!ref"]).e.r,s=Tn(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),pr("autoFilter",null,{ref:s})}var $we=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Uwe(e,t){t.Views||(t.Views=[{}]),(e.match($we)||[]).forEach(function(r,n){var s=fn(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),Us(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function zwe(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),pr("sheetViews",pr("sheetView",null,s),{})}function Wwe(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=B0[e.v];break;case"d":n&&n.cellDates?s=Hs(e.v,-1).toISOString():(e=Gs(e),e.t="n",s=""+(e.v=gi(Hs(e.v)))),typeof e.z>"u"&&(e.z=on[14]);break;default:s=e.v;break}var o=no("v",ms(s)),c={r:t},u=Ch(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=no("v",""+tA(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var d=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=pr("f",ms(e.f),d)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),pr("c",o,c)}var Hwe=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=i2("v"),i=i2("f");return function(c,u,d,f,h,g){for(var p=0,x="",v=[],C=[],b=0,_=0,T=0,N="",E,F,j=0,P=0,M,I,U=0,K=0,te=Array.isArray(g.CellXf),re,Z=[],B=[],J=Array.isArray(u),z=[],q={},H=!1,R=!!d.sheetStubs,L=c.split(t),G=0,W=L.length;G!=W;++G){x=L[G].trim();var Q=x.length;if(Q!==0){var X=0;e:for(p=0;p<Q;++p)switch(x[p]){case">":if(x[p-1]!="/"){++p;break e}if(d&&d.cellStyles){if(F=fn(x.slice(X,p),!0),j=F.r!=null?parseInt(F.r,10):j+1,P=-1,d.sheetRows&&d.sheetRows<j)continue;q={},H=!1,F.ht&&(H=!0,q.hpt=parseFloat(F.ht),q.hpx=v1(q.hpt)),F.hidden=="1"&&(H=!0,q.hidden=!0),F.outlineLevel!=null&&(H=!0,q.level=+F.outlineLevel),H&&(z[j-1]=q)}break;case"<":X=p;break}if(X>=p)break;if(F=fn(x.slice(X,p),!0),j=F.r!=null?parseInt(F.r,10):j+1,P=-1,!(d.sheetRows&&d.sheetRows<j)){f.s.r>j-1&&(f.s.r=j-1),f.e.r<j-1&&(f.e.r=j-1),d&&d.cellStyles&&(q={},H=!1,F.ht&&(H=!0,q.hpt=parseFloat(F.ht),q.hpx=v1(q.hpt)),F.hidden=="1"&&(H=!0,q.hidden=!0),F.outlineLevel!=null&&(H=!0,q.level=+F.outlineLevel),H&&(z[j-1]=q)),v=x.slice(p).split(e);for(var se=0;se!=v.length&&v[se].trim().charAt(0)=="<";++se);for(v=v.slice(se),p=0;p!=v.length;++p)if(x=v[p].trim(),x.length!==0){if(C=x.match(r),b=p,_=0,T=0,x="<c "+(x.slice(0,1)=="<"?">":"")+x,C!=null&&C.length===2){for(b=0,N=C[1],_=0;_!=N.length&&!((T=N.charCodeAt(_)-64)<1||T>26);++_)b=26*b+T;--b,P=b}else++P;for(_=0;_!=x.length&&x.charCodeAt(_)!==62;++_);if(++_,F=fn(x.slice(0,_),!0),F.r||(F.r=cn({r:j-1,c:P})),N=x.slice(_),E={t:""},(C=N.match(a))!=null&&C[1]!==""&&(E.v=Hn(C[1])),d.cellFormula){if((C=N.match(i))!=null&&C[1]!==""){if(E.f=Hn(bs(C[1])).replace(/\r\n/g,`
`),d.xlfn||(E.f=$D(E.f)),C[0].indexOf('t="array"')>-1)E.F=(N.match(s)||[])[1],E.F.indexOf(":")>-1&&Z.push([Vn(E.F),E.F]);else if(C[0].indexOf('t="shared"')>-1){I=fn(C[0]);var le=Hn(bs(C[1]));d.xlfn||(le=$D(le)),B[parseInt(I.si,10)]=[I,le,F.r]}}else(C=N.match(/<f[^>]*\/>/))&&(I=fn(C[0]),B[I.si]&&(E.f=$2e(B[I.si][1],B[I.si][2],F.r)));var he=la(F.r);for(_=0;_<Z.length;++_)he.r>=Z[_][0].s.r&&he.r<=Z[_][0].e.r&&he.c>=Z[_][0].s.c&&he.c<=Z[_][0].e.c&&(E.F=Z[_][1])}if(F.t==null&&E.v===void 0)if(E.f||E.F)E.v=0,E.t="n";else if(R)E.t="z";else continue;else E.t=F.t||"n";switch(f.s.c>P&&(f.s.c=P),f.e.c<P&&(f.e.c=P),E.t){case"n":if(E.v==""||E.v==null){if(!R)continue;E.t="z"}else E.v=parseFloat(E.v);break;case"s":if(typeof E.v>"u"){if(!R)continue;E.t="z"}else M=jv[parseInt(E.v,10)],E.v=M.t,E.r=M.r,d.cellHTML&&(E.h=M.h);break;case"str":E.t="s",E.v=E.v!=null?bs(E.v):"",d.cellHTML&&(E.h=RE(E.v));break;case"inlineStr":C=N.match(n),E.t="s",C!=null&&(M=KE(C[1]))?(E.v=M.t,d.cellHTML&&(E.h=M.h)):E.v="";break;case"b":E.v=Us(E.v);break;case"d":d.cellDates?E.v=Hs(E.v,1):(E.v=gi(Hs(E.v,1)),E.t="n");break;case"e":(!d||d.cellText!==!1)&&(E.w=E.v),E.v=Iq[E.v];break}if(U=K=0,re=null,te&&F.s!==void 0&&(re=g.CellXf[F.s],re!=null&&(re.numFmtId!=null&&(U=re.numFmtId),d.cellStyles&&re.fillId!=null&&(K=re.fillId))),RK(E,U,K,d,h,g),d.cellDates&&te&&E.t=="n"&&K1(on[U])&&(E.t="d",E.v=n3(E.v)),F.cm&&d.xlmeta){var we=(d.xlmeta.Cell||[])[+F.cm-1];we&&we.type=="XLDAPR"&&(E.D=!0)}if(J){var ie=la(F.r);u[ie.r]||(u[ie.r]=[]),u[ie.r][ie.c]=E}else u[F.r]=E}}}}z.length>0&&(u["!rows"]=z)}})();function Gwe(e,t,r,n){var s=[],a=[],i=Vn(e["!ref"]),o="",c,u="",d=[],f=0,h=0,g=e["!rows"],p=Array.isArray(e),x={r:u},v,C=-1;for(h=i.s.c;h<=i.e.c;++h)d[h]=oa(h);for(f=i.s.r;f<=i.e.r;++f){for(a=[],u=La(f),h=i.s.c;h<=i.e.c;++h){c=d[h]+u;var b=p?(e[f]||[])[h]:e[c];b!==void 0&&(o=Wwe(b,c,e,t))!=null&&a.push(o)}(a.length>0||g&&g[f])&&(x={r:u},g&&g[f]&&(v=g[f],v.hidden&&(x.hidden=1),C=-1,v.hpx?C=h2(v.hpx):v.hpt&&(C=v.hpt),C>-1&&(x.ht=C,x.customHeight=1),v.level&&(x.outlineLevel=v.level)),s[s.length]=pr("row",a.join(""),x))}if(g)for(;f<g.length;++f)g&&g[f]&&(x={r:f+1},v=g[f],v.hidden&&(x.hidden=1),C=-1,v.hpx?C=h2(v.hpx):v.hpt&&(C=v.hpt),C>-1&&(x.ht=C,x.customHeight=1),v.level&&(x.outlineLevel=v.level),s[s.length]=pr("row","",x));return s.join("")}function DK(e,t,r,n){var s=[Ua,pr("worksheet",null,{xmlns:xg[0],"xmlns:r":fi.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",d=Vn(u);if(d.e.c>16383||d.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),u=Tn(d)}n||(n={}),c["!comments"]=[];var f=[];Awe(c,r,e,t,s),s[s.length]=pr("dimension",null,{ref:u}),s[s.length]=zwe(c,t,e,r),t.sheetFormat&&(s[s.length]=pr("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=Iwe(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=Gwe(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=Fwe(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=Bwe(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=Nwe(c["!merges"]));var h=-1,g,p=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(g={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=ds(n,-1,ms(x[1].Target).replace(/#.*$/,""),In.HLINK),g["r:id"]="rId"+p),(h=x[1].Target.indexOf("#"))>-1&&(g.location=ms(x[1].Target.slice(h+1))),x[1].Tooltip&&(g.tooltip=ms(x[1].Tooltip)),s[s.length]=pr("hyperlink",null,g))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=Owe(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=no("ignoredErrors",pr("ignoredError",null,{numberStoredAsText:1,sqref:u}))),f.length>0&&(p=ds(n,-1,"../drawings/drawing"+(e+1)+".xml",In.DRAW),s[s.length]=pr("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=ds(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",In.VML),s[s.length]=pr("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Vwe(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function qwe(e,t,r){var n=Ht(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=h2(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},d=0;d<16;++d)if(!(t.s.c>d+1<<10||t.e.c<d<<10)){for(var f=-1,h=-1,g=d<<10;g<d+1<<10;++g){u.c=g;var p=Array.isArray(r)?(r[u.r]||[])[u.c]:r[cn(u)];p&&(f<0&&(f=g),h=g)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,h))}var x=n.l;return n.l=c,n.write_shift(4,o),n.l=x,n.length>n.l?n.slice(0,n.l):n}function Kwe(e,t,r,n){var s=qwe(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&Xt(e,0,s)}var Ywe=wg,Xwe=J1;function Jwe(){}function Qwe(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=t1e(e),r}function Zwe(e,t,r){r==null&&(r=Ht(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return F_({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Fq(e,r),r.slice(0,r.l)}function e4e(e){var t=Wc(e);return[t]}function t4e(e,t,r){return r==null&&(r=Ht(8)),yg(t,r)}function r4e(e){var t=vg(e);return[t]}function n4e(e,t,r){return r==null&&(r=Ht(4)),bg(t,r)}function s4e(e){var t=Wc(e),r=e.read_shift(1);return[t,r,"b"]}function a4e(e,t,r){return r==null&&(r=Ht(9)),yg(t,r),r.write_shift(1,e.v?1:0),r}function i4e(e){var t=vg(e),r=e.read_shift(1);return[t,r,"b"]}function o4e(e,t,r){return r==null&&(r=Ht(5)),bg(t,r),r.write_shift(1,e.v?1:0),r}function l4e(e){var t=Wc(e),r=e.read_shift(1);return[t,r,"e"]}function c4e(e,t,r){return r==null&&(r=Ht(9)),yg(t,r),r.write_shift(1,e.v),r}function u4e(e){var t=vg(e),r=e.read_shift(1);return[t,r,"e"]}function d4e(e,t,r){return r==null&&(r=Ht(8)),bg(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function f4e(e){var t=Wc(e),r=e.read_shift(4);return[t,r,"s"]}function h4e(e,t,r){return r==null&&(r=Ht(12)),yg(t,r),r.write_shift(4,t.v),r}function m4e(e){var t=vg(e),r=e.read_shift(4);return[t,r,"s"]}function g4e(e,t,r){return r==null&&(r=Ht(8)),bg(t,r),r.write_shift(4,t.v),r}function p4e(e){var t=Wc(e),r=So(e);return[t,r,"n"]}function x4e(e,t,r){return r==null&&(r=Ht(16)),yg(t,r),tg(e.v,r),r}function IK(e){var t=vg(e),r=So(e);return[t,r,"n"]}function y4e(e,t,r){return r==null&&(r=Ht(12)),bg(t,r),tg(e.v,r),r}function v4e(e){var t=Wc(e),r=WE(e);return[t,r,"n"]}function b4e(e,t,r){return r==null&&(r=Ht(12)),yg(t,r),Mq(e.v,r),r}function w4e(e){var t=vg(e),r=WE(e);return[t,r,"n"]}function _4e(e,t,r){return r==null&&(r=Ht(8)),bg(t,r),Mq(e.v,r),r}function S4e(e){var t=Wc(e),r=$E(e);return[t,r,"is"]}function k4e(e){var t=Wc(e),r=Eo(e);return[t,r,"str"]}function C4e(e,t,r){return r==null&&(r=Ht(12+4*e.v.length)),yg(t,r),Mi(e.v,r),r.length>r.l?r.slice(0,r.l):r}function T4e(e){var t=vg(e),r=Eo(e);return[t,r,"str"]}function N4e(e,t,r){return r==null&&(r=Ht(8+4*e.v.length)),bg(t,r),Mi(e.v,r),r.length>r.l?r.slice(0,r.l):r}function E4e(e,t,r){var n=e.l+t,s=Wc(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=i3(e,n-e.l,r);i[3]=bo(o,null,s,r.supbooks,r)}else e.l=n;return i}function A4e(e,t,r){var n=e.l+t,s=Wc(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=i3(e,n-e.l,r);i[3]=bo(o,null,s,r.supbooks,r)}else e.l=n;return i}function j4e(e,t,r){var n=e.l+t,s=Wc(e);s.r=r["!row"];var a=So(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=i3(e,n-e.l,r);i[3]=bo(o,null,s,r.supbooks,r)}else e.l=n;return i}function P4e(e,t,r){var n=e.l+t,s=Wc(e);s.r=r["!row"];var a=Eo(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=i3(e,n-e.l,r);i[3]=bo(o,null,s,r.supbooks,r)}else e.l=n;return i}var F4e=wg,M4e=J1;function R4e(e,t){return t==null&&(t=Ht(4)),t.write_shift(4,e),t}function O4e(e,t){var r=e.l+t,n=wg(e),s=UE(e),a=Eo(e),i=Eo(e),o=Eo(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function D4e(e,t){var r=Ht(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));J1({s:la(e[0]),e:la(e[0])},r),zE("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return Mi(s||"",r),Mi(e[1].Tooltip||"",r),Mi("",r),r.slice(0,r.l)}function I4e(){}function L4e(e,t,r){var n=e.l+t,s=Rq(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=lwe(e,n-e.l,r);i[1]=o}else e.l=n;return i}function B4e(e,t,r){var n=e.l+t,s=wg(e),a=[s];if(r.cellFormula){var i=uwe(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function $4e(e,t,r){r==null&&(r=Ht(18));var n=o3(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var LK=["left","right","top","bottom","header","footer"];function U4e(e){var t={};return LK.forEach(function(r){t[r]=So(e)}),t}function z4e(e,t){return t==null&&(t=Ht(48)),Om(e),LK.forEach(function(r){tg(e[r],t)}),t}function W4e(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function H4e(e,t,r){r==null&&(r=Ht(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function G4e(e){var t=Ht(24);return t.write_shift(4,4),t.write_shift(4,1),J1(e,t),t}function V4e(e,t){return t==null&&(t=Ht(66)),t.write_shift(2,e.password?YE(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function q4e(){}function K4e(){}function Y4e(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,d={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=!1,h=!1,g,p,x,v,C,b,_,T,N,E=[];o.biff=12,o["!row"]=0;var F=0,j=!1,P=[],M={},I=o.supbooks||s.supbooks||[[]];if(I.sharedf=M,I.arrayf=P,I.SheetNames=s.SheetNames||s.Sheets.map(function(J){return J.name}),!o.supbooks&&(o.supbooks=I,s.Names))for(var U=0;U<s.Names.length;++U)I[0][U+1]=s.Names[U];var K=[],te=[],re=!1;m2[16]={n:"BrtShortReal",f:IK};var Z;if(L0(e,function(z,q,H){if(!h)switch(H){case 148:u=z;break;case 0:g=z,o.sheetRows&&o.sheetRows<=g.r&&(h=!0),T=La(v=g.r),o["!row"]=g.r,(z.hidden||z.hpt||z.level!=null)&&(z.hpt&&(z.hpx=v1(z.hpt)),te[z.r]=z);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:z[2]},z[2]){case"n":p.v=z[1];break;case"s":_=jv[z[1]],p.v=_.t,p.r=_.r;break;case"b":p.v=!!z[1];break;case"e":p.v=z[1],o.cellText!==!1&&(p.w=B0[p.v]);break;case"str":p.t="s",p.v=z[1];break;case"is":p.t="s",p.v=z[1].t;break}if((x=i.CellXf[z[0].iStyleRef])&&RK(p,x.numFmtId,null,o,a,i),C=z[0].c==-1?C+1:z[0].c,o.dense?(c[v]||(c[v]=[]),c[v][C]=p):c[oa(C)+T]=p,o.cellFormula){for(j=!1,F=0;F<P.length;++F){var R=P[F];g.r>=R[0].s.r&&g.r<=R[0].e.r&&C>=R[0].s.c&&C<=R[0].e.c&&(p.F=Tn(R[0]),j=!0)}!j&&z.length>3&&(p.f=z[3])}if(d.s.r>g.r&&(d.s.r=g.r),d.s.c>C&&(d.s.c=C),d.e.r<g.r&&(d.e.r=g.r),d.e.c<C&&(d.e.c=C),o.cellDates&&x&&p.t=="n"&&K1(on[x.numFmtId])){var L=wm(p.v);L&&(p.t="d",p.v=new Date(L.y,L.m-1,L.d,L.H,L.M,L.S,L.u))}Z&&(Z.type=="XLDAPR"&&(p.D=!0),Z=void 0);break;case 1:case 12:if(!o.sheetStubs||f)break;p={t:"z",v:void 0},C=z[0].c==-1?C+1:z[0].c,o.dense?(c[v]||(c[v]=[]),c[v][C]=p):c[oa(C)+T]=p,d.s.r>g.r&&(d.s.r=g.r),d.s.c>C&&(d.s.c=C),d.e.r<g.r&&(d.e.r=g.r),d.e.c<C&&(d.e.c=C),Z&&(Z.type=="XLDAPR"&&(p.D=!0),Z=void 0);break;case 176:E.push(z);break;case 49:Z=((o.xlmeta||{}).Cell||[])[z-1];break;case 494:var G=n["!id"][z.relId];for(G?(z.Target=G.Target,z.loc&&(z.Target+="#"+z.loc),z.Rel=G):z.relId==""&&(z.Target="#"+z.loc),v=z.rfx.s.r;v<=z.rfx.e.r;++v)for(C=z.rfx.s.c;C<=z.rfx.e.c;++C)o.dense?(c[v]||(c[v]=[]),c[v][C]||(c[v][C]={t:"z",v:void 0}),c[v][C].l=z):(b=cn({c:C,r:v}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=z);break;case 426:if(!o.cellFormula)break;P.push(z),N=o.dense?c[v][C]:c[oa(C)+T],N.f=bo(z[1],d,{r:g.r,c:C},I,o),N.F=Tn(z[0]);break;case 427:if(!o.cellFormula)break;M[cn(z[0].s)]=z[1],N=o.dense?c[v][C]:c[oa(C)+T],N.f=bo(z[1],d,{r:g.r,c:C},I,o);break;case 60:if(!o.cellStyles)break;for(;z.e>=z.s;)K[z.e--]={width:z.w/256,hidden:!!(z.flags&1),level:z.level},re||(re=!0,XE(z.w/256)),dh(K[z.e+1]);break;case 161:c["!autofilter"]={ref:Tn(z)};break;case 476:c["!margins"]=z;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),z.name&&(s.Sheets[r].CodeName=z.name),(z.above||z.left)&&(c["!outline"]={above:z.above,left:z.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),z.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:f=!0;break;case 36:f=!1;break;case 37:f=!0;break;case 38:f=!1;break;default:if(!q.T){if(!f||o.WTF)throw new Error("Unexpected record 0x"+H.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(d.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=Tn(u||d)),o.sheetRows&&c["!ref"]){var B=Vn(c["!ref"]);o.sheetRows<=+B.e.r&&(B.e.r=o.sheetRows-1,B.e.r>d.e.r&&(B.e.r=d.e.r),B.e.r<B.s.r&&(B.s.r=B.e.r),B.e.c>d.e.c&&(B.e.c=d.e.c),B.e.c<B.s.c&&(B.s.c=B.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Tn(B))}return E.length>0&&(c["!merges"]=E),K.length>0&&(c["!cols"]=K),te.length>0&&(c["!rows"]=te),c}function X4e(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Gs(t),t.z=t.z||on[14],t.v=gi(Hs(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Ch(s.cellXfs,t,s),t.l&&a["!links"].push([cn(c),t.l]),t.c&&a["!comments"].push([cn(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=tA(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?Xt(e,18,g4e(t,c)):Xt(e,7,h4e(t,c))):(c.t="str",i?Xt(e,17,N4e(t,c)):Xt(e,6,C4e(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?Xt(e,13,_4e(t,c)):Xt(e,2,b4e(t,c)):i?Xt(e,16,y4e(t,c)):Xt(e,5,x4e(t,c)),!0;case"b":return c.t="b",i?Xt(e,15,o4e(t,c)):Xt(e,4,a4e(t,c)),!0;case"e":return c.t="e",i?Xt(e,14,d4e(t,c)):Xt(e,3,c4e(t,c)),!0}return i?Xt(e,12,n4e(t,c)):Xt(e,1,t4e(t,c)),!0}function J4e(e,t,r,n){var s=Vn(t["!ref"]||"A1"),a,i="",o=[];Xt(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var d=s.s.r;d<=u;++d){i=La(d),Kwe(e,t,s,d);var f=!1;if(d<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){d===s.s.r&&(o[h]=oa(h)),a=o[h]+i;var g=c?(t[d]||[])[h]:t[a];if(!g){f=!1;continue}f=X4e(e,g,d,h,n,t,f)}}Xt(e,146)}function Q4e(e,t){!t||!t["!merges"]||(Xt(e,177,R4e(t["!merges"].length)),t["!merges"].forEach(function(r){Xt(e,176,M4e(r))}),Xt(e,178))}function Z4e(e,t){!t||!t["!cols"]||(Xt(e,390),t["!cols"].forEach(function(r,n){r&&Xt(e,60,$4e(n,r))}),Xt(e,391))}function e_e(e,t){!t||!t["!ref"]||(Xt(e,648),Xt(e,649,G4e(Vn(t["!ref"]))),Xt(e,650))}function t_e(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=ds(r,-1,n[1].Target.replace(/#.*$/,""),In.HLINK);Xt(e,494,D4e(n,s))}}),delete t["!links"]}function r_e(e,t,r,n){if(t["!comments"].length>0){var s=ds(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",In.VML);Xt(e,551,zE("rId"+s)),t["!legacy"]=s}}function n_e(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:Tn(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=Tl(a);o.s.r==o.e.r&&(o.e.r=Tl(t["!ref"]).e.r,a=Tn(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Xt(e,161,J1(Vn(a))),Xt(e,162)}}function s_e(e,t,r){Xt(e,133),Xt(e,137,H4e(t,r)),Xt(e,138),Xt(e,134)}function a_e(e,t){t["!protect"]&&Xt(e,535,V4e(t["!protect"]))}function i_e(e,t,r,n){var s=Sl(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Vn(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],Xt(s,129),(r.vbaraw||i["!outline"])&&Xt(s,147,Zwe(o,i["!outline"])),Xt(s,148,Xwe(c)),s_e(s,i,r.Workbook),Z4e(s,i),J4e(s,i,e,t),a_e(s,i),n_e(s,i,r,e),Q4e(s,i),t_e(s,i,n),i["!margins"]&&Xt(s,476,z4e(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&e_e(s,i),r_e(s,i,e,n),Xt(s,130),s.end()}function o_e(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Hn((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function l_e(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var h=o_e(f);d.s.r=d.s.c=0,d.e.c=o,u=oa(o),h[0].forEach(function(g,p){i[u+La(p)]={t:"n",v:g,z:h[1]},c=p}),d.e.r<c&&(d.e.r=c),++o}),o>0&&(i["!ref"]=Tn(d)),i}function c_e(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(OK);return o&&rA(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function u_e(e,t){e.l+=10;var r=Eo(e);return{name:r}}function d_e(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return L0(e,function(c,u,d){switch(d){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var nA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],f_e=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],h_e=[],m_e=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function GD(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=Us(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function VD(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Us(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function BK(e){VD(e.WBProps,nA),VD(e.CalcPr,m_e),GD(e.WBView,f_e),GD(e.Sheets,h_e),s1.date1904=Us(e.WBProps.date1904)}function g_e(e){return!e.Workbook||!e.Workbook.WBProps?"false":Us(e.Workbook.WBProps.date1904)?"true":"false"}var p_e="][*?/\\".split("");function $K(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return p_e.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function x_e(e,t,r){e.forEach(function(n,s){$K(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function y_e(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];x_e(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)gwe(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var v_e=/<\w+:workbook/;function b_e(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Po,function(c,u){var d=fn(c);switch(wd(d[0])){case"<?xml":break;case"<workbook":c.match(v_e)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=d[s];break;case"</workbook>":break;case"<fileVersion":delete d[0],r.AppVersion=d;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":nA.forEach(function(f){if(d[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Us(d[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(d[f[0]],10);break;default:r.WBProps[f[0]]=d[f[0]]}}),d.codeName&&(r.WBProps.CodeName=bs(d.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete d[0],r.WBView.push(d);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(d.state){case"hidden":d.Hidden=1;break;case"veryHidden":d.Hidden=2;break;default:d.Hidden=0}delete d.state,d.name=Hn(bs(d.name)),delete d[0],r.Sheets.push(d);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=bs(d.name),d.comment&&(a.Comment=d.comment),d.localSheetId&&(a.Sheet=+d.localSheetId),Us(d.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=Hn(bs(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete d[0],r.CalcPr=d;break;case"<calcPr/>":delete d[0],r.CalcPr=d;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in workbook")}return c}),xg.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return BK(r),r}function UK(e){var t=[Ua];t[t.length]=pr("workbook",null,{xmlns:xg[0],"xmlns:r":fi.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(nA.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=pr("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:ms(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=pr("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=pr("definedName",ms(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function w_e(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=d8(e),r.name=Eo(e),r}function __e(e,t){return t||(t=Ht(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),zE(e.strRelID,t),Mi(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function S_e(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Eo(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function k_e(e,t){t||(t=Ht(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Fq(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function C_e(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function T_e(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=r1e(e),i=cwe(e,0,r),o=UE(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function N_e(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],m2[16]={n:"BrtFRTArchID$",f:C_e},L0(e,function(c,u,d){switch(d){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=bo(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([d,c]):i[0]=[d,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(d),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(d),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+d.toString(16))}}},t),BK(r),r.Names=a,r.supbooks=i,r}function E_e(e,t){Xt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Xt(e,156,__e(s))}Xt(e,144)}function A_e(e,t){t||(t=Ht(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Mi("SheetJS",t),Mi(C_.version,t),Mi(C_.version,t),Mi("7262",t),t.length>t.l?t.slice(0,t.l):t}function j_e(e,t){t||(t=Ht(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function P_e(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(Xt(e,135),Xt(e,158,j_e(s)),Xt(e,136))}}function F_e(e,t){var r=Sl();return Xt(r,131),Xt(r,128,A_e()),Xt(r,153,k_e(e.Workbook&&e.Workbook.WBProps||null)),P_e(r,e),E_e(r,e),Xt(r,132),r.end()}function M_e(e,t,r){return t.slice(-4)===".bin"?N_e(e,r):b_e(e,r)}function R_e(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?Y4e(e,n,r,s,a,i,o):Twe(e,n,r,s,a,i,o)}function O_e(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?d_e(e,n,r,s,a):c_e(e,n,r,s,a)}function D_e(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?L2e():B2e()}function I_e(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?D2e():I2e()}function L_e(e,t,r,n){return t.slice(-4)===".bin"?Mve(e,r,n):wve(e,r,n)}function B_e(e,t,r){return wK(e,r)}function $_e(e,t,r){return t.slice(-4)===".bin"?$ye(e,r):Iye(e,r)}function U_e(e,t,r){return t.slice(-4)===".bin"?P2e(e,r):_2e(e,r)}function z_e(e,t,r){return t.slice(-4)===".bin"?v2e(e):x2e(e)}function W_e(e,t,r,n){return r.slice(-4)===".bin"?b2e(e,t,r,n):void 0}function H_e(e,t,r){return t.slice(-4)===".bin"?m2e(e,t,r):p2e(e,t,r)}function G_e(e,t,r){return(t.slice(-4)===".bin"?F_e:UK)(e)}function V_e(e,t,r,n,s){return(t.slice(-4)===".bin"?i_e:DK)(e,r,n,s)}function q_e(e,t,r){return(t.slice(-4)===".bin"?Wve:vK)(e,r)}function K_e(e,t,r){return(t.slice(-4)===".bin"?Wye:dK)(e,r)}function Y_e(e,t,r){return(t.slice(-4)===".bin"?F2e:kK)(e)}function X_e(e){return(e.slice(-4)===".bin"?g2e:_K)()}var zK=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,WK=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function cu(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(zK),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(WK),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function J_e(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(zK),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(WK),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var Fv;function Q_e(e,t){var r=Fv[e]||Hn(e);return r==="General"?Zm(t):Bc(r,t)}function Z_e(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=Us(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=Hs(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Hn(t)]=s}function eSe(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||B0[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=a2(e.v):e.w=Zm(e.v):e.w=Q_e(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=Fv[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&K1(n)){var s=wm(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function tSe(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=hve[n.Pattern]||n.Pattern)}e[t.ID]=t}function rSe(e,t,r,n,s,a,i,o,c,u){var d="General",f=n.StyleID,h={};u=u||{};var g=[],p=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&i&&(f=i.StyleID);a[f]!==void 0&&(a[f].nf&&(d=a[f].nf),a[f].Interior&&g.push(a[f].Interior),!!a[f].Parent);)f=a[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Us(e);break;case"String":n.t="s",n.r=cD(Hn(e)),n.v=e.indexOf("<")>-1?Hn(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Hs(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Hn(e):n.v<60&&(n.v=n.v-1),(!d||d=="General")&&(d="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=Iq[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=cD(t||e));break}if(eSe(n,d,u),u.cellFormula!==!1)if(n.Formula){var x=Hn(n.Formula);x.charCodeAt(0)==61&&(x=x.slice(1)),n.f=n1(x,s),delete n.Formula,n.ArrayRange=="RC"?n.F=n1("RC:RC",s):n.ArrayRange&&(n.F=n1(n.ArrayRange,s),c.push([Vn(n.F),n.F]))}else for(p=0;p<c.length;++p)s.r>=c[p][0].s.r&&s.r<=c[p][0].e.r&&s.c>=c[p][0].s.c&&s.c<=c[p][0].e.c&&(n.F=c[p][1]);u.cellStyles&&(g.forEach(function(v){!h.patternType&&v.patternType&&(h.patternType=v.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function nSe(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function U6(e,t){var r=t||{};Y1();var n=uv(OE(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=bs(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=Gs(r);return i.type="string",y1.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function($t){s.indexOf("<"+$t)>=0&&(a=!0)}),a)return zSe(n,r);Fv={"General Number":"General","General Date":on[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":on[15],"Short Date":on[14],"Long Time":on[19],"Medium Time":on[18],"Short Time":on[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:on[2],Standard:on[4],Percent:on[10],Scientific:on[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,d={},f=[],h=r.dense?[]:{},g="",p={},x={},v=cu('<Data ss:Type="String">'),C=0,b=0,_=0,T={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},E={},F="",j=0,P=[],M={},I={},U=0,K=[],te=[],re={},Z=[],B,J=!1,z=[],q=[],H={},R=0,L=0,G={Sheets:[],WBProps:{date1904:!1}},W={};l2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var Q="";o=l2.exec(n);)switch(o[3]=(Q=o[3]).toLowerCase()){case"data":if(Q=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?rSe(n.slice(C,o.index),F,v,c[c.length-1][0]=="comment"?re:p,{c:b,r:_},N,Z[b],x,z,r):(F="",v=cu(o[0]),C=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(te.length>0&&(p.c=te),(!r.sheetRows||r.sheetRows>_)&&p.v!==void 0&&(r.dense?(h[_]||(h[_]=[]),h[_][b]=p):h[oa(b)+La(_)]=p),p.HRef&&(p.l={Target:Hn(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(R=b+(parseInt(p.MergeAcross,10)|0),L=_+(parseInt(p.MergeDown,10)|0),P.push({s:{c:b,r:_},e:{c:R,r:L}})),!r.sheetStubs)p.MergeAcross?b=R+1:++b;else if(p.MergeAcross||p.MergeDown){for(var X=b;X<=R;++X)for(var se=_;se<=L;++se)(X>b||se>_)&&(r.dense?(h[se]||(h[se]=[]),h[se][X]={t:"z"}):h[oa(X)+La(se)]={t:"z"});b=R+1}else++b;else p=J_e(o[0]),p.Index&&(b=+p.Index-1),b<T.s.c&&(T.s.c=b),b>T.e.c&&(T.e.c=b),o[0].slice(-2)==="/>"&&++b,te=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(_<T.s.r&&(T.s.r=_),_>T.e.r&&(T.e.r=_),o[0].slice(-2)==="/>"&&(x=cu(o[0]),x.Index&&(_=+x.Index-1)),b=0,++_):(x=cu(o[0]),x.Index&&(_=+x.Index-1),H={},(x.AutoFitHeight=="0"||x.Height)&&(H.hpx=parseInt(x.Height,10),H.hpt=h2(H.hpx),q[_]=H),x.Hidden=="1"&&(H.hidden=!0,q[_]=H));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));f.push(g),T.s.r<=T.e.r&&T.s.c<=T.e.c&&(h["!ref"]=Tn(T),r.sheetRows&&r.sheetRows<=T.e.r&&(h["!fullref"]=h["!ref"],T.e.r=r.sheetRows-1,h["!ref"]=Tn(T))),P.length&&(h["!merges"]=P),Z.length>0&&(h["!cols"]=Z),q.length>0&&(h["!rows"]=q),d[g]=h}else T={s:{r:2e6,c:2e6},e:{r:0,c:0}},_=b=0,c.push([o[3],!1]),u=cu(o[0]),g=Hn(u.Name),h=r.dense?[]:{},P=[],z=[],q=[],W={name:g,Hidden:0},G.Sheets.push(W);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Z=[],J=!1}break;case"style":o[1]==="/"?tSe(N,E,r):E=cu(o[0]);break;case"numberformat":E.nf=Hn(cu(o[0]).Format||"General"),Fv[E.nf]&&(E.nf=Fv[E.nf]);for(var le=0;le!=392&&on[le]!=E.nf;++le);if(le==392){for(le=57;le!=392;++le)if(on[le]==null){x0(E.nf,le);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(B=cu(o[0]),B.Hidden&&(B.hidden=!0,delete B.Hidden),B.Width&&(B.wpx=parseInt(B.Width,10)),!J&&B.wpx>10){J=!0,wo=xK;for(var he=0;he<Z.length;++he)Z[he]&&dh(Z[he])}J&&dh(B),Z[B.Index-1||Z.length]=B;for(var we=0;we<+B.Span;++we)Z[Z.length]=Gs(B);break;case"namedrange":if(o[1]==="/")break;G.Names||(G.Names=[]);var ie=fn(o[0]),Ee={Name:ie.Name,Ref:n1(ie.RefersTo.slice(1),{r:0,c:0})};G.Sheets.length>0&&(Ee.Sheet=G.Sheets.length-1),G.Names.push(Ee);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?F+=n.slice(j,o.index):j=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;E.Interior=cu(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?N1e(M,Q,n.slice(U,o.index)):U=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));nSe(re),te.push(re)}else c.push([o[3],!1]),u=cu(o[0]),re={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ye=cu(o[0]);h["!autofilter"]={ref:n1(ye.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return JD(n,r);var Ie=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ie=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ie=!1}break;case"excelworkbook":switch(o[3]){case"date1904":G.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ie=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ie=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(U,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else U=o.index+o[0].length;break;case"header":h["!margins"]||Om(h["!margins"]={},"xlml"),isNaN(+fn(o[0]).Margin)||(h["!margins"].header=+fn(o[0]).Margin);break;case"footer":h["!margins"]||Om(h["!margins"]={},"xlml"),isNaN(+fn(o[0]).Margin)||(h["!margins"].footer=+fn(o[0]).Margin);break;case"pagemargins":var ut=fn(o[0]);h["!margins"]||Om(h["!margins"]={},"xlml"),isNaN(+ut.Top)||(h["!margins"].top=+ut.Top),isNaN(+ut.Left)||(h["!margins"].left=+ut.Left),isNaN(+ut.Right)||(h["!margins"].right=+ut.Right),isNaN(+ut.Bottom)||(h["!margins"].bottom=+ut.Bottom);break;case"displayrighttoleft":G.Views||(G.Views=[]),G.Views[0]||(G.Views[0]={}),G.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ie=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ie=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ie=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ie=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ie=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ie=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ie=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ie=!1}break;case"smarttags":break;default:Ie=!1;break}if(Ie||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Z_e(I,Q,K,n.slice(U,o.index)):(K=o,U=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Qe={};return!r.bookSheets&&!r.bookProps&&(Qe.Sheets=d),Qe.SheetNames=f,Qe.Workbook=G,Qe.SSF=Gs(on),Qe.Props=M,Qe.Custprops=I,Qe}function y8(e,t){switch(aA(t=t||{}),t.type||"base64"){case"base64":return U6(Ql(e),t);case"binary":case"buffer":case"file":return U6(e,t);case"array":return U6(Sh(e),t)}}function sSe(e,t){var r=[];return e.Props&&r.push(E1e(e.Props,t)),e.Custprops&&r.push(A1e(e.Props,e.Custprops)),r.join("")}function aSe(){return""}function iSe(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(pr("NumberFormat",null,{"ss:Format":ms(on[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(pr("Style",a.join(""),i))}),pr("Styles",r.join(""))}function HK(e){return pr("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+ZE(e.Ref,{r:0,c:0})})}function oSe(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(HK(s)))}return pr("Names",r.join(""))}function lSe(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(HK(o)))}return a.join("")}function cSe(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(pr("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(pr("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(pr("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(pr("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(no("ProtectContents","True")),e["!protect"].objects&&s.push(no("ProtectObjects","True")),e["!protect"].scenarios&&s.push(no("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(no("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(no("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":pr("WorksheetOptions",s.join(""),{xmlns:zl.x})}function uSe(e){return e.map(function(t){var r=Ppe(t.t||""),n=pr("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return pr("Comment",n,{"ss:Author":t.a})}).join("")}function dSe(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+ms(ZE(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=la(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=ms(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=ms(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],d=0;d!=u.length;++d)u[d].s.c!=i.c||u[d].s.r!=i.r||(u[d].e.c>u[d].s.c&&(o["ss:MergeAcross"]=u[d].e.c-u[d].s.c),u[d].e.r>u[d].s.r&&(o["ss:MergeDown"]=u[d].e.r-u[d].s.r));var f="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",h=String(e.v);break;case"b":f="Boolean",h=e.v?"1":"0";break;case"e":f="Error",h=B0[e.v];break;case"d":f="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||on[14]);break;case"s":f="String",h=jpe(e.v||"");break}var g=Ch(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+g),o["ss:Index"]=i.c+1;var p=e.v!=null?h:"",x=e.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(e.c||[]).length>0&&(x+=uSe(e.c)),pr("Cell",x,o)}function fSe(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=v1(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function hSe(e,t,r,n){if(!e["!ref"])return"";var s=Vn(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(v,C){dh(v);var b=!!v.width,_=o3(C,v),T={"ss:Index":C+1};b&&(T["ss:Width"]=d2(_.width)),v.hidden&&(T["ss:Hidden"]="1"),o.push(pr("Column",null,T))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var d=[fSe(u,(e["!rows"]||[])[u])],f=s.s.c;f<=s.e.c;++f){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>f)&&!(a[i].s.r>u)&&!(a[i].e.c<f)&&!(a[i].e.r<u)){(a[i].s.c!=f||a[i].s.r!=u)&&(h=!0);break}if(!h){var g={r:u,c:f},p=cn(g),x=c?(e[u]||[])[f]:e[p];d.push(dSe(x,p,e,t,r,n,g))}}d.push("</Row>"),d.length>2&&o.push(d.join(""))}return o.join("")}function mSe(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?lSe(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?hSe(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(cSe(a,t,e,r)),n.join("")}function gSe(e,t){t||(t={}),e.SSF||(e.SSF=Gs(on)),e.SSF&&(Y1(),e3(e.SSF),t.revssf=r3(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ch(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(sSe(e,t)),r.push(aSe()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(pr("Worksheet",mSe(n,t,e),{"ss:Name":ms(e.SheetNames[n])}));return r[2]=iSe(e,t),r[3]=oSe(e),Ua+pr("Workbook",r.join(""),{xmlns:zl.ss,"xmlns:o":zl.o,"xmlns:x":zl.x,"xmlns:ss":zl.ss,"xmlns:dt":zl.dt,"xmlns:html":zl.html})}function pSe(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=o1e(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=l1e(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var xSe=[60,1084,2066,2165,2175];function ySe(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=u0(r,r.l),u=v8[c],d=0;u!=null&&xSe.indexOf(c)>-1;)a=u0(r,r.l+2),d=r.l+4,c==2066?d+=4:(c==2165||c==2175)&&(d+=12),o=r.slice(d,r.l+4+a),i.push(o),r.l+=4+a,u=v8[c=u0(r,r.l)];var f=Fi(i);eo(f,0);var h=0;f.lens=[];for(var g=0;g<i.length;++g)f.lens.push(h),h+=i[g].length;if(f.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+f.length+" < "+n;return t.f(f,f.length,s)}function Ku(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=on[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||B0[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=a2(e.v):e.w=Zm(e.v):e.w=Bc(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&K1(on[n]||String(n))){var s=wm(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function s4(e,t,r){return{v:e,ixfe:t,t:r}}function vSe(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",d={},f,h="",g,p,x,v,C={},b=[],_,T,N=[],E=[],F={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},P=function(Oe){return Oe<8?Fm[Oe]:Oe<64&&E[Oe-8]||Fm[Oe]},M=function(Oe,$e,Mt){var It=$e.XF.data;if(!(!It||!It.patternType||!Mt||!Mt.cellStyles)){$e.s={},$e.s.patternType=It.patternType;var At;(At=u2(P(It.icvFore)))&&($e.s.fgColor={rgb:At}),(At=u2(P(It.icvBack)))&&($e.s.bgColor={rgb:At})}},I=function(Oe,$e,Mt){if(!(H>1)&&!(Mt.sheetRows&&Oe.r>=Mt.sheetRows)){if(Mt.cellStyles&&$e.XF&&$e.XF.data&&M(Oe,$e,Mt),delete $e.ixfe,delete $e.XF,f=Oe,h=cn(Oe),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Oe.r<i.s.r&&(i.s.r=Oe.r),Oe.c<i.s.c&&(i.s.c=Oe.c),Oe.r+1>i.e.r&&(i.e.r=Oe.r+1),Oe.c+1>i.e.c&&(i.e.c=Oe.c+1),Mt.cellFormula&&$e.f){for(var It=0;It<b.length;++It)if(!(b[It][0].s.c>Oe.c||b[It][0].s.r>Oe.r)&&!(b[It][0].e.c<Oe.c||b[It][0].e.r<Oe.r)){$e.F=Tn(b[It][0]),(b[It][0].s.c!=Oe.c||b[It][0].s.r!=Oe.r)&&delete $e.f,$e.f&&($e.f=""+bo(b[It][1],i,Oe,z,U));break}}Mt.dense?(s[Oe.r]||(s[Oe.r]=[]),s[Oe.r][Oe.c]=$e):s[h]=$e}},U={enc:!1,sbcch:0,snames:[],sharedf:C,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(U.password=t.password);var K,te=[],re=[],Z=[],B=[],J=!1,z=[];z.SheetNames=U.snames,z.sharedf=U.sharedf,z.arrayf=U.arrayf,z.names=[],z.XTI=[];var q=0,H=0,R=0,L=[],G=[],W;U.codepage=1200,gu(1200);for(var Q=!1;e.l<e.length-1;){var X=e.l,se=e.read_shift(2);if(se===0&&q===10)break;var le=e.l===e.length?0:e.read_shift(2),he=v8[se];if(he&&he.f){if(t.bookSheets&&q===133&&se!==133)break;if(q=se,he.r===2||he.r==12){var we=e.read_shift(2);if(le-=2,!U.enc&&we!==se&&((we&255)<<8|we>>8)!==se)throw new Error("rt mismatch: "+we+"!="+se);he.r==12&&(e.l+=10,le-=10)}var ie={};if(se===10?ie=he.f(e,le,U):ie=ySe(se,he,e,le,U),H==0&&[9,521,1033,2057].indexOf(q)===-1)continue;switch(se){case 34:r.opts.Date1904=F.WBProps.date1904=ie;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(U.enc||(e.l=0),U.enc=ie,!t.password)throw new Error("File is password-protected");if(ie.valid==null)throw new Error("Encryption scheme unsupported");if(!ie.valid)throw new Error("Password is incorrect");break;case 92:U.lastuser=ie;break;case 66:var Ee=Number(ie);switch(Ee){case 21010:Ee=1200;break;case 32768:Ee=1e4;break;case 32769:Ee=1252;break}gu(U.codepage=Ee),Q=!0;break;case 317:U.rrtabid=ie;break;case 25:U.winlocked=ie;break;case 439:r.opts.RefreshAll=ie;break;case 12:r.opts.CalcCount=ie;break;case 16:r.opts.CalcDelta=ie;break;case 17:r.opts.CalcIter=ie;break;case 13:r.opts.CalcMode=ie;break;case 14:r.opts.CalcPrecision=ie;break;case 95:r.opts.CalcSaveRecalc=ie;break;case 15:U.CalcRefMode=ie;break;case 2211:r.opts.FullCalc=ie;break;case 129:ie.fDialog&&(s["!type"]="dialog"),ie.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),ie.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:N.push(ie);break;case 430:z.push([ie]),z[z.length-1].XTI=[];break;case 35:case 547:z[z.length-1].push(ie);break;case 24:case 536:W={Name:ie.Name,Ref:bo(ie.rgce,i,null,z,U)},ie.itab>0&&(W.Sheet=ie.itab-1),z.names.push(W),z[0]||(z[0]=[],z[0].XTI=[]),z[z.length-1].push(ie),ie.Name=="_xlnm._FilterDatabase"&&ie.itab>0&&ie.rgce&&ie.rgce[0]&&ie.rgce[0][0]&&ie.rgce[0][0][0]=="PtgArea3d"&&(G[ie.itab-1]={ref:Tn(ie.rgce[0][0][1][2])});break;case 22:U.ExternCount=ie;break;case 23:z.length==0&&(z[0]=[],z[0].XTI=[]),z[z.length-1].XTI=z[z.length-1].XTI.concat(ie),z.XTI=z.XTI.concat(ie);break;case 2196:if(U.biff<8)break;W!=null&&(W.Comment=ie[1]);break;case 18:s["!protect"]=ie;break;case 19:ie!==0&&U.WTF&&console.error("Password verifier: "+ie);break;case 133:a[ie.pos]=ie,U.snames.push(ie.name);break;case 10:{if(--H)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=Tn(i),t.sheetRows&&t.sheetRows<=i.e.r){var ye=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=Tn(i),i.e.r=ye}i.e.r++,i.e.c++}te.length>0&&(s["!merges"]=te),re.length>0&&(s["!objects"]=re),Z.length>0&&(s["!cols"]=Z),B.length>0&&(s["!rows"]=B),F.Sheets.push(j)}u===""?d=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(U.biff===8&&(U.biff={9:2,521:3,1033:4}[se]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ie.BIFFVer]||8),U.biffguess=ie.BIFFVer==0,ie.BIFFVer==0&&ie.dt==4096&&(U.biff=5,Q=!0,gu(U.codepage=28591)),U.biff==8&&ie.BIFFVer==0&&ie.dt==16&&(U.biff=2),H++)break;if(s=t.dense?[]:{},U.biff<8&&!Q&&(Q=!0,gu(U.codepage=t.codepage||1252)),U.biff<5||ie.BIFFVer==0&&ie.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ie={pos:e.l-le,name:u};a[Ie.pos]=Ie,U.snames.push(u)}else u=(a[X]||{name:""}).name;ie.dt==32&&(s["!type"]="chart"),ie.dt==64&&(s["!type"]="macro"),te=[],re=[],U.arrayf=b=[],Z=[],B=[],J=!1,j={Hidden:(a[X]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[ie.r]||[])[ie.c]:s[cn({c:ie.c,r:ie.r})])&&++ie.c,_={ixfe:ie.ixfe,XF:N[ie.ixfe]||{},v:ie.val,t:"n"},R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ie.c,r:ie.r},_,t);break;case 5:case 517:_={ixfe:ie.ixfe,XF:N[ie.ixfe],v:ie.val,t:ie.t},R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ie.c,r:ie.r},_,t);break;case 638:_={ixfe:ie.ixfe,XF:N[ie.ixfe],v:ie.rknum,t:"n"},R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ie.c,r:ie.r},_,t);break;case 189:for(var ut=ie.c;ut<=ie.C;++ut){var Qe=ie.rkrec[ut-ie.c][0];_={ixfe:Qe,XF:N[Qe],v:ie.rkrec[ut-ie.c][1],t:"n"},R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ut,r:ie.r},_,t)}break;case 6:case 518:case 1030:{if(ie.val=="String"){o=ie;break}if(_=s4(ie.val,ie.cell.ixfe,ie.tt),_.XF=N[_.ixfe],t.cellFormula){var $t=ie.formula;if($t&&$t[0]&&$t[0][0]&&$t[0][0][0]=="PtgExp"){var Ge=$t[0][0][1][0],et=$t[0][0][1][1],vt=cn({r:Ge,c:et});C[vt]?_.f=""+bo(ie.formula,i,ie.cell,z,U):_.F=((t.dense?(s[Ge]||[])[et]:s[vt])||{}).F}else _.f=""+bo(ie.formula,i,ie.cell,z,U)}R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I(ie.cell,_,t),o=ie}break;case 7:case 519:if(o)o.val=ie,_=s4(ie,o.cell.ixfe,"s"),_.XF=N[_.ixfe],t.cellFormula&&(_.f=""+bo(o.formula,i,o.cell,z,U)),R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I(o.cell,_,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{b.push(ie);var Te=cn(ie[0].s);if(g=t.dense?(s[ie[0].s.r]||[])[ie[0].s.c]:s[Te],t.cellFormula&&g){if(!o||!Te||!g)break;g.f=""+bo(ie[1],i,ie[0],z,U),g.F=Tn(ie[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;C[cn(o.cell)]=ie[0],g=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[cn(o.cell)],(g||{}).f=""+bo(ie[0],i,f,z,U)}}break;case 253:_=s4(c[ie.isst].t,ie.ixfe,"s"),c[ie.isst].h&&(_.h=c[ie.isst].h),_.XF=N[_.ixfe],R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ie.c,r:ie.r},_,t);break;case 513:t.sheetStubs&&(_={ixfe:ie.ixfe,XF:N[ie.ixfe],t:"z"},R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ie.c,r:ie.r},_,t));break;case 190:if(t.sheetStubs)for(var Ve=ie.c;Ve<=ie.C;++Ve){var pt=ie.ixfe[Ve-ie.c];_={ixfe:pt,XF:N[pt],t:"z"},R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:Ve,r:ie.r},_,t)}break;case 214:case 516:case 4:_=s4(ie.val,ie.ixfe,"s"),_.XF=N[_.ixfe],R>0&&(_.z=L[_.ixfe>>8&63]),Ku(_,t,r.opts.Date1904),I({c:ie.c,r:ie.r},_,t);break;case 0:case 512:H===1&&(i=ie);break;case 252:c=ie;break;case 1054:if(U.biff==4){L[R++]=ie[1];for(var wt=0;wt<R+163&&on[wt]!=ie[1];++wt);wt>=163&&x0(ie[1],R+163)}else x0(ie[1],ie[0]);break;case 30:{L[R++]=ie;for(var Ut=0;Ut<R+163&&on[Ut]!=ie;++Ut);Ut>=163&&x0(ie,R+163)}break;case 229:te=te.concat(ie);break;case 93:re[ie.cmo[0]]=U.lastobj=ie;break;case 438:U.lastobj.TxO=ie;break;case 127:U.lastobj.ImData=ie;break;case 440:for(v=ie[0].s.r;v<=ie[0].e.r;++v)for(x=ie[0].s.c;x<=ie[0].e.c;++x)g=t.dense?(s[v]||[])[x]:s[cn({c:x,r:v})],g&&(g.l=ie[1]);break;case 2048:for(v=ie[0].s.r;v<=ie[0].e.r;++v)for(x=ie[0].s.c;x<=ie[0].e.c;++x)g=t.dense?(s[v]||[])[x]:s[cn({c:x,r:v})],g&&g.l&&(g.l.Tooltip=ie[1]);break;case 28:{if(U.biff<=5&&U.biff>=2)break;g=t.dense?(s[ie[0].r]||[])[ie[0].c]:s[cn(ie[0])];var ct=re[ie[2]];g||(t.dense?(s[ie[0].r]||(s[ie[0].r]=[]),g=s[ie[0].r][ie[0].c]={t:"z"}):g=s[cn(ie[0])]={t:"z"},i.e.r=Math.max(i.e.r,ie[0].r),i.s.r=Math.min(i.s.r,ie[0].r),i.e.c=Math.max(i.e.c,ie[0].c),i.s.c=Math.min(i.s.c,ie[0].c)),g.c||(g.c=[]),p={a:ie[1],t:ct.TxO.t},g.c.push(p)}break;case 2173:i2e(N[ie.ixfe],ie.ext);break;case 125:{if(!U.cellStyles)break;for(;ie.e>=ie.s;)Z[ie.e--]={width:ie.w/256,level:ie.level||0,hidden:!!(ie.flags&1)},J||(J=!0,XE(ie.w/256)),dh(Z[ie.e+1])}break;case 520:{var yt={};ie.level!=null&&(B[ie.r]=yt,yt.level=ie.level),ie.hidden&&(B[ie.r]=yt,yt.hidden=!0),ie.hpt&&(B[ie.r]=yt,yt.hpt=ie.hpt,yt.hpx=v1(ie.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||Om(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[se]]=ie;break;case 161:s["!margins"]||Om(s["!margins"]={}),s["!margins"].header=ie.header,s["!margins"].footer=ie.footer;break;case 574:ie.RTL&&(F.Views[0].RTL=!0);break;case 146:E=ie;break;case 2198:K=ie;break;case 140:T=ie;break;case 442:u?j.CodeName=ie||j.name:F.WBProps.CodeName=ie||"ThisWorkbook";break}}else he||console.error("Missing Info for XLS Record 0x"+se.toString(16)),e.l+=le}return r.SheetNames=ka(a).sort(function(rt,Oe){return Number(rt)-Number(Oe)}).map(function(rt){return a[rt].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&d["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=d)):r.Preamble=d,r.Sheets&&G.forEach(function(rt,Oe){r.Sheets[r.SheetNames[Oe]]["!autofilter"]=rt}),r.Strings=c,r.SSF=Gs(on),U.enc&&(r.Encryption=U.enc),K&&(r.Themes=K),r.Metadata={},T!==void 0&&(r.Metadata.Country=T),z.names.length>0&&(F.Names=z.names),r.Workbook=F,r}var Mv={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function bSe(e,t,r){var n=Jr.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=ND(n,f8,Mv.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Jr.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=ND(i,h8,Mv.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(Wq(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function wSe(e,t){var r=[],n=[],s=[],a=0,i,o=nD(f8,"n"),c=nD(h8,"n");if(e.Props)for(i=ka(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=ka(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)Xq.indexOf(s[a][0])>-1||zq.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Jr.utils.cfb_add(t,"/SummaryInformation",ED(n,Mv.SI,c,h8)),(r.length||u.length)&&Jr.utils.cfb_add(t,"/DocumentSummaryInformation",ED(r,Mv.DSI,o,f8,u.length?u:null,Mv.UDI))}function GK(e,t){t||(t={}),aA(t),TE(),t.codepage&&CE(t.codepage);var r,n;if(e.FullPaths){if(Jr.find(e,"/encryption"))throw new Error("File is password-protected");r=Jr.find(e,"!CompObj"),n=Jr.find(e,"/Workbook")||Jr.find(e,"/Book")}else{switch(t.type){case"base64":e=Vl(Ql(e));break;case"binary":e=Vl(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}eo(e,0),n={content:e}}var s,a;if(r&&pSe(r),t.bookProps&&!t.bookSheets)s={};else{var i=Mn?"buffer":"array";if(n&&n.content)s=vSe(n.content,t);else if((a=Jr.find(e,"PerfectOffice_MAIN"))&&a.content)s=Rm.to_workbook(a.content,(t.type=i,t));else if((a=Jr.find(e,"NativeContent_MAIN"))&&a.content)s=Rm.to_workbook(a.content,(t.type=i,t));else throw(a=Jr.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Jr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=R2e(e))}var o={};return e.FullPaths&&bSe(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function _Se(e,t){var r=t||{},n=Jr.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Jr.utils.cfb_add(n,s,VK(e,r)),r.biff==8&&(e.Props||e.Custprops)&&wSe(e,n),r.biff==8&&e.vbaraw&&O2e(n,Jr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var m2={0:{f:Vwe},1:{f:e4e},2:{f:v4e},3:{f:l4e},4:{f:s4e},5:{f:p4e},6:{f:k4e},7:{f:f4e},8:{f:P4e},9:{f:j4e},10:{f:E4e},11:{f:A4e},12:{f:r4e},13:{f:w4e},14:{f:u4e},15:{f:i4e},16:{f:IK},17:{f:T4e},18:{f:m4e},19:{f:$E},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:T_e},40:{},42:{},43:{f:kve},44:{f:_ve},45:{f:Nve},46:{f:Ave},47:{f:Eve},48:{},49:{f:Ype},50:{},51:{f:c2e},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:oK},62:{f:S4e},63:{f:y2e},64:{f:q4e},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jo,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:W4e},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Qwe},148:{f:Ywe,p:16},151:{f:I4e},152:{},153:{f:S_e},154:{},155:{},156:{f:w_e},157:{},158:{},159:{T:1,f:Bye},160:{T:-1},161:{T:1,f:wg},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:F4e},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:o2e},336:{T:-1},337:{f:f2e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:d8},357:{},358:{},359:{},360:{T:1},361:{},362:{f:iK},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:L4e},427:{f:B4e},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:U4e},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jwe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:O4e},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:d8},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:A2e},633:{T:1},634:{T:-1},635:{T:1,f:N2e},636:{T:-1},637:{f:Zpe},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:u_e},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:K4e},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},v8={6:{f:B6},10:{f:Rf},12:{f:Ka},13:{f:Ka},14:{f:Ma},15:{f:Ma},16:{f:So},17:{f:Ma},18:{f:Ma},19:{f:Ka},20:{f:RD},21:{f:RD},23:{f:iK},24:{f:DD},25:{f:Ma},26:{},27:{},28:{f:Kxe},29:{},34:{f:Ma},35:{f:OD},38:{f:So},39:{f:So},40:{f:So},41:{f:So},42:{f:Ma},43:{f:Ma},47:{f:ive},49:{f:wxe},51:{f:Ka},60:{},61:{f:pxe},64:{f:Ma},65:{f:bxe},66:{f:Ka},77:{},80:{},81:{},82:{},85:{f:Ka},89:{},90:{},91:{},92:{f:axe},93:{f:Jxe},94:{},95:{f:Ma},96:{},97:{},99:{f:Ma},125:{f:oK},128:{f:Dxe},129:{f:oxe},130:{f:Ka},131:{f:Ma},132:{f:Ma},133:{f:lxe},134:{},140:{f:aye},141:{f:Ka},144:{},146:{f:lye},151:{},152:{},153:{},154:{},155:{},156:{f:Ka},157:{},158:{},160:{f:gye},161:{f:dye},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Fxe},190:{f:Mxe},193:{f:Rf},197:{},198:{},199:{},200:{},201:{},202:{f:Ma},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Ka},220:{},221:{f:Ma},222:{},224:{f:Oxe},225:{f:sxe},226:{f:Rf},227:{},229:{f:Yxe},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:uxe},253:{f:Sxe},255:{f:fxe},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Jq},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ma},353:{f:Rf},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Uxe},431:{f:Ma},432:{},433:{},434:{},437:{},438:{f:eye},439:{f:Ma},440:{f:tye},441:{},442:{f:rb},443:{},444:{f:Ka},445:{},446:{},448:{f:Rf},449:{f:gxe,r:2},450:{f:Rf},512:{f:PD},513:{f:mye},515:{f:Bxe},516:{f:Cxe},517:{f:MD},519:{f:pye},520:{f:hxe},523:{},545:{f:ID},549:{f:jD},566:{},574:{f:yxe},638:{f:Pxe},659:{},1048:{},1054:{f:Nxe},1084:{},1212:{f:Gxe},2048:{f:nye},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:t4},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Rf},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:cye,r:12},2173:{f:a2e,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ma,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Hxe,r:12},2197:{},2198:{f:Zve,r:12},2199:{},2200:{},2201:{},2202:{f:Vxe,r:12},2203:{f:Rf},2204:{},2205:{},2206:{},2207:{},2211:{f:mxe},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Ka},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:fye},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:oye},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:PD},1:{},2:{f:wye},3:{f:vye},4:{f:yye},5:{f:MD},7:{f:Sye},8:{},9:{f:t4},11:{},22:{f:Ka},30:{f:Axe},31:{},32:{},33:{f:ID},36:{},37:{f:jD},50:{f:kye},62:{},52:{},67:{},68:{f:Ka},69:{},86:{},126:{},127:{f:xye},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Cye},223:{},234:{},354:{},421:{},518:{f:B6},521:{f:t4},536:{f:DD},547:{f:OD},561:{},579:{},1030:{f:B6},1033:{f:t4},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vr(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&IE(r)&&e.push(r)}}function SSe(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return vr(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var d=e.next(4);for(d.write_shift(2,a),d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(d=e.next(4),d.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;d.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function ib(e,t,r){return e||(e=Ht(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function kSe(e,t,r,n){var s=Ht(9);return ib(s,e,t),Qq(r,n||"b",s),s}function CSe(e,t,r){var n=Ht(8+2*r.length);return ib(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function TSe(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?gi(Hs(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?vr(e,2,_ye(r,n,s)):vr(e,3,bye(r,n,s));return;case"b":case"e":vr(e,5,kSe(r,n,t.v,t.t));return;case"s":case"str":vr(e,4,CSe(r,n,(t.v||"").slice(0,255)));return}vr(e,1,ib(null,r,n))}function NSe(e,t,r,n){var s=Array.isArray(t),a=Vn(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=Tn(a)}for(var u=a.s.r;u<=a.e.r;++u){o=La(u);for(var d=a.s.c;d<=a.e.c;++d){u===a.s.r&&(c[d]=oa(d)),i=c[d]+o;var f=s?(t[u]||[])[d]:t[i];f&&TSe(e,f,u,d)}}}function ESe(e,t){for(var r=t||{},n=Sl(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return vr(n,r.biff==4?1033:r.biff==3?521:9,qE(e,16,r)),NSe(n,e.Sheets[e.SheetNames[s]],s,r),vr(n,10),n.end()}function ASe(e,t,r){vr(e,49,_xe({sz:12,name:"Arial"},r))}function jSe(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&vr(e,1054,Exe(s,t[s],r))})}function PSe(e,t){var r=Ht(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),vr(e,2151,r),r=Ht(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),nK(Vn(t["!ref"]||"A1"),r),r.write_shift(4,4),vr(e,2152,r)}function FSe(e,t){for(var r=0;r<16;++r)vr(e,224,FD({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){vr(e,224,FD(n,0,t))})}function MSe(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];vr(e,440,rye(n)),n[1].Tooltip&&vr(e,2048,sye(n))}delete t["!links"]}function RSe(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&vr(e,125,uye(o3(s,n),s))})}}function OSe(e,t,r,n,s){var a=16+Ch(s.cellXfs,t,s);if(t.v==null&&!t.bf){vr(e,513,ng(r,n,a));return}if(t.bf)vr(e,6,owe(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?gi(Hs(t.v)):t.v;vr(e,515,$xe(r,n,i,a));break;case"b":case"e":vr(e,517,Lxe(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=tA(s.Strings,t.v,s.revStrings);vr(e,253,kxe(r,n,o,a))}else vr(e,516,Txe(r,n,(t.v||"").slice(0,255),a,s));break;default:vr(e,513,ng(r,n,a))}}function DSe(e,t,r){var n=Sl(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,d,f="",h=[],g=Vn(a["!ref"]||"A1"),p=u?65536:16384;if(g.e.c>255||g.e.r>=p){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,p-1)}vr(n,2057,qE(r,16,t)),vr(n,13,Cc(1)),vr(n,12,Cc(100)),vr(n,15,Vo(!0)),vr(n,17,Vo(!1)),vr(n,16,tg(.001)),vr(n,95,Vo(!0)),vr(n,42,Vo(!1)),vr(n,43,Vo(!1)),vr(n,130,Cc(1)),vr(n,128,Ixe()),vr(n,131,Vo(!1)),vr(n,132,Vo(!1)),u&&RSe(n,a["!cols"]),vr(n,512,jxe(g,t)),u&&(a["!links"]=[]);for(var x=g.s.r;x<=g.e.r;++x){f=La(x);for(var v=g.s.c;v<=g.e.c;++v){x===g.s.r&&(h[v]=oa(v)),d=h[v]+f;var C=c?(a[x]||[])[v]:a[d];C&&(OSe(n,C,x,v,t),u&&C.l&&a["!links"].push([d,C.l]))}}var b=o.CodeName||o.name||s;return u&&vr(n,574,vxe((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&vr(n,229,Xxe(a["!merges"])),u&&MSe(n,a),vr(n,442,Zq(b)),u&&PSe(n,a),vr(n,10),n.end()}function ISe(e,t,r){var n=Sl(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(vr(n,2057,qE(e,5,r)),r.bookType=="xla"&&vr(n,135),vr(n,225,o?Cc(1200):null),vr(n,193,L1e(2)),c&&vr(n,191),c&&vr(n,192),vr(n,226),vr(n,92,ixe("SheetJS",r)),vr(n,66,Cc(o?1200:1252)),o&&vr(n,353,Cc(0)),o&&vr(n,448),vr(n,317,hye(e.SheetNames.length)),o&&e.vbaraw&&vr(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";vr(n,442,Zq(u))}vr(n,156,Cc(17)),vr(n,25,Vo(!1)),vr(n,18,Vo(!1)),vr(n,19,Cc(0)),o&&vr(n,431,Vo(!1)),o&&vr(n,444,Cc(0)),vr(n,61,xxe()),vr(n,64,Vo(!1)),vr(n,141,Cc(0)),vr(n,34,Vo(g_e(e)=="true")),vr(n,14,Vo(!0)),o&&vr(n,439,Vo(!1)),vr(n,218,Cc(0)),ASe(n,e,r),jSe(n,e.SSF,r),FSe(n,r),o&&vr(n,352,Vo(!1));var d=n.end(),f=Sl();o&&vr(f,140,iye()),o&&r.Strings&&SSe(f,252,dxe(r.Strings)),vr(f,10);var h=f.end(),g=Sl(),p=0,x=0;for(x=0;x<e.SheetNames.length;++x)p+=(o?12:11)+(o?2:1)*e.SheetNames[x].length;var v=d.length+p+h.length;for(x=0;x<e.SheetNames.length;++x){var C=a[x]||{};vr(g,133,cxe({pos:v,hs:C.Hidden||0,dt:0,name:e.SheetNames[x]},r)),v+=t[x].length}var b=g.end();if(p!=b.length)throw new Error("BS8 "+p+" != "+b.length);var _=[];return d.length&&_.push(d),b.length&&_.push(b),h.length&&_.push(h),Fi(_)}function LSe(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Gs(on)),e&&e.SSF&&(Y1(),e3(e.SSF),r.revssf=r3(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,iA(r),r.cellXfs=[],Ch(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=DSe(s,r,e);return n.unshift(ISe(e,n,r)),Fi(n)}function VK(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=Tl(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return LSe(e,t);case 4:case 3:case 2:return ESe(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function qD(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=_pe(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,d=0,f=0,h=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},p=[];for(i=0;i<c.length;++i){var x=c[i].trim(),v=x.slice(0,3).toLowerCase();if(v=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}d=0;continue}if(!(v!="<td"&&v!="<th")){var C=x.split(/<\/t[dh]>/i);for(o=0;o<C.length;++o){var b=C[o].trim();if(b.match(/<t[dh]/i)){for(var _=b,T=0;_.charAt(0)=="<"&&(T=_.indexOf(">"))>-1;)_=_.slice(T+1);for(var N=0;N<p.length;++N){var E=p[N];E.s.c==d&&E.s.r<u&&u<=E.e.r&&(d=E.e.c+1,N=-1)}var F=fn(b.slice(0,b.indexOf(">")));h=F.colspan?+F.colspan:1,((f=+F.rowspan)>1||h>1)&&p.push({s:{r:u,c:d},e:{r:u+(f||1)-1,c:d+h-1}});var j=F.t||F["data-t"]||"";if(!_.length){d+=h;continue}if(_=pq(_),g.s.r>u&&(g.s.r=u),g.e.r<u&&(g.e.r=u),g.s.c>d&&(g.s.c=d),g.e.c<d&&(g.e.c=d),!_.length){d+=h;continue}var P={t:"s",v:_};r.raw||!_.trim().length||j=="s"||(_==="TRUE"?P={t:"b",v:!0}:_==="FALSE"?P={t:"b",v:!1}:isNaN(yu(_))?isNaN(x1(_).getDate())||(P={t:"d",v:Hs(_)},r.cellDates||(P={t:"n",v:gi(P.v)}),P.z=r.dateNF||on[14]):P={t:"n",v:yu(_)}),r.dense?(n[u]||(n[u]=[]),n[u][d]=P):n[cn({r:u,c:d})]=P,d+=h}}}}return n["!ref"]=Tn(g),p.length&&(n["!merges"]=p),n}function BSe(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var d=cn({r,c:i}),f=n.dense?(e[r]||[])[i]:e[d],h=f&&f.v!=null&&(f.h||RE(f.w||(E0(f),f.w)||""))||"",g={};o>1&&(g.rowspan=o),c>1&&(g.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":f&&(g["data-t"]=f&&f.t||"z",f.v!=null&&(g["data-v"]=f.v),f.z!=null&&(g["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+f.l.Target+'">'+h+"</a>")),g.id=(n.id||"sjs")+"-"+d,a.push(pr("td",h,g))}}var p="<tr>";return p+a.join("")+"</tr>"}var $Se='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',USe="</body></html>";function zSe(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return kh(qD(r[0],t),t);var n=cA();return r.forEach(function(s,a){uA(n,qD(s,t),"Sheet"+(a+1))}),n}function WSe(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function qK(e,t){var r=t||{},n=r.header!=null?r.header:$Se,s=r.footer!=null?r.footer:USe,a=[n],i=Tl(e["!ref"]);r.dense=Array.isArray(e),a.push(WSe(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(BSe(e,i,o,r));return a.push("</table>"+s),a.join("")}function KK(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?la(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var d=Tl(e["!ref"]);u.s.r=Math.min(u.s.r,d.s.r),u.s.c=Math.min(u.s.c,d.s.c),u.e.r=Math.max(u.e.r,d.e.r),u.e.c=Math.max(u.e.c,d.e.c),s==-1&&(u.e.r=s=d.e.r+1)}var f=[],h=0,g=e["!rows"]||(e["!rows"]=[]),p=0,x=0,v=0,C=0,b=0,_=0;for(e["!cols"]||(e["!cols"]=[]);p<o.length&&x<c;++p){var T=o[p];if(KD(T)){if(n.display)continue;g[x]={hidden:!0}}var N=T.children;for(v=C=0;v<N.length;++v){var E=N[v];if(!(n.display&&KD(E))){var F=E.hasAttribute("data-v")?E.getAttribute("data-v"):E.hasAttribute("v")?E.getAttribute("v"):pq(E.innerHTML),j=E.getAttribute("data-z")||E.getAttribute("z");for(h=0;h<f.length;++h){var P=f[h];P.s.c==C+a&&P.s.r<x+s&&x+s<=P.e.r&&(C=P.e.c+1-a,h=-1)}_=+E.getAttribute("colspan")||1,((b=+E.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:x+s,c:C+a},e:{r:x+s+(b||1)-1,c:C+a+(_||1)-1}});var M={t:"s",v:F},I=E.getAttribute("data-t")||E.getAttribute("t")||"";F!=null&&(F.length==0?M.t=I||"z":n.raw||F.trim().length==0||I=="s"||(F==="TRUE"?M={t:"b",v:!0}:F==="FALSE"?M={t:"b",v:!1}:isNaN(yu(F))?isNaN(x1(F).getDate())||(M={t:"d",v:Hs(F)},n.cellDates||(M={t:"n",v:gi(M.v)}),M.z=n.dateNF||on[14]):M={t:"n",v:yu(F)})),M.z===void 0&&j!=null&&(M.z=j);var U="",K=E.getElementsByTagName("A");if(K&&K.length)for(var te=0;te<K.length&&!(K[te].hasAttribute("href")&&(U=K[te].getAttribute("href"),U.charAt(0)!="#"));++te);U&&U.charAt(0)!="#"&&(M.l={Target:U}),n.dense?(e[x+s]||(e[x+s]=[]),e[x+s][C+a]=M):e[cn({c:C+a,r:x+s})]=M,u.e.c<C+a&&(u.e.c=C+a),C+=_}}++x}return f.length&&(e["!merges"]=(e["!merges"]||[]).concat(f)),u.e.r=Math.max(u.e.r,x-1+s),e["!ref"]=Tn(u),x>=c&&(e["!fullref"]=Tn((u.e.r=o.length-p+x-1+s,u))),e}function YK(e,t){var r=t||{},n=r.dense?[]:{};return KK(n,e,t)}function HSe(e,t){return kh(YK(e,t),t)}function KD(e){var t="",r=GSe(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function GSe(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function VSe(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Hn(t.replace(/<[^>]*>/g,""));return[r]}var YD={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function XK(e,t){var r=t||{},n=OE(e),s=[],a,i,o={name:""},c="",u=0,d,f,h={},g=[],p=r.dense?[]:{},x,v,C={value:""},b="",_=0,T=[],N=-1,E=-1,F={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,P={},M=[],I={},U=0,K=0,te=[],re=1,Z=1,B=[],J={Names:[]},z={},q=["",""],H=[],R={},L="",G=0,W=!1,Q=!1,X=0;for(l2.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");x=l2.exec(n);)switch(x[3]=x[3].replace(/_.*$/,"")){case"table":case"":x[1]==="/"?(F.e.c>=F.s.c&&F.e.r>=F.s.r?p["!ref"]=Tn(F):p["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=F.e.r&&(p["!fullref"]=p["!ref"],F.e.r=r.sheetRows-1,p["!ref"]=Tn(F)),M.length&&(p["!merges"]=M),te.length&&(p["!rows"]=te),d.name=d.||d.name,typeof JSON<"u"&&JSON.stringify(d),g.push(d.name),h[d.name]=p,Q=!1):x[0].charAt(x[0].length-2)!=="/"&&(d=fn(x[0],!1),N=E=-1,F.s.r=F.s.c=1e7,F.e.r=F.e.c=0,p=r.dense?[]:{},M=[],te=[],Q=!0);break;case"table-row-group":x[1]==="/"?--j:++j;break;case"table-row":case"":if(x[1]==="/"){N+=re,re=1;break}if(f=fn(x[0],!1),f.?N=f.-1:N==-1&&(N=0),re=+f["number-rows-repeated"]||1,re<10)for(X=0;X<re;++X)j>0&&(te[N+X]={level:j});E=-1;break;case"covered-table-cell":x[1]!=="/"&&++E,r.sheetStubs&&(r.dense?(p[N]||(p[N]=[]),p[N][E]={t:"z"}):p[cn({r:N,c:E})]={t:"z"}),b="",T=[];break;case"table-cell":case"":if(x[0].charAt(x[0].length-2)==="/")++E,C=fn(x[0],!1),Z=parseInt(C["number-columns-repeated"]||"1",10),v={t:"z",v:null},C.formula&&r.cellFormula!=!1&&(v.f=HD(Hn(C.formula))),(C.||C["value-type"])=="string"&&(v.t="s",v.v=Hn(C["string-value"]||""),r.dense?(p[N]||(p[N]=[]),p[N][E]=v):p[cn({r:N,c:E})]=v),E+=Z-1;else if(x[1]!=="/"){++E,b="",_=0,T=[],Z=1;var se=re?N+re-1:N;if(E>F.e.c&&(F.e.c=E),E<F.s.c&&(F.s.c=E),N<F.s.r&&(F.s.r=N),se>F.e.r&&(F.e.r=se),C=fn(x[0],!1),H=[],R={},v={t:C.||C["value-type"],v:null},r.cellFormula)if(C.formula&&(C.formula=Hn(C.formula)),C["number-matrix-columns-spanned"]&&C["number-matrix-rows-spanned"]&&(U=parseInt(C["number-matrix-rows-spanned"],10)||0,K=parseInt(C["number-matrix-columns-spanned"],10)||0,I={s:{r:N,c:E},e:{r:N+U-1,c:E+K-1}},v.F=Tn(I),B.push([I,v.F])),C.formula)v.f=HD(C.formula);else for(X=0;X<B.length;++X)N>=B[X][0].s.r&&N<=B[X][0].e.r&&E>=B[X][0].s.c&&E<=B[X][0].e.c&&(v.F=B[X][1]);switch((C["number-columns-spanned"]||C["number-rows-spanned"])&&(U=parseInt(C["number-rows-spanned"],10)||0,K=parseInt(C["number-columns-spanned"],10)||0,I={s:{r:N,c:E},e:{r:N+U-1,c:E+K-1}},M.push(I)),C["number-columns-repeated"]&&(Z=parseInt(C["number-columns-repeated"],10)),v.t){case"boolean":v.t="b",v.v=Us(C["boolean-value"]);break;case"float":v.t="n",v.v=parseFloat(C.value);break;case"percentage":v.t="n",v.v=parseFloat(C.value);break;case"currency":v.t="n",v.v=parseFloat(C.value);break;case"date":v.t="d",v.v=Hs(C["date-value"]),r.cellDates||(v.t="n",v.v=gi(v.v)),v.z="m/d/yy";break;case"time":v.t="n",v.v=vpe(C["time-value"])/86400,r.cellDates&&(v.t="d",v.v=n3(v.v)),v.z="HH:MM:SS";break;case"number":v.t="n",v.v=parseFloat(C.);break;default:if(v.t==="string"||v.t==="text"||!v.t)v.t="s",C["string-value"]!=null&&(b=Hn(C["string-value"]),T=[]);else throw new Error("Unsupported value type "+v.t)}}else{if(W=!1,v.t==="s"&&(v.v=b||"",T.length&&(v.R=T),W=_==0),z.Target&&(v.l=z),H.length>0&&(v.c=H,H=[]),b&&r.cellText!==!1&&(v.w=b),W&&(v.t="z",delete v.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=N))for(var le=0;le<re;++le){if(Z=parseInt(C["number-columns-repeated"]||"1",10),r.dense)for(p[N+le]||(p[N+le]=[]),p[N+le][E]=le==0?v:Gs(v);--Z>0;)p[N+le][E+Z]=Gs(v);else for(p[cn({r:N+le,c:E})]=v;--Z>0;)p[cn({r:N+le,c:E+Z})]=Gs(v);F.e.c<=E&&(F.e.c=E)}Z=parseInt(C["number-columns-repeated"]||"1",10),E+=Z-1,Z=0,v={},b="",T=[]}z={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!0]);break;case"annotation":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a;R.t=b,T.length&&(R.R=T),R.a=L,H.push(R)}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);L="",G=0,b="",_=0,T=[];break;case"creator":x[1]==="/"?L=n.slice(G,x.index):G=x.index+x[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(x[1]==="/"){if((a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&s.push([x[3],!1]);b="",_=0,T=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(x[1]==="/"){if(P[o.name]=c,(a=s.pop())[0]!==x[3])throw"Bad state: "+a}else x[0].charAt(x[0].length-2)!=="/"&&(c="",o=fn(x[0],!1),s.push([x[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=fn(x[0],!1),c+=YD[x[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=fn(x[0],!1),c+=YD[x[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(x[0].slice(-2)==="/>")break;if(x[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,x.index);break}else u=x.index+x[0].length;break;case"named-range":i=fn(x[0],!1),q=$6(i["cell-range-address"]);var he={Name:i.name,Ref:q[0]+"!"+q[1]};Q&&(he.Sheet=g.length),J.Names.push(he);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(x[1]==="/"&&(!C||!C["string-value"])){var we=VSe(n.slice(_,x.index));b=(b.length>0?b+`
`:"")+we[0]}else fn(x[0],!1),_=x.index+x[0].length;break;case"s":break;case"database-range":if(x[1]==="/")break;try{q=$6(fn(x[0])["target-range-address"]),h[q[0]]["!autofilter"]={ref:q[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(x[1]!=="/"){if(z=fn(x[0],!1),!z.href)break;z.Target=Hn(z.href),delete z.href,z.Target.charAt(0)=="#"&&z.Target.indexOf(".")>-1?(q=$6(z.Target.slice(1)),z.Target="#"+q[0]+"!"+q[1]):z.Target.match(/^\.\.[\\\/]/)&&(z.Target=z.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(x[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(x)}}var ie={Sheets:h,SheetNames:g,Workbook:J};return r.bookSheets&&delete ie.Sheets,ie}function XD(e,t){t=t||{},kc(e,"META-INF/manifest.xml")&&v1e(qa(e,"META-INF/manifest.xml"),t);var r=ql(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=XK(bs(r),t);return kc(e,"meta.xml")&&(n.Props=$q(qa(e,"meta.xml"))),n}function JD(e,t){return XK(e,t)}var qSe=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+o2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Ua+t}})(),QD=(function(){var e=function(a){return ms(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+ms(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,d=0,f=Tl(a["!ref"]||"A1"),h=a["!merges"]||[],g=0,p=Array.isArray(a);if(a["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(a["!cols"][d]?' table:style-name="co'+a["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",v=a["!rows"]||[];for(u=0;u<f.s.r;++u)x=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;u<=f.e.r;++u){for(x=v[u]?' table:style-name="ro'+v[u].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<f.s.c;++d)c.push(t);for(;d<=f.e.c;++d){var C=!1,b={},_="";for(g=0;g!=h.length;++g)if(!(h[g].s.c>d)&&!(h[g].s.r>u)&&!(h[g].e.c<d)&&!(h[g].e.r<u)){(h[g].s.c!=d||h[g].s.r!=u)&&(C=!0),b["table:number-columns-spanned"]=h[g].e.c-h[g].s.c+1,b["table:number-rows-spanned"]=h[g].e.r-h[g].s.r+1;break}if(C){c.push(r);continue}var T=cn({r:u,c:d}),N=p?(a[u]||[])[d]:a[T];if(N&&N.f&&(b["table:formula"]=ms(hwe(N.f)),N.F&&N.F.slice(0,T.length)==T)){var E=Tl(N.F);b["table:number-matrix-columns-spanned"]=E.e.c-E.s.c+1,b["table:number-matrix-rows-spanned"]=E.e.r-E.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":_=N.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=N.v?"true":"false";break;case"n":_=N.w||String(N.v||0),b["office:value-type"]="float",b["office:value"]=N.v||0;break;case"s":case"str":_=N.v==null?"":N.v,b["office:value-type"]="string";break;case"d":_=N.w||Hs(N.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Hs(N.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(t);continue}var F=e(_);if(N.l&&N.l.Target){var j=N.l.Target;j=j.charAt(0)=="#"?"#"+mwe(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),F=pr("text:a",F,{"xlink:href":j.replace(/&/g,"&amp;")})}c.push("          "+pr("table:table-cell",pr("text:p",F,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var d=0;d<u["!cols"].length;++d)if(u["!cols"][d]){var f=u["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;dh(f),f.ods=o;var h=u["!cols"][d].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var d=0;d<u["!rows"].length;++d)if(u["!rows"][d]){u["!rows"][d].ods=c;var f=u["!rows"][d].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Ua],u=o2({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=o2({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+d+`>
`),c.push(Bq().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=i.SheetNames.length;++f)c.push(n(i.Sheets[i.SheetNames[f]],i,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}})();function JK(e,t){if(t.bookType=="fods")return QD(e,t);var r=PE(),n="",s=[],a=[];return n="mimetype",En(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",En(r,n,QD(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",En(r,n,qSe(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",En(r,n,Ua+Bq()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",En(r,n,_1e(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",En(r,n,b1e(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function sg(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function b8(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):bs(Sh(e))}function KSe(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Vl(id(e))}function YSe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function hh(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function ZD(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function XSe(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function JSe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function g2(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function cs(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Sa(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Yn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=g2(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=g2(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function Yi(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(cs(n*8+s.type)),s.type==2&&t.push(cs(s.data.length)),t.push(s.data))})}),hh(t)}function sA(e,t){return e?.map(function(r){return t(r.data)})||[]}function bc(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=g2(e,n),a=Yn(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:Sa(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=Yn(o.data),u=Sa(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=Sa(a[3][0].data)>>>0>0),r.push(i)}return r}function Cp(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:cs(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:cs(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:cs(i.data.length)}],n[2].push({data:Yi(i.meta),type:2})});var a=Yi(n);t.push(cs(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),hh(t)}function QSe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=g2(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[hh(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var d=hh(s);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function wc(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(QSe(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return hh(t)}function Tp(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=cs(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return hh(t)}function ZSe(e,t,r,n){var s=sg(e),a=s.getUint32(4,!0),i=(n>1?12:8)+ZD(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,d=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=ZD(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(d.setTime(d.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var f;switch(e[2]){case 0:break;case 2:f={t:"n",v:u};break;case 3:f={t:"s",v:t[c]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:t[c]};else if(!isNaN(u))f={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return f}function e3e(e,t,r){var n=sg(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,d=new Date(2001,0,1);s&1&&(c=XSe(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(d.setTime(d.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var f;switch(e[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:t[o]};break;case 5:f={t:"d",v:d};break;case 6:f={t:"b",v:u>0};break;case 7:f={t:"n",v:u/86400};break;case 8:f={t:"e",v:0};break;case 9:if(i>-1)f={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return f}function z6(e,t){var r=new Uint8Array(32),n=sg(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,JSe(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function W6(e,t){var r=new Uint8Array(32),n=sg(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function t3e(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ZSe(e,t,r,e[0]);case 5:return e3e(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vo(e){var t=Yn(e);return g2(t[1][0].data)}function eI(e,t){var r=Yn(t.data),n=Sa(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=Yn(i.data),c=Sa(o[1][0].data)>>>0;switch(n){case 1:a[c]=b8(o[3][0].data);break;case 8:{var u=e[vo(o[9][0].data)][0],d=Yn(u.data),f=e[vo(d[1][0].data)][0],h=Sa(f.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var g=Yn(f.data);a[c]=g[3].map(function(p){return b8(p.data)}).join("")}break}}),a}function r3e(e,t){var r,n,s,a,i,o,c,u,d,f,h,g,p,x,v=Yn(e),C=Sa(v[1][0].data)>>>0,b=Sa(v[2][0].data)>>>0,_=((n=(r=v[8])==null?void 0:r[0])==null?void 0:n.data)&&Sa(v[8][0].data)>0||!1,T,N;if((a=(s=v[7])==null?void 0:s[0])!=null&&a.data&&t!=0)T=(o=(i=v[7])==null?void 0:i[0])==null?void 0:o.data,N=(u=(c=v[6])==null?void 0:c[0])==null?void 0:u.data;else if((f=(d=v[4])==null?void 0:d[0])!=null&&f.data&&t!=1)T=(g=(h=v[4])==null?void 0:h[0])==null?void 0:g.data,N=(x=(p=v[3])==null?void 0:p[0])==null?void 0:x.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var E=_?4:1,F=sg(T),j=[],P=0;P<T.length/2;++P){var M=F.getUint16(P*2,!0);M<65535&&j.push([P,M])}if(j.length!=b)throw"Expected ".concat(b," cells, found ").concat(j.length);var I=[];for(P=0;P<j.length-1;++P)I[j[P][0]]=N.subarray(j[P][1]*E,j[P+1][1]*E);return j.length>=1&&(I[j[j.length-1][0]]=N.subarray(j[j.length-1][1]*E)),{R:C,cells:I}}function n3e(e,t){var r,n=Yn(t.data),s=(r=n?.[7])!=null&&r[0]?Sa(n[7][0].data)>>>0>0?1:0:-1,a=sA(n[5],function(i){return r3e(i,s)});return{nrows:Sa(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function s3e(e,t,r){var n,s=Yn(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(Sa(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(Sa(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=Tn(a);var i=Yn(s[4][0].data),o=eI(e,e[vo(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?eI(e,e[vo(i[17][0].data)][0]):[],u=Yn(i[3][0].data),d=0;u[1].forEach(function(f){var h=Yn(f.data),g=e[vo(h[2][0].data)][0],p=Sa(g.meta[1][0].data);if(p!=6002)throw new Error("6001 unexpected reference to ".concat(p));var x=n3e(e,g);x.data.forEach(function(v,C){v.forEach(function(b,_){var T=cn({r:d+C,c:_}),N=t3e(b,o,c);N&&(r[T]=N)})}),d+=x.nrows})}function a3e(e,t){var r=Yn(t.data),n={"!ref":"A1"},s=e[vo(r[2][0].data)],a=Sa(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return s3e(e,s[0],n),n}function i3e(e,t){var r,n=Yn(t.data),s={name:(r=n[1])!=null&&r[0]?b8(n[1][0].data):"",sheets:[]},a=sA(n[2],vo);return a.forEach(function(i){e[i].forEach(function(o){var c=Sa(o.meta[1][0].data);c==6e3&&s.sheets.push(a3e(e,o))})}),s}function o3e(e,t){var r=cA(),n=Yn(t.data),s=sA(n[1],vo);if(s.forEach(function(a){e[a].forEach(function(i){var o=Sa(i.meta[1][0].data);if(o==2){var c=i3e(e,i);c.sheets.forEach(function(u,d){uA(r,u,d==0?c.name:c.name+"_"+d,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function H6(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=wc(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var d;try{d=bc(u)}catch(f){return console.log("## "+(f.message||f))}d.forEach(function(f){a[f.id]=f.messages,i.push(f.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&Sa(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var d=Sa(u.meta[1][0].data)>>>0;if(d==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return o3e(a,o)}function l3e(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&Sa(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=sg(e[7][0].data),d=0,f=[],h=sg(e[4][0].data),g=0,p=[],x=0;x<t.length;++x){if(t[x]==null){u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535);continue}u.setUint16(x*2,d,!0),h.setUint16(x*2,g,!0);var v,C;switch(typeof t[x]){case"string":v=z6({t:"s",v:t[x]},r),C=W6({t:"s",v:t[x]},r);break;case"number":v=z6({t:"n",v:t[x]},r),C=W6({t:"n",v:t[x]},r);break;case"boolean":v=z6({t:"b",v:t[x]},r),C=W6({t:"b",v:t[x]},r);break;default:throw new Error("Unsupported value "+t[x])}f.push(v),d+=v.length,p.push(C),g+=C.length,++c}for(e[2][0].data=cs(c);x<e[7][0].data.length/2;++x)u.setUint16(x*2,65535,!0),h.setUint16(x*2,65535,!0);return e[6][0].data=hh(f),e[3][0].data=hh(p),c}function c3e(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Tl(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Tn(n)));var a=I_(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(L){return L.forEach(function(G){typeof G=="string"&&i.push(G)})});var o={},c=[],u=Jr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,G){return[L,u.FullPaths[G]]}).forEach(function(L){var G=L[0],W=L[1];if(G.type==2&&G.name.match(/\.iwa/)){var Q=G.content,X=wc(Q),se=bc(X);se.forEach(function(le){c.push(le.id),o[le.id]={deps:[],location:W,type:Sa(le.messages[0].meta[1][0].data)}})}}),c.sort(function(L,G){return L-G});var d=c.filter(function(L){return L>1}).map(function(L){return[L,cs(L)]});u.FileIndex.map(function(L,G){return[L,u.FullPaths[G]]}).forEach(function(L){var G=L[0];if(L[1],!!G.name.match(/\.iwa/)){var W=bc(wc(G.content));W.forEach(function(Q){Q.messages.forEach(function(X){d.forEach(function(se){Q.messages.some(function(le){return Sa(le.meta[1][0].data)!=11006&&YSe(le.data,se[1])})&&o[se[0]].deps.push(Q.id)})})})}});for(var f=Jr.find(u,o[1].location),h=bc(wc(f.content)),g,p=0;p<h.length;++p){var x=h[p];x.id==1&&(g=x)}var v=vo(Yn(g.messages[0].data)[1][0].data);for(f=Jr.find(u,o[v].location),h=bc(wc(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(g=x);for(v=vo(Yn(g.messages[0].data)[2][0].data),f=Jr.find(u,o[v].location),h=bc(wc(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(g=x);for(v=vo(Yn(g.messages[0].data)[2][0].data),f=Jr.find(u,o[v].location),h=bc(wc(f.content)),p=0;p<h.length;++p)x=h[p],x.id==v&&(g=x);var C=Yn(g.messages[0].data);{C[6][0].data=cs(n.e.r+1),C[7][0].data=cs(n.e.c+1);var b=vo(C[46][0].data),_=Jr.find(u,o[b].location),T=bc(wc(_.content));{for(var N=0;N<T.length&&T[N].id!=b;++N);if(T[N].id!=b)throw"Bad ColumnRowUIDMapArchive";var E=Yn(T[N].messages[0].data);E[1]=[],E[2]=[],E[3]=[];for(var F=0;F<=n.e.c;++F){var j=[];j[1]=j[2]=[{type:0,data:cs(F+420690)}],E[1].push({type:2,data:Yi(j)}),E[2].push({type:0,data:cs(F)}),E[3].push({type:0,data:cs(F)})}E[4]=[],E[5]=[],E[6]=[];for(var P=0;P<=n.e.r;++P)j=[],j[1]=j[2]=[{type:0,data:cs(P+726270)}],E[4].push({type:2,data:Yi(j)}),E[5].push({type:0,data:cs(P)}),E[6].push({type:0,data:cs(P)});T[N].messages[0].data=Yi(E)}_.content=Tp(Cp(T)),_.size=_.content.length,delete C[46];var M=Yn(C[4][0].data);{M[7][0].data=cs(n.e.r+1);var I=Yn(M[1][0].data),U=vo(I[2][0].data);_=Jr.find(u,o[U].location),T=bc(wc(_.content));{if(T[0].id!=U)throw"Bad HeaderStorageBucket";var K=Yn(T[0].messages[0].data);for(P=0;P<a.length;++P){var te=Yn(K[2][0].data);te[1][0].data=cs(P),te[4][0].data=cs(a[P].length),K[2][P]={type:K[2][0].type,data:Yi(te)}}T[0].messages[0].data=Yi(K)}_.content=Tp(Cp(T)),_.size=_.content.length;var re=vo(M[2][0].data);_=Jr.find(u,o[re].location),T=bc(wc(_.content));{if(T[0].id!=re)throw"Bad HeaderStorageBucket";for(K=Yn(T[0].messages[0].data),F=0;F<=n.e.c;++F)te=Yn(K[2][0].data),te[1][0].data=cs(F),te[4][0].data=cs(n.e.r+1),K[2][F]={type:K[2][0].type,data:Yi(te)};T[0].messages[0].data=Yi(K)}_.content=Tp(Cp(T)),_.size=_.content.length;var Z=vo(M[4][0].data);(function(){for(var L=Jr.find(u,o[Z].location),G=bc(wc(L.content)),W,Q=0;Q<G.length;++Q){var X=G[Q];X.id==Z&&(W=X)}var se=Yn(W.messages[0].data);{se[3]=[];var le=[];i.forEach(function(ie,Ee){le[1]=[{type:0,data:cs(Ee)}],le[2]=[{type:0,data:cs(1)}],le[3]=[{type:2,data:KSe(ie)}],se[3].push({type:2,data:Yi(le)})})}W.messages[0].data=Yi(se);var he=Cp(G),we=Tp(he);L.content=we,L.size=L.content.length})();var B=Yn(M[3][0].data);{var J=B[1][0];delete B[2];var z=Yn(J.data);{var q=vo(z[2][0].data);(function(){for(var L=Jr.find(u,o[q].location),G=bc(wc(L.content)),W,Q=0;Q<G.length;++Q){var X=G[Q];X.id==q&&(W=X)}var se=Yn(W.messages[0].data);{delete se[6],delete B[7];var le=new Uint8Array(se[5][0].data);se[5]=[];for(var he=0,we=0;we<=n.e.r;++we){var ie=Yn(le);he+=l3e(ie,a[we],i),ie[1][0].data=cs(we),se[5].push({data:Yi(ie),type:2})}se[1]=[{type:0,data:cs(n.e.c+1)}],se[2]=[{type:0,data:cs(n.e.r+1)}],se[3]=[{type:0,data:cs(he)}],se[4]=[{type:0,data:cs(n.e.r+1)}]}W.messages[0].data=Yi(se);var Ee=Cp(G),ye=Tp(Ee);L.content=ye,L.size=L.content.length})()}J.data=Yi(z)}M[3][0].data=Yi(B)}C[4][0].data=Yi(M)}g.messages[0].data=Yi(C);var H=Cp(h),R=Tp(H);return f.content=R,f.size=f.content.length,u}function QK(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function aA(e){QK([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function iA(e){QK([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function u3e(e){return In.WS.indexOf(e)>-1?"sheet":e==In.CS?"chart":e==In.DS?"dialog":e==In.MS?"macro":e&&e.length?e:"sheet"}function d3e(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,u3e(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function f3e(e,t,r,n,s,a,i,o,c,u,d,f){try{a[n]=Av(ql(e,r,!0),t);var h=qa(e,t),g;switch(o){case"sheet":g=R_e(h,t,s,c,a[n],u,d,f);break;case"chart":if(g=O_e(h,t,s,c,a[n],u,d,f),!g||!g["!drawel"])break;var p=fv(g["!drawel"].Target,t),x=c2(p),v=w2e(ql(e,p,!0),Av(ql(e,x,!0),p)),C=fv(v,p),b=c2(C);g=l_e(ql(e,C,!0),C,c,Av(ql(e,b,!0),C),u,g);break;case"macro":g=D_e(h,t,s,c,a[n],u,d,f);break;case"dialog":g=I_e(h,t,s,c,a[n],u,d,f);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=g;var _=[];a&&a[n]&&ka(a[n]).forEach(function(T){var N="";if(a[n][T].Type==In.CMNT){N=fv(a[n][T].Target,t);var E=U_e(qa(e,N,!0),N,c);if(!E||!E.length)return;BD(g,E,!1)}a[n][T].Type==In.TCMNT&&(N=fv(a[n][T].Target,t),_=_.concat(S2e(qa(e,N,!0),c)))}),_&&_.length&&BD(g,_,!0,c.people||[])}catch(T){if(c.WTF)throw T}}function yc(e){return e.charAt(0)=="/"?e.slice(1):e}function h3e(e,t){if(Y1(),t=t||{},aA(t),kc(e,"META-INF/manifest.xml")||kc(e,"objectdata.xml"))return XD(e,t);if(kc(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof H6<"u"){if(e.FileIndex)return H6(e);var r=Jr.utils.cfb_new();return iD(e).forEach(function(te){En(r,te,kpe(e,te))}),H6(r)}throw new Error("Unsupported NUMBERS file")}if(!kc(e,"[Content_Types].xml"))throw kc(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):kc(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=iD(e),s=x1e(ql(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",qa(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!qa(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(jv=[],s.sst)try{jv=$_e(qa(e,yc(s.sst)),s.sst,t)}catch(te){if(t.WTF)throw te}t.cellStyles&&s.themes.length&&(c=B_e(ql(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=L_e(qa(e,yc(s.style)),s.style,c,t))}s.links.map(function(te){try{var re=Av(ql(e,c2(yc(te))),te);return W_e(qa(e,yc(te)),re,te,t)}catch{}});var d=M_e(qa(e,yc(s.workbooks[0])),s.workbooks[0],t),f={},h="";s.coreprops.length&&(h=qa(e,yc(s.coreprops[0]),!0),h&&(f=$q(h)),s.extprops.length!==0&&(h=qa(e,yc(s.extprops[0]),!0),h&&k1e(h,f,t)));var g={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=ql(e,yc(s.custprops[0]),!0),h&&(g=T1e(h,t)));var p={};if((t.bookSheets||t.bookProps)&&(d.Sheets?i=d.Sheets.map(function(re){return re.name}):f.Worksheets&&f.SheetNames.length>0&&(i=f.SheetNames),t.bookProps&&(p.Props=f,p.Custprops=g),t.bookSheets&&typeof i<"u"&&(p.SheetNames=i),t.bookSheets?p.SheetNames:t.bookProps))return p;i={};var x={};t.bookDeps&&s.calcchain&&(x=z_e(qa(e,yc(s.calcchain)),s.calcchain));var v=0,C={},b,_;{var T=d.Sheets;f.Worksheets=T.length,f.SheetNames=[];for(var N=0;N!=T.length;++N)f.SheetNames[N]=T[N].name}var E=a?"bin":"xml",F=s.workbooks[0].lastIndexOf("/"),j=(s.workbooks[0].slice(0,F+1)+"_rels/"+s.workbooks[0].slice(F+1)+".rels").replace(/^\//,"");kc(e,j)||(j="xl/_rels/workbook."+E+".rels");var P=Av(ql(e,j,!0),j.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=H_e(qa(e,yc(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=C2e(qa(e,yc(s.people[0])),t)),P&&(P=d3e(P,d.Sheets));var M=qa(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=f.Worksheets;++v){var I="sheet";if(P&&P[v]?(b="xl/"+P[v][1].replace(/[\/]?xl\//,""),kc(e,b)||(b=P[v][1]),kc(e,b)||(b=j.replace(/_rels\/.*$/,"")+P[v][1]),I=P[v][2]):(b="xl/worksheets/sheet"+(v+1-M)+"."+E,b=b.replace(/sheet0\./,"sheet.")),_=b.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(f.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var U=!1,K=0;K!=t.sheets.length;++K)typeof t.sheets[K]=="number"&&t.sheets[K]==v&&(U=1),typeof t.sheets[K]=="string"&&t.sheets[K].toLowerCase()==f.SheetNames[v].toLowerCase()&&(U=1);if(!U)continue e}}f3e(e,b,_,f.SheetNames[v],v,C,i,I,t,d,c,u)}return p={Directory:s,Workbook:d,Props:f,Custprops:g,Deps:x,Sheets:i,SheetNames:f.SheetNames,Strings:jv,Styles:u,Themes:c,SSF:Gs(on)},t&&t.bookFiles&&(e.files?(p.keys=n,p.files=e.files):(p.keys=[],p.files={},e.FullPaths.forEach(function(te,re){te=te.replace(/^Root Entry[\/]/,""),p.keys.push(te),p.files[te]=e.FileIndex[re]}))),t&&t.bookVBA&&(s.vba.length>0?p.vbaraw=qa(e,yc(s.vba[0]),!0):s.defaults&&s.defaults.bin===M2e&&(p.vbaraw=qa(e,"xl/vbaProject.bin",!0))),p}function m3e(e,t){var r=t||{},n="Workbook",s=Jr.find(e,n);try{if(n="/!DataSpaces/Version",s=Jr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Hye(s.content),n="/!DataSpaces/DataSpaceMap",s=Jr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=Vye(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Jr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=qye(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Jr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);Yye(s.content)}catch{}if(n="/EncryptionInfo",s=Jr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Xye(s.content);if(n="/EncryptedPackage",s=Jr.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function g3e(e,t){return t.bookType=="ods"?JK(e,t):t.bookType=="numbers"?c3e(e,t):t.bookType=="xlsb"?p3e(e,t):x3e(e,t)}function p3e(e,t){Gp=1024,e&&!e.SSF&&(e.SSF=Gs(on)),e&&e.SSF&&(Y1(),e3(e.SSF),t.revssf=r3(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pv?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=CK.indexOf(t.bookType)>-1,s=GE();iA(t=t||{});var a=PE(),i="",o=0;if(t.cellXfs=[],Ch(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",En(a,i,Uq(e.Props,t)),s.coreprops.push(i),ds(t.rels,2,i,In.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,En(a,i,Hq(e.Props)),s.extprops.push(i),ds(t.rels,3,i,In.EXT_PROPS),e.Custprops!==e.Props&&ka(e.Custprops||{}).length>0&&(i="docProps/custom.xml",En(a,i,Gq(e.Custprops)),s.custprops.push(i),ds(t.rels,4,i,In.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},f=e.Sheets[e.SheetNames[o-1]],h=(f||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,En(a,i,V_e(o-1,i,t,e,d)),s.sheets.push(i),ds(t.wbrels,-1,"worksheets/sheet"+o+"."+r,In.WS[0])}if(f){var g=f["!comments"],p=!1,x="";g&&g.length>0&&(x="xl/comments"+o+"."+r,En(a,x,Y_e(g,x)),s.comments.push(x),ds(d,-1,"../comments"+o+"."+r,In.CMNT),p=!0),f["!legacy"]&&p&&En(a,"xl/drawings/vmlDrawing"+o+".vml",SK(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&En(a,c2(i),r1(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,En(a,i,K_e(t.Strings,i,t)),s.strs.push(i),ds(t.wbrels,-1,"sharedStrings."+r,In.SST)),i="xl/workbook."+r,En(a,i,G_e(e,i)),s.workbooks.push(i),ds(t.rels,1,i,In.WB),i="xl/theme/theme1.xml",En(a,i,JE(e.Themes,t)),s.themes.push(i),ds(t.wbrels,-1,"theme/theme1.xml",In.THEME),i="xl/styles."+r,En(a,i,q_e(e,i,t)),s.styles.push(i),ds(t.wbrels,-1,"styles."+r,In.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",En(a,i,e.vbaraw),s.vba.push(i),ds(t.wbrels,-1,"vbaProject.bin",In.VBA)),i="xl/metadata."+r,En(a,i,X_e(i)),s.metadata.push(i),ds(t.wbrels,-1,"metadata."+r,In.XLMETA),En(a,"[Content_Types].xml",Lq(s,t)),En(a,"_rels/.rels",r1(t.rels)),En(a,"xl/_rels/workbook."+r+".rels",r1(t.wbrels)),delete t.revssf,delete t.ssf,a}function x3e(e,t){Gp=1024,e&&!e.SSF&&(e.SSF=Gs(on)),e&&e.SSF&&(Y1(),e3(e.SSF),t.revssf=r3(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Pv?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=CK.indexOf(t.bookType)>-1,s=GE();iA(t=t||{});var a=PE(),i="",o=0;if(t.cellXfs=[],Ch(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",En(a,i,Uq(e.Props,t)),s.coreprops.push(i),ds(t.rels,2,i,In.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,En(a,i,Hq(e.Props)),s.extprops.push(i),ds(t.rels,3,i,In.EXT_PROPS),e.Custprops!==e.Props&&ka(e.Custprops||{}).length>0&&(i="docProps/custom.xml",En(a,i,Gq(e.Custprops)),s.custprops.push(i),ds(t.rels,4,i,In.CUST_PROPS));var d=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],g=(h||{})["!type"]||"sheet";switch(g){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,En(a,i,DK(o-1,t,e,f)),s.sheets.push(i),ds(t.wbrels,-1,"worksheets/sheet"+o+"."+r,In.WS[0])}if(h){var p=h["!comments"],x=!1,v="";if(p&&p.length>0){var C=!1;p.forEach(function(b){b[1].forEach(function(_){_.T==!0&&(C=!0)})}),C&&(v="xl/threadedComments/threadedComment"+o+"."+r,En(a,v,k2e(p,d,t)),s.threadedcomments.push(v),ds(f,-1,"../threadedComments/threadedComment"+o+"."+r,In.TCMNT)),v="xl/comments"+o+"."+r,En(a,v,kK(p)),s.comments.push(v),ds(f,-1,"../comments"+o+"."+r,In.CMNT),x=!0}h["!legacy"]&&x&&En(a,"xl/drawings/vmlDrawing"+o+".vml",SK(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&En(a,c2(i),r1(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,En(a,i,dK(t.Strings,t)),s.strs.push(i),ds(t.wbrels,-1,"sharedStrings."+r,In.SST)),i="xl/workbook."+r,En(a,i,UK(e)),s.workbooks.push(i),ds(t.rels,1,i,In.WB),i="xl/theme/theme1.xml",En(a,i,JE(e.Themes,t)),s.themes.push(i),ds(t.wbrels,-1,"theme/theme1.xml",In.THEME),i="xl/styles."+r,En(a,i,vK(e,t)),s.styles.push(i),ds(t.wbrels,-1,"styles."+r,In.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",En(a,i,e.vbaraw),s.vba.push(i),ds(t.wbrels,-1,"vbaProject.bin",In.VBA)),i="xl/metadata."+r,En(a,i,_K()),s.metadata.push(i),ds(t.wbrels,-1,"metadata."+r,In.XLMETA),d.length>1&&(i="xl/persons/person.xml",En(a,i,T2e(d)),s.people.push(i),ds(t.wbrels,-1,"persons/person.xml",In.PEOPLE)),En(a,"[Content_Types].xml",Lq(s,t)),En(a,"_rels/.rels",r1(t.rels)),En(a,"xl/_rels/workbook."+r+".rels",r1(t.wbrels)),delete t.revssf,delete t.ssf,a}function oA(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ql(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function y3e(e,t){return Jr.find(e,"EncryptedPackage")?m3e(e,t):GK(e,t)}function v3e(e,t){var r,n=e,s=t||{};return s.type||(s.type=Mn&&Buffer.isBuffer(e)?"buffer":"base64"),r=hq(n,s),h3e(r,s)}function ZK(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return y8(e.slice(r),t);default:break e}return y1.to_workbook(e,t)}function b3e(e,t){var r="",n=oA(e,t);switch(t.type){case"base64":r=Ql(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=eg(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=bs(r)),t.type="binary",ZK(r,t)}function w3e(e,t){var r=e;return t.type=="base64"&&(r=Ql(r)),r=n2.utils.decode(1200,r.slice(2),"str"),t.type="binary",ZK(r,t)}function _3e(e){return e.match(/[^\x00-\x7F]/)?id(e):e}function G6(e,t,r,n){return n?(r.type="string",y1.to_workbook(e,r)):y1.to_workbook(t,r)}function w8(e,t){TE();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return w8(new Uint8Array(e),(r=Gs(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),s1={},r.dateNF&&(s1.dateNF=r.dateNF),r.type||(r.type=Mn&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Mn?"buffer":"binary",n=ppe(e),typeof Uint8Array<"u"&&!Mn&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=_3e(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=Gs(r),r.type="array",w8(NE(n),r)}switch((s=oA(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return y3e(Jr.read(n,r),r);break;case 9:if(s[1]<=8)return GK(n,r);break;case 60:return y8(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return Nye(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return cK.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?v3e(n,r):G6(e,n,r,a);case 239:return s[3]===60?y8(n,r):G6(e,n,r,a);case 255:if(s[1]===254)return w3e(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return Rm.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return Rm.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return x8.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return pK.to_workbook(n,r);break;case 10:case 13:case 32:return b3e(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Tye.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?x8.to_workbook(n,r):G6(e,n,r,a)}function eY(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Z2(t.file,Jr.write(e,{type:Mn?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Jr.write(e,t)}function S3e(e,t){var r=Gs(t||{}),n=g3e(e,r);return k3e(n,r)}function k3e(e,t){var r={},n=Mn?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Jr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(ZS(s))}return t.password&&typeof encrypt_agile<"u"?eY(encrypt_agile(s,t.password),t):t.type==="file"?Z2(t.file,s):t.type=="string"?bs(s):s}function C3e(e,t){var r=t||{},n=_Se(e,r);return eY(n,r)}function Qu(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return s2(id(n));case"binary":return id(n);case"string":return e;case"file":return Z2(t.file,n,"utf8");case"buffer":return Mn?I0(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Qu(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function T3e(e,t){switch(t.type){case"base64":return s2(e);case"binary":return e;case"string":return e;case"file":return Z2(t.file,e,"binary");case"buffer":return Mn?I0(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function a4(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?s2(r):t.type=="string"?bs(r):r;case"file":return Z2(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function tY(e,t){TE(),y_e(e);var r=Gs(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=tY(e,r);return r.type="array",ZS(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Qu(gSe(e,r),r);case"slk":case"sylk":return Qu(lK.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return Qu(qK(e.Sheets[e.SheetNames[s]],r),r);case"txt":return T3e(rY(e.Sheets[e.SheetNames[s]],r),r);case"csv":return Qu(lA(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return Qu(cK.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return a4(x8.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return Qu(y1.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return Qu(pK.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return Qu(uK.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return Qu(JK(e,r),r);case"wk1":return a4(Rm.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return a4(Rm.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),a4(VK(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),C3e(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return S3e(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function N3e(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function E3e(e,t,r){var n={};return n.type="file",n.file=t,N3e(n),tY(e,n)}function A3e(e,t,r,n,s,a,i,o){var c=La(r),u=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var g=t.s.c;g<=t.e.c;++g){var p=i?e[r][g]:e[n[g]+c];if(p===void 0||p.t===void 0){if(u===void 0)continue;a[g]!=null&&(h[a[g]]=u);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(a[g]!=null){if(x==null)if(p.t=="e"&&x===null)h[a[g]]=null;else if(u!==void 0)h[a[g]]=u;else if(d&&x===null)h[a[g]]=null;else continue;else h[a[g]]=d&&(p.t!=="n"||p.t==="n"&&o.rawNumbers!==!1)?x:E0(p,x,o);x!=null&&(f=!1)}}return{row:h,isempty:f}}function I_(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},d=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof d){case"string":c=Vn(d);break;case"number":c=Vn(e["!ref"]),c.s.r=d;break;default:c=d}n>0&&(s=0);var f=La(c.s.r),h=[],g=[],p=0,x=0,v=Array.isArray(e),C=c.s.r,b=0,_={};v&&!e[C]&&(e[C]=[]);var T=u.skipHidden&&e["!cols"]||[],N=u.skipHidden&&e["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(T[b]||{}).hidden)switch(h[b]=oa(b),r=v?e[C][b]:e[h[b]+f],n){case 1:a[b]=b-c.s.c;break;case 2:a[b]=h[b];break;case 3:a[b]=u.header[b-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=E0(r,null,u),x=_[i]||0,!x)_[i]=1;else{do o=i+"_"+x++;while(_[o]);_[i]=x,_[o]=1}a[b]=o}for(C=c.s.r+s;C<=c.e.r;++C)if(!(N[C]||{}).hidden){var E=A3e(e,c,C,h,n,a,v,u);(E.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(g[p++]=E.row)}return g.length=p,g}var tI=/"/g;function j3e(e,t,r,n,s,a,i,o){for(var c=!0,u=[],d="",f=La(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var g=o.dense?(e[r]||[])[h]:e[n[h]+f];if(g==null)d="";else if(g.v!=null){c=!1,d=""+(o.rawNumbers&&g.t=="n"?g.v:E0(g,null,o));for(var p=0,x=0;p!==d.length;++p)if((x=d.charCodeAt(p))===s||x===a||x===34||o.forceQuotes){d='"'+d.replace(tI,'""')+'"';break}d=="ID"&&(d='"ID"')}else g.f!=null&&!g.F?(c=!1,d="="+g.f,d.indexOf(",")>=0&&(d='"'+d.replace(tI,'""')+'"')):d="";u.push(d)}return o.blankrows===!1&&c?null:u.join(i)}function lA(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Vn(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),d="",f=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],g=n.skipHidden&&e["!rows"]||[],p=s.s.c;p<=s.e.c;++p)(h[p]||{}).hidden||(f[p]=oa(p));for(var x=0,v=s.s.r;v<=s.e.r;++v)(g[v]||{}).hidden||(d=j3e(e,s,v,f,i,c,a,n),d!=null&&(n.strip&&(d=d.replace(u,"")),(d||n.blankrows!==!1)&&r.push((x++?o:"")+d)));return delete n.dense,r.join("")}function rY(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=lA(e,t);return r}function P3e(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Vn(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=oa(o);for(var d=s.s.r;d<=s.e.r;++d)for(a=La(d),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[d]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function nY(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?la(n.origin):n.origin;i=c.r,o=c.c}var u,d={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var f=Vn(a["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),i==-1&&(i=f.e.r+1,d.e.r=i+t.length-1+s)}else i==-1&&(i=0,d.e.r=t.length-1+s);var h=n.header||[],g=0;t.forEach(function(x,v){ka(x).forEach(function(C){(g=h.indexOf(C))==-1&&(h[g=h.length]=C);var b=x[C],_="z",T="",N=cn({c:o+g,r:i+v+s});u=p2(a,N),b&&typeof b=="object"&&!(b instanceof Date)?a[N]=b:(typeof b=="number"?_="n":typeof b=="boolean"?_="b":typeof b=="string"?_="s":b instanceof Date?(_="d",n.cellDates||(_="n",b=gi(b)),T=n.dateNF||on[14]):b===null&&n.nullError&&(_="e",b=0),u?(u.t=_,u.v=b,delete u.w,delete u.R,T&&(u.z=T)):a[N]=u={t:_,v:b},T&&(u.z=T))})}),d.e.c=Math.max(d.e.c,o+h.length-1);var p=La(i);if(s)for(g=0;g<h.length;++g)a[oa(g+o)+p]={t:"s",v:h[g]};return a["!ref"]=Tn(d),a}function F3e(e,t){return nY(null,e,t)}function p2(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=la(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?p2(e,cn(t)):p2(e,cn({r:t,c:r||0}))}function M3e(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function cA(){return{SheetNames:[],Sheets:{}}}function uA(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if($K(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function R3e(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=M3e(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function O3e(e,t){return e.z=t,e}function sY(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function D3e(e,t,r){return sY(e,"#"+t,r)}function I3e(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function L3e(e,t,r,n){for(var s=typeof t!="string"?t:Vn(t),a=typeof t=="string"?t:Tn(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=p2(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var D4={encode_col:oa,encode_row:La,encode_cell:cn,encode_range:Tn,decode_col:BE,decode_row:LE,split_cell:Kpe,decode_cell:la,decode_range:Tl,format_cell:E0,sheet_add_aoa:Pq,sheet_add_json:nY,sheet_add_dom:KK,aoa_to_sheet:X1,json_to_sheet:F3e,table_to_sheet:YK,table_to_book:HSe,sheet_to_csv:lA,sheet_to_txt:rY,sheet_to_json:I_,sheet_to_html:qK,sheet_to_formulae:P3e,sheet_to_row_object_array:I_,sheet_get_cell:p2,book_new:cA,book_append_sheet:uA,book_set_sheet_visibility:R3e,cell_set_number_format:O3e,cell_set_hyperlink:sY,cell_set_internal_link:D3e,cell_add_comment:I3e,sheet_set_array_formula:L3e,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aY=({onBackToCabinet:e,selectedGrade:t,selectedClass:r,openRetestModal:n,forceRefreshOnMount:s=!1})=>{Za(),ku();const{user:a,isAuthenticated:i}=ws(),{showNotification:o}=Ls(),c=w.useCallback(Re=>{let Ye=null;if(typeof Re?.percentage=="number"&&!Number.isNaN(Re.percentage))return Ye=Math.round(Re.percentage),console.debug("[TeacherResults] Using provided percentage",{percentage:Re.percentage,rounded:Ye,result:Re}),Ye;const Tt=Re?.retest_best_score??Re?.score,St=Re?.retest_best_max_score??Re?.max_score,Cr=Number(Tt??0),jt=Number(St??0);return jt>0&&(Ye=Math.round(Cr/jt*100)),Ye},[]);w.useCallback(Re=>{const Ye=c(Re);return Ye===null?"text-gray-600":Ye<50?"text-red-600 font-semibold":Ye<70?"text-yellow-600":"text-green-600"},[c]),w.useCallback(Re=>{const Ye=c(Re);return Ye!==null&&Ye<50},[c]);const[u,d]=w.useState(null),[f,h]=w.useState(!0),[g,p]=w.useState(""),[x,v]=w.useState([]),[C,b]=w.useState(null),[_,T]=w.useState(!1),[N,E]=w.useState([]),[F,j]=w.useState([]),[P,M]=w.useState([1,2]),[I,U]=w.useState(null),[K,te]=w.useState(null),[re,Z]=w.useState(null),[B,J]=w.useState("main"),[z,q]=w.useState(null),[H,R]=w.useState(null),L=z||t,G=H||r,[W,Q]=w.useState(null),[X,se]=w.useState({}),[le,he]=w.useState(!1),[we,ie]=w.useState(new Set),[Ee,ye]=w.useState(!0),[Ie,ut]=w.useState(null),[Qe,$t]=w.useState(null),[Ge,et]=w.useState(!1),[vt,Te]=w.useState(!1),[Ve,pt]=w.useState(!1),wt=w.useRef(null),[Ut,ct]=w.useState(null),[yt,rt]=w.useState(!1),[Oe,$e]=w.useState(null),[Mt,It]=w.useState(!1),[At,tr]=w.useState(null),[ar,dr]=w.useState(""),[or,mr]=w.useState(""),[ve,Fe]=w.useState(!1),[Be,Pe]=w.useState(!1),[lt,Ct]=w.useState(null),[Lt,Ue]=w.useState(""),[st,dt]=w.useState(!1),[Bt,Yt]=w.useState(new Set),[xr,Rr]=w.useState({}),[yr,Br]=w.useState(!1),[me,Ne]=w.useState(null),[be,Ae]=w.useState(""),[ue,ge]=w.useState(!1),[Me,ot]=w.useState(null),[Je,nt]=w.useState(null),[mt,de]=w.useState(!1),[Se,De]=w.useState(!1),[Le,tt]=w.useState({isOpen:!1,testResult:null}),[qt,kr]=w.useState({}),jr=w.useRef(new Set),_t=w.useRef({}),ur=w.useRef(null);w.useEffect(()=>{console.log(" editingColumns state changed:",Array.from(Bt)),jr.current=Bt},[Bt]),w.useEffect(()=>{console.log(" columnScores state changed:",xr),_t.current=xr},[xr]);const Gr=w.useCallback(Re=>{console.log(" Toggling test collapse for:",Re),ie(Ye=>{const Tt=new Set(Ye);return Tt.has(Re)?(Tt.delete(Re),console.log(" Expanding test:",Re)):(Tt.add(Re),console.log(" Collapsing test:",Re)),console.log(" New collapsed tests:",Array.from(Tt)),Tt})},[]),Mr=w.useCallback(()=>{if(wt.current){const{scrollLeft:Re,scrollWidth:Ye,clientWidth:Tt}=wt.current;Te(Re>0),pt(Re<Ye-Tt-1)}},[]);w.useEffect(()=>{qr()},[]),w.useEffect(()=>{if(I&&wt.current){const Re=setTimeout(Mr,100);return()=>clearTimeout(Re)}},[I,Mr]),w.useEffect(()=>{console.log(" Current collapsed tests state:",Array.from(we))},[we]);const Tr=w.useCallback(async(Re,Ye=!1)=>{try{he(!0);const Tt=a?.teacher_id,St=`${L}/${G}`,Cr=await cme.getTeacherStudentResults(Tt,L,St,Re,Ye);if(Cr.success){console.log(" Results loaded for term:",Re,Cr.results?.length||0,"results"),console.log(" Students loaded:",Cr.students?.length||0,"students");const jt=[],en=new Set,Nn=new Set;Cr.results&&Cr.results.length>0&&Cr.results.forEach(lr=>{lr.test_name&&!en.has(lr.test_name)&&(en.add(lr.test_name),jt.push({test_name:lr.test_name,test_type:lr.test_type,subject:lr.subject})),lr.subject&&Nn.add(lr.subject)});const Xe=(Cr.students||[]).map(lr=>{const _s={};return(Cr.results||[]).filter(hn=>hn.student_id===lr.student_id).forEach(hn=>{hn.test_name&&(_s[hn.test_name]={id:hn.id,test_type:hn.test_type,test_id:hn.test_id,subject_id:hn.subject_id,score:hn.score,max_score:hn.max_score,retest_offered:hn.retest_offered,caught_cheating:hn.caught_cheating,visibility_change_times:hn.visibility_change_times,answers:hn.answers,ai_feedback:hn.ai_feedback,name:hn.name,surname:hn.surname,test_name:hn.test_name})}),{...lr,..._s}}),br={results:Cr.results||[],students:Xe,class:Xe,unique_tests:jt,subjects:Array.from(Nn),count:Cr.count||0,student_count:Cr.student_count||0};console.log(" Processed results data:",{uniqueTests:jt.length,subjects:Array.from(Nn),resultsCount:Cr.results?.length||0,studentsWithScores:Xe.length,sampleStudent:Xe[0]}),U(br),se(br),Z(new Date)}}catch(Tt){console.error(" Error loading results for term:",Tt),U(null),se(null)}finally{he(!1)}},[a,L,G]);w.useEffect(()=>{(async()=>{try{et(!0),await _u.loadAcademicCalendar();const Ye=_u.getCurrentSemesterTerms();$t(Ye),Ye?.currentTerm&&(ut(Ye.currentTerm.id),L&&G&&Tr(Ye.currentTerm.id,s))}catch(Ye){console.error(" Error initializing academic calendar:",Ye)}finally{et(!1)}})()},[L,G,Tr,s]),w.useEffect(()=>{t&&r&&(console.log(" Props detected:",{grade:t,class:r}),Qe?.currentTerm&&(ut(Qe.currentTerm.id),Tr(Qe.currentTerm.id,s)))},[t,r,Qe,Tr,s]);const qr=w.useCallback(async()=>{console.log(" Initializing teacher results...");try{if(h(!0),p(""),!i||!a){console.log(" User not authenticated"),p("User not authenticated");return}if(a.role!==Ko.TEACHER){console.error(" Invalid user role for teacher results:",a.role),p("Access denied. Teacher role required.");return}console.log(" Loading teacher assignments..."),await $r(),console.log(" TODO: Load academic calendar service"),console.log(" Teacher results initialization complete!")}catch(Re){console.error(" Error initializing teacher results:",Re),p("Failed to initialize teacher results")}finally{h(!1)}},[i,a]),$r=w.useCallback(async()=>{console.log(" Loading teacher assignments...");try{const Re=`teacher_data_${a?.teacher_id||a?.id||""}`;let Ye=Os(Re);Ye&&Ye.subjects&&Ye.subjects.length>0&&(Ye.subjects.some(Xe=>Xe.subject&&Xe.classes&&Xe.classes.length>0)||(console.log(" Cached data has invalid subject structure, forcing refresh"),localStorage.removeItem(Re),Ye=null)),Ye?console.log(" Cache HIT! Using cached teacher data"):(console.log(" Cache MISS! Fetching teacher data from API"),Ye=await Xs.getTeacherData(),console.log(" Teacher data loaded:",Ye),vs(Re,Ye,hs.teacher_subjects)),d(Ye);const Tt=[];Ye&&Ye.subjects&&(console.log(" Teacher subjects structure:",Ye.subjects),Ye.subjects.forEach(Nn=>{console.log(" Processing subject:",Nn),Nn.classes&&Nn.classes.forEach(Xe=>{Xe.grade&&Xe.class&&Tt.push({grade:Xe.grade,class:Xe.class,subject:Nn.subject||Nn.name||"Unknown Subject"})})})),j(Tt),console.log(" Available classes from teacher data:",Tt);const St=`teacher_tests_${a?.teacher_id||a?.id||""}`,Cr=Os(St);Cr&&Cr.some(Nn=>Nn.test_type==="drawing")&&(console.log(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(St));let jt=Os(St);jt?console.log(" Cache HIT! Using cached teacher tests"):(console.log(" Cache MISS! Fetching teacher tests from API"),jt=await Pn.getTeacherTests(),console.log(" Teacher tests loaded:",jt),vs(St,jt,hs.teacher_tests));const en=jt.flatMap(Nn=>Nn.assignments||[]);v(en),console.log(" Raw assignments data:",en),console.log(" Teacher assignments loaded:",en.length)}catch(Re){console.error(" Error loading teacher assignments:",Re),o("Failed to load teacher assignments","error")}},[o]),qn=w.useCallback(async(Re,Ye)=>{console.log(" Showing classes for grade:",Re,"class:",Ye),q(Re),R(Ye),b(null),U(null),Re&&Ye&&console.log(" TODO: Implement academic calendar service for term selection")},[]);w.useCallback((Re,Ye)=>{console.log(" Showing semesters for class:",Re,Ye),b(null),U(null),console.log(" TODO: Implement academic calendar service for term selection")},[]),w.useCallback((Re,Ye)=>{console.log(" Class clicked:",Re,Ye),T(!0),console.log(" TODO: Implement academic calendar service for term selection")},[]);const gr=w.useCallback(async(Re,Ye=!1)=>{!L||!G||(console.log(" Loading results for semester:",Re,"forceRefresh:",Ye),b(Re),Qe?.currentTerm&&await Tr(Qe.currentTerm.id,Ye))},[L,G,Qe,Tr]),pn=w.useCallback(()=>Qe?l.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Current Semester: ",Qe?.semester===1?"Semester 1":"Semester 2"]}),l.jsx("div",{className:"flex space-x-4",children:Qe?.terms.map(Re=>l.jsx(Ze.button,{className:`px-6 py-3 rounded-lg font-semibold transition-all duration-300 ${Re.isCurrent?"bg-blue-600 text-white shadow-lg":Ie===Re.id?"bg-green-500 text-white shadow-lg":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,onClick:()=>{ut(Re.id),Tr(Re.id)},whileHover:{scale:1.05},whileTap:{scale:.95},children:Re.label},Re.id))})]}):l.jsx("div",{className:"flex space-x-4 mb-6",children:l.jsx("div",{className:"px-6 py-3 rounded-lg bg-gray-200 text-gray-500",children:"Loading terms..."})}),[Qe,Ie,Tr]);w.useCallback(Re=>Re.reduce((Ye,Tt)=>(Ye[Tt.student_id]||(Ye[Tt.student_id]=[]),Ye[Tt.student_id].push(Tt),Ye),{}),[]),w.useCallback(Re=>{if(Re.length===0)return 0;const Ye=Re.reduce((Tt,St)=>Tt+(St.percentage||0),0);return Math.round(Ye/Re.length)},[]),w.useCallback(Re=>{Re.score<Re.passing_score&&window.confirm("Give another try?")&&Zr(Re.student_id,Re.test_id)},[]);const Zr=w.useCallback(async(Re,Ye)=>{try{(await fetch("/.netlify/functions/reset-test-attempt",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentId:Re,testId:Ye})})).ok&&(G&&gr(C,!0),o("Test made accessible to student","success"))}catch(Tt){console.error("Error resetting test attempt:",Tt),o("Failed to reset test attempt","error")}},[G,C,gr,o]),Zn=w.useCallback((Re,Ye)=>{if(Re===null||Ye===null)return"";const Tt=Math.round(Re/Ye*100);return Tt>=80?"text-green-600 bg-green-50":Tt>=60?"text-yellow-600 bg-yellow-50":"text-red-600 bg-red-50"},[]),Fn=w.useCallback(Re=>{ct(Re),rt(!0)},[]),Ce=w.useCallback((Re,Ye="overview",Tt)=>{try{const Cr=!!Re?.ai_feedback,jt=typeof Re?.ai_feedback;let en=[];if(Cr)if(jt==="string")try{en=Object.keys(JSON.parse(Re.ai_feedback))}catch{en=["<invalid json>"]}else jt==="object"&&(en=Object.keys(Re.ai_feedback||{}));console.log("[AI DEBUG] Opening speaking result",{hasAi:Cr,aiType:jt,aiKeys:en})}catch{}const St={...Re,__initialTab:Ye};Tt&&(St.__audioUrl=Tt),$e(St),It(!0)},[]),Dt=w.useCallback(async(Re,Ye)=>{if(!Re||!Ye)return console.error("fetchTestQuestions: Missing testType or testId",{testType:Re,testId:Ye}),null;const Tt=`${Re}_${Ye}`;if(qt[Tt])return console.log(" Using cached questions for",Tt),qt[Tt];De(!0);try{console.log(" Fetching questions for",{testType:Re,testId:Ye});const St=await Pn.getTestQuestions(Re,Ye);return console.log(" Questions fetched:",St?.length||0,"questions"),kr(Cr=>({...Cr,[Tt]:St})),St}catch(St){return console.error(" Error fetching test questions:",St),o("Failed to load test questions","error"),null}finally{De(!1)}},[qt,o]),Fr=w.useCallback(async(Re,Ye)=>{if(console.log(" Opening answer modal for:",{testResult:Re,test:Ye}),console.log(" [handleViewAnswers] testResult.answers:",Re?.answers),console.log(" [handleViewAnswers] testResult.answers type:",typeof Re?.answers),console.log(" [handleViewAnswers] testResult.retest_offered:",Re?.retest_offered),console.log(" [handleViewAnswers] Full testResult keys:",Re?Object.keys(Re):"null"),Re.test_type==="drawing"||Ye?.test_type==="drawing"){Fn(Re);return}if(Re.test_type==="speaking"||Ye?.test_type==="speaking"){Ce(Re);return}const Tt=Re.test_type||Ye?.test_type;if(Tt==="word_matching"||Tt==="matching_type"){o("Word matching and picture matching tests have separate view mechanisms","info");return}ot(Re),nt(null),de(!0),De(!0);const St=Re.test_id||Ye?.test_id;if(!Tt||!St){o("Unable to load test questions: Missing test type or ID","error"),De(!1);return}try{const Cr=await Dt(Tt,St);Cr?nt(Cr):o("Failed to load test questions","error")}finally{De(!1)}},[Dt,Fn,Ce,o]);w.useCallback((Re,Ye,Tt)=>{tr({resultId:Re,score:Ye,maxScore:Tt}),dr(Ye?.toString()||""),mr(Tt?.toString()||""),Pe(!0)},[]),w.useCallback(Re=>{dr(Re)},[]),w.useCallback(Re=>{mr(Re)},[]),w.useCallback(async()=>{if(At){Fe(!0);try{const Re={resultId:At.resultId,score:parseInt(ar)||0,maxScore:parseInt(or)||1};(await fetch(a0.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re)})).ok?(o("Score updated successfully","success"),G&&gr(C,!0),tr(null),dr(""),mr(""),Pe(!1)):o("Failed to update score","error")}catch(Re){console.error("Error updating score:",Re),o("Failed to update score","error")}finally{Fe(!1)}}},[At,ar,or,G,C,gr,o]),w.useCallback(()=>{tr(null),dr(""),mr(""),Pe(!1)},[]);const Kr=w.useCallback((Re,Ye)=>{Ct({resultId:Re,score:Ye}),Ue(Ye.toString())},[]),On=w.useCallback(async()=>{if(lt){dt(!0);try{const Re={resultId:lt.resultId,score:parseInt(Lt)||0},Ye=await fetch(a0.UPDATE_SPEAKING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Re)});if(Ye.ok){const Tt=await Ye.json();o("Speaking test score updated successfully","success"),Oe&&$e(St=>({...St,score:Tt.score,percentage:Tt.percentage})),G&&gr(C,!0),Ct(null),Ue("")}else{const Tt=await Ye.json();o(Tt.error||"Failed to update speaking test score","error")}}catch(Re){console.error("Error updating speaking test score:",Re),o("Failed to update speaking test score","error")}finally{dt(!1)}}},[lt,Lt,G,C,gr,o]),Qr=w.useCallback(()=>{Ct(null),Ue("")},[]),ns=(Re,Ye)=>{console.log(" Starting column editing for drawing test:",Re),console.log(" Current editingColumns before update:",Array.from(Bt)),console.log(" Results data passed to function:",Ye),Yt(Tt=>{const St=new Set(Tt).add(Re);return console.log(" Updated editingColumns:",Array.from(St)),St}),console.log(" Initializing column scores for test:",Re),console.log(" Results data:",Ye),console.log(" Results.class:","null"),console.log(" No results or class data available")},ta=w.useCallback(Re=>{Yt(Ye=>{const Tt=new Set(Ye);return Tt.delete(Re),Tt}),Rr(Ye=>{const Tt={...Ye};return delete Tt[Re],Tt})},[]),yi=w.useCallback((Re,Ye,Tt,St)=>{const Cr=St.toString();_t.current[Re]||(_t.current[Re]={}),_t.current[Re][Ye]||(_t.current[Re][Ye]={}),_t.current[Re][Ye][Tt]=Cr;const jt=parseInt(St)||0;Rr(en=>({...en,[Re]:{...en[Re],[Ye]:{...en[Re]?.[Ye],[Tt]:jt}}}))},[]);w.useCallback(async Re=>{if(_t.current[Re]){Br(!0);try{const Ye=Object.entries(_t.current[Re]).map(([jt,en])=>({resultId:en.resultId,score:parseInt(en.score)||0,maxScore:parseInt(en.maxScore)||100}));console.log(" Saving column scores for",Re,":",Ye);const Tt=Ye.map(jt=>(console.log(" Sending update:",jt),fetch(a0.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(jt)})));(await Promise.all(Tt)).every(jt=>jt.ok)?(o(`Scores updated successfully for ${Re}`,"success"),G&&gr(C,!0),ta(Re)):o("Failed to update some scores","error")}catch(Ye){console.error("Error updating column scores:",Ye),o("Failed to update scores","error")}finally{Br(!1)}}},[xr,G,C,gr,o,ta]);const xn=w.useCallback((Re,Ye,Tt)=>!Ye||Ye.length===0?l.jsx(Ze.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(Ze.div,{className:"relative",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:l.jsxs(Ze.div,{className:"bg-white rounded-lg shadow-lg overflow-hidden",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.4,delay:.1},children:[l.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:St=>{wt.current&&(wt.current.scrollLeft=St.target.scrollLeft)},children:l.jsx("div",{className:"min-w-full h-1",children:l.jsx("div",{className:"h-1",style:{width:`${(Tt.length+5)*120}px`}})})}),l.jsx("div",{ref:wt,className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",onScroll:St=>{Mr(St);const Cr=St.target.previousElementSibling;Cr&&(Cr.scrollLeft=St.target.scrollLeft)},children:l.jsxs("table",{className:"min-w-full border-collapse text-sm min-w-max",children:[l.jsx("thead",{children:l.jsxs(Ze.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-20 text-center",children:"Student ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 ${Ee?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[180px] bg-blue-50 cursor-pointer select-none"}`,onClick:St=>{St.preventDefault(),St.stopPropagation(),ye(!Ee)},title:"Toggle student name columns",children:Ee?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 w-16 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-4 py-4 text-left font-semibold text-gray-700 min-w-[100px]",children:"Nickname"}),Tt.map((St,Cr)=>{const jt=we.has(St.test_name),en=St.test_type==="drawing",Nn=jr.current.has(St.test_name);return console.log(` Rendering test ${St.test_name}:`,{isDrawingTest:en,isEditingColumn:Nn,editingColumns:Array.from(jr.current),test_type:St.test_type}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-4 text-left font-semibold text-gray-700 cursor-pointer hover:bg-blue-200 transition-colors select-none ${jt?"w-8 min-w-[32px] max-w-[32px] bg-gray-100":"min-w-[100px] bg-blue-50"}`,onClick:Xe=>{Xe.preventDefault(),Xe.stopPropagation(),Gr(St.test_name)},children:jt?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:St.test_name,children:St.test_name.length>8?St.test_name.substring(0,8)+"...":St.test_name}),l.jsx("svg",{className:"w-4 h-4 ml-1 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})},Cr)})]})}),l.jsx("tbody",{children:l.jsx(Ai,{children:Ye.map((St,Cr)=>l.jsxs(Ze.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Cr%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1+Cr*.05,ease:"easeOut"},whileHover:{scale:1.01,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.99},children:[l.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-center font-semibold text-gray-900",whileHover:{scale:1.05},transition:{duration:.2},children:St.student_id}),Ee?l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),ye(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:St.name}),l.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:St.surname})]}),l.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-center text-gray-900",whileHover:{scale:1.02},transition:{duration:.2},children:St.number??Cr+1}),l.jsx(Ze.td,{className:"border-b border-gray-100 px-4 py-4 text-gray-600",whileHover:{scale:1.02},transition:{duration:.2},children:St.nickname||"-"}),Tt.map((jt,en)=>{const Nn=we.has(jt.test_name),Xe=St[jt.test_name];return Nn?(console.log(" Rendering collapsed column for test:",jt.test_name),l.jsx("td",{className:"border-b border-gray-100 px-1 py-4 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:br=>{br.preventDefault(),br.stopPropagation(),console.log(" Clicked on collapsed arrow for:",jt.test_name),Gr(jt.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},en)):l.jsx(Ze.td,{className:"border-b border-gray-100 px-2 py-4 text-sm min-w-[100px]",initial:{width:0,opacity:0},animate:{width:"auto",opacity:1},transition:{duration:.3},whileHover:{scale:1.02},onClick:br=>{console.debug("[TeacherResults] Main table TD clicked",{testResult:Xe,student:St.student_id});const lr=Xe?.test_type||jt?.test_type;if(lr==="drawing"||lr==="speaking")return;const _s=c(Xe),_n=_s!==null&&_s<50;if(Xe?.retest_offered===!0&&(lr==="multiple_choice"||lr==="true_false"||lr==="input")){Fr(Xe,jt);return}if(lr==="fill_blanks"||lr==="matching_type"||lr==="word_matching")if(console.debug("[TeacherResults] Fill Blanks/Matching/Word Matching clicked",{testType:lr,isRed:_n,testResult:Xe}),_n){if(Xe?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:St.student_id,test:jt}),n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else console.debug("[TeacherResults] Opening edit score modal",{testResult:Xe}),tt({isOpen:!0,testResult:Xe});else if(_n){if(Xe?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] Main table TD -> opening retest modal",{studentId:St.student_id,test:jt}),n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else Fr(Xe,jt)},children:Xe&&Xe.test_type==="drawing"?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[l.jsx("button",{onClick:()=>Fn(Xe),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"View Drawing"}),(()=>{const br=`${jt.test_name}|${St.student_id}`,lr=me===br,_s=Number.isFinite(Xe?.score)?Xe.score:0;if(!lr){const _n=c(Xe),hn=_n!==null&&_n<50,Sn=_n!==null&&_n>=50&&_n<70,jn=Xe?.retest_offered===!0,sc=_n===null?"text-gray-600":hn?"text-red-600 font-semibold":Sn?"text-yellow-600":"text-green-600";return l.jsxs(Ze.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${sc} cursor-pointer hover:opacity-90 ${jn?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:hn?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:Li=>{Li.preventDefault(),Li.stopPropagation(),hn&&!jn?n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r}):(Ne(br),Ae(String(_s)))},title:jn?"Retest offered":hn?"Offer retest":"Double-click to edit score",children:[(()=>{const Li=Xe.retest_best_score??Xe.score,jh=Xe.retest_best_max_score??Xe.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:hn?"text-red-700":"",children:Li}),"/",l.jsx("span",{children:jh})]})})(),Xe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})}return l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:10,value:be,onChange:_n=>Ae(_n.target.value),onBlur:async()=>{const _n=Math.max(0,Math.min(10,parseFloat(be||"0")));ge(!0);try{const hn={resultId:Xe?.id,score:_n,maxScore:10},Sn=await(window.tokenManager?.getToken()||va.get())||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(a0.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:Sn?`Bearer ${Sn}`:""},body:JSON.stringify(hn)})).ok)throw new Error("Failed to save")}catch{}finally{ge(!1),Ne(null),gr(C,!0)}},onKeyDown:async _n=>{_n.key==="Enter"?_n.currentTarget.blur():_n.key==="Escape"&&Ne(null)},className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0",disabled:ue}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",value:10,className:"w-12 px-2 py-1 text-xs border border-gray-300 bg-gray-100 rounded",disabled:!0})]})})(),Xe.caught_cheating&&Xe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Xe.visibility_change_times,")"]})]}):Xe&&(Xe.test_type==="speaking"||jt.test_type==="speaking")?l.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[(()=>{const br=Xe?.answers;let lr;if(typeof br=="string")if(/^https?:\/\//i.test(br))lr=br;else try{lr=JSON.parse(br)?.audio_url}catch{}else br&&typeof br=="object"&&(lr=br.audio_url);return!lr&&Xe?.audio_url&&(lr=Xe.audio_url),l.jsx(l.Fragment,{children:l.jsx("button",{onClick:()=>Ce({...Xe,__studentId:St.student_id},"audio",lr),className:"text-blue-600 hover:text-blue-800 underline text-sm font-medium px-2 py-1 rounded hover:bg-blue-50",children:"Results"})})})(),(()=>{const br=jr.current.has(jt.test_name);return console.log(` Score cell for ${jt.test_name}:`,{isEditing:br,editingColumns:Array.from(jr.current),test_name:jt.test_name}),br})()?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Xe.max_score||100,value:_t.current[jt.test_name]?.[St.student_id]?.score||Xe.score||"",onChange:br=>yi(jt.test_name,St.student_id,"score",br.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:_t.current[jt.test_name]?.[St.student_id]?.maxScore||Xe.max_score||100,onChange:br=>yi(jt.test_name,St.student_id,"maxScore",br.target.value),className:"w-16 px-2 py-1 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):l.jsxs("div",{className:"px-2 py-1 rounded-full text-xs font-medium",onDoubleClick:()=>{console.log(" Double-clicked on speaking test score:",jt.test_name),console.log(" Results state at double-click:",I),console.log(" Test result:",Xe),console.log(" Student:",St),console.log(" Test:",jt),Xe&&Xe.id?(console.log(" Starting column editing for speaking test:",jt.test_name),ns(jt.test_name)):console.log(" No test result ID found, cannot edit")},title:"Double-click to edit scores",children:[(()=>{const br=c(Xe),lr=br!==null&&br<50,_s=br!==null&&br>=50&&br<70,_n=Xe.retest_offered,hn=br===null?"text-gray-600":lr?"text-red-600 font-semibold":_s?"text-yellow-600":"text-green-600";return l.jsxs(Ze.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${hn} cursor-pointer hover:opacity-90 ${_n?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:lr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:Sn=>{Sn.preventDefault(),Sn.stopPropagation(),lr&&!_n&&(console.log(" Offering retest for speaking test:",jt.test_name),n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r}))},title:_n?"Retest offered":lr?"Offer retest":'Use "View Results" button to review',children:[(()=>{const Sn=Xe.retest_best_score??Xe.score,jn=Xe.retest_best_max_score??Xe.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:lr?"text-red-700":"",children:Sn}),"/",l.jsx("span",{children:jn})]})})(),Xe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Xe.caught_cheating&&Xe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Xe.visibility_change_times,")"]})]})]}):Xe&&Xe.score!==null&&Xe.score!==void 0?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[(()=>{const br=c(Xe),lr=br!==null&&br<50,_s=br!==null&&br>=50&&br<70,_n=br===null?"text-gray-600":lr?"text-red-600 font-semibold":_s?"text-yellow-600":"text-green-600",hn=Xe?.retest_offered===!0;return l.jsxs(Ze.div,{className:`px-2 py-1 rounded-full text-xs font-medium ${_n} cursor-pointer hover:opacity-90 ${hn?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:lr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.1},transition:{duration:.2},onClick:Sn=>{Sn.preventDefault(),Sn.stopPropagation();const jn=Xe?.test_type||jt?.test_type;if(!(jn==="drawing"||jn==="speaking")){if(Xe?.retest_offered===!0&&(jn==="multiple_choice"||jn==="true_false"||jn==="input")){Fr(Xe,jt);return}if(jn==="fill_blanks"||jn==="matching_type"||jn==="word_matching"){if(console.debug("[TeacherResults] Score pill clicked (Fill Blanks/Matching/Word Matching)",{testType:jn,isRed:lr,testResult:Xe}),lr){if(Xe?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else console.debug("[TeacherResults] Opening edit score modal from score pill",{testResult:Xe}),tt({isOpen:!0,testResult:Xe});return}if(lr){if(Xe?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else Fr(Xe,jt)}},title:hn?"Click to view retest answers":lr?"Offer retest":"",children:[(()=>{const Sn=Xe.retest_best_score??Xe.score,jn=Xe.retest_best_max_score??Xe.max_score;return l.jsxs(l.Fragment,{children:[l.jsx("span",{className:lr?"text-red-700":"",children:Sn}),"/",l.jsx("span",{children:jn})]})})(),Xe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Xe.caught_cheating&&Xe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Xe.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},en)})]},Cr))})})]})})]})}),[Zn,we,Gr,Ee]),Al=w.useCallback((Re,Ye,Tt)=>!Ye||Ye.length===0?l.jsx(Ze.div,{className:"text-center py-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},children:l.jsx("p",{className:"text-gray-500",children:"No students found for this subject"})}):l.jsx(Ze.div,{className:"w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,ease:"easeOut"},children:l.jsx(Ze.div,{className:"overflow-x-auto -mx-4 px-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{duration:.3,delay:.1},children:l.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden min-w-max",children:l.jsxs("table",{className:"w-full border-collapse text-xs min-w-max",children:[l.jsx("thead",{children:l.jsxs(Ze.tr,{className:"bg-gradient-to-r from-blue-50 to-indigo-50",initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.2,delay:.2},children:[l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-16 text-center",children:"ID"}),l.jsx("th",{className:`border-b border-gray-200 px-2 py-3 text-left font-semibold text-gray-700 ${Ee?"w-8 min-w-[32px] max-w-[32px] bg-gray-100 cursor-pointer select-none":"min-w-[160px] bg-blue-50 cursor-pointer select-none"}`,onClick:St=>{St.preventDefault(),St.stopPropagation(),ye(!Ee)},title:"Toggle student name columns",children:Ee?l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}):l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("span",{className:"truncate",title:"Student Name",children:"Student Name"}),l.jsx("svg",{className:"w-3 h-3 ml-1 flex-shrink-0 transition-transform duration-200",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 w-12 text-center",children:"No."}),l.jsx("th",{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[80px]",children:"Nickname"}),Tt.map((St,Cr)=>(St.test_type,jr.current.has(St.test_name),l.jsx(Ze.th,{className:"border-b border-gray-200 px-3 py-3 text-left font-semibold text-gray-700 min-w-[100px]",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.3+Cr*.05},children:l.jsx("div",{className:"flex flex-col space-y-1",children:l.jsx("span",{className:"text-xs",children:St.test_name.length>10?St.test_name.substring(0,10)+"...":St.test_name})})},Cr)))]})}),l.jsx("tbody",{children:l.jsx(Ai,{children:Ye.map((St,Cr)=>l.jsxs(Ze.tr,{className:`border-b border-gray-100 hover:bg-blue-50 transition-colors duration-200 ${Cr%2===0?"bg-white":"bg-gray-50"}`,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.2,delay:.1+Cr*.03,ease:"easeOut"},whileHover:{scale:1.005,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.995},children:[l.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-center font-semibold text-gray-900",whileHover:{scale:1.03},transition:{duration:.15},children:St.student_id}),Ee?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-xs w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-3 h-3 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:jt=>{jt.preventDefault(),jt.stopPropagation(),ye(!1)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}):l.jsxs(l.Fragment,{children:[l.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:St.name}),l.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:St.surname})]}),l.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-center text-gray-900 truncate",whileHover:{scale:1.01},transition:{duration:.15},children:St.number??Cr+1}),l.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-gray-600 whitespace-normal break-words",whileHover:{scale:1.01},transition:{duration:.15},children:St.nickname||"-"}),Tt.map((jt,en)=>{const Nn=we.has(jt.test_name),Xe=St[jt.test_name];return Nn?l.jsx("td",{className:"border-b border-gray-100 px-1 py-3 text-sm w-8 min-w-[32px] max-w-[32px]",children:l.jsx("div",{className:"flex justify-center",children:l.jsx("svg",{className:"w-4 h-4 text-gray-400 cursor-pointer hover:text-gray-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",onClick:br=>{br.preventDefault(),br.stopPropagation(),Gr(jt.test_name)},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})},en):l.jsx(Ze.td,{className:"border-b border-gray-100 px-3 py-3 text-sm",whileHover:{scale:1.01},transition:{duration:.15},onClick:br=>{console.debug("[TeacherResults] TD clicked",{testResult:Xe,student:St.student_id});const lr=Xe?.test_type||jt?.test_type;if(lr==="drawing"||lr==="speaking")return;const _s=c(Xe),_n=_s!==null&&_s<50;if(Xe?.retest_offered===!0&&(lr==="multiple_choice"||lr==="true_false"||lr==="input")){Fr(Xe,jt);return}if(lr==="fill_blanks"||lr==="matching_type"||lr==="word_matching")if(console.debug("[TeacherResults] Fill Blanks/Matching/Word Matching clicked (nested table)",{testType:lr,isRed:_n,testResult:Xe}),_n){if(Xe?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:St.student_id}),n({failedStudentIds:[St.student_id],test_type:Xe.test_type,original_test_id:Xe.test_id,subject_id:Xe.subject_id,grade:t,class:r})}else console.debug("[TeacherResults] Opening edit score modal (nested table)",{testResult:Xe}),tt({isOpen:!0,testResult:Xe});else if(_n){if(Xe?.retest_offered){o("Retest is already offered","info");return}console.debug("[TeacherResults] TD -> opening retest modal",{studentId:St.student_id}),n({failedStudentIds:[St.student_id],test_type:Xe.test_type,original_test_id:Xe.test_id,subject_id:Xe.subject_id,grade:t,class:r})}else Fr(Xe,jt)},children:Xe&&(Xe.test_type==="drawing"||jt.test_type==="drawing"||Xe.test_type==="speaking"||jt.test_type==="speaking"||Xe.score!==null&&Xe.score!==void 0)?l.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[Xe.test_type==="drawing"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Fn(Xe),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View"}),jr.current.has(jt.test_name)?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Xe.max_score||100,value:_t.current[jt.test_name]?.[St.student_id]?.score||Xe.score||"",onChange:br=>yi(jt.test_name,St.student_id,"score",br.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("span",{className:"text-xs text-gray-500",children:"/"}),l.jsx("input",{type:"number",min:"1",value:_t.current[jt.test_name]?.[St.student_id]?.maxScore||Xe.max_score||100,onChange:br=>yi(jt.test_name,St.student_id,"maxScore",br.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Max"})]}):(()=>{const br=c(Xe),lr=br!==null&&br<50,_s=br!==null&&br>=50&&br<70,_n=Xe.retest_offered,hn=br===null?"text-gray-600":lr?"text-red-600 font-semibold":_s?"text-yellow-600":"text-green-600";return l.jsxs(Ze.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${hn} cursor-pointer hover:opacity-90 ${_n?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:lr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>ns(jt.test_name),onClick:Sn=>{Sn.preventDefault(),Sn.stopPropagation();const jn=Xe?.test_type||jt?.test_type;if(!(jn==="drawing"||jn==="speaking")){if(Xe?.retest_offered===!0&&(jn==="multiple_choice"||jn==="true_false"||jn==="input")){Fr(Xe,jt);return}if(lr){if(Xe?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else Fr(Xe,jt)}},title:_n?"Click to view retest answers":lr?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:lr?"text-red-700":"",children:Xe.score}),"/",l.jsx("span",{children:Xe.max_score}),Xe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):Xe.test_type==="speaking"||jt.test_type==="speaking"?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:()=>Ce({...Xe,__studentId:St.student_id},"audio"),className:"text-blue-600 hover:text-blue-800 underline text-xs font-medium px-1 py-0.5 rounded hover:bg-blue-50",children:"View Audio"}),lt&&lt.resultId===Xe.result_id?l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx("input",{type:"number",min:"0",max:Xe.max_score||100,value:Lt,onChange:br=>Ue(br.target.value),className:"w-12 px-1 py-0.5 text-xs border border-blue-500 bg-blue-50 rounded focus:ring-1 focus:ring-blue-500 focus:border-blue-500",placeholder:"Score"}),l.jsx("button",{onClick:()=>On(),disabled:st,className:"px-1 py-0.5 bg-green-600 text-white text-xs rounded hover:bg-green-700 disabled:opacity-50",children:st?"Saving...":"Save"}),l.jsx("button",{onClick:()=>Qr(),disabled:st,className:"px-1 py-0.5 bg-gray-500 text-white text-xs rounded hover:bg-gray-600 disabled:opacity-50",children:"Cancel"})]}):(()=>{const br=c(Xe),lr=br!==null&&br<50,_s=br!==null&&br>=50&&br<70,_n=Xe.retest_offered,hn=br===null?"text-gray-600":lr?"text-red-600 font-semibold":_s?"text-yellow-600":"text-green-600";return l.jsxs(Ze.div,{className:`px-1 py-0.5 rounded text-xs font-medium ${hn} cursor-pointer hover:opacity-90 ${_n?"bg-blue-50 text-blue-700 border border-blue-200":""}`,style:lr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onDoubleClick:()=>{Ct({resultId:Xe.result_id,score:Xe.score}),Ue(Xe.score?.toString()||"")},onClick:Sn=>{Sn.preventDefault(),Sn.stopPropagation();const jn=Xe?.test_type||jt?.test_type;if(!(jn==="drawing"||jn==="speaking")){if(Xe?.retest_offered===!0&&(jn==="multiple_choice"||jn==="true_false"||jn==="input")){Fr(Xe,jt);return}if(lr){if(Xe?.retest_offered){o("Retest is already offered","info");return}n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else Fr(Xe,jt)}},title:_n?"Click to view retest answers":lr?"Offer retest":"Click to view answers, double-click to edit score",children:[l.jsx("span",{className:lr?"text-red-700":"",children:Xe.score||0}),"/",l.jsx("span",{children:Xe.max_score||100}),Xe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})()]}):(()=>{const br=c(Xe),lr=br!==null&&br<50,_s=br!==null&&br>=50&&br<70,_n=br!==null&&br>=70,hn=Xe?.retest_offered===!0;console.debug("[TeacherResults] Render pill",{studentId:St.student_id,pct:br,isRed:lr,isYellow:_s,isGreen:_n,score:Xe.score,max:Xe.max_score,percentageField:Xe.percentage});const jn=`px-1 py-0.5 rounded text-xs font-medium ${br===null?"text-gray-600":lr?"text-red-600 font-semibold":_s?"text-yellow-600":"text-green-600"} cursor-pointer hover:opacity-90 pointer-events-auto ${hn?"bg-blue-50 text-blue-700 border border-blue-200":""}`;return l.jsxs(Ze.div,{className:jn,style:lr?{color:"#b91c1c"}:void 0,whileHover:{scale:1.05},transition:{duration:.15},onClick:sc=>{sc.preventDefault(),sc.stopPropagation();const Li=Xe?.test_type||jt?.test_type;if(!(Li==="drawing"||Li==="speaking")){if(Xe?.retest_offered===!0&&(Li==="multiple_choice"||Li==="true_false"||Li==="input")){Fr(Xe,jt);return}if(lr){if(Xe?.retest_offered){o("Retest is already offered","info");return}const jh=window.getComputedStyle(sc.currentTarget).color;console.debug("[TeacherResults] Red pill clicked -> opening retest modal",{studentId:St.student_id,className:jn,computedColor:jh}),n({failedStudentIds:[St.student_id],test_type:jt.test_type,original_test_id:Xe?.test_id||jt.test_id,subject_id:Xe?.subject_id||jt.subject_id,grade:t,class:r})}else Fr(Xe,jt)}},title:hn?"Click to view retest answers":lr?"Offer retest":"Click to view answers",children:[l.jsx("span",{className:lr?"text-red-700":"",children:Xe.score}),"/",l.jsx("span",{children:Xe.max_score}),Xe.caught_cheating&&l.jsx("span",{className:"ml-1",children:""})]})})(),Xe.caught_cheating&&Xe.visibility_change_times&&l.jsxs("span",{className:"text-xs text-red-600",children:["(",Xe.visibility_change_times,")"]})]}):l.jsx("span",{className:"text-gray-400",children:"-"})},en)})]},Cr))})})]})})})}),[Zn,we,Gr,Ee]),sl=w.useCallback(()=>{if(!I)return null;console.log(" renderResults - results:",I),console.log(" renderResults - results.class:",I.class),console.log(" renderResults - results.unique_tests:",I.unique_tests);const Re=I.class&&Array.isArray(I.class)&&I.class.length>0;if(console.log(" renderResults - hasStudentData:",Re),!Re)return console.log(" renderResults - No student data, showing no students message"),l.jsx("div",{className:"text-center py-8",children:l.jsx("p",{className:"text-gray-500",children:"No students found for this class and semester."})});const Ye=I.unique_tests||[];return console.log(" renderResults - uniqueTests:",Ye),ur.current=I,l.jsxs("div",{className:"space-y-6",children:[l.jsxs(Ze.div,{className:"bg-gradient-to-r from-red-500 to-pink-500 rounded-lg p-6 text-white",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[l.jsxs(Ze.h2,{className:"text-2xl font-bold mb-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.1},children:["Test Results - Grade M",L,", Class ",L,"/",G,", Semester ",C]}),l.jsxs(Ze.p,{className:"text-cyan-100",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:.2},children:["Viewing results for ",I.subjects?.length||0," subject(s)"]}),l.jsxs(Ze.div,{className:"mt-4 flex gap-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3,delay:.3},children:[l.jsx("button",{onClick:()=>{const Tt=I.unique_tests?.map(St=>St.test_name)||[];ie(new Set(Tt))},className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Collapse All Tests"}),l.jsx("button",{onClick:()=>ie(new Set),className:"px-3 py-1 bg-white/20 hover:bg-white/30 rounded text-sm font-medium transition-colors",children:"Expand All Tests"})]})]}),l.jsxs(Ze.div,{className:"bg-white rounded-lg shadow p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},children:[l.jsx(Ze.h3,{className:"text-lg font-semibold text-gray-900 mb-4",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},children:"Class Results"}),l.jsx("div",{className:"hidden md:block",children:xn("All Subjects",I.class,Ye)}),l.jsx("div",{className:"md:hidden",children:Al("All Subjects",I.class,Ye)})]})]})},[I,xn,L,G,C]),qe=w.useCallback(()=>{if(!I||!I.class||!I.unique_tests)return;const Re=["Student ID","Name","Surname","No.","Nickname",...I.unique_tests.map(en=>en.test_name)],Ye=I.class.map((en,Nn)=>{const Xe=[];return Xe.push(en.student_id),Xe.push(en.name),Xe.push(en.surname),Xe.push(en.number??Nn+1),Xe.push(en.nickname||"-"),I.unique_tests.forEach(br=>{const lr=en[br.test_name];lr&&lr.score!==null&&lr.score!==void 0?Xe.push(`${lr.score}/${lr.max_score}`):Xe.push("-")}),Xe}),Tt=D4.aoa_to_sheet([Re,...Ye]),St=D4.book_new(),Cr=[{wch:10},{wch:15},{wch:15},{wch:6},{wch:12},...I.unique_tests.map(()=>({wch:15}))];Tt["!cols"]=Cr,D4.book_append_sheet(St,Tt,"Class Results");const jt=`class-results-${L}-${G}-semester-${C}.xlsx`;E3e(St,jt),o("Excel file exported successfully!","success")},[I,L,G,C,o]);return f?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Results..."})]})}):g?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Results Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:g}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"flex justify-between items-center py-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Class Results"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",re?re.toLocaleString():"Never"]})]})})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Class"}),F.length>0?(()=>{const Re=F.reduce((Ye,Tt)=>{const St=Tt.subject||"Unknown Subject";return Ye[St]||(Ye[St]=[]),Ye[St].push(Tt),Ye},{});return l.jsx("div",{className:"space-y-6",children:Object.entries(Re).map(([Ye,Tt])=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 flex flex-col sm:flex-row sm:items-center items-center",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),Ye]}),l.jsxs("span",{className:"ml-0 sm:ml-2 text-sm text-gray-500 mt-1 sm:mt-0",children:["(",Tt.length," classes)"]})]}),l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:Tt.map((St,Cr)=>l.jsxs(at,{variant:L===St.grade&&G===St.class?"primary":"outline",onClick:()=>qn(St.grade,St.class),className:"px-3 py-1 text-xs font-medium min-w-[60px]",children:[St.grade,"/",St.class]},`${St.grade}-${St.class}-${Cr}`))})]},Ye))})})():l.jsx("p",{className:"text-gray-500",children:"No classes available"})]}),G&&pn(),G&&I&&l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("div",{className:"flex justify-between items-center mb-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[L," ",G," - Test Results ",Ie?`(Term ${Qe?.terms.find(Re=>Re.id===Ie)?.term})`:""]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs("button",{type:"button",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-2",onClick:qe,children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-4 h-4 object-contain"}),l.jsx("span",{className:"font-medium text-sm",children:"Export Excel"})]})})]}),sl()]}),G&&!I&&l.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:l.jsx("div",{className:"flex items-center justify-center py-8",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-gray-200 border-t-blue-500"}),l.jsx("span",{className:"text-gray-600",children:"Loading results"})]})})})]})}),Ut&&yt&&l.jsx(Kw,{children:l.jsx(VV,{drawing:Ut,isOpen:yt,onClose:()=>rt(!1),isTeacherView:!0,onSaveScore:async({resultId:Re,score:Ye,maxScore:Tt})=>{try{const St=await(window.tokenManager?.getToken()||va.get())||localStorage.getItem("accessToken")||localStorage.getItem("token");if(!(await fetch(a0.UPDATE_DRAWING_TEST_SCORE,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:St?`Bearer ${St}`:""},body:JSON.stringify({resultId:Re,score:Ye,maxScore:Tt})})).ok)throw new Error("Failed to save");await gr(C,!0)}catch{o("Failed to save drawing score","error")}}})}),l.jsx(Kw,{children:l.jsx(Dge,{onScoreUpdate:Re=>{G&&gr(C,!0),Me&&ot(Ye=>({...Ye,score:Re.score,max_score:Re.maxScore,percentage:Re.percentage}))},isOpen:mt,onClose:()=>{de(!1),ot(null),nt(null)},testResult:Me,questions:Je,isLoadingQuestions:Se})}),l.jsx(Kw,{children:l.jsx(Ige,{isOpen:Le.isOpen,onClose:()=>tt({isOpen:!1,testResult:null}),testResult:Le.testResult,onScoreUpdate:Re=>{G&&gr(C,!0)}})}),Oe&&Mt&&l.jsx(Kw,{children:l.jsx(Oge,{result:Oe,isOpen:Mt,onClose:()=>It(!1),initialTab:Oe.__initialTab||"overview",editingSpeakingScore:lt,tempSpeakingScore:Lt,isSavingSpeakingScore:st,onStartSpeakingScoreEdit:Kr,onSaveSpeakingScore:On,onCancelSpeakingScoreEdit:Qr,onTempSpeakingScoreChange:Ue})})]})},B3e={getTestPerformance:async(e,t=null)=>{try{await _u.loadAcademicCalendar();const n=_u.getCurrentTerm()?.id;if(!n)throw new Error("No current academic period found");console.log(` Fetching test performance for teacher ${e}, period ${n}, class: ${t||"all"}`);let s=`/.netlify/functions/get-test-performance?teacher_id=${e}&academic_period_id=${n}`;if(t){const[o,c]=t.split("/"),u=o.startsWith("M")?o:`M${o}`;s+=`&grade=${u}&class=${c}`}const a=await fetch(s,{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const i=await a.json();if(!i.success)throw new Error(i.error||"Failed to fetch performance data");return console.log(` Performance data loaded: ${i.count} tests`),i.data}catch(r){throw console.error(" Error fetching test performance:",r),r}}};function iY(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=iY(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Vs(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=iY(e))&&(n&&(n+=" "),n+=t);return n}var V6={},q6={},rI;function $3e(){return rI||(rI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(q6)),q6}var K6={},nI;function oY(){return nI||(nI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(K6)),K6}var Y6={},sI;function lY(){return sI||(sI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="string"||typeof r=="symbol"?r:Object.is(r?.valueOf?.(),-0)?"-0":String(r)}e.toKey=t})(Y6)),Y6}var X6={},aI;function dA(){return aI||(aI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],s=r.length;if(s===0)return n;let a=0,i="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<s;){const u=r[a];o?u==="\\"&&a+1<s?(a++,i+=r[a]):u===o?o="":i+=u:c?u==='"'||u==="'"?o=u:u==="]"?(c=!1,n.push(i),i=""):i+=u:u==="["?(c=!0,i&&(n.push(i),i="")):u==="."?i&&(n.push(i),i=""):i+=u,a++}return i&&n.push(i),n}e.toPath=t})(X6)),X6}var iI;function fA(){return iI||(iI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$3e(),r=oY(),n=lY(),s=dA();function a(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?r.isDeepKey(c)?a(o,s.toPath(c),u):u:d}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const d=o[c];return d===void 0?u:d}default:{if(Array.isArray(c))return i(o,c,u);if(Object.is(c?.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const d=o[c];return d===void 0?u:d}}}function i(o,c,u){if(c.length===0)return u;let d=o;for(let f=0;f<c.length;f++){if(d==null||t.isUnsafeProperty(c[f]))return u;d=d[c[f]]}return d===void 0?u:d}e.get=a})(V6)),V6}var J6,oI;function U3e(){return oI||(oI=1,J6=fA().get),J6}var z3e=U3e();const l3=ec(z3e);var Q6={exports:{}},as={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lI;function W3e(){if(lI)return as;lI=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,n=e?Symbol.for("react.fragment"):60107,s=e?Symbol.for("react.strict_mode"):60108,a=e?Symbol.for("react.profiler"):60114,i=e?Symbol.for("react.provider"):60109,o=e?Symbol.for("react.context"):60110,c=e?Symbol.for("react.async_mode"):60111,u=e?Symbol.for("react.concurrent_mode"):60111,d=e?Symbol.for("react.forward_ref"):60112,f=e?Symbol.for("react.suspense"):60113,h=e?Symbol.for("react.suspense_list"):60120,g=e?Symbol.for("react.memo"):60115,p=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,v=e?Symbol.for("react.fundamental"):60117,C=e?Symbol.for("react.responder"):60118,b=e?Symbol.for("react.scope"):60119;function _(N){if(typeof N=="object"&&N!==null){var E=N.$$typeof;switch(E){case t:switch(N=N.type,N){case c:case u:case n:case a:case s:case f:return N;default:switch(N=N&&N.$$typeof,N){case o:case d:case p:case g:case i:return N;default:return E}}case r:return E}}}function T(N){return _(N)===u}return as.AsyncMode=c,as.ConcurrentMode=u,as.ContextConsumer=o,as.ContextProvider=i,as.Element=t,as.ForwardRef=d,as.Fragment=n,as.Lazy=p,as.Memo=g,as.Portal=r,as.Profiler=a,as.StrictMode=s,as.Suspense=f,as.isAsyncMode=function(N){return T(N)||_(N)===c},as.isConcurrentMode=T,as.isContextConsumer=function(N){return _(N)===o},as.isContextProvider=function(N){return _(N)===i},as.isElement=function(N){return typeof N=="object"&&N!==null&&N.$$typeof===t},as.isForwardRef=function(N){return _(N)===d},as.isFragment=function(N){return _(N)===n},as.isLazy=function(N){return _(N)===p},as.isMemo=function(N){return _(N)===g},as.isPortal=function(N){return _(N)===r},as.isProfiler=function(N){return _(N)===a},as.isStrictMode=function(N){return _(N)===s},as.isSuspense=function(N){return _(N)===f},as.isValidElementType=function(N){return typeof N=="string"||typeof N=="function"||N===n||N===u||N===a||N===s||N===f||N===h||typeof N=="object"&&N!==null&&(N.$$typeof===p||N.$$typeof===g||N.$$typeof===i||N.$$typeof===o||N.$$typeof===d||N.$$typeof===v||N.$$typeof===C||N.$$typeof===b||N.$$typeof===x)},as.typeOf=_,as}var cI;function H3e(){return cI||(cI=1,Q6.exports=W3e()),Q6.exports}H3e();var Pc=e=>e===0?0:e>0?1:-1,$c=e=>typeof e=="number"&&e!=+e,_m=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,gn=e=>(typeof e=="number"||e instanceof Number)&&!$c(e),gd=e=>gn(e)||typeof e=="string",G3e=0,x2=e=>{var t=++G3e;return"".concat(e||"").concat(t)},mh=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!gn(t)&&typeof t!="string")return n;var a;if(_m(t)){if(r==null)return n;var i=t.indexOf("%");a=r*parseFloat(t.slice(0,i))/100}else a=+t;return $c(a)&&(a=n),s&&r!=null&&a>r&&(a=r),a},cY=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1};function i0(e,t,r){return gn(e)&&gn(t)?e+r*(t-e):t}function uY(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):l3(n,t))===r)}var Ri=e=>e===null||typeof e>"u",hA=e=>Ri(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),V3e=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function mA(e){if(typeof e!="string")return!1;var t=V3e;return t.includes(e)}var q3e=["viewBox","children"],uI=["points","pathLength"],Z6={svg:q3e,polygon:uI,polyline:uI},gA=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(w.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(s=>{mA(s)&&(n[s]=(a=>r[s](r,a)))}),n},K3e=(e,t,r)=>n=>(e(t,r,n),null),Y3e=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(s=>{var a=e[s];mA(s)&&typeof a=="function"&&(n||(n={}),n[s]=K3e(a,t,r))}),n},X3e=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function dY(e){if(typeof e!="string")return!1;var t=X3e;return t.includes(e)}function Sg(e){var t=Object.entries(e).filter(r=>{var[n]=r;return dY(n)});return Object.fromEntries(t)}var fY=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,J3e=(e,t,r,n)=>{var s;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(s=n&&Z6?.[n])!==null&&s!==void 0?s:[],i=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&a.includes(t)||dY(t)),c=!!r&&mA(t);return i||o||c},oo=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(w.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(a=>{var i;J3e((i=n)===null||i===void 0?void 0:i[a],a,t,r)&&(s[a]=n[a])}),s},Q3e=["children","width","height","viewBox","className","style","title","desc"];function _8(){return _8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_8.apply(null,arguments)}function Z3e(e,t){if(e==null)return{};var r,n,s=e5e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function e5e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var hY=w.forwardRef((e,t)=>{var{children:r,width:n,height:s,viewBox:a,className:i,style:o,title:c,desc:u}=e,d=Z3e(e,Q3e),f=a||{width:n,height:s,x:0,y:0},h=Vs("recharts-surface",i);return w.createElement("svg",_8({},oo(d,!0,"svg"),{className:h,width:n,height:s,style:o,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),w.createElement("title",null,c),w.createElement("desc",null,u),r)}),t5e=["children","className"];function S8(){return S8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},S8.apply(null,arguments)}function r5e(e,t){if(e==null)return{};var r,n,s=n5e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function n5e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Q1=w.forwardRef((e,t)=>{var{children:r,className:n}=e,s=r5e(e,t5e),a=Vs("recharts-layer",n);return w.createElement("g",S8({className:a},oo(s,!0),{ref:t}),r)}),s5e=w.createContext(null);function ya(e){return function(){return e}}const k8=Math.PI,C8=2*k8,hm=1e-6,a5e=C8-hm;function mY(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function i5e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return mY;const r=10**t;return function(n){this._+=n[0];for(let s=1,a=n.length;s<a;++s)this._+=Math.round(arguments[s]*r)/r+n[s]}}class o5e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?mY:i5e(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,s){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+s}`}bezierCurveTo(t,r,n,s,a,i){this._append`C${+t},${+r},${+n},${+s},${this._x1=+a},${this._y1=+i}`}arcTo(t,r,n,s,a){if(t=+t,r=+r,n=+n,s=+s,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,o=this._y1,c=n-t,u=s-r,d=i-t,f=o-r,h=d*d+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(h>hm)if(!(Math.abs(f*c-u*d)>hm)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let g=n-i,p=s-o,x=c*c+u*u,v=g*g+p*p,C=Math.sqrt(x),b=Math.sqrt(h),_=a*Math.tan((k8-Math.acos((x+h-v)/(2*C*b)))/2),T=_/b,N=_/C;Math.abs(T-1)>hm&&this._append`L${t+T*d},${r+T*f}`,this._append`A${a},${a},0,0,${+(f*g>d*p)},${this._x1=t+N*c},${this._y1=r+N*u}`}}arc(t,r,n,s,a,i){if(t=+t,r=+r,n=+n,i=!!i,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(s),c=n*Math.sin(s),u=t+o,d=r+c,f=1^i,h=i?s-a:a-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>hm||Math.abs(this._y1-d)>hm)&&this._append`L${u},${d}`,n&&(h<0&&(h=h%C8+C8),h>a5e?this._append`A${n},${n},0,1,${f},${t-o},${r-c}A${n},${n},0,1,${f},${this._x1=u},${this._y1=d}`:h>hm&&this._append`A${n},${n},0,${+(h>=k8)},${f},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+s}h${-n}Z`}toString(){return this._}}function gY(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new o5e(t)}function pA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pY(e){this._context=e}pY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function c3(e){return new pY(e)}function xY(e){return e[0]}function yY(e){return e[1]}function vY(e,t){var r=ya(!0),n=null,s=c3,a=null,i=gY(o);e=typeof e=="function"?e:e===void 0?xY:ya(e),t=typeof t=="function"?t:t===void 0?yY:ya(t);function o(c){var u,d=(c=pA(c)).length,f,h=!1,g;for(n==null&&(a=s(g=i())),u=0;u<=d;++u)!(u<d&&r(f=c[u],u,c))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+e(f,u,c),+t(f,u,c));if(g)return a=null,g+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:ya(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:ya(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:ya(!!c),o):r},o.curve=function(c){return arguments.length?(s=c,n!=null&&(a=s(n)),o):s},o.context=function(c){return arguments.length?(c==null?n=a=null:a=s(n=c),o):n},o}function i4(e,t,r){var n=null,s=ya(!0),a=null,i=c3,o=null,c=gY(u);e=typeof e=="function"?e:e===void 0?xY:ya(+e),t=typeof t=="function"?t:ya(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?yY:ya(+r);function u(f){var h,g,p,x=(f=pA(f)).length,v,C=!1,b,_=new Array(x),T=new Array(x);for(a==null&&(o=i(b=c())),h=0;h<=x;++h){if(!(h<x&&s(v=f[h],h,f))===C)if(C=!C)g=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=h-1;p>=g;--p)o.point(_[p],T[p]);o.lineEnd(),o.areaEnd()}C&&(_[h]=+e(v,h,f),T[h]=+t(v,h,f),o.point(n?+n(v,h,f):_[h],r?+r(v,h,f):T[h]))}if(b)return o=null,b+""||null}function d(){return vY().defined(s).curve(i).context(a)}return u.x=function(f){return arguments.length?(e=typeof f=="function"?f:ya(+f),n=null,u):e},u.x0=function(f){return arguments.length?(e=typeof f=="function"?f:ya(+f),u):e},u.x1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ya(+f),u):n},u.y=function(f){return arguments.length?(t=typeof f=="function"?f:ya(+f),r=null,u):t},u.y0=function(f){return arguments.length?(t=typeof f=="function"?f:ya(+f),u):t},u.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ya(+f),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(t)},u.defined=function(f){return arguments.length?(s=typeof f=="function"?f:ya(!!f),u):s},u.curve=function(f){return arguments.length?(i=f,a!=null&&(o=i(a)),u):i},u.context=function(f){return arguments.length?(f==null?a=o=null:o=i(a=f),u):a},u}class bY{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function l5e(e){return new bY(e,!0)}function c5e(e){return new bY(e,!1)}function L_(){}function B_(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function wY(e){this._context=e}wY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:B_(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:B_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function u5e(e){return new wY(e)}function _Y(e){this._context=e}_Y.prototype={areaStart:L_,areaEnd:L_,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:B_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function d5e(e){return new _Y(e)}function SY(e){this._context=e}SY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:B_(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function f5e(e){return new SY(e)}function kY(e){this._context=e}kY.prototype={areaStart:L_,areaEnd:L_,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function h5e(e){return new kY(e)}function dI(e){return e<0?-1:1}function fI(e,t,r){var n=e._x1-e._x0,s=t-e._x1,a=(e._y1-e._y0)/(n||s<0&&-0),i=(r-e._y1)/(s||n<0&&-0),o=(a*s+i*n)/(n+s);return(dI(a)+dI(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(o))||0}function hI(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function ek(e,t,r){var n=e._x0,s=e._y0,a=e._x1,i=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,s+o*t,a-o,i-o*r,a,i)}function $_(e){this._context=e}$_.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ek(this,this._t0,hI(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ek(this,hI(this,r=fI(this,e,t)),r);break;default:ek(this,this._t0,r=fI(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function CY(e){this._context=new TY(e)}(CY.prototype=Object.create($_.prototype)).point=function(e,t){$_.prototype.point.call(this,t,e)};function TY(e){this._context=e}TY.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,s,a){this._context.bezierCurveTo(t,e,n,r,a,s)}};function m5e(e){return new $_(e)}function g5e(e){return new CY(e)}function NY(e){this._context=e}NY.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=mI(e),s=mI(t),a=0,i=1;i<r;++a,++i)this._context.bezierCurveTo(n[0][a],s[0][a],n[1][a],s[1][a],e[i],t[i]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function mI(e){var t,r=e.length-1,n,s=new Array(r),a=new Array(r),i=new Array(r);for(s[0]=0,a[0]=2,i[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,a[t]=4,i[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,a[r-1]=7,i[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=s[t]/a[t-1],a[t]-=n,i[t]-=n*i[t-1];for(s[r-1]=i[r-1]/a[r-1],t=r-2;t>=0;--t)s[t]=(i[t]-s[t+1])/a[t];for(a[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-s[t+1];return[s,a]}function p5e(e){return new NY(e)}function u3(e,t){this._context=e,this._t=t}u3.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function x5e(e){return new u3(e,.5)}function y5e(e){return new u3(e,0)}function v5e(e){return new u3(e,1)}function b1(e,t){if((i=e.length)>1)for(var r=1,n,s,a=e[t[0]],i,o=a.length;r<i;++r)for(s=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(s[n][1])?s[n][0]:s[n][1]}function T8(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function b5e(e,t){return e[t]}function w5e(e){const t=[];return t.key=e,t}function _5e(){var e=ya([]),t=T8,r=b1,n=b5e;function s(a){var i=Array.from(e.apply(this,arguments),w5e),o,c=i.length,u=-1,d;for(const f of a)for(o=0,++u;o<c;++o)(i[o][u]=[0,+n(f,i[o].key,u,a)]).data=f;for(o=0,d=pA(t(i));o<c;++o)i[d[o]].index=o;return r(i,d),i}return s.keys=function(a){return arguments.length?(e=typeof a=="function"?a:ya(Array.from(a)),s):e},s.value=function(a){return arguments.length?(n=typeof a=="function"?a:ya(+a),s):n},s.order=function(a){return arguments.length?(t=a==null?T8:typeof a=="function"?a:ya(Array.from(a)),s):t},s.offset=function(a){return arguments.length?(r=a??b1,s):r},s}function S5e(e,t){if((n=e.length)>0){for(var r,n,s=0,a=e[0].length,i;s<a;++s){for(i=r=0;r<n;++r)i+=e[r][s][1]||0;if(i)for(r=0;r<n;++r)e[r][s][1]/=i}b1(e,t)}}function k5e(e,t){if((s=e.length)>0){for(var r=0,n=e[t[0]],s,a=n.length;r<a;++r){for(var i=0,o=0;i<s;++i)o+=e[i][r][1]||0;n[r][1]+=n[r][0]=-o/2}b1(e,t)}}function C5e(e,t){if(!(!((i=e.length)>0)||!((a=(s=e[t[0]]).length)>0))){for(var r=0,n=1,s,a,i;n<a;++n){for(var o=0,c=0,u=0;o<i;++o){for(var d=e[t[o]],f=d[n][1]||0,h=d[n-1][1]||0,g=(f-h)/2,p=0;p<o;++p){var x=e[t[p]],v=x[n][1]||0,C=x[n-1][1]||0;g+=v-C}c+=f,u+=g*f}s[n-1][1]+=s[n-1][0]=r,c&&(r-=u/c)}s[n-1][1]+=s[n-1][0]=r,b1(e,t)}}var tk={},rk={},gI;function T5e(){return gI||(gI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const s=new Map;for(let a=0;a<r.length;a++){const i=r[a],o=n(i);s.has(o)||s.set(o,i)}return Array.from(s.values())}e.uniqBy=t})(rk)),rk}var nk={},pI;function EY(){return pI||(pI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(nk)),nk}var sk={},ak={},ik={},xI;function N5e(){return xI||(xI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(ik)),ik}var yI;function xA(){return yI||(yI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=N5e();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(ak)),ak}var ok={},vI;function E5e(){return vI||(vI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(ok)),ok}var bI;function A5e(){return bI||(bI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xA(),r=E5e();function n(s){return r.isObjectLike(s)&&t.isArrayLike(s)}e.isArrayLikeObject=n})(sk)),sk}var lk={},ck={},wI;function j5e(){return wI||(wI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fA();function r(n){return function(s){return t.get(s,n)}}e.property=r})(ck)),ck}var uk={},dk={},fk={},hk={},_I;function AY(){return _I||(_I=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(hk)),hk}var mk={},SI;function jY(){return SI||(SI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(mk)),mk}var gk={},kI;function PY(){return kI||(kI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(gk)),gk}var CI;function P5e(){return CI||(CI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yA(),r=AY(),n=jY(),s=PY();function a(f,h,g){return typeof g!="function"?t.isMatch(f,h):i(f,h,function p(x,v,C,b,_,T){const N=g(x,v,C,b,_,T);return N!==void 0?!!N:i(x,v,p,T)},new Map)}function i(f,h,g,p){if(h===f)return!0;switch(typeof h){case"object":return o(f,h,g,p);case"function":return Object.keys(h).length>0?i(f,{...h},g,p):s.eq(f,h);default:return r.isObject(f)?typeof h=="string"?h==="":!0:s.eq(f,h)}}function o(f,h,g,p){if(h==null)return!0;if(Array.isArray(h))return u(f,h,g,p);if(h instanceof Map)return c(f,h,g,p);if(h instanceof Set)return d(f,h,g,p);const x=Object.keys(h);if(f==null)return x.length===0;if(x.length===0)return!0;if(p&&p.has(h))return p.get(h)===f;p&&p.set(h,f);try{for(let v=0;v<x.length;v++){const C=x[v];if(!n.isPrimitive(f)&&!(C in f)||h[C]===void 0&&f[C]!==void 0||h[C]===null&&f[C]!==null||!g(f[C],h[C],C,f,h,p))return!1}return!0}finally{p&&p.delete(h)}}function c(f,h,g,p){if(h.size===0)return!0;if(!(f instanceof Map))return!1;for(const[x,v]of h.entries()){const C=f.get(x);if(g(C,v,x,f,h,p)===!1)return!1}return!0}function u(f,h,g,p){if(h.length===0)return!0;if(!Array.isArray(f))return!1;const x=new Set;for(let v=0;v<h.length;v++){const C=h[v];let b=!1;for(let _=0;_<f.length;_++){if(x.has(_))continue;const T=f[_];let N=!1;if(g(T,C,v,f,h,p)&&(N=!0),N){x.add(_),b=!0;break}}if(!b)return!1}return!0}function d(f,h,g,p){return h.size===0?!0:f instanceof Set?u([...f],[...h],g,p):!1}e.isMatchWith=a,e.isSetMatch=d})(fk)),fk}var TI;function yA(){return TI||(TI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=P5e();function r(n,s){return t.isMatchWith(n,s,()=>{})}e.isMatch=r})(dk)),dk}var pk={},xk={},yk={},NI;function F5e(){return NI||(NI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(yk)),yk}var vk={},EI;function FY(){return EI||(EI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(vk)),vk}var bk={},AI;function MY(){return AI||(AI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",s="[object Boolean]",a="[object Arguments]",i="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",d="[object Array]",f="[object Function]",h="[object ArrayBuffer]",g="[object Object]",p="[object Error]",x="[object DataView]",v="[object Uint8Array]",C="[object Uint8ClampedArray]",b="[object Uint16Array]",_="[object Uint32Array]",T="[object BigUint64Array]",N="[object Int8Array]",E="[object Int16Array]",F="[object Int32Array]",j="[object BigInt64Array]",P="[object Float32Array]",M="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=h,e.arrayTag=d,e.bigInt64ArrayTag=j,e.bigUint64ArrayTag=T,e.booleanTag=s,e.dataViewTag=x,e.dateTag=o,e.errorTag=p,e.float32ArrayTag=P,e.float64ArrayTag=M,e.functionTag=f,e.int16ArrayTag=E,e.int32ArrayTag=F,e.int8ArrayTag=N,e.mapTag=c,e.numberTag=n,e.objectTag=g,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=i,e.uint16ArrayTag=b,e.uint32ArrayTag=_,e.uint8ArrayTag=v,e.uint8ClampedArrayTag=C})(bk)),bk}var wk={},jI;function M5e(){return jI||(jI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(wk)),wk}var PI;function RY(){return PI||(PI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=F5e(),r=FY(),n=MY(),s=jY(),a=M5e();function i(d,f){return o(d,void 0,d,new Map,f)}function o(d,f,h,g=new Map,p=void 0){const x=p?.(d,f,h,g);if(x!==void 0)return x;if(s.isPrimitive(d))return d;if(g.has(d))return g.get(d);if(Array.isArray(d)){const v=new Array(d.length);g.set(d,v);for(let C=0;C<d.length;C++)v[C]=o(d[C],C,h,g,p);return Object.hasOwn(d,"index")&&(v.index=d.index),Object.hasOwn(d,"input")&&(v.input=d.input),v}if(d instanceof Date)return new Date(d.getTime());if(d instanceof RegExp){const v=new RegExp(d.source,d.flags);return v.lastIndex=d.lastIndex,v}if(d instanceof Map){const v=new Map;g.set(d,v);for(const[C,b]of d)v.set(C,o(b,C,h,g,p));return v}if(d instanceof Set){const v=new Set;g.set(d,v);for(const C of d)v.add(o(C,void 0,h,g,p));return v}if(typeof Buffer<"u"&&Buffer.isBuffer(d))return d.subarray();if(a.isTypedArray(d)){const v=new(Object.getPrototypeOf(d)).constructor(d.length);g.set(d,v);for(let C=0;C<d.length;C++)v[C]=o(d[C],C,h,g,p);return v}if(d instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&d instanceof SharedArrayBuffer)return d.slice(0);if(d instanceof DataView){const v=new DataView(d.buffer.slice(0),d.byteOffset,d.byteLength);return g.set(d,v),c(v,d,h,g,p),v}if(typeof File<"u"&&d instanceof File){const v=new File([d],d.name,{type:d.type});return g.set(d,v),c(v,d,h,g,p),v}if(d instanceof Blob){const v=new Blob([d],{type:d.type});return g.set(d,v),c(v,d,h,g,p),v}if(d instanceof Error){const v=new d.constructor;return g.set(d,v),v.message=d.message,v.name=d.name,v.stack=d.stack,v.cause=d.cause,c(v,d,h,g,p),v}if(typeof d=="object"&&u(d)){const v=Object.create(Object.getPrototypeOf(d));return g.set(d,v),c(v,d,h,g,p),v}return d}function c(d,f,h=d,g,p){const x=[...Object.keys(f),...t.getSymbols(f)];for(let v=0;v<x.length;v++){const C=x[v],b=Object.getOwnPropertyDescriptor(d,C);(b==null||b.writable)&&(d[C]=o(f[C],C,h,g,p))}}function u(d){switch(r.getTag(d)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=i,e.cloneDeepWithImpl=o,e.copyProperties=c})(xk)),xk}var FI;function R5e(){return FI||(FI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RY();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(pk)),pk}var MI;function O5e(){return MI||(MI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yA(),r=R5e();function n(s){return s=r.cloneDeep(s),a=>t.isMatch(a,s)}e.matches=n})(uk)),uk}var _k={},Sk={},kk={},RI;function D5e(){return RI||(RI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=RY(),r=MY();function n(s,a){return t.cloneDeepWith(s,(i,o,c,u)=>{const d=a?.(i,o,c,u);if(d!==void 0)return d;if(typeof s=="object")switch(Object.prototype.toString.call(s)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new s.constructor(s?.valueOf());return t.copyProperties(f,s),f}case r.argumentsTag:{const f={};return t.copyProperties(f,s),f.length=s.length,f[Symbol.iterator]=s[Symbol.iterator],f}default:return}})}e.cloneDeepWith=n})(kk)),kk}var OI;function I5e(){return OI||(OI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D5e();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Sk)),Sk}var Ck={},Tk={},DI;function OY(){return DI||(DI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,s=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<s;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Tk)),Tk}var Nk={},II;function L5e(){return II||(II=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=FY();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(Nk)),Nk}var LI;function B5e(){return LI||(LI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oY(),r=OY(),n=L5e(),s=dA();function a(i,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&i?.[o]==null?c=s.toPath(o):c=[o],c.length===0)return!1;let u=i;for(let d=0;d<c.length;d++){const f=c[d];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}e.has=a})(Ck)),Ck}var BI;function $5e(){return BI||(BI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=yA(),r=lY(),n=I5e(),s=fA(),a=B5e();function i(o,c){switch(typeof o){case"object":{Object.is(o?.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const d=s.get(u,o);return d===void 0?a.has(u,o):c===void 0?d===void 0:t.isMatch(d,c)}}e.matchesProperty=i})(_k)),_k}var $I;function U5e(){return $I||($I=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=EY(),r=j5e(),n=O5e(),s=$5e();function a(i){if(i==null)return t.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?s.matchesProperty(i[0],i[1]):n.matches(i);case"string":case"symbol":case"number":return r.property(i)}}e.iteratee=a})(lk)),lk}var UI;function z5e(){return UI||(UI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=T5e(),r=EY(),n=A5e(),s=U5e();function a(i,o=r.identity){return n.isArrayLikeObject(i)?t.uniqBy(Array.from(i),s.iteratee(o)):[]}e.uniqBy=a})(tk)),tk}var Ek,zI;function W5e(){return zI||(zI=1,Ek=z5e().uniqBy),Ek}var H5e=W5e();const WI=ec(H5e);function G5e(e,t,r){return t===!0?WI(e,r):typeof t=="function"?WI(e,t):e}var Ak={exports:{}},jk={},Pk={exports:{}},Fk={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HI;function V5e(){if(HI)return Fk;HI=1;var e=dg();function t(f,h){return f===h&&(f!==0||1/f===1/h)||f!==f&&h!==h}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,s=e.useEffect,a=e.useLayoutEffect,i=e.useDebugValue;function o(f,h){var g=h(),p=n({inst:{value:g,getSnapshot:h}}),x=p[0].inst,v=p[1];return a(function(){x.value=g,x.getSnapshot=h,c(x)&&v({inst:x})},[f,g,h]),s(function(){return c(x)&&v({inst:x}),f(function(){c(x)&&v({inst:x})})},[f]),i(g),g}function c(f){var h=f.getSnapshot;f=f.value;try{var g=h();return!r(f,g)}catch{return!0}}function u(f,h){return h()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:o;return Fk.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:d,Fk}var GI;function q5e(){return GI||(GI=1,Pk.exports=V5e()),Pk.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VI;function K5e(){if(VI)return jk;VI=1;var e=dg(),t=q5e();function r(u,d){return u===d&&(u!==0||1/u===1/d)||u!==u&&d!==d}var n=typeof Object.is=="function"?Object.is:r,s=t.useSyncExternalStore,a=e.useRef,i=e.useEffect,o=e.useMemo,c=e.useDebugValue;return jk.useSyncExternalStoreWithSelector=function(u,d,f,h,g){var p=a(null);if(p.current===null){var x={hasValue:!1,value:null};p.current=x}else x=p.current;p=o(function(){function C(E){if(!b){if(b=!0,_=E,E=h(E),g!==void 0&&x.hasValue){var F=x.value;if(g(F,E))return T=F}return T=E}if(F=T,n(_,E))return F;var j=h(E);return g!==void 0&&g(F,j)?(_=E,F):(_=E,T=j)}var b=!1,_,T,N=f===void 0?null:f;return[function(){return C(d())},N===null?void 0:function(){return C(N())}]},[d,f,h,g]);var v=s(u,p[0],p[1]);return i(function(){x.hasValue=!0,x.value=v},[v]),c(v),v},jk}var qI;function Y5e(){return qI||(qI=1,Ak.exports=K5e()),Ak.exports}var X5e=Y5e(),vA=w.createContext(null),J5e=e=>e,nl=()=>{var e=w.useContext(vA);return e?e.store.dispatch:J5e},I4=()=>{},Q5e=()=>I4,Z5e=(e,t)=>e===t;function an(e){var t=w.useContext(vA);return X5e.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:Q5e,t?t.store.getState:I4,t?t.store.getState:I4,t?e:I4,Z5e)}function e6e(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function t6e(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function r6e(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var KI=e=>Array.isArray(e)?e:[e];function n6e(e){const t=Array.isArray(e[0])?e[0]:e;return r6e(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function s6e(e,t){const r=[],{length:n}=e;for(let s=0;s<n;s++)r.push(e[s].apply(null,t));return r}var a6e=class{constructor(e){this.value=e}deref(){return this.value}},i6e=typeof WeakRef<"u"?WeakRef:a6e,o6e=0,YI=1;function o4(){return{s:o6e,v:void 0,o:null,p:null}}function DY(e,t={}){let r=o4();const{resultEqualityCheck:n}=t;let s,a=0;function i(){let o=r;const{length:c}=arguments;for(let f=0,h=c;f<h;f++){const g=arguments[f];if(typeof g=="function"||typeof g=="object"&&g!==null){let p=o.o;p===null&&(o.o=p=new WeakMap);const x=p.get(g);x===void 0?(o=o4(),p.set(g,o)):o=x}else{let p=o.p;p===null&&(o.p=p=new Map);const x=p.get(g);x===void 0?(o=o4(),p.set(g,o)):o=x}}const u=o;let d;if(o.s===YI)d=o.v;else if(d=e.apply(null,arguments),a++,n){const f=s?.deref?.()??s;f!=null&&n(f,d)&&(d=f,a!==0&&a--),s=typeof d=="object"&&d!==null||typeof d=="function"?new i6e(d):d}return u.s=YI,u.v=d,d}return i.clearCache=()=>{r=o4(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function l6e(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...s)=>{let a=0,i=0,o,c={},u=s.pop();typeof u=="object"&&(c=u,u=s.pop()),e6e(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const d={...r,...c},{memoize:f,memoizeOptions:h=[],argsMemoize:g=DY,argsMemoizeOptions:p=[]}=d,x=KI(h),v=KI(p),C=n6e(s),b=f(function(){return a++,u.apply(null,arguments)},...x),_=g(function(){i++;const N=s6e(C,arguments);return o=b.apply(null,N),o},...v);return Object.assign(_,{resultFunc:u,memoizedResultFunc:b,dependencies:C,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:f,argsMemoize:g})};return Object.assign(n,{withTypes:()=>n}),n}var Gt=l6e(DY),c6e=Object.assign((e,t=Gt)=>{t6e(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((i,o,c)=>(i[r[c]]=o,i),{}))},{withTypes:()=>c6e}),Mk={},Rk={},Ok={},XI;function u6e(){return XI||(XI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,s,a)=>{if(n!==s){const i=t(n),o=t(s);if(i===o&&i===0){if(n<s)return a==="desc"?1:-1;if(n>s)return a==="desc"?-1:1}return a==="desc"?o-i:i-o}return 0};e.compareValues=r})(Ok)),Ok}var Dk={},Ik={},JI;function IY(){return JI||(JI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Ik)),Ik}var QI;function d6e(){return QI||(QI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IY(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function s(a,i){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||i!=null&&Object.hasOwn(i,a)}e.isKey=s})(Dk)),Dk}var ZI;function f6e(){return ZI||(ZI=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u6e(),r=d6e(),n=dA();function s(a,i,o,c){if(a==null)return[];o=c?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(g=>String(g));const u=(g,p)=>{let x=g;for(let v=0;v<p.length&&x!=null;++v)x=x[p[v]];return x},d=(g,p)=>p==null||g==null?p:typeof g=="object"&&"key"in g?Object.hasOwn(p,g.key)?p[g.key]:u(p,g.path):typeof g=="function"?g(p):Array.isArray(g)?u(p,g):typeof p=="object"?p[g]:p,f=i.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||r.isKey(g)?g:{key:g,path:n.toPath(g)}));return a.map(g=>({original:g,criteria:f.map(p=>d(p,g))})).slice().sort((g,p)=>{for(let x=0;x<f.length;x++){const v=t.compareValues(g.criteria[x],p.criteria[x],o[x]);if(v!==0)return v}return 0}).map(g=>g.original)}e.orderBy=s})(Rk)),Rk}var Lk={},eL;function h6e(){return eL||(eL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const s=[],a=Math.floor(n),i=(o,c)=>{for(let u=0;u<o.length;u++){const d=o[u];Array.isArray(d)&&c<a?i(d,c+1):s.push(d)}};return i(r,0),s}e.flatten=t})(Lk)),Lk}var Bk={},tL;function LY(){return tL||(tL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=OY(),r=xA(),n=AY(),s=PY();function a(i,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?s.eq(c[o],i):!1}e.isIterateeCall=a})(Bk)),Bk}var rL;function m6e(){return rL||(rL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=f6e(),r=h6e(),n=LY();function s(a,...i){const o=i.length;return o>1&&n.isIterateeCall(a,i[0],i[1])?i=[]:o>2&&n.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),t.orderBy(a,r.flatten(i),["asc"])}e.sortBy=s})(Mk)),Mk}var $k,nL;function g6e(){return nL||(nL=1,$k=m6e().sortBy),$k}var p6e=g6e();const d3=ec(p6e);var BY=e=>e.legend.settings,x6e=e=>e.legend.size,y6e=e=>e.legend.payload;Gt([y6e,BY],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?d3(n,r):n});var l4=1;function v6e(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=w.useState({height:0,left:0,top:0,width:0}),n=w.useCallback(s=>{if(s!=null){var a=s.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-t.height)>l4||Math.abs(i.left-t.left)>l4||Math.abs(i.top-t.top)>l4||Math.abs(i.width-t.width)>l4)&&r({height:i.height,left:i.left,top:i.top,width:i.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Xi(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var b6e=typeof Symbol=="function"&&Symbol.observable||"@@observable",sL=b6e,Uk=()=>Math.random().toString(36).substring(7).split("").join("."),w6e={INIT:`@@redux/INIT${Uk()}`,REPLACE:`@@redux/REPLACE${Uk()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Uk()}`},U_=w6e;function bA(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function $Y(e,t,r){if(typeof e!="function")throw new Error(Xi(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Xi(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Xi(1));return r($Y)(e,t)}let n=e,s=t,a=new Map,i=a,o=0,c=!1;function u(){i===a&&(i=new Map,a.forEach((v,C)=>{i.set(C,v)}))}function d(){if(c)throw new Error(Xi(3));return s}function f(v){if(typeof v!="function")throw new Error(Xi(4));if(c)throw new Error(Xi(5));let C=!0;u();const b=o++;return i.set(b,v),function(){if(C){if(c)throw new Error(Xi(6));C=!1,u(),i.delete(b),a=null}}}function h(v){if(!bA(v))throw new Error(Xi(7));if(typeof v.type>"u")throw new Error(Xi(8));if(typeof v.type!="string")throw new Error(Xi(17));if(c)throw new Error(Xi(9));try{c=!0,s=n(s,v)}finally{c=!1}return(a=i).forEach(b=>{b()}),v}function g(v){if(typeof v!="function")throw new Error(Xi(10));n=v,h({type:U_.REPLACE})}function p(){const v=f;return{subscribe(C){if(typeof C!="object"||C===null)throw new Error(Xi(11));function b(){const T=C;T.next&&T.next(d())}return b(),{unsubscribe:v(b)}},[sL](){return this}}}return h({type:U_.INIT}),{dispatch:h,subscribe:f,getState:d,replaceReducer:g,[sL]:p}}function _6e(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:U_.INIT})>"u")throw new Error(Xi(12));if(typeof r(void 0,{type:U_.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Xi(13))})}function UY(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const i=t[a];typeof e[i]=="function"&&(r[i]=e[i])}const n=Object.keys(r);let s;try{_6e(r)}catch(a){s=a}return function(i={},o){if(s)throw s;let c=!1;const u={};for(let d=0;d<n.length;d++){const f=n[d],h=r[f],g=i[f],p=h(g,o);if(typeof p>"u")throw o&&o.type,new Error(Xi(14));u[f]=p,c=c||p!==g}return c=c||n.length!==Object.keys(i).length,c?u:i}}function z_(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function S6e(...e){return t=>(r,n)=>{const s=t(r,n);let a=()=>{throw new Error(Xi(15))};const i={getState:s.getState,dispatch:(c,...u)=>a(c,...u)},o=e.map(c=>c(i));return a=z_(...o)(s.dispatch),{...s,dispatch:a}}}function zY(e){return bA(e)&&"type"in e&&typeof e.type=="string"}var WY=Symbol.for("immer-nothing"),aL=Symbol.for("immer-draftable"),Zl=Symbol.for("immer-state");function hu(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var w1=Object.getPrototypeOf;function ag(e){return!!e&&!!e[Zl]}function A0(e){return e?HY(e)||Array.isArray(e)||!!e[aL]||!!e.constructor?.[aL]||ob(e)||h3(e):!1}var k6e=Object.prototype.constructor.toString();function HY(e){if(!e||typeof e!="object")return!1;const t=w1(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===k6e}function W_(e,t){f3(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function f3(e){const t=e[Zl];return t?t.type_:Array.isArray(e)?1:ob(e)?2:h3(e)?3:0}function N8(e,t){return f3(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function GY(e,t,r){const n=f3(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function C6e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ob(e){return e instanceof Map}function h3(e){return e instanceof Set}function mm(e){return e.copy_||e.base_}function E8(e,t){if(ob(e))return new Map(e);if(h3(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=HY(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Zl];let s=Reflect.ownKeys(n);for(let a=0;a<s.length;a++){const i=s[a],o=n[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[i]})}return Object.create(w1(e),n)}else{const n=w1(e);if(n!==null&&r)return{...e};const s=Object.create(n);return Object.assign(s,e)}}function wA(e,t=!1){return m3(e)||ag(e)||!A0(e)||(f3(e)>1&&Object.defineProperties(e,{set:{value:c4},add:{value:c4},clear:{value:c4},delete:{value:c4}}),Object.freeze(e),t&&Object.values(e).forEach(r=>wA(r,!0))),e}function c4(){hu(2)}function m3(e){return Object.isFrozen(e)}var T6e={};function ig(e){const t=T6e[e];return t||hu(0,e),t}var y2;function VY(){return y2}function N6e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function iL(e,t){t&&(ig("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function A8(e){j8(e),e.drafts_.forEach(E6e),e.drafts_=null}function j8(e){e===y2&&(y2=e.parent_)}function oL(e){return y2=N6e(y2,e)}function E6e(e){const t=e[Zl];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function lL(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Zl].modified_&&(A8(t),hu(4)),A0(e)&&(e=H_(t,e),t.parent_||G_(t,e)),t.patches_&&ig("Patches").generateReplacementPatches_(r[Zl].base_,e,t.patches_,t.inversePatches_)):e=H_(t,r,[]),A8(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==WY?e:void 0}function H_(e,t,r){if(m3(t))return t;const n=t[Zl];if(!n)return W_(t,(s,a)=>cL(e,n,t,s,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return G_(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const s=n.copy_;let a=s,i=!1;n.type_===3&&(a=new Set(s),s.clear(),i=!0),W_(a,(o,c)=>cL(e,n,s,o,c,r,i)),G_(e,s,!1),r&&e.patches_&&ig("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function cL(e,t,r,n,s,a,i){if(ag(s)){const o=a&&t&&t.type_!==3&&!N8(t.assigned_,n)?a.concat(n):void 0,c=H_(e,s,o);if(GY(r,n,c),ag(c))e.canAutoFreeze_=!1;else return}else i&&r.add(s);if(A0(s)&&!m3(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;H_(e,s),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(ob(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&G_(e,s)}}function G_(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&wA(t,r)}function A6e(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:VY(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=n,a=_A;r&&(s=[n],a=v2);const{revoke:i,proxy:o}=Proxy.revocable(s,a);return n.draft_=o,n.revoke_=i,o}var _A={get(e,t){if(t===Zl)return e;const r=mm(e);if(!N8(r,t))return j6e(e,r,t);const n=r[t];return e.finalized_||!A0(n)?n:n===zk(e.base_,t)?(Wk(e),e.copy_[t]=F8(n,e)):n},has(e,t){return t in mm(e)},ownKeys(e){return Reflect.ownKeys(mm(e))},set(e,t,r){const n=qY(mm(e),t);if(n?.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const s=zk(mm(e),t),a=s?.[Zl];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(C6e(r,s)&&(r!==void 0||N8(e.base_,t)))return!0;Wk(e),P8(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return zk(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Wk(e),P8(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=mm(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){hu(11)},getPrototypeOf(e){return w1(e.base_)},setPrototypeOf(){hu(12)}},v2={};W_(_A,(e,t)=>{v2[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});v2.deleteProperty=function(e,t){return v2.set.call(this,e,t,void 0)};v2.set=function(e,t,r){return _A.set.call(this,e[0],t,r,e[0])};function zk(e,t){const r=e[Zl];return(r?mm(r):e)[t]}function j6e(e,t,r){const n=qY(t,r);return n?"value"in n?n.value:n.get?.call(e.draft_):void 0}function qY(e,t){if(!(t in e))return;let r=w1(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=w1(r)}}function P8(e){e.modified_||(e.modified_=!0,e.parent_&&P8(e.parent_))}function Wk(e){e.copy_||(e.copy_=E8(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var P6e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const i=this;return function(c=a,...u){return i.produce(c,d=>r.call(this,d,...u))}}typeof r!="function"&&hu(6),n!==void 0&&typeof n!="function"&&hu(7);let s;if(A0(t)){const a=oL(this),i=F8(t,void 0);let o=!0;try{s=r(i),o=!1}finally{o?A8(a):j8(a)}return iL(a,n),lL(s,a)}else if(!t||typeof t!="object"){if(s=r(t),s===void 0&&(s=t),s===WY&&(s=void 0),this.autoFreeze_&&wA(s,!0),n){const a=[],i=[];ig("Patches").generateReplacementPatches_(t,s,a,i),n(a,i)}return s}else hu(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(i,...o)=>this.produceWithPatches(i,c=>t(c,...o));let n,s;return[this.produce(t,r,(i,o)=>{n=i,s=o}),n,s]},typeof e?.autoFreeze=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof e?.useStrictShallowCopy=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){A0(e)||hu(8),ag(e)&&(e=v0(e));const t=oL(this),r=F8(e,void 0);return r[Zl].isManual_=!0,j8(t),r}finishDraft(e,t){const r=e&&e[Zl];(!r||!r.isManual_)&&hu(9);const{scope_:n}=r;return iL(n,t),lL(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const s=t[r];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}r>-1&&(t=t.slice(r+1));const n=ig("Patches").applyPatches_;return ag(e)?n(e,t):this.produce(e,s=>n(s,t))}};function F8(e,t){const r=ob(e)?ig("MapSet").proxyMap_(e,t):h3(e)?ig("MapSet").proxySet_(e,t):A6e(e,t);return(t?t.scope_:VY()).drafts_.push(r),r}function v0(e){return ag(e)||hu(10,e),KY(e)}function KY(e){if(!A0(e)||m3(e))return e;const t=e[Zl];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=E8(e,t.scope_.immer_.useStrictShallowCopy_)}else r=E8(e,!0);return W_(r,(n,s)=>{GY(r,n,KY(s))}),t&&(t.finalized_=!1),r}var F6e=new P6e,YY=F6e.produce;function XY(e){return({dispatch:r,getState:n})=>s=>a=>typeof a=="function"?a(r,n,e):s(a)}var M6e=XY(),R6e=XY,O6e=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?z_:z_.apply(null,arguments)};function Uc(e,t){function r(...n){if(t){let s=t(...n);if(!s)throw new Error(Xl(0));return{type:e,payload:s.payload,..."meta"in s&&{meta:s.meta},..."error"in s&&{error:s.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>zY(n)&&n.type===e,r}var JY=class hv extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,hv.prototype)}static get[Symbol.species](){return hv}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new hv(...t[0].concat(this)):new hv(...t.concat(this))}};function uL(e){return A0(e)?YY(e,()=>{}):e}function u4(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function D6e(e){return typeof e=="boolean"}var I6e=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:s=!0,actionCreatorCheck:a=!0}=t??{};let i=new JY;return r&&(D6e(r)?i.push(M6e):i.push(R6e(r.extraArgument))),i},L6e="RTK_autoBatch",dL=e=>t=>{setTimeout(t,e)},B6e=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let s=!0,a=!1,i=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:dL(10):e.type==="callback"?e.queueNotification:dL(e.timeout),u=()=>{i=!1,a&&(a=!1,o.forEach(d=>d()))};return Object.assign({},n,{subscribe(d){const f=()=>s&&d(),h=n.subscribe(f);return o.add(d),()=>{h(),o.delete(d)}},dispatch(d){try{return s=!d?.meta?.[L6e],a=!s,a&&(i||(i=!0,c(u))),n.dispatch(d)}finally{s=!0}}})},$6e=e=>function(r){const{autoBatch:n=!0}=r??{};let s=new JY(e);return n&&s.push(B6e(typeof n=="object"?n:void 0)),s};function U6e(e){const t=I6e(),{reducer:r=void 0,middleware:n,devTools:s=!0,preloadedState:a=void 0,enhancers:i=void 0}=e||{};let o;if(typeof r=="function")o=r;else if(bA(r))o=UY(r);else throw new Error(Xl(1));let c;typeof n=="function"?c=n(t):c=t();let u=z_;s&&(u=O6e({trace:!1,...typeof s=="object"&&s}));const d=S6e(...c),f=$6e(d);let h=typeof i=="function"?i(f):f();const g=u(...h);return $Y(o,a,g)}function QY(e){const t={},r=[];let n;const s={addCase(a,i){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Xl(28));if(o in t)throw new Error(Xl(29));return t[o]=i,s},addAsyncThunk(a,i){return i.pending&&(t[a.pending.type]=i.pending),i.rejected&&(t[a.rejected.type]=i.rejected),i.fulfilled&&(t[a.fulfilled.type]=i.fulfilled),i.settled&&r.push({matcher:a.settled,reducer:i.settled}),s},addMatcher(a,i){return r.push({matcher:a,reducer:i}),s},addDefaultCase(a){return n=a,s}};return e(s),[t,r,n]}function z6e(e){return typeof e=="function"}function W6e(e,t){let[r,n,s]=QY(t),a;if(z6e(e))a=()=>uL(e());else{const o=uL(e);a=()=>o}function i(o=a(),c){let u=[r[c.type],...n.filter(({matcher:d})=>d(c)).map(({reducer:d})=>d)];return u.filter(d=>!!d).length===0&&(u=[s]),u.reduce((d,f)=>{if(f)if(ag(d)){const g=f(d,c);return g===void 0?d:g}else{if(A0(d))return YY(d,h=>f(h,c));{const h=f(d,c);if(h===void 0){if(d===null)return d;throw Error("A case reducer on a non-draftable value must not return undefined")}return h}}return d},o)}return i.getInitialState=a,i}var H6e="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",G6e=(e=21)=>{let t="",r=e;for(;r--;)t+=H6e[Math.random()*64|0];return t},V6e=Symbol.for("rtk-slice-createasyncthunk");function q6e(e,t){return`${e}/${t}`}function K6e({creators:e}={}){const t=e?.asyncThunk?.[V6e];return function(n){const{name:s,reducerPath:a=s}=n;if(!s)throw new Error(Xl(11));const i=(typeof n.reducers=="function"?n.reducers(X6e()):n.reducers)||{},o=Object.keys(i),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(_,T){const N=typeof _=="string"?_:_.type;if(!N)throw new Error(Xl(12));if(N in c.sliceCaseReducersByType)throw new Error(Xl(13));return c.sliceCaseReducersByType[N]=T,u},addMatcher(_,T){return c.sliceMatchers.push({matcher:_,reducer:T}),u},exposeAction(_,T){return c.actionCreators[_]=T,u},exposeCaseReducer(_,T){return c.sliceCaseReducersByName[_]=T,u}};o.forEach(_=>{const T=i[_],N={reducerName:_,type:q6e(s,_),createNotation:typeof n.reducers=="function"};Q6e(T)?eke(N,T,u,t):J6e(N,T,u)});function d(){const[_={},T=[],N=void 0]=typeof n.extraReducers=="function"?QY(n.extraReducers):[n.extraReducers],E={..._,...c.sliceCaseReducersByType};return W6e(n.initialState,F=>{for(let j in E)F.addCase(j,E[j]);for(let j of c.sliceMatchers)F.addMatcher(j.matcher,j.reducer);for(let j of T)F.addMatcher(j.matcher,j.reducer);N&&F.addDefaultCase(N)})}const f=_=>_,h=new Map,g=new WeakMap;let p;function x(_,T){return p||(p=d()),p(_,T)}function v(){return p||(p=d()),p.getInitialState()}function C(_,T=!1){function N(F){let j=F[_];return typeof j>"u"&&T&&(j=u4(g,N,v)),j}function E(F=f){const j=u4(h,T,()=>new WeakMap);return u4(j,F,()=>{const P={};for(const[M,I]of Object.entries(n.selectors??{}))P[M]=Y6e(I,F,()=>u4(g,F,v),T);return P})}return{reducerPath:_,getSelectors:E,get selectors(){return E(N)},selectSlice:N}}const b={name:s,reducer:x,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:v,...C(a),injectInto(_,{reducerPath:T,...N}={}){const E=T??a;return _.inject({reducerPath:E,reducer:x},N),{...b,...C(E,!0)}}};return b}}function Y6e(e,t,r,n){function s(a,...i){let o=t(a);return typeof o>"u"&&n&&(o=r()),e(o,...i)}return s.unwrapped=e,s}var nc=K6e();function X6e(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function J6e({type:e,reducerName:t,createNotation:r},n,s){let a,i;if("reducer"in n){if(r&&!Z6e(n))throw new Error(Xl(17));a=n.reducer,i=n.prepare}else a=n;s.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,i?Uc(e,i):Uc(e))}function Q6e(e){return e._reducerDefinitionType==="asyncThunk"}function Z6e(e){return e._reducerDefinitionType==="reducerWithPrepare"}function eke({type:e,reducerName:t},r,n,s){if(!s)throw new Error(Xl(18));const{payloadCreator:a,fulfilled:i,pending:o,rejected:c,settled:u,options:d}=r,f=s(e,a,d);n.exposeAction(t,f),i&&n.addCase(f.fulfilled,i),o&&n.addCase(f.pending,o),c&&n.addCase(f.rejected,c),u&&n.addMatcher(f.settled,u),n.exposeCaseReducer(t,{fulfilled:i||d4,pending:o||d4,rejected:c||d4,settled:u||d4})}function d4(){}var tke="task",ZY="listener",eX="completed",SA="cancelled",rke=`task-${SA}`,nke=`task-${eX}`,M8=`${ZY}-${SA}`,ske=`${ZY}-${eX}`,g3=class{constructor(e){this.code=e,this.message=`${tke} ${SA} (reason: ${e})`}name="TaskAbortError";message},kA=(e,t)=>{if(typeof e!="function")throw new TypeError(Xl(32))},V_=()=>{},tX=(e,t=V_)=>(e.catch(t),e),rX=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Dm=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},Im=e=>{if(e.aborted){const{reason:t}=e;throw new g3(t)}};function nX(e,t){let r=V_;return new Promise((n,s)=>{const a=()=>s(new g3(e.reason));if(e.aborted){a();return}r=rX(e,a),t.finally(()=>r()).then(n,s)}).finally(()=>{r=V_})}var ake=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof g3?"cancelled":"rejected",error:r}}finally{t?.()}},q_=e=>t=>tX(nX(e,t).then(r=>(Im(e),r))),sX=e=>{const t=q_(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:a1}=Object,fL={},p3="listenerMiddleware",ike=(e,t)=>{const r=n=>rX(e,()=>Dm(n,e.reason));return(n,s)=>{kA(n);const a=new AbortController;r(a);const i=ake(async()=>{Im(e),Im(a.signal);const o=await n({pause:q_(a.signal),delay:sX(a.signal),signal:a.signal});return Im(a.signal),o},()=>Dm(a,nke));return s?.autoJoin&&t.push(i.catch(V_)),{result:q_(e)(i),cancel(){Dm(a,rke)}}}},oke=(e,t)=>{const r=async(n,s)=>{Im(t);let a=()=>{};const o=[new Promise((c,u)=>{let d=e({predicate:n,effect:(f,h)=>{h.unsubscribe(),c([f,h.getState(),h.getOriginalState()])}});a=()=>{d(),u()}})];s!=null&&o.push(new Promise(c=>setTimeout(c,s,null)));try{const c=await nX(t,Promise.race(o));return Im(t),c}finally{a()}};return(n,s)=>tX(r(n,s))},aX=e=>{let{type:t,actionCreator:r,matcher:n,predicate:s,effect:a}=e;if(t)s=Uc(t).match;else if(r)t=r.type,s=r.match;else if(n)s=n;else if(!s)throw new Error(Xl(21));return kA(a),{predicate:s,type:t,effect:a}},iX=a1(e=>{const{type:t,predicate:r,effect:n}=aX(e);return{id:G6e(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Xl(22))}}},{withTypes:()=>iX}),hL=(e,t)=>{const{type:r,effect:n,predicate:s}=aX(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===s)&&a.effect===n)},R8=e=>{e.pending.forEach(t=>{Dm(t,M8)})},lke=e=>()=>{e.forEach(R8),e.clear()},mL=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},oX=a1(Uc(`${p3}/add`),{withTypes:()=>oX}),cke=Uc(`${p3}/removeAll`),lX=a1(Uc(`${p3}/remove`),{withTypes:()=>lX}),uke=(...e)=>{console.error(`${p3}/error`,...e)},lb=(e={})=>{const t=new Map,{extra:r,onError:n=uke}=e;kA(n);const s=d=>(d.unsubscribe=()=>t.delete(d.id),t.set(d.id,d),f=>{d.unsubscribe(),f?.cancelActive&&R8(d)}),a=d=>{const f=hL(t,d)??iX(d);return s(f)};a1(a,{withTypes:()=>a});const i=d=>{const f=hL(t,d);return f&&(f.unsubscribe(),d.cancelActive&&R8(f)),!!f};a1(i,{withTypes:()=>i});const o=async(d,f,h,g)=>{const p=new AbortController,x=oke(a,p.signal),v=[];try{d.pending.add(p),await Promise.resolve(d.effect(f,a1({},h,{getOriginalState:g,condition:(C,b)=>x(C,b).then(Boolean),take:x,delay:sX(p.signal),pause:q_(p.signal),extra:r,signal:p.signal,fork:ike(p.signal,v),unsubscribe:d.unsubscribe,subscribe:()=>{t.set(d.id,d)},cancelActiveListeners:()=>{d.pending.forEach((C,b,_)=>{C!==p&&(Dm(C,M8),_.delete(C))})},cancel:()=>{Dm(p,M8),d.pending.delete(p)},throwIfCancelled:()=>{Im(p.signal)}})))}catch(C){C instanceof g3||mL(n,C,{raisedBy:"effect"})}finally{await Promise.all(v),Dm(p,ske),d.pending.delete(p)}},c=lke(t);return{middleware:d=>f=>h=>{if(!zY(h))return f(h);if(oX.match(h))return a(h.payload);if(cke.match(h)){c();return}if(lX.match(h))return i(h.payload);let g=d.getState();const p=()=>{if(g===fL)throw new Error(Xl(23));return g};let x;try{if(x=f(h),t.size>0){const v=d.getState(),C=Array.from(t.values());for(const b of C){let _=!1;try{_=b.predicate(h,v,g)}catch(T){_=!1,mL(n,T,{raisedBy:"predicate"})}_&&o(b,h,d,p)}}}finally{g=fL}return x},startListening:a,stopListening:i,clearListeners:c}};function Xl(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var dke={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},cX=nc({name:"chartLayout",initialState:dke,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,s,a;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(s=t.payload.bottom)!==null&&s!==void 0?s:0,e.margin.left=(a=t.payload.left)!==null&&a!==void 0?a:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:fke,setLayout:hke,setChartSize:mke,setScale:gke}=cX.actions,pke=cX.reducer;function gL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function pL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gL(Object(r),!0).forEach(function(n){xke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xke(e,t,r){return(t=yke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yke(e){var t=vke(e,"string");return typeof t=="symbol"?t:t+""}function vke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var K_=Math.PI/180,bke=e=>e*180/Math.PI,so=(e,t,r,n)=>({x:e+Math.cos(-K_*n)*r,y:t+Math.sin(-K_*n)*r}),wke=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},_ke=(e,t)=>{var{x:r,y:n}=e,{x:s,y:a}=t;return Math.sqrt((r-s)**2+(n-a)**2)},Ske=(e,t)=>{var{x:r,y:n}=e,{cx:s,cy:a}=t,i=_ke({x:r,y:n},{x:s,y:a});if(i<=0)return{radius:i,angle:0};var o=(r-s)/i,c=Math.acos(o);return n>a&&(c=2*Math.PI-c),{radius:i,angle:bke(c),angleInRadian:c}},kke=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),s=Math.floor(r/360),a=Math.min(n,s);return{startAngle:t-a*360,endAngle:r-a*360}},Cke=(e,t)=>{var{startAngle:r,endAngle:n}=t,s=Math.floor(r/360),a=Math.floor(n/360),i=Math.min(s,a);return e+i*360},Tke=(e,t)=>{var{x:r,y:n}=e,{radius:s,angle:a}=Ske({x:r,y:n},t),{innerRadius:i,outerRadius:o}=t;if(s<i||s>o||s===0)return null;var{startAngle:c,endAngle:u}=kke(t),d=a,f;if(c<=u){for(;d>u;)d-=360;for(;d<c;)d+=360;f=d>=c&&d<=u}else{for(;d>c;)d-=360;for(;d<u;)d+=360;f=d>=u&&d<=c}return f?pL(pL({},t),{},{radius:s,angle:Cke(d,t)}):null};function uX(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function xL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Tc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xL(Object(r),!0).forEach(function(n){Nke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nke(e,t,r){return(t=Eke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Eke(e){var t=Ake(e,"string");return typeof t=="symbol"?t:t+""}function Ake(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function el(e,t,r){return Ri(e)||Ri(t)?r:gd(t)?l3(e,t,r):typeof t=="function"?t(e):r}var jke=(e,t,r,n,s)=>{var a,i=-1,o=(a=t?.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&s!=null&&Math.abs(Math.abs(s[1]-s[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,d=r[c].coordinate,f=c>=o-1?r[0].coordinate:r[c+1].coordinate,h=void 0;if(Pc(d-u)!==Pc(f-d)){var g=[];if(Pc(f-d)===Pc(s[1]-s[0])){h=f;var p=d+s[1]-s[0];g[0]=Math.min(p,(p+u)/2),g[1]=Math.max(p,(p+u)/2)}else{h=u;var x=f+s[1]-s[0];g[0]=Math.min(d,(x+d)/2),g[1]=Math.max(d,(x+d)/2)}var v=[Math.min(d,(h+d)/2),Math.max(d,(h+d)/2)];if(e>v[0]&&e<=v[1]||e>=g[0]&&e<=g[1]){({index:i}=r[c]);break}}else{var C=Math.min(u,f),b=Math.max(u,f);if(e>(C+d)/2&&e<=(b+d)/2){({index:i}=r[c]);break}}}else if(t){for(var _=0;_<o;_++)if(_===0&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_>0&&_<o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2&&e<=(t[_].coordinate+t[_+1].coordinate)/2||_===o-1&&e>(t[_].coordinate+t[_-1].coordinate)/2){({index:i}=t[_]);break}}return i},Pke=(e,t,r)=>{if(t&&r){var{width:n,height:s}=r,{align:a,verticalAlign:i,layout:o}=t;if((o==="vertical"||o==="horizontal"&&i==="middle")&&a!=="center"&&gn(e[a]))return Tc(Tc({},e),{},{[a]:e[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&i!=="middle"&&gn(e[i]))return Tc(Tc({},e),{},{[i]:e[i]+(s||0)})}return e},Th=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",dX=(e,t,r,n)=>{if(n)return e.map(o=>o.coordinate);var s,a,i=e.map(o=>(o.coordinate===t&&(s=!0),o.coordinate===r&&(a=!0),o.coordinate));return s||i.push(t),a||i.push(r),i},fX=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:s,range:a,scale:i,realScaleType:o,isCategorical:c,categoricalDomain:u,tickCount:d,ticks:f,niceTicks:h,axisType:g}=e;if(!i)return null;var p=o==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,x=s==="category"&&i.bandwidth?i.bandwidth()/p:0;if(x=g==="angleAxis"&&a&&a.length>=2?Pc(a[0]-a[1])*2*x:x,f||h){var v=(f||h||[]).map((C,b)=>{var _=n?n.indexOf(C):C;return{coordinate:i(_)+x,value:C,offset:x,index:b}});return v.filter(C=>!$c(C.coordinate))}return c&&u?u.map((C,b)=>({coordinate:i(C)+x,value:C,index:b,offset:x})):i.ticks&&d!=null?i.ticks(d).map((C,b)=>({coordinate:i(C)+x,value:C,offset:x,index:b})):i.domain().map((C,b)=>({coordinate:i(C)+x,value:n?n[C]:C,index:b,offset:x}))},yL=1e-4,Fke=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),s=Math.min(n[0],n[1])-yL,a=Math.max(n[0],n[1])+yL,i=e(t[0]),o=e(t[r-1]);(i<s||i>a||o<s||o>a)&&e.domain([t[0],t[r-1]])}},Mke=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0,i=0;i<t;++i){var o=$c(e[i][r][1])?e[i][r][0]:e[i][r][1];o>=0?(e[i][r][0]=s,e[i][r][1]=s+o,s=e[i][r][1]):(e[i][r][0]=a,e[i][r][1]=a+o,a=e[i][r][1])}},Rke=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var s=0,a=0;a<t;++a){var i=$c(e[a][r][1])?e[a][r][0]:e[a][r][1];i>=0?(e[a][r][0]=s,e[a][r][1]=s+i,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},Oke={sign:Mke,expand:S5e,none:b1,silhouette:k5e,wiggle:C5e,positive:Rke},Dke=(e,t,r)=>{var n=Oke[r],s=_5e().keys(t).value((a,i)=>+el(a,i,0)).order(T8).offset(n);return s(e)};function vL(e){var{axis:t,ticks:r,bandSize:n,entry:s,index:a,dataKey:i}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Ri(s[t.dataKey])){var o=uY(r,"value",s[t.dataKey]);if(o)return o.coordinate+n/2}return r[a]?r[a].coordinate+n/2:null}var c=el(s,Ri(i)?t.dataKey:i);return Ri(c)?null:t.scale(c)}var Ike=e=>{var t=e.flat(2).filter(gn);return[Math.min(...t),Math.max(...t)]},Lke=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Bke=(e,t,r)=>{if(e!=null)return Lke(Object.keys(e).reduce((n,s)=>{var a=e[s],{stackedData:i}=a,o=i.reduce((c,u)=>{var d=uX(u,t,r),f=Ike(d);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},bL=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,wL=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,O8=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var s=d3(t,d=>d.coordinate),a=1/0,i=1,o=s.length;i<o;i++){var c=s[i],u=s[i-1];a=Math.min((c.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0};function _L(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:s,name:a}=e;return Tc(Tc({},t),{},{dataKey:r,payload:n,value:s,name:a})}function hX(e,t){if(e)return String(e);if(typeof t=="string")return t}function $ke(e,t,r,n,s){if(r==="horizontal"||r==="vertical"){var a=e>=s.left&&e<=s.left+s.width&&t>=s.top&&t<=s.top+s.height;return a?{x:e,y:t}:null}return n?Tke({x:e,y:t},n):null}var Uke=(e,t,r,n)=>{var s=t.find(u=>u&&u.index===r);if(s){if(e==="horizontal")return{x:s.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,{radius:i}=n;return Tc(Tc(Tc({},n),so(n.cx,n.cy,i,a)),{},{angle:a,radius:i})}var o=s.coordinate,{angle:c}=n;return Tc(Tc(Tc({},n),so(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},zke=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,$0=e=>e.layout.width,U0=e=>e.layout.height,Wke=e=>e.layout.scale,mX=e=>e.layout.margin,x3=Gt(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),y3=Gt(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),Hke="data-recharts-item-index",Gke="data-recharts-item-data-key",cb=60;function SL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function f4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SL(Object(r),!0).forEach(function(n){Vke(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Vke(e,t,r){return(t=qke(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qke(e){var t=Kke(e,"string");return typeof t=="symbol"?t:t+""}function Kke(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yke=e=>e.brush.height;function Xke(e){var t=y3(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:cb;return r+s}return r},0)}function Jke(e){var t=y3(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var s=typeof n.width=="number"?n.width:cb;return r+s}return r},0)}function Qke(e){var t=x3(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function Zke(e){var t=x3(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var lo=Gt([$0,U0,mX,Yke,Xke,Jke,Qke,Zke,BY,x6e],(e,t,r,n,s,a,i,o,c,u)=>{var d={left:(r.left||0)+s,right:(r.right||0)+a},f={top:(r.top||0)+i,bottom:(r.bottom||0)+o},h=f4(f4({},f),d),g=h.bottom;h.bottom+=n,h=Pke(h,c,u);var p=e-h.left-h.right,x=t-h.top-h.bottom;return f4(f4({brushBottom:g},h),{},{width:Math.max(p,0),height:Math.max(x,0)})}),eCe=Gt(lo,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),gX=Gt($0,U0,(e,t)=>({x:0,y:0,width:e,height:t})),tCe=w.createContext(null),Hc=()=>w.useContext(tCe)!=null,v3=e=>e.brush,b3=Gt([v3,lo,mX],(e,t,r)=>({height:e.height,x:gn(e.x)?e.x:t.left,y:gn(e.y)?e.y:t.top+t.height+t.brushBottom-(r?.bottom||0),width:gn(e.width)?e.width:t.width})),CA=()=>{var e,t=Hc(),r=an(eCe),n=an(b3),s=(e=an(v3))===null||e===void 0?void 0:e.padding;return!t||!n||!s?r:{width:n.width-s.left-s.right,height:n.height-s.top-s.bottom,x:s.left,y:s.top}},rCe={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pX=()=>{var e;return(e=an(lo))!==null&&e!==void 0?e:rCe},xX=()=>an($0),yX=()=>an(U0),qs=e=>e.layout.layoutType,TA=()=>an(qs),nCe={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},vX=nc({name:"legend",initialState:nCe,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=v0(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:gDe,setLegendSettings:pDe,addLegendPayload:sCe,removeLegendPayload:aCe}=vX.actions,iCe=vX.reducer;function D8(){return D8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},D8.apply(null,arguments)}function kL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Hk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kL(Object(r),!0).forEach(function(n){oCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oCe(e,t,r){return(t=lCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lCe(e){var t=cCe(e,"string");return typeof t=="symbol"?t:t+""}function cCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uCe(e){return Array.isArray(e)&&gd(e[0])&&gd(e[1])?e.join(" ~ "):e}var dCe=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:s={},payload:a,formatter:i,itemSorter:o,wrapperClassName:c,labelClassName:u,label:d,labelFormatter:f,accessibilityLayer:h=!1}=e,g=()=>{if(a&&a.length){var N={padding:0,margin:0},E=(o?d3(a,o):a).map((F,j)=>{if(F.type==="none")return null;var P=F.formatter||i||uCe,{value:M,name:I}=F,U=M,K=I;if(P){var te=P(M,I,F,j,a);if(Array.isArray(te))[U,K]=te;else if(te!=null)U=te;else return null}var re=Hk({display:"block",paddingTop:4,paddingBottom:4,color:F.color||"#000"},n);return w.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(j),style:re},gd(K)?w.createElement("span",{className:"recharts-tooltip-item-name"},K):null,gd(K)?w.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,w.createElement("span",{className:"recharts-tooltip-item-value"},U),w.createElement("span",{className:"recharts-tooltip-item-unit"},F.unit||""))});return w.createElement("ul",{className:"recharts-tooltip-item-list",style:N},E)}return null},p=Hk({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),x=Hk({margin:0},s),v=!Ri(d),C=v?d:"",b=Vs("recharts-default-tooltip",c),_=Vs("recharts-tooltip-label",u);v&&f&&a!==void 0&&a!==null&&(C=f(d,a));var T=h?{role:"status","aria-live":"assertive"}:{};return w.createElement("div",D8({className:b,style:p},T),w.createElement("p",{className:_,style:x},w.isValidElement(C)?C:"".concat(C)),g())},Xy="recharts-tooltip-wrapper",fCe={visibility:"hidden"};function hCe(e){var{coordinate:t,translateX:r,translateY:n}=e;return Vs(Xy,{["".concat(Xy,"-right")]:gn(r)&&t&&gn(t.x)&&r>=t.x,["".concat(Xy,"-left")]:gn(r)&&t&&gn(t.x)&&r<t.x,["".concat(Xy,"-bottom")]:gn(n)&&t&&gn(t.y)&&n>=t.y,["".concat(Xy,"-top")]:gn(n)&&t&&gn(t.y)&&n<t.y})}function CL(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:s,position:a,reverseDirection:i,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(a&&gn(a[n]))return a[n];var d=r[n]-o-(s>0?s:0),f=r[n]+s;if(t[n])return i[n]?d:f;var h=c[n];if(h==null)return 0;if(i[n]){var g=d,p=h;return g<p?Math.max(f,h):Math.max(d,h)}if(u==null)return 0;var x=f+o,v=h+u;return x>v?Math.max(d,h):Math.max(f,h)}function mCe(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function gCe(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:s,reverseDirection:a,tooltipBox:i,useTranslate3d:o,viewBox:c}=e,u,d,f;return i.height>0&&i.width>0&&r?(d=CL({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=CL({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:s,reverseDirection:a,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=mCe({translateX:d,translateY:f,useTranslate3d:o})):u=fCe,{cssProperties:u,cssClasses:hCe({translateX:d,translateY:f,coordinate:r})}}function TL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function h4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?TL(Object(r),!0).forEach(function(n){I8(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):TL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I8(e,t,r){return(t=pCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pCe(e){var t=xCe(e,"string");return typeof t=="symbol"?t:t+""}function xCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class yCe extends w.PureComponent{constructor(){super(...arguments),I8(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),I8(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,s,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(s=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&s!==void 0?s:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:s,children:a,coordinate:i,hasPayload:o,isAnimationActive:c,offset:u,position:d,reverseDirection:f,useTranslate3d:h,viewBox:g,wrapperStyle:p,lastBoundingBox:x,innerRef:v,hasPortalFromProps:C}=this.props,{cssClasses:b,cssProperties:_}=gCe({allowEscapeViewBox:r,coordinate:i,offsetTopLeft:u,position:d,reverseDirection:f,tooltipBox:{height:x.height,width:x.width},useTranslate3d:h,viewBox:g}),T=C?{}:h4(h4({transition:c&&t?"transform ".concat(n,"ms ").concat(s):void 0},_),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),N=h4(h4({},T),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},p);return w.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:b,style:N,ref:v},a)}}var vCe=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Z1={devToolsEnabled:!1,isSsr:vCe()},bX=()=>an(e=>e.rootProps.accessibilityLayer);function Su(e){return Number.isFinite(e)}function Y_(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function L8(){return L8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},L8.apply(null,arguments)}function NL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function EL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?NL(Object(r),!0).forEach(function(n){bCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):NL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bCe(e,t,r){return(t=wCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wCe(e){var t=_Ce(e,"string");return typeof t=="symbol"?t:t+""}function _Ce(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AL={curveBasisClosed:d5e,curveBasisOpen:f5e,curveBasis:u5e,curveBumpX:l5e,curveBumpY:c5e,curveLinearClosed:h5e,curveLinear:c3,curveMonotoneX:m5e,curveMonotoneY:g5e,curveNatural:p5e,curveStep:x5e,curveStepAfter:v5e,curveStepBefore:y5e},m4=e=>Su(e.x)&&Su(e.y),Jy=e=>e.x,Qy=e=>e.y,SCe=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(hA(e));return(r==="curveMonotone"||r==="curveBump")&&t?AL["".concat(r).concat(t==="vertical"?"Y":"X")]:AL[r]||c3},kCe=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:s,connectNulls:a=!1}=e,i=SCe(t,s),o=a?r.filter(m4):r,c;if(Array.isArray(n)){var u=a?n.filter(f=>m4(f)):n,d=o.map((f,h)=>EL(EL({},f),{},{base:u[h]}));return s==="vertical"?c=i4().y(Qy).x1(Jy).x0(f=>f.base.x):c=i4().x(Jy).y1(Qy).y0(f=>f.base.y),c.defined(m4).curve(i),c(d)}return s==="vertical"&&gn(n)?c=i4().y(Qy).x1(Jy).x0(n):gn(n)?c=i4().x(Jy).y1(Qy).y0(n):c=vY().x(Jy).y(Qy),c.defined(m4).curve(i),c(o)},wX=e=>{var{className:t,points:r,path:n,pathRef:s}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?kCe(e):n;return w.createElement("path",L8({},Sg(e),gA(e),{className:Vs("recharts-curve",t),d:a===null?void 0:a,ref:s}))},CCe=["x","y","top","left","width","height","className"];function B8(){return B8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},B8.apply(null,arguments)}function jL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function TCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jL(Object(r),!0).forEach(function(n){NCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NCe(e,t,r){return(t=ECe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ECe(e){var t=ACe(e,"string");return typeof t=="symbol"?t:t+""}function ACe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jCe(e,t){if(e==null)return{};var r,n,s=PCe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function PCe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FCe=(e,t,r,n,s,a)=>"M".concat(e,",").concat(s,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),MCe=e=>{var{x:t=0,y:r=0,top:n=0,left:s=0,width:a=0,height:i=0,className:o}=e,c=jCe(e,CCe),u=TCe({x:t,y:r,top:n,left:s,width:a,height:i},c);return!gn(t)||!gn(r)||!gn(a)||!gn(i)||!gn(n)||!gn(s)?null:w.createElement("path",B8({},oo(u,!0),{className:Vs("recharts-cross",o),d:FCe(t,r,a,i,n,s)}))};function RCe(e,t,r,n){var s=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-s,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function PL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function OCe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?PL(Object(r),!0).forEach(function(n){DCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):PL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DCe(e,t,r){return(t=ICe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ICe(e){var t=LCe(e,"string");return typeof t=="symbol"?t:t+""}function LCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gc(e,t){var r=OCe({},e),n=t,s=Object.keys(t),a=s.reduce((i,o)=>(i[o]===void 0&&n[o]!==void 0&&(i[o]=n[o]),i),r);return a}function BCe(){}function FL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function ML(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FL(Object(r),!0).forEach(function(n){$Ce(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $Ce(e,t,r){return(t=UCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UCe(e){var t=zCe(e,"string");return typeof t=="symbol"?t:t+""}function zCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WCe=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),HCe=(e,t,r)=>e.map(n=>"".concat(WCe(n)," ").concat(t,"ms ").concat(r)).join(","),GCe=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(s=>n.includes(s))),b2=(e,t)=>Object.keys(t).reduce((r,n)=>ML(ML({},r),{},{[n]:e(n,t[n])}),{});function RL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Zi(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?RL(Object(r),!0).forEach(function(n){VCe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VCe(e,t,r){return(t=qCe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qCe(e){var t=KCe(e,"string");return typeof t=="symbol"?t:t+""}function KCe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var X_=(e,t,r)=>e+(t-e)*r,$8=e=>{var{from:t,to:r}=e;return t!==r},_X=(e,t,r)=>{var n=b2((s,a)=>{if($8(a)){var[i,o]=e(a.from,a.to,a.velocity);return Zi(Zi({},a),{},{from:i,velocity:o})}return a},t);return r<1?b2((s,a)=>$8(a)?Zi(Zi({},a),{},{velocity:X_(a.velocity,n[s].velocity,r),from:X_(a.from,n[s].from,r)}):a,t):_X(e,n,r-1)};function YCe(e,t,r,n,s,a){var i,o=n.reduce((h,g)=>Zi(Zi({},h),{},{[g]:{from:e[g],velocity:0,to:t[g]}}),{}),c=()=>b2((h,g)=>g.from,o),u=()=>!Object.values(o).filter($8).length,d=null,f=h=>{i||(i=h);var g=h-i,p=g/r.dt;o=_X(r,o,p),s(Zi(Zi(Zi({},e),t),c())),i=h,u()||(d=a.setTimeout(f))};return()=>(d=a.setTimeout(f),()=>{d()})}function XCe(e,t,r,n,s,a,i){var o=null,c=s.reduce((f,h)=>Zi(Zi({},f),{},{[h]:[e[h],t[h]]}),{}),u,d=f=>{u||(u=f);var h=(f-u)/n,g=b2((x,v)=>X_(...v,r(h)),c);if(a(Zi(Zi(Zi({},e),t),g)),h<1)o=i.setTimeout(d);else{var p=b2((x,v)=>X_(...v,r(1)),c);a(Zi(Zi(Zi({},e),t),p))}};return()=>(o=i.setTimeout(d),()=>{o()})}const JCe=(e,t,r,n,s,a)=>{var i=GCe(e,t);return r.isStepper===!0?YCe(e,t,r,i,s,a):XCe(e,t,r,n,i,s,a)};var J_=1e-4,SX=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],kX=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),OL=(e,t)=>r=>{var n=SX(e,t);return kX(n,r)},QCe=(e,t)=>r=>{var n=SX(e,t),s=[...n.map((a,i)=>a*i).slice(1),0];return kX(s,r)},DL=function(){for(var t,r,n,s,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];if(i.length===1)switch(i[0]){case"linear":[t,n,r,s]=[0,0,1,1];break;case"ease":[t,n,r,s]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,s]=[.42,0,1,1];break;case"ease-out":[t,n,r,s]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,s]=[0,0,.58,1];break;default:{var c=i[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,s]=c[1].split(")")[0].split(",").map(p=>parseFloat(p)))}}else i.length===4&&([t,n,r,s]=i);var u=OL(t,r),d=OL(n,s),f=QCe(t,r),h=p=>p>1?1:p<0?0:p,g=p=>{for(var x=p>1?1:p,v=x,C=0;C<8;++C){var b=u(v)-x,_=f(v);if(Math.abs(b-x)<J_||_<J_)return d(v);v=h(v-b/_)}return d(v)};return g.isStepper=!1,g},ZCe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:s=17}=t,a=(i,o,c)=>{var u=-(i-o)*r,d=c*n,f=c+(u-d)*s/1e3,h=c*s/1e3+i;return Math.abs(h-o)<J_&&Math.abs(f)<J_?[o,0]:[h,f]};return a.isStepper=!0,a.dt=s,a},eTe=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return DL(e);case"spring":return ZCe();default:if(e.split("(")[0]==="cubic-bezier")return DL(e)}return typeof e=="function"?e:null};function tTe(e){var t,r=()=>null,n=!1,s=null,a=i=>{if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,[c,...u]=o;if(typeof c=="number"){s=e.setTimeout(a.bind(null,u),c);return}a(c),s=e.setTimeout(a.bind(null,u));return}typeof i=="string"&&(t=i,r(t)),typeof i=="object"&&(t=i,r(t)),typeof i=="function"&&i()}};return{stop:()=>{n=!0},start:i=>{n=!1,s&&(s(),s=null),a(i)},subscribe:i=>(r=i,()=>{r=()=>null}),getTimeoutController:()=>e}}class rTe{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),s=null,a=i=>{i-n>=r?t(i):typeof requestAnimationFrame=="function"&&(s=requestAnimationFrame(a))};return s=requestAnimationFrame(a),()=>{cancelAnimationFrame(s)}}}function nTe(){return tTe(new rTe)}var sTe=w.createContext(nTe);function aTe(e,t){var r=w.useContext(sTe);return w.useMemo(()=>t??r(e),[e,t,r])}var iTe={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},IL={t:0},Gk={t:1};function CX(e){var t=Gc(e,iTe),{isActive:r,canBegin:n,duration:s,easing:a,begin:i,onAnimationEnd:o,onAnimationStart:c,children:u}=t,d=aTe(t.animationId,t.animationManager),[f,h]=w.useState(r?IL:Gk),g=w.useRef(null);return w.useEffect(()=>{r||h(Gk)},[r]),w.useEffect(()=>{if(!r||!n)return BCe;var p=JCe(IL,Gk,eTe(a),s,h,d.getTimeoutController()),x=()=>{g.current=p()};return d.start([c,i,x,s,o]),()=>{d.stop(),g.current&&g.current(),o()}},[r,n,s,a,i,c,o,d]),u(f.t)}function TX(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=w.useRef(x2(t)),n=w.useRef(e);return n.current!==e&&(r.current=x2(t),n.current=e),r.current}function LL(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function BL(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LL(Object(r),!0).forEach(function(n){oTe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LL(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oTe(e,t,r){return(t=lTe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lTe(e){var t=cTe(e,"string");return typeof t=="symbol"?t:t+""}function cTe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q_(){return Q_=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q_.apply(null,arguments)}var $L=(e,t,r,n,s)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),i=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(a>0&&s instanceof Array){for(var d=[0,0,0,0],f=0,h=4;f<h;f++)d[f]=s[f]>a?a:s[f];u="M".concat(e,",").concat(t+i*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+o*d[0],",").concat(t)),u+="L ".concat(e+r-o*d[1],",").concat(t),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+i*d[1])),u+="L ".concat(e+r,",").concat(t+n-i*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-o*d[2],",").concat(t+n)),u+="L ".concat(e+o*d[3],",").concat(t+n),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-i*d[3])),u+="Z"}else if(a>0&&s===+s&&s>0){var g=Math.min(a,s);u="M ".concat(e,",").concat(t+i*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(c,",").concat(e+o*g,",").concat(t,`
            L `).concat(e+r-o*g,",").concat(t,`
            A `).concat(g,",").concat(g,",0,0,").concat(c,",").concat(e+r,",").concat(t+i*g,`
            L `).concat(e+r,",").concat(t+n-i*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(c,",").concat(e+r-o*g,",").concat(t+n,`
            L `).concat(e+o*g,",").concat(t+n,`
            A `).concat(g,",").concat(g,",0,0,").concat(c,",").concat(e,",").concat(t+n-i*g," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},uTe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},dTe=e=>{var t=Gc(e,uTe),r=w.useRef(null),[n,s]=w.useState(-1);w.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var te=r.current.getTotalLength();te&&s(te)}catch{}},[]);var{x:a,y:i,width:o,height:c,radius:u,className:d}=t,{animationEasing:f,animationDuration:h,animationBegin:g,isAnimationActive:p,isUpdateAnimationActive:x}=t,v=w.useRef(o),C=w.useRef(c),b=w.useRef(a),_=w.useRef(i),T=w.useMemo(()=>({x:a,y:i,width:o,height:c,radius:u}),[a,i,o,c,u]),N=TX(T,"rectangle-");if(a!==+a||i!==+i||o!==+o||c!==+c||o===0||c===0)return null;var E=Vs("recharts-rectangle",d);if(!x)return w.createElement("path",Q_({},oo(t,!0),{className:E,d:$L(a,i,o,c,u)}));var F=v.current,j=C.current,P=b.current,M=_.current,I="0px ".concat(n===-1?1:n,"px"),U="".concat(n,"px 0px"),K=HCe(["strokeDasharray"],h,typeof f=="string"?f:void 0);return w.createElement(CX,{animationId:N,key:N,canBegin:n>0,duration:h,easing:f,isActive:x,begin:g},te=>{var re=i0(F,o,te),Z=i0(j,c,te),B=i0(P,a,te),J=i0(M,i,te);r.current&&(v.current=re,C.current=Z,b.current=B,_.current=J);var z;return p?te>0?z={transition:K,strokeDasharray:U}:z={strokeDasharray:I}:z={strokeDasharray:U},w.createElement("path",Q_({},oo(t,!0),{className:E,d:$L(B,J,re,Z,u),ref:r,style:BL(BL({},z),t.style)}))})};function NX(e){var{cx:t,cy:r,radius:n,startAngle:s,endAngle:a}=e,i=so(t,r,n,s),o=so(t,r,n,a);return{points:[i,o],cx:t,cy:r,radius:n,startAngle:s,endAngle:a}}function U8(){return U8=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},U8.apply(null,arguments)}var fTe=(e,t)=>{var r=Pc(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},g4=e=>{var{cx:t,cy:r,radius:n,angle:s,sign:a,isExternal:i,cornerRadius:o,cornerIsExternal:c}=e,u=o*(i?1:-1)+n,d=Math.asin(o/u)/K_,f=c?s:s+a*d,h=so(t,r,u,f),g=so(t,r,n,f),p=c?s-a*d:s,x=so(t,r,u*Math.cos(d*K_),p);return{center:h,circleTangency:g,lineTangency:x,theta:d}},EX=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:a,endAngle:i}=e,o=fTe(a,i),c=a+o,u=so(t,r,s,a),d=so(t,r,s,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(n>0){var h=so(t,r,n,a),g=so(t,r,n,c);f+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=c),`,
            `).concat(h.x,",").concat(h.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},hTe=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:s,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:o,startAngle:c,endAngle:u}=e,d=Pc(u-c),{circleTangency:f,lineTangency:h,theta:g}=g4({cx:t,cy:r,radius:s,angle:c,sign:d,cornerRadius:a,cornerIsExternal:o}),{circleTangency:p,lineTangency:x,theta:v}=g4({cx:t,cy:r,radius:s,angle:u,sign:-d,cornerRadius:a,cornerIsExternal:o}),C=o?Math.abs(c-u):Math.abs(c-u)-g-v;if(C<0)return i?"M ".concat(h.x,",").concat(h.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):EX({cx:t,cy:r,innerRadius:n,outerRadius:s,startAngle:c,endAngle:u});var b="M ".concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(C>180),",").concat(+(d<0),",").concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
  `);if(n>0){var{circleTangency:_,lineTangency:T,theta:N}=g4({cx:t,cy:r,radius:n,angle:c,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:E,lineTangency:F,theta:j}=g4({cx:t,cy:r,radius:n,angle:u,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),P=o?Math.abs(c-u):Math.abs(c-u)-N-j;if(P<0&&a===0)return"".concat(b,"L").concat(t,",").concat(r,"Z");b+="L".concat(F.x,",").concat(F.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(E.x,",").concat(E.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(d>0),",").concat(_.x,",").concat(_.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(T.x,",").concat(T.y,"Z")}else b+="L".concat(t,",").concat(r,"Z");return b},mTe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},gTe=e=>{var t=Gc(e,mTe),{cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:i,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d,className:f}=t;if(a<s||u===d)return null;var h=Vs("recharts-sector",f),g=a-s,p=mh(i,g,0,!0),x;return p>0&&Math.abs(u-d)<360?x=hTe({cx:r,cy:n,innerRadius:s,outerRadius:a,cornerRadius:Math.min(p,g/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:d}):x=EX({cx:r,cy:n,innerRadius:s,outerRadius:a,startAngle:u,endAngle:d}),w.createElement("path",U8({},oo(t,!0),{className:h,d:x}))};function pTe(e,t,r){var n,s,a,i;if(e==="horizontal")n=t.x,a=n,s=r.top,i=r.top+r.height;else if(e==="vertical")s=t.y,i=s,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:d,angle:f}=t,h=so(o,c,u,f),g=so(o,c,d,f);n=h.x,s=h.y,a=g.x,i=g.y}else return NX(t);return[{x:n,y:s},{x:a,y:i}]}var Vk={},qk={},Kk={},UL;function xTe(){return UL||(UL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=IY();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(Kk)),Kk}var zL;function yTe(){return zL||(zL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=xTe();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(qk)),qk}var WL;function vTe(){return WL||(WL=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LY(),r=yTe();function n(s,a,i){i&&typeof i!="number"&&t.isIterateeCall(s,a,i)&&(a=i=void 0),s=r.toFinite(s),a===void 0?(a=s,s=0):a=r.toFinite(a),i=i===void 0?s<a?1:-1:r.toFinite(i);const o=Math.max(Math.ceil((a-s)/(i||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=s,s+=i;return c}e.range=n})(Vk)),Vk}var Yk,HL;function bTe(){return HL||(HL=1,Yk=vTe().range),Yk}var wTe=bTe();const AX=ec(wTe);function eh(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function _Te(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function NA(e){let t,r,n;e.length!==2?(t=eh,r=(o,c)=>eh(e(o),c),n=(o,c)=>e(o)-c):(t=e===eh||e===_Te?e:STe,r=e,n=e);function s(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<0?u=f+1:d=f}while(u<d)}return u}function a(o,c,u=0,d=o.length){if(u<d){if(t(c,c)!==0)return d;do{const f=u+d>>>1;r(o[f],c)<=0?u=f+1:d=f}while(u<d)}return u}function i(o,c,u=0,d=o.length){const f=s(o,c,u,d-1);return f>u&&n(o[f-1],c)>-n(o[f],c)?f-1:f}return{left:s,center:i,right:a}}function STe(){return 0}function jX(e){return e===null?NaN:+e}function*kTe(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const CTe=NA(eh),ub=CTe.right;NA(jX).center;class GL extends Map{constructor(t,r=ETe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,s]of t)this.set(n,s)}get(t){return super.get(VL(this,t))}has(t){return super.has(VL(this,t))}set(t,r){return super.set(TTe(this,t),r)}delete(t){return super.delete(NTe(this,t))}}function VL({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function TTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function NTe({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function ETe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ATe(e=eh){if(e===eh)return PX;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function PX(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const jTe=Math.sqrt(50),PTe=Math.sqrt(10),FTe=Math.sqrt(2);function Z_(e,t,r){const n=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(n)),a=n/Math.pow(10,s),i=a>=jTe?10:a>=PTe?5:a>=FTe?2:1;let o,c,u;return s<0?(u=Math.pow(10,-s)/i,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,s)*i,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?Z_(e,t,r*2):[o,c,u]}function z8(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[s,a,i]=n?Z_(t,e,r):Z_(e,t,r);if(!(a>=s))return[];const o=a-s+1,c=new Array(o);if(n)if(i<0)for(let u=0;u<o;++u)c[u]=(a-u)/-i;else for(let u=0;u<o;++u)c[u]=(a-u)*i;else if(i<0)for(let u=0;u<o;++u)c[u]=(s+u)/-i;else for(let u=0;u<o;++u)c[u]=(s+u)*i;return c}function W8(e,t,r){return t=+t,e=+e,r=+r,Z_(e,t,r)[2]}function H8(e,t,r){t=+t,e=+e,r=+r;const n=t<e,s=n?W8(t,e,r):W8(e,t,r);return(n?-1:1)*(s<0?1/-s:s)}function qL(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function KL(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function FX(e,t,r=0,n=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(s=s===void 0?PX:ATe(s);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,d=Math.log(c),f=.5*Math.exp(2*d/3),h=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),g=Math.max(r,Math.floor(t-u*f/c+h)),p=Math.min(n,Math.floor(t+(c-u)*f/c+h));FX(e,t,g,p,s)}const a=e[t];let i=r,o=n;for(Zy(e,r,t),s(e[n],a)>0&&Zy(e,r,n);i<o;){for(Zy(e,i,o),++i,--o;s(e[i],a)<0;)++i;for(;s(e[o],a)>0;)--o}s(e[r],a)===0?Zy(e,r,o):(++o,Zy(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Zy(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function MTe(e,t,r){if(e=Float64Array.from(kTe(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return KL(e);if(t>=1)return qL(e);var n,s=(n-1)*t,a=Math.floor(s),i=qL(FX(e,a).subarray(0,a+1)),o=KL(e.subarray(a+1));return i+(o-i)*(s-a)}}function RTe(e,t,r=jX){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,s=(n-1)*t,a=Math.floor(s),i=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return i+(o-i)*(s-a)}}function OTe(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var n=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(s);++n<s;)a[n]=e+n*r;return a}function Vc(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function z0(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const G8=Symbol("implicit");function EA(){var e=new GL,t=[],r=[],n=G8;function s(a){let i=e.get(a);if(i===void 0){if(n!==G8)return n;e.set(a,i=t.push(a)-1)}return r[i%r.length]}return s.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new GL;for(const i of a)e.has(i)||e.set(i,t.push(i)-1);return s},s.range=function(a){return arguments.length?(r=Array.from(a),s):r.slice()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return EA(t,r).unknown(n)},Vc.apply(s,arguments),s}function AA(){var e=EA().unknown(void 0),t=e.domain,r=e.range,n=0,s=1,a,i,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var h=t().length,g=s<n,p=g?s:n,x=g?n:s;a=(x-p)/Math.max(1,h-c+u*2),o&&(a=Math.floor(a)),p+=(x-p-a*(h-c))*d,i=a*(1-c),o&&(p=Math.round(p),i=Math.round(i));var v=OTe(h).map(function(C){return p+a*C});return r(g?v.reverse():v)}return e.domain=function(h){return arguments.length?(t(h),f()):t()},e.range=function(h){return arguments.length?([n,s]=h,n=+n,s=+s,f()):[n,s]},e.rangeRound=function(h){return[n,s]=h,n=+n,s=+s,o=!0,f()},e.bandwidth=function(){return i},e.step=function(){return a},e.round=function(h){return arguments.length?(o=!!h,f()):o},e.padding=function(h){return arguments.length?(c=Math.min(1,u=+h),f()):c},e.paddingInner=function(h){return arguments.length?(c=Math.min(1,h),f()):c},e.paddingOuter=function(h){return arguments.length?(u=+h,f()):u},e.align=function(h){return arguments.length?(d=Math.max(0,Math.min(1,h)),f()):d},e.copy=function(){return AA(t(),[n,s]).round(o).paddingInner(c).paddingOuter(u).align(d)},Vc.apply(f(),arguments)}function MX(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return MX(t())},e}function DTe(){return MX(AA.apply(null,arguments).paddingInner(1))}function jA(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function RX(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function db(){}var w2=.7,eS=1/w2,i1="\\s*([+-]?\\d+)\\s*",_2="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",fd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ITe=/^#([0-9a-f]{3,8})$/,LTe=new RegExp(`^rgb\\(${i1},${i1},${i1}\\)$`),BTe=new RegExp(`^rgb\\(${fd},${fd},${fd}\\)$`),$Te=new RegExp(`^rgba\\(${i1},${i1},${i1},${_2}\\)$`),UTe=new RegExp(`^rgba\\(${fd},${fd},${fd},${_2}\\)$`),zTe=new RegExp(`^hsl\\(${_2},${fd},${fd}\\)$`),WTe=new RegExp(`^hsla\\(${_2},${fd},${fd},${_2}\\)$`),YL={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};jA(db,S2,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:XL,formatHex:XL,formatHex8:HTe,formatHsl:GTe,formatRgb:JL,toString:JL});function XL(){return this.rgb().formatHex()}function HTe(){return this.rgb().formatHex8()}function GTe(){return OX(this).formatHsl()}function JL(){return this.rgb().formatRgb()}function S2(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=ITe.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?QL(t):r===3?new bl(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?p4(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?p4(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=LTe.exec(e))?new bl(t[1],t[2],t[3],1):(t=BTe.exec(e))?new bl(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$Te.exec(e))?p4(t[1],t[2],t[3],t[4]):(t=UTe.exec(e))?p4(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=zTe.exec(e))?tB(t[1],t[2]/100,t[3]/100,1):(t=WTe.exec(e))?tB(t[1],t[2]/100,t[3]/100,t[4]):YL.hasOwnProperty(e)?QL(YL[e]):e==="transparent"?new bl(NaN,NaN,NaN,0):null}function QL(e){return new bl(e>>16&255,e>>8&255,e&255,1)}function p4(e,t,r,n){return n<=0&&(e=t=r=NaN),new bl(e,t,r,n)}function VTe(e){return e instanceof db||(e=S2(e)),e?(e=e.rgb(),new bl(e.r,e.g,e.b,e.opacity)):new bl}function V8(e,t,r,n){return arguments.length===1?VTe(e):new bl(e,t,r,n??1)}function bl(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}jA(bl,V8,RX(db,{brighter(e){return e=e==null?eS:Math.pow(eS,e),new bl(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?w2:Math.pow(w2,e),new bl(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new bl(Lm(this.r),Lm(this.g),Lm(this.b),tS(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ZL,formatHex:ZL,formatHex8:qTe,formatRgb:eB,toString:eB}));function ZL(){return`#${Sm(this.r)}${Sm(this.g)}${Sm(this.b)}`}function qTe(){return`#${Sm(this.r)}${Sm(this.g)}${Sm(this.b)}${Sm((isNaN(this.opacity)?1:this.opacity)*255)}`}function eB(){const e=tS(this.opacity);return`${e===1?"rgb(":"rgba("}${Lm(this.r)}, ${Lm(this.g)}, ${Lm(this.b)}${e===1?")":`, ${e})`}`}function tS(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Lm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Sm(e){return e=Lm(e),(e<16?"0":"")+e.toString(16)}function tB(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new mu(e,t,r,n)}function OX(e){if(e instanceof mu)return new mu(e.h,e.s,e.l,e.opacity);if(e instanceof db||(e=S2(e)),!e)return new mu;if(e instanceof mu)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,s=Math.min(t,r,n),a=Math.max(t,r,n),i=NaN,o=a-s,c=(a+s)/2;return o?(t===a?i=(r-n)/o+(r<n)*6:r===a?i=(n-t)/o+2:i=(t-r)/o+4,o/=c<.5?a+s:2-a-s,i*=60):o=c>0&&c<1?0:i,new mu(i,o,c,e.opacity)}function KTe(e,t,r,n){return arguments.length===1?OX(e):new mu(e,t,r,n??1)}function mu(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}jA(mu,KTe,RX(db,{brighter(e){return e=e==null?eS:Math.pow(eS,e),new mu(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?w2:Math.pow(w2,e),new mu(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,s=2*r-n;return new bl(Xk(e>=240?e-240:e+120,s,n),Xk(e,s,n),Xk(e<120?e+240:e-120,s,n),this.opacity)},clamp(){return new mu(rB(this.h),x4(this.s),x4(this.l),tS(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=tS(this.opacity);return`${e===1?"hsl(":"hsla("}${rB(this.h)}, ${x4(this.s)*100}%, ${x4(this.l)*100}%${e===1?")":`, ${e})`}`}}));function rB(e){return e=(e||0)%360,e<0?e+360:e}function x4(e){return Math.max(0,Math.min(1,e||0))}function Xk(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const PA=e=>()=>e;function YTe(e,t){return function(r){return e+r*t}}function XTe(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function JTe(e){return(e=+e)==1?DX:function(t,r){return r-t?XTe(t,r,e):PA(isNaN(t)?r:t)}}function DX(e,t){var r=t-e;return r?YTe(e,r):PA(isNaN(e)?t:e)}const nB=(function e(t){var r=JTe(t);function n(s,a){var i=r((s=V8(s)).r,(a=V8(a)).r),o=r(s.g,a.g),c=r(s.b,a.b),u=DX(s.opacity,a.opacity);return function(d){return s.r=i(d),s.g=o(d),s.b=c(d),s.opacity=u(d),s+""}}return n.gamma=e,n})(1);function QTe(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),s;return function(a){for(s=0;s<r;++s)n[s]=e[s]*(1-a)+t[s]*a;return n}}function ZTe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function e8e(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,s=new Array(n),a=new Array(r),i;for(i=0;i<n;++i)s[i]=ex(e[i],t[i]);for(;i<r;++i)a[i]=t[i];return function(o){for(i=0;i<n;++i)a[i]=s[i](o);return a}}function t8e(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function rS(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function r8e(e,t){var r={},n={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=ex(e[s],t[s]):n[s]=t[s];return function(a){for(s in r)n[s]=r[s](a);return n}}var q8=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Jk=new RegExp(q8.source,"g");function n8e(e){return function(){return e}}function s8e(e){return function(t){return e(t)+""}}function a8e(e,t){var r=q8.lastIndex=Jk.lastIndex=0,n,s,a,i=-1,o=[],c=[];for(e=e+"",t=t+"";(n=q8.exec(e))&&(s=Jk.exec(t));)(a=s.index)>r&&(a=t.slice(r,a),o[i]?o[i]+=a:o[++i]=a),(n=n[0])===(s=s[0])?o[i]?o[i]+=s:o[++i]=s:(o[++i]=null,c.push({i,x:rS(n,s)})),r=Jk.lastIndex;return r<t.length&&(a=t.slice(r),o[i]?o[i]+=a:o[++i]=a),o.length<2?c[0]?s8e(c[0].x):n8e(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function ex(e,t){var r=typeof t,n;return t==null||r==="boolean"?PA(t):(r==="number"?rS:r==="string"?(n=S2(t))?(t=n,nB):a8e:t instanceof S2?nB:t instanceof Date?t8e:ZTe(t)?QTe:Array.isArray(t)?e8e:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?r8e:rS)(e,t)}function FA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function i8e(e,t){t===void 0&&(t=e,e=ex);for(var r=0,n=t.length-1,s=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(s,s=t[++r]);return function(i){var o=Math.max(0,Math.min(n-1,Math.floor(i*=n)));return a[o](i-o)}}function o8e(e){return function(){return e}}function nS(e){return+e}var sB=[0,1];function Jo(e){return e}function K8(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:o8e(isNaN(t)?NaN:.5)}function l8e(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function c8e(e,t,r){var n=e[0],s=e[1],a=t[0],i=t[1];return s<n?(n=K8(s,n),a=r(i,a)):(n=K8(n,s),a=r(a,i)),function(o){return a(n(o))}}function u8e(e,t,r){var n=Math.min(e.length,t.length)-1,s=new Array(n),a=new Array(n),i=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++i<n;)s[i]=K8(e[i],e[i+1]),a[i]=r(t[i],t[i+1]);return function(o){var c=ub(e,o,1,n)-1;return a[c](s[c](o))}}function fb(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function w3(){var e=sB,t=sB,r=ex,n,s,a,i=Jo,o,c,u;function d(){var h=Math.min(e.length,t.length);return i!==Jo&&(i=l8e(e[0],e[h-1])),o=h>2?u8e:c8e,c=u=null,f}function f(h){return h==null||isNaN(h=+h)?a:(c||(c=o(e.map(n),t,r)))(n(i(h)))}return f.invert=function(h){return i(s((u||(u=o(t,e.map(n),rS)))(h)))},f.domain=function(h){return arguments.length?(e=Array.from(h,nS),d()):e.slice()},f.range=function(h){return arguments.length?(t=Array.from(h),d()):t.slice()},f.rangeRound=function(h){return t=Array.from(h),r=FA,d()},f.clamp=function(h){return arguments.length?(i=h?!0:Jo,d()):i!==Jo},f.interpolate=function(h){return arguments.length?(r=h,d()):r},f.unknown=function(h){return arguments.length?(a=h,f):a},function(h,g){return n=h,s=g,d()}}function MA(){return w3()(Jo,Jo)}function d8e(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function sS(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function _1(e){return e=sS(Math.abs(e)),e?e[1]:NaN}function f8e(e,t){return function(r,n){for(var s=r.length,a=[],i=0,o=e[0],c=0;s>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),a.push(r.substring(s-=o,s+o)),!((c+=o+1)>n));)o=e[i=(i+1)%e.length];return a.reverse().join(t)}}function h8e(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var m8e=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function k2(e){if(!(t=m8e.exec(e)))throw new Error("invalid format: "+e);var t;return new RA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}k2.prototype=RA.prototype;function RA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}RA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function g8e(e){e:for(var t=e.length,r=1,n=-1,s;r<t;++r)switch(e[r]){case".":n=s=r;break;case"0":n===0&&(n=r),s=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(s+1):e}var IX;function p8e(e,t){var r=sS(e,t);if(!r)return e+"";var n=r[0],s=r[1],a=s-(IX=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,i=n.length;return a===i?n:a>i?n+new Array(a-i+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+sS(e,Math.max(0,t+a-1))[0]}function aB(e,t){var r=sS(e,t);if(!r)return e+"";var n=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+n:n.length>s+1?n.slice(0,s+1)+"."+n.slice(s+1):n+new Array(s-n.length+2).join("0")}const iB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:d8e,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>aB(e*100,t),r:aB,s:p8e,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function oB(e){return e}var lB=Array.prototype.map,cB=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function x8e(e){var t=e.grouping===void 0||e.thousands===void 0?oB:f8e(lB.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?oB:h8e(lB.call(e.numerals,String)),i=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=k2(f);var h=f.fill,g=f.align,p=f.sign,x=f.symbol,v=f.zero,C=f.width,b=f.comma,_=f.precision,T=f.trim,N=f.type;N==="n"?(b=!0,N="g"):iB[N]||(_===void 0&&(_=12),T=!0,N="g"),(v||h==="0"&&g==="=")&&(v=!0,h="0",g="=");var E=x==="$"?r:x==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",F=x==="$"?n:/[%p]/.test(N)?i:"",j=iB[N],P=/[defgprs%]/.test(N);_=_===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));function M(I){var U=E,K=F,te,re,Z;if(N==="c")K=j(I)+K,I="";else{I=+I;var B=I<0||1/I<0;if(I=isNaN(I)?c:j(Math.abs(I),_),T&&(I=g8e(I)),B&&+I==0&&p!=="+"&&(B=!1),U=(B?p==="("?p:o:p==="-"||p==="("?"":p)+U,K=(N==="s"?cB[8+IX/3]:"")+K+(B&&p==="("?")":""),P){for(te=-1,re=I.length;++te<re;)if(Z=I.charCodeAt(te),48>Z||Z>57){K=(Z===46?s+I.slice(te+1):I.slice(te))+K,I=I.slice(0,te);break}}}b&&!v&&(I=t(I,1/0));var J=U.length+I.length+K.length,z=J<C?new Array(C-J+1).join(h):"";switch(b&&v&&(I=t(z+I,z.length?C-K.length:1/0),z=""),g){case"<":I=U+I+K+z;break;case"=":I=U+z+I+K;break;case"^":I=z.slice(0,J=z.length>>1)+U+I+K+z.slice(J);break;default:I=z+U+I+K;break}return a(I)}return M.toString=function(){return f+""},M}function d(f,h){var g=u((f=k2(f),f.type="f",f)),p=Math.max(-8,Math.min(8,Math.floor(_1(h)/3)))*3,x=Math.pow(10,-p),v=cB[8+p/3];return function(C){return g(x*C)+v}}return{format:u,formatPrefix:d}}var y4,OA,LX;y8e({thousands:",",grouping:[3],currency:["$",""]});function y8e(e){return y4=x8e(e),OA=y4.format,LX=y4.formatPrefix,y4}function v8e(e){return Math.max(0,-_1(Math.abs(e)))}function b8e(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(_1(t)/3)))*3-_1(Math.abs(e)))}function w8e(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,_1(t)-_1(e))+1}function BX(e,t,r,n){var s=H8(e,t,r),a;switch(n=k2(n??",f"),n.type){case"s":{var i=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=b8e(s,i))&&(n.precision=a),LX(n,i)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=w8e(s,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=v8e(s))&&(n.precision=a-(n.type==="%")*2);break}}return OA(n)}function Nh(e){var t=e.domain;return e.ticks=function(r){var n=t();return z8(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var s=t();return BX(s[0],s[s.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),s=0,a=n.length-1,i=n[s],o=n[a],c,u,d=10;for(o<i&&(u=i,i=o,o=u,u=s,s=a,a=u);d-- >0;){if(u=W8(i,o,r),u===c)return n[s]=i,n[a]=o,t(n);if(u>0)i=Math.floor(i/u)*u,o=Math.ceil(o/u)*u;else if(u<0)i=Math.ceil(i*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function $X(){var e=MA();return e.copy=function(){return fb(e,$X())},Vc.apply(e,arguments),Nh(e)}function UX(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,nS),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return UX(e).unknown(t)},e=arguments.length?Array.from(e,nS):[0,1],Nh(r)}function zX(e,t){e=e.slice();var r=0,n=e.length-1,s=e[r],a=e[n],i;return a<s&&(i=r,r=n,n=i,i=s,s=a,a=i),e[r]=t.floor(s),e[n]=t.ceil(a),e}function uB(e){return Math.log(e)}function dB(e){return Math.exp(e)}function _8e(e){return-Math.log(-e)}function S8e(e){return-Math.exp(-e)}function k8e(e){return isFinite(e)?+("1e"+e):e<0?0:e}function C8e(e){return e===10?k8e:e===Math.E?Math.exp:t=>Math.pow(e,t)}function T8e(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function fB(e){return(t,r)=>-e(-t,r)}function DA(e){const t=e(uB,dB),r=t.domain;let n=10,s,a;function i(){return s=T8e(n),a=C8e(n),r()[0]<0?(s=fB(s),a=fB(a),e(_8e,S8e)):e(uB,dB),t}return t.base=function(o){return arguments.length?(n=+o,i()):n},t.domain=function(o){return arguments.length?(r(o),i()):r()},t.ticks=o=>{const c=r();let u=c[0],d=c[c.length-1];const f=d<u;f&&([u,d]=[d,u]);let h=s(u),g=s(d),p,x;const v=o==null?10:+o;let C=[];if(!(n%1)&&g-h<v){if(h=Math.floor(h),g=Math.ceil(g),u>0){for(;h<=g;++h)for(p=1;p<n;++p)if(x=h<0?p/a(-h):p*a(h),!(x<u)){if(x>d)break;C.push(x)}}else for(;h<=g;++h)for(p=n-1;p>=1;--p)if(x=h>0?p/a(-h):p*a(h),!(x<u)){if(x>d)break;C.push(x)}C.length*2<v&&(C=z8(u,d,v))}else C=z8(h,g,Math.min(g-h,v)).map(a);return f?C.reverse():C},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=k2(c)).precision==null&&(c.trim=!0),c=OA(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return d=>{let f=d/a(Math.round(s(d)));return f*n<n-.5&&(f*=n),f<=u?c(d):""}},t.nice=()=>r(zX(r(),{floor:o=>a(Math.floor(s(o))),ceil:o=>a(Math.ceil(s(o)))})),t}function WX(){const e=DA(w3()).domain([1,10]);return e.copy=()=>fb(e,WX()).base(e.base()),Vc.apply(e,arguments),e}function hB(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function mB(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function IA(e){var t=1,r=e(hB(t),mB(t));return r.constant=function(n){return arguments.length?e(hB(t=+n),mB(t)):t},Nh(r)}function HX(){var e=IA(w3());return e.copy=function(){return fb(e,HX()).constant(e.constant())},Vc.apply(e,arguments)}function gB(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function N8e(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function E8e(e){return e<0?-e*e:e*e}function LA(e){var t=e(Jo,Jo),r=1;function n(){return r===1?e(Jo,Jo):r===.5?e(N8e,E8e):e(gB(r),gB(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,n()):r},Nh(t)}function BA(){var e=LA(w3());return e.copy=function(){return fb(e,BA()).exponent(e.exponent())},Vc.apply(e,arguments),e}function A8e(){return BA.apply(null,arguments).exponent(.5)}function pB(e){return Math.sign(e)*e*e}function j8e(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function GX(){var e=MA(),t=[0,1],r=!1,n;function s(a){var i=j8e(e(a));return isNaN(i)?n:r?Math.round(i):i}return s.invert=function(a){return e.invert(pB(a))},s.domain=function(a){return arguments.length?(e.domain(a),s):e.domain()},s.range=function(a){return arguments.length?(e.range((t=Array.from(a,nS)).map(pB)),s):t.slice()},s.rangeRound=function(a){return s.range(a).round(!0)},s.round=function(a){return arguments.length?(r=!!a,s):r},s.clamp=function(a){return arguments.length?(e.clamp(a),s):e.clamp()},s.unknown=function(a){return arguments.length?(n=a,s):n},s.copy=function(){return GX(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Vc.apply(s,arguments),Nh(s)}function VX(){var e=[],t=[],r=[],n;function s(){var i=0,o=Math.max(1,t.length);for(r=new Array(o-1);++i<o;)r[i-1]=RTe(e,i/o);return a}function a(i){return i==null||isNaN(i=+i)?n:t[ub(r,i)]}return a.invertExtent=function(i){var o=t.indexOf(i);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let o of i)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(eh),s()},a.range=function(i){return arguments.length?(t=Array.from(i),s()):t.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return VX().domain(e).range(t).unknown(n)},Vc.apply(a,arguments)}function qX(){var e=0,t=1,r=1,n=[.5],s=[0,1],a;function i(c){return c!=null&&c<=c?s[ub(n,c,0,r)]:a}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return i}return i.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},i.range=function(c){return arguments.length?(r=(s=Array.from(c)).length-1,o()):s.slice()},i.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},i.unknown=function(c){return arguments.length&&(a=c),i},i.thresholds=function(){return n.slice()},i.copy=function(){return qX().domain([e,t]).range(s).unknown(a)},Vc.apply(Nh(i),arguments)}function KX(){var e=[.5],t=[0,1],r,n=1;function s(a){return a!=null&&a<=a?t[ub(e,a,0,n)]:r}return s.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(a){var i=t.indexOf(a);return[e[i-1],e[i]]},s.unknown=function(a){return arguments.length?(r=a,s):r},s.copy=function(){return KX().domain(e).range(t).unknown(r)},Vc.apply(s,arguments)}const Qk=new Date,Zk=new Date;function pi(e,t,r,n){function s(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return s.floor=a=>(e(a=new Date(+a)),a),s.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),s.round=a=>{const i=s(a),o=s.ceil(a);return a-i<o-a?i:o},s.offset=(a,i)=>(t(a=new Date(+a),i==null?1:Math.floor(i)),a),s.range=(a,i,o)=>{const c=[];if(a=s.ceil(a),o=o==null?1:Math.floor(o),!(a<i)||!(o>0))return c;let u;do c.push(u=new Date(+a)),t(a,o),e(a);while(u<a&&a<i);return c},s.filter=a=>pi(i=>{if(i>=i)for(;e(i),!a(i);)i.setTime(i-1)},(i,o)=>{if(i>=i)if(o<0)for(;++o<=0;)for(;t(i,-1),!a(i););else for(;--o>=0;)for(;t(i,1),!a(i););}),r&&(s.count=(a,i)=>(Qk.setTime(+a),Zk.setTime(+i),e(Qk),e(Zk),Math.floor(r(Qk,Zk))),s.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?s.filter(n?i=>n(i)%a===0:i=>s.count(0,i)%a===0):s)),s}const aS=pi(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);aS.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?pi(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):aS);aS.range;const d0=1e3,Fc=d0*60,f0=Fc*60,j0=f0*24,$A=j0*7,xB=j0*30,eC=j0*365,km=pi(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*d0)},(e,t)=>(t-e)/d0,e=>e.getUTCSeconds());km.range;const UA=pi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*d0)},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getMinutes());UA.range;const zA=pi(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Fc)},(e,t)=>(t-e)/Fc,e=>e.getUTCMinutes());zA.range;const WA=pi(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*d0-e.getMinutes()*Fc)},(e,t)=>{e.setTime(+e+t*f0)},(e,t)=>(t-e)/f0,e=>e.getHours());WA.range;const HA=pi(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*f0)},(e,t)=>(t-e)/f0,e=>e.getUTCHours());HA.range;const hb=pi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fc)/j0,e=>e.getDate()-1);hb.range;const _3=pi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/j0,e=>e.getUTCDate()-1);_3.range;const YX=pi(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/j0,e=>Math.floor(e/j0));YX.range;function kg(e){return pi(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Fc)/$A)}const S3=kg(0),iS=kg(1),P8e=kg(2),F8e=kg(3),S1=kg(4),M8e=kg(5),R8e=kg(6);S3.range;iS.range;P8e.range;F8e.range;S1.range;M8e.range;R8e.range;function Cg(e){return pi(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/$A)}const k3=Cg(0),oS=Cg(1),O8e=Cg(2),D8e=Cg(3),k1=Cg(4),I8e=Cg(5),L8e=Cg(6);k3.range;oS.range;O8e.range;D8e.range;k1.range;I8e.range;L8e.range;const GA=pi(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());GA.range;const VA=pi(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());VA.range;const P0=pi(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());P0.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:pi(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});P0.range;const F0=pi(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());F0.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:pi(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});F0.range;function XX(e,t,r,n,s,a){const i=[[km,1,d0],[km,5,5*d0],[km,15,15*d0],[km,30,30*d0],[a,1,Fc],[a,5,5*Fc],[a,15,15*Fc],[a,30,30*Fc],[s,1,f0],[s,3,3*f0],[s,6,6*f0],[s,12,12*f0],[n,1,j0],[n,2,2*j0],[r,1,$A],[t,1,xB],[t,3,3*xB],[e,1,eC]];function o(u,d,f){const h=d<u;h&&([u,d]=[d,u]);const g=f&&typeof f.range=="function"?f:c(u,d,f),p=g?g.range(u,+d+1):[];return h?p.reverse():p}function c(u,d,f){const h=Math.abs(d-u)/f,g=NA(([,,v])=>v).right(i,h);if(g===i.length)return e.every(H8(u/eC,d/eC,f));if(g===0)return aS.every(Math.max(H8(u,d,f),1));const[p,x]=i[h/i[g-1][2]<i[g][2]/h?g-1:g];return p.every(x)}return[o,c]}const[B8e,$8e]=XX(F0,VA,k3,YX,HA,zA),[U8e,z8e]=XX(P0,GA,S3,hb,WA,UA);function tC(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function rC(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ev(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function W8e(e){var t=e.dateTime,r=e.date,n=e.time,s=e.periods,a=e.days,i=e.shortDays,o=e.months,c=e.shortMonths,u=tv(s),d=rv(s),f=tv(a),h=rv(a),g=tv(i),p=rv(i),x=tv(o),v=rv(o),C=tv(c),b=rv(c),_={a:B,A:J,b:z,B:q,c:null,d:SB,e:SB,f:f7e,g:_7e,G:k7e,H:c7e,I:u7e,j:d7e,L:JX,m:h7e,M:m7e,p:H,q:R,Q:TB,s:NB,S:g7e,u:p7e,U:x7e,V:y7e,w:v7e,W:b7e,x:null,X:null,y:w7e,Y:S7e,Z:C7e,"%":CB},T={a:L,A:G,b:W,B:Q,c:null,d:kB,e:kB,f:A7e,g:B7e,G:U7e,H:T7e,I:N7e,j:E7e,L:ZX,m:j7e,M:P7e,p:X,q:se,Q:TB,s:NB,S:F7e,u:M7e,U:R7e,V:O7e,w:D7e,W:I7e,x:null,X:null,y:L7e,Y:$7e,Z:z7e,"%":CB},N={a:M,A:I,b:U,B:K,c:te,d:wB,e:wB,f:a7e,g:bB,G:vB,H:_B,I:_B,j:t7e,L:s7e,m:e7e,M:r7e,p:P,q:Z8e,Q:o7e,s:l7e,S:n7e,u:K8e,U:Y8e,V:X8e,w:q8e,W:J8e,x:re,X:Z,y:bB,Y:vB,Z:Q8e,"%":i7e};_.x=E(r,_),_.X=E(n,_),_.c=E(t,_),T.x=E(r,T),T.X=E(n,T),T.c=E(t,T);function E(le,he){return function(we){var ie=[],Ee=-1,ye=0,Ie=le.length,ut,Qe,$t;for(we instanceof Date||(we=new Date(+we));++Ee<Ie;)le.charCodeAt(Ee)===37&&(ie.push(le.slice(ye,Ee)),(Qe=yB[ut=le.charAt(++Ee)])!=null?ut=le.charAt(++Ee):Qe=ut==="e"?" ":"0",($t=he[ut])&&(ut=$t(we,Qe)),ie.push(ut),ye=Ee+1);return ie.push(le.slice(ye,Ee)),ie.join("")}}function F(le,he){return function(we){var ie=ev(1900,void 0,1),Ee=j(ie,le,we+="",0),ye,Ie;if(Ee!=we.length)return null;if("Q"in ie)return new Date(ie.Q);if("s"in ie)return new Date(ie.s*1e3+("L"in ie?ie.L:0));if(he&&!("Z"in ie)&&(ie.Z=0),"p"in ie&&(ie.H=ie.H%12+ie.p*12),ie.m===void 0&&(ie.m="q"in ie?ie.q:0),"V"in ie){if(ie.V<1||ie.V>53)return null;"w"in ie||(ie.w=1),"Z"in ie?(ye=rC(ev(ie.y,0,1)),Ie=ye.getUTCDay(),ye=Ie>4||Ie===0?oS.ceil(ye):oS(ye),ye=_3.offset(ye,(ie.V-1)*7),ie.y=ye.getUTCFullYear(),ie.m=ye.getUTCMonth(),ie.d=ye.getUTCDate()+(ie.w+6)%7):(ye=tC(ev(ie.y,0,1)),Ie=ye.getDay(),ye=Ie>4||Ie===0?iS.ceil(ye):iS(ye),ye=hb.offset(ye,(ie.V-1)*7),ie.y=ye.getFullYear(),ie.m=ye.getMonth(),ie.d=ye.getDate()+(ie.w+6)%7)}else("W"in ie||"U"in ie)&&("w"in ie||(ie.w="u"in ie?ie.u%7:"W"in ie?1:0),Ie="Z"in ie?rC(ev(ie.y,0,1)).getUTCDay():tC(ev(ie.y,0,1)).getDay(),ie.m=0,ie.d="W"in ie?(ie.w+6)%7+ie.W*7-(Ie+5)%7:ie.w+ie.U*7-(Ie+6)%7);return"Z"in ie?(ie.H+=ie.Z/100|0,ie.M+=ie.Z%100,rC(ie)):tC(ie)}}function j(le,he,we,ie){for(var Ee=0,ye=he.length,Ie=we.length,ut,Qe;Ee<ye;){if(ie>=Ie)return-1;if(ut=he.charCodeAt(Ee++),ut===37){if(ut=he.charAt(Ee++),Qe=N[ut in yB?he.charAt(Ee++):ut],!Qe||(ie=Qe(le,we,ie))<0)return-1}else if(ut!=we.charCodeAt(ie++))return-1}return ie}function P(le,he,we){var ie=u.exec(he.slice(we));return ie?(le.p=d.get(ie[0].toLowerCase()),we+ie[0].length):-1}function M(le,he,we){var ie=g.exec(he.slice(we));return ie?(le.w=p.get(ie[0].toLowerCase()),we+ie[0].length):-1}function I(le,he,we){var ie=f.exec(he.slice(we));return ie?(le.w=h.get(ie[0].toLowerCase()),we+ie[0].length):-1}function U(le,he,we){var ie=C.exec(he.slice(we));return ie?(le.m=b.get(ie[0].toLowerCase()),we+ie[0].length):-1}function K(le,he,we){var ie=x.exec(he.slice(we));return ie?(le.m=v.get(ie[0].toLowerCase()),we+ie[0].length):-1}function te(le,he,we){return j(le,t,he,we)}function re(le,he,we){return j(le,r,he,we)}function Z(le,he,we){return j(le,n,he,we)}function B(le){return i[le.getDay()]}function J(le){return a[le.getDay()]}function z(le){return c[le.getMonth()]}function q(le){return o[le.getMonth()]}function H(le){return s[+(le.getHours()>=12)]}function R(le){return 1+~~(le.getMonth()/3)}function L(le){return i[le.getUTCDay()]}function G(le){return a[le.getUTCDay()]}function W(le){return c[le.getUTCMonth()]}function Q(le){return o[le.getUTCMonth()]}function X(le){return s[+(le.getUTCHours()>=12)]}function se(le){return 1+~~(le.getUTCMonth()/3)}return{format:function(le){var he=E(le+="",_);return he.toString=function(){return le},he},parse:function(le){var he=F(le+="",!1);return he.toString=function(){return le},he},utcFormat:function(le){var he=E(le+="",T);return he.toString=function(){return le},he},utcParse:function(le){var he=F(le+="",!0);return he.toString=function(){return le},he}}}var yB={"-":"",_:" ",0:"0"},Di=/^\s*\d+/,H8e=/^%/,G8e=/[\\^$*+?|[\]().{}]/g;function Qn(e,t,r){var n=e<0?"-":"",s=(n?-e:e)+"",a=s.length;return n+(a<r?new Array(r-a+1).join(t)+s:s)}function V8e(e){return e.replace(G8e,"\\$&")}function tv(e){return new RegExp("^(?:"+e.map(V8e).join("|")+")","i")}function rv(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function q8e(e,t,r){var n=Di.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function K8e(e,t,r){var n=Di.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function Y8e(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function X8e(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function J8e(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function vB(e,t,r){var n=Di.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function bB(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function Q8e(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function Z8e(e,t,r){var n=Di.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function e7e(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function wB(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function t7e(e,t,r){var n=Di.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function _B(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function r7e(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function n7e(e,t,r){var n=Di.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function s7e(e,t,r){var n=Di.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function a7e(e,t,r){var n=Di.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function i7e(e,t,r){var n=H8e.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function o7e(e,t,r){var n=Di.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function l7e(e,t,r){var n=Di.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function SB(e,t){return Qn(e.getDate(),t,2)}function c7e(e,t){return Qn(e.getHours(),t,2)}function u7e(e,t){return Qn(e.getHours()%12||12,t,2)}function d7e(e,t){return Qn(1+hb.count(P0(e),e),t,3)}function JX(e,t){return Qn(e.getMilliseconds(),t,3)}function f7e(e,t){return JX(e,t)+"000"}function h7e(e,t){return Qn(e.getMonth()+1,t,2)}function m7e(e,t){return Qn(e.getMinutes(),t,2)}function g7e(e,t){return Qn(e.getSeconds(),t,2)}function p7e(e){var t=e.getDay();return t===0?7:t}function x7e(e,t){return Qn(S3.count(P0(e)-1,e),t,2)}function QX(e){var t=e.getDay();return t>=4||t===0?S1(e):S1.ceil(e)}function y7e(e,t){return e=QX(e),Qn(S1.count(P0(e),e)+(P0(e).getDay()===4),t,2)}function v7e(e){return e.getDay()}function b7e(e,t){return Qn(iS.count(P0(e)-1,e),t,2)}function w7e(e,t){return Qn(e.getFullYear()%100,t,2)}function _7e(e,t){return e=QX(e),Qn(e.getFullYear()%100,t,2)}function S7e(e,t){return Qn(e.getFullYear()%1e4,t,4)}function k7e(e,t){var r=e.getDay();return e=r>=4||r===0?S1(e):S1.ceil(e),Qn(e.getFullYear()%1e4,t,4)}function C7e(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Qn(t/60|0,"0",2)+Qn(t%60,"0",2)}function kB(e,t){return Qn(e.getUTCDate(),t,2)}function T7e(e,t){return Qn(e.getUTCHours(),t,2)}function N7e(e,t){return Qn(e.getUTCHours()%12||12,t,2)}function E7e(e,t){return Qn(1+_3.count(F0(e),e),t,3)}function ZX(e,t){return Qn(e.getUTCMilliseconds(),t,3)}function A7e(e,t){return ZX(e,t)+"000"}function j7e(e,t){return Qn(e.getUTCMonth()+1,t,2)}function P7e(e,t){return Qn(e.getUTCMinutes(),t,2)}function F7e(e,t){return Qn(e.getUTCSeconds(),t,2)}function M7e(e){var t=e.getUTCDay();return t===0?7:t}function R7e(e,t){return Qn(k3.count(F0(e)-1,e),t,2)}function eJ(e){var t=e.getUTCDay();return t>=4||t===0?k1(e):k1.ceil(e)}function O7e(e,t){return e=eJ(e),Qn(k1.count(F0(e),e)+(F0(e).getUTCDay()===4),t,2)}function D7e(e){return e.getUTCDay()}function I7e(e,t){return Qn(oS.count(F0(e)-1,e),t,2)}function L7e(e,t){return Qn(e.getUTCFullYear()%100,t,2)}function B7e(e,t){return e=eJ(e),Qn(e.getUTCFullYear()%100,t,2)}function $7e(e,t){return Qn(e.getUTCFullYear()%1e4,t,4)}function U7e(e,t){var r=e.getUTCDay();return e=r>=4||r===0?k1(e):k1.ceil(e),Qn(e.getUTCFullYear()%1e4,t,4)}function z7e(){return"+0000"}function CB(){return"%"}function TB(e){return+e}function NB(e){return Math.floor(+e/1e3)}var Np,tJ,rJ;W7e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function W7e(e){return Np=W8e(e),tJ=Np.format,Np.parse,rJ=Np.utcFormat,Np.utcParse,Np}function H7e(e){return new Date(e)}function G7e(e){return e instanceof Date?+e:+new Date(+e)}function qA(e,t,r,n,s,a,i,o,c,u){var d=MA(),f=d.invert,h=d.domain,g=u(".%L"),p=u(":%S"),x=u("%I:%M"),v=u("%I %p"),C=u("%a %d"),b=u("%b %d"),_=u("%B"),T=u("%Y");function N(E){return(c(E)<E?g:o(E)<E?p:i(E)<E?x:a(E)<E?v:n(E)<E?s(E)<E?C:b:r(E)<E?_:T)(E)}return d.invert=function(E){return new Date(f(E))},d.domain=function(E){return arguments.length?h(Array.from(E,G7e)):h().map(H7e)},d.ticks=function(E){var F=h();return e(F[0],F[F.length-1],E??10)},d.tickFormat=function(E,F){return F==null?N:u(F)},d.nice=function(E){var F=h();return(!E||typeof E.range!="function")&&(E=t(F[0],F[F.length-1],E??10)),E?h(zX(F,E)):d},d.copy=function(){return fb(d,qA(e,t,r,n,s,a,i,o,c,u))},d}function V7e(){return Vc.apply(qA(U8e,z8e,P0,GA,S3,hb,WA,UA,km,tJ).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function q7e(){return Vc.apply(qA(B8e,$8e,F0,VA,k3,_3,HA,zA,km,rJ).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function C3(){var e=0,t=1,r,n,s,a,i=Jo,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:i(s===0?.5:(f=(a(f)-r)*s,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,r=a(e=+e),n=a(t=+t),s=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(i=f,u):i};function d(f){return function(h){var g,p;return arguments.length?([g,p]=h,i=f(g,p),u):[i(0),i(1)]}}return u.range=d(ex),u.rangeRound=d(FA),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return a=f,r=f(e),n=f(t),s=r===n?0:1/(n-r),u}}function Eh(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function nJ(){var e=Nh(C3()(Jo));return e.copy=function(){return Eh(e,nJ())},z0.apply(e,arguments)}function sJ(){var e=DA(C3()).domain([1,10]);return e.copy=function(){return Eh(e,sJ()).base(e.base())},z0.apply(e,arguments)}function aJ(){var e=IA(C3());return e.copy=function(){return Eh(e,aJ()).constant(e.constant())},z0.apply(e,arguments)}function KA(){var e=LA(C3());return e.copy=function(){return Eh(e,KA()).exponent(e.exponent())},z0.apply(e,arguments)}function K7e(){return KA.apply(null,arguments).exponent(.5)}function iJ(){var e=[],t=Jo;function r(n){if(n!=null&&!isNaN(n=+n))return t((ub(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let s of n)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(eh),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,s)=>t(s/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(s,a)=>MTe(e,a/n))},r.copy=function(){return iJ(t).domain(e)},z0.apply(r,arguments)}function T3(){var e=0,t=.5,r=1,n=1,s,a,i,o,c,u=Jo,d,f=!1,h;function g(x){return isNaN(x=+x)?h:(x=.5+((x=+d(x))-a)*(n*x<n*a?o:c),u(f?Math.max(0,Math.min(1,x)):x))}g.domain=function(x){return arguments.length?([e,t,r]=x,s=d(e=+e),a=d(t=+t),i=d(r=+r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,g):[e,t,r]},g.clamp=function(x){return arguments.length?(f=!!x,g):f},g.interpolator=function(x){return arguments.length?(u=x,g):u};function p(x){return function(v){var C,b,_;return arguments.length?([C,b,_]=v,u=i8e(x,[C,b,_]),g):[u(0),u(.5),u(1)]}}return g.range=p(ex),g.rangeRound=p(FA),g.unknown=function(x){return arguments.length?(h=x,g):h},function(x){return d=x,s=x(e),a=x(t),i=x(r),o=s===a?0:.5/(a-s),c=a===i?0:.5/(i-a),n=a<s?-1:1,g}}function oJ(){var e=Nh(T3()(Jo));return e.copy=function(){return Eh(e,oJ())},z0.apply(e,arguments)}function lJ(){var e=DA(T3()).domain([.1,1,10]);return e.copy=function(){return Eh(e,lJ()).base(e.base())},z0.apply(e,arguments)}function cJ(){var e=IA(T3());return e.copy=function(){return Eh(e,cJ()).constant(e.constant())},z0.apply(e,arguments)}function YA(){var e=LA(T3());return e.copy=function(){return Eh(e,YA()).exponent(e.exponent())},z0.apply(e,arguments)}function Y7e(){return YA.apply(null,arguments).exponent(.5)}const mv=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:AA,scaleDiverging:oJ,scaleDivergingLog:lJ,scaleDivergingPow:YA,scaleDivergingSqrt:Y7e,scaleDivergingSymlog:cJ,scaleIdentity:UX,scaleImplicit:G8,scaleLinear:$X,scaleLog:WX,scaleOrdinal:EA,scalePoint:DTe,scalePow:BA,scaleQuantile:VX,scaleQuantize:qX,scaleRadial:GX,scaleSequential:nJ,scaleSequentialLog:sJ,scaleSequentialPow:KA,scaleSequentialQuantile:iJ,scaleSequentialSqrt:K7e,scaleSequentialSymlog:aJ,scaleSqrt:A8e,scaleSymlog:HX,scaleThreshold:KX,scaleTime:V7e,scaleUtc:q7e,tickFormat:BX},Symbol.toStringTag,{value:"Module"}));var Ah=e=>e.chartData,X7e=Gt([Ah],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),XA=(e,t,r,n)=>n?X7e(e):Ah(e);function C1(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Su(t)&&Su(r))return!0}return!1}function EB(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function J7e(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,s,a;if(Su(r))s=r;else if(typeof r=="function")return;if(Su(n))a=n;else if(typeof n=="function")return;var i=[s,a];if(C1(i))return i}}function Q7e(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(C1(n))return EB(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[s,a]=e,i,o;if(s==="auto")t!=null&&(i=Math.min(...t));else if(gn(s))i=s;else if(typeof s=="function")try{t!=null&&(i=s(t?.[0]))}catch{}else if(typeof s=="string"&&bL.test(s)){var c=bL.exec(s);if(c==null||t==null)i=void 0;else{var u=+c[1];i=t[0]-u}}else i=t?.[0];if(a==="auto")t!=null&&(o=Math.max(...t));else if(gn(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t?.[1]))}catch{}else if(typeof a=="string"&&wL.test(a)){var d=wL.exec(a);if(d==null||t==null)o=void 0;else{var f=+d[1];o=t[1]+f}}else o=t?.[1];var h=[i,o];if(C1(h))return t==null?h:EB(h,t,r)}}}var tx=1e9,Z7e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},QA,Qs=!0,zc="[DecimalError] ",Bm=zc+"Invalid argument: ",JA=zc+"Exponent out of range: ",rx=Math.floor,gm=Math.pow,eNe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Kl,Ei=1e7,$s=7,uJ=9007199254740991,lS=rx(uJ/$s),zr={};zr.absoluteValue=zr.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};zr.comparedTo=zr.cmp=function(e){var t,r,n,s,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,s=e.d.length,t=0,r=n<s?n:s;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===s?0:n>s^a.s<0?1:-1};zr.decimalPlaces=zr.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*$s;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};zr.dividedBy=zr.div=function(e){return b0(this,new this.constructor(e))};zr.dividedToIntegerBy=zr.idiv=function(e){var t=this,r=t.constructor;return Ns(b0(t,new r(e),0,1),r.precision)};zr.equals=zr.eq=function(e){return!this.cmp(e)};zr.exponent=function(){return Qa(this)};zr.greaterThan=zr.gt=function(e){return this.cmp(e)>0};zr.greaterThanOrEqualTo=zr.gte=function(e){return this.cmp(e)>=0};zr.isInteger=zr.isint=function(){return this.e>this.d.length-2};zr.isNegative=zr.isneg=function(){return this.s<0};zr.isPositive=zr.ispos=function(){return this.s>0};zr.isZero=function(){return this.s===0};zr.lessThan=zr.lt=function(e){return this.cmp(e)<0};zr.lessThanOrEqualTo=zr.lte=function(e){return this.cmp(e)<1};zr.logarithm=zr.log=function(e){var t,r=this,n=r.constructor,s=n.precision,a=s+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Kl))throw Error(zc+"NaN");if(r.s<1)throw Error(zc+(r.s?"NaN":"-Infinity"));return r.eq(Kl)?new n(0):(Qs=!1,t=b0(C2(r,a),C2(e,a),a),Qs=!0,Ns(t,s))};zr.minus=zr.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?hJ(t,e):dJ(t,(e.s=-e.s,e))};zr.modulo=zr.mod=function(e){var t,r=this,n=r.constructor,s=n.precision;if(e=new n(e),!e.s)throw Error(zc+"NaN");return r.s?(Qs=!1,t=b0(r,e,0,1).times(e),Qs=!0,r.minus(t)):Ns(new n(r),s)};zr.naturalExponential=zr.exp=function(){return fJ(this)};zr.naturalLogarithm=zr.ln=function(){return C2(this)};zr.negated=zr.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};zr.plus=zr.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?dJ(t,e):hJ(t,(e.s=-e.s,e))};zr.precision=zr.sd=function(e){var t,r,n,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Bm+e);if(t=Qa(s)+1,n=s.d.length-1,r=n*$s+1,n=s.d[n],n){for(;n%10==0;n/=10)r--;for(n=s.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};zr.squareRoot=zr.sqrt=function(){var e,t,r,n,s,a,i,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(zc+"NaN")}for(e=Qa(o),Qs=!1,s=Math.sqrt(+o),s==0||s==1/0?(t=od(o.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=rx((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(s.toString()),r=c.precision,s=i=r+3;;)if(a=n,n=a.plus(b0(o,a,i+2)).times(.5),od(a.d).slice(0,i)===(t=od(n.d)).slice(0,i)){if(t=t.slice(i-3,i+1),s==i&&t=="4999"){if(Ns(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;i+=4}return Qs=!0,Ns(n,r)};zr.times=zr.mul=function(e){var t,r,n,s,a,i,o,c,u,d=this,f=d.constructor,h=d.d,g=(e=new f(e)).d;if(!d.s||!e.s)return new f(0);for(e.s*=d.s,r=d.e+e.e,c=h.length,u=g.length,c<u&&(a=h,h=g,g=a,i=c,c=u,u=i),a=[],i=c+u,n=i;n--;)a.push(0);for(n=u;--n>=0;){for(t=0,s=c+n;s>n;)o=a[s]+g[n]*h[s-n-1]+t,a[s--]=o%Ei|0,t=o/Ei|0;a[s]=(a[s]+t)%Ei|0}for(;!a[--i];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,Qs?Ns(e,f.precision):e};zr.toDecimalPlaces=zr.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(pd(e,0,tx),t===void 0?t=n.rounding:pd(t,0,8),Ns(r,e+Qa(r)+1,t))};zr.toExponential=function(e,t){var r,n=this,s=n.constructor;return e===void 0?r=og(n,!0):(pd(e,0,tx),t===void 0?t=s.rounding:pd(t,0,8),n=Ns(new s(n),e+1,t),r=og(n,!0,e+1)),r};zr.toFixed=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?og(s):(pd(e,0,tx),t===void 0?t=a.rounding:pd(t,0,8),n=Ns(new a(s),e+Qa(s)+1,t),r=og(n.abs(),!1,e+Qa(n)+1),s.isneg()&&!s.isZero()?"-"+r:r)};zr.toInteger=zr.toint=function(){var e=this,t=e.constructor;return Ns(new t(e),Qa(e)+1,t.rounding)};zr.toNumber=function(){return+this};zr.toPower=zr.pow=function(e){var t,r,n,s,a,i,o=this,c=o.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(Kl);if(o=new c(o),!o.s){if(e.s<1)throw Error(zc+"Infinity");return o}if(o.eq(Kl))return o;if(n=c.precision,e.eq(Kl))return Ns(o,n);if(t=e.e,r=e.d.length-1,i=t>=r,a=o.s,i){if((r=d<0?-d:d)<=uJ){for(s=new c(Kl),t=Math.ceil(n/$s+4),Qs=!1;r%2&&(s=s.times(o),jB(s.d,t)),r=rx(r/2),r!==0;)o=o.times(o),jB(o.d,t);return Qs=!0,e.s<0?new c(Kl).div(s):Ns(s,n)}}else if(a<0)throw Error(zc+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Qs=!1,s=e.times(C2(o,n+u)),Qs=!0,s=fJ(s),s.s=a,s};zr.toPrecision=function(e,t){var r,n,s=this,a=s.constructor;return e===void 0?(r=Qa(s),n=og(s,r<=a.toExpNeg||r>=a.toExpPos)):(pd(e,1,tx),t===void 0?t=a.rounding:pd(t,0,8),s=Ns(new a(s),e,t),r=Qa(s),n=og(s,e<=r||r<=a.toExpNeg,e)),n};zr.toSignificantDigits=zr.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(pd(e,1,tx),t===void 0?t=n.rounding:pd(t,0,8)),Ns(new n(r),e,t)};zr.toString=zr.valueOf=zr.val=zr.toJSON=zr[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Qa(e),r=e.constructor;return og(e,t<=r.toExpNeg||t>=r.toExpPos)};function dJ(e,t){var r,n,s,a,i,o,c,u,d=e.constructor,f=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Qs?Ns(t,f):t;if(c=e.d,u=t.d,i=e.e,s=t.e,c=c.slice(),a=i-s,a){for(a<0?(n=c,a=-a,o=u.length):(n=u,s=i,o=c.length),i=Math.ceil(f/$s),o=i>o?i+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=c.length,a=u.length,o-a<0&&(a=o,n=u,u=c,c=n),r=0;a;)r=(c[--a]=c[a]+u[a]+r)/Ei|0,c[a]%=Ei;for(r&&(c.unshift(r),++s),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=s,Qs?Ns(t,f):t}function pd(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Bm+e)}function od(e){var t,r,n,s=e.length-1,a="",i=e[0];if(s>0){for(a+=i,t=1;t<s;t++)n=e[t]+"",r=$s-n.length,r&&(a+=Lf(r)),a+=n;i=e[t],n=i+"",r=$s-n.length,r&&(a+=Lf(r))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var b0=(function(){function e(n,s){var a,i=0,o=n.length;for(n=n.slice();o--;)a=n[o]*s+i,n[o]=a%Ei|0,i=a/Ei|0;return i&&n.unshift(i),n}function t(n,s,a,i){var o,c;if(a!=i)c=a>i?1:-1;else for(o=c=0;o<a;o++)if(n[o]!=s[o]){c=n[o]>s[o]?1:-1;break}return c}function r(n,s,a){for(var i=0;a--;)n[a]-=i,i=n[a]<s[a]?1:0,n[a]=i*Ei+n[a]-s[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,s,a,i){var o,c,u,d,f,h,g,p,x,v,C,b,_,T,N,E,F,j,P=n.constructor,M=n.s==s.s?1:-1,I=n.d,U=s.d;if(!n.s)return new P(n);if(!s.s)throw Error(zc+"Division by zero");for(c=n.e-s.e,F=U.length,N=I.length,g=new P(M),p=g.d=[],u=0;U[u]==(I[u]||0);)++u;if(U[u]>(I[u]||0)&&--c,a==null?b=a=P.precision:i?b=a+(Qa(n)-Qa(s))+1:b=a,b<0)return new P(0);if(b=b/$s+2|0,u=0,F==1)for(d=0,U=U[0],b++;(u<N||d)&&b--;u++)_=d*Ei+(I[u]||0),p[u]=_/U|0,d=_%U|0;else{for(d=Ei/(U[0]+1)|0,d>1&&(U=e(U,d),I=e(I,d),F=U.length,N=I.length),T=F,x=I.slice(0,F),v=x.length;v<F;)x[v++]=0;j=U.slice(),j.unshift(0),E=U[0],U[1]>=Ei/2&&++E;do d=0,o=t(U,x,F,v),o<0?(C=x[0],F!=v&&(C=C*Ei+(x[1]||0)),d=C/E|0,d>1?(d>=Ei&&(d=Ei-1),f=e(U,d),h=f.length,v=x.length,o=t(f,x,h,v),o==1&&(d--,r(f,F<h?j:U,h))):(d==0&&(o=d=1),f=U.slice()),h=f.length,h<v&&f.unshift(0),r(x,f,v),o==-1&&(v=x.length,o=t(U,x,F,v),o<1&&(d++,r(x,F<v?j:U,v))),v=x.length):o===0&&(d++,x=[0]),p[u++]=d,o&&x[0]?x[v++]=I[T]||0:(x=[I[T]],v=1);while((T++<N||x[0]!==void 0)&&b--)}return p[0]||p.shift(),g.e=c,Ns(g,i?a+Qa(g)+1:a)}})();function fJ(e,t){var r,n,s,a,i,o,c=0,u=0,d=e.constructor,f=d.precision;if(Qa(e)>16)throw Error(JA+Qa(e));if(!e.s)return new d(Kl);for(Qs=!1,o=f,i=new d(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(n=Math.log(gm(2,u))/Math.LN10*2+5|0,o+=n,r=s=a=new d(Kl),d.precision=o;;){if(s=Ns(s.times(e),o),r=r.times(++c),i=a.plus(b0(s,r,o)),od(i.d).slice(0,o)===od(a.d).slice(0,o)){for(;u--;)a=Ns(a.times(a),o);return d.precision=f,t==null?(Qs=!0,Ns(a,f)):a}a=i}}function Qa(e){for(var t=e.e*$s,r=e.d[0];r>=10;r/=10)t++;return t}function nC(e,t,r){if(t>e.LN10.sd())throw Qs=!0,r&&(e.precision=r),Error(zc+"LN10 precision limit exceeded");return Ns(new e(e.LN10),t)}function Lf(e){for(var t="";e--;)t+="0";return t}function C2(e,t){var r,n,s,a,i,o,c,u,d,f=1,h=10,g=e,p=g.d,x=g.constructor,v=x.precision;if(g.s<1)throw Error(zc+(g.s?"NaN":"-Infinity"));if(g.eq(Kl))return new x(0);if(t==null?(Qs=!1,u=v):u=t,g.eq(10))return t==null&&(Qs=!0),nC(x,u);if(u+=h,x.precision=u,r=od(p),n=r.charAt(0),a=Qa(g),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)g=g.times(e),r=od(g.d),n=r.charAt(0),f++;a=Qa(g),n>1?(g=new x("0."+r),a++):g=new x(n+"."+r.slice(1))}else return c=nC(x,u+2,v).times(a+""),g=C2(new x(n+"."+r.slice(1)),u-h).plus(c),x.precision=v,t==null?(Qs=!0,Ns(g,v)):g;for(o=i=g=b0(g.minus(Kl),g.plus(Kl),u),d=Ns(g.times(g),u),s=3;;){if(i=Ns(i.times(d),u),c=o.plus(b0(i,new x(s),u)),od(c.d).slice(0,u)===od(o.d).slice(0,u))return o=o.times(2),a!==0&&(o=o.plus(nC(x,u+2,v).times(a+""))),o=b0(o,new x(f),u),x.precision=v,t==null?(Qs=!0,Ns(o,v)):o;o=c,s+=2}}function AB(e,t){var r,n,s;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(n,s),t){if(s-=n,r=r-n-1,e.e=rx(r/$s),e.d=[],n=(r+1)%$s,r<0&&(n+=$s),n<s){for(n&&e.d.push(+t.slice(0,n)),s-=$s;n<s;)e.d.push(+t.slice(n,n+=$s));t=t.slice(n),n=$s-t.length}else n-=s;for(;n--;)t+="0";if(e.d.push(+t),Qs&&(e.e>lS||e.e<-lS))throw Error(JA+r)}else e.s=0,e.e=0,e.d=[0];return e}function Ns(e,t,r){var n,s,a,i,o,c,u,d,f=e.d;for(i=1,a=f[0];a>=10;a/=10)i++;if(n=t-i,n<0)n+=$s,s=t,u=f[d=0];else{if(d=Math.ceil((n+1)/$s),a=f.length,d>=a)return e;for(u=a=f[d],i=1;a>=10;a/=10)i++;n%=$s,s=n-$s+i}if(r!==void 0&&(a=gm(10,i-s-1),o=u/a%10|0,c=t<0||f[d+1]!==void 0||u%a,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?s>0?u/gm(10,i-s):0:f[d-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return c?(a=Qa(e),f.length=1,t=t-a-1,f[0]=gm(10,($s-t%$s)%$s),e.e=rx(-t/$s)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(n==0?(f.length=d,a=1,d--):(f.length=d+1,a=gm(10,$s-n),f[d]=s>0?(u/gm(10,i-s)%gm(10,s)|0)*a:0),c)for(;;)if(d==0){(f[0]+=a)==Ei&&(f[0]=1,++e.e);break}else{if(f[d]+=a,f[d]!=Ei)break;f[d--]=0,a=1}for(n=f.length;f[--n]===0;)f.pop();if(Qs&&(e.e>lS||e.e<-lS))throw Error(JA+Qa(e));return e}function hJ(e,t){var r,n,s,a,i,o,c,u,d,f,h=e.constructor,g=h.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new h(e),Qs?Ns(t,g):t;if(c=e.d,f=t.d,n=t.e,u=e.e,c=c.slice(),i=u-n,i){for(d=i<0,d?(r=c,i=-i,o=f.length):(r=f,n=u,o=c.length),s=Math.max(Math.ceil(g/$s),o)+2,i>s&&(i=s,r.length=1),r.reverse(),s=i;s--;)r.push(0);r.reverse()}else{for(s=c.length,o=f.length,d=s<o,d&&(o=s),s=0;s<o;s++)if(c[s]!=f[s]){d=c[s]<f[s];break}i=0}for(d&&(r=c,c=f,f=r,t.s=-t.s),o=c.length,s=f.length-o;s>0;--s)c[o++]=0;for(s=f.length;s>i;){if(c[--s]<f[s]){for(a=s;a&&c[--a]===0;)c[a]=Ei-1;--c[a],c[s]+=Ei}c[s]-=f[s]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Qs?Ns(t,g):t):new h(0)}function og(e,t,r){var n,s=Qa(e),a=od(e.d),i=a.length;return t?(r&&(n=r-i)>0?a=a.charAt(0)+"."+a.slice(1)+Lf(n):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(s<0?"e":"e+")+s):s<0?(a="0."+Lf(-s-1)+a,r&&(n=r-i)>0&&(a+=Lf(n))):s>=i?(a+=Lf(s+1-i),r&&(n=r-s-1)>0&&(a=a+"."+Lf(n))):((n=s+1)<i&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-i)>0&&(s+1===i&&(a+="."),a+=Lf(n))),e.s<0?"-"+a:a}function jB(e,t){if(e.length>t)return e.length=t,!0}function mJ(e){var t,r,n;function s(a){var i=this;if(!(i instanceof s))return new s(a);if(i.constructor=s,a instanceof s){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Bm+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return AB(i,a.toString())}else if(typeof a!="string")throw Error(Bm+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,eNe.test(a))AB(i,a);else throw Error(Bm+a)}if(s.prototype=zr,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=mJ,s.config=s.set=tNe,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return s.config(e),s}function tNe(e){if(!e||typeof e!="object")throw Error(zc+"Object expected");var t,r,n,s=["precision",1,tx,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((n=e[r=s[t]])!==void 0)if(rx(n)===n&&n>=s[t+1]&&n<=s[t+2])this[r]=n;else throw Error(Bm+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Bm+r+": "+n);return this}var QA=mJ(Z7e);Kl=new QA(1);const fs=QA;var rNe=e=>e,gJ={},pJ=e=>e===gJ,PB=e=>function t(){return arguments.length===0||arguments.length===1&&pJ(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},xJ=(e,t)=>e===1?t:PB(function(){for(var r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];var a=n.filter(i=>i!==gJ).length;return a>=e?t(...n):xJ(e-a,PB(function(){for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];var u=n.map(d=>pJ(d)?o.shift():d);return t(...u,...o)}))}),N3=e=>xJ(e.length,e),Y8=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},nNe=N3((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),sNe=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return rNe;var s=r.reverse(),a=s[0],i=s.slice(1);return function(){return i.reduce((o,c)=>c(o),a(...arguments))}},X8=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),yJ=e=>{var t=null,r=null;return function(){for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return t&&s.every((i,o)=>{var c;return i===((c=t)===null||c===void 0?void 0:c[o])})||(t=s,r=e(...s)),r}};function vJ(e){var t;return e===0?t=1:t=Math.floor(new fs(e).abs().log(10).toNumber())+1,t}function bJ(e,t,r){for(var n=new fs(e),s=0,a=[];n.lt(t)&&s<1e5;)a.push(n.toNumber()),n=n.add(r),s++;return a}N3((e,t,r)=>{var n=+e,s=+t;return n+r*(s-n)});N3((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});N3((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var wJ=e=>{var[t,r]=e,[n,s]=[t,r];return t>r&&([n,s]=[r,t]),[n,s]},_J=(e,t,r)=>{if(e.lte(0))return new fs(0);var n=vJ(e.toNumber()),s=new fs(10).pow(n),a=e.div(s),i=n!==1?.05:.1,o=new fs(Math.ceil(a.div(i).toNumber())).add(r).mul(i),c=o.mul(s);return t?new fs(c.toNumber()):new fs(Math.ceil(c.toNumber()))},aNe=(e,t,r)=>{var n=new fs(1),s=new fs(e);if(!s.isint()&&r){var a=Math.abs(e);a<1?(n=new fs(10).pow(vJ(e)-1),s=new fs(Math.floor(s.div(n).toNumber())).mul(n)):a>1&&(s=new fs(Math.floor(e)))}else e===0?s=new fs(Math.floor((t-1)/2)):r||(s=new fs(Math.floor(e)));var i=Math.floor((t-1)/2),o=sNe(nNe(c=>s.add(new fs(c-i).mul(n)).toNumber()),Y8);return o(0,t)},SJ=function(t,r,n,s){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new fs(0),tickMin:new fs(0),tickMax:new fs(0)};var i=_J(new fs(r).sub(t).div(n-1),s,a),o;t<=0&&r>=0?o=new fs(0):(o=new fs(t).add(r).div(2),o=o.sub(new fs(o).mod(i)));var c=Math.ceil(o.sub(t).div(i).toNumber()),u=Math.ceil(new fs(r).sub(o).div(i).toNumber()),d=c+u+1;return d>n?SJ(t,r,n,s,a+1):(d<n&&(u=r>0?u+(n-d):u,c=r>0?c:c+(n-d)),{step:i,tickMin:o.sub(new fs(c).mul(i)),tickMax:o.add(new fs(u).mul(i))})};function iNe(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[i,o]=wJ([t,r]);if(i===-1/0||o===1/0){var c=o===1/0?[i,...Y8(0,n-1).map(()=>1/0)]:[...Y8(0,n-1).map(()=>-1/0),o];return t>r?X8(c):c}if(i===o)return aNe(i,n,s);var{step:u,tickMin:d,tickMax:f}=SJ(i,o,a,s,0),h=bJ(d,f.add(new fs(.1).mul(u)),u);return t>r?X8(h):h}function oNe(e,t){var[r,n]=e,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=wJ([r,n]);if(a===-1/0||i===1/0)return[r,n];if(a===i)return[a];var o=Math.max(t,2),c=_J(new fs(i).sub(a).div(o-1),s,0),u=[...bJ(new fs(a),new fs(i),c),i];return s===!1&&(u=u.map(d=>Math.round(d))),r>n?X8(u):u}var lNe=yJ(iNe),cNe=yJ(oNe),uNe=e=>e.rootProps.barCategoryGap,E3=e=>e.rootProps.stackOffset,ZA=e=>e.options.chartName,ej=e=>e.rootProps.syncId,kJ=e=>e.rootProps.syncMethod,tj=e=>e.options.eventEmitter,o0={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},$l={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},A3=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},dNe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:o0.angleAxisId,includeHidden:!1,name:void 0,reversed:o0.reversed,scale:o0.scale,tick:o0.tick,tickCount:void 0,ticks:void 0,type:o0.type,unit:void 0},fNe={allowDataOverflow:$l.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:$l.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$l.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$l.scale,tick:$l.tick,tickCount:$l.tickCount,ticks:void 0,type:$l.type,unit:void 0},hNe={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:o0.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:o0.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:o0.scale,tick:o0.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},mNe={allowDataOverflow:$l.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:$l.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$l.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$l.scale,tick:$l.tick,tickCount:$l.tickCount,ticks:void 0,type:"category",unit:void 0},rj=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?hNe:dNe,nj=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?mNe:fNe,j3=e=>e.polarOptions,sj=Gt([$0,U0,lo],wke),CJ=Gt([j3,sj],(e,t)=>{if(e!=null)return mh(e.innerRadius,t,0)}),TJ=Gt([j3,sj],(e,t)=>{if(e!=null)return mh(e.outerRadius,t,t*.8)}),gNe=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},NJ=Gt([j3],gNe);Gt([rj,NJ],A3);var EJ=Gt([sj,CJ,TJ],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Gt([nj,EJ],A3);var AJ=Gt([qs,j3,CJ,TJ,$0,U0],(e,t,r,n,s,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:i,cy:o,startAngle:c,endAngle:u}=t;return{cx:mh(i,s,s/2),cy:mh(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),ti=(e,t)=>t,P3=(e,t,r)=>r;function jJ(e){return e?.id}var xi=e=>{var t=qs(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},nx=e=>e.tooltip.settings.axisId,Ii=e=>{var t=xi(e),r=nx(e);return mb(e,t,r)},PJ=Gt([Ii],e=>e?.dataKey);function FJ(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:s,dataKey:a}=r,i=new Map;return e.forEach(o=>{var c,u=(c=o.data)!==null&&c!==void 0?c:n;if(!(u==null||u.length===0)){var d=jJ(o);u.forEach((f,h)=>{var g=a==null||s?h:String(el(f,a,null)),p=el(f,o.dataKey,0),x;i.has(g)?x=i.get(g):x={},Object.assign(x,{[d]:p}),i.set(g,x)})}}),Array.from(i.values())}function aj(e){return e.stackId!=null&&e.dataKey!=null}function FB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function cS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?FB(Object(r),!0).forEach(function(n){pNe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):FB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pNe(e,t,r){return(t=xNe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xNe(e){var t=yNe(e,"string");return typeof t=="symbol"?t:t+""}function yNe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var J8=[0,"auto"],Ll={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},MJ=(e,t)=>e.cartesianAxis.xAxis[t],W0=(e,t)=>{var r=MJ(e,t);return r??Ll},Bl={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:J8,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:cb},RJ=(e,t)=>e.cartesianAxis.yAxis[t],H0=(e,t)=>{var r=RJ(e,t);return r??Bl},vNe={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ij=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??vNe},El=(e,t,r)=>{switch(t){case"xAxis":return W0(e,r);case"yAxis":return H0(e,r);case"zAxis":return ij(e,r);case"angleAxis":return rj(e,r);case"radiusAxis":return nj(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},bNe=(e,t,r)=>{switch(t){case"xAxis":return W0(e,r);case"yAxis":return H0(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},mb=(e,t,r)=>{switch(t){case"xAxis":return W0(e,r);case"yAxis":return H0(e,r);case"angleAxis":return rj(e,r);case"radiusAxis":return nj(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},OJ=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function DJ(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var IJ=e=>e.graphicalItems.cartesianItems,wNe=Gt([ti,P3],DJ),LJ=(e,t,r)=>e.filter(r).filter(n=>t?.includeHidden===!0?!0:!n.hide),gb=Gt([IJ,El,wNe],LJ),BJ=Gt([gb],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(aj)),$J=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),UJ=Gt([gb],$J),zJ=e=>e.map(t=>t.data).filter(Boolean).flat(1),_Ne=Gt([gb],zJ),WJ=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:s}=t;return e.length>0?e:r.slice(n,s+1)},oj=Gt([_Ne,XA],WJ),HJ=(e,t,r)=>t?.dataKey!=null?e.map(n=>({value:el(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(s=>({value:el(s,n)}))):e.map(n=>({value:n})),F3=Gt([oj,El,gb],HJ);function GJ(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Tg(e){return e.filter(t=>gd(t)||t instanceof Date).map(Number).filter(t=>$c(t)===!1)}function SNe(e,t,r){return!r||typeof t!="number"||$c(t)?[]:r.length?Tg(r.flatMap(n=>{var s=el(e,n.dataKey),a,i;if(Array.isArray(s)?[a,i]=s:a=i=s,!(!Su(a)||!Su(i)))return[t-a,t+i]})):[]}var kNe=Gt([BJ,XA,Ii],FJ),VJ=(e,t,r)=>{var n={},s=t.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),n);return Object.fromEntries(Object.entries(s).map(a=>{var[i,o]=a,c=o.map(jJ);return[i,{stackedData:Dke(e,c,r),graphicalItems:o}]}))},CNe=Gt([kNe,BJ,E3],VJ),qJ=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:s}=t;if(r!=="zAxis"){var a=Bke(e,n,s);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},TNe=Gt([CNe,Ah,ti],qJ),KJ=(e,t,r,n,s)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var o,c,u=(o=n[i.id])===null||o===void 0?void 0:o.filter(f=>GJ(s,f)),d=el(a,(c=t.dataKey)!==null&&c!==void 0?c:i.dataKey);return{value:d,errorDomain:SNe(a,d,u)}})).filter(Boolean):t?.dataKey!=null?e.map(a=>({value:el(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),M3=e=>e.errorBars,YJ=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>GJ(r,n));Gt([UJ,M3,ti],YJ);var NNe=Gt([oj,El,UJ,M3,ti],KJ);function ENe(e){var{value:t}=e;if(gd(t)||t instanceof Date)return t}var MB=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Tg(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ANe=(e,t,r)=>{var n=e.map(ENe).filter(s=>s!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&cY(n))?AX(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},lj=e=>{var t;if(e==null||!("domain"in e))return J8;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Tg(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e?.domain)!==null&&t!==void 0?t:J8},uS=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var s=r.filter(Boolean);if(s.length!==0){var a=s.flat(),i=Math.min(...a),o=Math.max(...a);return[i,o]}},XJ=e=>e.referenceElements.dots,sx=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),jNe=Gt([XJ,ti,P3],sx),JJ=e=>e.referenceElements.areas,PNe=Gt([JJ,ti,P3],sx),QJ=e=>e.referenceElements.lines,FNe=Gt([QJ,ti,P3],sx),ZJ=(e,t)=>{var r=Tg(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},MNe=Gt(jNe,ti,ZJ),eQ=(e,t)=>{var r=Tg(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},RNe=Gt([PNe,ti],eQ),tQ=(e,t)=>{var r=Tg(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ONe=Gt(FNe,ti,tQ),DNe=Gt(MNe,ONe,RNe,(e,t,r)=>uS(e,r,t)),INe=Gt([El],lj),rQ=(e,t,r,n,s,a,i)=>{var o=J7e(t,e.allowDataOverflow);if(o!=null)return o;var c=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",u=c?uS(r,s,MB(n)):uS(s,MB(n));return Q7e(t,u,e.allowDataOverflow)},LNe=Gt([El,INe,TNe,NNe,DNe,qs,ti],rQ),BNe=[0,1],nQ=(e,t,r,n,s,a,i)=>{if(!((e==null||r==null||r.length===0)&&i===void 0)){var{dataKey:o,type:c}=e,u=Th(t,a);return u&&o==null?AX(0,r.length):c==="category"?ANe(n,e,u):s==="expand"?BNe:i}},cj=Gt([El,qs,oj,F3,E3,ti,LNe],nQ),sQ=(e,t,r,n,s)=>{if(e!=null){var{scale:a,type:i}=e;if(a==="auto")return t==="radial"&&s==="radiusAxis"?"band":t==="radial"&&s==="angleAxis"?"linear":i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(hA(a));return o in mv?o:"point"}}},pb=Gt([El,qs,OJ,ZA,ti],sQ);function $Ne(e){if(e!=null){if(e in mv)return mv[e]();var t="scale".concat(hA(e));if(t in mv)return mv[t]()}}function uj(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var s=$Ne(t);if(s!=null){var a=s.domain(r).range(n);return Fke(a),a}}}var aQ=(e,t,r)=>{var n=lj(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&C1(e))return lNe(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&C1(e))return cNe(e,t.tickCount,t.allowDecimals)}},dj=Gt([cj,mb,pb],aQ),iQ=(e,t,r,n)=>{if(n!=="angleAxis"&&e?.type==="number"&&C1(t)&&Array.isArray(r)&&r.length>0){var s=t[0],a=r[0],i=t[1],o=r[r.length-1];return[Math.min(s,a),Math.max(i,o)]}return t},UNe=Gt([El,cj,dj,ti],iQ),zNe=Gt(F3,El,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Tg(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var s=n[n.length-1]-n[0];if(s===0)return 1/0;for(var a=0;a<n.length-1;a++){var i=n[a+1]-n[a];r=Math.min(r,i)}return r/s}}),oQ=Gt(zNe,qs,uNe,lo,(e,t,r,n)=>n,(e,t,r,n,s)=>{if(!Su(e))return 0;var a=t==="vertical"?n.height:n.width;if(s==="gap")return e*a/2;if(s==="no-gap"){var i=mh(r,e*a),o=e*a/2;return o-i-(o-i)/a*i}return 0}),WNe=(e,t)=>{var r=W0(e,t);return r==null||typeof r.padding!="string"?0:oQ(e,"xAxis",t,r.padding)},HNe=(e,t)=>{var r=H0(e,t);return r==null||typeof r.padding!="string"?0:oQ(e,"yAxis",t,r.padding)},GNe=Gt(W0,WNe,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:s}=e;return typeof s=="string"?{left:t,right:t}:{left:((r=s.left)!==null&&r!==void 0?r:0)+t,right:((n=s.right)!==null&&n!==void 0?n:0)+t}}),VNe=Gt(H0,HNe,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:s}=e;return typeof s=="string"?{top:t,bottom:t}:{top:((r=s.top)!==null&&r!==void 0?r:0)+t,bottom:((n=s.bottom)!==null&&n!==void 0?n:0)+t}}),qNe=Gt([lo,GNe,b3,v3,(e,t,r)=>r],(e,t,r,n,s)=>{var{padding:a}=n;return s?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),KNe=Gt([lo,qs,VNe,b3,v3,(e,t,r)=>r],(e,t,r,n,s,a)=>{var{padding:i}=s;return a?[n.height-i.bottom,i.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),xb=(e,t,r,n)=>{var s;switch(t){case"xAxis":return qNe(e,r,n);case"yAxis":return KNe(e,r,n);case"zAxis":return(s=ij(e,r))===null||s===void 0?void 0:s.range;case"angleAxis":return NJ(e);case"radiusAxis":return EJ(e,r);default:return}},lQ=Gt([El,xb],A3),ax=Gt([El,pb,UNe,lQ],uj);Gt([gb,M3,ti],YJ);function cQ(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var R3=(e,t)=>t,O3=(e,t,r)=>r,YNe=Gt(x3,R3,O3,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(cQ)),XNe=Gt(y3,R3,O3,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(cQ)),uQ=(e,t)=>({width:e.width,height:t.height}),JNe=(e,t)=>{var r=typeof t.width=="number"?t.width:cb;return{width:r,height:e.height}},QNe=Gt(lo,W0,uQ),ZNe=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},eEe=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},tEe=Gt(U0,lo,YNe,R3,O3,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=uQ(t,o);i==null&&(i=ZNe(t,n,e));var u=n==="top"&&!s||n==="bottom"&&s;a[o.id]=i-Number(u)*c.height,i+=(u?-1:1)*c.height}),a}),rEe=Gt($0,lo,XNe,R3,O3,(e,t,r,n,s)=>{var a={},i;return r.forEach(o=>{var c=JNe(t,o);i==null&&(i=eEe(t,n,e));var u=n==="left"&&!s||n==="right"&&s;a[o.id]=i-Number(u)*c.width,i+=(u?-1:1)*c.width}),a}),nEe=(e,t)=>{var r=W0(e,t);if(r!=null)return tEe(e,r.orientation,r.mirror)},sEe=Gt([lo,W0,nEe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:e.left,y:0}:{x:e.left,y:s}}}),aEe=(e,t)=>{var r=H0(e,t);if(r!=null)return rEe(e,r.orientation,r.mirror)},iEe=Gt([lo,H0,aEe,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var s=r?.[n];return s==null?{x:0,y:e.top}:{x:s,y:e.top}}}),oEe=Gt(lo,H0,(e,t)=>{var r=typeof t.width=="number"?t.width:cb;return{width:r,height:e.height}}),dQ=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:s,type:a,dataKey:i}=r,o=Th(e,n),c=t.map(u=>u.value);if(i&&o&&a==="category"&&s&&cY(c))return c}},fj=Gt([qs,F3,El,ti],dQ),fQ=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:s,scale:a}=r,i=Th(e,n);if(i&&(s==="number"||a!=="auto"))return t.map(o=>o.value)}},hj=Gt([qs,F3,mb,ti],fQ),RB=Gt([qs,bNe,pb,ax,fj,hj,xb,dj,ti],(e,t,r,n,s,a,i,o,c)=>{if(t==null)return null;var u=Th(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:a,duplicateDomain:s,isCategorical:u,niceTicks:o,range:i,realScaleType:r,scale:n}}),lEe=(e,t,r,n,s,a,i,o,c)=>{if(!(t==null||n==null)){var u=Th(e,c),{type:d,ticks:f,tickCount:h}=t,g=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,p=d==="category"&&n.bandwidth?n.bandwidth()/g:0;p=c==="angleAxis"&&a!=null&&a.length>=2?Pc(a[0]-a[1])*2*p:p;var x=f||s;if(x){var v=x.map((C,b)=>{var _=i?i.indexOf(C):C;return{index:b,coordinate:n(_)+p,value:C,offset:p}});return v.filter(C=>!$c(C.coordinate))}return u&&o?o.map((C,b)=>({coordinate:n(C)+p,value:C,index:b,offset:p})):n.ticks?n.ticks(h).map(C=>({coordinate:n(C)+p,value:C,offset:p})):n.domain().map((C,b)=>({coordinate:n(C)+p,value:i?i[C]:C,index:b,offset:p}))}},hQ=Gt([qs,mb,pb,ax,dj,xb,fj,hj,ti],lEe),cEe=(e,t,r,n,s,a,i)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Th(e,i),{tickCount:c}=t,u=0;return u=i==="angleAxis"&&n?.length>=2?Pc(n[0]-n[1])*2*u:u,o&&a?a.map((d,f)=>({coordinate:r(d)+u,value:d,index:f,offset:u})):r.ticks?r.ticks(c).map(d=>({coordinate:r(d)+u,value:d,offset:u})):r.domain().map((d,f)=>({coordinate:r(d)+u,value:s?s[d]:d,index:f,offset:u}))}},mQ=Gt([qs,mb,ax,xb,fj,hj,ti],cEe),gQ=Gt(El,ax,(e,t)=>{if(!(e==null||t==null))return cS(cS({},e),{},{scale:t})}),uEe=Gt([El,pb,cj,lQ],uj);Gt((e,t,r)=>ij(e,r),uEe,(e,t)=>{if(!(e==null||t==null))return cS(cS({},e),{},{scale:t})});var dEe=Gt([qs,x3,y3],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),pQ=e=>e.options.defaultTooltipEventType,xQ=e=>e.options.validateTooltipEventTypes;function yQ(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function mj(e,t){var r=pQ(e),n=xQ(e);return yQ(t,r,n)}function fEe(e){return an(t=>mj(t,e))}var vQ=(e,t)=>{var r,n=Number(t);if(!($c(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},hEe=e=>e.tooltip.settings,$f={active:!1,index:null,dataKey:void 0,coordinate:void 0},mEe={itemInteraction:{click:$f,hover:$f},axisInteraction:{click:$f,hover:$f},keyboardInteraction:$f,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},bQ=nc({name:"tooltip",initialState:mEe,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=v0(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:gEe,removeTooltipEntrySettings:pEe,setTooltipSettingsState:xEe,setActiveMouseOverItemIndex:yEe,mouseLeaveItem:xDe,mouseLeaveChart:wQ,setActiveClickItemIndex:yDe,setMouseOverAxisIndex:_Q,setMouseClickAxisIndex:vEe,setSyncInteraction:Q8,setKeyboardInteraction:Z8}=bQ.actions,bEe=bQ.reducer;function OB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function v4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?OB(Object(r),!0).forEach(function(n){wEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):OB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wEe(e,t,r){return(t=_Ee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _Ee(e){var t=SEe(e,"string");return typeof t=="symbol"?t:t+""}function SEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kEe(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function CEe(e){return e.index!=null}var SQ=(e,t,r,n)=>{if(t==null)return $f;var s=kEe(e,t,r);if(s==null)return $f;if(s.active)return s;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(CEe(s)){if(a)return v4(v4({},s),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return v4(v4({},$f),{},{coordinate:s.coordinate})},gj=(e,t)=>{var r=e?.index;if(r==null)return null;var n=Number(r);if(!Su(n))return r;var s=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(s,Math.min(n,a)))},kQ=(e,t,r,n,s,a,i,o)=>{if(!(a==null||o==null)){var c=i[0],u=c==null?void 0:o(c.positions,a);if(u!=null)return u;var d=s?.[Number(a)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},CQ=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var s;return r==="hover"?s=e.itemInteraction.hover.dataKey:s=e.itemInteraction.click.dataKey,s==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===s})},yb=e=>e.options.tooltipPayloadSearcher,ix=e=>e.tooltip;function DB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function IB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?DB(Object(r),!0).forEach(function(n){TEe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):DB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TEe(e,t,r){return(t=NEe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NEe(e){var t=EEe(e,"string");return typeof t=="symbol"?t:t+""}function EEe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function AEe(e,t){return e??t}var TQ=(e,t,r,n,s,a,i)=>{if(!(t==null||a==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:d}=r,f=[];return e.reduce((h,g)=>{var p,{dataDefinedOnItem:x,settings:v}=g,C=AEe(x,o),b=Array.isArray(C)?uX(C,u,d):C,_=(p=v?.dataKey)!==null&&p!==void 0?p:n,T=v?.nameKey,N;if(n&&Array.isArray(b)&&!Array.isArray(b[0])&&i==="axis"?N=uY(b,n,s):N=a(b,t,c,T),Array.isArray(N))N.forEach(F=>{var j=IB(IB({},v),{},{name:F.name,unit:F.unit,color:void 0,fill:void 0});h.push(_L({tooltipEntrySettings:j,dataKey:F.dataKey,payload:F.payload,value:el(F.payload,F.dataKey),name:F.name}))});else{var E;h.push(_L({tooltipEntrySettings:v,dataKey:_,payload:N,value:el(N,_),name:(E=el(N,T))!==null&&E!==void 0?E:v?.name}))}return h},f)}},pj=Gt([Ii,qs,OJ,ZA,xi],sQ),jEe=Gt([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),PEe=Gt([xi,nx],DJ),vb=Gt([jEe,Ii,PEe],LJ),FEe=Gt([vb],e=>e.filter(aj)),MEe=Gt([vb],zJ),ox=Gt([MEe,Ah],WJ),REe=Gt([FEe,Ah,Ii],FJ),xj=Gt([ox,Ii,vb],HJ),OEe=Gt([Ii],lj),DEe=Gt([vb],e=>e.filter(aj)),IEe=Gt([REe,DEe,E3],VJ),LEe=Gt([IEe,Ah,xi],qJ),BEe=Gt([vb],$J),$Ee=Gt([ox,Ii,BEe,M3,xi],KJ),UEe=Gt([XJ,xi,nx],sx),zEe=Gt([UEe,xi],ZJ),WEe=Gt([JJ,xi,nx],sx),HEe=Gt([WEe,xi],eQ),GEe=Gt([QJ,xi,nx],sx),VEe=Gt([GEe,xi],tQ),qEe=Gt([zEe,VEe,HEe],uS),KEe=Gt([Ii,OEe,LEe,$Ee,qEe,qs,xi],rQ),NQ=Gt([Ii,qs,ox,xj,E3,xi,KEe],nQ),YEe=Gt([NQ,Ii,pj],aQ),XEe=Gt([Ii,NQ,YEe,xi],iQ),EQ=e=>{var t=xi(e),r=nx(e),n=!1;return xb(e,t,r,n)},AQ=Gt([Ii,EQ],A3),jQ=Gt([Ii,pj,XEe,AQ],uj),JEe=Gt([qs,xj,Ii,xi],dQ),QEe=Gt([qs,xj,Ii,xi],fQ),ZEe=(e,t,r,n,s,a,i,o)=>{if(t){var{type:c}=t,u=Th(e,o);if(n){var d=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,f=c==="category"&&n.bandwidth?n.bandwidth()/d:0;return f=o==="angleAxis"&&s!=null&&s?.length>=2?Pc(s[0]-s[1])*2*f:f,u&&i?i.map((h,g)=>({coordinate:n(h)+f,value:h,index:g,offset:f})):n.domain().map((h,g)=>({coordinate:n(h)+f,value:a?a[h]:h,index:g,offset:f}))}}},G0=Gt([qs,Ii,pj,jQ,EQ,JEe,QEe,xi],ZEe),yj=Gt([pQ,xQ,hEe],(e,t,r)=>yQ(r.shared,e,t)),PQ=e=>e.tooltip.settings.trigger,vj=e=>e.tooltip.settings.defaultIndex,D3=Gt([ix,yj,PQ,vj],SQ),T2=Gt([D3,ox],gj),FQ=Gt([G0,T2],vQ),eAe=Gt([D3],e=>{if(e)return e.dataKey}),MQ=Gt([ix,yj,PQ,vj],CQ),tAe=Gt([$0,U0,qs,lo,G0,vj,MQ,yb],kQ),rAe=Gt([D3,tAe],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),nAe=Gt([D3],e=>e.active),sAe=Gt([MQ,T2,Ah,PJ,FQ,yb,yj],TQ),aAe=Gt([sAe],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function LB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function BB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?LB(Object(r),!0).forEach(function(n){iAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):LB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iAe(e,t,r){return(t=oAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oAe(e){var t=lAe(e,"string");return typeof t=="symbol"?t:t+""}function lAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cAe=()=>an(Ii),uAe=()=>{var e=cAe(),t=an(G0),r=an(jQ);return O8(BB(BB({},e),{},{scale:r}),t)},dAe=()=>an(ZA),bj=(e,t)=>t,RQ=(e,t,r)=>r,wj=(e,t,r,n)=>n,fAe=Gt(G0,e=>d3(e,t=>t.coordinate)),_j=Gt([ix,bj,RQ,wj],SQ),OQ=Gt([_j,ox],gj),hAe=(e,t,r)=>{if(t!=null){var n=ix(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},DQ=Gt([ix,bj,RQ,wj],CQ),dS=Gt([$0,U0,qs,lo,G0,wj,DQ,yb],kQ),mAe=Gt([_j,dS],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),IQ=Gt(G0,OQ,vQ),gAe=Gt([DQ,OQ,Ah,PJ,IQ,yb,bj],TQ),pAe=Gt([_j],e=>({isActive:e.active,activeIndex:e.index})),xAe=(e,t,r,n,s,a,i,o)=>{if(!(!e||!t||!n||!s||!a)){var c=$ke(e.chartX,e.chartY,t,r,o);if(c){var u=zke(c,t),d=jke(u,i,a,n,s),f=Uke(t,a,d,c);return{activeIndex:String(d),activeCoordinate:f}}}};function e7(){return e7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},e7.apply(null,arguments)}function $B(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function b4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$B(Object(r),!0).forEach(function(n){yAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$B(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yAe(e,t,r){return(t=vAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vAe(e){var t=bAe(e,"string");return typeof t=="symbol"?t:t+""}function bAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wAe(e){var{coordinate:t,payload:r,index:n,offset:s,tooltipAxisBandSize:a,layout:i,cursor:o,tooltipEventType:c,chartName:u}=e,d=t,f=r,h=n;if(!o||!d||u!=="ScatterChart"&&c!=="axis")return null;var g,p;if(u==="ScatterChart")g=d,p=MCe;else if(u==="BarChart")g=RCe(i,d,s,a),p=dTe;else if(i==="radial"){var{cx:x,cy:v,radius:C,startAngle:b,endAngle:_}=NX(d);g={cx:x,cy:v,startAngle:b,endAngle:_,innerRadius:C,outerRadius:C},p=gTe}else g={points:pTe(i,d,s)},p=wX;var T=typeof o=="object"&&"className"in o?o.className:void 0,N=b4(b4(b4(b4({stroke:"#ccc",pointerEvents:"none"},s),g),oo(o,!1)),{},{payload:f,payloadIndex:h,className:Vs("recharts-tooltip-cursor",T)});return w.isValidElement(o)?w.cloneElement(o,N):w.createElement(p,N)}function _Ae(e){var t=uAe(),r=pX(),n=TA(),s=dAe();return w.createElement(wAe,e7({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:s}))}var LQ=w.createContext(null),SAe=()=>w.useContext(LQ),sC={exports:{}},UB;function kAe(){return UB||(UB=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function s(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function a(c,u,d,f,h){if(typeof d!="function")throw new TypeError("The listener must be a function");var g=new s(d,f||c,h),p=r?r+u:u;return c._events[p]?c._events[p].fn?c._events[p]=[c._events[p],g]:c._events[p].push(g):(c._events[p]=g,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],d,f;if(this._eventsCount===0)return u;for(f in d=this._events)t.call(d,f)&&u.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},o.prototype.listeners=function(u){var d=r?r+u:u,f=this._events[d];if(!f)return[];if(f.fn)return[f.fn];for(var h=0,g=f.length,p=new Array(g);h<g;h++)p[h]=f[h].fn;return p},o.prototype.listenerCount=function(u){var d=r?r+u:u,f=this._events[d];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,d,f,h,g,p){var x=r?r+u:u;if(!this._events[x])return!1;var v=this._events[x],C=arguments.length,b,_;if(v.fn){switch(v.once&&this.removeListener(u,v.fn,void 0,!0),C){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,d),!0;case 3:return v.fn.call(v.context,d,f),!0;case 4:return v.fn.call(v.context,d,f,h),!0;case 5:return v.fn.call(v.context,d,f,h,g),!0;case 6:return v.fn.call(v.context,d,f,h,g,p),!0}for(_=1,b=new Array(C-1);_<C;_++)b[_-1]=arguments[_];v.fn.apply(v.context,b)}else{var T=v.length,N;for(_=0;_<T;_++)switch(v[_].once&&this.removeListener(u,v[_].fn,void 0,!0),C){case 1:v[_].fn.call(v[_].context);break;case 2:v[_].fn.call(v[_].context,d);break;case 3:v[_].fn.call(v[_].context,d,f);break;case 4:v[_].fn.call(v[_].context,d,f,h);break;default:if(!b)for(N=1,b=new Array(C-1);N<C;N++)b[N-1]=arguments[N];v[_].fn.apply(v[_].context,b)}}return!0},o.prototype.on=function(u,d,f){return a(this,u,d,f,!1)},o.prototype.once=function(u,d,f){return a(this,u,d,f,!0)},o.prototype.removeListener=function(u,d,f,h){var g=r?r+u:u;if(!this._events[g])return this;if(!d)return i(this,g),this;var p=this._events[g];if(p.fn)p.fn===d&&(!h||p.once)&&(!f||p.context===f)&&i(this,g);else{for(var x=0,v=[],C=p.length;x<C;x++)(p[x].fn!==d||h&&!p[x].once||f&&p[x].context!==f)&&v.push(p[x]);v.length?this._events[g]=v.length===1?v[0]:v:i(this,g)}return this},o.prototype.removeAllListeners=function(u){var d;return u?(d=r?r+u:u,this._events[d]&&i(this,d)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(sC)),sC.exports}var CAe=kAe();const TAe=ec(CAe);var N2=new TAe,t7="recharts.syncEvent.tooltip",zB="recharts.syncEvent.brush";function NAe(e,t){if(t){var r=Number.parseInt(t,10);if(!$c(r))return e?.[r]}}var EAe={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},BQ=nc({name:"options",initialState:EAe,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),AAe=BQ.reducer,{createEventEmitter:jAe}=BQ.actions;function PAe(e){return e.tooltip.syncInteraction}var FAe={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},$Q=nc({name:"chartData",initialState:FAe,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:WB,setDataStartEndIndexes:MAe,setComputedData:vDe}=$Q.actions,RAe=$Q.reducer,OAe=["x","y"];function HB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?HB(Object(r),!0).forEach(function(n){DAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):HB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DAe(e,t,r){return(t=IAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IAe(e){var t=LAe(e,"string");return typeof t=="symbol"?t:t+""}function LAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BAe(e,t){if(e==null)return{};var r,n,s=$Ae(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function $Ae(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UQ=()=>{};function UAe(){var e=an(ej),t=an(tj),r=nl(),n=an(kJ),s=an(G0),a=TA(),i=CA(),o=an(c=>c.rootProps.className);w.useEffect(()=>{if(e==null)return UQ;var c=(u,d,f)=>{if(t!==f&&e===u){if(n==="index"){var h;if(i&&d!==null&&d!==void 0&&(h=d.payload)!==null&&h!==void 0&&h.coordinate){var g=d.payload.coordinate,{x:p,y:x}=g,v=BAe(g,OAe),C=dm(dm(dm({},v),typeof p=="number"&&{x:Math.max(i.x,Math.min(p,i.x+i.width))}),typeof x=="number"&&{y:Math.max(i.y,Math.min(x,i.y+i.height))}),b=dm(dm({},d),{},{payload:dm(dm({},d.payload),{},{coordinate:C})});r(b)}else r(d);return}if(s!=null){var _;if(typeof n=="function"){var T={activeTooltipIndex:d.payload.index==null?void 0:Number(d.payload.index),isTooltipActive:d.payload.active,activeIndex:d.payload.index==null?void 0:Number(d.payload.index),activeLabel:d.payload.label,activeDataKey:d.payload.dataKey,activeCoordinate:d.payload.coordinate},N=n(s,T);_=s[N]}else n==="value"&&(_=s.find(K=>String(K.value)===d.payload.label));var{coordinate:E}=d.payload;if(_==null||d.payload.active===!1||E==null||i==null){r(Q8({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:F,y:j}=E,P=Math.min(F,i.x+i.width),M=Math.min(j,i.y+i.height),I={x:a==="horizontal"?_.coordinate:P,y:a==="horizontal"?M:_.coordinate},U=Q8({active:d.payload.active,coordinate:I,dataKey:d.payload.dataKey,index:String(_.index),label:d.payload.label});r(U)}}};return N2.on(t7,c),()=>{N2.off(t7,c)}},[o,r,t,e,n,s,a,i])}function zAe(){var e=an(ej),t=an(tj),r=nl();w.useEffect(()=>{if(e==null)return UQ;var n=(s,a,i)=>{t!==i&&e===s&&r(MAe(a))};return N2.on(zB,n),()=>{N2.off(zB,n)}},[r,t,e])}function WAe(){var e=nl();w.useEffect(()=>{e(jAe())},[e]),UAe(),zAe()}function HAe(e,t,r,n,s,a){var i=an(h=>hAe(h,e,t)),o=an(tj),c=an(ej),u=an(kJ),d=an(PAe),f=d?.active;w.useEffect(()=>{if(!f&&c!=null&&o!=null){var h=Q8({active:a,coordinate:r,dataKey:i,index:s,label:typeof n=="number"?String(n):n});N2.emit(t7,c,h,o)}},[f,r,i,s,n,o,c,u,a])}function GB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function VB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?GB(Object(r),!0).forEach(function(n){GAe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):GB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function GAe(e,t,r){return(t=VAe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VAe(e){var t=qAe(e,"string");return typeof t=="symbol"?t:t+""}function qAe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KAe(e){return e.dataKey}function YAe(e,t){return w.isValidElement(e)?w.cloneElement(e,t):typeof e=="function"?w.createElement(e,t):w.createElement(dCe,t)}var qB=[],XAe={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Z1.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function JAe(e){var t=Gc(e,XAe),{active:r,allowEscapeViewBox:n,animationDuration:s,animationEasing:a,content:i,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:d,position:f,reverseDirection:h,useTranslate3d:g,wrapperStyle:p,cursor:x,shared:v,trigger:C,defaultIndex:b,portal:_,axisId:T}=t,N=nl(),E=typeof b=="number"?String(b):b;w.useEffect(()=>{N(xEe({shared:v,trigger:C,axisId:T,active:r,defaultIndex:E}))},[N,v,C,T,r,E]);var F=CA(),j=bX(),P=fEe(v),{activeIndex:M,isActive:I}=an(W=>pAe(W,P,C,E)),U=an(W=>gAe(W,P,C,E)),K=an(W=>IQ(W,P,C,E)),te=an(W=>mAe(W,P,C,E)),re=U,Z=SAe(),B=r??I,[J,z]=v6e([re,B]),q=P==="axis"?K:void 0;HAe(P,C,te,q,M,B);var H=_??Z;if(H==null)return null;var R=re??qB;B||(R=qB),o&&R.length&&(R=G5e(re.filter(W=>W.value!=null&&(W.hide!==!0||t.includeHidden)),d,KAe));var L=R.length>0,G=w.createElement(yCe,{allowEscapeViewBox:n,animationDuration:s,animationEasing:a,isAnimationActive:c,active:B,coordinate:te,hasPayload:L,offset:u,position:f,reverseDirection:h,useTranslate3d:g,viewBox:F,wrapperStyle:p,lastBoundingBox:J,innerRef:z,hasPortalFromProps:!!_},YAe(i,VB(VB({},t),{},{payload:R,label:q,active:B,coordinate:te,accessibilityLayer:j})));return w.createElement(w.Fragment,null,GC.createPortal(G,H),B&&w.createElement(_Ae,{cursor:x,tooltipEventType:P,coordinate:te,payload:re,index:M}))}var aC={},iC={},oC={},KB;function QAe(){return KB||(KB=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:s,edges:a}={}){let i,o=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),d=()=>{o!==null&&(r.apply(i,o),i=void 0,o=null)},f=()=>{u&&d(),x()};let h=null;const g=()=>{h!=null&&clearTimeout(h),h=setTimeout(()=>{h=null,f()},n)},p=()=>{h!==null&&(clearTimeout(h),h=null)},x=()=>{p(),i=void 0,o=null},v=()=>{d()},C=function(...b){if(s?.aborted)return;i=this,o=b;const _=h==null;g(),c&&_&&d()};return C.schedule=g,C.cancel=x,C.flush=v,s?.addEventListener("abort",x,{once:!0}),C}e.debounce=t})(oC)),oC}var YB;function ZAe(){return YB||(YB=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QAe();function r(n,s=0,a={}){typeof a!="object"&&(a={});const{leading:i=!1,trailing:o=!0,maxWait:c}=a,u=Array(2);i&&(u[0]="leading"),o&&(u[1]="trailing");let d,f=null;const h=t.debounce(function(...x){d=n.apply(this,x),f=null},s,{edges:u}),g=function(...x){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(d=n.apply(this,x),f=Date.now(),h.cancel(),h.schedule(),d):(h.apply(this,x),d)},p=()=>(h.flush(),d);return g.cancel=h.cancel,g.flush=p,g}e.debounce=r})(iC)),iC}var XB;function eje(){return XB||(XB=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ZAe();function r(n,s=0,a={}){const{leading:i=!0,trailing:o=!0}=a;return t.debounce(n,s,{leading:i,maxWait:s,trailing:o})}e.throttle=r})(aC)),aC}var lC,JB;function tje(){return JB||(JB=1,lC=eje().throttle),lC}var rje=tje();const nje=ec(rje);var Rv=function(t,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),a=2;a<n;a++)s[a-2]=arguments[a]};function QB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function cC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QB(Object(r),!0).forEach(function(n){sje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sje(e,t,r){return(t=aje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aje(e){var t=ije(e,"string");return typeof t=="symbol"?t:t+""}function ije(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oje=w.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:s="100%",height:a="100%",minWidth:i=0,minHeight:o,maxHeight:c,children:u,debounce:d=0,id:f,className:h,onResize:g,style:p={}}=e,x=w.useRef(null),v=w.useRef();v.current=g,w.useImperativeHandle(t,()=>x.current);var[C,b]=w.useState({containerWidth:n.width,containerHeight:n.height}),_=w.useCallback((N,E)=>{b(F=>{var j=Math.round(N),P=Math.round(E);return F.containerWidth===j&&F.containerHeight===P?F:{containerWidth:j,containerHeight:P}})},[]);w.useEffect(()=>{var N=P=>{var M,{width:I,height:U}=P[0].contentRect;_(I,U),(M=v.current)===null||M===void 0||M.call(v,I,U)};d>0&&(N=nje(N,d,{trailing:!0,leading:!1}));var E=new ResizeObserver(N),{width:F,height:j}=x.current.getBoundingClientRect();return _(F,j),E.observe(x.current),()=>{E.disconnect()}},[_,d]);var T=w.useMemo(()=>{var{containerWidth:N,containerHeight:E}=C;if(N<0||E<0)return null;Rv(_m(s)||_m(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,s,a),Rv(!r||r>0,"The aspect(%s) must be greater than zero.",r);var F=_m(s)?N:s,j=_m(a)?E:a;return r&&r>0&&(F?j=F/r:j&&(F=j*r),c&&j>c&&(j=c)),Rv(F>0||j>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,F,j,s,a,i,o,r),w.Children.map(u,P=>w.cloneElement(P,{width:F,height:j,style:cC({width:F,height:j},P.props.style)}))},[r,u,a,c,o,i,C,s]);return w.createElement("div",{id:f?"".concat(f):void 0,className:Vs("recharts-responsive-container",h),style:cC(cC({},p),{},{width:s,height:a,minWidth:i,minHeight:o,maxHeight:c}),ref:x},w.createElement("div",{style:{width:0,height:0,overflow:"visible"}},T))});function lje(e,t,r){return(t=cje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cje(e){var t=uje(e,"string");return typeof t=="symbol"?t:t+""}function uje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class dje{constructor(t){lje(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function ZB(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function fje(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ZB(Object(r),!0).forEach(function(n){hje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ZB(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hje(e,t,r){return(t=mje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mje(e){var t=gje(e,"string");return typeof t=="symbol"?t:t+""}function gje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pje={cacheSize:2e3,enableCache:!0},zQ=fje({},pje),e$=new dje(zQ.cacheSize),xje={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},t$="recharts_measurement_span";function yje(e,t){var r=t.fontSize||"",n=t.fontFamily||"",s=t.fontWeight||"",a=t.fontStyle||"",i=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(s,"|").concat(a,"|").concat(i,"|").concat(o)}var r$=(e,t)=>{try{var r=document.getElementById(t$);r||(r=document.createElement("span"),r.setAttribute("id",t$),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,xje,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Ov=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Z1.isSsr)return{width:0,height:0};if(!zQ.enableCache)return r$(t,r);var n=yje(t,r),s=e$.get(n);if(s)return s;var a=r$(t,r);return e$.set(n,a),a},n$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,s$=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,vje=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,bje=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,WQ={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},wje=Object.keys(WQ),Vp="NaN";function _je(e,t){return e*WQ[t]}class pl{static parse(t){var r,[,n,s]=(r=bje.exec(t))!==null&&r!==void 0?r:[];return new pl(parseFloat(n),s??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,$c(t)&&(this.unit=""),r!==""&&!vje.test(r)&&(this.num=NaN,this.unit=""),wje.includes(r)&&(this.num=_je(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new pl(NaN,""):new pl(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new pl(NaN,""):new pl(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new pl(NaN,""):new pl(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new pl(NaN,""):new pl(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return $c(this.num)}}function HQ(e){if(e.includes(Vp))return Vp;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,s,a]=(r=n$.exec(t))!==null&&r!==void 0?r:[],i=pl.parse(n??""),o=pl.parse(a??""),c=s==="*"?i.multiply(o):i.divide(o);if(c.isNaN())return Vp;t=t.replace(n$,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,d,f,h]=(u=s$.exec(t))!==null&&u!==void 0?u:[],g=pl.parse(d??""),p=pl.parse(h??""),x=f==="+"?g.add(p):g.subtract(p);if(x.isNaN())return Vp;t=t.replace(s$,x.toString())}return t}var a$=/\(([^()]*)\)/;function Sje(e){for(var t=e,r;(r=a$.exec(t))!=null;){var[,n]=r;t=t.replace(a$,HQ(n))}return t}function kje(e){var t=e.replace(/\s+/g,"");return t=Sje(t),t=HQ(t),t}function Cje(e){try{return kje(e)}catch{return Vp}}function uC(e){var t=Cje(e.slice(5,-1));return t===Vp?"":t}var Tje=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Nje=["dx","dy","angle","className","breakAll"];function r7(){return r7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},r7.apply(null,arguments)}function i$(e,t){if(e==null)return{};var r,n,s=Eje(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Eje(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var GQ=/[ \f\n\r\t\v\u2028\u2029]+/,VQ=e=>{var{children:t,breakAll:r,style:n}=e;try{var s=[];Ri(t)||(r?s=t.toString().split(""):s=t.toString().split(GQ));var a=s.map(o=>({word:o,width:Ov(o,n).width})),i=r?0:Ov("",n).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},Aje=(e,t,r,n,s)=>{var{maxLines:a,children:i,style:o,breakAll:c}=e,u=gn(a),d=i,f=function(){var I=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return I.reduce((U,K)=>{var{word:te,width:re}=K,Z=U[U.length-1];if(Z&&(n==null||s||Z.width+re+r<Number(n)))Z.words.push(te),Z.width+=re+r;else{var B={words:[te],width:re};U.push(B)}return U},[])},h=f(t),g=M=>M.reduce((I,U)=>I.width>U.width?I:U);if(!u||s)return h;var p=h.length>a||g(h).width>Number(n);if(!p)return h;for(var x="",v=M=>{var I=d.slice(0,M),U=VQ({breakAll:c,style:o,children:I+x}).wordsWithComputedWidth,K=f(U),te=K.length>a||g(K).width>Number(n);return[te,K]},C=0,b=d.length-1,_=0,T;C<=b&&_<=d.length-1;){var N=Math.floor((C+b)/2),E=N-1,[F,j]=v(E),[P]=v(N);if(!F&&!P&&(C=N+1),F&&P&&(b=N-1),!F&&P){T=j;break}_++}return T||h},o$=e=>{var t=Ri(e)?[]:e.toString().split(GQ);return[{words:t}]},jje=e=>{var{width:t,scaleToFit:r,children:n,style:s,breakAll:a,maxLines:i}=e;if((t||r)&&!Z1.isSsr){var o,c,u=VQ({breakAll:a,children:n,style:s});if(u){var{wordsWithComputedWidth:d,spaceWidth:f}=u;o=d,c=f}else return o$(n);return Aje({breakAll:a,children:n,maxLines:i,style:s},o,c,t,r)}return o$(n)},l$="#808080",Sj=w.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:s="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=l$}=e,d=i$(e,Tje),f=w.useMemo(()=>jje({breakAll:d.breakAll,children:d.children,maxLines:d.maxLines,scaleToFit:i,style:d.style,width:d.width}),[d.breakAll,d.children,d.maxLines,i,d.style,d.width]),{dx:h,dy:g,angle:p,className:x,breakAll:v}=d,C=i$(d,Nje);if(!gd(r)||!gd(n)||f.length===0)return null;var b=r+(gn(h)?h:0),_=n+(gn(g)?g:0),T;switch(c){case"start":T=uC("calc(".concat(a,")"));break;case"middle":T=uC("calc(".concat((f.length-1)/2," * -").concat(s," + (").concat(a," / 2))"));break;default:T=uC("calc(".concat(f.length-1," * -").concat(s,")"));break}var N=[];if(i){var E=f[0].width,{width:F}=d;N.push("scale(".concat(gn(F)?F/E:1,")"))}return p&&N.push("rotate(".concat(p,", ").concat(b,", ").concat(_,")")),N.length&&(C.transform=N.join(" ")),w.createElement("text",r7({},oo(C,!0),{ref:t,x:b,y:_,className:Vs("recharts-text",x),textAnchor:o,fill:u.includes("url")?l$:u}),f.map((j,P)=>{var M=j.words.join(v?"":" ");return w.createElement("tspan",{x:b,dy:P===0?T:s,key:"".concat(M,"-").concat(P)},M)}))});Sj.displayName="Text";var Pje=["labelRef"];function Fje(e,t){if(e==null)return{};var r,n,s=Mje(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function Mje(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function c$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Ra(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c$(Object(r),!0).forEach(function(n){Rje(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Rje(e,t,r){return(t=Oje(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Oje(e){var t=Dje(e,"string");return typeof t=="symbol"?t:t+""}function Dje(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function l0(){return l0=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l0.apply(null,arguments)}var qQ=w.createContext(null),Ije=e=>{var{x:t,y:r,width:n,height:s,children:a}=e,i=w.useMemo(()=>({x:t,y:r,width:n,height:s}),[t,r,n,s]);return w.createElement(qQ.Provider,{value:i},a)},KQ=()=>{var e=w.useContext(qQ),t=CA();return e||t},Lje=w.createContext(null),Bje=()=>{var e=w.useContext(Lje),t=an(AJ);return e||t},$je=e=>{var{value:t,formatter:r}=e,n=Ri(e.children)?t:e.children;return typeof r=="function"?r(n):n},kj=e=>e!=null&&typeof e=="function",Uje=(e,t)=>{var r=Pc(t-e),n=Math.min(Math.abs(t-e),360);return r*n},zje=(e,t,r,n,s)=>{var{offset:a,className:i}=e,{cx:o,cy:c,innerRadius:u,outerRadius:d,startAngle:f,endAngle:h,clockWise:g}=s,p=(u+d)/2,x=Uje(f,h),v=x>=0?1:-1,C,b;switch(t){case"insideStart":C=f+v*a,b=g;break;case"insideEnd":C=h-v*a,b=!g;break;case"end":C=h+v*a,b=g;break;default:throw new Error("Unsupported position ".concat(t))}b=x<=0?b:!b;var _=so(o,c,p,C),T=so(o,c,p,C+(b?1:-1)*359),N="M".concat(_.x,",").concat(_.y,`
    A`).concat(p,",").concat(p,",0,1,").concat(b?0:1,`,
    `).concat(T.x,",").concat(T.y),E=Ri(e.id)?x2("recharts-radial-line-"):e.id;return w.createElement("text",l0({},n,{dominantBaseline:"central",className:Vs("recharts-radial-bar-label",i)}),w.createElement("defs",null,w.createElement("path",{id:E,d:N})),w.createElement("textPath",{xlinkHref:"#".concat(E)},r))},Wje=(e,t,r)=>{var{cx:n,cy:s,innerRadius:a,outerRadius:i,startAngle:o,endAngle:c}=e,u=(o+c)/2;if(r==="outside"){var{x:d,y:f}=so(n,s,i+t,u);return{x:d,y:f,textAnchor:d>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:s,textAnchor:"middle",verticalAnchor:"end"};var h=(a+i)/2,{x:g,y:p}=so(n,s,h,u);return{x:g,y:p,textAnchor:"middle",verticalAnchor:"middle"}},YQ=e=>"cx"in e&&gn(e.cx),Hje=(e,t)=>{var{parentViewBox:r,offset:n,position:s}=e,a;r!=null&&!YQ(r)&&(a=r);var{x:i,y:o,width:c,height:u}=t,d=u>=0?1:-1,f=d*n,h=d>0?"end":"start",g=d>0?"start":"end",p=c>=0?1:-1,x=p*n,v=p>0?"end":"start",C=p>0?"start":"end";if(s==="top"){var b={x:i+c/2,y:o-d*n,textAnchor:"middle",verticalAnchor:h};return Ra(Ra({},b),a?{height:Math.max(o-a.y,0),width:c}:{})}if(s==="bottom"){var _={x:i+c/2,y:o+u+f,textAnchor:"middle",verticalAnchor:g};return Ra(Ra({},_),a?{height:Math.max(a.y+a.height-(o+u),0),width:c}:{})}if(s==="left"){var T={x:i-x,y:o+u/2,textAnchor:v,verticalAnchor:"middle"};return Ra(Ra({},T),a?{width:Math.max(T.x-a.x,0),height:u}:{})}if(s==="right"){var N={x:i+c+x,y:o+u/2,textAnchor:C,verticalAnchor:"middle"};return Ra(Ra({},N),a?{width:Math.max(a.x+a.width-N.x,0),height:u}:{})}var E=a?{width:c,height:u}:{};return s==="insideLeft"?Ra({x:i+x,y:o+u/2,textAnchor:C,verticalAnchor:"middle"},E):s==="insideRight"?Ra({x:i+c-x,y:o+u/2,textAnchor:v,verticalAnchor:"middle"},E):s==="insideTop"?Ra({x:i+c/2,y:o+f,textAnchor:"middle",verticalAnchor:g},E):s==="insideBottom"?Ra({x:i+c/2,y:o+u-f,textAnchor:"middle",verticalAnchor:h},E):s==="insideTopLeft"?Ra({x:i+x,y:o+f,textAnchor:C,verticalAnchor:g},E):s==="insideTopRight"?Ra({x:i+c-x,y:o+f,textAnchor:v,verticalAnchor:g},E):s==="insideBottomLeft"?Ra({x:i+x,y:o+u-f,textAnchor:C,verticalAnchor:h},E):s==="insideBottomRight"?Ra({x:i+c-x,y:o+u-f,textAnchor:v,verticalAnchor:h},E):s&&typeof s=="object"&&(gn(s.x)||_m(s.x))&&(gn(s.y)||_m(s.y))?Ra({x:i+mh(s.x,c),y:o+mh(s.y,u),textAnchor:"end",verticalAnchor:"end"},E):Ra({x:i+c/2,y:o+u/2,textAnchor:"middle",verticalAnchor:"middle"},E)},Gje={offset:5};function Bf(e){var t=Gc(e,Gje),{viewBox:r,position:n,value:s,children:a,content:i,className:o="",textBreakAll:c,labelRef:u}=t,d=Bje(),f=KQ(),h=n==="center"?f:d??f,g=r||h;if(!g||Ri(s)&&Ri(a)&&!w.isValidElement(i)&&typeof i!="function")return null;var p=Ra(Ra({},t),{},{viewBox:g});if(w.isValidElement(i)){var{labelRef:x}=p,v=Fje(p,Pje);return w.cloneElement(i,v)}var C;if(typeof i=="function"){if(C=w.createElement(i,p),w.isValidElement(C))return C}else C=$je(t);var b=YQ(g),_=oo(t,!0);if(b&&(n==="insideStart"||n==="insideEnd"||n==="end"))return zje(t,n,C,_,g);var T=b?Wje(g,t.offset,t.position):Hje(t,g);return w.createElement(Sj,l0({ref:u,className:Vs("recharts-label",o)},_,T,{breakAll:c}),C)}Bf.displayName="Label";var Vje=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?w.createElement(Bf,l0({key:"label-implicit"},n)):gd(e)?w.createElement(Bf,l0({key:"label-implicit",value:e},n)):w.isValidElement(e)?e.type===Bf?w.cloneElement(e,Ra({key:"label-implicit"},n)):w.createElement(Bf,l0({key:"label-implicit",content:e},n)):kj(e)?w.createElement(Bf,l0({key:"label-implicit",content:e},n)):e&&typeof e=="object"?w.createElement(Bf,l0({},e,{key:"label-implicit"},n)):null};function qje(e){var{label:t}=e,r=KQ();return Vje(t,r)||null}var dC={},fC={},u$;function Kje(){return u$||(u$=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(fC)),fC}var hC={},d$;function Yje(){return d$||(d$=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(hC)),hC}var f$;function Xje(){return f$||(f$=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kje(),r=Yje(),n=xA();function s(a){if(n.isArrayLike(a))return t.last(r.toArray(a))}e.last=s})(dC)),dC}var mC,h$;function Jje(){return h$||(h$=1,mC=Xje().last),mC}var Qje=Jje();const Zje=ec(Qje);var e9e=["valueAccessor"],t9e=["dataKey","clockWise","id","textBreakAll"];function fS(){return fS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fS.apply(null,arguments)}function m$(e,t){if(e==null)return{};var r,n,s=r9e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function r9e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var n9e=e=>Array.isArray(e.value)?Zje(e.value):e.value,XQ=w.createContext(void 0),s9e=XQ.Provider,JQ=w.createContext(void 0);JQ.Provider;function a9e(){return w.useContext(XQ)}function i9e(){return w.useContext(JQ)}function L4(e){var{valueAccessor:t=n9e}=e,r=m$(e,e9e),{dataKey:n,clockWise:s,id:a,textBreakAll:i}=r,o=m$(r,t9e),c=a9e(),u=i9e(),d=c||u;return!d||!d.length?null:w.createElement(Q1,{className:"recharts-label-list"},d.map((f,h)=>{var g,p=Ri(n)?t(f,h):el(f&&f.payload,n),x=Ri(a)?{}:{id:"".concat(a,"-").concat(h)};return w.createElement(Bf,fS({},oo(f,!0),o,x,{fill:(g=r.fill)!==null&&g!==void 0?g:f.fill,parentViewBox:f.parentViewBox,value:p,textBreakAll:i,viewBox:f.viewBox,key:"label-".concat(h),index:h}))}))}L4.displayName="LabelList";function o9e(e){var{label:t}=e;return t?t===!0?w.createElement(L4,{key:"labelList-implicit"}):w.isValidElement(t)||kj(t)?w.createElement(L4,{key:"labelList-implicit",content:t}):typeof t=="object"?w.createElement(L4,fS({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function n7(){return n7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},n7.apply(null,arguments)}var QQ=e=>{var{cx:t,cy:r,r:n,className:s}=e,a=Vs("recharts-dot",s);return t===+t&&r===+r&&n===+n?w.createElement("circle",n7({},Sg(e),gA(e),{className:a,cx:t,cy:r,r:n})):null},l9e={radiusAxis:{},angleAxis:{}},ZQ=nc({name:"polarAxis",initialState:l9e,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:bDe,removeRadiusAxis:wDe,addAngleAxis:_De,removeAngleAxis:SDe}=ZQ.actions,c9e=ZQ.reducer;function u9e(e){var{fn:t,args:r}=e,n=nl(),s=Hc();return w.useEffect(()=>{if(!s){var a=t(r);return n(gEe(a)),()=>{n(pEe(a))}}},[t,r,n,s]),null}var d9e=()=>{};function f9e(e){var{legendPayload:t}=e,r=nl(),n=Hc();return w.useEffect(()=>n?d9e:(r(sCe(t)),()=>{r(aCe(t))}),[r,n,t]),null}var gC,h9e=()=>{var[e]=w.useState(()=>x2("uid-"));return e},m9e=(gC=CU.useId)!==null&&gC!==void 0?gC:h9e;function g9e(e,t){var r=m9e();return t||(e?"".concat(e,"-").concat(r):r)}var p9e=w.createContext(void 0),x9e=e=>{var{id:t,type:r,children:n}=e,s=g9e("recharts-".concat(r),t);return w.createElement(p9e.Provider,{value:s},n(s))},y9e={cartesianItems:[],polarItems:[]},eZ=nc({name:"graphicalItems",initialState:y9e,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,s=v0(e).cartesianItems.indexOf(r);s>-1&&(e.cartesianItems[s]=n)},removeCartesianGraphicalItem(e,t){var r=v0(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=v0(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:v9e,replaceCartesianGraphicalItem:b9e,removeCartesianGraphicalItem:w9e,addPolarGraphicalItem:kDe,removePolarGraphicalItem:CDe}=eZ.actions,_9e=eZ.reducer;function S9e(e){var t=nl(),r=w.useRef(null);return w.useEffect(()=>{r.current===null?t(v9e(e)):r.current!==e&&t(b9e({prev:r.current,next:e})),r.current=e},[t,e]),w.useEffect(()=>()=>{r.current&&(t(w9e(r.current)),r.current=null)},[t]),null}function g$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function p$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g$(Object(r),!0).forEach(function(n){k9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k9e(e,t,r){return(t=C9e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C9e(e){var t=T9e(e,"string");return typeof t=="symbol"?t:t+""}function T9e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var N9e={xAxis:{},yAxis:{},zAxis:{}},tZ=nc({name:"cartesianAxis",initialState:N9e,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=p$(p$({},e.yAxis[r]),{},{width:n}))}}}),{addXAxis:E9e,removeXAxis:A9e,addYAxis:j9e,removeYAxis:P9e,addZAxis:TDe,removeZAxis:NDe,updateYAxisWidth:F9e}=tZ.actions,M9e=tZ.reducer,R9e=Gt([lo],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),O9e=Gt([R9e,$0,U0],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),Cj=()=>an(O9e),D9e=()=>an(aAe);function x$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function y$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x$(Object(r),!0).forEach(function(n){I9e(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function I9e(e,t,r){return(t=L9e(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L9e(e){var t=B9e(e,"string");return typeof t=="symbol"?t:t+""}function B9e(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $9e=e=>{var{point:t,childIndex:r,mainColor:n,activeDot:s,dataKey:a}=e;if(s===!1||t.x==null||t.y==null)return null;var i=y$(y$({index:r,dataKey:a,cx:t.x,cy:t.y,r:4,fill:n??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},oo(s,!1)),gA(s)),o;return w.isValidElement(s)?o=w.cloneElement(s,i):typeof s=="function"?o=s(i):o=w.createElement(QQ,i),w.createElement(Q1,{className:"recharts-active-dot"},o)};function U9e(e){var{points:t,mainColor:r,activeDot:n,itemDataKey:s}=e,a=an(T2),i=D9e();if(t==null||i==null)return null;var o=t.find(c=>i.includes(c.payload));return Ri(o)?null:$9e({point:o,childIndex:Number(a),mainColor:r,dataKey:s,activeDot:n})}var z9e={},rZ=nc({name:"errorBars",initialState:z9e,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:s}=t.payload;e[r]&&(e[r]=e[r].map(a=>a.dataKey===n.dataKey&&a.direction===n.direction?s:a))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(s=>s.dataKey!==n.dataKey||s.direction!==n.direction))}}}),{addErrorBar:EDe,replaceErrorBar:ADe,removeErrorBar:jDe}=rZ.actions,W9e=rZ.reducer,H9e=["children"];function G9e(e,t){if(e==null)return{};var r,n,s=V9e(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function V9e(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var q9e={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},K9e=w.createContext(q9e);function Y9e(e){var{children:t}=e,r=G9e(e,H9e);return w.createElement(K9e.Provider,{value:r},t)}function nZ(e,t){var r,n,s=an(u=>W0(u,e)),a=an(u=>H0(u,t)),i=(r=s?.allowDataOverflow)!==null&&r!==void 0?r:Ll.allowDataOverflow,o=(n=a?.allowDataOverflow)!==null&&n!==void 0?n:Bl.allowDataOverflow,c=i||o;return{needClip:c,needClipX:i,needClipY:o}}function X9e(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,s=Cj(),{needClipX:a,needClipY:i,needClip:o}=nZ(t,r);if(!o)return null;var{x:c,y:u,width:d,height:f}=s;return w.createElement("clipPath",{id:"clipPath-".concat(n)},w.createElement("rect",{x:a?c:c-d/2,y:i?u:u-f/2,width:a?d:d*2,height:i?f:f*2}))}var J9e=e=>{var{chartData:t}=e,r=nl(),n=Hc();return w.useEffect(()=>n?()=>{}:(r(WB(t)),()=>{r(WB(void 0))}),[t,r,n]),null},v$={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},sZ=nc({name:"brush",initialState:v$,reducers:{setBrushSettings(e,t){return t.payload==null?v$:t.payload}}}),{setBrushSettings:PDe}=sZ.actions,Q9e=sZ.reducer;function Z9e(e,t,r){return(t=ePe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ePe(e){var t=tPe(e,"string");return typeof t=="symbol"?t:t+""}function tPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Tj{static create(t){return new Tj(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(n)switch(n){case"start":return this.scale(t);case"middle":{var s=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+s}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(t)+a}default:return this.scale(t)}if(r){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}return this.scale(t)}}isInRange(t){var r=this.range(),n=r[0],s=r[r.length-1];return n<=s?t>=n&&t<=s:t>=s&&t<=n}}Z9e(Tj,"EPS",1e-4);function rPe(e){return(e%180+180)%180}var nPe=function(t){var{width:r,height:n}=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=rPe(s),i=a*Math.PI/180,o=Math.atan(n/r),c=i>o&&i<Math.PI-o?n/Math.sin(i):r/Math.cos(i);return Math.abs(c)},sPe={dots:[],areas:[],lines:[]},aZ=nc({name:"referenceElements",initialState:sPe,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=v0(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=v0(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=v0(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:FDe,removeDot:MDe,addArea:RDe,removeArea:ODe,addLine:DDe,removeLine:IDe}=aZ.actions,aPe=aZ.reducer,iPe=w.createContext(void 0),oPe=e=>{var{children:t}=e,[r]=w.useState("".concat(x2("recharts"),"-clip")),n=Cj();if(n==null)return null;var{x:s,y:a,width:i,height:o}=n;return w.createElement(iPe.Provider,{value:r},w.createElement("defs",null,w.createElement("clipPath",{id:r},w.createElement("rect",{x:s,y:a,height:o,width:i}))),t)};function T1(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var n in t)if({}.hasOwnProperty.call(t,n)&&!{}.hasOwnProperty.call(e,n))return!1;return!0}function iZ(e,t,r){if(t<1)return[];if(t===1&&r===void 0)return e;for(var n=[],s=0;s<e.length;s+=t)n.push(e[s]);return n}function lPe(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return nPe(n,r)}function cPe(e,t,r){var n=r==="width",{x:s,y:a,width:i,height:o}=e;return t===1?{start:n?s:a,end:n?s+i:a+o}:{start:n?s+i:a+o,end:n?s:a}}function hS(e,t,r,n,s){if(e*t<e*n||e*t>e*s)return!1;var a=r();return e*(t-e*a/2-n)>=0&&e*(t+e*a/2-s)<=0}function uPe(e,t){return iZ(e,t+1)}function dPe(e,t,r,n,s){for(var a=(n||[]).slice(),{start:i,end:o}=t,c=0,u=1,d=i,f=function(){var p=n?.[c];if(p===void 0)return{v:iZ(n,u)};var x=c,v,C=()=>(v===void 0&&(v=r(p,x)),v),b=p.coordinate,_=c===0||hS(e,b,C,d,o);_||(c=0,d=i,u+=1),_&&(d=b+e*(C()/2+s),c+=u)},h;u<=a.length;)if(h=f(),h)return h.v;return[]}function b$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function yo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?b$(Object(r),!0).forEach(function(n){fPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fPe(e,t,r){return(t=hPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hPe(e){var t=mPe(e,"string");return typeof t=="symbol"?t:t+""}function mPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gPe(e,t,r,n,s){for(var a=(n||[]).slice(),i=a.length,{start:o}=t,{end:c}=t,u=function(h){var g=a[h],p,x=()=>(p===void 0&&(p=r(g,h)),p);if(h===i-1){var v=e*(g.coordinate+e*x()/2-c);a[h]=g=yo(yo({},g),{},{tickCoord:v>0?g.coordinate-v*e:g.coordinate})}else a[h]=g=yo(yo({},g),{},{tickCoord:g.coordinate});var C=hS(e,g.tickCoord,x,o,c);C&&(c=g.tickCoord-e*(x()/2+s),a[h]=yo(yo({},g),{},{isShow:!0}))},d=i-1;d>=0;d--)u(d);return a}function pPe(e,t,r,n,s,a){var i=(n||[]).slice(),o=i.length,{start:c,end:u}=t;if(a){var d=n[o-1],f=r(d,o-1),h=e*(d.coordinate+e*f/2-u);i[o-1]=d=yo(yo({},d),{},{tickCoord:h>0?d.coordinate-h*e:d.coordinate});var g=hS(e,d.tickCoord,()=>f,c,u);g&&(u=d.tickCoord-e*(f/2+s),i[o-1]=yo(yo({},d),{},{isShow:!0}))}for(var p=a?o-1:o,x=function(b){var _=i[b],T,N=()=>(T===void 0&&(T=r(_,b)),T);if(b===0){var E=e*(_.coordinate-e*N()/2-c);i[b]=_=yo(yo({},_),{},{tickCoord:E<0?_.coordinate-E*e:_.coordinate})}else i[b]=_=yo(yo({},_),{},{tickCoord:_.coordinate});var F=hS(e,_.tickCoord,N,c,u);F&&(c=_.tickCoord+e*(N()/2+s),i[b]=yo(yo({},_),{},{isShow:!0}))},v=0;v<p;v++)x(v);return i}function Nj(e,t,r){var{tick:n,ticks:s,viewBox:a,minTickGap:i,orientation:o,interval:c,tickFormatter:u,unit:d,angle:f}=e;if(!s||!s.length||!n)return[];if(gn(c)||Z1.isSsr){var h;return(h=uPe(s,gn(c)?c:0))!==null&&h!==void 0?h:[]}var g=[],p=o==="top"||o==="bottom"?"width":"height",x=d&&p==="width"?Ov(d,{fontSize:t,letterSpacing:r}):{width:0,height:0},v=(_,T)=>{var N=typeof u=="function"?u(_.value,T):_.value;return p==="width"?lPe(Ov(N,{fontSize:t,letterSpacing:r}),x,f):Ov(N,{fontSize:t,letterSpacing:r})[p]},C=s.length>=2?Pc(s[1].coordinate-s[0].coordinate):1,b=cPe(a,C,p);return c==="equidistantPreserveStart"?dPe(C,b,v,s,i):(c==="preserveStart"||c==="preserveStartEnd"?g=pPe(C,b,v,s,i,c==="preserveStartEnd"):g=gPe(C,b,v,s,i),g.filter(_=>_.isShow))}var xPe=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:s=0,tickMargin:a=0}=e,i=0;if(t){t.forEach(d=>{if(d){var f=d.getBoundingClientRect();f.width>i&&(i=f.width)}});var o=r?r.getBoundingClientRect().width:0,c=s+a,u=i+c+o+(r?n:0);return Math.round(u)}return 0},yPe=["axisLine","width","height","className","hide","ticks"],vPe=["viewBox"],bPe=["viewBox"];function s7(e,t){if(e==null)return{};var r,n,s=wPe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function wPe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function lg(){return lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lg.apply(null,arguments)}function w$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function li(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?w$(Object(r),!0).forEach(function(n){_Pe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _Pe(e,t,r){return(t=SPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SPe(e){var t=kPe(e,"string");return typeof t=="symbol"?t:t+""}function kPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ej={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function CPe(e){var{x:t,y:r,width:n,height:s,orientation:a,mirror:i,axisLine:o,otherSvgProps:c}=e;if(!o)return null;var u=li(li(li({},c),oo(o,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var d=+(a==="top"&&!i||a==="bottom"&&i);u=li(li({},u),{},{x1:t,y1:r+d*s,x2:t+n,y2:r+d*s})}else{var f=+(a==="left"&&!i||a==="right"&&i);u=li(li({},u),{},{x1:t+f*n,y1:r,x2:t+f*n,y2:r+s})}return w.createElement("line",lg({},u,{className:Vs("recharts-cartesian-axis-line",l3(o,"className"))}))}function TPe(e,t,r,n,s,a,i,o,c){var u,d,f,h,g,p,x=o?-1:1,v=e.tickSize||i,C=gn(e.tickCoord)?e.tickCoord:e.coordinate;switch(a){case"top":u=d=e.coordinate,h=r+ +!o*s,f=h-x*v,p=f-x*c,g=C;break;case"left":f=h=e.coordinate,d=t+ +!o*n,u=d-x*v,g=u-x*c,p=C;break;case"right":f=h=e.coordinate,d=t+ +o*n,u=d+x*v,g=u+x*c,p=C;break;default:u=d=e.coordinate,h=r+ +o*s,f=h+x*v,p=f+x*c,g=C;break}return{line:{x1:u,y1:f,x2:d,y2:h},tick:{x:g,y:p}}}function NPe(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function EPe(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function APe(e){var{option:t,tickProps:r,value:n}=e,s,a=Vs(r.className,"recharts-cartesian-axis-tick-value");if(w.isValidElement(t))s=w.cloneElement(t,li(li({},r),{},{className:a}));else if(typeof t=="function")s=t(li(li({},r),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(i=Vs(i,t?.className)),s=w.createElement(Sj,lg({},r,{className:i}),n)}return s}function jPe(e){var{ticks:t=[],tick:r,tickLine:n,stroke:s,tickFormatter:a,unit:i,padding:o,tickTextProps:c,orientation:u,mirror:d,x:f,y:h,width:g,height:p,tickSize:x,tickMargin:v,fontSize:C,letterSpacing:b,getTicksConfig:_,events:T}=e,N=Nj(li(li({},_),{},{ticks:t}),C,b),E=NPe(u,d),F=EPe(u,d),j=Sg(_),P=oo(r,!1),M=li(li({},j),{},{fill:"none"},oo(n,!1)),I=N.map((U,K)=>{var{line:te,tick:re}=TPe(U,f,h,g,p,u,x,d,v),Z=li(li(li(li({textAnchor:E,verticalAnchor:F},j),{},{stroke:"none",fill:s},P),re),{},{index:K,payload:U,visibleTicksCount:N.length,tickFormatter:a,padding:o},c);return w.createElement(Q1,lg({className:"recharts-cartesian-axis-tick",key:"tick-".concat(U.value,"-").concat(U.coordinate,"-").concat(U.tickCoord)},Y3e(T,U,K)),n&&w.createElement("line",lg({},M,te,{className:Vs("recharts-cartesian-axis-tick-line",l3(n,"className"))})),r&&w.createElement(APe,{option:r,tickProps:Z,value:"".concat(typeof a=="function"?a(U.value,K):U.value).concat(i||"")}))});return I.length>0?w.createElement("g",{className:"recharts-cartesian-axis-ticks"},I):null}var PPe=w.forwardRef((e,t)=>{var{axisLine:r,width:n,height:s,className:a,hide:i,ticks:o}=e,c=s7(e,yPe),[u,d]=w.useState(""),[f,h]=w.useState(""),g=w.useRef([]);w.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var x;return xPe({ticks:g.current,label:(x=e.labelRef)===null||x===void 0?void 0:x.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var p=w.useCallback(x=>{if(x){var v=x.getElementsByClassName("recharts-cartesian-axis-tick-value");g.current=Array.from(v);var C=v[0];if(C){var b=window.getComputedStyle(C),_=b.fontSize,T=b.letterSpacing;(_!==u||T!==f)&&(d(_),h(T))}}},[u,f]);return i||n!=null&&n<=0||s!=null&&s<=0?null:w.createElement(Q1,{className:Vs("recharts-cartesian-axis",a),ref:p},w.createElement(CPe,{x:e.x,y:e.y,width:n,height:s,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Sg(e)}),w.createElement(jPe,{ticks:o,tick:e.tick,tickLine:e.tickLine,stroke:e.stroke,tickFormatter:e.tickFormatter,unit:e.unit,padding:e.padding,tickTextProps:e.tickTextProps,orientation:e.orientation,mirror:e.mirror,x:e.x,y:e.y,width:e.width,height:e.height,tickSize:e.tickSize,tickMargin:e.tickMargin,fontSize:u,letterSpacing:f,getTicksConfig:e,events:c}),w.createElement(Ije,{x:e.x,y:e.y,width:e.width,height:e.height},w.createElement(qje,{label:e.label}),e.children))}),FPe=w.memo(PPe,(e,t)=>{var{viewBox:r}=e,n=s7(e,vPe),{viewBox:s}=t,a=s7(t,bPe);return T1(r,s)&&T1(n,a)}),Aj=w.forwardRef((e,t)=>{var r=Gc(e,Ej);return w.createElement(FPe,lg({},r,{ref:t}))});Aj.displayName="CartesianAxis";var MPe=["x1","y1","x2","y2","key"],RPe=["offset"],OPe=["xAxisId","yAxisId"],DPe=["xAxisId","yAxisId"];function _$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function _o(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_$(Object(r),!0).forEach(function(n){IPe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IPe(e,t,r){return(t=LPe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LPe(e){var t=BPe(e,"string");return typeof t=="symbol"?t:t+""}function BPe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cm.apply(null,arguments)}function mS(e,t){if(e==null)return{};var r,n,s=$Pe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function $Pe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UPe=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:s,width:a,height:i,ry:o}=e;return w.createElement("rect",{x:n,y:s,ry:o,width:a,height:i,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function oZ(e,t){var r;if(w.isValidElement(e))r=w.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var{x1:n,y1:s,x2:a,y2:i,key:o}=t,c=mS(t,MPe),u=Sg(c),{offset:d}=u,f=mS(u,RPe);r=w.createElement("line",Cm({},f,{x1:n,y1:s,x2:a,y2:i,fill:"none",key:o}))}return r}function zPe(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=mS(e,OPe),c=s.map((u,d)=>{var f=_o(_o({},o),{},{x1:t,y1:u,x2:t+r,y2:u,key:"line-".concat(d),index:d});return oZ(n,f)});return w.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function WPe(e){var{y:t,height:r,vertical:n=!0,verticalPoints:s}=e;if(!n||!s||!s.length)return null;var{xAxisId:a,yAxisId:i}=e,o=mS(e,DPe),c=s.map((u,d)=>{var f=_o(_o({},o),{},{x1:u,y1:t,x2:u,y2:t+r,key:"line-".concat(d),index:d});return oZ(n,f)});return w.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function HPe(e){var{horizontalFill:t,fillOpacity:r,x:n,y:s,width:a,height:i,horizontalPoints:o,horizontal:c=!0}=e;if(!c||!t||!t.length)return null;var u=o.map(f=>Math.round(f+s-s)).sort((f,h)=>f-h);s!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var g=!u[h+1],p=g?s+i-f:u[h+1]-f;if(p<=0)return null;var x=h%t.length;return w.createElement("rect",{key:"react-".concat(h),y:f,x:n,height:p,width:a,stroke:"none",fill:t[x],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function GPe(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:s,y:a,width:i,height:o,verticalPoints:c}=e;if(!t||!r||!r.length)return null;var u=c.map(f=>Math.round(f+s-s)).sort((f,h)=>f-h);s!==u[0]&&u.unshift(0);var d=u.map((f,h)=>{var g=!u[h+1],p=g?s+i-f:u[h+1]-f;if(p<=0)return null;var x=h%r.length;return w.createElement("rect",{key:"react-".concat(h),x:f,y:a,width:p,height:o,stroke:"none",fill:r[x],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return w.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var VPe=(e,t)=>{var{xAxis:r,width:n,height:s,offset:a}=e;return dX(Nj(_o(_o(_o({},Ej),r),{},{ticks:fX(r),viewBox:{x:0,y:0,width:n,height:s}})),a.left,a.left+a.width,t)},qPe=(e,t)=>{var{yAxis:r,width:n,height:s,offset:a}=e;return dX(Nj(_o(_o(_o({},Ej),r),{},{ticks:fX(r),viewBox:{x:0,y:0,width:n,height:s}})),a.top,a.top+a.height,t)},KPe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function lZ(e){var t=xX(),r=yX(),n=pX(),s=_o(_o({},Gc(e,KPe)),{},{x:gn(e.x)?e.x:n.left,y:gn(e.y)?e.y:n.top,width:gn(e.width)?e.width:n.width,height:gn(e.height)?e.height:n.height}),{xAxisId:a,yAxisId:i,x:o,y:c,width:u,height:d,syncWithTicks:f,horizontalValues:h,verticalValues:g}=s,p=Hc(),x=an(P=>RB(P,"xAxis",a,p)),v=an(P=>RB(P,"yAxis",i,p));if(!gn(u)||u<=0||!gn(d)||d<=0||!gn(o)||o!==+o||!gn(c)||c!==+c)return null;var C=s.verticalCoordinatesGenerator||VPe,b=s.horizontalCoordinatesGenerator||qPe,{horizontalPoints:_,verticalPoints:T}=s;if((!_||!_.length)&&typeof b=="function"){var N=h&&h.length,E=b({yAxis:v?_o(_o({},v),{},{ticks:N?h:v.ticks}):void 0,width:t,height:r,offset:n},N?!0:f);Rv(Array.isArray(E),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof E,"]")),Array.isArray(E)&&(_=E)}if((!T||!T.length)&&typeof C=="function"){var F=g&&g.length,j=C({xAxis:x?_o(_o({},x),{},{ticks:F?g:x.ticks}):void 0,width:t,height:r,offset:n},F?!0:f);Rv(Array.isArray(j),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof j,"]")),Array.isArray(j)&&(T=j)}return w.createElement("g",{className:"recharts-cartesian-grid"},w.createElement(UPe,{fill:s.fill,fillOpacity:s.fillOpacity,x:s.x,y:s.y,width:s.width,height:s.height,ry:s.ry}),w.createElement(HPe,Cm({},s,{horizontalPoints:_})),w.createElement(GPe,Cm({},s,{verticalPoints:T})),w.createElement(zPe,Cm({},s,{offset:n,horizontalPoints:_,xAxis:x,yAxis:v})),w.createElement(WPe,Cm({},s,{offset:n,verticalPoints:T,xAxis:x,yAxis:v})))}lZ.displayName="CartesianGrid";var cZ=(e,t,r,n)=>gQ(e,"xAxis",t,n),uZ=(e,t,r,n)=>mQ(e,"xAxis",t,n),dZ=(e,t,r,n)=>gQ(e,"yAxis",r,n),fZ=(e,t,r,n)=>mQ(e,"yAxis",r,n),YPe=Gt([qs,cZ,dZ,uZ,fZ],(e,t,r,n,s)=>Th(e,"xAxis")?O8(t,n,!1):O8(r,s,!1)),XPe=(e,t,r,n,s)=>s;function JPe(e){return e.type==="line"}var QPe=Gt([IJ,XPe],(e,t)=>e.filter(JPe).find(r=>r.id===t)),ZPe=Gt([qs,cZ,dZ,uZ,fZ,QPe,YPe,XA],(e,t,r,n,s,a,i,o)=>{var{chartData:c,dataStartIndex:u,dataEndIndex:d}=o;if(!(a==null||t==null||r==null||n==null||s==null||n.length===0||s.length===0||i==null)){var{dataKey:f,data:h}=a,g;if(h!=null&&h.length>0?g=h:g=c?.slice(u,d+1),g!=null)return wFe({layout:e,xAxis:t,yAxis:r,xAxisTicks:n,yAxisTicks:s,dataKey:f,bandSize:i,displayedData:g})}}),eFe=["id"],tFe=["type","layout","connectNulls","needClip"],rFe=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function S$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function Hl(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S$(Object(r),!0).forEach(function(n){nFe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nFe(e,t,r){return(t=sFe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sFe(e){var t=aFe(e,"string");return typeof t=="symbol"?t:t+""}function aFe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jj(e,t){if(e==null)return{};var r,n,s=iFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function iFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function cg(){return cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},cg.apply(null,arguments)}var oFe=e=>{var{dataKey:t,name:r,stroke:n,legendType:s,hide:a}=e;return[{inactive:a,dataKey:t,type:s,color:n,value:hX(r,t),payload:e}]};function lFe(e){var{dataKey:t,data:r,stroke:n,strokeWidth:s,fill:a,name:i,hide:o,unit:c}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:a,dataKey:t,nameKey:void 0,name:hX(i,t),hide:o,type:e.tooltipType,color:e.stroke,unit:c}}}var hZ=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function cFe(e,t){for(var r=e.length%2!==0?[...e,0]:e,n=[],s=0;s<t;++s)n=[...n,...r];return n}var uFe=(e,t,r)=>{var n=r.reduce((f,h)=>f+h);if(!n)return hZ(t,e);for(var s=Math.floor(e/n),a=e%n,i=t-e,o=[],c=0,u=0;c<r.length;u+=r[c],++c)if(u+r[c]>a){o=[...r.slice(0,c),a-u];break}var d=o.length%2===0?[0,i]:[i];return[...cFe(r,s),...o,...d].map(f=>"".concat(f,"px")).join(", ")};function dFe(e,t){var r;if(w.isValidElement(e))r=w.cloneElement(e,t);else if(typeof e=="function")r=e(t);else{var n=Vs("recharts-line-dot",typeof e!="boolean"?e.className:"");r=w.createElement(QQ,cg({},t,{className:n}))}return r}function fFe(e,t){return e==null?!1:t?!0:e.length===1}function hFe(e){var{clipPathId:t,points:r,props:n}=e,{dot:s,dataKey:a,needClip:i}=n;if(!fFe(r,s))return null;var{id:o}=n,c=jj(n,eFe),u=fY(s),d=Sg(c),f=oo(s,!0),h=r.map((p,x)=>{var v=Hl(Hl(Hl({key:"dot-".concat(x),r:3},d),f),{},{index:x,cx:p.x,cy:p.y,dataKey:a,value:p.value,payload:p.payload,points:r});return dFe(s,v)}),g={clipPath:i?"url(#clipPath-".concat(u?"":"dots-").concat(t,")"):void 0};return w.createElement(Q1,cg({className:"recharts-line-dots",key:"dots"},g),h)}function mFe(e){var{showLabels:t,children:r,points:n}=e,s=w.useMemo(()=>n?.map(a=>{var i={x:a.x,y:a.y,width:0,height:0};return Hl(Hl({},i),{},{value:a.value,payload:a.payload,viewBox:i,parentViewBox:void 0,fill:void 0})}),[n]);return w.createElement(s9e,{value:t?s:null},r)}function k$(e){var{clipPathId:t,pathRef:r,points:n,strokeDasharray:s,props:a}=e,{type:i,layout:o,connectNulls:c,needClip:u}=a,d=jj(a,tFe),f=Hl(Hl({},oo(d,!0)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(t,")"):void 0,points:n,type:i,layout:o,connectNulls:c,strokeDasharray:s??a.strokeDasharray});return w.createElement(w.Fragment,null,n?.length>1&&w.createElement(wX,cg({},f,{pathRef:r})),w.createElement(hFe,{points:n,clipPathId:t,props:a}))}function gFe(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function pFe(e){var{clipPathId:t,props:r,pathRef:n,previousPointsRef:s,longestAnimatedLengthRef:a}=e,{points:i,strokeDasharray:o,isAnimationActive:c,animationBegin:u,animationDuration:d,animationEasing:f,animateNewValues:h,width:g,height:p,onAnimationEnd:x,onAnimationStart:v}=r,C=s.current,b=TX(r,"recharts-line-"),[_,T]=w.useState(!1),N=!_,E=w.useCallback(()=>{typeof x=="function"&&x(),T(!1)},[x]),F=w.useCallback(()=>{typeof v=="function"&&v(),T(!0)},[v]),j=gFe(n.current),P=a.current;return w.createElement(mFe,{points:i,showLabels:N},r.children,w.createElement(CX,{animationId:b,begin:u,duration:d,isActive:c,easing:f,onAnimationEnd:E,onAnimationStart:F,key:b},M=>{var I=i0(P,j+P,M),U=Math.min(I,j),K;if(c)if(o){var te="".concat(o).split(/[,\s]+/gim).map(B=>parseFloat(B));K=uFe(U,j,te)}else K=hZ(j,U);else K=o==null?void 0:String(o);if(C){var re=C.length/i.length,Z=M===1?i:i.map((B,J)=>{var z=Math.floor(J*re);if(C[z]){var q=C[z];return Hl(Hl({},B),{},{x:i0(q.x,B.x,M),y:i0(q.y,B.y,M)})}return h?Hl(Hl({},B),{},{x:i0(g*2,B.x,M),y:i0(p/2,B.y,M)}):Hl(Hl({},B),{},{x:B.x,y:B.y})});return s.current=Z,w.createElement(k$,{props:r,points:Z,clipPathId:t,pathRef:n,strokeDasharray:K})}return M>0&&j>0&&(s.current=i,a.current=U),w.createElement(k$,{props:r,points:i,clipPathId:t,pathRef:n,strokeDasharray:K})}),w.createElement(o9e,{label:r.label}))}function xFe(e){var{clipPathId:t,props:r}=e,n=w.useRef(null),s=w.useRef(0),a=w.useRef(null);return w.createElement(pFe,{props:r,clipPathId:t,previousPointsRef:n,longestAnimatedLengthRef:s,pathRef:a})}var yFe=(e,t)=>({x:e.x,y:e.y,value:e.value,errorVal:el(e.payload,t)});class vFe extends w.Component{render(){var t,{hide:r,dot:n,points:s,className:a,xAxisId:i,yAxisId:o,top:c,left:u,width:d,height:f,id:h,needClip:g}=this.props;if(r)return null;var p=Vs("recharts-line",a),x=h,{r:v=3,strokeWidth:C=2}=(t=oo(n,!1))!==null&&t!==void 0?t:{r:3,strokeWidth:2},b=fY(n),_=v*2+C;return w.createElement(w.Fragment,null,w.createElement(Q1,{className:p},g&&w.createElement("defs",null,w.createElement(X9e,{clipPathId:x,xAxisId:i,yAxisId:o}),!b&&w.createElement("clipPath",{id:"clipPath-dots-".concat(x)},w.createElement("rect",{x:u-_/2,y:c-_/2,width:d+_,height:f+_}))),w.createElement(Y9e,{xAxisId:i,yAxisId:o,data:s,dataPointFormatter:yFe,errorBarOffset:0},w.createElement(xFe,{props:this.props,clipPathId:x}))),w.createElement(U9e,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var mZ={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Z1.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0};function bFe(e){var t=Gc(e,mZ),{activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,connectNulls:o,dot:c,hide:u,isAnimationActive:d,label:f,legendType:h,xAxisId:g,yAxisId:p,id:x}=t,v=jj(t,rFe),{needClip:C}=nZ(g,p),b=Cj(),_=TA(),T=Hc(),N=an(M=>ZPe(M,g,p,T,x));if(_!=="horizontal"&&_!=="vertical"||N==null||b==null)return null;var{height:E,width:F,x:j,y:P}=b;return w.createElement(vFe,cg({},v,{id:x,connectNulls:o,dot:c,activeDot:r,animateNewValues:n,animationBegin:s,animationDuration:a,animationEasing:i,isAnimationActive:d,hide:u,label:f,legendType:h,xAxisId:g,yAxisId:p,points:N,layout:_,height:E,width:F,left:j,top:P,needClip:C}))}function wFe(e){var{layout:t,xAxis:r,yAxis:n,xAxisTicks:s,yAxisTicks:a,dataKey:i,bandSize:o,displayedData:c}=e;return c.map((u,d)=>{var f=el(u,i);if(t==="horizontal"){var h=vL({axis:r,ticks:s,bandSize:o,entry:u,index:d}),g=Ri(f)?null:n.scale(f);return{x:h,y:g,value:f,payload:u}}var p=Ri(f)?null:r.scale(f),x=vL({axis:n,ticks:a,bandSize:o,entry:u,index:d});return p==null||x==null?null:{x:p,y:x,value:f,payload:u}}).filter(Boolean)}function _Fe(e){var t=Gc(e,mZ),r=Hc();return w.createElement(x9e,{id:t.id,type:"line"},n=>w.createElement(w.Fragment,null,w.createElement(f9e,{legendPayload:oFe(t)}),w.createElement(u9e,{fn:lFe,args:t}),w.createElement(S9e,{type:"line",id:n,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),w.createElement(bFe,cg({},t,{id:n}))))}var gZ=w.memo(_Fe);gZ.displayName="Line";var SFe=["dangerouslySetInnerHTML","ticks"],kFe=["id"],CFe=["domain"],TFe=["domain"];function a7(){return a7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},a7.apply(null,arguments)}function gS(e,t){if(e==null)return{};var r,n,s=NFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function NFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function EFe(e){var t=nl();return w.useEffect(()=>(t(E9e(e)),()=>{t(A9e(e))}),[e,t]),null}var AFe=e=>{var{xAxisId:t,className:r}=e,n=an(gX),s=Hc(),a="xAxis",i=an(v=>ax(v,a,t,s)),o=an(v=>hQ(v,a,t,s)),c=an(v=>QNe(v,t)),u=an(v=>sEe(v,t)),d=an(v=>MJ(v,t));if(c==null||u==null||d==null)return null;var{dangerouslySetInnerHTML:f,ticks:h}=e,g=gS(e,SFe),{id:p}=d,x=gS(d,kFe);return w.createElement(Aj,a7({},g,x,{scale:i,x:u.x,y:u.y,width:c.width,height:c.height,className:Vs("recharts-".concat(a," ").concat(a),r),viewBox:n,ticks:o}))},jFe={allowDataOverflow:Ll.allowDataOverflow,allowDecimals:Ll.allowDecimals,allowDuplicatedCategory:Ll.allowDuplicatedCategory,height:Ll.height,hide:!1,mirror:Ll.mirror,orientation:Ll.orientation,padding:Ll.padding,reversed:Ll.reversed,scale:Ll.scale,tickCount:Ll.tickCount,type:Ll.type,xAxisId:0},PFe=e=>{var t,r,n,s,a,i=Gc(e,jFe);return w.createElement(w.Fragment,null,w.createElement(EFe,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),w.createElement(AFe,i))},FFe=(e,t)=>{var{domain:r}=e,n=gS(e,CFe),{domain:s}=t,a=gS(t,TFe);return T1(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:T1({domain:r},{domain:s}):!1},pZ=w.memo(PFe,FFe);pZ.displayName="XAxis";var MFe=["dangerouslySetInnerHTML","ticks"],RFe=["id"],OFe=["domain"],DFe=["domain"];function i7(){return i7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i7.apply(null,arguments)}function pS(e,t){if(e==null)return{};var r,n,s=IFe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function IFe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function LFe(e){var t=nl();return w.useEffect(()=>(t(j9e(e)),()=>{t(P9e(e))}),[e,t]),null}var BFe=e=>{var{yAxisId:t,className:r,width:n,label:s}=e,a=w.useRef(null),i=w.useRef(null),o=an(gX),c=Hc(),u=nl(),d="yAxis",f=an(N=>ax(N,d,t,c)),h=an(N=>oEe(N,t)),g=an(N=>iEe(N,t)),p=an(N=>hQ(N,d,t,c)),x=an(N=>RJ(N,t));if(w.useLayoutEffect(()=>{if(!(n!=="auto"||!h||kj(s)||w.isValidElement(s)||x==null)){var N=a.current;if(N){var E=N.getCalculatedWidth();Math.round(h.width)!==Math.round(E)&&u(F9e({id:t,width:E}))}}},[p,h,u,s,t,n,x]),h==null||g==null||x==null)return null;var{dangerouslySetInnerHTML:v,ticks:C}=e,b=pS(e,MFe),{id:_}=x,T=pS(x,RFe);return w.createElement(Aj,i7({},b,T,{ref:a,labelRef:i,scale:f,x:g.x,y:g.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:h.width,height:h.height,className:Vs("recharts-".concat(d," ").concat(d),r),viewBox:o,ticks:p}))},$Fe={allowDataOverflow:Bl.allowDataOverflow,allowDecimals:Bl.allowDecimals,allowDuplicatedCategory:Bl.allowDuplicatedCategory,hide:!1,mirror:Bl.mirror,orientation:Bl.orientation,padding:Bl.padding,reversed:Bl.reversed,scale:Bl.scale,tickCount:Bl.tickCount,type:Bl.type,width:Bl.width,yAxisId:0},UFe=e=>{var t,r,n,s,a,i=Gc(e,$Fe);return w.createElement(w.Fragment,null,w.createElement(LFe,{interval:(t=i.interval)!==null&&t!==void 0?t:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:(r=i.includeHidden)!==null&&r!==void 0?r:!1,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(n=i.angle)!==null&&n!==void 0?n:0,minTickGap:(s=i.minTickGap)!==null&&s!==void 0?s:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),w.createElement(BFe,i))},zFe=(e,t)=>{var{domain:r}=e,n=pS(e,OFe),{domain:s}=t,a=pS(t,DFe);return T1(n,a)?Array.isArray(r)&&r.length===2&&Array.isArray(s)&&s.length===2?r[0]===s[0]&&r[1]===s[1]:T1({domain:r},{domain:s}):!1},xZ=w.memo(UFe,zFe);xZ.displayName="YAxis";var pC={exports:{}},xC={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var C$;function WFe(){if(C$)return xC;C$=1;var e=dg();function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,s=e.useRef,a=e.useEffect,i=e.useMemo,o=e.useDebugValue;return xC.useSyncExternalStoreWithSelector=function(c,u,d,f,h){var g=s(null);if(g.current===null){var p={hasValue:!1,value:null};g.current=p}else p=g.current;g=i(function(){function v(N){if(!C){if(C=!0,b=N,N=f(N),h!==void 0&&p.hasValue){var E=p.value;if(h(E,N))return _=E}return _=N}if(E=_,r(b,N))return E;var F=f(N);return h!==void 0&&h(E,F)?(b=N,E):(b=N,_=F)}var C=!1,b,_,T=d===void 0?null:d;return[function(){return v(u())},T===null?void 0:function(){return v(T())}]},[u,d,f,h]);var x=n(c,g[0],g[1]);return a(function(){p.hasValue=!0,p.value=x},[x]),o(x),x},xC}var T$;function HFe(){return T$||(T$=1,pC.exports=WFe()),pC.exports}HFe();function GFe(e){e()}function VFe(){let e=null,t=null;return{clear(){e=null,t=null},notify(){GFe(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const s=t={callback:r,next:null,prev:t};return s.prev?s.prev.next=s:e=s,function(){!n||e===null||(n=!1,s.next?s.next.prev=s.prev:t=s.prev,s.prev?s.prev.next=s.next:e=s.next)}}}}var N$={notify(){},get:()=>[]};function qFe(e,t){let r,n=N$,s=0,a=!1;function i(x){d();const v=n.subscribe(x);let C=!1;return()=>{C||(C=!0,v(),f())}}function o(){n.notify()}function c(){p.onStateChange&&p.onStateChange()}function u(){return a}function d(){s++,r||(r=e.subscribe(c),n=VFe())}function f(){s--,r&&s===0&&(r(),r=void 0,n.clear(),n=N$)}function h(){a||(a=!0,d())}function g(){a&&(a=!1,f())}const p={addNestedSub:i,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:h,tryUnsubscribe:g,getListeners:()=>n};return p}var KFe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",YFe=KFe(),XFe=()=>typeof navigator<"u"&&navigator.product==="ReactNative",JFe=XFe(),QFe=()=>YFe||JFe?w.useLayoutEffect:w.useEffect,ZFe=QFe(),eMe=Symbol.for("react-redux-context"),tMe=typeof globalThis<"u"?globalThis:{};function rMe(){if(!w.createContext)return{};const e=tMe[eMe]??=new Map;let t=e.get(w.createContext);return t||(t=w.createContext(null),e.set(w.createContext,t)),t}var nMe=rMe();function sMe(e){const{children:t,context:r,serverState:n,store:s}=e,a=w.useMemo(()=>{const c=qFe(s);return{store:s,subscription:c,getServerState:n?()=>n:void 0}},[s,n]),i=w.useMemo(()=>s.getState(),[s]);ZFe(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==s.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,i]);const o=r||nMe;return w.createElement(o.Provider,{value:a},t)}var aMe=sMe,iMe=(e,t)=>t,Pj=Gt([iMe,qs,AJ,xi,AQ,G0,fAe,lo],xAe),Fj=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},yZ=Uc("mouseClick"),vZ=lb();vZ.startListening({actionCreator:yZ,effect:(e,t)=>{var r=e.payload,n=Pj(t.getState(),Fj(r));n?.activeIndex!=null&&t.dispatch(vEe({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var o7=Uc("mouseMove"),bZ=lb();bZ.startListening({actionCreator:o7,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=mj(n,n.tooltip.settings.shared),a=Pj(n,Fj(r));s==="axis"&&(a?.activeIndex!=null?t.dispatch(_Q({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(wQ()))}});var E$={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},wZ=nc({name:"rootProps",initialState:E$,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:E$.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),oMe=wZ.reducer,{updateOptions:lMe}=wZ.actions,_Z=nc({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:LDe}=_Z.actions,cMe=_Z.reducer,SZ=Uc("keyDown"),kZ=Uc("focus"),Mj=lb();Mj.startListening({actionCreator:SZ,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number(gj(s,ox(r))),o=G0(r);if(a==="Enter"){var c=dS(r,"axis","hover",String(s.index));t.dispatch(Z8({active:!s.active,activeIndex:s.index,activeDataKey:s.dataKey,activeCoordinate:c}));return}var u=dEe(r),d=u==="left-to-right"?1:-1,f=a==="ArrowRight"?1:-1,h=i+f*d;if(!(o==null||h>=o.length||h<0)){var g=dS(r,"axis","hover",String(h));t.dispatch(Z8({active:!0,activeIndex:h.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});Mj.startListening({actionCreator:kZ,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:s}=r.tooltip;if(!s.active&&s.index==null){var a="0",i=dS(r,"axis","hover",String(a));t.dispatch(Z8({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}});var _c=Uc("externalEvent"),CZ=lb();CZ.startListening({actionCreator:_c,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:rAe(r),activeDataKey:eAe(r),activeIndex:T2(r),activeLabel:FQ(r),activeTooltipIndex:T2(r),isTooltipActive:nAe(r)};e.payload.handler(n,e.payload.reactEvent)}}});var uMe=Gt([ix],e=>e.tooltipItemPayloads),dMe=Gt([uMe,yb,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var s=e.find(o=>o.settings.dataKey===n);if(s!=null){var{positions:a}=s;if(a!=null){var i=t(a,r);return i}}}),TZ=Uc("touchMove"),NZ=lb();NZ.startListening({actionCreator:TZ,effect:(e,t)=>{var r=e.payload,n=t.getState(),s=mj(n,n.tooltip.settings.shared);if(s==="axis"){var a=Pj(n,Fj({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));a?.activeIndex!=null&&t.dispatch(_Q({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(s==="item"){var i,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(Hke),d=(i=c.getAttribute(Gke))!==null&&i!==void 0?i:void 0,f=dMe(t.getState(),u,d);t.dispatch(yEe({activeDataKey:d,activeIndex:u,activeCoordinate:f}))}}});var fMe=UY({brush:Q9e,cartesianAxis:M9e,chartData:RAe,errorBars:W9e,graphicalItems:_9e,layout:pke,legend:iCe,options:AAe,polarAxis:c9e,polarOptions:cMe,referenceElements:aPe,rootProps:oMe,tooltip:bEe}),hMe=function(t){return U6e({reducer:fMe,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([vZ.middleware,bZ.middleware,Mj.middleware,CZ.middleware,NZ.middleware]),devTools:Z1.devToolsEnabled})};function mMe(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,s=Hc(),a=w.useRef(null);if(s)return r;a.current==null&&(a.current=hMe(t));var i=vA;return w.createElement(aMe,{context:i,store:a.current},r)}function gMe(e){var{layout:t,width:r,height:n,margin:s}=e,a=nl(),i=Hc();return w.useEffect(()=>{i||(a(hke(t)),a(mke({width:r,height:n})),a(fke(s)))},[a,i,t,r,n,s]),null}function pMe(e){var t=nl();return w.useEffect(()=>{t(lMe(e))},[t,e]),null}var xMe=["children"];function yMe(e,t){if(e==null)return{};var r,n,s=vMe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function vMe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function xS(){return xS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xS.apply(null,arguments)}var bMe={width:"100%",height:"100%"},wMe=w.forwardRef((e,t)=>{var r=xX(),n=yX(),s=bX();if(!Y_(r)||!Y_(n))return null;var{children:a,otherAttributes:i,title:o,desc:c}=e,u,d;return typeof i.tabIndex=="number"?u=i.tabIndex:u=s?0:void 0,typeof i.role=="string"?d=i.role:d=s?"application":void 0,w.createElement(hY,xS({},i,{title:o,desc:c,role:d,tabIndex:u,width:r,height:n,style:bMe,ref:t}),a)}),_Me=e=>{var{children:t}=e,r=an(b3);if(!r)return null;var{width:n,height:s,y:a,x:i}=r;return w.createElement(hY,{width:n,height:s,x:i,y:a},t)},A$=w.forwardRef((e,t)=>{var{children:r}=e,n=yMe(e,xMe),s=Hc();return s?w.createElement(_Me,null,r):w.createElement(wMe,xS({ref:t},n),r)});function SMe(){var e=nl(),[t,r]=w.useState(null),n=an(Wke);return w.useEffect(()=>{if(t!=null){var s=t.getBoundingClientRect(),a=s.width/t.offsetWidth;Su(a)&&a!==n&&e(gke(a))}},[t,e,n]),r}function j$(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),r.push.apply(r,n)}return r}function kMe(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j$(Object(r),!0).forEach(function(n){CMe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j$(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CMe(e,t,r){return(t=TMe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TMe(e){var t=NMe(e,"string");return typeof t=="symbol"?t:t+""}function NMe(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var EMe=w.forwardRef((e,t)=>{var{children:r,className:n,height:s,onClick:a,onContextMenu:i,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:d,onMouseMove:f,onMouseUp:h,onTouchEnd:g,onTouchMove:p,onTouchStart:x,style:v,width:C}=e,b=nl(),[_,T]=w.useState(null),[N,E]=w.useState(null);WAe();var F=SMe(),j=w.useCallback(R=>{F(R),typeof t=="function"&&t(R),T(R),E(R)},[F,t,T,E]),P=w.useCallback(R=>{b(yZ(R)),b(_c({handler:a,reactEvent:R}))},[b,a]),M=w.useCallback(R=>{b(o7(R)),b(_c({handler:u,reactEvent:R}))},[b,u]),I=w.useCallback(R=>{b(wQ()),b(_c({handler:d,reactEvent:R}))},[b,d]),U=w.useCallback(R=>{b(o7(R)),b(_c({handler:f,reactEvent:R}))},[b,f]),K=w.useCallback(()=>{b(kZ())},[b]),te=w.useCallback(R=>{b(SZ(R.key))},[b]),re=w.useCallback(R=>{b(_c({handler:i,reactEvent:R}))},[b,i]),Z=w.useCallback(R=>{b(_c({handler:o,reactEvent:R}))},[b,o]),B=w.useCallback(R=>{b(_c({handler:c,reactEvent:R}))},[b,c]),J=w.useCallback(R=>{b(_c({handler:h,reactEvent:R}))},[b,h]),z=w.useCallback(R=>{b(_c({handler:x,reactEvent:R}))},[b,x]),q=w.useCallback(R=>{b(TZ(R)),b(_c({handler:p,reactEvent:R}))},[b,p]),H=w.useCallback(R=>{b(_c({handler:g,reactEvent:R}))},[b,g]);return w.createElement(LQ.Provider,{value:_},w.createElement(s5e.Provider,{value:N},w.createElement("div",{className:Vs("recharts-wrapper",n),style:kMe({position:"relative",cursor:"default",width:C,height:s},v),onClick:P,onContextMenu:re,onDoubleClick:Z,onFocus:K,onKeyDown:te,onMouseDown:B,onMouseEnter:M,onMouseLeave:I,onMouseMove:U,onMouseUp:J,onTouchEnd:H,onTouchMove:q,onTouchStart:z,ref:j},r)))}),AMe=["children","className","width","height","style","compact","title","desc"];function jMe(e,t){if(e==null)return{};var r,n,s=PMe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function PMe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var FMe=w.forwardRef((e,t)=>{var{children:r,className:n,width:s,height:a,style:i,compact:o,title:c,desc:u}=e,d=jMe(e,AMe),f=Sg(d);return o?w.createElement(A$,{otherAttributes:f,title:c,desc:u},r):w.createElement(EMe,{className:n,style:i,width:s,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},w.createElement(A$,{otherAttributes:f,title:c,desc:u,ref:t},w.createElement(oPe,null,r)))}),MMe=["width","height"];function l7(){return l7=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},l7.apply(null,arguments)}function RMe(e,t){if(e==null)return{};var r,n,s=OMe(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}function OMe(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var DMe={top:5,right:5,bottom:5,left:5},IMe={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:DMe,reverseStackOrder:!1,syncMethod:"index"},LMe=w.forwardRef(function(t,r){var n,s=Gc(t.categoricalChartProps,IMe),{width:a,height:i}=s,o=RMe(s,MMe);if(!Y_(a)||!Y_(i))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,categoricalChartProps:h}=t,g={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:d,tooltipPayloadSearcher:f,eventEmitter:void 0};return w.createElement(mMe,{preloadedState:{options:g},reduxStoreName:(n=h.id)!==null&&n!==void 0?n:c},w.createElement(J9e,{chartData:h.data}),w.createElement(gMe,{width:a,height:i,layout:s.layout,margin:s.margin}),w.createElement(pMe,{accessibilityLayer:s.accessibilityLayer,barCategoryGap:s.barCategoryGap,maxBarSize:s.maxBarSize,stackOffset:s.stackOffset,barGap:s.barGap,barSize:s.barSize,syncId:s.syncId,syncMethod:s.syncMethod,className:s.className}),w.createElement(FMe,l7({},o,{width:a,height:i,ref:r})))}),BMe=["axis"],$Me=w.forwardRef((e,t)=>w.createElement(LMe,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:BMe,tooltipPayloadSearcher:NAe,categoricalChartProps:e,ref:t}));const UMe=({data:e=[],loading:t=!1,error:r=null})=>{if(t)return l.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"400px"},children:l.jsx("div",{className:"spinner-border text-primary",role:"status",children:l.jsx("span",{className:"visually-hidden",children:"Loading..."})})});if(r)return l.jsxs("div",{className:"alert alert-danger",role:"alert",children:[l.jsx("h5",{className:"alert-heading",children:"Error Loading Performance Data"}),l.jsx("p",{children:r})]});if(!e||e.length===0)return l.jsx("div",{className:"text-center text-muted",style:{height:"400px",display:"flex",alignItems:"center",justifyContent:"center"},children:l.jsxs("div",{children:[l.jsx("h5",{children:"No Test Data Available"}),l.jsx("p",{children:"No tests have been completed yet for the current term."})]})});const n=e.map(s=>({testName:s.test_name,testDate:s.submitted_at,averageScore:parseFloat(s.average_score),totalStudents:s.total_students,testId:s.test_id}));return l.jsxs("div",{className:"test-performance-graph",children:[l.jsx("div",{style:{width:"100%",height:"400px"},children:l.jsx(oje,{children:l.jsxs($Me,{data:n,margin:{top:20,right:30,left:20,bottom:20},children:[l.jsx(lZ,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),l.jsx(pZ,{dataKey:"testDate",tickFormatter:s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric"}),stroke:"#666",fontSize:12}),l.jsx(xZ,{domain:[0,100],tickFormatter:s=>`${s}%`,stroke:"#666",fontSize:12}),l.jsx(JAe,{formatter:(s,a)=>[`${parseFloat(s).toFixed(1)}%`,"Average Score"],labelFormatter:s=>{const a=n.find(i=>i.testDate===s);if(a){const i=new Date(s);return`${a.testName} (${i.toLocaleDateString("en-US",{month:"long",day:"numeric"})})`}return s},contentStyle:{backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"}}),l.jsx(gZ,{type:"monotone",dataKey:"averageScore",stroke:"#007bff",strokeWidth:3,connectNulls:!0,dot:{r:6,fill:"#007bff",stroke:"#fff",strokeWidth:2},activeDot:{r:8,fill:"#ff6b35",stroke:"#fff",strokeWidth:2}})]})})}),l.jsx("div",{className:"mt-3",children:l.jsxs("div",{className:"row",children:[l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Total Tests: "}),l.jsx("strong",{children:n.length})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Average Score: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(i=>i.averageScore!==null&&i.averageScore!==void 0&&!isNaN(i.averageScore));return s.length===0?"N/A":`${(s.reduce((i,o)=>i+o.averageScore,0)/s.length).toFixed(1)}%`})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Best Test: "}),l.jsx("strong",{children:n.length>0?(()=>{const s=n.filter(a=>a.averageScore!==null&&a.averageScore!==void 0&&!isNaN(a.averageScore));return s.length===0?"N/A":s.reduce((a,i)=>i.averageScore>a.averageScore?i:a).testName})():"N/A"})]})}),l.jsx("div",{className:"col-md-3",children:l.jsxs("div",{className:"text-center",children:[l.jsx("span",{className:"text-muted",children:"Latest Test: "}),l.jsx("strong",{children:n.length>0?n[n.length-1].testName:"N/A"})]})})]})})]})};var Ep={},yC,P$;function zMe(){return P$||(P$=1,yC=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),yC}var vC={},Of={},F$;function Ng(){if(F$)return Of;F$=1;let e;const t=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return Of.getSymbolSize=function(n){if(!n)throw new Error('"version" cannot be null or undefined');if(n<1||n>40)throw new Error('"version" should be in range from 1 to 40');return n*4+17},Of.getSymbolTotalCodewords=function(n){return t[n]},Of.getBCHDigit=function(r){let n=0;for(;r!==0;)n++,r>>>=1;return n},Of.setToSJISFunction=function(n){if(typeof n!="function")throw new Error('"toSJISFunc" is not a valid function.');e=n},Of.isKanjiModeEnabled=function(){return typeof e<"u"},Of.toSJIS=function(n){return e(n)},Of}var bC={},M$;function Rj(){return M$||(M$=1,(function(e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2};function t(r){if(typeof r!="string")throw new Error("Param is not a string");switch(r.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+r)}}e.isValid=function(n){return n&&typeof n.bit<"u"&&n.bit>=0&&n.bit<4},e.from=function(n,s){if(e.isValid(n))return n;try{return t(n)}catch{return s}}})(bC)),bC}var wC,R$;function WMe(){if(R$)return wC;R$=1;function e(){this.buffer=[],this.length=0}return e.prototype={get:function(t){const r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)===1},put:function(t,r){for(let n=0;n<r;n++)this.putBit((t>>>r-n-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}},wC=e,wC}var _C,O$;function HMe(){if(O$)return _C;O$=1;function e(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}return e.prototype.set=function(t,r,n,s){const a=t*this.size+r;this.data[a]=n,s&&(this.reservedBit[a]=!0)},e.prototype.get=function(t,r){return this.data[t*this.size+r]},e.prototype.xor=function(t,r,n){this.data[t*this.size+r]^=n},e.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]},_C=e,_C}var SC={},D$;function GMe(){return D$||(D$=1,(function(e){const t=Ng().getSymbolSize;e.getRowColCoords=function(n){if(n===1)return[];const s=Math.floor(n/7)+2,a=t(n),i=a===145?26:Math.ceil((a-13)/(2*s-2))*2,o=[a-7];for(let c=1;c<s-1;c++)o[c]=o[c-1]-i;return o.push(6),o.reverse()},e.getPositions=function(n){const s=[],a=e.getRowColCoords(n),i=a.length;for(let o=0;o<i;o++)for(let c=0;c<i;c++)o===0&&c===0||o===0&&c===i-1||o===i-1&&c===0||s.push([a[o],a[c]]);return s}})(SC)),SC}var kC={},I$;function VMe(){if(I$)return kC;I$=1;const e=Ng().getSymbolSize,t=7;return kC.getPositions=function(n){const s=e(n);return[[0,0],[s-t,0],[0,s-t]]},kC}var CC={},L$;function qMe(){return L$||(L$=1,(function(e){e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const t={N1:3,N2:3,N3:40,N4:10};e.isValid=function(s){return s!=null&&s!==""&&!isNaN(s)&&s>=0&&s<=7},e.from=function(s){return e.isValid(s)?parseInt(s,10):void 0},e.getPenaltyN1=function(s){const a=s.size;let i=0,o=0,c=0,u=null,d=null;for(let f=0;f<a;f++){o=c=0,u=d=null;for(let h=0;h<a;h++){let g=s.get(f,h);g===u?o++:(o>=5&&(i+=t.N1+(o-5)),u=g,o=1),g=s.get(h,f),g===d?c++:(c>=5&&(i+=t.N1+(c-5)),d=g,c=1)}o>=5&&(i+=t.N1+(o-5)),c>=5&&(i+=t.N1+(c-5))}return i},e.getPenaltyN2=function(s){const a=s.size;let i=0;for(let o=0;o<a-1;o++)for(let c=0;c<a-1;c++){const u=s.get(o,c)+s.get(o,c+1)+s.get(o+1,c)+s.get(o+1,c+1);(u===4||u===0)&&i++}return i*t.N2},e.getPenaltyN3=function(s){const a=s.size;let i=0,o=0,c=0;for(let u=0;u<a;u++){o=c=0;for(let d=0;d<a;d++)o=o<<1&2047|s.get(u,d),d>=10&&(o===1488||o===93)&&i++,c=c<<1&2047|s.get(d,u),d>=10&&(c===1488||c===93)&&i++}return i*t.N3},e.getPenaltyN4=function(s){let a=0;const i=s.data.length;for(let c=0;c<i;c++)a+=s.data[c];return Math.abs(Math.ceil(a*100/i/5)-10)*t.N4};function r(n,s,a){switch(n){case e.Patterns.PATTERN000:return(s+a)%2===0;case e.Patterns.PATTERN001:return s%2===0;case e.Patterns.PATTERN010:return a%3===0;case e.Patterns.PATTERN011:return(s+a)%3===0;case e.Patterns.PATTERN100:return(Math.floor(s/2)+Math.floor(a/3))%2===0;case e.Patterns.PATTERN101:return s*a%2+s*a%3===0;case e.Patterns.PATTERN110:return(s*a%2+s*a%3)%2===0;case e.Patterns.PATTERN111:return(s*a%3+(s+a)%2)%2===0;default:throw new Error("bad maskPattern:"+n)}}e.applyMask=function(s,a){const i=a.size;for(let o=0;o<i;o++)for(let c=0;c<i;c++)a.isReserved(c,o)||a.xor(c,o,r(s,c,o))},e.getBestMask=function(s,a){const i=Object.keys(e.Patterns).length;let o=0,c=1/0;for(let u=0;u<i;u++){a(u),e.applyMask(u,s);const d=e.getPenaltyN1(s)+e.getPenaltyN2(s)+e.getPenaltyN3(s)+e.getPenaltyN4(s);e.applyMask(u,s),d<c&&(c=d,o=u)}return o}})(CC)),CC}var w4={},B$;function EZ(){if(B$)return w4;B$=1;const e=Rj(),t=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],r=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return w4.getBlocksCount=function(s,a){switch(a){case e.L:return t[(s-1)*4+0];case e.M:return t[(s-1)*4+1];case e.Q:return t[(s-1)*4+2];case e.H:return t[(s-1)*4+3];default:return}},w4.getTotalCodewordsCount=function(s,a){switch(a){case e.L:return r[(s-1)*4+0];case e.M:return r[(s-1)*4+1];case e.Q:return r[(s-1)*4+2];case e.H:return r[(s-1)*4+3];default:return}},w4}var TC={},nv={},$$;function KMe(){if($$)return nv;$$=1;const e=new Uint8Array(512),t=new Uint8Array(256);return(function(){let n=1;for(let s=0;s<255;s++)e[s]=n,t[n]=s,n<<=1,n&256&&(n^=285);for(let s=255;s<512;s++)e[s]=e[s-255]})(),nv.log=function(n){if(n<1)throw new Error("log("+n+")");return t[n]},nv.exp=function(n){return e[n]},nv.mul=function(n,s){return n===0||s===0?0:e[t[n]+t[s]]},nv}var U$;function YMe(){return U$||(U$=1,(function(e){const t=KMe();e.mul=function(n,s){const a=new Uint8Array(n.length+s.length-1);for(let i=0;i<n.length;i++)for(let o=0;o<s.length;o++)a[i+o]^=t.mul(n[i],s[o]);return a},e.mod=function(n,s){let a=new Uint8Array(n);for(;a.length-s.length>=0;){const i=a[0];for(let c=0;c<s.length;c++)a[c]^=t.mul(s[c],i);let o=0;for(;o<a.length&&a[o]===0;)o++;a=a.slice(o)}return a},e.generateECPolynomial=function(n){let s=new Uint8Array([1]);for(let a=0;a<n;a++)s=e.mul(s,new Uint8Array([1,t.exp(a)]));return s}})(TC)),TC}var NC,z$;function XMe(){if(z$)return NC;z$=1;const e=YMe();function t(r){this.genPoly=void 0,this.degree=r,this.degree&&this.initialize(this.degree)}return t.prototype.initialize=function(n){this.degree=n,this.genPoly=e.generateECPolynomial(this.degree)},t.prototype.encode=function(n){if(!this.genPoly)throw new Error("Encoder not initialized");const s=new Uint8Array(n.length+this.degree);s.set(n);const a=e.mod(s,this.genPoly),i=this.degree-a.length;if(i>0){const o=new Uint8Array(this.degree);return o.set(a,i),o}return a},NC=t,NC}var EC={},AC={},jC={},W$;function AZ(){return W$||(W$=1,jC.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}),jC}var Yu={},H$;function jZ(){if(H$)return Yu;H$=1;const e="[0-9]+",t="[A-Z $%*+\\-./:]+";let r="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";r=r.replace(/u/g,"\\u");const n="(?:(?![A-Z0-9 $%*+\\-./:]|"+r+`)(?:.|[\r
]))+`;Yu.KANJI=new RegExp(r,"g"),Yu.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),Yu.BYTE=new RegExp(n,"g"),Yu.NUMERIC=new RegExp(e,"g"),Yu.ALPHANUMERIC=new RegExp(t,"g");const s=new RegExp("^"+r+"$"),a=new RegExp("^"+e+"$"),i=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return Yu.testKanji=function(c){return s.test(c)},Yu.testNumeric=function(c){return a.test(c)},Yu.testAlphanumeric=function(c){return i.test(c)},Yu}var G$;function Eg(){return G$||(G$=1,(function(e){const t=AZ(),r=jZ();e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(a,i){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!t.isValid(i))throw new Error("Invalid version: "+i);return i>=1&&i<10?a.ccBits[0]:i<27?a.ccBits[1]:a.ccBits[2]},e.getBestModeForData=function(a){return r.testNumeric(a)?e.NUMERIC:r.testAlphanumeric(a)?e.ALPHANUMERIC:r.testKanji(a)?e.KANJI:e.BYTE},e.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},e.isValid=function(a){return a&&a.bit&&a.ccBits};function n(s){if(typeof s!="string")throw new Error("Param is not a string");switch(s.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+s)}}e.from=function(a,i){if(e.isValid(a))return a;try{return n(a)}catch{return i}}})(AC)),AC}var V$;function JMe(){return V$||(V$=1,(function(e){const t=Ng(),r=EZ(),n=Rj(),s=Eg(),a=AZ(),i=7973,o=t.getBCHDigit(i);function c(h,g,p){for(let x=1;x<=40;x++)if(g<=e.getCapacity(x,p,h))return x}function u(h,g){return s.getCharCountIndicator(h,g)+4}function d(h,g){let p=0;return h.forEach(function(x){const v=u(x.mode,g);p+=v+x.getBitsLength()}),p}function f(h,g){for(let p=1;p<=40;p++)if(d(h,p)<=e.getCapacity(p,g,s.MIXED))return p}e.from=function(g,p){return a.isValid(g)?parseInt(g,10):p},e.getCapacity=function(g,p,x){if(!a.isValid(g))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=s.BYTE);const v=t.getSymbolTotalCodewords(g),C=r.getTotalCodewordsCount(g,p),b=(v-C)*8;if(x===s.MIXED)return b;const _=b-u(x,g);switch(x){case s.NUMERIC:return Math.floor(_/10*3);case s.ALPHANUMERIC:return Math.floor(_/11*2);case s.KANJI:return Math.floor(_/13);case s.BYTE:default:return Math.floor(_/8)}},e.getBestVersionForData=function(g,p){let x;const v=n.from(p,n.M);if(Array.isArray(g)){if(g.length>1)return f(g,v);if(g.length===0)return 1;x=g[0]}else x=g;return c(x.mode,x.getLength(),v)},e.getEncodedBits=function(g){if(!a.isValid(g)||g<7)throw new Error("Invalid QR Code version");let p=g<<12;for(;t.getBCHDigit(p)-o>=0;)p^=i<<t.getBCHDigit(p)-o;return g<<12|p}})(EC)),EC}var PC={},q$;function QMe(){if(q$)return PC;q$=1;const e=Ng(),t=1335,r=21522,n=e.getBCHDigit(t);return PC.getEncodedBits=function(a,i){const o=a.bit<<3|i;let c=o<<10;for(;e.getBCHDigit(c)-n>=0;)c^=t<<e.getBCHDigit(c)-n;return(o<<10|c)^r},PC}var FC={},MC,K$;function ZMe(){if(K$)return MC;K$=1;const e=Eg();function t(r){this.mode=e.NUMERIC,this.data=r.toString()}return t.getBitsLength=function(n){return 10*Math.floor(n/3)+(n%3?n%3*3+1:0)},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(n){let s,a,i;for(s=0;s+3<=this.data.length;s+=3)a=this.data.substr(s,3),i=parseInt(a,10),n.put(i,10);const o=this.data.length-s;o>0&&(a=this.data.substr(s),i=parseInt(a,10),n.put(i,o*3+1))},MC=t,MC}var RC,Y$;function eRe(){if(Y$)return RC;Y$=1;const e=Eg(),t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function r(n){this.mode=e.ALPHANUMERIC,this.data=n}return r.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(s){let a;for(a=0;a+2<=this.data.length;a+=2){let i=t.indexOf(this.data[a])*45;i+=t.indexOf(this.data[a+1]),s.put(i,11)}this.data.length%2&&s.put(t.indexOf(this.data[a]),6)},RC=r,RC}var OC,X$;function tRe(){if(X$)return OC;X$=1;const e=Eg();function t(r){this.mode=e.BYTE,typeof r=="string"?this.data=new TextEncoder().encode(r):this.data=new Uint8Array(r)}return t.getBitsLength=function(n){return n*8},t.prototype.getLength=function(){return this.data.length},t.prototype.getBitsLength=function(){return t.getBitsLength(this.data.length)},t.prototype.write=function(r){for(let n=0,s=this.data.length;n<s;n++)r.put(this.data[n],8)},OC=t,OC}var DC,J$;function rRe(){if(J$)return DC;J$=1;const e=Eg(),t=Ng();function r(n){this.mode=e.KANJI,this.data=n}return r.getBitsLength=function(s){return s*13},r.prototype.getLength=function(){return this.data.length},r.prototype.getBitsLength=function(){return r.getBitsLength(this.data.length)},r.prototype.write=function(n){let s;for(s=0;s<this.data.length;s++){let a=t.toSJIS(this.data[s]);if(a>=33088&&a<=40956)a-=33088;else if(a>=57408&&a<=60351)a-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);a=(a>>>8&255)*192+(a&255),n.put(a,13)}},DC=r,DC}var IC={exports:{}},Q$;function nRe(){return Q$||(Q$=1,(function(e){var t={single_source_shortest_paths:function(r,n,s){var a={},i={};i[n]=0;var o=t.PriorityQueue.make();o.push(n,0);for(var c,u,d,f,h,g,p,x,v;!o.empty();){c=o.pop(),u=c.value,f=c.cost,h=r[u]||{};for(d in h)h.hasOwnProperty(d)&&(g=h[d],p=f+g,x=i[d],v=typeof i[d]>"u",(v||x>p)&&(i[d]=p,o.push(d,p),a[d]=u))}if(typeof s<"u"&&typeof i[s]>"u"){var C=["Could not find a path from ",n," to ",s,"."].join("");throw new Error(C)}return a},extract_shortest_path_from_predecessor_list:function(r,n){for(var s=[],a=n;a;)s.push(a),r[a],a=r[a];return s.reverse(),s},find_path:function(r,n,s){var a=t.single_source_shortest_paths(r,n,s);return t.extract_shortest_path_from_predecessor_list(a,s)},PriorityQueue:{make:function(r){var n=t.PriorityQueue,s={},a;r=r||{};for(a in n)n.hasOwnProperty(a)&&(s[a]=n[a]);return s.queue=[],s.sorter=r.sorter||n.default_sorter,s},default_sorter:function(r,n){return r.cost-n.cost},push:function(r,n){var s={value:r,cost:n};this.queue.push(s),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};e.exports=t})(IC)),IC.exports}var Z$;function sRe(){return Z$||(Z$=1,(function(e){const t=Eg(),r=ZMe(),n=eRe(),s=tRe(),a=rRe(),i=jZ(),o=Ng(),c=nRe();function u(C){return unescape(encodeURIComponent(C)).length}function d(C,b,_){const T=[];let N;for(;(N=C.exec(_))!==null;)T.push({data:N[0],index:N.index,mode:b,length:N[0].length});return T}function f(C){const b=d(i.NUMERIC,t.NUMERIC,C),_=d(i.ALPHANUMERIC,t.ALPHANUMERIC,C);let T,N;return o.isKanjiModeEnabled()?(T=d(i.BYTE,t.BYTE,C),N=d(i.KANJI,t.KANJI,C)):(T=d(i.BYTE_KANJI,t.BYTE,C),N=[]),b.concat(_,T,N).sort(function(F,j){return F.index-j.index}).map(function(F){return{data:F.data,mode:F.mode,length:F.length}})}function h(C,b){switch(b){case t.NUMERIC:return r.getBitsLength(C);case t.ALPHANUMERIC:return n.getBitsLength(C);case t.KANJI:return a.getBitsLength(C);case t.BYTE:return s.getBitsLength(C)}}function g(C){return C.reduce(function(b,_){const T=b.length-1>=0?b[b.length-1]:null;return T&&T.mode===_.mode?(b[b.length-1].data+=_.data,b):(b.push(_),b)},[])}function p(C){const b=[];for(let _=0;_<C.length;_++){const T=C[_];switch(T.mode){case t.NUMERIC:b.push([T,{data:T.data,mode:t.ALPHANUMERIC,length:T.length},{data:T.data,mode:t.BYTE,length:T.length}]);break;case t.ALPHANUMERIC:b.push([T,{data:T.data,mode:t.BYTE,length:T.length}]);break;case t.KANJI:b.push([T,{data:T.data,mode:t.BYTE,length:u(T.data)}]);break;case t.BYTE:b.push([{data:T.data,mode:t.BYTE,length:u(T.data)}])}}return b}function x(C,b){const _={},T={start:{}};let N=["start"];for(let E=0;E<C.length;E++){const F=C[E],j=[];for(let P=0;P<F.length;P++){const M=F[P],I=""+E+P;j.push(I),_[I]={node:M,lastCount:0},T[I]={};for(let U=0;U<N.length;U++){const K=N[U];_[K]&&_[K].node.mode===M.mode?(T[K][I]=h(_[K].lastCount+M.length,M.mode)-h(_[K].lastCount,M.mode),_[K].lastCount+=M.length):(_[K]&&(_[K].lastCount=M.length),T[K][I]=h(M.length,M.mode)+4+t.getCharCountIndicator(M.mode,b))}}N=j}for(let E=0;E<N.length;E++)T[N[E]].end=0;return{map:T,table:_}}function v(C,b){let _;const T=t.getBestModeForData(C);if(_=t.from(b,T),_!==t.BYTE&&_.bit<T.bit)throw new Error('"'+C+'" cannot be encoded with mode '+t.toString(_)+`.
 Suggested mode is: `+t.toString(T));switch(_===t.KANJI&&!o.isKanjiModeEnabled()&&(_=t.BYTE),_){case t.NUMERIC:return new r(C);case t.ALPHANUMERIC:return new n(C);case t.KANJI:return new a(C);case t.BYTE:return new s(C)}}e.fromArray=function(b){return b.reduce(function(_,T){return typeof T=="string"?_.push(v(T,null)):T.data&&_.push(v(T.data,T.mode)),_},[])},e.fromString=function(b,_){const T=f(b,o.isKanjiModeEnabled()),N=p(T),E=x(N,_),F=c.find_path(E.map,"start","end"),j=[];for(let P=1;P<F.length-1;P++)j.push(E.table[F[P]].node);return e.fromArray(g(j))},e.rawSplit=function(b){return e.fromArray(f(b,o.isKanjiModeEnabled()))}})(FC)),FC}var eU;function aRe(){if(eU)return vC;eU=1;const e=Ng(),t=Rj(),r=WMe(),n=HMe(),s=GMe(),a=VMe(),i=qMe(),o=EZ(),c=XMe(),u=JMe(),d=QMe(),f=Eg(),h=sRe();function g(E,F){const j=E.size,P=a.getPositions(F);for(let M=0;M<P.length;M++){const I=P[M][0],U=P[M][1];for(let K=-1;K<=7;K++)if(!(I+K<=-1||j<=I+K))for(let te=-1;te<=7;te++)U+te<=-1||j<=U+te||(K>=0&&K<=6&&(te===0||te===6)||te>=0&&te<=6&&(K===0||K===6)||K>=2&&K<=4&&te>=2&&te<=4?E.set(I+K,U+te,!0,!0):E.set(I+K,U+te,!1,!0))}}function p(E){const F=E.size;for(let j=8;j<F-8;j++){const P=j%2===0;E.set(j,6,P,!0),E.set(6,j,P,!0)}}function x(E,F){const j=s.getPositions(F);for(let P=0;P<j.length;P++){const M=j[P][0],I=j[P][1];for(let U=-2;U<=2;U++)for(let K=-2;K<=2;K++)U===-2||U===2||K===-2||K===2||U===0&&K===0?E.set(M+U,I+K,!0,!0):E.set(M+U,I+K,!1,!0)}}function v(E,F){const j=E.size,P=u.getEncodedBits(F);let M,I,U;for(let K=0;K<18;K++)M=Math.floor(K/3),I=K%3+j-8-3,U=(P>>K&1)===1,E.set(M,I,U,!0),E.set(I,M,U,!0)}function C(E,F,j){const P=E.size,M=d.getEncodedBits(F,j);let I,U;for(I=0;I<15;I++)U=(M>>I&1)===1,I<6?E.set(I,8,U,!0):I<8?E.set(I+1,8,U,!0):E.set(P-15+I,8,U,!0),I<8?E.set(8,P-I-1,U,!0):I<9?E.set(8,15-I-1+1,U,!0):E.set(8,15-I-1,U,!0);E.set(P-8,8,1,!0)}function b(E,F){const j=E.size;let P=-1,M=j-1,I=7,U=0;for(let K=j-1;K>0;K-=2)for(K===6&&K--;;){for(let te=0;te<2;te++)if(!E.isReserved(M,K-te)){let re=!1;U<F.length&&(re=(F[U]>>>I&1)===1),E.set(M,K-te,re),I--,I===-1&&(U++,I=7)}if(M+=P,M<0||j<=M){M-=P,P=-P;break}}}function _(E,F,j){const P=new r;j.forEach(function(te){P.put(te.mode.bit,4),P.put(te.getLength(),f.getCharCountIndicator(te.mode,E)),te.write(P)});const M=e.getSymbolTotalCodewords(E),I=o.getTotalCodewordsCount(E,F),U=(M-I)*8;for(P.getLengthInBits()+4<=U&&P.put(0,4);P.getLengthInBits()%8!==0;)P.putBit(0);const K=(U-P.getLengthInBits())/8;for(let te=0;te<K;te++)P.put(te%2?17:236,8);return T(P,E,F)}function T(E,F,j){const P=e.getSymbolTotalCodewords(F),M=o.getTotalCodewordsCount(F,j),I=P-M,U=o.getBlocksCount(F,j),K=P%U,te=U-K,re=Math.floor(P/U),Z=Math.floor(I/U),B=Z+1,J=re-Z,z=new c(J);let q=0;const H=new Array(U),R=new Array(U);let L=0;const G=new Uint8Array(E.buffer);for(let le=0;le<U;le++){const he=le<te?Z:B;H[le]=G.slice(q,q+he),R[le]=z.encode(H[le]),q+=he,L=Math.max(L,he)}const W=new Uint8Array(P);let Q=0,X,se;for(X=0;X<L;X++)for(se=0;se<U;se++)X<H[se].length&&(W[Q++]=H[se][X]);for(X=0;X<J;X++)for(se=0;se<U;se++)W[Q++]=R[se][X];return W}function N(E,F,j,P){let M;if(Array.isArray(E))M=h.fromArray(E);else if(typeof E=="string"){let re=F;if(!re){const Z=h.rawSplit(E);re=u.getBestVersionForData(Z,j)}M=h.fromString(E,re||40)}else throw new Error("Invalid data");const I=u.getBestVersionForData(M,j);if(!I)throw new Error("The amount of data is too big to be stored in a QR Code");if(!F)F=I;else if(F<I)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+I+`.
`);const U=_(F,j,M),K=e.getSymbolSize(F),te=new n(K);return g(te,F),p(te),x(te,F),C(te,j,0),F>=7&&v(te,F),b(te,U),isNaN(P)&&(P=i.getBestMask(te,C.bind(null,te,j))),i.applyMask(P,te),C(te,j,P),{modules:te,version:F,errorCorrectionLevel:j,maskPattern:P,segments:M}}return vC.create=function(F,j){if(typeof F>"u"||F==="")throw new Error("No input text");let P=t.M,M,I;return typeof j<"u"&&(P=t.from(j.errorCorrectionLevel,t.M),M=u.from(j.version),I=i.from(j.maskPattern),j.toSJISFunc&&e.setToSJISFunction(j.toSJISFunc)),N(F,M,P,I)},vC}var LC={},BC={},tU;function PZ(){return tU||(tU=1,(function(e){function t(r){if(typeof r=="number"&&(r=r.toString()),typeof r!="string")throw new Error("Color should be defined as hex string");let n=r.slice().replace("#","").split("");if(n.length<3||n.length===5||n.length>8)throw new Error("Invalid hex color: "+r);(n.length===3||n.length===4)&&(n=Array.prototype.concat.apply([],n.map(function(a){return[a,a]}))),n.length===6&&n.push("F","F");const s=parseInt(n.join(""),16);return{r:s>>24&255,g:s>>16&255,b:s>>8&255,a:s&255,hex:"#"+n.slice(0,6).join("")}}e.getOptions=function(n){n||(n={}),n.color||(n.color={});const s=typeof n.margin>"u"||n.margin===null||n.margin<0?4:n.margin,a=n.width&&n.width>=21?n.width:void 0,i=n.scale||4;return{width:a,scale:a?4:i,margin:s,color:{dark:t(n.color.dark||"#000000ff"),light:t(n.color.light||"#ffffffff")},type:n.type,rendererOpts:n.rendererOpts||{}}},e.getScale=function(n,s){return s.width&&s.width>=n+s.margin*2?s.width/(n+s.margin*2):s.scale},e.getImageWidth=function(n,s){const a=e.getScale(n,s);return Math.floor((n+s.margin*2)*a)},e.qrToImageData=function(n,s,a){const i=s.modules.size,o=s.modules.data,c=e.getScale(i,a),u=Math.floor((i+a.margin*2)*c),d=a.margin*c,f=[a.color.light,a.color.dark];for(let h=0;h<u;h++)for(let g=0;g<u;g++){let p=(h*u+g)*4,x=a.color.light;if(h>=d&&g>=d&&h<u-d&&g<u-d){const v=Math.floor((h-d)/c),C=Math.floor((g-d)/c);x=f[o[v*i+C]?1:0]}n[p++]=x.r,n[p++]=x.g,n[p++]=x.b,n[p]=x.a}}})(BC)),BC}var rU;function iRe(){return rU||(rU=1,(function(e){const t=PZ();function r(s,a,i){s.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=i,a.width=i,a.style.height=i+"px",a.style.width=i+"px"}function n(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}e.render=function(a,i,o){let c=o,u=i;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),i||(u=n()),c=t.getOptions(c);const d=t.getImageWidth(a.modules.size,c),f=u.getContext("2d"),h=f.createImageData(d,d);return t.qrToImageData(h.data,a,c),r(f,u,d),f.putImageData(h,0,0),u},e.renderToDataURL=function(a,i,o){let c=o;typeof c>"u"&&(!i||!i.getContext)&&(c=i,i=void 0),c||(c={});const u=e.render(a,i,c),d=c.type||"image/png",f=c.rendererOpts||{};return u.toDataURL(d,f.quality)}})(LC)),LC}var $C={},nU;function oRe(){if(nU)return $C;nU=1;const e=PZ();function t(s,a){const i=s.a/255,o=a+'="'+s.hex+'"';return i<1?o+" "+a+'-opacity="'+i.toFixed(2).slice(1)+'"':o}function r(s,a,i){let o=s+a;return typeof i<"u"&&(o+=" "+i),o}function n(s,a,i){let o="",c=0,u=!1,d=0;for(let f=0;f<s.length;f++){const h=Math.floor(f%a),g=Math.floor(f/a);!h&&!u&&(u=!0),s[f]?(d++,f>0&&h>0&&s[f-1]||(o+=u?r("M",h+i,.5+g+i):r("m",c,0),c=0,u=!1),h+1<a&&s[f+1]||(o+=r("h",d),d=0)):c++}return o}return $C.render=function(a,i,o){const c=e.getOptions(i),u=a.modules.size,d=a.modules.data,f=u+c.margin*2,h=c.color.light.a?"<path "+t(c.color.light,"fill")+' d="M0 0h'+f+"v"+f+'H0z"/>':"",g="<path "+t(c.color.dark,"stroke")+' d="'+n(d,u,c.margin)+'"/>',p='viewBox="0 0 '+f+" "+f+'"',v='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+p+' shape-rendering="crispEdges">'+h+g+`</svg>
`;return typeof o=="function"&&o(null,v),v},$C}var sU;function lRe(){if(sU)return Ep;sU=1;const e=zMe(),t=aRe(),r=iRe(),n=oRe();function s(a,i,o,c,u){const d=[].slice.call(arguments,1),f=d.length,h=typeof d[f-1]=="function";if(!h&&!e())throw new Error("Callback required as last argument");if(h){if(f<2)throw new Error("Too few arguments provided");f===2?(u=o,o=i,i=c=void 0):f===3&&(i.getContext&&typeof u>"u"?(u=c,c=void 0):(u=c,c=o,o=i,i=void 0))}else{if(f<1)throw new Error("Too few arguments provided");return f===1?(o=i,i=c=void 0):f===2&&!i.getContext&&(c=o,o=i,i=void 0),new Promise(function(g,p){try{const x=t.create(o,c);g(a(x,i,c))}catch(x){p(x)}})}try{const g=t.create(o,c);u(null,a(g,i,c))}catch(g){u(g)}}return Ep.create=t.create,Ep.toCanvas=s.bind(null,r.render),Ep.toDataURL=s.bind(null,r.renderToDataURL),Ep.toString=s.bind(null,function(a,i,o){return n.render(a,o)}),Ep}var cRe=lRe();const FZ=ec(cRe),uRe=({sessionCode:e,gameName:t,onClose:r,hideCloseButton:n=!1})=>{const s=w.useRef(null),a=`${window.location.origin}/student/duel/${e}`;w.useEffect(()=>{s.current&&e&&FZ.toCanvas(s.current,a,{width:300,margin:2,color:{dark:"#000000",light:"#FFFFFF"}},o=>{o&&console.error("Error generating QR code:",o)})},[e,a]);const i=()=>{navigator.clipboard.writeText(a)};return l.jsx(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:r,children:l.jsxs(Ze.div,{initial:{y:20},animate:{y:0},onClick:o=>o.stopPropagation(),className:"bg-white rounded-lg p-6 max-w-md w-full shadow-2xl",children:[l.jsxs("div",{className:"text-center mb-4",children:[l.jsxs("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:["Join Game: ",t||"Duel Game"]}),l.jsx("p",{className:"text-gray-600 text-sm mb-4",children:"Scan QR code or share link with students"})]}),l.jsxs("div",{className:"flex flex-col items-center mb-4",children:[l.jsx("div",{className:"bg-white p-4 rounded-lg border-2 border-gray-200 mb-4",children:l.jsx("canvas",{ref:s,className:"w-full h-auto"})}),l.jsxs("div",{className:"w-full",children:[l.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2 text-center",children:"Session Code:"}),l.jsx("div",{className:"bg-gray-100 rounded-lg p-3 mb-3",children:l.jsx("p",{className:"text-2xl font-mono font-bold text-center text-gray-800 tracking-widest",children:e})})]}),l.jsxs("div",{className:"w-full",children:[l.jsx("p",{className:"text-sm font-semibold text-gray-700 mb-2 text-center",children:"Game Link:"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:a,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm bg-gray-50"}),l.jsx("button",{onClick:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:"Copy"})]})]})]}),l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:l.jsxs("p",{className:"text-xs text-blue-800 text-center",children:[l.jsx("strong",{children:"Important:"})," Students must be logged in to join the game. They will need to log in first if they haven't already."]})}),!n&&l.jsx("button",{onClick:r,className:"w-full py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Close"})]})})},dRe=({sessionCode:e})=>{const t=Rs.useRef(null);return w.useEffect(()=>{if(t.current&&e){const r=`${window.location.origin}/student/duel/${e}`;FZ.toCanvas(t.current,r,{width:200,margin:2,color:{dark:"#000000",light:"#FFFFFF"}},n=>{n&&console.error("Error generating QR code:",n)})}},[e]),l.jsx("div",{className:"flex justify-center",children:l.jsx("div",{className:"bg-white p-2 rounded-lg border border-gray-200",children:l.jsx("canvas",{ref:t})})})},MZ=({onBackToCabinet:e})=>{const{user:t}=ws(),{showNotification:r}=Ls(),n=Za(),s=ku(),[a,i]=w.useState(!0),[o,c]=w.useState([]),[u,d]=w.useState(!1),[f,h]=w.useState(null),[g,p]=w.useState(null),[x,v]=w.useState(!1),[C,b]=w.useState(!1),[_,T]=w.useState(!1),[N,E]=w.useState(null),[F,j]=w.useState(!1),[P,M]=w.useState([]),[I,U]=w.useState(!1),[K,te]=w.useState([]),[re,Z]=w.useState(!1),[B,J]=w.useState(!1),[z,q]=w.useState(!1),{isConnected:H,sendMessage:R,onMessage:L}=YV(g,t?.teacher_id,"teacher");w.useEffect(()=>{G()},[s.pathname]);const G=async()=>{try{if(i(!0),!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");const Ie=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/get-mini-games",{method:"GET",headers:{"Content-Type":"application/json"}})).json();Ie.success?c(Ie.games):r("Failed to load games","error")}catch(ye){console.error("Error loading games:",ye),r(ye.message||"Failed to load games","error")}finally{i(!1)}},W=ye=>{h(ye),d(!0)},Q=()=>{d(!1),h(null)},X=ye=>{E(ye),T(!0)},se=async()=>{N&&(await le(N),T(!1),E(null),Q())},le=async ye=>{try{if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");(await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/delete-mini-game?game_id=${ye.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"}})).json()).success?(await G(),r("Game deleted successfully","success")):r("Failed to delete game","error")}catch(Ie){console.error("Error deleting game:",Ie),r(Ie.message||"Failed to delete game","error")}},he=async()=>{if(f)try{if(v(!0),!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");const Ie=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-mini-game-session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:f.id})})).json();if(Ie.success){const ut=Ie.session.session_code;p(ut),M([]),j(!0),r(`Game session created! Code: ${ut}`,"success")}else r(Ie.error||"Failed to start game","error")}catch(ye){console.error("Error starting game:",ye),r(ye.message||"Failed to start game","error")}finally{v(!1)}},we=()=>{if(!g||!R){r("Not connected to server. Please wait...","error");return}if(P.length===0){r("No players in lobby yet","warning");return}R("start-game",{sessionCode:g}),U(!0),r("Game started! Students will begin the card phase.","success")},ie=()=>{Z(!0)},Ee=async()=>{if(!g||!R){r("Not connected to server","error");return}R("finish-game",{sessionCode:g}),U(!1),te([]),M([]),p(null),j(!1),Z(!1),r("Game finished. Session closed.","success")};return w.useEffect(()=>{H&&g&&t?.teacher_id&&R&&(console.log("[Teacher] Joining session:",g),R("join-session",{sessionCode:g}))},[H,g,t?.teacher_id,R]),w.useEffect(()=>{if(!L||!g)return;const ye=L("lobby-update",Ge=>{console.log("[Teacher] Lobby update:",Ge),M(Ge.players||[])}),Ie=L("player-joined",Ge=>{console.log("[Teacher] Player joined:",Ge)}),ut=L("game-started",Ge=>{console.log("[Teacher] Game started:",Ge),U(!0)}),Qe=L("game-finished",Ge=>{console.log("[Teacher] Game finished:",Ge),U(!1),te([]),M([]),p(null),j(!1),r("Game finished successfully","success")}),$t=L("player-stats-update",Ge=>{console.log("[Teacher] Player stats update:",Ge),te(Ge.stats||[])});return()=>{ye(),Ie(),ut(),$t(),Qe()}},[L,g]),a?l.jsx(Kt,{children:l.jsx("div",{className:"flex justify-center items-center p-8",children:l.jsx(Xr,{})})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h2",{className:"text-2xl font-bold",children:"Mini Games"}),l.jsx(at,{onClick:()=>n("/teacher/minigames/create"),children:"+ Create New Game"})]}),o.length===0?l.jsx(Kt,{children:l.jsxs("div",{className:"text-center p-8 text-gray-500",children:[l.jsx("p",{children:"No games created yet."}),l.jsx(at,{onClick:()=>n("/teacher/minigames/create"),className:"mt-4",children:"Create Your First Game"})]})}):l.jsx("div",{className:"space-y-3",children:o.map(ye=>l.jsx(Kt,{className:"p-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:ye.game_name}),ye.is_active&&l.jsx("span",{className:"px-2 py-1 text-xs bg-green-100 text-green-800 rounded font-medium",children:"Active"}),!ye.is_active&&l.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded font-medium",children:"Inactive"})]}),l.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[ye.topic,"  ",ye.question_count||0," questions"]})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(at,{onClick:()=>W(ye),variant:"outline",size:"sm",children:"Details"}),g&&f?.id===ye.id?l.jsx(at,{onClick:()=>{h(ye),j(!0)},size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:"Session Active"}):l.jsx(at,{onClick:()=>{h(ye),he()},disabled:x||!ye.is_active,size:"sm",children:x&&f?.id===ye.id?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm"}),l.jsx("span",{className:"ml-1",children:"Creating..."})]}):"Start"}),l.jsx(at,{onClick:()=>X(ye),variant:"destructive",size:"sm",className:"bg-red-600 hover:bg-red-700 text-white",children:"Delete"})]})]})},ye.id))}),u&&f&&l.jsx(Ds,{isOpen:u,onClose:Q,title:f.game_name,children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Topic"}),l.jsx("p",{className:"text-gray-900",children:f.topic||"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Grade"}),l.jsxs("p",{className:"text-gray-900",children:["Grade ",f.grade]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Class"}),l.jsx("p",{className:"text-gray-900",children:f.class===0?"All Classes":`Class ${f.class}`})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Game Type"}),l.jsx("p",{className:"text-gray-900 capitalize",children:f.game_type?.replace("_"," ")||"N/A"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Questions"}),l.jsxs("p",{className:"text-gray-900",children:[f.question_count||0," questions"]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Status"}),l.jsx("p",{className:"text-gray-900",children:l.jsx("span",{className:`px-2 py-1 text-xs rounded ${f.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:f.is_active?"Active":"Inactive"})})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Created"}),l.jsx("p",{className:"text-gray-900",children:new Date(f.created_at).toLocaleDateString()})]})]}),g&&l.jsxs(Ze.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},className:"p-4 bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg",children:[l.jsx("p",{className:"font-semibold mb-2 text-green-800",children:"Game Session Active!"}),l.jsx("p",{className:"text-2xl font-mono font-bold text-center mb-3 text-green-600 tracking-widest",children:g}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(at,{onClick:()=>{navigator.clipboard.writeText(g),r("Session code copied!","success")},variant:"outline",size:"sm",className:"flex-1",children:"Copy Code"}),l.jsx(at,{onClick:()=>b(!0),variant:"outline",size:"sm",className:"flex-1",children:"Show QR Code"})]}),H&&l.jsx("p",{className:"text-xs text-green-600 mt-2 text-center",children:" Connected to game server"})]})]})}),_&&N&&l.jsx(Ds,{isOpen:_,onClose:()=>{T(!1),E(null)},title:"Delete Game",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-700",children:["Are you sure you want to delete ",l.jsxs("strong",{children:['"',N.game_name,'"']}),"?"]}),l.jsx("p",{className:"text-sm text-gray-500",children:"This action cannot be undone. All questions and game data will be permanently deleted."}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx(at,{onClick:()=>{T(!1),E(null)},variant:"outline",className:"flex-1",children:"Cancel"}),l.jsx(at,{onClick:se,variant:"destructive",className:"flex-1",children:"Delete"})]})]})}),F&&g&&f&&l.jsx(Ds,{isOpen:F,onClose:()=>{j(!1),J(!1),q(!1)},title:`Start Game: ${f.game_name}`,size:"large",className:B?"h-[95vh] max-w-[95vw]":"max-h-[90vh] max-w-[90vw]",children:l.jsxs("div",{className:`space-y-4 overflow-y-auto pr-2 custom-scrollbar ${B?"h-[calc(95vh-120px)]":"max-h-[calc(90vh-120px)]"}`,children:[l.jsxs("div",{className:"text-center",children:[l.jsx("label",{className:"text-sm font-medium text-gray-500 block mb-2",children:"Session Code"}),l.jsx("p",{className:"text-3xl font-mono font-bold text-green-600 tracking-widest mb-4",children:g}),l.jsx(at,{onClick:()=>{navigator.clipboard.writeText(g),r("Session code copied!","success")},variant:"outline",size:"sm",children:"Copy Code"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"text-sm font-medium text-gray-500 block mb-2",children:"Game Link"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{type:"text",value:`${window.location.origin}/student/duel/${g}`,readOnly:!0,className:"flex-1 px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-sm"}),l.jsx(at,{onClick:()=>{const ye=`${window.location.origin}/student/duel/${g}`;navigator.clipboard.writeText(ye),r("Game link copied!","success")},variant:"outline",size:"sm",children:"Copy"})]})]}),l.jsx(dRe,{sessionCode:g}),l.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Students in Lobby"}),l.jsx("span",{className:"text-lg font-bold text-blue-600",children:P.length})]}),P.length>0&&l.jsx("div",{className:"mt-2 space-y-1 max-h-32 overflow-y-auto",children:P.map((ye,Ie)=>l.jsxs("div",{className:"text-sm text-gray-600",children:[" ",ye.studentNickname||ye.studentName||ye.studentId,ye.selectedCharacter&&l.jsxs("span",{className:"text-gray-400 ml-2 capitalize",children:["(",ye.selectedCharacter,")"]})]},ye.studentId||Ie))}),P.length===0&&l.jsx("p",{className:"text-sm text-gray-500 italic",children:"Waiting for students to join..."})]}),H?l.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),l.jsx("span",{children:"Connected to game server"})]}):l.jsxs("div",{className:"flex items-center gap-2 text-sm text-yellow-600",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),l.jsx("span",{children:"Connecting to server..."})]}),I&&K.length>0&&l.jsxs("div",{className:"pt-4 border-t",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Live Leaderboard"}),l.jsx("button",{onClick:()=>q(!z),className:"p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors","aria-label":z?"Exit leaderboard fullscreen":"Fullscreen leaderboard",title:z?"Exit fullscreen":"Fullscreen leaderboard",children:z?l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})})]}),l.jsx("div",{className:`space-y-2 overflow-y-auto custom-scrollbar ${z?"max-h-[70vh]":"max-h-64"}`,children:K.sort((ye,Ie)=>Ie.correctAnswers!==ye.correctAnswers?Ie.correctAnswers-ye.correctAnswers:(Ie.damageDealt||0)-(ye.damageDealt||0)).map((ye,Ie)=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-yellow-400 text-gray-900 font-bold text-sm",children:Ie+1}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-gray-900",children:ye.studentNickname||ye.studentName||ye.studentId}),ye.selectedCharacter&&l.jsx("p",{className:"text-xs text-gray-500 capitalize",children:ye.selectedCharacter})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"flex gap-4 text-sm",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"XP:"}),l.jsx("span",{className:"font-semibold text-green-600 ml-1",children:ye.correctAnswers*10||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Dealt:"}),l.jsx("span",{className:"font-semibold text-blue-600 ml-1",children:ye.damageDealt||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Taken:"}),l.jsx("span",{className:"font-semibold text-red-600 ml-1",children:ye.damageReceived||0})]})]}),l.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[ye.correctAnswers||0," / 3 cards correct"]})]})]},ye.studentId))})]}),l.jsx("div",{className:"pt-4 border-t",children:I?l.jsx(at,{onClick:ie,className:"w-full bg-red-600 hover:bg-red-700 text-white",size:"lg",children:"Finish Game"}):l.jsxs(l.Fragment,{children:[l.jsx(at,{onClick:we,disabled:!H||P.length===0,className:"w-full bg-green-600 hover:bg-green-700 text-white",size:"lg",children:P.length===0?"Waiting for players...":`Start Game (${P.length} ${P.length===1?"player":"players"} ready)`}),P.length===0&&l.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:"Students need to join and select characters first"})]})})]})}),re&&l.jsx(Ds,{isOpen:re,onClose:()=>Z(!1),title:"Finish Game",children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("p",{className:"text-gray-700",children:"Are you sure you want to finish the game? This will close the session and disconnect all players."}),l.jsx("p",{className:"text-sm text-gray-500",children:"All game progress will be saved, but players will be disconnected from the game."}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx(at,{onClick:()=>Z(!1),variant:"outline",className:"flex-1",children:"Cancel"}),l.jsx(at,{onClick:Ee,variant:"destructive",className:"flex-1 bg-red-600 hover:bg-red-700 text-white",children:"Finish Game"})]})]})}),C&&g&&l.jsx(uRe,{sessionCode:g,gameName:f?.game_name,onClose:()=>b(!1)}),z&&I&&K.length>0&&l.jsx(Ds,{isOpen:z,onClose:()=>q(!1),title:"Live Leaderboard",size:"large",className:"h-[90vh] flex flex-col",children:l.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar pr-2",children:l.jsx("div",{className:"space-y-2",children:K.sort((ye,Ie)=>Ie.correctAnswers!==ye.correctAnswers?Ie.correctAnswers-ye.correctAnswers:(Ie.damageDealt||0)-(ye.damageDealt||0)).map((ye,Ie)=>l.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-yellow-400 text-gray-900 font-bold text-lg",children:Ie+1}),l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-lg text-gray-900",children:ye.studentNickname||ye.studentName||ye.studentId}),ye.selectedCharacter&&l.jsx("p",{className:"text-sm text-gray-500 capitalize",children:ye.selectedCharacter})]})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("div",{className:"flex gap-6 text-base",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"XP:"}),l.jsx("span",{className:"font-semibold text-green-600 ml-2",children:ye.correctAnswers*10||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Dealt:"}),l.jsx("span",{className:"font-semibold text-blue-600 ml-2",children:ye.damageDealt||0})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-gray-500",children:"Taken:"}),l.jsx("span",{className:"font-semibold text-red-600 ml-2",children:ye.damageReceived||0})]})]}),l.jsxs("p",{className:"text-sm text-gray-400 mt-2",children:[ye.correctAnswers||0," / 3 cards correct"]})]})]},ye.studentId))})})})]})},aU=({onBackToLogin:e})=>{const t=Za(),r=ku(),{user:n,isAuthenticated:s,logout:a,getCurrentTeacherUsername:i}=ws(),{teacherData:o,loadTeacherData:c}=XS(),{activeTests:u,loadActiveTests:d}=J2(),{showNotification:f,notifications:h,removeNotification:g}=Ls(),[p,x]=w.useState(!0),[v,C]=w.useState(""),[b,_]=w.useState(r.state?.view||"main"),[T,N]=w.useState([]),[E,F]=w.useState([]),[j,P]=w.useState(null),[M,I]=w.useState(null),[U,K]=w.useState(null),[te,re]=w.useState(!1),[Z,B]=w.useState(!1),[J,z]=w.useState(null),[q,H]=w.useState([]),[R,L]=w.useState(null),[G,W]=w.useState(!1),[Q,X]=w.useState(!1),[se,le]=w.useState(null),[he,we]=w.useState(!1),[ie,Ee]=w.useState(null),[ye,Ie]=w.useState(null),[ut,Qe]=w.useState([]),[$t,Ge]=w.useState(!1),[et,vt]=w.useState(null),[Te,Ve]=w.useState([]),[pt,wt]=w.useState(!1),[Ut,ct]=w.useState(null),[yt,rt]=w.useState(null),[Oe,$e]=w.useState(!1),[Mt,It]=w.useState(!1),[At,tr]=w.useState(0),[ar,dr]=w.useState(!1),[or,mr]=w.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[ve,Fe]=w.useState([]),[Be,Pe]=w.useState([]),[lt,Ct]=w.useState(!1),[Lt,Ue]=w.useState(!1),[st,dt]=w.useState(null),[Bt,Yt]=w.useState([]),[xr,Rr]=w.useState(!1),[yr,Br]=w.useState("subject");w.useEffect(()=>{ot()},[]),w.useEffect(()=>{r.state?.view&&(_(r.state.view),t(r.pathname,{replace:!0,state:{}}))},[r.state,t,r.pathname]),w.useEffect(()=>{const qe=Re=>{Oe&&!Re.target.closest(".relative")&&$e(!1),Mt&&!Re.target.closest(".relative")&&It(!1)};return document.addEventListener("mousedown",qe),()=>{document.removeEventListener("mousedown",qe)}},[Oe,Mt]);const me=w.useCallback(()=>{_e.debug(" showChangePasswordTab called"),dr(!0),$e(!1),It(!1)},[]),Ne=w.useCallback(()=>{_e.debug(" hideChangePasswordTab called"),dr(!1),mr({currentPassword:"",newPassword:"",confirmPassword:""})},[]),be=w.useCallback(async()=>{if(!n)return;const{currentPassword:qe,newPassword:Re,confirmPassword:Ye}=or;if(!qe||!Re||!Ye){f("Please fill in all fields","error");return}if(Re!==Ye){f("New passwords do not match","error");return}if(Re.length<6){f("New password must be at least 6 characters long","error");return}const Tt=/[a-zA-Z]/.test(Re),St=/[0-9]/.test(Re);if(!Tt||!St){f("New password must contain both letters and numbers","error");return}try{const Cr=await Xs.changePassword({username:n.username,currentPassword:qe,newPassword:Re});Cr.success?(f("Password changed successfully!","success"),Ne()):f(Cr.message||"Failed to change password","error")}catch(Cr){_e.error("Password change error:",Cr),f("Failed to change password. Please try again.","error")}},[n,or,f]),Ae=w.useCallback(qe=>{const{name:Re,value:Ye}=qe.target;mr(Tt=>({...Tt,[Re]:Ye}))},[]),ue=w.useCallback(async()=>{_e.debug(" Loading teacher data...");try{const qe=await Xs.getTeacherData();return _e.debug(" Teacher data loaded:",qe),Ie(new Date),qe}catch(qe){throw _e.error(" Error loading teacher data:",qe),qe}},[]),ge=w.useCallback(async(qe=null)=>{_e.debug(" Loading teacher subjects...");try{if(!qe){const Tt=`teacher_subjects_${n?.teacher_id||n?.id||""}`,St=Os(Tt);if(St)return _e.debug(" Using cached teacher subjects"),N(St),St}let Re=qe,Ye;if(qe?(_e.debug(" Using passed teacher data for subjects"),Ye=Xs.getTeacherSubjects(qe.subjects)):(_e.debug(" No teacher data passed, fetching from API"),Re=await Xs.getTeacherData(),_e.debug(" Raw teacher data:",Re),Ye=Xs.getTeacherSubjects(Re.subjects)),_e.debug(" Teacher subjects loaded:",Ye),N(Ye),!qe){const Tt=`teacher_subjects_${n?.teacher_id||n?.id||""}`;vs(Tt,Ye,hs.teacher_subjects)}return _e.debug(" Available classes for performance chart:",Ye[0]?.classes||[]),_e.debug(" Performance chart will load when user clicks on a class"),Ye}catch(Re){throw _e.error(" Error loading teacher subjects:",Re),Re}},[n?.teacher_id,n?.id]),Me=w.useCallback(async()=>{_e.debug(" Loading teacher active tests...");try{const qe=`teacher_tests_${n?.teacher_id||n?.id||""}`,Re=Os(qe);Re&&Re.some(St=>St.test_type==="drawing")&&(_e.debug(" Drawing test detected - forcing cache refresh"),localStorage.removeItem(qe));const Ye=Os(qe);if(Ye)return _e.debug(" Using cached teacher tests"),F(Ye),Ye;const Tt=await Pn.getTeacherTests();return _e.debug(" Teacher tests loaded:",Tt),F(Tt),vs(qe,Tt,hs.teacher_tests),Tt}catch(qe){throw _e.error(" Error loading teacher tests:",qe),qe}},[n?.teacher_id,n?.id]),ot=w.useCallback(async()=>{_e.debug(" Initializing Teacher Cabinet...");try{if(x(!0),C(""),!s||!n){_e.debug(" User not authenticated"),C("User not authenticated");return}if(n.role!==Ko.TEACHER){_e.error(" Invalid user role for teacher cabinet:",n.role),C("Access denied. Teacher role required.");return}_e.debug(" Loading teacher data...");const qe=await ue();_e.debug(" Loading subjects and tests in parallel...");const[Re,Ye]=await Promise.allSettled([ge(qe),Me()]);let Tt=!1;Re.status==="rejected"&&(_e.warn(" Subjects loading failed:",Re.reason),Tt=!0),Ye.status==="rejected"&&(_e.warn(" Tests loading failed:",Ye.reason),Tt=!0),Tt&&f("Some data failed to load, but you can continue","warning"),_e.debug(" Teacher Cabinet initialization complete!")}catch(qe){_e.error(" Error initializing teacher cabinet:",qe),C("Failed to initialize teacher cabinet")}finally{x(!1)}},[s,n,ue,ge,Me,f]),Je=w.useCallback(()=>{_e.debug(" Showing subject selection prompt..."),re(!0),nt(),Br("subject")},[]),nt=w.useCallback(async()=>{_e.debug(" Loading available subjects..."),Ct(!0);try{const qe=await Xs.getSubjectsForSelection();Fe(qe),_e.debug(" Available subjects loaded:",qe)}catch(qe){_e.error(" Error loading available subjects:",qe),f("Failed to load subjects","error")}finally{Ct(!1)}},[]),mt=w.useCallback(qe=>{if(!qe){dt(null);return}const Re=ve.find(Ye=>Ye.subject_id==qe);Re&&(dt(Re),Yt([]),Br("classes"))},[ve]),de=w.useCallback((qe,Re)=>{Yt(Ye=>Ye.some(Tt=>Tt.grade===qe&&Tt.class===Re)?Ye.filter(Tt=>!(Tt.grade===qe&&Tt.class===Re)):[...Ye,{grade:qe,class:Re}])},[]),Se=w.useCallback(()=>{if(!st||Bt.length===0){f("Please select at least one class","warning");return}const qe={subject_id:parseInt(st.subject_id),subject_name:st.subject,classes:Bt};Pe(Re=>[...Re,qe]),dt(null),Yt([]),Br("subject"),f(`Added ${st.subject} with ${Bt.length} classes`,"success")},[st,Bt]),De=w.useCallback(qe=>{Pe(Re=>Re.filter((Ye,Tt)=>Tt!==qe))},[]),Le=w.useCallback(async(qe,Re,Ye)=>{_e.debug(" Deleting teacher subject:",{subjectId:qe,grade:Re,classNumber:Ye});try{const Tt={subjectId:qe,grade:Re,class:Ye};_e.debug(" Sending delete request with data:",Tt);const St=await Xs.deleteTeacherSubject(Tt);if(St.success)f("Subject assignment deleted successfully!","success"),await ge();else throw new Error(St.error||"Failed to delete subject assignment")}catch(Tt){_e.error(" Error deleting subject assignment:",Tt),f("Error deleting subject assignment. Please try again.","error")}},[ge,f]),tt=w.useCallback((qe,Re,Ye,Tt)=>{Ee({subjectId:qe,subjectName:Re,grade:Ye,classNumber:Tt}),we(!0)},[]),qt=w.useCallback(async()=>{ie&&(await Le(ie.subjectId,ie.grade,ie.classNumber),we(!1),Ee(null))},[ie,Le]),kr=w.useCallback(()=>{we(!1),Ee(null)},[]),jr=w.useCallback(async()=>{if(Be.length===0){f("Please select at least one subject","warning");return}Ue(!0);try{const qe=await Xs.saveTeacherSubjects(Be);if(qe.success)f("Subjects saved successfully!","success"),re(!1),Pe([]),Br("subject"),await ge();else throw new Error(qe.error||"Failed to save subjects")}catch(qe){_e.error(" Error saving teacher subjects:",qe),f("Failed to save subjects","error")}finally{Ue(!1)}},[Be,ge]);w.useCallback(async qe=>{_e.debug(" Saving teacher subjects:",qe);try{const Re=await Xs.saveTeacherSubjects(qe);if(Re.success)f("Subjects saved successfully!","success"),await ge(),re(!1);else throw new Error(Re.error||"Failed to save subjects")}catch(Re){_e.error(" Error saving teacher subjects:",Re),f("Failed to save subjects","error")}},[ge]);const _t=w.useCallback(()=>{_e.debug(" Showing active tests..."),_("tests")},[]),ur=w.useCallback(async qe=>{_e.debug(" Showing test details:",qe);const Re=E?.find(jt=>jt.test_type===qe.test_type&&jt.test_id===qe.test_id)||{},Ye=Re.assignments||qe.assignments||[],Tt=Ye.some(jt=>jt.is_active),St=qe.selectedAssignmentId||qe.assignment_id||null,Cr={...Re,...qe,assignments:Ye,selectedAssignmentId:St,hasActiveAssignment:Tt};z(Cr),B(!0),H([]),L(null),W(!0);try{if(["input","true_false","multiple_choice","word_matching","fill_blanks"].includes(qe.test_type)){const jt=await Pn.getTestQuestionsWithInfo(qe.test_type,qe.test_id);H(jt.questions||[]),L(jt.testInfo||null),_e.debug(" Test questions and info loaded:",{questionsCount:jt.questions?.length||0,testInfo:jt.testInfo})}}catch(jt){console.error("Error loading test questions:",jt),f("Error loading test questions. Please try again.","error")}finally{W(!1)}},[E,f]);w.useCallback(async(qe,Re,Ye)=>{_e.debug(" Removing class assignment:",qe,Re,Ye);try{const Tt=await Pn.removeClassAssignment(qe,Re,Ye);if(Tt.success)f("Assignment removed successfully!","success"),await Me();else throw new Error(Tt.error||"Failed to remove assignment")}catch(Tt){_e.error(" Error removing class assignment:",Tt),f("Failed to remove assignment","error")}},[Me]);const Gr=w.useCallback(async qe=>{_e.debug(" Marking assignment as completed:",qe),vt(qe);try{const Re=await Pn.markAssignmentCompleted(qe);if(Re.success){F(Tt=>Tt.map(St=>({...St,assignments:St.assignments?.map(Cr=>Cr.assignment_id===qe?{...Cr,is_active:!1}:Cr)||[]}))),f("Test assignment marked as completed!","success");const Ye=`teacher_tests_${n?.teacher_id||n?.id||""}`;localStorage.removeItem(Ye),_e.debug(" Cleared teacher tests cache"),Me().catch(Tt=>{_e.error(" Error refreshing tests after completion:",Tt)})}else throw new Error(Re.error||"Failed to mark assignment as completed")}catch(Re){_e.error(" Error marking assignment as completed:",Re),f("Failed to mark assignment as completed","error")}finally{vt(null)}},[Me,f,n?.teacher_id,n?.id]),Mr=w.useCallback(async()=>{_e.debug(" Refreshing active tests data...");try{const qe=`teacher_tests_${n?.teacher_id||n?.id||""}`;localStorage.removeItem(qe),_e.debug(" Cache cleared, forcing fresh API call"),_e.debug(" Making direct API call to get-teacher-active-tests with noCache");const Re=await Pn.getTeacherTests(!0);_e.debug(" Direct API call returned:",Re),F(Re),_e.debug(" activeTestsData state updated:",Re),f(`Tests refreshed successfully! Found ${Re?.length||0} tests.`,"success")}catch(qe){_e.error(" Error refreshing tests:",qe),f("Failed to refresh tests","error")}},[f,n?.teacher_id,n?.id]),[Tr,qr]=w.useState(null),$r=w.useCallback(async qe=>{_e.debug(" Activating assignment:",qe),qr(qe);try{const Re=await Pn.activateAssignment(qe);if(!Re.success)throw new Error(Re.error||"Failed to activate assignment");let Ye=null;F(St=>{const Cr=St.map(jt=>({...jt,assignments:jt.assignments?.map(en=>en.assignment_id===qe?{...en,is_active:!0}:en)||[]}));return Ye=Cr,Cr}),Ye&&z(St=>{if(!St)return St;const Cr=Ye.find(Nn=>Nn.test_id===St.test_id&&Nn.test_type===St.test_type);if(!Cr)return St;const jt=Cr.assignments||St.assignments||[],en=jt.some(Nn=>Nn.is_active);return{...St,...Cr,assignments:jt,hasActiveAssignment:en}}),f("Test assignment activated! Students can now see this test.","success");const Tt=`teacher_tests_${n?.teacher_id||n?.id||""}`;localStorage.removeItem(Tt),_e.debug(" Cleared teacher tests cache"),Mr().catch(St=>{_e.error(" Error performing hard refresh after activation:",St)})}catch(Re){_e.error(" Error activating assignment:",Re),f("Failed to activate assignment","error")}finally{qr(null)}},[Mr,f,n?.teacher_id,n?.id]),qn=w.useMemo(()=>!E||E.length===0?[]:E.flatMap(qe=>{if(!qe.assignments||qe.assignments.length===0)return[];const Re=qe.assignments.some(Ye=>Ye.is_active);return qe.assignments.map(Ye=>({test_id:qe.test_id,test_type:qe.test_type,test_name:qe.test_name,num_questions:qe.num_questions,created_at:qe.created_at,subject_id:qe.subject_id,subject:qe.subject,teacher_id:qe.teacher_id,assignments:qe.assignments,has_active_assignment:Re,assignment_id:Ye.assignment_id,grade:Ye.grade,class:Ye.class,is_active:Ye.is_active,assigned_at:Ye.assigned_at,days_remaining:Ye.days_remaining}))}),[E]),gr=w.useCallback(async(qe=null)=>{if(n?.teacher_id){wt(!0),ct(null);try{_e.debug(" Loading test performance data for class:",qe);const Re=await B3e.getTestPerformance(n.teacher_id,qe);Ve(Re),_e.debug(" Test performance data loaded:",Re.length,"tests")}catch(Re){_e.error(" Error loading test performance data:",Re),ct(Re.message)}finally{wt(!1)}}},[n?.teacher_id]);w.useCallback((qe,Re)=>{_e.debug(" Showing class results:",qe,Re),_e.debug(" Class click - grade:",qe,"className:",Re),I(qe),K(Re),_("results");const Ye=`${qe}/${Re}`;_e.debug(" Loading performance data for clicked class:",Ye),rt(Ye),gr(Ye)},[gr]);const[pn,Zr]=w.useState([]),[Zn,Fn]=w.useState([]),Ce=w.useCallback(async()=>{try{const Re=await(await ui(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestAssignments(n.teacher_id);Zr(Re)}catch(qe){_e.warn("Failed to load retests",qe)}},[n]);w.useCallback(async qe=>{try{const Ye=await(await ui(()=>import("./retestService-C6b0YDiD.js"),[])).retestService.getRetestTargets(qe);Fn(Ye)}catch(Re){_e.warn("Failed to load retest targets",Re)}},[]);const[Dt,Fr]=w.useState(!1),[Kr,On]=w.useState(!1);w.useEffect(()=>{_e.debug("[TeacherCabinet] showRetestModal state changed:",Dt)},[Dt]);const[Qr,ns]=w.useState({test_type:"",original_test_id:"",subject_id:"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:[]}),ta=w.useCallback(async qe=>{_e.debug("[TeacherCabinet] openRetestModal called with:",qe);const{test_type:Re,original_test_id:Ye,subject_id:Tt,failedStudentIds:St=[],grade:Cr,class:jt}=qe||{};ns({test_type:Re||"multiple_choice",original_test_id:Ye||"",subject_id:Tt||"",passing_threshold:50,scoring_policy:"BEST",max_attempts:1,window_days:2,student_ids:St}),Cr!==void 0&&I(Cr),jt!==void 0&&K(jt),_e.debug("[TeacherCabinet] Setting showRetestModal to true"),Fr(!0)},[]),yi=w.useCallback(async()=>{On(!0);try{const qe=await ui(()=>import("./retestService-C6b0YDiD.js"),[]),Re=new Date,Ye=new Date(Re.getTime()+Qr.window_days*24*60*60*1e3),Tt={...Qr,teacher_id:n.teacher_id,grade:M,class:U,window_start:Re.toISOString(),window_end:Ye.toISOString()};_e.debug("[Retest][TeacherCabinet] Prepared payload:",JSON.stringify(Tt)),_e.debug("[Retest][TeacherCabinet] Selected students count:",(Tt.student_ids||[]).length,"IDs:",Tt.student_ids),await qe.retestService.createRetestAssignment(Tt),f("Retest created","success"),Fr(!1),Ce(),tr(St=>St+1)}catch(qe){_e.error("Create retest error",qe),f(qe.message||"Failed to create retest","error")}finally{On(!1)}},[Qr,M,U,Ce]);if(p)return l.jsxs("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Cabinet..."})]}),l.jsx("div",{className:"flex flex-wrap gap-2"})]});if(v)return l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Cabinet Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:v}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})});return l.jsxs(Ze.div,{className:"min-h-screen bg-gradient-to-br from-green-50 to-emerald-100",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Ze.div,{className:"bg-gradient-to-r from-sky-400 to-sky-600 text-white shadow-lg",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-6",children:[l.jsxs(Ze.div,{className:"flex-1 text-center",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white mb-2",children:"Teacher Cabinet"}),l.jsxs("p",{className:"text-sky-100 text-sm sm:text-base md:text-lg",children:["Welcome, Teacher ",i()||""]})]}),l.jsxs(Ze.div,{className:"relative",initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsx("div",{className:"hidden md:block",children:l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>$e(!Oe),className:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border border-white/20 text-white hover:bg-white/20 px-2 sm:px-4 py-1.5 sm:py-2 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:[l.jsx("span",{className:"hidden sm:inline text-xs sm:text-sm font-medium",children:"Menu"}),l.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 transition-transform duration-200",style:{transform:Oe?"rotate(180deg)":"rotate(0deg)"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),Oe&&l.jsxs(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("button",{onClick:()=>{$e(!1),me()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{$e(!1),e?e():a()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})}),l.jsxs("div",{className:"md:hidden",children:[l.jsx("button",{onClick:()=>It(!Mt),className:"flex items-center justify-center w-10 h-10 bg-white/10 border border-white/20 text-white hover:bg-white/20 rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-white/50",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Mt&&l.jsxs(Ze.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1 z-50",children:[l.jsxs("div",{className:"px-4 py-2 border-b border-gray-200",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:i()||"Teacher"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Teacher Account"})]}),l.jsxs("button",{onClick:()=>{It(!1),me()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),l.jsx("span",{children:"Change Password"})]}),l.jsxs("button",{onClick:()=>{It(!1),e?e():a()},className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200 flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),l.jsx("span",{children:"Logout"})]})]})]})]})]})})}),l.jsx(Ze.div,{className:"bg-white border-b shadow-sm",initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4,duration:.5},children:l.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-4 lg:px-8",children:l.jsx("nav",{className:"flex space-x-1 sm:space-x-8 overflow-x-auto",children:[{key:"main",label:"Main Dashboard",shortLabel:"Dashboard"},{key:"tests",label:"Test Management",shortLabel:"Tests"},{key:"minigames",label:"Mini Games",shortLabel:"Games"},{key:"results",label:"Class Results",shortLabel:"Results"},{key:"subjects",label:"Subject Management",shortLabel:"Subjects"}].map((qe,Re)=>l.jsxs(Ze.button,{onClick:()=>qe.key==="tests"?_t():_(qe.key),className:`py-2 sm:py-4 px-2 sm:px-1 border-b-2 font-medium text-xs sm:text-sm transition-colors duration-200 whitespace-nowrap flex-shrink-0 flex-1 sm:flex-none ${b===qe.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,initial:{y:-10,opacity:0},animate:{y:0,opacity:1},transition:{delay:.5+Re*.1,duration:.3},whileHover:{scale:1.05},whileTap:{scale:.95},children:[l.jsx("span",{className:"sm:hidden",children:qe.shortLabel}),l.jsx("span",{className:"hidden sm:inline",children:qe.label})]},qe.key))})})}),l.jsx(Ze.div,{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:l.jsxs(Ai,{mode:"wait",children:[b==="main"&&l.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:xn()},"main"),b==="subjects"&&l.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:Al()},"subjects"),b==="tests"&&l.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:sl()},"tests"),b==="minigames"&&l.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(MZ,{onBackToCabinet:()=>_("main")})},"minigames"),b==="results"&&l.jsx(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},children:l.jsx(aY,{selectedGrade:M,selectedClass:U,onBackToCabinet:()=>_("main"),openRetestModal:ta,forceRefreshOnMount:At>0},At)},"results")]})}),te&&l.jsx(Ds,{isOpen:te,onClose:()=>{re(!1),Br("subject"),Pe([]),dt(null),Yt([])},title:"Select Subjects and Classes",size:"large",children:l.jsxs("div",{className:"space-y-6 px-4 max-h-[80vh] overflow-y-auto",children:[yr==="subject"&&l.jsxs(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Step 1: Select Subject"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the subject you want to teach:"}),lt?l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading subjects..."})]}):l.jsxs("select",{value:st?.subject_id||"",onChange:qe=>mt(qe.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"Select a subject"}),ve.map(qe=>l.jsx("option",{value:qe.subject_id,children:qe.subject},qe.subject_id))]})]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(at,{variant:"outline",onClick:()=>re(!1),children:"Cancel"}),l.jsx(at,{variant:"primary",onClick:()=>Br("classes"),disabled:!st,children:"Next: Select Classes"})]})]}),yr==="classes"&&st&&l.jsxs(Ze.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["Step 2: Select Classes for ",st.subject]}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Choose the classes you teach for this subject:"}),l.jsx("div",{className:"max-h-80 overflow-y-auto border border-gray-200 rounded-lg p-4",children:l.jsx("div",{className:"grid grid-cols-3 gap-3",children:[1,2,3,4,5,6,7].map(qe=>{let Re;return qe===1||qe===2||qe===3?Re=[15,16]:qe===4||qe===5||qe===6?Re=[13,14]:qe===7?Re=[69,70]:Re=[],l.jsxs("div",{className:"space-y-2",children:[l.jsxs("h4",{className:"font-medium text-gray-700 text-sm",children:["Grade ",qe]}),l.jsx("div",{className:"space-y-1",children:Re.map(Ye=>l.jsxs("label",{className:"flex items-center space-x-2 py-1",children:[l.jsx("input",{type:"checkbox",checked:Bt.some(Tt=>Tt.grade===qe.toString()&&Tt.class===Ye.toString()),onChange:()=>de(qe.toString(),Ye.toString()),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),l.jsxs("span",{className:"text-xs text-gray-700",children:["Class ",Ye]})]},Ye))})]},qe)})})})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(at,{variant:"outline",onClick:()=>Br("subject"),children:"Back to Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(at,{variant:"outline",onClick:()=>re(!1),children:"Cancel"}),l.jsx(at,{variant:"primary",onClick:Se,disabled:Bt.length===0,children:"Add Subject"})]})]})]}),Be.length>0&&l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600 mb-4",children:"Review your selected subjects and classes:"}),l.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:Be.map((qe,Re)=>l.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:l.jsxs("div",{className:"flex justify-between items-start",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:qe.subject_name}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Classes: ",qe.classes.map(Ye=>`Grade ${Ye.grade} Class ${Ye.class}`).join(", ")]})]}),l.jsx("button",{onClick:()=>De(Re),className:"text-red-600 hover:text-red-800 p-1",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Re))})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx(at,{variant:"outline",onClick:()=>Br("subject"),children:"Add More Subjects"}),l.jsxs("div",{className:"space-x-3",children:[l.jsx(at,{variant:"outline",onClick:()=>re(!1),children:"Cancel"}),l.jsx(at,{variant:"primary",onClick:jr,disabled:Lt,className:"relative",children:Lt?l.jsxs(l.Fragment,{children:[l.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save All Subjects"})]})]})]})]})}),Dt&&l.jsxs(Ds,{isOpen:Dt,onClose:()=>Fr(!1),title:"Create Retest",size:"medium",children:[l.jsx("div",{className:"space-y-4",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Retest Window"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Qr.window_days,onChange:qe=>ns(Re=>({...Re,window_days:Number(qe.target.value)})),children:[l.jsx("option",{value:1,children:"1 day"}),l.jsx("option",{value:2,children:"2 days"}),l.jsx("option",{value:3,children:"3 days"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Attempts"}),l.jsxs("select",{className:"w-full border rounded px-3 py-2 text-sm",value:Qr.max_attempts,onChange:qe=>ns(Re=>({...Re,max_attempts:Number(qe.target.value)})),children:[l.jsx("option",{value:1,children:"1 attempt"}),l.jsx("option",{value:2,children:"2 attempts"}),l.jsx("option",{value:3,children:"3 attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students can retry immediately if they fail"})]})]})}),l.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[l.jsx("button",{onClick:()=>Fr(!1),disabled:Kr,className:"px-4 py-2 text-sm rounded border border-gray-300 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),l.jsx("button",{onClick:yi,disabled:Kr,className:"px-4 py-2 text-sm rounded bg-indigo-600 text-white hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:Kr?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm"}),"Creating Retest..."]}):"Create Retest"})]})]}),Z&&J&&l.jsx(SE,{isOpen:Z,onClose:()=>B(!1),testType:J.test_type,testId:J.test_id,testName:J.test_name,questions:q,isLoading:G,canEdit:!J.hasActiveAssignment,canEditSettings:!J.hasActiveAssignment,subject:J.subject,createdAt:J.created_at,assignments:J.assignments||[],testInfo:R,onSave:async(qe,Re,Ye)=>{try{await Pn.updateTestQuestions(qe,Re,Ye),f("Questions updated successfully!","success");const Tt=`teacher_tests_${n?.teacher_id||n?.id||""}`;localStorage.removeItem(Tt),await ur(J)}catch(Tt){throw console.error("Error saving questions:",Tt),f("Failed to update questions","error"),Tt}},onSettingsSave:async qe=>{try{await Pn.updateTestSettings(J.test_type,J.test_id,qe),f("Settings updated successfully!","success"),await ur(J)}catch(Re){throw f("Failed to update settings","error"),Re}}}),he&&ie&&l.jsx(Ds,{isOpen:he,onClose:kr,title:"Delete Subject Assignment",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:l.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Delete Subject Assignment"}),l.jsxs("p",{className:"text-sm text-gray-500 mb-4",children:["Are you sure you want to delete the assignment for"," ",l.jsx("span",{className:"font-semibold text-gray-900",children:ie.subjectName})," ","in Grade ",ie.grade,", Class ",ie.classNumber,"?"]}),l.jsx("p",{className:"text-xs text-red-600",children:"This action cannot be undone."})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx(at,{variant:"outline",onClick:kr,children:"Cancel"}),l.jsx(at,{variant:"danger",onClick:qt,children:"Delete Assignment"})]})]})}),l.jsx(Ze.div,{className:"fixed top-4 right-4 space-y-2 z-50",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.8,duration:.5},children:h.map(qe=>l.jsx(Ze.div,{initial:{opacity:0,y:-20,scale:.9},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-20,scale:.9},transition:{duration:.3},children:l.jsx("div",{className:`p-4 rounded-lg shadow-lg ${qe.type==="success"?"bg-green-600 text-white":qe.type==="error"?"bg-red-600 text-white":qe.type==="warning"?"bg-yellow-600 text-white":"bg-blue-600 text-white"}`,children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{children:qe.message}),l.jsx("button",{onClick:()=>g(qe.id),className:"ml-4 text-white hover:text-gray-200",children:""})]})})},qe.id))}),ar&&l.jsx(Ds,{isOpen:ar,onClose:Ne,title:"Change Password",size:"small",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),l.jsx("input",{type:"password",name:"currentPassword",value:or.currentPassword,onChange:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter current password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),l.jsx("input",{type:"password",name:"newPassword",value:or.newPassword,onChange:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Enter new password"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),l.jsx("input",{type:"password",name:"confirmPassword",value:or.confirmPassword,onChange:Ae,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-transparent",placeholder:"Confirm new password"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx(at,{type:"button",variant:"secondary",onClick:Ne,className:"flex-1",children:"Cancel"}),l.jsx(at,{type:"button",onClick:be,className:"flex-1",children:"Change Password"})]})]})})]});function xn(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsxs(Kt,{children:[l.jsx(Kt.Header,{children:l.jsx(Kt.Title,{children:"My Subjects & Classes"})}),l.jsx(Kt.Body,{children:T.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:""}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned"}),l.jsx("p",{className:"text-gray-500 mb-4",children:"You don't have any subjects assigned yet."}),l.jsx(at,{variant:"outline",onClick:()=>_("subjects"),children:"Manage Subjects"})]}):l.jsx("div",{className:"space-y-6",children:T.map((qe,Re)=>l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2+Re*.1,duration:.3},className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:qe.name}),l.jsxs("span",{className:"text-sm text-gray-500",children:[qe.classes?.length||0," classes"]})]}),qe.classes&&qe.classes.length>0?l.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:qe.classes.map((Ye,Tt)=>l.jsx(Ze.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3+Re*.1+Tt*.05,duration:.2},whileHover:{scale:1.05},whileTap:{scale:.95},children:l.jsxs(at,{variant:"outline",size:"sm",onClick:()=>{I(Ye.grade),K(Ye.class),_("results")},className:"font-medium",children:[Ye.grade,"/",Ye.class]})},Tt))}):l.jsx("div",{className:"text-center py-4 text-gray-500",children:l.jsx("span",{className:"text-sm",children:"No classes assigned to this subject"})})]},qe.id))})})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.5},children:l.jsxs(Kt,{children:[l.jsxs(Kt.Header,{children:[l.jsx(Kt.Title,{children:"Test Performance Overview"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Test performance over time with average scores"})]}),l.jsx(Kt.Body,{children:T.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"No subjects assigned - no performance data available"})]}):l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex flex-wrap gap-2 border-b border-gray-200",children:(()=>{const qe=[];return T.forEach(Re=>{Re.classes&&Re.classes.forEach(Ye=>{const Tt=`${Ye.grade}/${Ye.class}`;qe.find(St=>St.key===Tt)||qe.push({key:Tt,grade:Ye.grade,class:Ye.class,subject:Re.name})})}),qe})().map((qe,Re)=>l.jsxs("button",{onClick:()=>{_e.debug(" Class button clicked:",qe.key),rt(qe.key),gr(qe.key)},className:`px-4 py-2 text-sm font-medium rounded-t-lg transition-colors ${yt===qe.key?"bg-blue-100 text-blue-700 border-b-2 border-blue-500":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"}`,children:[qe.grade,"/",qe.class]},qe.key))}),yt?l.jsx("div",{className:"mt-4",children:l.jsx(UMe,{data:Te,loading:pt,error:Ut})}):l.jsxs("div",{className:"mt-4 text-center text-muted py-4",children:[l.jsx("div",{className:"mb-2",children:l.jsx("img",{src:"/pics/Graph.png",alt:"Performance Graph",className:"w-16 h-16 object-contain mx-auto"})}),l.jsx("p",{className:"text-gray-500",children:"Select a class above to view test performance data"})]})]})})]})})]})}function Al(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(Kt,{children:l.jsx(Kt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(Kt.Title,{children:"Subject Management"}),l.jsx(at,{variant:"primary",onClick:Je,children:"Add Subject"})]})})})}),T.length===0?l.jsx(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(Kt,{children:l.jsx(Kt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(Ze.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Add your first subject to get started with creating tests and managing classes."}),l.jsx(at,{variant:"primary",onClick:Je,size:"lg",children:"Add Your First Subject"})]})})})}):l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},children:l.jsxs(Kt,{children:[l.jsx(Kt.Header,{children:l.jsx(Kt.Title,{children:"Your Subjects"})}),l.jsx(Kt.Body,{children:l.jsx("div",{className:"space-y-4",children:T.map((qe,Re)=>l.jsx(Ze.div,{className:"p-4 bg-gray-50 rounded-lg border-l-4 border-green-500",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3+Re*.1,duration:.3},whileHover:{scale:1.02,backgroundColor:"#f9fafb"},children:l.jsx("div",{className:"flex justify-between items-start",children:l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:qe.name}),l.jsx("div",{className:"flex flex-wrap gap-2",children:qe.classes?.map((Ye,Tt)=>l.jsxs(Ze.div,{className:"inline-flex items-center gap-2 bg-blue-100 text-blue-800 text-xs rounded-full px-3 py-1",initial:{scale:0},animate:{scale:1},transition:{delay:.4+Re*.1+Tt*.05,duration:.2},whileHover:{scale:1.1},children:[l.jsxs("span",{children:[Ye.grade," - ",Ye.className]}),l.jsx("button",{onClick:()=>tt(qe.id,qe.name,Ye.grade,Ye.class),className:"ml-1 text-red-600 hover:text-red-800 transition-colors",title:"Delete this subject assignment",children:l.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},Tt))||l.jsx("span",{className:"text-gray-500 text-sm",children:"No classes assigned"})})]})})},Re))})})]})})]})}function sl(){return l.jsxs("div",{className:"space-y-8",children:[l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1,duration:.5},children:l.jsx(Kt,{children:l.jsx(Kt.Header,{children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx(Kt.Title,{children:"Active Tests"}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(at,{variant:"outline",onClick:Mr,children:"Refresh"}),l.jsx(at,{variant:"primary",onClick:()=>t("/teacher/tests/create"),children:"Create New Test"})]})]})})})}),qn.length===0?l.jsx(Ze.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2,duration:.5},children:l.jsx(Kt,{children:l.jsx(Kt.Body,{children:l.jsxs("div",{className:"text-center p-12",children:[l.jsx(Ze.div,{className:"text-6xl mb-4",initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.5,type:"spring"},children:""}),l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"No active tests found"}),l.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first test to get started with assessments."}),l.jsx(at,{variant:"primary",onClick:()=>t("/teacher/tests/create"),size:"lg",children:"Create Your First Test"})]})})})}):l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.5},className:"space-y-4",children:qn.map((qe,Re)=>l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3+Re*.1,duration:.3},whileHover:{scale:1.01},children:l.jsx(Kt,{children:l.jsxs(Kt.Body,{children:[l.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row sm:items-center sm:justify-between",children:[l.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row sm:items-center sm:space-x-4 gap-2",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 min-w-0 flex-shrink-0 max-w-xs truncate",title:qe.test_name,children:qe.test_name}),l.jsx("span",{className:"hidden sm:inline-block bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium flex-shrink-0",children:qe.test_type}),l.jsxs("span",{className:"hidden sm:inline-block bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold flex-shrink-0",children:[qe.grade,"/",qe.class]})]}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-4",children:[l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${qe.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:qe.is_active?"Active":"Inactive"}),l.jsx("div",{className:"text-sm text-gray-500 flex-shrink-0",children:new Date(qe.created_at).toLocaleDateString()})]})]}),l.jsxs("div",{className:"hidden sm:flex gap-2 ml-4 flex-shrink-0",children:[l.jsx(at,{variant:"outline",onClick:()=>ur({...qe,selectedAssignmentId:qe.assignment_id,assignments:qe.assignments}),size:"sm",children:"Details"}),!qe.is_active&&l.jsx(at,{variant:"primary",onClick:()=>$r(qe.assignment_id),size:"sm",disabled:Tr===qe.assignment_id,children:Tr===qe.assignment_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Activating..."]}):"Activate"}),l.jsx(at,{variant:"success",onClick:()=>Gr(qe.assignment_id),size:"sm",disabled:et===qe.assignment_id,children:et===qe.assignment_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete"})]})]}),l.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 sm:hidden",children:[l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsxs("span",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded text-sm font-semibold",children:[qe.grade,"/",qe.class]}),l.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${qe.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:qe.is_active?"Active":"Inactive"}),l.jsx("span",{className:"text-xs text-gray-500",children:new Date(qe.created_at).toLocaleDateString()})]}),l.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[l.jsx(at,{variant:"outline",onClick:()=>ur({...qe,assignments:[{assignment_id:qe.assignment_id,grade:qe.grade,class:qe.class,is_active:qe.is_active}]}),size:"sm",className:"text-xs",children:"Details"}),!qe.is_active&&l.jsx(at,{variant:"primary",onClick:()=>$r(qe.assignment_id),size:"sm",disabled:Tr===qe.assignment_id,children:Tr===qe.assignment_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Activating..."]}):"Activate"}),l.jsx(at,{variant:"success",onClick:()=>Gr(qe.assignment_id),size:"sm",disabled:et===qe.assignment_id,children:et===qe.assignment_id?l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Completing..."]}):"Complete"})]})]})]})})},`${qe.test_id}-${qe.assignment_id}-${Re}`))})]})}},fRe=[{value:"A1",label:"A1 (Beginner)",description:"Basic vocabulary, simple sentences"},{value:"A2",label:"A2 (Elementary)",description:"Everyday vocabulary, present/past tenses"},{value:"B1",label:"B1 (Intermediate)",description:"Varied vocabulary, complex sentences"},{value:"B2",label:"B2 (Upper-Intermediate)",description:"Advanced vocabulary, sophisticated structures"},{value:"C1",label:"C1 (Advanced)",description:"Nuanced vocabulary, complex discourse"},{value:"C2",label:"C2 (Proficiency)",description:"Native-like fluency and accuracy"}],hRe=({testName:e="",onTestSaved:t,onCancel:r,onBackToCabinet:n,isSaving:s=!1,validationErrors:a={}})=>{const{showNotification:i}=Ls(),[o,c]=w.useState({min_words:50,allowed_attempts:3,questions:[{question_id:1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}),[u,d]=w.useState(!1),f=w.useCallback((C,b)=>{c(_=>({..._,[C]:b}))},[]),h=w.useCallback((C,b,_)=>{c(T=>({...T,questions:T.questions.map((N,E)=>E===C?{...N,[b]:_}:N)}))},[]),g=w.useCallback(()=>{c(C=>({...C,questions:[...C.questions,{question_id:C.questions.length+1,prompt:"",expected_duration:null,difficulty_level:"B1"}]}))},[]),p=w.useCallback(C=>{o.questions.length>1&&c(b=>({...b,questions:b.questions.filter((_,T)=>T!==C)}))},[o.questions.length]),x=w.useCallback(()=>{const C={};return o.min_words<10&&(C.min_words="Minimum word count must be at least 10 words"),o.questions.forEach((b,_)=>{b.prompt.trim()||(C[`question_${_}_prompt`]="Question prompt is required")}),C},[o]),v=w.useCallback(async C=>{C.preventDefault();const b=x();if(Object.keys(b).length>0){i("Please fix the validation errors","error");return}d(!0);try{const _={test_name:e,time_limit:300,min_duration:30,max_duration:600,allowed_attempts:o.allowed_attempts,max_attempts:o.allowed_attempts,min_words:o.min_words,passing_score:50,allowed_time:null,questions:o.questions.map((T,N)=>({question_id:N+1,prompt:T.prompt,expected_duration:T.expected_duration,difficulty_level:T.difficulty_level}))};console.log(" [DEBUG] Calling onTestSaved with data:",_),t?(console.log(" [DEBUG] onTestSaved function exists, calling it..."),t(_),console.log(" [DEBUG] onTestSaved called successfully")):console.log(" [DEBUG] onTestSaved function is null/undefined")}catch(_){console.error("Error preparing speaking test:",_),i("Failed to prepare speaking test","error")}finally{d(!1)}},[o,x,i,t,e]);return u||s?l.jsxs("div",{className:"flex items-center justify-center p-8",children:[l.jsx(Xr,{}),l.jsx("span",{className:"ml-2",children:"Creating speaking test..."})]}):l.jsxs("div",{className:"speaking-test-creator max-w-4xl mx-auto",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Create Speaking Test"}),l.jsx("p",{className:"text-gray-600",children:"Create a speaking test where students record audio responses with AI-powered feedback"})]}),l.jsxs("form",{onSubmit:v,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Scoring Settings"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Word Count *"}),l.jsx("input",{type:"number",min:"10",max:"1000",value:o.min_words,onChange:C=>f("min_words",parseInt(C.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.min_words&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a.min_words})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Attempts *"}),l.jsxs("select",{value:o.allowed_attempts,onChange:C=>f("allowed_attempts",parseInt(C.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:1,children:"1 Attempt"}),l.jsx("option",{value:2,children:"2 Attempts"}),l.jsx("option",{value:3,children:"3 Attempts"})]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Students will be able to record and re-record their response this many times before submitting."})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("h3",{className:"text-lg font-semibold",children:"Questions"}),l.jsx(at,{type:"button",variant:"outline",onClick:g,children:"Add Question"})]}),o.questions.length>1&&l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-blue-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-blue-800",children:"Multiple Questions Detected"}),l.jsx("div",{className:"mt-1 text-sm text-blue-700",children:l.jsxs("p",{children:["You have ",o.questions.length," questions in this test.",l.jsx("strong",{children:" Only one question will be randomly selected"})," and shown to each student. This ensures fair distribution across your question pool."]})})]})]})}),o.questions.map((C,b)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("div",{className:"flex justify-between items-center mb-3",children:[l.jsxs("h4",{className:"font-medium",children:["Question ",b+1]}),o.questions.length>1&&l.jsx(at,{type:"button",variant:"outline",size:"sm",onClick:()=>p(b),className:"text-red-600 hover:text-red-700",children:"Remove"})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Prompt *"}),l.jsx("textarea",{value:C.prompt,onChange:_=>h(b,"prompt",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Enter the question prompt for students"}),a[`question_${b}_prompt`]&&l.jsx("p",{className:"text-red-500 text-sm mt-1",children:a[`question_${b}_prompt`]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expected Duration (seconds)"}),l.jsx("input",{type:"number",min:"10",max:"600",value:C.expected_duration||"",onChange:_=>h(b,"expected_duration",_.target.value?parseInt(_.target.value):null),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Optional"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CEFR Level"}),l.jsx("select",{value:C.difficulty_level,onChange:_=>h(b,"difficulty_level",_.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:fRe.map(_=>l.jsxs("option",{value:_.value,children:[_.label," - ",_.description]},_.value))}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Select the appropriate CEFR level for this question. This will be used by AI to evaluate students appropriately."})]})]})]})]},b))]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t border-gray-200",children:[l.jsx(at,{type:"button",variant:"secondary",onClick:r,children:"Cancel"}),l.jsx(at,{type:"submit",variant:"primary",disabled:u||s,children:u||s?"Creating...":"Create Speaking Test"})]})]})]})},mRe={multipleChoice:"multiple_choice",trueFalse:"true_false",input:"input",matching:"matching_type",wordMatching:"word_matching",drawing:"drawing",fillBlanks:"fill_blanks",speaking:"speaking"},iU=()=>{const{user:e}=ws();Zue();const{notifications:t,showNotification:r,removeNotification:n}=Ls(),[s,a]=w.useState(!1),[i,o]=w.useState(!1),[c,u]=w.useState("typeSelection"),[d,f]=w.useState(!1),[h,g]=w.useState(null),[p,x]=w.useState([]),[v,C]=w.useState(!1),[b,_]=w.useState(!1),[T,N]=w.useState(!1),[E,F]=w.useState(!1),[j,P]=w.useState({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:"",isShuffled:!1}),[M,I]=w.useState([]),[U,K]=w.useState(null);w.useRef(null),w.useRef(null),w.useRef(null),w.useRef(null),w.useRef(null),w.useRef(null),w.useRef(null);const te=w.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in initializeTestCreation, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" Setting up test creation event listeners..."),H(),console.log(" Test creation initialization complete")},[e,r]),re=w.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestTypeSelection, redirecting to login"),r("Missing teacher session. Please sign in again.","error");return}console.log(" showTestTypeSelection called - starting new test creation"),o(!1),console.log(" Reset testAssignmentCompleted flag to false"),a(!0),console.log(" Set isInTestCreation flag to true"),Z(),u("typeSelection"),J("testTypeSelection")},[e,r]),Z=w.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in disableNavigationButtons, redirecting to login");return}console.log(" Disabling navigation buttons..."),f(!0)},[e]),B=w.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in enableNavigationButtons, redirecting to login");return}console.log(" Enabling navigation buttons..."),f(!1)},[e]),J=w.useCallback(async de=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveTestCreationState, redirecting to login");return}console.log("  saveTestCreationState called with step:",de),console.log("  Call stack:",new Error().stack);const Se={multipleChoice:{buttonVisible:!0,hintVisible:!1},trueFalse:{buttonVisible:!0,hintVisible:!1},input:{buttonVisible:!0,hintVisible:!1}},De={isInTestCreation:!0,currentStep:de,timestamp:Date.now(),excelState:Se};localStorage.setItem("test_creation_state",JSON.stringify(De)),console.log(" Saved test creation state:",De);const Le={};switch(de){case"testTypeSelection":break;case"multipleChoiceForm":Le.testName=j.testName||"",Le.numQuestions=j.numQuestions||"",Le.numOptions=j.numOptions||"",Le.questions=j.questions||{};break;case"trueFalseForm":Le.testName=j.testName||"",Le.numQuestions=j.numQuestions||"",Le.questions=j.questions||{};break;case"inputForm":Le.testName=j.testName||"",Le.numQuestions=j.numQuestions||"",Le.questions=j.questions||{};break;case"formCreation":Le.testName=j.testName||"",Le.numQuestions=j.numQuestions||"",Le.numOptions=j.numOptions||"",Le.questions=j.questions||{},Le.enableTimer=!!j.enableTimer,Le.timerMinutes=j.timerMinutes||"",Le.isShuffled=!!j.isShuffled;break;case"assignment":case"testAssignment":Le.testName=j.testName||"",Le.numQuestions=j.numQuestions||"",Le.numOptions=j.numOptions||"",Le.questions=j.questions||{};break;default:console.log(" Unknown step in saveTestCreationState:",de);break}Object.keys(Le).length>0&&(localStorage.setItem(`form_data_${de}`,JSON.stringify(Le)),console.log(" Saved form data for step:",de,Le))},[e,j]),z=w.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearTestCreationState, redirecting to login");return}localStorage.removeItem("test_creation_state"),localStorage.removeItem("test_creation_form_data");const de=[];for(let Se=0;Se<localStorage.length;Se++){const De=localStorage.key(Se);De&&(De.includes("test")||De.includes("form")||De.includes("question"))&&de.push(De)}de.forEach(Se=>{localStorage.removeItem(Se),console.log(" Removed localStorage key:",Se)}),console.log(" Cleared test creation state from localStorage")},[e]);w.useCallback(async()=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in clearAllTestFields, redirecting to login");return}console.log(" Clearing all test form fields..."),P({testName:"",numQuestions:0,numOptions:0,questions:{}}),g(null),I([]),K(null),console.log(" Cleared all test form fields")},[e]);const q=w.useCallback(()=>{console.log(" Resetting Excel upload state..."),$e({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),["multiple-choice","true-false","input","word-matching"].forEach(Se=>{const De=document.querySelector(`.excel-upload-btn[data-test-type="${Se}"]`);De&&(De.style.display="none",console.log(" Excel button hidden for:",Se));const Le=document.querySelector(`.excel-hint[data-test-type="${Se}"]`);Le&&(Le.style.display="none",console.log(" Excel hint hidden for:",Se));const tt=document.querySelector(`.excel-file-input[data-test-type="${Se}"]`);tt&&(tt.value="",console.log(" File input cleared for:",Se))}),console.log(" Excel upload state reset complete")},[]),H=w.useCallback(()=>{console.log(" Setting up auto-save listeners for initial form fields..."),["testName","numQuestions","numOptions","enableTimer","timerMinutes","isShuffled"].forEach(Se=>{const De=document.getElementById(Se);De&&De.addEventListener("input",()=>{console.log(` Auto-save triggered for field: ${Se}`)})}),console.log(" Form auto-save setup complete")},[]);w.useCallback(async de=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in saveFormDataForStep, redirecting to login");return}console.log("  saveFormDataForStep called with step:",de),console.log("  Call stack:",new Error().stack);const Se={};switch(de){case"testTypeSelection":break;case"multipleChoiceForm":Se.testName=j.testName||"",Se.numQuestions=j.numQuestions||"",Se.numOptions=j.numOptions||"",Se.questions=j.questions||{};break;case"trueFalseForm":Se.testName=j.testName||"",Se.numQuestions=j.numQuestions||"",Se.questions=j.questions||{};break;case"inputForm":Se.testName=j.testName||"",Se.numQuestions=j.numQuestions||"",Se.questions=j.questions||{};break;case"formCreation":Se.testName=j.testName||"",Se.numQuestions=j.numQuestions||"",Se.numOptions=j.numOptions||"",Se.questions=j.questions||{};break;default:console.log(" Unknown step for form data save:",de);return}localStorage.setItem("test_creation_form_data",JSON.stringify({step:de,data:Se,timestamp:Date.now()})),console.log(" Saved form data for step:",de,Se)},[e,j]);const R=w.useCallback(async de=>{console.log(" Restoring form data for step:",de);try{const Se=localStorage.getItem(`form_data_${de}`);if(Se){const De=JSON.parse(Se);console.log(" Restored form data:",De),P(Le=>{const tt={...Le,...De};return console.log(" Updated formData with restored data:",tt),console.log(" Matching test data in restored data:",tt.matchingTestData),tt}),Object.keys(De).forEach(Le=>{const tt=document.getElementById(Le);tt&&De[Le]!==void 0&&(tt.value=De[Le])}),console.log(" Form data restored for step:",de)}else console.log(" No saved data found for step:",de)}catch(Se){console.error(" Error restoring form data:",Se)}},[e]),L=w.useCallback(()=>{console.log(" Setting up multiple choice form auto-save..."),["mcNumOptions"].forEach(De=>{const Le=document.getElementById(De);Le&&Le.addEventListener("input",()=>{console.log(` Auto-save triggered for MC field: ${De}`)})}),document.querySelectorAll("#mcQuestionsContainer input, #mcQuestionsContainer textarea, #mcQuestionsContainer select").forEach(De=>{De.addEventListener("input",()=>{console.log(" Auto-save triggered for MC question field")})}),console.log(" Multiple choice form auto-save setup complete")},[]),G=w.useCallback(()=>{console.log(" Setting up true/false form auto-save..."),document.querySelectorAll("#tfQuestionsContainer input, #tfQuestionsContainer textarea, #tfQuestionsContainer select").forEach(Se=>{Se.addEventListener("input",()=>{console.log(" Auto-save triggered for TF question field")})}),console.log(" True/false form auto-save setup complete")},[]),W=w.useCallback(()=>{console.log(" Setting up input form auto-save..."),document.querySelectorAll("#inputQuestionsContainer input, #inputQuestionsContainer textarea, #inputQuestionsContainer select").forEach(Se=>{Se.addEventListener("input",()=>{console.log(" Auto-save triggered for Input question field")})}),console.log(" Input form auto-save setup complete")},[]),Q=w.useCallback(de=>{console.log(" showExcelUploadButton called with testType:",de);const Se=de==="multiple-choice"?"multipleChoice":de==="true-false"?"trueFalse":de==="input"?"input":de;$e(De=>({...De,[Se]:{...De[Se],buttonVisible:!0}}))},[]),X=w.useCallback(de=>{console.log(" showExcelHint called with testType:",de);const Se=de==="multiple-choice"?"multipleChoice":de==="true-false"?"trueFalse":de==="input"?"input":de;$e(De=>({...De,[Se]:{...De[Se],hintVisible:!0}}))},[]),se=w.useCallback(async(de,Se,De)=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTestAssignmentOptions, redirecting to login");return}console.log("displayTestAssignmentOptions called with:",{classes:de,testType:Se,testId:De}),x(de),console.log(" Test assignment options displayed for:",{testType:Se,testId:De,classesCount:de.length})},[e]),le=w.useCallback(async(de,Se)=>{try{if(console.log("Loading teacher grades and classes for test assignment"),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}console.log("Teacher ID:",e.teacher_id);const Le=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log("Teacher subjects response:",Le),Le.success&&Le.subjects&&Le.subjects.length>0?(console.log("Teacher subjects loaded:",Le.subjects),x(Le.subjects),se(Le.subjects,de,Se)):(console.log("No teacher subjects found"),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(De){console.error("Error loading teacher grades and classes:",De),r("Error loading teacher grades and classes","error")}},[e,r,se]),he=w.useCallback(async()=>{if(console.log(" Loading available classes..."),!e||!e.teacher_id){console.error("No valid teacher session found, redirecting to login");return}try{const Se=await(await window.tokenManager.makeAuthenticatedRequest(`/.netlify/functions/get-teacher-subjects?teacher_id=${e.teacher_id}`)).json();console.log(" Teacher subjects response:",Se),Se.success&&Se.subjects&&Se.subjects.length>0?(console.log(" Teacher subjects loaded:",Se.subjects),x(Se.subjects)):(console.log("No teacher subjects found"),x([]),r("No subjects found. Please assign subjects to grades and classes first.","warning"))}catch(de){console.error(" Error loading available classes:",de),r("Failed to load available classes","error")}},[e,r]);w.useCallback(async(de,Se)=>{if(i){o(!1);return}if(!e||!e.teacher_id){console.error("No valid teacher session found in showTestAssignment, redirecting to login");return}Z(),J("testAssignment"),K(Se),g(de),u("testAssignment"),le(de,Se),console.log(" Test assignment interface shown for:",{testType:de,testId:Se})},[i,e,Z,J,le]);const we=w.useCallback(async de=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayTeacherActiveTests, redirecting to login");return}if(console.log(" Displaying teacher active tests:",de),de.length===0){Qe([]);return}Qe(de),console.log(" Active tests displayed:",de.length,"tests")},[e]);w.useCallback(async(de,Se)=>{try{console.log(" Loading test questions for:",{testType:de,testId:Se});const De=await Pn.getTestQuestions(Se,de);return console.log(" Test questions loaded:",De),De}catch(De){throw console.error("Error loading test questions:",De),De}},[]),w.useCallback((de,Se,De,Le)=>{console.log(" Showing teacher test details modal:",{testType:de,testId:Se,testName:De,questionsCount:Le.length}),console.log("Test Details:",{testType:de,testId:Se,testName:De,questions:Le.map(tt=>({id:tt.question_id,question:tt.question,correctAnswer:tt.correct_answer}))}),r(`Test details for "${De}" loaded successfully.`,"success")},[r]);const ie=w.useCallback(async()=>{console.log(" DEBUG: loadTeacherActiveTests called");try{console.log(" DEBUG: Fetching teacher active tests using JWT authentication...");const de=await Pn.getTeacherTests();console.log(" DEBUG: Tests loaded:",de),de&&de.length>0?(console.log(" DEBUG: Success! Displaying",de.length,"tests"),we(de)):(console.log(" DEBUG: No tests found"),Qe([]))}catch(de){console.error(" DEBUG: Error loading active tests:",de),r("Error loading active tests.","error")}},[r,we]),Ee=w.useCallback(()=>{console.log("showTestCreationSuccessMessage called"),r("Test created and assigned successfully!","success"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}}),I([]),o(!1),a(!1),z()},[r,z]),ye=w.useCallback(async(de,Se)=>{if(console.log(" === ASSIGN TEST TO CLASSES DEBUG START ==="),console.log(" Test Type:",de),console.log(" Test ID:",Se),console.log(" Current formData:",j),console.log(" Selected Classes:",M),console.log(" User:",e),C(!0),!e||!e.teacher_id){console.error(" No valid teacher session found in assignTestToClasses, redirecting to login"),r("Missing teacher session. Please sign in again.","error"),C(!1);return}if(console.log(" Teacher ID:",e.teacher_id),M.length===0){console.warn(" No classes selected"),r("Please select at least one class.","warning"),C(!1);return}try{console.log(" Preparing test + assignment request..."),await _u.loadAcademicCalendar();const Le=_u.getCurrentTerm()?.id;if(!Le)throw new Error("No current academic period found");const tt=M.map(_t=>{const ur={grade:parseInt(_t.grade),class:parseInt(_t.class),subject_id:parseInt(_t.subject_id),academic_period_id:Le,due_date:null};return console.log(" Created assignment:",ur),ur});if(console.log(" Final assignments array:",tt),de==="matching"){console.log(" Processing matching test..."),console.log(" Setting isAssigningTest to true for matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Tr=>setTimeout(Tr,100));const _t=j.matchingTestData;if(console.log(" Matching test data from formData:",_t),!_t){console.error(" Matching test data not found in formData"),r("Matching test data not found. Please recreate the test.","error");return}console.log(" Matching test data found, processing...");let ur;_t.processedQuestions?(console.log(" Using pre-processed questions from MatchingTestCreator"),ur=_t.processedQuestions):(console.log(" Converting blocks to questions (fallback)..."),console.log(" Blocks:",_t.blocks),console.log(" Words:",_t.words),console.log(" Arrows:",_t.arrows),ur=_t.blocks.map((Tr,qr)=>{const $r=_t.words.find(Zr=>Zr.blockId===Tr.id)?.word||`Word ${qr+1}`,qn=_t.arrows.some(Zr=>Zr.startBlock===Tr.id),gr=_t.arrows.find(Zr=>Zr.startBlock===Tr.id)||null,pn={question_id:qr+1,word:$r,block_coordinates:{x:Tr.x,y:Tr.y,width:Tr.width,height:Tr.height},has_arrow:qn,arrow:gr?{startX:gr.startX,startY:gr.startY,endX:gr.endX,endY:gr.endY,style:gr.style||{}}:null};return console.log(` Question ${qr+1}:`,pn),pn})),console.log(" Final questions array:",ur);const Gr={teacher_id:e.teacher_id,test_name:j.testName,image_url:_t.imageUrl,num_blocks:_t.blocks.length,questions:ur,allowed_time:j.enableTimer?Math.max(0,Math.floor(Number(j.timerMinutes||0)*60)):null,assignments:tt};console.log(" Final matching test data payload:",Gr),console.log(" Calling testService.saveMatchingTest...");const Mr=await Pn.saveMatchingTest(Gr);console.log(" API Response:",Mr),Mr.success?(console.log(" Matching test created and assigned successfully!"),r("Matching test created and assigned successfully!","success"),console.log("Matching test created and assigned successfully"),o(!0),Ie()):(console.error(" Failed to create matching test:",Mr.message),r("Error creating and assigning matching test: "+Mr.message,"error")),F(!1);return}if(de==="wordMatching"){console.log(" Processing word matching test..."),console.log(" Setting isAssigningTest to true for word matching test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Tr=>setTimeout(Tr,100));const _t=j.wordMatchingData;if(console.log(" Word matching test data from formData:",_t),!_t){console.error(" Word matching test data not found in formData"),r("Word matching test data not found. Please recreate the test.","error");return}console.log(" Word matching test data found, processing...");const ur=_t.wordPairs.map((Tr,qr)=>({question_id:qr+1,left_word:Tr.leftWord,right_word:Tr.rightWord}));console.log(" Final word matching questions array:",ur);const Gr={teacher_id:e.teacher_id,test_type:"word_matching",test_name:j.testName,num_questions:_t.wordPairs.length,interaction_type:_t.interactionType||"drag",questions:ur,allowed_time:j.enableTimer?Math.max(0,Math.floor(Number(j.timerMinutes||0)*60)):null,assignments:tt};console.log(" Final word matching test data payload:",Gr),console.log(" Calling testService.assignTestToClasses for word matching...");const Mr=await Pn.assignTestToClasses(Gr);console.log(" API Response:",Mr),Mr.success?(console.log(" Word matching test created and assigned successfully!"),r("Word matching test created and assigned successfully!","success"),console.log("Word matching test created and assigned successfully"),o(!0),Ie()):(console.error(" Failed to create word matching test:",Mr.message),r("Error creating and assigning word matching test: "+Mr.message,"error")),F(!1);return}if(de==="drawing"){console.log(" Processing drawing test..."),console.log(" Setting isAssigningTest to true for drawing test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Tr=>setTimeout(Tr,100));const _t=j.drawingData;if(console.log(" Drawing test data from formData:",_t),!_t){console.error(" Drawing test data not found in formData"),r("Drawing test data not found. Please recreate the test.","error");return}console.log(" Drawing test data found, processing...");const ur=_t.questions||[];console.log(" Drawing questions array:",ur);const Gr={teacher_id:e.teacher_id,test_type:"drawing",test_name:j.testName,num_questions:_t.num_questions,passing_score:_t.passing_score,questions:ur,allowed_time:j.enableTimer?Math.max(0,Math.floor(Number(j.timerMinutes||0)*60)):null,assignments:tt};console.log(" Final drawing test data payload:",Gr),console.log(" Calling testService.assignTestToClasses...");const Mr=await Pn.assignTestToClasses(Gr);console.log(" API Response:",Mr),Mr.success?(console.log(" Drawing test created and assigned successfully!"),r("Drawing test created and assigned successfully!","success"),o(!0),Ie()):(console.error(" Failed to create drawing test:",Mr.message),r("Error creating and assigning drawing test: "+Mr.message,"error")),F(!1);return}if(de==="fillBlanks"){console.log(" Processing fill blanks test..."),console.log(" Setting isAssigningTest to true for fill blanks test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Tr=>setTimeout(Tr,100));const _t=j.fillBlanksData;if(console.log(" Fill blanks test data from formData:",_t),!_t){console.error(" Fill blanks test data not found in formData"),r("Fill blanks test data not found. Please recreate the test.","error");return}console.log(" Fill blanks test data found, processing...");const ur=_t.blanks||[];console.log(" Fill blanks questions array:",ur);const Gr={teacher_id:e.teacher_id,test_type:"fill_blanks",test_name:j.testName,test_text:_t.test_text,num_questions:_t.num_questions,num_blanks:_t.num_blanks,separate_type:_t.separate_type,allowed_time:j.enableTimer?Math.max(0,Math.floor(Number(j.timerMinutes||0)*60)):null,questions:ur,assignments:tt};console.log(" Final fill blanks test data payload:",Gr),console.log(" Calling testService.assignTestToClasses...");const Mr=await Pn.assignTestToClasses(Gr);console.log(" API Response:",Mr),Mr.success?(console.log(" Fill blanks test created and assigned successfully!"),r("Fill blanks test created and assigned successfully!","success"),o(!0),Ie()):(console.error(" Failed to create fill blanks test:",Mr.message),r("Error creating and assigning fill blanks test: "+Mr.message,"error")),F(!1);return}if(de==="speaking"){console.log(" Processing speaking test..."),console.log(" Setting isAssigningTest to true for speaking test..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(Tr=>setTimeout(Tr,100));const _t=j.speakingData;if(console.log(" Speaking test data from formData:",_t),!_t){console.error(" Speaking test data not found in formData"),r("Speaking test data not found. Please recreate the test.","error");return}console.log(" Speaking test data found, processing...");const ur={teacher_id:e.teacher_id,test_type:"speaking",test_name:j.testName,time_limit:_t.time_limit,min_duration:_t.min_duration,max_duration:_t.max_duration,allowed_attempts:_t.allowed_attempts,max_attempts:_t.max_attempts,min_words:_t.min_words,passing_score:_t.passing_score,allowed_time:j.enableTimer?Math.max(0,Math.floor(Number(j.timerMinutes||0)*60)):null,questions:_t.questions,assignments:tt};console.log(" Final speaking test data payload:",ur),console.log(" Calling save-speaking-test-with-assignments for speaking test...");const Mr=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-speaking-test-with-assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ur)})).json();console.log(" API Response:",Mr),Mr.success?(console.log(" Speaking test created and assigned successfully!"),r("Speaking test created and assigned successfully!","success"),o(!0),Ie()):(console.error(" Failed to create speaking test:",Mr.message),r("Error creating and assigning speaking test: "+Mr.message,"error")),F(!1);return}console.log(" Processing non-matching test..."),console.log(" Form data questions:",j.questions);const qt=Object.keys(j.questions).map(_t=>{const ur=j.questions[_t];console.log(` Processing question ${_t}:`,ur);let Gr;if(de==="input")Gr={correct_answers:ur.correct_answers||[ur.correctAnswer||""]};else if(de==="trueFalse"){const Tr=ur.correct_answer||ur.correctAnswer||ur.correct_answers?.[0]||"";Gr={correct_answer:Tr==="true"}}else Gr={correct_answer:ur.correctAnswer||ur.correct_answer||ur.correct_answers?.[0]||""};const Mr={question_id:parseInt(_t),question:ur.question,...Gr,options:ur.options||[]};return console.log(` Question ${_t} correct_answers:`,ur.correct_answers),console.log(` Question ${_t} correctAnswer:`,ur.correctAnswer),console.log(` Converted question ${_t}:`,Mr),Mr});console.log(" Final questions array:",qt);const kr={teacher_id:e.teacher_id,test_type:mRe[de],test_name:j.testName,num_questions:j.numQuestions,num_options:j.numOptions,questions:qt,allowed_time:j.enableTimer?Math.max(0,Math.floor(Number(j.timerMinutes||0)*60)):null,is_shuffled:!!j.isShuffled,assignments:tt};console.log(" Final test data payload:",kr),console.log(" Setting isAssigningTest to true..."),F(!0),console.log(" isAssigningTest set to true, overlay should show"),await new Promise(_t=>setTimeout(_t,100)),console.log(" Calling testService.assignTestToClasses...");const jr=await Pn.assignTestToClasses(kr);console.log(" API Response:",jr),jr.success?(console.log(" Test created and assigned successfully!"),r("Test created and assigned successfully!","success"),console.log("Test created and assigned successfully"),o(!0),Ie()):(console.error(" Failed to create and assign test:",jr.message),r("Error creating and assigning test: "+jr.message,"error"))}catch(De){console.error(" Exception in assignTestToClasses:",De),console.error("Error creating and assigning test:",De),r("Error creating and assigning test. Please try again.","error")}finally{F(!1),C(!1)}console.log(" === ASSIGN TEST TO CLASSES DEBUG END ===")},[e,M,j,r,Ee]),Ie=w.useCallback(async()=>{console.log("returnToMainCabinet called - restoring main cabinet view");try{a(!1),o(!1),u("typeSelection"),g(null),K(null),I([]),B(),z(),Ee(),console.log(" Returned to main cabinet")}catch(de){console.error("Error returning to main cabinet:",de)}},[B,z,Ee]),[ut,Qe]=w.useState([]),[$t,Ge]=w.useState(!1);w.useCallback(async()=>{console.log(" Refreshing active tests data...");try{await ie(),r("Active tests data refreshed.","success")}catch(de){console.error("Error refreshing active tests data:",de),r("Error refreshing data.","error")}},[ie,r]);const[et,vt]=w.useState([]),[Te,Ve]=w.useState([]),[pt,wt]=w.useState(!1),[Ut,ct]=w.useState(!1),yt=w.useCallback(async de=>{if(!e||!e.teacher_id){console.error("No valid teacher session found in displayExistingSubjectsInSelection, redirecting to login");return}console.log("Displaying existing subjects in selection interface:",de),vt(de),console.log(" Existing subjects displayed in selection:",de.length,"subjects")},[e]);w.useCallback(async()=>{try{console.log("Loading existing subjects...");const de=await Xs.getTeacherSubjects();console.log("Existing subjects loaded:",de),de&&de.length>0?yt(de):(console.log("No existing subjects found"),vt([]))}catch(de){console.error("Error loading existing subjects:",de),r("Error loading subjects.","error")}},[r,yt]);const rt=w.useCallback(de=>{console.log("Checking for outside click...");const Se=document.getElementById("dropdownMenu"),De=document.querySelector("[data-menu-button]");Se&&!Se.contains(de.target)&&!De?.contains(de.target)&&(console.log("Outside click detected, closing menu"),Se.classList.remove("show"),document.removeEventListener("click",rt))},[]),[Oe,$e]=w.useState({multipleChoice:{buttonVisible:!1,hintVisible:!1},trueFalse:{buttonVisible:!1,hintVisible:!1},input:{buttonVisible:!1,hintVisible:!1}}),Mt=w.useCallback((de,Se)=>{const De=de.target.files[0];if(!De)return;if(!De.name.match(/\.(xlsx|xls)$/i)){r("Please select a valid Excel file (.xlsx or .xls)","error"),de.target.value="";return}if(De.size>5*1024*1024){r("File is too large. Please select a file smaller than 5MB.","error"),de.target.value="";return}N(!0);const Le=new FileReader;Le.onload=function(tt){try{console.log(" File loaded, processing data...");const qt=new Uint8Array(tt.target.result),kr=w8(qt,{type:"array"}),jr=kr.SheetNames[0],_t=kr.Sheets[jr],ur=D4.sheet_to_json(_t,{header:1});console.log(" Parsed Excel data:",ur),At(ur,Se),N(!1)}catch(qt){console.error("Error processing Excel file:",qt),r("Error reading Excel file: "+qt.message,"error"),de.target.value="",N(!1)}},Le.onerror=function(){r("Failed to read file","error"),de.target.value="",N(!1)},Le.readAsArrayBuffer(De)},[r]),It=w.useCallback(()=>{console.log(" Initializing Excel upload for all test types...");const de=document.querySelectorAll(".excel-upload-btn");console.log(` Found ${de.length} Excel upload buttons`),de.forEach((Se,De)=>{const Le=Se.dataset.testType,tt=document.querySelector(`.excel-file-input[data-test-type="${Le}"]`);console.log(` Processing button ${De+1}: testType=${Le}, fileInput=${tt?"found":"not found"}`),tt?(Se._excelClickHandler&&Se.removeEventListener("click",Se._excelClickHandler),tt._excelChangeHandler&&tt.removeEventListener("change",tt._excelChangeHandler),Se._excelClickHandler=()=>{console.log(` Excel upload button clicked for test type: ${Le}`),tt.click()},tt._excelChangeHandler=qt=>{console.log(` File input changed for test type: ${Le}`),Mt(qt,Le)},Se.addEventListener("click",Se._excelClickHandler),tt.addEventListener("change",tt._excelChangeHandler),console.log(` Excel upload initialized for test type: ${Le}`)):console.warn(` File input not found for test type: ${Le}`)}),console.log(" Excel upload initialization complete")},[Mt]),At=w.useCallback((de,Se)=>{const De=de.filter(_t=>Array.isArray(_t)&&_t.length>0&&_t.some(ur=>ur&&ur.toString().trim()!==""));console.log(" Original Excel data rows:",de.length),console.log(" Filtered Excel data rows:",De.length);const tt=tr(De,Se).dataRows;if(tt.length===0){const _t="No data rows found after header processing. Please check your Excel file.";r(_t,"error"),alert(_t),Be(Se);return}console.log(` Processing Excel data for test type: ${Se}`),console.log(" Data rows after header processing:",tt);const qt=or(tt,Se);if(console.log(" Recognition result:",qt),!qt.recognized){console.log(` Excel data recognition failed for test type: ${Se}`);const _t="Excel data recognition failed. Please check your file format.";r(_t,"error"),alert(_t),Be(Se);return}console.log(` Excel data recognition successful for test type: ${Se}`);const kr=tt.length,jr=Fe(Se);if(jr===0)console.log(` No question count specified, using CSV count: ${kr}`),P(_t=>({..._t,numQuestions:kr}));else if(kr!==jr){const _t=`Your CSV file has ${kr} data rows, but you specified ${jr} questions.

Please either:
1. Change your question count to ${kr}, or
2. Fix your CSV file to have exactly ${jr} data rows

Then try uploading again.`;r(_t,"error"),Be(Se);return}Pe(tt,Se)},[r]),tr=w.useCallback((de,Se)=>{if(de.length===0)return{hasHeaders:!1,headerRow:null,dataRows:de};const De=de[0],Le=ar(Se);if(dr(De,Le).isLikelyHeader){const qt=`The first row of your Excel file looks like it contains headers:

"${De.join(" | ")}"

Does the first row contain column headers?

Click "OK" if YES (headers will be removed)
Click "Cancel" if NO (first row will be treated as data)`;if(window.confirm(qt))return{hasHeaders:!0,headerRow:De,dataRows:de.slice(1)}}return{hasHeaders:!1,headerRow:null,dataRows:de}},[]),ar=w.useCallback(de=>{switch(de){case"multipleChoice":return{keywords:["question","answer","correct","option","a","b","c","d","e","f"],expectedColumns:4};case"trueFalse":return{keywords:["question","answer","correct","true","false"],expectedColumns:2};case"input":return{keywords:["question","answer","correct"],expectedColumns:2};default:return{keywords:[],expectedColumns:0}}},[]),dr=w.useCallback((de,Se)=>{if(!de||de.length===0)return{isLikelyHeader:!1};if(de.length<Se.expectedColumns)return{isLikelyHeader:!1};const De=de.join(" ").toLowerCase(),Le=Se.keywords.filter(qt=>De.includes(qt.toLowerCase()));return{isLikelyHeader:Le.length>Se.keywords.length/2,keywordMatches:Le}},[]),or=w.useCallback((de,Se)=>{if(de.length===0)return r("No data rows found. Please check your Excel file.","error"),{recognized:!1,data:[]};console.log(` Checking data pattern for test type: ${Se}`),console.log(" Excel data to validate:",de);const De=mr(de,Se);if(console.log(" Recognition result:",De),!De.matches){const Le=`Your Excel file doesn't match the expected format.

Required format:
${ve(Se)}

Please review your Excel file and make sure it follows this format exactly.

Then try uploading again.`;return console.log(" Data pattern validation failed:",Le),console.log(" Calling showNotification with message:",Le),r(Le,"error"),console.log(" showNotification called"),alert(Le),{recognized:!1,data:[]}}return console.log(` Data pattern validation passed for test type: ${Se}`),{recognized:!0,data:de}},[r]),mr=w.useCallback((de,Se)=>{if(Se==="multipleChoice")for(let De=0;De<de.length;De++){const Le=de[De];if(Le.length<4)return{matches:!1,issue:`Row ${De+1} has ${Le.length} columns but needs at least 4`};if(!Le[0]||Le[0].toString().trim()==="")return{matches:!1,issue:`Row ${De+1} has no question in column 1`};if(!Le[1]||Le[1].toString().trim()==="")return{matches:!1,issue:`Row ${De+1} has no correct answer in column 2`}}else if(Se==="trueFalse")for(let De=0;De<de.length;De++){const Le=de[De];if(Le.length<2)return{matches:!1,issue:`Row ${De+1} has ${Le.length} columns but needs at least 2`};if(!Le[0]||Le[0].toString().trim()==="")return{matches:!1,issue:`Row ${De+1} has no question in column 1`};const tt=Le[1]?.toString().trim().toLowerCase();if(!tt||!["true","false","t","f"].includes(tt))return{matches:!1,issue:`Row ${De+1} has invalid correct answer in column 2 (must be True/False)`}}else if(Se==="input")for(let De=0;De<de.length;De++){const Le=de[De];if(Le.length<2)return{matches:!1,issue:`Row ${De+1} has ${Le.length} columns but needs at least 2`};if(!Le[0]||Le[0].toString().trim()==="")return{matches:!1,issue:`Row ${De+1} has no question in column 1`};if(!Le[1]||Le[1].toString().trim()==="")return{matches:!1,issue:`Row ${De+1} has no correct answer in column 2`}}return{matches:!0}},[]),ve=w.useCallback(de=>{switch(de){case"multipleChoice":return`Column 1: Question
Column 2: Correct Answer (A, B, C, D, E, or F)
Column 3: Option A
Column 4: Option B
Column 5: Option C (optional)
Column 6: Option D (optional)
Column 7: Option E (optional)
Column 8: Option F (optional)`;case"trueFalse":return`Column 1: Question
Column 2: Correct Answer (True or False)`;case"input":return`Column 1: Question
Column 2: Correct Answer`;default:return"Unknown test type"}},[]),Fe=w.useCallback(de=>j.numQuestions||0,[j.numQuestions]),Be=w.useCallback(de=>{console.log(` Clearing file input for test type: ${de}`)},[]),Pe=w.useCallback((de,Se)=>{switch(console.log(` populateFromExcelForTestType called with testType: ${Se}`),Se){case"multipleChoice":case"multiple-choice":lt(de);break;case"trueFalse":case"true-false":Ct(de);break;case"input":Lt(de);break;default:console.log(` Unknown test type: ${Se}`)}},[]),lt=w.useCallback(de=>{console.log(" populateMultipleChoiceFromExcel called with:",de);const Se=Math.max(...de.map(tt=>tt.length-2)),De=Math.min(Se,6);console.log(` Excel data has ${Se} option columns, using ${De} options`),P(tt=>({...tt,numOptions:De}));const Le={};de.forEach((tt,qt)=>{const kr=qt+1;console.log(` Row ${qt+1} data:`,tt);const jr={question:(tt[0]||"").toString().trim(),options:[],correctAnswer:(tt[1]||"").toString().trim().toUpperCase()};console.log(` Question ${kr} correctAnswer:`,jr.correctAnswer),["A","B","C","D","E","F"].slice(0,De).forEach((Gr,Mr)=>{const Tr=(tt[Mr+2]||"").toString().trim();console.log(` Option ${Mr} (${Gr}):`,Tr),jr.options.push(Tr)}),Le[kr]=jr}),P(tt=>{const qt={...tt,questions:Le};return console.log(" Updating form data with:",qt),qt}),console.log(" Populated multiple choice questions from Excel:",Le),r(`Successfully loaded ${de.length} questions from CSV file!`,"success"),L(),Ue("multiple-choice")},[j.numOptions,L,r]),Ct=w.useCallback(de=>{console.log(" populateTrueFalseFromExcel called with:",de);const Se={};de.forEach((De,Le)=>{const tt=Le+1,qt={question:(De[0]||"").toString().trim(),correctAnswer:De[1]?.toString().trim().toLowerCase()==="true"?"true":"false"};Se[tt]=qt}),P(De=>({...De,questions:Se})),console.log(" Populated true/false questions from Excel:",Se),r(`Successfully loaded ${de.length} questions from CSV file!`,"success"),G(),Ue("true-false")},[G,r]),Lt=w.useCallback(de=>{console.log(" populateInputFromExcel called with:",de);const Se={};de.forEach((De,Le)=>{const tt=Le+1,qt=[];for(let jr=1;jr<De.length;jr++){const _t=(De[jr]||"").toString().trim();_t&&qt.push(_t)}const kr={question:(De[0]||"").toString().trim(),correctAnswer:qt[0]||"",correct_answers:qt};console.log(` Excel question ${tt} data:`,kr),Se[tt]=kr}),P(De=>({...De,questions:Se})),console.log(" Populated input questions from Excel:",Se),r(`Successfully loaded ${de.length} questions from Excel file!`,"success"),W(),Ue("input")},[W,r]),Ue=w.useCallback(de=>{switch(console.log(` Reattaching form event listeners for test type: ${de}`),document.querySelectorAll('[data-listener-attached="true"]').forEach(De=>{De.removeEventListener("input",()=>{}),De.removeAttribute("data-listener-attached")}),de){case"multiple-choice":L();break;case"true-false":G();break;case"input":W();break;default:console.warn("Unknown test type for event listener reattachment:",de)}console.log(` Form event listeners reattached for test type: ${de}`)},[L,G,W]),st=w.useCallback(()=>{const de=localStorage.getItem("test_creation_state");if(!de)return console.log(" No test creation state found in localStorage"),!1;try{const Se=JSON.parse(de);console.log(" Found test creation state:",Se);const De=Date.now()-Se.timestamp,Le=1800*1e3;if(De>Le)return console.log(" Test creation state is too old, clearing it"),z(),!1;switch(a(!0),console.log(" Restored isInTestCreation flag to true"),Z(),Se.excelState&&q(),Se.currentStep){case"testTypeSelection":console.log(" Restoring test type selection step"),u("typeSelection");break;case"multipleChoiceForm":console.log(" Restoring multiple choice form step"),g("multipleChoice"),u("formCreation");break;case"trueFalseForm":console.log(" Restoring true/false form step"),g("trueFalse"),u("formCreation");break;case"inputForm":console.log(" Restoring input form step"),g("input"),u("formCreation");break;case"testAssignment":case"assignment":console.log(" Restoring test assignment step"),console.log(" Cannot restore test assignment step without test data, going back to type selection"),u("typeSelection");break;default:console.log(" Unknown step in state, defaulting to type selection"),u("typeSelection")}return R(Se.currentStep),!0}catch(Se){return console.error(" Error restoring test creation state:",Se),z(),!1}},[z,Z,q,R]);w.useEffect(()=>{console.log(" Initializing Teacher Tests..."),te(),st(),he(),It()},[te,st,he,It]),w.useEffect(()=>{j.numQuestions>0&&h&&h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&(console.log(" Excel upload buttons rendered, initializing event listeners..."),setTimeout(()=>{It()},100))},[j.numQuestions,h,It]);const dt=de=>{console.log(" Test type selected:",de),console.log(" Setting testType to:",de),g(de),u("formCreation"),P({testName:"",numQuestions:0,numOptions:0,questions:{},enableTimer:!1,timerMinutes:""}),J("formCreation"),setTimeout(()=>{It()},100)},Bt=(de,Se)=>{P(De=>({...De,[de]:Se}))},Yt=(de,Se,De)=>{P(Le=>({...Le,questions:{...Le.questions,[de]:{...Le.questions[de],[Se]:De}}}))},xr=w.useCallback((de,Se)=>{P(De=>{const tt=[...De.questions[de]?.options||[]];tt[Se]=null;const qt=String.fromCharCode(65+Se),kr=De.questions[de]?.correctAnswer||"",jr=kr===qt?"":kr;return{...De,questions:{...De.questions,[de]:{...De.questions[de],options:tt,correctAnswer:jr}}}})},[]),Rr=w.useCallback(de=>{P(Se=>{const De=Se.questions[de]?.options||[];if(De.filter(_t=>_t!=null).length>=6)return Se;let tt=[...De];const qt=tt.findIndex(_t=>_t===null);qt!==-1?tt[qt]="":tt.push("");const kr=tt.filter(_t=>_t!=null).length,jr=Math.max(Se.numOptions||0,kr);return{...Se,numOptions:jr,questions:{...Se.questions,[de]:{...Se.questions[de],options:tt}}}})},[]),yr=(de,Se,De,Le=0)=>{const tt={};for(let qt=1;qt<=De;qt++)de==="multipleChoice"?tt[qt]={question:"",options:Array.from({length:Le},()=>""),correctAnswer:""}:de==="trueFalse"?tt[qt]={question:"",correctAnswer:""}:de==="input"&&(tt[qt]={question:"",correct_answers:[""]});P(qt=>({...qt,questions:tt})),de==="multipleChoice"?(Q("multiple-choice"),X("multiple-choice")):de==="trueFalse"?(Q("true-false"),X("true-false")):de==="input"&&(Q("input"),X("input"))},Br=async()=>{if(!h||!j.testName||!j.numQuestions){r("Please fill in all required fields","error");return}console.log(" Test form completed, proceeding to assignment step"),J("testAssignment",j),u("testAssignment"),r("Test form completed! Now select classes and subjects.","success")},me=(de,Se,De,Le,tt)=>{I(De?qt=>[...qt,{grade:de,class:Se,subject_id:Le,subject:tt}]:qt=>qt.filter(kr=>!(kr.grade===de&&kr.class===Se&&kr.subject_id===Le)))},Ne=w.useCallback(async de=>{console.log(" [DEBUG] handleMatchingTestSave called"),console.log(" [DEBUG] Received testData:",de),console.log(" [DEBUG] Current formData:",j),console.log(" [DEBUG] Current testType:",h),console.log(" [DEBUG] Current user:",e),console.log(" [DEBUG] Current currentStep:",c),_(!0);try{const Se=de.blocks.map((tt,qt)=>{const kr=de.words.find(ur=>ur.blockId===tt.id)?.word||`Word ${qt+1}`,jr=de.arrows.some(ur=>ur.startBlock===tt.id),_t=de.arrows.find(ur=>ur.startBlock===tt.id)||null;return{question_id:qt+1,word:kr,block_coordinates:{x:tt.x,y:tt.y,width:tt.width,height:tt.height},has_arrow:jr,arrow:_t?{startX:_t.startX,startY:_t.startY,endX:_t.endX,endY:_t.endY,style:_t.style||{}}:null}}),De={teacher_id:e.teacher_id,test_name:j.testName||`Matching Test - ${new Date().toLocaleString()}`,image_url:de.imageUrl,num_blocks:de.blocks.length,questions:Se,assignments:[]};console.log(" Sending matching test payload:",De);const Le={...j,testName:De.test_name,numQuestions:De.num_blocks,numOptions:0,questions:Se.reduce((tt,qt,kr)=>(tt[kr+1]={question:qt.word,correctAnswer:qt.word,options:[]},tt),{}),matchingTestData:de};console.log(" Assignment form data:",Le),P(Le),J("testAssignment",Le),console.log(" Setting current step to testAssignment"),u("testAssignment"),r("Matching test data saved! Now select classes and subjects.","success")}catch(Se){console.error(" Error saving matching test:",Se),r("Failed to save matching test: "+Se.message,"error")}finally{_(!1)}},[e,j,h,r,J]),be=w.useCallback(()=>{console.log(" Cancelling matching test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Ae=w.useCallback(async de=>{console.log(" [DEBUG] handleWordMatchingTestSave called"),console.log(" [DEBUG] Received testData:",de),_(!0);try{P(Se=>({...Se,wordMatchingData:de,numQuestions:de.numQuestions||de.wordPairs?.length||0})),u("testAssignment"),r("Word matching test created! Now assign it to classes.","success")}catch(Se){console.error("Error saving word matching test:",Se),r("Failed to save word matching test: "+Se.message,"error")}finally{_(!1)}},[r]),ue=w.useCallback(()=>{console.log(" Cancelling word matching test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ge=w.useCallback(async de=>{console.log(" [DEBUG] handleDrawingTestSave called"),console.log(" [DEBUG] Received testData:",de),_(!0);try{P(Se=>({...Se,drawingData:de,numQuestions:de.num_questions||de.questions?.length||0})),u("testAssignment"),r("Drawing test created! Now assign it to classes.","success")}catch(Se){console.error(" Error saving drawing test:",Se),r("Error saving drawing test","error")}finally{_(!1)}},[r]),Me=w.useCallback(()=>{console.log(" Cancelling drawing test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),ot=w.useCallback(()=>{console.log(" Cancelling fill blanks test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),Je=w.useCallback(async de=>{console.log(" [DEBUG] handleFillBlanksTestSave called"),console.log(" [DEBUG] Received testData:",de),_(!0);try{P(Se=>({...Se,fillBlanksData:de,numQuestions:de.num_questions||de.blanks?.length||0})),u("testAssignment"),r("Fill blanks test created! Now assign it to classes.","success")}catch(Se){console.error(" Error saving fill blanks test:",Se),r("Error saving fill blanks test","error")}finally{_(!1)}},[r]),nt=w.useCallback(()=>{console.log(" Cancelling speaking test creation"),u("typeSelection"),P({testName:"",numQuestions:0,numOptions:0,questions:{}})},[]),mt=w.useCallback(async de=>{console.log(" [DEBUG] handleSpeakingTestSave called"),console.log(" [DEBUG] Received testData:",de),_(!0);try{P(Se=>({...Se,speakingData:de,numQuestions:de.questions?.length||0})),u("testAssignment"),r("Speaking test created! Now assign it to classes.","success")}catch(Se){console.error(" Error saving speaking test:",Se),r("Error saving speaking test","error")}finally{_(!1)}},[r]);return l.jsxs("div",{className:"min-h-screen bg-gray-50 py-8",children:[l.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs(Ai,{mode:"wait",children:[c==="typeSelection"&&l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs(at,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsx("div",{className:"flex-1"})]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create New Test"}),l.jsx("p",{className:"text-gray-600",children:"Choose the type of test you want to create"})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[{type:"multipleChoice",title:"Multiple Choice",description:"Questions with multiple answer options",icon:"/pics/multiple-choice.png"},{type:"trueFalse",title:"True/False",description:"Questions with true or false answers",icon:"/pics/true-false.png"},{type:"input",title:"Input",description:"Questions requiring text input",icon:"/pics/input.png"},{type:"matching",title:"Picture Matching",description:"Labeling pictures",icon:"/pics/matching.png"},{type:"wordMatching",title:"Word Matching",description:"Matching word pairs by dragging or drawing arrows",icon:"/pics/matching-words.png"},{type:"drawing",title:"Drawing Test",description:"Interactive drawing tests with canvas for students",icon:"/pics/drawing.png"},{type:"fillBlanks",title:"Fill Blanks",description:"Text with multiple choice blanks",icon:"/pics/fill-blanks.png"},{type:"speaking",title:"Speaking Test",description:"Audio recording with AI-powered feedback",icon:"/pics/speaking.png"}].map(({type:de,title:Se,description:De,icon:Le})=>l.jsx(Ze.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"cursor-pointer",onClick:()=>dt(de),children:l.jsxs(Kt,{className:"h-full text-center hover:shadow-lg transition-shadow",children:[l.jsx("div",{className:"mb-3 flex justify-center",children:l.jsx("img",{src:Le,alt:Se,className:"w-12 h-12 object-contain"})}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:Se}),l.jsx("p",{className:"text-sm text-gray-600",children:De})]})},de))})]}),c==="formCreation"&&l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"flex space-x-2",children:l.jsx(at,{variant:"outline",onClick:re,children:" Back to Test Types"})}),l.jsxs("div",{children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Create ",h==="multipleChoice"?"Multiple Choice":h==="trueFalse"?"True/False":h==="input"?"Input":h==="drawing"?"Drawing":h==="fillBlanks"?"Fill Blanks":h==="wordMatching"?"Word Matching":h==="speaking"?"Speaking":"Picture Matching"," Test"]}),l.jsx("p",{className:"text-gray-600",children:"Fill in the test details and questions"})]})]})}),l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Information"}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Test Name"}),l.jsx("input",{type:"text",value:j.testName,onChange:de=>Bt("testName",de.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test name"})]}),h!=="matching"&&h!=="wordMatching"&&h!=="drawing"&&h!=="fillBlanks"&&h!=="speaking"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"50",value:j.numQuestions,onChange:de=>{const Se=parseInt(de.target.value)||0;Bt("numQuestions",Se),Se>0&&yr(h,j.testName,Se,j.numOptions)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of questions"})]}),h==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Number of Options per Question"}),l.jsx("input",{type:"number",min:"2",max:"6",value:j.numOptions,onChange:de=>{const Se=parseInt(de.target.value)||0;Bt("numOptions",Se),Se>0&&Se<2&&r("Multiple choice tests require at least 2 options per question. Please enter 2 or more.","warning"),j.numQuestions>0&&yr(h,j.testName,j.numQuestions,Se)},className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter number of options (2-6)"})]}),h!=="speaking"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!j.enableTimer,onChange:de=>Bt("enableTimer",de.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Enable timer for this test"})]}),j.enableTimer&&l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm text-gray-700",children:"Time (minutes):"}),l.jsx("input",{type:"number",min:"1",max:"1440",value:j.timerMinutes,onChange:de=>Bt("timerMinutes",de.target.value.replace(/[^0-9]/g,"")),className:"w-28 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 30"})]})]}),h!=="drawing"&&h!=="matching"&&h!=="wordMatching"&&h!=="fillBlanks"&&h!=="speaking"&&l.jsx("div",{className:"flex items-center space-x-2",children:l.jsxs("label",{className:"inline-flex items-center space-x-2",children:[l.jsx("input",{type:"checkbox",checked:!!j.isShuffled,onChange:de=>Bt("isShuffled",de.target.checked),className:"h-4 w-4 text-blue-600 border-gray-300 rounded"}),l.jsx("span",{className:"text-sm text-gray-700",children:"Shuffle questions during test"})]})})]})]})}),h==="matching"&&l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Picture Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an image and create interactive matching blocks with words."}),l.jsx(Kue,{testName:j.testName,onTestSaved:Ne,onCancel:be,onBackToCabinet:Ie,isSaving:b,validationErrors:{}})]})}),h==="wordMatching"&&l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4 text-center",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create Word Matching Test"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Create word pairs for students to match by dragging or drawing arrows."}),l.jsx(Que,{testName:j.testName,onTestSaved:Ae,onCancel:ue,onBackToCabinet:Ie,isSaving:b,validationErrors:{}})]})}),h==="drawing"&&l.jsxs(Kt,{children:[console.log(" Rendering DrawingTestCreator, testType:",h),l.jsx(Ghe,{testName:j.testName,onTestSaved:ge,onCancel:Me,onBackToCabinet:Ie,isSaving:b,validationErrors:{}})]}),h==="fillBlanks"&&l.jsxs(Kt,{children:[console.log(" Rendering FillBlanksTestCreator, testType:",h),l.jsx(mme,{testName:j.testName,allowedTime:j.enableTimer&&parseInt(j.timerMinutes)||null,onTestSaved:Je,onCancel:ot,onBackToCabinet:Ie,isSaving:b,validationErrors:{}})]}),h==="speaking"&&l.jsxs(Kt,{children:[console.log(" Rendering SpeakingTestCreator, testType:",h),l.jsx(hRe,{testName:j.testName,onTestSaved:mt,onCancel:nt,onBackToCabinet:Ie,isSaving:b,validationErrors:{}})]}),h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&h!=="speaking"&&j.numQuestions>0&&l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Excel Upload"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Upload an Excel file to automatically populate questions, or fill them in manually below."}),l.jsxs("div",{className:"space-y-6",children:[h==="multipleChoice"&&Oe.multipleChoice?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"multiple-choice",disabled:T,children:T?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"multiple-choice"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Multiple Choice Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Correct Answer (A-F)"}),l.jsx("div",{children:"Column 3: Option A text"}),l.jsx("div",{children:"Column 4: Option B text"}),l.jsx("div",{children:"Column 5: Option C text"}),l.jsx("div",{children:"Column 6: Option D text"})]})]})})})]}),h==="trueFalse"&&Oe.trueFalse?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"true-false",disabled:T,children:T?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"true-false"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-xs text-blue-800",children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Format:"})," Question | Answer (true/false)"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Example:"})," The Earth is round | true"]}),l.jsxs("div",{className:"mt-1",children:[l.jsx("strong",{children:"Note:"})," Headers are optional"]})]})})})]}),h==="input"&&Oe.input?.buttonVisible&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsxs("div",{className:"flex flex-col items-center",children:[l.jsx("button",{type:"button",className:"excel-upload-btn px-6 py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 shadow-md hover:shadow-lg transition-all duration-200 flex items-center space-x-3 min-h-[60px] disabled:opacity-50 disabled:cursor-not-allowed","data-test-type":"input",disabled:T,children:T?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white"}),l.jsx("span",{className:"font-medium",children:"Processing..."})]}):l.jsxs(l.Fragment,{children:[l.jsx("img",{src:"/pics/excel.png",alt:"Excel",className:"w-6 h-6 object-contain"}),l.jsx("span",{className:"font-medium",children:"Upload Excel"})]})}),l.jsx("input",{type:"file",accept:".xlsx,.xls",className:"excel-file-input hidden","data-test-type":"input"})]}),l.jsx("div",{className:"w-fit",children:l.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-md min-h-[60px] flex items-start",children:l.jsxs("div",{className:"text-sm text-blue-800",children:[l.jsx("strong",{children:"Input Test Format:"}),l.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1 text-xs",children:[l.jsx("div",{children:"Column 1: Question"}),l.jsx("div",{children:"Column 2: Answer 1"}),l.jsx("div",{children:"Column 3: Answer 2 (optional)"})]})]})})})]})]})]})}),h!=="matching"&&h!=="drawing"&&h!=="fillBlanks"&&j.numQuestions>0&&l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manual Question Entry"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Fill in the questions manually using the form below."})]})}),j.numQuestions>0&&l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Questions"}),l.jsx("div",{className:"space-y-6",children:Object.keys(j.questions).map(de=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Question ",de]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question Text"}),l.jsxs("div",{className:"relative",children:[l.jsx("textarea",{value:j.questions[de]?.question||"",onChange:Se=>Yt(de,"question",Se.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2",placeholder:"Enter the question text",id:`question_${de}`}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`question_${de}`),onChange:Se=>Yt(de,"question",Se.target.value)})]})]}),h==="multipleChoice"&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options"}),l.jsx("div",{className:"space-y-2",children:j.questions[de]?.options?.map((Se,De)=>{const Le=De<2;return Se===null&&!Le?null:l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("span",{className:"w-6 text-sm font-medium text-gray-700",children:[String.fromCharCode(65+De),":"]}),l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",value:Se||"",onChange:qt=>{const kr=[...j.questions[de].options];kr[De]=qt.target.value,Yt(de,"options",kr)},className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Option ${String.fromCharCode(65+De)}`,id:`option_${de}_${De}`}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`option_${de}_${De}`),onChange:qt=>{const kr=[...j.questions[de].options];kr[De]=qt.target.value,Yt(de,"options",kr)}})]}),!Le&&l.jsx("button",{type:"button",onClick:()=>xr(de,De),style:{background:"#dc3545",border:"1px solid #dc3545",borderRadius:"4px",cursor:"pointer",fontSize:"18px",fontWeight:"bold",color:"#ffffff",padding:"4px 10px",lineHeight:"1",display:"flex",alignItems:"center",justifyContent:"center",minWidth:"32px",height:"32px",transition:"all 0.2s",flexShrink:0},onMouseEnter:qt=>{qt.target.style.background="#c82333",qt.target.style.borderColor="#c82333"},onMouseLeave:qt=>{qt.target.style.background="#dc3545",qt.target.style.borderColor="#dc3545"},title:"Delete this option",children:""})]},De)})}),(j.questions[de]?.options||[]).filter(tt=>tt!=null).length<6?l.jsx("button",{type:"button",onClick:()=>Rr(de),className:"mt-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm font-medium transition-colors",children:"+ Add Option"}):null]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer"}),h==="multipleChoice"?l.jsx("div",{children:l.jsxs("select",{value:j.questions[de]?.correctAnswer||"",onChange:Se=>Yt(de,"correctAnswer",Se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),j.questions[de]?.options?.map((Se,De)=>({option:Se,index:De})).filter(({option:Se})=>Se!==null&&Se!==""&&Se!==void 0).map(({index:Se})=>l.jsx("option",{value:String.fromCharCode(65+Se),children:String.fromCharCode(65+Se)},Se))]})}):h==="trueFalse"?l.jsxs("select",{value:j.questions[de]?.correctAnswer||"",onChange:Se=>Yt(de,"correctAnswer",Se.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[l.jsx("option",{value:"",children:"Select correct answer"}),l.jsx("option",{value:"true",children:"True"}),l.jsx("option",{value:"false",children:"False"})]}):l.jsxs("div",{className:"space-y-2",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correct Answer(s)"}),l.jsxs("div",{className:"space-y-2",children:[l.jsxs("div",{className:"relative",children:[l.jsx("input",{type:"text",value:j.questions[de]?.correct_answers?.[0]||"",onChange:Se=>{const Le=[...j.questions[de]?.correct_answers||[""]];Le[0]=Se.target.value,Yt(de,"correct_answers",Le)},className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter the primary correct answer",id:`answer_${de}_0`}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`answer_${de}_0`),onChange:Se=>{const Le=[...j.questions[de]?.correct_answers||[""]];Le[0]=Se.target.value,Yt(de,"correct_answers",Le)}})]}),j.questions[de]?.correct_answers?.slice(1).map((Se,De)=>l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx("input",{type:"text",value:Se,onChange:Le=>{const tt=[...j.questions[de]?.correct_answers||[]];tt[De+1]=Le.target.value,Yt(de,"correct_answers",tt)},className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:`Alternative answer ${De+2}`,id:`answer_${de}_${De+1}`}),l.jsx(qo,{showPreview:!0,inputRef:()=>document.getElementById(`answer_${de}_${De+1}`),onChange:Le=>{const tt=[...j.questions[de]?.correct_answers||[]];tt[De+1]=Le.target.value,Yt(de,"correct_answers",tt)}})]}),l.jsx("button",{type:"button",onClick:()=>{const Le=[...j.questions[de]?.correct_answers||[]];Le.splice(De+1,1),Yt(de,"correct_answers",Le)},className:"px-2 py-1 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]},De))||[],l.jsx("button",{type:"button",onClick:()=>{const De=[...j.questions[de]?.correct_answers||[""],""];Yt(de,"correct_answers",De)},className:"px-3 py-1 text-blue-600 hover:text-blue-800 text-sm border border-blue-300 rounded-md hover:bg-blue-50",children:"+ Add Alternative Answer"})]}),l.jsx("p",{className:"text-xs text-gray-500",children:"You can add multiple correct answers for the same question. Students will get credit for any of them."})]})]})]})]},de))})]})}),j.testName&&j.numQuestions>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(at,{onClick:Br,disabled:b,className:"px-8",children:b?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white",className:"mr-2"}),"Saving Test..."]}):"Save Test & Continue to Assignment"})})]}),c==="testAssignment"&&l.jsxs(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs(at,{variant:"outline",onClick:()=>window.history.back(),className:"flex items-center space-x-2",children:[l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),l.jsx("span",{children:"Back to Main"})]}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Assign Test to Classes"}),l.jsx("p",{className:"text-gray-600",children:"Select which classes should take this test"})]})]}),l.jsx(at,{variant:"outline",onClick:()=>u("formCreation"),children:" Back to Test Form"})]}),l.jsx(Kt,{children:l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Available Classes"}),p.length===0?l.jsxs("div",{className:"text-center py-8",children:[l.jsx("div",{className:"text-6xl mb-4",children:""}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No subjects available for assignment."}),l.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"You need to assign subjects to grades and classes first."}),l.jsx("div",{className:"mt-4",children:l.jsx(at,{onClick:()=>window.location.href="/teacher/subjects",className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Go to Subjects Page"})})]}):l.jsx("div",{className:"space-y-6",children:p.map(de=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:de.subject}),l.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-2",children:de.classes.map(Se=>l.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:M.some(De=>De.grade===Se.grade&&De.class===Se.class&&De.subject_id===de.subject_id),onChange:De=>me(Se.grade,Se.class,De.target.checked,de.subject_id,de.subject),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),l.jsxs("span",{className:"text-sm text-gray-700",children:[Se.grade,"/",Se.class]})]},`${Se.grade}-${Se.class}-${de.subject_id}`))})]},de.subject_id))})]})}),M.length>0&&l.jsx("div",{className:"flex justify-end",children:l.jsx(at,{onClick:()=>ye(h,null),disabled:v,className:"px-8",children:v?l.jsxs(l.Fragment,{children:[l.jsx(Xr,{size:"sm",color:"white",className:"mr-2"}),"Assigning Test..."]}):`Assign Test to ${M.length} Class${M.length>1?"es":""}`})})]})]})}),console.log(" Checking isAssigningTest:",E),E&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Assigning test to classes..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we process your assignment"})]})}),b&&l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-90 flex items-center justify-center z-50",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-200 border-t-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-blue-600 font-semibold text-lg",children:"Saving test..."}),l.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Please wait while we save your test"})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:t.map(de=>l.jsx(bu,{type:de.type,message:de.message,duration:de.duration,onClose:()=>n(de.id)},de.id))})]})},gRe=({onDataLoaded:e,onError:t})=>{const r=Za(),{user:n,isAuthenticated:s}=ws(),{teacherData:a,loadTeacherData:i}=XS(),[o,c]=w.useState(!0),[u,d]=w.useState(""),[f,h]=w.useState([]),[g,p]=w.useState(null),[x,v]=w.useState([]),[C,b]=w.useState([]),[_,T]=w.useState([]),[N,E]=w.useState(null),[F,j]=w.useState(0);w.useEffect(()=>{te()},[]),w.useCallback(async Z=>{console.log(" Teacher login attempt...");try{const B=await Xs.teacherLogin(Z);if(B.success)return K("Login successful!","success"),await P(),B;throw new Error(B.error||"Login failed")}catch(B){throw console.error(" Teacher login error:",B),K("Login failed. Please check your credentials.","error"),B}},[]);const P=w.useCallback(async()=>{console.log(" Loading teacher data...");try{if(c(!0),d(""),!s||!n){console.log(" User not authenticated"),d("User not authenticated");return}if(n.role!==Ko.TEACHER){console.error(" Invalid user role for teacher data:",n.role),d("Access denied. Teacher role required.");return}console.log(" Fetching teacher data from service...");const Z=await Xs.getTeacherData();if(Z&&Z.success)console.log(" Teacher data loaded successfully:",Z),p(Z.teacher||n),Z.subjects&&(v(Z.subjects),console.log(" Teacher subjects loaded:",Z.subjects.length)),Z.grades&&b(Z.grades),Z.classes&&T(Z.classes),E(new Date),j(B=>B+1),e&&e(Z),K("Teacher data loaded successfully!","success");else throw new Error(Z?.error||"Failed to load teacher data")}catch(Z){console.error(" Error loading teacher data:",Z);const B=Z.message||"Failed to load teacher data";d(B),t&&t(Z),K(B,"error")}finally{c(!1)}},[s,n,e,t]),M=w.useCallback(()=>{console.log(" Returning to main cabinet..."),r("/teacher/cabinet")},[r]);w.useCallback(Z=>{console.log(" Showing main cabinet with subjects:",Z),Z&&v(Z),r("/teacher/cabinet")},[r]);const I=w.useCallback(()=>(console.log(" Rendering grade buttons..."),["M1","M2","M3","M4","M5","M6"].map(B=>({id:B,name:`Grade ${B}`,classes:U(B)}))),[]),U=w.useCallback(Z=>Array.from({length:10},(J,z)=>z+1).map(J=>({id:`${Z}-${J}`,name:`Class ${J}`,grade:Z,classNumber:J})),[]),K=w.useCallback((Z,B)=>{const J={id:Date.now(),message:Z,type:B,timestamp:new Date};h(z=>[...z,J]),setTimeout(()=>{h(z=>z.filter(q=>q.id!==J.id))},pg.NOTIFICATION_DURATION)},[]),te=w.useCallback(async()=>{console.log(" Initializing teacher data..."),await P()},[P]),re=w.useCallback(async()=>{console.log(" Refreshing teacher data..."),await P()},[P]);return w.useCallback(async Z=>{console.log(" Updating teacher profile:",Z);try{const B=await Xs.updateUserProfile(Z);if(B.success)return p(J=>({...J,...Z})),K("Profile updated successfully!","success"),B;throw new Error(B.error||"Failed to update profile")}catch(B){throw console.error(" Error updating teacher profile:",B),K("Failed to update profile","error"),B}},[]),w.useCallback(async Z=>{console.log(" Changing teacher password...");try{const B=await Xs.changePassword(Z);if(B.success)return K("Password changed successfully!","success"),B;throw new Error(B.error||"Failed to change password")}catch(B){throw console.error(" Error changing teacher password:",B),K("Failed to change password","error"),B}},[]),o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Data..."})]})}):u?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Data Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:u}),l.jsxs("div",{className:"flex space-x-3 justify-center",children:[l.jsx(at,{variant:"primary",onClick:re,children:"Retry"}),l.jsx(at,{variant:"outline",onClick:M,children:"Go Back"})]})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Teacher Data"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",N?N.toLocaleString():"Never"," | Version: ",F]})]}),l.jsxs("div",{className:"flex space-x-3",children:[l.jsx(at,{variant:"outline",onClick:re,children:"Refresh Data"}),l.jsx(at,{variant:"outline",onClick:M,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Teacher Information"}),g?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Name:"}),l.jsx("p",{className:"text-sm text-gray-900",children:g.name||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Username:"}),l.jsx("p",{className:"text-sm text-gray-900",children:g.username||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Email:"}),l.jsx("p",{className:"text-sm text-gray-900",children:g.email||"N/A"})]}),l.jsxs("div",{children:[l.jsx("span",{className:"text-sm font-medium text-gray-500",children:"Role:"}),l.jsx("p",{className:"text-sm text-gray-900",children:g.role||"N/A"})]})]}):l.jsx("p",{className:"text-gray-500",children:"No teacher information available"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Subjects (",x.length,")"]}),x.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((Z,B)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900",children:Z.name}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Z.description||"No description"}),Z.classes&&Z.classes.length>0&&l.jsxs("div",{className:"mt-2",children:[l.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:Z.classes.map((J,z)=>l.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:[J.grade," - ",J.className]},z))})]})]},B))}):l.jsx("p",{className:"text-gray-500",children:"No subjects assigned"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Grade Levels"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:I().map(Z=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[l.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:Z.name}),l.jsx("div",{className:"grid grid-cols-5 gap-1",children:Z.classes.map(B=>l.jsx("button",{className:"px-2 py-1 text-xs bg-gray-100 hover:bg-gray-200 rounded transition-colors",onClick:()=>console.log("Class clicked:",B),children:B.classNumber},B.id))})]},Z.id))})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data Statistics"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-blue-600",children:x.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Subjects"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-green-600",children:C.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Grades"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-yellow-600",children:_.length}),l.jsx("p",{className:"text-sm text-gray-500",children:"Classes"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-semibold text-purple-600",children:F}),l.jsx("p",{className:"text-sm text-gray-500",children:"Data Version"})]})]})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:f.map(Z=>l.jsx(bu,{type:Z.type,message:Z.message,onClose:()=>h(B=>B.filter(J=>J.id!==Z.id))},Z.id))})]})},pRe=({onBackToCabinet:e})=>{const t=Za(),{user:r,isAuthenticated:n}=ws(),{teacherData:s}=XS(),[a,i]=w.useState(!0),[o,c]=w.useState(""),[u,d]=w.useState([]),[f,h]=w.useState([]),[g,p]=w.useState([]),[x,v]=w.useState([]),[C,b]=w.useState(null),[_,T]=w.useState([]),[N,E]=w.useState(!1),[F,j]=w.useState(!1),[P,M]=w.useState(!1),[I,U]=w.useState(!1),[K,te]=w.useState(null),[re,Z]=w.useState(!0),[B,J]=w.useState(null);w.useEffect(()=>{Qe()},[]),w.useCallback(Ge=>{console.log(" Rendering existing subjects:",Ge),h(Ge)},[]);const z=w.useCallback(()=>{console.log(" Showing subject selection prompt..."),E(!0),Z(!1),q()},[]),q=w.useCallback(async()=>{console.log(" Loading existing subjects...");try{const Ge=await Xs.getTeacherSubjects();Ge.success&&Ge.subjects&&Ge.subjects.length>0?(console.log(" Existing subjects found:",Ge.subjects),H(Ge.subjects)):(console.log(" No existing subjects found"),v([]))}catch(Ge){console.error(" Error loading existing subjects:",Ge),ut("Failed to load existing subjects","error")}},[]),H=w.useCallback(Ge=>{console.log(" Rendering subject selection:",Ge);const et=[];Ge.forEach(vt=>{vt.classes&&Array.isArray(vt.classes)&&vt.classes.forEach(Te=>{et.push({id:`${vt.subject_id}-${Te.grade}-${Te.class}`,subjectId:vt.subject_id,subjectName:vt.subject,grade:Te.grade,class:Te.class,displayText:`${vt.subject} - ${Te.grade}/${Te.class}`})})}),v(et),console.log(" Processed subjects for selection:",et)},[]),R=w.useCallback(async Ge=>{if(console.log(" Saving teacher subjects:",Ge),!Ge||Ge.length===0){ut("Please select at least one subject and class combination.","warning");return}try{const et=Ge.reduce((Te,Ve)=>{const pt=Te.find(wt=>wt.subject_id===Ve.subjectId);return pt?pt.classes.push({grade:Ve.grade,class:Ve.class}):Te.push({subject_id:Ve.subjectId,classes:[{grade:Ve.grade,class:Ve.class}]}),Te},[]);console.log(" Transformed data for backend:",et);const vt=await Xs.saveTeacherSubjects(et);if(vt.success)ut("Subjects saved successfully!","success"),E(!1),Z(!0),J(new Date),await q();else throw new Error(vt.error||"Failed to save subjects")}catch(et){console.error(" Error saving subjects:",et),ut("Error saving subjects. Please try again.","error")}},[]),L=w.useCallback(()=>{console.log(" Toggling subject dropdown..."),j(Ge=>!Ge),M(!1)},[]),G=w.useCallback(async()=>{console.log(" Loading subjects for dropdown...");try{const Ge=await Xs.getAllSubjects();if(Ge.success)p(Ge.subjects||[]),console.log(" Available subjects loaded:",Ge.subjects?.length||0);else throw new Error(Ge.error||"Failed to load subjects")}catch(Ge){console.error(" Error loading subjects for dropdown:",Ge),ut("Failed to load subjects","error")}},[]),W=w.useCallback(Ge=>{console.log(" Subject selected:",Ge);const et=g.find(vt=>vt.subject_id===parseInt(Ge));et&&(b(et),M(!0),j(!1),Q())},[g]),Q=w.useCallback(()=>{console.log(" Loading grades and classes...")},[]),X=w.useCallback((Ge,et)=>{console.log(" Saving classes for subject:",Ge,et);const vt={id:`${Ge.subject_id}-${Date.now()}`,subjectId:Ge.subject_id,subjectName:Ge.subject,grade:et.grade,class:et.class,displayText:`${Ge.subject} - ${et.grade}/${et.class}`};v(Te=>[...Te,vt]),b(null),T([]),M(!1),le(`Added ${Ge.subject} for ${et.grade}/${et.class}`)},[]),se=w.useCallback(()=>{console.log(" Resetting subject selection..."),b(null),T([]),j(!1),M(!1)},[]),le=w.useCallback(Ge=>{console.log(" Showing message:",Ge),ut(Ge,"success")},[]),he=w.useCallback(Ge=>{console.log(" Showing confirmation modal:",Ge),te(Ge),U(!0)},[]),we=w.useCallback(()=>{console.log(" Hiding confirmation modal..."),U(!1),te(null)},[]),ie=w.useCallback(()=>{console.log(" Confirming save subjects..."),we(),R(x)},[x,R,we]),Ee=w.useCallback(()=>{console.log(" Cancelling save subjects..."),we()},[we]),ye=w.useCallback(Ge=>{console.log(" Removing subject:",Ge),v(et=>et.filter(vt=>vt.id!==Ge)),ut("Subject removed","info")},[]);w.useCallback(()=>{console.log(" Showing edit subjects button..."),Z(!0)},[]),w.useCallback(()=>{console.log(" Hiding edit subjects button..."),Z(!1)},[]);const Ie=w.useCallback(Ge=>{console.log(" Generating class buttons for grade:",Ge);let et;return Ge===1||Ge===2?et=["15","16"]:Ge===3?et=["15","16"]:Ge===4?et=["13","14"]:Ge===5||Ge===6?et=["13","14"]:et=[],et.map(vt=>({id:`${Ge}-${vt}`,grade:Ge,class:vt,displayText:`${Ge}/${vt}`}))},[]);w.useCallback((Ge,et)=>{console.log(" Showing class results:",Ge,et),t("/teacher/results")},[t]);const ut=w.useCallback((Ge,et)=>{const vt={id:Date.now(),message:Ge,type:et,timestamp:new Date};d(Te=>[...Te,vt]),setTimeout(()=>{d(Te=>Te.filter(Ve=>Ve.id!==vt.id))},pg.NOTIFICATION_DURATION)},[]),Qe=w.useCallback(async()=>{console.log(" Initializing teacher subjects...");try{if(i(!0),c(""),!n||!r){console.log(" User not authenticated"),c("User not authenticated");return}if(r.role!==Ko.TEACHER){console.error(" Invalid user role for teacher subjects:",r.role),c("Access denied. Teacher role required.");return}await q(),await G(),console.log(" Teacher subjects initialization complete!")}catch(Ge){console.error(" Error initializing teacher subjects:",Ge),c("Failed to initialize teacher subjects")}finally{i(!1)}},[n,r,q,G]),$t=w.useCallback(()=>{e?e():t("/teacher/cabinet")},[e,t]);return a?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Xr,{size:"lg"}),l.jsx("p",{className:"mt-4 text-gray-600",children:"Loading Teacher Subjects..."})]})}):o?l.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:l.jsx("div",{className:"text-center",children:l.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 max-w-md",children:[l.jsx("h2",{className:"text-lg font-semibold text-red-800 mb-2",children:"Subjects Error"}),l.jsx("p",{className:"text-red-600 mb-4",children:o}),l.jsx(at,{variant:"primary",onClick:()=>window.location.reload(),children:"Retry"})]})})}):l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Subject Management"}),l.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Last updated: ",B?B.toLocaleString():"Never"]})]}),l.jsxs("div",{className:"flex space-x-3",children:[re&&l.jsx(at,{variant:"primary",onClick:z,children:"Edit Subjects"}),l.jsx(at,{variant:"outline",onClick:$t,children:"Back to Cabinet"})]})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:l.jsxs("div",{className:"space-y-6",children:[!N&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Your Assigned Subjects"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your teaching subjects and class assignments"})]}),l.jsx("div",{className:"flex space-x-3",children:l.jsxs(at,{variant:"primary",onClick:z,className:"px-6 py-2",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Subjects"]})})]}),f.length>0?l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((Ge,et)=>l.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:Ge.subject}),Ge.classes&&Ge.classes.length>0&&l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-2",children:"Assigned Classes:"}),l.jsx("div",{className:"flex flex-wrap gap-2",children:Ge.classes.map((vt,Te)=>l.jsxs("span",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded-full",children:["Grade ",vt.grade," - Class ",vt.class]},Te))})]})]}),l.jsx("div",{className:"ml-4",children:l.jsx(at,{variant:"outline",size:"sm",onClick:()=>ye(Ge.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]})},et))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mx-auto w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:l.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No subjects assigned yet"}),l.jsx("p",{className:"text-gray-500 mb-6",children:"Get started by adding your teaching subjects and class assignments"}),l.jsxs(at,{variant:"primary",onClick:z,className:"px-6 py-3",children:[l.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add Your First Subject"]})]})]}),N&&l.jsxs("div",{className:`\r
              bg-white rounded-xl shadow-md border border-gray-200 p-6\r
              hover:shadow-lg hover:-translate-y-1 transition-all duration-200\r
            `,children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Select Subjects and Classes"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subjects you want to teach and assign them to specific classes"})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-blue-600 font-semibold text-sm",children:"1"})}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-lg font-semibold text-gray-900",children:"Select Subject"}),l.jsx("p",{className:"text-gray-600",children:"Choose the subject you want to teach"})]})]}),l.jsxs("div",{className:"relative",children:[l.jsxs(at,{variant:"outline",onClick:L,className:"w-full justify-between p-4 h-auto text-left border-2 border-gray-200 hover:border-blue-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white rounded-xl shadow-sm",children:[l.jsx("span",{className:"text-gray-900 font-medium",children:C?C.subject:"Select a subject"}),l.jsx("svg",{className:"w-5 h-5 ml-2 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),F&&l.jsx("div",{className:"absolute z-10 w-full mt-2 bg-white border-2 border-gray-200 rounded-xl shadow-xl max-h-60 overflow-y-auto",children:g.map(Ge=>l.jsx("button",{onClick:()=>W(Ge.subject_id),className:"w-full px-4 py-4 text-left hover:bg-blue-50 focus:bg-blue-50 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:l.jsx("span",{className:"text-gray-900 font-medium",children:Ge.subject})},Ge.subject_id))})]})]}),P&&C&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-6",children:[l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-green-600 font-semibold text-sm",children:"2"})}),l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Select Classes for ",C.subject]}),l.jsx("p",{className:"text-gray-600",children:"Choose which classes you want to teach this subject to"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(Ge=>l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-200 rounded-xl p-6 hover:shadow-md transition-shadow duration-200",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center mr-2",children:l.jsx("span",{className:"text-white font-bold text-xs",children:Ge})}),l.jsxs("h4",{className:"font-semibold text-gray-900",children:["Grade ",Ge]})]}),l.jsx("div",{className:"space-y-3",children:Ie(Ge).map(et=>l.jsx(at,{variant:"outline",size:"sm",onClick:()=>X(C,et),className:"w-full text-sm py-2 px-4 border-green-300 hover:border-green-400 hover:bg-green-100 focus:ring-2 focus:ring-green-500 rounded-lg font-medium",children:et.displayText},et.id))})]},Ge))})]}),x.length>0&&l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3",children:l.jsx("span",{className:"text-purple-600 font-semibold text-sm",children:"3"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Selected Subjects"}),l.jsx("p",{className:"text-gray-600",children:"Review your subject and class selections"})]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:x.map(Ge=>l.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-pink-50 border-2 border-purple-200 rounded-xl p-4 hover:shadow-md transition-shadow duration-200",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("div",{className:"flex-1",children:l.jsx("span",{className:"text-sm font-semibold text-purple-900",children:Ge.displayText})}),l.jsx(at,{variant:"outline",size:"sm",onClick:()=>ye(Ge.id),className:"text-red-600 hover:text-red-700 hover:bg-red-50 border-red-300 focus:ring-2 focus:ring-red-500 rounded-lg",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})},Ge.id))})]}),l.jsxs("div",{className:"flex justify-between items-center pt-6 border-t-2 border-gray-100",children:[l.jsx("div",{className:"text-sm text-gray-500",children:x.length>0?`${x.length} subject${x.length>1?"s":""} selected`:"No subjects selected"}),l.jsxs("div",{className:"flex space-x-4",children:[l.jsxs(at,{variant:"outline",onClick:()=>{E(!1),Z(!0),se()},className:"px-6 py-3 text-sm font-medium text-gray-700 bg-white border-2 border-gray-300 hover:bg-gray-50 focus:ring-2 focus:ring-gray-500 rounded-xl",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),"Cancel"]}),l.jsxs(at,{variant:"primary",onClick:()=>he({type:"save",data:x}),disabled:x.length===0,className:"px-8 py-3 text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-indigo-600 border border-transparent rounded-xl hover:from-blue-700 hover:to-indigo-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:[l.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),P?"Next: Select Classes":"Save Subjects"]})]})]})]})]})]})}),I&&l.jsx(Ds,{isOpen:I,onClose:we,title:"Confirm Save",variant:"confirmation",children:l.jsxs("div",{className:"space-y-4",children:[l.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to save ",K?.data?.length||0," subject assignments?"]}),l.jsxs("div",{className:"flex justify-end space-x-3",children:[l.jsx(at,{variant:"outline",onClick:Ee,children:"Cancel"}),l.jsx(at,{variant:"primary",onClick:ie,children:"Save"})]})]})}),l.jsx("div",{className:"fixed top-4 right-4 space-y-2 z-50",children:u.map(Ge=>l.jsx(bu,{type:Ge.type,message:Ge.message,onClose:()=>d(et=>et.filter(vt=>vt.id!==Ge.id))},Ge.id))})]})};function RZ(e,t){return function(){return e.apply(t,arguments)}}const{toString:xRe}=Object.prototype,{getPrototypeOf:Oj}=Object,{iterator:I3,toStringTag:OZ}=Symbol,L3=(e=>t=>{const r=xRe.call(t);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),Tu=e=>(e=e.toLowerCase(),t=>L3(t)===e),B3=e=>t=>typeof t===e,{isArray:lx}=Array,N1=B3("undefined");function bb(e){return e!==null&&!N1(e)&&e.constructor!==null&&!N1(e.constructor)&&kl(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const DZ=Tu("ArrayBuffer");function yRe(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&DZ(e.buffer),t}const vRe=B3("string"),kl=B3("function"),IZ=B3("number"),wb=e=>e!==null&&typeof e=="object",bRe=e=>e===!0||e===!1,B4=e=>{if(L3(e)!=="object")return!1;const t=Oj(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(OZ in e)&&!(I3 in e)},wRe=e=>{if(!wb(e)||bb(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},_Re=Tu("Date"),SRe=Tu("File"),kRe=Tu("Blob"),CRe=Tu("FileList"),TRe=e=>wb(e)&&kl(e.pipe),NRe=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||kl(e.append)&&((t=L3(e))==="formdata"||t==="object"&&kl(e.toString)&&e.toString()==="[object FormData]"))},ERe=Tu("URLSearchParams"),[ARe,jRe,PRe,FRe]=["ReadableStream","Request","Response","Headers"].map(Tu),MRe=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function _b(e,t,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,s;if(typeof e!="object"&&(e=[e]),lx(e))for(n=0,s=e.length;n<s;n++)t.call(null,e[n],n,e);else{if(bb(e))return;const a=r?Object.getOwnPropertyNames(e):Object.keys(e),i=a.length;let o;for(n=0;n<i;n++)o=a[n],t.call(null,e[o],o,e)}}function LZ(e,t){if(bb(e))return null;t=t.toLowerCase();const r=Object.keys(e);let n=r.length,s;for(;n-- >0;)if(s=r[n],t===s.toLowerCase())return s;return null}const Tm=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,BZ=e=>!N1(e)&&e!==Tm;function c7(){const{caseless:e,skipUndefined:t}=BZ(this)&&this||{},r={},n=(s,a)=>{const i=e&&LZ(r,a)||a;B4(r[i])&&B4(s)?r[i]=c7(r[i],s):B4(s)?r[i]=c7({},s):lx(s)?r[i]=s.slice():(!t||!N1(s))&&(r[i]=s)};for(let s=0,a=arguments.length;s<a;s++)arguments[s]&&_b(arguments[s],n);return r}const RRe=(e,t,r,{allOwnKeys:n}={})=>(_b(t,(s,a)=>{r&&kl(s)?e[a]=RZ(s,r):e[a]=s},{allOwnKeys:n}),e),ORe=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),DRe=(e,t,r,n)=>{e.prototype=Object.create(t.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),r&&Object.assign(e.prototype,r)},IRe=(e,t,r,n)=>{let s,a,i;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),a=s.length;a-- >0;)i=s[a],(!n||n(i,e,t))&&!o[i]&&(t[i]=e[i],o[i]=!0);e=r!==!1&&Oj(e)}while(e&&(!r||r(e,t))&&e!==Object.prototype);return t},LRe=(e,t,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=t.length;const n=e.indexOf(t,r);return n!==-1&&n===r},BRe=e=>{if(!e)return null;if(lx(e))return e;let t=e.length;if(!IZ(t))return null;const r=new Array(t);for(;t-- >0;)r[t]=e[t];return r},$Re=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Oj(Uint8Array)),URe=(e,t)=>{const n=(e&&e[I3]).call(e);let s;for(;(s=n.next())&&!s.done;){const a=s.value;t.call(e,a[0],a[1])}},zRe=(e,t)=>{let r;const n=[];for(;(r=e.exec(t))!==null;)n.push(r);return n},WRe=Tu("HTMLFormElement"),HRe=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,s){return n.toUpperCase()+s}),oU=(({hasOwnProperty:e})=>(t,r)=>e.call(t,r))(Object.prototype),GRe=Tu("RegExp"),$Z=(e,t)=>{const r=Object.getOwnPropertyDescriptors(e),n={};_b(r,(s,a)=>{let i;(i=t(s,a,e))!==!1&&(n[a]=i||s)}),Object.defineProperties(e,n)},VRe=e=>{$Z(e,(t,r)=>{if(kl(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(kl(n)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},qRe=(e,t)=>{const r={},n=s=>{s.forEach(a=>{r[a]=!0})};return lx(e)?n(e):n(String(e).split(t)),r},KRe=()=>{},YRe=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function XRe(e){return!!(e&&kl(e.append)&&e[OZ]==="FormData"&&e[I3])}const JRe=e=>{const t=new Array(10),r=(n,s)=>{if(wb(n)){if(t.indexOf(n)>=0)return;if(bb(n))return n;if(!("toJSON"in n)){t[s]=n;const a=lx(n)?[]:{};return _b(n,(i,o)=>{const c=r(i,s+1);!N1(c)&&(a[o]=c)}),t[s]=void 0,a}}return n};return r(e,0)},QRe=Tu("AsyncFunction"),ZRe=e=>e&&(wb(e)||kl(e))&&kl(e.then)&&kl(e.catch),UZ=((e,t)=>e?setImmediate:t?((r,n)=>(Tm.addEventListener("message",({source:s,data:a})=>{s===Tm&&a===r&&n.length&&n.shift()()},!1),s=>{n.push(s),Tm.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",kl(Tm.postMessage)),eOe=typeof queueMicrotask<"u"?queueMicrotask.bind(Tm):typeof process<"u"&&process.nextTick||UZ,tOe=e=>e!=null&&kl(e[I3]),Ot={isArray:lx,isArrayBuffer:DZ,isBuffer:bb,isFormData:NRe,isArrayBufferView:yRe,isString:vRe,isNumber:IZ,isBoolean:bRe,isObject:wb,isPlainObject:B4,isEmptyObject:wRe,isReadableStream:ARe,isRequest:jRe,isResponse:PRe,isHeaders:FRe,isUndefined:N1,isDate:_Re,isFile:SRe,isBlob:kRe,isRegExp:GRe,isFunction:kl,isStream:TRe,isURLSearchParams:ERe,isTypedArray:$Re,isFileList:CRe,forEach:_b,merge:c7,extend:RRe,trim:MRe,stripBOM:ORe,inherits:DRe,toFlatObject:IRe,kindOf:L3,kindOfTest:Tu,endsWith:LRe,toArray:BRe,forEachEntry:URe,matchAll:zRe,isHTMLForm:WRe,hasOwnProperty:oU,hasOwnProp:oU,reduceDescriptors:$Z,freezeMethods:VRe,toObjectSet:qRe,toCamelCase:HRe,noop:KRe,toFiniteNumber:YRe,findKey:LZ,global:Tm,isContextDefined:BZ,isSpecCompliantForm:XRe,toJSONObject:JRe,isAsyncFn:QRe,isThenable:ZRe,setImmediate:UZ,asap:eOe,isIterable:tOe};function Cn(e,t,r,n,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),r&&(this.config=r),n&&(this.request=n),s&&(this.response=s,this.status=s.status?s.status:null)}Ot.inherits(Cn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Ot.toJSONObject(this.config),code:this.code,status:this.status}}});const zZ=Cn.prototype,WZ={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{WZ[e]={value:e}});Object.defineProperties(Cn,WZ);Object.defineProperty(zZ,"isAxiosError",{value:!0});Cn.from=(e,t,r,n,s,a)=>{const i=Object.create(zZ);Ot.toFlatObject(e,i,function(d){return d!==Error.prototype},u=>u!=="isAxiosError");const o=e&&e.message?e.message:"Error",c=t==null&&e?e.code:t;return Cn.call(i,o,c,r,n,s),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",a&&Object.assign(i,a),i};const rOe=null;function u7(e){return Ot.isPlainObject(e)||Ot.isArray(e)}function HZ(e){return Ot.endsWith(e,"[]")?e.slice(0,-2):e}function lU(e,t,r){return e?e.concat(t).map(function(s,a){return s=HZ(s),!r&&a?"["+s+"]":s}).join(r?".":""):t}function nOe(e){return Ot.isArray(e)&&!e.some(u7)}const sOe=Ot.toFlatObject(Ot,{},null,function(t){return/^is[A-Z]/.test(t)});function $3(e,t,r){if(!Ot.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,r=Ot.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(x,v){return!Ot.isUndefined(v[x])});const n=r.metaTokens,s=r.visitor||d,a=r.dots,i=r.indexes,c=(r.Blob||typeof Blob<"u"&&Blob)&&Ot.isSpecCompliantForm(t);if(!Ot.isFunction(s))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(Ot.isDate(p))return p.toISOString();if(Ot.isBoolean(p))return p.toString();if(!c&&Ot.isBlob(p))throw new Cn("Blob is not supported. Use a Buffer instead.");return Ot.isArrayBuffer(p)||Ot.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function d(p,x,v){let C=p;if(p&&!v&&typeof p=="object"){if(Ot.endsWith(x,"{}"))x=n?x:x.slice(0,-2),p=JSON.stringify(p);else if(Ot.isArray(p)&&nOe(p)||(Ot.isFileList(p)||Ot.endsWith(x,"[]"))&&(C=Ot.toArray(p)))return x=HZ(x),C.forEach(function(_,T){!(Ot.isUndefined(_)||_===null)&&t.append(i===!0?lU([x],T,a):i===null?x:x+"[]",u(_))}),!1}return u7(p)?!0:(t.append(lU(v,x,a),u(p)),!1)}const f=[],h=Object.assign(sOe,{defaultVisitor:d,convertValue:u,isVisitable:u7});function g(p,x){if(!Ot.isUndefined(p)){if(f.indexOf(p)!==-1)throw Error("Circular reference detected in "+x.join("."));f.push(p),Ot.forEach(p,function(C,b){(!(Ot.isUndefined(C)||C===null)&&s.call(t,C,Ot.isString(b)?b.trim():b,x,h))===!0&&g(C,x?x.concat(b):[b])}),f.pop()}}if(!Ot.isObject(e))throw new TypeError("data must be an object");return g(e),t}function cU(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return t[n]})}function Dj(e,t){this._pairs=[],e&&$3(e,this,t)}const GZ=Dj.prototype;GZ.append=function(t,r){this._pairs.push([t,r])};GZ.toString=function(t){const r=t?function(n){return t.call(this,n,cU)}:cU;return this._pairs.map(function(s){return r(s[0])+"="+r(s[1])},"").join("&")};function aOe(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function VZ(e,t,r){if(!t)return e;const n=r&&r.encode||aOe;Ot.isFunction(r)&&(r={serialize:r});const s=r&&r.serialize;let a;if(s?a=s(t,r):a=Ot.isURLSearchParams(t)?t.toString():new Dj(t,r).toString(n),a){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+a}return e}class uU{constructor(){this.handlers=[]}use(t,r,n){return this.handlers.push({fulfilled:t,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Ot.forEach(this.handlers,function(n){n!==null&&t(n)})}}const qZ={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},iOe=typeof URLSearchParams<"u"?URLSearchParams:Dj,oOe=typeof FormData<"u"?FormData:null,lOe=typeof Blob<"u"?Blob:null,cOe={isBrowser:!0,classes:{URLSearchParams:iOe,FormData:oOe,Blob:lOe},protocols:["http","https","file","blob","url","data"]},Ij=typeof window<"u"&&typeof document<"u",d7=typeof navigator=="object"&&navigator||void 0,uOe=Ij&&(!d7||["ReactNative","NativeScript","NS"].indexOf(d7.product)<0),dOe=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",fOe=Ij&&window.location.href||"http://localhost",hOe=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ij,hasStandardBrowserEnv:uOe,hasStandardBrowserWebWorkerEnv:dOe,navigator:d7,origin:fOe},Symbol.toStringTag,{value:"Module"})),ko={...hOe,...cOe};function mOe(e,t){return $3(e,new ko.classes.URLSearchParams,{visitor:function(r,n,s,a){return ko.isNode&&Ot.isBuffer(r)?(this.append(n,r.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...t})}function gOe(e){return Ot.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function pOe(e){const t={},r=Object.keys(e);let n;const s=r.length;let a;for(n=0;n<s;n++)a=r[n],t[a]=e[a];return t}function KZ(e){function t(r,n,s,a){let i=r[a++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),c=a>=r.length;return i=!i&&Ot.isArray(s)?s.length:i,c?(Ot.hasOwnProp(s,i)?s[i]=[s[i],n]:s[i]=n,!o):((!s[i]||!Ot.isObject(s[i]))&&(s[i]=[]),t(r,n,s[i],a)&&Ot.isArray(s[i])&&(s[i]=pOe(s[i])),!o)}if(Ot.isFormData(e)&&Ot.isFunction(e.entries)){const r={};return Ot.forEachEntry(e,(n,s)=>{t(gOe(n),s,r,0)}),r}return null}function xOe(e,t,r){if(Ot.isString(e))try{return(t||JSON.parse)(e),Ot.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Sb={transitional:qZ,adapter:["xhr","http","fetch"],transformRequest:[function(t,r){const n=r.getContentType()||"",s=n.indexOf("application/json")>-1,a=Ot.isObject(t);if(a&&Ot.isHTMLForm(t)&&(t=new FormData(t)),Ot.isFormData(t))return s?JSON.stringify(KZ(t)):t;if(Ot.isArrayBuffer(t)||Ot.isBuffer(t)||Ot.isStream(t)||Ot.isFile(t)||Ot.isBlob(t)||Ot.isReadableStream(t))return t;if(Ot.isArrayBufferView(t))return t.buffer;if(Ot.isURLSearchParams(t))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(a){if(n.indexOf("application/x-www-form-urlencoded")>-1)return mOe(t,this.formSerializer).toString();if((o=Ot.isFileList(t))||n.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return $3(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return a||s?(r.setContentType("application/json",!1),xOe(t)):t}],transformResponse:[function(t){const r=this.transitional||Sb.transitional,n=r&&r.forcedJSONParsing,s=this.responseType==="json";if(Ot.isResponse(t)||Ot.isReadableStream(t))return t;if(t&&Ot.isString(t)&&(n&&!this.responseType||s)){const i=!(r&&r.silentJSONParsing)&&s;try{return JSON.parse(t,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?Cn.from(o,Cn.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ko.classes.FormData,Blob:ko.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Ot.forEach(["delete","get","head","post","put","patch"],e=>{Sb.headers[e]={}});const yOe=Ot.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),vOe=e=>{const t={};let r,n,s;return e&&e.split(`
`).forEach(function(i){s=i.indexOf(":"),r=i.substring(0,s).trim().toLowerCase(),n=i.substring(s+1).trim(),!(!r||t[r]&&yOe[r])&&(r==="set-cookie"?t[r]?t[r].push(n):t[r]=[n]:t[r]=t[r]?t[r]+", "+n:n)}),t},dU=Symbol("internals");function sv(e){return e&&String(e).trim().toLowerCase()}function $4(e){return e===!1||e==null?e:Ot.isArray(e)?e.map($4):String(e)}function bOe(e){const t=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)t[n[1]]=n[2];return t}const wOe=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function UC(e,t,r,n,s){if(Ot.isFunction(n))return n.call(this,t,r);if(s&&(t=r),!!Ot.isString(t)){if(Ot.isString(n))return t.indexOf(n)!==-1;if(Ot.isRegExp(n))return n.test(t)}}function _Oe(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,r,n)=>r.toUpperCase()+n)}function SOe(e,t){const r=Ot.toCamelCase(" "+t);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(s,a,i){return this[n].call(this,t,s,a,i)},configurable:!0})})}let Cl=class{constructor(t){t&&this.set(t)}set(t,r,n){const s=this;function a(o,c,u){const d=sv(c);if(!d)throw new Error("header name must be a non-empty string");const f=Ot.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=$4(o))}const i=(o,c)=>Ot.forEach(o,(u,d)=>a(u,d,c));if(Ot.isPlainObject(t)||t instanceof this.constructor)i(t,r);else if(Ot.isString(t)&&(t=t.trim())&&!wOe(t))i(vOe(t),r);else if(Ot.isObject(t)&&Ot.isIterable(t)){let o={},c,u;for(const d of t){if(!Ot.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?Ot.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}i(o,r)}else t!=null&&a(r,t,n);return this}get(t,r){if(t=sv(t),t){const n=Ot.findKey(this,t);if(n){const s=this[n];if(!r)return s;if(r===!0)return bOe(s);if(Ot.isFunction(r))return r.call(this,s,n);if(Ot.isRegExp(r))return r.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,r){if(t=sv(t),t){const n=Ot.findKey(this,t);return!!(n&&this[n]!==void 0&&(!r||UC(this,this[n],n,r)))}return!1}delete(t,r){const n=this;let s=!1;function a(i){if(i=sv(i),i){const o=Ot.findKey(n,i);o&&(!r||UC(n,n[o],o,r))&&(delete n[o],s=!0)}}return Ot.isArray(t)?t.forEach(a):a(t),s}clear(t){const r=Object.keys(this);let n=r.length,s=!1;for(;n--;){const a=r[n];(!t||UC(this,this[a],a,t,!0))&&(delete this[a],s=!0)}return s}normalize(t){const r=this,n={};return Ot.forEach(this,(s,a)=>{const i=Ot.findKey(n,a);if(i){r[i]=$4(s),delete r[a];return}const o=t?_Oe(a):String(a).trim();o!==a&&delete r[a],r[o]=$4(s),n[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const r=Object.create(null);return Ot.forEach(this,(n,s)=>{n!=null&&n!==!1&&(r[s]=t&&Ot.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,r])=>t+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...r){const n=new this(t);return r.forEach(s=>n.set(s)),n}static accessor(t){const n=(this[dU]=this[dU]={accessors:{}}).accessors,s=this.prototype;function a(i){const o=sv(i);n[o]||(SOe(s,i),n[o]=!0)}return Ot.isArray(t)?t.forEach(a):a(t),this}};Cl.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Ot.reduceDescriptors(Cl.prototype,({value:e},t)=>{let r=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(n){this[r]=n}}});Ot.freezeMethods(Cl);function zC(e,t){const r=this||Sb,n=t||r,s=Cl.from(n.headers);let a=n.data;return Ot.forEach(e,function(o){a=o.call(r,a,s.normalize(),t?t.status:void 0)}),s.normalize(),a}function YZ(e){return!!(e&&e.__CANCEL__)}function cx(e,t,r){Cn.call(this,e??"canceled",Cn.ERR_CANCELED,t,r),this.name="CanceledError"}Ot.inherits(cx,Cn,{__CANCEL__:!0});function XZ(e,t,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):t(new Cn("Request failed with status code "+r.status,[Cn.ERR_BAD_REQUEST,Cn.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function kOe(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function COe(e,t){e=e||10;const r=new Array(e),n=new Array(e);let s=0,a=0,i;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=n[a];i||(i=u),r[s]=c,n[s]=u;let f=a,h=0;for(;f!==s;)h+=r[f++],f=f%e;if(s=(s+1)%e,s===a&&(a=(a+1)%e),u-i<t)return;const g=d&&u-d;return g?Math.round(h*1e3/g):void 0}}function TOe(e,t){let r=0,n=1e3/t,s,a;const i=(u,d=Date.now())=>{r=d,s=null,a&&(clearTimeout(a),a=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-r;f>=n?i(u,d):(s=u,a||(a=setTimeout(()=>{a=null,i(s)},n-f)))},()=>s&&i(s)]}const yS=(e,t,r=3)=>{let n=0;const s=COe(50,250);return TOe(a=>{const i=a.loaded,o=a.lengthComputable?a.total:void 0,c=i-n,u=s(c),d=i<=o;n=i;const f={loaded:i,total:o,progress:o?i/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-i)/u:void 0,event:a,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},r)},fU=(e,t)=>{const r=e!=null;return[n=>t[0]({lengthComputable:r,total:e,loaded:n}),t[1]]},hU=e=>(...t)=>Ot.asap(()=>e(...t)),NOe=ko.hasStandardBrowserEnv?((e,t)=>r=>(r=new URL(r,ko.origin),e.protocol===r.protocol&&e.host===r.host&&(t||e.port===r.port)))(new URL(ko.origin),ko.navigator&&/(msie|trident)/i.test(ko.navigator.userAgent)):()=>!0,EOe=ko.hasStandardBrowserEnv?{write(e,t,r,n,s,a){const i=[e+"="+encodeURIComponent(t)];Ot.isNumber(r)&&i.push("expires="+new Date(r).toGMTString()),Ot.isString(n)&&i.push("path="+n),Ot.isString(s)&&i.push("domain="+s),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function AOe(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function jOe(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function JZ(e,t,r){let n=!AOe(t);return e&&(n||r==!1)?jOe(e,t):t}const mU=e=>e instanceof Cl?{...e}:e;function ug(e,t){t=t||{};const r={};function n(u,d,f,h){return Ot.isPlainObject(u)&&Ot.isPlainObject(d)?Ot.merge.call({caseless:h},u,d):Ot.isPlainObject(d)?Ot.merge({},d):Ot.isArray(d)?d.slice():d}function s(u,d,f,h){if(Ot.isUndefined(d)){if(!Ot.isUndefined(u))return n(void 0,u,f,h)}else return n(u,d,f,h)}function a(u,d){if(!Ot.isUndefined(d))return n(void 0,d)}function i(u,d){if(Ot.isUndefined(d)){if(!Ot.isUndefined(u))return n(void 0,u)}else return n(void 0,d)}function o(u,d,f){if(f in t)return n(u,d);if(f in e)return n(void 0,u)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(u,d,f)=>s(mU(u),mU(d),f,!0)};return Ot.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||s,h=f(e[d],t[d],d);Ot.isUndefined(h)&&f!==o||(r[d]=h)}),r}const QZ=e=>{const t=ug({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:s,xsrfCookieName:a,headers:i,auth:o}=t;if(t.headers=i=Cl.from(i),t.url=VZ(JZ(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),Ot.isFormData(r)){if(ko.hasStandardBrowserEnv||ko.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Ot.isFunction(r.getHeaders)){const c=r.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([d,f])=>{u.includes(d.toLowerCase())&&i.set(d,f)})}}if(ko.hasStandardBrowserEnv&&(n&&Ot.isFunction(n)&&(n=n(t)),n||n!==!1&&NOe(t.url))){const c=s&&a&&EOe.read(a);c&&i.set(s,c)}return t},POe=typeof XMLHttpRequest<"u",FOe=POe&&function(e){return new Promise(function(r,n){const s=QZ(e);let a=s.data;const i=Cl.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=s,d,f,h,g,p;function x(){g&&g(),p&&p(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let v=new XMLHttpRequest;v.open(s.method.toUpperCase(),s.url,!0),v.timeout=s.timeout;function C(){if(!v)return;const _=Cl.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),N={data:!o||o==="text"||o==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:_,config:e,request:v};XZ(function(F){r(F),x()},function(F){n(F),x()},N),v=null}"onloadend"in v?v.onloadend=C:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(C)},v.onabort=function(){v&&(n(new Cn("Request aborted",Cn.ECONNABORTED,e,v)),v=null)},v.onerror=function(T){const N=T&&T.message?T.message:"Network Error",E=new Cn(N,Cn.ERR_NETWORK,e,v);E.event=T||null,n(E),v=null},v.ontimeout=function(){let T=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const N=s.transitional||qZ;s.timeoutErrorMessage&&(T=s.timeoutErrorMessage),n(new Cn(T,N.clarifyTimeoutError?Cn.ETIMEDOUT:Cn.ECONNABORTED,e,v)),v=null},a===void 0&&i.setContentType(null),"setRequestHeader"in v&&Ot.forEach(i.toJSON(),function(T,N){v.setRequestHeader(N,T)}),Ot.isUndefined(s.withCredentials)||(v.withCredentials=!!s.withCredentials),o&&o!=="json"&&(v.responseType=s.responseType),u&&([h,p]=yS(u,!0),v.addEventListener("progress",h)),c&&v.upload&&([f,g]=yS(c),v.upload.addEventListener("progress",f),v.upload.addEventListener("loadend",g)),(s.cancelToken||s.signal)&&(d=_=>{v&&(n(!_||_.type?new cx(null,e,v):_),v.abort(),v=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const b=kOe(s.url);if(b&&ko.protocols.indexOf(b)===-1){n(new Cn("Unsupported protocol "+b+":",Cn.ERR_BAD_REQUEST,e));return}v.send(a||null)})},MOe=(e,t)=>{const{length:r}=e=e?e.filter(Boolean):[];if(t||r){let n=new AbortController,s;const a=function(u){if(!s){s=!0,o();const d=u instanceof Error?u:this.reason;n.abort(d instanceof Cn?d:new cx(d instanceof Error?d.message:d))}};let i=t&&setTimeout(()=>{i=null,a(new Cn(`timeout ${t} of ms exceeded`,Cn.ETIMEDOUT))},t);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),e=null)};e.forEach(u=>u.addEventListener("abort",a));const{signal:c}=n;return c.unsubscribe=()=>Ot.asap(o),c}},ROe=function*(e,t){let r=e.byteLength;if(r<t){yield e;return}let n=0,s;for(;n<r;)s=n+t,yield e.slice(n,s),n=s},OOe=async function*(e,t){for await(const r of DOe(e))yield*ROe(r,t)},DOe=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)break;yield n}}finally{await t.cancel()}},gU=(e,t,r,n)=>{const s=OOe(e,t);let a=0,i,o=c=>{i||(i=!0,n&&n(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){o(),c.close();return}let f=d.byteLength;if(r){let h=a+=f;r(h)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},pU=64*1024,{isFunction:_4}=Ot,IOe=(({Request:e,Response:t})=>({Request:e,Response:t}))(Ot.global),{ReadableStream:xU,TextEncoder:yU}=Ot.global,vU=(e,...t)=>{try{return!!e(...t)}catch{return!1}},LOe=e=>{e=Ot.merge.call({skipUndefined:!0},IOe,e);const{fetch:t,Request:r,Response:n}=e,s=t?_4(t):typeof fetch=="function",a=_4(r),i=_4(n);if(!s)return!1;const o=s&&_4(xU),c=s&&(typeof yU=="function"?(p=>x=>p.encode(x))(new yU):async p=>new Uint8Array(await new r(p).arrayBuffer())),u=a&&o&&vU(()=>{let p=!1;const x=new r(ko.origin,{body:new xU,method:"POST",get duplex(){return p=!0,"half"}}).headers.has("Content-Type");return p&&!x}),d=i&&o&&vU(()=>Ot.isReadableStream(new n("").body)),f={stream:d&&(p=>p.body)};s&&["text","arrayBuffer","blob","formData","stream"].forEach(p=>{!f[p]&&(f[p]=(x,v)=>{let C=x&&x[p];if(C)return C.call(x);throw new Cn(`Response type '${p}' is not supported`,Cn.ERR_NOT_SUPPORT,v)})});const h=async p=>{if(p==null)return 0;if(Ot.isBlob(p))return p.size;if(Ot.isSpecCompliantForm(p))return(await new r(ko.origin,{method:"POST",body:p}).arrayBuffer()).byteLength;if(Ot.isArrayBufferView(p)||Ot.isArrayBuffer(p))return p.byteLength;if(Ot.isURLSearchParams(p)&&(p=p+""),Ot.isString(p))return(await c(p)).byteLength},g=async(p,x)=>{const v=Ot.toFiniteNumber(p.getContentLength());return v??h(x)};return async p=>{let{url:x,method:v,data:C,signal:b,cancelToken:_,timeout:T,onDownloadProgress:N,onUploadProgress:E,responseType:F,headers:j,withCredentials:P="same-origin",fetchOptions:M}=QZ(p),I=t||fetch;F=F?(F+"").toLowerCase():"text";let U=MOe([b,_&&_.toAbortSignal()],T),K=null;const te=U&&U.unsubscribe&&(()=>{U.unsubscribe()});let re;try{if(E&&u&&v!=="get"&&v!=="head"&&(re=await g(j,C))!==0){let H=new r(x,{method:"POST",body:C,duplex:"half"}),R;if(Ot.isFormData(C)&&(R=H.headers.get("content-type"))&&j.setContentType(R),H.body){const[L,G]=fU(re,yS(hU(E)));C=gU(H.body,pU,L,G)}}Ot.isString(P)||(P=P?"include":"omit");const Z=a&&"credentials"in r.prototype,B={...M,signal:U,method:v.toUpperCase(),headers:j.normalize().toJSON(),body:C,duplex:"half",credentials:Z?P:void 0};K=a&&new r(x,B);let J=await(a?I(K,M):I(x,B));const z=d&&(F==="stream"||F==="response");if(d&&(N||z&&te)){const H={};["status","statusText","headers"].forEach(W=>{H[W]=J[W]});const R=Ot.toFiniteNumber(J.headers.get("content-length")),[L,G]=N&&fU(R,yS(hU(N),!0))||[];J=new n(gU(J.body,pU,L,()=>{G&&G(),te&&te()}),H)}F=F||"text";let q=await f[Ot.findKey(f,F)||"text"](J,p);return!z&&te&&te(),await new Promise((H,R)=>{XZ(H,R,{data:q,headers:Cl.from(J.headers),status:J.status,statusText:J.statusText,config:p,request:K})})}catch(Z){throw te&&te(),Z&&Z.name==="TypeError"&&/Load failed|fetch/i.test(Z.message)?Object.assign(new Cn("Network Error",Cn.ERR_NETWORK,p,K),{cause:Z.cause||Z}):Cn.from(Z,Z&&Z.code,p,K)}}},BOe=new Map,ZZ=e=>{let t=e?e.env:{};const{fetch:r,Request:n,Response:s}=t,a=[n,s,r];let i=a.length,o=i,c,u,d=BOe;for(;o--;)c=a[o],u=d.get(c),u===void 0&&d.set(c,u=o?new Map:LOe(t)),d=u;return u};ZZ();const f7={http:rOe,xhr:FOe,fetch:{get:ZZ}};Ot.forEach(f7,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const bU=e=>`- ${e}`,$Oe=e=>Ot.isFunction(e)||e===null||e===!1,eee={getAdapter:(e,t)=>{e=Ot.isArray(e)?e:[e];const{length:r}=e;let n,s;const a={};for(let i=0;i<r;i++){n=e[i];let o;if(s=n,!$Oe(n)&&(s=f7[(o=String(n)).toLowerCase()],s===void 0))throw new Cn(`Unknown adapter '${o}'`);if(s&&(Ot.isFunction(s)||(s=s.get(t))))break;a[o||"#"+i]=s}if(!s){const i=Object.entries(a).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(bU).join(`
`):" "+bU(i[0]):"as no adapter specified";throw new Cn("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return s},adapters:f7};function WC(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new cx(null,e)}function wU(e){return WC(e),e.headers=Cl.from(e.headers),e.data=zC.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),eee.getAdapter(e.adapter||Sb.adapter,e)(e).then(function(n){return WC(e),n.data=zC.call(e,e.transformResponse,n),n.headers=Cl.from(n.headers),n},function(n){return YZ(n)||(WC(e),n&&n.response&&(n.response.data=zC.call(e,e.transformResponse,n.response),n.response.headers=Cl.from(n.response.headers))),Promise.reject(n)})}const tee="1.12.2",U3={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{U3[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const _U={};U3.transitional=function(t,r,n){function s(a,i){return"[Axios v"+tee+"] Transitional option '"+a+"'"+i+(n?". "+n:"")}return(a,i,o)=>{if(t===!1)throw new Cn(s(i," has been removed"+(r?" in "+r:"")),Cn.ERR_DEPRECATED);return r&&!_U[i]&&(_U[i]=!0,console.warn(s(i," has been deprecated since v"+r+" and will be removed in the near future"))),t?t(a,i,o):!0}};U3.spelling=function(t){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${t}`),!0)};function UOe(e,t,r){if(typeof e!="object")throw new Cn("options must be an object",Cn.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let s=n.length;for(;s-- >0;){const a=n[s],i=t[a];if(i){const o=e[a],c=o===void 0||i(o,a,e);if(c!==!0)throw new Cn("option "+a+" must be "+c,Cn.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new Cn("Unknown option "+a,Cn.ERR_BAD_OPTION)}}const U4={assertOptions:UOe,validators:U3},Xu=U4.validators;let $m=class{constructor(t){this.defaults=t||{},this.interceptors={request:new uU,response:new uU}}async request(t,r){try{return await this._request(t,r)}catch(n){if(n instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const a=s.stack?s.stack.replace(/^.+\n/,""):"";try{n.stack?a&&!String(n.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+a):n.stack=a}catch{}}throw n}}_request(t,r){typeof t=="string"?(r=r||{},r.url=t):r=t||{},r=ug(this.defaults,r);const{transitional:n,paramsSerializer:s,headers:a}=r;n!==void 0&&U4.assertOptions(n,{silentJSONParsing:Xu.transitional(Xu.boolean),forcedJSONParsing:Xu.transitional(Xu.boolean),clarifyTimeoutError:Xu.transitional(Xu.boolean)},!1),s!=null&&(Ot.isFunction(s)?r.paramsSerializer={serialize:s}:U4.assertOptions(s,{encode:Xu.function,serialize:Xu.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),U4.assertOptions(r,{baseUrl:Xu.spelling("baseURL"),withXsrfToken:Xu.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=a&&Ot.merge(a.common,a[r.method]);a&&Ot.forEach(["delete","get","head","post","put","patch","common"],p=>{delete a[p]}),r.headers=Cl.concat(i,a);const o=[];let c=!0;this.interceptors.request.forEach(function(x){typeof x.runWhen=="function"&&x.runWhen(r)===!1||(c=c&&x.synchronous,o.unshift(x.fulfilled,x.rejected))});const u=[];this.interceptors.response.forEach(function(x){u.push(x.fulfilled,x.rejected)});let d,f=0,h;if(!c){const p=[wU.bind(this),void 0];for(p.unshift(...o),p.push(...u),h=p.length,d=Promise.resolve(r);f<h;)d=d.then(p[f++],p[f++]);return d}h=o.length;let g=r;for(;f<h;){const p=o[f++],x=o[f++];try{g=p(g)}catch(v){x.call(this,v);break}}try{d=wU.call(this,g)}catch(p){return Promise.reject(p)}for(f=0,h=u.length;f<h;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=ug(this.defaults,t);const r=JZ(t.baseURL,t.url,t.allowAbsoluteUrls);return VZ(r,t.params,t.paramsSerializer)}};Ot.forEach(["delete","get","head","options"],function(t){$m.prototype[t]=function(r,n){return this.request(ug(n||{},{method:t,url:r,data:(n||{}).data}))}});Ot.forEach(["post","put","patch"],function(t){function r(n){return function(a,i,o){return this.request(ug(o||{},{method:t,headers:n?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}$m.prototype[t]=r(),$m.prototype[t+"Form"]=r(!0)});let zOe=class ree{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(a){r=a});const n=this;this.promise.then(s=>{if(!n._listeners)return;let a=n._listeners.length;for(;a-- >0;)n._listeners[a](s);n._listeners=null}),this.promise.then=s=>{let a;const i=new Promise(o=>{n.subscribe(o),a=o}).then(s);return i.cancel=function(){n.unsubscribe(a)},i},t(function(a,i,o){n.reason||(n.reason=new cx(a,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const r=this._listeners.indexOf(t);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const t=new AbortController,r=n=>{t.abort(n)};return this.subscribe(r),t.signal.unsubscribe=()=>this.unsubscribe(r),t.signal}static source(){let t;return{token:new ree(function(s){t=s}),cancel:t}}};function WOe(e){return function(r){return e.apply(null,r)}}function HOe(e){return Ot.isObject(e)&&e.isAxiosError===!0}const h7={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(h7).forEach(([e,t])=>{h7[t]=e});function nee(e){const t=new $m(e),r=RZ($m.prototype.request,t);return Ot.extend(r,$m.prototype,t,{allOwnKeys:!0}),Ot.extend(r,t,null,{allOwnKeys:!0}),r.create=function(s){return nee(ug(e,s))},r}const Ba=nee(Sb);Ba.Axios=$m;Ba.CanceledError=cx;Ba.CancelToken=zOe;Ba.isCancel=YZ;Ba.VERSION=tee;Ba.toFormData=$3;Ba.AxiosError=Cn;Ba.Cancel=Ba.CanceledError;Ba.all=function(t){return Promise.all(t)};Ba.spread=WOe;Ba.isAxiosError=HOe;Ba.mergeConfig=ug;Ba.AxiosHeaders=Cl;Ba.formToJSON=e=>KZ(Ot.isHTMLForm(e)?new FormData(e):e);Ba.getAdapter=eee.getAdapter;Ba.HttpStatusCode=h7;Ba.default=Ba;const{Axios:UDe,AxiosError:zDe,CanceledError:WDe,isCancel:HDe,CancelToken:GDe,VERSION:VDe,all:qDe,Cancel:KDe,isAxiosError:YDe,spread:XDe,toFormData:JDe,AxiosHeaders:QDe,HttpStatusCode:ZDe,formToJSON:eIe,getAdapter:tIe,mergeConfig:rIe}=Ba,GOe=({onGameSaved:e,onCancel:t})=>{const{user:r}=ws(),{showNotification:n}=Ls(),s=[{subject_id:1,subject:"Listening and Speaking"},{subject_id:2,subject:"English for career"},{subject_id:3,subject:"Tourism"},{subject_id:4,subject:"Reading and Writing"},{subject_id:5,subject:"Geography"},{subject_id:6,subject:"Grammar"},{subject_id:7,subject:"English for Communication"},{subject_id:8,subject:"Health"},{subject_id:9,subject:"Science Fundamental"},{subject_id:10,subject:"Science Supplementary"},{subject_id:11,subject:"Chemistry"},{subject_id:12,subject:"Biology"},{subject_id:13,subject:"Math Fundamental"},{subject_id:14,subject:"Math Supplementary"}],[a,i]=w.useState(null),[o,c]=w.useState(null),[u,d]=w.useState(""),[f,h]=w.useState(""),[g,p]=w.useState("custom"),[x,v]=w.useState(3),[C,b]=w.useState([]),[_,T]=w.useState(3),[N,E]=w.useState([]),[F,j]=w.useState(!1),[P,M]=w.useState(!1),[I,U]=w.useState(!1),K=w.useRef({}),te=w.useRef({});w.useEffect(()=>{if(g==="custom"&&x>0){const W=Array.from({length:x},(Q,X)=>({question_id:X+1,question_text:"",question_image_url:null,option_a:"",option_b:"",option_c:"",option_d:"",correct_answer:"A"}));b(W)}},[x,g]);const[re,Z]=w.useState(""),B=W=>{const Q=parseInt(W.target.value);i(Q);const X=s.find(se=>se.subject_id===Q);X&&Z(X.subject)},J=W=>{c(parseInt(W.target.value))},z=(W,Q,X)=>{b(se=>se.map(le=>le.question_id===W?{...le,[Q]:X}:le))},q=async(W,Q)=>{if(Q)try{const X=await MH(Q);if(!X.valid){n(X.errors.join(", "),"error");return}let se=Q;Q.size>500*1024&&n("Image is large, compressing...","info");const le=new FileReader;le.onloadend=async()=>{try{const he=le.result.split(",")[1];if(!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");const we=await window.tokenManager.getToken(),ie=await Ba.post("/.netlify/functions/upload-image",{image:he,folder:"mini_games",filename:Q.name},{headers:{Authorization:`Bearer ${we}`,"Content-Type":"application/json"}});ie.data.success?(z(W,"question_image_url",ie.data.url),n("Image uploaded successfully","success")):n("Failed to upload image","error")}catch(he){console.error("Error uploading image:",he),n("Failed to upload image","error")}},le.readAsDataURL(se)}catch(X){console.error("Error uploading image:",X),n("Failed to upload image","error")}},H=async()=>{if(!a||!o||!u||!_){n("Please fill in subject, grade, topic, and number of questions","error");return}try{if(j(!0),!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");const W=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/mini-game-generate-ai-questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:a,subjectName:re,grade:o,topic:u,numQuestions:_})}),Q=await W.json();console.log("[Frontend] AI Question Generation Response:",{success:Q.success,questionsCount:Q.questions?.length,error:Q.error,message:Q.message,responseStatus:W.status}),Q.success&&Q.questions?(console.log("[Frontend] Setting AI questions:",Q.questions.length),console.log("[Frontend] Sample question:",Q.questions[0]),E(Q.questions),n(`Successfully generated ${Q.questions.length} questions`,"success")):(console.error("[Frontend] Failed to generate questions:",Q),n(Q.error||Q.message||"Failed to generate questions","error"))}catch(W){console.error("Error generating AI questions:",W),n(W.message||"Failed to generate questions","error")}finally{j(!1)}},R=(W,Q,X)=>{E(se=>se.map(le=>le.question_id===W?{...le,[Q]:X}:le))},L=re&&(re.toLowerCase().includes("math")||re.toLowerCase().includes("mathematics")||re.toLowerCase().includes("science")||re.toLowerCase().includes("physics")||re.toLowerCase().includes("chemistry")),G=async()=>{if(!a||!o||!u||!f){n("Please fill in all required fields","error");return}const W=g==="custom"?C:N;if(W.length===0){n("Please create at least one question","error");return}for(const Q of W){if(!Q.question_text&&!Q.question_image_url){n(`Question ${Q.question_id} must have text or image`,"error");return}if(!Q.option_a||!Q.option_b){n(`Question ${Q.question_id} must have at least 2 options`,"error");return}if(!["A","B","C","D"].includes(Q.correct_answer)){n(`Question ${Q.question_id} must have a valid correct answer`,"error");return}}try{if(U(!0),console.log("[Save Game] Checking tokenManager...",{exists:!!window.tokenManager,isAuthenticated:window.tokenManager?.isAuthenticated?.()}),!window.tokenManager||!window.tokenManager.isAuthenticated())throw new Error("No valid authentication token found");const Q={subject_id:a,grade:o,class:0,topic:u,game_type:"spell_duel",game_name:f};console.log("[Save Game] Making request with body:",Q);const X=await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/create-mini-game",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Q)});console.log("[Save Game] Response status:",X.status,X.statusText);const se=await X.json();if(console.log("[Save Game] Response:",se),!se.success)throw new Error(se.error||"Failed to create game");const le=se.game.id,we=await(await window.tokenManager.makeAuthenticatedRequest("/.netlify/functions/save-mini-game-questions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({game_id:le,questions:W})})).json();if(console.log("[Save Questions] Response:",we),!we.success)throw new Error(we.error||"Failed to save questions");n("Game created successfully","success"),e&&e(le)}catch(Q){console.error("Error saving game:",Q),n(Q.message||"Failed to save game","error")}finally{U(!1)}};return P?l.jsx(Kt,{children:l.jsx("div",{className:"flex justify-center items-center p-8",children:l.jsx(Xr,{})})}):l.jsx(Kt,{children:l.jsxs("div",{className:"p-6 space-y-6",children:[l.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Mini Game"}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Subject *"}),l.jsxs("select",{value:a||"",onChange:B,className:"w-full px-3 py-2 border rounded-md",children:[l.jsx("option",{value:"",children:"Select Subject"}),s.map(W=>l.jsx("option",{value:W.subject_id,children:W.subject},W.subject_id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Grade *"}),l.jsxs("select",{value:o||"",onChange:J,className:"w-full px-3 py-2 border rounded-md",children:[l.jsx("option",{value:"",children:"Select Grade"}),[7,8,9,10,11,12].map(W=>l.jsxs("option",{value:W,children:["Grade ",W]},W))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Topic *"}),l.jsx("input",{type:"text",value:u,onChange:W=>d(W.target.value),placeholder:"Enter topic",className:"w-full px-3 py-2 border rounded-md"})]}),l.jsxs("div",{className:"md:col-span-2",children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Game Name *"}),l.jsx("input",{type:"text",value:f,onChange:W=>h(W.target.value),placeholder:"Enter game name",className:"w-full px-3 py-2 border rounded-md"})]})]}),l.jsx("div",{className:"border-b",children:l.jsxs("div",{className:"flex space-x-4",children:[l.jsx("button",{onClick:()=>p("custom"),className:`px-4 py-2 font-medium ${g==="custom"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"Custom"}),l.jsx("button",{onClick:()=>p("ai"),className:`px-4 py-2 font-medium ${g==="ai"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"AI Generated"})]})}),g==="custom"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"20",value:x,onChange:W=>v(parseInt(W.target.value)||1),className:"w-full px-3 py-2 border rounded-md"})]}),C.map((W,Q)=>l.jsxs("div",{className:"relative",children:[l.jsx(SU,{question:W,index:Q,onQuestionChange:z,onImageUpload:q,isMathOrScience:L,questionRefs:K,optionRefs:te}),C.length>1&&l.jsx("button",{onClick:()=>{const se=C.filter(le=>le.question_id!==W.question_id).map((le,he)=>({...le,question_id:he+1}));b(se)},className:"absolute top-2 right-2 text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete Question"})]},W.question_id)),l.jsx(at,{onClick:()=>{const W=Math.max(...C.map(Q=>Q.question_id),0)+1;b([...C,{question_id:W,question_text:"",question_image_url:null,option_a:"",option_b:"",option_c:"",option_d:"",correct_answer:"A"}])},variant:"outline",children:"+ Add Question"})]}),g==="ai"&&l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex gap-4 items-end",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Number of Questions"}),l.jsx("input",{type:"number",min:"1",max:"20",value:_,onChange:W=>T(parseInt(W.target.value)||1),className:"w-full px-3 py-2 border rounded-md"})]}),l.jsx(at,{onClick:H,disabled:F||!a||!o||!u,children:F?l.jsx(Xr,{size:"sm"}):"Generate Questions"}),N.length>0&&l.jsx(at,{onClick:H,variant:"outline",disabled:F,children:"Regenerate"})]}),F&&l.jsxs("div",{className:"flex justify-center p-8",children:[l.jsx(Xr,{}),l.jsx("span",{className:"ml-2",children:"Generating questions..."})]}),N.map((W,Q)=>l.jsx(SU,{question:W,index:Q,onQuestionChange:R,onImageUpload:null,isMathOrScience:L,questionRefs:K,optionRefs:te},W.question_id))]}),l.jsxs("div",{className:"flex justify-end gap-4 pt-4 border-t",children:[l.jsx(at,{onClick:t,variant:"outline",children:"Cancel"}),l.jsx(at,{onClick:G,disabled:I,children:I?l.jsx(Xr,{size:"sm"}):"Save Game"})]})]})})},SU=({question:e,index:t,onQuestionChange:r,onImageUpload:n,isMathOrScience:s,questionRefs:a,optionRefs:i})=>{Ls();const[o,c]=w.useState(!1),u=d=>{const f=d.target.files[0];f&&n&&n(e.question_id,f)};return l.jsxs(Kt,{className:"p-4 space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h3",{className:"font-semibold",children:["Question ",t+1]}),s&&l.jsx("button",{onClick:()=>c(!o),className:"text-sm text-blue-600 hover:text-blue-800",children:o?"Hide Preview":"Show Preview"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Question Text"}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{ref:d=>a.current[`q_${e.question_id}`]=d,type:"text",value:e.question_text||"",onChange:d=>r(e.question_id,"question_text",d.target.value),placeholder:"Enter question text",className:"flex-1 px-3 py-2 border rounded-md"}),s&&l.jsx(qo,{inputRef:a.current[`q_${e.question_id}`],onInsert:d=>{const f=e.question_text||"",h=f+(f?" ":"")+`$${d}$`;r(e.question_id,"question_text",h)}})]}),o&&e.question_text&&l.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded",children:l.jsx("div",{dangerouslySetInnerHTML:{__html:Ms(e.question_text)}})})]}),n&&l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Question Image (Optional, max 500KB)"}),l.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"w-full px-3 py-2 border rounded-md"}),e.question_image_url&&l.jsxs("div",{className:"mt-2",children:[l.jsx("img",{src:e.question_image_url,alt:"Question",className:"max-w-xs rounded"}),l.jsx("button",{onClick:()=>r(e.question_id,"question_image_url",null),className:"ml-2 text-red-600 hover:text-red-800 text-sm",children:"Remove"})]})]}),["A","B","C","D"].map((d,f)=>l.jsxs("div",{children:[l.jsxs("label",{className:"block text-sm font-medium mb-2",children:["Option ",d," *"]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx("input",{ref:h=>i.current[`${e.question_id}_${d}`]=h,type:"text",value:e[`option_${d.toLowerCase()}`]||"",onChange:h=>r(e.question_id,`option_${d.toLowerCase()}`,h.target.value),placeholder:`Enter option ${d}`,className:"flex-1 px-3 py-2 border rounded-md"}),s&&l.jsx(qo,{inputRef:i.current[`${e.question_id}_${d}`],onInsert:h=>{const g=e[`option_${d.toLowerCase()}`]||"",p=g+(g?" ":"")+`$${h}$`;r(e.question_id,`option_${d.toLowerCase()}`,p)}})]}),o&&e[`option_${d.toLowerCase()}`]&&l.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded",children:l.jsx("div",{dangerouslySetInnerHTML:{__html:Ms(e[`option_${d.toLowerCase()}`])}})})]},d)),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium mb-2",children:"Correct Answer *"}),l.jsx("select",{value:e.correct_answer||"A",onChange:d=>r(e.question_id,"correct_answer",d.target.value),className:"w-full px-3 py-2 border rounded-md",children:["A","B","C","D"].map(d=>l.jsxs("option",{value:d,children:["Option ",d]},d))})]})]})},VOe=()=>{const e=Za(),{showNotification:t}=Ls(),r=()=>{t("Game created successfully!","success"),e("/teacher",{state:{view:"minigames"}})},n=()=>{e("/teacher",{state:{view:"minigames"}})};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-8",children:l.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsx(Ze.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"mb-6",children:l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Create Mini Game"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Create a new educational mini game for your students"})]}),l.jsxs(at,{onClick:n,variant:"outline",className:"flex items-center gap-2",children:[l.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Games"]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:l.jsx(Kt,{className:"p-6",children:l.jsx(GOe,{onGameSaved:r,onCancel:n})})})]})})},qOe=()=>{const{user:e,role:t,isAuthenticated:r,isLoading:n}=ws(),[s,a]=w.useState("cabinet");return!r||t!=="teacher"?l.jsx(o1,{to:"/login",replace:!0}):n?l.jsxs("div",{className:"teacher-app-loading",children:[l.jsx(Xr,{}),l.jsx("p",{children:"Loading teacher interface..."})]}):l.jsx("div",{className:"teacher-app",children:l.jsxs(v7,{children:[l.jsx(Ts,{path:"/",element:l.jsx(aU,{})}),l.jsx(Ts,{path:"/cabinet",element:l.jsx(aU,{})}),l.jsx(Ts,{path:"/tests",element:l.jsx(iU,{})}),l.jsx(Ts,{path:"/tests/create",element:l.jsx(iU,{})}),l.jsx(Ts,{path:"/data",element:l.jsx(gRe,{})}),l.jsx(Ts,{path:"/subjects",element:l.jsx(pRe,{})}),l.jsx(Ts,{path:"/results",element:l.jsx(aY,{})}),l.jsx(Ts,{path:"/minigames",element:l.jsx(MZ,{})}),l.jsx(Ts,{path:"/minigames/create",element:l.jsx(VOe,{})}),l.jsx(Ts,{path:"*",element:l.jsx(o1,{to:"/teacher",replace:!0})})]})})},ht={container:"min-h-screen bg-gradient-to-br from-purple-50 to-indigo-100",mainContainer:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",header:"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-lg",headerContent:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",headerFlex:"flex justify-between items-center",adminInfo:"flex items-center space-x-4",adminAvatar:"h-12 w-12 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm",adminText:"text-lg sm:text-xl md:text-2xl font-bold text-white",adminSubtext:"text-purple-100 text-sm sm:text-base md:text-lg",menuContainer:"relative admin-menu",menuButton:"flex items-center space-x-1 sm:space-x-2 bg-white/10 border-white/20 text-white hover:bg-white/20 font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-2 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm border-2",menuDropdown:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg z-50 overflow-hidden",menuItem:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-purple-50 transition-colors",menuItemLogout:"block w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-red-50 transition-colors",cardContainer:"bg-white rounded-xl shadow-lg border border-gray-200 hover:shadow-xl transition-shadow duration-300",cardHeader:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-purple-50 to-indigo-50",cardTitle:"text-xl font-bold text-gray-800",cardBody:"p-6",buttonGroup:"flex flex-wrap gap-3 mb-6",buttonPrimary:"bg-purple-600 hover:bg-purple-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200",buttonSecondary:"bg-gray-200 hover:bg-gray-300 text-gray-800 font-medium px-4 py-2 rounded-lg transition-colors duration-200",formContainer:"bg-gray-50 rounded-lg p-6 border border-gray-200",formGrid:"grid grid-cols-1 md:grid-cols-2 gap-4",formGroup:"space-y-2",formLabel:"block text-sm font-medium text-gray-700",formInput:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-colors duration-200",formCheckbox:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded",formActions:"flex space-x-3 pt-4",table:"min-w-full divide-y divide-gray-200",tableHeader:"bg-gray-50",tableHeaderCell:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",tableBody:"bg-white divide-y divide-gray-200",tableRow:"hover:bg-gray-50 transition-colors duration-150",tableCell:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",statusActive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",statusInactive:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",modalOverlay:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",modalContent:"bg-white rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",modalTitle:"text-xl font-semibold text-gray-900 mb-4",modalActions:"flex space-x-3 pt-4"},KOe=()=>{const{user:e,isAdmin:t,logout:r}=ws(),{get:n,post:s,delete:a}=tc(),i=w.useCallback(async()=>{try{h({type:"info",message:"Checking for overdue assignments..."});const Ce=await s("/.netlify/functions/check-overdue-assignments",{});if(Ce&&Ce.success){const Dt=Ce.overdue_count||0;Dt>0?h({type:"success",message:`Found and marked ${Dt} overdue assignments as inactive.`}):h({type:"info",message:"No overdue assignments found."})}else h({type:"error",message:Ce?.error||"Failed to check assignments"})}catch(Ce){h({type:"error",message:"Failed to check assignments"}),console.error("Check overdue assignments error:",Ce)}},[s]),[o,c]=w.useState(!1),[u,d]=w.useState(null),[f,h]=w.useState(null),[g,p]=w.useState(!1),[x,v]=w.useState(!1),[C,b]=w.useState(!1),[_,T]=w.useState(!1),[N,E]=w.useState(""),[F,j]=w.useState(null),[P,M]=w.useState({}),[I,U]=w.useState(null),[K,te]=w.useState({}),[re,Z]=w.useState(null),[B,J]=w.useState({}),[z,q]=w.useState([]),[H,R]=w.useState(""),[L,G]=w.useState(""),[W,Q]=w.useState(""),[X,se]=w.useState("all"),[le,he]=w.useState(!0),[we,ie]=w.useState(!1),[Ee,ye]=w.useState([]),[Ie,ut]=w.useState(""),[Qe,$t]=w.useState(""),[Ge,et]=w.useState(""),[vt,Te]=w.useState(new Set),[Ve,pt]=w.useState(!1),[wt,Ut]=w.useState(!1),[ct,yt]=w.useState([]),[rt,Oe]=w.useState([]),[$e,Mt]=w.useState([]),[It,At]=w.useState([]),[tr,ar]=w.useState(!1),[dr,or]=w.useState(!1),[mr,ve]=w.useState(!1),[Fe,Be]=w.useState(!1),[Pe,lt]=w.useState({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),[Ct,Lt]=w.useState({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),[Ue,st]=w.useState({subject_id:"",subject:"",description:"",is_active:!0}),[dt,Bt]=w.useState({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""});w.useEffect(()=>{console.log(" AdminCabinet component mounted - initializing..."),Yt()},[]),w.useEffect(()=>{const Ce=Dt=>{Ve&&!Dt.target.closest(".admin-menu")&&pt(!1)};return document.addEventListener("mousedown",Ce),()=>{document.removeEventListener("mousedown",Ce)}},[Ve]);const Yt=w.useCallback(async()=>{try{c(!0),await Br(),console.log("Admin app initialized")}catch(Ce){d("Failed to initialize admin app"),console.error("Admin app initialization error:",Ce)}finally{c(!1)}},[]),xr=w.useCallback(()=>{pt(Ce=>!Ce)},[]),Rr=w.useCallback(()=>{Ut(!0),pt(!1)},[]),yr=w.useCallback(()=>{Ut(!1)},[]),Br=w.useCallback(async()=>{try{await Promise.all([me(),Ne(),be(),Ae()])}catch(Ce){console.error("Error loading admin data:",Ce),d("Failed to load admin data")}},[]),me=w.useCallback(async()=>{try{const Ce="admin_users_",Dt=Os(Ce);if(Dt){console.log(" Using cached users data"),yt(Dt);return}const Fr=await n("/.netlify/functions/get-all-users");console.log(" Users response:",Fr);const Kr=Fr.users||[];yt(Kr),vs(Ce,Kr,hs.admin_users),console.log(" Users set to state:",Kr)}catch(Ce){console.error("Error loading users:",Ce)}},[n]),Ne=w.useCallback(async()=>{try{const Ce="admin_teachers_",Dt=Os(Ce);if(Dt){console.log(" Using cached teachers data"),Oe(Dt);return}const Fr=await n("/.netlify/functions/get-all-teachers");console.log(" Teachers response:",Fr);const Kr=Fr.teachers||[];Oe(Kr),vs(Ce,Kr,hs.admin_teachers),console.log(" Teachers set to state:",Kr)}catch(Ce){console.error("Error loading teachers:",Ce)}},[n]),be=w.useCallback(async()=>{try{const Ce="admin_subjects_",Dt=Os(Ce);if(Dt){console.log(" Using cached subjects data"),Mt(Dt);return}const Fr=await n("/.netlify/functions/get-all-subjects");console.log(" Subjects response:",Fr);const Kr=Fr.subjects||[];Mt(Kr),vs(Ce,Kr,hs.admin_subjects),console.log(" Subjects set to state:",Kr)}catch(Ce){console.error("Error loading subjects:",Ce)}},[n]),Ae=w.useCallback(async()=>{try{const Ce="admin_academic_years_",Dt=Os(Ce);if(Dt){console.log(" Using cached academic years data"),At(Dt);return}const Fr=await _u.loadAcademicCalendar();Fr&&Array.isArray(Fr)?(At(Fr),vs(Ce,Fr,hs.admin_academic_years)):console.error("Failed to load academic calendar")}catch(Ce){console.error("Error loading academic year:",Ce)}},[]),ue=w.useCallback(async()=>{try{if(T(!_),!_){const Ce=Date.now(),[Dt,Fr]=await Promise.all([n(`/.netlify/functions/get-all-tests?t=${Ce}`),n(`/.netlify/functions/get-test-assignments?t=${Ce}`)]);console.log(" Active tests response:",Dt),console.log(" Assignments response:",Fr);const Kr=Dt.tests||[],Qr=(Fr.assignments||[]).reduce((ta,yi)=>{const xn=`${yi.test_type}-${yi.test_id}`;return ta[xn]||(ta[xn]=[]),ta[xn].push(yi),ta},{}),ns=Kr.map(ta=>{const yi=`${ta.test_type}-${ta.test_id}`,xn=Qr[yi]||[],Al=xn.some(sl=>sl.is_active);return{...ta,is_active:Al,assignments:xn}});q(ns),console.log(" All tests with status set to state:",ns)}}catch(Ce){console.error("Error loading tests:",Ce),h({type:"error",message:"Failed to load tests"})}},[n,_]),ge=w.useCallback((Ce,Dt)=>{lt(Fr=>({...Fr,[Ce]:Dt}))},[]),Me=w.useCallback((Ce,Dt)=>{Lt(Fr=>({...Fr,[Ce]:Dt}))},[]),ot=w.useCallback((Ce,Dt)=>{st(Fr=>({...Fr,[Ce]:Dt}))},[]);w.useCallback(()=>{console.log(" Testing local storage...");try{const Ce={test:"data",timestamp:Date.now()};localStorage.setItem("test",JSON.stringify(Ce));const Dt=JSON.parse(localStorage.getItem("test"));console.log(" Local storage test successful:",Dt),h({type:"success",message:"Local storage test successful"})}catch(Ce){console.error(" Local storage test failed:",Ce),h({type:"error",message:"Local storage test failed"})}},[]),w.useCallback(()=>{console.log(" Clearing local storage...");try{localStorage.clear(),console.log(" Local storage cleared"),h({type:"success",message:"Local storage cleared"})}catch(Ce){console.error(" Error clearing local storage:",Ce),h({type:"error",message:"Error clearing local storage"})}},[]),w.useCallback(async()=>{console.log(" Checking teacher subjects...");try{const Dt=(await n("/.netlify/functions/get-all-teachers")).data||[];console.log(" Teachers data:",Dt),h({type:"success",message:`Found ${Dt.length} teachers`})}catch(Ce){console.error(" Error checking teacher subjects:",Ce),h({type:"error",message:"Error checking teacher subjects"})}},[n]);const Je=w.useCallback(async Ce=>{Ce.preventDefault();try{console.log(" Submitting user:",Pe);const Dt=await s("/.netlify/functions/add-user",Pe);Dt.success?(h({type:"success",message:"User added successfully"}),ar(!1),lt({grade:"",class:"",number:"",student_id:"",name:"",surname:"",nickname:"",password:"",is_active:!0}),me()):h({type:"error",message:Dt.message||"Failed to add user"})}catch(Dt){console.error(" Error adding user:",Dt),h({type:"error",message:"Error adding user"})}},[Pe,s,me]),nt=w.useCallback(async Ce=>{Ce.preventDefault();try{console.log(" Submitting teacher:",Ct);const Dt=await s("/.netlify/functions/add-teacher",Ct);Dt.success?(h({type:"success",message:"Teacher added successfully"}),or(!1),Lt({teacher_id:"",username:"",password:"",first_name:"",last_name:"",is_active:!0}),Ne()):h({type:"error",message:Dt.message||"Failed to add teacher"})}catch(Dt){console.error(" Error adding teacher:",Dt),h({type:"error",message:"Error adding teacher"})}},[Ct,s,Ne]),mt=w.useCallback(async Ce=>{Ce.preventDefault();try{console.log(" Submitting subject:",Ue);const Dt=await s("/.netlify/functions/add-subject",Ue);Dt.success?(h({type:"success",message:"Subject added successfully"}),ve(!1),st({subject_id:"",subject:"",description:"",is_active:!0}),be()):h({type:"error",message:Dt.message||"Failed to add subject"})}catch(Dt){console.error(" Error adding subject:",Dt),h({type:"error",message:"Error adding subject"})}},[Ue,s,be]),de=w.useCallback(Ce=>{j(Ce),M({name:Ce.name||"",surname:Ce.surname||"",grade:Ce.grade||"",class:Ce.class||"",student_id:Ce.student_id||"",nickname:Ce.nickname||"",password:Ce.password||"",is_active:Ce.is_active!==void 0?Ce.is_active:!0})},[]),Se=w.useCallback(async()=>{try{const Ce=[];Object.keys(P).forEach(Dt=>{Dt!=="student_id"&&P[Dt]!==F[Dt]&&Ce.push({fieldName:Dt,newValue:P[Dt]})});for(const Dt of Ce)await s("/.netlify/functions/update-user",{userId:F.student_id,fieldName:Dt.fieldName,newValue:Dt.newValue});h({type:"success",message:"User updated successfully!"}),j(null),M({}),me()}catch{h({type:"error",message:"Failed to update user"})}},[P,F,s,me]),De=w.useCallback(async Ce=>{if(window.confirm("Are you sure you want to delete this user?"))try{(await s("/.netlify/functions/delete-user",{userId:Ce})).success&&(h({type:"success",message:"User deleted successfully!"}),me())}catch{h({type:"error",message:"Failed to delete user"})}},[s,me]),Le=w.useCallback(Ce=>{U(Ce),te({teacher_id:Ce.teacher_id||"",username:Ce.username||"",password:Ce.password||"",first_name:Ce.first_name||"",last_name:Ce.last_name||"",is_active:Ce.is_active!==void 0?Ce.is_active:!0})},[]),tt=w.useCallback(async()=>{try{const Ce=[];Object.keys(K).forEach(Dt=>{Dt!=="teacher_id"&&K[Dt]!==I[Dt]&&Ce.push({fieldName:Dt,newValue:K[Dt]})});for(const Dt of Ce)await s("/.netlify/functions/update-teacher",{teacherId:I.teacher_id,fieldName:Dt.fieldName,newValue:Dt.newValue});h({type:"success",message:"Teacher updated successfully!"}),U(null),te({}),Ne()}catch{h({type:"error",message:"Failed to update teacher"})}},[K,I,s,Ne]),qt=w.useCallback(async Ce=>{if(window.confirm("Are you sure you want to delete this teacher?"))try{(await s("/.netlify/functions/delete-teacher",{teacherId:Ce})).success&&(h({type:"success",message:"Teacher deleted successfully!"}),Ne())}catch{h({type:"error",message:"Failed to delete teacher"})}},[s,Ne]),kr=w.useCallback(Ce=>{Z(Ce),J({subject_id:Ce.subject_id||"",subject:Ce.subject||""})},[]),jr=w.useCallback(async()=>{try{const Ce=[];Object.keys(B).forEach(Dt=>{Dt!=="subject_id"&&B[Dt]!==re[Dt]&&Ce.push({fieldName:Dt,newValue:B[Dt]})});for(const Dt of Ce)await s("/.netlify/functions/update-subject",{subjectId:re.subject_id,fieldName:Dt.fieldName,newValue:Dt.newValue});h({type:"success",message:"Subject updated successfully!"}),Z(null),J({}),be()}catch{h({type:"error",message:"Failed to update subject"})}},[B,re,s,be]),_t=w.useCallback(async Ce=>{if(window.confirm("Are you sure you want to delete this subject?"))try{const Dt=await s("/.netlify/functions/delete-subject",{subjectId:Ce});Dt.success?(h({type:"success",message:"Subject deleted successfully!"}),be()):h({type:"error",message:Dt.message||"Failed to delete subject"})}catch{h({type:"error",message:"Failed to delete subject"})}},[s,be]),ur=w.useCallback((Ce,Dt)=>{Bt(Fr=>({...Fr,[Ce]:Dt}))},[]),Gr=w.useCallback(async Ce=>{if(Ce.preventDefault(),!dt.startDate||!dt.endDate||!dt.teacherId){h({type:"error",message:"Please fill in all required fields (Start Date, End Date, Teacher ID)"});return}if(window.confirm("Are you sure you want to delete all test data for the selected criteria? This action cannot be undone."))try{const Dt=await s("/.netlify/functions/delete-test-data",dt);Dt.success?(h({type:"success",message:`Successfully deleted ${Dt.deletedCount} test records!`}),Be(!1),Bt({startDate:"",endDate:"",teacherId:"",grades:[],classes:[],subjectId:""})):h({type:"error",message:Dt.message||"Failed to delete test data"})}catch{h({type:"error",message:"Failed to delete test data"})}},[dt,s]),Mr=w.useCallback(async(Ce,Dt,Fr)=>{try{const Kr=Date.now(),On=await n(`/.netlify/functions/get-test-assignments?t=${Kr}`);if(On.success&&On.assignments){const Qr=On.assignments.filter(ns=>ns.test_id===parseInt(Ce)&&ns.test_type===Dt);if(Qr.length===0){h({type:"error",message:"No assignments found for this test"});return}for(const ns of Qr){const ta=await s("/.netlify/functions/remove-assignment",{teacher_id:Fr,assignment_id:ns.assignment_id,test_type:Dt,test_id:Ce});if(!ta.success){h({type:"error",message:`Failed to complete test: ${ta.message}`});return}}h({type:"success",message:"Test marked as complete successfully!"}),await ue()}else h({type:"error",message:"Failed to get test assignments"})}catch(Kr){console.error("Error completing test:",Kr),h({type:"error",message:"Failed to complete test"})}},[s,n,ue]),Tr=w.useCallback(async(Ce,Dt,Fr)=>{try{const Kr=Date.now(),On=await n(`/.netlify/functions/get-test-assignments?t=${Kr}`);if(On.success&&On.assignments){const Qr=On.assignments.filter(ns=>ns.test_id===parseInt(Ce)&&ns.test_type===Dt);if(Qr.length===0){h({type:"error",message:"No assignments found for this test"});return}for(const ns of Qr){const ta=await s("/.netlify/functions/remove-assignment",{teacher_id:Fr,assignment_id:ns.assignment_id,test_type:Dt,test_id:Ce,mark_active:!0});if(!ta.success){h({type:"error",message:`Failed to reactivate test: ${ta.message}`});return}}h({type:"success",message:"Test marked as active successfully!"}),await ue()}else h({type:"error",message:"Failed to get test assignments"})}catch(Kr){console.error("Error reactivating test:",Kr),h({type:"error",message:"Failed to reactivate test"})}},[s,n,ue]),qr=w.useCallback(async(Ce=!1)=>{try{const Dt=Date.now(),Fr=await n(`/.netlify/functions/get-all-tests?t=${Dt}`);console.log(" Actual tests response:",Fr),ye(Fr.tests||[]),console.log(" Actual tests set to state:",Fr.tests||[])}catch(Dt){console.error("Error loading actual tests:",Dt),h({type:"error",message:"Failed to load tests"})}},[n]),$r=w.useCallback(async(Ce,Dt,Fr)=>{try{const Kr=await s("/.netlify/functions/delete-test",{test_id:Ce,test_type:Dt,teacher_id:Fr});if(Kr.success){h({type:"success",message:"Test deleted successfully!"});const On=`${Dt}-${Ce}-${Fr}`;Te(Qr=>{const ns=new Set(Qr);return ns.delete(On),ns}),await qr(!0)}else h({type:"error",message:`Failed to delete test: ${Kr.message}`})}catch(Kr){console.error("Error deleting test:",Kr),h({type:"error",message:"Failed to delete test"})}},[s,qr]),qn=w.useCallback((Ce,Dt,Fr)=>{const Kr=`${Dt}-${Ce}-${Fr}`;Te(On=>{const Qr=new Set(On);return Qr.has(Kr)?Qr.delete(Kr):Qr.add(Kr),Qr})},[]),gr=N?ct.filter(Ce=>Ce.grade.toString()===N):ct,pn=z.filter(Ce=>{const Dt=X==="all"?!0:X==="active"?Ce.is_active:!Ce.is_active,Fr=!H||Ce.teacher_id===H,Kr=!L||new Date(Ce.created_at)>=new Date(L),On=!W||new Date(Ce.created_at)<=new Date(W+"T23:59:59");return Dt&&Fr&&Kr&&On}),Zr=Ee.filter(Ce=>{const Dt=!Ie||Ce.teacher_id===Ie,Fr=!Qe||new Date(Ce.created_at)>=new Date(Qe),Kr=!Ge||new Date(Ce.created_at)<=new Date(Ge+"T23:59:59");return Dt&&Fr&&Kr}),Zn=w.useCallback(()=>{if(vt.size===Zr.length&&Zr.length>0)Te(new Set);else{const Ce=Zr.map(Dt=>`${Dt.test_type}-${Dt.test_id}-${Dt.teacher_id}`);Te(new Set(Ce))}},[vt.size,Zr]),Fn=w.useCallback(async()=>{if(vt.size!==0&&window.confirm(`Are you sure you want to delete ${vt.size} test(s)?`))try{const Ce=Array.from(vt).map(Dt=>{const[Fr,Kr,On]=Dt.split("-");return s("/.netlify/functions/delete-test",{test_id:parseInt(Kr),test_type:Fr,teacher_id:On})});await Promise.all(Ce),h({type:"success",message:`Successfully deleted ${vt.size} test(s)!`}),Te(new Set),await qr(!0)}catch(Ce){console.error("Error deleting marked tests:",Ce),h({type:"error",message:"Failed to delete some tests. Please try again."})}},[vt,s,qr]);return l.jsxs(Ze.div,{id:"admin-cabinet-main",className:ht.container,initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[l.jsx(Ze.div,{className:ht.header,initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.1,duration:.5},children:l.jsx("div",{className:ht.headerContent,children:l.jsxs("div",{className:ht.headerFlex,children:[l.jsxs(Ze.div,{className:ht.adminInfo,initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.2,duration:.5},children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx(Ze.div,{className:ht.adminAvatar,initial:{scale:0},animate:{scale:1},transition:{delay:.3,duration:.3,type:"spring"},whileHover:{scale:1.1},children:l.jsx("span",{className:"text-white font-semibold text-xl",children:e?.username?.charAt(0)||"A"})})}),l.jsxs("div",{children:[l.jsx("h1",{className:ht.adminText,children:e?.username||"Administrator"}),l.jsx("p",{className:ht.adminSubtext,children:"Administrator Dashboard"})]})]}),l.jsxs(Ze.div,{className:ht.menuContainer,initial:{x:20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3,duration:.5},children:[l.jsxs("button",{onClick:xr,className:ht.menuButton,style:{zIndex:1e3},children:[l.jsx("span",{className:"hidden sm:inline",children:"Menu"}),l.jsx(Ze.svg,{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",animate:{rotate:Ve?180:0},transition:{duration:.2},children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]}),l.jsx(Ai,{children:Ve&&l.jsx(Ze.div,{className:ht.menuDropdown,initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},transition:{duration:.2},children:l.jsxs("div",{className:"py-2",children:[l.jsx(Ze.button,{onClick:Rr,className:ht.menuItem,whileHover:{x:4},transition:{duration:.2},children:"Change Password"}),l.jsx(Ze.button,{onClick:()=>{xr(),r()},className:ht.menuItemLogout,whileHover:{x:4},transition:{duration:.2},children:"Logout"})]})})})]})]})})}),o&&l.jsx(Xr,{text:"Loading..."}),u&&l.jsx(bu,{type:"error",message:u,onClose:()=>d(null)}),f&&l.jsx(bu,{type:f.type,message:f.message,onClose:()=>h(null)}),wt&&l.jsx("div",{className:ht.modalOverlay,children:l.jsxs("div",{className:ht.modalContent,children:[l.jsx("h2",{className:ht.modalTitle,children:"Change Password"}),l.jsxs("form",{className:"space-y-4",children:[l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{htmlFor:"currentPassword",className:ht.formLabel,children:"Current Password"}),l.jsx("input",{type:"password",id:"currentPassword",className:ht.formInput})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{htmlFor:"newPassword",className:ht.formLabel,children:"New Password"}),l.jsx("input",{type:"password",id:"newPassword",className:ht.formInput})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{htmlFor:"confirmPassword",className:ht.formLabel,children:"Confirm New Password"}),l.jsx("input",{type:"password",id:"confirmPassword",className:ht.formInput})]}),l.jsxs("div",{className:ht.modalActions,children:[l.jsx(at,{type:"button",variant:"secondary",onClick:yr,className:"flex-1",children:"Cancel"}),l.jsx(at,{type:"submit",variant:"primary",className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"Change Password"})]})]})]})}),l.jsx(Ze.div,{className:ht.mainContainer,initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.5},children:l.jsxs("div",{className:"space-y-6",children:[l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsx(Kt.Header,{className:ht.cardHeader,children:l.jsx(Kt.Title,{className:ht.cardTitle,children:"User Management"})}),l.jsxs(Kt.Body,{className:ht.cardBody,children:[l.jsxs("div",{className:ht.buttonGroup,children:[l.jsx(at,{variant:"primary",onClick:()=>ar(!0),className:ht.buttonPrimary,children:"Add User"}),l.jsx(at,{variant:"secondary",onClick:()=>{me(),p(!g)},className:ht.buttonSecondary,children:g?"Hide Users Table":"Get All Users "})]}),l.jsx(Ai,{children:tr&&l.jsxs(Ze.div,{className:ht.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New User"}),l.jsxs("form",{onSubmit:Je,className:"space-y-4",children:[l.jsxs("div",{className:ht.formGrid,children:[l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Grade"}),l.jsx("input",{type:"text",value:Pe.grade,onChange:Ce=>ge("grade",Ce.target.value),className:ht.formInput,placeholder:"Enter grade"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Class"}),l.jsx("input",{type:"text",value:Pe.class,onChange:Ce=>ge("class",Ce.target.value),className:ht.formInput,placeholder:"Enter class"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Number"}),l.jsx("input",{type:"text",value:Pe.number,onChange:Ce=>ge("number",Ce.target.value),className:ht.formInput,placeholder:"Enter number"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Student ID"}),l.jsx("input",{type:"text",value:Pe.student_id,onChange:Ce=>ge("student_id",Ce.target.value),className:ht.formInput,placeholder:"Enter student ID"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Name"}),l.jsx("input",{type:"text",value:Pe.name,onChange:Ce=>ge("name",Ce.target.value),className:ht.formInput,placeholder:"Enter name"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Surname"}),l.jsx("input",{type:"text",value:Pe.surname,onChange:Ce=>ge("surname",Ce.target.value),className:ht.formInput,placeholder:"Enter surname"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Nickname"}),l.jsx("input",{type:"text",value:Pe.nickname,onChange:Ce=>ge("nickname",Ce.target.value),className:ht.formInput,placeholder:"Enter nickname"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Pe.password,onChange:Ce=>ge("password",Ce.target.value),className:ht.formInput,placeholder:"Enter password"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"userActive",checked:Pe.is_active,onChange:Ce=>ge("is_active",Ce.target.checked),className:ht.formCheckbox}),l.jsx("label",{htmlFor:"userActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:ht.formActions,children:[l.jsx(at,{type:"button",variant:"secondary",onClick:()=>ar(!1),className:ht.buttonSecondary,children:"Cancel"}),l.jsx(at,{type:"submit",variant:"primary",className:ht.buttonPrimary,children:"Add User"})]})]})]})}),g&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Users (",gr.length," of ",ct.length,")"]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Filter by Grade:"}),l.jsxs("select",{value:N,onChange:Ce=>E(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Grades"}),[...new Set(ct.map(Ce=>Ce.grade))].sort().map(Ce=>l.jsxs("option",{value:Ce,children:["Grade ",Ce]},Ce))]})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-[600px]",children:l.jsxs("table",{className:ht.table,children:[l.jsx("thead",{className:ht.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:ht.tableHeaderCell,children:"Name"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Grade"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Class"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Student ID"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Number"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Nickname"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:ht.tableBody,children:gr.map((Ce,Dt)=>l.jsxs("tr",{className:ht.tableRow,children:[l.jsxs("td",{className:ht.tableCell,children:[Ce.name," ",Ce.surname]}),l.jsx("td",{className:ht.tableCell,children:Ce.grade}),l.jsx("td",{className:ht.tableCell,children:Ce.class}),l.jsx("td",{className:ht.tableCell,children:Ce.student_id}),l.jsx("td",{className:ht.tableCell,children:Ce.number}),l.jsx("td",{className:ht.tableCell,children:Ce.nickname}),l.jsx("td",{className:ht.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>de(Ce),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>De(Ce.student_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},Ce.id||Dt))})]})})})]})]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsxs(Kt.Header,{className:ht.cardHeader,children:[l.jsx(Kt.Title,{className:ht.cardTitle,children:"Teacher Management"}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsx("button",{onClick:i,className:"px-3 py-1.5 bg-orange-600 text-white rounded hover:bg-orange-700 transition-colors text-xs whitespace-nowrap",title:"Check and mark overdue assignments (7+ days old) as inactive",children:"Check Overdue Assignments"}),l.jsx(at,{variant:"primary",onClick:()=>or(!0),className:"text-xs whitespace-nowrap",children:"Add Teacher"}),l.jsx(at,{variant:"secondary",onClick:()=>{Ne(),v(!x)},className:"text-xs whitespace-nowrap",children:x?"Hide Teachers Table":"Get All Teachers "})]})]}),l.jsxs(Kt.Body,{className:ht.cardBody,children:[l.jsx(Ai,{children:dr&&l.jsxs(Ze.div,{className:ht.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Teacher"}),l.jsxs("form",{onSubmit:nt,className:"space-y-4",children:[l.jsxs("div",{className:ht.formGrid,children:[l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Teacher ID"}),l.jsx("input",{type:"text",value:Ct.teacher_id,onChange:Ce=>Me("teacher_id",Ce.target.value),className:ht.formInput,placeholder:"Enter teacher ID"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Username"}),l.jsx("input",{type:"text",value:Ct.username,onChange:Ce=>Me("username",Ce.target.value),className:ht.formInput,placeholder:"Enter username"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Password"}),l.jsx("input",{type:"password",value:Ct.password,onChange:Ce=>Me("password",Ce.target.value),className:ht.formInput,placeholder:"Enter password"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"First Name"}),l.jsx("input",{type:"text",value:Ct.first_name,onChange:Ce=>Me("first_name",Ce.target.value),className:ht.formInput,placeholder:"Enter first name"})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Last Name"}),l.jsx("input",{type:"text",value:Ct.last_name,onChange:Ce=>Me("last_name",Ce.target.value),className:ht.formInput,placeholder:"Enter last name"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacherActive",checked:Ct.is_active,onChange:Ce=>Me("is_active",Ce.target.checked),className:ht.formCheckbox}),l.jsx("label",{htmlFor:"teacherActive",className:"ml-2 text-sm text-gray-700",children:"Active"})]}),l.jsxs("div",{className:ht.formActions,children:[l.jsx(at,{type:"button",variant:"secondary",onClick:()=>or(!1),className:ht.buttonSecondary,children:"Cancel"}),l.jsx(at,{type:"submit",variant:"primary",className:ht.buttonPrimary,children:"Add Teacher"})]})]})]})}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit User"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),l.jsx("input",{type:"text",value:P.name,onChange:Ce=>M({...P,name:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Surname"}),l.jsx("input",{type:"text",value:P.surname,onChange:Ce=>M({...P,surname:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Grade"}),l.jsx("input",{type:"number",value:P.grade,onChange:Ce=>M({...P,grade:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),l.jsx("input",{type:"number",value:P.class,onChange:Ce=>M({...P,class:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student ID"}),l.jsx("input",{type:"text",value:P.student_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Student ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nickname"}),l.jsx("input",{type:"text",value:P.nickname,onChange:Ce=>M({...P,nickname:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:P.password,onChange:Ce=>M({...P,password:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"is_active",checked:P.is_active,onChange:Ce=>M({...P,is_active:Ce.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{j(null),M({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:Se,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update User"})]})]})}),x&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Teachers (",rt.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:ht.table,children:[l.jsx("thead",{className:ht.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:ht.tableHeaderCell,children:"Teacher ID"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Name"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Username"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Password"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Status"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Created"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:ht.tableBody,children:rt.map((Ce,Dt)=>l.jsxs("tr",{className:ht.tableRow,children:[l.jsx("td",{className:ht.tableCell,children:Ce.teacher_id}),l.jsxs("td",{className:ht.tableCell,children:[Ce.first_name," ",Ce.last_name]}),l.jsx("td",{className:ht.tableCell,children:Ce.username}),l.jsx("td",{className:ht.tableCell,children:Ce.password}),l.jsx("td",{className:ht.tableCell,children:l.jsx("span",{className:Ce.is_active?ht.statusActive:ht.statusInactive,children:Ce.is_active?"Active":"Inactive"})}),l.jsx("td",{className:ht.tableCell,children:new Date(Ce.created_at).toLocaleDateString()}),l.jsx("td",{className:ht.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>Le(Ce),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>qt(Ce.teacher_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},Ce.teacher_id||Dt))})]})})})]})]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.7,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsx(Kt.Header,{className:ht.cardHeader,children:l.jsx(Kt.Title,{className:ht.cardTitle,children:"Subject Management"})}),l.jsxs(Kt.Body,{className:ht.cardBody,children:[l.jsxs("div",{className:ht.buttonGroup,children:[l.jsx(at,{variant:"primary",onClick:()=>ve(!0),className:ht.buttonPrimary,children:"Add Subject"}),l.jsx(at,{variant:"secondary",onClick:()=>{be(),b(!C)},className:ht.buttonSecondary,children:C?"Hide Subjects Table":"Get All Subjects "})]}),l.jsx(Ai,{children:mr&&l.jsxs(Ze.div,{className:ht.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Add New Subject"}),l.jsxs("form",{onSubmit:mt,className:"space-y-4",children:[l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Subject Name"}),l.jsx("input",{type:"text",value:Ue.subject,onChange:Ce=>ot("subject",Ce.target.value),className:ht.formInput,placeholder:"Enter subject name",required:!0}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Subject ID will be automatically generated"})]}),l.jsxs("div",{className:ht.formActions,children:[l.jsx(at,{type:"button",variant:"secondary",onClick:()=>ve(!1),className:ht.buttonSecondary,children:"Cancel"}),l.jsx(at,{type:"submit",variant:"primary",className:ht.buttonPrimary,children:"Add Subject"})]})]})]})}),I&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Teacher"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher ID"}),l.jsx("input",{type:"text",value:K.teacher_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Teacher ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),l.jsx("input",{type:"text",value:K.username,onChange:Ce=>te({...K,username:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),l.jsx("input",{type:"text",value:K.password,onChange:Ce=>te({...K,password:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),l.jsx("input",{type:"text",value:K.first_name,onChange:Ce=>te({...K,first_name:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),l.jsx("input",{type:"text",value:K.last_name,onChange:Ce=>te({...K,last_name:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),l.jsxs("div",{className:"flex items-center",children:[l.jsx("input",{type:"checkbox",id:"teacher_is_active",checked:K.is_active,onChange:Ce=>te({...K,is_active:Ce.target.checked}),className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:"teacher_is_active",className:"ml-2 text-sm font-medium text-gray-700",children:"Active"})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>{U(null),te({})},className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300",children:"Cancel"}),l.jsx("button",{onClick:tt,className:"px-4 py-2 text-sm font-medium text-white bg-purple-600 rounded-md hover:bg-purple-700",children:"Update Teacher"})]})]})}),re&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Edit Subject"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject ID"}),l.jsx("input",{type:"text",value:B.subject_id,disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-100 text-gray-500 cursor-not-allowed"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Subject ID cannot be changed"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject Name"}),l.jsx("input",{type:"text",value:B.subject,onChange:Ce=>J({...B,subject:Ce.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[l.jsx("button",{onClick:()=>Z(null),className:"px-4 py-2 text-gray-600 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",children:"Cancel"}),l.jsx("button",{onClick:jr,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors",children:"Update Subject"})]})]})}),C&&l.jsxs("div",{className:"mt-6",children:[l.jsx("div",{className:"mb-4",children:l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Subjects (",$e.length,")"]})}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto max-h-96",children:l.jsxs("table",{className:ht.table,children:[l.jsx("thead",{className:ht.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:ht.tableHeaderCell,children:"Subject ID"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Subject Name"}),l.jsx("th",{className:ht.tableHeaderCell,children:"Actions"})]})}),l.jsx("tbody",{className:ht.tableBody,children:$e.map((Ce,Dt)=>l.jsxs("tr",{className:ht.tableRow,children:[l.jsx("td",{className:ht.tableCell,children:Ce.subject_id}),l.jsx("td",{className:ht.tableCell,children:Ce.subject}),l.jsx("td",{className:ht.tableCell,children:l.jsxs("div",{className:"flex space-x-2",children:[l.jsx("button",{onClick:()=>kr(Ce),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Edit"}),l.jsx("button",{onClick:()=>_t(Ce.subject_id),className:"text-red-600 hover:text-red-800 text-sm font-medium",children:"Delete"})]})})]},Ce.subject_id||Dt))})]})})})]})]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.8,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsx(Kt.Header,{className:ht.cardHeader,children:l.jsx(Kt.Title,{className:ht.cardTitle,children:"Test Data Deletion"})}),l.jsxs(Kt.Body,{className:ht.cardBody,children:[l.jsx("div",{className:ht.buttonGroup,children:l.jsx(at,{variant:"danger",onClick:()=>Be(!0),className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})}),l.jsx(Ai,{children:Fe&&l.jsxs(Ze.div,{className:ht.formContainer,initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Delete Test Data by Date Range"}),l.jsxs("form",{onSubmit:Gr,className:"space-y-4",children:[l.jsxs("div",{className:ht.formGrid,children:[l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Start Date *"}),l.jsx("input",{type:"date",value:dt.startDate,onChange:Ce=>ur("startDate",Ce.target.value),className:ht.formInput,required:!0})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"End Date *"}),l.jsx("input",{type:"date",value:dt.endDate,onChange:Ce=>ur("endDate",Ce.target.value),className:ht.formInput,required:!0})]})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Teacher ID *"}),l.jsxs("select",{value:dt.teacherId,onChange:Ce=>ur("teacherId",Ce.target.value),className:ht.formInput,required:!0,children:[l.jsx("option",{value:"",children:"Select a teacher"}),rt.map(Ce=>l.jsxs("option",{value:Ce.teacher_id,children:[Ce.teacher_id," - ",Ce.first_name," ",Ce.last_name]},Ce.teacher_id))]})]}),l.jsxs("div",{className:ht.formGroup,children:[l.jsx("label",{className:ht.formLabel,children:"Subject (Optional)"}),l.jsxs("select",{value:dt.subjectId,onChange:Ce=>ur("subjectId",Ce.target.value),className:ht.formInput,children:[l.jsx("option",{value:"",children:"All subjects"}),$e.map(Ce=>l.jsx("option",{value:Ce.subject_id,children:Ce.subject},Ce.subject_id))]})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Warning: This action cannot be undone"}),l.jsxs("div",{className:"mt-2 text-sm text-yellow-700",children:[l.jsx("p",{children:"This will permanently delete:"}),l.jsxs("ul",{className:"list-disc list-inside mt-1",children:[l.jsx("li",{children:"All test records within the date range"}),l.jsx("li",{children:"All test questions and answers"}),l.jsx("li",{children:"All test results and submissions"}),l.jsx("li",{children:"All test assignments"}),l.jsx("li",{children:"Associated Cloudinary images (for matching tests)"})]})]})]})]})}),l.jsxs("div",{className:ht.formActions,children:[l.jsx(at,{type:"button",variant:"secondary",onClick:()=>Be(!1),className:ht.buttonSecondary,children:"Cancel"}),l.jsx(at,{type:"submit",variant:"danger",className:"bg-red-600 hover:bg-red-700 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200 shadow-md",children:"Delete Test Data"})]})]})]})})]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.85,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsx(Kt.Header,{className:ht.cardHeader,children:l.jsx(Kt.Title,{className:ht.cardTitle,children:"Assignments Management"})}),l.jsxs(Kt.Body,{className:ht.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(at,{variant:"primary",onClick:ue,className:ht.buttonPrimary,children:_?"Hide Assignments Table":"Get All Assignments "})}),_&&l.jsx("div",{className:"mb-4",children:l.jsx("p",{className:"text-sm text-gray-600",children:"Showing all tests (Active and Completed)"})}),_&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Assignments (",pn.length," of ",z.length,")"]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:X,onChange:Ce=>se(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"all",children:"All"}),l.jsx("option",{value:"active",children:"Active"}),l.jsx("option",{value:"completed",children:"Completed"})]}),l.jsxs("select",{value:H,onChange:Ce=>R(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),rt.map(Ce=>l.jsxs("option",{value:Ce.teacher_id,children:[Ce.first_name," ",Ce.last_name]},Ce.teacher_id))]}),l.jsx("input",{type:"date",value:L,onChange:Ce=>G(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:W,onChange:Ce=>Q(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:ht.table,children:[l.jsx("thead",{className:ht.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider text-center",children:"Questions"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Created"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:ht.tableBody,children:pn.map((Ce,Dt)=>l.jsxs("tr",{className:ht.tableRow,children:[l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 max-w-xs truncate",title:Ce.test_name,children:Ce.test_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:Ce.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:Ce.teacher_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 text-center",children:Ce.num_questions}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:new Date(Ce.created_at).toLocaleDateString()}),l.jsx("td",{className:"px-4 py-3 text-xs",children:l.jsx("div",{className:"flex space-x-2",children:Ce.is_active?l.jsx("button",{onClick:()=>Mr(Ce.test_id,Ce.test_type,Ce.teacher_id),className:"text-xs font-medium px-2 py-1 rounded bg-orange-100 text-orange-700 hover:bg-orange-200",children:"Mark Complete"}):l.jsx("button",{onClick:()=>Tr(Ce.test_id,Ce.test_type,Ce.teacher_id),className:"text-xs font-medium px-2 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Mark Active"})})})]},`${Ce.test_type}-${Ce.test_id}-${Dt}`))})]})})})]})]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsx(Kt.Header,{className:ht.cardHeader,children:l.jsx(Kt.Title,{className:ht.cardTitle,children:"Test Management"})}),l.jsxs(Kt.Body,{className:ht.cardBody,children:[l.jsx("div",{className:"mb-4",children:l.jsx(at,{variant:"primary",onClick:()=>{we||qr(),ie(!we)},className:ht.buttonPrimary,children:we?"Hide Tests Table":"Get All Tests "})}),we&&l.jsxs("div",{className:"mt-6",children:[l.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsxs("h4",{className:"text-lg font-semibold text-gray-700",children:["All Tests (",Zr.length," of ",Ee.length,")"]}),vt.size>0&&l.jsxs(at,{variant:"danger",onClick:Fn,className:"text-sm px-4 py-2",children:["Delete Marked (",vt.size,")"]})]}),l.jsxs("div",{className:"flex flex-wrap gap-2",children:[l.jsxs("select",{value:Ie,onChange:Ce=>ut(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[l.jsx("option",{value:"",children:"All Teachers"}),rt.map(Ce=>l.jsxs("option",{value:Ce.teacher_id,children:[Ce.first_name," ",Ce.last_name]},Ce.teacher_id))]}),l.jsx("input",{type:"date",value:Qe,onChange:Ce=>$t(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Start Date"}),l.jsx("input",{type:"date",value:Ge,onChange:Ce=>et(Ce.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"End Date"})]})]}),l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:ht.table,children:[l.jsx("thead",{className:ht.tableHeader,children:l.jsxs("tr",{children:[l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:l.jsx("input",{type:"checkbox",checked:vt.size===Zr.length&&Zr.length>0,onChange:Zn,className:"cursor-pointer"})}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Test Name"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Type"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Teacher"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider text-center",children:"Questions"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Created"}),l.jsx("th",{className:"px-4 py-3 text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),l.jsx("tbody",{className:ht.tableBody,children:Zr.map((Ce,Dt)=>l.jsxs("tr",{className:ht.tableRow,children:[l.jsx("td",{className:ht.tableCell,children:l.jsx("input",{type:"checkbox",checked:vt.has(`${Ce.test_type}-${Ce.test_id}-${Ce.teacher_id}`),onChange:()=>qn(Ce.test_id,Ce.test_type,Ce.teacher_id),className:"cursor-pointer"})}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 max-w-xs truncate",title:Ce.test_name,children:Ce.test_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:Ce.test_type.replace("_"," ").toUpperCase()})}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:Ce.teacher_name}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900 text-center",children:Ce.num_questions}),l.jsx("td",{className:"px-4 py-3 text-xs text-gray-900",children:new Date(Ce.created_at).toLocaleDateString()}),l.jsx("td",{className:"px-4 py-3 text-xs",children:l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>$r(Ce.test_id,Ce.test_type,Ce.teacher_id),className:"text-xs font-medium px-2 py-1 rounded bg-red-100 text-red-700 hover:bg-red-200",children:"Delete"})})})]},`${Ce.test_type}-${Ce.test_id}-${Dt}`))})]})})})]})]})]})}),l.jsx(Ze.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.9,duration:.5},children:l.jsxs(Kt,{className:ht.cardContainer,children:[l.jsx(Kt.Header,{className:ht.cardHeader,children:l.jsx(Kt.Title,{className:ht.cardTitle,children:"Debug & Testing"})}),l.jsx(Kt.Body,{className:ht.cardBody})]})})]})})]})},YOe=()=>{const{isAdmin:e,getCurrentAdminId:t,logout:r}=ws(),{get:n}=tc(),{showNotification:s}=Ls();w.useEffect(()=>{a()},[]);const a=w.useCallback(async()=>{if(console.log(" Initializing Admin Application..."),!e()){console.error(" User is not an admin, redirecting to login"),s("Access Denied: You are not an administrator.","error"),r();return}try{i(),await o(),c(),u(),console.log(" Admin Application initialized successfully"),s("Admin dashboard loaded successfully","success")}catch(d){console.error(" Error initializing admin app:",d),s("Failed to initialize admin dashboard","error")}},[e,t,r,s,n]),i=w.useCallback(()=>{console.log(" Initializing global event listeners...");const d=f=>{f.ctrlKey&&f.key==="k"&&(f.preventDefault(),console.log("Admin search shortcut triggered"))};return document.addEventListener("keydown",d),()=>{document.removeEventListener("keydown",d)}},[]),o=w.useCallback(async()=>{try{console.log(" Loading admin data...");const[d,f,h,g]=await Promise.allSettled([n("/.netlify/functions/get-all-users"),n("/.netlify/functions/get-all-teachers"),n("/.netlify/functions/get-all-subjects"),_u.loadAcademicCalendar()]);d.status==="fulfilled"&&d.value?.success&&console.log(" Users loaded:",d.value.users?.length||0),f.status==="fulfilled"&&f.value?.success&&console.log(" Teachers loaded:",f.value.teachers?.length||0),h.status==="fulfilled"&&h.value?.success&&console.log(" Subjects loaded:",h.value.subjects?.length||0),g.status==="fulfilled"&&Array.isArray(g.value)&&console.log(" Academic years loaded:",g.value.length||0),console.log(" Admin data loading completed")}catch(d){throw console.error(" Error loading admin data:",d),d}},[n]),c=w.useCallback(()=>{console.log(" Initializing test deletion functionality..."),console.log(" Test deletion functionality initialized")},[]),u=w.useCallback(()=>{console.log(" Exposing admin functions globally..."),window.toggleSubjectsContent=()=>{const f=document.getElementById("allSubjectsContainer"),h=document.querySelector('button[onclick="toggleSubjectsContent()"]');if(!f){console.error(" allSubjectsContainer not found");return}if(!h){console.error(" Button not found");return}const g=f.style.display!=="none";f.style.display=g?"none":"block",h.textContent=g?"Show Subjects":"Hide Subjects"},window.showAddSubjectForm=()=>{const f=document.getElementById("addSubjectForm");f&&(f.style.display="block")},window.hideAddSubjectForm=()=>{const f=document.getElementById("addSubjectForm"),h=document.getElementById("newSubjectForm");f&&(f.style.display="none"),h&&h.reset()},window.showAddAcademicYearForm=()=>{const f=document.getElementById("addAcademicYearForm");f&&(f.style.display="block")},window.hideAddAcademicYearForm=()=>{const f=document.getElementById("addAcademicYearForm"),h=document.getElementById("newAcademicYearForm");f&&(f.style.display="none"),h&&h.reset()},window.toggleUsersContent=()=>{const f=document.getElementById("allUsersContainer"),h=document.querySelector('button[onclick="toggleUsersContent()"]');if(!f){console.error(" allUsersContainer not found");return}if(!h){console.error(" Button not found");return}const g=f.style.display!=="none";f.style.display=g?"none":"block",h.textContent=g?"Show Users":"Hide Users"},window.showAddUserForm=()=>{const f=document.getElementById("addUserForm");f&&(f.style.display="block")},window.hideAddUserForm=()=>{const f=document.getElementById("addUserForm"),h=document.getElementById("newUserForm");f&&(f.style.display="none"),h&&h.reset()},window.showAddTeacherForm=()=>{const f=document.getElementById("addTeacherForm");f&&(f.style.display="block")},window.hideAddTeacherForm=()=>{const f=document.getElementById("addTeacherForm"),h=document.getElementById("newTeacherForm");f&&(f.style.display="none"),h&&h.reset()},window.toggleTeachersContent=()=>{const f=document.getElementById("allTeachersContainer"),h=document.querySelector('button[onclick="toggleTeachersContent()"]');if(!f){console.error(" allTeachersContainer not found");return}if(!h){console.error(" Button not found");return}const g=f.style.display!=="none";f.style.display=g?"none":"block",h.textContent=g?"Show Teachers":"Hide Teachers"},window.toggleTestsContent=()=>{const f=document.getElementById("allTestsContainer"),h=document.querySelector('button[onclick="toggleTestsContent()"]');if(!f){console.error(" allTestsContainer not found");return}if(!h){console.error(" Button not found");return}const g=f.style.display!=="none";f.style.display=g?"none":"block",h.textContent=g?"Show Tests":"Hide Tests"},window.toggleAssignmentsContent=()=>{const f=document.getElementById("allAssignmentsContainer"),h=document.querySelector('button[onclick="toggleAssignmentsContent()"]');if(!f){console.error(" allAssignmentsContainer not found");return}if(!h){console.error(" Button not found");return}const g=f.style.display!=="none";f.style.display=g?"none":"block",h.textContent=g?"Show Assignments":"Hide Assignments"},window.toggleResultsContent=()=>{const f=document.getElementById("allResultsContainer"),h=document.querySelector('button[onclick="toggleResultsContent()"]');if(!f){console.error(" allResultsContainer not found");return}if(!h){console.error(" Button not found");return}const g=f.style.display!=="none";f.style.display=g?"none":"block",h.textContent=g?"Show Results":"Hide Results"};const d={};window.toggleSection=f=>{console.log(` toggleSection called with sectionId: ${f}`);const h=Date.now();if(d[f]&&h-d[f]<300){console.log(` Ignoring rapid successive call for ${f}`);return}d[f]=h;const g=document.getElementById(f);if(!g){console.error(` Section with id '${f}' not found!`);return}const p=g.style.display!=="none";g.style.display=p?"none":"block";const x=document.querySelector(`button[onclick="toggleSection('${f}')"]`);x&&(x.textContent=p?"Show":"Hide")},window.addClickListeners=()=>{console.log(" Adding click listeners to section headers...");const f=document.querySelectorAll(".section-header");console.log(` Found ${f.length} section headers`),f.forEach((h,g)=>{const p=h.textContent.trim();if(console.log(` Processing header ${g+1}:`,p),h.dataset.listenerAdded==="true"){console.log(` Skipping header ${p} - listener already added`);return}h.addEventListener("click",()=>{const x=h.dataset.sectionId;x&&window.toggleSection(x)}),h.dataset.listenerAdded="true",console.log(` Added click listener to header: ${p}`)})},window.makeFieldEditable=f=>{const h=f.textContent;f.dataset.field;const g=document.createElement("input");g.type="text",g.value=h,g.className="editable-input";const p=document.createElement("button");p.textContent="Save",p.className="btn-save",p.onclick=()=>window.saveField(f,g,p,x);const x=document.createElement("button");x.textContent="Cancel",x.className="btn-cancel",x.onclick=()=>{f.textContent=h,f.style.display="block",g.remove(),p.remove(),x.remove()},f.style.display="none",f.parentNode.insertBefore(g,f),f.parentNode.insertBefore(p,f),f.parentNode.insertBefore(x,f)},window.saveField=(f,h,g,p)=>{const x=h.value.trim(),v=f.dataset.field,C=f.dataset.recordId;if(!x){alert("Field cannot be empty");return}console.log(`Saving field ${v} for record ${C} with value: ${x}`),f.textContent=x,f.style.display="block",h.remove(),g.remove(),p.remove()},window.showTestDataDeletion=()=>console.log("showTestDataDeletion called"),window.hideTestDataDeletionForm=()=>console.log("hideTestDataDeletionForm called"),window.loadTeacherGradesClasses=()=>console.log("loadTeacherGradesClasses called"),window.checkTeacherSubjects=()=>console.log("checkTeacherSubjects called"),window.initializeTestDeletion=()=>console.log("initializeTestDeletion called"),window.handleAssignmentDeletion=()=>console.log("handleAssignmentDeletion called"),window.handleTestDataDeletion=()=>console.log("handleTestDataDeletion called"),window.getSelectedGradesClasses=()=>console.log("getSelectedGradesClasses called"),window.hideAssignmentDeletionForm=()=>console.log("hideAssignmentDeletionForm called"),window.addKeyboardAccessibility=()=>console.log("addKeyboardAccessibility called"),window.testToggleSection=()=>console.log("testToggleSection called"),window.testAllToggles=()=>console.log("testAllToggles called"),window.manualToggleTest=()=>console.log("manualToggleTest called"),window.addEditableFieldListeners=()=>console.log("addEditableFieldListeners called"),window.deleteTest=()=>console.log("deleteTest called"),window.testLocalStorage=()=>{console.log("Testing localStorage...");try{localStorage.setItem("test","value");const f=localStorage.getItem("test");return localStorage.removeItem("test"),console.log(" localStorage is working"),!0}catch(f){return console.error(" localStorage error:",f),!1}},window.clearAllLocalStorage=()=>{console.log("Clearing all localStorage..."),localStorage.clear(),console.log(" localStorage cleared")},window.exportLocalStorage=()=>{console.log("Exporting localStorage...");const f={};for(let x=0;x<localStorage.length;x++){const v=localStorage.key(x);f[v]=localStorage.getItem(v)}const h=new Blob([JSON.stringify(f,null,2)],{type:"application/json"}),g=URL.createObjectURL(h),p=document.createElement("a");p.href=g,p.download="localStorage-backup.json",p.click(),URL.revokeObjectURL(g)},console.log(" Admin functions exposed globally")},[]);return e()?l.jsx(KOe,{}):l.jsxs("div",{className:"admin-error",children:[l.jsx("h2",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access the admin dashboard."}),l.jsx("button",{onClick:r,children:"Return to Login"})]})},XOe=()=>{const[e,t]=w.useState(!1),[r,n]=w.useState("en");w.useEffect(()=>{localStorage.getItem("cookie_consent")||setTimeout(()=>{t(!0)},500);const c=localStorage.getItem("app_language")||(navigator.language.startsWith("th")?"th":"en");n(c)},[]);const s=()=>{localStorage.setItem("cookie_consent","informed"),localStorage.setItem("cookie_consent_date",new Date().toISOString()),t(!1)};if(!e)return null;const i={en:{title:"Cookie Information",message:"This app uses only essential cookies and local storage to manage authentication, sessions, and test progress. These functions are necessary for the app to operate correctly and do not require user consent under GDPR or Thailand's PDPA. No tracking or advertising cookies are used.",acknowledge:"I Understand",learnMore:"Learn More",privacyLink:"/privacy"},th:{title:"",message:"    GDPR  PDPA  ",acknowledge:"",learnMore:"",privacyLink:"/privacy"}}[r];return l.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 p-3 sm:p-6",children:l.jsx("div",{className:"max-w-4xl mx-auto rounded-lg shadow-2xl border-2 bg-white",children:l.jsx("div",{className:"p-3 sm:p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"text-lg font-semibold mb-2 text-gray-900",children:i.title}),l.jsx("p",{className:"text-sm text-gray-700",children:i.message}),l.jsx("a",{href:i.privacyLink,className:"text-sm mt-2 inline-block underline text-blue-600 hover:text-blue-800",children:i.learnMore})]}),l.jsx("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-auto sm:w-auto",children:l.jsx("button",{onClick:s,className:"font-medium rounded-lg transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 cursor-pointer px-4 py-2 text-sm sm:px-3 sm:py-1.5 sm:text-sm bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 whitespace-nowrap",children:i.acknowledge})})]})})})})},HC=({children:e,allowedRoles:t})=>{const{isAuthenticated:r,role:n,isLoading:s}=ws();return s?l.jsx("div",{className:"flex items-center justify-center min-h-screen",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}):r?t&&!t.includes(n)?l.jsx(o1,{to:"/unauthorized",replace:!0}):e:l.jsx(o1,{to:"/login",replace:!0})},JOe=()=>l.jsxs("div",{className:"unauthorized-page",children:[l.jsx("h1",{children:"Access Denied"}),l.jsx("p",{children:"You don't have permission to access this page."})]}),QOe=()=>l.jsx($U,{children:l.jsx(DV,{children:l.jsx(RV,{children:l.jsx(Mte,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:l.jsxs("div",{className:"app",children:[l.jsxs(v7,{children:[l.jsx(Ts,{path:"/privacy",element:l.jsx(Zhe,{})}),l.jsx(Ts,{path:"/login",element:l.jsx(Jhe,{})}),l.jsx(Ts,{path:"/unauthorized",element:l.jsx(JOe,{})}),l.jsx(Ts,{path:"/student/duel/:sessionCode",element:l.jsx(Age,{})}),l.jsx(Ts,{path:"/student/*",element:l.jsx(HC,{allowedRoles:["student"],children:l.jsx(Rge,{})})}),l.jsx(Ts,{path:"/teacher/*",element:l.jsx(HC,{allowedRoles:["teacher"],children:l.jsx(qOe,{})})}),l.jsx(Ts,{path:"/admin/*",element:l.jsx(HC,{allowedRoles:["admin"],children:l.jsx(YOe,{})})}),l.jsx(Ts,{path:"/",element:l.jsx(o1,{to:"/login",replace:!0})}),l.jsx(Ts,{path:"*",element:l.jsx(o1,{to:"/login",replace:!0})})]}),l.jsx(ZOe,{})]})})})})}),ZOe=()=>{const{isAuthenticated:e}=ws();return e?l.jsx(XOe,{}):null},eDe=["/login","/privacy","/privacy-policy"],tDe=["privacy","terms","legal"],rDe=e=>{const t=e.toLowerCase();return eDe.some(r=>t===r||t.startsWith(`${r}/`))?!0:tDe.some(r=>t.includes(r))};class nDe{constructor(){this.tokenKey="auth_token",this.refreshTokenKey="refresh_token",this.userKey="user_data",this.startIntegrityMonitoring()}startIntegrityMonitoring(){setInterval(()=>{this.performIntegrityCheck().catch(t=>{console.error("Integrity check failed:",t)})},3e4)}async performIntegrityCheck(){try{const t=await va.get();t&&!this.validateTokenFormat(t)&&(console.warn("Integrity check failed - corrupted token detected"),await this.restoreFromBackup()||(console.warn("No valid backup available - clearing authentication"),await this.clearAuth()))}catch(t){console.error("Error during integrity check:",t)}}async getToken(){const t=await va.get();return t&&!this.validateTokenFormat(t)?(console.warn("Corrupted token detected in storage - clearing it"),this.clearAuth(),null):t}getTokenSync(){return null}getRefreshToken(){return localStorage.getItem(this.refreshTokenKey)}getUserData(){const t=localStorage.getItem(this.userKey);return t?JSON.parse(t):null}async setToken(t){if(!this.validateTokenFormat(t))return console.error("Invalid token format - refusing to store corrupted token"),!1;try{this.decodeToken(t);const r=await va.get();if(r)try{localStorage.setItem(`${this.tokenKey}_backup`,r)}catch{}const n=await va.set(t);return n?console.log("Token stored successfully with secure storage (hash verification, retry, write verification)"):console.error("Failed to store token - secure storage failed"),n}catch(r){return console.error("Failed to store token - token is corrupted:",r),!1}}async restoreFromBackup(){try{const t=localStorage.getItem(`${this.tokenKey}_backup`);if(t&&this.validateTokenFormat(t))return console.log("Restoring token from backup"),await va.set(t)}catch(t){console.warn("Failed to restore from backup",t)}return!1}validateTokenFormat(t){if(!t||typeof t!="string")return console.warn("Token validation failed: not a string"),!1;if(!t.includes("."))return console.warn("Token validation failed: not a JWT format"),!1;const r=t.split(".");if(r.length!==3)return console.warn("Token validation failed: not 3 parts"),!1;for(let n=0;n<r.length;n++)try{atob(r[n].replace(/-/g,"+").replace(/_/g,"/"))}catch{return console.warn(`Token validation failed: part ${n} is not valid base64`),!1}return!0}setRefreshToken(t){localStorage.setItem(this.refreshTokenKey,t)}setUserData(t){localStorage.setItem(this.userKey,JSON.stringify(t))}setTokens(t,r){return this.setToken(t)?(this.setUserData({role:r}),localStorage.setItem("accessToken",t),!0):(console.error("Failed to set token - token validation failed"),!1)}async isAuthenticated(){const t=await this.getToken();if(!t)return!1;try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),!1;const r=t.split(".");if(r.length!==3)return console.warn("Invalid token format - not 3 parts"),this.clearAuth(),!1;const n=JSON.parse(atob(r[1])),s=Date.now()/1e3;return n.exp>s}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),!1}}getUserRole(){const t=this.getUserData();return t?t.role:null}isAdmin(){return this.getUserRole()==="admin"}isTeacher(){return this.getUserRole()==="teacher"}isStudent(){return this.getUserRole()==="student"}async clearAuth(){try{await va.clear(),localStorage.removeItem(this.refreshTokenKey),localStorage.removeItem(this.userKey),localStorage.removeItem(`${this.tokenKey}_backup`)}catch(t){console.error("Failed to clear localStorage - possible corruption:",t),this.forceClearAllAuthData()}}forceClearAllAuthData(){["auth_token","accessToken","userRole","userData","refresh_token","auth_token_backup"].forEach(r=>{try{localStorage.removeItem(r)}catch(n){console.warn(`Failed to remove ${r}:`,n)}})}logout(){this.clearAuth(),window.location.href="/login"}async getAuthHeader(){const t=await this.getToken();return t?`Bearer ${t}`:null}async makeAuthenticatedRequest(t,r={}){const n=await this.getToken();if(!n)throw new Error("No authentication token found");const s={"Content-Type":"application/json",Authorization:`Bearer ${n}`,...r.headers},a=await fetch(t,{...r,headers:s});if(a.status===401)if(await this.refreshToken()){const o=await this.getToken();return s.Authorization=`Bearer ${o}`,fetch(t,{...r,headers:s})}else throw this.logout(),new Error("Authentication failed");return a}async refreshToken(){const t=this.getRefreshToken();if(!t)return!1;try{const r=await fetch("/.netlify/functions/refresh-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refreshToken:t})});if(r.ok){const n=await r.json(),s=n.accessToken||n.token;return s?await this.setToken(s)?(n.refreshToken&&this.setRefreshToken(n.refreshToken),!0):(console.error("Failed to store refreshed token"),!1):(console.error("Refresh token response missing accessToken"),!1)}else{const n=await r.json().catch(()=>({}));return console.error("Token refresh failed:",r.status,n.message||"Unknown error"),!1}}catch(r){console.error("Error refreshing token:",r)}return!1}async getAccessToken(){return await this.getToken()}decodeToken(t){try{if(typeof t!="string"||!t.includes("."))return console.warn("Invalid token format - not a JWT"),this.clearAuth(),null;const r=t.split(".");return r.length!==3?(console.warn("Invalid token format - not 3 parts"),this.clearAuth(),null):JSON.parse(atob(r[1]))}catch(r){return console.error("Error decoding token:",r),console.warn("Token appears to be corrupted - clearing authentication"),this.clearAuth(),null}}async init(){if(!await this.isAuthenticated()){const r=window.location.pathname||"/",n=rDe(r);return console.info("[TokenManager] Unauthenticated visitor on path:",r,"public?",n),n||(window.location.href="/login"),!1}return this.setupTokenRefresh(),!0}setupTokenRefresh(){setInterval(async()=>{await this.isAuthenticated()&&await this.refreshToken()},3e3*1e3)}}const see=new nDe;window.tokenManager=see;if(typeof document<"u"){const e=async()=>{await see.init()};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",e):e()}class aee{constructor(){this.currentRole=null,this.loadedFunctions=new Set,this.blockedFunctions=new Set,this.initialized=!1,this.retryCount=0,this.maxRetries=20}initialize(){if(this.initialized){console.log("[DEBUG] Role-based loader already initialized, skipping...");return}if(this.retryCount>=this.maxRetries){console.warn("[DEBUG] Max retries reached, stopping role-based loader initialization");return}if(this.retryCount++,(this.retryCount%5===1||this.retryCount===this.maxRetries)&&console.log(`[DEBUG] Role-based loader initializing... (attempt ${this.retryCount}/${this.maxRetries})`),console.log("[DEBUG] Token manager available:",!!window.tokenManager),window.tokenManager&&window.tokenManager.isAuthenticated()){const t=window.tokenManager.getUserRole();console.log("[DEBUG] Role from token manager:",t),console.log("[DEBUG] Access token exists:",!!window.tokenManager.getAccessToken()),t?(this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess()):(console.log("[DEBUG] No role found, waiting for role to be set..."),setTimeout(()=>this.initialize(),500))}else console.log("[DEBUG] Token manager not available or not authenticated, waiting..."),setTimeout(()=>this.initialize(),500)}setupRoleBasedAccess(){this.currentRole||(console.warn("No role detected, defaulting to student access"),this.currentRole="student");let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check:",r),t=!1}console.log(`Role-based loader initialized for: ${this.currentRole}${t?" (admin)":""}`),this.loadRoleSpecificFunctions(),this.setupRoleBasedUI(),this.replaceBlockedFunctions()}loadRoleSpecificFunctions(){this.currentRole==="teacher"?this.loadTeacherFunctions():this.currentRole==="student"&&this.loadStudentFunctions()}loadTeacherFunctions(){console.log("Teacher functions already available in main script")}loadStudentFunctions(){console.log("Student functions already available in main script")}loadFunction(t,r){console.log(`Function ${t} already available in main script for ${r}`),this.loadedFunctions.add(t)}setupRoleBasedUI(){let t=!1;try{const r=window.tokenManager.getAccessToken();r&&(t=window.tokenManager.decodeToken(r).role==="admin")}catch(r){console.warn("Could not decode token for admin check in UI:",r),t=!1}this.currentRole==="student"&&this.hideTeacherElements(),this.currentRole==="teacher"&&!t&&this.hideStudentElements()}hideTeacherElements(){[".teacher-cabinet",".test-creation-panel",".grade-management-panel",".class-management-panel",'[data-role="teacher"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}hideStudentElements(){[".student-cabinet",".test-taking-panel",".results-viewing-panel",'[data-role="student"]'].forEach(r=>{document.querySelectorAll(r).forEach(s=>{s.style.display="none",s.classList.add("role-hidden")})})}replaceBlockedFunctions(){this.currentRole==="student"?this.blockTeacherFunctions():this.currentRole==="teacher"&&this.blockStudentFunctions()}blockTeacherFunctions(){Object.entries({createTest:()=>this.showAccessDenied("teacher"),assignTest:()=>this.showAccessDenied("teacher"),gradeTest:()=>this.showAccessDenied("teacher"),manageClasses:()=>this.showAccessDenied("teacher"),viewAllResults:()=>this.showAccessDenied("teacher")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}blockStudentFunctions(){Object.entries({takeTest:()=>this.showAccessDenied("student"),submitTest:()=>this.showAccessDenied("student"),viewMyResults:()=>this.showAccessDenied("student")}).forEach(([r,n])=>{window[r]&&(this.blockedFunctions.add(r),window[r]=n)})}showAccessDenied(t){const r=`Access denied. This function requires ${t} role.`;console.warn(r),typeof showNotification=="function"?showNotification(r,"warning"):alert(r)}isFunctionBlocked(t){return this.blockedFunctions.has(t)}isFunctionLoaded(t){return this.loadedFunctions.has(t)}getCurrentRole(){return this.currentRole}hasRole(t){return this.currentRole===t}reloadRoleAccess(){this.initialize()}setupAccessAfterLogin(){if(console.log("[DEBUG] Setting up role-based access after login..."),console.log("[DEBUG] Role-based loader will now initialize (no more retry loop before login)"),!window.tokenManager)return console.error("[ERROR] Token manager not available during setupAccessAfterLogin"),!1;if(!window.tokenManager.isAuthenticated())return console.error("[ERROR] User not authenticated during setupAccessAfterLogin"),!1;const t=window.tokenManager.getUserRole();return t?(console.log("[DEBUG] Setting role after login:",t),this.currentRole=t,this.initialized=!0,this.retryCount=0,this.setupRoleBasedAccess(),console.log("[DEBUG] Role-based access setup completed successfully for role:",t),!0):(console.error("[ERROR] No role found in token during setupAccessAfterLogin"),!1)}}window.roleBasedLoader=new aee;typeof z4<"u"&&z4.exports&&(z4.exports=aee);const sDe=()=>{const e={schemaVersion:"2.0",enhancedFeatures:!0,newUserStructure:!0,newTestStructure:!0};localStorage.setItem("app_init_data",JSON.stringify(e))},aDe=()=>{sDe(),Dee.createRoot(document.getElementById("root")).render(l.jsx(Rs.StrictMode,{children:l.jsx(QOe,{})}))};aDe()});export default iDe();
